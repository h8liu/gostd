<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5130684">package</span>&nbsp;<span class="ident" id="5130692">link8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5130699">//&nbsp;Linker&nbsp;provides&nbsp;the&nbsp;framework&nbsp;to&nbsp;link&nbsp;packages&nbsp;together.</span><br>
<span class="lineno"></span><span class="keyword" id="5130759">type</span>&nbsp;<span class="ident" id="5130764">Linker</span>&nbsp;<span class="keyword" id="5130771">struct</span>&nbsp;<span class="op" id="5130778">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130781">pkgs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5130790">[</span><span class="op" id="5130791">]</span><span class="op" id="5130792">*</span><span class="ident" id="5130793">Package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130802">pkgIndex</span>&nbsp;<span class="keyword" id="5130811">map</span><span class="op" id="5130814">[</span><span class="builtintype" id="5130815">string</span><span class="op" id="5130821">]</span><span class="builtintype" id="5130822">int</span><br>
<span class="lineno"></span><span class="op" id="5130826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5130829">//&nbsp;NewLinker&nbsp;creates&nbsp;a&nbsp;new&nbsp;linker&nbsp;with&nbsp;no&nbsp;packages.</span><br>
<span class="lineno">10</span><span class="keyword" id="5130881">func</span>&nbsp;<span class="ident" id="5130886">NewLinker</span><span class="op" id="5130895">(</span><span class="op" id="5130896">)</span>&nbsp;<span class="op" id="5130898">*</span><span class="ident" id="5130899">Linker</span>&nbsp;<span class="op" id="5130906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130909">ret</span>&nbsp;<span class="op" id="5130913">:=</span>&nbsp;<span class="builtinfunc" id="5130916">new</span><span class="op" id="5130919">(</span><span class="ident" id="5130920">Linker</span><span class="op" id="5130926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130929">ret</span><span class="op" id="5130932">.</span><span class="ident" id="5130933">pkgIndex</span>&nbsp;<span class="op" id="5130942">=</span>&nbsp;<span class="builtinfunc" id="5130944">make</span><span class="op" id="5130948">(</span><span class="keyword" id="5130949">map</span><span class="op" id="5130952">[</span><span class="builtintype" id="5130953">string</span><span class="op" id="5130959">]</span><span class="builtintype" id="5130960">int</span><span class="op" id="5130963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5130966">return</span>&nbsp;<span class="ident" id="5130973">ret</span><br>
<span class="lineno"></span><span class="op" id="5130977">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5130980">//&nbsp;AddPkg&nbsp;adds&nbsp;a&nbsp;package&nbsp;into&nbsp;the&nbsp;linker.</span><br>
<span class="lineno"></span><span class="comment" id="5131022">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;package&nbsp;and&nbsp;if&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="5131080">//&nbsp;is&nbsp;new.</span><br>
<span class="lineno"></span><span class="keyword" id="5131091">func</span>&nbsp;<span class="op" id="5131096">(</span><span class="ident" id="5131097">lnk</span>&nbsp;<span class="op" id="5131101">*</span><span class="ident" id="5131102">Linker</span><span class="op" id="5131108">)</span>&nbsp;<span class="ident" id="5131110">AddPkg</span><span class="op" id="5131116">(</span><span class="ident" id="5131117">p</span>&nbsp;<span class="op" id="5131119">*</span><span class="ident" id="5131120">Package</span><span class="op" id="5131127">)</span>&nbsp;<span class="op" id="5131129">(</span><span class="ident" id="5131130">index</span>&nbsp;<span class="builtintype" id="5131136">int</span><span class="op" id="5131139">,</span>&nbsp;<span class="ident" id="5131141">isNew</span>&nbsp;<span class="builtintype" id="5131147">bool</span><span class="op" id="5131151">)</span>&nbsp;<span class="op" id="5131153">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131156">path</span>&nbsp;<span class="op" id="5131161">:=</span>&nbsp;<span class="ident" id="5131164">p</span><span class="op" id="5131165">.</span><span class="ident" id="5131166">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131172">index</span><span class="op" id="5131177">,</span>&nbsp;<span class="ident" id="5131179">found</span>&nbsp;<span class="op" id="5131185">:=</span>&nbsp;<span class="ident" id="5131188">lnk</span><span class="op" id="5131191">.</span><span class="ident" id="5131192">pkgIndex</span><span class="op" id="5131200">[</span><span class="ident" id="5131201">path</span><span class="op" id="5131205">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131208">if</span>&nbsp;<span class="ident" id="5131211">found</span>&nbsp;<span class="op" id="5131217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131221">return</span>&nbsp;<span class="ident" id="5131228">index</span><span class="op" id="5131233">,</span>&nbsp;<span class="builtintype" id="5131235">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5131242">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131246">index</span>&nbsp;<span class="op" id="5131252">=</span>&nbsp;<span class="builtinfunc" id="5131254">len</span><span class="op" id="5131257">(</span><span class="ident" id="5131258">lnk</span><span class="op" id="5131261">.</span><span class="ident" id="5131262">pkgs</span><span class="op" id="5131266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131269">lnk</span><span class="op" id="5131272">.</span><span class="ident" id="5131273">pkgs</span>&nbsp;<span class="op" id="5131278">=</span>&nbsp;<span class="builtinfunc" id="5131280">append</span><span class="op" id="5131286">(</span><span class="ident" id="5131287">lnk</span><span class="op" id="5131290">.</span><span class="ident" id="5131291">pkgs</span><span class="op" id="5131295">,</span>&nbsp;<span class="ident" id="5131297">p</span><span class="op" id="5131298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131301">lnk</span><span class="op" id="5131304">.</span><span class="ident" id="5131305">pkgIndex</span><span class="op" id="5131313">[</span><span class="ident" id="5131314">path</span><span class="op" id="5131318">]</span>&nbsp;<span class="op" id="5131320">=</span>&nbsp;<span class="ident" id="5131322">index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131329">return</span>&nbsp;<span class="ident" id="5131336">index</span><span class="op" id="5131341">,</span>&nbsp;<span class="builtintype" id="5131343">true</span><br>
<span class="lineno">30</span><span class="op" id="5131348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5131351">//&nbsp;AddPkgs&nbsp;adds&nbsp;the&nbsp;package&nbsp;and&nbsp;recursively&nbsp;adds&nbsp;the&nbsp;packages</span><br>
<span class="lineno"></span><span class="comment" id="5131413">//&nbsp;it&nbsp;requires.&nbsp;It&nbsp;returns&nbsp;the&nbsp;package&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="5131459">func</span>&nbsp;<span class="op" id="5131464">(</span><span class="ident" id="5131465">lnk</span>&nbsp;<span class="op" id="5131469">*</span><span class="ident" id="5131470">Linker</span><span class="op" id="5131476">)</span>&nbsp;<span class="ident" id="5131478">AddPkgs</span><span class="op" id="5131485">(</span><span class="ident" id="5131486">p</span>&nbsp;<span class="op" id="5131488">*</span><span class="ident" id="5131489">Package</span><span class="op" id="5131496">)</span>&nbsp;<span class="builtintype" id="5131498">int</span>&nbsp;<span class="op" id="5131502">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131505">index</span><span class="op" id="5131510">,</span>&nbsp;<span class="ident" id="5131512">isNew</span>&nbsp;<span class="op" id="5131518">:=</span>&nbsp;<span class="ident" id="5131521">lnk</span><span class="op" id="5131524">.</span><span class="ident" id="5131525">AddPkg</span><span class="op" id="5131531">(</span><span class="ident" id="5131532">p</span><span class="op" id="5131533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131536">if</span>&nbsp;<span class="ident" id="5131539">isNew</span>&nbsp;<span class="op" id="5131545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131549">for</span>&nbsp;<span class="ident" id="5131553">_</span><span class="op" id="5131554">,</span>&nbsp;<span class="ident" id="5131556">req</span>&nbsp;<span class="op" id="5131560">:=</span>&nbsp;<span class="keyword" id="5131563">range</span>&nbsp;<span class="ident" id="5131569">p</span><span class="op" id="5131570">.</span><span class="ident" id="5131571">requires</span>&nbsp;<span class="op" id="5131580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131585">lnk</span><span class="op" id="5131588">.</span><span class="ident" id="5131589">AddPkgs</span><span class="op" id="5131596">(</span><span class="ident" id="5131597">req</span><span class="op" id="5131600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5131604">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5131607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131611">return</span>&nbsp;<span class="ident" id="5131618">index</span><br>
<span class="lineno"></span><span class="op" id="5131624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5131627">//&nbsp;PkgIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;particular&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="5131684">func</span>&nbsp;<span class="op" id="5131689">(</span><span class="ident" id="5131690">lnk</span>&nbsp;<span class="op" id="5131694">*</span><span class="ident" id="5131695">Linker</span><span class="op" id="5131701">)</span>&nbsp;<span class="ident" id="5131703">PkgIndex</span><span class="op" id="5131711">(</span><span class="ident" id="5131712">path</span>&nbsp;<span class="builtintype" id="5131717">string</span><span class="op" id="5131723">)</span>&nbsp;<span class="builtintype" id="5131725">int</span>&nbsp;<span class="op" id="5131729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5131732">ret</span><span class="op" id="5131735">,</span>&nbsp;<span class="ident" id="5131737">found</span>&nbsp;<span class="op" id="5131743">:=</span>&nbsp;<span class="ident" id="5131746">lnk</span><span class="op" id="5131749">.</span><span class="ident" id="5131750">pkgIndex</span><span class="op" id="5131758">[</span><span class="ident" id="5131759">path</span><span class="op" id="5131763">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131766">if</span>&nbsp;<span class="op" id="5131769">!</span><span class="ident" id="5131770">found</span>&nbsp;<span class="op" id="5131776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5131780">panic</span><span class="op" id="5131785">(</span><span class="string" id="5131786">&#34;not&nbsp;found&#34;</span><span class="op" id="5131797">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5131800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131803">return</span>&nbsp;<span class="ident" id="5131810">ret</span><br>
<span class="lineno"></span><span class="op" id="5131814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5131817">//&nbsp;Pkg&nbsp;returns&nbsp;the&nbsp;package&nbsp;of&nbsp;index&nbsp;i.</span><br>
<span class="lineno">55</span><span class="keyword" id="5131856">func</span>&nbsp;<span class="op" id="5131861">(</span><span class="ident" id="5131862">lnk</span>&nbsp;<span class="op" id="5131866">*</span><span class="ident" id="5131867">Linker</span><span class="op" id="5131873">)</span>&nbsp;<span class="ident" id="5131875">Pkg</span><span class="op" id="5131878">(</span><span class="ident" id="5131879">i</span>&nbsp;<span class="builtintype" id="5131881">int</span><span class="op" id="5131884">)</span>&nbsp;<span class="op" id="5131886">*</span><span class="ident" id="5131887">Package</span>&nbsp;<span class="op" id="5131895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131898">return</span>&nbsp;<span class="ident" id="5131905">lnk</span><span class="op" id="5131908">.</span><span class="ident" id="5131909">pkgs</span><span class="op" id="5131913">[</span><span class="ident" id="5131914">i</span><span class="op" id="5131915">]</span><br>
<span class="lineno"></span><span class="op" id="5131917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5131920">//&nbsp;Npkg&nbsp;retunrs&nbsp;the&nbsp;total&nbsp;number&nbsp;of&nbsp;packages.</span><br>
<span class="lineno">60</span><span class="keyword" id="5131966">func</span>&nbsp;<span class="op" id="5131971">(</span><span class="ident" id="5131972">lnk</span>&nbsp;<span class="op" id="5131976">*</span><span class="ident" id="5131977">Linker</span><span class="op" id="5131983">)</span>&nbsp;<span class="ident" id="5131985">Npkg</span><span class="op" id="5131989">(</span><span class="op" id="5131990">)</span>&nbsp;<span class="builtintype" id="5131992">int</span>&nbsp;<span class="op" id="5131996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5131999">return</span>&nbsp;<span class="builtinfunc" id="5132006">len</span><span class="op" id="5132009">(</span><span class="ident" id="5132010">lnk</span><span class="op" id="5132013">.</span><span class="ident" id="5132014">pkgs</span><span class="op" id="5132018">)</span><br>
<span class="lineno"></span><span class="op" id="5132020">}</span>
</div>
</body>
</html>
