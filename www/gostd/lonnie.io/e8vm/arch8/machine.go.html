<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/arch8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/arch8/console.go.html">console.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu.go.html">cpu.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu_test.go.html">cpu_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/device.go.html">device.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/exception.go.html">exception.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br_test.go.html">inst_br_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm_test.go.html">inst_imm_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg_test.go.html">inst_reg_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/int_bus.go.html">int_bus.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt.go.html">interrupt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt_test.go.html">interrupt_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/machine.go.html">machine.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/multi_core.go.html">multi_core.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page.go.html">page.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table.go.html">page_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table_test.go.html">page_table_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_test.go.html">page_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory.go.html">phy_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory_test.go.html">phy_memory_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs.go.html">regs.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs_test.go.html">regs_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/run_image.go.html">run_image.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/serial.go.html">serial.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/ticker.go.html">ticker.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory.go.html">virt_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory_test.go.html">virt_memory_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3578118">package</span>&nbsp;<span class="ident" id="3578126">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3578133">import</span>&nbsp;<span class="op" id="3578140">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3578143">&#34;io&#34;</span><br>
<span class="lineno">5</span><span class="op" id="3578148">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3578151">//&nbsp;Machine&nbsp;is&nbsp;a&nbsp;multicore&nbsp;shared&nbsp;memory&nbsp;simulated&nbsp;arch8&nbsp;machine.</span><br>
<span class="lineno"></span><span class="keyword" id="3578216">type</span>&nbsp;<span class="ident" id="3578221">Machine</span>&nbsp;<span class="keyword" id="3578229">struct</span>&nbsp;<span class="op" id="3578236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578239">phyMem</span>&nbsp;&nbsp;<span class="op" id="3578247">*</span><span class="ident" id="3578248">phyMemory</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578259">inst</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3578267">inst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578273">cores</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3578281">*</span><span class="ident" id="3578282">multiCore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578293">serial</span>&nbsp;&nbsp;<span class="op" id="3578301">*</span><span class="ident" id="3578302">serial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578310">console</span>&nbsp;<span class="op" id="3578318">*</span><span class="ident" id="3578319">console</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578329">devices</span>&nbsp;<span class="op" id="3578337">[</span><span class="op" id="3578338">]</span><span class="ident" id="3578339">device</span><br>
<span class="lineno"></span><span class="op" id="3578346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3578349">//&nbsp;NewMachine&nbsp;creates&nbsp;a&nbsp;machine&nbsp;with&nbsp;memory&nbsp;and&nbsp;cores.</span><br>
<span class="lineno"></span><span class="keyword" id="3578404">func</span>&nbsp;<span class="ident" id="3578409">NewMachine</span><span class="op" id="3578419">(</span><span class="ident" id="3578420">memSize</span>&nbsp;<span class="builtintype" id="3578428">uint32</span><span class="op" id="3578434">,</span>&nbsp;<span class="ident" id="3578436">ncore</span>&nbsp;<span class="builtintype" id="3578442">int</span><span class="op" id="3578445">)</span>&nbsp;<span class="op" id="3578447">*</span><span class="ident" id="3578448">Machine</span>&nbsp;<span class="op" id="3578456">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578459">ret</span>&nbsp;<span class="op" id="3578463">:=</span>&nbsp;<span class="builtinfunc" id="3578466">new</span><span class="op" id="3578469">(</span><span class="ident" id="3578470">Machine</span><span class="op" id="3578477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578480">ret</span><span class="op" id="3578483">.</span><span class="ident" id="3578484">phyMem</span>&nbsp;<span class="op" id="3578491">=</span>&nbsp;<span class="ident" id="3578493">newPhyMemory</span><span class="op" id="3578505">(</span><span class="ident" id="3578506">memSize</span><span class="op" id="3578513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578516">ret</span><span class="op" id="3578519">.</span><span class="ident" id="3578520">inst</span>&nbsp;<span class="op" id="3578525">=</span>&nbsp;<span class="builtinfunc" id="3578527">new</span><span class="op" id="3578530">(</span><span class="ident" id="3578531">instArch8</span><span class="op" id="3578540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578543">ret</span><span class="op" id="3578546">.</span><span class="ident" id="3578547">cores</span>&nbsp;<span class="op" id="3578553">=</span>&nbsp;<span class="ident" id="3578555">newMultiCore</span><span class="op" id="3578567">(</span><span class="ident" id="3578568">ncore</span><span class="op" id="3578573">,</span>&nbsp;<span class="ident" id="3578575">ret</span><span class="op" id="3578578">.</span><span class="ident" id="3578579">phyMem</span><span class="op" id="3578585">,</span>&nbsp;<span class="ident" id="3578587">ret</span><span class="op" id="3578590">.</span><span class="ident" id="3578591">inst</span><span class="op" id="3578595">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3578599">//&nbsp;hook-up&nbsp;devices</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578619">p</span>&nbsp;<span class="op" id="3578621">:=</span>&nbsp;<span class="ident" id="3578624">ret</span><span class="op" id="3578627">.</span><span class="ident" id="3578628">phyMem</span><span class="op" id="3578634">.</span><span class="ident" id="3578635">Page</span><span class="op" id="3578639">(</span><span class="ident" id="3578640">pageBasicIO</span><span class="op" id="3578651">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578655">ret</span><span class="op" id="3578658">.</span><span class="ident" id="3578659">serial</span>&nbsp;<span class="op" id="3578666">=</span>&nbsp;<span class="ident" id="3578668">newSerial</span><span class="op" id="3578677">(</span><span class="ident" id="3578678">p</span><span class="op" id="3578679">,</span>&nbsp;<span class="ident" id="3578681">ret</span><span class="op" id="3578684">.</span><span class="ident" id="3578685">cores</span><span class="op" id="3578690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578693">ret</span><span class="op" id="3578696">.</span><span class="ident" id="3578697">console</span>&nbsp;<span class="op" id="3578705">=</span>&nbsp;<span class="ident" id="3578707">newConsole</span><span class="op" id="3578717">(</span><span class="ident" id="3578718">p</span><span class="op" id="3578719">,</span>&nbsp;<span class="ident" id="3578721">ret</span><span class="op" id="3578724">.</span><span class="ident" id="3578725">cores</span><span class="op" id="3578730">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578734">ret</span><span class="op" id="3578737">.</span><span class="ident" id="3578738">addDevice</span><span class="op" id="3578747">(</span><span class="ident" id="3578748">newTicker</span><span class="op" id="3578757">(</span><span class="ident" id="3578758">ret</span><span class="op" id="3578761">.</span><span class="ident" id="3578762">cores</span><span class="op" id="3578767">)</span><span class="op" id="3578768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578771">ret</span><span class="op" id="3578774">.</span><span class="ident" id="3578775">addDevice</span><span class="op" id="3578784">(</span><span class="ident" id="3578785">ret</span><span class="op" id="3578788">.</span><span class="ident" id="3578789">serial</span><span class="op" id="3578795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578798">ret</span><span class="op" id="3578801">.</span><span class="ident" id="3578802">addDevice</span><span class="op" id="3578811">(</span><span class="ident" id="3578812">ret</span><span class="op" id="3578815">.</span><span class="ident" id="3578816">console</span><span class="op" id="3578823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3578827">return</span>&nbsp;<span class="ident" id="3578834">ret</span><br>
<span class="lineno"></span><span class="op" id="3578838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3578841">//&nbsp;SetOutput&nbsp;sets&nbsp;the&nbsp;output&nbsp;writer&nbsp;of&nbsp;the&nbsp;machine&#39;s&nbsp;serial</span><br>
<span class="lineno"></span><span class="comment" id="3578901">//&nbsp;console.</span><br>
<span class="lineno">40</span><span class="keyword" id="3578913">func</span>&nbsp;<span class="op" id="3578918">(</span><span class="ident" id="3578919">m</span>&nbsp;<span class="op" id="3578921">*</span><span class="ident" id="3578922">Machine</span><span class="op" id="3578929">)</span>&nbsp;<span class="ident" id="3578931">SetOutput</span><span class="op" id="3578940">(</span><span class="ident" id="3578941">w</span>&nbsp;<span class="ident" id="3578943">io</span><span class="op" id="3578945">.</span><span class="ident" id="3578946">Writer</span><span class="op" id="3578952">)</span>&nbsp;<span class="op" id="3578954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578957">m</span><span class="op" id="3578958">.</span><span class="ident" id="3578959">serial</span><span class="op" id="3578965">.</span><span class="ident" id="3578966">Output</span>&nbsp;<span class="op" id="3578973">=</span>&nbsp;<span class="ident" id="3578975">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3578978">m</span><span class="op" id="3578979">.</span><span class="ident" id="3578980">console</span><span class="op" id="3578987">.</span><span class="ident" id="3578988">Output</span>&nbsp;<span class="op" id="3578995">=</span>&nbsp;<span class="ident" id="3578997">w</span><br>
<span class="lineno"></span><span class="op" id="3578999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3579002">//&nbsp;AddDevice&nbsp;adds&nbsp;a&nbsp;devices&nbsp;to&nbsp;the&nbsp;machine.</span><br>
<span class="lineno"></span><span class="keyword" id="3579046">func</span>&nbsp;<span class="op" id="3579051">(</span><span class="ident" id="3579052">m</span>&nbsp;<span class="op" id="3579054">*</span><span class="ident" id="3579055">Machine</span><span class="op" id="3579062">)</span>&nbsp;<span class="ident" id="3579064">addDevice</span><span class="op" id="3579073">(</span><span class="ident" id="3579074">d</span>&nbsp;<span class="ident" id="3579076">device</span><span class="op" id="3579082">)</span>&nbsp;<span class="op" id="3579084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3579087">m</span><span class="op" id="3579088">.</span><span class="ident" id="3579089">devices</span>&nbsp;<span class="op" id="3579097">=</span>&nbsp;<span class="builtinfunc" id="3579099">append</span><span class="op" id="3579105">(</span><span class="ident" id="3579106">m</span><span class="op" id="3579107">.</span><span class="ident" id="3579108">devices</span><span class="op" id="3579115">,</span>&nbsp;<span class="ident" id="3579117">d</span><span class="op" id="3579118">)</span><br>
<span class="lineno"></span><span class="op" id="3579120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3579123">//&nbsp;Tick&nbsp;proceeds&nbsp;the&nbsp;simulation&nbsp;by&nbsp;one&nbsp;tick.</span><br>
<span class="lineno"></span><span class="keyword" id="3579168">func</span>&nbsp;<span class="op" id="3579173">(</span><span class="ident" id="3579174">m</span>&nbsp;<span class="op" id="3579176">*</span><span class="ident" id="3579177">Machine</span><span class="op" id="3579184">)</span>&nbsp;<span class="ident" id="3579186">Tick</span><span class="op" id="3579190">(</span><span class="op" id="3579191">)</span>&nbsp;<span class="op" id="3579193">*</span><span class="ident" id="3579194">CoreExcep</span>&nbsp;<span class="op" id="3579204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579207">for</span>&nbsp;<span class="ident" id="3579211">_</span><span class="op" id="3579212">,</span>&nbsp;<span class="ident" id="3579214">d</span>&nbsp;<span class="op" id="3579216">:=</span>&nbsp;<span class="keyword" id="3579219">range</span>&nbsp;<span class="ident" id="3579225">m</span><span class="op" id="3579226">.</span><span class="ident" id="3579227">devices</span>&nbsp;<span class="op" id="3579235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3579239">d</span><span class="op" id="3579240">.</span><span class="ident" id="3579241">Tick</span><span class="op" id="3579245">(</span><span class="op" id="3579246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3579249">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579253">return</span>&nbsp;<span class="ident" id="3579260">m</span><span class="op" id="3579261">.</span><span class="ident" id="3579262">cores</span><span class="op" id="3579267">.</span><span class="ident" id="3579268">Tick</span><span class="op" id="3579272">(</span><span class="op" id="3579273">)</span><br>
<span class="lineno"></span><span class="op" id="3579275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3579278">//&nbsp;Run&nbsp;simulates&nbsp;nticks.&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;ticks</span><br>
<span class="lineno">60</span><span class="comment" id="3579334">//&nbsp;simulated&nbsp;without&nbsp;error,&nbsp;and&nbsp;the&nbsp;first&nbsp;met&nbsp;error&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="3579394">func</span>&nbsp;<span class="op" id="3579399">(</span><span class="ident" id="3579400">m</span>&nbsp;<span class="op" id="3579402">*</span><span class="ident" id="3579403">Machine</span><span class="op" id="3579410">)</span>&nbsp;<span class="ident" id="3579412">Run</span><span class="op" id="3579415">(</span><span class="ident" id="3579416">nticks</span>&nbsp;<span class="builtintype" id="3579423">int</span><span class="op" id="3579426">)</span>&nbsp;<span class="op" id="3579428">(</span><span class="builtintype" id="3579429">int</span><span class="op" id="3579432">,</span>&nbsp;<span class="op" id="3579434">*</span><span class="ident" id="3579435">CoreExcep</span><span class="op" id="3579444">)</span>&nbsp;<span class="op" id="3579446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3579449">n</span>&nbsp;<span class="op" id="3579451">:=</span>&nbsp;<span class="num" id="3579454">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579457">for</span>&nbsp;<span class="ident" id="3579461">i</span>&nbsp;<span class="op" id="3579463">:=</span>&nbsp;<span class="num" id="3579466">0</span><span class="op" id="3579467">;</span>&nbsp;<span class="ident" id="3579469">nticks</span>&nbsp;<span class="op" id="3579476">==</span>&nbsp;<span class="num" id="3579479">0</span>&nbsp;<span class="op" id="3579481">||</span>&nbsp;<span class="ident" id="3579484">i</span>&nbsp;<span class="op" id="3579486">&lt;</span>&nbsp;<span class="ident" id="3579488">nticks</span><span class="op" id="3579494">;</span>&nbsp;<span class="ident" id="3579496">i</span><span class="op" id="3579497">++</span>&nbsp;<span class="op" id="3579500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3579504">e</span>&nbsp;<span class="op" id="3579506">:=</span>&nbsp;<span class="ident" id="3579509">m</span><span class="op" id="3579510">.</span><span class="ident" id="3579511">Tick</span><span class="op" id="3579515">(</span><span class="op" id="3579516">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3579520">n</span><span class="op" id="3579521">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579526">if</span>&nbsp;<span class="ident" id="3579529">e</span>&nbsp;<span class="op" id="3579531">!=</span>&nbsp;<span class="ident" id="3579534">nil</span>&nbsp;<span class="op" id="3579538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579543">return</span>&nbsp;<span class="ident" id="3579550">n</span><span class="op" id="3579551">,</span>&nbsp;<span class="ident" id="3579553">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3579557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3579560">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579564">return</span>&nbsp;<span class="ident" id="3579571">n</span><span class="op" id="3579572">,</span>&nbsp;<span class="ident" id="3579574">nil</span><br>
<span class="lineno"></span><span class="op" id="3579578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3579581">//&nbsp;LoadImage&nbsp;loads&nbsp;an&nbsp;booting&nbsp;image&nbsp;from&nbsp;a&nbsp;reader&nbsp;and&nbsp;put&nbsp;it</span><br>
<span class="lineno">75</span><span class="comment" id="3579642">//&nbsp;at&nbsp;a&nbsp;particular&nbsp;offset&nbsp;in&nbsp;the&nbsp;physical&nbsp;memory.</span><br>
<span class="lineno"></span><span class="keyword" id="3579692">func</span>&nbsp;<span class="op" id="3579697">(</span><span class="ident" id="3579698">m</span>&nbsp;<span class="op" id="3579700">*</span><span class="ident" id="3579701">Machine</span><span class="op" id="3579708">)</span>&nbsp;<span class="ident" id="3579710">LoadImage</span><span class="op" id="3579719">(</span><span class="ident" id="3579720">r</span>&nbsp;<span class="ident" id="3579722">io</span><span class="op" id="3579724">.</span><span class="ident" id="3579725">Reader</span><span class="op" id="3579731">,</span>&nbsp;<span class="ident" id="3579733">offset</span>&nbsp;<span class="builtintype" id="3579740">uint32</span><span class="op" id="3579746">)</span>&nbsp;<span class="builtintype" id="3579748">error</span>&nbsp;<span class="op" id="3579754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579757">if</span>&nbsp;<span class="ident" id="3579760">offset</span><span class="op" id="3579766">%</span><span class="ident" id="3579767">PageSize</span>&nbsp;<span class="op" id="3579776">!=</span>&nbsp;<span class="num" id="3579779">0</span>&nbsp;<span class="op" id="3579781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3579785">panic</span><span class="op" id="3579790">(</span><span class="string" id="3579791">&#34;boot&nbsp;image&nbsp;not&nbsp;page&nbsp;aligned&#34;</span><span class="op" id="3579820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3579823">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3579827">pn</span>&nbsp;<span class="op" id="3579830">:=</span>&nbsp;<span class="ident" id="3579833">offset</span>&nbsp;<span class="op" id="3579840">/</span>&nbsp;<span class="ident" id="3579842">PageSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579853">for</span>&nbsp;<span class="op" id="3579857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3579861">p</span>&nbsp;<span class="op" id="3579863">:=</span>&nbsp;<span class="ident" id="3579866">m</span><span class="op" id="3579867">.</span><span class="ident" id="3579868">phyMem</span><span class="op" id="3579874">.</span><span class="ident" id="3579875">Page</span><span class="op" id="3579879">(</span><span class="ident" id="3579880">pn</span><span class="op" id="3579882">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579886">if</span>&nbsp;<span class="ident" id="3579889">p</span>&nbsp;<span class="op" id="3579891">==</span>&nbsp;<span class="ident" id="3579894">nil</span>&nbsp;<span class="op" id="3579898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579903">return</span>&nbsp;<span class="ident" id="3579910">errOutOfRange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3579926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3579930">_</span><span class="op" id="3579931">,</span>&nbsp;<span class="ident" id="3579933">e</span>&nbsp;<span class="op" id="3579935">:=</span>&nbsp;<span class="ident" id="3579938">r</span><span class="op" id="3579939">.</span><span class="ident" id="3579940">Read</span><span class="op" id="3579944">(</span><span class="ident" id="3579945">p</span><span class="op" id="3579946">.</span><span class="ident" id="3579947">Bytes</span><span class="op" id="3579952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579956">if</span>&nbsp;<span class="ident" id="3579959">e</span>&nbsp;<span class="op" id="3579961">==</span>&nbsp;<span class="ident" id="3579964">io</span><span class="op" id="3579966">.</span><span class="ident" id="3579967">EOF</span>&nbsp;<span class="op" id="3579971">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3579976">return</span>&nbsp;<span class="ident" id="3579983">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3579989">}</span>&nbsp;<span class="keyword" id="3579991">else</span>&nbsp;<span class="keyword" id="3579996">if</span>&nbsp;<span class="ident" id="3579999">e</span>&nbsp;<span class="op" id="3580001">!=</span>&nbsp;<span class="ident" id="3580004">nil</span>&nbsp;<span class="op" id="3580008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3580013">return</span>&nbsp;<span class="ident" id="3580020">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3580024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3580029">pn</span><span class="op" id="3580031">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3580035">}</span><br>
<span class="lineno"></span><span class="op" id="3580037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3580040">//&nbsp;PrintCoreStatus&nbsp;prints&nbsp;the&nbsp;cpu&nbsp;statuses.</span><br>
<span class="lineno">100</span><span class="keyword" id="3580084">func</span>&nbsp;<span class="op" id="3580089">(</span><span class="ident" id="3580090">m</span>&nbsp;<span class="op" id="3580092">*</span><span class="ident" id="3580093">Machine</span><span class="op" id="3580100">)</span>&nbsp;<span class="ident" id="3580102">PrintCoreStatus</span><span class="op" id="3580117">(</span><span class="op" id="3580118">)</span>&nbsp;<span class="op" id="3580120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3580123">m</span><span class="op" id="3580124">.</span><span class="ident" id="3580125">cores</span><span class="op" id="3580130">.</span><span class="ident" id="3580131">PrintStatus</span><span class="op" id="3580142">(</span><span class="op" id="3580143">)</span><br>
<span class="lineno"></span><span class="op" id="3580145">}</span>
</div>
</body>
</html>
