<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5447516">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5447571">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5447625">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5447676">package</span>&nbsp;<span class="ident" id="5447684">image</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5447691">import</span>&nbsp;<span class="op" id="5447698">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5447701">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5447710">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5447720">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5447725">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5447728">//&nbsp;ErrFormat&nbsp;indicates&nbsp;that&nbsp;decoding&nbsp;encountered&nbsp;an&nbsp;unknown&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="5447796">var</span>&nbsp;<span class="ident" id="5447800">ErrFormat</span>&nbsp;<span class="op" id="5447810">=</span>&nbsp;<span class="ident" id="5447812"><a href="/image/format.go.html#5447710">errors</a></span><span class="op" id="5447818">.</span><span class="ident" id="5447819">New</span><span class="op" id="5447822">(</span><span class="string" id="5447823">&#34;image:&nbsp;unknown&nbsp;format&#34;</span><span class="op" id="5447846">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5447849">//&nbsp;A&nbsp;format&nbsp;holds&nbsp;an&nbsp;image&nbsp;format&#39;s&nbsp;name,&nbsp;magic&nbsp;header&nbsp;and&nbsp;how&nbsp;to&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="5447926">type</span>&nbsp;<span class="ident" id="5447931">format</span>&nbsp;<span class="keyword" id="5447938">struct</span>&nbsp;<span class="op" id="5447945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447948">name</span><span class="op" id="5447952">,</span>&nbsp;<span class="ident" id="5447954">magic</span>&nbsp;&nbsp;<span class="builtintype" id="5447961">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447969">decode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5447982">func</span><span class="op" id="5447986">(</span><span class="ident" id="5447987"><a href="/image/format.go.html#5447720">io</a></span><span class="op" id="5447989">.</span><span class="ident" id="5447990">Reader</span><span class="op" id="5447996">)</span>&nbsp;<span class="op" id="5447998">(</span><span class="ident" id="5447999"><a href="/image/image.go.html#5457152">Image</a></span><span class="op" id="5448004">,</span>&nbsp;<span class="builtintype" id="5448006">error</span><span class="op" id="5448011">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448014">decodeConfig</span>&nbsp;<span class="keyword" id="5448027">func</span><span class="op" id="5448031">(</span><span class="ident" id="5448032"><a href="/image/format.go.html#5447720">io</a></span><span class="op" id="5448034">.</span><span class="ident" id="5448035">Reader</span><span class="op" id="5448041">)</span>&nbsp;<span class="op" id="5448043">(</span><span class="ident" id="5448044"><a href="/image/image.go.html#5456993">Config</a></span><span class="op" id="5448050">,</span>&nbsp;<span class="builtintype" id="5448052">error</span><span class="op" id="5448057">)</span><br>
<span class="lineno"></span><span class="op" id="5448059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5448062">//&nbsp;Formats&nbsp;is&nbsp;the&nbsp;list&nbsp;of&nbsp;registered&nbsp;formats.</span><br>
<span class="lineno"></span><span class="keyword" id="5448108">var</span>&nbsp;<span class="ident" id="5448112">formats</span>&nbsp;<span class="op" id="5448120">[</span><span class="op" id="5448121">]</span><span class="ident" id="5448122"><a href="/image/format.go.html#5447931">format</a></span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5448130">//&nbsp;RegisterFormat&nbsp;registers&nbsp;an&nbsp;image&nbsp;format&nbsp;for&nbsp;use&nbsp;by&nbsp;Decode.</span><br>
<span class="lineno"></span><span class="comment" id="5448193">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;format,&nbsp;like&nbsp;&#34;jpeg&#34;&nbsp;or&nbsp;&#34;png&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="5448250">//&nbsp;Magic&nbsp;is&nbsp;the&nbsp;magic&nbsp;prefix&nbsp;that&nbsp;identifies&nbsp;the&nbsp;format&#39;s&nbsp;encoding.&nbsp;The&nbsp;magic</span><br>
<span class="lineno"></span><span class="comment" id="5448328">//&nbsp;string&nbsp;can&nbsp;contain&nbsp;&#34;?&#34;&nbsp;wildcards&nbsp;that&nbsp;each&nbsp;match&nbsp;any&nbsp;one&nbsp;byte.</span><br>
<span class="lineno">30</span><span class="comment" id="5448394">//&nbsp;Decode&nbsp;is&nbsp;the&nbsp;function&nbsp;that&nbsp;decodes&nbsp;the&nbsp;encoded&nbsp;image.</span><br>
<span class="lineno"></span><span class="comment" id="5448452">//&nbsp;DecodeConfig&nbsp;is&nbsp;the&nbsp;function&nbsp;that&nbsp;decodes&nbsp;just&nbsp;its&nbsp;configuration.</span><br>
<span class="lineno"></span><span class="keyword" id="5448521">func</span>&nbsp;<span class="ident" id="5448526">RegisterFormat</span><span class="op" id="5448540">(</span><span class="ident" id="5448541">name</span><span class="op" id="5448545">,</span>&nbsp;<span class="ident" id="5448547">magic</span>&nbsp;<span class="builtintype" id="5448553">string</span><span class="op" id="5448559">,</span>&nbsp;<span class="ident" id="5448561">decode</span>&nbsp;<span class="keyword" id="5448568">func</span><span class="op" id="5448572">(</span><span class="ident" id="5448573"><a href="/image/format.go.html#5447720">io</a></span><span class="op" id="5448575">.</span><span class="ident" id="5448576">Reader</span><span class="op" id="5448582">)</span>&nbsp;<span class="op" id="5448584">(</span><span class="ident" id="5448585"><a href="/image/image.go.html#5457152">Image</a></span><span class="op" id="5448590">,</span>&nbsp;<span class="builtintype" id="5448592">error</span><span class="op" id="5448597">)</span><span class="op" id="5448598">,</span>&nbsp;<span class="ident" id="5448600">decodeConfig</span>&nbsp;<span class="keyword" id="5448613">func</span><span class="op" id="5448617">(</span><span class="ident" id="5448618"><a href="/image/format.go.html#5447720">io</a></span><span class="op" id="5448620">.</span><span class="ident" id="5448621">Reader</span><span class="op" id="5448627">)</span>&nbsp;<span class="op" id="5448629">(</span><span class="ident" id="5448630"><a href="/image/image.go.html#5456993">Config</a></span><span class="op" id="5448636">,</span>&nbsp;<span class="builtintype" id="5448638">error</span><span class="op" id="5448643">)</span><span class="op" id="5448644">)</span>&nbsp;<span class="op" id="5448646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448649"><a href="/image/format.go.html#5448112">formats</a></span>&nbsp;<span class="op" id="5448657">=</span>&nbsp;<span class="builtinfunc" id="5448659">append</span><span class="op" id="5448665">(</span><span class="ident" id="5448666"><a href="/image/format.go.html#5448112">formats</a></span><span class="op" id="5448673">,</span>&nbsp;<span class="ident" id="5448675"><a href="/image/format.go.html#5447931">format</a></span><span class="op" id="5448681">{</span><span class="ident" id="5448682"><a href="/image/format.go.html#5448541">name</a></span><span class="op" id="5448686">,</span>&nbsp;<span class="ident" id="5448688"><a href="/image/format.go.html#5448547">magic</a></span><span class="op" id="5448693">,</span>&nbsp;<span class="ident" id="5448695"><a href="/image/format.go.html#5448561">decode</a></span><span class="op" id="5448701">,</span>&nbsp;<span class="ident" id="5448703"><a href="/image/format.go.html#5448600">decodeConfig</a></span><span class="op" id="5448715">}</span><span class="op" id="5448716">)</span><br>
<span class="lineno"></span><span class="op" id="5448718">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="5448721">//&nbsp;A&nbsp;reader&nbsp;is&nbsp;an&nbsp;io.Reader&nbsp;that&nbsp;can&nbsp;also&nbsp;peek&nbsp;ahead.</span><br>
<span class="lineno"></span><span class="keyword" id="5448775">type</span>&nbsp;<span class="ident" id="5448780">reader</span>&nbsp;<span class="keyword" id="5448787">interface</span>&nbsp;<span class="op" id="5448797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448800"><a href="/image/format.go.html#5447720">io</a></span><span class="op" id="5448802">.</span><span class="ident" id="5448803">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448811">Peek</span><span class="op" id="5448815">(</span><span class="builtintype" id="5448816">int</span><span class="op" id="5448819">)</span>&nbsp;<span class="op" id="5448821">(</span><span class="op" id="5448822">[</span><span class="op" id="5448823">]</span><span class="builtintype" id="5448824">byte</span><span class="op" id="5448828">,</span>&nbsp;<span class="builtintype" id="5448830">error</span><span class="op" id="5448835">)</span><br>
<span class="lineno">40</span><span class="op" id="5448837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5448840">//&nbsp;asReader&nbsp;converts&nbsp;an&nbsp;io.Reader&nbsp;to&nbsp;a&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5448887">func</span>&nbsp;<span class="ident" id="5448892">asReader</span><span class="op" id="5448900">(</span><span class="ident" id="5448901">r</span>&nbsp;<span class="ident" id="5448903"><a href="/image/format.go.html#5447720">io</a></span><span class="op" id="5448905">.</span><span class="ident" id="5448906">Reader</span><span class="op" id="5448912">)</span>&nbsp;<span class="ident" id="5448914"><a href="/image/format.go.html#5448780">reader</a></span>&nbsp;<span class="op" id="5448921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448924">if</span>&nbsp;<span class="ident" id="5448927">rr</span><span class="op" id="5448929">,</span>&nbsp;<span class="ident" id="5448931">ok</span>&nbsp;<span class="op" id="5448934">:=</span>&nbsp;<span class="ident" id="5448937"><a href="/image/format.go.html#5448901">r</a></span><span class="op" id="5448938">.</span><span class="op" id="5448939">(</span><span class="ident" id="5448940"><a href="/image/format.go.html#5448780">reader</a></span><span class="op" id="5448946">)</span><span class="op" id="5448947">;</span>&nbsp;<span class="ident" id="5448949"><a href="/image/format.go.html#5448931">ok</a></span>&nbsp;<span class="op" id="5448952">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448956">return</span>&nbsp;<span class="ident" id="5448963"><a href="/image/format.go.html#5448927">rr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5448967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448970">return</span>&nbsp;<span class="ident" id="5448977"><a href="/image/format.go.html#5447701">bufio</a></span><span class="op" id="5448982">.</span><span class="ident" id="5448983">NewReader</span><span class="op" id="5448992">(</span><span class="ident" id="5448993"><a href="/image/format.go.html#5448901">r</a></span><span class="op" id="5448994">)</span><br>
<span class="lineno"></span><span class="op" id="5448996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="5448999">//&nbsp;Match&nbsp;reports&nbsp;whether&nbsp;magic&nbsp;matches&nbsp;b.&nbsp;Magic&nbsp;may&nbsp;contain&nbsp;&#34;?&#34;&nbsp;wildcards.</span><br>
<span class="lineno"></span><span class="keyword" id="5449074">func</span>&nbsp;<span class="ident" id="5449079">match</span><span class="op" id="5449084">(</span><span class="ident" id="5449085">magic</span>&nbsp;<span class="builtintype" id="5449091">string</span><span class="op" id="5449097">,</span>&nbsp;<span class="ident" id="5449099">b</span>&nbsp;<span class="op" id="5449101">[</span><span class="op" id="5449102">]</span><span class="builtintype" id="5449103">byte</span><span class="op" id="5449107">)</span>&nbsp;<span class="builtintype" id="5449109">bool</span>&nbsp;<span class="op" id="5449114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449117">if</span>&nbsp;<span class="builtinfunc" id="5449120">len</span><span class="op" id="5449123">(</span><span class="ident" id="5449124"><a href="/image/format.go.html#5449085">magic</a></span><span class="op" id="5449129">)</span>&nbsp;<span class="op" id="5449131">!=</span>&nbsp;<span class="builtinfunc" id="5449134">len</span><span class="op" id="5449137">(</span><span class="ident" id="5449138"><a href="/image/format.go.html#5449099">b</a></span><span class="op" id="5449139">)</span>&nbsp;<span class="op" id="5449141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449145">return</span>&nbsp;<span class="ident" id="5449152">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449159">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449162">for</span>&nbsp;<span class="ident" id="5449166">i</span><span class="op" id="5449167">,</span>&nbsp;<span class="ident" id="5449169">c</span>&nbsp;<span class="op" id="5449171">:=</span>&nbsp;<span class="keyword" id="5449174">range</span>&nbsp;<span class="ident" id="5449180"><a href="/image/format.go.html#5449099">b</a></span>&nbsp;<span class="op" id="5449182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449186">if</span>&nbsp;<span class="ident" id="5449189"><a href="/image/format.go.html#5449085">magic</a></span><span class="op" id="5449194">[</span><span class="ident" id="5449195"><a href="/image/format.go.html#5449166">i</a></span><span class="op" id="5449196">]</span>&nbsp;<span class="op" id="5449198">!=</span>&nbsp;<span class="ident" id="5449201"><a href="/image/format.go.html#5449169">c</a></span>&nbsp;<span class="op" id="5449203">&amp;&amp;</span>&nbsp;<span class="ident" id="5449206"><a href="/image/format.go.html#5449085">magic</a></span><span class="op" id="5449211">[</span><span class="ident" id="5449212"><a href="/image/format.go.html#5449166">i</a></span><span class="op" id="5449213">]</span>&nbsp;<span class="op" id="5449215">!=</span>&nbsp;<span class="string" id="5449218">&#39;?&#39;</span>&nbsp;<span class="op" id="5449222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449227">return</span>&nbsp;<span class="ident" id="5449234">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449245">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449248">return</span>&nbsp;<span class="ident" id="5449255">true</span><br>
<span class="lineno"></span><span class="op" id="5449260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5449263">//&nbsp;Sniff&nbsp;determines&nbsp;the&nbsp;format&nbsp;of&nbsp;r&#39;s&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5449307">func</span>&nbsp;<span class="ident" id="5449312">sniff</span><span class="op" id="5449317">(</span><span class="ident" id="5449318">r</span>&nbsp;<span class="ident" id="5449320"><a href="/image/format.go.html#5448780">reader</a></span><span class="op" id="5449326">)</span>&nbsp;<span class="ident" id="5449328"><a href="/image/format.go.html#5447931">format</a></span>&nbsp;<span class="op" id="5449335">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449338">for</span>&nbsp;<span class="ident" id="5449342">_</span><span class="op" id="5449343">,</span>&nbsp;<span class="ident" id="5449345">f</span>&nbsp;<span class="op" id="5449347">:=</span>&nbsp;<span class="keyword" id="5449350">range</span>&nbsp;<span class="ident" id="5449356"><a href="/image/format.go.html#5448112">formats</a></span>&nbsp;<span class="op" id="5449364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449368">b</span><span class="op" id="5449369">,</span>&nbsp;<span class="ident" id="5449371">err</span>&nbsp;<span class="op" id="5449375">:=</span>&nbsp;<span class="ident" id="5449378"><a href="/image/format.go.html#5449318">r</a></span><span class="op" id="5449379">.</span><span class="ident" id="5449380">Peek</span><span class="op" id="5449384">(</span><span class="builtinfunc" id="5449385">len</span><span class="op" id="5449388">(</span><span class="ident" id="5449389"><a href="/image/format.go.html#5449345">f</a></span><span class="op" id="5449390">.</span><span class="ident" id="5449391">magic</span><span class="op" id="5449396">)</span><span class="op" id="5449397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449401">if</span>&nbsp;<span class="ident" id="5449404"><a href="/image/format.go.html#5449371">err</a></span>&nbsp;<span class="op" id="5449408">==</span>&nbsp;<span class="ident" id="5449411">nil</span>&nbsp;<span class="op" id="5449415">&amp;&amp;</span>&nbsp;<span class="ident" id="5449418"><a href="/image/format.go.html#5449079">match</a></span><span class="op" id="5449423">(</span><span class="ident" id="5449424"><a href="/image/format.go.html#5449345">f</a></span><span class="op" id="5449425">.</span><span class="ident" id="5449426">magic</span><span class="op" id="5449431">,</span>&nbsp;<span class="ident" id="5449433"><a href="/image/format.go.html#5449368">b</a></span><span class="op" id="5449434">)</span>&nbsp;<span class="op" id="5449436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449441">return</span>&nbsp;<span class="ident" id="5449448"><a href="/image/format.go.html#5449345">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449452">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449458">return</span>&nbsp;<span class="ident" id="5449465"><a href="/image/format.go.html#5447931">format</a></span><span class="op" id="5449471">{</span><span class="op" id="5449472">}</span><br>
<span class="lineno"></span><span class="op" id="5449474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5449477">//&nbsp;Decode&nbsp;decodes&nbsp;an&nbsp;image&nbsp;that&nbsp;has&nbsp;been&nbsp;encoded&nbsp;in&nbsp;a&nbsp;registered&nbsp;format.</span><br>
<span class="lineno">75</span><span class="comment" id="5449550">//&nbsp;The&nbsp;string&nbsp;returned&nbsp;is&nbsp;the&nbsp;format&nbsp;name&nbsp;used&nbsp;during&nbsp;format&nbsp;registration.</span><br>
<span class="lineno"></span><span class="comment" id="5449625">//&nbsp;Format&nbsp;registration&nbsp;is&nbsp;typically&nbsp;done&nbsp;by&nbsp;an&nbsp;init&nbsp;function&nbsp;in&nbsp;the&nbsp;codec-</span><br>
<span class="lineno"></span><span class="comment" id="5449700">//&nbsp;specific&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="5449721">func</span>&nbsp;<span class="ident" id="5449726">Decode</span><span class="op" id="5449732">(</span><span class="ident" id="5449733">r</span>&nbsp;<span class="ident" id="5449735"><a href="/image/format.go.html#5447720">io</a></span><span class="op" id="5449737">.</span><span class="ident" id="5449738">Reader</span><span class="op" id="5449744">)</span>&nbsp;<span class="op" id="5449746">(</span><span class="ident" id="5449747"><a href="/image/image.go.html#5457152">Image</a></span><span class="op" id="5449752">,</span>&nbsp;<span class="builtintype" id="5449754">string</span><span class="op" id="5449760">,</span>&nbsp;<span class="builtintype" id="5449762">error</span><span class="op" id="5449767">)</span>&nbsp;<span class="op" id="5449769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449772">rr</span>&nbsp;<span class="op" id="5449775">:=</span>&nbsp;<span class="ident" id="5449778"><a href="/image/format.go.html#5448892">asReader</a></span><span class="op" id="5449786">(</span><span class="ident" id="5449787"><a href="/image/format.go.html#5449733">r</a></span><span class="op" id="5449788">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449791">f</span>&nbsp;<span class="op" id="5449793">:=</span>&nbsp;<span class="ident" id="5449796"><a href="/image/format.go.html#5449312">sniff</a></span><span class="op" id="5449801">(</span><span class="ident" id="5449802"><a href="/image/format.go.html#5449772">rr</a></span><span class="op" id="5449804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449807">if</span>&nbsp;<span class="ident" id="5449810"><a href="/image/format.go.html#5449791">f</a></span><span class="op" id="5449811">.</span><span class="ident" id="5449812">decode</span>&nbsp;<span class="op" id="5449819">==</span>&nbsp;<span class="ident" id="5449822">nil</span>&nbsp;<span class="op" id="5449826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449830">return</span>&nbsp;<span class="ident" id="5449837">nil</span><span class="op" id="5449840">,</span>&nbsp;<span class="string" id="5449842">&#34;&#34;</span><span class="op" id="5449844">,</span>&nbsp;<span class="ident" id="5449846"><a href="/image/format.go.html#5447800">ErrFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449860">m</span><span class="op" id="5449861">,</span>&nbsp;<span class="ident" id="5449863">err</span>&nbsp;<span class="op" id="5449867">:=</span>&nbsp;<span class="ident" id="5449870"><a href="/image/format.go.html#5449791">f</a></span><span class="op" id="5449871">.</span><span class="ident" id="5449872">decode</span><span class="op" id="5449878">(</span><span class="ident" id="5449879"><a href="/image/format.go.html#5449772">rr</a></span><span class="op" id="5449881">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449884">return</span>&nbsp;<span class="ident" id="5449891"><a href="/image/format.go.html#5449860">m</a></span><span class="op" id="5449892">,</span>&nbsp;<span class="ident" id="5449894"><a href="/image/format.go.html#5449791">f</a></span><span class="op" id="5449895">.</span><span class="ident" id="5449896">name</span><span class="op" id="5449900">,</span>&nbsp;<span class="ident" id="5449902"><a href="/image/format.go.html#5449863">err</a></span><br>
<span class="lineno"></span><span class="op" id="5449906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5449909">//&nbsp;DecodeConfig&nbsp;decodes&nbsp;the&nbsp;color&nbsp;model&nbsp;and&nbsp;dimensions&nbsp;of&nbsp;an&nbsp;image&nbsp;that&nbsp;has</span><br>
<span class="lineno"></span><span class="comment" id="5449985">//&nbsp;been&nbsp;encoded&nbsp;in&nbsp;a&nbsp;registered&nbsp;format.&nbsp;The&nbsp;string&nbsp;returned&nbsp;is&nbsp;the&nbsp;format&nbsp;name</span><br>
<span class="lineno">90</span><span class="comment" id="5450064">//&nbsp;used&nbsp;during&nbsp;format&nbsp;registration.&nbsp;Format&nbsp;registration&nbsp;is&nbsp;typically&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5450141">//&nbsp;an&nbsp;init&nbsp;function&nbsp;in&nbsp;the&nbsp;codec-specific&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="5450192">func</span>&nbsp;<span class="ident" id="5450197">DecodeConfig</span><span class="op" id="5450209">(</span><span class="ident" id="5450210">r</span>&nbsp;<span class="ident" id="5450212"><a href="/image/format.go.html#5447720">io</a></span><span class="op" id="5450214">.</span><span class="ident" id="5450215">Reader</span><span class="op" id="5450221">)</span>&nbsp;<span class="op" id="5450223">(</span><span class="ident" id="5450224"><a href="/image/image.go.html#5456993">Config</a></span><span class="op" id="5450230">,</span>&nbsp;<span class="builtintype" id="5450232">string</span><span class="op" id="5450238">,</span>&nbsp;<span class="builtintype" id="5450240">error</span><span class="op" id="5450245">)</span>&nbsp;<span class="op" id="5450247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450250">rr</span>&nbsp;<span class="op" id="5450253">:=</span>&nbsp;<span class="ident" id="5450256"><a href="/image/format.go.html#5448892">asReader</a></span><span class="op" id="5450264">(</span><span class="ident" id="5450265"><a href="/image/format.go.html#5450210">r</a></span><span class="op" id="5450266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450269">f</span>&nbsp;<span class="op" id="5450271">:=</span>&nbsp;<span class="ident" id="5450274"><a href="/image/format.go.html#5449312">sniff</a></span><span class="op" id="5450279">(</span><span class="ident" id="5450280"><a href="/image/format.go.html#5450250">rr</a></span><span class="op" id="5450282">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5450285">if</span>&nbsp;<span class="ident" id="5450288"><a href="/image/format.go.html#5450269">f</a></span><span class="op" id="5450289">.</span><span class="ident" id="5450290">decodeConfig</span>&nbsp;<span class="op" id="5450303">==</span>&nbsp;<span class="ident" id="5450306">nil</span>&nbsp;<span class="op" id="5450310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5450314">return</span>&nbsp;<span class="ident" id="5450321"><a href="/image/image.go.html#5456993">Config</a></span><span class="op" id="5450327">{</span><span class="op" id="5450328">}</span><span class="op" id="5450329">,</span>&nbsp;<span class="string" id="5450331">&#34;&#34;</span><span class="op" id="5450333">,</span>&nbsp;<span class="ident" id="5450335"><a href="/image/format.go.html#5447800">ErrFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5450346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450349">c</span><span class="op" id="5450350">,</span>&nbsp;<span class="ident" id="5450352">err</span>&nbsp;<span class="op" id="5450356">:=</span>&nbsp;<span class="ident" id="5450359"><a href="/image/format.go.html#5450269">f</a></span><span class="op" id="5450360">.</span><span class="ident" id="5450361">decodeConfig</span><span class="op" id="5450373">(</span><span class="ident" id="5450374"><a href="/image/format.go.html#5450250">rr</a></span><span class="op" id="5450376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5450379">return</span>&nbsp;<span class="ident" id="5450386"><a href="/image/format.go.html#5450349">c</a></span><span class="op" id="5450387">,</span>&nbsp;<span class="ident" id="5450389"><a href="/image/format.go.html#5450269">f</a></span><span class="op" id="5450390">.</span><span class="ident" id="5450391">name</span><span class="op" id="5450395">,</span>&nbsp;<span class="ident" id="5450397"><a href="/image/format.go.html#5450352">err</a></span><br>
<span class="lineno">100</span><span class="op" id="5450401">}</span>
</div>
</body>
</html>
