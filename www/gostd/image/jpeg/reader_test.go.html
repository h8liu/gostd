<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/jpeg</h2>
<ul>
<li><a href="/gostd/image/jpeg/dct_test.go.html">dct_test.go</a></li>
<li><a href="/gostd/image/jpeg/fdct.go.html">fdct.go</a></li>
<li><a href="/gostd/image/jpeg/huffman.go.html">huffman.go</a></li>
<li><a href="/gostd/image/jpeg/idct.go.html">idct.go</a></li>
<li><a href="/gostd/image/jpeg/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/jpeg/reader_test.go.html" class="current">reader_test.go</a></li>
<li><a href="/gostd/image/jpeg/scan.go.html">scan.go</a></li>
<li><a href="/gostd/image/jpeg/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/jpeg/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6983969">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6984024">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6984078">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6984129">package</span>&nbsp;<span class="ident" id="6984137">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6984143">import</span>&nbsp;<span class="op" id="6984150">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984153">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984162">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984169">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984178">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984193">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984199">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984212">&#34;math/rand&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984225">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984231">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984242">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6984252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="6984255">//&nbsp;TestDecodeProgressive&nbsp;tests&nbsp;that&nbsp;decoding&nbsp;the&nbsp;baseline&nbsp;and&nbsp;progressive</span><br>
<span class="lineno"></span><span class="comment" id="6984329">//&nbsp;versions&nbsp;of&nbsp;the&nbsp;same&nbsp;image&nbsp;result&nbsp;in&nbsp;exactly&nbsp;the&nbsp;same&nbsp;pixel&nbsp;data,&nbsp;in&nbsp;YCbCr</span><br>
<span class="lineno"></span><span class="comment" id="6984407">//&nbsp;space&nbsp;for&nbsp;color&nbsp;images,&nbsp;and&nbsp;Y&nbsp;space&nbsp;for&nbsp;grayscale&nbsp;images.</span><br>
<span class="lineno"></span><span class="keyword" id="6984468">func</span>&nbsp;<span class="ident" id="6984473">TestDecodeProgressive</span><span class="op" id="6984494">(</span><span class="ident" id="6984495">t</span>&nbsp;<span class="op" id="6984497">*</span><span class="ident" id="6984498"><a href="/gostd/image/jpeg/reader_test.go.html#6984242">testing</a></span><span class="op" id="6984505">.</span><span class="ident" id="6984506"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6984507">)</span>&nbsp;<span class="op" id="6984509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6984512">testCases</span>&nbsp;<span class="op" id="6984522">:=</span>&nbsp;<span class="op" id="6984525">[</span><span class="op" id="6984526">]</span><span class="builtintype" id="6984527">string</span><span class="op" id="6984533">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984537">&#34;../testdata/video-001&#34;</span><span class="op" id="6984560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984564">&#34;../testdata/video-001.q50.420&#34;</span><span class="op" id="6984595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984599">&#34;../testdata/video-001.q50.422&#34;</span><span class="op" id="6984630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984634">&#34;../testdata/video-001.q50.440&#34;</span><span class="op" id="6984665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984669">&#34;../testdata/video-001.q50.444&#34;</span><span class="op" id="6984700">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984704">&#34;../testdata/video-005.gray.q50&#34;</span><span class="op" id="6984736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984740">&#34;../testdata/video-005.gray.q50.2x2&#34;</span><span class="op" id="6984776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6984780">&#34;../testdata/video-001.separate.dc.progression&#34;</span><span class="op" id="6984827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6984830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6984833">for</span>&nbsp;<span class="ident" id="6984837">_</span><span class="op" id="6984838">,</span>&nbsp;<span class="ident" id="6984840">tc</span>&nbsp;<span class="op" id="6984843">:=</span>&nbsp;<span class="keyword" id="6984846">range</span>&nbsp;<span class="ident" id="6984852"><a href="/gostd/image/jpeg/reader_test.go.html#6984512">testCases</a></span>&nbsp;<span class="op" id="6984862">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6984866">m0</span><span class="op" id="6984868">,</span>&nbsp;<span class="ident" id="6984870">err</span>&nbsp;<span class="op" id="6984874">:=</span>&nbsp;<span class="ident" id="6984877"><a href="/gostd/image/jpeg/reader_test.go.html#6986158">decodeFile</a></span><span class="op" id="6984887">(</span><span class="ident" id="6984888"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span>&nbsp;<span class="op" id="6984891">+</span>&nbsp;<span class="string" id="6984893">&#34;.jpeg&#34;</span><span class="op" id="6984900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6984904">if</span>&nbsp;<span class="ident" id="6984907"><a href="/gostd/image/jpeg/reader_test.go.html#6984870">err</a></span>&nbsp;<span class="op" id="6984911">!=</span>&nbsp;<span class="builtintype" id="6984914">nil</span>&nbsp;<span class="op" id="6984918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6984923"><a href="/gostd/image/jpeg/reader_test.go.html#6984495">t</a></span><span class="op" id="6984924">.</span><span class="ident" id="6984925"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6984931">(</span><span class="string" id="6984932">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="6984940">,</span>&nbsp;<span class="ident" id="6984942"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span><span class="op" id="6984944">+</span><span class="string" id="6984945">&#34;.jpeg&#34;</span><span class="op" id="6984952">,</span>&nbsp;<span class="ident" id="6984954"><a href="/gostd/image/jpeg/reader_test.go.html#6984870">err</a></span><span class="op" id="6984957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6984962">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6984973">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6984977">m1</span><span class="op" id="6984979">,</span>&nbsp;<span class="ident" id="6984981"><a href="/gostd/image/jpeg/reader_test.go.html#6984870">err</a></span>&nbsp;<span class="op" id="6984985">:=</span>&nbsp;<span class="ident" id="6984988"><a href="/gostd/image/jpeg/reader_test.go.html#6986158">decodeFile</a></span><span class="op" id="6984998">(</span><span class="ident" id="6984999"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span>&nbsp;<span class="op" id="6985002">+</span>&nbsp;<span class="string" id="6985004">&#34;.progressive.jpeg&#34;</span><span class="op" id="6985023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985027">if</span>&nbsp;<span class="ident" id="6985030"><a href="/gostd/image/jpeg/reader_test.go.html#6984870">err</a></span>&nbsp;<span class="op" id="6985034">!=</span>&nbsp;<span class="builtintype" id="6985037">nil</span>&nbsp;<span class="op" id="6985041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6985046"><a href="/gostd/image/jpeg/reader_test.go.html#6984495">t</a></span><span class="op" id="6985047">.</span><span class="ident" id="6985048"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6985054">(</span><span class="string" id="6985055">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="6985063">,</span>&nbsp;<span class="ident" id="6985065"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span><span class="op" id="6985067">+</span><span class="string" id="6985068">&#34;.progressive.jpeg&#34;</span><span class="op" id="6985087">,</span>&nbsp;<span class="ident" id="6985089"><a href="/gostd/image/jpeg/reader_test.go.html#6984870">err</a></span><span class="op" id="6985092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985097">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6985108">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985112">if</span>&nbsp;<span class="ident" id="6985115"><a href="/gostd/image/jpeg/reader_test.go.html#6984866">m0</a></span><span class="op" id="6985117">.</span><span class="ident" id="6985118"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="6985124">(</span><span class="op" id="6985125">)</span>&nbsp;<span class="op" id="6985127">!=</span>&nbsp;<span class="ident" id="6985130"><a href="/gostd/image/jpeg/reader_test.go.html#6984977">m1</a></span><span class="op" id="6985132">.</span><span class="ident" id="6985133"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="6985139">(</span><span class="op" id="6985140">)</span>&nbsp;<span class="op" id="6985142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6985147"><a href="/gostd/image/jpeg/reader_test.go.html#6984495">t</a></span><span class="op" id="6985148">.</span><span class="ident" id="6985149"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6985155">(</span><span class="string" id="6985156">&#34;%s:&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="6985186">,</span>&nbsp;<span class="ident" id="6985188"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span><span class="op" id="6985190">,</span>&nbsp;<span class="ident" id="6985192"><a href="/gostd/image/jpeg/reader_test.go.html#6984866">m0</a></span><span class="op" id="6985194">.</span><span class="ident" id="6985195"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="6985201">(</span><span class="op" id="6985202">)</span><span class="op" id="6985203">,</span>&nbsp;<span class="ident" id="6985205"><a href="/gostd/image/jpeg/reader_test.go.html#6984977">m1</a></span><span class="op" id="6985207">.</span><span class="ident" id="6985208"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="6985214">(</span><span class="op" id="6985215">)</span><span class="op" id="6985216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985221">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6985232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6985236">//&nbsp;All&nbsp;of&nbsp;the&nbsp;video-*.jpeg&nbsp;files&nbsp;are&nbsp;150x103.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985284">if</span>&nbsp;<span class="ident" id="6985287"><a href="/gostd/image/jpeg/reader_test.go.html#6984866">m0</a></span><span class="op" id="6985289">.</span><span class="ident" id="6985290"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="6985296">(</span><span class="op" id="6985297">)</span>&nbsp;<span class="op" id="6985299">!=</span>&nbsp;<span class="ident" id="6985302"><a href="/gostd/image/jpeg/reader_test.go.html#6984169">image</a></span><span class="op" id="6985307">.</span><span class="ident" id="6985308"><a href="/gostd/image/geom.go.html#5153452">Rect</a></span><span class="op" id="6985312">(</span><span class="num" id="6985313">0</span><span class="op" id="6985314">,</span>&nbsp;<span class="num" id="6985316">0</span><span class="op" id="6985317">,</span>&nbsp;<span class="num" id="6985319">150</span><span class="op" id="6985322">,</span>&nbsp;<span class="num" id="6985324">103</span><span class="op" id="6985327">)</span>&nbsp;<span class="op" id="6985329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6985334"><a href="/gostd/image/jpeg/reader_test.go.html#6984495">t</a></span><span class="op" id="6985335">.</span><span class="ident" id="6985336"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6985342">(</span><span class="string" id="6985343">&#34;%s:&nbsp;bad&nbsp;bounds:&nbsp;%v&#34;</span><span class="op" id="6985363">,</span>&nbsp;<span class="ident" id="6985365"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span><span class="op" id="6985367">,</span>&nbsp;<span class="ident" id="6985369"><a href="/gostd/image/jpeg/reader_test.go.html#6984866">m0</a></span><span class="op" id="6985371">.</span><span class="ident" id="6985372"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="6985378">(</span><span class="op" id="6985379">)</span><span class="op" id="6985380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985385">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6985396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985401">switch</span>&nbsp;<span class="ident" id="6985408">m0</span>&nbsp;<span class="op" id="6985411">:=</span>&nbsp;<span class="ident" id="6985414"><a href="/gostd/image/jpeg/reader_test.go.html#6984866">m0</a></span><span class="op" id="6985416">.</span><span class="op" id="6985417">(</span><span class="keyword" id="6985418">type</span><span class="op" id="6985422">)</span>&nbsp;<span class="op" id="6985424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985428">case</span>&nbsp;<span class="op" id="6985433">*</span><span class="ident" id="6985434"><a href="/gostd/image/jpeg/reader_test.go.html#6984169">image</a></span><span class="op" id="6985439">.</span><span class="ident" id="6985440"><a href="/gostd/image/ycbcr.go.html#5181913">YCbCr</a></span><span class="op" id="6985445">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6985450">m1</span>&nbsp;<span class="op" id="6985453">:=</span>&nbsp;<span class="ident" id="6985456"><a href="/gostd/image/jpeg/reader_test.go.html#6984977">m1</a></span><span class="op" id="6985458">.</span><span class="op" id="6985459">(</span><span class="op" id="6985460">*</span><span class="ident" id="6985461"><a href="/gostd/image/jpeg/reader_test.go.html#6984169">image</a></span><span class="op" id="6985466">.</span><span class="ident" id="6985467"><a href="/gostd/image/ycbcr.go.html#5181913">YCbCr</a></span><span class="op" id="6985472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985477">if</span>&nbsp;<span class="ident" id="6985480">err</span>&nbsp;<span class="op" id="6985484">:=</span>&nbsp;<span class="ident" id="6985487"><a href="/gostd/image/jpeg/reader_test.go.html#6987306">check</a></span><span class="op" id="6985492">(</span><span class="ident" id="6985493"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985495">.</span><span class="ident" id="6985496"><a href="/gostd/image/ycbcr.go.html#5182144">Bounds</a></span><span class="op" id="6985502">(</span><span class="op" id="6985503">)</span><span class="op" id="6985504">,</span>&nbsp;<span class="ident" id="6985506"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985508">.</span><span class="ident" id="6985509"><a href="/gostd/image/ycbcr.go.html#5181929">Y</a></span><span class="op" id="6985510">,</span>&nbsp;<span class="ident" id="6985512"><a href="/gostd/image/jpeg/reader_test.go.html#6985450">m1</a></span><span class="op" id="6985514">.</span><span class="ident" id="6985515"><a href="/gostd/image/ycbcr.go.html#5181929">Y</a></span><span class="op" id="6985516">,</span>&nbsp;<span class="ident" id="6985518"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985520">.</span><span class="ident" id="6985521"><a href="/gostd/image/ycbcr.go.html#5181953">YStride</a></span><span class="op" id="6985528">,</span>&nbsp;<span class="ident" id="6985530"><a href="/gostd/image/jpeg/reader_test.go.html#6985450">m1</a></span><span class="op" id="6985532">.</span><span class="ident" id="6985533"><a href="/gostd/image/ycbcr.go.html#5181953">YStride</a></span><span class="op" id="6985540">)</span><span class="op" id="6985541">;</span>&nbsp;<span class="ident" id="6985543"><a href="/gostd/image/jpeg/reader_test.go.html#6985480">err</a></span>&nbsp;<span class="op" id="6985547">!=</span>&nbsp;<span class="builtintype" id="6985550">nil</span>&nbsp;<span class="op" id="6985554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6985560"><a href="/gostd/image/jpeg/reader_test.go.html#6984495">t</a></span><span class="op" id="6985561">.</span><span class="ident" id="6985562"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6985568">(</span><span class="string" id="6985569">&#34;%s&nbsp;(Y):&nbsp;%v&#34;</span><span class="op" id="6985581">,</span>&nbsp;<span class="ident" id="6985583"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span><span class="op" id="6985585">,</span>&nbsp;<span class="ident" id="6985587"><a href="/gostd/image/jpeg/reader_test.go.html#6985480">err</a></span><span class="op" id="6985590">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985596">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6985608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985613">if</span>&nbsp;<span class="ident" id="6985616">err</span>&nbsp;<span class="op" id="6985620">:=</span>&nbsp;<span class="ident" id="6985623"><a href="/gostd/image/jpeg/reader_test.go.html#6987306">check</a></span><span class="op" id="6985628">(</span><span class="ident" id="6985629"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985631">.</span><span class="ident" id="6985632"><a href="/gostd/image/ycbcr.go.html#5182144">Bounds</a></span><span class="op" id="6985638">(</span><span class="op" id="6985639">)</span><span class="op" id="6985640">,</span>&nbsp;<span class="ident" id="6985642"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985644">.</span><span class="ident" id="6985645"><a href="/gostd/image/ycbcr.go.html#5181932">Cb</a></span><span class="op" id="6985647">,</span>&nbsp;<span class="ident" id="6985649"><a href="/gostd/image/jpeg/reader_test.go.html#6985450">m1</a></span><span class="op" id="6985651">.</span><span class="ident" id="6985652"><a href="/gostd/image/ycbcr.go.html#5181932">Cb</a></span><span class="op" id="6985654">,</span>&nbsp;<span class="ident" id="6985656"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985658">.</span><span class="ident" id="6985659"><a href="/gostd/image/ycbcr.go.html#5181973">CStride</a></span><span class="op" id="6985666">,</span>&nbsp;<span class="ident" id="6985668"><a href="/gostd/image/jpeg/reader_test.go.html#6985450">m1</a></span><span class="op" id="6985670">.</span><span class="ident" id="6985671"><a href="/gostd/image/ycbcr.go.html#5181973">CStride</a></span><span class="op" id="6985678">)</span><span class="op" id="6985679">;</span>&nbsp;<span class="ident" id="6985681"><a href="/gostd/image/jpeg/reader_test.go.html#6985616">err</a></span>&nbsp;<span class="op" id="6985685">!=</span>&nbsp;<span class="builtintype" id="6985688">nil</span>&nbsp;<span class="op" id="6985692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6985698"><a href="/gostd/image/jpeg/reader_test.go.html#6984495">t</a></span><span class="op" id="6985699">.</span><span class="ident" id="6985700"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6985706">(</span><span class="string" id="6985707">&#34;%s&nbsp;(Cb):&nbsp;%v&#34;</span><span class="op" id="6985720">,</span>&nbsp;<span class="ident" id="6985722"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span><span class="op" id="6985724">,</span>&nbsp;<span class="ident" id="6985726"><a href="/gostd/image/jpeg/reader_test.go.html#6985616">err</a></span><span class="op" id="6985729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985735">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6985747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985752">if</span>&nbsp;<span class="ident" id="6985755">err</span>&nbsp;<span class="op" id="6985759">:=</span>&nbsp;<span class="ident" id="6985762"><a href="/gostd/image/jpeg/reader_test.go.html#6987306">check</a></span><span class="op" id="6985767">(</span><span class="ident" id="6985768"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985770">.</span><span class="ident" id="6985771"><a href="/gostd/image/ycbcr.go.html#5182144">Bounds</a></span><span class="op" id="6985777">(</span><span class="op" id="6985778">)</span><span class="op" id="6985779">,</span>&nbsp;<span class="ident" id="6985781"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985783">.</span><span class="ident" id="6985784"><a href="/gostd/image/ycbcr.go.html#5181936">Cr</a></span><span class="op" id="6985786">,</span>&nbsp;<span class="ident" id="6985788"><a href="/gostd/image/jpeg/reader_test.go.html#6985450">m1</a></span><span class="op" id="6985790">.</span><span class="ident" id="6985791"><a href="/gostd/image/ycbcr.go.html#5181936">Cr</a></span><span class="op" id="6985793">,</span>&nbsp;<span class="ident" id="6985795"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985797">.</span><span class="ident" id="6985798"><a href="/gostd/image/ycbcr.go.html#5181973">CStride</a></span><span class="op" id="6985805">,</span>&nbsp;<span class="ident" id="6985807"><a href="/gostd/image/jpeg/reader_test.go.html#6985450">m1</a></span><span class="op" id="6985809">.</span><span class="ident" id="6985810"><a href="/gostd/image/ycbcr.go.html#5181973">CStride</a></span><span class="op" id="6985817">)</span><span class="op" id="6985818">;</span>&nbsp;<span class="ident" id="6985820"><a href="/gostd/image/jpeg/reader_test.go.html#6985755">err</a></span>&nbsp;<span class="op" id="6985824">!=</span>&nbsp;<span class="builtintype" id="6985827">nil</span>&nbsp;<span class="op" id="6985831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6985837"><a href="/gostd/image/jpeg/reader_test.go.html#6984495">t</a></span><span class="op" id="6985838">.</span><span class="ident" id="6985839"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6985845">(</span><span class="string" id="6985846">&#34;%s&nbsp;(Cr):&nbsp;%v&#34;</span><span class="op" id="6985859">,</span>&nbsp;<span class="ident" id="6985861"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span><span class="op" id="6985863">,</span>&nbsp;<span class="ident" id="6985865"><a href="/gostd/image/jpeg/reader_test.go.html#6985755">err</a></span><span class="op" id="6985868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985874">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6985886">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985890">case</span>&nbsp;<span class="op" id="6985895">*</span><span class="ident" id="6985896"><a href="/gostd/image/jpeg/reader_test.go.html#6984169">image</a></span><span class="op" id="6985901">.</span><span class="ident" id="6985902"><a href="/gostd/image/image.go.html#5172029">Gray</a></span><span class="op" id="6985906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6985911">m1</span>&nbsp;<span class="op" id="6985914">:=</span>&nbsp;<span class="ident" id="6985917"><a href="/gostd/image/jpeg/reader_test.go.html#6984977">m1</a></span><span class="op" id="6985919">.</span><span class="op" id="6985920">(</span><span class="op" id="6985921">*</span><span class="ident" id="6985922"><a href="/gostd/image/jpeg/reader_test.go.html#6984169">image</a></span><span class="op" id="6985927">.</span><span class="ident" id="6985928"><a href="/gostd/image/image.go.html#5172029">Gray</a></span><span class="op" id="6985932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6985937">if</span>&nbsp;<span class="ident" id="6985940">err</span>&nbsp;<span class="op" id="6985944">:=</span>&nbsp;<span class="ident" id="6985947"><a href="/gostd/image/jpeg/reader_test.go.html#6987306">check</a></span><span class="op" id="6985952">(</span><span class="ident" id="6985953"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985955">.</span><span class="ident" id="6985956"><a href="/gostd/image/image.go.html#5172409">Bounds</a></span><span class="op" id="6985962">(</span><span class="op" id="6985963">)</span><span class="op" id="6985964">,</span>&nbsp;<span class="ident" id="6985966"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985968">.</span><span class="ident" id="6985969"><a href="/gostd/image/image.go.html#5172175">Pix</a></span><span class="op" id="6985972">,</span>&nbsp;<span class="ident" id="6985974"><a href="/gostd/image/jpeg/reader_test.go.html#6985911">m1</a></span><span class="op" id="6985976">.</span><span class="ident" id="6985977"><a href="/gostd/image/image.go.html#5172175">Pix</a></span><span class="op" id="6985980">,</span>&nbsp;<span class="ident" id="6985982"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6985984">.</span><span class="ident" id="6985985"><a href="/gostd/image/image.go.html#5172264">Stride</a></span><span class="op" id="6985991">,</span>&nbsp;<span class="ident" id="6985993"><a href="/gostd/image/jpeg/reader_test.go.html#6985911">m1</a></span><span class="op" id="6985995">.</span><span class="ident" id="6985996"><a href="/gostd/image/image.go.html#5172264">Stride</a></span><span class="op" id="6986002">)</span><span class="op" id="6986003">;</span>&nbsp;<span class="ident" id="6986005"><a href="/gostd/image/jpeg/reader_test.go.html#6985940">err</a></span>&nbsp;<span class="op" id="6986009">!=</span>&nbsp;<span class="builtintype" id="6986012">nil</span>&nbsp;<span class="op" id="6986016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986022"><a href="/gostd/image/jpeg/reader_test.go.html#6984495">t</a></span><span class="op" id="6986023">.</span><span class="ident" id="6986024"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6986030">(</span><span class="string" id="6986031">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="6986039">,</span>&nbsp;<span class="ident" id="6986041"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span><span class="op" id="6986043">,</span>&nbsp;<span class="ident" id="6986045"><a href="/gostd/image/jpeg/reader_test.go.html#6985940">err</a></span><span class="op" id="6986048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986054">continue</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986070">default</span><span class="op" id="6986077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986082"><a href="/gostd/image/jpeg/reader_test.go.html#6984495">t</a></span><span class="op" id="6986083">.</span><span class="ident" id="6986084"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6986090">(</span><span class="string" id="6986091">&#34;%s:&nbsp;unexpected&nbsp;image&nbsp;type&nbsp;%T&#34;</span><span class="op" id="6986121">,</span>&nbsp;<span class="ident" id="6986123"><a href="/gostd/image/jpeg/reader_test.go.html#6984840">tc</a></span><span class="op" id="6986125">,</span>&nbsp;<span class="ident" id="6986127"><a href="/gostd/image/jpeg/reader_test.go.html#6985408">m0</a></span><span class="op" id="6986129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986134">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986145">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986148">}</span><br>
<span class="lineno"></span><span class="op" id="6986150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6986153">func</span>&nbsp;<span class="ident" id="6986158">decodeFile</span><span class="op" id="6986168">(</span><span class="ident" id="6986169">filename</span>&nbsp;<span class="builtintype" id="6986178">string</span><span class="op" id="6986184">)</span>&nbsp;<span class="op" id="6986186">(</span><span class="ident" id="6986187"><a href="/gostd/image/jpeg/reader_test.go.html#6984169">image</a></span><span class="op" id="6986192">.</span><span class="ident" id="6986193"><a href="/gostd/image/image.go.html#5154907">Image</a></span><span class="op" id="6986198">,</span>&nbsp;<span class="builtintype" id="6986200">error</span><span class="op" id="6986205">)</span>&nbsp;<span class="op" id="6986207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986210">f</span><span class="op" id="6986211">,</span>&nbsp;<span class="ident" id="6986213">err</span>&nbsp;<span class="op" id="6986217">:=</span>&nbsp;<span class="ident" id="6986220"><a href="/gostd/image/jpeg/reader_test.go.html#6984225">os</a></span><span class="op" id="6986222">.</span><span class="ident" id="6986223"><a href="/gostd/os/file.go.html#2446863">Open</a></span><span class="op" id="6986227">(</span><span class="ident" id="6986228"><a href="/gostd/image/jpeg/reader_test.go.html#6986169">filename</a></span><span class="op" id="6986236">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986239">if</span>&nbsp;<span class="ident" id="6986242"><a href="/gostd/image/jpeg/reader_test.go.html#6986213">err</a></span>&nbsp;<span class="op" id="6986246">!=</span>&nbsp;<span class="builtintype" id="6986249">nil</span>&nbsp;<span class="op" id="6986253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986257">return</span>&nbsp;<span class="builtintype" id="6986264">nil</span><span class="op" id="6986267">,</span>&nbsp;<span class="ident" id="6986269"><a href="/gostd/image/jpeg/reader_test.go.html#6986213">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986277">defer</span>&nbsp;<span class="ident" id="6986283"><a href="/gostd/image/jpeg/reader_test.go.html#6986210">f</a></span><span class="op" id="6986284">.</span><span class="ident" id="6986285"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="6986290">(</span><span class="op" id="6986291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986294">return</span>&nbsp;<span class="ident" id="6986301"><a href="/gostd/image/jpeg/reader.go.html#5114879">Decode</a></span><span class="op" id="6986307">(</span><span class="ident" id="6986308"><a href="/gostd/image/jpeg/reader_test.go.html#6986210">f</a></span><span class="op" id="6986309">)</span><br>
<span class="lineno">90</span><span class="op" id="6986311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6986314">type</span>&nbsp;<span class="ident" id="6986319">eofReader</span>&nbsp;<span class="keyword" id="6986329">struct</span>&nbsp;<span class="op" id="6986336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986339">data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986348">[</span><span class="op" id="6986349">]</span><span class="builtintype" id="6986350">byte</span>&nbsp;<span class="comment" id="6986355">//&nbsp;deliver&nbsp;from&nbsp;Read&nbsp;without&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986389">dataEOF</span>&nbsp;&nbsp;<span class="op" id="6986398">[</span><span class="op" id="6986399">]</span><span class="builtintype" id="6986400">byte</span>&nbsp;<span class="comment" id="6986405">//&nbsp;then&nbsp;deliver&nbsp;from&nbsp;Read&nbsp;with&nbsp;EOF&nbsp;on&nbsp;last&nbsp;chunk</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986455">lenAtEOF</span>&nbsp;<span class="builtintype" id="6986464">int</span><br>
<span class="lineno"></span><span class="op" id="6986468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6986471">func</span>&nbsp;<span class="op" id="6986476">(</span><span class="ident" id="6986477">r</span>&nbsp;<span class="op" id="6986479">*</span><span class="ident" id="6986480"><a href="/gostd/image/jpeg/reader_test.go.html#6986319">eofReader</a></span><span class="op" id="6986489">)</span>&nbsp;<span class="ident" id="6986491">Read</span><span class="op" id="6986495">(</span><span class="ident" id="6986496">b</span>&nbsp;<span class="op" id="6986498">[</span><span class="op" id="6986499">]</span><span class="builtintype" id="6986500">byte</span><span class="op" id="6986504">)</span>&nbsp;<span class="op" id="6986506">(</span><span class="ident" id="6986507">n</span>&nbsp;<span class="builtintype" id="6986509">int</span><span class="op" id="6986512">,</span>&nbsp;<span class="ident" id="6986514">err</span>&nbsp;<span class="builtintype" id="6986518">error</span><span class="op" id="6986523">)</span>&nbsp;<span class="op" id="6986525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986528">if</span>&nbsp;<span class="builtinfunc" id="6986531">len</span><span class="op" id="6986534">(</span><span class="ident" id="6986535"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986536">.</span><span class="ident" id="6986537"><a href="/gostd/image/jpeg/reader_test.go.html#6986339">data</a></span><span class="op" id="6986541">)</span>&nbsp;<span class="op" id="6986543">&gt;</span>&nbsp;<span class="num" id="6986545">0</span>&nbsp;<span class="op" id="6986547">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986551"><a href="/gostd/image/jpeg/reader_test.go.html#6986507">n</a></span>&nbsp;<span class="op" id="6986553">=</span>&nbsp;<span class="builtinfunc" id="6986555">copy</span><span class="op" id="6986559">(</span><span class="ident" id="6986560"><a href="/gostd/image/jpeg/reader_test.go.html#6986496">b</a></span><span class="op" id="6986561">,</span>&nbsp;<span class="ident" id="6986563"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986564">.</span><span class="ident" id="6986565"><a href="/gostd/image/jpeg/reader_test.go.html#6986339">data</a></span><span class="op" id="6986569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986573"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986574">.</span><span class="ident" id="6986575"><a href="/gostd/image/jpeg/reader_test.go.html#6986339">data</a></span>&nbsp;<span class="op" id="6986580">=</span>&nbsp;<span class="ident" id="6986582"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986583">.</span><span class="ident" id="6986584"><a href="/gostd/image/jpeg/reader_test.go.html#6986339">data</a></span><span class="op" id="6986588">[</span><span class="ident" id="6986589"><a href="/gostd/image/jpeg/reader_test.go.html#6986507">n</a></span><span class="op" id="6986590">:</span><span class="op" id="6986591">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986594">}</span>&nbsp;<span class="keyword" id="6986596">else</span>&nbsp;<span class="op" id="6986601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986605"><a href="/gostd/image/jpeg/reader_test.go.html#6986507">n</a></span>&nbsp;<span class="op" id="6986607">=</span>&nbsp;<span class="builtinfunc" id="6986609">copy</span><span class="op" id="6986613">(</span><span class="ident" id="6986614"><a href="/gostd/image/jpeg/reader_test.go.html#6986496">b</a></span><span class="op" id="6986615">,</span>&nbsp;<span class="ident" id="6986617"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986618">.</span><span class="ident" id="6986619"><a href="/gostd/image/jpeg/reader_test.go.html#6986389">dataEOF</a></span><span class="op" id="6986626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986630"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986631">.</span><span class="ident" id="6986632"><a href="/gostd/image/jpeg/reader_test.go.html#6986389">dataEOF</a></span>&nbsp;<span class="op" id="6986640">=</span>&nbsp;<span class="ident" id="6986642"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986643">.</span><span class="ident" id="6986644"><a href="/gostd/image/jpeg/reader_test.go.html#6986389">dataEOF</a></span><span class="op" id="6986651">[</span><span class="ident" id="6986652"><a href="/gostd/image/jpeg/reader_test.go.html#6986507">n</a></span><span class="op" id="6986653">:</span><span class="op" id="6986654">]</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986658">if</span>&nbsp;<span class="builtinfunc" id="6986661">len</span><span class="op" id="6986664">(</span><span class="ident" id="6986665"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986666">.</span><span class="ident" id="6986667"><a href="/gostd/image/jpeg/reader_test.go.html#6986389">dataEOF</a></span><span class="op" id="6986674">)</span>&nbsp;<span class="op" id="6986676">==</span>&nbsp;<span class="num" id="6986679">0</span>&nbsp;<span class="op" id="6986681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986686"><a href="/gostd/image/jpeg/reader_test.go.html#6986514">err</a></span>&nbsp;<span class="op" id="6986690">=</span>&nbsp;<span class="ident" id="6986692"><a href="/gostd/image/jpeg/reader_test.go.html#6984193">io</a></span><span class="op" id="6986694">.</span><span class="ident" id="6986695"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986702">if</span>&nbsp;<span class="ident" id="6986705"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986706">.</span><span class="ident" id="6986707"><a href="/gostd/image/jpeg/reader_test.go.html#6986455">lenAtEOF</a></span>&nbsp;<span class="op" id="6986716">==</span>&nbsp;<span class="op" id="6986719">-</span><span class="num" id="6986720">1</span>&nbsp;<span class="op" id="6986722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986728"><a href="/gostd/image/jpeg/reader_test.go.html#6986477">r</a></span><span class="op" id="6986729">.</span><span class="ident" id="6986730"><a href="/gostd/image/jpeg/reader_test.go.html#6986455">lenAtEOF</a></span>&nbsp;<span class="op" id="6986739">=</span>&nbsp;<span class="ident" id="6986741"><a href="/gostd/image/jpeg/reader_test.go.html#6986507">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986746">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986756">return</span><br>
<span class="lineno"></span><span class="op" id="6986763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="6986766">func</span>&nbsp;<span class="ident" id="6986771">TestDecodeEOF</span><span class="op" id="6986784">(</span><span class="ident" id="6986785">t</span>&nbsp;<span class="op" id="6986787">*</span><span class="ident" id="6986788"><a href="/gostd/image/jpeg/reader_test.go.html#6984242">testing</a></span><span class="op" id="6986795">.</span><span class="ident" id="6986796"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6986797">)</span>&nbsp;<span class="op" id="6986799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6986802">//&nbsp;Check&nbsp;that&nbsp;if&nbsp;reader&nbsp;returns&nbsp;final&nbsp;data&nbsp;and&nbsp;EOF&nbsp;at&nbsp;same&nbsp;time,&nbsp;jpeg&nbsp;handles&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986885">data</span><span class="op" id="6986889">,</span>&nbsp;<span class="ident" id="6986891">err</span>&nbsp;<span class="op" id="6986895">:=</span>&nbsp;<span class="ident" id="6986898"><a href="/gostd/image/jpeg/reader_test.go.html#6984199">ioutil</a></span><span class="op" id="6986904">.</span><span class="ident" id="6986905"><a href="/gostd/io/ioutil/ioutil.go.html#3765434">ReadFile</a></span><span class="op" id="6986913">(</span><span class="string" id="6986914">&#34;../testdata/video-001.jpeg&#34;</span><span class="op" id="6986942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986945">if</span>&nbsp;<span class="ident" id="6986948"><a href="/gostd/image/jpeg/reader_test.go.html#6986891">err</a></span>&nbsp;<span class="op" id="6986952">!=</span>&nbsp;<span class="builtintype" id="6986955">nil</span>&nbsp;<span class="op" id="6986959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986963"><a href="/gostd/image/jpeg/reader_test.go.html#6986785">t</a></span><span class="op" id="6986964">.</span><span class="ident" id="6986965"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6986970">(</span><span class="ident" id="6986971"><a href="/gostd/image/jpeg/reader_test.go.html#6986891">err</a></span><span class="op" id="6986974">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6986977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6986981">n</span>&nbsp;<span class="op" id="6986983">:=</span>&nbsp;<span class="builtinfunc" id="6986986">len</span><span class="op" id="6986989">(</span><span class="ident" id="6986990"><a href="/gostd/image/jpeg/reader_test.go.html#6986885">data</a></span><span class="op" id="6986994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6986997">for</span>&nbsp;<span class="ident" id="6987001">i</span>&nbsp;<span class="op" id="6987003">:=</span>&nbsp;<span class="num" id="6987006">0</span><span class="op" id="6987007">;</span>&nbsp;<span class="ident" id="6987009"><a href="/gostd/image/jpeg/reader_test.go.html#6987001">i</a></span>&nbsp;<span class="op" id="6987011">&lt;</span>&nbsp;<span class="ident" id="6987013"><a href="/gostd/image/jpeg/reader_test.go.html#6986981">n</a></span><span class="op" id="6987014">;</span>&nbsp;<span class="op" id="6987016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6987020">r</span>&nbsp;<span class="op" id="6987022">:=</span>&nbsp;<span class="op" id="6987025">&amp;</span><span class="ident" id="6987026"><a href="/gostd/image/jpeg/reader_test.go.html#6986319">eofReader</a></span><span class="op" id="6987035">{</span><span class="ident" id="6987036"><a href="/gostd/image/jpeg/reader_test.go.html#6986885">data</a></span><span class="op" id="6987040">[</span><span class="op" id="6987041">:</span><span class="ident" id="6987042"><a href="/gostd/image/jpeg/reader_test.go.html#6986981">n</a></span><span class="op" id="6987043">-</span><span class="ident" id="6987044"><a href="/gostd/image/jpeg/reader_test.go.html#6987001">i</a></span><span class="op" id="6987045">]</span><span class="op" id="6987046">,</span>&nbsp;<span class="ident" id="6987048"><a href="/gostd/image/jpeg/reader_test.go.html#6986885">data</a></span><span class="op" id="6987052">[</span><span class="ident" id="6987053"><a href="/gostd/image/jpeg/reader_test.go.html#6986981">n</a></span><span class="op" id="6987054">-</span><span class="ident" id="6987055"><a href="/gostd/image/jpeg/reader_test.go.html#6987001">i</a></span><span class="op" id="6987056">:</span><span class="op" id="6987057">]</span><span class="op" id="6987058">,</span>&nbsp;<span class="op" id="6987060">-</span><span class="num" id="6987061">1</span><span class="op" id="6987062">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6987066">_</span><span class="op" id="6987067">,</span>&nbsp;<span class="ident" id="6987069">err</span>&nbsp;<span class="op" id="6987073">:=</span>&nbsp;<span class="ident" id="6987076"><a href="/gostd/image/jpeg/reader.go.html#5114879">Decode</a></span><span class="op" id="6987082">(</span><span class="ident" id="6987083"><a href="/gostd/image/jpeg/reader_test.go.html#6987020">r</a></span><span class="op" id="6987084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6987088">if</span>&nbsp;<span class="ident" id="6987091"><a href="/gostd/image/jpeg/reader_test.go.html#6987069">err</a></span>&nbsp;<span class="op" id="6987095">!=</span>&nbsp;<span class="builtintype" id="6987098">nil</span>&nbsp;<span class="op" id="6987102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6987107"><a href="/gostd/image/jpeg/reader_test.go.html#6986785">t</a></span><span class="op" id="6987108">.</span><span class="ident" id="6987109"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6987115">(</span><span class="string" id="6987116">&#34;Decode&nbsp;with&nbsp;Read()&nbsp;=&nbsp;%d,&nbsp;EOF:&nbsp;%v&#34;</span><span class="op" id="6987150">,</span>&nbsp;<span class="ident" id="6987152"><a href="/gostd/image/jpeg/reader_test.go.html#6987020">r</a></span><span class="op" id="6987153">.</span><span class="ident" id="6987154"><a href="/gostd/image/jpeg/reader_test.go.html#6986455">lenAtEOF</a></span><span class="op" id="6987162">,</span>&nbsp;<span class="ident" id="6987164"><a href="/gostd/image/jpeg/reader_test.go.html#6987069">err</a></span><span class="op" id="6987167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6987171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6987175">if</span>&nbsp;<span class="ident" id="6987178"><a href="/gostd/image/jpeg/reader_test.go.html#6987001">i</a></span>&nbsp;<span class="op" id="6987180">==</span>&nbsp;<span class="num" id="6987183">0</span>&nbsp;<span class="op" id="6987185">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6987190"><a href="/gostd/image/jpeg/reader_test.go.html#6987001">i</a></span>&nbsp;<span class="op" id="6987192">=</span>&nbsp;<span class="num" id="6987194">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6987198">}</span>&nbsp;<span class="keyword" id="6987200">else</span>&nbsp;<span class="op" id="6987205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6987210"><a href="/gostd/image/jpeg/reader_test.go.html#6987001">i</a></span>&nbsp;<span class="op" id="6987212">*=</span>&nbsp;<span class="num" id="6987215">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6987219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6987222">}</span><br>
<span class="lineno">135</span><span class="op" id="6987224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6987227">//&nbsp;check&nbsp;checks&nbsp;that&nbsp;the&nbsp;two&nbsp;pix&nbsp;data&nbsp;are&nbsp;equal,&nbsp;within&nbsp;the&nbsp;given&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword" id="6987301">func</span>&nbsp;<span class="ident" id="6987306">check</span><span class="op" id="6987311">(</span><span class="ident" id="6987312">bounds</span>&nbsp;<span class="ident" id="6987319"><a href="/gostd/image/jpeg/reader_test.go.html#6984169">image</a></span><span class="op" id="6987324">.</span><span class="ident" id="6987325"><a href="/gostd/image/geom.go.html#5149996">Rectangle</a></span><span class="op" id="6987334">,</span>&nbsp;<span class="ident" id="6987336">pix0</span><span class="op" id="6987340">,</span>&nbsp;<span class="ident" id="6987342">pix1</span>&nbsp;<span class="op" id="6987347">[</span><span class="op" id="6987348">]</span><span class="builtintype" id="6987349">byte</span><span class="op" id="6987353">,</span>&nbsp;<span class="ident" id="6987355">stride0</span><span class="op" id="6987362">,</span>&nbsp;<span class="ident" id="6987364">stride1</span>&nbsp;<span class="builtintype" id="6987372">int</span><span class="op" id="6987375">)</span>&nbsp;<span class="builtintype" id="6987377">error</span>&nbsp;<span class="op" id="6987383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6987386">if</span>&nbsp;<span class="ident" id="6987389"><a href="/gostd/image/jpeg/reader_test.go.html#6987355">stride0</a></span>&nbsp;<span class="op" id="6987397">&lt;=</span>&nbsp;<span class="num" id="6987400">0</span>&nbsp;<span class="op" id="6987402">||</span>&nbsp;<span class="ident" id="6987405"><a href="/gostd/image/jpeg/reader_test.go.html#6987355">stride0</a></span><span class="op" id="6987412">%</span><span class="num" id="6987413">8</span>&nbsp;<span class="op" id="6987415">!=</span>&nbsp;<span class="num" id="6987418">0</span>&nbsp;<span class="op" id="6987420">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6987424">return</span>&nbsp;<span class="ident" id="6987431"><a href="/gostd/image/jpeg/reader_test.go.html#6984162">fmt</a></span><span class="op" id="6987434">.</span><span class="ident" id="6987435"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="6987441">(</span><span class="string" id="6987442">&#34;bad&nbsp;stride&nbsp;%d&#34;</span><span class="op" id="6987457">,</span>&nbsp;<span class="ident" id="6987459"><a href="/gostd/image/jpeg/reader_test.go.html#6987355">stride0</a></span><span class="op" id="6987466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6987469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6987472">if</span>&nbsp;<span class="ident" id="6987475"><a href="/gostd/image/jpeg/reader_test.go.html#6987364">stride1</a></span>&nbsp;<span class="op" id="6987483">&lt;=</span>&nbsp;<span class="num" id="6987486">0</span>&nbsp;<span class="op" id="6987488">||</span>&nbsp;<span class="ident" id="6987491"><a href="/gostd/image/jpeg/reader_test.go.html#6987364">stride1</a></span><span class="op" id="6987498">%</span><span class="num" id="6987499">8</span>&nbsp;<span class="op" id="6987501">!=</span>&nbsp;<span class="num" id="6987504">0</span>&nbsp;<span class="op" id="6987506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6987510">return</span>&nbsp;<span class="ident" id="6987517"><a href="/gostd/image/jpeg/reader_test.go.html#6984162">fmt</a></span><span class="op" id="6987520">.</span><span class="ident" id="6987521"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="6987527">(</span><span class="string" id="6987528">&#34;bad&nbsp;stride&nbsp;%d&#34;</span><span class="op" id="6987543">,</span>&nbsp;<span class="ident" id="6987545"><a href="/gostd/image/jpeg/reader_test.go.html#6987364">stride1</a></span><span class="op" id="6987552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6987555">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6987558">//&nbsp;Compare&nbsp;the&nbsp;two&nbsp;pix&nbsp;data,&nbsp;one&nbsp;8x8&nbsp;block&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6987613">for</span>&nbsp;<span class="ident" id="6987617">y</span>&nbsp;<span class="op" id="6987619">:=</span>&nbsp;<span class="num" id="6987622">0</span><span class="op" id="6987623">;</span>&nbsp;<span class="ident" id="6987625"><a href="/gostd/image/jpeg/reader_test.go.html#6987617">y</a></span>&nbsp;<span class="op" id="6987627">&lt;</span>&nbsp;<span class="builtinfunc" id="6987629">len</span><span class="op" id="6987632">(</span><span class="ident" id="6987633"><a href="/gostd/image/jpeg/reader_test.go.html#6987336">pix0</a></span><span class="op" id="6987637">)</span><span class="op" id="6987638">/</span><span class="ident" id="6987639"><a href="/gostd/image/jpeg/reader_test.go.html#6987355">stride0</a></span>&nbsp;<span class="op" id="6987647">&amp;&amp;</span>&nbsp;<span class="ident" id="6987650"><a href="/gostd/image/jpeg/reader_test.go.html#6987617">y</a></span>&nbsp;<span class="op" id="6987652">&lt;</span>&nbsp;<span class="builtinfunc" id="6987654">len</span><span class="op" id="6987657">(</span><span class="ident" id="6987658"><a href="/gostd/image/jpeg/reader_test.go.html#6987342">pix1</a></span><span class="op" id="6987662">)</span><span class="op" id="6987663">/</span><span class="ident" id="6987664"><a href="/gostd/image/jpeg/reader_test.go.html#6987364">stride1</a></span><span class="op" id="6987671">;</span>&nbsp;<span class="ident" id="6987673"><a href="/gostd/image/jpeg/reader_test.go.html#6987617">y</a></span>&nbsp;<span class="op" id="6987675">+=</span>&nbsp;<span class="num" id="6987678">8</span>&nbsp;<span class="op" id="6987680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6987684">for</span>&nbsp;<span class="ident" id="6987688">x</span>&nbsp;<span class="op" id="6987690">:=</span>&nbsp;<span class="num" id="6987693">0</span><span class="op" id="6987694">;</span>&nbsp;<span class="ident" id="6987696"><a href="/gostd/image/jpeg/reader_test.go.html#6987688">x</a></span>&nbsp;<span class="op" id="6987698">&lt;</span>&nbsp;<span class="ident" id="6987700"><a href="/gostd/image/jpeg/reader_test.go.html#6987355">stride0</a></span>&nbsp;<span class="op" id="6987708">&amp;&amp;</span>&nbsp;<span class="ident" id="6987711"><a href="/gostd/image/jpeg/reader_test.go.html#6987688">x</a></span>&nbsp;<span class="op" id="6987713">&lt;</span>&nbsp;<span class="ident" id="6987715"><a href="/gostd/image/jpeg/reader_test.go.html#6987364">stride1</a></span><span class="op" id="6987722">;</span>&nbsp;<span class="ident" id="6987724"><a href="/gostd/image/jpeg/reader_test.go.html#6987688">x</a></span>&nbsp;<span class="op" id="6987726">+=</span>&nbsp;<span class="num" id="6987729">8</span>&nbsp;<span class="op" id="6987731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6987736">if</span>&nbsp;<span class="ident" id="6987739"><a href="/gostd/image/jpeg/reader_test.go.html#6987688">x</a></span>&nbsp;<span class="op" id="6987741">&gt;=</span>&nbsp;<span class="ident" id="6987744"><a href="/gostd/image/jpeg/reader_test.go.html#6987312">bounds</a></span><span class="op" id="6987750">.</span><span class="ident" id="6987751"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="6987754">.</span><span class="ident" id="6987755"><a href="/gostd/image/geom.go.html#5148451">X</a></span>&nbsp;<span class="op" id="6987757">||</span>&nbsp;<span class="ident" id="6987760"><a href="/gostd/image/jpeg/reader_test.go.html#6987617">y</a></span>&nbsp;<span class="op" id="6987762">&gt;=</span>&nbsp;<span class="ident" id="6987765"><a href="/gostd/image/jpeg/reader_test.go.html#6987312">bounds</a></span><span class="op" id="6987771">.</span><span class="ident" id="6987772"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="6987775">.</span><span class="ident" id="6987776"><a href="/gostd/image/geom.go.html#5148454">Y</a></span>&nbsp;<span class="op" id="6987778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6987784">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;if&nbsp;the&nbsp;two&nbsp;pix&nbsp;data&nbsp;differ&nbsp;if&nbsp;the&nbsp;8x8&nbsp;block&nbsp;is</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6987852">//&nbsp;entirely&nbsp;outside&nbsp;of&nbsp;the&nbsp;image&#39;s&nbsp;bounds.&nbsp;For&nbsp;example,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6987921">//&nbsp;occur&nbsp;with&nbsp;a&nbsp;4:2:0&nbsp;chroma&nbsp;subsampling&nbsp;and&nbsp;a&nbsp;1x1&nbsp;image.&nbsp;Baseline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6987992">//&nbsp;decoding&nbsp;works&nbsp;on&nbsp;the&nbsp;one&nbsp;16x16&nbsp;MCU&nbsp;as&nbsp;a&nbsp;whole;&nbsp;progressive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6988059">//&nbsp;decoding&#39;s&nbsp;first&nbsp;pass&nbsp;works&nbsp;on&nbsp;that&nbsp;16x16&nbsp;MCU&nbsp;as&nbsp;a&nbsp;whole&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6988127">//&nbsp;refinement&nbsp;passes&nbsp;only&nbsp;process&nbsp;one&nbsp;8x8&nbsp;block&nbsp;within&nbsp;the&nbsp;MCU.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6988195">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6988207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6988213">for</span>&nbsp;<span class="ident" id="6988217">j</span>&nbsp;<span class="op" id="6988219">:=</span>&nbsp;<span class="num" id="6988222">0</span><span class="op" id="6988223">;</span>&nbsp;<span class="ident" id="6988225"><a href="/gostd/image/jpeg/reader_test.go.html#6988217">j</a></span>&nbsp;<span class="op" id="6988227">&lt;</span>&nbsp;<span class="num" id="6988229">8</span><span class="op" id="6988230">;</span>&nbsp;<span class="ident" id="6988232"><a href="/gostd/image/jpeg/reader_test.go.html#6988217">j</a></span><span class="op" id="6988233">++</span>&nbsp;<span class="op" id="6988236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6988242">for</span>&nbsp;<span class="ident" id="6988246">i</span>&nbsp;<span class="op" id="6988248">:=</span>&nbsp;<span class="num" id="6988251">0</span><span class="op" id="6988252">;</span>&nbsp;<span class="ident" id="6988254"><a href="/gostd/image/jpeg/reader_test.go.html#6988246">i</a></span>&nbsp;<span class="op" id="6988256">&lt;</span>&nbsp;<span class="num" id="6988258">8</span><span class="op" id="6988259">;</span>&nbsp;<span class="ident" id="6988261"><a href="/gostd/image/jpeg/reader_test.go.html#6988246">i</a></span><span class="op" id="6988262">++</span>&nbsp;<span class="op" id="6988265">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988272">index0</span>&nbsp;<span class="op" id="6988279">:=</span>&nbsp;<span class="op" id="6988282">(</span><span class="ident" id="6988283"><a href="/gostd/image/jpeg/reader_test.go.html#6987617">y</a></span><span class="op" id="6988284">+</span><span class="ident" id="6988285"><a href="/gostd/image/jpeg/reader_test.go.html#6988217">j</a></span><span class="op" id="6988286">)</span><span class="op" id="6988287">*</span><span class="ident" id="6988288"><a href="/gostd/image/jpeg/reader_test.go.html#6987355">stride0</a></span>&nbsp;<span class="op" id="6988296">+</span>&nbsp;<span class="op" id="6988298">(</span><span class="ident" id="6988299"><a href="/gostd/image/jpeg/reader_test.go.html#6987688">x</a></span>&nbsp;<span class="op" id="6988301">+</span>&nbsp;<span class="ident" id="6988303"><a href="/gostd/image/jpeg/reader_test.go.html#6988246">i</a></span><span class="op" id="6988304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988311">index1</span>&nbsp;<span class="op" id="6988318">:=</span>&nbsp;<span class="op" id="6988321">(</span><span class="ident" id="6988322"><a href="/gostd/image/jpeg/reader_test.go.html#6987617">y</a></span><span class="op" id="6988323">+</span><span class="ident" id="6988324"><a href="/gostd/image/jpeg/reader_test.go.html#6988217">j</a></span><span class="op" id="6988325">)</span><span class="op" id="6988326">*</span><span class="ident" id="6988327"><a href="/gostd/image/jpeg/reader_test.go.html#6987364">stride1</a></span>&nbsp;<span class="op" id="6988335">+</span>&nbsp;<span class="op" id="6988337">(</span><span class="ident" id="6988338"><a href="/gostd/image/jpeg/reader_test.go.html#6987688">x</a></span>&nbsp;<span class="op" id="6988340">+</span>&nbsp;<span class="ident" id="6988342"><a href="/gostd/image/jpeg/reader_test.go.html#6988246">i</a></span><span class="op" id="6988343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6988350">if</span>&nbsp;<span class="ident" id="6988353"><a href="/gostd/image/jpeg/reader_test.go.html#6987336">pix0</a></span><span class="op" id="6988357">[</span><span class="ident" id="6988358"><a href="/gostd/image/jpeg/reader_test.go.html#6988272">index0</a></span><span class="op" id="6988364">]</span>&nbsp;<span class="op" id="6988366">!=</span>&nbsp;<span class="ident" id="6988369"><a href="/gostd/image/jpeg/reader_test.go.html#6987342">pix1</a></span><span class="op" id="6988373">[</span><span class="ident" id="6988374"><a href="/gostd/image/jpeg/reader_test.go.html#6988311">index1</a></span><span class="op" id="6988380">]</span>&nbsp;<span class="op" id="6988382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6988390">return</span>&nbsp;<span class="ident" id="6988397"><a href="/gostd/image/jpeg/reader_test.go.html#6984162">fmt</a></span><span class="op" id="6988400">.</span><span class="ident" id="6988401"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="6988407">(</span><span class="string" id="6988408">&#34;blocks&nbsp;at&nbsp;(%d,&nbsp;%d)&nbsp;differ:\n%sand\n%s&#34;</span><span class="op" id="6988447">,</span>&nbsp;<span class="ident" id="6988449"><a href="/gostd/image/jpeg/reader_test.go.html#6987688">x</a></span><span class="op" id="6988450">,</span>&nbsp;<span class="ident" id="6988452"><a href="/gostd/image/jpeg/reader_test.go.html#6987617">y</a></span><span class="op" id="6988453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988462"><a href="/gostd/image/jpeg/reader_test.go.html#6988586">pixString</a></span><span class="op" id="6988471">(</span><span class="ident" id="6988472"><a href="/gostd/image/jpeg/reader_test.go.html#6987336">pix0</a></span><span class="op" id="6988476">,</span>&nbsp;<span class="ident" id="6988478"><a href="/gostd/image/jpeg/reader_test.go.html#6987355">stride0</a></span><span class="op" id="6988485">,</span>&nbsp;<span class="ident" id="6988487"><a href="/gostd/image/jpeg/reader_test.go.html#6987688">x</a></span><span class="op" id="6988488">,</span>&nbsp;<span class="ident" id="6988490"><a href="/gostd/image/jpeg/reader_test.go.html#6987617">y</a></span><span class="op" id="6988491">)</span><span class="op" id="6988492">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988501"><a href="/gostd/image/jpeg/reader_test.go.html#6988586">pixString</a></span><span class="op" id="6988510">(</span><span class="ident" id="6988511"><a href="/gostd/image/jpeg/reader_test.go.html#6987342">pix1</a></span><span class="op" id="6988515">,</span>&nbsp;<span class="ident" id="6988517"><a href="/gostd/image/jpeg/reader_test.go.html#6987364">stride1</a></span><span class="op" id="6988524">,</span>&nbsp;<span class="ident" id="6988526"><a href="/gostd/image/jpeg/reader_test.go.html#6987688">x</a></span><span class="op" id="6988527">,</span>&nbsp;<span class="ident" id="6988529"><a href="/gostd/image/jpeg/reader_test.go.html#6987617">y</a></span><span class="op" id="6988530">)</span><span class="op" id="6988531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6988539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6988546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6988552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6988557">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6988561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6988564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6988567">return</span>&nbsp;<span class="builtintype" id="6988574">nil</span><br>
<span class="lineno"></span><span class="op" id="6988578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6988581">func</span>&nbsp;<span class="ident" id="6988586">pixString</span><span class="op" id="6988595">(</span><span class="ident" id="6988596">pix</span>&nbsp;<span class="op" id="6988600">[</span><span class="op" id="6988601">]</span><span class="builtintype" id="6988602">byte</span><span class="op" id="6988606">,</span>&nbsp;<span class="ident" id="6988608">stride</span><span class="op" id="6988614">,</span>&nbsp;<span class="ident" id="6988616">x</span><span class="op" id="6988617">,</span>&nbsp;<span class="ident" id="6988619">y</span>&nbsp;<span class="builtintype" id="6988621">int</span><span class="op" id="6988624">)</span>&nbsp;<span class="builtintype" id="6988626">string</span>&nbsp;<span class="op" id="6988633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988636">s</span>&nbsp;<span class="op" id="6988638">:=</span>&nbsp;<span class="ident" id="6988641"><a href="/gostd/image/jpeg/reader_test.go.html#6984153">bytes</a></span><span class="op" id="6988646">.</span><span class="ident" id="6988647"><a href="/gostd/bytes/buffer.go.html#1395573">NewBuffer</a></span><span class="op" id="6988656">(</span><span class="builtintype" id="6988657">nil</span><span class="op" id="6988660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6988663">for</span>&nbsp;<span class="ident" id="6988667">j</span>&nbsp;<span class="op" id="6988669">:=</span>&nbsp;<span class="num" id="6988672">0</span><span class="op" id="6988673">;</span>&nbsp;<span class="ident" id="6988675"><a href="/gostd/image/jpeg/reader_test.go.html#6988667">j</a></span>&nbsp;<span class="op" id="6988677">&lt;</span>&nbsp;<span class="num" id="6988679">8</span><span class="op" id="6988680">;</span>&nbsp;<span class="ident" id="6988682"><a href="/gostd/image/jpeg/reader_test.go.html#6988667">j</a></span><span class="op" id="6988683">++</span>&nbsp;<span class="op" id="6988686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988690"><a href="/gostd/image/jpeg/reader_test.go.html#6984162">fmt</a></span><span class="op" id="6988693">.</span><span class="ident" id="6988694"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="6988701">(</span><span class="ident" id="6988702"><a href="/gostd/image/jpeg/reader_test.go.html#6988636">s</a></span><span class="op" id="6988703">,</span>&nbsp;<span class="string" id="6988705">&#34;\t&#34;</span><span class="op" id="6988709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6988713">for</span>&nbsp;<span class="ident" id="6988717">i</span>&nbsp;<span class="op" id="6988719">:=</span>&nbsp;<span class="num" id="6988722">0</span><span class="op" id="6988723">;</span>&nbsp;<span class="ident" id="6988725"><a href="/gostd/image/jpeg/reader_test.go.html#6988717">i</a></span>&nbsp;<span class="op" id="6988727">&lt;</span>&nbsp;<span class="num" id="6988729">8</span><span class="op" id="6988730">;</span>&nbsp;<span class="ident" id="6988732"><a href="/gostd/image/jpeg/reader_test.go.html#6988717">i</a></span><span class="op" id="6988733">++</span>&nbsp;<span class="op" id="6988736">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988741"><a href="/gostd/image/jpeg/reader_test.go.html#6984162">fmt</a></span><span class="op" id="6988744">.</span><span class="ident" id="6988745"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="6988752">(</span><span class="ident" id="6988753"><a href="/gostd/image/jpeg/reader_test.go.html#6988636">s</a></span><span class="op" id="6988754">,</span>&nbsp;<span class="string" id="6988756">&#34;%02x&nbsp;&#34;</span><span class="op" id="6988763">,</span>&nbsp;<span class="ident" id="6988765"><a href="/gostd/image/jpeg/reader_test.go.html#6988596">pix</a></span><span class="op" id="6988768">[</span><span class="op" id="6988769">(</span><span class="ident" id="6988770"><a href="/gostd/image/jpeg/reader_test.go.html#6988619">y</a></span><span class="op" id="6988771">+</span><span class="ident" id="6988772"><a href="/gostd/image/jpeg/reader_test.go.html#6988667">j</a></span><span class="op" id="6988773">)</span><span class="op" id="6988774">*</span><span class="ident" id="6988775"><a href="/gostd/image/jpeg/reader_test.go.html#6988608">stride</a></span><span class="op" id="6988781">+</span><span class="op" id="6988782">(</span><span class="ident" id="6988783"><a href="/gostd/image/jpeg/reader_test.go.html#6988616">x</a></span><span class="op" id="6988784">+</span><span class="ident" id="6988785"><a href="/gostd/image/jpeg/reader_test.go.html#6988717">i</a></span><span class="op" id="6988786">)</span><span class="op" id="6988787">]</span><span class="op" id="6988788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6988792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988796"><a href="/gostd/image/jpeg/reader_test.go.html#6984162">fmt</a></span><span class="op" id="6988799">.</span><span class="ident" id="6988800"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="6988807">(</span><span class="ident" id="6988808"><a href="/gostd/image/jpeg/reader_test.go.html#6988636">s</a></span><span class="op" id="6988809">,</span>&nbsp;<span class="string" id="6988811">&#34;\n&#34;</span><span class="op" id="6988815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6988818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6988821">return</span>&nbsp;<span class="ident" id="6988828"><a href="/gostd/image/jpeg/reader_test.go.html#6988636">s</a></span><span class="op" id="6988829">.</span><span class="ident" id="6988830"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6988836">(</span><span class="op" id="6988837">)</span><br>
<span class="lineno">185</span><span class="op" id="6988839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6988842">func</span>&nbsp;<span class="ident" id="6988847">TestExtraneousData</span><span class="op" id="6988865">(</span><span class="ident" id="6988866">t</span>&nbsp;<span class="op" id="6988868">*</span><span class="ident" id="6988869"><a href="/gostd/image/jpeg/reader_test.go.html#6984242">testing</a></span><span class="op" id="6988876">.</span><span class="ident" id="6988877"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6988878">)</span>&nbsp;<span class="op" id="6988880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6988883">//&nbsp;Encode&nbsp;a&nbsp;1x1&nbsp;red&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988911">src</span>&nbsp;<span class="op" id="6988915">:=</span>&nbsp;<span class="ident" id="6988918"><a href="/gostd/image/jpeg/reader_test.go.html#6984169">image</a></span><span class="op" id="6988923">.</span><span class="ident" id="6988924"><a href="/gostd/image/image.go.html#5158226">NewRGBA</a></span><span class="op" id="6988931">(</span><span class="ident" id="6988932"><a href="/gostd/image/jpeg/reader_test.go.html#6984169">image</a></span><span class="op" id="6988937">.</span><span class="ident" id="6988938"><a href="/gostd/image/geom.go.html#5153452">Rect</a></span><span class="op" id="6988942">(</span><span class="num" id="6988943">0</span><span class="op" id="6988944">,</span>&nbsp;<span class="num" id="6988946">0</span><span class="op" id="6988947">,</span>&nbsp;<span class="num" id="6988949">1</span><span class="op" id="6988950">,</span>&nbsp;<span class="num" id="6988952">1</span><span class="op" id="6988953">)</span><span class="op" id="6988954">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6988957"><a href="/gostd/image/jpeg/reader_test.go.html#6988911">src</a></span><span class="op" id="6988960">.</span><span class="ident" id="6988961"><a href="/gostd/image/image.go.html#5156818">Set</a></span><span class="op" id="6988964">(</span><span class="num" id="6988965">0</span><span class="op" id="6988966">,</span>&nbsp;<span class="num" id="6988968">0</span><span class="op" id="6988969">,</span>&nbsp;<span class="ident" id="6988971"><a href="/gostd/image/jpeg/reader_test.go.html#6984178">color</a></span><span class="op" id="6988976">.</span><span class="ident" id="6988977"><a href="/gostd/image/color/color.go.html#5185612">RGBA</a></span><span class="op" id="6988981">{</span><span class="num" id="6988982">0xff</span><span class="op" id="6988986">,</span>&nbsp;<span class="num" id="6988988">0x00</span><span class="op" id="6988992">,</span>&nbsp;<span class="num" id="6988994">0x00</span><span class="op" id="6988998">,</span>&nbsp;<span class="num" id="6989000">0xff</span><span class="op" id="6989004">}</span><span class="op" id="6989005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6989008">buf</span>&nbsp;<span class="op" id="6989012">:=</span>&nbsp;<span class="builtinfunc" id="6989015">new</span><span class="op" id="6989018">(</span><span class="ident" id="6989019"><a href="/gostd/image/jpeg/reader_test.go.html#6984153">bytes</a></span><span class="op" id="6989024">.</span><span class="ident" id="6989025"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="6989031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6989034">if</span>&nbsp;<span class="ident" id="6989037">err</span>&nbsp;<span class="op" id="6989041">:=</span>&nbsp;<span class="ident" id="6989044"><a href="/gostd/image/jpeg/writer.go.html#5143795">Encode</a></span><span class="op" id="6989050">(</span><span class="ident" id="6989051"><a href="/gostd/image/jpeg/reader_test.go.html#6989008">buf</a></span><span class="op" id="6989054">,</span>&nbsp;<span class="ident" id="6989056"><a href="/gostd/image/jpeg/reader_test.go.html#6988911">src</a></span><span class="op" id="6989059">,</span>&nbsp;<span class="builtintype" id="6989061">nil</span><span class="op" id="6989064">)</span><span class="op" id="6989065">;</span>&nbsp;<span class="ident" id="6989067"><a href="/gostd/image/jpeg/reader_test.go.html#6989037">err</a></span>&nbsp;<span class="op" id="6989071">!=</span>&nbsp;<span class="builtintype" id="6989074">nil</span>&nbsp;<span class="op" id="6989078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6989082"><a href="/gostd/image/jpeg/reader_test.go.html#6988866">t</a></span><span class="op" id="6989083">.</span><span class="ident" id="6989084"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6989090">(</span><span class="string" id="6989091">&#34;encode:&nbsp;%v&#34;</span><span class="op" id="6989103">,</span>&nbsp;<span class="ident" id="6989105"><a href="/gostd/image/jpeg/reader_test.go.html#6989037">err</a></span><span class="op" id="6989108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6989111">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6989114">enc</span>&nbsp;<span class="op" id="6989118">:=</span>&nbsp;<span class="ident" id="6989121"><a href="/gostd/image/jpeg/reader_test.go.html#6989008">buf</a></span><span class="op" id="6989124">.</span><span class="ident" id="6989125"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6989131">(</span><span class="op" id="6989132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6989135">//&nbsp;Sanity&nbsp;check&nbsp;that&nbsp;the&nbsp;encoded&nbsp;JPEG&nbsp;is&nbsp;long&nbsp;enough,&nbsp;that&nbsp;it&nbsp;ends&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6989208">//&nbsp;&#34;\xff\xd9&#34;&nbsp;EOI&nbsp;marker,&nbsp;and&nbsp;that&nbsp;it&nbsp;contains&nbsp;a&nbsp;&#34;\xff\xda&#34;&nbsp;SOS&nbsp;marker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6989280">//&nbsp;somewhere&nbsp;in&nbsp;the&nbsp;final&nbsp;64&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6989317">if</span>&nbsp;<span class="builtinfunc" id="6989320">len</span><span class="op" id="6989323">(</span><span class="ident" id="6989324"><a href="/gostd/image/jpeg/reader_test.go.html#6989114">enc</a></span><span class="op" id="6989327">)</span>&nbsp;<span class="op" id="6989329">&lt;</span>&nbsp;<span class="num" id="6989331">64</span>&nbsp;<span class="op" id="6989334">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6989338"><a href="/gostd/image/jpeg/reader_test.go.html#6988866">t</a></span><span class="op" id="6989339">.</span><span class="ident" id="6989340"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6989346">(</span><span class="string" id="6989347">&#34;encoded&nbsp;JPEG&nbsp;is&nbsp;too&nbsp;short:&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="6989384">,</span>&nbsp;<span class="builtinfunc" id="6989386">len</span><span class="op" id="6989389">(</span><span class="ident" id="6989390"><a href="/gostd/image/jpeg/reader_test.go.html#6989114">enc</a></span><span class="op" id="6989393">)</span><span class="op" id="6989394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6989397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6989400">if</span>&nbsp;<span class="ident" id="6989403">got</span><span class="op" id="6989406">,</span>&nbsp;<span class="ident" id="6989408">want</span>&nbsp;<span class="op" id="6989413">:=</span>&nbsp;<span class="ident" id="6989416"><a href="/gostd/image/jpeg/reader_test.go.html#6989114">enc</a></span><span class="op" id="6989419">[</span><span class="builtinfunc" id="6989420">len</span><span class="op" id="6989423">(</span><span class="ident" id="6989424"><a href="/gostd/image/jpeg/reader_test.go.html#6989114">enc</a></span><span class="op" id="6989427">)</span><span class="op" id="6989428">-</span><span class="num" id="6989429">2</span><span class="op" id="6989430">:</span><span class="op" id="6989431">]</span><span class="op" id="6989432">,</span>&nbsp;<span class="string" id="6989434">&#34;\xff\xd9&#34;</span><span class="op" id="6989444">;</span>&nbsp;<span class="ident" id="6989446"><a href="/gostd/image/jpeg/reader_test.go.html#6989403">got</a></span>&nbsp;<span class="op" id="6989450">!=</span>&nbsp;<span class="ident" id="6989453"><a href="/gostd/image/jpeg/reader_test.go.html#6989408">want</a></span>&nbsp;<span class="op" id="6989458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6989462"><a href="/gostd/image/jpeg/reader_test.go.html#6988866">t</a></span><span class="op" id="6989463">.</span><span class="ident" id="6989464"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6989470">(</span><span class="string" id="6989471">&#34;encoded&nbsp;JPEG&nbsp;ends&nbsp;with&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6989507">,</span>&nbsp;<span class="ident" id="6989509"><a href="/gostd/image/jpeg/reader_test.go.html#6989403">got</a></span><span class="op" id="6989512">,</span>&nbsp;<span class="ident" id="6989514"><a href="/gostd/image/jpeg/reader_test.go.html#6989408">want</a></span><span class="op" id="6989518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6989521">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6989524">if</span>&nbsp;<span class="ident" id="6989527">s</span>&nbsp;<span class="op" id="6989529">:=</span>&nbsp;<span class="ident" id="6989532"><a href="/gostd/image/jpeg/reader_test.go.html#6989114">enc</a></span><span class="op" id="6989535">[</span><span class="builtinfunc" id="6989536">len</span><span class="op" id="6989539">(</span><span class="ident" id="6989540"><a href="/gostd/image/jpeg/reader_test.go.html#6989114">enc</a></span><span class="op" id="6989543">)</span><span class="op" id="6989544">-</span><span class="num" id="6989545">64</span><span class="op" id="6989547">:</span><span class="op" id="6989548">]</span><span class="op" id="6989549">;</span>&nbsp;<span class="op" id="6989551">!</span><span class="ident" id="6989552"><a href="/gostd/image/jpeg/reader_test.go.html#6984231">strings</a></span><span class="op" id="6989559">.</span><span class="ident" id="6989560"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="6989568">(</span><span class="ident" id="6989569"><a href="/gostd/image/jpeg/reader_test.go.html#6989527">s</a></span><span class="op" id="6989570">,</span>&nbsp;<span class="string" id="6989572">&#34;\xff\xda&#34;</span><span class="op" id="6989582">)</span>&nbsp;<span class="op" id="6989584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6989588"><a href="/gostd/image/jpeg/reader_test.go.html#6988866">t</a></span><span class="op" id="6989589">.</span><span class="ident" id="6989590"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6989596">(</span><span class="string" id="6989597">&#34;encoded&nbsp;JPEG&nbsp;does&nbsp;not&nbsp;contain&nbsp;a&nbsp;SOS&nbsp;marker&nbsp;(ff&nbsp;da)&nbsp;near&nbsp;the&nbsp;end:&nbsp;%&nbsp;x&#34;</span><span class="op" id="6989667">,</span>&nbsp;<span class="ident" id="6989669"><a href="/gostd/image/jpeg/reader_test.go.html#6989527">s</a></span><span class="op" id="6989670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6989673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6989676">//&nbsp;Test&nbsp;that&nbsp;adding&nbsp;some&nbsp;random&nbsp;junk&nbsp;between&nbsp;the&nbsp;SOS&nbsp;marker&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6989745">//&nbsp;EOI&nbsp;marker&nbsp;does&nbsp;not&nbsp;affect&nbsp;the&nbsp;decoding.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6989790">rnd</span>&nbsp;<span class="op" id="6989794">:=</span>&nbsp;<span class="ident" id="6989797"><a href="/gostd/image/jpeg/reader_test.go.html#6984212">rand</a></span><span class="op" id="6989801">.</span><span class="ident" id="6989802"><a href="/gostd/math/rand/rand.go.html#2922124">New</a></span><span class="op" id="6989805">(</span><span class="ident" id="6989806"><a href="/gostd/image/jpeg/reader_test.go.html#6984212">rand</a></span><span class="op" id="6989810">.</span><span class="ident" id="6989811"><a href="/gostd/math/rand/rand.go.html#2921867">NewSource</a></span><span class="op" id="6989820">(</span><span class="num" id="6989821">1</span><span class="op" id="6989822">)</span><span class="op" id="6989823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6989826">for</span>&nbsp;<span class="ident" id="6989830">i</span><span class="op" id="6989831">,</span>&nbsp;<span class="ident" id="6989833">nerr</span>&nbsp;<span class="op" id="6989838">:=</span>&nbsp;<span class="num" id="6989841">0</span><span class="op" id="6989842">,</span>&nbsp;<span class="num" id="6989844">0</span><span class="op" id="6989845">;</span>&nbsp;<span class="ident" id="6989847"><a href="/gostd/image/jpeg/reader_test.go.html#6989830">i</a></span>&nbsp;<span class="op" id="6989849">&lt;</span>&nbsp;<span class="num" id="6989851">1000</span>&nbsp;<span class="op" id="6989856">&amp;&amp;</span>&nbsp;<span class="ident" id="6989859"><a href="/gostd/image/jpeg/reader_test.go.html#6989833">nerr</a></span>&nbsp;<span class="op" id="6989864">&lt;</span>&nbsp;<span class="num" id="6989866">10</span><span class="op" id="6989868">;</span>&nbsp;<span class="ident" id="6989870"><a href="/gostd/image/jpeg/reader_test.go.html#6989830">i</a></span><span class="op" id="6989871">++</span>&nbsp;<span class="op" id="6989874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6989878"><a href="/gostd/image/jpeg/reader_test.go.html#6989008">buf</a></span><span class="op" id="6989881">.</span><span class="ident" id="6989882"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="6989887">(</span><span class="op" id="6989888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6989892">//&nbsp;Write&nbsp;all&nbsp;but&nbsp;the&nbsp;trailing&nbsp;&#34;\xff\xd9&#34;&nbsp;EOI&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6989947"><a href="/gostd/image/jpeg/reader_test.go.html#6989008">buf</a></span><span class="op" id="6989950">.</span><span class="ident" id="6989951"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="6989962">(</span><span class="ident" id="6989963"><a href="/gostd/image/jpeg/reader_test.go.html#6989114">enc</a></span><span class="op" id="6989966">[</span><span class="op" id="6989967">:</span><span class="builtinfunc" id="6989968">len</span><span class="op" id="6989971">(</span><span class="ident" id="6989972"><a href="/gostd/image/jpeg/reader_test.go.html#6989114">enc</a></span><span class="op" id="6989975">)</span><span class="op" id="6989976">-</span><span class="num" id="6989977">2</span><span class="op" id="6989978">]</span><span class="op" id="6989979">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6989983">//&nbsp;Write&nbsp;some&nbsp;random&nbsp;extraneous&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990023">for</span>&nbsp;<span class="ident" id="6990027">n</span>&nbsp;<span class="op" id="6990029">:=</span>&nbsp;<span class="ident" id="6990032"><a href="/gostd/image/jpeg/reader_test.go.html#6989790">rnd</a></span><span class="op" id="6990035">.</span><span class="ident" id="6990036"><a href="/gostd/math/rand/rand.go.html#2923767">Intn</a></span><span class="op" id="6990040">(</span><span class="num" id="6990041">10</span><span class="op" id="6990043">)</span><span class="op" id="6990044">;</span>&nbsp;<span class="ident" id="6990046"><a href="/gostd/image/jpeg/reader_test.go.html#6990027">n</a></span>&nbsp;<span class="op" id="6990048">&gt;</span>&nbsp;<span class="num" id="6990050">0</span><span class="op" id="6990051">;</span>&nbsp;<span class="ident" id="6990053"><a href="/gostd/image/jpeg/reader_test.go.html#6990027">n</a></span><span class="op" id="6990054">--</span>&nbsp;<span class="op" id="6990057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990062">if</span>&nbsp;<span class="ident" id="6990065">x</span>&nbsp;<span class="op" id="6990067">:=</span>&nbsp;<span class="builtintype" id="6990070">byte</span><span class="op" id="6990074">(</span><span class="ident" id="6990075"><a href="/gostd/image/jpeg/reader_test.go.html#6989790">rnd</a></span><span class="op" id="6990078">.</span><span class="ident" id="6990079"><a href="/gostd/math/rand/rand.go.html#2923767">Intn</a></span><span class="op" id="6990083">(</span><span class="num" id="6990084">256</span><span class="op" id="6990087">)</span><span class="op" id="6990088">)</span><span class="op" id="6990089">;</span>&nbsp;<span class="ident" id="6990091"><a href="/gostd/image/jpeg/reader_test.go.html#6990065">x</a></span>&nbsp;<span class="op" id="6990093">!=</span>&nbsp;<span class="num" id="6990096">0xff</span>&nbsp;<span class="op" id="6990101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990107"><a href="/gostd/image/jpeg/reader_test.go.html#6989008">buf</a></span><span class="op" id="6990110">.</span><span class="ident" id="6990111"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="6990120">(</span><span class="ident" id="6990121"><a href="/gostd/image/jpeg/reader_test.go.html#6990065">x</a></span><span class="op" id="6990122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6990127">}</span>&nbsp;<span class="keyword" id="6990129">else</span>&nbsp;<span class="op" id="6990134">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6990140">//&nbsp;The&nbsp;JPEG&nbsp;format&nbsp;escapes&nbsp;a&nbsp;SOS&nbsp;0xff&nbsp;data&nbsp;byte&nbsp;as&nbsp;&#34;\xff\x00&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990207"><a href="/gostd/image/jpeg/reader_test.go.html#6989008">buf</a></span><span class="op" id="6990210">.</span><span class="ident" id="6990211"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="6990222">(</span><span class="string" id="6990223">&#34;\xff\x00&#34;</span><span class="op" id="6990233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6990238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6990242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6990246">//&nbsp;Write&nbsp;the&nbsp;&#34;\xff\xd9&#34;&nbsp;EOI&nbsp;marker.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990284"><a href="/gostd/image/jpeg/reader_test.go.html#6989008">buf</a></span><span class="op" id="6990287">.</span><span class="ident" id="6990288"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="6990299">(</span><span class="string" id="6990300">&#34;\xff\xd9&#34;</span><span class="op" id="6990310">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6990315">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;can&nbsp;still&nbsp;decode&nbsp;the&nbsp;resultant&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990372">got</span><span class="op" id="6990375">,</span>&nbsp;<span class="ident" id="6990377">err</span>&nbsp;<span class="op" id="6990381">:=</span>&nbsp;<span class="ident" id="6990384"><a href="/gostd/image/jpeg/reader.go.html#5114879">Decode</a></span><span class="op" id="6990390">(</span><span class="ident" id="6990391"><a href="/gostd/image/jpeg/reader_test.go.html#6989008">buf</a></span><span class="op" id="6990394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990398">if</span>&nbsp;<span class="ident" id="6990401"><a href="/gostd/image/jpeg/reader_test.go.html#6990377">err</a></span>&nbsp;<span class="op" id="6990405">!=</span>&nbsp;<span class="builtintype" id="6990408">nil</span>&nbsp;<span class="op" id="6990412">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990417"><a href="/gostd/image/jpeg/reader_test.go.html#6988866">t</a></span><span class="op" id="6990418">.</span><span class="ident" id="6990419"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6990425">(</span><span class="string" id="6990426">&#34;could&nbsp;not&nbsp;decode&nbsp;image&nbsp;#%d:&nbsp;%v&#34;</span><span class="op" id="6990458">,</span>&nbsp;<span class="ident" id="6990460"><a href="/gostd/image/jpeg/reader_test.go.html#6989830">i</a></span><span class="op" id="6990461">,</span>&nbsp;<span class="ident" id="6990463"><a href="/gostd/image/jpeg/reader_test.go.html#6990377">err</a></span><span class="op" id="6990466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990471"><a href="/gostd/image/jpeg/reader_test.go.html#6989833">nerr</a></span><span class="op" id="6990475">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990481">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6990492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990496">if</span>&nbsp;<span class="ident" id="6990499"><a href="/gostd/image/jpeg/reader_test.go.html#6990372">got</a></span><span class="op" id="6990502">.</span><span class="ident" id="6990503"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="6990509">(</span><span class="op" id="6990510">)</span>&nbsp;<span class="op" id="6990512">!=</span>&nbsp;<span class="ident" id="6990515"><a href="/gostd/image/jpeg/reader_test.go.html#6988911">src</a></span><span class="op" id="6990518">.</span><span class="ident" id="6990519"><a href="/gostd/image/image.go.html#5156299">Bounds</a></span><span class="op" id="6990525">(</span><span class="op" id="6990526">)</span>&nbsp;<span class="op" id="6990528">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990533"><a href="/gostd/image/jpeg/reader_test.go.html#6988866">t</a></span><span class="op" id="6990534">.</span><span class="ident" id="6990535"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6990541">(</span><span class="string" id="6990542">&#34;image&nbsp;#%d,&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="6990579">,</span>&nbsp;<span class="ident" id="6990581"><a href="/gostd/image/jpeg/reader_test.go.html#6989830">i</a></span><span class="op" id="6990582">,</span>&nbsp;<span class="ident" id="6990584"><a href="/gostd/image/jpeg/reader_test.go.html#6990372">got</a></span><span class="op" id="6990587">.</span><span class="ident" id="6990588"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="6990594">(</span><span class="op" id="6990595">)</span><span class="op" id="6990596">,</span>&nbsp;<span class="ident" id="6990598"><a href="/gostd/image/jpeg/reader_test.go.html#6988911">src</a></span><span class="op" id="6990601">.</span><span class="ident" id="6990602"><a href="/gostd/image/image.go.html#5156299">Bounds</a></span><span class="op" id="6990608">(</span><span class="op" id="6990609">)</span><span class="op" id="6990610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990615"><a href="/gostd/image/jpeg/reader_test.go.html#6989833">nerr</a></span><span class="op" id="6990619">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990625">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6990636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990640">if</span>&nbsp;<span class="ident" id="6990643"><a href="/gostd/image/jpeg/writer_test.go.html#6996219">averageDelta</a></span><span class="op" id="6990655">(</span><span class="ident" id="6990656"><a href="/gostd/image/jpeg/reader_test.go.html#6990372">got</a></span><span class="op" id="6990659">,</span>&nbsp;<span class="ident" id="6990661"><a href="/gostd/image/jpeg/reader_test.go.html#6988911">src</a></span><span class="op" id="6990664">)</span>&nbsp;<span class="op" id="6990666">&gt;</span>&nbsp;<span class="num" id="6990668">2</span><span class="op" id="6990669">&lt;&lt;</span><span class="num" id="6990671">8</span>&nbsp;<span class="op" id="6990673">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990678"><a href="/gostd/image/jpeg/reader_test.go.html#6988866">t</a></span><span class="op" id="6990679">.</span><span class="ident" id="6990680"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6990686">(</span><span class="string" id="6990687">&#34;image&nbsp;#%d&nbsp;changed&nbsp;too&nbsp;much&nbsp;after&nbsp;a&nbsp;round&nbsp;trip&#34;</span><span class="op" id="6990734">,</span>&nbsp;<span class="ident" id="6990736"><a href="/gostd/image/jpeg/reader_test.go.html#6989830">i</a></span><span class="op" id="6990737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990742"><a href="/gostd/image/jpeg/reader_test.go.html#6989833">nerr</a></span><span class="op" id="6990746">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990752">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6990763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6990766">}</span><br>
<span class="lineno">245</span><span class="op" id="6990768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6990771">func</span>&nbsp;<span class="ident" id="6990776">benchmarkDecode</span><span class="op" id="6990791">(</span><span class="ident" id="6990792">b</span>&nbsp;<span class="op" id="6990794">*</span><span class="ident" id="6990795"><a href="/gostd/image/jpeg/reader_test.go.html#6984242">testing</a></span><span class="op" id="6990802">.</span><span class="ident" id="6990803"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="6990804">,</span>&nbsp;<span class="ident" id="6990806">filename</span>&nbsp;<span class="builtintype" id="6990815">string</span><span class="op" id="6990821">)</span>&nbsp;<span class="op" id="6990823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990826"><a href="/gostd/image/jpeg/reader_test.go.html#6990792">b</a></span><span class="op" id="6990827">.</span><span class="ident" id="6990828"><a href="/gostd/testing/benchmark.go.html#5452096">StopTimer</a></span><span class="op" id="6990837">(</span><span class="op" id="6990838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990841">data</span><span class="op" id="6990845">,</span>&nbsp;<span class="ident" id="6990847">err</span>&nbsp;<span class="op" id="6990851">:=</span>&nbsp;<span class="ident" id="6990854"><a href="/gostd/image/jpeg/reader_test.go.html#6984199">ioutil</a></span><span class="op" id="6990860">.</span><span class="ident" id="6990861"><a href="/gostd/io/ioutil/ioutil.go.html#3765434">ReadFile</a></span><span class="op" id="6990869">(</span><span class="ident" id="6990870"><a href="/gostd/image/jpeg/reader_test.go.html#6990806">filename</a></span><span class="op" id="6990878">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990881">if</span>&nbsp;<span class="ident" id="6990884"><a href="/gostd/image/jpeg/reader_test.go.html#6990847">err</a></span>&nbsp;<span class="op" id="6990888">!=</span>&nbsp;<span class="builtintype" id="6990891">nil</span>&nbsp;<span class="op" id="6990895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990899"><a href="/gostd/image/jpeg/reader_test.go.html#6990792">b</a></span><span class="op" id="6990900">.</span><span class="ident" id="6990901"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6990906">(</span><span class="ident" id="6990907"><a href="/gostd/image/jpeg/reader_test.go.html#6990847">err</a></span><span class="op" id="6990910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6990913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990916">cfg</span><span class="op" id="6990919">,</span>&nbsp;<span class="ident" id="6990921"><a href="/gostd/image/jpeg/reader_test.go.html#6990847">err</a></span>&nbsp;<span class="op" id="6990925">:=</span>&nbsp;<span class="ident" id="6990928"><a href="/gostd/image/jpeg/reader.go.html#5115081">DecodeConfig</a></span><span class="op" id="6990940">(</span><span class="ident" id="6990941"><a href="/gostd/image/jpeg/reader_test.go.html#6984153">bytes</a></span><span class="op" id="6990946">.</span><span class="ident" id="6990947"><a href="/gostd/bytes/reader.go.html#1418136">NewReader</a></span><span class="op" id="6990956">(</span><span class="ident" id="6990957"><a href="/gostd/image/jpeg/reader_test.go.html#6990841">data</a></span><span class="op" id="6990961">)</span><span class="op" id="6990962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6990965">if</span>&nbsp;<span class="ident" id="6990968"><a href="/gostd/image/jpeg/reader_test.go.html#6990847">err</a></span>&nbsp;<span class="op" id="6990972">!=</span>&nbsp;<span class="builtintype" id="6990975">nil</span>&nbsp;<span class="op" id="6990979">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6990983"><a href="/gostd/image/jpeg/reader_test.go.html#6990792">b</a></span><span class="op" id="6990984">.</span><span class="ident" id="6990985"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6990990">(</span><span class="ident" id="6990991"><a href="/gostd/image/jpeg/reader_test.go.html#6990847">err</a></span><span class="op" id="6990994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6990997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6991000"><a href="/gostd/image/jpeg/reader_test.go.html#6990792">b</a></span><span class="op" id="6991001">.</span><span class="ident" id="6991002"><a href="/gostd/testing/benchmark.go.html#5452834">SetBytes</a></span><span class="op" id="6991010">(</span><span class="builtintype" id="6991011">int64</span><span class="op" id="6991016">(</span><span class="ident" id="6991017"><a href="/gostd/image/jpeg/reader_test.go.html#6990916">cfg</a></span><span class="op" id="6991020">.</span><span class="ident" id="6991021"><a href="/gostd/image/image.go.html#5154792">Width</a></span>&nbsp;<span class="op" id="6991027">*</span>&nbsp;<span class="ident" id="6991029"><a href="/gostd/image/jpeg/reader_test.go.html#6990916">cfg</a></span><span class="op" id="6991032">.</span><span class="ident" id="6991033"><a href="/gostd/image/image.go.html#5154799">Height</a></span>&nbsp;<span class="op" id="6991040">*</span>&nbsp;<span class="num" id="6991042">4</span><span class="op" id="6991043">)</span><span class="op" id="6991044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6991047"><a href="/gostd/image/jpeg/reader_test.go.html#6990792">b</a></span><span class="op" id="6991048">.</span><span class="ident" id="6991049"><a href="/gostd/testing/benchmark.go.html#5451749">StartTimer</a></span><span class="op" id="6991059">(</span><span class="op" id="6991060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6991063">for</span>&nbsp;<span class="ident" id="6991067">i</span>&nbsp;<span class="op" id="6991069">:=</span>&nbsp;<span class="num" id="6991072">0</span><span class="op" id="6991073">;</span>&nbsp;<span class="ident" id="6991075"><a href="/gostd/image/jpeg/reader_test.go.html#6991067">i</a></span>&nbsp;<span class="op" id="6991077">&lt;</span>&nbsp;<span class="ident" id="6991079"><a href="/gostd/image/jpeg/reader_test.go.html#6990792">b</a></span><span class="op" id="6991080">.</span><span class="ident" id="6991081"><a href="/gostd/testing/benchmark.go.html#5450983">N</a></span><span class="op" id="6991082">;</span>&nbsp;<span class="ident" id="6991084"><a href="/gostd/image/jpeg/reader_test.go.html#6991067">i</a></span><span class="op" id="6991085">++</span>&nbsp;<span class="op" id="6991088">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6991092"><a href="/gostd/image/jpeg/reader.go.html#5114879">Decode</a></span><span class="op" id="6991098">(</span><span class="ident" id="6991099"><a href="/gostd/image/jpeg/reader_test.go.html#6984153">bytes</a></span><span class="op" id="6991104">.</span><span class="ident" id="6991105"><a href="/gostd/bytes/reader.go.html#1418136">NewReader</a></span><span class="op" id="6991114">(</span><span class="ident" id="6991115"><a href="/gostd/image/jpeg/reader_test.go.html#6990841">data</a></span><span class="op" id="6991119">)</span><span class="op" id="6991120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6991123">}</span><br>
<span class="lineno"></span><span class="op" id="6991125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6991128">func</span>&nbsp;<span class="ident" id="6991133">BenchmarkDecodeBaseline</span><span class="op" id="6991156">(</span><span class="ident" id="6991157">b</span>&nbsp;<span class="op" id="6991159">*</span><span class="ident" id="6991160"><a href="/gostd/image/jpeg/reader_test.go.html#6984242">testing</a></span><span class="op" id="6991167">.</span><span class="ident" id="6991168"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="6991169">)</span>&nbsp;<span class="op" id="6991171">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6991174"><a href="/gostd/image/jpeg/reader_test.go.html#6990776">benchmarkDecode</a></span><span class="op" id="6991189">(</span><span class="ident" id="6991190"><a href="/gostd/image/jpeg/reader_test.go.html#6991157">b</a></span><span class="op" id="6991191">,</span>&nbsp;<span class="string" id="6991193">&#34;../testdata/video-001.jpeg&#34;</span><span class="op" id="6991221">)</span><br>
<span class="lineno"></span><span class="op" id="6991223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6991226">func</span>&nbsp;<span class="ident" id="6991231">BenchmarkDecodeProgressive</span><span class="op" id="6991257">(</span><span class="ident" id="6991258">b</span>&nbsp;<span class="op" id="6991260">*</span><span class="ident" id="6991261"><a href="/gostd/image/jpeg/reader_test.go.html#6984242">testing</a></span><span class="op" id="6991268">.</span><span class="ident" id="6991269"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="6991270">)</span>&nbsp;<span class="op" id="6991272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6991275"><a href="/gostd/image/jpeg/reader_test.go.html#6990776">benchmarkDecode</a></span><span class="op" id="6991290">(</span><span class="ident" id="6991291"><a href="/gostd/image/jpeg/reader_test.go.html#6991258">b</a></span><span class="op" id="6991292">,</span>&nbsp;<span class="string" id="6991294">&#34;../testdata/video-001.progressive.jpeg&#34;</span><span class="op" id="6991334">)</span><br>
<span class="lineno">270</span><span class="op" id="6991336">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
