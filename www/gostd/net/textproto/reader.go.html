<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4332622">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4332678">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4332732">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4332783">package</span>&nbsp;<span class="ident" id="4332791">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4332802">import</span>&nbsp;<span class="op" id="4332809">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4332812">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4332821">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4332830">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4332836">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4332849">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4332860">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4332870">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="4332873">//&nbsp;BUG(rsc):&nbsp;To&nbsp;let&nbsp;callers&nbsp;manage&nbsp;exposure&nbsp;to&nbsp;denial&nbsp;of&nbsp;service</span><br>
<span class="lineno"></span><span class="comment" id="4332938">//&nbsp;attacks,&nbsp;Reader&nbsp;should&nbsp;allow&nbsp;them&nbsp;to&nbsp;set&nbsp;and&nbsp;reset&nbsp;a&nbsp;limit&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="4333003">//&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read&nbsp;from&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4333053">//&nbsp;A&nbsp;Reader&nbsp;implements&nbsp;convenience&nbsp;methods&nbsp;for&nbsp;reading&nbsp;requests</span><br>
<span class="lineno"></span><span class="comment" id="4333117">//&nbsp;or&nbsp;responses&nbsp;from&nbsp;a&nbsp;text&nbsp;protocol&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4333174">type</span>&nbsp;<span class="ident" id="4333179">Reader</span>&nbsp;<span class="keyword" id="4333186">struct</span>&nbsp;<span class="op" id="4333193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333196">R</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4333200">*</span><span class="ident" id="4333201"><a href="/gostd/net/textproto/reader.go.html#4332812">bufio</a></span><span class="op" id="4333206">.</span><span class="ident" id="4333207"><a href="/gostd/bufio/bufio.go.html#1354974">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333215">dot</span>&nbsp;<span class="op" id="4333219">*</span><span class="ident" id="4333220"><a href="/gostd/net/textproto/reader.go.html#4340800">dotReader</a></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333231">buf</span>&nbsp;<span class="op" id="4333235">[</span><span class="op" id="4333236">]</span><span class="builtintype" id="4333237">byte</span>&nbsp;<span class="comment" id="4333242">//&nbsp;a&nbsp;re-usable&nbsp;buffer&nbsp;for&nbsp;readContinuedLineSlice</span><br>
<span class="lineno"></span><span class="op" id="4333291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4333294">//&nbsp;NewReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;Reader&nbsp;reading&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="4333344">func</span>&nbsp;<span class="ident" id="4333349">NewReader</span><span class="op" id="4333358">(</span><span class="ident" id="4333359">r</span>&nbsp;<span class="op" id="4333361">*</span><span class="ident" id="4333362"><a href="/gostd/net/textproto/reader.go.html#4332812">bufio</a></span><span class="op" id="4333367">.</span><span class="ident" id="4333368"><a href="/gostd/bufio/bufio.go.html#1354974">Reader</a></span><span class="op" id="4333374">)</span>&nbsp;<span class="op" id="4333376">*</span><span class="ident" id="4333377"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span>&nbsp;<span class="op" id="4333384">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4333387">return</span>&nbsp;<span class="op" id="4333394">&amp;</span><span class="ident" id="4333395"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4333401">{</span><span class="ident" id="4333402"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="4333403">:</span>&nbsp;<span class="ident" id="4333405"><a href="/gostd/net/textproto/reader.go.html#4333359">r</a></span><span class="op" id="4333406">}</span><br>
<span class="lineno"></span><span class="op" id="4333408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4333411">//&nbsp;ReadLine&nbsp;reads&nbsp;a&nbsp;single&nbsp;line&nbsp;from&nbsp;r,</span><br>
<span class="lineno"></span><span class="comment" id="4333451">//&nbsp;eliding&nbsp;the&nbsp;final&nbsp;\n&nbsp;or&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;returned&nbsp;string.</span><br>
<span class="lineno">35</span><span class="keyword" id="4333509">func</span>&nbsp;<span class="op" id="4333514">(</span><span class="ident" id="4333515">r</span>&nbsp;<span class="op" id="4333517">*</span><span class="ident" id="4333518"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4333524">)</span>&nbsp;<span class="ident" id="4333526">ReadLine</span><span class="op" id="4333534">(</span><span class="op" id="4333535">)</span>&nbsp;<span class="op" id="4333537">(</span><span class="builtintype" id="4333538">string</span><span class="op" id="4333544">,</span>&nbsp;<span class="builtintype" id="4333546">error</span><span class="op" id="4333551">)</span>&nbsp;<span class="op" id="4333553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333556">line</span><span class="op" id="4333560">,</span>&nbsp;<span class="ident" id="4333562">err</span>&nbsp;<span class="op" id="4333566">:=</span>&nbsp;<span class="ident" id="4333569"><a href="/gostd/net/textproto/reader.go.html#4333515">r</a></span><span class="op" id="4333570">.</span><span class="ident" id="4333571"><a href="/gostd/net/textproto/reader.go.html#4333898">readLineSlice</a></span><span class="op" id="4333584">(</span><span class="op" id="4333585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4333588">return</span>&nbsp;<span class="builtintype" id="4333595">string</span><span class="op" id="4333601">(</span><span class="ident" id="4333602"><a href="/gostd/net/textproto/reader.go.html#4333556">line</a></span><span class="op" id="4333606">)</span><span class="op" id="4333607">,</span>&nbsp;<span class="ident" id="4333609"><a href="/gostd/net/textproto/reader.go.html#4333562">err</a></span><br>
<span class="lineno"></span><span class="op" id="4333613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4333616">//&nbsp;ReadLineBytes&nbsp;is&nbsp;like&nbsp;ReadLine&nbsp;but&nbsp;returns&nbsp;a&nbsp;[]byte&nbsp;instead&nbsp;of&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4333692">func</span>&nbsp;<span class="op" id="4333697">(</span><span class="ident" id="4333698">r</span>&nbsp;<span class="op" id="4333700">*</span><span class="ident" id="4333701"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4333707">)</span>&nbsp;<span class="ident" id="4333709">ReadLineBytes</span><span class="op" id="4333722">(</span><span class="op" id="4333723">)</span>&nbsp;<span class="op" id="4333725">(</span><span class="op" id="4333726">[</span><span class="op" id="4333727">]</span><span class="builtintype" id="4333728">byte</span><span class="op" id="4333732">,</span>&nbsp;<span class="builtintype" id="4333734">error</span><span class="op" id="4333739">)</span>&nbsp;<span class="op" id="4333741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333744">line</span><span class="op" id="4333748">,</span>&nbsp;<span class="ident" id="4333750">err</span>&nbsp;<span class="op" id="4333754">:=</span>&nbsp;<span class="ident" id="4333757"><a href="/gostd/net/textproto/reader.go.html#4333698">r</a></span><span class="op" id="4333758">.</span><span class="ident" id="4333759"><a href="/gostd/net/textproto/reader.go.html#4333898">readLineSlice</a></span><span class="op" id="4333772">(</span><span class="op" id="4333773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4333776">if</span>&nbsp;<span class="ident" id="4333779"><a href="/gostd/net/textproto/reader.go.html#4333744">line</a></span>&nbsp;<span class="op" id="4333784">!=</span>&nbsp;<span class="builtintype" id="4333787">nil</span>&nbsp;<span class="op" id="4333791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333795">buf</span>&nbsp;<span class="op" id="4333799">:=</span>&nbsp;<span class="builtinfunc" id="4333802">make</span><span class="op" id="4333806">(</span><span class="op" id="4333807">[</span><span class="op" id="4333808">]</span><span class="builtintype" id="4333809">byte</span><span class="op" id="4333813">,</span>&nbsp;<span class="builtinfunc" id="4333815">len</span><span class="op" id="4333818">(</span><span class="ident" id="4333819"><a href="/gostd/net/textproto/reader.go.html#4333744">line</a></span><span class="op" id="4333823">)</span><span class="op" id="4333824">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4333828">copy</span><span class="op" id="4333832">(</span><span class="ident" id="4333833"><a href="/gostd/net/textproto/reader.go.html#4333795">buf</a></span><span class="op" id="4333836">,</span>&nbsp;<span class="ident" id="4333838"><a href="/gostd/net/textproto/reader.go.html#4333744">line</a></span><span class="op" id="4333842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333846"><a href="/gostd/net/textproto/reader.go.html#4333744">line</a></span>&nbsp;<span class="op" id="4333851">=</span>&nbsp;<span class="ident" id="4333853"><a href="/gostd/net/textproto/reader.go.html#4333795">buf</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4333858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4333861">return</span>&nbsp;<span class="ident" id="4333868"><a href="/gostd/net/textproto/reader.go.html#4333744">line</a></span><span class="op" id="4333872">,</span>&nbsp;<span class="ident" id="4333874"><a href="/gostd/net/textproto/reader.go.html#4333750">err</a></span><br>
<span class="lineno"></span><span class="op" id="4333878">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4333881">func</span>&nbsp;<span class="op" id="4333886">(</span><span class="ident" id="4333887">r</span>&nbsp;<span class="op" id="4333889">*</span><span class="ident" id="4333890"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4333896">)</span>&nbsp;<span class="ident" id="4333898">readLineSlice</span><span class="op" id="4333911">(</span><span class="op" id="4333912">)</span>&nbsp;<span class="op" id="4333914">(</span><span class="op" id="4333915">[</span><span class="op" id="4333916">]</span><span class="builtintype" id="4333917">byte</span><span class="op" id="4333921">,</span>&nbsp;<span class="builtintype" id="4333923">error</span><span class="op" id="4333928">)</span>&nbsp;<span class="op" id="4333930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333933"><a href="/gostd/net/textproto/reader.go.html#4333887">r</a></span><span class="op" id="4333934">.</span><span class="ident" id="4333935"><a href="/gostd/net/textproto/reader.go.html#4342775">closeDot</a></span><span class="op" id="4333943">(</span><span class="op" id="4333944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4333947">var</span>&nbsp;<span class="ident" id="4333951">line</span>&nbsp;<span class="op" id="4333956">[</span><span class="op" id="4333957">]</span><span class="builtintype" id="4333958">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4333964">for</span>&nbsp;<span class="op" id="4333968">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333972">l</span><span class="op" id="4333973">,</span>&nbsp;<span class="ident" id="4333975">more</span><span class="op" id="4333979">,</span>&nbsp;<span class="ident" id="4333981">err</span>&nbsp;<span class="op" id="4333985">:=</span>&nbsp;<span class="ident" id="4333988"><a href="/gostd/net/textproto/reader.go.html#4333887">r</a></span><span class="op" id="4333989">.</span><span class="ident" id="4333990"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="4333991">.</span><span class="ident" id="4333992"><a href="/gostd/bufio/bufio.go.html#1362739">ReadLine</a></span><span class="op" id="4334000">(</span><span class="op" id="4334001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4334005">if</span>&nbsp;<span class="ident" id="4334008"><a href="/gostd/net/textproto/reader.go.html#4333981">err</a></span>&nbsp;<span class="op" id="4334012">!=</span>&nbsp;<span class="builtintype" id="4334015">nil</span>&nbsp;<span class="op" id="4334019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4334024">return</span>&nbsp;<span class="builtintype" id="4334031">nil</span><span class="op" id="4334034">,</span>&nbsp;<span class="ident" id="4334036"><a href="/gostd/net/textproto/reader.go.html#4333981">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4334042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4334046">//&nbsp;Avoid&nbsp;the&nbsp;copy&nbsp;if&nbsp;the&nbsp;first&nbsp;call&nbsp;produced&nbsp;a&nbsp;full&nbsp;line.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4334106">if</span>&nbsp;<span class="ident" id="4334109"><a href="/gostd/net/textproto/reader.go.html#4333951">line</a></span>&nbsp;<span class="op" id="4334114">==</span>&nbsp;<span class="builtintype" id="4334117">nil</span>&nbsp;<span class="op" id="4334121">&amp;&amp;</span>&nbsp;<span class="op" id="4334124">!</span><span class="ident" id="4334125"><a href="/gostd/net/textproto/reader.go.html#4333975">more</a></span>&nbsp;<span class="op" id="4334130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4334135">return</span>&nbsp;<span class="ident" id="4334142"><a href="/gostd/net/textproto/reader.go.html#4333972">l</a></span><span class="op" id="4334143">,</span>&nbsp;<span class="builtintype" id="4334145">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4334151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4334155"><a href="/gostd/net/textproto/reader.go.html#4333951">line</a></span>&nbsp;<span class="op" id="4334160">=</span>&nbsp;<span class="builtinfunc" id="4334162">append</span><span class="op" id="4334168">(</span><span class="ident" id="4334169"><a href="/gostd/net/textproto/reader.go.html#4333951">line</a></span><span class="op" id="4334173">,</span>&nbsp;<span class="ident" id="4334175"><a href="/gostd/net/textproto/reader.go.html#4333972">l</a></span><span class="op" id="4334176">...</span><span class="op" id="4334179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4334183">if</span>&nbsp;<span class="op" id="4334186">!</span><span class="ident" id="4334187"><a href="/gostd/net/textproto/reader.go.html#4333975">more</a></span>&nbsp;<span class="op" id="4334192">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4334197">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4334205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4334208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4334211">return</span>&nbsp;<span class="ident" id="4334218"><a href="/gostd/net/textproto/reader.go.html#4333951">line</a></span><span class="op" id="4334222">,</span>&nbsp;<span class="builtintype" id="4334224">nil</span><br>
<span class="lineno"></span><span class="op" id="4334228">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="4334231">//&nbsp;ReadContinuedLine&nbsp;reads&nbsp;a&nbsp;possibly&nbsp;continued&nbsp;line&nbsp;from&nbsp;r,</span><br>
<span class="lineno"></span><span class="comment" id="4334292">//&nbsp;eliding&nbsp;the&nbsp;final&nbsp;trailing&nbsp;ASCII&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="4334341">//&nbsp;Lines&nbsp;after&nbsp;the&nbsp;first&nbsp;are&nbsp;considered&nbsp;continuations&nbsp;if&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="4334403">//&nbsp;begin&nbsp;with&nbsp;a&nbsp;space&nbsp;or&nbsp;tab&nbsp;character.&nbsp;&nbsp;In&nbsp;the&nbsp;returned&nbsp;data,</span><br>
<span class="lineno">75</span><span class="comment" id="4334466">//&nbsp;continuation&nbsp;lines&nbsp;are&nbsp;separated&nbsp;from&nbsp;the&nbsp;previous&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="4334525">//&nbsp;only&nbsp;by&nbsp;a&nbsp;single&nbsp;space:&nbsp;the&nbsp;newline&nbsp;and&nbsp;leading&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="4334588">//&nbsp;are&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="4334604">//</span><br>
<span class="lineno"></span><span class="comment" id="4334607">//&nbsp;For&nbsp;example,&nbsp;consider&nbsp;this&nbsp;input:</span><br>
<span class="lineno">80</span><span class="comment" id="4334644">//</span><br>
<span class="lineno"></span><span class="comment" id="4334647">//&nbsp;&nbsp;&nbsp;&nbsp;Line&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="4334657">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continued...</span><br>
<span class="lineno"></span><span class="comment" id="4334675">//&nbsp;&nbsp;&nbsp;&nbsp;Line&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="4334685">//</span><br>
<span class="lineno">85</span><span class="comment" id="4334688">//&nbsp;The&nbsp;first&nbsp;call&nbsp;to&nbsp;ReadContinuedLine&nbsp;will&nbsp;return&nbsp;&#34;Line&nbsp;1&nbsp;continued...&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4334761">//&nbsp;and&nbsp;the&nbsp;second&nbsp;will&nbsp;return&nbsp;&#34;Line&nbsp;2&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="4334801">//</span><br>
<span class="lineno"></span><span class="comment" id="4334804">//&nbsp;A&nbsp;line&nbsp;consisting&nbsp;of&nbsp;only&nbsp;white&nbsp;space&nbsp;is&nbsp;never&nbsp;continued.</span><br>
<span class="lineno"></span><span class="comment" id="4334865">//</span><br>
<span class="lineno">90</span><span class="keyword" id="4334868">func</span>&nbsp;<span class="op" id="4334873">(</span><span class="ident" id="4334874">r</span>&nbsp;<span class="op" id="4334876">*</span><span class="ident" id="4334877"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4334883">)</span>&nbsp;<span class="ident" id="4334885">ReadContinuedLine</span><span class="op" id="4334902">(</span><span class="op" id="4334903">)</span>&nbsp;<span class="op" id="4334905">(</span><span class="builtintype" id="4334906">string</span><span class="op" id="4334912">,</span>&nbsp;<span class="builtintype" id="4334914">error</span><span class="op" id="4334919">)</span>&nbsp;<span class="op" id="4334921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4334924">line</span><span class="op" id="4334928">,</span>&nbsp;<span class="ident" id="4334930">err</span>&nbsp;<span class="op" id="4334934">:=</span>&nbsp;<span class="ident" id="4334937"><a href="/gostd/net/textproto/reader.go.html#4334874">r</a></span><span class="op" id="4334938">.</span><span class="ident" id="4334939"><a href="/gostd/net/textproto/reader.go.html#4335610">readContinuedLineSlice</a></span><span class="op" id="4334961">(</span><span class="op" id="4334962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4334965">return</span>&nbsp;<span class="builtintype" id="4334972">string</span><span class="op" id="4334978">(</span><span class="ident" id="4334979"><a href="/gostd/net/textproto/reader.go.html#4334924">line</a></span><span class="op" id="4334983">)</span><span class="op" id="4334984">,</span>&nbsp;<span class="ident" id="4334986"><a href="/gostd/net/textproto/reader.go.html#4334930">err</a></span><br>
<span class="lineno"></span><span class="op" id="4334990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4334993">//&nbsp;trim&nbsp;returns&nbsp;s&nbsp;with&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="4335062">//&nbsp;It&nbsp;does&nbsp;not&nbsp;assume&nbsp;Unicode&nbsp;or&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="keyword" id="4335102">func</span>&nbsp;<span class="ident" id="4335107">trim</span><span class="op" id="4335111">(</span><span class="ident" id="4335112">s</span>&nbsp;<span class="op" id="4335114">[</span><span class="op" id="4335115">]</span><span class="builtintype" id="4335116">byte</span><span class="op" id="4335120">)</span>&nbsp;<span class="op" id="4335122">[</span><span class="op" id="4335123">]</span><span class="builtintype" id="4335124">byte</span>&nbsp;<span class="op" id="4335129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4335132">i</span>&nbsp;<span class="op" id="4335134">:=</span>&nbsp;<span class="num" id="4335137">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4335140">for</span>&nbsp;<span class="ident" id="4335144"><a href="/gostd/net/textproto/reader.go.html#4335132">i</a></span>&nbsp;<span class="op" id="4335146">&lt;</span>&nbsp;<span class="builtinfunc" id="4335148">len</span><span class="op" id="4335151">(</span><span class="ident" id="4335152"><a href="/gostd/net/textproto/reader.go.html#4335112">s</a></span><span class="op" id="4335153">)</span>&nbsp;<span class="op" id="4335155">&amp;&amp;</span>&nbsp;<span class="op" id="4335158">(</span><span class="ident" id="4335159"><a href="/gostd/net/textproto/reader.go.html#4335112">s</a></span><span class="op" id="4335160">[</span><span class="ident" id="4335161"><a href="/gostd/net/textproto/reader.go.html#4335132">i</a></span><span class="op" id="4335162">]</span>&nbsp;<span class="op" id="4335164">==</span>&nbsp;<span class="string" id="4335167">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4335171">||</span>&nbsp;<span class="ident" id="4335174"><a href="/gostd/net/textproto/reader.go.html#4335112">s</a></span><span class="op" id="4335175">[</span><span class="ident" id="4335176"><a href="/gostd/net/textproto/reader.go.html#4335132">i</a></span><span class="op" id="4335177">]</span>&nbsp;<span class="op" id="4335179">==</span>&nbsp;<span class="string" id="4335182">&#39;\t&#39;</span><span class="op" id="4335186">)</span>&nbsp;<span class="op" id="4335188">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4335192"><a href="/gostd/net/textproto/reader.go.html#4335132">i</a></span><span class="op" id="4335193">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4335197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4335200">n</span>&nbsp;<span class="op" id="4335202">:=</span>&nbsp;<span class="builtinfunc" id="4335205">len</span><span class="op" id="4335208">(</span><span class="ident" id="4335209"><a href="/gostd/net/textproto/reader.go.html#4335112">s</a></span><span class="op" id="4335210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4335213">for</span>&nbsp;<span class="ident" id="4335217"><a href="/gostd/net/textproto/reader.go.html#4335200">n</a></span>&nbsp;<span class="op" id="4335219">&gt;</span>&nbsp;<span class="ident" id="4335221"><a href="/gostd/net/textproto/reader.go.html#4335132">i</a></span>&nbsp;<span class="op" id="4335223">&amp;&amp;</span>&nbsp;<span class="op" id="4335226">(</span><span class="ident" id="4335227"><a href="/gostd/net/textproto/reader.go.html#4335112">s</a></span><span class="op" id="4335228">[</span><span class="ident" id="4335229"><a href="/gostd/net/textproto/reader.go.html#4335200">n</a></span><span class="op" id="4335230">-</span><span class="num" id="4335231">1</span><span class="op" id="4335232">]</span>&nbsp;<span class="op" id="4335234">==</span>&nbsp;<span class="string" id="4335237">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4335241">||</span>&nbsp;<span class="ident" id="4335244"><a href="/gostd/net/textproto/reader.go.html#4335112">s</a></span><span class="op" id="4335245">[</span><span class="ident" id="4335246"><a href="/gostd/net/textproto/reader.go.html#4335200">n</a></span><span class="op" id="4335247">-</span><span class="num" id="4335248">1</span><span class="op" id="4335249">]</span>&nbsp;<span class="op" id="4335251">==</span>&nbsp;<span class="string" id="4335254">&#39;\t&#39;</span><span class="op" id="4335258">)</span>&nbsp;<span class="op" id="4335260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4335264"><a href="/gostd/net/textproto/reader.go.html#4335200">n</a></span><span class="op" id="4335265">--</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4335269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4335272">return</span>&nbsp;<span class="ident" id="4335279"><a href="/gostd/net/textproto/reader.go.html#4335112">s</a></span><span class="op" id="4335280">[</span><span class="ident" id="4335281"><a href="/gostd/net/textproto/reader.go.html#4335132">i</a></span><span class="op" id="4335282">:</span><span class="ident" id="4335283"><a href="/gostd/net/textproto/reader.go.html#4335200">n</a></span><span class="op" id="4335284">]</span><br>
<span class="lineno"></span><span class="op" id="4335286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4335289">//&nbsp;ReadContinuedLineBytes&nbsp;is&nbsp;like&nbsp;ReadContinuedLine&nbsp;but</span><br>
<span class="lineno">110</span><span class="comment" id="4335345">//&nbsp;returns&nbsp;a&nbsp;[]byte&nbsp;instead&nbsp;of&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4335386">func</span>&nbsp;<span class="op" id="4335391">(</span><span class="ident" id="4335392">r</span>&nbsp;<span class="op" id="4335394">*</span><span class="ident" id="4335395"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4335401">)</span>&nbsp;<span class="ident" id="4335403">ReadContinuedLineBytes</span><span class="op" id="4335425">(</span><span class="op" id="4335426">)</span>&nbsp;<span class="op" id="4335428">(</span><span class="op" id="4335429">[</span><span class="op" id="4335430">]</span><span class="builtintype" id="4335431">byte</span><span class="op" id="4335435">,</span>&nbsp;<span class="builtintype" id="4335437">error</span><span class="op" id="4335442">)</span>&nbsp;<span class="op" id="4335444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4335447">line</span><span class="op" id="4335451">,</span>&nbsp;<span class="ident" id="4335453">err</span>&nbsp;<span class="op" id="4335457">:=</span>&nbsp;<span class="ident" id="4335460"><a href="/gostd/net/textproto/reader.go.html#4335392">r</a></span><span class="op" id="4335461">.</span><span class="ident" id="4335462"><a href="/gostd/net/textproto/reader.go.html#4335610">readContinuedLineSlice</a></span><span class="op" id="4335484">(</span><span class="op" id="4335485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4335488">if</span>&nbsp;<span class="ident" id="4335491"><a href="/gostd/net/textproto/reader.go.html#4335447">line</a></span>&nbsp;<span class="op" id="4335496">!=</span>&nbsp;<span class="builtintype" id="4335499">nil</span>&nbsp;<span class="op" id="4335503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4335507">buf</span>&nbsp;<span class="op" id="4335511">:=</span>&nbsp;<span class="builtinfunc" id="4335514">make</span><span class="op" id="4335518">(</span><span class="op" id="4335519">[</span><span class="op" id="4335520">]</span><span class="builtintype" id="4335521">byte</span><span class="op" id="4335525">,</span>&nbsp;<span class="builtinfunc" id="4335527">len</span><span class="op" id="4335530">(</span><span class="ident" id="4335531"><a href="/gostd/net/textproto/reader.go.html#4335447">line</a></span><span class="op" id="4335535">)</span><span class="op" id="4335536">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4335540">copy</span><span class="op" id="4335544">(</span><span class="ident" id="4335545"><a href="/gostd/net/textproto/reader.go.html#4335507">buf</a></span><span class="op" id="4335548">,</span>&nbsp;<span class="ident" id="4335550"><a href="/gostd/net/textproto/reader.go.html#4335447">line</a></span><span class="op" id="4335554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4335558"><a href="/gostd/net/textproto/reader.go.html#4335447">line</a></span>&nbsp;<span class="op" id="4335563">=</span>&nbsp;<span class="ident" id="4335565"><a href="/gostd/net/textproto/reader.go.html#4335507">buf</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4335570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4335573">return</span>&nbsp;<span class="ident" id="4335580"><a href="/gostd/net/textproto/reader.go.html#4335447">line</a></span><span class="op" id="4335584">,</span>&nbsp;<span class="ident" id="4335586"><a href="/gostd/net/textproto/reader.go.html#4335453">err</a></span><br>
<span class="lineno"></span><span class="op" id="4335590">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4335593">func</span>&nbsp;<span class="op" id="4335598">(</span><span class="ident" id="4335599">r</span>&nbsp;<span class="op" id="4335601">*</span><span class="ident" id="4335602"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4335608">)</span>&nbsp;<span class="ident" id="4335610">readContinuedLineSlice</span><span class="op" id="4335632">(</span><span class="op" id="4335633">)</span>&nbsp;<span class="op" id="4335635">(</span><span class="op" id="4335636">[</span><span class="op" id="4335637">]</span><span class="builtintype" id="4335638">byte</span><span class="op" id="4335642">,</span>&nbsp;<span class="builtintype" id="4335644">error</span><span class="op" id="4335649">)</span>&nbsp;<span class="op" id="4335651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4335654">//&nbsp;Read&nbsp;the&nbsp;first&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4335679">line</span><span class="op" id="4335683">,</span>&nbsp;<span class="ident" id="4335685">err</span>&nbsp;<span class="op" id="4335689">:=</span>&nbsp;<span class="ident" id="4335692"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4335693">.</span><span class="ident" id="4335694"><a href="/gostd/net/textproto/reader.go.html#4333898">readLineSlice</a></span><span class="op" id="4335707">(</span><span class="op" id="4335708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4335711">if</span>&nbsp;<span class="ident" id="4335714"><a href="/gostd/net/textproto/reader.go.html#4335685">err</a></span>&nbsp;<span class="op" id="4335718">!=</span>&nbsp;<span class="builtintype" id="4335721">nil</span>&nbsp;<span class="op" id="4335725">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4335729">return</span>&nbsp;<span class="builtintype" id="4335736">nil</span><span class="op" id="4335739">,</span>&nbsp;<span class="ident" id="4335741"><a href="/gostd/net/textproto/reader.go.html#4335685">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4335746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4335749">if</span>&nbsp;<span class="builtinfunc" id="4335752">len</span><span class="op" id="4335755">(</span><span class="ident" id="4335756"><a href="/gostd/net/textproto/reader.go.html#4335679">line</a></span><span class="op" id="4335760">)</span>&nbsp;<span class="op" id="4335762">==</span>&nbsp;<span class="num" id="4335765">0</span>&nbsp;<span class="op" id="4335767">{</span>&nbsp;<span class="comment" id="4335769">//&nbsp;blank&nbsp;line&nbsp;-&nbsp;no&nbsp;continuation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4335803">return</span>&nbsp;<span class="ident" id="4335810"><a href="/gostd/net/textproto/reader.go.html#4335679">line</a></span><span class="op" id="4335814">,</span>&nbsp;<span class="builtintype" id="4335816">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4335821">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4335825">//&nbsp;Optimistically&nbsp;assume&nbsp;that&nbsp;we&nbsp;have&nbsp;started&nbsp;to&nbsp;buffer&nbsp;the&nbsp;next&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4335896">//&nbsp;and&nbsp;it&nbsp;starts&nbsp;with&nbsp;an&nbsp;ASCII&nbsp;letter&nbsp;(the&nbsp;next&nbsp;header&nbsp;key),&nbsp;so&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4335968">//&nbsp;avoid&nbsp;copying&nbsp;that&nbsp;buffered&nbsp;data&nbsp;around&nbsp;in&nbsp;memory&nbsp;and&nbsp;skipping&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4336040">//&nbsp;non-existent&nbsp;whitespace.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336069">if</span>&nbsp;<span class="ident" id="4336072"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336073">.</span><span class="ident" id="4336074"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="4336075">.</span><span class="ident" id="4336076"><a href="/gostd/bufio/bufio.go.html#1360477">Buffered</a></span><span class="op" id="4336084">(</span><span class="op" id="4336085">)</span>&nbsp;<span class="op" id="4336087">&gt;</span>&nbsp;<span class="num" id="4336089">1</span>&nbsp;<span class="op" id="4336091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336095">peek</span><span class="op" id="4336099">,</span>&nbsp;<span class="ident" id="4336101">err</span>&nbsp;<span class="op" id="4336105">:=</span>&nbsp;<span class="ident" id="4336108"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336109">.</span><span class="ident" id="4336110"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="4336111">.</span><span class="ident" id="4336112"><a href="/gostd/bufio/bufio.go.html#1357192">Peek</a></span><span class="op" id="4336116">(</span><span class="num" id="4336117">1</span><span class="op" id="4336118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336122">if</span>&nbsp;<span class="ident" id="4336125"><a href="/gostd/net/textproto/reader.go.html#4336101">err</a></span>&nbsp;<span class="op" id="4336129">==</span>&nbsp;<span class="builtintype" id="4336132">nil</span>&nbsp;<span class="op" id="4336136">&amp;&amp;</span>&nbsp;<span class="ident" id="4336139"><a href="/gostd/net/textproto/textproto.go.html#4352604">isASCIILetter</a></span><span class="op" id="4336152">(</span><span class="ident" id="4336153"><a href="/gostd/net/textproto/reader.go.html#4336095">peek</a></span><span class="op" id="4336157">[</span><span class="num" id="4336158">0</span><span class="op" id="4336159">]</span><span class="op" id="4336160">)</span>&nbsp;<span class="op" id="4336162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336167">return</span>&nbsp;<span class="ident" id="4336174"><a href="/gostd/net/textproto/reader.go.html#4335107">trim</a></span><span class="op" id="4336178">(</span><span class="ident" id="4336179"><a href="/gostd/net/textproto/reader.go.html#4335679">line</a></span><span class="op" id="4336183">)</span><span class="op" id="4336184">,</span>&nbsp;<span class="builtintype" id="4336186">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4336192">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4336195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4336199">//&nbsp;ReadByte&nbsp;or&nbsp;the&nbsp;next&nbsp;readLineSlice&nbsp;will&nbsp;flush&nbsp;the&nbsp;read&nbsp;buffer;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4336266">//&nbsp;copy&nbsp;the&nbsp;slice&nbsp;into&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336295"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336296">.</span><span class="ident" id="4336297"><a href="/gostd/net/textproto/reader.go.html#4333231">buf</a></span>&nbsp;<span class="op" id="4336301">=</span>&nbsp;<span class="builtinfunc" id="4336303">append</span><span class="op" id="4336309">(</span><span class="ident" id="4336310"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336311">.</span><span class="ident" id="4336312"><a href="/gostd/net/textproto/reader.go.html#4333231">buf</a></span><span class="op" id="4336315">[</span><span class="op" id="4336316">:</span><span class="num" id="4336317">0</span><span class="op" id="4336318">]</span><span class="op" id="4336319">,</span>&nbsp;<span class="ident" id="4336321"><a href="/gostd/net/textproto/reader.go.html#4335107">trim</a></span><span class="op" id="4336325">(</span><span class="ident" id="4336326"><a href="/gostd/net/textproto/reader.go.html#4335679">line</a></span><span class="op" id="4336330">)</span><span class="op" id="4336331">...</span><span class="op" id="4336334">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4336338">//&nbsp;Read&nbsp;continuation&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336367">for</span>&nbsp;<span class="ident" id="4336371"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336372">.</span><span class="ident" id="4336373"><a href="/gostd/net/textproto/reader.go.html#4336637">skipSpace</a></span><span class="op" id="4336382">(</span><span class="op" id="4336383">)</span>&nbsp;<span class="op" id="4336385">&gt;</span>&nbsp;<span class="num" id="4336387">0</span>&nbsp;<span class="op" id="4336389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336393">line</span><span class="op" id="4336397">,</span>&nbsp;<span class="ident" id="4336399">err</span>&nbsp;<span class="op" id="4336403">:=</span>&nbsp;<span class="ident" id="4336406"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336407">.</span><span class="ident" id="4336408"><a href="/gostd/net/textproto/reader.go.html#4333898">readLineSlice</a></span><span class="op" id="4336421">(</span><span class="op" id="4336422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336426">if</span>&nbsp;<span class="ident" id="4336429"><a href="/gostd/net/textproto/reader.go.html#4336399">err</a></span>&nbsp;<span class="op" id="4336433">!=</span>&nbsp;<span class="builtintype" id="4336436">nil</span>&nbsp;<span class="op" id="4336440">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336445">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4336453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336457"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336458">.</span><span class="ident" id="4336459"><a href="/gostd/net/textproto/reader.go.html#4333231">buf</a></span>&nbsp;<span class="op" id="4336463">=</span>&nbsp;<span class="builtinfunc" id="4336465">append</span><span class="op" id="4336471">(</span><span class="ident" id="4336472"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336473">.</span><span class="ident" id="4336474"><a href="/gostd/net/textproto/reader.go.html#4333231">buf</a></span><span class="op" id="4336477">,</span>&nbsp;<span class="string" id="4336479">&#39;&nbsp;&#39;</span><span class="op" id="4336482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336486"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336487">.</span><span class="ident" id="4336488"><a href="/gostd/net/textproto/reader.go.html#4333231">buf</a></span>&nbsp;<span class="op" id="4336492">=</span>&nbsp;<span class="builtinfunc" id="4336494">append</span><span class="op" id="4336500">(</span><span class="ident" id="4336501"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336502">.</span><span class="ident" id="4336503"><a href="/gostd/net/textproto/reader.go.html#4333231">buf</a></span><span class="op" id="4336506">,</span>&nbsp;<span class="ident" id="4336508"><a href="/gostd/net/textproto/reader.go.html#4336393">line</a></span><span class="op" id="4336512">...</span><span class="op" id="4336515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4336518">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336521">return</span>&nbsp;<span class="ident" id="4336528"><a href="/gostd/net/textproto/reader.go.html#4335599">r</a></span><span class="op" id="4336529">.</span><span class="ident" id="4336530"><a href="/gostd/net/textproto/reader.go.html#4333231">buf</a></span><span class="op" id="4336533">,</span>&nbsp;<span class="builtintype" id="4336535">nil</span><br>
<span class="lineno"></span><span class="op" id="4336539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4336542">//&nbsp;skipSpace&nbsp;skips&nbsp;R&nbsp;over&nbsp;all&nbsp;spaces&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="keyword" id="4336620">func</span>&nbsp;<span class="op" id="4336625">(</span><span class="ident" id="4336626">r</span>&nbsp;<span class="op" id="4336628">*</span><span class="ident" id="4336629"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4336635">)</span>&nbsp;<span class="ident" id="4336637">skipSpace</span><span class="op" id="4336646">(</span><span class="op" id="4336647">)</span>&nbsp;<span class="builtintype" id="4336649">int</span>&nbsp;<span class="op" id="4336653">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336656">n</span>&nbsp;<span class="op" id="4336658">:=</span>&nbsp;<span class="num" id="4336661">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336664">for</span>&nbsp;<span class="op" id="4336668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336672">c</span><span class="op" id="4336673">,</span>&nbsp;<span class="ident" id="4336675">err</span>&nbsp;<span class="op" id="4336679">:=</span>&nbsp;<span class="ident" id="4336682"><a href="/gostd/net/textproto/reader.go.html#4336626">r</a></span><span class="op" id="4336683">.</span><span class="ident" id="4336684"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="4336685">.</span><span class="ident" id="4336686"><a href="/gostd/bufio/bufio.go.html#1358635">ReadByte</a></span><span class="op" id="4336694">(</span><span class="op" id="4336695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336699">if</span>&nbsp;<span class="ident" id="4336702"><a href="/gostd/net/textproto/reader.go.html#4336675">err</a></span>&nbsp;<span class="op" id="4336706">!=</span>&nbsp;<span class="builtintype" id="4336709">nil</span>&nbsp;<span class="op" id="4336713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4336718">//&nbsp;Bufio&nbsp;will&nbsp;keep&nbsp;err&nbsp;until&nbsp;next&nbsp;read.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336761">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4336769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336773">if</span>&nbsp;<span class="ident" id="4336776"><a href="/gostd/net/textproto/reader.go.html#4336672">c</a></span>&nbsp;<span class="op" id="4336778">!=</span>&nbsp;<span class="string" id="4336781">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4336785">&amp;&amp;</span>&nbsp;<span class="ident" id="4336788"><a href="/gostd/net/textproto/reader.go.html#4336672">c</a></span>&nbsp;<span class="op" id="4336790">!=</span>&nbsp;<span class="string" id="4336793">&#39;\t&#39;</span>&nbsp;<span class="op" id="4336798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336803"><a href="/gostd/net/textproto/reader.go.html#4336626">r</a></span><span class="op" id="4336804">.</span><span class="ident" id="4336805"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="4336806">.</span><span class="ident" id="4336807"><a href="/gostd/bufio/bufio.go.html#1358954">UnreadByte</a></span><span class="op" id="4336817">(</span><span class="op" id="4336818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336823">break</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4336831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336835"><a href="/gostd/net/textproto/reader.go.html#4336656">n</a></span><span class="op" id="4336836">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4336840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336843">return</span>&nbsp;<span class="ident" id="4336850"><a href="/gostd/net/textproto/reader.go.html#4336656">n</a></span><br>
<span class="lineno"></span><span class="op" id="4336852">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="4336855">func</span>&nbsp;<span class="op" id="4336860">(</span><span class="ident" id="4336861">r</span>&nbsp;<span class="op" id="4336863">*</span><span class="ident" id="4336864"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4336870">)</span>&nbsp;<span class="ident" id="4336872">readCodeLine</span><span class="op" id="4336884">(</span><span class="ident" id="4336885">expectCode</span>&nbsp;<span class="builtintype" id="4336896">int</span><span class="op" id="4336899">)</span>&nbsp;<span class="op" id="4336901">(</span><span class="ident" id="4336902">code</span>&nbsp;<span class="builtintype" id="4336907">int</span><span class="op" id="4336910">,</span>&nbsp;<span class="ident" id="4336912">continued</span>&nbsp;<span class="builtintype" id="4336922">bool</span><span class="op" id="4336926">,</span>&nbsp;<span class="ident" id="4336928">message</span>&nbsp;<span class="builtintype" id="4336936">string</span><span class="op" id="4336942">,</span>&nbsp;<span class="ident" id="4336944">err</span>&nbsp;<span class="builtintype" id="4336948">error</span><span class="op" id="4336953">)</span>&nbsp;<span class="op" id="4336955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336958">line</span><span class="op" id="4336962">,</span>&nbsp;<span class="ident" id="4336964"><a href="/gostd/net/textproto/reader.go.html#4336944">err</a></span>&nbsp;<span class="op" id="4336968">:=</span>&nbsp;<span class="ident" id="4336971"><a href="/gostd/net/textproto/reader.go.html#4336861">r</a></span><span class="op" id="4336972">.</span><span class="ident" id="4336973"><a href="/gostd/net/textproto/reader.go.html#4333526">ReadLine</a></span><span class="op" id="4336981">(</span><span class="op" id="4336982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4336985">if</span>&nbsp;<span class="ident" id="4336988"><a href="/gostd/net/textproto/reader.go.html#4336944">err</a></span>&nbsp;<span class="op" id="4336992">!=</span>&nbsp;<span class="builtintype" id="4336995">nil</span>&nbsp;<span class="op" id="4336999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4337003">return</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4337011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4337014">return</span>&nbsp;<span class="ident" id="4337021"><a href="/gostd/net/textproto/reader.go.html#4337061">parseCodeLine</a></span><span class="op" id="4337034">(</span><span class="ident" id="4337035"><a href="/gostd/net/textproto/reader.go.html#4336958">line</a></span><span class="op" id="4337039">,</span>&nbsp;<span class="ident" id="4337041"><a href="/gostd/net/textproto/reader.go.html#4336885">expectCode</a></span><span class="op" id="4337051">)</span><br>
<span class="lineno"></span><span class="op" id="4337053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4337056">func</span>&nbsp;<span class="ident" id="4337061">parseCodeLine</span><span class="op" id="4337074">(</span><span class="ident" id="4337075">line</span>&nbsp;<span class="builtintype" id="4337080">string</span><span class="op" id="4337086">,</span>&nbsp;<span class="ident" id="4337088">expectCode</span>&nbsp;<span class="builtintype" id="4337099">int</span><span class="op" id="4337102">)</span>&nbsp;<span class="op" id="4337104">(</span><span class="ident" id="4337105">code</span>&nbsp;<span class="builtintype" id="4337110">int</span><span class="op" id="4337113">,</span>&nbsp;<span class="ident" id="4337115">continued</span>&nbsp;<span class="builtintype" id="4337125">bool</span><span class="op" id="4337129">,</span>&nbsp;<span class="ident" id="4337131">message</span>&nbsp;<span class="builtintype" id="4337139">string</span><span class="op" id="4337145">,</span>&nbsp;<span class="ident" id="4337147">err</span>&nbsp;<span class="builtintype" id="4337151">error</span><span class="op" id="4337156">)</span>&nbsp;<span class="op" id="4337158">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4337161">if</span>&nbsp;<span class="builtinfunc" id="4337164">len</span><span class="op" id="4337167">(</span><span class="ident" id="4337168"><a href="/gostd/net/textproto/reader.go.html#4337075">line</a></span><span class="op" id="4337172">)</span>&nbsp;<span class="op" id="4337174">&lt;</span>&nbsp;<span class="num" id="4337176">4</span>&nbsp;<span class="op" id="4337178">||</span>&nbsp;<span class="ident" id="4337181"><a href="/gostd/net/textproto/reader.go.html#4337075">line</a></span><span class="op" id="4337185">[</span><span class="num" id="4337186">3</span><span class="op" id="4337187">]</span>&nbsp;<span class="op" id="4337189">!=</span>&nbsp;<span class="string" id="4337192">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4337196">&amp;&amp;</span>&nbsp;<span class="ident" id="4337199"><a href="/gostd/net/textproto/reader.go.html#4337075">line</a></span><span class="op" id="4337203">[</span><span class="num" id="4337204">3</span><span class="op" id="4337205">]</span>&nbsp;<span class="op" id="4337207">!=</span>&nbsp;<span class="string" id="4337210">&#39;-&#39;</span>&nbsp;<span class="op" id="4337214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4337218"><a href="/gostd/net/textproto/reader.go.html#4337147">err</a></span>&nbsp;<span class="op" id="4337222">=</span>&nbsp;<span class="ident" id="4337224"><a href="/gostd/net/textproto/textproto.go.html#4350116">ProtocolError</a></span><span class="op" id="4337237">(</span><span class="string" id="4337238">&#34;short&nbsp;response:&nbsp;&#34;</span>&nbsp;<span class="op" id="4337257">+</span>&nbsp;<span class="ident" id="4337259"><a href="/gostd/net/textproto/reader.go.html#4337075">line</a></span><span class="op" id="4337263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4337267">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4337275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4337278"><a href="/gostd/net/textproto/reader.go.html#4337115">continued</a></span>&nbsp;<span class="op" id="4337288">=</span>&nbsp;<span class="ident" id="4337290"><a href="/gostd/net/textproto/reader.go.html#4337075">line</a></span><span class="op" id="4337294">[</span><span class="num" id="4337295">3</span><span class="op" id="4337296">]</span>&nbsp;<span class="op" id="4337298">==</span>&nbsp;<span class="string" id="4337301">&#39;-&#39;</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4337306"><a href="/gostd/net/textproto/reader.go.html#4337105">code</a></span><span class="op" id="4337310">,</span>&nbsp;<span class="ident" id="4337312"><a href="/gostd/net/textproto/reader.go.html#4337147">err</a></span>&nbsp;<span class="op" id="4337316">=</span>&nbsp;<span class="ident" id="4337318"><a href="/gostd/net/textproto/reader.go.html#4332849">strconv</a></span><span class="op" id="4337325">.</span><span class="ident" id="4337326"><a href="/gostd/strconv/atoi.go.html#2357032">Atoi</a></span><span class="op" id="4337330">(</span><span class="ident" id="4337331"><a href="/gostd/net/textproto/reader.go.html#4337075">line</a></span><span class="op" id="4337335">[</span><span class="num" id="4337336">0</span><span class="op" id="4337337">:</span><span class="num" id="4337338">3</span><span class="op" id="4337339">]</span><span class="op" id="4337340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4337343">if</span>&nbsp;<span class="ident" id="4337346"><a href="/gostd/net/textproto/reader.go.html#4337147">err</a></span>&nbsp;<span class="op" id="4337350">!=</span>&nbsp;<span class="builtintype" id="4337353">nil</span>&nbsp;<span class="op" id="4337357">||</span>&nbsp;<span class="ident" id="4337360"><a href="/gostd/net/textproto/reader.go.html#4337105">code</a></span>&nbsp;<span class="op" id="4337365">&lt;</span>&nbsp;<span class="num" id="4337367">100</span>&nbsp;<span class="op" id="4337371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4337375"><a href="/gostd/net/textproto/reader.go.html#4337147">err</a></span>&nbsp;<span class="op" id="4337379">=</span>&nbsp;<span class="ident" id="4337381"><a href="/gostd/net/textproto/textproto.go.html#4350116">ProtocolError</a></span><span class="op" id="4337394">(</span><span class="string" id="4337395">&#34;invalid&nbsp;response&nbsp;code:&nbsp;&#34;</span>&nbsp;<span class="op" id="4337421">+</span>&nbsp;<span class="ident" id="4337423"><a href="/gostd/net/textproto/reader.go.html#4337075">line</a></span><span class="op" id="4337427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4337431">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4337439">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4337442"><a href="/gostd/net/textproto/reader.go.html#4337131">message</a></span>&nbsp;<span class="op" id="4337450">=</span>&nbsp;<span class="ident" id="4337452"><a href="/gostd/net/textproto/reader.go.html#4337075">line</a></span><span class="op" id="4337456">[</span><span class="num" id="4337457">4</span><span class="op" id="4337458">:</span><span class="op" id="4337459">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4337462">if</span>&nbsp;<span class="num" id="4337465">1</span>&nbsp;<span class="op" id="4337467">&lt;=</span>&nbsp;<span class="ident" id="4337470"><a href="/gostd/net/textproto/reader.go.html#4337088">expectCode</a></span>&nbsp;<span class="op" id="4337481">&amp;&amp;</span>&nbsp;<span class="ident" id="4337484"><a href="/gostd/net/textproto/reader.go.html#4337088">expectCode</a></span>&nbsp;<span class="op" id="4337495">&lt;</span>&nbsp;<span class="num" id="4337497">10</span>&nbsp;<span class="op" id="4337500">&amp;&amp;</span>&nbsp;<span class="ident" id="4337503"><a href="/gostd/net/textproto/reader.go.html#4337105">code</a></span><span class="op" id="4337507">/</span><span class="num" id="4337508">100</span>&nbsp;<span class="op" id="4337512">!=</span>&nbsp;<span class="ident" id="4337515"><a href="/gostd/net/textproto/reader.go.html#4337088">expectCode</a></span>&nbsp;<span class="op" id="4337526">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4337531">10</span>&nbsp;<span class="op" id="4337534">&lt;=</span>&nbsp;<span class="ident" id="4337537"><a href="/gostd/net/textproto/reader.go.html#4337088">expectCode</a></span>&nbsp;<span class="op" id="4337548">&amp;&amp;</span>&nbsp;<span class="ident" id="4337551"><a href="/gostd/net/textproto/reader.go.html#4337088">expectCode</a></span>&nbsp;<span class="op" id="4337562">&lt;</span>&nbsp;<span class="num" id="4337564">100</span>&nbsp;<span class="op" id="4337568">&amp;&amp;</span>&nbsp;<span class="ident" id="4337571"><a href="/gostd/net/textproto/reader.go.html#4337105">code</a></span><span class="op" id="4337575">/</span><span class="num" id="4337576">10</span>&nbsp;<span class="op" id="4337579">!=</span>&nbsp;<span class="ident" id="4337582"><a href="/gostd/net/textproto/reader.go.html#4337088">expectCode</a></span>&nbsp;<span class="op" id="4337593">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4337598">100</span>&nbsp;<span class="op" id="4337602">&lt;=</span>&nbsp;<span class="ident" id="4337605"><a href="/gostd/net/textproto/reader.go.html#4337088">expectCode</a></span>&nbsp;<span class="op" id="4337616">&amp;&amp;</span>&nbsp;<span class="ident" id="4337619"><a href="/gostd/net/textproto/reader.go.html#4337088">expectCode</a></span>&nbsp;<span class="op" id="4337630">&lt;</span>&nbsp;<span class="num" id="4337632">1000</span>&nbsp;<span class="op" id="4337637">&amp;&amp;</span>&nbsp;<span class="ident" id="4337640"><a href="/gostd/net/textproto/reader.go.html#4337105">code</a></span>&nbsp;<span class="op" id="4337645">!=</span>&nbsp;<span class="ident" id="4337648"><a href="/gostd/net/textproto/reader.go.html#4337088">expectCode</a></span>&nbsp;<span class="op" id="4337659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4337663"><a href="/gostd/net/textproto/reader.go.html#4337147">err</a></span>&nbsp;<span class="op" id="4337667">=</span>&nbsp;<span class="op" id="4337669">&amp;</span><span class="ident" id="4337670"><a href="/gostd/net/textproto/textproto.go.html#4349882">Error</a></span><span class="op" id="4337675">{</span><span class="ident" id="4337676"><a href="/gostd/net/textproto/reader.go.html#4337105">code</a></span><span class="op" id="4337680">,</span>&nbsp;<span class="ident" id="4337682"><a href="/gostd/net/textproto/reader.go.html#4337131">message</a></span><span class="op" id="4337689">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4337692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4337695">return</span><br>
<span class="lineno"></span><span class="op" id="4337702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4337705">//&nbsp;ReadCodeLine&nbsp;reads&nbsp;a&nbsp;response&nbsp;code&nbsp;line&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno">205</span><span class="comment" id="4337760">//&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="4337776">//&nbsp;where&nbsp;code&nbsp;is&nbsp;a&nbsp;three-digit&nbsp;status&nbsp;code&nbsp;and&nbsp;the&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="4337835">//&nbsp;extends&nbsp;to&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;line.&nbsp;&nbsp;An&nbsp;example&nbsp;of&nbsp;such&nbsp;a&nbsp;line&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4337902">//&nbsp;&nbsp;&nbsp;&nbsp;220&nbsp;plan9.bell-labs.com&nbsp;ESMTP</span><br>
<span class="lineno"></span><span class="comment" id="4337935">//</span><br>
<span class="lineno">210</span><span class="comment" id="4337938">//&nbsp;If&nbsp;the&nbsp;prefix&nbsp;of&nbsp;the&nbsp;status&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;digits&nbsp;in&nbsp;expectCode,</span><br>
<span class="lineno"></span><span class="comment" id="4338010">//&nbsp;ReadCodeLine&nbsp;returns&nbsp;with&nbsp;err&nbsp;set&nbsp;to&nbsp;&amp;Error{code,&nbsp;message}.</span><br>
<span class="lineno"></span><span class="comment" id="4338073">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;expectCode&nbsp;is&nbsp;31,&nbsp;an&nbsp;error&nbsp;will&nbsp;be&nbsp;returned&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4338139">//&nbsp;the&nbsp;status&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[310,319].</span><br>
<span class="lineno"></span><span class="comment" id="4338184">//</span><br>
<span class="lineno">215</span><span class="comment" id="4338187">//&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;multi-line,&nbsp;ReadCodeLine&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4338252">//</span><br>
<span class="lineno"></span><span class="comment" id="4338255">//&nbsp;An&nbsp;expectCode&nbsp;&lt;=&nbsp;0&nbsp;disables&nbsp;the&nbsp;check&nbsp;of&nbsp;the&nbsp;status&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="4338316">//</span><br>
<span class="lineno"></span><span class="keyword" id="4338319">func</span>&nbsp;<span class="op" id="4338324">(</span><span class="ident" id="4338325">r</span>&nbsp;<span class="op" id="4338327">*</span><span class="ident" id="4338328"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4338334">)</span>&nbsp;<span class="ident" id="4338336">ReadCodeLine</span><span class="op" id="4338348">(</span><span class="ident" id="4338349">expectCode</span>&nbsp;<span class="builtintype" id="4338360">int</span><span class="op" id="4338363">)</span>&nbsp;<span class="op" id="4338365">(</span><span class="ident" id="4338366">code</span>&nbsp;<span class="builtintype" id="4338371">int</span><span class="op" id="4338374">,</span>&nbsp;<span class="ident" id="4338376">message</span>&nbsp;<span class="builtintype" id="4338384">string</span><span class="op" id="4338390">,</span>&nbsp;<span class="ident" id="4338392">err</span>&nbsp;<span class="builtintype" id="4338396">error</span><span class="op" id="4338401">)</span>&nbsp;<span class="op" id="4338403">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4338406"><a href="/gostd/net/textproto/reader.go.html#4338366">code</a></span><span class="op" id="4338410">,</span>&nbsp;<span class="ident" id="4338412">continued</span><span class="op" id="4338421">,</span>&nbsp;<span class="ident" id="4338423"><a href="/gostd/net/textproto/reader.go.html#4338376">message</a></span><span class="op" id="4338430">,</span>&nbsp;<span class="ident" id="4338432"><a href="/gostd/net/textproto/reader.go.html#4338392">err</a></span>&nbsp;<span class="op" id="4338436">:=</span>&nbsp;<span class="ident" id="4338439"><a href="/gostd/net/textproto/reader.go.html#4338325">r</a></span><span class="op" id="4338440">.</span><span class="ident" id="4338441"><a href="/gostd/net/textproto/reader.go.html#4336872">readCodeLine</a></span><span class="op" id="4338453">(</span><span class="ident" id="4338454"><a href="/gostd/net/textproto/reader.go.html#4338349">expectCode</a></span><span class="op" id="4338464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4338467">if</span>&nbsp;<span class="ident" id="4338470"><a href="/gostd/net/textproto/reader.go.html#4338392">err</a></span>&nbsp;<span class="op" id="4338474">==</span>&nbsp;<span class="builtintype" id="4338477">nil</span>&nbsp;<span class="op" id="4338481">&amp;&amp;</span>&nbsp;<span class="ident" id="4338484"><a href="/gostd/net/textproto/reader.go.html#4338412">continued</a></span>&nbsp;<span class="op" id="4338494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4338498"><a href="/gostd/net/textproto/reader.go.html#4338392">err</a></span>&nbsp;<span class="op" id="4338502">=</span>&nbsp;<span class="ident" id="4338504"><a href="/gostd/net/textproto/textproto.go.html#4350116">ProtocolError</a></span><span class="op" id="4338517">(</span><span class="string" id="4338518">&#34;unexpected&nbsp;multi-line&nbsp;response:&nbsp;&#34;</span>&nbsp;<span class="op" id="4338553">+</span>&nbsp;<span class="ident" id="4338555"><a href="/gostd/net/textproto/reader.go.html#4338376">message</a></span><span class="op" id="4338562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4338565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4338568">return</span><br>
<span class="lineno">225</span><span class="op" id="4338575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4338578">//&nbsp;ReadResponse&nbsp;reads&nbsp;a&nbsp;multi-line&nbsp;response&nbsp;of&nbsp;the&nbsp;form:</span><br>
<span class="lineno"></span><span class="comment" id="4338635">//</span><br>
<span class="lineno"></span><span class="comment" id="4338638">//&nbsp;&nbsp;&nbsp;&nbsp;code-message&nbsp;line&nbsp;1</span><br>
<span class="lineno">230</span><span class="comment" id="4338661">//&nbsp;&nbsp;&nbsp;&nbsp;code-message&nbsp;line&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="4338684">//&nbsp;&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="4338691">//&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;message&nbsp;line&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="4338714">//</span><br>
<span class="lineno"></span><span class="comment" id="4338717">//&nbsp;where&nbsp;code&nbsp;is&nbsp;a&nbsp;three-digit&nbsp;status&nbsp;code.&nbsp;The&nbsp;first&nbsp;line&nbsp;starts&nbsp;with&nbsp;the</span><br>
<span class="lineno">235</span><span class="comment" id="4338792">//&nbsp;code&nbsp;and&nbsp;a&nbsp;hyphen.&nbsp;The&nbsp;response&nbsp;is&nbsp;terminated&nbsp;by&nbsp;a&nbsp;line&nbsp;that&nbsp;starts</span><br>
<span class="lineno"></span><span class="comment" id="4338863">//&nbsp;with&nbsp;the&nbsp;same&nbsp;code&nbsp;followed&nbsp;by&nbsp;a&nbsp;space.&nbsp;Each&nbsp;line&nbsp;in&nbsp;message&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4338930">//&nbsp;separated&nbsp;by&nbsp;a&nbsp;newline&nbsp;(\n).</span><br>
<span class="lineno"></span><span class="comment" id="4338962">//</span><br>
<span class="lineno"></span><span class="comment" id="4338965">//&nbsp;See&nbsp;page&nbsp;36&nbsp;of&nbsp;RFC&nbsp;959&nbsp;(http://www.ietf.org/rfc/rfc959.txt)&nbsp;for</span><br>
<span class="lineno">240</span><span class="comment" id="4339032">//&nbsp;details.</span><br>
<span class="lineno"></span><span class="comment" id="4339044">//</span><br>
<span class="lineno"></span><span class="comment" id="4339047">//&nbsp;If&nbsp;the&nbsp;prefix&nbsp;of&nbsp;the&nbsp;status&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;digits&nbsp;in&nbsp;expectCode,</span><br>
<span class="lineno"></span><span class="comment" id="4339119">//&nbsp;ReadResponse&nbsp;returns&nbsp;with&nbsp;err&nbsp;set&nbsp;to&nbsp;&amp;Error{code,&nbsp;message}.</span><br>
<span class="lineno"></span><span class="comment" id="4339182">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;expectCode&nbsp;is&nbsp;31,&nbsp;an&nbsp;error&nbsp;will&nbsp;be&nbsp;returned&nbsp;if</span><br>
<span class="lineno">245</span><span class="comment" id="4339248">//&nbsp;the&nbsp;status&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[310,319].</span><br>
<span class="lineno"></span><span class="comment" id="4339293">//</span><br>
<span class="lineno"></span><span class="comment" id="4339296">//&nbsp;An&nbsp;expectCode&nbsp;&lt;=&nbsp;0&nbsp;disables&nbsp;the&nbsp;check&nbsp;of&nbsp;the&nbsp;status&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="4339357">//</span><br>
<span class="lineno"></span><span class="keyword" id="4339360">func</span>&nbsp;<span class="op" id="4339365">(</span><span class="ident" id="4339366">r</span>&nbsp;<span class="op" id="4339368">*</span><span class="ident" id="4339369"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4339375">)</span>&nbsp;<span class="ident" id="4339377">ReadResponse</span><span class="op" id="4339389">(</span><span class="ident" id="4339390">expectCode</span>&nbsp;<span class="builtintype" id="4339401">int</span><span class="op" id="4339404">)</span>&nbsp;<span class="op" id="4339406">(</span><span class="ident" id="4339407">code</span>&nbsp;<span class="builtintype" id="4339412">int</span><span class="op" id="4339415">,</span>&nbsp;<span class="ident" id="4339417">message</span>&nbsp;<span class="builtintype" id="4339425">string</span><span class="op" id="4339431">,</span>&nbsp;<span class="ident" id="4339433">err</span>&nbsp;<span class="builtintype" id="4339437">error</span><span class="op" id="4339442">)</span>&nbsp;<span class="op" id="4339444">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339447"><a href="/gostd/net/textproto/reader.go.html#4339407">code</a></span><span class="op" id="4339451">,</span>&nbsp;<span class="ident" id="4339453">continued</span><span class="op" id="4339462">,</span>&nbsp;<span class="ident" id="4339464"><a href="/gostd/net/textproto/reader.go.html#4339417">message</a></span><span class="op" id="4339471">,</span>&nbsp;<span class="ident" id="4339473"><a href="/gostd/net/textproto/reader.go.html#4339433">err</a></span>&nbsp;<span class="op" id="4339477">:=</span>&nbsp;<span class="ident" id="4339480"><a href="/gostd/net/textproto/reader.go.html#4339366">r</a></span><span class="op" id="4339481">.</span><span class="ident" id="4339482"><a href="/gostd/net/textproto/reader.go.html#4336872">readCodeLine</a></span><span class="op" id="4339494">(</span><span class="ident" id="4339495"><a href="/gostd/net/textproto/reader.go.html#4339390">expectCode</a></span><span class="op" id="4339505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339508">for</span>&nbsp;<span class="ident" id="4339512"><a href="/gostd/net/textproto/reader.go.html#4339433">err</a></span>&nbsp;<span class="op" id="4339516">==</span>&nbsp;<span class="builtintype" id="4339519">nil</span>&nbsp;<span class="op" id="4339523">&amp;&amp;</span>&nbsp;<span class="ident" id="4339526"><a href="/gostd/net/textproto/reader.go.html#4339453">continued</a></span>&nbsp;<span class="op" id="4339536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339540">line</span><span class="op" id="4339544">,</span>&nbsp;<span class="ident" id="4339546">err</span>&nbsp;<span class="op" id="4339550">:=</span>&nbsp;<span class="ident" id="4339553"><a href="/gostd/net/textproto/reader.go.html#4339366">r</a></span><span class="op" id="4339554">.</span><span class="ident" id="4339555"><a href="/gostd/net/textproto/reader.go.html#4333526">ReadLine</a></span><span class="op" id="4339563">(</span><span class="op" id="4339564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339568">if</span>&nbsp;<span class="ident" id="4339571"><a href="/gostd/net/textproto/reader.go.html#4339546">err</a></span>&nbsp;<span class="op" id="4339575">!=</span>&nbsp;<span class="builtintype" id="4339578">nil</span>&nbsp;<span class="op" id="4339582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339587">return</span>&nbsp;<span class="num" id="4339594">0</span><span class="op" id="4339595">,</span>&nbsp;<span class="string" id="4339597">&#34;&#34;</span><span class="op" id="4339599">,</span>&nbsp;<span class="ident" id="4339601"><a href="/gostd/net/textproto/reader.go.html#4339546">err</a></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339612">var</span>&nbsp;<span class="ident" id="4339616">code2</span>&nbsp;<span class="builtintype" id="4339622">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339628">var</span>&nbsp;<span class="ident" id="4339632">moreMessage</span>&nbsp;<span class="builtintype" id="4339644">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339653"><a href="/gostd/net/textproto/reader.go.html#4339616">code2</a></span><span class="op" id="4339658">,</span>&nbsp;<span class="ident" id="4339660"><a href="/gostd/net/textproto/reader.go.html#4339453">continued</a></span><span class="op" id="4339669">,</span>&nbsp;<span class="ident" id="4339671"><a href="/gostd/net/textproto/reader.go.html#4339632">moreMessage</a></span><span class="op" id="4339682">,</span>&nbsp;<span class="ident" id="4339684"><a href="/gostd/net/textproto/reader.go.html#4339546">err</a></span>&nbsp;<span class="op" id="4339688">=</span>&nbsp;<span class="ident" id="4339690"><a href="/gostd/net/textproto/reader.go.html#4337061">parseCodeLine</a></span><span class="op" id="4339703">(</span><span class="ident" id="4339704"><a href="/gostd/net/textproto/reader.go.html#4339540">line</a></span><span class="op" id="4339708">,</span>&nbsp;<span class="ident" id="4339710"><a href="/gostd/net/textproto/reader.go.html#4339390">expectCode</a></span><span class="op" id="4339720">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339724">if</span>&nbsp;<span class="ident" id="4339727"><a href="/gostd/net/textproto/reader.go.html#4339546">err</a></span>&nbsp;<span class="op" id="4339731">!=</span>&nbsp;<span class="builtintype" id="4339734">nil</span>&nbsp;<span class="op" id="4339738">||</span>&nbsp;<span class="ident" id="4339741"><a href="/gostd/net/textproto/reader.go.html#4339616">code2</a></span>&nbsp;<span class="op" id="4339747">!=</span>&nbsp;<span class="ident" id="4339750"><a href="/gostd/net/textproto/reader.go.html#4339407">code</a></span>&nbsp;<span class="op" id="4339755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339760"><a href="/gostd/net/textproto/reader.go.html#4339417">message</a></span>&nbsp;<span class="op" id="4339768">+=</span>&nbsp;<span class="string" id="4339771">&#34;\n&#34;</span>&nbsp;<span class="op" id="4339776">+</span>&nbsp;<span class="ident" id="4339778"><a href="/gostd/net/textproto/reader.go.html#4332860">strings</a></span><span class="op" id="4339785">.</span><span class="ident" id="4339786"><a href="/gostd/strings/strings.go.html#2982257">TrimRight</a></span><span class="op" id="4339795">(</span><span class="ident" id="4339796"><a href="/gostd/net/textproto/reader.go.html#4339540">line</a></span><span class="op" id="4339800">,</span>&nbsp;<span class="string" id="4339802">&#34;\r\n&#34;</span><span class="op" id="4339808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339813"><a href="/gostd/net/textproto/reader.go.html#4339453">continued</a></span>&nbsp;<span class="op" id="4339823">=</span>&nbsp;<span class="builtintype" id="4339825">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339833">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339844">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339848"><a href="/gostd/net/textproto/reader.go.html#4339417">message</a></span>&nbsp;<span class="op" id="4339856">+=</span>&nbsp;<span class="string" id="4339859">&#34;\n&#34;</span>&nbsp;<span class="op" id="4339864">+</span>&nbsp;<span class="ident" id="4339866"><a href="/gostd/net/textproto/reader.go.html#4339632">moreMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339882">return</span><br>
<span class="lineno"></span><span class="op" id="4339889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="4339892">//&nbsp;DotReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;Reader&nbsp;that&nbsp;satisfies&nbsp;Reads&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4339957">//&nbsp;decoded&nbsp;text&nbsp;of&nbsp;a&nbsp;dot-encoded&nbsp;block&nbsp;read&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4340009">//&nbsp;The&nbsp;returned&nbsp;Reader&nbsp;is&nbsp;only&nbsp;valid&nbsp;until&nbsp;the&nbsp;next&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="4340066">//&nbsp;to&nbsp;a&nbsp;method&nbsp;on&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4340087">//</span><br>
<span class="lineno">275</span><span class="comment" id="4340090">//&nbsp;Dot&nbsp;encoding&nbsp;is&nbsp;a&nbsp;common&nbsp;framing&nbsp;used&nbsp;for&nbsp;data&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="4340147">//&nbsp;in&nbsp;text&nbsp;protocols&nbsp;such&nbsp;as&nbsp;SMTP.&nbsp;&nbsp;The&nbsp;data&nbsp;consists&nbsp;of&nbsp;a&nbsp;sequence</span><br>
<span class="lineno"></span><span class="comment" id="4340215">//&nbsp;of&nbsp;lines,&nbsp;each&nbsp;of&nbsp;which&nbsp;ends&nbsp;in&nbsp;&#34;\r\n&#34;.&nbsp;&nbsp;The&nbsp;sequence&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="4340279">//&nbsp;ends&nbsp;at&nbsp;a&nbsp;line&nbsp;containing&nbsp;just&nbsp;a&nbsp;dot:&nbsp;&#34;.\r\n&#34;.&nbsp;&nbsp;Lines&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="4340346">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;are&nbsp;escaped&nbsp;with&nbsp;an&nbsp;additional&nbsp;dot&nbsp;to&nbsp;avoid</span><br>
<span class="lineno">280</span><span class="comment" id="4340404">//&nbsp;looking&nbsp;like&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="4340445">//</span><br>
<span class="lineno"></span><span class="comment" id="4340448">//&nbsp;The&nbsp;decoded&nbsp;form&nbsp;returned&nbsp;by&nbsp;the&nbsp;Reader&#39;s&nbsp;Read&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="4340505">//&nbsp;rewrites&nbsp;the&nbsp;&#34;\r\n&#34;&nbsp;line&nbsp;endings&nbsp;into&nbsp;the&nbsp;simpler&nbsp;&#34;\n&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="4340564">//&nbsp;removes&nbsp;leading&nbsp;dot&nbsp;escapes&nbsp;if&nbsp;present,&nbsp;and&nbsp;stops&nbsp;with&nbsp;error&nbsp;io.EOF</span><br>
<span class="lineno">285</span><span class="comment" id="4340635">//&nbsp;after&nbsp;consuming&nbsp;(and&nbsp;discarding)&nbsp;the&nbsp;end-of-sequence&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="4340697">func</span>&nbsp;<span class="op" id="4340702">(</span><span class="ident" id="4340703">r</span>&nbsp;<span class="op" id="4340705">*</span><span class="ident" id="4340706"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4340712">)</span>&nbsp;<span class="ident" id="4340714">DotReader</span><span class="op" id="4340723">(</span><span class="op" id="4340724">)</span>&nbsp;<span class="ident" id="4340726"><a href="/gostd/net/textproto/reader.go.html#4332830">io</a></span><span class="op" id="4340728">.</span><span class="ident" id="4340729"><a href="/gostd/io/io.go.html#1421823">Reader</a></span>&nbsp;<span class="op" id="4340736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340739"><a href="/gostd/net/textproto/reader.go.html#4340703">r</a></span><span class="op" id="4340740">.</span><span class="ident" id="4340741"><a href="/gostd/net/textproto/reader.go.html#4342775">closeDot</a></span><span class="op" id="4340749">(</span><span class="op" id="4340750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340753"><a href="/gostd/net/textproto/reader.go.html#4340703">r</a></span><span class="op" id="4340754">.</span><span class="ident" id="4340755"><a href="/gostd/net/textproto/reader.go.html#4333215">dot</a></span>&nbsp;<span class="op" id="4340759">=</span>&nbsp;<span class="op" id="4340761">&amp;</span><span class="ident" id="4340762"><a href="/gostd/net/textproto/reader.go.html#4340800">dotReader</a></span><span class="op" id="4340771">{</span><span class="ident" id="4340772"><a href="/gostd/net/textproto/reader.go.html#4340820">r</a></span><span class="op" id="4340773">:</span>&nbsp;<span class="ident" id="4340775"><a href="/gostd/net/textproto/reader.go.html#4340703">r</a></span><span class="op" id="4340776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340779">return</span>&nbsp;<span class="ident" id="4340786"><a href="/gostd/net/textproto/reader.go.html#4340703">r</a></span><span class="op" id="4340787">.</span><span class="ident" id="4340788"><a href="/gostd/net/textproto/reader.go.html#4333215">dot</a></span><br>
<span class="lineno">290</span><span class="op" id="4340792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4340795">type</span>&nbsp;<span class="ident" id="4340800">dotReader</span>&nbsp;<span class="keyword" id="4340810">struct</span>&nbsp;<span class="op" id="4340817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340820">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4340826">*</span><span class="ident" id="4340827"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340835">state</span>&nbsp;<span class="builtintype" id="4340841">int</span><br>
<span class="lineno">295</span><span class="op" id="4340845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4340848">//&nbsp;Read&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;decoding&nbsp;dot-encoded&nbsp;data&nbsp;read&nbsp;from&nbsp;d.r.</span><br>
<span class="lineno"></span><span class="keyword" id="4340916">func</span>&nbsp;<span class="op" id="4340921">(</span><span class="ident" id="4340922">d</span>&nbsp;<span class="op" id="4340924">*</span><span class="ident" id="4340925"><a href="/gostd/net/textproto/reader.go.html#4340800">dotReader</a></span><span class="op" id="4340934">)</span>&nbsp;<span class="ident" id="4340936">Read</span><span class="op" id="4340940">(</span><span class="ident" id="4340941">b</span>&nbsp;<span class="op" id="4340943">[</span><span class="op" id="4340944">]</span><span class="builtintype" id="4340945">byte</span><span class="op" id="4340949">)</span>&nbsp;<span class="op" id="4340951">(</span><span class="ident" id="4340952">n</span>&nbsp;<span class="builtintype" id="4340954">int</span><span class="op" id="4340957">,</span>&nbsp;<span class="ident" id="4340959">err</span>&nbsp;<span class="builtintype" id="4340963">error</span><span class="op" id="4340968">)</span>&nbsp;<span class="op" id="4340970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4340973">//&nbsp;Run&nbsp;data&nbsp;through&nbsp;a&nbsp;simple&nbsp;state&nbsp;machine&nbsp;to</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4341020">//&nbsp;elide&nbsp;leading&nbsp;dots,&nbsp;rewrite&nbsp;trailing&nbsp;\r\n&nbsp;into&nbsp;\n,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4341075">//&nbsp;and&nbsp;detect&nbsp;ending&nbsp;.\r\n&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341109">const</span>&nbsp;<span class="op" id="4341115">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341119">stateBeginLine</span>&nbsp;<span class="op" id="4341134">=</span>&nbsp;<span class="ident" id="4341136">iota</span>&nbsp;<span class="comment" id="4341141">//&nbsp;beginning&nbsp;of&nbsp;line;&nbsp;initial&nbsp;state;&nbsp;must&nbsp;be&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341193">stateDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4341215">//&nbsp;read&nbsp;.&nbsp;at&nbsp;beginning&nbsp;of&nbsp;line</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341248">stateDotCR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4341270">//&nbsp;read&nbsp;.\r&nbsp;at&nbsp;beginning&nbsp;of&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341305">stateCR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4341327">//&nbsp;read&nbsp;\r&nbsp;(possibly&nbsp;at&nbsp;end&nbsp;of&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341366">stateData</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4341388">//&nbsp;reading&nbsp;data&nbsp;in&nbsp;middle&nbsp;of&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341424">stateEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4341446">//&nbsp;reached&nbsp;.\r\n&nbsp;end&nbsp;marker&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4341480">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341483">br</span>&nbsp;<span class="op" id="4341486">:=</span>&nbsp;<span class="ident" id="4341489"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4341490">.</span><span class="ident" id="4341491"><a href="/gostd/net/textproto/reader.go.html#4340820">r</a></span><span class="op" id="4341492">.</span><span class="ident" id="4341493"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341496">for</span>&nbsp;<span class="ident" id="4341500"><a href="/gostd/net/textproto/reader.go.html#4340952">n</a></span>&nbsp;<span class="op" id="4341502">&lt;</span>&nbsp;<span class="builtinfunc" id="4341504">len</span><span class="op" id="4341507">(</span><span class="ident" id="4341508"><a href="/gostd/net/textproto/reader.go.html#4340941">b</a></span><span class="op" id="4341509">)</span>&nbsp;<span class="op" id="4341511">&amp;&amp;</span>&nbsp;<span class="ident" id="4341514"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4341515">.</span><span class="ident" id="4341516"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4341522">!=</span>&nbsp;<span class="ident" id="4341525"><a href="/gostd/net/textproto/reader.go.html#4341424">stateEOF</a></span>&nbsp;<span class="op" id="4341534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341538">var</span>&nbsp;<span class="ident" id="4341542">c</span>&nbsp;<span class="builtintype" id="4341544">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341551"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span><span class="op" id="4341552">,</span>&nbsp;<span class="ident" id="4341554"><a href="/gostd/net/textproto/reader.go.html#4340959">err</a></span>&nbsp;<span class="op" id="4341558">=</span>&nbsp;<span class="ident" id="4341560"><a href="/gostd/net/textproto/reader.go.html#4341483">br</a></span><span class="op" id="4341562">.</span><span class="ident" id="4341563"><a href="/gostd/bufio/bufio.go.html#1358635">ReadByte</a></span><span class="op" id="4341571">(</span><span class="op" id="4341572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341576">if</span>&nbsp;<span class="ident" id="4341579"><a href="/gostd/net/textproto/reader.go.html#4340959">err</a></span>&nbsp;<span class="op" id="4341583">!=</span>&nbsp;<span class="builtintype" id="4341586">nil</span>&nbsp;<span class="op" id="4341590">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341595">if</span>&nbsp;<span class="ident" id="4341598"><a href="/gostd/net/textproto/reader.go.html#4340959">err</a></span>&nbsp;<span class="op" id="4341602">==</span>&nbsp;<span class="ident" id="4341605"><a href="/gostd/net/textproto/reader.go.html#4332830">io</a></span><span class="op" id="4341607">.</span><span class="ident" id="4341608"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="4341612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341618"><a href="/gostd/net/textproto/reader.go.html#4340959">err</a></span>&nbsp;<span class="op" id="4341622">=</span>&nbsp;<span class="ident" id="4341624"><a href="/gostd/net/textproto/reader.go.html#4332830">io</a></span><span class="op" id="4341626">.</span><span class="ident" id="4341627"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4341647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341652">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4341660">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341664">switch</span>&nbsp;<span class="ident" id="4341671"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4341672">.</span><span class="ident" id="4341673"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4341679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341683">case</span>&nbsp;<span class="ident" id="4341688"><a href="/gostd/net/textproto/reader.go.html#4341119">stateBeginLine</a></span><span class="op" id="4341702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341707">if</span>&nbsp;<span class="ident" id="4341710"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4341712">==</span>&nbsp;<span class="string" id="4341715">&#39;.&#39;</span>&nbsp;<span class="op" id="4341719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341725"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4341726">.</span><span class="ident" id="4341727"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4341733">=</span>&nbsp;<span class="ident" id="4341735"><a href="/gostd/net/textproto/reader.go.html#4341193">stateDot</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341748">continue</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4341760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341765">if</span>&nbsp;<span class="ident" id="4341768"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4341770">==</span>&nbsp;<span class="string" id="4341773">&#39;\r&#39;</span>&nbsp;<span class="op" id="4341778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341784"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4341785">.</span><span class="ident" id="4341786"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4341792">=</span>&nbsp;<span class="ident" id="4341794"><a href="/gostd/net/textproto/reader.go.html#4341305">stateCR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341806">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4341818">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341823"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4341824">.</span><span class="ident" id="4341825"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4341831">=</span>&nbsp;<span class="ident" id="4341833"><a href="/gostd/net/textproto/reader.go.html#4341366">stateData</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341846">case</span>&nbsp;<span class="ident" id="4341851"><a href="/gostd/net/textproto/reader.go.html#4341193">stateDot</a></span><span class="op" id="4341859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341864">if</span>&nbsp;<span class="ident" id="4341867"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4341869">==</span>&nbsp;<span class="string" id="4341872">&#39;\r&#39;</span>&nbsp;<span class="op" id="4341877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341883"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4341884">.</span><span class="ident" id="4341885"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4341891">=</span>&nbsp;<span class="ident" id="4341893"><a href="/gostd/net/textproto/reader.go.html#4341248">stateDotCR</a></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341908">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4341920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341925">if</span>&nbsp;<span class="ident" id="4341928"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4341930">==</span>&nbsp;<span class="string" id="4341933">&#39;\n&#39;</span>&nbsp;<span class="op" id="4341938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341944"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4341945">.</span><span class="ident" id="4341946"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4341952">=</span>&nbsp;<span class="ident" id="4341954"><a href="/gostd/net/textproto/reader.go.html#4341424">stateEOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4341967">continue</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4341979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4341984"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4341985">.</span><span class="ident" id="4341986"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4341992">=</span>&nbsp;<span class="ident" id="4341994"><a href="/gostd/net/textproto/reader.go.html#4341366">stateData</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342007">case</span>&nbsp;<span class="ident" id="4342012"><a href="/gostd/net/textproto/reader.go.html#4341248">stateDotCR</a></span><span class="op" id="4342022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342027">if</span>&nbsp;<span class="ident" id="4342030"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4342032">==</span>&nbsp;<span class="string" id="4342035">&#39;\n&#39;</span>&nbsp;<span class="op" id="4342040">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342046"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4342047">.</span><span class="ident" id="4342048"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4342054">=</span>&nbsp;<span class="ident" id="4342056"><a href="/gostd/net/textproto/reader.go.html#4341424">stateEOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342069">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4342086">//&nbsp;Not&nbsp;part&nbsp;of&nbsp;.\r\n.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4342111">//&nbsp;Consume&nbsp;leading&nbsp;dot&nbsp;and&nbsp;emit&nbsp;saved&nbsp;\r.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342156"><a href="/gostd/net/textproto/reader.go.html#4341483">br</a></span><span class="op" id="4342158">.</span><span class="ident" id="4342159"><a href="/gostd/bufio/bufio.go.html#1358954">UnreadByte</a></span><span class="op" id="4342169">(</span><span class="op" id="4342170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342175"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4342177">=</span>&nbsp;<span class="string" id="4342179">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342187"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4342188">.</span><span class="ident" id="4342189"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4342195">=</span>&nbsp;<span class="ident" id="4342197"><a href="/gostd/net/textproto/reader.go.html#4341366">stateData</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342210">case</span>&nbsp;<span class="ident" id="4342215"><a href="/gostd/net/textproto/reader.go.html#4341305">stateCR</a></span><span class="op" id="4342222">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342227">if</span>&nbsp;<span class="ident" id="4342230"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4342232">==</span>&nbsp;<span class="string" id="4342235">&#39;\n&#39;</span>&nbsp;<span class="op" id="4342240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342246"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4342247">.</span><span class="ident" id="4342248"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4342254">=</span>&nbsp;<span class="ident" id="4342256"><a href="/gostd/net/textproto/reader.go.html#4341119">stateBeginLine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342275">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4342289">//&nbsp;Not&nbsp;part&nbsp;of&nbsp;\r\n.&nbsp;&nbsp;Emit&nbsp;saved&nbsp;\r</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342328"><a href="/gostd/net/textproto/reader.go.html#4341483">br</a></span><span class="op" id="4342330">.</span><span class="ident" id="4342331"><a href="/gostd/bufio/bufio.go.html#1358954">UnreadByte</a></span><span class="op" id="4342341">(</span><span class="op" id="4342342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342347"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4342349">=</span>&nbsp;<span class="string" id="4342351">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342359"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4342360">.</span><span class="ident" id="4342361"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4342367">=</span>&nbsp;<span class="ident" id="4342369"><a href="/gostd/net/textproto/reader.go.html#4341366">stateData</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342382">case</span>&nbsp;<span class="ident" id="4342387"><a href="/gostd/net/textproto/reader.go.html#4341366">stateData</a></span><span class="op" id="4342396">:</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342401">if</span>&nbsp;<span class="ident" id="4342404"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4342406">==</span>&nbsp;<span class="string" id="4342409">&#39;\r&#39;</span>&nbsp;<span class="op" id="4342414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342420"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4342421">.</span><span class="ident" id="4342422"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4342428">=</span>&nbsp;<span class="ident" id="4342430"><a href="/gostd/net/textproto/reader.go.html#4341305">stateCR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342442">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342459">if</span>&nbsp;<span class="ident" id="4342462"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span>&nbsp;<span class="op" id="4342464">==</span>&nbsp;<span class="string" id="4342467">&#39;\n&#39;</span>&nbsp;<span class="op" id="4342472">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342478"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4342479">.</span><span class="ident" id="4342480"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4342486">=</span>&nbsp;<span class="ident" id="4342488"><a href="/gostd/net/textproto/reader.go.html#4341119">stateBeginLine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342514"><a href="/gostd/net/textproto/reader.go.html#4340941">b</a></span><span class="op" id="4342515">[</span><span class="ident" id="4342516"><a href="/gostd/net/textproto/reader.go.html#4340952">n</a></span><span class="op" id="4342517">]</span>&nbsp;<span class="op" id="4342519">=</span>&nbsp;<span class="ident" id="4342521"><a href="/gostd/net/textproto/reader.go.html#4341542">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342525"><a href="/gostd/net/textproto/reader.go.html#4340952">n</a></span><span class="op" id="4342526">++</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342533">if</span>&nbsp;<span class="ident" id="4342536"><a href="/gostd/net/textproto/reader.go.html#4340959">err</a></span>&nbsp;<span class="op" id="4342540">==</span>&nbsp;<span class="builtintype" id="4342543">nil</span>&nbsp;<span class="op" id="4342547">&amp;&amp;</span>&nbsp;<span class="ident" id="4342550"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4342551">.</span><span class="ident" id="4342552"><a href="/gostd/net/textproto/reader.go.html#4340835">state</a></span>&nbsp;<span class="op" id="4342558">==</span>&nbsp;<span class="ident" id="4342561"><a href="/gostd/net/textproto/reader.go.html#4341424">stateEOF</a></span>&nbsp;<span class="op" id="4342570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342574"><a href="/gostd/net/textproto/reader.go.html#4340959">err</a></span>&nbsp;<span class="op" id="4342578">=</span>&nbsp;<span class="ident" id="4342580"><a href="/gostd/net/textproto/reader.go.html#4332830">io</a></span><span class="op" id="4342582">.</span><span class="ident" id="4342583"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342591">if</span>&nbsp;<span class="ident" id="4342594"><a href="/gostd/net/textproto/reader.go.html#4340959">err</a></span>&nbsp;<span class="op" id="4342598">!=</span>&nbsp;<span class="builtintype" id="4342601">nil</span>&nbsp;<span class="op" id="4342605">&amp;&amp;</span>&nbsp;<span class="ident" id="4342608"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4342609">.</span><span class="ident" id="4342610"><a href="/gostd/net/textproto/reader.go.html#4340820">r</a></span><span class="op" id="4342611">.</span><span class="ident" id="4342612"><a href="/gostd/net/textproto/reader.go.html#4333215">dot</a></span>&nbsp;<span class="op" id="4342616">==</span>&nbsp;<span class="ident" id="4342619"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span>&nbsp;<span class="op" id="4342621">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342625"><a href="/gostd/net/textproto/reader.go.html#4340922">d</a></span><span class="op" id="4342626">.</span><span class="ident" id="4342627"><a href="/gostd/net/textproto/reader.go.html#4340820">r</a></span><span class="op" id="4342628">.</span><span class="ident" id="4342629"><a href="/gostd/net/textproto/reader.go.html#4333215">dot</a></span>&nbsp;<span class="op" id="4342633">=</span>&nbsp;<span class="builtintype" id="4342635">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342643">return</span><br>
<span class="lineno"></span><span class="op" id="4342650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="4342653">//&nbsp;closeDot&nbsp;drains&nbsp;the&nbsp;current&nbsp;DotReader&nbsp;if&nbsp;any,</span><br>
<span class="lineno"></span><span class="comment" id="4342702">//&nbsp;making&nbsp;sure&nbsp;that&nbsp;it&nbsp;reads&nbsp;until&nbsp;the&nbsp;ending&nbsp;dot&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="4342758">func</span>&nbsp;<span class="op" id="4342763">(</span><span class="ident" id="4342764">r</span>&nbsp;<span class="op" id="4342766">*</span><span class="ident" id="4342767"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4342773">)</span>&nbsp;<span class="ident" id="4342775">closeDot</span><span class="op" id="4342783">(</span><span class="op" id="4342784">)</span>&nbsp;<span class="op" id="4342786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342789">if</span>&nbsp;<span class="ident" id="4342792"><a href="/gostd/net/textproto/reader.go.html#4342764">r</a></span><span class="op" id="4342793">.</span><span class="ident" id="4342794"><a href="/gostd/net/textproto/reader.go.html#4333215">dot</a></span>&nbsp;<span class="op" id="4342798">==</span>&nbsp;<span class="builtintype" id="4342801">nil</span>&nbsp;<span class="op" id="4342805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342809">return</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342820">buf</span>&nbsp;<span class="op" id="4342824">:=</span>&nbsp;<span class="builtinfunc" id="4342827">make</span><span class="op" id="4342831">(</span><span class="op" id="4342832">[</span><span class="op" id="4342833">]</span><span class="builtintype" id="4342834">byte</span><span class="op" id="4342838">,</span>&nbsp;<span class="num" id="4342840">128</span><span class="op" id="4342843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4342846">for</span>&nbsp;<span class="ident" id="4342850"><a href="/gostd/net/textproto/reader.go.html#4342764">r</a></span><span class="op" id="4342851">.</span><span class="ident" id="4342852"><a href="/gostd/net/textproto/reader.go.html#4333215">dot</a></span>&nbsp;<span class="op" id="4342856">!=</span>&nbsp;<span class="builtintype" id="4342859">nil</span>&nbsp;<span class="op" id="4342863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4342867">//&nbsp;When&nbsp;Read&nbsp;reaches&nbsp;EOF&nbsp;or&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4342907">//&nbsp;it&nbsp;will&nbsp;set&nbsp;r.dot&nbsp;==&nbsp;nil.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4342938"><a href="/gostd/net/textproto/reader.go.html#4342764">r</a></span><span class="op" id="4342939">.</span><span class="ident" id="4342940"><a href="/gostd/net/textproto/reader.go.html#4333215">dot</a></span><span class="op" id="4342943">.</span><span class="ident" id="4342944"><a href="/gostd/net/textproto/reader.go.html#4340936">Read</a></span><span class="op" id="4342948">(</span><span class="ident" id="4342949"><a href="/gostd/net/textproto/reader.go.html#4342820">buf</a></span><span class="op" id="4342952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4342955">}</span><br>
<span class="lineno"></span><span class="op" id="4342957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4342960">//&nbsp;ReadDotBytes&nbsp;reads&nbsp;a&nbsp;dot-encoding&nbsp;and&nbsp;returns&nbsp;the&nbsp;decoded&nbsp;data.</span><br>
<span class="lineno">400</span><span class="comment" id="4343027">//</span><br>
<span class="lineno"></span><span class="comment" id="4343030">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;the&nbsp;DotReader&nbsp;method&nbsp;for&nbsp;details&nbsp;about&nbsp;dot-encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="4343112">func</span>&nbsp;<span class="op" id="4343117">(</span><span class="ident" id="4343118">r</span>&nbsp;<span class="op" id="4343120">*</span><span class="ident" id="4343121"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4343127">)</span>&nbsp;<span class="ident" id="4343129">ReadDotBytes</span><span class="op" id="4343141">(</span><span class="op" id="4343142">)</span>&nbsp;<span class="op" id="4343144">(</span><span class="op" id="4343145">[</span><span class="op" id="4343146">]</span><span class="builtintype" id="4343147">byte</span><span class="op" id="4343151">,</span>&nbsp;<span class="builtintype" id="4343153">error</span><span class="op" id="4343158">)</span>&nbsp;<span class="op" id="4343160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343163">return</span>&nbsp;<span class="ident" id="4343170"><a href="/gostd/net/textproto/reader.go.html#4332836">ioutil</a></span><span class="op" id="4343176">.</span><span class="ident" id="4343177"><a href="/gostd/io/ioutil/ioutil.go.html#3765117">ReadAll</a></span><span class="op" id="4343184">(</span><span class="ident" id="4343185"><a href="/gostd/net/textproto/reader.go.html#4343118">r</a></span><span class="op" id="4343186">.</span><span class="ident" id="4343187"><a href="/gostd/net/textproto/reader.go.html#4340714">DotReader</a></span><span class="op" id="4343196">(</span><span class="op" id="4343197">)</span><span class="op" id="4343198">)</span><br>
<span class="lineno"></span><span class="op" id="4343200">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="4343203">//&nbsp;ReadDotLines&nbsp;reads&nbsp;a&nbsp;dot-encoding&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4343260">//&nbsp;containing&nbsp;the&nbsp;decoded&nbsp;lines,&nbsp;with&nbsp;the&nbsp;final&nbsp;\r\n&nbsp;or&nbsp;\n&nbsp;elided&nbsp;from&nbsp;each.</span><br>
<span class="lineno"></span><span class="comment" id="4343337">//</span><br>
<span class="lineno"></span><span class="comment" id="4343340">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;the&nbsp;DotReader&nbsp;method&nbsp;for&nbsp;details&nbsp;about&nbsp;dot-encoding.</span><br>
<span class="lineno">410</span><span class="keyword" id="4343422">func</span>&nbsp;<span class="op" id="4343427">(</span><span class="ident" id="4343428">r</span>&nbsp;<span class="op" id="4343430">*</span><span class="ident" id="4343431"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4343437">)</span>&nbsp;<span class="ident" id="4343439">ReadDotLines</span><span class="op" id="4343451">(</span><span class="op" id="4343452">)</span>&nbsp;<span class="op" id="4343454">(</span><span class="op" id="4343455">[</span><span class="op" id="4343456">]</span><span class="builtintype" id="4343457">string</span><span class="op" id="4343463">,</span>&nbsp;<span class="builtintype" id="4343465">error</span><span class="op" id="4343470">)</span>&nbsp;<span class="op" id="4343472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4343475">//&nbsp;We&nbsp;could&nbsp;use&nbsp;ReadDotBytes&nbsp;and&nbsp;then&nbsp;Split&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4343524">//&nbsp;but&nbsp;reading&nbsp;a&nbsp;line&nbsp;at&nbsp;a&nbsp;time&nbsp;avoids&nbsp;needing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4343574">//&nbsp;large&nbsp;contiguous&nbsp;block&nbsp;of&nbsp;memory&nbsp;and&nbsp;is&nbsp;simpler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343627">var</span>&nbsp;<span class="ident" id="4343631">v</span>&nbsp;<span class="op" id="4343633">[</span><span class="op" id="4343634">]</span><span class="builtintype" id="4343635">string</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343643">var</span>&nbsp;<span class="ident" id="4343647">err</span>&nbsp;<span class="builtintype" id="4343651">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343658">for</span>&nbsp;<span class="op" id="4343662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343666">var</span>&nbsp;<span class="ident" id="4343670">line</span>&nbsp;<span class="builtintype" id="4343675">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4343684"><a href="/gostd/net/textproto/reader.go.html#4343670">line</a></span><span class="op" id="4343688">,</span>&nbsp;<span class="ident" id="4343690"><a href="/gostd/net/textproto/reader.go.html#4343647">err</a></span>&nbsp;<span class="op" id="4343694">=</span>&nbsp;<span class="ident" id="4343696"><a href="/gostd/net/textproto/reader.go.html#4343428">r</a></span><span class="op" id="4343697">.</span><span class="ident" id="4343698"><a href="/gostd/net/textproto/reader.go.html#4333526">ReadLine</a></span><span class="op" id="4343706">(</span><span class="op" id="4343707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343711">if</span>&nbsp;<span class="ident" id="4343714"><a href="/gostd/net/textproto/reader.go.html#4343647">err</a></span>&nbsp;<span class="op" id="4343718">!=</span>&nbsp;<span class="builtintype" id="4343721">nil</span>&nbsp;<span class="op" id="4343725">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343730">if</span>&nbsp;<span class="ident" id="4343733"><a href="/gostd/net/textproto/reader.go.html#4343647">err</a></span>&nbsp;<span class="op" id="4343737">==</span>&nbsp;<span class="ident" id="4343740"><a href="/gostd/net/textproto/reader.go.html#4332830">io</a></span><span class="op" id="4343742">.</span><span class="ident" id="4343743"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="4343747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4343753"><a href="/gostd/net/textproto/reader.go.html#4343647">err</a></span>&nbsp;<span class="op" id="4343757">=</span>&nbsp;<span class="ident" id="4343759"><a href="/gostd/net/textproto/reader.go.html#4332830">io</a></span><span class="op" id="4343761">.</span><span class="ident" id="4343762"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4343782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343787">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4343795">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4343800">//&nbsp;Dot&nbsp;by&nbsp;itself&nbsp;marks&nbsp;end;&nbsp;otherwise&nbsp;cut&nbsp;one&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343853">if</span>&nbsp;<span class="builtinfunc" id="4343856">len</span><span class="op" id="4343859">(</span><span class="ident" id="4343860"><a href="/gostd/net/textproto/reader.go.html#4343670">line</a></span><span class="op" id="4343864">)</span>&nbsp;<span class="op" id="4343866">&gt;</span>&nbsp;<span class="num" id="4343868">0</span>&nbsp;<span class="op" id="4343870">&amp;&amp;</span>&nbsp;<span class="ident" id="4343873"><a href="/gostd/net/textproto/reader.go.html#4343670">line</a></span><span class="op" id="4343877">[</span><span class="num" id="4343878">0</span><span class="op" id="4343879">]</span>&nbsp;<span class="op" id="4343881">==</span>&nbsp;<span class="string" id="4343884">&#39;.&#39;</span>&nbsp;<span class="op" id="4343888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343893">if</span>&nbsp;<span class="builtinfunc" id="4343896">len</span><span class="op" id="4343899">(</span><span class="ident" id="4343900"><a href="/gostd/net/textproto/reader.go.html#4343670">line</a></span><span class="op" id="4343904">)</span>&nbsp;<span class="op" id="4343906">==</span>&nbsp;<span class="num" id="4343909">1</span>&nbsp;<span class="op" id="4343911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343917">break</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4343926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4343931"><a href="/gostd/net/textproto/reader.go.html#4343670">line</a></span>&nbsp;<span class="op" id="4343936">=</span>&nbsp;<span class="ident" id="4343938"><a href="/gostd/net/textproto/reader.go.html#4343670">line</a></span><span class="op" id="4343942">[</span><span class="num" id="4343943">1</span><span class="op" id="4343944">:</span><span class="op" id="4343945">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4343949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4343953"><a href="/gostd/net/textproto/reader.go.html#4343631">v</a></span>&nbsp;<span class="op" id="4343955">=</span>&nbsp;<span class="builtinfunc" id="4343957">append</span><span class="op" id="4343963">(</span><span class="ident" id="4343964"><a href="/gostd/net/textproto/reader.go.html#4343631">v</a></span><span class="op" id="4343965">,</span>&nbsp;<span class="ident" id="4343967"><a href="/gostd/net/textproto/reader.go.html#4343670">line</a></span><span class="op" id="4343971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4343974">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343977">return</span>&nbsp;<span class="ident" id="4343984"><a href="/gostd/net/textproto/reader.go.html#4343631">v</a></span><span class="op" id="4343985">,</span>&nbsp;<span class="ident" id="4343987"><a href="/gostd/net/textproto/reader.go.html#4343647">err</a></span><br>
<span class="lineno"></span><span class="op" id="4343991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4343994">//&nbsp;ReadMIMEHeader&nbsp;reads&nbsp;a&nbsp;MIME-style&nbsp;header&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4344046">//&nbsp;The&nbsp;header&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;possibly&nbsp;continued&nbsp;Key:&nbsp;Value&nbsp;lines</span><br>
<span class="lineno">440</span><span class="comment" id="4344113">//&nbsp;ending&nbsp;in&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span><span class="comment" id="4344140">//&nbsp;The&nbsp;returned&nbsp;map&nbsp;m&nbsp;maps&nbsp;CanonicalMIMEHeaderKey(key)&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4344200">//&nbsp;sequence&nbsp;of&nbsp;values&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;encountered&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="4344266">//</span><br>
<span class="lineno"></span><span class="comment" id="4344269">//&nbsp;For&nbsp;example,&nbsp;consider&nbsp;this&nbsp;input:</span><br>
<span class="lineno">445</span><span class="comment" id="4344306">//</span><br>
<span class="lineno"></span><span class="comment" id="4344309">//&nbsp;&nbsp;&nbsp;&nbsp;My-Key:&nbsp;Value&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="4344328">//&nbsp;&nbsp;&nbsp;&nbsp;Long-Key:&nbsp;Even</span><br>
<span class="lineno"></span><span class="comment" id="4344346">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Longer&nbsp;Value</span><br>
<span class="lineno"></span><span class="comment" id="4344369">//&nbsp;&nbsp;&nbsp;&nbsp;My-Key:&nbsp;Value&nbsp;2</span><br>
<span class="lineno">450</span><span class="comment" id="4344388">//</span><br>
<span class="lineno"></span><span class="comment" id="4344391">//&nbsp;Given&nbsp;that&nbsp;input,&nbsp;ReadMIMEHeader&nbsp;returns&nbsp;the&nbsp;map:</span><br>
<span class="lineno"></span><span class="comment" id="4344444">//</span><br>
<span class="lineno"></span><span class="comment" id="4344447">//&nbsp;&nbsp;&nbsp;&nbsp;map[string][]string{</span><br>
<span class="lineno"></span><span class="comment" id="4344471">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;My-Key&#34;:&nbsp;{&#34;Value&nbsp;1&#34;,&nbsp;&#34;Value&nbsp;2&#34;},</span><br>
<span class="lineno">455</span><span class="comment" id="4344509">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;Long-Key&#34;:&nbsp;{&#34;Even&nbsp;Longer&nbsp;Value&#34;},</span><br>
<span class="lineno"></span><span class="comment" id="4344548">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4344553">//</span><br>
<span class="lineno"></span><span class="keyword" id="4344556">func</span>&nbsp;<span class="op" id="4344561">(</span><span class="ident" id="4344562">r</span>&nbsp;<span class="op" id="4344564">*</span><span class="ident" id="4344565"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4344571">)</span>&nbsp;<span class="ident" id="4344573">ReadMIMEHeader</span><span class="op" id="4344587">(</span><span class="op" id="4344588">)</span>&nbsp;<span class="op" id="4344590">(</span><span class="ident" id="4344591"><a href="/gostd/net/textproto/header.go.html#4328626">MIMEHeader</a></span><span class="op" id="4344601">,</span>&nbsp;<span class="builtintype" id="4344603">error</span><span class="op" id="4344608">)</span>&nbsp;<span class="op" id="4344610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344613">//&nbsp;Avoid&nbsp;lots&nbsp;of&nbsp;small&nbsp;slice&nbsp;allocations&nbsp;later&nbsp;by&nbsp;allocating&nbsp;one</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344679">//&nbsp;large&nbsp;one&nbsp;ahead&nbsp;of&nbsp;time&nbsp;which&nbsp;we&#39;ll&nbsp;cut&nbsp;up&nbsp;into&nbsp;smaller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344739">//&nbsp;slices.&nbsp;If&nbsp;this&nbsp;isn&#39;t&nbsp;big&nbsp;enough&nbsp;later,&nbsp;we&nbsp;allocate&nbsp;small&nbsp;ones.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4344807">var</span>&nbsp;<span class="ident" id="4344811">strs</span>&nbsp;<span class="op" id="4344816">[</span><span class="op" id="4344817">]</span><span class="builtintype" id="4344818">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344826">hint</span>&nbsp;<span class="op" id="4344831">:=</span>&nbsp;<span class="ident" id="4344834"><a href="/gostd/net/textproto/reader.go.html#4344562">r</a></span><span class="op" id="4344835">.</span><span class="ident" id="4344836"><a href="/gostd/net/textproto/reader.go.html#4346134">upcomingHeaderNewlines</a></span><span class="op" id="4344858">(</span><span class="op" id="4344859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4344862">if</span>&nbsp;<span class="ident" id="4344865"><a href="/gostd/net/textproto/reader.go.html#4344826">hint</a></span>&nbsp;<span class="op" id="4344870">&gt;</span>&nbsp;<span class="num" id="4344872">0</span>&nbsp;<span class="op" id="4344874">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344878"><a href="/gostd/net/textproto/reader.go.html#4344811">strs</a></span>&nbsp;<span class="op" id="4344883">=</span>&nbsp;<span class="builtinfunc" id="4344885">make</span><span class="op" id="4344889">(</span><span class="op" id="4344890">[</span><span class="op" id="4344891">]</span><span class="builtintype" id="4344892">string</span><span class="op" id="4344898">,</span>&nbsp;<span class="ident" id="4344900"><a href="/gostd/net/textproto/reader.go.html#4344826">hint</a></span><span class="op" id="4344904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4344907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344911">m</span>&nbsp;<span class="op" id="4344913">:=</span>&nbsp;<span class="builtinfunc" id="4344916">make</span><span class="op" id="4344920">(</span><span class="ident" id="4344921"><a href="/gostd/net/textproto/header.go.html#4328626">MIMEHeader</a></span><span class="op" id="4344931">,</span>&nbsp;<span class="ident" id="4344933"><a href="/gostd/net/textproto/reader.go.html#4344826">hint</a></span><span class="op" id="4344937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4344940">for</span>&nbsp;<span class="op" id="4344944">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344948">kv</span><span class="op" id="4344950">,</span>&nbsp;<span class="ident" id="4344952">err</span>&nbsp;<span class="op" id="4344956">:=</span>&nbsp;<span class="ident" id="4344959"><a href="/gostd/net/textproto/reader.go.html#4344562">r</a></span><span class="op" id="4344960">.</span><span class="ident" id="4344961"><a href="/gostd/net/textproto/reader.go.html#4335610">readContinuedLineSlice</a></span><span class="op" id="4344983">(</span><span class="op" id="4344984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4344988">if</span>&nbsp;<span class="builtinfunc" id="4344991">len</span><span class="op" id="4344994">(</span><span class="ident" id="4344995"><a href="/gostd/net/textproto/reader.go.html#4344948">kv</a></span><span class="op" id="4344997">)</span>&nbsp;<span class="op" id="4344999">==</span>&nbsp;<span class="num" id="4345002">0</span>&nbsp;<span class="op" id="4345004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345009">return</span>&nbsp;<span class="ident" id="4345016"><a href="/gostd/net/textproto/reader.go.html#4344911">m</a></span><span class="op" id="4345017">,</span>&nbsp;<span class="ident" id="4345019"><a href="/gostd/net/textproto/reader.go.html#4344952">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4345030">//&nbsp;Key&nbsp;ends&nbsp;at&nbsp;first&nbsp;colon;&nbsp;should&nbsp;not&nbsp;have&nbsp;spaces&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4345087">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;the&nbsp;wild,&nbsp;violating&nbsp;specs,&nbsp;so&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4345140">//&nbsp;remove&nbsp;them&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345169">i</span>&nbsp;<span class="op" id="4345171">:=</span>&nbsp;<span class="ident" id="4345174"><a href="/gostd/net/textproto/reader.go.html#4332821">bytes</a></span><span class="op" id="4345179">.</span><span class="ident" id="4345180"><a href="/gostd/bytes/bytes_decl.go.html#1414570">IndexByte</a></span><span class="op" id="4345189">(</span><span class="ident" id="4345190"><a href="/gostd/net/textproto/reader.go.html#4344948">kv</a></span><span class="op" id="4345192">,</span>&nbsp;<span class="string" id="4345194">&#39;:&#39;</span><span class="op" id="4345197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345201">if</span>&nbsp;<span class="ident" id="4345204"><a href="/gostd/net/textproto/reader.go.html#4345169">i</a></span>&nbsp;<span class="op" id="4345206">&lt;</span>&nbsp;<span class="num" id="4345208">0</span>&nbsp;<span class="op" id="4345210">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345215">return</span>&nbsp;<span class="ident" id="4345222"><a href="/gostd/net/textproto/reader.go.html#4344911">m</a></span><span class="op" id="4345223">,</span>&nbsp;<span class="ident" id="4345225"><a href="/gostd/net/textproto/textproto.go.html#4350116">ProtocolError</a></span><span class="op" id="4345238">(</span><span class="string" id="4345239">&#34;malformed&nbsp;MIME&nbsp;header&nbsp;line:&nbsp;&#34;</span>&nbsp;<span class="op" id="4345270">+</span>&nbsp;<span class="builtintype" id="4345272">string</span><span class="op" id="4345278">(</span><span class="ident" id="4345279"><a href="/gostd/net/textproto/reader.go.html#4344948">kv</a></span><span class="op" id="4345281">)</span><span class="op" id="4345282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345290">endKey</span>&nbsp;<span class="op" id="4345297">:=</span>&nbsp;<span class="ident" id="4345300"><a href="/gostd/net/textproto/reader.go.html#4345169">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345304">for</span>&nbsp;<span class="ident" id="4345308"><a href="/gostd/net/textproto/reader.go.html#4345290">endKey</a></span>&nbsp;<span class="op" id="4345315">&gt;</span>&nbsp;<span class="num" id="4345317">0</span>&nbsp;<span class="op" id="4345319">&amp;&amp;</span>&nbsp;<span class="ident" id="4345322"><a href="/gostd/net/textproto/reader.go.html#4344948">kv</a></span><span class="op" id="4345324">[</span><span class="ident" id="4345325"><a href="/gostd/net/textproto/reader.go.html#4345290">endKey</a></span><span class="op" id="4345331">-</span><span class="num" id="4345332">1</span><span class="op" id="4345333">]</span>&nbsp;<span class="op" id="4345335">==</span>&nbsp;<span class="string" id="4345338">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4345342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345347"><a href="/gostd/net/textproto/reader.go.html#4345290">endKey</a></span><span class="op" id="4345353">--</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345362">key</span>&nbsp;<span class="op" id="4345366">:=</span>&nbsp;<span class="ident" id="4345369"><a href="/gostd/net/textproto/reader.go.html#4347436">canonicalMIMEHeaderKey</a></span><span class="op" id="4345391">(</span><span class="ident" id="4345392"><a href="/gostd/net/textproto/reader.go.html#4344948">kv</a></span><span class="op" id="4345394">[</span><span class="op" id="4345395">:</span><span class="ident" id="4345396"><a href="/gostd/net/textproto/reader.go.html#4345290">endKey</a></span><span class="op" id="4345402">]</span><span class="op" id="4345403">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4345408">//&nbsp;Skip&nbsp;initial&nbsp;spaces&nbsp;in&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345443"><a href="/gostd/net/textproto/reader.go.html#4345169">i</a></span><span class="op" id="4345444">++</span>&nbsp;<span class="comment" id="4345447">//&nbsp;skip&nbsp;colon</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345463">for</span>&nbsp;<span class="ident" id="4345467"><a href="/gostd/net/textproto/reader.go.html#4345169">i</a></span>&nbsp;<span class="op" id="4345469">&lt;</span>&nbsp;<span class="builtinfunc" id="4345471">len</span><span class="op" id="4345474">(</span><span class="ident" id="4345475"><a href="/gostd/net/textproto/reader.go.html#4344948">kv</a></span><span class="op" id="4345477">)</span>&nbsp;<span class="op" id="4345479">&amp;&amp;</span>&nbsp;<span class="op" id="4345482">(</span><span class="ident" id="4345483"><a href="/gostd/net/textproto/reader.go.html#4344948">kv</a></span><span class="op" id="4345485">[</span><span class="ident" id="4345486"><a href="/gostd/net/textproto/reader.go.html#4345169">i</a></span><span class="op" id="4345487">]</span>&nbsp;<span class="op" id="4345489">==</span>&nbsp;<span class="string" id="4345492">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4345496">||</span>&nbsp;<span class="ident" id="4345499"><a href="/gostd/net/textproto/reader.go.html#4344948">kv</a></span><span class="op" id="4345501">[</span><span class="ident" id="4345502"><a href="/gostd/net/textproto/reader.go.html#4345169">i</a></span><span class="op" id="4345503">]</span>&nbsp;<span class="op" id="4345505">==</span>&nbsp;<span class="string" id="4345508">&#39;\t&#39;</span><span class="op" id="4345512">)</span>&nbsp;<span class="op" id="4345514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345519"><a href="/gostd/net/textproto/reader.go.html#4345169">i</a></span><span class="op" id="4345520">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345529">value</span>&nbsp;<span class="op" id="4345535">:=</span>&nbsp;<span class="builtintype" id="4345538">string</span><span class="op" id="4345544">(</span><span class="ident" id="4345545"><a href="/gostd/net/textproto/reader.go.html#4344948">kv</a></span><span class="op" id="4345547">[</span><span class="ident" id="4345548"><a href="/gostd/net/textproto/reader.go.html#4345169">i</a></span><span class="op" id="4345549">:</span><span class="op" id="4345550">]</span><span class="op" id="4345551">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345556">vv</span>&nbsp;<span class="op" id="4345559">:=</span>&nbsp;<span class="ident" id="4345562"><a href="/gostd/net/textproto/reader.go.html#4344911">m</a></span><span class="op" id="4345563">[</span><span class="ident" id="4345564"><a href="/gostd/net/textproto/reader.go.html#4345362">key</a></span><span class="op" id="4345567">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345571">if</span>&nbsp;<span class="ident" id="4345574"><a href="/gostd/net/textproto/reader.go.html#4345556">vv</a></span>&nbsp;<span class="op" id="4345577">==</span>&nbsp;<span class="builtintype" id="4345580">nil</span>&nbsp;<span class="op" id="4345584">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4345587">len</span><span class="op" id="4345590">(</span><span class="ident" id="4345591"><a href="/gostd/net/textproto/reader.go.html#4344811">strs</a></span><span class="op" id="4345595">)</span>&nbsp;<span class="op" id="4345597">&gt;</span>&nbsp;<span class="num" id="4345599">0</span>&nbsp;<span class="op" id="4345601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4345606">//&nbsp;More&nbsp;than&nbsp;likely&nbsp;this&nbsp;will&nbsp;be&nbsp;a&nbsp;single-element&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4345664">//&nbsp;Most&nbsp;headers&nbsp;aren&#39;t&nbsp;multi-valued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4345704">//&nbsp;Set&nbsp;the&nbsp;capacity&nbsp;on&nbsp;strs[0]&nbsp;to&nbsp;1,&nbsp;so&nbsp;any&nbsp;future&nbsp;append</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4345765">//&nbsp;won&#39;t&nbsp;extend&nbsp;the&nbsp;slice&nbsp;into&nbsp;the&nbsp;other&nbsp;strings.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345818"><a href="/gostd/net/textproto/reader.go.html#4345556">vv</a></span><span class="op" id="4345820">,</span>&nbsp;<span class="ident" id="4345822"><a href="/gostd/net/textproto/reader.go.html#4344811">strs</a></span>&nbsp;<span class="op" id="4345827">=</span>&nbsp;<span class="ident" id="4345829"><a href="/gostd/net/textproto/reader.go.html#4344811">strs</a></span><span class="op" id="4345833">[</span><span class="op" id="4345834">:</span><span class="num" id="4345835">1</span><span class="op" id="4345836">:</span><span class="num" id="4345837">1</span><span class="op" id="4345838">]</span><span class="op" id="4345839">,</span>&nbsp;<span class="ident" id="4345841"><a href="/gostd/net/textproto/reader.go.html#4344811">strs</a></span><span class="op" id="4345845">[</span><span class="num" id="4345846">1</span><span class="op" id="4345847">:</span><span class="op" id="4345848">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345853"><a href="/gostd/net/textproto/reader.go.html#4345556">vv</a></span><span class="op" id="4345855">[</span><span class="num" id="4345856">0</span><span class="op" id="4345857">]</span>&nbsp;<span class="op" id="4345859">=</span>&nbsp;<span class="ident" id="4345861"><a href="/gostd/net/textproto/reader.go.html#4345529">value</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345870"><a href="/gostd/net/textproto/reader.go.html#4344911">m</a></span><span class="op" id="4345871">[</span><span class="ident" id="4345872"><a href="/gostd/net/textproto/reader.go.html#4345362">key</a></span><span class="op" id="4345875">]</span>&nbsp;<span class="op" id="4345877">=</span>&nbsp;<span class="ident" id="4345879"><a href="/gostd/net/textproto/reader.go.html#4345556">vv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345884">}</span>&nbsp;<span class="keyword" id="4345886">else</span>&nbsp;<span class="op" id="4345891">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345896"><a href="/gostd/net/textproto/reader.go.html#4344911">m</a></span><span class="op" id="4345897">[</span><span class="ident" id="4345898"><a href="/gostd/net/textproto/reader.go.html#4345362">key</a></span><span class="op" id="4345901">]</span>&nbsp;<span class="op" id="4345903">=</span>&nbsp;<span class="builtinfunc" id="4345905">append</span><span class="op" id="4345911">(</span><span class="ident" id="4345912"><a href="/gostd/net/textproto/reader.go.html#4345556">vv</a></span><span class="op" id="4345914">,</span>&nbsp;<span class="ident" id="4345916"><a href="/gostd/net/textproto/reader.go.html#4345529">value</a></span><span class="op" id="4345921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345930">if</span>&nbsp;<span class="ident" id="4345933"><a href="/gostd/net/textproto/reader.go.html#4344952">err</a></span>&nbsp;<span class="op" id="4345937">!=</span>&nbsp;<span class="builtintype" id="4345940">nil</span>&nbsp;<span class="op" id="4345944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345949">return</span>&nbsp;<span class="ident" id="4345956"><a href="/gostd/net/textproto/reader.go.html#4344911">m</a></span><span class="op" id="4345957">,</span>&nbsp;<span class="ident" id="4345959"><a href="/gostd/net/textproto/reader.go.html#4344952">err</a></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345968">}</span><br>
<span class="lineno"></span><span class="op" id="4345970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4345973">//&nbsp;upcomingHeaderNewlines&nbsp;returns&nbsp;an&nbsp;approximation&nbsp;of&nbsp;the&nbsp;number&nbsp;of&nbsp;newlines</span><br>
<span class="lineno">515</span><span class="comment" id="4346050">//&nbsp;that&nbsp;will&nbsp;be&nbsp;in&nbsp;this&nbsp;header.&nbsp;If&nbsp;it&nbsp;gets&nbsp;confused,&nbsp;it&nbsp;returns&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="4346117">func</span>&nbsp;<span class="op" id="4346122">(</span><span class="ident" id="4346123">r</span>&nbsp;<span class="op" id="4346125">*</span><span class="ident" id="4346126"><a href="/gostd/net/textproto/reader.go.html#4333179">Reader</a></span><span class="op" id="4346132">)</span>&nbsp;<span class="ident" id="4346134">upcomingHeaderNewlines</span><span class="op" id="4346156">(</span><span class="op" id="4346157">)</span>&nbsp;<span class="op" id="4346159">(</span><span class="ident" id="4346160">n</span>&nbsp;<span class="builtintype" id="4346162">int</span><span class="op" id="4346165">)</span>&nbsp;<span class="op" id="4346167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346170">//&nbsp;Try&nbsp;to&nbsp;determine&nbsp;the&nbsp;&#39;hint&#39;&nbsp;size.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4346208"><a href="/gostd/net/textproto/reader.go.html#4346123">r</a></span><span class="op" id="4346209">.</span><span class="ident" id="4346210"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="4346211">.</span><span class="ident" id="4346212"><a href="/gostd/bufio/bufio.go.html#1357192">Peek</a></span><span class="op" id="4346216">(</span><span class="num" id="4346217">1</span><span class="op" id="4346218">)</span>&nbsp;<span class="comment" id="4346220">//&nbsp;force&nbsp;a&nbsp;buffer&nbsp;load&nbsp;if&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4346253">s</span>&nbsp;<span class="op" id="4346255">:=</span>&nbsp;<span class="ident" id="4346258"><a href="/gostd/net/textproto/reader.go.html#4346123">r</a></span><span class="op" id="4346259">.</span><span class="ident" id="4346260"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="4346261">.</span><span class="ident" id="4346262"><a href="/gostd/bufio/bufio.go.html#1360477">Buffered</a></span><span class="op" id="4346270">(</span><span class="op" id="4346271">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4346274">if</span>&nbsp;<span class="ident" id="4346277"><a href="/gostd/net/textproto/reader.go.html#4346253">s</a></span>&nbsp;<span class="op" id="4346279">==</span>&nbsp;<span class="num" id="4346282">0</span>&nbsp;<span class="op" id="4346284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4346288">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4346296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4346299">peek</span><span class="op" id="4346303">,</span>&nbsp;<span class="ident" id="4346305">_</span>&nbsp;<span class="op" id="4346307">:=</span>&nbsp;<span class="ident" id="4346310"><a href="/gostd/net/textproto/reader.go.html#4346123">r</a></span><span class="op" id="4346311">.</span><span class="ident" id="4346312"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="4346313">.</span><span class="ident" id="4346314"><a href="/gostd/bufio/bufio.go.html#1357192">Peek</a></span><span class="op" id="4346318">(</span><span class="ident" id="4346319"><a href="/gostd/net/textproto/reader.go.html#4346253">s</a></span><span class="op" id="4346320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4346323">for</span>&nbsp;<span class="builtinfunc" id="4346327">len</span><span class="op" id="4346330">(</span><span class="ident" id="4346331"><a href="/gostd/net/textproto/reader.go.html#4346299">peek</a></span><span class="op" id="4346335">)</span>&nbsp;<span class="op" id="4346337">&gt;</span>&nbsp;<span class="num" id="4346339">0</span>&nbsp;<span class="op" id="4346341">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4346345">i</span>&nbsp;<span class="op" id="4346347">:=</span>&nbsp;<span class="ident" id="4346350"><a href="/gostd/net/textproto/reader.go.html#4332821">bytes</a></span><span class="op" id="4346355">.</span><span class="ident" id="4346356"><a href="/gostd/bytes/bytes_decl.go.html#1414570">IndexByte</a></span><span class="op" id="4346365">(</span><span class="ident" id="4346366"><a href="/gostd/net/textproto/reader.go.html#4346299">peek</a></span><span class="op" id="4346370">,</span>&nbsp;<span class="string" id="4346372">&#39;\n&#39;</span><span class="op" id="4346376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4346380">if</span>&nbsp;<span class="ident" id="4346383"><a href="/gostd/net/textproto/reader.go.html#4346345">i</a></span>&nbsp;<span class="op" id="4346385">&lt;</span>&nbsp;<span class="num" id="4346387">3</span>&nbsp;<span class="op" id="4346389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346394">//&nbsp;Not&nbsp;present&nbsp;(-1)&nbsp;or&nbsp;found&nbsp;within&nbsp;the&nbsp;next&nbsp;few&nbsp;bytes,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346453">//&nbsp;implying&nbsp;we&#39;re&nbsp;at&nbsp;the&nbsp;end&nbsp;(&#34;\r\n\r\n&#34;&nbsp;or&nbsp;&#34;\n\n&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4346508">return</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4346517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4346521"><a href="/gostd/net/textproto/reader.go.html#4346160">n</a></span><span class="op" id="4346522">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4346527"><a href="/gostd/net/textproto/reader.go.html#4346299">peek</a></span>&nbsp;<span class="op" id="4346532">=</span>&nbsp;<span class="ident" id="4346534"><a href="/gostd/net/textproto/reader.go.html#4346299">peek</a></span><span class="op" id="4346538">[</span><span class="ident" id="4346539"><a href="/gostd/net/textproto/reader.go.html#4346345">i</a></span><span class="op" id="4346540">+</span><span class="num" id="4346541">1</span><span class="op" id="4346542">:</span><span class="op" id="4346543">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4346546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4346549">return</span><br>
<span class="lineno">535</span><span class="op" id="4346556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4346559">//&nbsp;CanonicalMIMEHeaderKey&nbsp;returns&nbsp;the&nbsp;canonical&nbsp;format&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4346621">//&nbsp;MIME&nbsp;header&nbsp;key&nbsp;s.&nbsp;&nbsp;The&nbsp;canonicalization&nbsp;converts&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="4346684">//&nbsp;letter&nbsp;and&nbsp;any&nbsp;letter&nbsp;following&nbsp;a&nbsp;hyphen&nbsp;to&nbsp;upper&nbsp;case;</span><br>
<span class="lineno">540</span><span class="comment" id="4346743">//&nbsp;the&nbsp;rest&nbsp;are&nbsp;converted&nbsp;to&nbsp;lowercase.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4346801">//&nbsp;canonical&nbsp;key&nbsp;for&nbsp;&#34;accept-encoding&#34;&nbsp;is&nbsp;&#34;Accept-Encoding&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="4346862">//&nbsp;MIME&nbsp;header&nbsp;keys&nbsp;are&nbsp;assumed&nbsp;to&nbsp;be&nbsp;ASCII&nbsp;only.</span><br>
<span class="lineno"></span><span class="keyword" id="4346912">func</span>&nbsp;<span class="ident" id="4346917">CanonicalMIMEHeaderKey</span><span class="op" id="4346939">(</span><span class="ident" id="4346940">s</span>&nbsp;<span class="builtintype" id="4346942">string</span><span class="op" id="4346948">)</span>&nbsp;<span class="builtintype" id="4346950">string</span>&nbsp;<span class="op" id="4346957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346960">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;canonical&nbsp;encoding.</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347000">upper</span>&nbsp;<span class="op" id="4347006">:=</span>&nbsp;<span class="builtintype" id="4347009">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347015">for</span>&nbsp;<span class="ident" id="4347019">i</span>&nbsp;<span class="op" id="4347021">:=</span>&nbsp;<span class="num" id="4347024">0</span><span class="op" id="4347025">;</span>&nbsp;<span class="ident" id="4347027"><a href="/gostd/net/textproto/reader.go.html#4347019">i</a></span>&nbsp;<span class="op" id="4347029">&lt;</span>&nbsp;<span class="builtinfunc" id="4347031">len</span><span class="op" id="4347034">(</span><span class="ident" id="4347035"><a href="/gostd/net/textproto/reader.go.html#4346940">s</a></span><span class="op" id="4347036">)</span><span class="op" id="4347037">;</span>&nbsp;<span class="ident" id="4347039"><a href="/gostd/net/textproto/reader.go.html#4347019">i</a></span><span class="op" id="4347040">++</span>&nbsp;<span class="op" id="4347043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347047">c</span>&nbsp;<span class="op" id="4347049">:=</span>&nbsp;<span class="ident" id="4347052"><a href="/gostd/net/textproto/reader.go.html#4346940">s</a></span><span class="op" id="4347053">[</span><span class="ident" id="4347054"><a href="/gostd/net/textproto/reader.go.html#4347019">i</a></span><span class="op" id="4347055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347059">if</span>&nbsp;<span class="ident" id="4347062"><a href="/gostd/net/textproto/reader.go.html#4347000">upper</a></span>&nbsp;<span class="op" id="4347068">&amp;&amp;</span>&nbsp;<span class="string" id="4347071">&#39;a&#39;</span>&nbsp;<span class="op" id="4347075">&lt;=</span>&nbsp;<span class="ident" id="4347078"><a href="/gostd/net/textproto/reader.go.html#4347047">c</a></span>&nbsp;<span class="op" id="4347080">&amp;&amp;</span>&nbsp;<span class="ident" id="4347083"><a href="/gostd/net/textproto/reader.go.html#4347047">c</a></span>&nbsp;<span class="op" id="4347085">&lt;=</span>&nbsp;<span class="string" id="4347088">&#39;z&#39;</span>&nbsp;<span class="op" id="4347092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347097">return</span>&nbsp;<span class="ident" id="4347104"><a href="/gostd/net/textproto/reader.go.html#4347436">canonicalMIMEHeaderKey</a></span><span class="op" id="4347126">(</span><span class="op" id="4347127">[</span><span class="op" id="4347128">]</span><span class="builtintype" id="4347129">byte</span><span class="op" id="4347133">(</span><span class="ident" id="4347134"><a href="/gostd/net/textproto/reader.go.html#4346940">s</a></span><span class="op" id="4347135">)</span><span class="op" id="4347136">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347144">if</span>&nbsp;<span class="op" id="4347147">!</span><span class="ident" id="4347148"><a href="/gostd/net/textproto/reader.go.html#4347000">upper</a></span>&nbsp;<span class="op" id="4347154">&amp;&amp;</span>&nbsp;<span class="string" id="4347157">&#39;A&#39;</span>&nbsp;<span class="op" id="4347161">&lt;=</span>&nbsp;<span class="ident" id="4347164"><a href="/gostd/net/textproto/reader.go.html#4347047">c</a></span>&nbsp;<span class="op" id="4347166">&amp;&amp;</span>&nbsp;<span class="ident" id="4347169"><a href="/gostd/net/textproto/reader.go.html#4347047">c</a></span>&nbsp;<span class="op" id="4347171">&lt;=</span>&nbsp;<span class="string" id="4347174">&#39;Z&#39;</span>&nbsp;<span class="op" id="4347178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347183">return</span>&nbsp;<span class="ident" id="4347190"><a href="/gostd/net/textproto/reader.go.html#4347436">canonicalMIMEHeaderKey</a></span><span class="op" id="4347212">(</span><span class="op" id="4347213">[</span><span class="op" id="4347214">]</span><span class="builtintype" id="4347215">byte</span><span class="op" id="4347219">(</span><span class="ident" id="4347220"><a href="/gostd/net/textproto/reader.go.html#4346940">s</a></span><span class="op" id="4347221">)</span><span class="op" id="4347222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347230"><a href="/gostd/net/textproto/reader.go.html#4347000">upper</a></span>&nbsp;<span class="op" id="4347236">=</span>&nbsp;<span class="ident" id="4347238"><a href="/gostd/net/textproto/reader.go.html#4347047">c</a></span>&nbsp;<span class="op" id="4347240">==</span>&nbsp;<span class="string" id="4347243">&#39;-&#39;</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347251">return</span>&nbsp;<span class="ident" id="4347258"><a href="/gostd/net/textproto/reader.go.html#4346940">s</a></span><br>
<span class="lineno"></span><span class="op" id="4347260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4347263">const</span>&nbsp;<span class="ident" id="4347269">toLower</span>&nbsp;<span class="op" id="4347277">=</span>&nbsp;<span class="string" id="4347279">&#39;a&#39;</span>&nbsp;<span class="op" id="4347283">-</span>&nbsp;<span class="string" id="4347285">&#39;A&#39;</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span><span class="comment" id="4347290">//&nbsp;canonicalMIMEHeaderKey&nbsp;is&nbsp;like&nbsp;CanonicalMIMEHeaderKey&nbsp;but&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4347354">//&nbsp;allowed&nbsp;to&nbsp;mutate&nbsp;the&nbsp;provided&nbsp;byte&nbsp;slice&nbsp;before&nbsp;returning&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4347420">//&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4347431">func</span>&nbsp;<span class="ident" id="4347436">canonicalMIMEHeaderKey</span><span class="op" id="4347458">(</span><span class="ident" id="4347459">a</span>&nbsp;<span class="op" id="4347461">[</span><span class="op" id="4347462">]</span><span class="builtintype" id="4347463">byte</span><span class="op" id="4347467">)</span>&nbsp;<span class="builtintype" id="4347469">string</span>&nbsp;<span class="op" id="4347476">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347479">upper</span>&nbsp;<span class="op" id="4347485">:=</span>&nbsp;<span class="builtintype" id="4347488">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347494">for</span>&nbsp;<span class="ident" id="4347498">i</span><span class="op" id="4347499">,</span>&nbsp;<span class="ident" id="4347501">c</span>&nbsp;<span class="op" id="4347503">:=</span>&nbsp;<span class="keyword" id="4347506">range</span>&nbsp;<span class="ident" id="4347512"><a href="/gostd/net/textproto/reader.go.html#4347459">a</a></span>&nbsp;<span class="op" id="4347514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4347518">//&nbsp;Canonicalize:&nbsp;first&nbsp;letter&nbsp;upper&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4347561">//&nbsp;and&nbsp;upper&nbsp;case&nbsp;after&nbsp;each&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4347598">//&nbsp;(Host,&nbsp;User-Agent,&nbsp;If-Modified-Since).</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4347642">//&nbsp;MIME&nbsp;headers&nbsp;are&nbsp;ASCII&nbsp;only,&nbsp;so&nbsp;no&nbsp;Unicode&nbsp;issues.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347698">if</span>&nbsp;<span class="ident" id="4347701"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span>&nbsp;<span class="op" id="4347703">==</span>&nbsp;<span class="string" id="4347706">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4347710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347715"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span>&nbsp;<span class="op" id="4347717">=</span>&nbsp;<span class="string" id="4347719">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347725">}</span>&nbsp;<span class="keyword" id="4347727">else</span>&nbsp;<span class="keyword" id="4347732">if</span>&nbsp;<span class="ident" id="4347735"><a href="/gostd/net/textproto/reader.go.html#4347479">upper</a></span>&nbsp;<span class="op" id="4347741">&amp;&amp;</span>&nbsp;<span class="string" id="4347744">&#39;a&#39;</span>&nbsp;<span class="op" id="4347748">&lt;=</span>&nbsp;<span class="ident" id="4347751"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span>&nbsp;<span class="op" id="4347753">&amp;&amp;</span>&nbsp;<span class="ident" id="4347756"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span>&nbsp;<span class="op" id="4347758">&lt;=</span>&nbsp;<span class="string" id="4347761">&#39;z&#39;</span>&nbsp;<span class="op" id="4347765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347770"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span>&nbsp;<span class="op" id="4347772">-=</span>&nbsp;<span class="ident" id="4347775"><a href="/gostd/net/textproto/reader.go.html#4347269">toLower</a></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347785">}</span>&nbsp;<span class="keyword" id="4347787">else</span>&nbsp;<span class="keyword" id="4347792">if</span>&nbsp;<span class="op" id="4347795">!</span><span class="ident" id="4347796"><a href="/gostd/net/textproto/reader.go.html#4347479">upper</a></span>&nbsp;<span class="op" id="4347802">&amp;&amp;</span>&nbsp;<span class="string" id="4347805">&#39;A&#39;</span>&nbsp;<span class="op" id="4347809">&lt;=</span>&nbsp;<span class="ident" id="4347812"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span>&nbsp;<span class="op" id="4347814">&amp;&amp;</span>&nbsp;<span class="ident" id="4347817"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span>&nbsp;<span class="op" id="4347819">&lt;=</span>&nbsp;<span class="string" id="4347822">&#39;Z&#39;</span>&nbsp;<span class="op" id="4347826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347831"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span>&nbsp;<span class="op" id="4347833">+=</span>&nbsp;<span class="ident" id="4347836"><a href="/gostd/net/textproto/reader.go.html#4347269">toLower</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347850"><a href="/gostd/net/textproto/reader.go.html#4347459">a</a></span><span class="op" id="4347851">[</span><span class="ident" id="4347852"><a href="/gostd/net/textproto/reader.go.html#4347498">i</a></span><span class="op" id="4347853">]</span>&nbsp;<span class="op" id="4347855">=</span>&nbsp;<span class="ident" id="4347857"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347861"><a href="/gostd/net/textproto/reader.go.html#4347479">upper</a></span>&nbsp;<span class="op" id="4347867">=</span>&nbsp;<span class="ident" id="4347869"><a href="/gostd/net/textproto/reader.go.html#4347501">c</a></span>&nbsp;<span class="op" id="4347871">==</span>&nbsp;<span class="string" id="4347874">&#39;-&#39;</span>&nbsp;<span class="comment" id="4347878">//&nbsp;for&nbsp;next&nbsp;time</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4347899">//&nbsp;The&nbsp;compiler&nbsp;recognizes&nbsp;m[string(byteSlice)]&nbsp;as&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4347961">//&nbsp;case,&nbsp;so&nbsp;a&nbsp;copy&nbsp;of&nbsp;a&#39;s&nbsp;bytes&nbsp;into&nbsp;a&nbsp;new&nbsp;string&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4348021">//&nbsp;happen&nbsp;in&nbsp;this&nbsp;map&nbsp;lookup:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348052">if</span>&nbsp;<span class="ident" id="4348055">v</span>&nbsp;<span class="op" id="4348057">:=</span>&nbsp;<span class="ident" id="4348060"><a href="/gostd/net/textproto/reader.go.html#4348181">commonHeader</a></span><span class="op" id="4348072">[</span><span class="builtintype" id="4348073">string</span><span class="op" id="4348079">(</span><span class="ident" id="4348080"><a href="/gostd/net/textproto/reader.go.html#4347459">a</a></span><span class="op" id="4348081">)</span><span class="op" id="4348082">]</span><span class="op" id="4348083">;</span>&nbsp;<span class="ident" id="4348085"><a href="/gostd/net/textproto/reader.go.html#4348055">v</a></span>&nbsp;<span class="op" id="4348087">!=</span>&nbsp;<span class="string" id="4348090">&#34;&#34;</span>&nbsp;<span class="op" id="4348093">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348097">return</span>&nbsp;<span class="ident" id="4348104"><a href="/gostd/net/textproto/reader.go.html#4348055">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348110">return</span>&nbsp;<span class="builtintype" id="4348117">string</span><span class="op" id="4348123">(</span><span class="ident" id="4348124"><a href="/gostd/net/textproto/reader.go.html#4347459">a</a></span><span class="op" id="4348125">)</span><br>
<span class="lineno"></span><span class="op" id="4348127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span><span class="comment" id="4348130">//&nbsp;commonHeader&nbsp;interns&nbsp;common&nbsp;header&nbsp;strings.</span><br>
<span class="lineno"></span><span class="keyword" id="4348177">var</span>&nbsp;<span class="ident" id="4348181">commonHeader</span>&nbsp;<span class="op" id="4348194">=</span>&nbsp;<span class="builtinfunc" id="4348196">make</span><span class="op" id="4348200">(</span><span class="keyword" id="4348201">map</span><span class="op" id="4348204">[</span><span class="builtintype" id="4348205">string</span><span class="op" id="4348211">]</span><span class="builtintype" id="4348212">string</span><span class="op" id="4348218">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4348221">func</span>&nbsp;<span class="ident" id="4348226">init</span><span class="op" id="4348230">(</span><span class="op" id="4348231">)</span>&nbsp;<span class="op" id="4348233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348236">for</span>&nbsp;<span class="ident" id="4348240">_</span><span class="op" id="4348241">,</span>&nbsp;<span class="ident" id="4348243">v</span>&nbsp;<span class="op" id="4348245">:=</span>&nbsp;<span class="keyword" id="4348248">range</span>&nbsp;<span class="op" id="4348254">[</span><span class="op" id="4348255">]</span><span class="builtintype" id="4348256">string</span><span class="op" id="4348262">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348266">&#34;Accept&#34;</span><span class="op" id="4348274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348278">&#34;Accept-Charset&#34;</span><span class="op" id="4348294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348298">&#34;Accept-Encoding&#34;</span><span class="op" id="4348315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348319">&#34;Accept-Language&#34;</span><span class="op" id="4348336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348340">&#34;Accept-Ranges&#34;</span><span class="op" id="4348355">,</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348359">&#34;Cache-Control&#34;</span><span class="op" id="4348374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348378">&#34;Cc&#34;</span><span class="op" id="4348382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348386">&#34;Connection&#34;</span><span class="op" id="4348398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348402">&#34;Content-Id&#34;</span><span class="op" id="4348414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348418">&#34;Content-Language&#34;</span><span class="op" id="4348436">,</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348440">&#34;Content-Length&#34;</span><span class="op" id="4348456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348460">&#34;Content-Transfer-Encoding&#34;</span><span class="op" id="4348487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348491">&#34;Content-Type&#34;</span><span class="op" id="4348505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348509">&#34;Cookie&#34;</span><span class="op" id="4348517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348521">&#34;Date&#34;</span><span class="op" id="4348527">,</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348531">&#34;Dkim-Signature&#34;</span><span class="op" id="4348547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348551">&#34;Etag&#34;</span><span class="op" id="4348557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348561">&#34;Expires&#34;</span><span class="op" id="4348570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348574">&#34;From&#34;</span><span class="op" id="4348580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348584">&#34;Host&#34;</span><span class="op" id="4348590">,</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348594">&#34;If-Modified-Since&#34;</span><span class="op" id="4348613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348617">&#34;If-None-Match&#34;</span><span class="op" id="4348632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348636">&#34;In-Reply-To&#34;</span><span class="op" id="4348649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348653">&#34;Last-Modified&#34;</span><span class="op" id="4348668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348672">&#34;Location&#34;</span><span class="op" id="4348682">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348686">&#34;Message-Id&#34;</span><span class="op" id="4348698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348702">&#34;Mime-Version&#34;</span><span class="op" id="4348716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348720">&#34;Pragma&#34;</span><span class="op" id="4348728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348732">&#34;Received&#34;</span><span class="op" id="4348742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348746">&#34;Return-Path&#34;</span><span class="op" id="4348759">,</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348763">&#34;Server&#34;</span><span class="op" id="4348771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348775">&#34;Set-Cookie&#34;</span><span class="op" id="4348787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348791">&#34;Subject&#34;</span><span class="op" id="4348800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348804">&#34;To&#34;</span><span class="op" id="4348808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348812">&#34;User-Agent&#34;</span><span class="op" id="4348824">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348828">&#34;Via&#34;</span><span class="op" id="4348833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348837">&#34;X-Forwarded-For&#34;</span><span class="op" id="4348854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348858">&#34;X-Imforwards&#34;</span><span class="op" id="4348872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4348876">&#34;X-Powered-By&#34;</span><span class="op" id="4348890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348893">}</span>&nbsp;<span class="op" id="4348895">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348899"><a href="/gostd/net/textproto/reader.go.html#4348181">commonHeader</a></span><span class="op" id="4348911">[</span><span class="ident" id="4348912"><a href="/gostd/net/textproto/reader.go.html#4348243">v</a></span><span class="op" id="4348913">]</span>&nbsp;<span class="op" id="4348915">=</span>&nbsp;<span class="ident" id="4348917"><a href="/gostd/net/textproto/reader.go.html#4348243">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348920">}</span><br>
<span class="lineno"></span><span class="op" id="4348922">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
