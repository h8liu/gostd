<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3611897">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3611952">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3612006">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3612057">package</span>&nbsp;<span class="ident" id="3612065">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3612070">import</span>&nbsp;<span class="op" id="3612077">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3612080">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3612094">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3612111">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3612125">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3612140">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3612154">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3612169">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3612184">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3612191">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3612194">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="3612273">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="3612337">type</span>&nbsp;<span class="ident" id="3612342">keyAgreement</span>&nbsp;<span class="keyword" id="3612355">interface</span>&nbsp;<span class="op" id="3612365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3612368">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3612436">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3612498">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3612571">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612580">generateServerKeyExchange</span><span class="op" id="3612605">(</span><span class="op" id="3612606">*</span><span class="ident" id="3612607">Config</span><span class="op" id="3612613">,</span>&nbsp;<span class="op" id="3612615">*</span><span class="ident" id="3612616">Certificate</span><span class="op" id="3612627">,</span>&nbsp;<span class="op" id="3612629">*</span><span class="ident" id="3612630">clientHelloMsg</span><span class="op" id="3612644">,</span>&nbsp;<span class="op" id="3612646">*</span><span class="ident" id="3612647">serverHelloMsg</span><span class="op" id="3612661">)</span>&nbsp;<span class="op" id="3612663">(</span><span class="op" id="3612664">*</span><span class="ident" id="3612665">serverKeyExchangeMsg</span><span class="op" id="3612685">,</span>&nbsp;<span class="builtintype" id="3612687">error</span><span class="op" id="3612692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612695">processClientKeyExchange</span><span class="op" id="3612719">(</span><span class="op" id="3612720">*</span><span class="ident" id="3612721">Config</span><span class="op" id="3612727">,</span>&nbsp;<span class="op" id="3612729">*</span><span class="ident" id="3612730">Certificate</span><span class="op" id="3612741">,</span>&nbsp;<span class="op" id="3612743">*</span><span class="ident" id="3612744">clientKeyExchangeMsg</span><span class="op" id="3612764">,</span>&nbsp;<span class="builtintype" id="3612766">uint16</span><span class="op" id="3612772">)</span>&nbsp;<span class="op" id="3612774">(</span><span class="op" id="3612775">[</span><span class="op" id="3612776">]</span><span class="builtintype" id="3612777">byte</span><span class="op" id="3612781">,</span>&nbsp;<span class="builtintype" id="3612783">error</span><span class="op" id="3612788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3612792">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3612859">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3612922">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612953">processServerKeyExchange</span><span class="op" id="3612977">(</span><span class="op" id="3612978">*</span><span class="ident" id="3612979">Config</span><span class="op" id="3612985">,</span>&nbsp;<span class="op" id="3612987">*</span><span class="ident" id="3612988">clientHelloMsg</span><span class="op" id="3613002">,</span>&nbsp;<span class="op" id="3613004">*</span><span class="ident" id="3613005">serverHelloMsg</span><span class="op" id="3613019">,</span>&nbsp;<span class="op" id="3613021">*</span><span class="ident" id="3613022">x509</span><span class="op" id="3613026">.</span><span class="ident" id="3613027">Certificate</span><span class="op" id="3613038">,</span>&nbsp;<span class="op" id="3613040">*</span><span class="ident" id="3613041">serverKeyExchangeMsg</span><span class="op" id="3613061">)</span>&nbsp;<span class="builtintype" id="3613063">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3613070">generateClientKeyExchange</span><span class="op" id="3613095">(</span><span class="op" id="3613096">*</span><span class="ident" id="3613097">Config</span><span class="op" id="3613103">,</span>&nbsp;<span class="op" id="3613105">*</span><span class="ident" id="3613106">clientHelloMsg</span><span class="op" id="3613120">,</span>&nbsp;<span class="op" id="3613122">*</span><span class="ident" id="3613123">x509</span><span class="op" id="3613127">.</span><span class="ident" id="3613128">Certificate</span><span class="op" id="3613139">)</span>&nbsp;<span class="op" id="3613141">(</span><span class="op" id="3613142">[</span><span class="op" id="3613143">]</span><span class="builtintype" id="3613144">byte</span><span class="op" id="3613148">,</span>&nbsp;<span class="op" id="3613150">*</span><span class="ident" id="3613151">clientKeyExchangeMsg</span><span class="op" id="3613171">,</span>&nbsp;<span class="builtintype" id="3613173">error</span><span class="op" id="3613178">)</span><br>
<span class="lineno">35</span><span class="op" id="3613180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3613183">const</span>&nbsp;<span class="op" id="3613189">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613192">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613262">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613334">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613406">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3613433">suiteECDHE</span>&nbsp;<span class="op" id="3613444">=</span>&nbsp;<span class="num" id="3613446">1</span>&nbsp;<span class="op" id="3613448">&lt;&lt;</span>&nbsp;<span class="ident" id="3613451">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613457">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613522">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613589">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613659">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3613674">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613686">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613759">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3613796">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="3613807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3613810">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="3613886">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="3613953">type</span>&nbsp;<span class="ident" id="3613958">cipherSuite</span>&nbsp;<span class="keyword" id="3613970">struct</span>&nbsp;<span class="op" id="3613977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3613980">id</span>&nbsp;<span class="builtintype" id="3613983">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3613991">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614065">keyLen</span>&nbsp;<span class="builtintype" id="3614072">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614077">macLen</span>&nbsp;<span class="builtintype" id="3614084">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614089">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="3614096">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614101">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614108">func</span><span class="op" id="3614112">(</span><span class="ident" id="3614113">version</span>&nbsp;<span class="builtintype" id="3614121">uint16</span><span class="op" id="3614127">)</span>&nbsp;<span class="ident" id="3614129">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3614143">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614195">flags</span>&nbsp;&nbsp;<span class="builtintype" id="3614202">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614207">cipher</span>&nbsp;<span class="keyword" id="3614214">func</span><span class="op" id="3614218">(</span><span class="ident" id="3614219">key</span><span class="op" id="3614222">,</span>&nbsp;<span class="ident" id="3614224">iv</span>&nbsp;<span class="op" id="3614227">[</span><span class="op" id="3614228">]</span><span class="builtintype" id="3614229">byte</span><span class="op" id="3614233">,</span>&nbsp;<span class="ident" id="3614235">isRead</span>&nbsp;<span class="builtintype" id="3614242">bool</span><span class="op" id="3614246">)</span>&nbsp;<span class="keyword" id="3614248">interface</span><span class="op" id="3614257">{</span><span class="op" id="3614258">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614261">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614268">func</span><span class="op" id="3614272">(</span><span class="ident" id="3614273">version</span>&nbsp;<span class="builtintype" id="3614281">uint16</span><span class="op" id="3614287">,</span>&nbsp;<span class="ident" id="3614289">macKey</span>&nbsp;<span class="op" id="3614296">[</span><span class="op" id="3614297">]</span><span class="builtintype" id="3614298">byte</span><span class="op" id="3614302">)</span>&nbsp;<span class="ident" id="3614304">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614317">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614324">func</span><span class="op" id="3614328">(</span><span class="ident" id="3614329">key</span><span class="op" id="3614332">,</span>&nbsp;<span class="ident" id="3614334">fixedNonce</span>&nbsp;<span class="op" id="3614345">[</span><span class="op" id="3614346">]</span><span class="builtintype" id="3614347">byte</span><span class="op" id="3614351">)</span>&nbsp;<span class="ident" id="3614353">cipher</span><span class="op" id="3614359">.</span><span class="ident" id="3614360">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3614365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3614368">var</span>&nbsp;<span class="ident" id="3614372">cipherSuites</span>&nbsp;<span class="op" id="3614385">=</span>&nbsp;<span class="op" id="3614387">[</span><span class="op" id="3614388">]</span><span class="op" id="3614389">*</span><span class="ident" id="3614390">cipherSuite</span><span class="op" id="3614401">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3614404">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3614473">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3614535">{</span><span class="ident" id="3614536">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3614573">,</span>&nbsp;<span class="num" id="3614575">16</span><span class="op" id="3614577">,</span>&nbsp;<span class="num" id="3614579">0</span><span class="op" id="3614580">,</span>&nbsp;<span class="num" id="3614582">4</span><span class="op" id="3614583">,</span>&nbsp;<span class="ident" id="3614585">ecdheRSAKA</span><span class="op" id="3614595">,</span>&nbsp;<span class="ident" id="3614597">suiteECDHE</span>&nbsp;<span class="op" id="3614608">|</span>&nbsp;<span class="ident" id="3614610">suiteTLS12</span><span class="op" id="3614620">,</span>&nbsp;<span class="ident" id="3614622">nil</span><span class="op" id="3614625">,</span>&nbsp;<span class="ident" id="3614627">nil</span><span class="op" id="3614630">,</span>&nbsp;<span class="ident" id="3614632">aeadAESGCM</span><span class="op" id="3614642">}</span><span class="op" id="3614643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3614646">{</span><span class="ident" id="3614647">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3614686">,</span>&nbsp;<span class="num" id="3614688">16</span><span class="op" id="3614690">,</span>&nbsp;<span class="num" id="3614692">0</span><span class="op" id="3614693">,</span>&nbsp;<span class="num" id="3614695">4</span><span class="op" id="3614696">,</span>&nbsp;<span class="ident" id="3614698">ecdheECDSAKA</span><span class="op" id="3614710">,</span>&nbsp;<span class="ident" id="3614712">suiteECDHE</span>&nbsp;<span class="op" id="3614723">|</span>&nbsp;<span class="ident" id="3614725">suiteECDSA</span>&nbsp;<span class="op" id="3614736">|</span>&nbsp;<span class="ident" id="3614738">suiteTLS12</span><span class="op" id="3614748">,</span>&nbsp;<span class="ident" id="3614750">nil</span><span class="op" id="3614753">,</span>&nbsp;<span class="ident" id="3614755">nil</span><span class="op" id="3614758">,</span>&nbsp;<span class="ident" id="3614760">aeadAESGCM</span><span class="op" id="3614770">}</span><span class="op" id="3614771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3614774">{</span><span class="ident" id="3614775">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="3614805">,</span>&nbsp;<span class="num" id="3614807">16</span><span class="op" id="3614809">,</span>&nbsp;<span class="num" id="3614811">20</span><span class="op" id="3614813">,</span>&nbsp;<span class="num" id="3614815">0</span><span class="op" id="3614816">,</span>&nbsp;<span class="ident" id="3614818">ecdheRSAKA</span><span class="op" id="3614828">,</span>&nbsp;<span class="ident" id="3614830">suiteECDHE</span><span class="op" id="3614840">,</span>&nbsp;<span class="ident" id="3614842">cipherRC4</span><span class="op" id="3614851">,</span>&nbsp;<span class="ident" id="3614853">macSHA1</span><span class="op" id="3614860">,</span>&nbsp;<span class="ident" id="3614862">nil</span><span class="op" id="3614865">}</span><span class="op" id="3614866">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3614869">{</span><span class="ident" id="3614870">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="3614902">,</span>&nbsp;<span class="num" id="3614904">16</span><span class="op" id="3614906">,</span>&nbsp;<span class="num" id="3614908">20</span><span class="op" id="3614910">,</span>&nbsp;<span class="num" id="3614912">0</span><span class="op" id="3614913">,</span>&nbsp;<span class="ident" id="3614915">ecdheECDSAKA</span><span class="op" id="3614927">,</span>&nbsp;<span class="ident" id="3614929">suiteECDHE</span>&nbsp;<span class="op" id="3614940">|</span>&nbsp;<span class="ident" id="3614942">suiteECDSA</span><span class="op" id="3614952">,</span>&nbsp;<span class="ident" id="3614954">cipherRC4</span><span class="op" id="3614963">,</span>&nbsp;<span class="ident" id="3614965">macSHA1</span><span class="op" id="3614972">,</span>&nbsp;<span class="ident" id="3614974">nil</span><span class="op" id="3614977">}</span><span class="op" id="3614978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3614981">{</span><span class="ident" id="3614982">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3615016">,</span>&nbsp;<span class="num" id="3615018">16</span><span class="op" id="3615020">,</span>&nbsp;<span class="num" id="3615022">20</span><span class="op" id="3615024">,</span>&nbsp;<span class="num" id="3615026">16</span><span class="op" id="3615028">,</span>&nbsp;<span class="ident" id="3615030">ecdheRSAKA</span><span class="op" id="3615040">,</span>&nbsp;<span class="ident" id="3615042">suiteECDHE</span><span class="op" id="3615052">,</span>&nbsp;<span class="ident" id="3615054">cipherAES</span><span class="op" id="3615063">,</span>&nbsp;<span class="ident" id="3615065">macSHA1</span><span class="op" id="3615072">,</span>&nbsp;<span class="ident" id="3615074">nil</span><span class="op" id="3615077">}</span><span class="op" id="3615078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615081">{</span><span class="ident" id="3615082">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3615118">,</span>&nbsp;<span class="num" id="3615120">16</span><span class="op" id="3615122">,</span>&nbsp;<span class="num" id="3615124">20</span><span class="op" id="3615126">,</span>&nbsp;<span class="num" id="3615128">16</span><span class="op" id="3615130">,</span>&nbsp;<span class="ident" id="3615132">ecdheECDSAKA</span><span class="op" id="3615144">,</span>&nbsp;<span class="ident" id="3615146">suiteECDHE</span>&nbsp;<span class="op" id="3615157">|</span>&nbsp;<span class="ident" id="3615159">suiteECDSA</span><span class="op" id="3615169">,</span>&nbsp;<span class="ident" id="3615171">cipherAES</span><span class="op" id="3615180">,</span>&nbsp;<span class="ident" id="3615182">macSHA1</span><span class="op" id="3615189">,</span>&nbsp;<span class="ident" id="3615191">nil</span><span class="op" id="3615194">}</span><span class="op" id="3615195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615198">{</span><span class="ident" id="3615199">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3615233">,</span>&nbsp;<span class="num" id="3615235">32</span><span class="op" id="3615237">,</span>&nbsp;<span class="num" id="3615239">20</span><span class="op" id="3615241">,</span>&nbsp;<span class="num" id="3615243">16</span><span class="op" id="3615245">,</span>&nbsp;<span class="ident" id="3615247">ecdheRSAKA</span><span class="op" id="3615257">,</span>&nbsp;<span class="ident" id="3615259">suiteECDHE</span><span class="op" id="3615269">,</span>&nbsp;<span class="ident" id="3615271">cipherAES</span><span class="op" id="3615280">,</span>&nbsp;<span class="ident" id="3615282">macSHA1</span><span class="op" id="3615289">,</span>&nbsp;<span class="ident" id="3615291">nil</span><span class="op" id="3615294">}</span><span class="op" id="3615295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615298">{</span><span class="ident" id="3615299">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3615335">,</span>&nbsp;<span class="num" id="3615337">32</span><span class="op" id="3615339">,</span>&nbsp;<span class="num" id="3615341">20</span><span class="op" id="3615343">,</span>&nbsp;<span class="num" id="3615345">16</span><span class="op" id="3615347">,</span>&nbsp;<span class="ident" id="3615349">ecdheECDSAKA</span><span class="op" id="3615361">,</span>&nbsp;<span class="ident" id="3615363">suiteECDHE</span>&nbsp;<span class="op" id="3615374">|</span>&nbsp;<span class="ident" id="3615376">suiteECDSA</span><span class="op" id="3615386">,</span>&nbsp;<span class="ident" id="3615388">cipherAES</span><span class="op" id="3615397">,</span>&nbsp;<span class="ident" id="3615399">macSHA1</span><span class="op" id="3615406">,</span>&nbsp;<span class="ident" id="3615408">nil</span><span class="op" id="3615411">}</span><span class="op" id="3615412">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615415">{</span><span class="ident" id="3615416">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="3615440">,</span>&nbsp;<span class="num" id="3615442">16</span><span class="op" id="3615444">,</span>&nbsp;<span class="num" id="3615446">20</span><span class="op" id="3615448">,</span>&nbsp;<span class="num" id="3615450">0</span><span class="op" id="3615451">,</span>&nbsp;<span class="ident" id="3615453">rsaKA</span><span class="op" id="3615458">,</span>&nbsp;<span class="num" id="3615460">0</span><span class="op" id="3615461">,</span>&nbsp;<span class="ident" id="3615463">cipherRC4</span><span class="op" id="3615472">,</span>&nbsp;<span class="ident" id="3615474">macSHA1</span><span class="op" id="3615481">,</span>&nbsp;<span class="ident" id="3615483">nil</span><span class="op" id="3615486">}</span><span class="op" id="3615487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615490">{</span><span class="ident" id="3615491">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3615519">,</span>&nbsp;<span class="num" id="3615521">16</span><span class="op" id="3615523">,</span>&nbsp;<span class="num" id="3615525">20</span><span class="op" id="3615527">,</span>&nbsp;<span class="num" id="3615529">16</span><span class="op" id="3615531">,</span>&nbsp;<span class="ident" id="3615533">rsaKA</span><span class="op" id="3615538">,</span>&nbsp;<span class="num" id="3615540">0</span><span class="op" id="3615541">,</span>&nbsp;<span class="ident" id="3615543">cipherAES</span><span class="op" id="3615552">,</span>&nbsp;<span class="ident" id="3615554">macSHA1</span><span class="op" id="3615561">,</span>&nbsp;<span class="ident" id="3615563">nil</span><span class="op" id="3615566">}</span><span class="op" id="3615567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615570">{</span><span class="ident" id="3615571">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3615599">,</span>&nbsp;<span class="num" id="3615601">32</span><span class="op" id="3615603">,</span>&nbsp;<span class="num" id="3615605">20</span><span class="op" id="3615607">,</span>&nbsp;<span class="num" id="3615609">16</span><span class="op" id="3615611">,</span>&nbsp;<span class="ident" id="3615613">rsaKA</span><span class="op" id="3615618">,</span>&nbsp;<span class="num" id="3615620">0</span><span class="op" id="3615621">,</span>&nbsp;<span class="ident" id="3615623">cipherAES</span><span class="op" id="3615632">,</span>&nbsp;<span class="ident" id="3615634">macSHA1</span><span class="op" id="3615641">,</span>&nbsp;<span class="ident" id="3615643">nil</span><span class="op" id="3615646">}</span><span class="op" id="3615647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615650">{</span><span class="ident" id="3615651">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3615686">,</span>&nbsp;<span class="num" id="3615688">24</span><span class="op" id="3615690">,</span>&nbsp;<span class="num" id="3615692">20</span><span class="op" id="3615694">,</span>&nbsp;<span class="num" id="3615696">8</span><span class="op" id="3615697">,</span>&nbsp;<span class="ident" id="3615699">ecdheRSAKA</span><span class="op" id="3615709">,</span>&nbsp;<span class="ident" id="3615711">suiteECDHE</span><span class="op" id="3615721">,</span>&nbsp;<span class="ident" id="3615723">cipher3DES</span><span class="op" id="3615733">,</span>&nbsp;<span class="ident" id="3615735">macSHA1</span><span class="op" id="3615742">,</span>&nbsp;<span class="ident" id="3615744">nil</span><span class="op" id="3615747">}</span><span class="op" id="3615748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615751">{</span><span class="ident" id="3615752">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3615781">,</span>&nbsp;<span class="num" id="3615783">24</span><span class="op" id="3615785">,</span>&nbsp;<span class="num" id="3615787">20</span><span class="op" id="3615789">,</span>&nbsp;<span class="num" id="3615791">8</span><span class="op" id="3615792">,</span>&nbsp;<span class="ident" id="3615794">rsaKA</span><span class="op" id="3615799">,</span>&nbsp;<span class="num" id="3615801">0</span><span class="op" id="3615802">,</span>&nbsp;<span class="ident" id="3615804">cipher3DES</span><span class="op" id="3615814">,</span>&nbsp;<span class="ident" id="3615816">macSHA1</span><span class="op" id="3615823">,</span>&nbsp;<span class="ident" id="3615825">nil</span><span class="op" id="3615828">}</span><span class="op" id="3615829">,</span><br>
<span class="lineno">85</span><span class="op" id="3615831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3615834">func</span>&nbsp;<span class="ident" id="3615839">cipherRC4</span><span class="op" id="3615848">(</span><span class="ident" id="3615849">key</span><span class="op" id="3615852">,</span>&nbsp;<span class="ident" id="3615854">iv</span>&nbsp;<span class="op" id="3615857">[</span><span class="op" id="3615858">]</span><span class="builtintype" id="3615859">byte</span><span class="op" id="3615863">,</span>&nbsp;<span class="ident" id="3615865">isRead</span>&nbsp;<span class="builtintype" id="3615872">bool</span><span class="op" id="3615876">)</span>&nbsp;<span class="keyword" id="3615878">interface</span><span class="op" id="3615887">{</span><span class="op" id="3615888">}</span>&nbsp;<span class="op" id="3615890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615893">cipher</span><span class="op" id="3615899">,</span>&nbsp;<span class="ident" id="3615901">_</span>&nbsp;<span class="op" id="3615903">:=</span>&nbsp;<span class="ident" id="3615906">rc4</span><span class="op" id="3615909">.</span><span class="ident" id="3615910">NewCipher</span><span class="op" id="3615919">(</span><span class="ident" id="3615920">key</span><span class="op" id="3615923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615926">return</span>&nbsp;<span class="ident" id="3615933">cipher</span><br>
<span class="lineno">90</span><span class="op" id="3615940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3615943">func</span>&nbsp;<span class="ident" id="3615948">cipher3DES</span><span class="op" id="3615958">(</span><span class="ident" id="3615959">key</span><span class="op" id="3615962">,</span>&nbsp;<span class="ident" id="3615964">iv</span>&nbsp;<span class="op" id="3615967">[</span><span class="op" id="3615968">]</span><span class="builtintype" id="3615969">byte</span><span class="op" id="3615973">,</span>&nbsp;<span class="ident" id="3615975">isRead</span>&nbsp;<span class="builtintype" id="3615982">bool</span><span class="op" id="3615986">)</span>&nbsp;<span class="keyword" id="3615988">interface</span><span class="op" id="3615997">{</span><span class="op" id="3615998">}</span>&nbsp;<span class="op" id="3616000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616003">block</span><span class="op" id="3616008">,</span>&nbsp;<span class="ident" id="3616010">_</span>&nbsp;<span class="op" id="3616012">:=</span>&nbsp;<span class="ident" id="3616015">des</span><span class="op" id="3616018">.</span><span class="ident" id="3616019">NewTripleDESCipher</span><span class="op" id="3616037">(</span><span class="ident" id="3616038">key</span><span class="op" id="3616041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616044">if</span>&nbsp;<span class="ident" id="3616047">isRead</span>&nbsp;<span class="op" id="3616054">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616058">return</span>&nbsp;<span class="ident" id="3616065">cipher</span><span class="op" id="3616071">.</span><span class="ident" id="3616072">NewCBCDecrypter</span><span class="op" id="3616087">(</span><span class="ident" id="3616088">block</span><span class="op" id="3616093">,</span>&nbsp;<span class="ident" id="3616095">iv</span><span class="op" id="3616097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3616100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616103">return</span>&nbsp;<span class="ident" id="3616110">cipher</span><span class="op" id="3616116">.</span><span class="ident" id="3616117">NewCBCEncrypter</span><span class="op" id="3616132">(</span><span class="ident" id="3616133">block</span><span class="op" id="3616138">,</span>&nbsp;<span class="ident" id="3616140">iv</span><span class="op" id="3616142">)</span><br>
<span class="lineno"></span><span class="op" id="3616144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3616147">func</span>&nbsp;<span class="ident" id="3616152">cipherAES</span><span class="op" id="3616161">(</span><span class="ident" id="3616162">key</span><span class="op" id="3616165">,</span>&nbsp;<span class="ident" id="3616167">iv</span>&nbsp;<span class="op" id="3616170">[</span><span class="op" id="3616171">]</span><span class="builtintype" id="3616172">byte</span><span class="op" id="3616176">,</span>&nbsp;<span class="ident" id="3616178">isRead</span>&nbsp;<span class="builtintype" id="3616185">bool</span><span class="op" id="3616189">)</span>&nbsp;<span class="keyword" id="3616191">interface</span><span class="op" id="3616200">{</span><span class="op" id="3616201">}</span>&nbsp;<span class="op" id="3616203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616206">block</span><span class="op" id="3616211">,</span>&nbsp;<span class="ident" id="3616213">_</span>&nbsp;<span class="op" id="3616215">:=</span>&nbsp;<span class="ident" id="3616218">aes</span><span class="op" id="3616221">.</span><span class="ident" id="3616222">NewCipher</span><span class="op" id="3616231">(</span><span class="ident" id="3616232">key</span><span class="op" id="3616235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616238">if</span>&nbsp;<span class="ident" id="3616241">isRead</span>&nbsp;<span class="op" id="3616248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616252">return</span>&nbsp;<span class="ident" id="3616259">cipher</span><span class="op" id="3616265">.</span><span class="ident" id="3616266">NewCBCDecrypter</span><span class="op" id="3616281">(</span><span class="ident" id="3616282">block</span><span class="op" id="3616287">,</span>&nbsp;<span class="ident" id="3616289">iv</span><span class="op" id="3616291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3616294">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616297">return</span>&nbsp;<span class="ident" id="3616304">cipher</span><span class="op" id="3616310">.</span><span class="ident" id="3616311">NewCBCEncrypter</span><span class="op" id="3616326">(</span><span class="ident" id="3616327">block</span><span class="op" id="3616332">,</span>&nbsp;<span class="ident" id="3616334">iv</span><span class="op" id="3616336">)</span><br>
<span class="lineno"></span><span class="op" id="3616338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3616341">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="3616406">func</span>&nbsp;<span class="ident" id="3616411">macSHA1</span><span class="op" id="3616418">(</span><span class="ident" id="3616419">version</span>&nbsp;<span class="builtintype" id="3616427">uint16</span><span class="op" id="3616433">,</span>&nbsp;<span class="ident" id="3616435">key</span>&nbsp;<span class="op" id="3616439">[</span><span class="op" id="3616440">]</span><span class="builtintype" id="3616441">byte</span><span class="op" id="3616445">)</span>&nbsp;<span class="ident" id="3616447">macFunction</span>&nbsp;<span class="op" id="3616459">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616462">if</span>&nbsp;<span class="ident" id="3616465">version</span>&nbsp;<span class="op" id="3616473">==</span>&nbsp;<span class="ident" id="3616476">VersionSSL30</span>&nbsp;<span class="op" id="3616489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616493">mac</span>&nbsp;<span class="op" id="3616497">:=</span>&nbsp;<span class="ident" id="3616500">ssl30MAC</span><span class="op" id="3616508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616513">h</span><span class="op" id="3616514">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3616518">sha1</span><span class="op" id="3616522">.</span><span class="ident" id="3616523">New</span><span class="op" id="3616526">(</span><span class="op" id="3616527">)</span><span class="op" id="3616528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616533">key</span><span class="op" id="3616536">:</span>&nbsp;<span class="builtinfunc" id="3616538">make</span><span class="op" id="3616542">(</span><span class="op" id="3616543">[</span><span class="op" id="3616544">]</span><span class="builtintype" id="3616545">byte</span><span class="op" id="3616549">,</span>&nbsp;<span class="builtinfunc" id="3616551">len</span><span class="op" id="3616554">(</span><span class="ident" id="3616555">key</span><span class="op" id="3616558">)</span><span class="op" id="3616559">)</span><span class="op" id="3616560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3616564">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3616568">copy</span><span class="op" id="3616572">(</span><span class="ident" id="3616573">mac</span><span class="op" id="3616576">.</span><span class="ident" id="3616577">key</span><span class="op" id="3616580">,</span>&nbsp;<span class="ident" id="3616582">key</span><span class="op" id="3616585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616589">return</span>&nbsp;<span class="ident" id="3616596">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3616601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616604">return</span>&nbsp;<span class="ident" id="3616611">tls10MAC</span><span class="op" id="3616619">{</span><span class="ident" id="3616620">hmac</span><span class="op" id="3616624">.</span><span class="ident" id="3616625">New</span><span class="op" id="3616628">(</span><span class="ident" id="3616629">sha1</span><span class="op" id="3616633">.</span><span class="ident" id="3616634">New</span><span class="op" id="3616637">,</span>&nbsp;<span class="ident" id="3616639">key</span><span class="op" id="3616642">)</span><span class="op" id="3616643">}</span><br>
<span class="lineno"></span><span class="op" id="3616645">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3616648">type</span>&nbsp;<span class="ident" id="3616653">macFunction</span>&nbsp;<span class="keyword" id="3616665">interface</span>&nbsp;<span class="op" id="3616675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616678">Size</span><span class="op" id="3616682">(</span><span class="op" id="3616683">)</span>&nbsp;<span class="builtintype" id="3616685">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616690">MAC</span><span class="op" id="3616693">(</span><span class="ident" id="3616694">digestBuf</span><span class="op" id="3616703">,</span>&nbsp;<span class="ident" id="3616705">seq</span><span class="op" id="3616708">,</span>&nbsp;<span class="ident" id="3616710">header</span><span class="op" id="3616716">,</span>&nbsp;<span class="ident" id="3616718">data</span>&nbsp;<span class="op" id="3616723">[</span><span class="op" id="3616724">]</span><span class="builtintype" id="3616725">byte</span><span class="op" id="3616729">)</span>&nbsp;<span class="op" id="3616731">[</span><span class="op" id="3616732">]</span><span class="builtintype" id="3616733">byte</span><br>
<span class="lineno"></span><span class="op" id="3616738">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="3616741">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3616818">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="3616832">type</span>&nbsp;<span class="ident" id="3616837">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="3616852">struct</span>&nbsp;<span class="op" id="3616859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3616862">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3616933">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3616997">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617052">sealNonce</span><span class="op" id="3617061">,</span>&nbsp;<span class="ident" id="3617063">openNonce</span>&nbsp;<span class="op" id="3617073">[</span><span class="op" id="3617074">]</span><span class="builtintype" id="3617075">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617081">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617102">cipher</span><span class="op" id="3617108">.</span><span class="ident" id="3617109">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3617114">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="3617117">func</span>&nbsp;<span class="op" id="3617122">(</span><span class="ident" id="3617123">f</span>&nbsp;<span class="op" id="3617125">*</span><span class="ident" id="3617126">fixedNonceAEAD</span><span class="op" id="3617140">)</span>&nbsp;<span class="ident" id="3617142">NonceSize</span><span class="op" id="3617151">(</span><span class="op" id="3617152">)</span>&nbsp;<span class="builtintype" id="3617154">int</span>&nbsp;<span class="op" id="3617158">{</span>&nbsp;<span class="keyword" id="3617160">return</span>&nbsp;<span class="num" id="3617167">8</span>&nbsp;<span class="op" id="3617169">}</span><br>
<span class="lineno"></span><span class="keyword" id="3617171">func</span>&nbsp;<span class="op" id="3617176">(</span><span class="ident" id="3617177">f</span>&nbsp;<span class="op" id="3617179">*</span><span class="ident" id="3617180">fixedNonceAEAD</span><span class="op" id="3617194">)</span>&nbsp;<span class="ident" id="3617196">Overhead</span><span class="op" id="3617204">(</span><span class="op" id="3617205">)</span>&nbsp;<span class="builtintype" id="3617207">int</span>&nbsp;&nbsp;<span class="op" id="3617212">{</span>&nbsp;<span class="keyword" id="3617214">return</span>&nbsp;<span class="ident" id="3617221">f</span><span class="op" id="3617222">.</span><span class="ident" id="3617223">aead</span><span class="op" id="3617227">.</span><span class="ident" id="3617228">Overhead</span><span class="op" id="3617236">(</span><span class="op" id="3617237">)</span>&nbsp;<span class="op" id="3617239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3617242">func</span>&nbsp;<span class="op" id="3617247">(</span><span class="ident" id="3617248">f</span>&nbsp;<span class="op" id="3617250">*</span><span class="ident" id="3617251">fixedNonceAEAD</span><span class="op" id="3617265">)</span>&nbsp;<span class="ident" id="3617267">Seal</span><span class="op" id="3617271">(</span><span class="ident" id="3617272">out</span><span class="op" id="3617275">,</span>&nbsp;<span class="ident" id="3617277">nonce</span><span class="op" id="3617282">,</span>&nbsp;<span class="ident" id="3617284">plaintext</span><span class="op" id="3617293">,</span>&nbsp;<span class="ident" id="3617295">additionalData</span>&nbsp;<span class="op" id="3617310">[</span><span class="op" id="3617311">]</span><span class="builtintype" id="3617312">byte</span><span class="op" id="3617316">)</span>&nbsp;<span class="op" id="3617318">[</span><span class="op" id="3617319">]</span><span class="builtintype" id="3617320">byte</span>&nbsp;<span class="op" id="3617325">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3617328">copy</span><span class="op" id="3617332">(</span><span class="ident" id="3617333">f</span><span class="op" id="3617334">.</span><span class="ident" id="3617335">sealNonce</span><span class="op" id="3617344">[</span><span class="builtinfunc" id="3617345">len</span><span class="op" id="3617348">(</span><span class="ident" id="3617349">f</span><span class="op" id="3617350">.</span><span class="ident" id="3617351">sealNonce</span><span class="op" id="3617360">)</span><span class="op" id="3617361">-</span><span class="num" id="3617362">8</span><span class="op" id="3617363">:</span><span class="op" id="3617364">]</span><span class="op" id="3617365">,</span>&nbsp;<span class="ident" id="3617367">nonce</span><span class="op" id="3617372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3617375">return</span>&nbsp;<span class="ident" id="3617382">f</span><span class="op" id="3617383">.</span><span class="ident" id="3617384">aead</span><span class="op" id="3617388">.</span><span class="ident" id="3617389">Seal</span><span class="op" id="3617393">(</span><span class="ident" id="3617394">out</span><span class="op" id="3617397">,</span>&nbsp;<span class="ident" id="3617399">f</span><span class="op" id="3617400">.</span><span class="ident" id="3617401">sealNonce</span><span class="op" id="3617410">,</span>&nbsp;<span class="ident" id="3617412">plaintext</span><span class="op" id="3617421">,</span>&nbsp;<span class="ident" id="3617423">additionalData</span><span class="op" id="3617437">)</span><br>
<span class="lineno"></span><span class="op" id="3617439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3617442">func</span>&nbsp;<span class="op" id="3617447">(</span><span class="ident" id="3617448">f</span>&nbsp;<span class="op" id="3617450">*</span><span class="ident" id="3617451">fixedNonceAEAD</span><span class="op" id="3617465">)</span>&nbsp;<span class="ident" id="3617467">Open</span><span class="op" id="3617471">(</span><span class="ident" id="3617472">out</span><span class="op" id="3617475">,</span>&nbsp;<span class="ident" id="3617477">nonce</span><span class="op" id="3617482">,</span>&nbsp;<span class="ident" id="3617484">plaintext</span><span class="op" id="3617493">,</span>&nbsp;<span class="ident" id="3617495">additionalData</span>&nbsp;<span class="op" id="3617510">[</span><span class="op" id="3617511">]</span><span class="builtintype" id="3617512">byte</span><span class="op" id="3617516">)</span>&nbsp;<span class="op" id="3617518">(</span><span class="op" id="3617519">[</span><span class="op" id="3617520">]</span><span class="builtintype" id="3617521">byte</span><span class="op" id="3617525">,</span>&nbsp;<span class="builtintype" id="3617527">error</span><span class="op" id="3617532">)</span>&nbsp;<span class="op" id="3617534">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3617537">copy</span><span class="op" id="3617541">(</span><span class="ident" id="3617542">f</span><span class="op" id="3617543">.</span><span class="ident" id="3617544">openNonce</span><span class="op" id="3617553">[</span><span class="builtinfunc" id="3617554">len</span><span class="op" id="3617557">(</span><span class="ident" id="3617558">f</span><span class="op" id="3617559">.</span><span class="ident" id="3617560">openNonce</span><span class="op" id="3617569">)</span><span class="op" id="3617570">-</span><span class="num" id="3617571">8</span><span class="op" id="3617572">:</span><span class="op" id="3617573">]</span><span class="op" id="3617574">,</span>&nbsp;<span class="ident" id="3617576">nonce</span><span class="op" id="3617581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3617584">return</span>&nbsp;<span class="ident" id="3617591">f</span><span class="op" id="3617592">.</span><span class="ident" id="3617593">aead</span><span class="op" id="3617597">.</span><span class="ident" id="3617598">Open</span><span class="op" id="3617602">(</span><span class="ident" id="3617603">out</span><span class="op" id="3617606">,</span>&nbsp;<span class="ident" id="3617608">f</span><span class="op" id="3617609">.</span><span class="ident" id="3617610">openNonce</span><span class="op" id="3617619">,</span>&nbsp;<span class="ident" id="3617621">plaintext</span><span class="op" id="3617630">,</span>&nbsp;<span class="ident" id="3617632">additionalData</span><span class="op" id="3617646">)</span><br>
<span class="lineno"></span><span class="op" id="3617648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3617651">func</span>&nbsp;<span class="ident" id="3617656">aeadAESGCM</span><span class="op" id="3617666">(</span><span class="ident" id="3617667">key</span><span class="op" id="3617670">,</span>&nbsp;<span class="ident" id="3617672">fixedNonce</span>&nbsp;<span class="op" id="3617683">[</span><span class="op" id="3617684">]</span><span class="builtintype" id="3617685">byte</span><span class="op" id="3617689">)</span>&nbsp;<span class="ident" id="3617691">cipher</span><span class="op" id="3617697">.</span><span class="ident" id="3617698">AEAD</span>&nbsp;<span class="op" id="3617703">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617706">aes</span><span class="op" id="3617709">,</span>&nbsp;<span class="ident" id="3617711">err</span>&nbsp;<span class="op" id="3617715">:=</span>&nbsp;<span class="ident" id="3617718">aes</span><span class="op" id="3617721">.</span><span class="ident" id="3617722">NewCipher</span><span class="op" id="3617731">(</span><span class="ident" id="3617732">key</span><span class="op" id="3617735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3617738">if</span>&nbsp;<span class="ident" id="3617741">err</span>&nbsp;<span class="op" id="3617745">!=</span>&nbsp;<span class="ident" id="3617748">nil</span>&nbsp;<span class="op" id="3617752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3617756">panic</span><span class="op" id="3617761">(</span><span class="ident" id="3617762">err</span><span class="op" id="3617765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3617768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617771">aead</span><span class="op" id="3617775">,</span>&nbsp;<span class="ident" id="3617777">err</span>&nbsp;<span class="op" id="3617781">:=</span>&nbsp;<span class="ident" id="3617784">cipher</span><span class="op" id="3617790">.</span><span class="ident" id="3617791">NewGCM</span><span class="op" id="3617797">(</span><span class="ident" id="3617798">aes</span><span class="op" id="3617801">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3617804">if</span>&nbsp;<span class="ident" id="3617807">err</span>&nbsp;<span class="op" id="3617811">!=</span>&nbsp;<span class="ident" id="3617814">nil</span>&nbsp;<span class="op" id="3617818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3617822">panic</span><span class="op" id="3617827">(</span><span class="ident" id="3617828">err</span><span class="op" id="3617831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3617834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617838">nonce1</span><span class="op" id="3617844">,</span>&nbsp;<span class="ident" id="3617846">nonce2</span>&nbsp;<span class="op" id="3617853">:=</span>&nbsp;<span class="builtinfunc" id="3617856">make</span><span class="op" id="3617860">(</span><span class="op" id="3617861">[</span><span class="op" id="3617862">]</span><span class="builtintype" id="3617863">byte</span><span class="op" id="3617867">,</span>&nbsp;<span class="num" id="3617869">12</span><span class="op" id="3617871">)</span><span class="op" id="3617872">,</span>&nbsp;<span class="builtinfunc" id="3617874">make</span><span class="op" id="3617878">(</span><span class="op" id="3617879">[</span><span class="op" id="3617880">]</span><span class="builtintype" id="3617881">byte</span><span class="op" id="3617885">,</span>&nbsp;<span class="num" id="3617887">12</span><span class="op" id="3617889">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3617892">copy</span><span class="op" id="3617896">(</span><span class="ident" id="3617897">nonce1</span><span class="op" id="3617903">,</span>&nbsp;<span class="ident" id="3617905">fixedNonce</span><span class="op" id="3617915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3617918">copy</span><span class="op" id="3617922">(</span><span class="ident" id="3617923">nonce2</span><span class="op" id="3617929">,</span>&nbsp;<span class="ident" id="3617931">fixedNonce</span><span class="op" id="3617941">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3617945">return</span>&nbsp;<span class="op" id="3617952">&amp;</span><span class="ident" id="3617953">fixedNonceAEAD</span><span class="op" id="3617967">{</span><span class="ident" id="3617968">nonce1</span><span class="op" id="3617974">,</span>&nbsp;<span class="ident" id="3617976">nonce2</span><span class="op" id="3617982">,</span>&nbsp;<span class="ident" id="3617984">aead</span><span class="op" id="3617988">}</span><br>
<span class="lineno"></span><span class="op" id="3617990">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="3617993">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3618054">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="3618132">type</span>&nbsp;<span class="ident" id="3618137">ssl30MAC</span>&nbsp;<span class="keyword" id="3618146">struct</span>&nbsp;<span class="op" id="3618153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618156">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3618160">hash</span><span class="op" id="3618164">.</span><span class="ident" id="3618165">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618171">key</span>&nbsp;<span class="op" id="3618175">[</span><span class="op" id="3618176">]</span><span class="builtintype" id="3618177">byte</span><br>
<span class="lineno"></span><span class="op" id="3618182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3618185">func</span>&nbsp;<span class="op" id="3618190">(</span><span class="ident" id="3618191">s</span>&nbsp;<span class="ident" id="3618193">ssl30MAC</span><span class="op" id="3618201">)</span>&nbsp;<span class="ident" id="3618203">Size</span><span class="op" id="3618207">(</span><span class="op" id="3618208">)</span>&nbsp;<span class="builtintype" id="3618210">int</span>&nbsp;<span class="op" id="3618214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3618217">return</span>&nbsp;<span class="ident" id="3618224">s</span><span class="op" id="3618225">.</span><span class="ident" id="3618226">h</span><span class="op" id="3618227">.</span><span class="ident" id="3618228">Size</span><span class="op" id="3618232">(</span><span class="op" id="3618233">)</span><br>
<span class="lineno">175</span><span class="op" id="3618235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3618238">var</span>&nbsp;<span class="ident" id="3618242">ssl30Pad1</span>&nbsp;<span class="op" id="3618252">=</span>&nbsp;<span class="op" id="3618254">[</span><span class="num" id="3618255">48</span><span class="op" id="3618257">]</span><span class="builtintype" id="3618258">byte</span><span class="op" id="3618262">{</span><span class="num" id="3618263">0x36</span><span class="op" id="3618267">,</span>&nbsp;<span class="num" id="3618269">0x36</span><span class="op" id="3618273">,</span>&nbsp;<span class="num" id="3618275">0x36</span><span class="op" id="3618279">,</span>&nbsp;<span class="num" id="3618281">0x36</span><span class="op" id="3618285">,</span>&nbsp;<span class="num" id="3618287">0x36</span><span class="op" id="3618291">,</span>&nbsp;<span class="num" id="3618293">0x36</span><span class="op" id="3618297">,</span>&nbsp;<span class="num" id="3618299">0x36</span><span class="op" id="3618303">,</span>&nbsp;<span class="num" id="3618305">0x36</span><span class="op" id="3618309">,</span>&nbsp;<span class="num" id="3618311">0x36</span><span class="op" id="3618315">,</span>&nbsp;<span class="num" id="3618317">0x36</span><span class="op" id="3618321">,</span>&nbsp;<span class="num" id="3618323">0x36</span><span class="op" id="3618327">,</span>&nbsp;<span class="num" id="3618329">0x36</span><span class="op" id="3618333">,</span>&nbsp;<span class="num" id="3618335">0x36</span><span class="op" id="3618339">,</span>&nbsp;<span class="num" id="3618341">0x36</span><span class="op" id="3618345">,</span>&nbsp;<span class="num" id="3618347">0x36</span><span class="op" id="3618351">,</span>&nbsp;<span class="num" id="3618353">0x36</span><span class="op" id="3618357">,</span>&nbsp;<span class="num" id="3618359">0x36</span><span class="op" id="3618363">,</span>&nbsp;<span class="num" id="3618365">0x36</span><span class="op" id="3618369">,</span>&nbsp;<span class="num" id="3618371">0x36</span><span class="op" id="3618375">,</span>&nbsp;<span class="num" id="3618377">0x36</span><span class="op" id="3618381">,</span>&nbsp;<span class="num" id="3618383">0x36</span><span class="op" id="3618387">,</span>&nbsp;<span class="num" id="3618389">0x36</span><span class="op" id="3618393">,</span>&nbsp;<span class="num" id="3618395">0x36</span><span class="op" id="3618399">,</span>&nbsp;<span class="num" id="3618401">0x36</span><span class="op" id="3618405">,</span>&nbsp;<span class="num" id="3618407">0x36</span><span class="op" id="3618411">,</span>&nbsp;<span class="num" id="3618413">0x36</span><span class="op" id="3618417">,</span>&nbsp;<span class="num" id="3618419">0x36</span><span class="op" id="3618423">,</span>&nbsp;<span class="num" id="3618425">0x36</span><span class="op" id="3618429">,</span>&nbsp;<span class="num" id="3618431">0x36</span><span class="op" id="3618435">,</span>&nbsp;<span class="num" id="3618437">0x36</span><span class="op" id="3618441">,</span>&nbsp;<span class="num" id="3618443">0x36</span><span class="op" id="3618447">,</span>&nbsp;<span class="num" id="3618449">0x36</span><span class="op" id="3618453">,</span>&nbsp;<span class="num" id="3618455">0x36</span><span class="op" id="3618459">,</span>&nbsp;<span class="num" id="3618461">0x36</span><span class="op" id="3618465">,</span>&nbsp;<span class="num" id="3618467">0x36</span><span class="op" id="3618471">,</span>&nbsp;<span class="num" id="3618473">0x36</span><span class="op" id="3618477">,</span>&nbsp;<span class="num" id="3618479">0x36</span><span class="op" id="3618483">,</span>&nbsp;<span class="num" id="3618485">0x36</span><span class="op" id="3618489">,</span>&nbsp;<span class="num" id="3618491">0x36</span><span class="op" id="3618495">,</span>&nbsp;<span class="num" id="3618497">0x36</span><span class="op" id="3618501">,</span>&nbsp;<span class="num" id="3618503">0x36</span><span class="op" id="3618507">,</span>&nbsp;<span class="num" id="3618509">0x36</span><span class="op" id="3618513">,</span>&nbsp;<span class="num" id="3618515">0x36</span><span class="op" id="3618519">,</span>&nbsp;<span class="num" id="3618521">0x36</span><span class="op" id="3618525">,</span>&nbsp;<span class="num" id="3618527">0x36</span><span class="op" id="3618531">,</span>&nbsp;<span class="num" id="3618533">0x36</span><span class="op" id="3618537">,</span>&nbsp;<span class="num" id="3618539">0x36</span><span class="op" id="3618543">,</span>&nbsp;<span class="num" id="3618545">0x36</span><span class="op" id="3618549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3618552">var</span>&nbsp;<span class="ident" id="3618556">ssl30Pad2</span>&nbsp;<span class="op" id="3618566">=</span>&nbsp;<span class="op" id="3618568">[</span><span class="num" id="3618569">48</span><span class="op" id="3618571">]</span><span class="builtintype" id="3618572">byte</span><span class="op" id="3618576">{</span><span class="num" id="3618577">0x5c</span><span class="op" id="3618581">,</span>&nbsp;<span class="num" id="3618583">0x5c</span><span class="op" id="3618587">,</span>&nbsp;<span class="num" id="3618589">0x5c</span><span class="op" id="3618593">,</span>&nbsp;<span class="num" id="3618595">0x5c</span><span class="op" id="3618599">,</span>&nbsp;<span class="num" id="3618601">0x5c</span><span class="op" id="3618605">,</span>&nbsp;<span class="num" id="3618607">0x5c</span><span class="op" id="3618611">,</span>&nbsp;<span class="num" id="3618613">0x5c</span><span class="op" id="3618617">,</span>&nbsp;<span class="num" id="3618619">0x5c</span><span class="op" id="3618623">,</span>&nbsp;<span class="num" id="3618625">0x5c</span><span class="op" id="3618629">,</span>&nbsp;<span class="num" id="3618631">0x5c</span><span class="op" id="3618635">,</span>&nbsp;<span class="num" id="3618637">0x5c</span><span class="op" id="3618641">,</span>&nbsp;<span class="num" id="3618643">0x5c</span><span class="op" id="3618647">,</span>&nbsp;<span class="num" id="3618649">0x5c</span><span class="op" id="3618653">,</span>&nbsp;<span class="num" id="3618655">0x5c</span><span class="op" id="3618659">,</span>&nbsp;<span class="num" id="3618661">0x5c</span><span class="op" id="3618665">,</span>&nbsp;<span class="num" id="3618667">0x5c</span><span class="op" id="3618671">,</span>&nbsp;<span class="num" id="3618673">0x5c</span><span class="op" id="3618677">,</span>&nbsp;<span class="num" id="3618679">0x5c</span><span class="op" id="3618683">,</span>&nbsp;<span class="num" id="3618685">0x5c</span><span class="op" id="3618689">,</span>&nbsp;<span class="num" id="3618691">0x5c</span><span class="op" id="3618695">,</span>&nbsp;<span class="num" id="3618697">0x5c</span><span class="op" id="3618701">,</span>&nbsp;<span class="num" id="3618703">0x5c</span><span class="op" id="3618707">,</span>&nbsp;<span class="num" id="3618709">0x5c</span><span class="op" id="3618713">,</span>&nbsp;<span class="num" id="3618715">0x5c</span><span class="op" id="3618719">,</span>&nbsp;<span class="num" id="3618721">0x5c</span><span class="op" id="3618725">,</span>&nbsp;<span class="num" id="3618727">0x5c</span><span class="op" id="3618731">,</span>&nbsp;<span class="num" id="3618733">0x5c</span><span class="op" id="3618737">,</span>&nbsp;<span class="num" id="3618739">0x5c</span><span class="op" id="3618743">,</span>&nbsp;<span class="num" id="3618745">0x5c</span><span class="op" id="3618749">,</span>&nbsp;<span class="num" id="3618751">0x5c</span><span class="op" id="3618755">,</span>&nbsp;<span class="num" id="3618757">0x5c</span><span class="op" id="3618761">,</span>&nbsp;<span class="num" id="3618763">0x5c</span><span class="op" id="3618767">,</span>&nbsp;<span class="num" id="3618769">0x5c</span><span class="op" id="3618773">,</span>&nbsp;<span class="num" id="3618775">0x5c</span><span class="op" id="3618779">,</span>&nbsp;<span class="num" id="3618781">0x5c</span><span class="op" id="3618785">,</span>&nbsp;<span class="num" id="3618787">0x5c</span><span class="op" id="3618791">,</span>&nbsp;<span class="num" id="3618793">0x5c</span><span class="op" id="3618797">,</span>&nbsp;<span class="num" id="3618799">0x5c</span><span class="op" id="3618803">,</span>&nbsp;<span class="num" id="3618805">0x5c</span><span class="op" id="3618809">,</span>&nbsp;<span class="num" id="3618811">0x5c</span><span class="op" id="3618815">,</span>&nbsp;<span class="num" id="3618817">0x5c</span><span class="op" id="3618821">,</span>&nbsp;<span class="num" id="3618823">0x5c</span><span class="op" id="3618827">,</span>&nbsp;<span class="num" id="3618829">0x5c</span><span class="op" id="3618833">,</span>&nbsp;<span class="num" id="3618835">0x5c</span><span class="op" id="3618839">,</span>&nbsp;<span class="num" id="3618841">0x5c</span><span class="op" id="3618845">,</span>&nbsp;<span class="num" id="3618847">0x5c</span><span class="op" id="3618851">,</span>&nbsp;<span class="num" id="3618853">0x5c</span><span class="op" id="3618857">,</span>&nbsp;<span class="num" id="3618859">0x5c</span><span class="op" id="3618863">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3618866">func</span>&nbsp;<span class="op" id="3618871">(</span><span class="ident" id="3618872">s</span>&nbsp;<span class="ident" id="3618874">ssl30MAC</span><span class="op" id="3618882">)</span>&nbsp;<span class="ident" id="3618884">MAC</span><span class="op" id="3618887">(</span><span class="ident" id="3618888">digestBuf</span><span class="op" id="3618897">,</span>&nbsp;<span class="ident" id="3618899">seq</span><span class="op" id="3618902">,</span>&nbsp;<span class="ident" id="3618904">header</span><span class="op" id="3618910">,</span>&nbsp;<span class="ident" id="3618912">data</span>&nbsp;<span class="op" id="3618917">[</span><span class="op" id="3618918">]</span><span class="builtintype" id="3618919">byte</span><span class="op" id="3618923">)</span>&nbsp;<span class="op" id="3618925">[</span><span class="op" id="3618926">]</span><span class="builtintype" id="3618927">byte</span>&nbsp;<span class="op" id="3618932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618935">padLength</span>&nbsp;<span class="op" id="3618945">:=</span>&nbsp;<span class="num" id="3618948">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3618952">if</span>&nbsp;<span class="ident" id="3618955">s</span><span class="op" id="3618956">.</span><span class="ident" id="3618957">h</span><span class="op" id="3618958">.</span><span class="ident" id="3618959">Size</span><span class="op" id="3618963">(</span><span class="op" id="3618964">)</span>&nbsp;<span class="op" id="3618966">==</span>&nbsp;<span class="num" id="3618969">20</span>&nbsp;<span class="op" id="3618972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618976">padLength</span>&nbsp;<span class="op" id="3618986">=</span>&nbsp;<span class="num" id="3618988">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3618992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618996">s</span><span class="op" id="3618997">.</span><span class="ident" id="3618998">h</span><span class="op" id="3618999">.</span><span class="ident" id="3619000">Reset</span><span class="op" id="3619005">(</span><span class="op" id="3619006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619009">s</span><span class="op" id="3619010">.</span><span class="ident" id="3619011">h</span><span class="op" id="3619012">.</span><span class="ident" id="3619013">Write</span><span class="op" id="3619018">(</span><span class="ident" id="3619019">s</span><span class="op" id="3619020">.</span><span class="ident" id="3619021">key</span><span class="op" id="3619024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619027">s</span><span class="op" id="3619028">.</span><span class="ident" id="3619029">h</span><span class="op" id="3619030">.</span><span class="ident" id="3619031">Write</span><span class="op" id="3619036">(</span><span class="ident" id="3619037">ssl30Pad1</span><span class="op" id="3619046">[</span><span class="op" id="3619047">:</span><span class="ident" id="3619048">padLength</span><span class="op" id="3619057">]</span><span class="op" id="3619058">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619061">s</span><span class="op" id="3619062">.</span><span class="ident" id="3619063">h</span><span class="op" id="3619064">.</span><span class="ident" id="3619065">Write</span><span class="op" id="3619070">(</span><span class="ident" id="3619071">seq</span><span class="op" id="3619074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619077">s</span><span class="op" id="3619078">.</span><span class="ident" id="3619079">h</span><span class="op" id="3619080">.</span><span class="ident" id="3619081">Write</span><span class="op" id="3619086">(</span><span class="ident" id="3619087">header</span><span class="op" id="3619093">[</span><span class="op" id="3619094">:</span><span class="num" id="3619095">1</span><span class="op" id="3619096">]</span><span class="op" id="3619097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619100">s</span><span class="op" id="3619101">.</span><span class="ident" id="3619102">h</span><span class="op" id="3619103">.</span><span class="ident" id="3619104">Write</span><span class="op" id="3619109">(</span><span class="ident" id="3619110">header</span><span class="op" id="3619116">[</span><span class="num" id="3619117">3</span><span class="op" id="3619118">:</span><span class="num" id="3619119">5</span><span class="op" id="3619120">]</span><span class="op" id="3619121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619124">s</span><span class="op" id="3619125">.</span><span class="ident" id="3619126">h</span><span class="op" id="3619127">.</span><span class="ident" id="3619128">Write</span><span class="op" id="3619133">(</span><span class="ident" id="3619134">data</span><span class="op" id="3619138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619141">digestBuf</span>&nbsp;<span class="op" id="3619151">=</span>&nbsp;<span class="ident" id="3619153">s</span><span class="op" id="3619154">.</span><span class="ident" id="3619155">h</span><span class="op" id="3619156">.</span><span class="ident" id="3619157">Sum</span><span class="op" id="3619160">(</span><span class="ident" id="3619161">digestBuf</span><span class="op" id="3619170">[</span><span class="op" id="3619171">:</span><span class="num" id="3619172">0</span><span class="op" id="3619173">]</span><span class="op" id="3619174">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619178">s</span><span class="op" id="3619179">.</span><span class="ident" id="3619180">h</span><span class="op" id="3619181">.</span><span class="ident" id="3619182">Reset</span><span class="op" id="3619187">(</span><span class="op" id="3619188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619191">s</span><span class="op" id="3619192">.</span><span class="ident" id="3619193">h</span><span class="op" id="3619194">.</span><span class="ident" id="3619195">Write</span><span class="op" id="3619200">(</span><span class="ident" id="3619201">s</span><span class="op" id="3619202">.</span><span class="ident" id="3619203">key</span><span class="op" id="3619206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619209">s</span><span class="op" id="3619210">.</span><span class="ident" id="3619211">h</span><span class="op" id="3619212">.</span><span class="ident" id="3619213">Write</span><span class="op" id="3619218">(</span><span class="ident" id="3619219">ssl30Pad2</span><span class="op" id="3619228">[</span><span class="op" id="3619229">:</span><span class="ident" id="3619230">padLength</span><span class="op" id="3619239">]</span><span class="op" id="3619240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619243">s</span><span class="op" id="3619244">.</span><span class="ident" id="3619245">h</span><span class="op" id="3619246">.</span><span class="ident" id="3619247">Write</span><span class="op" id="3619252">(</span><span class="ident" id="3619253">digestBuf</span><span class="op" id="3619262">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619265">return</span>&nbsp;<span class="ident" id="3619272">s</span><span class="op" id="3619273">.</span><span class="ident" id="3619274">h</span><span class="op" id="3619275">.</span><span class="ident" id="3619276">Sum</span><span class="op" id="3619279">(</span><span class="ident" id="3619280">digestBuf</span><span class="op" id="3619289">[</span><span class="op" id="3619290">:</span><span class="num" id="3619291">0</span><span class="op" id="3619292">]</span><span class="op" id="3619293">)</span><br>
<span class="lineno"></span><span class="op" id="3619295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3619298">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="3619372">type</span>&nbsp;<span class="ident" id="3619377">tls10MAC</span>&nbsp;<span class="keyword" id="3619386">struct</span>&nbsp;<span class="op" id="3619393">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619396">h</span>&nbsp;<span class="ident" id="3619398">hash</span><span class="op" id="3619402">.</span><span class="ident" id="3619403">Hash</span><br>
<span class="lineno"></span><span class="op" id="3619408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3619411">func</span>&nbsp;<span class="op" id="3619416">(</span><span class="ident" id="3619417">s</span>&nbsp;<span class="ident" id="3619419">tls10MAC</span><span class="op" id="3619427">)</span>&nbsp;<span class="ident" id="3619429">Size</span><span class="op" id="3619433">(</span><span class="op" id="3619434">)</span>&nbsp;<span class="builtintype" id="3619436">int</span>&nbsp;<span class="op" id="3619440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619443">return</span>&nbsp;<span class="ident" id="3619450">s</span><span class="op" id="3619451">.</span><span class="ident" id="3619452">h</span><span class="op" id="3619453">.</span><span class="ident" id="3619454">Size</span><span class="op" id="3619458">(</span><span class="op" id="3619459">)</span><br>
<span class="lineno">210</span><span class="op" id="3619461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3619464">func</span>&nbsp;<span class="op" id="3619469">(</span><span class="ident" id="3619470">s</span>&nbsp;<span class="ident" id="3619472">tls10MAC</span><span class="op" id="3619480">)</span>&nbsp;<span class="ident" id="3619482">MAC</span><span class="op" id="3619485">(</span><span class="ident" id="3619486">digestBuf</span><span class="op" id="3619495">,</span>&nbsp;<span class="ident" id="3619497">seq</span><span class="op" id="3619500">,</span>&nbsp;<span class="ident" id="3619502">header</span><span class="op" id="3619508">,</span>&nbsp;<span class="ident" id="3619510">data</span>&nbsp;<span class="op" id="3619515">[</span><span class="op" id="3619516">]</span><span class="builtintype" id="3619517">byte</span><span class="op" id="3619521">)</span>&nbsp;<span class="op" id="3619523">[</span><span class="op" id="3619524">]</span><span class="builtintype" id="3619525">byte</span>&nbsp;<span class="op" id="3619530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619533">s</span><span class="op" id="3619534">.</span><span class="ident" id="3619535">h</span><span class="op" id="3619536">.</span><span class="ident" id="3619537">Reset</span><span class="op" id="3619542">(</span><span class="op" id="3619543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619546">s</span><span class="op" id="3619547">.</span><span class="ident" id="3619548">h</span><span class="op" id="3619549">.</span><span class="ident" id="3619550">Write</span><span class="op" id="3619555">(</span><span class="ident" id="3619556">seq</span><span class="op" id="3619559">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619562">s</span><span class="op" id="3619563">.</span><span class="ident" id="3619564">h</span><span class="op" id="3619565">.</span><span class="ident" id="3619566">Write</span><span class="op" id="3619571">(</span><span class="ident" id="3619572">header</span><span class="op" id="3619578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619581">s</span><span class="op" id="3619582">.</span><span class="ident" id="3619583">h</span><span class="op" id="3619584">.</span><span class="ident" id="3619585">Write</span><span class="op" id="3619590">(</span><span class="ident" id="3619591">data</span><span class="op" id="3619595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619598">return</span>&nbsp;<span class="ident" id="3619605">s</span><span class="op" id="3619606">.</span><span class="ident" id="3619607">h</span><span class="op" id="3619608">.</span><span class="ident" id="3619609">Sum</span><span class="op" id="3619612">(</span><span class="ident" id="3619613">digestBuf</span><span class="op" id="3619622">[</span><span class="op" id="3619623">:</span><span class="num" id="3619624">0</span><span class="op" id="3619625">]</span><span class="op" id="3619626">)</span><br>
<span class="lineno"></span><span class="op" id="3619628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3619631">func</span>&nbsp;<span class="ident" id="3619636">rsaKA</span><span class="op" id="3619641">(</span><span class="ident" id="3619642">version</span>&nbsp;<span class="builtintype" id="3619650">uint16</span><span class="op" id="3619656">)</span>&nbsp;<span class="ident" id="3619658">keyAgreement</span>&nbsp;<span class="op" id="3619671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619674">return</span>&nbsp;<span class="ident" id="3619681">rsaKeyAgreement</span><span class="op" id="3619696">{</span><span class="op" id="3619697">}</span><br>
<span class="lineno"></span><span class="op" id="3619699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3619702">func</span>&nbsp;<span class="ident" id="3619707">ecdheECDSAKA</span><span class="op" id="3619719">(</span><span class="ident" id="3619720">version</span>&nbsp;<span class="builtintype" id="3619728">uint16</span><span class="op" id="3619734">)</span>&nbsp;<span class="ident" id="3619736">keyAgreement</span>&nbsp;<span class="op" id="3619749">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619752">return</span>&nbsp;<span class="op" id="3619759">&amp;</span><span class="ident" id="3619760">ecdheKeyAgreement</span><span class="op" id="3619777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619781">sigType</span><span class="op" id="3619788">:</span>&nbsp;<span class="ident" id="3619790">signatureECDSA</span><span class="op" id="3619804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619808">version</span><span class="op" id="3619815">:</span>&nbsp;<span class="ident" id="3619817">version</span><span class="op" id="3619824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619827">}</span><br>
<span class="lineno"></span><span class="op" id="3619829">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3619832">func</span>&nbsp;<span class="ident" id="3619837">ecdheRSAKA</span><span class="op" id="3619847">(</span><span class="ident" id="3619848">version</span>&nbsp;<span class="builtintype" id="3619856">uint16</span><span class="op" id="3619862">)</span>&nbsp;<span class="ident" id="3619864">keyAgreement</span>&nbsp;<span class="op" id="3619877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619880">return</span>&nbsp;<span class="op" id="3619887">&amp;</span><span class="ident" id="3619888">ecdheKeyAgreement</span><span class="op" id="3619905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619909">sigType</span><span class="op" id="3619916">:</span>&nbsp;<span class="ident" id="3619918">signatureRSA</span><span class="op" id="3619930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619934">version</span><span class="op" id="3619941">:</span>&nbsp;<span class="ident" id="3619943">version</span><span class="op" id="3619950">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619953">}</span><br>
<span class="lineno"></span><span class="op" id="3619955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3619958">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="3620027">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="3620077">func</span>&nbsp;<span class="ident" id="3620082">mutualCipherSuite</span><span class="op" id="3620099">(</span><span class="ident" id="3620100">have</span>&nbsp;<span class="op" id="3620105">[</span><span class="op" id="3620106">]</span><span class="builtintype" id="3620107">uint16</span><span class="op" id="3620113">,</span>&nbsp;<span class="ident" id="3620115">want</span>&nbsp;<span class="builtintype" id="3620120">uint16</span><span class="op" id="3620126">)</span>&nbsp;<span class="op" id="3620128">*</span><span class="ident" id="3620129">cipherSuite</span>&nbsp;<span class="op" id="3620141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3620144">for</span>&nbsp;<span class="ident" id="3620148">_</span><span class="op" id="3620149">,</span>&nbsp;<span class="ident" id="3620151">id</span>&nbsp;<span class="op" id="3620154">:=</span>&nbsp;<span class="keyword" id="3620157">range</span>&nbsp;<span class="ident" id="3620163">have</span>&nbsp;<span class="op" id="3620168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3620172">if</span>&nbsp;<span class="ident" id="3620175">id</span>&nbsp;<span class="op" id="3620178">==</span>&nbsp;<span class="ident" id="3620181">want</span>&nbsp;<span class="op" id="3620186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3620191">for</span>&nbsp;<span class="ident" id="3620195">_</span><span class="op" id="3620196">,</span>&nbsp;<span class="ident" id="3620198">suite</span>&nbsp;<span class="op" id="3620204">:=</span>&nbsp;<span class="keyword" id="3620207">range</span>&nbsp;<span class="ident" id="3620213">cipherSuites</span>&nbsp;<span class="op" id="3620226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3620232">if</span>&nbsp;<span class="ident" id="3620235">suite</span><span class="op" id="3620240">.</span><span class="ident" id="3620241">id</span>&nbsp;<span class="op" id="3620244">==</span>&nbsp;<span class="ident" id="3620247">want</span>&nbsp;<span class="op" id="3620252">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3620259">return</span>&nbsp;<span class="ident" id="3620266">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3620276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3620281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3620286">return</span>&nbsp;<span class="ident" id="3620293">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3620299">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3620302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3620305">return</span>&nbsp;<span class="ident" id="3620312">nil</span><br>
<span class="lineno"></span><span class="op" id="3620316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3620319">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="3620374">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="3620443">const</span>&nbsp;<span class="op" id="3620449">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620452">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620492">uint16</span>&nbsp;<span class="op" id="3620499">=</span>&nbsp;<span class="num" id="3620501">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620509">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620549">uint16</span>&nbsp;<span class="op" id="3620556">=</span>&nbsp;<span class="num" id="3620558">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620566">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620606">uint16</span>&nbsp;<span class="op" id="3620613">=</span>&nbsp;<span class="num" id="3620615">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620623">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620663">uint16</span>&nbsp;<span class="op" id="3620670">=</span>&nbsp;<span class="num" id="3620672">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620680">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620720">uint16</span>&nbsp;<span class="op" id="3620727">=</span>&nbsp;<span class="num" id="3620729">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620737">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620777">uint16</span>&nbsp;<span class="op" id="3620784">=</span>&nbsp;<span class="num" id="3620786">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620794">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620834">uint16</span>&nbsp;<span class="op" id="3620841">=</span>&nbsp;<span class="num" id="3620843">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620851">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620891">uint16</span>&nbsp;<span class="op" id="3620898">=</span>&nbsp;<span class="num" id="3620900">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620908">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620948">uint16</span>&nbsp;<span class="op" id="3620955">=</span>&nbsp;<span class="num" id="3620957">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620965">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3621005">uint16</span>&nbsp;<span class="op" id="3621012">=</span>&nbsp;<span class="num" id="3621014">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621022">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3621062">uint16</span>&nbsp;<span class="op" id="3621069">=</span>&nbsp;<span class="num" id="3621071">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621079">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3621119">uint16</span>&nbsp;<span class="op" id="3621126">=</span>&nbsp;<span class="num" id="3621128">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621136">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="3621176">uint16</span>&nbsp;<span class="op" id="3621183">=</span>&nbsp;<span class="num" id="3621185">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621194">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621263">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621314">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621380">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="3621398">uint16</span>&nbsp;<span class="op" id="3621405">=</span>&nbsp;<span class="num" id="3621407">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="3621414">)</span>
</div>
</body>
</html>
