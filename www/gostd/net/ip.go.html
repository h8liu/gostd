<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html" class="current">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3920299">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3920354">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3920408">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3920459">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="3920487">//</span><br>
<span class="lineno"></span><span class="comment" id="3920490">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3920550">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3920608">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="3920658">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="3920719">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3920750">package</span>&nbsp;<span class="ident" id="3920758">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3920763">import</span>&nbsp;<span class="string" id="3920770">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3920780">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="3920811">const</span>&nbsp;<span class="op" id="3920817">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920820">IPv4len</span>&nbsp;<span class="op" id="3920828">=</span>&nbsp;<span class="num" id="3920830">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920833">IPv6len</span>&nbsp;<span class="op" id="3920841">=</span>&nbsp;<span class="num" id="3920843">16</span><br>
<span class="lineno"></span><span class="op" id="3920846">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3920849">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3920900">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="3920957">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3920995">//</span><br>
<span class="lineno"></span><span class="comment" id="3920998">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3921050">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="3921102">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="3921157">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="3921212">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3921235">type</span>&nbsp;<span class="ident" id="3921240">IP</span>&nbsp;<span class="op" id="3921243">[</span><span class="op" id="3921244">]</span><span class="builtintype" id="3921245">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3921251">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="3921283">type</span>&nbsp;<span class="ident" id="3921288">IPMask</span>&nbsp;<span class="op" id="3921295">[</span><span class="op" id="3921296">]</span><span class="builtintype" id="3921297">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3921303">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="3921341">type</span>&nbsp;<span class="ident" id="3921346">IPNet</span>&nbsp;<span class="keyword" id="3921352">struct</span>&nbsp;<span class="op" id="3921359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921362">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3921367">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3921374">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921393">Mask</span>&nbsp;<span class="ident" id="3921398">IPMask</span>&nbsp;<span class="comment" id="3921405">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="3921421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3921424">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3921480">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="3921505">func</span>&nbsp;<span class="ident" id="3921510">IPv4</span><span class="op" id="3921514">(</span><span class="ident" id="3921515">a</span><span class="op" id="3921516">,</span>&nbsp;<span class="ident" id="3921518">b</span><span class="op" id="3921519">,</span>&nbsp;<span class="ident" id="3921521">c</span><span class="op" id="3921522">,</span>&nbsp;<span class="ident" id="3921524">d</span>&nbsp;<span class="builtintype" id="3921526">byte</span><span class="op" id="3921530">)</span>&nbsp;<span class="ident" id="3921532">IP</span>&nbsp;<span class="op" id="3921535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921538">p</span>&nbsp;<span class="op" id="3921540">:=</span>&nbsp;<span class="builtinfunc" id="3921543">make</span><span class="op" id="3921547">(</span><span class="ident" id="3921548">IP</span><span class="op" id="3921550">,</span>&nbsp;<span class="ident" id="3921552">IPv6len</span><span class="op" id="3921559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3921562">copy</span><span class="op" id="3921566">(</span><span class="ident" id="3921567">p</span><span class="op" id="3921568">,</span>&nbsp;<span class="ident" id="3921570">v4InV6Prefix</span><span class="op" id="3921582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921585">p</span><span class="op" id="3921586">[</span><span class="num" id="3921587">12</span><span class="op" id="3921589">]</span>&nbsp;<span class="op" id="3921591">=</span>&nbsp;<span class="ident" id="3921593">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921596">p</span><span class="op" id="3921597">[</span><span class="num" id="3921598">13</span><span class="op" id="3921600">]</span>&nbsp;<span class="op" id="3921602">=</span>&nbsp;<span class="ident" id="3921604">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921607">p</span><span class="op" id="3921608">[</span><span class="num" id="3921609">14</span><span class="op" id="3921611">]</span>&nbsp;<span class="op" id="3921613">=</span>&nbsp;<span class="ident" id="3921615">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921618">p</span><span class="op" id="3921619">[</span><span class="num" id="3921620">15</span><span class="op" id="3921622">]</span>&nbsp;<span class="op" id="3921624">=</span>&nbsp;<span class="ident" id="3921626">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3921629">return</span>&nbsp;<span class="ident" id="3921636">p</span><br>
<span class="lineno"></span><span class="op" id="3921638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3921641">var</span>&nbsp;<span class="ident" id="3921645">v4InV6Prefix</span>&nbsp;<span class="op" id="3921658">=</span>&nbsp;<span class="op" id="3921660">[</span><span class="op" id="3921661">]</span><span class="builtintype" id="3921662">byte</span><span class="op" id="3921666">{</span><span class="num" id="3921667">0</span><span class="op" id="3921668">,</span>&nbsp;<span class="num" id="3921670">0</span><span class="op" id="3921671">,</span>&nbsp;<span class="num" id="3921673">0</span><span class="op" id="3921674">,</span>&nbsp;<span class="num" id="3921676">0</span><span class="op" id="3921677">,</span>&nbsp;<span class="num" id="3921679">0</span><span class="op" id="3921680">,</span>&nbsp;<span class="num" id="3921682">0</span><span class="op" id="3921683">,</span>&nbsp;<span class="num" id="3921685">0</span><span class="op" id="3921686">,</span>&nbsp;<span class="num" id="3921688">0</span><span class="op" id="3921689">,</span>&nbsp;<span class="num" id="3921691">0</span><span class="op" id="3921692">,</span>&nbsp;<span class="num" id="3921694">0</span><span class="op" id="3921695">,</span>&nbsp;<span class="num" id="3921697">0xff</span><span class="op" id="3921701">,</span>&nbsp;<span class="num" id="3921703">0xff</span><span class="op" id="3921707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3921710">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3921766">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="3921788">func</span>&nbsp;<span class="ident" id="3921793">IPv4Mask</span><span class="op" id="3921801">(</span><span class="ident" id="3921802">a</span><span class="op" id="3921803">,</span>&nbsp;<span class="ident" id="3921805">b</span><span class="op" id="3921806">,</span>&nbsp;<span class="ident" id="3921808">c</span><span class="op" id="3921809">,</span>&nbsp;<span class="ident" id="3921811">d</span>&nbsp;<span class="builtintype" id="3921813">byte</span><span class="op" id="3921817">)</span>&nbsp;<span class="ident" id="3921819">IPMask</span>&nbsp;<span class="op" id="3921826">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921829">p</span>&nbsp;<span class="op" id="3921831">:=</span>&nbsp;<span class="builtinfunc" id="3921834">make</span><span class="op" id="3921838">(</span><span class="ident" id="3921839">IPMask</span><span class="op" id="3921845">,</span>&nbsp;<span class="ident" id="3921847">IPv4len</span><span class="op" id="3921854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921857">p</span><span class="op" id="3921858">[</span><span class="num" id="3921859">0</span><span class="op" id="3921860">]</span>&nbsp;<span class="op" id="3921862">=</span>&nbsp;<span class="ident" id="3921864">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921867">p</span><span class="op" id="3921868">[</span><span class="num" id="3921869">1</span><span class="op" id="3921870">]</span>&nbsp;<span class="op" id="3921872">=</span>&nbsp;<span class="ident" id="3921874">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921877">p</span><span class="op" id="3921878">[</span><span class="num" id="3921879">2</span><span class="op" id="3921880">]</span>&nbsp;<span class="op" id="3921882">=</span>&nbsp;<span class="ident" id="3921884">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3921887">p</span><span class="op" id="3921888">[</span><span class="num" id="3921889">3</span><span class="op" id="3921890">]</span>&nbsp;<span class="op" id="3921892">=</span>&nbsp;<span class="ident" id="3921894">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3921897">return</span>&nbsp;<span class="ident" id="3921904">p</span><br>
<span class="lineno"></span><span class="op" id="3921906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3921909">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="3921967">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="3922022">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="3922090">func</span>&nbsp;<span class="ident" id="3922095">CIDRMask</span><span class="op" id="3922103">(</span><span class="ident" id="3922104">ones</span><span class="op" id="3922108">,</span>&nbsp;<span class="ident" id="3922110">bits</span>&nbsp;<span class="builtintype" id="3922115">int</span><span class="op" id="3922118">)</span>&nbsp;<span class="ident" id="3922120">IPMask</span>&nbsp;<span class="op" id="3922127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3922130">if</span>&nbsp;<span class="ident" id="3922133">bits</span>&nbsp;<span class="op" id="3922138">!=</span>&nbsp;<span class="num" id="3922141">8</span><span class="op" id="3922142">*</span><span class="ident" id="3922143">IPv4len</span>&nbsp;<span class="op" id="3922151">&amp;&amp;</span>&nbsp;<span class="ident" id="3922154">bits</span>&nbsp;<span class="op" id="3922159">!=</span>&nbsp;<span class="num" id="3922162">8</span><span class="op" id="3922163">*</span><span class="ident" id="3922164">IPv6len</span>&nbsp;<span class="op" id="3922172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3922176">return</span>&nbsp;<span class="builtintype" id="3922183">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922188">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3922191">if</span>&nbsp;<span class="ident" id="3922194">ones</span>&nbsp;<span class="op" id="3922199">&lt;</span>&nbsp;<span class="num" id="3922201">0</span>&nbsp;<span class="op" id="3922203">||</span>&nbsp;<span class="ident" id="3922206">ones</span>&nbsp;<span class="op" id="3922211">&gt;</span>&nbsp;<span class="ident" id="3922213">bits</span>&nbsp;<span class="op" id="3922218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3922222">return</span>&nbsp;<span class="builtintype" id="3922229">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922237">l</span>&nbsp;<span class="op" id="3922239">:=</span>&nbsp;<span class="ident" id="3922242">bits</span>&nbsp;<span class="op" id="3922247">/</span>&nbsp;<span class="num" id="3922249">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922252">m</span>&nbsp;<span class="op" id="3922254">:=</span>&nbsp;<span class="builtinfunc" id="3922257">make</span><span class="op" id="3922261">(</span><span class="ident" id="3922262">IPMask</span><span class="op" id="3922268">,</span>&nbsp;<span class="ident" id="3922270">l</span><span class="op" id="3922271">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922274">n</span>&nbsp;<span class="op" id="3922276">:=</span>&nbsp;<span class="builtintype" id="3922279">uint</span><span class="op" id="3922283">(</span><span class="ident" id="3922284">ones</span><span class="op" id="3922288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3922291">for</span>&nbsp;<span class="ident" id="3922295">i</span>&nbsp;<span class="op" id="3922297">:=</span>&nbsp;<span class="num" id="3922300">0</span><span class="op" id="3922301">;</span>&nbsp;<span class="ident" id="3922303">i</span>&nbsp;<span class="op" id="3922305">&lt;</span>&nbsp;<span class="ident" id="3922307">l</span><span class="op" id="3922308">;</span>&nbsp;<span class="ident" id="3922310">i</span><span class="op" id="3922311">++</span>&nbsp;<span class="op" id="3922314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3922318">if</span>&nbsp;<span class="ident" id="3922321">n</span>&nbsp;<span class="op" id="3922323">&gt;=</span>&nbsp;<span class="num" id="3922326">8</span>&nbsp;<span class="op" id="3922328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922333">m</span><span class="op" id="3922334">[</span><span class="ident" id="3922335">i</span><span class="op" id="3922336">]</span>&nbsp;<span class="op" id="3922338">=</span>&nbsp;<span class="num" id="3922340">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922348">n</span>&nbsp;<span class="op" id="3922350">-=</span>&nbsp;<span class="num" id="3922353">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3922358">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922373">m</span><span class="op" id="3922374">[</span><span class="ident" id="3922375">i</span><span class="op" id="3922376">]</span>&nbsp;<span class="op" id="3922378">=</span>&nbsp;<span class="op" id="3922380">^</span><span class="builtintype" id="3922381">byte</span><span class="op" id="3922385">(</span><span class="num" id="3922386">0xff</span>&nbsp;<span class="op" id="3922391">&gt;&gt;</span>&nbsp;<span class="ident" id="3922394">n</span><span class="op" id="3922395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922399">n</span>&nbsp;<span class="op" id="3922401">=</span>&nbsp;<span class="num" id="3922403">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922406">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3922409">return</span>&nbsp;<span class="ident" id="3922416">m</span><br>
<span class="lineno"></span><span class="op" id="3922418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3922421">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3922450">var</span>&nbsp;<span class="op" id="3922454">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922457">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922471">=</span>&nbsp;<span class="ident" id="3922473">IPv4</span><span class="op" id="3922477">(</span><span class="num" id="3922478">255</span><span class="op" id="3922481">,</span>&nbsp;<span class="num" id="3922483">255</span><span class="op" id="3922486">,</span>&nbsp;<span class="num" id="3922488">255</span><span class="op" id="3922491">,</span>&nbsp;<span class="num" id="3922493">255</span><span class="op" id="3922496">)</span>&nbsp;<span class="comment" id="3922498">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922512">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922526">=</span>&nbsp;<span class="ident" id="3922528">IPv4</span><span class="op" id="3922532">(</span><span class="num" id="3922533">224</span><span class="op" id="3922536">,</span>&nbsp;<span class="num" id="3922538">0</span><span class="op" id="3922539">,</span>&nbsp;<span class="num" id="3922541">0</span><span class="op" id="3922542">,</span>&nbsp;<span class="num" id="3922544">1</span><span class="op" id="3922545">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3922553">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922569">IPv4allrouter</span>&nbsp;<span class="op" id="3922583">=</span>&nbsp;<span class="ident" id="3922585">IPv4</span><span class="op" id="3922589">(</span><span class="num" id="3922590">224</span><span class="op" id="3922593">,</span>&nbsp;<span class="num" id="3922595">0</span><span class="op" id="3922596">,</span>&nbsp;<span class="num" id="3922598">0</span><span class="op" id="3922599">,</span>&nbsp;<span class="num" id="3922601">2</span><span class="op" id="3922602">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3922610">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922626">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922640">=</span>&nbsp;<span class="ident" id="3922642">IPv4</span><span class="op" id="3922646">(</span><span class="num" id="3922647">0</span><span class="op" id="3922648">,</span>&nbsp;<span class="num" id="3922650">0</span><span class="op" id="3922651">,</span>&nbsp;<span class="num" id="3922653">0</span><span class="op" id="3922654">,</span>&nbsp;<span class="num" id="3922656">0</span><span class="op" id="3922657">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3922667">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="3922680">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3922683">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3922712">var</span>&nbsp;<span class="op" id="3922716">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922719">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922746">=</span>&nbsp;<span class="ident" id="3922748">IP</span><span class="op" id="3922750">{</span><span class="num" id="3922751">0</span><span class="op" id="3922752">,</span>&nbsp;<span class="num" id="3922754">0</span><span class="op" id="3922755">,</span>&nbsp;<span class="num" id="3922757">0</span><span class="op" id="3922758">,</span>&nbsp;<span class="num" id="3922760">0</span><span class="op" id="3922761">,</span>&nbsp;<span class="num" id="3922763">0</span><span class="op" id="3922764">,</span>&nbsp;<span class="num" id="3922766">0</span><span class="op" id="3922767">,</span>&nbsp;<span class="num" id="3922769">0</span><span class="op" id="3922770">,</span>&nbsp;<span class="num" id="3922772">0</span><span class="op" id="3922773">,</span>&nbsp;<span class="num" id="3922775">0</span><span class="op" id="3922776">,</span>&nbsp;<span class="num" id="3922778">0</span><span class="op" id="3922779">,</span>&nbsp;<span class="num" id="3922781">0</span><span class="op" id="3922782">,</span>&nbsp;<span class="num" id="3922784">0</span><span class="op" id="3922785">,</span>&nbsp;<span class="num" id="3922787">0</span><span class="op" id="3922788">,</span>&nbsp;<span class="num" id="3922790">0</span><span class="op" id="3922791">,</span>&nbsp;<span class="num" id="3922793">0</span><span class="op" id="3922794">,</span>&nbsp;<span class="num" id="3922796">0</span><span class="op" id="3922797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922800">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922827">=</span>&nbsp;<span class="ident" id="3922829">IP</span><span class="op" id="3922831">{</span><span class="num" id="3922832">0</span><span class="op" id="3922833">,</span>&nbsp;<span class="num" id="3922835">0</span><span class="op" id="3922836">,</span>&nbsp;<span class="num" id="3922838">0</span><span class="op" id="3922839">,</span>&nbsp;<span class="num" id="3922841">0</span><span class="op" id="3922842">,</span>&nbsp;<span class="num" id="3922844">0</span><span class="op" id="3922845">,</span>&nbsp;<span class="num" id="3922847">0</span><span class="op" id="3922848">,</span>&nbsp;<span class="num" id="3922850">0</span><span class="op" id="3922851">,</span>&nbsp;<span class="num" id="3922853">0</span><span class="op" id="3922854">,</span>&nbsp;<span class="num" id="3922856">0</span><span class="op" id="3922857">,</span>&nbsp;<span class="num" id="3922859">0</span><span class="op" id="3922860">,</span>&nbsp;<span class="num" id="3922862">0</span><span class="op" id="3922863">,</span>&nbsp;<span class="num" id="3922865">0</span><span class="op" id="3922866">,</span>&nbsp;<span class="num" id="3922868">0</span><span class="op" id="3922869">,</span>&nbsp;<span class="num" id="3922871">0</span><span class="op" id="3922872">,</span>&nbsp;<span class="num" id="3922874">0</span><span class="op" id="3922875">,</span>&nbsp;<span class="num" id="3922877">0</span><span class="op" id="3922878">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922881">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3922908">=</span>&nbsp;<span class="ident" id="3922910">IP</span><span class="op" id="3922912">{</span><span class="num" id="3922913">0</span><span class="op" id="3922914">,</span>&nbsp;<span class="num" id="3922916">0</span><span class="op" id="3922917">,</span>&nbsp;<span class="num" id="3922919">0</span><span class="op" id="3922920">,</span>&nbsp;<span class="num" id="3922922">0</span><span class="op" id="3922923">,</span>&nbsp;<span class="num" id="3922925">0</span><span class="op" id="3922926">,</span>&nbsp;<span class="num" id="3922928">0</span><span class="op" id="3922929">,</span>&nbsp;<span class="num" id="3922931">0</span><span class="op" id="3922932">,</span>&nbsp;<span class="num" id="3922934">0</span><span class="op" id="3922935">,</span>&nbsp;<span class="num" id="3922937">0</span><span class="op" id="3922938">,</span>&nbsp;<span class="num" id="3922940">0</span><span class="op" id="3922941">,</span>&nbsp;<span class="num" id="3922943">0</span><span class="op" id="3922944">,</span>&nbsp;<span class="num" id="3922946">0</span><span class="op" id="3922947">,</span>&nbsp;<span class="num" id="3922949">0</span><span class="op" id="3922950">,</span>&nbsp;<span class="num" id="3922952">0</span><span class="op" id="3922953">,</span>&nbsp;<span class="num" id="3922955">0</span><span class="op" id="3922956">,</span>&nbsp;<span class="num" id="3922958">1</span><span class="op" id="3922959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3922962">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="3922989">=</span>&nbsp;<span class="ident" id="3922991">IP</span><span class="op" id="3922993">{</span><span class="num" id="3922994">0xff</span><span class="op" id="3922998">,</span>&nbsp;<span class="num" id="3923000">0x01</span><span class="op" id="3923004">,</span>&nbsp;<span class="num" id="3923006">0</span><span class="op" id="3923007">,</span>&nbsp;<span class="num" id="3923009">0</span><span class="op" id="3923010">,</span>&nbsp;<span class="num" id="3923012">0</span><span class="op" id="3923013">,</span>&nbsp;<span class="num" id="3923015">0</span><span class="op" id="3923016">,</span>&nbsp;<span class="num" id="3923018">0</span><span class="op" id="3923019">,</span>&nbsp;<span class="num" id="3923021">0</span><span class="op" id="3923022">,</span>&nbsp;<span class="num" id="3923024">0</span><span class="op" id="3923025">,</span>&nbsp;<span class="num" id="3923027">0</span><span class="op" id="3923028">,</span>&nbsp;<span class="num" id="3923030">0</span><span class="op" id="3923031">,</span>&nbsp;<span class="num" id="3923033">0</span><span class="op" id="3923034">,</span>&nbsp;<span class="num" id="3923036">0</span><span class="op" id="3923037">,</span>&nbsp;<span class="num" id="3923039">0</span><span class="op" id="3923040">,</span>&nbsp;<span class="num" id="3923042">0</span><span class="op" id="3923043">,</span>&nbsp;<span class="num" id="3923045">0x01</span><span class="op" id="3923049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923052">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3923079">=</span>&nbsp;<span class="ident" id="3923081">IP</span><span class="op" id="3923083">{</span><span class="num" id="3923084">0xff</span><span class="op" id="3923088">,</span>&nbsp;<span class="num" id="3923090">0x02</span><span class="op" id="3923094">,</span>&nbsp;<span class="num" id="3923096">0</span><span class="op" id="3923097">,</span>&nbsp;<span class="num" id="3923099">0</span><span class="op" id="3923100">,</span>&nbsp;<span class="num" id="3923102">0</span><span class="op" id="3923103">,</span>&nbsp;<span class="num" id="3923105">0</span><span class="op" id="3923106">,</span>&nbsp;<span class="num" id="3923108">0</span><span class="op" id="3923109">,</span>&nbsp;<span class="num" id="3923111">0</span><span class="op" id="3923112">,</span>&nbsp;<span class="num" id="3923114">0</span><span class="op" id="3923115">,</span>&nbsp;<span class="num" id="3923117">0</span><span class="op" id="3923118">,</span>&nbsp;<span class="num" id="3923120">0</span><span class="op" id="3923121">,</span>&nbsp;<span class="num" id="3923123">0</span><span class="op" id="3923124">,</span>&nbsp;<span class="num" id="3923126">0</span><span class="op" id="3923127">,</span>&nbsp;<span class="num" id="3923129">0</span><span class="op" id="3923130">,</span>&nbsp;<span class="num" id="3923132">0</span><span class="op" id="3923133">,</span>&nbsp;<span class="num" id="3923135">0x01</span><span class="op" id="3923139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923142">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3923169">=</span>&nbsp;<span class="ident" id="3923171">IP</span><span class="op" id="3923173">{</span><span class="num" id="3923174">0xff</span><span class="op" id="3923178">,</span>&nbsp;<span class="num" id="3923180">0x02</span><span class="op" id="3923184">,</span>&nbsp;<span class="num" id="3923186">0</span><span class="op" id="3923187">,</span>&nbsp;<span class="num" id="3923189">0</span><span class="op" id="3923190">,</span>&nbsp;<span class="num" id="3923192">0</span><span class="op" id="3923193">,</span>&nbsp;<span class="num" id="3923195">0</span><span class="op" id="3923196">,</span>&nbsp;<span class="num" id="3923198">0</span><span class="op" id="3923199">,</span>&nbsp;<span class="num" id="3923201">0</span><span class="op" id="3923202">,</span>&nbsp;<span class="num" id="3923204">0</span><span class="op" id="3923205">,</span>&nbsp;<span class="num" id="3923207">0</span><span class="op" id="3923208">,</span>&nbsp;<span class="num" id="3923210">0</span><span class="op" id="3923211">,</span>&nbsp;<span class="num" id="3923213">0</span><span class="op" id="3923214">,</span>&nbsp;<span class="num" id="3923216">0</span><span class="op" id="3923217">,</span>&nbsp;<span class="num" id="3923219">0</span><span class="op" id="3923220">,</span>&nbsp;<span class="num" id="3923222">0</span><span class="op" id="3923223">,</span>&nbsp;<span class="num" id="3923225">0x02</span><span class="op" id="3923229">}</span><br>
<span class="lineno"></span><span class="op" id="3923231">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3923234">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3923297">func</span>&nbsp;<span class="op" id="3923302">(</span><span class="ident" id="3923303">ip</span>&nbsp;<span class="ident" id="3923306">IP</span><span class="op" id="3923308">)</span>&nbsp;<span class="ident" id="3923310">IsUnspecified</span><span class="op" id="3923323">(</span><span class="op" id="3923324">)</span>&nbsp;<span class="builtintype" id="3923326">bool</span>&nbsp;<span class="op" id="3923331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923334">if</span>&nbsp;<span class="ident" id="3923337">ip</span><span class="op" id="3923339">.</span><span class="ident" id="3923340">Equal</span><span class="op" id="3923345">(</span><span class="ident" id="3923346">IPv4zero</span><span class="op" id="3923354">)</span>&nbsp;<span class="op" id="3923356">||</span>&nbsp;<span class="ident" id="3923359">ip</span><span class="op" id="3923361">.</span><span class="ident" id="3923362">Equal</span><span class="op" id="3923367">(</span><span class="ident" id="3923368">IPv6unspecified</span><span class="op" id="3923383">)</span>&nbsp;<span class="op" id="3923385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923389">return</span>&nbsp;<span class="builtintype" id="3923396">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3923402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923405">return</span>&nbsp;<span class="builtintype" id="3923412">false</span><br>
<span class="lineno"></span><span class="op" id="3923418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3923421">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="3923477">func</span>&nbsp;<span class="op" id="3923482">(</span><span class="ident" id="3923483">ip</span>&nbsp;<span class="ident" id="3923486">IP</span><span class="op" id="3923488">)</span>&nbsp;<span class="ident" id="3923490">IsLoopback</span><span class="op" id="3923500">(</span><span class="op" id="3923501">)</span>&nbsp;<span class="builtintype" id="3923503">bool</span>&nbsp;<span class="op" id="3923508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923511">if</span>&nbsp;<span class="ident" id="3923514">ip4</span>&nbsp;<span class="op" id="3923518">:=</span>&nbsp;<span class="ident" id="3923521">ip</span><span class="op" id="3923523">.</span><span class="ident" id="3923524">To4</span><span class="op" id="3923527">(</span><span class="op" id="3923528">)</span><span class="op" id="3923529">;</span>&nbsp;<span class="ident" id="3923531">ip4</span>&nbsp;<span class="op" id="3923535">!=</span>&nbsp;<span class="builtintype" id="3923538">nil</span>&nbsp;<span class="op" id="3923542">&amp;&amp;</span>&nbsp;<span class="ident" id="3923545">ip4</span><span class="op" id="3923548">[</span><span class="num" id="3923549">0</span><span class="op" id="3923550">]</span>&nbsp;<span class="op" id="3923552">==</span>&nbsp;<span class="num" id="3923555">127</span>&nbsp;<span class="op" id="3923559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923563">return</span>&nbsp;<span class="builtintype" id="3923570">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3923576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923579">return</span>&nbsp;<span class="ident" id="3923586">ip</span><span class="op" id="3923588">.</span><span class="ident" id="3923589">Equal</span><span class="op" id="3923594">(</span><span class="ident" id="3923595">IPv6loopback</span><span class="op" id="3923607">)</span><br>
<span class="lineno">125</span><span class="op" id="3923609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3923612">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3923670">func</span>&nbsp;<span class="op" id="3923675">(</span><span class="ident" id="3923676">ip</span>&nbsp;<span class="ident" id="3923679">IP</span><span class="op" id="3923681">)</span>&nbsp;<span class="ident" id="3923683">IsMulticast</span><span class="op" id="3923694">(</span><span class="op" id="3923695">)</span>&nbsp;<span class="builtintype" id="3923697">bool</span>&nbsp;<span class="op" id="3923702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923705">if</span>&nbsp;<span class="ident" id="3923708">ip4</span>&nbsp;<span class="op" id="3923712">:=</span>&nbsp;<span class="ident" id="3923715">ip</span><span class="op" id="3923717">.</span><span class="ident" id="3923718">To4</span><span class="op" id="3923721">(</span><span class="op" id="3923722">)</span><span class="op" id="3923723">;</span>&nbsp;<span class="ident" id="3923725">ip4</span>&nbsp;<span class="op" id="3923729">!=</span>&nbsp;<span class="builtintype" id="3923732">nil</span>&nbsp;<span class="op" id="3923736">&amp;&amp;</span>&nbsp;<span class="ident" id="3923739">ip4</span><span class="op" id="3923742">[</span><span class="num" id="3923743">0</span><span class="op" id="3923744">]</span><span class="op" id="3923745">&amp;</span><span class="num" id="3923746">0xf0</span>&nbsp;<span class="op" id="3923751">==</span>&nbsp;<span class="num" id="3923754">0xe0</span>&nbsp;<span class="op" id="3923759">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923763">return</span>&nbsp;<span class="builtintype" id="3923770">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3923776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923779">return</span>&nbsp;<span class="ident" id="3923786">ip</span><span class="op" id="3923788">[</span><span class="num" id="3923789">0</span><span class="op" id="3923790">]</span>&nbsp;<span class="op" id="3923792">==</span>&nbsp;<span class="num" id="3923795">0xff</span><br>
<span class="lineno"></span><span class="op" id="3923800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3923803">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3923858">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3923899">func</span>&nbsp;<span class="op" id="3923904">(</span><span class="ident" id="3923905">ip</span>&nbsp;<span class="ident" id="3923908">IP</span><span class="op" id="3923910">)</span>&nbsp;<span class="ident" id="3923912">IsInterfaceLocalMulticast</span><span class="op" id="3923937">(</span><span class="op" id="3923938">)</span>&nbsp;<span class="builtintype" id="3923940">bool</span>&nbsp;<span class="op" id="3923945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923948">return</span>&nbsp;<span class="builtinfunc" id="3923955">len</span><span class="op" id="3923958">(</span><span class="ident" id="3923959">ip</span><span class="op" id="3923961">)</span>&nbsp;<span class="op" id="3923963">==</span>&nbsp;<span class="ident" id="3923966">IPv6len</span>&nbsp;<span class="op" id="3923974">&amp;&amp;</span>&nbsp;<span class="ident" id="3923977">ip</span><span class="op" id="3923979">[</span><span class="num" id="3923980">0</span><span class="op" id="3923981">]</span>&nbsp;<span class="op" id="3923983">==</span>&nbsp;<span class="num" id="3923986">0xff</span>&nbsp;<span class="op" id="3923991">&amp;&amp;</span>&nbsp;<span class="ident" id="3923994">ip</span><span class="op" id="3923996">[</span><span class="num" id="3923997">1</span><span class="op" id="3923998">]</span><span class="op" id="3923999">&amp;</span><span class="num" id="3924000">0x0f</span>&nbsp;<span class="op" id="3924005">==</span>&nbsp;<span class="num" id="3924008">0x01</span><br>
<span class="lineno"></span><span class="op" id="3924013">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="3924016">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3924075">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3924097">func</span>&nbsp;<span class="op" id="3924102">(</span><span class="ident" id="3924103">ip</span>&nbsp;<span class="ident" id="3924106">IP</span><span class="op" id="3924108">)</span>&nbsp;<span class="ident" id="3924110">IsLinkLocalMulticast</span><span class="op" id="3924130">(</span><span class="op" id="3924131">)</span>&nbsp;<span class="builtintype" id="3924133">bool</span>&nbsp;<span class="op" id="3924138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924141">if</span>&nbsp;<span class="ident" id="3924144">ip4</span>&nbsp;<span class="op" id="3924148">:=</span>&nbsp;<span class="ident" id="3924151">ip</span><span class="op" id="3924153">.</span><span class="ident" id="3924154">To4</span><span class="op" id="3924157">(</span><span class="op" id="3924158">)</span><span class="op" id="3924159">;</span>&nbsp;<span class="ident" id="3924161">ip4</span>&nbsp;<span class="op" id="3924165">!=</span>&nbsp;<span class="builtintype" id="3924168">nil</span>&nbsp;<span class="op" id="3924172">&amp;&amp;</span>&nbsp;<span class="ident" id="3924175">ip4</span><span class="op" id="3924178">[</span><span class="num" id="3924179">0</span><span class="op" id="3924180">]</span>&nbsp;<span class="op" id="3924182">==</span>&nbsp;<span class="num" id="3924185">224</span>&nbsp;<span class="op" id="3924189">&amp;&amp;</span>&nbsp;<span class="ident" id="3924192">ip4</span><span class="op" id="3924195">[</span><span class="num" id="3924196">1</span><span class="op" id="3924197">]</span>&nbsp;<span class="op" id="3924199">==</span>&nbsp;<span class="num" id="3924202">0</span>&nbsp;<span class="op" id="3924204">&amp;&amp;</span>&nbsp;<span class="ident" id="3924207">ip4</span><span class="op" id="3924210">[</span><span class="num" id="3924211">2</span><span class="op" id="3924212">]</span>&nbsp;<span class="op" id="3924214">==</span>&nbsp;<span class="num" id="3924217">0</span>&nbsp;<span class="op" id="3924219">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924223">return</span>&nbsp;<span class="builtintype" id="3924230">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924239">return</span>&nbsp;<span class="ident" id="3924246">ip</span><span class="op" id="3924248">[</span><span class="num" id="3924249">0</span><span class="op" id="3924250">]</span>&nbsp;<span class="op" id="3924252">==</span>&nbsp;<span class="num" id="3924255">0xff</span>&nbsp;<span class="op" id="3924260">&amp;&amp;</span>&nbsp;<span class="ident" id="3924263">ip</span><span class="op" id="3924265">[</span><span class="num" id="3924266">1</span><span class="op" id="3924267">]</span><span class="op" id="3924268">&amp;</span><span class="num" id="3924269">0x0f</span>&nbsp;<span class="op" id="3924274">==</span>&nbsp;<span class="num" id="3924277">0x02</span><br>
<span class="lineno"></span><span class="op" id="3924282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3924285">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3924342">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3924362">func</span>&nbsp;<span class="op" id="3924367">(</span><span class="ident" id="3924368">ip</span>&nbsp;<span class="ident" id="3924371">IP</span><span class="op" id="3924373">)</span>&nbsp;<span class="ident" id="3924375">IsLinkLocalUnicast</span><span class="op" id="3924393">(</span><span class="op" id="3924394">)</span>&nbsp;<span class="builtintype" id="3924396">bool</span>&nbsp;<span class="op" id="3924401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924404">if</span>&nbsp;<span class="ident" id="3924407">ip4</span>&nbsp;<span class="op" id="3924411">:=</span>&nbsp;<span class="ident" id="3924414">ip</span><span class="op" id="3924416">.</span><span class="ident" id="3924417">To4</span><span class="op" id="3924420">(</span><span class="op" id="3924421">)</span><span class="op" id="3924422">;</span>&nbsp;<span class="ident" id="3924424">ip4</span>&nbsp;<span class="op" id="3924428">!=</span>&nbsp;<span class="builtintype" id="3924431">nil</span>&nbsp;<span class="op" id="3924435">&amp;&amp;</span>&nbsp;<span class="ident" id="3924438">ip4</span><span class="op" id="3924441">[</span><span class="num" id="3924442">0</span><span class="op" id="3924443">]</span>&nbsp;<span class="op" id="3924445">==</span>&nbsp;<span class="num" id="3924448">169</span>&nbsp;<span class="op" id="3924452">&amp;&amp;</span>&nbsp;<span class="ident" id="3924455">ip4</span><span class="op" id="3924458">[</span><span class="num" id="3924459">1</span><span class="op" id="3924460">]</span>&nbsp;<span class="op" id="3924462">==</span>&nbsp;<span class="num" id="3924465">254</span>&nbsp;<span class="op" id="3924469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924473">return</span>&nbsp;<span class="builtintype" id="3924480">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924489">return</span>&nbsp;<span class="ident" id="3924496">ip</span><span class="op" id="3924498">[</span><span class="num" id="3924499">0</span><span class="op" id="3924500">]</span>&nbsp;<span class="op" id="3924502">==</span>&nbsp;<span class="num" id="3924505">0xfe</span>&nbsp;<span class="op" id="3924510">&amp;&amp;</span>&nbsp;<span class="ident" id="3924513">ip</span><span class="op" id="3924515">[</span><span class="num" id="3924516">1</span><span class="op" id="3924517">]</span><span class="op" id="3924518">&amp;</span><span class="num" id="3924519">0xc0</span>&nbsp;<span class="op" id="3924524">==</span>&nbsp;<span class="num" id="3924527">0x80</span><br>
<span class="lineno"></span><span class="op" id="3924532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3924535">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="3924593">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3924605">func</span>&nbsp;<span class="op" id="3924610">(</span><span class="ident" id="3924611">ip</span>&nbsp;<span class="ident" id="3924614">IP</span><span class="op" id="3924616">)</span>&nbsp;<span class="ident" id="3924618">IsGlobalUnicast</span><span class="op" id="3924633">(</span><span class="op" id="3924634">)</span>&nbsp;<span class="builtintype" id="3924636">bool</span>&nbsp;<span class="op" id="3924641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924644">return</span>&nbsp;<span class="op" id="3924651">!</span><span class="ident" id="3924652">ip</span><span class="op" id="3924654">.</span><span class="ident" id="3924655">IsUnspecified</span><span class="op" id="3924668">(</span><span class="op" id="3924669">)</span>&nbsp;<span class="op" id="3924671">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924676">!</span><span class="ident" id="3924677">ip</span><span class="op" id="3924679">.</span><span class="ident" id="3924680">IsLoopback</span><span class="op" id="3924690">(</span><span class="op" id="3924691">)</span>&nbsp;<span class="op" id="3924693">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924698">!</span><span class="ident" id="3924699">ip</span><span class="op" id="3924701">.</span><span class="ident" id="3924702">IsMulticast</span><span class="op" id="3924713">(</span><span class="op" id="3924714">)</span>&nbsp;<span class="op" id="3924716">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924721">!</span><span class="ident" id="3924722">ip</span><span class="op" id="3924724">.</span><span class="ident" id="3924725">IsLinkLocalUnicast</span><span class="op" id="3924743">(</span><span class="op" id="3924744">)</span><br>
<span class="lineno"></span><span class="op" id="3924746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3924749">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="3924768">func</span>&nbsp;<span class="ident" id="3924773">isZeros</span><span class="op" id="3924780">(</span><span class="ident" id="3924781">p</span>&nbsp;<span class="ident" id="3924783">IP</span><span class="op" id="3924785">)</span>&nbsp;<span class="builtintype" id="3924787">bool</span>&nbsp;<span class="op" id="3924792">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924795">for</span>&nbsp;<span class="ident" id="3924799">i</span>&nbsp;<span class="op" id="3924801">:=</span>&nbsp;<span class="num" id="3924804">0</span><span class="op" id="3924805">;</span>&nbsp;<span class="ident" id="3924807">i</span>&nbsp;<span class="op" id="3924809">&lt;</span>&nbsp;<span class="builtinfunc" id="3924811">len</span><span class="op" id="3924814">(</span><span class="ident" id="3924815">p</span><span class="op" id="3924816">)</span><span class="op" id="3924817">;</span>&nbsp;<span class="ident" id="3924819">i</span><span class="op" id="3924820">++</span>&nbsp;<span class="op" id="3924823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924827">if</span>&nbsp;<span class="ident" id="3924830">p</span><span class="op" id="3924831">[</span><span class="ident" id="3924832">i</span><span class="op" id="3924833">]</span>&nbsp;<span class="op" id="3924835">!=</span>&nbsp;<span class="num" id="3924838">0</span>&nbsp;<span class="op" id="3924840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924845">return</span>&nbsp;<span class="builtintype" id="3924852">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924863">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924866">return</span>&nbsp;<span class="builtintype" id="3924873">true</span><br>
<span class="lineno"></span><span class="op" id="3924878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3924881">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3924945">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="3924995">func</span>&nbsp;<span class="op" id="3925000">(</span><span class="ident" id="3925001">ip</span>&nbsp;<span class="ident" id="3925004">IP</span><span class="op" id="3925006">)</span>&nbsp;<span class="ident" id="3925008">To4</span><span class="op" id="3925011">(</span><span class="op" id="3925012">)</span>&nbsp;<span class="ident" id="3925014">IP</span>&nbsp;<span class="op" id="3925017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925020">if</span>&nbsp;<span class="builtinfunc" id="3925023">len</span><span class="op" id="3925026">(</span><span class="ident" id="3925027">ip</span><span class="op" id="3925029">)</span>&nbsp;<span class="op" id="3925031">==</span>&nbsp;<span class="ident" id="3925034">IPv4len</span>&nbsp;<span class="op" id="3925042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925046">return</span>&nbsp;<span class="ident" id="3925053">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3925057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925060">if</span>&nbsp;<span class="builtinfunc" id="3925063">len</span><span class="op" id="3925066">(</span><span class="ident" id="3925067">ip</span><span class="op" id="3925069">)</span>&nbsp;<span class="op" id="3925071">==</span>&nbsp;<span class="ident" id="3925074">IPv6len</span>&nbsp;<span class="op" id="3925082">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3925087">isZeros</span><span class="op" id="3925094">(</span><span class="ident" id="3925095">ip</span><span class="op" id="3925097">[</span><span class="num" id="3925098">0</span><span class="op" id="3925099">:</span><span class="num" id="3925100">10</span><span class="op" id="3925102">]</span><span class="op" id="3925103">)</span>&nbsp;<span class="op" id="3925105">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3925110">ip</span><span class="op" id="3925112">[</span><span class="num" id="3925113">10</span><span class="op" id="3925115">]</span>&nbsp;<span class="op" id="3925117">==</span>&nbsp;<span class="num" id="3925120">0xff</span>&nbsp;<span class="op" id="3925125">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3925130">ip</span><span class="op" id="3925132">[</span><span class="num" id="3925133">11</span><span class="op" id="3925135">]</span>&nbsp;<span class="op" id="3925137">==</span>&nbsp;<span class="num" id="3925140">0xff</span>&nbsp;<span class="op" id="3925145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925149">return</span>&nbsp;<span class="ident" id="3925156">ip</span><span class="op" id="3925158">[</span><span class="num" id="3925159">12</span><span class="op" id="3925161">:</span><span class="num" id="3925162">16</span><span class="op" id="3925164">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3925167">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925170">return</span>&nbsp;<span class="builtintype" id="3925177">nil</span><br>
<span class="lineno"></span><span class="op" id="3925181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3925184">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3925248">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="3925322">func</span>&nbsp;<span class="op" id="3925327">(</span><span class="ident" id="3925328">ip</span>&nbsp;<span class="ident" id="3925331">IP</span><span class="op" id="3925333">)</span>&nbsp;<span class="ident" id="3925335">To16</span><span class="op" id="3925339">(</span><span class="op" id="3925340">)</span>&nbsp;<span class="ident" id="3925342">IP</span>&nbsp;<span class="op" id="3925345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925348">if</span>&nbsp;<span class="builtinfunc" id="3925351">len</span><span class="op" id="3925354">(</span><span class="ident" id="3925355">ip</span><span class="op" id="3925357">)</span>&nbsp;<span class="op" id="3925359">==</span>&nbsp;<span class="ident" id="3925362">IPv4len</span>&nbsp;<span class="op" id="3925370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925374">return</span>&nbsp;<span class="ident" id="3925381">IPv4</span><span class="op" id="3925385">(</span><span class="ident" id="3925386">ip</span><span class="op" id="3925388">[</span><span class="num" id="3925389">0</span><span class="op" id="3925390">]</span><span class="op" id="3925391">,</span>&nbsp;<span class="ident" id="3925393">ip</span><span class="op" id="3925395">[</span><span class="num" id="3925396">1</span><span class="op" id="3925397">]</span><span class="op" id="3925398">,</span>&nbsp;<span class="ident" id="3925400">ip</span><span class="op" id="3925402">[</span><span class="num" id="3925403">2</span><span class="op" id="3925404">]</span><span class="op" id="3925405">,</span>&nbsp;<span class="ident" id="3925407">ip</span><span class="op" id="3925409">[</span><span class="num" id="3925410">3</span><span class="op" id="3925411">]</span><span class="op" id="3925412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3925415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925418">if</span>&nbsp;<span class="builtinfunc" id="3925421">len</span><span class="op" id="3925424">(</span><span class="ident" id="3925425">ip</span><span class="op" id="3925427">)</span>&nbsp;<span class="op" id="3925429">==</span>&nbsp;<span class="ident" id="3925432">IPv6len</span>&nbsp;<span class="op" id="3925440">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925444">return</span>&nbsp;<span class="ident" id="3925451">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3925455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925458">return</span>&nbsp;<span class="builtintype" id="3925465">nil</span><br>
<span class="lineno"></span><span class="op" id="3925469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3925472">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="3925505">var</span>&nbsp;<span class="op" id="3925509">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3925512">classAMask</span>&nbsp;<span class="op" id="3925523">=</span>&nbsp;<span class="ident" id="3925525">IPv4Mask</span><span class="op" id="3925533">(</span><span class="num" id="3925534">0xff</span><span class="op" id="3925538">,</span>&nbsp;<span class="num" id="3925540">0</span><span class="op" id="3925541">,</span>&nbsp;<span class="num" id="3925543">0</span><span class="op" id="3925544">,</span>&nbsp;<span class="num" id="3925546">0</span><span class="op" id="3925547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3925550">classBMask</span>&nbsp;<span class="op" id="3925561">=</span>&nbsp;<span class="ident" id="3925563">IPv4Mask</span><span class="op" id="3925571">(</span><span class="num" id="3925572">0xff</span><span class="op" id="3925576">,</span>&nbsp;<span class="num" id="3925578">0xff</span><span class="op" id="3925582">,</span>&nbsp;<span class="num" id="3925584">0</span><span class="op" id="3925585">,</span>&nbsp;<span class="num" id="3925587">0</span><span class="op" id="3925588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3925591">classCMask</span>&nbsp;<span class="op" id="3925602">=</span>&nbsp;<span class="ident" id="3925604">IPv4Mask</span><span class="op" id="3925612">(</span><span class="num" id="3925613">0xff</span><span class="op" id="3925617">,</span>&nbsp;<span class="num" id="3925619">0xff</span><span class="op" id="3925623">,</span>&nbsp;<span class="num" id="3925625">0xff</span><span class="op" id="3925629">,</span>&nbsp;<span class="num" id="3925631">0</span><span class="op" id="3925632">)</span><br>
<span class="lineno">210</span><span class="op" id="3925634">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3925637">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3925703">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3925766">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="3925808">func</span>&nbsp;<span class="op" id="3925813">(</span><span class="ident" id="3925814">ip</span>&nbsp;<span class="ident" id="3925817">IP</span><span class="op" id="3925819">)</span>&nbsp;<span class="ident" id="3925821">DefaultMask</span><span class="op" id="3925832">(</span><span class="op" id="3925833">)</span>&nbsp;<span class="ident" id="3925835">IPMask</span>&nbsp;<span class="op" id="3925842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925845">if</span>&nbsp;<span class="ident" id="3925848">ip</span>&nbsp;<span class="op" id="3925851">=</span>&nbsp;<span class="ident" id="3925853">ip</span><span class="op" id="3925855">.</span><span class="ident" id="3925856">To4</span><span class="op" id="3925859">(</span><span class="op" id="3925860">)</span><span class="op" id="3925861">;</span>&nbsp;<span class="ident" id="3925863">ip</span>&nbsp;<span class="op" id="3925866">==</span>&nbsp;<span class="builtintype" id="3925869">nil</span>&nbsp;<span class="op" id="3925873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925877">return</span>&nbsp;<span class="builtintype" id="3925884">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3925889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925892">switch</span>&nbsp;<span class="builtintype" id="3925899">true</span>&nbsp;<span class="op" id="3925904">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925907">case</span>&nbsp;<span class="ident" id="3925912">ip</span><span class="op" id="3925914">[</span><span class="num" id="3925915">0</span><span class="op" id="3925916">]</span>&nbsp;<span class="op" id="3925918">&lt;</span>&nbsp;<span class="num" id="3925920">0x80</span><span class="op" id="3925924">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925928">return</span>&nbsp;<span class="ident" id="3925935">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925947">case</span>&nbsp;<span class="ident" id="3925952">ip</span><span class="op" id="3925954">[</span><span class="num" id="3925955">0</span><span class="op" id="3925956">]</span>&nbsp;<span class="op" id="3925958">&lt;</span>&nbsp;<span class="num" id="3925960">0xC0</span><span class="op" id="3925964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925968">return</span>&nbsp;<span class="ident" id="3925975">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925987">default</span><span class="op" id="3925994">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3925998">return</span>&nbsp;<span class="ident" id="3926005">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3926017">}</span><br>
<span class="lineno"></span><span class="op" id="3926019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3926022">func</span>&nbsp;<span class="ident" id="3926027">allFF</span><span class="op" id="3926032">(</span><span class="ident" id="3926033">b</span>&nbsp;<span class="op" id="3926035">[</span><span class="op" id="3926036">]</span><span class="builtintype" id="3926037">byte</span><span class="op" id="3926041">)</span>&nbsp;<span class="builtintype" id="3926043">bool</span>&nbsp;<span class="op" id="3926048">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926051">for</span>&nbsp;<span class="ident" id="3926055">_</span><span class="op" id="3926056">,</span>&nbsp;<span class="ident" id="3926058">c</span>&nbsp;<span class="op" id="3926060">:=</span>&nbsp;<span class="keyword" id="3926063">range</span>&nbsp;<span class="ident" id="3926069">b</span>&nbsp;<span class="op" id="3926071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926075">if</span>&nbsp;<span class="ident" id="3926078">c</span>&nbsp;<span class="op" id="3926080">!=</span>&nbsp;<span class="num" id="3926083">0xff</span>&nbsp;<span class="op" id="3926088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926093">return</span>&nbsp;<span class="builtintype" id="3926100">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3926108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3926111">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926114">return</span>&nbsp;<span class="builtintype" id="3926121">true</span><br>
<span class="lineno"></span><span class="op" id="3926126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3926129">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="3926196">func</span>&nbsp;<span class="op" id="3926201">(</span><span class="ident" id="3926202">ip</span>&nbsp;<span class="ident" id="3926205">IP</span><span class="op" id="3926207">)</span>&nbsp;<span class="ident" id="3926209">Mask</span><span class="op" id="3926213">(</span><span class="ident" id="3926214">mask</span>&nbsp;<span class="ident" id="3926219">IPMask</span><span class="op" id="3926225">)</span>&nbsp;<span class="ident" id="3926227">IP</span>&nbsp;<span class="op" id="3926230">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926233">if</span>&nbsp;<span class="builtinfunc" id="3926236">len</span><span class="op" id="3926239">(</span><span class="ident" id="3926240">mask</span><span class="op" id="3926244">)</span>&nbsp;<span class="op" id="3926246">==</span>&nbsp;<span class="ident" id="3926249">IPv6len</span>&nbsp;<span class="op" id="3926257">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3926260">len</span><span class="op" id="3926263">(</span><span class="ident" id="3926264">ip</span><span class="op" id="3926266">)</span>&nbsp;<span class="op" id="3926268">==</span>&nbsp;<span class="ident" id="3926271">IPv4len</span>&nbsp;<span class="op" id="3926279">&amp;&amp;</span>&nbsp;<span class="ident" id="3926282">allFF</span><span class="op" id="3926287">(</span><span class="ident" id="3926288">mask</span><span class="op" id="3926292">[</span><span class="op" id="3926293">:</span><span class="num" id="3926294">12</span><span class="op" id="3926296">]</span><span class="op" id="3926297">)</span>&nbsp;<span class="op" id="3926299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3926303">mask</span>&nbsp;<span class="op" id="3926308">=</span>&nbsp;<span class="ident" id="3926310">mask</span><span class="op" id="3926314">[</span><span class="num" id="3926315">12</span><span class="op" id="3926317">:</span><span class="op" id="3926318">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3926321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926324">if</span>&nbsp;<span class="builtinfunc" id="3926327">len</span><span class="op" id="3926330">(</span><span class="ident" id="3926331">mask</span><span class="op" id="3926335">)</span>&nbsp;<span class="op" id="3926337">==</span>&nbsp;<span class="ident" id="3926340">IPv4len</span>&nbsp;<span class="op" id="3926348">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3926351">len</span><span class="op" id="3926354">(</span><span class="ident" id="3926355">ip</span><span class="op" id="3926357">)</span>&nbsp;<span class="op" id="3926359">==</span>&nbsp;<span class="ident" id="3926362">IPv6len</span>&nbsp;<span class="op" id="3926370">&amp;&amp;</span>&nbsp;<span class="ident" id="3926373">bytesEqual</span><span class="op" id="3926383">(</span><span class="ident" id="3926384">ip</span><span class="op" id="3926386">[</span><span class="op" id="3926387">:</span><span class="num" id="3926388">12</span><span class="op" id="3926390">]</span><span class="op" id="3926391">,</span>&nbsp;<span class="ident" id="3926393">v4InV6Prefix</span><span class="op" id="3926405">)</span>&nbsp;<span class="op" id="3926407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3926411">ip</span>&nbsp;<span class="op" id="3926414">=</span>&nbsp;<span class="ident" id="3926416">ip</span><span class="op" id="3926418">[</span><span class="num" id="3926419">12</span><span class="op" id="3926421">:</span><span class="op" id="3926422">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3926425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3926428">n</span>&nbsp;<span class="op" id="3926430">:=</span>&nbsp;<span class="builtinfunc" id="3926433">len</span><span class="op" id="3926436">(</span><span class="ident" id="3926437">ip</span><span class="op" id="3926439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926442">if</span>&nbsp;<span class="ident" id="3926445">n</span>&nbsp;<span class="op" id="3926447">!=</span>&nbsp;<span class="builtinfunc" id="3926450">len</span><span class="op" id="3926453">(</span><span class="ident" id="3926454">mask</span><span class="op" id="3926458">)</span>&nbsp;<span class="op" id="3926460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926464">return</span>&nbsp;<span class="builtintype" id="3926471">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3926476">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3926479">out</span>&nbsp;<span class="op" id="3926483">:=</span>&nbsp;<span class="builtinfunc" id="3926486">make</span><span class="op" id="3926490">(</span><span class="ident" id="3926491">IP</span><span class="op" id="3926493">,</span>&nbsp;<span class="ident" id="3926495">n</span><span class="op" id="3926496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926499">for</span>&nbsp;<span class="ident" id="3926503">i</span>&nbsp;<span class="op" id="3926505">:=</span>&nbsp;<span class="num" id="3926508">0</span><span class="op" id="3926509">;</span>&nbsp;<span class="ident" id="3926511">i</span>&nbsp;<span class="op" id="3926513">&lt;</span>&nbsp;<span class="ident" id="3926515">n</span><span class="op" id="3926516">;</span>&nbsp;<span class="ident" id="3926518">i</span><span class="op" id="3926519">++</span>&nbsp;<span class="op" id="3926522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3926526">out</span><span class="op" id="3926529">[</span><span class="ident" id="3926530">i</span><span class="op" id="3926531">]</span>&nbsp;<span class="op" id="3926533">=</span>&nbsp;<span class="ident" id="3926535">ip</span><span class="op" id="3926537">[</span><span class="ident" id="3926538">i</span><span class="op" id="3926539">]</span>&nbsp;<span class="op" id="3926541">&amp;</span>&nbsp;<span class="ident" id="3926543">mask</span><span class="op" id="3926547">[</span><span class="ident" id="3926548">i</span><span class="op" id="3926549">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3926552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926555">return</span>&nbsp;<span class="ident" id="3926562">out</span><br>
<span class="lineno">255</span><span class="op" id="3926566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3926569">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3926625">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="3926689">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="3926758">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="3926795">func</span>&nbsp;<span class="op" id="3926800">(</span><span class="ident" id="3926801">ip</span>&nbsp;<span class="ident" id="3926804">IP</span><span class="op" id="3926806">)</span>&nbsp;<span class="ident" id="3926808">String</span><span class="op" id="3926814">(</span><span class="op" id="3926815">)</span>&nbsp;<span class="builtintype" id="3926817">string</span>&nbsp;<span class="op" id="3926824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3926827">p</span>&nbsp;<span class="op" id="3926829">:=</span>&nbsp;<span class="ident" id="3926832">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926837">if</span>&nbsp;<span class="builtinfunc" id="3926840">len</span><span class="op" id="3926843">(</span><span class="ident" id="3926844">ip</span><span class="op" id="3926846">)</span>&nbsp;<span class="op" id="3926848">==</span>&nbsp;<span class="num" id="3926851">0</span>&nbsp;<span class="op" id="3926853">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926857">return</span>&nbsp;<span class="string" id="3926864">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3926873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3926877">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926911">if</span>&nbsp;<span class="ident" id="3926914">p4</span>&nbsp;<span class="op" id="3926917">:=</span>&nbsp;<span class="ident" id="3926920">p</span><span class="op" id="3926921">.</span><span class="ident" id="3926922">To4</span><span class="op" id="3926925">(</span><span class="op" id="3926926">)</span><span class="op" id="3926927">;</span>&nbsp;<span class="builtinfunc" id="3926929">len</span><span class="op" id="3926932">(</span><span class="ident" id="3926933">p4</span><span class="op" id="3926935">)</span>&nbsp;<span class="op" id="3926937">==</span>&nbsp;<span class="ident" id="3926940">IPv4len</span>&nbsp;<span class="op" id="3926948">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3926952">return</span>&nbsp;<span class="ident" id="3926959">itod</span><span class="op" id="3926963">(</span><span class="builtintype" id="3926964">uint</span><span class="op" id="3926968">(</span><span class="ident" id="3926969">p4</span><span class="op" id="3926971">[</span><span class="num" id="3926972">0</span><span class="op" id="3926973">]</span><span class="op" id="3926974">)</span><span class="op" id="3926975">)</span>&nbsp;<span class="op" id="3926977">+</span>&nbsp;<span class="string" id="3926979">&#34;.&#34;</span>&nbsp;<span class="op" id="3926983">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3926988">itod</span><span class="op" id="3926992">(</span><span class="builtintype" id="3926993">uint</span><span class="op" id="3926997">(</span><span class="ident" id="3926998">p4</span><span class="op" id="3927000">[</span><span class="num" id="3927001">1</span><span class="op" id="3927002">]</span><span class="op" id="3927003">)</span><span class="op" id="3927004">)</span>&nbsp;<span class="op" id="3927006">+</span>&nbsp;<span class="string" id="3927008">&#34;.&#34;</span>&nbsp;<span class="op" id="3927012">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927017">itod</span><span class="op" id="3927021">(</span><span class="builtintype" id="3927022">uint</span><span class="op" id="3927026">(</span><span class="ident" id="3927027">p4</span><span class="op" id="3927029">[</span><span class="num" id="3927030">2</span><span class="op" id="3927031">]</span><span class="op" id="3927032">)</span><span class="op" id="3927033">)</span>&nbsp;<span class="op" id="3927035">+</span>&nbsp;<span class="string" id="3927037">&#34;.&#34;</span>&nbsp;<span class="op" id="3927041">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927046">itod</span><span class="op" id="3927050">(</span><span class="builtintype" id="3927051">uint</span><span class="op" id="3927055">(</span><span class="ident" id="3927056">p4</span><span class="op" id="3927058">[</span><span class="num" id="3927059">3</span><span class="op" id="3927060">]</span><span class="op" id="3927061">)</span><span class="op" id="3927062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927065">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927068">if</span>&nbsp;<span class="builtinfunc" id="3927071">len</span><span class="op" id="3927074">(</span><span class="ident" id="3927075">p</span><span class="op" id="3927076">)</span>&nbsp;<span class="op" id="3927078">!=</span>&nbsp;<span class="ident" id="3927081">IPv6len</span>&nbsp;<span class="op" id="3927089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927093">return</span>&nbsp;<span class="string" id="3927100">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3927109">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927140">e0</span>&nbsp;<span class="op" id="3927143">:=</span>&nbsp;<span class="op" id="3927146">-</span><span class="num" id="3927147">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927150">e1</span>&nbsp;<span class="op" id="3927153">:=</span>&nbsp;<span class="op" id="3927156">-</span><span class="num" id="3927157">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927160">for</span>&nbsp;<span class="ident" id="3927164">i</span>&nbsp;<span class="op" id="3927166">:=</span>&nbsp;<span class="num" id="3927169">0</span><span class="op" id="3927170">;</span>&nbsp;<span class="ident" id="3927172">i</span>&nbsp;<span class="op" id="3927174">&lt;</span>&nbsp;<span class="ident" id="3927176">IPv6len</span><span class="op" id="3927183">;</span>&nbsp;<span class="ident" id="3927185">i</span>&nbsp;<span class="op" id="3927187">+=</span>&nbsp;<span class="num" id="3927190">2</span>&nbsp;<span class="op" id="3927192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927196">j</span>&nbsp;<span class="op" id="3927198">:=</span>&nbsp;<span class="ident" id="3927201">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927205">for</span>&nbsp;<span class="ident" id="3927209">j</span>&nbsp;<span class="op" id="3927211">&lt;</span>&nbsp;<span class="ident" id="3927213">IPv6len</span>&nbsp;<span class="op" id="3927221">&amp;&amp;</span>&nbsp;<span class="ident" id="3927224">p</span><span class="op" id="3927225">[</span><span class="ident" id="3927226">j</span><span class="op" id="3927227">]</span>&nbsp;<span class="op" id="3927229">==</span>&nbsp;<span class="num" id="3927232">0</span>&nbsp;<span class="op" id="3927234">&amp;&amp;</span>&nbsp;<span class="ident" id="3927237">p</span><span class="op" id="3927238">[</span><span class="ident" id="3927239">j</span><span class="op" id="3927240">+</span><span class="num" id="3927241">1</span><span class="op" id="3927242">]</span>&nbsp;<span class="op" id="3927244">==</span>&nbsp;<span class="num" id="3927247">0</span>&nbsp;<span class="op" id="3927249">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927254">j</span>&nbsp;<span class="op" id="3927256">+=</span>&nbsp;<span class="num" id="3927259">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927267">if</span>&nbsp;<span class="ident" id="3927270">j</span>&nbsp;<span class="op" id="3927272">&gt;</span>&nbsp;<span class="ident" id="3927274">i</span>&nbsp;<span class="op" id="3927276">&amp;&amp;</span>&nbsp;<span class="ident" id="3927279">j</span><span class="op" id="3927280">-</span><span class="ident" id="3927281">i</span>&nbsp;<span class="op" id="3927283">&gt;</span>&nbsp;<span class="ident" id="3927285">e1</span><span class="op" id="3927287">-</span><span class="ident" id="3927288">e0</span>&nbsp;<span class="op" id="3927291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927296">e0</span>&nbsp;<span class="op" id="3927299">=</span>&nbsp;<span class="ident" id="3927301">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927306">e1</span>&nbsp;<span class="op" id="3927309">=</span>&nbsp;<span class="ident" id="3927311">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927316">i</span>&nbsp;<span class="op" id="3927318">=</span>&nbsp;<span class="ident" id="3927320">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3927330">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927403">if</span>&nbsp;<span class="ident" id="3927406">e1</span><span class="op" id="3927408">-</span><span class="ident" id="3927409">e0</span>&nbsp;<span class="op" id="3927412">&lt;=</span>&nbsp;<span class="num" id="3927415">2</span>&nbsp;<span class="op" id="3927417">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927421">e0</span>&nbsp;<span class="op" id="3927424">=</span>&nbsp;<span class="op" id="3927426">-</span><span class="num" id="3927427">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927431">e1</span>&nbsp;<span class="op" id="3927434">=</span>&nbsp;<span class="op" id="3927436">-</span><span class="num" id="3927437">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927444">const</span>&nbsp;<span class="ident" id="3927450">maxLen</span>&nbsp;<span class="op" id="3927457">=</span>&nbsp;<span class="builtinfunc" id="3927459">len</span><span class="op" id="3927462">(</span><span class="string" id="3927463">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="3927504">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927507">b</span>&nbsp;<span class="op" id="3927509">:=</span>&nbsp;<span class="builtinfunc" id="3927512">make</span><span class="op" id="3927516">(</span><span class="op" id="3927517">[</span><span class="op" id="3927518">]</span><span class="builtintype" id="3927519">byte</span><span class="op" id="3927523">,</span>&nbsp;<span class="num" id="3927525">0</span><span class="op" id="3927526">,</span>&nbsp;<span class="ident" id="3927528">maxLen</span><span class="op" id="3927534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3927538">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927590">for</span>&nbsp;<span class="ident" id="3927594">i</span>&nbsp;<span class="op" id="3927596">:=</span>&nbsp;<span class="num" id="3927599">0</span><span class="op" id="3927600">;</span>&nbsp;<span class="ident" id="3927602">i</span>&nbsp;<span class="op" id="3927604">&lt;</span>&nbsp;<span class="ident" id="3927606">IPv6len</span><span class="op" id="3927613">;</span>&nbsp;<span class="ident" id="3927615">i</span>&nbsp;<span class="op" id="3927617">+=</span>&nbsp;<span class="num" id="3927620">2</span>&nbsp;<span class="op" id="3927622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927626">if</span>&nbsp;<span class="ident" id="3927629">i</span>&nbsp;<span class="op" id="3927631">==</span>&nbsp;<span class="ident" id="3927634">e0</span>&nbsp;<span class="op" id="3927637">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927642">b</span>&nbsp;<span class="op" id="3927644">=</span>&nbsp;<span class="builtinfunc" id="3927646">append</span><span class="op" id="3927652">(</span><span class="ident" id="3927653">b</span><span class="op" id="3927654">,</span>&nbsp;<span class="string" id="3927656">&#39;:&#39;</span><span class="op" id="3927659">,</span>&nbsp;<span class="string" id="3927661">&#39;:&#39;</span><span class="op" id="3927664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927669">i</span>&nbsp;<span class="op" id="3927671">=</span>&nbsp;<span class="ident" id="3927673">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927679">if</span>&nbsp;<span class="ident" id="3927682">i</span>&nbsp;<span class="op" id="3927684">&gt;=</span>&nbsp;<span class="ident" id="3927687">IPv6len</span>&nbsp;<span class="op" id="3927695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927701">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927710">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927714">}</span>&nbsp;<span class="keyword" id="3927716">else</span>&nbsp;<span class="keyword" id="3927721">if</span>&nbsp;<span class="ident" id="3927724">i</span>&nbsp;<span class="op" id="3927726">&gt;</span>&nbsp;<span class="num" id="3927728">0</span>&nbsp;<span class="op" id="3927730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927735">b</span>&nbsp;<span class="op" id="3927737">=</span>&nbsp;<span class="builtinfunc" id="3927739">append</span><span class="op" id="3927745">(</span><span class="ident" id="3927746">b</span><span class="op" id="3927747">,</span>&nbsp;<span class="string" id="3927749">&#39;:&#39;</span><span class="op" id="3927752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927760">b</span>&nbsp;<span class="op" id="3927762">=</span>&nbsp;<span class="ident" id="3927764">appendHex</span><span class="op" id="3927773">(</span><span class="ident" id="3927774">b</span><span class="op" id="3927775">,</span>&nbsp;<span class="op" id="3927777">(</span><span class="builtintype" id="3927778">uint32</span><span class="op" id="3927784">(</span><span class="ident" id="3927785">p</span><span class="op" id="3927786">[</span><span class="ident" id="3927787">i</span><span class="op" id="3927788">]</span><span class="op" id="3927789">)</span><span class="op" id="3927790">&lt;&lt;</span><span class="num" id="3927792">8</span><span class="op" id="3927793">)</span><span class="op" id="3927794">|</span><span class="builtintype" id="3927795">uint32</span><span class="op" id="3927801">(</span><span class="ident" id="3927802">p</span><span class="op" id="3927803">[</span><span class="ident" id="3927804">i</span><span class="op" id="3927805">+</span><span class="num" id="3927806">1</span><span class="op" id="3927807">]</span><span class="op" id="3927808">)</span><span class="op" id="3927809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927812">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927815">return</span>&nbsp;<span class="builtintype" id="3927822">string</span><span class="op" id="3927828">(</span><span class="ident" id="3927829">b</span><span class="op" id="3927830">)</span><br>
<span class="lineno"></span><span class="op" id="3927832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3927835">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3927893">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="3927930">func</span>&nbsp;<span class="ident" id="3927935">ipEmptyString</span><span class="op" id="3927948">(</span><span class="ident" id="3927949">ip</span>&nbsp;<span class="ident" id="3927952">IP</span><span class="op" id="3927954">)</span>&nbsp;<span class="builtintype" id="3927956">string</span>&nbsp;<span class="op" id="3927963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927966">if</span>&nbsp;<span class="builtinfunc" id="3927969">len</span><span class="op" id="3927972">(</span><span class="ident" id="3927973">ip</span><span class="op" id="3927975">)</span>&nbsp;<span class="op" id="3927977">==</span>&nbsp;<span class="num" id="3927980">0</span>&nbsp;<span class="op" id="3927982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3927986">return</span>&nbsp;<span class="string" id="3927993">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928000">return</span>&nbsp;<span class="ident" id="3928007">ip</span><span class="op" id="3928009">.</span><span class="ident" id="3928010">String</span><span class="op" id="3928016">(</span><span class="op" id="3928017">)</span><br>
<span class="lineno">325</span><span class="op" id="3928019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3928022">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3928086">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="3928137">func</span>&nbsp;<span class="op" id="3928142">(</span><span class="ident" id="3928143">ip</span>&nbsp;<span class="ident" id="3928146">IP</span><span class="op" id="3928148">)</span>&nbsp;<span class="ident" id="3928150">MarshalText</span><span class="op" id="3928161">(</span><span class="op" id="3928162">)</span>&nbsp;<span class="op" id="3928164">(</span><span class="op" id="3928165">[</span><span class="op" id="3928166">]</span><span class="builtintype" id="3928167">byte</span><span class="op" id="3928171">,</span>&nbsp;<span class="builtintype" id="3928173">error</span><span class="op" id="3928178">)</span>&nbsp;<span class="op" id="3928180">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928183">if</span>&nbsp;<span class="builtinfunc" id="3928186">len</span><span class="op" id="3928189">(</span><span class="ident" id="3928190">ip</span><span class="op" id="3928192">)</span>&nbsp;<span class="op" id="3928194">==</span>&nbsp;<span class="num" id="3928197">0</span>&nbsp;<span class="op" id="3928199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928203">return</span>&nbsp;<span class="op" id="3928210">[</span><span class="op" id="3928211">]</span><span class="builtintype" id="3928212">byte</span><span class="op" id="3928216">(</span><span class="string" id="3928217">&#34;&#34;</span><span class="op" id="3928219">)</span><span class="op" id="3928220">,</span>&nbsp;<span class="builtintype" id="3928222">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928230">if</span>&nbsp;<span class="builtinfunc" id="3928233">len</span><span class="op" id="3928236">(</span><span class="ident" id="3928237">ip</span><span class="op" id="3928239">)</span>&nbsp;<span class="op" id="3928241">!=</span>&nbsp;<span class="ident" id="3928244">IPv4len</span>&nbsp;<span class="op" id="3928252">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3928255">len</span><span class="op" id="3928258">(</span><span class="ident" id="3928259">ip</span><span class="op" id="3928261">)</span>&nbsp;<span class="op" id="3928263">!=</span>&nbsp;<span class="ident" id="3928266">IPv6len</span>&nbsp;<span class="op" id="3928274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928278">return</span>&nbsp;<span class="builtintype" id="3928285">nil</span><span class="op" id="3928288">,</span>&nbsp;<span class="ident" id="3928290">errors</span><span class="op" id="3928296">.</span><span class="ident" id="3928297">New</span><span class="op" id="3928300">(</span><span class="string" id="3928301">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="3928321">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928327">return</span>&nbsp;<span class="op" id="3928334">[</span><span class="op" id="3928335">]</span><span class="builtintype" id="3928336">byte</span><span class="op" id="3928340">(</span><span class="ident" id="3928341">ip</span><span class="op" id="3928343">.</span><span class="ident" id="3928344">String</span><span class="op" id="3928350">(</span><span class="op" id="3928351">)</span><span class="op" id="3928352">)</span><span class="op" id="3928353">,</span>&nbsp;<span class="builtintype" id="3928355">nil</span><br>
<span class="lineno"></span><span class="op" id="3928359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3928362">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="3928430">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="3928491">func</span>&nbsp;<span class="op" id="3928496">(</span><span class="ident" id="3928497">ip</span>&nbsp;<span class="op" id="3928500">*</span><span class="ident" id="3928501">IP</span><span class="op" id="3928503">)</span>&nbsp;<span class="ident" id="3928505">UnmarshalText</span><span class="op" id="3928518">(</span><span class="ident" id="3928519">text</span>&nbsp;<span class="op" id="3928524">[</span><span class="op" id="3928525">]</span><span class="builtintype" id="3928526">byte</span><span class="op" id="3928530">)</span>&nbsp;<span class="builtintype" id="3928532">error</span>&nbsp;<span class="op" id="3928538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928541">if</span>&nbsp;<span class="builtinfunc" id="3928544">len</span><span class="op" id="3928547">(</span><span class="ident" id="3928548">text</span><span class="op" id="3928552">)</span>&nbsp;<span class="op" id="3928554">==</span>&nbsp;<span class="num" id="3928557">0</span>&nbsp;<span class="op" id="3928559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928563">*</span><span class="ident" id="3928564">ip</span>&nbsp;<span class="op" id="3928567">=</span>&nbsp;<span class="builtintype" id="3928569">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928575">return</span>&nbsp;<span class="builtintype" id="3928582">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928590">s</span>&nbsp;<span class="op" id="3928592">:=</span>&nbsp;<span class="builtintype" id="3928595">string</span><span class="op" id="3928601">(</span><span class="ident" id="3928602">text</span><span class="op" id="3928606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928609">x</span>&nbsp;<span class="op" id="3928611">:=</span>&nbsp;<span class="ident" id="3928614">ParseIP</span><span class="op" id="3928621">(</span><span class="ident" id="3928622">s</span><span class="op" id="3928623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928626">if</span>&nbsp;<span class="ident" id="3928629">x</span>&nbsp;<span class="op" id="3928631">==</span>&nbsp;<span class="builtintype" id="3928634">nil</span>&nbsp;<span class="op" id="3928638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928642">return</span>&nbsp;<span class="op" id="3928649">&amp;</span><span class="ident" id="3928650">ParseError</span><span class="op" id="3928660">{</span><span class="string" id="3928661">&#34;IP&nbsp;address&#34;</span><span class="op" id="3928673">,</span>&nbsp;<span class="ident" id="3928675">s</span><span class="op" id="3928676">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928682">*</span><span class="ident" id="3928683">ip</span>&nbsp;<span class="op" id="3928686">=</span>&nbsp;<span class="ident" id="3928688">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928691">return</span>&nbsp;<span class="builtintype" id="3928698">nil</span><br>
<span class="lineno"></span><span class="op" id="3928702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3928705">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="3928764">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3928822">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="3928849">func</span>&nbsp;<span class="op" id="3928854">(</span><span class="ident" id="3928855">ip</span>&nbsp;<span class="ident" id="3928858">IP</span><span class="op" id="3928860">)</span>&nbsp;<span class="ident" id="3928862">Equal</span><span class="op" id="3928867">(</span><span class="ident" id="3928868">x</span>&nbsp;<span class="ident" id="3928870">IP</span><span class="op" id="3928872">)</span>&nbsp;<span class="builtintype" id="3928874">bool</span>&nbsp;<span class="op" id="3928879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928882">if</span>&nbsp;<span class="builtinfunc" id="3928885">len</span><span class="op" id="3928888">(</span><span class="ident" id="3928889">ip</span><span class="op" id="3928891">)</span>&nbsp;<span class="op" id="3928893">==</span>&nbsp;<span class="builtinfunc" id="3928896">len</span><span class="op" id="3928899">(</span><span class="ident" id="3928900">x</span><span class="op" id="3928901">)</span>&nbsp;<span class="op" id="3928903">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928907">return</span>&nbsp;<span class="ident" id="3928914">bytesEqual</span><span class="op" id="3928924">(</span><span class="ident" id="3928925">ip</span><span class="op" id="3928927">,</span>&nbsp;<span class="ident" id="3928929">x</span><span class="op" id="3928930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928936">if</span>&nbsp;<span class="builtinfunc" id="3928939">len</span><span class="op" id="3928942">(</span><span class="ident" id="3928943">ip</span><span class="op" id="3928945">)</span>&nbsp;<span class="op" id="3928947">==</span>&nbsp;<span class="ident" id="3928950">IPv4len</span>&nbsp;<span class="op" id="3928958">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3928961">len</span><span class="op" id="3928964">(</span><span class="ident" id="3928965">x</span><span class="op" id="3928966">)</span>&nbsp;<span class="op" id="3928968">==</span>&nbsp;<span class="ident" id="3928971">IPv6len</span>&nbsp;<span class="op" id="3928979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928983">return</span>&nbsp;<span class="ident" id="3928990">bytesEqual</span><span class="op" id="3929000">(</span><span class="ident" id="3929001">x</span><span class="op" id="3929002">[</span><span class="num" id="3929003">0</span><span class="op" id="3929004">:</span><span class="num" id="3929005">12</span><span class="op" id="3929007">]</span><span class="op" id="3929008">,</span>&nbsp;<span class="ident" id="3929010">v4InV6Prefix</span><span class="op" id="3929022">)</span>&nbsp;<span class="op" id="3929024">&amp;&amp;</span>&nbsp;<span class="ident" id="3929027">bytesEqual</span><span class="op" id="3929037">(</span><span class="ident" id="3929038">ip</span><span class="op" id="3929040">,</span>&nbsp;<span class="ident" id="3929042">x</span><span class="op" id="3929043">[</span><span class="num" id="3929044">12</span><span class="op" id="3929046">:</span><span class="op" id="3929047">]</span><span class="op" id="3929048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929051">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929054">if</span>&nbsp;<span class="builtinfunc" id="3929057">len</span><span class="op" id="3929060">(</span><span class="ident" id="3929061">ip</span><span class="op" id="3929063">)</span>&nbsp;<span class="op" id="3929065">==</span>&nbsp;<span class="ident" id="3929068">IPv6len</span>&nbsp;<span class="op" id="3929076">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3929079">len</span><span class="op" id="3929082">(</span><span class="ident" id="3929083">x</span><span class="op" id="3929084">)</span>&nbsp;<span class="op" id="3929086">==</span>&nbsp;<span class="ident" id="3929089">IPv4len</span>&nbsp;<span class="op" id="3929097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929101">return</span>&nbsp;<span class="ident" id="3929108">bytesEqual</span><span class="op" id="3929118">(</span><span class="ident" id="3929119">ip</span><span class="op" id="3929121">[</span><span class="num" id="3929122">0</span><span class="op" id="3929123">:</span><span class="num" id="3929124">12</span><span class="op" id="3929126">]</span><span class="op" id="3929127">,</span>&nbsp;<span class="ident" id="3929129">v4InV6Prefix</span><span class="op" id="3929141">)</span>&nbsp;<span class="op" id="3929143">&amp;&amp;</span>&nbsp;<span class="ident" id="3929146">bytesEqual</span><span class="op" id="3929156">(</span><span class="ident" id="3929157">ip</span><span class="op" id="3929159">[</span><span class="num" id="3929160">12</span><span class="op" id="3929162">:</span><span class="op" id="3929163">]</span><span class="op" id="3929164">,</span>&nbsp;<span class="ident" id="3929166">x</span><span class="op" id="3929167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929173">return</span>&nbsp;<span class="builtintype" id="3929180">false</span><br>
<span class="lineno"></span><span class="op" id="3929186">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="3929189">func</span>&nbsp;<span class="ident" id="3929194">bytesEqual</span><span class="op" id="3929204">(</span><span class="ident" id="3929205">x</span><span class="op" id="3929206">,</span>&nbsp;<span class="ident" id="3929208">y</span>&nbsp;<span class="op" id="3929210">[</span><span class="op" id="3929211">]</span><span class="builtintype" id="3929212">byte</span><span class="op" id="3929216">)</span>&nbsp;<span class="builtintype" id="3929218">bool</span>&nbsp;<span class="op" id="3929223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929226">if</span>&nbsp;<span class="builtinfunc" id="3929229">len</span><span class="op" id="3929232">(</span><span class="ident" id="3929233">x</span><span class="op" id="3929234">)</span>&nbsp;<span class="op" id="3929236">!=</span>&nbsp;<span class="builtinfunc" id="3929239">len</span><span class="op" id="3929242">(</span><span class="ident" id="3929243">y</span><span class="op" id="3929244">)</span>&nbsp;<span class="op" id="3929246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929250">return</span>&nbsp;<span class="builtintype" id="3929257">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929264">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929267">for</span>&nbsp;<span class="ident" id="3929271">i</span><span class="op" id="3929272">,</span>&nbsp;<span class="ident" id="3929274">b</span>&nbsp;<span class="op" id="3929276">:=</span>&nbsp;<span class="keyword" id="3929279">range</span>&nbsp;<span class="ident" id="3929285">x</span>&nbsp;<span class="op" id="3929287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929291">if</span>&nbsp;<span class="ident" id="3929294">y</span><span class="op" id="3929295">[</span><span class="ident" id="3929296">i</span><span class="op" id="3929297">]</span>&nbsp;<span class="op" id="3929299">!=</span>&nbsp;<span class="ident" id="3929302">b</span>&nbsp;<span class="op" id="3929304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929309">return</span>&nbsp;<span class="builtintype" id="3929316">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929327">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929330">return</span>&nbsp;<span class="builtintype" id="3929337">true</span><br>
<span class="lineno"></span><span class="op" id="3929342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3929345">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3929400">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="3929432">func</span>&nbsp;<span class="ident" id="3929437">simpleMaskLength</span><span class="op" id="3929453">(</span><span class="ident" id="3929454">mask</span>&nbsp;<span class="ident" id="3929459">IPMask</span><span class="op" id="3929465">)</span>&nbsp;<span class="builtintype" id="3929467">int</span>&nbsp;<span class="op" id="3929471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929474">var</span>&nbsp;<span class="ident" id="3929478">n</span>&nbsp;<span class="builtintype" id="3929480">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929485">for</span>&nbsp;<span class="ident" id="3929489">i</span><span class="op" id="3929490">,</span>&nbsp;<span class="ident" id="3929492">v</span>&nbsp;<span class="op" id="3929494">:=</span>&nbsp;<span class="keyword" id="3929497">range</span>&nbsp;<span class="ident" id="3929503">mask</span>&nbsp;<span class="op" id="3929508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929512">if</span>&nbsp;<span class="ident" id="3929515">v</span>&nbsp;<span class="op" id="3929517">==</span>&nbsp;<span class="num" id="3929520">0xff</span>&nbsp;<span class="op" id="3929525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929530">n</span>&nbsp;<span class="op" id="3929532">+=</span>&nbsp;<span class="num" id="3929535">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929540">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3929555">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3929578">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929596">for</span>&nbsp;<span class="ident" id="3929600">v</span><span class="op" id="3929601">&amp;</span><span class="num" id="3929602">0x80</span>&nbsp;<span class="op" id="3929607">!=</span>&nbsp;<span class="num" id="3929610">0</span>&nbsp;<span class="op" id="3929612">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929617">n</span><span class="op" id="3929618">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929624">v</span>&nbsp;<span class="op" id="3929626">&lt;&lt;=</span>&nbsp;<span class="num" id="3929630">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3929638">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929663">if</span>&nbsp;<span class="ident" id="3929666">v</span>&nbsp;<span class="op" id="3929668">!=</span>&nbsp;<span class="num" id="3929671">0</span>&nbsp;<span class="op" id="3929673">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929678">return</span>&nbsp;<span class="op" id="3929685">-</span><span class="num" id="3929686">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929694">for</span>&nbsp;<span class="ident" id="3929698">i</span><span class="op" id="3929699">++</span><span class="op" id="3929701">;</span>&nbsp;<span class="ident" id="3929703">i</span>&nbsp;<span class="op" id="3929705">&lt;</span>&nbsp;<span class="builtinfunc" id="3929707">len</span><span class="op" id="3929710">(</span><span class="ident" id="3929711">mask</span><span class="op" id="3929715">)</span><span class="op" id="3929716">;</span>&nbsp;<span class="ident" id="3929718">i</span><span class="op" id="3929719">++</span>&nbsp;<span class="op" id="3929722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929727">if</span>&nbsp;<span class="ident" id="3929730">mask</span><span class="op" id="3929734">[</span><span class="ident" id="3929735">i</span><span class="op" id="3929736">]</span>&nbsp;<span class="op" id="3929738">!=</span>&nbsp;<span class="num" id="3929741">0</span>&nbsp;<span class="op" id="3929743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929749">return</span>&nbsp;<span class="op" id="3929756">-</span><span class="num" id="3929757">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929770">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929780">return</span>&nbsp;<span class="ident" id="3929787">n</span><br>
<span class="lineno">410</span><span class="op" id="3929789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3929792">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="3929863">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="3929937">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="3929959">func</span>&nbsp;<span class="op" id="3929964">(</span><span class="ident" id="3929965">m</span>&nbsp;<span class="ident" id="3929967">IPMask</span><span class="op" id="3929973">)</span>&nbsp;<span class="ident" id="3929975">Size</span><span class="op" id="3929979">(</span><span class="op" id="3929980">)</span>&nbsp;<span class="op" id="3929982">(</span><span class="ident" id="3929983">ones</span><span class="op" id="3929987">,</span>&nbsp;<span class="ident" id="3929989">bits</span>&nbsp;<span class="builtintype" id="3929994">int</span><span class="op" id="3929997">)</span>&nbsp;<span class="op" id="3929999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930002">ones</span><span class="op" id="3930006">,</span>&nbsp;<span class="ident" id="3930008">bits</span>&nbsp;<span class="op" id="3930013">=</span>&nbsp;<span class="ident" id="3930015">simpleMaskLength</span><span class="op" id="3930031">(</span><span class="ident" id="3930032">m</span><span class="op" id="3930033">)</span><span class="op" id="3930034">,</span>&nbsp;<span class="builtinfunc" id="3930036">len</span><span class="op" id="3930039">(</span><span class="ident" id="3930040">m</span><span class="op" id="3930041">)</span><span class="op" id="3930042">*</span><span class="num" id="3930043">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930046">if</span>&nbsp;<span class="ident" id="3930049">ones</span>&nbsp;<span class="op" id="3930054">==</span>&nbsp;<span class="op" id="3930057">-</span><span class="num" id="3930058">1</span>&nbsp;<span class="op" id="3930060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930064">return</span>&nbsp;<span class="num" id="3930071">0</span><span class="op" id="3930072">,</span>&nbsp;<span class="num" id="3930074">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930077">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930080">return</span><br>
<span class="lineno"></span><span class="op" id="3930087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3930090">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="3930156">func</span>&nbsp;<span class="op" id="3930161">(</span><span class="ident" id="3930162">m</span>&nbsp;<span class="ident" id="3930164">IPMask</span><span class="op" id="3930170">)</span>&nbsp;<span class="ident" id="3930172">String</span><span class="op" id="3930178">(</span><span class="op" id="3930179">)</span>&nbsp;<span class="builtintype" id="3930181">string</span>&nbsp;<span class="op" id="3930188">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930191">if</span>&nbsp;<span class="builtinfunc" id="3930194">len</span><span class="op" id="3930197">(</span><span class="ident" id="3930198">m</span><span class="op" id="3930199">)</span>&nbsp;<span class="op" id="3930201">==</span>&nbsp;<span class="num" id="3930204">0</span>&nbsp;<span class="op" id="3930206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930210">return</span>&nbsp;<span class="string" id="3930217">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930229">buf</span>&nbsp;<span class="op" id="3930233">:=</span>&nbsp;<span class="builtinfunc" id="3930236">make</span><span class="op" id="3930240">(</span><span class="op" id="3930241">[</span><span class="op" id="3930242">]</span><span class="builtintype" id="3930243">byte</span><span class="op" id="3930247">,</span>&nbsp;<span class="builtinfunc" id="3930249">len</span><span class="op" id="3930252">(</span><span class="ident" id="3930253">m</span><span class="op" id="3930254">)</span><span class="op" id="3930255">*</span><span class="num" id="3930256">2</span><span class="op" id="3930257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930260">for</span>&nbsp;<span class="ident" id="3930264">i</span><span class="op" id="3930265">,</span>&nbsp;<span class="ident" id="3930267">b</span>&nbsp;<span class="op" id="3930269">:=</span>&nbsp;<span class="keyword" id="3930272">range</span>&nbsp;<span class="ident" id="3930278">m</span>&nbsp;<span class="op" id="3930280">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930284">buf</span><span class="op" id="3930287">[</span><span class="ident" id="3930288">i</span><span class="op" id="3930289">*</span><span class="num" id="3930290">2</span><span class="op" id="3930291">]</span><span class="op" id="3930292">,</span>&nbsp;<span class="ident" id="3930294">buf</span><span class="op" id="3930297">[</span><span class="ident" id="3930298">i</span><span class="op" id="3930299">*</span><span class="num" id="3930300">2</span><span class="op" id="3930301">+</span><span class="num" id="3930302">1</span><span class="op" id="3930303">]</span>&nbsp;<span class="op" id="3930305">=</span>&nbsp;<span class="ident" id="3930307">hexDigit</span><span class="op" id="3930315">[</span><span class="ident" id="3930316">b</span><span class="op" id="3930317">&gt;&gt;</span><span class="num" id="3930319">4</span><span class="op" id="3930320">]</span><span class="op" id="3930321">,</span>&nbsp;<span class="ident" id="3930323">hexDigit</span><span class="op" id="3930331">[</span><span class="ident" id="3930332">b</span><span class="op" id="3930333">&amp;</span><span class="num" id="3930334">0xf</span><span class="op" id="3930337">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930343">return</span>&nbsp;<span class="builtintype" id="3930350">string</span><span class="op" id="3930356">(</span><span class="ident" id="3930357">buf</span><span class="op" id="3930360">)</span><br>
<span class="lineno"></span><span class="op" id="3930362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="3930365">func</span>&nbsp;<span class="ident" id="3930370">networkNumberAndMask</span><span class="op" id="3930390">(</span><span class="ident" id="3930391">n</span>&nbsp;<span class="op" id="3930393">*</span><span class="ident" id="3930394">IPNet</span><span class="op" id="3930399">)</span>&nbsp;<span class="op" id="3930401">(</span><span class="ident" id="3930402">ip</span>&nbsp;<span class="ident" id="3930405">IP</span><span class="op" id="3930407">,</span>&nbsp;<span class="ident" id="3930409">m</span>&nbsp;<span class="ident" id="3930411">IPMask</span><span class="op" id="3930417">)</span>&nbsp;<span class="op" id="3930419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930422">if</span>&nbsp;<span class="ident" id="3930425">ip</span>&nbsp;<span class="op" id="3930428">=</span>&nbsp;<span class="ident" id="3930430">n</span><span class="op" id="3930431">.</span><span class="ident" id="3930432">IP</span><span class="op" id="3930434">.</span><span class="ident" id="3930435">To4</span><span class="op" id="3930438">(</span><span class="op" id="3930439">)</span><span class="op" id="3930440">;</span>&nbsp;<span class="ident" id="3930442">ip</span>&nbsp;<span class="op" id="3930445">==</span>&nbsp;<span class="builtintype" id="3930448">nil</span>&nbsp;<span class="op" id="3930452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930456">ip</span>&nbsp;<span class="op" id="3930459">=</span>&nbsp;<span class="ident" id="3930461">n</span><span class="op" id="3930462">.</span><span class="ident" id="3930463">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930468">if</span>&nbsp;<span class="builtinfunc" id="3930471">len</span><span class="op" id="3930474">(</span><span class="ident" id="3930475">ip</span><span class="op" id="3930477">)</span>&nbsp;<span class="op" id="3930479">!=</span>&nbsp;<span class="ident" id="3930482">IPv6len</span>&nbsp;<span class="op" id="3930490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930495">return</span>&nbsp;<span class="builtintype" id="3930502">nil</span><span class="op" id="3930505">,</span>&nbsp;<span class="builtintype" id="3930507">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930519">m</span>&nbsp;<span class="op" id="3930521">=</span>&nbsp;<span class="ident" id="3930523">n</span><span class="op" id="3930524">.</span><span class="ident" id="3930525">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930531">switch</span>&nbsp;<span class="builtinfunc" id="3930538">len</span><span class="op" id="3930541">(</span><span class="ident" id="3930542">m</span><span class="op" id="3930543">)</span>&nbsp;<span class="op" id="3930545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930548">case</span>&nbsp;<span class="ident" id="3930553">IPv4len</span><span class="op" id="3930560">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930564">if</span>&nbsp;<span class="builtinfunc" id="3930567">len</span><span class="op" id="3930570">(</span><span class="ident" id="3930571">ip</span><span class="op" id="3930573">)</span>&nbsp;<span class="op" id="3930575">!=</span>&nbsp;<span class="ident" id="3930578">IPv4len</span>&nbsp;<span class="op" id="3930586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930591">return</span>&nbsp;<span class="builtintype" id="3930598">nil</span><span class="op" id="3930601">,</span>&nbsp;<span class="builtintype" id="3930603">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930612">case</span>&nbsp;<span class="ident" id="3930617">IPv6len</span><span class="op" id="3930624">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930628">if</span>&nbsp;<span class="builtinfunc" id="3930631">len</span><span class="op" id="3930634">(</span><span class="ident" id="3930635">ip</span><span class="op" id="3930637">)</span>&nbsp;<span class="op" id="3930639">==</span>&nbsp;<span class="ident" id="3930642">IPv4len</span>&nbsp;<span class="op" id="3930650">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930655">m</span>&nbsp;<span class="op" id="3930657">=</span>&nbsp;<span class="ident" id="3930659">m</span><span class="op" id="3930660">[</span><span class="num" id="3930661">12</span><span class="op" id="3930663">:</span><span class="op" id="3930664">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930671">default</span><span class="op" id="3930678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930682">return</span>&nbsp;<span class="builtintype" id="3930689">nil</span><span class="op" id="3930692">,</span>&nbsp;<span class="builtintype" id="3930694">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930699">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930702">return</span><br>
<span class="lineno"></span><span class="op" id="3930709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3930712">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="3930765">func</span>&nbsp;<span class="op" id="3930770">(</span><span class="ident" id="3930771">n</span>&nbsp;<span class="op" id="3930773">*</span><span class="ident" id="3930774">IPNet</span><span class="op" id="3930779">)</span>&nbsp;<span class="ident" id="3930781">Contains</span><span class="op" id="3930789">(</span><span class="ident" id="3930790">ip</span>&nbsp;<span class="ident" id="3930793">IP</span><span class="op" id="3930795">)</span>&nbsp;<span class="builtintype" id="3930797">bool</span>&nbsp;<span class="op" id="3930802">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930805">nn</span><span class="op" id="3930807">,</span>&nbsp;<span class="ident" id="3930809">m</span>&nbsp;<span class="op" id="3930811">:=</span>&nbsp;<span class="ident" id="3930814">networkNumberAndMask</span><span class="op" id="3930834">(</span><span class="ident" id="3930835">n</span><span class="op" id="3930836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930839">if</span>&nbsp;<span class="ident" id="3930842">x</span>&nbsp;<span class="op" id="3930844">:=</span>&nbsp;<span class="ident" id="3930847">ip</span><span class="op" id="3930849">.</span><span class="ident" id="3930850">To4</span><span class="op" id="3930853">(</span><span class="op" id="3930854">)</span><span class="op" id="3930855">;</span>&nbsp;<span class="ident" id="3930857">x</span>&nbsp;<span class="op" id="3930859">!=</span>&nbsp;<span class="builtintype" id="3930862">nil</span>&nbsp;<span class="op" id="3930866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930870">ip</span>&nbsp;<span class="op" id="3930873">=</span>&nbsp;<span class="ident" id="3930875">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930881">l</span>&nbsp;<span class="op" id="3930883">:=</span>&nbsp;<span class="builtinfunc" id="3930886">len</span><span class="op" id="3930889">(</span><span class="ident" id="3930890">ip</span><span class="op" id="3930892">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930895">if</span>&nbsp;<span class="ident" id="3930898">l</span>&nbsp;<span class="op" id="3930900">!=</span>&nbsp;<span class="builtinfunc" id="3930903">len</span><span class="op" id="3930906">(</span><span class="ident" id="3930907">nn</span><span class="op" id="3930909">)</span>&nbsp;<span class="op" id="3930911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930915">return</span>&nbsp;<span class="builtintype" id="3930922">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930932">for</span>&nbsp;<span class="ident" id="3930936">i</span>&nbsp;<span class="op" id="3930938">:=</span>&nbsp;<span class="num" id="3930941">0</span><span class="op" id="3930942">;</span>&nbsp;<span class="ident" id="3930944">i</span>&nbsp;<span class="op" id="3930946">&lt;</span>&nbsp;<span class="ident" id="3930948">l</span><span class="op" id="3930949">;</span>&nbsp;<span class="ident" id="3930951">i</span><span class="op" id="3930952">++</span>&nbsp;<span class="op" id="3930955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930959">if</span>&nbsp;<span class="ident" id="3930962">nn</span><span class="op" id="3930964">[</span><span class="ident" id="3930965">i</span><span class="op" id="3930966">]</span><span class="op" id="3930967">&amp;</span><span class="ident" id="3930968">m</span><span class="op" id="3930969">[</span><span class="ident" id="3930970">i</span><span class="op" id="3930971">]</span>&nbsp;<span class="op" id="3930973">!=</span>&nbsp;<span class="ident" id="3930976">ip</span><span class="op" id="3930978">[</span><span class="ident" id="3930979">i</span><span class="op" id="3930980">]</span><span class="op" id="3930981">&amp;</span><span class="ident" id="3930982">m</span><span class="op" id="3930983">[</span><span class="ident" id="3930984">i</span><span class="op" id="3930985">]</span>&nbsp;<span class="op" id="3930987">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930992">return</span>&nbsp;<span class="builtintype" id="3930999">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931013">return</span>&nbsp;<span class="builtintype" id="3931020">true</span><br>
<span class="lineno"></span><span class="op" id="3931025">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="3931028">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3931085">func</span>&nbsp;<span class="op" id="3931090">(</span><span class="ident" id="3931091">n</span>&nbsp;<span class="op" id="3931093">*</span><span class="ident" id="3931094">IPNet</span><span class="op" id="3931099">)</span>&nbsp;<span class="ident" id="3931101">Network</span><span class="op" id="3931108">(</span><span class="op" id="3931109">)</span>&nbsp;<span class="builtintype" id="3931111">string</span>&nbsp;<span class="op" id="3931118">{</span>&nbsp;<span class="keyword" id="3931120">return</span>&nbsp;<span class="string" id="3931127">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="3931136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3931139">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="3931204">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3931263">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3931323">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="3931386">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3931448">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="3931494">func</span>&nbsp;<span class="op" id="3931499">(</span><span class="ident" id="3931500">n</span>&nbsp;<span class="op" id="3931502">*</span><span class="ident" id="3931503">IPNet</span><span class="op" id="3931508">)</span>&nbsp;<span class="ident" id="3931510">String</span><span class="op" id="3931516">(</span><span class="op" id="3931517">)</span>&nbsp;<span class="builtintype" id="3931519">string</span>&nbsp;<span class="op" id="3931526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931529">nn</span><span class="op" id="3931531">,</span>&nbsp;<span class="ident" id="3931533">m</span>&nbsp;<span class="op" id="3931535">:=</span>&nbsp;<span class="ident" id="3931538">networkNumberAndMask</span><span class="op" id="3931558">(</span><span class="ident" id="3931559">n</span><span class="op" id="3931560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931563">if</span>&nbsp;<span class="ident" id="3931566">nn</span>&nbsp;<span class="op" id="3931569">==</span>&nbsp;<span class="builtintype" id="3931572">nil</span>&nbsp;<span class="op" id="3931576">||</span>&nbsp;<span class="ident" id="3931579">m</span>&nbsp;<span class="op" id="3931581">==</span>&nbsp;<span class="builtintype" id="3931584">nil</span>&nbsp;<span class="op" id="3931588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931592">return</span>&nbsp;<span class="string" id="3931599">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931608">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931611">l</span>&nbsp;<span class="op" id="3931613">:=</span>&nbsp;<span class="ident" id="3931616">simpleMaskLength</span><span class="op" id="3931632">(</span><span class="ident" id="3931633">m</span><span class="op" id="3931634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931637">if</span>&nbsp;<span class="ident" id="3931640">l</span>&nbsp;<span class="op" id="3931642">==</span>&nbsp;<span class="op" id="3931645">-</span><span class="num" id="3931646">1</span>&nbsp;<span class="op" id="3931648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931652">return</span>&nbsp;<span class="ident" id="3931659">nn</span><span class="op" id="3931661">.</span><span class="ident" id="3931662">String</span><span class="op" id="3931668">(</span><span class="op" id="3931669">)</span>&nbsp;<span class="op" id="3931671">+</span>&nbsp;<span class="string" id="3931673">&#34;/&#34;</span>&nbsp;<span class="op" id="3931677">+</span>&nbsp;<span class="ident" id="3931679">m</span><span class="op" id="3931680">.</span><span class="ident" id="3931681">String</span><span class="op" id="3931687">(</span><span class="op" id="3931688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931694">return</span>&nbsp;<span class="ident" id="3931701">nn</span><span class="op" id="3931703">.</span><span class="ident" id="3931704">String</span><span class="op" id="3931710">(</span><span class="op" id="3931711">)</span>&nbsp;<span class="op" id="3931713">+</span>&nbsp;<span class="string" id="3931715">&#34;/&#34;</span>&nbsp;<span class="op" id="3931719">+</span>&nbsp;<span class="ident" id="3931721">itod</span><span class="op" id="3931725">(</span><span class="builtintype" id="3931726">uint</span><span class="op" id="3931730">(</span><span class="ident" id="3931731">l</span><span class="op" id="3931732">)</span><span class="op" id="3931733">)</span><br>
<span class="lineno">495</span><span class="op" id="3931735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3931738">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="3931771">func</span>&nbsp;<span class="ident" id="3931776">parseIPv4</span><span class="op" id="3931785">(</span><span class="ident" id="3931786">s</span>&nbsp;<span class="builtintype" id="3931788">string</span><span class="op" id="3931794">)</span>&nbsp;<span class="ident" id="3931796">IP</span>&nbsp;<span class="op" id="3931799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931802">var</span>&nbsp;<span class="ident" id="3931806">p</span>&nbsp;<span class="op" id="3931808">[</span><span class="ident" id="3931809">IPv4len</span><span class="op" id="3931816">]</span><span class="builtintype" id="3931817">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931823">i</span>&nbsp;<span class="op" id="3931825">:=</span>&nbsp;<span class="num" id="3931828">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931831">for</span>&nbsp;<span class="ident" id="3931835">j</span>&nbsp;<span class="op" id="3931837">:=</span>&nbsp;<span class="num" id="3931840">0</span><span class="op" id="3931841">;</span>&nbsp;<span class="ident" id="3931843">j</span>&nbsp;<span class="op" id="3931845">&lt;</span>&nbsp;<span class="ident" id="3931847">IPv4len</span><span class="op" id="3931854">;</span>&nbsp;<span class="ident" id="3931856">j</span><span class="op" id="3931857">++</span>&nbsp;<span class="op" id="3931860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931864">if</span>&nbsp;<span class="ident" id="3931867">i</span>&nbsp;<span class="op" id="3931869">&gt;=</span>&nbsp;<span class="builtinfunc" id="3931872">len</span><span class="op" id="3931875">(</span><span class="ident" id="3931876">s</span><span class="op" id="3931877">)</span>&nbsp;<span class="op" id="3931879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3931884">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931906">return</span>&nbsp;<span class="builtintype" id="3931913">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931923">if</span>&nbsp;<span class="ident" id="3931926">j</span>&nbsp;<span class="op" id="3931928">&gt;</span>&nbsp;<span class="num" id="3931930">0</span>&nbsp;<span class="op" id="3931932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931937">if</span>&nbsp;<span class="ident" id="3931940">s</span><span class="op" id="3931941">[</span><span class="ident" id="3931942">i</span><span class="op" id="3931943">]</span>&nbsp;<span class="op" id="3931945">!=</span>&nbsp;<span class="string" id="3931948">&#39;.&#39;</span>&nbsp;<span class="op" id="3931952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931958">return</span>&nbsp;<span class="builtintype" id="3931965">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931972">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931977">i</span><span class="op" id="3931978">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931987">var</span>&nbsp;<span class="op" id="3931991">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931996">n</span>&nbsp;&nbsp;<span class="builtintype" id="3931999">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932006">ok</span>&nbsp;<span class="builtintype" id="3932009">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932020">n</span><span class="op" id="3932021">,</span>&nbsp;<span class="ident" id="3932023">i</span><span class="op" id="3932024">,</span>&nbsp;<span class="ident" id="3932026">ok</span>&nbsp;<span class="op" id="3932029">=</span>&nbsp;<span class="ident" id="3932031">dtoi</span><span class="op" id="3932035">(</span><span class="ident" id="3932036">s</span><span class="op" id="3932037">,</span>&nbsp;<span class="ident" id="3932039">i</span><span class="op" id="3932040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932044">if</span>&nbsp;<span class="op" id="3932047">!</span><span class="ident" id="3932048">ok</span>&nbsp;<span class="op" id="3932051">||</span>&nbsp;<span class="ident" id="3932054">n</span>&nbsp;<span class="op" id="3932056">&gt;</span>&nbsp;<span class="num" id="3932058">0xFF</span>&nbsp;<span class="op" id="3932063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932068">return</span>&nbsp;<span class="builtintype" id="3932075">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932081">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932085">p</span><span class="op" id="3932086">[</span><span class="ident" id="3932087">j</span><span class="op" id="3932088">]</span>&nbsp;<span class="op" id="3932090">=</span>&nbsp;<span class="builtintype" id="3932092">byte</span><span class="op" id="3932096">(</span><span class="ident" id="3932097">n</span><span class="op" id="3932098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932104">if</span>&nbsp;<span class="ident" id="3932107">i</span>&nbsp;<span class="op" id="3932109">!=</span>&nbsp;<span class="builtinfunc" id="3932112">len</span><span class="op" id="3932115">(</span><span class="ident" id="3932116">s</span><span class="op" id="3932117">)</span>&nbsp;<span class="op" id="3932119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932123">return</span>&nbsp;<span class="builtintype" id="3932130">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932135">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932138">return</span>&nbsp;<span class="ident" id="3932145">IPv4</span><span class="op" id="3932149">(</span><span class="ident" id="3932150">p</span><span class="op" id="3932151">[</span><span class="num" id="3932152">0</span><span class="op" id="3932153">]</span><span class="op" id="3932154">,</span>&nbsp;<span class="ident" id="3932156">p</span><span class="op" id="3932157">[</span><span class="num" id="3932158">1</span><span class="op" id="3932159">]</span><span class="op" id="3932160">,</span>&nbsp;<span class="ident" id="3932162">p</span><span class="op" id="3932163">[</span><span class="num" id="3932164">2</span><span class="op" id="3932165">]</span><span class="op" id="3932166">,</span>&nbsp;<span class="ident" id="3932168">p</span><span class="op" id="3932169">[</span><span class="num" id="3932170">3</span><span class="op" id="3932171">]</span><span class="op" id="3932172">)</span><br>
<span class="lineno"></span><span class="op" id="3932174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3932177">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="3932247">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="3932318">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3932388">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3932397">func</span>&nbsp;<span class="ident" id="3932402">parseIPv6</span><span class="op" id="3932411">(</span><span class="ident" id="3932412">s</span>&nbsp;<span class="builtintype" id="3932414">string</span><span class="op" id="3932420">,</span>&nbsp;<span class="ident" id="3932422">zoneAllowed</span>&nbsp;<span class="builtintype" id="3932434">bool</span><span class="op" id="3932438">)</span>&nbsp;<span class="op" id="3932440">(</span><span class="ident" id="3932441">ip</span>&nbsp;<span class="ident" id="3932444">IP</span><span class="op" id="3932446">,</span>&nbsp;<span class="ident" id="3932448">zone</span>&nbsp;<span class="builtintype" id="3932453">string</span><span class="op" id="3932459">)</span>&nbsp;<span class="op" id="3932461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932464">ip</span>&nbsp;<span class="op" id="3932467">=</span>&nbsp;<span class="builtinfunc" id="3932469">make</span><span class="op" id="3932473">(</span><span class="ident" id="3932474">IP</span><span class="op" id="3932476">,</span>&nbsp;<span class="ident" id="3932478">IPv6len</span><span class="op" id="3932485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932488">ellipsis</span>&nbsp;<span class="op" id="3932497">:=</span>&nbsp;<span class="op" id="3932500">-</span><span class="num" id="3932501">1</span>&nbsp;<span class="comment" id="3932503">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932533">i</span>&nbsp;<span class="op" id="3932535">:=</span>&nbsp;<span class="num" id="3932538">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932548">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932571">if</span>&nbsp;<span class="ident" id="3932574">zoneAllowed</span>&nbsp;<span class="op" id="3932586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932590">s</span><span class="op" id="3932591">,</span>&nbsp;<span class="ident" id="3932593">zone</span>&nbsp;<span class="op" id="3932598">=</span>&nbsp;<span class="ident" id="3932600">splitHostZone</span><span class="op" id="3932613">(</span><span class="ident" id="3932614">s</span><span class="op" id="3932615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932618">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932622">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932654">if</span>&nbsp;<span class="builtinfunc" id="3932657">len</span><span class="op" id="3932660">(</span><span class="ident" id="3932661">s</span><span class="op" id="3932662">)</span>&nbsp;<span class="op" id="3932664">&gt;=</span>&nbsp;<span class="num" id="3932667">2</span>&nbsp;<span class="op" id="3932669">&amp;&amp;</span>&nbsp;<span class="ident" id="3932672">s</span><span class="op" id="3932673">[</span><span class="num" id="3932674">0</span><span class="op" id="3932675">]</span>&nbsp;<span class="op" id="3932677">==</span>&nbsp;<span class="string" id="3932680">&#39;:&#39;</span>&nbsp;<span class="op" id="3932684">&amp;&amp;</span>&nbsp;<span class="ident" id="3932687">s</span><span class="op" id="3932688">[</span><span class="num" id="3932689">1</span><span class="op" id="3932690">]</span>&nbsp;<span class="op" id="3932692">==</span>&nbsp;<span class="string" id="3932695">&#39;:&#39;</span>&nbsp;<span class="op" id="3932699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932703">ellipsis</span>&nbsp;<span class="op" id="3932712">=</span>&nbsp;<span class="num" id="3932714">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932718">i</span>&nbsp;<span class="op" id="3932720">=</span>&nbsp;<span class="num" id="3932722">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932726">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932754">if</span>&nbsp;<span class="ident" id="3932757">i</span>&nbsp;<span class="op" id="3932759">==</span>&nbsp;<span class="builtinfunc" id="3932762">len</span><span class="op" id="3932765">(</span><span class="ident" id="3932766">s</span><span class="op" id="3932767">)</span>&nbsp;<span class="op" id="3932769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932774">return</span>&nbsp;<span class="ident" id="3932781">ip</span><span class="op" id="3932783">,</span>&nbsp;<span class="ident" id="3932785">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932795">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932799">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932848">j</span>&nbsp;<span class="op" id="3932850">:=</span>&nbsp;<span class="num" id="3932853">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932856">for</span>&nbsp;<span class="ident" id="3932860">j</span>&nbsp;<span class="op" id="3932862">&lt;</span>&nbsp;<span class="ident" id="3932864">IPv6len</span>&nbsp;<span class="op" id="3932872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932876">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932893">n</span><span class="op" id="3932894">,</span>&nbsp;<span class="ident" id="3932896">i1</span><span class="op" id="3932898">,</span>&nbsp;<span class="ident" id="3932900">ok</span>&nbsp;<span class="op" id="3932903">:=</span>&nbsp;<span class="ident" id="3932906">xtoi</span><span class="op" id="3932910">(</span><span class="ident" id="3932911">s</span><span class="op" id="3932912">,</span>&nbsp;<span class="ident" id="3932914">i</span><span class="op" id="3932915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932919">if</span>&nbsp;<span class="op" id="3932922">!</span><span class="ident" id="3932923">ok</span>&nbsp;<span class="op" id="3932926">||</span>&nbsp;<span class="ident" id="3932929">n</span>&nbsp;<span class="op" id="3932931">&gt;</span>&nbsp;<span class="num" id="3932933">0xFFFF</span>&nbsp;<span class="op" id="3932940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932945">return</span>&nbsp;<span class="builtintype" id="3932952">nil</span><span class="op" id="3932955">,</span>&nbsp;<span class="ident" id="3932957">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932969">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933021">if</span>&nbsp;<span class="ident" id="3933024">i1</span>&nbsp;<span class="op" id="3933027">&lt;</span>&nbsp;<span class="builtinfunc" id="3933029">len</span><span class="op" id="3933032">(</span><span class="ident" id="3933033">s</span><span class="op" id="3933034">)</span>&nbsp;<span class="op" id="3933036">&amp;&amp;</span>&nbsp;<span class="ident" id="3933039">s</span><span class="op" id="3933040">[</span><span class="ident" id="3933041">i1</span><span class="op" id="3933043">]</span>&nbsp;<span class="op" id="3933045">==</span>&nbsp;<span class="string" id="3933048">&#39;.&#39;</span>&nbsp;<span class="op" id="3933052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933057">if</span>&nbsp;<span class="ident" id="3933060">ellipsis</span>&nbsp;<span class="op" id="3933069">&lt;</span>&nbsp;<span class="num" id="3933071">0</span>&nbsp;<span class="op" id="3933073">&amp;&amp;</span>&nbsp;<span class="ident" id="3933076">j</span>&nbsp;<span class="op" id="3933078">!=</span>&nbsp;<span class="ident" id="3933081">IPv6len</span><span class="op" id="3933088">-</span><span class="ident" id="3933089">IPv4len</span>&nbsp;<span class="op" id="3933097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933103">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933131">return</span>&nbsp;<span class="builtintype" id="3933138">nil</span><span class="op" id="3933141">,</span>&nbsp;<span class="ident" id="3933143">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933156">if</span>&nbsp;<span class="ident" id="3933159">j</span><span class="op" id="3933160">+</span><span class="ident" id="3933161">IPv4len</span>&nbsp;<span class="op" id="3933169">&gt;</span>&nbsp;<span class="ident" id="3933171">IPv6len</span>&nbsp;<span class="op" id="3933179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933185">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933209">return</span>&nbsp;<span class="builtintype" id="3933216">nil</span><span class="op" id="3933219">,</span>&nbsp;<span class="ident" id="3933221">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933229">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933234">ip4</span>&nbsp;<span class="op" id="3933238">:=</span>&nbsp;<span class="ident" id="3933241">parseIPv4</span><span class="op" id="3933250">(</span><span class="ident" id="3933251">s</span><span class="op" id="3933252">[</span><span class="ident" id="3933253">i</span><span class="op" id="3933254">:</span><span class="op" id="3933255">]</span><span class="op" id="3933256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933261">if</span>&nbsp;<span class="ident" id="3933264">ip4</span>&nbsp;<span class="op" id="3933268">==</span>&nbsp;<span class="builtintype" id="3933271">nil</span>&nbsp;<span class="op" id="3933275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933281">return</span>&nbsp;<span class="builtintype" id="3933288">nil</span><span class="op" id="3933291">,</span>&nbsp;<span class="ident" id="3933293">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933306">ip</span><span class="op" id="3933308">[</span><span class="ident" id="3933309">j</span><span class="op" id="3933310">]</span>&nbsp;<span class="op" id="3933312">=</span>&nbsp;<span class="ident" id="3933314">ip4</span><span class="op" id="3933317">[</span><span class="num" id="3933318">12</span><span class="op" id="3933320">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933325">ip</span><span class="op" id="3933327">[</span><span class="ident" id="3933328">j</span><span class="op" id="3933329">+</span><span class="num" id="3933330">1</span><span class="op" id="3933331">]</span>&nbsp;<span class="op" id="3933333">=</span>&nbsp;<span class="ident" id="3933335">ip4</span><span class="op" id="3933338">[</span><span class="num" id="3933339">13</span><span class="op" id="3933341">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933346">ip</span><span class="op" id="3933348">[</span><span class="ident" id="3933349">j</span><span class="op" id="3933350">+</span><span class="num" id="3933351">2</span><span class="op" id="3933352">]</span>&nbsp;<span class="op" id="3933354">=</span>&nbsp;<span class="ident" id="3933356">ip4</span><span class="op" id="3933359">[</span><span class="num" id="3933360">14</span><span class="op" id="3933362">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933367">ip</span><span class="op" id="3933369">[</span><span class="ident" id="3933370">j</span><span class="op" id="3933371">+</span><span class="num" id="3933372">3</span><span class="op" id="3933373">]</span>&nbsp;<span class="op" id="3933375">=</span>&nbsp;<span class="ident" id="3933377">ip4</span><span class="op" id="3933380">[</span><span class="num" id="3933381">15</span><span class="op" id="3933383">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933388">i</span>&nbsp;<span class="op" id="3933390">=</span>&nbsp;<span class="builtinfunc" id="3933392">len</span><span class="op" id="3933395">(</span><span class="ident" id="3933396">s</span><span class="op" id="3933397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933402">j</span>&nbsp;<span class="op" id="3933404">+=</span>&nbsp;<span class="ident" id="3933407">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933418">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933431">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933460">ip</span><span class="op" id="3933462">[</span><span class="ident" id="3933463">j</span><span class="op" id="3933464">]</span>&nbsp;<span class="op" id="3933466">=</span>&nbsp;<span class="builtintype" id="3933468">byte</span><span class="op" id="3933472">(</span><span class="ident" id="3933473">n</span>&nbsp;<span class="op" id="3933475">&gt;&gt;</span>&nbsp;<span class="num" id="3933478">8</span><span class="op" id="3933479">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933483">ip</span><span class="op" id="3933485">[</span><span class="ident" id="3933486">j</span><span class="op" id="3933487">+</span><span class="num" id="3933488">1</span><span class="op" id="3933489">]</span>&nbsp;<span class="op" id="3933491">=</span>&nbsp;<span class="builtintype" id="3933493">byte</span><span class="op" id="3933497">(</span><span class="ident" id="3933498">n</span><span class="op" id="3933499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933503">j</span>&nbsp;<span class="op" id="3933505">+=</span>&nbsp;<span class="num" id="3933508">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933513">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933541">i</span>&nbsp;<span class="op" id="3933543">=</span>&nbsp;<span class="ident" id="3933545">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933550">if</span>&nbsp;<span class="ident" id="3933553">i</span>&nbsp;<span class="op" id="3933555">==</span>&nbsp;<span class="builtinfunc" id="3933558">len</span><span class="op" id="3933561">(</span><span class="ident" id="3933562">s</span><span class="op" id="3933563">)</span>&nbsp;<span class="op" id="3933565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933570">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933583">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933634">if</span>&nbsp;<span class="ident" id="3933637">s</span><span class="op" id="3933638">[</span><span class="ident" id="3933639">i</span><span class="op" id="3933640">]</span>&nbsp;<span class="op" id="3933642">!=</span>&nbsp;<span class="string" id="3933645">&#39;:&#39;</span>&nbsp;<span class="op" id="3933649">||</span>&nbsp;<span class="ident" id="3933652">i</span><span class="op" id="3933653">+</span><span class="num" id="3933654">1</span>&nbsp;<span class="op" id="3933656">==</span>&nbsp;<span class="builtinfunc" id="3933659">len</span><span class="op" id="3933662">(</span><span class="ident" id="3933663">s</span><span class="op" id="3933664">)</span>&nbsp;<span class="op" id="3933666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933671">return</span>&nbsp;<span class="builtintype" id="3933678">nil</span><span class="op" id="3933681">,</span>&nbsp;<span class="ident" id="3933683">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933694">i</span><span class="op" id="3933695">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933701">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933725">if</span>&nbsp;<span class="ident" id="3933728">s</span><span class="op" id="3933729">[</span><span class="ident" id="3933730">i</span><span class="op" id="3933731">]</span>&nbsp;<span class="op" id="3933733">==</span>&nbsp;<span class="string" id="3933736">&#39;:&#39;</span>&nbsp;<span class="op" id="3933740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933745">if</span>&nbsp;<span class="ident" id="3933748">ellipsis</span>&nbsp;<span class="op" id="3933757">&gt;=</span>&nbsp;<span class="num" id="3933760">0</span>&nbsp;<span class="op" id="3933762">{</span>&nbsp;<span class="comment" id="3933764">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933788">return</span>&nbsp;<span class="builtintype" id="3933795">nil</span><span class="op" id="3933798">,</span>&nbsp;<span class="ident" id="3933800">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933808">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933813">ellipsis</span>&nbsp;<span class="op" id="3933822">=</span>&nbsp;<span class="ident" id="3933824">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933829">if</span>&nbsp;<span class="ident" id="3933832">i</span><span class="op" id="3933833">++</span><span class="op" id="3933835">;</span>&nbsp;<span class="ident" id="3933837">i</span>&nbsp;<span class="op" id="3933839">==</span>&nbsp;<span class="builtinfunc" id="3933842">len</span><span class="op" id="3933845">(</span><span class="ident" id="3933846">s</span><span class="op" id="3933847">)</span>&nbsp;<span class="op" id="3933849">{</span>&nbsp;<span class="comment" id="3933851">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933872">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933885">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933892">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933926">if</span>&nbsp;<span class="ident" id="3933929">i</span>&nbsp;<span class="op" id="3933931">!=</span>&nbsp;<span class="builtinfunc" id="3933934">len</span><span class="op" id="3933937">(</span><span class="ident" id="3933938">s</span><span class="op" id="3933939">)</span>&nbsp;<span class="op" id="3933941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933945">return</span>&nbsp;<span class="builtintype" id="3933952">nil</span><span class="op" id="3933955">,</span>&nbsp;<span class="ident" id="3933957">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933967">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934012">if</span>&nbsp;<span class="ident" id="3934015">j</span>&nbsp;<span class="op" id="3934017">&lt;</span>&nbsp;<span class="ident" id="3934019">IPv6len</span>&nbsp;<span class="op" id="3934027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934031">if</span>&nbsp;<span class="ident" id="3934034">ellipsis</span>&nbsp;<span class="op" id="3934043">&lt;</span>&nbsp;<span class="num" id="3934045">0</span>&nbsp;<span class="op" id="3934047">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934052">return</span>&nbsp;<span class="builtintype" id="3934059">nil</span><span class="op" id="3934062">,</span>&nbsp;<span class="ident" id="3934064">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934075">n</span>&nbsp;<span class="op" id="3934077">:=</span>&nbsp;<span class="ident" id="3934080">IPv6len</span>&nbsp;<span class="op" id="3934088">-</span>&nbsp;<span class="ident" id="3934090">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934094">for</span>&nbsp;<span class="ident" id="3934098">k</span>&nbsp;<span class="op" id="3934100">:=</span>&nbsp;<span class="ident" id="3934103">j</span>&nbsp;<span class="op" id="3934105">-</span>&nbsp;<span class="num" id="3934107">1</span><span class="op" id="3934108">;</span>&nbsp;<span class="ident" id="3934110">k</span>&nbsp;<span class="op" id="3934112">&gt;=</span>&nbsp;<span class="ident" id="3934115">ellipsis</span><span class="op" id="3934123">;</span>&nbsp;<span class="ident" id="3934125">k</span><span class="op" id="3934126">--</span>&nbsp;<span class="op" id="3934129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934134">ip</span><span class="op" id="3934136">[</span><span class="ident" id="3934137">k</span><span class="op" id="3934138">+</span><span class="ident" id="3934139">n</span><span class="op" id="3934140">]</span>&nbsp;<span class="op" id="3934142">=</span>&nbsp;<span class="ident" id="3934144">ip</span><span class="op" id="3934146">[</span><span class="ident" id="3934147">k</span><span class="op" id="3934148">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934156">for</span>&nbsp;<span class="ident" id="3934160">k</span>&nbsp;<span class="op" id="3934162">:=</span>&nbsp;<span class="ident" id="3934165">ellipsis</span>&nbsp;<span class="op" id="3934174">+</span>&nbsp;<span class="ident" id="3934176">n</span>&nbsp;<span class="op" id="3934178">-</span>&nbsp;<span class="num" id="3934180">1</span><span class="op" id="3934181">;</span>&nbsp;<span class="ident" id="3934183">k</span>&nbsp;<span class="op" id="3934185">&gt;=</span>&nbsp;<span class="ident" id="3934188">ellipsis</span><span class="op" id="3934196">;</span>&nbsp;<span class="ident" id="3934198">k</span><span class="op" id="3934199">--</span>&nbsp;<span class="op" id="3934202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934207">ip</span><span class="op" id="3934209">[</span><span class="ident" id="3934210">k</span><span class="op" id="3934211">]</span>&nbsp;<span class="op" id="3934213">=</span>&nbsp;<span class="num" id="3934215">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934222">}</span>&nbsp;<span class="keyword" id="3934224">else</span>&nbsp;<span class="keyword" id="3934229">if</span>&nbsp;<span class="ident" id="3934232">ellipsis</span>&nbsp;<span class="op" id="3934241">&gt;=</span>&nbsp;<span class="num" id="3934244">0</span>&nbsp;<span class="op" id="3934246">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3934250">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934301">return</span>&nbsp;<span class="builtintype" id="3934308">nil</span><span class="op" id="3934311">,</span>&nbsp;<span class="ident" id="3934313">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934322">return</span>&nbsp;<span class="ident" id="3934329">ip</span><span class="op" id="3934331">,</span>&nbsp;<span class="ident" id="3934333">zone</span><br>
<span class="lineno"></span><span class="op" id="3934338">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="3934341">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="3934434">type</span>&nbsp;<span class="ident" id="3934439">ParseError</span>&nbsp;<span class="keyword" id="3934450">struct</span>&nbsp;<span class="op" id="3934457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934460">Type</span>&nbsp;<span class="builtintype" id="3934465">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934473">Text</span>&nbsp;<span class="builtintype" id="3934478">string</span><br>
<span class="lineno">640</span><span class="op" id="3934485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3934488">func</span>&nbsp;<span class="op" id="3934493">(</span><span class="ident" id="3934494">e</span>&nbsp;<span class="op" id="3934496">*</span><span class="ident" id="3934497">ParseError</span><span class="op" id="3934507">)</span>&nbsp;<span class="ident" id="3934509">Error</span><span class="op" id="3934514">(</span><span class="op" id="3934515">)</span>&nbsp;<span class="builtintype" id="3934517">string</span>&nbsp;<span class="op" id="3934524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934527">return</span>&nbsp;<span class="string" id="3934534">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="3934545">+</span>&nbsp;<span class="ident" id="3934547">e</span><span class="op" id="3934548">.</span><span class="ident" id="3934549">Type</span>&nbsp;<span class="op" id="3934554">+</span>&nbsp;<span class="string" id="3934556">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3934561">+</span>&nbsp;<span class="ident" id="3934563">e</span><span class="op" id="3934564">.</span><span class="ident" id="3934565">Text</span><br>
<span class="lineno"></span><span class="op" id="3934570">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="3934573">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="3934633">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3934691">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="3934733">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="3934797">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3934821">func</span>&nbsp;<span class="ident" id="3934826">ParseIP</span><span class="op" id="3934833">(</span><span class="ident" id="3934834">s</span>&nbsp;<span class="builtintype" id="3934836">string</span><span class="op" id="3934842">)</span>&nbsp;<span class="ident" id="3934844">IP</span>&nbsp;<span class="op" id="3934847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934850">for</span>&nbsp;<span class="ident" id="3934854">i</span>&nbsp;<span class="op" id="3934856">:=</span>&nbsp;<span class="num" id="3934859">0</span><span class="op" id="3934860">;</span>&nbsp;<span class="ident" id="3934862">i</span>&nbsp;<span class="op" id="3934864">&lt;</span>&nbsp;<span class="builtinfunc" id="3934866">len</span><span class="op" id="3934869">(</span><span class="ident" id="3934870">s</span><span class="op" id="3934871">)</span><span class="op" id="3934872">;</span>&nbsp;<span class="ident" id="3934874">i</span><span class="op" id="3934875">++</span>&nbsp;<span class="op" id="3934878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934882">switch</span>&nbsp;<span class="ident" id="3934889">s</span><span class="op" id="3934890">[</span><span class="ident" id="3934891">i</span><span class="op" id="3934892">]</span>&nbsp;<span class="op" id="3934894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934898">case</span>&nbsp;<span class="string" id="3934903">&#39;.&#39;</span><span class="op" id="3934906">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934911">return</span>&nbsp;<span class="ident" id="3934918">parseIPv4</span><span class="op" id="3934927">(</span><span class="ident" id="3934928">s</span><span class="op" id="3934929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934933">case</span>&nbsp;<span class="string" id="3934938">&#39;:&#39;</span><span class="op" id="3934941">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934946">ip</span><span class="op" id="3934948">,</span>&nbsp;<span class="ident" id="3934950">_</span>&nbsp;<span class="op" id="3934952">:=</span>&nbsp;<span class="ident" id="3934955">parseIPv6</span><span class="op" id="3934964">(</span><span class="ident" id="3934965">s</span><span class="op" id="3934966">,</span>&nbsp;<span class="builtintype" id="3934968">false</span><span class="op" id="3934973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934978">return</span>&nbsp;<span class="ident" id="3934985">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934990">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934996">return</span>&nbsp;<span class="builtintype" id="3935003">nil</span><br>
<span class="lineno"></span><span class="op" id="3935007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3935010">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="3935072">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3935133">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3935159">//</span><br>
<span class="lineno"></span><span class="comment" id="3935162">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3935225">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="3935290">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="3935354">func</span>&nbsp;<span class="ident" id="3935359">ParseCIDR</span><span class="op" id="3935368">(</span><span class="ident" id="3935369">s</span>&nbsp;<span class="builtintype" id="3935371">string</span><span class="op" id="3935377">)</span>&nbsp;<span class="op" id="3935379">(</span><span class="ident" id="3935380">IP</span><span class="op" id="3935382">,</span>&nbsp;<span class="op" id="3935384">*</span><span class="ident" id="3935385">IPNet</span><span class="op" id="3935390">,</span>&nbsp;<span class="builtintype" id="3935392">error</span><span class="op" id="3935397">)</span>&nbsp;<span class="op" id="3935399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935402">i</span>&nbsp;<span class="op" id="3935404">:=</span>&nbsp;<span class="ident" id="3935407">byteIndex</span><span class="op" id="3935416">(</span><span class="ident" id="3935417">s</span><span class="op" id="3935418">,</span>&nbsp;<span class="string" id="3935420">&#39;/&#39;</span><span class="op" id="3935423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935426">if</span>&nbsp;<span class="ident" id="3935429">i</span>&nbsp;<span class="op" id="3935431">&lt;</span>&nbsp;<span class="num" id="3935433">0</span>&nbsp;<span class="op" id="3935435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935439">return</span>&nbsp;<span class="builtintype" id="3935446">nil</span><span class="op" id="3935449">,</span>&nbsp;<span class="builtintype" id="3935451">nil</span><span class="op" id="3935454">,</span>&nbsp;<span class="op" id="3935456">&amp;</span><span class="ident" id="3935457">ParseError</span><span class="op" id="3935467">{</span><span class="string" id="3935468">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3935482">,</span>&nbsp;<span class="ident" id="3935484">s</span><span class="op" id="3935485">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935491">addr</span><span class="op" id="3935495">,</span>&nbsp;<span class="ident" id="3935497">mask</span>&nbsp;<span class="op" id="3935502">:=</span>&nbsp;<span class="ident" id="3935505">s</span><span class="op" id="3935506">[</span><span class="op" id="3935507">:</span><span class="ident" id="3935508">i</span><span class="op" id="3935509">]</span><span class="op" id="3935510">,</span>&nbsp;<span class="ident" id="3935512">s</span><span class="op" id="3935513">[</span><span class="ident" id="3935514">i</span><span class="op" id="3935515">+</span><span class="num" id="3935516">1</span><span class="op" id="3935517">:</span><span class="op" id="3935518">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935521">iplen</span>&nbsp;<span class="op" id="3935527">:=</span>&nbsp;<span class="ident" id="3935530">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935539">ip</span>&nbsp;<span class="op" id="3935542">:=</span>&nbsp;<span class="ident" id="3935545">parseIPv4</span><span class="op" id="3935554">(</span><span class="ident" id="3935555">addr</span><span class="op" id="3935559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935562">if</span>&nbsp;<span class="ident" id="3935565">ip</span>&nbsp;<span class="op" id="3935568">==</span>&nbsp;<span class="builtintype" id="3935571">nil</span>&nbsp;<span class="op" id="3935575">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935579">iplen</span>&nbsp;<span class="op" id="3935585">=</span>&nbsp;<span class="ident" id="3935587">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935597">ip</span><span class="op" id="3935599">,</span>&nbsp;<span class="ident" id="3935601">_</span>&nbsp;<span class="op" id="3935603">=</span>&nbsp;<span class="ident" id="3935605">parseIPv6</span><span class="op" id="3935614">(</span><span class="ident" id="3935615">addr</span><span class="op" id="3935619">,</span>&nbsp;<span class="builtintype" id="3935621">false</span><span class="op" id="3935626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935632">n</span><span class="op" id="3935633">,</span>&nbsp;<span class="ident" id="3935635">i</span><span class="op" id="3935636">,</span>&nbsp;<span class="ident" id="3935638">ok</span>&nbsp;<span class="op" id="3935641">:=</span>&nbsp;<span class="ident" id="3935644">dtoi</span><span class="op" id="3935648">(</span><span class="ident" id="3935649">mask</span><span class="op" id="3935653">,</span>&nbsp;<span class="num" id="3935655">0</span><span class="op" id="3935656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935659">if</span>&nbsp;<span class="ident" id="3935662">ip</span>&nbsp;<span class="op" id="3935665">==</span>&nbsp;<span class="builtintype" id="3935668">nil</span>&nbsp;<span class="op" id="3935672">||</span>&nbsp;<span class="op" id="3935675">!</span><span class="ident" id="3935676">ok</span>&nbsp;<span class="op" id="3935679">||</span>&nbsp;<span class="ident" id="3935682">i</span>&nbsp;<span class="op" id="3935684">!=</span>&nbsp;<span class="builtinfunc" id="3935687">len</span><span class="op" id="3935690">(</span><span class="ident" id="3935691">mask</span><span class="op" id="3935695">)</span>&nbsp;<span class="op" id="3935697">||</span>&nbsp;<span class="ident" id="3935700">n</span>&nbsp;<span class="op" id="3935702">&lt;</span>&nbsp;<span class="num" id="3935704">0</span>&nbsp;<span class="op" id="3935706">||</span>&nbsp;<span class="ident" id="3935709">n</span>&nbsp;<span class="op" id="3935711">&gt;</span>&nbsp;<span class="num" id="3935713">8</span><span class="op" id="3935714">*</span><span class="ident" id="3935715">iplen</span>&nbsp;<span class="op" id="3935721">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935725">return</span>&nbsp;<span class="builtintype" id="3935732">nil</span><span class="op" id="3935735">,</span>&nbsp;<span class="builtintype" id="3935737">nil</span><span class="op" id="3935740">,</span>&nbsp;<span class="op" id="3935742">&amp;</span><span class="ident" id="3935743">ParseError</span><span class="op" id="3935753">{</span><span class="string" id="3935754">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3935768">,</span>&nbsp;<span class="ident" id="3935770">s</span><span class="op" id="3935771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935777">m</span>&nbsp;<span class="op" id="3935779">:=</span>&nbsp;<span class="ident" id="3935782">CIDRMask</span><span class="op" id="3935790">(</span><span class="ident" id="3935791">n</span><span class="op" id="3935792">,</span>&nbsp;<span class="num" id="3935794">8</span><span class="op" id="3935795">*</span><span class="ident" id="3935796">iplen</span><span class="op" id="3935801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935804">return</span>&nbsp;<span class="ident" id="3935811">ip</span><span class="op" id="3935813">,</span>&nbsp;<span class="op" id="3935815">&amp;</span><span class="ident" id="3935816">IPNet</span><span class="op" id="3935821">{</span><span class="ident" id="3935822">IP</span><span class="op" id="3935824">:</span>&nbsp;<span class="ident" id="3935826">ip</span><span class="op" id="3935828">.</span><span class="ident" id="3935829">Mask</span><span class="op" id="3935833">(</span><span class="ident" id="3935834">m</span><span class="op" id="3935835">)</span><span class="op" id="3935836">,</span>&nbsp;<span class="ident" id="3935838">Mask</span><span class="op" id="3935842">:</span>&nbsp;<span class="ident" id="3935844">m</span><span class="op" id="3935845">}</span><span class="op" id="3935846">,</span>&nbsp;<span class="builtintype" id="3935848">nil</span><br>
<span class="lineno"></span><span class="op" id="3935852">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
