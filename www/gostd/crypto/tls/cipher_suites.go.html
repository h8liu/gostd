<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4405546">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4405601">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4405655">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4405706">package</span>&nbsp;<span class="ident" id="4405714">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4405719">import</span>&nbsp;<span class="op" id="4405726">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405729">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405743">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405760">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405774">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405789">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405803">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405818">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405833">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4405840">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4405843">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="4405922">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="4405986">type</span>&nbsp;<span class="ident" id="4405991">keyAgreement</span>&nbsp;<span class="keyword" id="4406004">interface</span>&nbsp;<span class="op" id="4406014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406017">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406085">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406147">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406220">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406229">generateServerKeyExchange</span><span class="op" id="4406254">(</span><span class="op" id="4406255">*</span><span class="ident" id="4406256">Config</span><span class="op" id="4406262">,</span>&nbsp;<span class="op" id="4406264">*</span><span class="ident" id="4406265">Certificate</span><span class="op" id="4406276">,</span>&nbsp;<span class="op" id="4406278">*</span><span class="ident" id="4406279">clientHelloMsg</span><span class="op" id="4406293">,</span>&nbsp;<span class="op" id="4406295">*</span><span class="ident" id="4406296">serverHelloMsg</span><span class="op" id="4406310">)</span>&nbsp;<span class="op" id="4406312">(</span><span class="op" id="4406313">*</span><span class="ident" id="4406314">serverKeyExchangeMsg</span><span class="op" id="4406334">,</span>&nbsp;<span class="builtintype" id="4406336">error</span><span class="op" id="4406341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406344">processClientKeyExchange</span><span class="op" id="4406368">(</span><span class="op" id="4406369">*</span><span class="ident" id="4406370">Config</span><span class="op" id="4406376">,</span>&nbsp;<span class="op" id="4406378">*</span><span class="ident" id="4406379">Certificate</span><span class="op" id="4406390">,</span>&nbsp;<span class="op" id="4406392">*</span><span class="ident" id="4406393">clientKeyExchangeMsg</span><span class="op" id="4406413">,</span>&nbsp;<span class="builtintype" id="4406415">uint16</span><span class="op" id="4406421">)</span>&nbsp;<span class="op" id="4406423">(</span><span class="op" id="4406424">[</span><span class="op" id="4406425">]</span><span class="builtintype" id="4406426">byte</span><span class="op" id="4406430">,</span>&nbsp;<span class="builtintype" id="4406432">error</span><span class="op" id="4406437">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406441">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406508">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406571">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406602">processServerKeyExchange</span><span class="op" id="4406626">(</span><span class="op" id="4406627">*</span><span class="ident" id="4406628">Config</span><span class="op" id="4406634">,</span>&nbsp;<span class="op" id="4406636">*</span><span class="ident" id="4406637">clientHelloMsg</span><span class="op" id="4406651">,</span>&nbsp;<span class="op" id="4406653">*</span><span class="ident" id="4406654">serverHelloMsg</span><span class="op" id="4406668">,</span>&nbsp;<span class="op" id="4406670">*</span><span class="ident" id="4406671">x509</span><span class="op" id="4406675">.</span><span class="ident" id="4406676">Certificate</span><span class="op" id="4406687">,</span>&nbsp;<span class="op" id="4406689">*</span><span class="ident" id="4406690">serverKeyExchangeMsg</span><span class="op" id="4406710">)</span>&nbsp;<span class="builtintype" id="4406712">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406719">generateClientKeyExchange</span><span class="op" id="4406744">(</span><span class="op" id="4406745">*</span><span class="ident" id="4406746">Config</span><span class="op" id="4406752">,</span>&nbsp;<span class="op" id="4406754">*</span><span class="ident" id="4406755">clientHelloMsg</span><span class="op" id="4406769">,</span>&nbsp;<span class="op" id="4406771">*</span><span class="ident" id="4406772">x509</span><span class="op" id="4406776">.</span><span class="ident" id="4406777">Certificate</span><span class="op" id="4406788">)</span>&nbsp;<span class="op" id="4406790">(</span><span class="op" id="4406791">[</span><span class="op" id="4406792">]</span><span class="builtintype" id="4406793">byte</span><span class="op" id="4406797">,</span>&nbsp;<span class="op" id="4406799">*</span><span class="ident" id="4406800">clientKeyExchangeMsg</span><span class="op" id="4406820">,</span>&nbsp;<span class="builtintype" id="4406822">error</span><span class="op" id="4406827">)</span><br>
<span class="lineno">35</span><span class="op" id="4406829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4406832">const</span>&nbsp;<span class="op" id="4406838">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406841">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406911">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406983">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407055">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407082">suiteECDHE</span>&nbsp;<span class="op" id="4407093">=</span>&nbsp;<span class="num" id="4407095">1</span>&nbsp;<span class="op" id="4407097">&lt;&lt;</span>&nbsp;<span class="ident" id="4407100">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407106">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407171">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407238">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407308">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407323">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407335">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407408">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407445">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="4407456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4407459">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="4407535">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="4407602">type</span>&nbsp;<span class="ident" id="4407607">cipherSuite</span>&nbsp;<span class="keyword" id="4407619">struct</span>&nbsp;<span class="op" id="4407626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407629">id</span>&nbsp;<span class="builtintype" id="4407632">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407640">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407714">keyLen</span>&nbsp;<span class="builtintype" id="4407721">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407726">macLen</span>&nbsp;<span class="builtintype" id="4407733">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407738">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="4407745">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407750">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407757">func</span><span class="op" id="4407761">(</span><span class="ident" id="4407762">version</span>&nbsp;<span class="builtintype" id="4407770">uint16</span><span class="op" id="4407776">)</span>&nbsp;<span class="ident" id="4407778">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407792">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407844">flags</span>&nbsp;&nbsp;<span class="builtintype" id="4407851">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407856">cipher</span>&nbsp;<span class="keyword" id="4407863">func</span><span class="op" id="4407867">(</span><span class="ident" id="4407868">key</span><span class="op" id="4407871">,</span>&nbsp;<span class="ident" id="4407873">iv</span>&nbsp;<span class="op" id="4407876">[</span><span class="op" id="4407877">]</span><span class="builtintype" id="4407878">byte</span><span class="op" id="4407882">,</span>&nbsp;<span class="ident" id="4407884">isRead</span>&nbsp;<span class="builtintype" id="4407891">bool</span><span class="op" id="4407895">)</span>&nbsp;<span class="keyword" id="4407897">interface</span><span class="op" id="4407906">{</span><span class="op" id="4407907">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407910">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407917">func</span><span class="op" id="4407921">(</span><span class="ident" id="4407922">version</span>&nbsp;<span class="builtintype" id="4407930">uint16</span><span class="op" id="4407936">,</span>&nbsp;<span class="ident" id="4407938">macKey</span>&nbsp;<span class="op" id="4407945">[</span><span class="op" id="4407946">]</span><span class="builtintype" id="4407947">byte</span><span class="op" id="4407951">)</span>&nbsp;<span class="ident" id="4407953">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407966">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407973">func</span><span class="op" id="4407977">(</span><span class="ident" id="4407978">key</span><span class="op" id="4407981">,</span>&nbsp;<span class="ident" id="4407983">fixedNonce</span>&nbsp;<span class="op" id="4407994">[</span><span class="op" id="4407995">]</span><span class="builtintype" id="4407996">byte</span><span class="op" id="4408000">)</span>&nbsp;<span class="ident" id="4408002">cipher</span><span class="op" id="4408008">.</span><span class="ident" id="4408009">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4408014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4408017">var</span>&nbsp;<span class="ident" id="4408021">cipherSuites</span>&nbsp;<span class="op" id="4408034">=</span>&nbsp;<span class="op" id="4408036">[</span><span class="op" id="4408037">]</span><span class="op" id="4408038">*</span><span class="ident" id="4408039">cipherSuite</span><span class="op" id="4408050">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408053">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408122">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408184">{</span><span class="ident" id="4408185">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4408222">,</span>&nbsp;<span class="num" id="4408224">16</span><span class="op" id="4408226">,</span>&nbsp;<span class="num" id="4408228">0</span><span class="op" id="4408229">,</span>&nbsp;<span class="num" id="4408231">4</span><span class="op" id="4408232">,</span>&nbsp;<span class="ident" id="4408234">ecdheRSAKA</span><span class="op" id="4408244">,</span>&nbsp;<span class="ident" id="4408246">suiteECDHE</span>&nbsp;<span class="op" id="4408257">|</span>&nbsp;<span class="ident" id="4408259">suiteTLS12</span><span class="op" id="4408269">,</span>&nbsp;<span class="ident" id="4408271">nil</span><span class="op" id="4408274">,</span>&nbsp;<span class="ident" id="4408276">nil</span><span class="op" id="4408279">,</span>&nbsp;<span class="ident" id="4408281">aeadAESGCM</span><span class="op" id="4408291">}</span><span class="op" id="4408292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408295">{</span><span class="ident" id="4408296">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4408335">,</span>&nbsp;<span class="num" id="4408337">16</span><span class="op" id="4408339">,</span>&nbsp;<span class="num" id="4408341">0</span><span class="op" id="4408342">,</span>&nbsp;<span class="num" id="4408344">4</span><span class="op" id="4408345">,</span>&nbsp;<span class="ident" id="4408347">ecdheECDSAKA</span><span class="op" id="4408359">,</span>&nbsp;<span class="ident" id="4408361">suiteECDHE</span>&nbsp;<span class="op" id="4408372">|</span>&nbsp;<span class="ident" id="4408374">suiteECDSA</span>&nbsp;<span class="op" id="4408385">|</span>&nbsp;<span class="ident" id="4408387">suiteTLS12</span><span class="op" id="4408397">,</span>&nbsp;<span class="ident" id="4408399">nil</span><span class="op" id="4408402">,</span>&nbsp;<span class="ident" id="4408404">nil</span><span class="op" id="4408407">,</span>&nbsp;<span class="ident" id="4408409">aeadAESGCM</span><span class="op" id="4408419">}</span><span class="op" id="4408420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408423">{</span><span class="ident" id="4408424">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="4408454">,</span>&nbsp;<span class="num" id="4408456">16</span><span class="op" id="4408458">,</span>&nbsp;<span class="num" id="4408460">20</span><span class="op" id="4408462">,</span>&nbsp;<span class="num" id="4408464">0</span><span class="op" id="4408465">,</span>&nbsp;<span class="ident" id="4408467">ecdheRSAKA</span><span class="op" id="4408477">,</span>&nbsp;<span class="ident" id="4408479">suiteECDHE</span><span class="op" id="4408489">,</span>&nbsp;<span class="ident" id="4408491">cipherRC4</span><span class="op" id="4408500">,</span>&nbsp;<span class="ident" id="4408502">macSHA1</span><span class="op" id="4408509">,</span>&nbsp;<span class="ident" id="4408511">nil</span><span class="op" id="4408514">}</span><span class="op" id="4408515">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408518">{</span><span class="ident" id="4408519">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="4408551">,</span>&nbsp;<span class="num" id="4408553">16</span><span class="op" id="4408555">,</span>&nbsp;<span class="num" id="4408557">20</span><span class="op" id="4408559">,</span>&nbsp;<span class="num" id="4408561">0</span><span class="op" id="4408562">,</span>&nbsp;<span class="ident" id="4408564">ecdheECDSAKA</span><span class="op" id="4408576">,</span>&nbsp;<span class="ident" id="4408578">suiteECDHE</span>&nbsp;<span class="op" id="4408589">|</span>&nbsp;<span class="ident" id="4408591">suiteECDSA</span><span class="op" id="4408601">,</span>&nbsp;<span class="ident" id="4408603">cipherRC4</span><span class="op" id="4408612">,</span>&nbsp;<span class="ident" id="4408614">macSHA1</span><span class="op" id="4408621">,</span>&nbsp;<span class="ident" id="4408623">nil</span><span class="op" id="4408626">}</span><span class="op" id="4408627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408630">{</span><span class="ident" id="4408631">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4408665">,</span>&nbsp;<span class="num" id="4408667">16</span><span class="op" id="4408669">,</span>&nbsp;<span class="num" id="4408671">20</span><span class="op" id="4408673">,</span>&nbsp;<span class="num" id="4408675">16</span><span class="op" id="4408677">,</span>&nbsp;<span class="ident" id="4408679">ecdheRSAKA</span><span class="op" id="4408689">,</span>&nbsp;<span class="ident" id="4408691">suiteECDHE</span><span class="op" id="4408701">,</span>&nbsp;<span class="ident" id="4408703">cipherAES</span><span class="op" id="4408712">,</span>&nbsp;<span class="ident" id="4408714">macSHA1</span><span class="op" id="4408721">,</span>&nbsp;<span class="ident" id="4408723">nil</span><span class="op" id="4408726">}</span><span class="op" id="4408727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408730">{</span><span class="ident" id="4408731">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4408767">,</span>&nbsp;<span class="num" id="4408769">16</span><span class="op" id="4408771">,</span>&nbsp;<span class="num" id="4408773">20</span><span class="op" id="4408775">,</span>&nbsp;<span class="num" id="4408777">16</span><span class="op" id="4408779">,</span>&nbsp;<span class="ident" id="4408781">ecdheECDSAKA</span><span class="op" id="4408793">,</span>&nbsp;<span class="ident" id="4408795">suiteECDHE</span>&nbsp;<span class="op" id="4408806">|</span>&nbsp;<span class="ident" id="4408808">suiteECDSA</span><span class="op" id="4408818">,</span>&nbsp;<span class="ident" id="4408820">cipherAES</span><span class="op" id="4408829">,</span>&nbsp;<span class="ident" id="4408831">macSHA1</span><span class="op" id="4408838">,</span>&nbsp;<span class="ident" id="4408840">nil</span><span class="op" id="4408843">}</span><span class="op" id="4408844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408847">{</span><span class="ident" id="4408848">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4408882">,</span>&nbsp;<span class="num" id="4408884">32</span><span class="op" id="4408886">,</span>&nbsp;<span class="num" id="4408888">20</span><span class="op" id="4408890">,</span>&nbsp;<span class="num" id="4408892">16</span><span class="op" id="4408894">,</span>&nbsp;<span class="ident" id="4408896">ecdheRSAKA</span><span class="op" id="4408906">,</span>&nbsp;<span class="ident" id="4408908">suiteECDHE</span><span class="op" id="4408918">,</span>&nbsp;<span class="ident" id="4408920">cipherAES</span><span class="op" id="4408929">,</span>&nbsp;<span class="ident" id="4408931">macSHA1</span><span class="op" id="4408938">,</span>&nbsp;<span class="ident" id="4408940">nil</span><span class="op" id="4408943">}</span><span class="op" id="4408944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408947">{</span><span class="ident" id="4408948">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4408984">,</span>&nbsp;<span class="num" id="4408986">32</span><span class="op" id="4408988">,</span>&nbsp;<span class="num" id="4408990">20</span><span class="op" id="4408992">,</span>&nbsp;<span class="num" id="4408994">16</span><span class="op" id="4408996">,</span>&nbsp;<span class="ident" id="4408998">ecdheECDSAKA</span><span class="op" id="4409010">,</span>&nbsp;<span class="ident" id="4409012">suiteECDHE</span>&nbsp;<span class="op" id="4409023">|</span>&nbsp;<span class="ident" id="4409025">suiteECDSA</span><span class="op" id="4409035">,</span>&nbsp;<span class="ident" id="4409037">cipherAES</span><span class="op" id="4409046">,</span>&nbsp;<span class="ident" id="4409048">macSHA1</span><span class="op" id="4409055">,</span>&nbsp;<span class="ident" id="4409057">nil</span><span class="op" id="4409060">}</span><span class="op" id="4409061">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409064">{</span><span class="ident" id="4409065">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="4409089">,</span>&nbsp;<span class="num" id="4409091">16</span><span class="op" id="4409093">,</span>&nbsp;<span class="num" id="4409095">20</span><span class="op" id="4409097">,</span>&nbsp;<span class="num" id="4409099">0</span><span class="op" id="4409100">,</span>&nbsp;<span class="ident" id="4409102">rsaKA</span><span class="op" id="4409107">,</span>&nbsp;<span class="num" id="4409109">0</span><span class="op" id="4409110">,</span>&nbsp;<span class="ident" id="4409112">cipherRC4</span><span class="op" id="4409121">,</span>&nbsp;<span class="ident" id="4409123">macSHA1</span><span class="op" id="4409130">,</span>&nbsp;<span class="ident" id="4409132">nil</span><span class="op" id="4409135">}</span><span class="op" id="4409136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409139">{</span><span class="ident" id="4409140">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4409168">,</span>&nbsp;<span class="num" id="4409170">16</span><span class="op" id="4409172">,</span>&nbsp;<span class="num" id="4409174">20</span><span class="op" id="4409176">,</span>&nbsp;<span class="num" id="4409178">16</span><span class="op" id="4409180">,</span>&nbsp;<span class="ident" id="4409182">rsaKA</span><span class="op" id="4409187">,</span>&nbsp;<span class="num" id="4409189">0</span><span class="op" id="4409190">,</span>&nbsp;<span class="ident" id="4409192">cipherAES</span><span class="op" id="4409201">,</span>&nbsp;<span class="ident" id="4409203">macSHA1</span><span class="op" id="4409210">,</span>&nbsp;<span class="ident" id="4409212">nil</span><span class="op" id="4409215">}</span><span class="op" id="4409216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409219">{</span><span class="ident" id="4409220">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4409248">,</span>&nbsp;<span class="num" id="4409250">32</span><span class="op" id="4409252">,</span>&nbsp;<span class="num" id="4409254">20</span><span class="op" id="4409256">,</span>&nbsp;<span class="num" id="4409258">16</span><span class="op" id="4409260">,</span>&nbsp;<span class="ident" id="4409262">rsaKA</span><span class="op" id="4409267">,</span>&nbsp;<span class="num" id="4409269">0</span><span class="op" id="4409270">,</span>&nbsp;<span class="ident" id="4409272">cipherAES</span><span class="op" id="4409281">,</span>&nbsp;<span class="ident" id="4409283">macSHA1</span><span class="op" id="4409290">,</span>&nbsp;<span class="ident" id="4409292">nil</span><span class="op" id="4409295">}</span><span class="op" id="4409296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409299">{</span><span class="ident" id="4409300">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4409335">,</span>&nbsp;<span class="num" id="4409337">24</span><span class="op" id="4409339">,</span>&nbsp;<span class="num" id="4409341">20</span><span class="op" id="4409343">,</span>&nbsp;<span class="num" id="4409345">8</span><span class="op" id="4409346">,</span>&nbsp;<span class="ident" id="4409348">ecdheRSAKA</span><span class="op" id="4409358">,</span>&nbsp;<span class="ident" id="4409360">suiteECDHE</span><span class="op" id="4409370">,</span>&nbsp;<span class="ident" id="4409372">cipher3DES</span><span class="op" id="4409382">,</span>&nbsp;<span class="ident" id="4409384">macSHA1</span><span class="op" id="4409391">,</span>&nbsp;<span class="ident" id="4409393">nil</span><span class="op" id="4409396">}</span><span class="op" id="4409397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409400">{</span><span class="ident" id="4409401">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4409430">,</span>&nbsp;<span class="num" id="4409432">24</span><span class="op" id="4409434">,</span>&nbsp;<span class="num" id="4409436">20</span><span class="op" id="4409438">,</span>&nbsp;<span class="num" id="4409440">8</span><span class="op" id="4409441">,</span>&nbsp;<span class="ident" id="4409443">rsaKA</span><span class="op" id="4409448">,</span>&nbsp;<span class="num" id="4409450">0</span><span class="op" id="4409451">,</span>&nbsp;<span class="ident" id="4409453">cipher3DES</span><span class="op" id="4409463">,</span>&nbsp;<span class="ident" id="4409465">macSHA1</span><span class="op" id="4409472">,</span>&nbsp;<span class="ident" id="4409474">nil</span><span class="op" id="4409477">}</span><span class="op" id="4409478">,</span><br>
<span class="lineno">85</span><span class="op" id="4409480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4409483">func</span>&nbsp;<span class="ident" id="4409488">cipherRC4</span><span class="op" id="4409497">(</span><span class="ident" id="4409498">key</span><span class="op" id="4409501">,</span>&nbsp;<span class="ident" id="4409503">iv</span>&nbsp;<span class="op" id="4409506">[</span><span class="op" id="4409507">]</span><span class="builtintype" id="4409508">byte</span><span class="op" id="4409512">,</span>&nbsp;<span class="ident" id="4409514">isRead</span>&nbsp;<span class="builtintype" id="4409521">bool</span><span class="op" id="4409525">)</span>&nbsp;<span class="keyword" id="4409527">interface</span><span class="op" id="4409536">{</span><span class="op" id="4409537">}</span>&nbsp;<span class="op" id="4409539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409542">cipher</span><span class="op" id="4409548">,</span>&nbsp;<span class="ident" id="4409550">_</span>&nbsp;<span class="op" id="4409552">:=</span>&nbsp;<span class="ident" id="4409555">rc4</span><span class="op" id="4409558">.</span><span class="ident" id="4409559">NewCipher</span><span class="op" id="4409568">(</span><span class="ident" id="4409569">key</span><span class="op" id="4409572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409575">return</span>&nbsp;<span class="ident" id="4409582">cipher</span><br>
<span class="lineno">90</span><span class="op" id="4409589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4409592">func</span>&nbsp;<span class="ident" id="4409597">cipher3DES</span><span class="op" id="4409607">(</span><span class="ident" id="4409608">key</span><span class="op" id="4409611">,</span>&nbsp;<span class="ident" id="4409613">iv</span>&nbsp;<span class="op" id="4409616">[</span><span class="op" id="4409617">]</span><span class="builtintype" id="4409618">byte</span><span class="op" id="4409622">,</span>&nbsp;<span class="ident" id="4409624">isRead</span>&nbsp;<span class="builtintype" id="4409631">bool</span><span class="op" id="4409635">)</span>&nbsp;<span class="keyword" id="4409637">interface</span><span class="op" id="4409646">{</span><span class="op" id="4409647">}</span>&nbsp;<span class="op" id="4409649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409652">block</span><span class="op" id="4409657">,</span>&nbsp;<span class="ident" id="4409659">_</span>&nbsp;<span class="op" id="4409661">:=</span>&nbsp;<span class="ident" id="4409664">des</span><span class="op" id="4409667">.</span><span class="ident" id="4409668">NewTripleDESCipher</span><span class="op" id="4409686">(</span><span class="ident" id="4409687">key</span><span class="op" id="4409690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409693">if</span>&nbsp;<span class="ident" id="4409696">isRead</span>&nbsp;<span class="op" id="4409703">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409707">return</span>&nbsp;<span class="ident" id="4409714">cipher</span><span class="op" id="4409720">.</span><span class="ident" id="4409721">NewCBCDecrypter</span><span class="op" id="4409736">(</span><span class="ident" id="4409737">block</span><span class="op" id="4409742">,</span>&nbsp;<span class="ident" id="4409744">iv</span><span class="op" id="4409746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409752">return</span>&nbsp;<span class="ident" id="4409759">cipher</span><span class="op" id="4409765">.</span><span class="ident" id="4409766">NewCBCEncrypter</span><span class="op" id="4409781">(</span><span class="ident" id="4409782">block</span><span class="op" id="4409787">,</span>&nbsp;<span class="ident" id="4409789">iv</span><span class="op" id="4409791">)</span><br>
<span class="lineno"></span><span class="op" id="4409793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4409796">func</span>&nbsp;<span class="ident" id="4409801">cipherAES</span><span class="op" id="4409810">(</span><span class="ident" id="4409811">key</span><span class="op" id="4409814">,</span>&nbsp;<span class="ident" id="4409816">iv</span>&nbsp;<span class="op" id="4409819">[</span><span class="op" id="4409820">]</span><span class="builtintype" id="4409821">byte</span><span class="op" id="4409825">,</span>&nbsp;<span class="ident" id="4409827">isRead</span>&nbsp;<span class="builtintype" id="4409834">bool</span><span class="op" id="4409838">)</span>&nbsp;<span class="keyword" id="4409840">interface</span><span class="op" id="4409849">{</span><span class="op" id="4409850">}</span>&nbsp;<span class="op" id="4409852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409855">block</span><span class="op" id="4409860">,</span>&nbsp;<span class="ident" id="4409862">_</span>&nbsp;<span class="op" id="4409864">:=</span>&nbsp;<span class="ident" id="4409867">aes</span><span class="op" id="4409870">.</span><span class="ident" id="4409871">NewCipher</span><span class="op" id="4409880">(</span><span class="ident" id="4409881">key</span><span class="op" id="4409884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409887">if</span>&nbsp;<span class="ident" id="4409890">isRead</span>&nbsp;<span class="op" id="4409897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409901">return</span>&nbsp;<span class="ident" id="4409908">cipher</span><span class="op" id="4409914">.</span><span class="ident" id="4409915">NewCBCDecrypter</span><span class="op" id="4409930">(</span><span class="ident" id="4409931">block</span><span class="op" id="4409936">,</span>&nbsp;<span class="ident" id="4409938">iv</span><span class="op" id="4409940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409943">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409946">return</span>&nbsp;<span class="ident" id="4409953">cipher</span><span class="op" id="4409959">.</span><span class="ident" id="4409960">NewCBCEncrypter</span><span class="op" id="4409975">(</span><span class="ident" id="4409976">block</span><span class="op" id="4409981">,</span>&nbsp;<span class="ident" id="4409983">iv</span><span class="op" id="4409985">)</span><br>
<span class="lineno"></span><span class="op" id="4409987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4409990">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="4410055">func</span>&nbsp;<span class="ident" id="4410060">macSHA1</span><span class="op" id="4410067">(</span><span class="ident" id="4410068">version</span>&nbsp;<span class="builtintype" id="4410076">uint16</span><span class="op" id="4410082">,</span>&nbsp;<span class="ident" id="4410084">key</span>&nbsp;<span class="op" id="4410088">[</span><span class="op" id="4410089">]</span><span class="builtintype" id="4410090">byte</span><span class="op" id="4410094">)</span>&nbsp;<span class="ident" id="4410096">macFunction</span>&nbsp;<span class="op" id="4410108">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410111">if</span>&nbsp;<span class="ident" id="4410114">version</span>&nbsp;<span class="op" id="4410122">==</span>&nbsp;<span class="ident" id="4410125">VersionSSL30</span>&nbsp;<span class="op" id="4410138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410142">mac</span>&nbsp;<span class="op" id="4410146">:=</span>&nbsp;<span class="ident" id="4410149">ssl30MAC</span><span class="op" id="4410157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410162">h</span><span class="op" id="4410163">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4410167">sha1</span><span class="op" id="4410171">.</span><span class="ident" id="4410172">New</span><span class="op" id="4410175">(</span><span class="op" id="4410176">)</span><span class="op" id="4410177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410182">key</span><span class="op" id="4410185">:</span>&nbsp;<span class="builtinfunc" id="4410187">make</span><span class="op" id="4410191">(</span><span class="op" id="4410192">[</span><span class="op" id="4410193">]</span><span class="builtintype" id="4410194">byte</span><span class="op" id="4410198">,</span>&nbsp;<span class="builtinfunc" id="4410200">len</span><span class="op" id="4410203">(</span><span class="ident" id="4410204">key</span><span class="op" id="4410207">)</span><span class="op" id="4410208">)</span><span class="op" id="4410209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4410213">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4410217">copy</span><span class="op" id="4410221">(</span><span class="ident" id="4410222">mac</span><span class="op" id="4410225">.</span><span class="ident" id="4410226">key</span><span class="op" id="4410229">,</span>&nbsp;<span class="ident" id="4410231">key</span><span class="op" id="4410234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410238">return</span>&nbsp;<span class="ident" id="4410245">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4410250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410253">return</span>&nbsp;<span class="ident" id="4410260">tls10MAC</span><span class="op" id="4410268">{</span><span class="ident" id="4410269">hmac</span><span class="op" id="4410273">.</span><span class="ident" id="4410274">New</span><span class="op" id="4410277">(</span><span class="ident" id="4410278">sha1</span><span class="op" id="4410282">.</span><span class="ident" id="4410283">New</span><span class="op" id="4410286">,</span>&nbsp;<span class="ident" id="4410288">key</span><span class="op" id="4410291">)</span><span class="op" id="4410292">}</span><br>
<span class="lineno"></span><span class="op" id="4410294">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4410297">type</span>&nbsp;<span class="ident" id="4410302">macFunction</span>&nbsp;<span class="keyword" id="4410314">interface</span>&nbsp;<span class="op" id="4410324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410327">Size</span><span class="op" id="4410331">(</span><span class="op" id="4410332">)</span>&nbsp;<span class="builtintype" id="4410334">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410339">MAC</span><span class="op" id="4410342">(</span><span class="ident" id="4410343">digestBuf</span><span class="op" id="4410352">,</span>&nbsp;<span class="ident" id="4410354">seq</span><span class="op" id="4410357">,</span>&nbsp;<span class="ident" id="4410359">header</span><span class="op" id="4410365">,</span>&nbsp;<span class="ident" id="4410367">data</span>&nbsp;<span class="op" id="4410372">[</span><span class="op" id="4410373">]</span><span class="builtintype" id="4410374">byte</span><span class="op" id="4410378">)</span>&nbsp;<span class="op" id="4410380">[</span><span class="op" id="4410381">]</span><span class="builtintype" id="4410382">byte</span><br>
<span class="lineno"></span><span class="op" id="4410387">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4410390">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4410467">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="4410481">type</span>&nbsp;<span class="ident" id="4410486">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="4410501">struct</span>&nbsp;<span class="op" id="4410508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4410511">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4410582">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4410646">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410701">sealNonce</span><span class="op" id="4410710">,</span>&nbsp;<span class="ident" id="4410712">openNonce</span>&nbsp;<span class="op" id="4410722">[</span><span class="op" id="4410723">]</span><span class="builtintype" id="4410724">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410730">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410751">cipher</span><span class="op" id="4410757">.</span><span class="ident" id="4410758">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4410763">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4410766">func</span>&nbsp;<span class="op" id="4410771">(</span><span class="ident" id="4410772">f</span>&nbsp;<span class="op" id="4410774">*</span><span class="ident" id="4410775">fixedNonceAEAD</span><span class="op" id="4410789">)</span>&nbsp;<span class="ident" id="4410791">NonceSize</span><span class="op" id="4410800">(</span><span class="op" id="4410801">)</span>&nbsp;<span class="builtintype" id="4410803">int</span>&nbsp;<span class="op" id="4410807">{</span>&nbsp;<span class="keyword" id="4410809">return</span>&nbsp;<span class="num" id="4410816">8</span>&nbsp;<span class="op" id="4410818">}</span><br>
<span class="lineno"></span><span class="keyword" id="4410820">func</span>&nbsp;<span class="op" id="4410825">(</span><span class="ident" id="4410826">f</span>&nbsp;<span class="op" id="4410828">*</span><span class="ident" id="4410829">fixedNonceAEAD</span><span class="op" id="4410843">)</span>&nbsp;<span class="ident" id="4410845">Overhead</span><span class="op" id="4410853">(</span><span class="op" id="4410854">)</span>&nbsp;<span class="builtintype" id="4410856">int</span>&nbsp;&nbsp;<span class="op" id="4410861">{</span>&nbsp;<span class="keyword" id="4410863">return</span>&nbsp;<span class="ident" id="4410870">f</span><span class="op" id="4410871">.</span><span class="ident" id="4410872">aead</span><span class="op" id="4410876">.</span><span class="ident" id="4410877">Overhead</span><span class="op" id="4410885">(</span><span class="op" id="4410886">)</span>&nbsp;<span class="op" id="4410888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4410891">func</span>&nbsp;<span class="op" id="4410896">(</span><span class="ident" id="4410897">f</span>&nbsp;<span class="op" id="4410899">*</span><span class="ident" id="4410900">fixedNonceAEAD</span><span class="op" id="4410914">)</span>&nbsp;<span class="ident" id="4410916">Seal</span><span class="op" id="4410920">(</span><span class="ident" id="4410921">out</span><span class="op" id="4410924">,</span>&nbsp;<span class="ident" id="4410926">nonce</span><span class="op" id="4410931">,</span>&nbsp;<span class="ident" id="4410933">plaintext</span><span class="op" id="4410942">,</span>&nbsp;<span class="ident" id="4410944">additionalData</span>&nbsp;<span class="op" id="4410959">[</span><span class="op" id="4410960">]</span><span class="builtintype" id="4410961">byte</span><span class="op" id="4410965">)</span>&nbsp;<span class="op" id="4410967">[</span><span class="op" id="4410968">]</span><span class="builtintype" id="4410969">byte</span>&nbsp;<span class="op" id="4410974">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4410977">copy</span><span class="op" id="4410981">(</span><span class="ident" id="4410982">f</span><span class="op" id="4410983">.</span><span class="ident" id="4410984">sealNonce</span><span class="op" id="4410993">[</span><span class="builtinfunc" id="4410994">len</span><span class="op" id="4410997">(</span><span class="ident" id="4410998">f</span><span class="op" id="4410999">.</span><span class="ident" id="4411000">sealNonce</span><span class="op" id="4411009">)</span><span class="op" id="4411010">-</span><span class="num" id="4411011">8</span><span class="op" id="4411012">:</span><span class="op" id="4411013">]</span><span class="op" id="4411014">,</span>&nbsp;<span class="ident" id="4411016">nonce</span><span class="op" id="4411021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411024">return</span>&nbsp;<span class="ident" id="4411031">f</span><span class="op" id="4411032">.</span><span class="ident" id="4411033">aead</span><span class="op" id="4411037">.</span><span class="ident" id="4411038">Seal</span><span class="op" id="4411042">(</span><span class="ident" id="4411043">out</span><span class="op" id="4411046">,</span>&nbsp;<span class="ident" id="4411048">f</span><span class="op" id="4411049">.</span><span class="ident" id="4411050">sealNonce</span><span class="op" id="4411059">,</span>&nbsp;<span class="ident" id="4411061">plaintext</span><span class="op" id="4411070">,</span>&nbsp;<span class="ident" id="4411072">additionalData</span><span class="op" id="4411086">)</span><br>
<span class="lineno"></span><span class="op" id="4411088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4411091">func</span>&nbsp;<span class="op" id="4411096">(</span><span class="ident" id="4411097">f</span>&nbsp;<span class="op" id="4411099">*</span><span class="ident" id="4411100">fixedNonceAEAD</span><span class="op" id="4411114">)</span>&nbsp;<span class="ident" id="4411116">Open</span><span class="op" id="4411120">(</span><span class="ident" id="4411121">out</span><span class="op" id="4411124">,</span>&nbsp;<span class="ident" id="4411126">nonce</span><span class="op" id="4411131">,</span>&nbsp;<span class="ident" id="4411133">plaintext</span><span class="op" id="4411142">,</span>&nbsp;<span class="ident" id="4411144">additionalData</span>&nbsp;<span class="op" id="4411159">[</span><span class="op" id="4411160">]</span><span class="builtintype" id="4411161">byte</span><span class="op" id="4411165">)</span>&nbsp;<span class="op" id="4411167">(</span><span class="op" id="4411168">[</span><span class="op" id="4411169">]</span><span class="builtintype" id="4411170">byte</span><span class="op" id="4411174">,</span>&nbsp;<span class="builtintype" id="4411176">error</span><span class="op" id="4411181">)</span>&nbsp;<span class="op" id="4411183">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4411186">copy</span><span class="op" id="4411190">(</span><span class="ident" id="4411191">f</span><span class="op" id="4411192">.</span><span class="ident" id="4411193">openNonce</span><span class="op" id="4411202">[</span><span class="builtinfunc" id="4411203">len</span><span class="op" id="4411206">(</span><span class="ident" id="4411207">f</span><span class="op" id="4411208">.</span><span class="ident" id="4411209">openNonce</span><span class="op" id="4411218">)</span><span class="op" id="4411219">-</span><span class="num" id="4411220">8</span><span class="op" id="4411221">:</span><span class="op" id="4411222">]</span><span class="op" id="4411223">,</span>&nbsp;<span class="ident" id="4411225">nonce</span><span class="op" id="4411230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411233">return</span>&nbsp;<span class="ident" id="4411240">f</span><span class="op" id="4411241">.</span><span class="ident" id="4411242">aead</span><span class="op" id="4411246">.</span><span class="ident" id="4411247">Open</span><span class="op" id="4411251">(</span><span class="ident" id="4411252">out</span><span class="op" id="4411255">,</span>&nbsp;<span class="ident" id="4411257">f</span><span class="op" id="4411258">.</span><span class="ident" id="4411259">openNonce</span><span class="op" id="4411268">,</span>&nbsp;<span class="ident" id="4411270">plaintext</span><span class="op" id="4411279">,</span>&nbsp;<span class="ident" id="4411281">additionalData</span><span class="op" id="4411295">)</span><br>
<span class="lineno"></span><span class="op" id="4411297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4411300">func</span>&nbsp;<span class="ident" id="4411305">aeadAESGCM</span><span class="op" id="4411315">(</span><span class="ident" id="4411316">key</span><span class="op" id="4411319">,</span>&nbsp;<span class="ident" id="4411321">fixedNonce</span>&nbsp;<span class="op" id="4411332">[</span><span class="op" id="4411333">]</span><span class="builtintype" id="4411334">byte</span><span class="op" id="4411338">)</span>&nbsp;<span class="ident" id="4411340">cipher</span><span class="op" id="4411346">.</span><span class="ident" id="4411347">AEAD</span>&nbsp;<span class="op" id="4411352">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411355">aes</span><span class="op" id="4411358">,</span>&nbsp;<span class="ident" id="4411360">err</span>&nbsp;<span class="op" id="4411364">:=</span>&nbsp;<span class="ident" id="4411367">aes</span><span class="op" id="4411370">.</span><span class="ident" id="4411371">NewCipher</span><span class="op" id="4411380">(</span><span class="ident" id="4411381">key</span><span class="op" id="4411384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411387">if</span>&nbsp;<span class="ident" id="4411390">err</span>&nbsp;<span class="op" id="4411394">!=</span>&nbsp;<span class="ident" id="4411397">nil</span>&nbsp;<span class="op" id="4411401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4411405">panic</span><span class="op" id="4411410">(</span><span class="ident" id="4411411">err</span><span class="op" id="4411414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4411417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411420">aead</span><span class="op" id="4411424">,</span>&nbsp;<span class="ident" id="4411426">err</span>&nbsp;<span class="op" id="4411430">:=</span>&nbsp;<span class="ident" id="4411433">cipher</span><span class="op" id="4411439">.</span><span class="ident" id="4411440">NewGCM</span><span class="op" id="4411446">(</span><span class="ident" id="4411447">aes</span><span class="op" id="4411450">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411453">if</span>&nbsp;<span class="ident" id="4411456">err</span>&nbsp;<span class="op" id="4411460">!=</span>&nbsp;<span class="ident" id="4411463">nil</span>&nbsp;<span class="op" id="4411467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4411471">panic</span><span class="op" id="4411476">(</span><span class="ident" id="4411477">err</span><span class="op" id="4411480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4411483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411487">nonce1</span><span class="op" id="4411493">,</span>&nbsp;<span class="ident" id="4411495">nonce2</span>&nbsp;<span class="op" id="4411502">:=</span>&nbsp;<span class="builtinfunc" id="4411505">make</span><span class="op" id="4411509">(</span><span class="op" id="4411510">[</span><span class="op" id="4411511">]</span><span class="builtintype" id="4411512">byte</span><span class="op" id="4411516">,</span>&nbsp;<span class="num" id="4411518">12</span><span class="op" id="4411520">)</span><span class="op" id="4411521">,</span>&nbsp;<span class="builtinfunc" id="4411523">make</span><span class="op" id="4411527">(</span><span class="op" id="4411528">[</span><span class="op" id="4411529">]</span><span class="builtintype" id="4411530">byte</span><span class="op" id="4411534">,</span>&nbsp;<span class="num" id="4411536">12</span><span class="op" id="4411538">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4411541">copy</span><span class="op" id="4411545">(</span><span class="ident" id="4411546">nonce1</span><span class="op" id="4411552">,</span>&nbsp;<span class="ident" id="4411554">fixedNonce</span><span class="op" id="4411564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4411567">copy</span><span class="op" id="4411571">(</span><span class="ident" id="4411572">nonce2</span><span class="op" id="4411578">,</span>&nbsp;<span class="ident" id="4411580">fixedNonce</span><span class="op" id="4411590">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411594">return</span>&nbsp;<span class="op" id="4411601">&amp;</span><span class="ident" id="4411602">fixedNonceAEAD</span><span class="op" id="4411616">{</span><span class="ident" id="4411617">nonce1</span><span class="op" id="4411623">,</span>&nbsp;<span class="ident" id="4411625">nonce2</span><span class="op" id="4411631">,</span>&nbsp;<span class="ident" id="4411633">aead</span><span class="op" id="4411637">}</span><br>
<span class="lineno"></span><span class="op" id="4411639">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4411642">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4411703">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="4411781">type</span>&nbsp;<span class="ident" id="4411786">ssl30MAC</span>&nbsp;<span class="keyword" id="4411795">struct</span>&nbsp;<span class="op" id="4411802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411805">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4411809">hash</span><span class="op" id="4411813">.</span><span class="ident" id="4411814">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411820">key</span>&nbsp;<span class="op" id="4411824">[</span><span class="op" id="4411825">]</span><span class="builtintype" id="4411826">byte</span><br>
<span class="lineno"></span><span class="op" id="4411831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4411834">func</span>&nbsp;<span class="op" id="4411839">(</span><span class="ident" id="4411840">s</span>&nbsp;<span class="ident" id="4411842">ssl30MAC</span><span class="op" id="4411850">)</span>&nbsp;<span class="ident" id="4411852">Size</span><span class="op" id="4411856">(</span><span class="op" id="4411857">)</span>&nbsp;<span class="builtintype" id="4411859">int</span>&nbsp;<span class="op" id="4411863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411866">return</span>&nbsp;<span class="ident" id="4411873">s</span><span class="op" id="4411874">.</span><span class="ident" id="4411875">h</span><span class="op" id="4411876">.</span><span class="ident" id="4411877">Size</span><span class="op" id="4411881">(</span><span class="op" id="4411882">)</span><br>
<span class="lineno">175</span><span class="op" id="4411884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4411887">var</span>&nbsp;<span class="ident" id="4411891">ssl30Pad1</span>&nbsp;<span class="op" id="4411901">=</span>&nbsp;<span class="op" id="4411903">[</span><span class="num" id="4411904">48</span><span class="op" id="4411906">]</span><span class="builtintype" id="4411907">byte</span><span class="op" id="4411911">{</span><span class="num" id="4411912">0x36</span><span class="op" id="4411916">,</span>&nbsp;<span class="num" id="4411918">0x36</span><span class="op" id="4411922">,</span>&nbsp;<span class="num" id="4411924">0x36</span><span class="op" id="4411928">,</span>&nbsp;<span class="num" id="4411930">0x36</span><span class="op" id="4411934">,</span>&nbsp;<span class="num" id="4411936">0x36</span><span class="op" id="4411940">,</span>&nbsp;<span class="num" id="4411942">0x36</span><span class="op" id="4411946">,</span>&nbsp;<span class="num" id="4411948">0x36</span><span class="op" id="4411952">,</span>&nbsp;<span class="num" id="4411954">0x36</span><span class="op" id="4411958">,</span>&nbsp;<span class="num" id="4411960">0x36</span><span class="op" id="4411964">,</span>&nbsp;<span class="num" id="4411966">0x36</span><span class="op" id="4411970">,</span>&nbsp;<span class="num" id="4411972">0x36</span><span class="op" id="4411976">,</span>&nbsp;<span class="num" id="4411978">0x36</span><span class="op" id="4411982">,</span>&nbsp;<span class="num" id="4411984">0x36</span><span class="op" id="4411988">,</span>&nbsp;<span class="num" id="4411990">0x36</span><span class="op" id="4411994">,</span>&nbsp;<span class="num" id="4411996">0x36</span><span class="op" id="4412000">,</span>&nbsp;<span class="num" id="4412002">0x36</span><span class="op" id="4412006">,</span>&nbsp;<span class="num" id="4412008">0x36</span><span class="op" id="4412012">,</span>&nbsp;<span class="num" id="4412014">0x36</span><span class="op" id="4412018">,</span>&nbsp;<span class="num" id="4412020">0x36</span><span class="op" id="4412024">,</span>&nbsp;<span class="num" id="4412026">0x36</span><span class="op" id="4412030">,</span>&nbsp;<span class="num" id="4412032">0x36</span><span class="op" id="4412036">,</span>&nbsp;<span class="num" id="4412038">0x36</span><span class="op" id="4412042">,</span>&nbsp;<span class="num" id="4412044">0x36</span><span class="op" id="4412048">,</span>&nbsp;<span class="num" id="4412050">0x36</span><span class="op" id="4412054">,</span>&nbsp;<span class="num" id="4412056">0x36</span><span class="op" id="4412060">,</span>&nbsp;<span class="num" id="4412062">0x36</span><span class="op" id="4412066">,</span>&nbsp;<span class="num" id="4412068">0x36</span><span class="op" id="4412072">,</span>&nbsp;<span class="num" id="4412074">0x36</span><span class="op" id="4412078">,</span>&nbsp;<span class="num" id="4412080">0x36</span><span class="op" id="4412084">,</span>&nbsp;<span class="num" id="4412086">0x36</span><span class="op" id="4412090">,</span>&nbsp;<span class="num" id="4412092">0x36</span><span class="op" id="4412096">,</span>&nbsp;<span class="num" id="4412098">0x36</span><span class="op" id="4412102">,</span>&nbsp;<span class="num" id="4412104">0x36</span><span class="op" id="4412108">,</span>&nbsp;<span class="num" id="4412110">0x36</span><span class="op" id="4412114">,</span>&nbsp;<span class="num" id="4412116">0x36</span><span class="op" id="4412120">,</span>&nbsp;<span class="num" id="4412122">0x36</span><span class="op" id="4412126">,</span>&nbsp;<span class="num" id="4412128">0x36</span><span class="op" id="4412132">,</span>&nbsp;<span class="num" id="4412134">0x36</span><span class="op" id="4412138">,</span>&nbsp;<span class="num" id="4412140">0x36</span><span class="op" id="4412144">,</span>&nbsp;<span class="num" id="4412146">0x36</span><span class="op" id="4412150">,</span>&nbsp;<span class="num" id="4412152">0x36</span><span class="op" id="4412156">,</span>&nbsp;<span class="num" id="4412158">0x36</span><span class="op" id="4412162">,</span>&nbsp;<span class="num" id="4412164">0x36</span><span class="op" id="4412168">,</span>&nbsp;<span class="num" id="4412170">0x36</span><span class="op" id="4412174">,</span>&nbsp;<span class="num" id="4412176">0x36</span><span class="op" id="4412180">,</span>&nbsp;<span class="num" id="4412182">0x36</span><span class="op" id="4412186">,</span>&nbsp;<span class="num" id="4412188">0x36</span><span class="op" id="4412192">,</span>&nbsp;<span class="num" id="4412194">0x36</span><span class="op" id="4412198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412201">var</span>&nbsp;<span class="ident" id="4412205">ssl30Pad2</span>&nbsp;<span class="op" id="4412215">=</span>&nbsp;<span class="op" id="4412217">[</span><span class="num" id="4412218">48</span><span class="op" id="4412220">]</span><span class="builtintype" id="4412221">byte</span><span class="op" id="4412225">{</span><span class="num" id="4412226">0x5c</span><span class="op" id="4412230">,</span>&nbsp;<span class="num" id="4412232">0x5c</span><span class="op" id="4412236">,</span>&nbsp;<span class="num" id="4412238">0x5c</span><span class="op" id="4412242">,</span>&nbsp;<span class="num" id="4412244">0x5c</span><span class="op" id="4412248">,</span>&nbsp;<span class="num" id="4412250">0x5c</span><span class="op" id="4412254">,</span>&nbsp;<span class="num" id="4412256">0x5c</span><span class="op" id="4412260">,</span>&nbsp;<span class="num" id="4412262">0x5c</span><span class="op" id="4412266">,</span>&nbsp;<span class="num" id="4412268">0x5c</span><span class="op" id="4412272">,</span>&nbsp;<span class="num" id="4412274">0x5c</span><span class="op" id="4412278">,</span>&nbsp;<span class="num" id="4412280">0x5c</span><span class="op" id="4412284">,</span>&nbsp;<span class="num" id="4412286">0x5c</span><span class="op" id="4412290">,</span>&nbsp;<span class="num" id="4412292">0x5c</span><span class="op" id="4412296">,</span>&nbsp;<span class="num" id="4412298">0x5c</span><span class="op" id="4412302">,</span>&nbsp;<span class="num" id="4412304">0x5c</span><span class="op" id="4412308">,</span>&nbsp;<span class="num" id="4412310">0x5c</span><span class="op" id="4412314">,</span>&nbsp;<span class="num" id="4412316">0x5c</span><span class="op" id="4412320">,</span>&nbsp;<span class="num" id="4412322">0x5c</span><span class="op" id="4412326">,</span>&nbsp;<span class="num" id="4412328">0x5c</span><span class="op" id="4412332">,</span>&nbsp;<span class="num" id="4412334">0x5c</span><span class="op" id="4412338">,</span>&nbsp;<span class="num" id="4412340">0x5c</span><span class="op" id="4412344">,</span>&nbsp;<span class="num" id="4412346">0x5c</span><span class="op" id="4412350">,</span>&nbsp;<span class="num" id="4412352">0x5c</span><span class="op" id="4412356">,</span>&nbsp;<span class="num" id="4412358">0x5c</span><span class="op" id="4412362">,</span>&nbsp;<span class="num" id="4412364">0x5c</span><span class="op" id="4412368">,</span>&nbsp;<span class="num" id="4412370">0x5c</span><span class="op" id="4412374">,</span>&nbsp;<span class="num" id="4412376">0x5c</span><span class="op" id="4412380">,</span>&nbsp;<span class="num" id="4412382">0x5c</span><span class="op" id="4412386">,</span>&nbsp;<span class="num" id="4412388">0x5c</span><span class="op" id="4412392">,</span>&nbsp;<span class="num" id="4412394">0x5c</span><span class="op" id="4412398">,</span>&nbsp;<span class="num" id="4412400">0x5c</span><span class="op" id="4412404">,</span>&nbsp;<span class="num" id="4412406">0x5c</span><span class="op" id="4412410">,</span>&nbsp;<span class="num" id="4412412">0x5c</span><span class="op" id="4412416">,</span>&nbsp;<span class="num" id="4412418">0x5c</span><span class="op" id="4412422">,</span>&nbsp;<span class="num" id="4412424">0x5c</span><span class="op" id="4412428">,</span>&nbsp;<span class="num" id="4412430">0x5c</span><span class="op" id="4412434">,</span>&nbsp;<span class="num" id="4412436">0x5c</span><span class="op" id="4412440">,</span>&nbsp;<span class="num" id="4412442">0x5c</span><span class="op" id="4412446">,</span>&nbsp;<span class="num" id="4412448">0x5c</span><span class="op" id="4412452">,</span>&nbsp;<span class="num" id="4412454">0x5c</span><span class="op" id="4412458">,</span>&nbsp;<span class="num" id="4412460">0x5c</span><span class="op" id="4412464">,</span>&nbsp;<span class="num" id="4412466">0x5c</span><span class="op" id="4412470">,</span>&nbsp;<span class="num" id="4412472">0x5c</span><span class="op" id="4412476">,</span>&nbsp;<span class="num" id="4412478">0x5c</span><span class="op" id="4412482">,</span>&nbsp;<span class="num" id="4412484">0x5c</span><span class="op" id="4412488">,</span>&nbsp;<span class="num" id="4412490">0x5c</span><span class="op" id="4412494">,</span>&nbsp;<span class="num" id="4412496">0x5c</span><span class="op" id="4412500">,</span>&nbsp;<span class="num" id="4412502">0x5c</span><span class="op" id="4412506">,</span>&nbsp;<span class="num" id="4412508">0x5c</span><span class="op" id="4412512">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4412515">func</span>&nbsp;<span class="op" id="4412520">(</span><span class="ident" id="4412521">s</span>&nbsp;<span class="ident" id="4412523">ssl30MAC</span><span class="op" id="4412531">)</span>&nbsp;<span class="ident" id="4412533">MAC</span><span class="op" id="4412536">(</span><span class="ident" id="4412537">digestBuf</span><span class="op" id="4412546">,</span>&nbsp;<span class="ident" id="4412548">seq</span><span class="op" id="4412551">,</span>&nbsp;<span class="ident" id="4412553">header</span><span class="op" id="4412559">,</span>&nbsp;<span class="ident" id="4412561">data</span>&nbsp;<span class="op" id="4412566">[</span><span class="op" id="4412567">]</span><span class="builtintype" id="4412568">byte</span><span class="op" id="4412572">)</span>&nbsp;<span class="op" id="4412574">[</span><span class="op" id="4412575">]</span><span class="builtintype" id="4412576">byte</span>&nbsp;<span class="op" id="4412581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412584">padLength</span>&nbsp;<span class="op" id="4412594">:=</span>&nbsp;<span class="num" id="4412597">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412601">if</span>&nbsp;<span class="ident" id="4412604">s</span><span class="op" id="4412605">.</span><span class="ident" id="4412606">h</span><span class="op" id="4412607">.</span><span class="ident" id="4412608">Size</span><span class="op" id="4412612">(</span><span class="op" id="4412613">)</span>&nbsp;<span class="op" id="4412615">==</span>&nbsp;<span class="num" id="4412618">20</span>&nbsp;<span class="op" id="4412621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412625">padLength</span>&nbsp;<span class="op" id="4412635">=</span>&nbsp;<span class="num" id="4412637">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412645">s</span><span class="op" id="4412646">.</span><span class="ident" id="4412647">h</span><span class="op" id="4412648">.</span><span class="ident" id="4412649">Reset</span><span class="op" id="4412654">(</span><span class="op" id="4412655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412658">s</span><span class="op" id="4412659">.</span><span class="ident" id="4412660">h</span><span class="op" id="4412661">.</span><span class="ident" id="4412662">Write</span><span class="op" id="4412667">(</span><span class="ident" id="4412668">s</span><span class="op" id="4412669">.</span><span class="ident" id="4412670">key</span><span class="op" id="4412673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412676">s</span><span class="op" id="4412677">.</span><span class="ident" id="4412678">h</span><span class="op" id="4412679">.</span><span class="ident" id="4412680">Write</span><span class="op" id="4412685">(</span><span class="ident" id="4412686">ssl30Pad1</span><span class="op" id="4412695">[</span><span class="op" id="4412696">:</span><span class="ident" id="4412697">padLength</span><span class="op" id="4412706">]</span><span class="op" id="4412707">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412710">s</span><span class="op" id="4412711">.</span><span class="ident" id="4412712">h</span><span class="op" id="4412713">.</span><span class="ident" id="4412714">Write</span><span class="op" id="4412719">(</span><span class="ident" id="4412720">seq</span><span class="op" id="4412723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412726">s</span><span class="op" id="4412727">.</span><span class="ident" id="4412728">h</span><span class="op" id="4412729">.</span><span class="ident" id="4412730">Write</span><span class="op" id="4412735">(</span><span class="ident" id="4412736">header</span><span class="op" id="4412742">[</span><span class="op" id="4412743">:</span><span class="num" id="4412744">1</span><span class="op" id="4412745">]</span><span class="op" id="4412746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412749">s</span><span class="op" id="4412750">.</span><span class="ident" id="4412751">h</span><span class="op" id="4412752">.</span><span class="ident" id="4412753">Write</span><span class="op" id="4412758">(</span><span class="ident" id="4412759">header</span><span class="op" id="4412765">[</span><span class="num" id="4412766">3</span><span class="op" id="4412767">:</span><span class="num" id="4412768">5</span><span class="op" id="4412769">]</span><span class="op" id="4412770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412773">s</span><span class="op" id="4412774">.</span><span class="ident" id="4412775">h</span><span class="op" id="4412776">.</span><span class="ident" id="4412777">Write</span><span class="op" id="4412782">(</span><span class="ident" id="4412783">data</span><span class="op" id="4412787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412790">digestBuf</span>&nbsp;<span class="op" id="4412800">=</span>&nbsp;<span class="ident" id="4412802">s</span><span class="op" id="4412803">.</span><span class="ident" id="4412804">h</span><span class="op" id="4412805">.</span><span class="ident" id="4412806">Sum</span><span class="op" id="4412809">(</span><span class="ident" id="4412810">digestBuf</span><span class="op" id="4412819">[</span><span class="op" id="4412820">:</span><span class="num" id="4412821">0</span><span class="op" id="4412822">]</span><span class="op" id="4412823">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412827">s</span><span class="op" id="4412828">.</span><span class="ident" id="4412829">h</span><span class="op" id="4412830">.</span><span class="ident" id="4412831">Reset</span><span class="op" id="4412836">(</span><span class="op" id="4412837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412840">s</span><span class="op" id="4412841">.</span><span class="ident" id="4412842">h</span><span class="op" id="4412843">.</span><span class="ident" id="4412844">Write</span><span class="op" id="4412849">(</span><span class="ident" id="4412850">s</span><span class="op" id="4412851">.</span><span class="ident" id="4412852">key</span><span class="op" id="4412855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412858">s</span><span class="op" id="4412859">.</span><span class="ident" id="4412860">h</span><span class="op" id="4412861">.</span><span class="ident" id="4412862">Write</span><span class="op" id="4412867">(</span><span class="ident" id="4412868">ssl30Pad2</span><span class="op" id="4412877">[</span><span class="op" id="4412878">:</span><span class="ident" id="4412879">padLength</span><span class="op" id="4412888">]</span><span class="op" id="4412889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412892">s</span><span class="op" id="4412893">.</span><span class="ident" id="4412894">h</span><span class="op" id="4412895">.</span><span class="ident" id="4412896">Write</span><span class="op" id="4412901">(</span><span class="ident" id="4412902">digestBuf</span><span class="op" id="4412911">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412914">return</span>&nbsp;<span class="ident" id="4412921">s</span><span class="op" id="4412922">.</span><span class="ident" id="4412923">h</span><span class="op" id="4412924">.</span><span class="ident" id="4412925">Sum</span><span class="op" id="4412928">(</span><span class="ident" id="4412929">digestBuf</span><span class="op" id="4412938">[</span><span class="op" id="4412939">:</span><span class="num" id="4412940">0</span><span class="op" id="4412941">]</span><span class="op" id="4412942">)</span><br>
<span class="lineno"></span><span class="op" id="4412944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4412947">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4413021">type</span>&nbsp;<span class="ident" id="4413026">tls10MAC</span>&nbsp;<span class="keyword" id="4413035">struct</span>&nbsp;<span class="op" id="4413042">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413045">h</span>&nbsp;<span class="ident" id="4413047">hash</span><span class="op" id="4413051">.</span><span class="ident" id="4413052">Hash</span><br>
<span class="lineno"></span><span class="op" id="4413057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4413060">func</span>&nbsp;<span class="op" id="4413065">(</span><span class="ident" id="4413066">s</span>&nbsp;<span class="ident" id="4413068">tls10MAC</span><span class="op" id="4413076">)</span>&nbsp;<span class="ident" id="4413078">Size</span><span class="op" id="4413082">(</span><span class="op" id="4413083">)</span>&nbsp;<span class="builtintype" id="4413085">int</span>&nbsp;<span class="op" id="4413089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413092">return</span>&nbsp;<span class="ident" id="4413099">s</span><span class="op" id="4413100">.</span><span class="ident" id="4413101">h</span><span class="op" id="4413102">.</span><span class="ident" id="4413103">Size</span><span class="op" id="4413107">(</span><span class="op" id="4413108">)</span><br>
<span class="lineno">210</span><span class="op" id="4413110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4413113">func</span>&nbsp;<span class="op" id="4413118">(</span><span class="ident" id="4413119">s</span>&nbsp;<span class="ident" id="4413121">tls10MAC</span><span class="op" id="4413129">)</span>&nbsp;<span class="ident" id="4413131">MAC</span><span class="op" id="4413134">(</span><span class="ident" id="4413135">digestBuf</span><span class="op" id="4413144">,</span>&nbsp;<span class="ident" id="4413146">seq</span><span class="op" id="4413149">,</span>&nbsp;<span class="ident" id="4413151">header</span><span class="op" id="4413157">,</span>&nbsp;<span class="ident" id="4413159">data</span>&nbsp;<span class="op" id="4413164">[</span><span class="op" id="4413165">]</span><span class="builtintype" id="4413166">byte</span><span class="op" id="4413170">)</span>&nbsp;<span class="op" id="4413172">[</span><span class="op" id="4413173">]</span><span class="builtintype" id="4413174">byte</span>&nbsp;<span class="op" id="4413179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413182">s</span><span class="op" id="4413183">.</span><span class="ident" id="4413184">h</span><span class="op" id="4413185">.</span><span class="ident" id="4413186">Reset</span><span class="op" id="4413191">(</span><span class="op" id="4413192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413195">s</span><span class="op" id="4413196">.</span><span class="ident" id="4413197">h</span><span class="op" id="4413198">.</span><span class="ident" id="4413199">Write</span><span class="op" id="4413204">(</span><span class="ident" id="4413205">seq</span><span class="op" id="4413208">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413211">s</span><span class="op" id="4413212">.</span><span class="ident" id="4413213">h</span><span class="op" id="4413214">.</span><span class="ident" id="4413215">Write</span><span class="op" id="4413220">(</span><span class="ident" id="4413221">header</span><span class="op" id="4413227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413230">s</span><span class="op" id="4413231">.</span><span class="ident" id="4413232">h</span><span class="op" id="4413233">.</span><span class="ident" id="4413234">Write</span><span class="op" id="4413239">(</span><span class="ident" id="4413240">data</span><span class="op" id="4413244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413247">return</span>&nbsp;<span class="ident" id="4413254">s</span><span class="op" id="4413255">.</span><span class="ident" id="4413256">h</span><span class="op" id="4413257">.</span><span class="ident" id="4413258">Sum</span><span class="op" id="4413261">(</span><span class="ident" id="4413262">digestBuf</span><span class="op" id="4413271">[</span><span class="op" id="4413272">:</span><span class="num" id="4413273">0</span><span class="op" id="4413274">]</span><span class="op" id="4413275">)</span><br>
<span class="lineno"></span><span class="op" id="4413277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4413280">func</span>&nbsp;<span class="ident" id="4413285">rsaKA</span><span class="op" id="4413290">(</span><span class="ident" id="4413291">version</span>&nbsp;<span class="builtintype" id="4413299">uint16</span><span class="op" id="4413305">)</span>&nbsp;<span class="ident" id="4413307">keyAgreement</span>&nbsp;<span class="op" id="4413320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413323">return</span>&nbsp;<span class="ident" id="4413330">rsaKeyAgreement</span><span class="op" id="4413345">{</span><span class="op" id="4413346">}</span><br>
<span class="lineno"></span><span class="op" id="4413348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4413351">func</span>&nbsp;<span class="ident" id="4413356">ecdheECDSAKA</span><span class="op" id="4413368">(</span><span class="ident" id="4413369">version</span>&nbsp;<span class="builtintype" id="4413377">uint16</span><span class="op" id="4413383">)</span>&nbsp;<span class="ident" id="4413385">keyAgreement</span>&nbsp;<span class="op" id="4413398">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413401">return</span>&nbsp;<span class="op" id="4413408">&amp;</span><span class="ident" id="4413409">ecdheKeyAgreement</span><span class="op" id="4413426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413430">sigType</span><span class="op" id="4413437">:</span>&nbsp;<span class="ident" id="4413439">signatureECDSA</span><span class="op" id="4413453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413457">version</span><span class="op" id="4413464">:</span>&nbsp;<span class="ident" id="4413466">version</span><span class="op" id="4413473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413476">}</span><br>
<span class="lineno"></span><span class="op" id="4413478">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4413481">func</span>&nbsp;<span class="ident" id="4413486">ecdheRSAKA</span><span class="op" id="4413496">(</span><span class="ident" id="4413497">version</span>&nbsp;<span class="builtintype" id="4413505">uint16</span><span class="op" id="4413511">)</span>&nbsp;<span class="ident" id="4413513">keyAgreement</span>&nbsp;<span class="op" id="4413526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413529">return</span>&nbsp;<span class="op" id="4413536">&amp;</span><span class="ident" id="4413537">ecdheKeyAgreement</span><span class="op" id="4413554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413558">sigType</span><span class="op" id="4413565">:</span>&nbsp;<span class="ident" id="4413567">signatureRSA</span><span class="op" id="4413579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413583">version</span><span class="op" id="4413590">:</span>&nbsp;<span class="ident" id="4413592">version</span><span class="op" id="4413599">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413602">}</span><br>
<span class="lineno"></span><span class="op" id="4413604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4413607">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="4413676">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="4413726">func</span>&nbsp;<span class="ident" id="4413731">mutualCipherSuite</span><span class="op" id="4413748">(</span><span class="ident" id="4413749">have</span>&nbsp;<span class="op" id="4413754">[</span><span class="op" id="4413755">]</span><span class="builtintype" id="4413756">uint16</span><span class="op" id="4413762">,</span>&nbsp;<span class="ident" id="4413764">want</span>&nbsp;<span class="builtintype" id="4413769">uint16</span><span class="op" id="4413775">)</span>&nbsp;<span class="op" id="4413777">*</span><span class="ident" id="4413778">cipherSuite</span>&nbsp;<span class="op" id="4413790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413793">for</span>&nbsp;<span class="ident" id="4413797">_</span><span class="op" id="4413798">,</span>&nbsp;<span class="ident" id="4413800">id</span>&nbsp;<span class="op" id="4413803">:=</span>&nbsp;<span class="keyword" id="4413806">range</span>&nbsp;<span class="ident" id="4413812">have</span>&nbsp;<span class="op" id="4413817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413821">if</span>&nbsp;<span class="ident" id="4413824">id</span>&nbsp;<span class="op" id="4413827">==</span>&nbsp;<span class="ident" id="4413830">want</span>&nbsp;<span class="op" id="4413835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413840">for</span>&nbsp;<span class="ident" id="4413844">_</span><span class="op" id="4413845">,</span>&nbsp;<span class="ident" id="4413847">suite</span>&nbsp;<span class="op" id="4413853">:=</span>&nbsp;<span class="keyword" id="4413856">range</span>&nbsp;<span class="ident" id="4413862">cipherSuites</span>&nbsp;<span class="op" id="4413875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413881">if</span>&nbsp;<span class="ident" id="4413884">suite</span><span class="op" id="4413889">.</span><span class="ident" id="4413890">id</span>&nbsp;<span class="op" id="4413893">==</span>&nbsp;<span class="ident" id="4413896">want</span>&nbsp;<span class="op" id="4413901">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413908">return</span>&nbsp;<span class="ident" id="4413915">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413935">return</span>&nbsp;<span class="ident" id="4413942">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413948">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413954">return</span>&nbsp;<span class="ident" id="4413961">nil</span><br>
<span class="lineno"></span><span class="op" id="4413965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4413968">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="4414023">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="4414092">const</span>&nbsp;<span class="op" id="4414098">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414101">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414141">uint16</span>&nbsp;<span class="op" id="4414148">=</span>&nbsp;<span class="num" id="4414150">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414158">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414198">uint16</span>&nbsp;<span class="op" id="4414205">=</span>&nbsp;<span class="num" id="4414207">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414215">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414255">uint16</span>&nbsp;<span class="op" id="4414262">=</span>&nbsp;<span class="num" id="4414264">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414272">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414312">uint16</span>&nbsp;<span class="op" id="4414319">=</span>&nbsp;<span class="num" id="4414321">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414329">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414369">uint16</span>&nbsp;<span class="op" id="4414376">=</span>&nbsp;<span class="num" id="4414378">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414386">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414426">uint16</span>&nbsp;<span class="op" id="4414433">=</span>&nbsp;<span class="num" id="4414435">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414443">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414483">uint16</span>&nbsp;<span class="op" id="4414490">=</span>&nbsp;<span class="num" id="4414492">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414500">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414540">uint16</span>&nbsp;<span class="op" id="4414547">=</span>&nbsp;<span class="num" id="4414549">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414557">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414597">uint16</span>&nbsp;<span class="op" id="4414604">=</span>&nbsp;<span class="num" id="4414606">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414614">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414654">uint16</span>&nbsp;<span class="op" id="4414661">=</span>&nbsp;<span class="num" id="4414663">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414671">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414711">uint16</span>&nbsp;<span class="op" id="4414718">=</span>&nbsp;<span class="num" id="4414720">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414728">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4414768">uint16</span>&nbsp;<span class="op" id="4414775">=</span>&nbsp;<span class="num" id="4414777">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414785">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="4414825">uint16</span>&nbsp;<span class="op" id="4414832">=</span>&nbsp;<span class="num" id="4414834">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4414843">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4414912">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4414963">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415029">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="4415047">uint16</span>&nbsp;<span class="op" id="4415054">=</span>&nbsp;<span class="num" id="4415056">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="4415063">)</span>
</div>
</body>
</html>
