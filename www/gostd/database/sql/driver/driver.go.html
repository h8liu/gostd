<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>database/sql/driver</h2>
<ul>
<li><a href="/gostd/database/sql/driver/driver.go.html">driver.go</a></li>
<li><a href="/gostd/database/sql/driver/types.go.html">types.go</a></li>
<li><a href="/gostd/database/sql/driver/types_test.go.html">types_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5116490">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5116545">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5116599">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5116650">//&nbsp;Package&nbsp;driver&nbsp;defines&nbsp;interfaces&nbsp;to&nbsp;be&nbsp;implemented&nbsp;by&nbsp;database</span><br>
<span class="lineno"></span><span class="comment" id="5116717">//&nbsp;drivers&nbsp;as&nbsp;used&nbsp;by&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="comment" id="5116752">//</span><br>
<span class="lineno"></span><span class="comment" id="5116755">//&nbsp;Most&nbsp;code&nbsp;should&nbsp;use&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="keyword" id="5116792">package</span>&nbsp;<span class="ident" id="5116800">driver</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5116808">import</span>&nbsp;<span class="string" id="5116815">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5116825">//&nbsp;Value&nbsp;is&nbsp;a&nbsp;value&nbsp;that&nbsp;drivers&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.</span><br>
<span class="lineno"></span><span class="comment" id="5116882">//&nbsp;It&nbsp;is&nbsp;either&nbsp;nil&nbsp;or&nbsp;an&nbsp;instance&nbsp;of&nbsp;one&nbsp;of&nbsp;these&nbsp;types:</span><br>
<span class="lineno">15</span><span class="comment" id="5116940">//</span><br>
<span class="lineno"></span><span class="comment" id="5116943">//&nbsp;&nbsp;&nbsp;int64</span><br>
<span class="lineno"></span><span class="comment" id="5116954">//&nbsp;&nbsp;&nbsp;float64</span><br>
<span class="lineno"></span><span class="comment" id="5116967">//&nbsp;&nbsp;&nbsp;bool</span><br>
<span class="lineno"></span><span class="comment" id="5116977">//&nbsp;&nbsp;&nbsp;[]byte</span><br>
<span class="lineno">20</span><span class="comment" id="5116989">//&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;[*]&nbsp;everywhere&nbsp;except&nbsp;from&nbsp;Rows.Next.</span><br>
<span class="lineno"></span><span class="comment" id="5117041">//&nbsp;&nbsp;&nbsp;time.Time</span><br>
<span class="lineno"></span><span class="keyword" id="5117056">type</span>&nbsp;<span class="ident" id="5117061">Value</span>&nbsp;<span class="keyword" id="5117067">interface</span><span class="op" id="5117076">{</span><span class="op" id="5117077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5117080">//&nbsp;Driver&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;must&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;database</span><br>
<span class="lineno">25</span><span class="comment" id="5117146">//&nbsp;driver.</span><br>
<span class="lineno"></span><span class="keyword" id="5117157">type</span>&nbsp;<span class="ident" id="5117162">Driver</span>&nbsp;<span class="keyword" id="5117169">interface</span>&nbsp;<span class="op" id="5117179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5117182">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;the&nbsp;database.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5117233">//&nbsp;The&nbsp;name&nbsp;is&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;driver-specific&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5117287">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5117291">//&nbsp;Open&nbsp;may&nbsp;return&nbsp;a&nbsp;cached&nbsp;connection&nbsp;(one&nbsp;previously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5117347">//&nbsp;closed),&nbsp;but&nbsp;doing&nbsp;so&nbsp;is&nbsp;unnecessary;&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5117405">//&nbsp;maintains&nbsp;a&nbsp;pool&nbsp;of&nbsp;idle&nbsp;connections&nbsp;for&nbsp;efficient&nbsp;re-use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5117468">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5117472">//&nbsp;The&nbsp;returned&nbsp;connection&nbsp;is&nbsp;only&nbsp;used&nbsp;by&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5117535">//&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117545">Open</span><span class="op" id="5117549">(</span><span class="ident" id="5117550">name</span>&nbsp;<span class="builtintype" id="5117555">string</span><span class="op" id="5117561">)</span>&nbsp;<span class="op" id="5117563">(</span><span class="ident" id="5117564">Conn</span><span class="op" id="5117568">,</span>&nbsp;<span class="builtintype" id="5117570">error</span><span class="op" id="5117575">)</span><br>
<span class="lineno"></span><span class="op" id="5117577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5117580">//&nbsp;ErrSkip&nbsp;may&nbsp;be&nbsp;returned&nbsp;by&nbsp;some&nbsp;optional&nbsp;interfaces&#39;&nbsp;methods&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="5117647">//&nbsp;indicate&nbsp;at&nbsp;runtime&nbsp;that&nbsp;the&nbsp;fast&nbsp;path&nbsp;is&nbsp;unavailable&nbsp;and&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5117716">//&nbsp;package&nbsp;should&nbsp;continue&nbsp;as&nbsp;if&nbsp;the&nbsp;optional&nbsp;interface&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5117780">//&nbsp;implemented.&nbsp;ErrSkip&nbsp;is&nbsp;only&nbsp;supported&nbsp;where&nbsp;explicitly</span><br>
<span class="lineno"></span><span class="comment" id="5117839">//&nbsp;documented.</span><br>
<span class="lineno"></span><span class="keyword" id="5117854">var</span>&nbsp;<span class="ident" id="5117858">ErrSkip</span>&nbsp;<span class="op" id="5117866">=</span>&nbsp;<span class="ident" id="5117868">errors</span><span class="op" id="5117874">.</span><span class="ident" id="5117875">New</span><span class="op" id="5117878">(</span><span class="string" id="5117879">&#34;driver:&nbsp;skip&nbsp;fast-path;&nbsp;continue&nbsp;as&nbsp;if&nbsp;unimplemented&#34;</span><span class="op" id="5117933">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5117936">//&nbsp;ErrBadConn&nbsp;should&nbsp;be&nbsp;returned&nbsp;by&nbsp;a&nbsp;driver&nbsp;to&nbsp;signal&nbsp;to&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5118002">//&nbsp;package&nbsp;that&nbsp;a&nbsp;driver.Conn&nbsp;is&nbsp;in&nbsp;a&nbsp;bad&nbsp;state&nbsp;(such&nbsp;as&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="5118070">//&nbsp;having&nbsp;earlier&nbsp;closed&nbsp;the&nbsp;connection)&nbsp;and&nbsp;the&nbsp;sql&nbsp;package&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="5118138">//&nbsp;retry&nbsp;on&nbsp;a&nbsp;new&nbsp;connection.</span><br>
<span class="lineno">50</span><span class="comment" id="5118168">//</span><br>
<span class="lineno"></span><span class="comment" id="5118171">//&nbsp;To&nbsp;prevent&nbsp;duplicate&nbsp;operations,&nbsp;ErrBadConn&nbsp;should&nbsp;NOT&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="5118241">//&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;possibility&nbsp;that&nbsp;the&nbsp;database&nbsp;server&nbsp;might&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="5118305">//&nbsp;performed&nbsp;the&nbsp;operation.&nbsp;Even&nbsp;if&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5118373">//&nbsp;you&nbsp;shouldn&#39;t&nbsp;return&nbsp;ErrBadConn.</span><br>
<span class="lineno">55</span><span class="keyword" id="5118409">var</span>&nbsp;<span class="ident" id="5118413">ErrBadConn</span>&nbsp;<span class="op" id="5118424">=</span>&nbsp;<span class="ident" id="5118426">errors</span><span class="op" id="5118432">.</span><span class="ident" id="5118433">New</span><span class="op" id="5118436">(</span><span class="string" id="5118437">&#34;driver:&nbsp;bad&nbsp;connection&#34;</span><span class="op" id="5118461">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5118464">//&nbsp;Execer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5118534">//</span><br>
<span class="lineno"></span><span class="comment" id="5118537">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Execer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Exec&nbsp;will</span><br>
<span class="lineno">60</span><span class="comment" id="5118608">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5118676">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5118690">//</span><br>
<span class="lineno"></span><span class="comment" id="5118693">//&nbsp;Exec&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno"></span><span class="keyword" id="5118721">type</span>&nbsp;<span class="ident" id="5118726">Execer</span>&nbsp;<span class="keyword" id="5118733">interface</span>&nbsp;<span class="op" id="5118743">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118746">Exec</span><span class="op" id="5118750">(</span><span class="ident" id="5118751">query</span>&nbsp;<span class="builtintype" id="5118757">string</span><span class="op" id="5118763">,</span>&nbsp;<span class="ident" id="5118765">args</span>&nbsp;<span class="op" id="5118770">[</span><span class="op" id="5118771">]</span><span class="ident" id="5118772">Value</span><span class="op" id="5118777">)</span>&nbsp;<span class="op" id="5118779">(</span><span class="ident" id="5118780">Result</span><span class="op" id="5118786">,</span>&nbsp;<span class="builtintype" id="5118788">error</span><span class="op" id="5118793">)</span><br>
<span class="lineno"></span><span class="op" id="5118795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5118798">//&nbsp;Queryer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5118869">//</span><br>
<span class="lineno">70</span><span class="comment" id="5118872">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Queryer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Query&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5118945">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5119013">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5119027">//</span><br>
<span class="lineno"></span><span class="comment" id="5119030">//&nbsp;Query&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno">75</span><span class="keyword" id="5119059">type</span>&nbsp;<span class="ident" id="5119064">Queryer</span>&nbsp;<span class="keyword" id="5119072">interface</span>&nbsp;<span class="op" id="5119082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119085">Query</span><span class="op" id="5119090">(</span><span class="ident" id="5119091">query</span>&nbsp;<span class="builtintype" id="5119097">string</span><span class="op" id="5119103">,</span>&nbsp;<span class="ident" id="5119105">args</span>&nbsp;<span class="op" id="5119110">[</span><span class="op" id="5119111">]</span><span class="ident" id="5119112">Value</span><span class="op" id="5119117">)</span>&nbsp;<span class="op" id="5119119">(</span><span class="ident" id="5119120">Rows</span><span class="op" id="5119124">,</span>&nbsp;<span class="builtintype" id="5119126">error</span><span class="op" id="5119131">)</span><br>
<span class="lineno"></span><span class="op" id="5119133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5119136">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;connection&nbsp;to&nbsp;a&nbsp;database.&nbsp;It&nbsp;is&nbsp;not&nbsp;used&nbsp;concurrently</span><br>
<span class="lineno">80</span><span class="comment" id="5119203">//&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="5119230">//</span><br>
<span class="lineno"></span><span class="comment" id="5119233">//&nbsp;Conn&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;stateful.</span><br>
<span class="lineno"></span><span class="keyword" id="5119268">type</span>&nbsp;<span class="ident" id="5119273">Conn</span>&nbsp;<span class="keyword" id="5119278">interface</span>&nbsp;<span class="op" id="5119288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119291">//&nbsp;Prepare&nbsp;returns&nbsp;a&nbsp;prepared&nbsp;statement,&nbsp;bound&nbsp;to&nbsp;this&nbsp;connection.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119359">Prepare</span><span class="op" id="5119366">(</span><span class="ident" id="5119367">query</span>&nbsp;<span class="builtintype" id="5119373">string</span><span class="op" id="5119379">)</span>&nbsp;<span class="op" id="5119381">(</span><span class="ident" id="5119382">Stmt</span><span class="op" id="5119386">,</span>&nbsp;<span class="builtintype" id="5119388">error</span><span class="op" id="5119393">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119397">//&nbsp;Close&nbsp;invalidates&nbsp;and&nbsp;potentially&nbsp;stops&nbsp;any&nbsp;current</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119453">//&nbsp;prepared&nbsp;statements&nbsp;and&nbsp;transactions,&nbsp;marking&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119508">//&nbsp;connection&nbsp;as&nbsp;no&nbsp;longer&nbsp;in&nbsp;use.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119544">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119548">//&nbsp;Because&nbsp;the&nbsp;sql&nbsp;package&nbsp;maintains&nbsp;a&nbsp;free&nbsp;pool&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119601">//&nbsp;connections&nbsp;and&nbsp;only&nbsp;calls&nbsp;Close&nbsp;when&nbsp;there&#39;s&nbsp;a&nbsp;surplus&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119664">//&nbsp;idle&nbsp;connections,&nbsp;it&nbsp;shouldn&#39;t&nbsp;be&nbsp;necessary&nbsp;for&nbsp;drivers&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119727">//&nbsp;do&nbsp;their&nbsp;own&nbsp;connection&nbsp;caching.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119764">Close</span><span class="op" id="5119769">(</span><span class="op" id="5119770">)</span>&nbsp;<span class="builtintype" id="5119772">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119780">//&nbsp;Begin&nbsp;starts&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;transaction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119828">Begin</span><span class="op" id="5119833">(</span><span class="op" id="5119834">)</span>&nbsp;<span class="op" id="5119836">(</span><span class="ident" id="5119837">Tx</span><span class="op" id="5119839">,</span>&nbsp;<span class="builtintype" id="5119841">error</span><span class="op" id="5119846">)</span><br>
<span class="lineno"></span><span class="op" id="5119848">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5119851">//&nbsp;Result&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;query&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="5119897">type</span>&nbsp;<span class="ident" id="5119902">Result</span>&nbsp;<span class="keyword" id="5119909">interface</span>&nbsp;<span class="op" id="5119919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119922">//&nbsp;LastInsertId&nbsp;returns&nbsp;the&nbsp;database&#39;s&nbsp;auto-generated&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119980">//&nbsp;after,&nbsp;for&nbsp;example,&nbsp;an&nbsp;INSERT&nbsp;into&nbsp;a&nbsp;table&nbsp;with&nbsp;primary</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120040">//&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120049">LastInsertId</span><span class="op" id="5120061">(</span><span class="op" id="5120062">)</span>&nbsp;<span class="op" id="5120064">(</span><span class="ident" id="5120065">int64</span><span class="op" id="5120070">,</span>&nbsp;<span class="builtintype" id="5120072">error</span><span class="op" id="5120077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120081">//&nbsp;RowsAffected&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;affected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120141">//&nbsp;query.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120152">RowsAffected</span><span class="op" id="5120164">(</span><span class="op" id="5120165">)</span>&nbsp;<span class="op" id="5120167">(</span><span class="ident" id="5120168">int64</span><span class="op" id="5120173">,</span>&nbsp;<span class="builtintype" id="5120175">error</span><span class="op" id="5120180">)</span><br>
<span class="lineno"></span><span class="op" id="5120182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5120185">//&nbsp;Stmt&nbsp;is&nbsp;a&nbsp;prepared&nbsp;statement.&nbsp;It&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;Conn&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5120248">//&nbsp;used&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;concurrently.</span><br>
<span class="lineno">115</span><span class="keyword" id="5120293">type</span>&nbsp;<span class="ident" id="5120298">Stmt</span>&nbsp;<span class="keyword" id="5120303">interface</span>&nbsp;<span class="op" id="5120313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120316">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120348">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120352">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.1,&nbsp;a&nbsp;Stmt&nbsp;will&nbsp;not&nbsp;be&nbsp;closed&nbsp;if&nbsp;it&#39;s&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120411">//&nbsp;by&nbsp;any&nbsp;queries.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120431">Close</span><span class="op" id="5120436">(</span><span class="op" id="5120437">)</span>&nbsp;<span class="builtintype" id="5120439">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120447">//&nbsp;NumInput&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;placeholder&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120506">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120510">//&nbsp;If&nbsp;NumInput&nbsp;returns&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;sql&nbsp;package&nbsp;will&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120574">//&nbsp;argument&nbsp;counts&nbsp;from&nbsp;callers&nbsp;and&nbsp;return&nbsp;errors&nbsp;to&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120639">//&nbsp;before&nbsp;the&nbsp;statement&#39;s&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120700">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120704">//&nbsp;NumInput&nbsp;may&nbsp;also&nbsp;return&nbsp;-1,&nbsp;if&nbsp;the&nbsp;driver&nbsp;doesn&#39;t&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120764">//&nbsp;its&nbsp;number&nbsp;of&nbsp;placeholders.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120826">//&nbsp;will&nbsp;not&nbsp;sanity&nbsp;check&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;argument&nbsp;counts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120883">NumInput</span><span class="op" id="5120891">(</span><span class="op" id="5120892">)</span>&nbsp;<span class="builtintype" id="5120894">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120900">//&nbsp;Exec&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;doesn&#39;t&nbsp;return&nbsp;rows,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120957">//&nbsp;as&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120985">Exec</span><span class="op" id="5120989">(</span><span class="ident" id="5120990">args</span>&nbsp;<span class="op" id="5120995">[</span><span class="op" id="5120996">]</span><span class="ident" id="5120997">Value</span><span class="op" id="5121002">)</span>&nbsp;<span class="op" id="5121004">(</span><span class="ident" id="5121005">Result</span><span class="op" id="5121011">,</span>&nbsp;<span class="builtintype" id="5121013">error</span><span class="op" id="5121018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121022">//&nbsp;Query&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;may&nbsp;return&nbsp;rows,&nbsp;such&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121081">//&nbsp;SELECT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121093">Query</span><span class="op" id="5121098">(</span><span class="ident" id="5121099">args</span>&nbsp;<span class="op" id="5121104">[</span><span class="op" id="5121105">]</span><span class="ident" id="5121106">Value</span><span class="op" id="5121111">)</span>&nbsp;<span class="op" id="5121113">(</span><span class="ident" id="5121114">Rows</span><span class="op" id="5121118">,</span>&nbsp;<span class="builtintype" id="5121120">error</span><span class="op" id="5121125">)</span><br>
<span class="lineno">140</span><span class="op" id="5121127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5121130">//&nbsp;ColumnConverter&nbsp;may&nbsp;be&nbsp;optionally&nbsp;implemented&nbsp;by&nbsp;Stmt&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5121194">//&nbsp;statement&nbsp;is&nbsp;aware&nbsp;of&nbsp;its&nbsp;own&nbsp;columns&#39;&nbsp;types&nbsp;and&nbsp;can&nbsp;convert&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5121263">//&nbsp;any&nbsp;type&nbsp;to&nbsp;a&nbsp;driver&nbsp;Value.</span><br>
<span class="lineno">145</span><span class="keyword" id="5121294">type</span>&nbsp;<span class="ident" id="5121299">ColumnConverter</span>&nbsp;<span class="keyword" id="5121315">interface</span>&nbsp;<span class="op" id="5121325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121328">//&nbsp;ColumnConverter&nbsp;returns&nbsp;a&nbsp;ValueConverter&nbsp;for&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121390">//&nbsp;column&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;specific&nbsp;column&nbsp;isn&#39;t&nbsp;known</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121454">//&nbsp;or&nbsp;shouldn&#39;t&nbsp;be&nbsp;handled&nbsp;specially,&nbsp;DefaultValueConverter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121515">//&nbsp;can&nbsp;be&nbsp;returned.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121536">ColumnConverter</span><span class="op" id="5121551">(</span><span class="ident" id="5121552">idx</span>&nbsp;<span class="builtintype" id="5121556">int</span><span class="op" id="5121559">)</span>&nbsp;<span class="ident" id="5121561">ValueConverter</span><br>
<span class="lineno"></span><span class="op" id="5121576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5121579">//&nbsp;Rows&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;an&nbsp;executed&nbsp;query&#39;s&nbsp;results.</span><br>
<span class="lineno"></span><span class="keyword" id="5121636">type</span>&nbsp;<span class="ident" id="5121641">Rows</span>&nbsp;<span class="keyword" id="5121646">interface</span>&nbsp;<span class="op" id="5121656">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121659">//&nbsp;Columns&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;columns.&nbsp;The&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121719">//&nbsp;columns&nbsp;of&nbsp;the&nbsp;result&nbsp;is&nbsp;inferred&nbsp;from&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121780">//&nbsp;slice.&nbsp;&nbsp;If&nbsp;a&nbsp;particular&nbsp;column&nbsp;name&nbsp;isn&#39;t&nbsp;known,&nbsp;an&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121842">//&nbsp;string&nbsp;should&nbsp;be&nbsp;returned&nbsp;for&nbsp;that&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121888">Columns</span><span class="op" id="5121895">(</span><span class="op" id="5121896">)</span>&nbsp;<span class="op" id="5121898">[</span><span class="op" id="5121899">]</span><span class="builtintype" id="5121900">string</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121909">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;rows&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121945">Close</span><span class="op" id="5121950">(</span><span class="op" id="5121951">)</span>&nbsp;<span class="builtintype" id="5121953">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121961">//&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;populate&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122018">//&nbsp;the&nbsp;provided&nbsp;slice.&nbsp;The&nbsp;provided&nbsp;slice&nbsp;will&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122078">//&nbsp;size&nbsp;as&nbsp;the&nbsp;Columns()&nbsp;are&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122114">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122118">//&nbsp;The&nbsp;dest&nbsp;slice&nbsp;may&nbsp;be&nbsp;populated&nbsp;only&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122164">//&nbsp;a&nbsp;driver&nbsp;Value&nbsp;type,&nbsp;but&nbsp;excluding&nbsp;string.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122211">//&nbsp;All&nbsp;string&nbsp;values&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122262">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122266">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5122325">Next</span><span class="op" id="5122329">(</span><span class="ident" id="5122330">dest</span>&nbsp;<span class="op" id="5122335">[</span><span class="op" id="5122336">]</span><span class="ident" id="5122337">Value</span><span class="op" id="5122342">)</span>&nbsp;<span class="builtintype" id="5122344">error</span><br>
<span class="lineno"></span><span class="op" id="5122350">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="5122353">//&nbsp;Tx&nbsp;is&nbsp;a&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="5122377">type</span>&nbsp;<span class="ident" id="5122382">Tx</span>&nbsp;<span class="keyword" id="5122385">interface</span>&nbsp;<span class="op" id="5122395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5122398">Commit</span><span class="op" id="5122404">(</span><span class="op" id="5122405">)</span>&nbsp;<span class="builtintype" id="5122407">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5122414">Rollback</span><span class="op" id="5122422">(</span><span class="op" id="5122423">)</span>&nbsp;<span class="builtintype" id="5122425">error</span><br>
<span class="lineno">180</span><span class="op" id="5122431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5122434">//&nbsp;RowsAffected&nbsp;implements&nbsp;Result&nbsp;for&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE&nbsp;operation</span><br>
<span class="lineno"></span><span class="comment" id="5122502">//&nbsp;which&nbsp;mutates&nbsp;a&nbsp;number&nbsp;of&nbsp;rows.</span><br>
<span class="lineno"></span><span class="keyword" id="5122537">type</span>&nbsp;<span class="ident" id="5122542">RowsAffected</span>&nbsp;<span class="ident" id="5122555">int64</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="5122562">var</span>&nbsp;<span class="ident" id="5122566">_</span>&nbsp;<span class="ident" id="5122568">Result</span>&nbsp;<span class="op" id="5122575">=</span>&nbsp;<span class="ident" id="5122577">RowsAffected</span><span class="op" id="5122589">(</span><span class="num" id="5122590">0</span><span class="op" id="5122591">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5122594">func</span>&nbsp;<span class="op" id="5122599">(</span><span class="ident" id="5122600">RowsAffected</span><span class="op" id="5122612">)</span>&nbsp;<span class="ident" id="5122614">LastInsertId</span><span class="op" id="5122626">(</span><span class="op" id="5122627">)</span>&nbsp;<span class="op" id="5122629">(</span><span class="ident" id="5122630">int64</span><span class="op" id="5122635">,</span>&nbsp;<span class="builtintype" id="5122637">error</span><span class="op" id="5122642">)</span>&nbsp;<span class="op" id="5122644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122647">return</span>&nbsp;<span class="num" id="5122654">0</span><span class="op" id="5122655">,</span>&nbsp;<span class="ident" id="5122657">errors</span><span class="op" id="5122663">.</span><span class="ident" id="5122664">New</span><span class="op" id="5122667">(</span><span class="string" id="5122668">&#34;no&nbsp;LastInsertId&nbsp;available&#34;</span><span class="op" id="5122695">)</span><br>
<span class="lineno">190</span><span class="op" id="5122697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5122700">func</span>&nbsp;<span class="op" id="5122705">(</span><span class="ident" id="5122706">v</span>&nbsp;<span class="ident" id="5122708">RowsAffected</span><span class="op" id="5122720">)</span>&nbsp;<span class="ident" id="5122722">RowsAffected</span><span class="op" id="5122734">(</span><span class="op" id="5122735">)</span>&nbsp;<span class="op" id="5122737">(</span><span class="ident" id="5122738">int64</span><span class="op" id="5122743">,</span>&nbsp;<span class="builtintype" id="5122745">error</span><span class="op" id="5122750">)</span>&nbsp;<span class="op" id="5122752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122755">return</span>&nbsp;<span class="ident" id="5122762">int64</span><span class="op" id="5122767">(</span><span class="ident" id="5122768">v</span><span class="op" id="5122769">)</span><span class="op" id="5122770">,</span>&nbsp;<span class="ident" id="5122772">nil</span><br>
<span class="lineno"></span><span class="op" id="5122776">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="5122779">//&nbsp;ResultNoRows&nbsp;is&nbsp;a&nbsp;pre-defined&nbsp;Result&nbsp;for&nbsp;drivers&nbsp;to&nbsp;return&nbsp;when&nbsp;a&nbsp;DDL</span><br>
<span class="lineno"></span><span class="comment" id="5122852">//&nbsp;command&nbsp;(such&nbsp;as&nbsp;a&nbsp;CREATE&nbsp;TABLE)&nbsp;succeeds.&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;for&nbsp;both</span><br>
<span class="lineno"></span><span class="comment" id="5122927">//&nbsp;LastInsertId&nbsp;and&nbsp;RowsAffected.</span><br>
<span class="lineno"></span><span class="keyword" id="5122961">var</span>&nbsp;<span class="ident" id="5122965">ResultNoRows</span>&nbsp;<span class="ident" id="5122978">noRows</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="5122986">type</span>&nbsp;<span class="ident" id="5122991">noRows</span>&nbsp;<span class="keyword" id="5122998">struct</span><span class="op" id="5123004">{</span><span class="op" id="5123005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5123008">var</span>&nbsp;<span class="ident" id="5123012">_</span>&nbsp;<span class="ident" id="5123014">Result</span>&nbsp;<span class="op" id="5123021">=</span>&nbsp;<span class="ident" id="5123023">noRows</span><span class="op" id="5123029">{</span><span class="op" id="5123030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="5123033">func</span>&nbsp;<span class="op" id="5123038">(</span><span class="ident" id="5123039">noRows</span><span class="op" id="5123045">)</span>&nbsp;<span class="ident" id="5123047">LastInsertId</span><span class="op" id="5123059">(</span><span class="op" id="5123060">)</span>&nbsp;<span class="op" id="5123062">(</span><span class="ident" id="5123063">int64</span><span class="op" id="5123068">,</span>&nbsp;<span class="builtintype" id="5123070">error</span><span class="op" id="5123075">)</span>&nbsp;<span class="op" id="5123077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5123080">return</span>&nbsp;<span class="num" id="5123087">0</span><span class="op" id="5123088">,</span>&nbsp;<span class="ident" id="5123090">errors</span><span class="op" id="5123096">.</span><span class="ident" id="5123097">New</span><span class="op" id="5123100">(</span><span class="string" id="5123101">&#34;no&nbsp;LastInsertId&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5123148">)</span><br>
<span class="lineno"></span><span class="op" id="5123150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5123153">func</span>&nbsp;<span class="op" id="5123158">(</span><span class="ident" id="5123159">noRows</span><span class="op" id="5123165">)</span>&nbsp;<span class="ident" id="5123167">RowsAffected</span><span class="op" id="5123179">(</span><span class="op" id="5123180">)</span>&nbsp;<span class="op" id="5123182">(</span><span class="ident" id="5123183">int64</span><span class="op" id="5123188">,</span>&nbsp;<span class="builtintype" id="5123190">error</span><span class="op" id="5123195">)</span>&nbsp;<span class="op" id="5123197">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5123200">return</span>&nbsp;<span class="num" id="5123207">0</span><span class="op" id="5123208">,</span>&nbsp;<span class="ident" id="5123210">errors</span><span class="op" id="5123216">.</span><span class="ident" id="5123217">New</span><span class="op" id="5123220">(</span><span class="string" id="5123221">&#34;no&nbsp;RowsAffected&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5123268">)</span><br>
<span class="lineno"></span><span class="op" id="5123270">}</span>
</div>
</body>
</html>
