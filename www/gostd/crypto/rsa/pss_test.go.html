<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html" class="current">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8133466">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8133521">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8133575">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8133626">package</span>&nbsp;<span class="ident" id="8133634">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8133639">import</span>&nbsp;<span class="op" id="8133646">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133649">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133658">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133667">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133685">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8133695">_</span>&nbsp;<span class="string" id="8133697">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133711">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133726">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8133741">_</span>&nbsp;<span class="string" id="8133743">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133760">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133776">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133788">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133794">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133805">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8133816">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8133826">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8133829">func</span>&nbsp;<span class="ident" id="8133834">TestEMSAPSS</span><span class="op" id="8133845">(</span><span class="ident" id="8133846">t</span>&nbsp;<span class="op" id="8133848">*</span><span class="ident" id="8133849">testing</span><span class="op" id="8133856">.</span><span class="ident" id="8133857">T</span><span class="op" id="8133858">)</span>&nbsp;<span class="op" id="8133860">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8133863">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8133966">msg</span>&nbsp;<span class="op" id="8133970">:=</span>&nbsp;<span class="op" id="8133973">[</span><span class="op" id="8133974">]</span><span class="builtintype" id="8133975">byte</span><span class="op" id="8133979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8133983">0x85</span><span class="op" id="8133987">,</span>&nbsp;<span class="num" id="8133989">0x9e</span><span class="op" id="8133993">,</span>&nbsp;<span class="num" id="8133995">0xef</span><span class="op" id="8133999">,</span>&nbsp;<span class="num" id="8134001">0x2f</span><span class="op" id="8134005">,</span>&nbsp;<span class="num" id="8134007">0xd7</span><span class="op" id="8134011">,</span>&nbsp;<span class="num" id="8134013">0x8a</span><span class="op" id="8134017">,</span>&nbsp;<span class="num" id="8134019">0xca</span><span class="op" id="8134023">,</span>&nbsp;<span class="num" id="8134025">0x00</span><span class="op" id="8134029">,</span>&nbsp;<span class="num" id="8134031">0x30</span><span class="op" id="8134035">,</span>&nbsp;<span class="num" id="8134037">0x8b</span><span class="op" id="8134041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134045">0xdc</span><span class="op" id="8134049">,</span>&nbsp;<span class="num" id="8134051">0x47</span><span class="op" id="8134055">,</span>&nbsp;<span class="num" id="8134057">0x11</span><span class="op" id="8134061">,</span>&nbsp;<span class="num" id="8134063">0x93</span><span class="op" id="8134067">,</span>&nbsp;<span class="num" id="8134069">0xbf</span><span class="op" id="8134073">,</span>&nbsp;<span class="num" id="8134075">0x55</span><span class="op" id="8134079">,</span>&nbsp;<span class="num" id="8134081">0xbf</span><span class="op" id="8134085">,</span>&nbsp;<span class="num" id="8134087">0x9d</span><span class="op" id="8134091">,</span>&nbsp;<span class="num" id="8134093">0x78</span><span class="op" id="8134097">,</span>&nbsp;<span class="num" id="8134099">0xdb</span><span class="op" id="8134103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134107">0x8f</span><span class="op" id="8134111">,</span>&nbsp;<span class="num" id="8134113">0x8a</span><span class="op" id="8134117">,</span>&nbsp;<span class="num" id="8134119">0x67</span><span class="op" id="8134123">,</span>&nbsp;<span class="num" id="8134125">0x2b</span><span class="op" id="8134129">,</span>&nbsp;<span class="num" id="8134131">0x48</span><span class="op" id="8134135">,</span>&nbsp;<span class="num" id="8134137">0x46</span><span class="op" id="8134141">,</span>&nbsp;<span class="num" id="8134143">0x34</span><span class="op" id="8134147">,</span>&nbsp;<span class="num" id="8134149">0xf3</span><span class="op" id="8134153">,</span>&nbsp;<span class="num" id="8134155">0xc9</span><span class="op" id="8134159">,</span>&nbsp;<span class="num" id="8134161">0xc2</span><span class="op" id="8134165">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134169">0x6e</span><span class="op" id="8134173">,</span>&nbsp;<span class="num" id="8134175">0x64</span><span class="op" id="8134179">,</span>&nbsp;<span class="num" id="8134181">0x78</span><span class="op" id="8134185">,</span>&nbsp;<span class="num" id="8134187">0xae</span><span class="op" id="8134191">,</span>&nbsp;<span class="num" id="8134193">0x10</span><span class="op" id="8134197">,</span>&nbsp;<span class="num" id="8134199">0x26</span><span class="op" id="8134203">,</span>&nbsp;<span class="num" id="8134205">0x0f</span><span class="op" id="8134209">,</span>&nbsp;<span class="num" id="8134211">0xe0</span><span class="op" id="8134215">,</span>&nbsp;<span class="num" id="8134217">0xdd</span><span class="op" id="8134221">,</span>&nbsp;<span class="num" id="8134223">0x8c</span><span class="op" id="8134227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134231">0x08</span><span class="op" id="8134235">,</span>&nbsp;<span class="num" id="8134237">0x2e</span><span class="op" id="8134241">,</span>&nbsp;<span class="num" id="8134243">0x53</span><span class="op" id="8134247">,</span>&nbsp;<span class="num" id="8134249">0xa5</span><span class="op" id="8134253">,</span>&nbsp;<span class="num" id="8134255">0x29</span><span class="op" id="8134259">,</span>&nbsp;<span class="num" id="8134261">0x3a</span><span class="op" id="8134265">,</span>&nbsp;<span class="num" id="8134267">0xf2</span><span class="op" id="8134271">,</span>&nbsp;<span class="num" id="8134273">0x17</span><span class="op" id="8134277">,</span>&nbsp;<span class="num" id="8134279">0x3c</span><span class="op" id="8134283">,</span>&nbsp;<span class="num" id="8134285">0xd5</span><span class="op" id="8134289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134293">0x0c</span><span class="op" id="8134297">,</span>&nbsp;<span class="num" id="8134299">0x6d</span><span class="op" id="8134303">,</span>&nbsp;<span class="num" id="8134305">0x5d</span><span class="op" id="8134309">,</span>&nbsp;<span class="num" id="8134311">0x35</span><span class="op" id="8134315">,</span>&nbsp;<span class="num" id="8134317">0x4f</span><span class="op" id="8134321">,</span>&nbsp;<span class="num" id="8134323">0xeb</span><span class="op" id="8134327">,</span>&nbsp;<span class="num" id="8134329">0xf7</span><span class="op" id="8134333">,</span>&nbsp;<span class="num" id="8134335">0x8b</span><span class="op" id="8134339">,</span>&nbsp;<span class="num" id="8134341">0x26</span><span class="op" id="8134345">,</span>&nbsp;<span class="num" id="8134347">0x02</span><span class="op" id="8134351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134355">0x1c</span><span class="op" id="8134359">,</span>&nbsp;<span class="num" id="8134361">0x25</span><span class="op" id="8134365">,</span>&nbsp;<span class="num" id="8134367">0xc0</span><span class="op" id="8134371">,</span>&nbsp;<span class="num" id="8134373">0x27</span><span class="op" id="8134377">,</span>&nbsp;<span class="num" id="8134379">0x12</span><span class="op" id="8134383">,</span>&nbsp;<span class="num" id="8134385">0xe7</span><span class="op" id="8134389">,</span>&nbsp;<span class="num" id="8134391">0x8c</span><span class="op" id="8134395">,</span>&nbsp;<span class="num" id="8134397">0xd4</span><span class="op" id="8134401">,</span>&nbsp;<span class="num" id="8134403">0x69</span><span class="op" id="8134407">,</span>&nbsp;<span class="num" id="8134409">0x4c</span><span class="op" id="8134413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134417">0x9f</span><span class="op" id="8134421">,</span>&nbsp;<span class="num" id="8134423">0x46</span><span class="op" id="8134427">,</span>&nbsp;<span class="num" id="8134429">0x97</span><span class="op" id="8134433">,</span>&nbsp;<span class="num" id="8134435">0x77</span><span class="op" id="8134439">,</span>&nbsp;<span class="num" id="8134441">0xe4</span><span class="op" id="8134445">,</span>&nbsp;<span class="num" id="8134447">0x51</span><span class="op" id="8134451">,</span>&nbsp;<span class="num" id="8134453">0xe7</span><span class="op" id="8134457">,</span>&nbsp;<span class="num" id="8134459">0xf8</span><span class="op" id="8134463">,</span>&nbsp;<span class="num" id="8134465">0xe9</span><span class="op" id="8134469">,</span>&nbsp;<span class="num" id="8134471">0xe0</span><span class="op" id="8134475">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134479">0x4c</span><span class="op" id="8134483">,</span>&nbsp;<span class="num" id="8134485">0xd3</span><span class="op" id="8134489">,</span>&nbsp;<span class="num" id="8134491">0x73</span><span class="op" id="8134495">,</span>&nbsp;<span class="num" id="8134497">0x9c</span><span class="op" id="8134501">,</span>&nbsp;<span class="num" id="8134503">0x6b</span><span class="op" id="8134507">,</span>&nbsp;<span class="num" id="8134509">0xbf</span><span class="op" id="8134513">,</span>&nbsp;<span class="num" id="8134515">0xed</span><span class="op" id="8134519">,</span>&nbsp;<span class="num" id="8134521">0xae</span><span class="op" id="8134525">,</span>&nbsp;<span class="num" id="8134527">0x48</span><span class="op" id="8134531">,</span>&nbsp;<span class="num" id="8134533">0x7f</span><span class="op" id="8134537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134541">0xb5</span><span class="op" id="8134545">,</span>&nbsp;<span class="num" id="8134547">0x56</span><span class="op" id="8134551">,</span>&nbsp;<span class="num" id="8134553">0x44</span><span class="op" id="8134557">,</span>&nbsp;<span class="num" id="8134559">0xe9</span><span class="op" id="8134563">,</span>&nbsp;<span class="num" id="8134565">0xca</span><span class="op" id="8134569">,</span>&nbsp;<span class="num" id="8134571">0x74</span><span class="op" id="8134575">,</span>&nbsp;<span class="num" id="8134577">0xff</span><span class="op" id="8134581">,</span>&nbsp;<span class="num" id="8134583">0x77</span><span class="op" id="8134587">,</span>&nbsp;<span class="num" id="8134589">0xa5</span><span class="op" id="8134593">,</span>&nbsp;<span class="num" id="8134595">0x3c</span><span class="op" id="8134599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134603">0xb7</span><span class="op" id="8134607">,</span>&nbsp;<span class="num" id="8134609">0x29</span><span class="op" id="8134613">,</span>&nbsp;<span class="num" id="8134615">0x80</span><span class="op" id="8134619">,</span>&nbsp;<span class="num" id="8134621">0x2f</span><span class="op" id="8134625">,</span>&nbsp;<span class="num" id="8134627">0x6e</span><span class="op" id="8134631">,</span>&nbsp;<span class="num" id="8134633">0xd4</span><span class="op" id="8134637">,</span>&nbsp;<span class="num" id="8134639">0xa5</span><span class="op" id="8134643">,</span>&nbsp;<span class="num" id="8134645">0xff</span><span class="op" id="8134649">,</span>&nbsp;<span class="num" id="8134651">0xa8</span><span class="op" id="8134655">,</span>&nbsp;<span class="num" id="8134657">0xba</span><span class="op" id="8134661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134665">0x15</span><span class="op" id="8134669">,</span>&nbsp;<span class="num" id="8134671">0x98</span><span class="op" id="8134675">,</span>&nbsp;<span class="num" id="8134677">0x90</span><span class="op" id="8134681">,</span>&nbsp;<span class="num" id="8134683">0xfc</span><span class="op" id="8134687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8134690">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8134693">salt</span>&nbsp;<span class="op" id="8134698">:=</span>&nbsp;<span class="op" id="8134701">[</span><span class="op" id="8134702">]</span><span class="builtintype" id="8134703">byte</span><span class="op" id="8134707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134711">0xe3</span><span class="op" id="8134715">,</span>&nbsp;<span class="num" id="8134717">0xb5</span><span class="op" id="8134721">,</span>&nbsp;<span class="num" id="8134723">0xd5</span><span class="op" id="8134727">,</span>&nbsp;<span class="num" id="8134729">0xd0</span><span class="op" id="8134733">,</span>&nbsp;<span class="num" id="8134735">0x02</span><span class="op" id="8134739">,</span>&nbsp;<span class="num" id="8134741">0xc1</span><span class="op" id="8134745">,</span>&nbsp;<span class="num" id="8134747">0xbc</span><span class="op" id="8134751">,</span>&nbsp;<span class="num" id="8134753">0xe5</span><span class="op" id="8134757">,</span>&nbsp;<span class="num" id="8134759">0x0c</span><span class="op" id="8134763">,</span>&nbsp;<span class="num" id="8134765">0x2b</span><span class="op" id="8134769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134773">0x65</span><span class="op" id="8134777">,</span>&nbsp;<span class="num" id="8134779">0xef</span><span class="op" id="8134783">,</span>&nbsp;<span class="num" id="8134785">0x88</span><span class="op" id="8134789">,</span>&nbsp;<span class="num" id="8134791">0xa1</span><span class="op" id="8134795">,</span>&nbsp;<span class="num" id="8134797">0x88</span><span class="op" id="8134801">,</span>&nbsp;<span class="num" id="8134803">0xd8</span><span class="op" id="8134807">,</span>&nbsp;<span class="num" id="8134809">0x3b</span><span class="op" id="8134813">,</span>&nbsp;<span class="num" id="8134815">0xce</span><span class="op" id="8134819">,</span>&nbsp;<span class="num" id="8134821">0x7e</span><span class="op" id="8134825">,</span>&nbsp;<span class="num" id="8134827">0x61</span><span class="op" id="8134831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8134834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8134837">expected</span>&nbsp;<span class="op" id="8134846">:=</span>&nbsp;<span class="op" id="8134849">[</span><span class="op" id="8134850">]</span><span class="builtintype" id="8134851">byte</span><span class="op" id="8134855">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134859">0x66</span><span class="op" id="8134863">,</span>&nbsp;<span class="num" id="8134865">0xe4</span><span class="op" id="8134869">,</span>&nbsp;<span class="num" id="8134871">0x67</span><span class="op" id="8134875">,</span>&nbsp;<span class="num" id="8134877">0x2e</span><span class="op" id="8134881">,</span>&nbsp;<span class="num" id="8134883">0x83</span><span class="op" id="8134887">,</span>&nbsp;<span class="num" id="8134889">0x6a</span><span class="op" id="8134893">,</span>&nbsp;<span class="num" id="8134895">0xd1</span><span class="op" id="8134899">,</span>&nbsp;<span class="num" id="8134901">0x21</span><span class="op" id="8134905">,</span>&nbsp;<span class="num" id="8134907">0xba</span><span class="op" id="8134911">,</span>&nbsp;<span class="num" id="8134913">0x24</span><span class="op" id="8134917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134921">0x4b</span><span class="op" id="8134925">,</span>&nbsp;<span class="num" id="8134927">0xed</span><span class="op" id="8134931">,</span>&nbsp;<span class="num" id="8134933">0x65</span><span class="op" id="8134937">,</span>&nbsp;<span class="num" id="8134939">0x76</span><span class="op" id="8134943">,</span>&nbsp;<span class="num" id="8134945">0xb8</span><span class="op" id="8134949">,</span>&nbsp;<span class="num" id="8134951">0x67</span><span class="op" id="8134955">,</span>&nbsp;<span class="num" id="8134957">0xd9</span><span class="op" id="8134961">,</span>&nbsp;<span class="num" id="8134963">0xa4</span><span class="op" id="8134967">,</span>&nbsp;<span class="num" id="8134969">0x47</span><span class="op" id="8134973">,</span>&nbsp;<span class="num" id="8134975">0xc2</span><span class="op" id="8134979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8134983">0x8a</span><span class="op" id="8134987">,</span>&nbsp;<span class="num" id="8134989">0x6e</span><span class="op" id="8134993">,</span>&nbsp;<span class="num" id="8134995">0x66</span><span class="op" id="8134999">,</span>&nbsp;<span class="num" id="8135001">0xa5</span><span class="op" id="8135005">,</span>&nbsp;<span class="num" id="8135007">0xb8</span><span class="op" id="8135011">,</span>&nbsp;<span class="num" id="8135013">0x7d</span><span class="op" id="8135017">,</span>&nbsp;<span class="num" id="8135019">0xee</span><span class="op" id="8135023">,</span>&nbsp;<span class="num" id="8135025">0x7f</span><span class="op" id="8135029">,</span>&nbsp;<span class="num" id="8135031">0xbc</span><span class="op" id="8135035">,</span>&nbsp;<span class="num" id="8135037">0x7e</span><span class="op" id="8135041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135045">0x65</span><span class="op" id="8135049">,</span>&nbsp;<span class="num" id="8135051">0xaf</span><span class="op" id="8135055">,</span>&nbsp;<span class="num" id="8135057">0x50</span><span class="op" id="8135061">,</span>&nbsp;<span class="num" id="8135063">0x57</span><span class="op" id="8135067">,</span>&nbsp;<span class="num" id="8135069">0xf8</span><span class="op" id="8135073">,</span>&nbsp;<span class="num" id="8135075">0x6f</span><span class="op" id="8135079">,</span>&nbsp;<span class="num" id="8135081">0xae</span><span class="op" id="8135085">,</span>&nbsp;<span class="num" id="8135087">0x89</span><span class="op" id="8135091">,</span>&nbsp;<span class="num" id="8135093">0x84</span><span class="op" id="8135097">,</span>&nbsp;<span class="num" id="8135099">0xd9</span><span class="op" id="8135103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135107">0xba</span><span class="op" id="8135111">,</span>&nbsp;<span class="num" id="8135113">0x7f</span><span class="op" id="8135117">,</span>&nbsp;<span class="num" id="8135119">0x96</span><span class="op" id="8135123">,</span>&nbsp;<span class="num" id="8135125">0x9a</span><span class="op" id="8135129">,</span>&nbsp;<span class="num" id="8135131">0xd6</span><span class="op" id="8135135">,</span>&nbsp;<span class="num" id="8135137">0xfe</span><span class="op" id="8135141">,</span>&nbsp;<span class="num" id="8135143">0x02</span><span class="op" id="8135147">,</span>&nbsp;<span class="num" id="8135149">0xa4</span><span class="op" id="8135153">,</span>&nbsp;<span class="num" id="8135155">0xd7</span><span class="op" id="8135159">,</span>&nbsp;<span class="num" id="8135161">0x5f</span><span class="op" id="8135165">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135169">0x74</span><span class="op" id="8135173">,</span>&nbsp;<span class="num" id="8135175">0x45</span><span class="op" id="8135179">,</span>&nbsp;<span class="num" id="8135181">0xfe</span><span class="op" id="8135185">,</span>&nbsp;<span class="num" id="8135187">0xfd</span><span class="op" id="8135191">,</span>&nbsp;<span class="num" id="8135193">0xd8</span><span class="op" id="8135197">,</span>&nbsp;<span class="num" id="8135199">0x5b</span><span class="op" id="8135203">,</span>&nbsp;<span class="num" id="8135205">0x6d</span><span class="op" id="8135209">,</span>&nbsp;<span class="num" id="8135211">0x3a</span><span class="op" id="8135215">,</span>&nbsp;<span class="num" id="8135217">0x47</span><span class="op" id="8135221">,</span>&nbsp;<span class="num" id="8135223">0x7c</span><span class="op" id="8135227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135231">0x28</span><span class="op" id="8135235">,</span>&nbsp;<span class="num" id="8135237">0xd2</span><span class="op" id="8135241">,</span>&nbsp;<span class="num" id="8135243">0x4b</span><span class="op" id="8135247">,</span>&nbsp;<span class="num" id="8135249">0xa1</span><span class="op" id="8135253">,</span>&nbsp;<span class="num" id="8135255">0xe3</span><span class="op" id="8135259">,</span>&nbsp;<span class="num" id="8135261">0x75</span><span class="op" id="8135265">,</span>&nbsp;<span class="num" id="8135267">0x6f</span><span class="op" id="8135271">,</span>&nbsp;<span class="num" id="8135273">0x79</span><span class="op" id="8135277">,</span>&nbsp;<span class="num" id="8135279">0x2d</span><span class="op" id="8135283">,</span>&nbsp;<span class="num" id="8135285">0xd1</span><span class="op" id="8135289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135293">0xdc</span><span class="op" id="8135297">,</span>&nbsp;<span class="num" id="8135299">0xe8</span><span class="op" id="8135303">,</span>&nbsp;<span class="num" id="8135305">0xca</span><span class="op" id="8135309">,</span>&nbsp;<span class="num" id="8135311">0x94</span><span class="op" id="8135315">,</span>&nbsp;<span class="num" id="8135317">0x44</span><span class="op" id="8135321">,</span>&nbsp;<span class="num" id="8135323">0x0e</span><span class="op" id="8135327">,</span>&nbsp;<span class="num" id="8135329">0xcb</span><span class="op" id="8135333">,</span>&nbsp;<span class="num" id="8135335">0x52</span><span class="op" id="8135339">,</span>&nbsp;<span class="num" id="8135341">0x79</span><span class="op" id="8135345">,</span>&nbsp;<span class="num" id="8135347">0xec</span><span class="op" id="8135351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135355">0xd3</span><span class="op" id="8135359">,</span>&nbsp;<span class="num" id="8135361">0x18</span><span class="op" id="8135365">,</span>&nbsp;<span class="num" id="8135367">0x3a</span><span class="op" id="8135371">,</span>&nbsp;<span class="num" id="8135373">0x31</span><span class="op" id="8135377">,</span>&nbsp;<span class="num" id="8135379">0x1f</span><span class="op" id="8135383">,</span>&nbsp;<span class="num" id="8135385">0xc8</span><span class="op" id="8135389">,</span>&nbsp;<span class="num" id="8135391">0x96</span><span class="op" id="8135395">,</span>&nbsp;<span class="num" id="8135397">0xda</span><span class="op" id="8135401">,</span>&nbsp;<span class="num" id="8135403">0x1c</span><span class="op" id="8135407">,</span>&nbsp;<span class="num" id="8135409">0xb3</span><span class="op" id="8135413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135417">0x93</span><span class="op" id="8135421">,</span>&nbsp;<span class="num" id="8135423">0x11</span><span class="op" id="8135427">,</span>&nbsp;<span class="num" id="8135429">0xaf</span><span class="op" id="8135433">,</span>&nbsp;<span class="num" id="8135435">0x37</span><span class="op" id="8135439">,</span>&nbsp;<span class="num" id="8135441">0xea</span><span class="op" id="8135445">,</span>&nbsp;<span class="num" id="8135447">0x4a</span><span class="op" id="8135451">,</span>&nbsp;<span class="num" id="8135453">0x75</span><span class="op" id="8135457">,</span>&nbsp;<span class="num" id="8135459">0xe2</span><span class="op" id="8135463">,</span>&nbsp;<span class="num" id="8135465">0x4b</span><span class="op" id="8135469">,</span>&nbsp;<span class="num" id="8135471">0xdb</span><span class="op" id="8135475">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135479">0xfd</span><span class="op" id="8135483">,</span>&nbsp;<span class="num" id="8135485">0x5c</span><span class="op" id="8135489">,</span>&nbsp;<span class="num" id="8135491">0x1d</span><span class="op" id="8135495">,</span>&nbsp;<span class="num" id="8135497">0xa0</span><span class="op" id="8135501">,</span>&nbsp;<span class="num" id="8135503">0xde</span><span class="op" id="8135507">,</span>&nbsp;<span class="num" id="8135509">0x7c</span><span class="op" id="8135513">,</span>&nbsp;<span class="num" id="8135515">0xec</span><span class="op" id="8135519">,</span>&nbsp;<span class="num" id="8135521">0xdf</span><span class="op" id="8135525">,</span>&nbsp;<span class="num" id="8135527">0x1a</span><span class="op" id="8135531">,</span>&nbsp;<span class="num" id="8135533">0x89</span><span class="op" id="8135537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135541">0x6f</span><span class="op" id="8135545">,</span>&nbsp;<span class="num" id="8135547">0x9d</span><span class="op" id="8135551">,</span>&nbsp;<span class="num" id="8135553">0x8b</span><span class="op" id="8135557">,</span>&nbsp;<span class="num" id="8135559">0xc8</span><span class="op" id="8135563">,</span>&nbsp;<span class="num" id="8135565">0x16</span><span class="op" id="8135569">,</span>&nbsp;<span class="num" id="8135571">0xd9</span><span class="op" id="8135575">,</span>&nbsp;<span class="num" id="8135577">0x7c</span><span class="op" id="8135581">,</span>&nbsp;<span class="num" id="8135583">0xd7</span><span class="op" id="8135587">,</span>&nbsp;<span class="num" id="8135589">0xa2</span><span class="op" id="8135593">,</span>&nbsp;<span class="num" id="8135595">0xc4</span><span class="op" id="8135599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8135603">0x3b</span><span class="op" id="8135607">,</span>&nbsp;<span class="num" id="8135609">0xad</span><span class="op" id="8135613">,</span>&nbsp;<span class="num" id="8135615">0x54</span><span class="op" id="8135619">,</span>&nbsp;<span class="num" id="8135621">0x6f</span><span class="op" id="8135625">,</span>&nbsp;<span class="num" id="8135627">0xbe</span><span class="op" id="8135631">,</span>&nbsp;<span class="num" id="8135633">0x8c</span><span class="op" id="8135637">,</span>&nbsp;<span class="num" id="8135639">0xfe</span><span class="op" id="8135643">,</span>&nbsp;<span class="num" id="8135645">0xbc</span><span class="op" id="8135649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8135652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8135656">hash</span>&nbsp;<span class="op" id="8135661">:=</span>&nbsp;<span class="ident" id="8135664">sha1</span><span class="op" id="8135668">.</span><span class="ident" id="8135669">New</span><span class="op" id="8135672">(</span><span class="op" id="8135673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8135676">hash</span><span class="op" id="8135680">.</span><span class="ident" id="8135681">Write</span><span class="op" id="8135686">(</span><span class="ident" id="8135687">msg</span><span class="op" id="8135690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8135693">hashed</span>&nbsp;<span class="op" id="8135700">:=</span>&nbsp;<span class="ident" id="8135703">hash</span><span class="op" id="8135707">.</span><span class="ident" id="8135708">Sum</span><span class="op" id="8135711">(</span><span class="builtintype" id="8135712">nil</span><span class="op" id="8135715">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8135719">encoded</span><span class="op" id="8135726">,</span>&nbsp;<span class="ident" id="8135728">err</span>&nbsp;<span class="op" id="8135732">:=</span>&nbsp;<span class="ident" id="8135735">emsaPSSEncode</span><span class="op" id="8135748">(</span><span class="ident" id="8135749">hashed</span><span class="op" id="8135755">,</span>&nbsp;<span class="num" id="8135757">1023</span><span class="op" id="8135761">,</span>&nbsp;<span class="ident" id="8135763">salt</span><span class="op" id="8135767">,</span>&nbsp;<span class="ident" id="8135769">sha1</span><span class="op" id="8135773">.</span><span class="ident" id="8135774">New</span><span class="op" id="8135777">(</span><span class="op" id="8135778">)</span><span class="op" id="8135779">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8135782">if</span>&nbsp;<span class="ident" id="8135785">err</span>&nbsp;<span class="op" id="8135789">!=</span>&nbsp;<span class="builtintype" id="8135792">nil</span>&nbsp;<span class="op" id="8135796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8135800">t</span><span class="op" id="8135801">.</span><span class="ident" id="8135802">Errorf</span><span class="op" id="8135808">(</span><span class="string" id="8135809">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="8135841">,</span>&nbsp;<span class="ident" id="8135843">err</span><span class="op" id="8135846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8135849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8135852">if</span>&nbsp;<span class="op" id="8135855">!</span><span class="ident" id="8135856">bytes</span><span class="op" id="8135861">.</span><span class="ident" id="8135862">Equal</span><span class="op" id="8135867">(</span><span class="ident" id="8135868">encoded</span><span class="op" id="8135875">,</span>&nbsp;<span class="ident" id="8135877">expected</span><span class="op" id="8135885">)</span>&nbsp;<span class="op" id="8135887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8135891">t</span><span class="op" id="8135892">.</span><span class="ident" id="8135893">Errorf</span><span class="op" id="8135899">(</span><span class="string" id="8135900">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8135931">,</span>&nbsp;<span class="ident" id="8135933">encoded</span><span class="op" id="8135940">,</span>&nbsp;<span class="ident" id="8135942">expected</span><span class="op" id="8135950">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8135953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8135957">if</span>&nbsp;<span class="ident" id="8135960">err</span>&nbsp;<span class="op" id="8135964">=</span>&nbsp;<span class="ident" id="8135966">emsaPSSVerify</span><span class="op" id="8135979">(</span><span class="ident" id="8135980">hashed</span><span class="op" id="8135986">,</span>&nbsp;<span class="ident" id="8135988">encoded</span><span class="op" id="8135995">,</span>&nbsp;<span class="num" id="8135997">1023</span><span class="op" id="8136001">,</span>&nbsp;<span class="builtinfunc" id="8136003">len</span><span class="op" id="8136006">(</span><span class="ident" id="8136007">salt</span><span class="op" id="8136011">)</span><span class="op" id="8136012">,</span>&nbsp;<span class="ident" id="8136014">sha1</span><span class="op" id="8136018">.</span><span class="ident" id="8136019">New</span><span class="op" id="8136022">(</span><span class="op" id="8136023">)</span><span class="op" id="8136024">)</span><span class="op" id="8136025">;</span>&nbsp;<span class="ident" id="8136027">err</span>&nbsp;<span class="op" id="8136031">!=</span>&nbsp;<span class="builtintype" id="8136034">nil</span>&nbsp;<span class="op" id="8136038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8136042">t</span><span class="op" id="8136043">.</span><span class="ident" id="8136044">Errorf</span><span class="op" id="8136050">(</span><span class="string" id="8136051">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="8136073">,</span>&nbsp;<span class="ident" id="8136075">err</span><span class="op" id="8136078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8136081">}</span><br>
<span class="lineno">75</span><span class="op" id="8136083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8136086">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="8136151">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="8136215">func</span>&nbsp;<span class="ident" id="8136220">TestPSSGolden</span><span class="op" id="8136233">(</span><span class="ident" id="8136234">t</span>&nbsp;<span class="op" id="8136236">*</span><span class="ident" id="8136237">testing</span><span class="op" id="8136244">.</span><span class="ident" id="8136245">T</span><span class="op" id="8136246">)</span>&nbsp;<span class="op" id="8136248">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8136251">inFile</span><span class="op" id="8136257">,</span>&nbsp;<span class="ident" id="8136259">err</span>&nbsp;<span class="op" id="8136263">:=</span>&nbsp;<span class="ident" id="8136266">os</span><span class="op" id="8136268">.</span><span class="ident" id="8136269">Open</span><span class="op" id="8136273">(</span><span class="string" id="8136274">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="8136301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136304">if</span>&nbsp;<span class="ident" id="8136307">err</span>&nbsp;<span class="op" id="8136311">!=</span>&nbsp;<span class="builtintype" id="8136314">nil</span>&nbsp;<span class="op" id="8136318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8136322">t</span><span class="op" id="8136323">.</span><span class="ident" id="8136324">Fatalf</span><span class="op" id="8136330">(</span><span class="string" id="8136331">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="8136362">,</span>&nbsp;<span class="ident" id="8136364">err</span><span class="op" id="8136367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8136370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136373">defer</span>&nbsp;<span class="ident" id="8136379">inFile</span><span class="op" id="8136385">.</span><span class="ident" id="8136386">Close</span><span class="op" id="8136391">(</span><span class="op" id="8136392">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8136396">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8136461">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8136532">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8136602">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136637">const</span>&nbsp;<span class="ident" id="8136643">newKeyMarker</span>&nbsp;<span class="op" id="8136656">=</span>&nbsp;<span class="string" id="8136658">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136675">const</span>&nbsp;<span class="ident" id="8136681">newSignatureMarker</span>&nbsp;<span class="op" id="8136700">=</span>&nbsp;<span class="string" id="8136702">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8136726">values</span>&nbsp;<span class="op" id="8136733">:=</span>&nbsp;<span class="builtinfunc" id="8136736">make</span><span class="op" id="8136740">(</span><span class="keyword" id="8136741">chan</span>&nbsp;<span class="builtintype" id="8136746">string</span><span class="op" id="8136752">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136756">go</span>&nbsp;<span class="keyword" id="8136759">func</span><span class="op" id="8136763">(</span><span class="op" id="8136764">)</span>&nbsp;<span class="op" id="8136766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136770">defer</span>&nbsp;<span class="builtinfunc" id="8136776">close</span><span class="op" id="8136781">(</span><span class="ident" id="8136782">values</span><span class="op" id="8136788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8136792">scanner</span>&nbsp;<span class="op" id="8136800">:=</span>&nbsp;<span class="ident" id="8136803">bufio</span><span class="op" id="8136808">.</span><span class="ident" id="8136809">NewScanner</span><span class="op" id="8136819">(</span><span class="ident" id="8136820">bzip2</span><span class="op" id="8136825">.</span><span class="ident" id="8136826">NewReader</span><span class="op" id="8136835">(</span><span class="ident" id="8136836">inFile</span><span class="op" id="8136842">)</span><span class="op" id="8136843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136847">var</span>&nbsp;<span class="ident" id="8136851">partialValue</span>&nbsp;<span class="builtintype" id="8136864">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8136873">lastWasValue</span>&nbsp;<span class="op" id="8136886">:=</span>&nbsp;<span class="builtintype" id="8136889">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136897">for</span>&nbsp;<span class="ident" id="8136901">scanner</span><span class="op" id="8136908">.</span><span class="ident" id="8136909">Scan</span><span class="op" id="8136913">(</span><span class="op" id="8136914">)</span>&nbsp;<span class="op" id="8136916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8136921">line</span>&nbsp;<span class="op" id="8136926">:=</span>&nbsp;<span class="ident" id="8136929">scanner</span><span class="op" id="8136936">.</span><span class="ident" id="8136937">Text</span><span class="op" id="8136941">(</span><span class="op" id="8136942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136947">switch</span>&nbsp;<span class="op" id="8136954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136959">case</span>&nbsp;<span class="builtinfunc" id="8136964">len</span><span class="op" id="8136967">(</span><span class="ident" id="8136968">line</span><span class="op" id="8136972">)</span>&nbsp;<span class="op" id="8136974">==</span>&nbsp;<span class="num" id="8136977">0</span><span class="op" id="8136978">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8136984">if</span>&nbsp;<span class="builtinfunc" id="8136987">len</span><span class="op" id="8136990">(</span><span class="ident" id="8136991">partialValue</span><span class="op" id="8137003">)</span>&nbsp;<span class="op" id="8137005">&gt;</span>&nbsp;<span class="num" id="8137007">0</span>&nbsp;<span class="op" id="8137009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137016">values</span>&nbsp;<span class="op" id="8137023">&lt;-</span>&nbsp;<span class="ident" id="8137026">strings</span><span class="op" id="8137033">.</span><span class="ident" id="8137034">Replace</span><span class="op" id="8137041">(</span><span class="ident" id="8137042">partialValue</span><span class="op" id="8137054">,</span>&nbsp;<span class="string" id="8137056">&#34;&nbsp;&#34;</span><span class="op" id="8137059">,</span>&nbsp;<span class="string" id="8137061">&#34;&#34;</span><span class="op" id="8137063">,</span>&nbsp;<span class="op" id="8137065">-</span><span class="num" id="8137066">1</span><span class="op" id="8137067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137074">partialValue</span>&nbsp;<span class="op" id="8137087">=</span>&nbsp;<span class="string" id="8137089">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137097">lastWasValue</span>&nbsp;<span class="op" id="8137110">=</span>&nbsp;<span class="builtintype" id="8137112">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137121">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137127">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137139">case</span>&nbsp;<span class="ident" id="8137144">strings</span><span class="op" id="8137151">.</span><span class="ident" id="8137152">HasPrefix</span><span class="op" id="8137161">(</span><span class="ident" id="8137162">line</span><span class="op" id="8137166">,</span>&nbsp;<span class="string" id="8137168">&#34;#&nbsp;======&#34;</span><span class="op" id="8137178">)</span>&nbsp;<span class="op" id="8137180">&amp;&amp;</span>&nbsp;<span class="ident" id="8137183">lastWasValue</span><span class="op" id="8137195">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137201">values</span>&nbsp;<span class="op" id="8137208">&lt;-</span>&nbsp;<span class="ident" id="8137211">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137228">lastWasValue</span>&nbsp;<span class="op" id="8137241">=</span>&nbsp;<span class="builtintype" id="8137243">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137252">case</span>&nbsp;<span class="ident" id="8137257">strings</span><span class="op" id="8137264">.</span><span class="ident" id="8137265">HasPrefix</span><span class="op" id="8137274">(</span><span class="ident" id="8137275">line</span><span class="op" id="8137279">,</span>&nbsp;<span class="string" id="8137281">&#34;#&nbsp;------&#34;</span><span class="op" id="8137291">)</span>&nbsp;<span class="op" id="8137293">&amp;&amp;</span>&nbsp;<span class="ident" id="8137296">lastWasValue</span><span class="op" id="8137308">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137314">values</span>&nbsp;<span class="op" id="8137321">&lt;-</span>&nbsp;<span class="ident" id="8137324">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137347">lastWasValue</span>&nbsp;<span class="op" id="8137360">=</span>&nbsp;<span class="builtintype" id="8137362">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137371">case</span>&nbsp;<span class="ident" id="8137376">strings</span><span class="op" id="8137383">.</span><span class="ident" id="8137384">HasPrefix</span><span class="op" id="8137393">(</span><span class="ident" id="8137394">line</span><span class="op" id="8137398">,</span>&nbsp;<span class="string" id="8137400">&#34;#&#34;</span><span class="op" id="8137403">)</span><span class="op" id="8137404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137410">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137422">default</span><span class="op" id="8137429">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137435">partialValue</span>&nbsp;<span class="op" id="8137448">+=</span>&nbsp;<span class="ident" id="8137451">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137467">if</span>&nbsp;<span class="ident" id="8137470">err</span>&nbsp;<span class="op" id="8137474">:=</span>&nbsp;<span class="ident" id="8137477">scanner</span><span class="op" id="8137484">.</span><span class="ident" id="8137485">Err</span><span class="op" id="8137488">(</span><span class="op" id="8137489">)</span><span class="op" id="8137490">;</span>&nbsp;<span class="ident" id="8137492">err</span>&nbsp;<span class="op" id="8137496">!=</span>&nbsp;<span class="builtintype" id="8137499">nil</span>&nbsp;<span class="op" id="8137503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8137508">panic</span><span class="op" id="8137513">(</span><span class="ident" id="8137514">err</span><span class="op" id="8137517">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137524">}</span><span class="op" id="8137525">(</span><span class="op" id="8137526">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137530">var</span>&nbsp;<span class="ident" id="8137534">key</span>&nbsp;<span class="op" id="8137538">*</span><span class="ident" id="8137539">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137550">var</span>&nbsp;<span class="ident" id="8137554">hashed</span>&nbsp;<span class="op" id="8137561">[</span><span class="op" id="8137562">]</span><span class="builtintype" id="8137563">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137569">hash</span>&nbsp;<span class="op" id="8137574">:=</span>&nbsp;<span class="ident" id="8137577">crypto</span><span class="op" id="8137583">.</span><span class="ident" id="8137584">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137590">h</span>&nbsp;<span class="op" id="8137592">:=</span>&nbsp;<span class="ident" id="8137595">hash</span><span class="op" id="8137599">.</span><span class="ident" id="8137600">New</span><span class="op" id="8137603">(</span><span class="op" id="8137604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137607">opts</span>&nbsp;<span class="op" id="8137612">:=</span>&nbsp;<span class="op" id="8137615">&amp;</span><span class="ident" id="8137616">PSSOptions</span><span class="op" id="8137626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137630">SaltLength</span><span class="op" id="8137640">:</span>&nbsp;<span class="ident" id="8137642">PSSSaltLengthEqualsHash</span><span class="op" id="8137665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137668">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137672">for</span>&nbsp;<span class="ident" id="8137676">marker</span>&nbsp;<span class="op" id="8137683">:=</span>&nbsp;<span class="keyword" id="8137686">range</span>&nbsp;<span class="ident" id="8137692">values</span>&nbsp;<span class="op" id="8137699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137703">switch</span>&nbsp;<span class="ident" id="8137710">marker</span>&nbsp;<span class="op" id="8137717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137721">case</span>&nbsp;<span class="ident" id="8137726">newKeyMarker</span><span class="op" id="8137738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137743">key</span>&nbsp;<span class="op" id="8137747">=</span>&nbsp;<span class="builtinfunc" id="8137749">new</span><span class="op" id="8137752">(</span><span class="ident" id="8137753">PublicKey</span><span class="op" id="8137762">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137767">nHex</span><span class="op" id="8137771">,</span>&nbsp;<span class="ident" id="8137773">ok</span>&nbsp;<span class="op" id="8137776">:=</span>&nbsp;<span class="op" id="8137779">&lt;-</span><span class="ident" id="8137781">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137791">if</span>&nbsp;<span class="op" id="8137794">!</span><span class="ident" id="8137795">ok</span>&nbsp;<span class="op" id="8137798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137804">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137821">key</span><span class="op" id="8137824">.</span><span class="ident" id="8137825">N</span>&nbsp;<span class="op" id="8137827">=</span>&nbsp;<span class="ident" id="8137829">bigFromHex</span><span class="op" id="8137839">(</span><span class="ident" id="8137840">nHex</span><span class="op" id="8137844">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137849">key</span><span class="op" id="8137852">.</span><span class="ident" id="8137853">E</span>&nbsp;<span class="op" id="8137855">=</span>&nbsp;<span class="ident" id="8137857">intFromHex</span><span class="op" id="8137867">(</span><span class="op" id="8137868">&lt;-</span><span class="ident" id="8137870">values</span><span class="op" id="8137876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8137881">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137930">for</span>&nbsp;<span class="ident" id="8137934">i</span>&nbsp;<span class="op" id="8137936">:=</span>&nbsp;<span class="num" id="8137939">0</span><span class="op" id="8137940">;</span>&nbsp;<span class="ident" id="8137942">i</span>&nbsp;<span class="op" id="8137944">&lt;</span>&nbsp;<span class="num" id="8137946">6</span><span class="op" id="8137947">;</span>&nbsp;<span class="ident" id="8137949">i</span><span class="op" id="8137950">++</span>&nbsp;<span class="op" id="8137953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137959">&lt;-</span><span class="ident" id="8137961">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137971">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137975">case</span>&nbsp;<span class="ident" id="8137980">newSignatureMarker</span><span class="op" id="8137998">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138003">msg</span>&nbsp;<span class="op" id="8138007">:=</span>&nbsp;<span class="ident" id="8138010">fromHex</span><span class="op" id="8138017">(</span><span class="op" id="8138018">&lt;-</span><span class="ident" id="8138020">values</span><span class="op" id="8138026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138031">&lt;-</span><span class="ident" id="8138033">values</span>&nbsp;<span class="comment" id="8138040">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138056">sig</span>&nbsp;<span class="op" id="8138060">:=</span>&nbsp;<span class="ident" id="8138063">fromHex</span><span class="op" id="8138070">(</span><span class="op" id="8138071">&lt;-</span><span class="ident" id="8138073">values</span><span class="op" id="8138079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138085">h</span><span class="op" id="8138086">.</span><span class="ident" id="8138087">Reset</span><span class="op" id="8138092">(</span><span class="op" id="8138093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138098">h</span><span class="op" id="8138099">.</span><span class="ident" id="8138100">Write</span><span class="op" id="8138105">(</span><span class="ident" id="8138106">msg</span><span class="op" id="8138109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138114">hashed</span>&nbsp;<span class="op" id="8138121">=</span>&nbsp;<span class="ident" id="8138123">h</span><span class="op" id="8138124">.</span><span class="ident" id="8138125">Sum</span><span class="op" id="8138128">(</span><span class="ident" id="8138129">hashed</span><span class="op" id="8138135">[</span><span class="op" id="8138136">:</span><span class="num" id="8138137">0</span><span class="op" id="8138138">]</span><span class="op" id="8138139">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138145">if</span>&nbsp;<span class="ident" id="8138148">err</span>&nbsp;<span class="op" id="8138152">:=</span>&nbsp;<span class="ident" id="8138155">VerifyPSS</span><span class="op" id="8138164">(</span><span class="ident" id="8138165">key</span><span class="op" id="8138168">,</span>&nbsp;<span class="ident" id="8138170">hash</span><span class="op" id="8138174">,</span>&nbsp;<span class="ident" id="8138176">hashed</span><span class="op" id="8138182">,</span>&nbsp;<span class="ident" id="8138184">sig</span><span class="op" id="8138187">,</span>&nbsp;<span class="ident" id="8138189">opts</span><span class="op" id="8138193">)</span><span class="op" id="8138194">;</span>&nbsp;<span class="ident" id="8138196">err</span>&nbsp;<span class="op" id="8138200">!=</span>&nbsp;<span class="builtintype" id="8138203">nil</span>&nbsp;<span class="op" id="8138207">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138213">t</span><span class="op" id="8138214">.</span><span class="ident" id="8138215">Error</span><span class="op" id="8138220">(</span><span class="ident" id="8138221">err</span><span class="op" id="8138224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138233">default</span><span class="op" id="8138240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138245">t</span><span class="op" id="8138246">.</span><span class="ident" id="8138247">Fatalf</span><span class="op" id="8138253">(</span><span class="string" id="8138254">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="8138273">+</span>&nbsp;<span class="ident" id="8138275">marker</span><span class="op" id="8138281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138285">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138288">}</span><br>
<span class="lineno"></span><span class="op" id="8138290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8138293">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8138372">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="8138440">func</span>&nbsp;<span class="ident" id="8138445">TestPSSOpenSSL</span><span class="op" id="8138459">(</span><span class="ident" id="8138460">t</span>&nbsp;<span class="op" id="8138462">*</span><span class="ident" id="8138463">testing</span><span class="op" id="8138470">.</span><span class="ident" id="8138471">T</span><span class="op" id="8138472">)</span>&nbsp;<span class="op" id="8138474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138477">hash</span>&nbsp;<span class="op" id="8138482">:=</span>&nbsp;<span class="ident" id="8138485">crypto</span><span class="op" id="8138491">.</span><span class="ident" id="8138492">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138500">h</span>&nbsp;<span class="op" id="8138502">:=</span>&nbsp;<span class="ident" id="8138505">hash</span><span class="op" id="8138509">.</span><span class="ident" id="8138510">New</span><span class="op" id="8138513">(</span><span class="op" id="8138514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138517">h</span><span class="op" id="8138518">.</span><span class="ident" id="8138519">Write</span><span class="op" id="8138524">(</span><span class="op" id="8138525">[</span><span class="op" id="8138526">]</span><span class="builtintype" id="8138527">byte</span><span class="op" id="8138531">(</span><span class="string" id="8138532">&#34;testing&#34;</span><span class="op" id="8138541">)</span><span class="op" id="8138542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138545">hashed</span>&nbsp;<span class="op" id="8138552">:=</span>&nbsp;<span class="ident" id="8138555">h</span><span class="op" id="8138556">.</span><span class="ident" id="8138557">Sum</span><span class="op" id="8138560">(</span><span class="builtintype" id="8138561">nil</span><span class="op" id="8138564">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8138568">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138677">sig</span>&nbsp;<span class="op" id="8138681">:=</span>&nbsp;<span class="op" id="8138684">[</span><span class="op" id="8138685">]</span><span class="builtintype" id="8138686">byte</span><span class="op" id="8138690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8138694">0x95</span><span class="op" id="8138698">,</span>&nbsp;<span class="num" id="8138700">0x59</span><span class="op" id="8138704">,</span>&nbsp;<span class="num" id="8138706">0x6f</span><span class="op" id="8138710">,</span>&nbsp;<span class="num" id="8138712">0xd3</span><span class="op" id="8138716">,</span>&nbsp;<span class="num" id="8138718">0x10</span><span class="op" id="8138722">,</span>&nbsp;<span class="num" id="8138724">0xa2</span><span class="op" id="8138728">,</span>&nbsp;<span class="num" id="8138730">0xe7</span><span class="op" id="8138734">,</span>&nbsp;<span class="num" id="8138736">0xa2</span><span class="op" id="8138740">,</span>&nbsp;<span class="num" id="8138742">0x92</span><span class="op" id="8138746">,</span>&nbsp;<span class="num" id="8138748">0x9d</span><span class="op" id="8138752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8138756">0x4a</span><span class="op" id="8138760">,</span>&nbsp;<span class="num" id="8138762">0x07</span><span class="op" id="8138766">,</span>&nbsp;<span class="num" id="8138768">0x2e</span><span class="op" id="8138772">,</span>&nbsp;<span class="num" id="8138774">0x2b</span><span class="op" id="8138778">,</span>&nbsp;<span class="num" id="8138780">0x27</span><span class="op" id="8138784">,</span>&nbsp;<span class="num" id="8138786">0xcc</span><span class="op" id="8138790">,</span>&nbsp;<span class="num" id="8138792">0x06</span><span class="op" id="8138796">,</span>&nbsp;<span class="num" id="8138798">0xc2</span><span class="op" id="8138802">,</span>&nbsp;<span class="num" id="8138804">0x87</span><span class="op" id="8138808">,</span>&nbsp;<span class="num" id="8138810">0x2c</span><span class="op" id="8138814">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8138818">0x52</span><span class="op" id="8138822">,</span>&nbsp;<span class="num" id="8138824">0xf0</span><span class="op" id="8138828">,</span>&nbsp;<span class="num" id="8138830">0x4a</span><span class="op" id="8138834">,</span>&nbsp;<span class="num" id="8138836">0xcc</span><span class="op" id="8138840">,</span>&nbsp;<span class="num" id="8138842">0x05</span><span class="op" id="8138846">,</span>&nbsp;<span class="num" id="8138848">0x94</span><span class="op" id="8138852">,</span>&nbsp;<span class="num" id="8138854">0xf2</span><span class="op" id="8138858">,</span>&nbsp;<span class="num" id="8138860">0xc3</span><span class="op" id="8138864">,</span>&nbsp;<span class="num" id="8138866">0x2e</span><span class="op" id="8138870">,</span>&nbsp;<span class="num" id="8138872">0x20</span><span class="op" id="8138876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8138880">0xd7</span><span class="op" id="8138884">,</span>&nbsp;<span class="num" id="8138886">0x3e</span><span class="op" id="8138890">,</span>&nbsp;<span class="num" id="8138892">0x66</span><span class="op" id="8138896">,</span>&nbsp;<span class="num" id="8138898">0x62</span><span class="op" id="8138902">,</span>&nbsp;<span class="num" id="8138904">0xb5</span><span class="op" id="8138908">,</span>&nbsp;<span class="num" id="8138910">0x95</span><span class="op" id="8138914">,</span>&nbsp;<span class="num" id="8138916">0x2b</span><span class="op" id="8138920">,</span>&nbsp;<span class="num" id="8138922">0xa3</span><span class="op" id="8138926">,</span>&nbsp;<span class="num" id="8138928">0x93</span><span class="op" id="8138932">,</span>&nbsp;<span class="num" id="8138934">0x9a</span><span class="op" id="8138938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8138942">0x66</span><span class="op" id="8138946">,</span>&nbsp;<span class="num" id="8138948">0x64</span><span class="op" id="8138952">,</span>&nbsp;<span class="num" id="8138954">0x25</span><span class="op" id="8138958">,</span>&nbsp;<span class="num" id="8138960">0xe0</span><span class="op" id="8138964">,</span>&nbsp;<span class="num" id="8138966">0x74</span><span class="op" id="8138970">,</span>&nbsp;<span class="num" id="8138972">0x66</span><span class="op" id="8138976">,</span>&nbsp;<span class="num" id="8138978">0x8c</span><span class="op" id="8138982">,</span>&nbsp;<span class="num" id="8138984">0x3e</span><span class="op" id="8138988">,</span>&nbsp;<span class="num" id="8138990">0x92</span><span class="op" id="8138994">,</span>&nbsp;<span class="num" id="8138996">0xeb</span><span class="op" id="8139000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8139004">0xc6</span><span class="op" id="8139008">,</span>&nbsp;<span class="num" id="8139010">0xe6</span><span class="op" id="8139014">,</span>&nbsp;<span class="num" id="8139016">0xc0</span><span class="op" id="8139020">,</span>&nbsp;<span class="num" id="8139022">0x44</span><span class="op" id="8139026">,</span>&nbsp;<span class="num" id="8139028">0xf3</span><span class="op" id="8139032">,</span>&nbsp;<span class="num" id="8139034">0xb4</span><span class="op" id="8139038">,</span>&nbsp;<span class="num" id="8139040">0xb4</span><span class="op" id="8139044">,</span>&nbsp;<span class="num" id="8139046">0x2e</span><span class="op" id="8139050">,</span>&nbsp;<span class="num" id="8139052">0x8c</span><span class="op" id="8139056">,</span>&nbsp;<span class="num" id="8139058">0x66</span><span class="op" id="8139062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8139066">0x0a</span><span class="op" id="8139070">,</span>&nbsp;<span class="num" id="8139072">0x37</span><span class="op" id="8139076">,</span>&nbsp;<span class="num" id="8139078">0x9c</span><span class="op" id="8139082">,</span>&nbsp;<span class="num" id="8139084">0x69</span><span class="op" id="8139088">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139095">if</span>&nbsp;<span class="ident" id="8139098">err</span>&nbsp;<span class="op" id="8139102">:=</span>&nbsp;<span class="ident" id="8139105">VerifyPSS</span><span class="op" id="8139114">(</span><span class="op" id="8139115">&amp;</span><span class="ident" id="8139116">rsaPrivateKey</span><span class="op" id="8139129">.</span><span class="ident" id="8139130">PublicKey</span><span class="op" id="8139139">,</span>&nbsp;<span class="ident" id="8139141">hash</span><span class="op" id="8139145">,</span>&nbsp;<span class="ident" id="8139147">hashed</span><span class="op" id="8139153">,</span>&nbsp;<span class="ident" id="8139155">sig</span><span class="op" id="8139158">,</span>&nbsp;<span class="builtintype" id="8139160">nil</span><span class="op" id="8139163">)</span><span class="op" id="8139164">;</span>&nbsp;<span class="ident" id="8139166">err</span>&nbsp;<span class="op" id="8139170">!=</span>&nbsp;<span class="builtintype" id="8139173">nil</span>&nbsp;<span class="op" id="8139177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139181">t</span><span class="op" id="8139182">.</span><span class="ident" id="8139183">Error</span><span class="op" id="8139188">(</span><span class="ident" id="8139189">err</span><span class="op" id="8139192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139195">}</span><br>
<span class="lineno">190</span><span class="op" id="8139197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8139200">func</span>&nbsp;<span class="ident" id="8139205">TestPSSSigning</span><span class="op" id="8139219">(</span><span class="ident" id="8139220">t</span>&nbsp;<span class="op" id="8139222">*</span><span class="ident" id="8139223">testing</span><span class="op" id="8139230">.</span><span class="ident" id="8139231">T</span><span class="op" id="8139232">)</span>&nbsp;<span class="op" id="8139234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139237">var</span>&nbsp;<span class="ident" id="8139241">saltLengthCombinations</span>&nbsp;<span class="op" id="8139264">=</span>&nbsp;<span class="op" id="8139266">[</span><span class="op" id="8139267">]</span><span class="keyword" id="8139268">struct</span>&nbsp;<span class="op" id="8139275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139279">signSaltLength</span><span class="op" id="8139293">,</span>&nbsp;<span class="ident" id="8139295">verifySaltLength</span>&nbsp;<span class="builtintype" id="8139312">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139318">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8139351">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139357">}</span><span class="op" id="8139358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139362">{</span><span class="ident" id="8139363">PSSSaltLengthAuto</span><span class="op" id="8139380">,</span>&nbsp;<span class="ident" id="8139382">PSSSaltLengthAuto</span><span class="op" id="8139399">,</span>&nbsp;<span class="builtintype" id="8139401">true</span><span class="op" id="8139405">}</span><span class="op" id="8139406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139410">{</span><span class="ident" id="8139411">PSSSaltLengthEqualsHash</span><span class="op" id="8139434">,</span>&nbsp;<span class="ident" id="8139436">PSSSaltLengthAuto</span><span class="op" id="8139453">,</span>&nbsp;<span class="builtintype" id="8139455">true</span><span class="op" id="8139459">}</span><span class="op" id="8139460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139464">{</span><span class="ident" id="8139465">PSSSaltLengthEqualsHash</span><span class="op" id="8139488">,</span>&nbsp;<span class="ident" id="8139490">PSSSaltLengthEqualsHash</span><span class="op" id="8139513">,</span>&nbsp;<span class="builtintype" id="8139515">true</span><span class="op" id="8139519">}</span><span class="op" id="8139520">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139524">{</span><span class="ident" id="8139525">PSSSaltLengthEqualsHash</span><span class="op" id="8139548">,</span>&nbsp;<span class="num" id="8139550">8</span><span class="op" id="8139551">,</span>&nbsp;<span class="builtintype" id="8139553">false</span><span class="op" id="8139558">}</span><span class="op" id="8139559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139563">{</span><span class="ident" id="8139564">PSSSaltLengthAuto</span><span class="op" id="8139581">,</span>&nbsp;<span class="ident" id="8139583">PSSSaltLengthEqualsHash</span><span class="op" id="8139606">,</span>&nbsp;<span class="builtintype" id="8139608">false</span><span class="op" id="8139613">}</span><span class="op" id="8139614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139618">{</span><span class="num" id="8139619">8</span><span class="op" id="8139620">,</span>&nbsp;<span class="num" id="8139622">8</span><span class="op" id="8139623">,</span>&nbsp;<span class="builtintype" id="8139625">true</span><span class="op" id="8139629">}</span><span class="op" id="8139630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139637">hash</span>&nbsp;<span class="op" id="8139642">:=</span>&nbsp;<span class="ident" id="8139645">crypto</span><span class="op" id="8139651">.</span><span class="ident" id="8139652">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139657">h</span>&nbsp;<span class="op" id="8139659">:=</span>&nbsp;<span class="ident" id="8139662">hash</span><span class="op" id="8139666">.</span><span class="ident" id="8139667">New</span><span class="op" id="8139670">(</span><span class="op" id="8139671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139674">h</span><span class="op" id="8139675">.</span><span class="ident" id="8139676">Write</span><span class="op" id="8139681">(</span><span class="op" id="8139682">[</span><span class="op" id="8139683">]</span><span class="builtintype" id="8139684">byte</span><span class="op" id="8139688">(</span><span class="string" id="8139689">&#34;testing&#34;</span><span class="op" id="8139698">)</span><span class="op" id="8139699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139702">hashed</span>&nbsp;<span class="op" id="8139709">:=</span>&nbsp;<span class="ident" id="8139712">h</span><span class="op" id="8139713">.</span><span class="ident" id="8139714">Sum</span><span class="op" id="8139717">(</span><span class="builtintype" id="8139718">nil</span><span class="op" id="8139721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139724">var</span>&nbsp;<span class="ident" id="8139728">opts</span>&nbsp;<span class="ident" id="8139733">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139746">for</span>&nbsp;<span class="ident" id="8139750">i</span><span class="op" id="8139751">,</span>&nbsp;<span class="ident" id="8139753">test</span>&nbsp;<span class="op" id="8139758">:=</span>&nbsp;<span class="keyword" id="8139761">range</span>&nbsp;<span class="ident" id="8139767">saltLengthCombinations</span>&nbsp;<span class="op" id="8139790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139794">opts</span><span class="op" id="8139798">.</span><span class="ident" id="8139799">SaltLength</span>&nbsp;<span class="op" id="8139810">=</span>&nbsp;<span class="ident" id="8139812">test</span><span class="op" id="8139816">.</span><span class="ident" id="8139817">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139834">sig</span><span class="op" id="8139837">,</span>&nbsp;<span class="ident" id="8139839">err</span>&nbsp;<span class="op" id="8139843">:=</span>&nbsp;<span class="ident" id="8139846">SignPSS</span><span class="op" id="8139853">(</span><span class="ident" id="8139854">rand</span><span class="op" id="8139858">.</span><span class="ident" id="8139859">Reader</span><span class="op" id="8139865">,</span>&nbsp;<span class="ident" id="8139867">rsaPrivateKey</span><span class="op" id="8139880">,</span>&nbsp;<span class="ident" id="8139882">hash</span><span class="op" id="8139886">,</span>&nbsp;<span class="ident" id="8139888">hashed</span><span class="op" id="8139894">,</span>&nbsp;<span class="op" id="8139896">&amp;</span><span class="ident" id="8139897">opts</span><span class="op" id="8139901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139905">if</span>&nbsp;<span class="ident" id="8139908">err</span>&nbsp;<span class="op" id="8139912">!=</span>&nbsp;<span class="builtintype" id="8139915">nil</span>&nbsp;<span class="op" id="8139919">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139924">t</span><span class="op" id="8139925">.</span><span class="ident" id="8139926">Errorf</span><span class="op" id="8139932">(</span><span class="string" id="8139933">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8139963">,</span>&nbsp;<span class="ident" id="8139965">i</span><span class="op" id="8139966">,</span>&nbsp;<span class="ident" id="8139968">err</span><span class="op" id="8139971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139976">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139992">opts</span><span class="op" id="8139996">.</span><span class="ident" id="8139997">SaltLength</span>&nbsp;<span class="op" id="8140008">=</span>&nbsp;<span class="ident" id="8140010">test</span><span class="op" id="8140014">.</span><span class="ident" id="8140015">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140034">err</span>&nbsp;<span class="op" id="8140038">=</span>&nbsp;<span class="ident" id="8140040">VerifyPSS</span><span class="op" id="8140049">(</span><span class="op" id="8140050">&amp;</span><span class="ident" id="8140051">rsaPrivateKey</span><span class="op" id="8140064">.</span><span class="ident" id="8140065">PublicKey</span><span class="op" id="8140074">,</span>&nbsp;<span class="ident" id="8140076">hash</span><span class="op" id="8140080">,</span>&nbsp;<span class="ident" id="8140082">hashed</span><span class="op" id="8140088">,</span>&nbsp;<span class="ident" id="8140090">sig</span><span class="op" id="8140093">,</span>&nbsp;<span class="op" id="8140095">&amp;</span><span class="ident" id="8140096">opts</span><span class="op" id="8140100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140104">if</span>&nbsp;<span class="op" id="8140107">(</span><span class="ident" id="8140108">err</span>&nbsp;<span class="op" id="8140112">==</span>&nbsp;<span class="builtintype" id="8140115">nil</span><span class="op" id="8140118">)</span>&nbsp;<span class="op" id="8140120">!=</span>&nbsp;<span class="ident" id="8140123">test</span><span class="op" id="8140127">.</span><span class="ident" id="8140128">good</span>&nbsp;<span class="op" id="8140133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140138">t</span><span class="op" id="8140139">.</span><span class="ident" id="8140140">Errorf</span><span class="op" id="8140146">(</span><span class="string" id="8140147">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="8140185">,</span>&nbsp;<span class="ident" id="8140187">i</span><span class="op" id="8140188">,</span>&nbsp;<span class="ident" id="8140190">test</span><span class="op" id="8140194">.</span><span class="ident" id="8140195">good</span><span class="op" id="8140199">,</span>&nbsp;<span class="ident" id="8140201">err</span><span class="op" id="8140204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140211">}</span><br>
<span class="lineno">225</span><span class="op" id="8140213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8140216">func</span>&nbsp;<span class="ident" id="8140221">bigFromHex</span><span class="op" id="8140231">(</span><span class="ident" id="8140232">hex</span>&nbsp;<span class="builtintype" id="8140236">string</span><span class="op" id="8140242">)</span>&nbsp;<span class="op" id="8140244">*</span><span class="ident" id="8140245">big</span><span class="op" id="8140248">.</span><span class="ident" id="8140249">Int</span>&nbsp;<span class="op" id="8140253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140256">n</span><span class="op" id="8140257">,</span>&nbsp;<span class="ident" id="8140259">ok</span>&nbsp;<span class="op" id="8140262">:=</span>&nbsp;<span class="builtinfunc" id="8140265">new</span><span class="op" id="8140268">(</span><span class="ident" id="8140269">big</span><span class="op" id="8140272">.</span><span class="ident" id="8140273">Int</span><span class="op" id="8140276">)</span><span class="op" id="8140277">.</span><span class="ident" id="8140278">SetString</span><span class="op" id="8140287">(</span><span class="ident" id="8140288">hex</span><span class="op" id="8140291">,</span>&nbsp;<span class="num" id="8140293">16</span><span class="op" id="8140295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140298">if</span>&nbsp;<span class="op" id="8140301">!</span><span class="ident" id="8140302">ok</span>&nbsp;<span class="op" id="8140305">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8140309">panic</span><span class="op" id="8140314">(</span><span class="string" id="8140315">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="8140327">+</span>&nbsp;<span class="ident" id="8140329">hex</span><span class="op" id="8140332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140338">return</span>&nbsp;<span class="ident" id="8140345">n</span><br>
<span class="lineno"></span><span class="op" id="8140347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8140350">func</span>&nbsp;<span class="ident" id="8140355">intFromHex</span><span class="op" id="8140365">(</span><span class="ident" id="8140366">hex</span>&nbsp;<span class="builtintype" id="8140370">string</span><span class="op" id="8140376">)</span>&nbsp;<span class="builtintype" id="8140378">int</span>&nbsp;<span class="op" id="8140382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140385">i</span><span class="op" id="8140386">,</span>&nbsp;<span class="ident" id="8140388">err</span>&nbsp;<span class="op" id="8140392">:=</span>&nbsp;<span class="ident" id="8140395">strconv</span><span class="op" id="8140402">.</span><span class="ident" id="8140403">ParseInt</span><span class="op" id="8140411">(</span><span class="ident" id="8140412">hex</span><span class="op" id="8140415">,</span>&nbsp;<span class="num" id="8140417">16</span><span class="op" id="8140419">,</span>&nbsp;<span class="num" id="8140421">32</span><span class="op" id="8140423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140426">if</span>&nbsp;<span class="ident" id="8140429">err</span>&nbsp;<span class="op" id="8140433">!=</span>&nbsp;<span class="builtintype" id="8140436">nil</span>&nbsp;<span class="op" id="8140440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8140444">panic</span><span class="op" id="8140449">(</span><span class="ident" id="8140450">err</span><span class="op" id="8140453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140456">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140459">return</span>&nbsp;<span class="builtintype" id="8140466">int</span><span class="op" id="8140469">(</span><span class="ident" id="8140470">i</span><span class="op" id="8140471">)</span><br>
<span class="lineno"></span><span class="op" id="8140473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8140476">func</span>&nbsp;<span class="ident" id="8140481">fromHex</span><span class="op" id="8140488">(</span><span class="ident" id="8140489">hexStr</span>&nbsp;<span class="builtintype" id="8140496">string</span><span class="op" id="8140502">)</span>&nbsp;<span class="op" id="8140504">[</span><span class="op" id="8140505">]</span><span class="builtintype" id="8140506">byte</span>&nbsp;<span class="op" id="8140511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140514">s</span><span class="op" id="8140515">,</span>&nbsp;<span class="ident" id="8140517">err</span>&nbsp;<span class="op" id="8140521">:=</span>&nbsp;<span class="ident" id="8140524">hex</span><span class="op" id="8140527">.</span><span class="ident" id="8140528">DecodeString</span><span class="op" id="8140540">(</span><span class="ident" id="8140541">hexStr</span><span class="op" id="8140547">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140550">if</span>&nbsp;<span class="ident" id="8140553">err</span>&nbsp;<span class="op" id="8140557">!=</span>&nbsp;<span class="builtintype" id="8140560">nil</span>&nbsp;<span class="op" id="8140564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8140568">panic</span><span class="op" id="8140573">(</span><span class="ident" id="8140574">err</span><span class="op" id="8140577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140583">return</span>&nbsp;<span class="ident" id="8140590">s</span><br>
<span class="lineno"></span><span class="op" id="8140592">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
