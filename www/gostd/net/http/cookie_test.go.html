<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7771696">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7771752">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7771806">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7771857">package</span>&nbsp;<span class="ident" id="7771865">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7771871">import</span>&nbsp;<span class="op" id="7771878">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7771881">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7771890">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7771907">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7771914">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7771921">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7771927">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7771938">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7771949">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7771960">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7771967">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7771970">var</span>&nbsp;<span class="ident" id="7771974">writeSetCookiesTests</span>&nbsp;<span class="op" id="7771995">=</span>&nbsp;<span class="op" id="7771997">[</span><span class="op" id="7771998">]</span><span class="keyword" id="7771999">struct</span>&nbsp;<span class="op" id="7772006">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7772009">Cookie</span>&nbsp;<span class="op" id="7772016">*</span><span class="ident" id="7772017">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7772025">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7772032">string</span><br>
<span class="lineno"></span><span class="op" id="7772039">}</span><span class="op" id="7772040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772047">&amp;</span><span class="ident" id="7772048">Cookie</span><span class="op" id="7772054">{</span><span class="ident" id="7772055">Name</span><span class="op" id="7772059">:</span>&nbsp;<span class="string" id="7772061">&#34;cookie-1&#34;</span><span class="op" id="7772071">,</span>&nbsp;<span class="ident" id="7772073">Value</span><span class="op" id="7772078">:</span>&nbsp;<span class="string" id="7772080">&#34;v$1&#34;</span><span class="op" id="7772085">}</span><span class="op" id="7772086">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7772090">&#34;cookie-1=v$1&#34;</span><span class="op" id="7772104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772107">}</span><span class="op" id="7772108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772115">&amp;</span><span class="ident" id="7772116">Cookie</span><span class="op" id="7772122">{</span><span class="ident" id="7772123">Name</span><span class="op" id="7772127">:</span>&nbsp;<span class="string" id="7772129">&#34;cookie-2&#34;</span><span class="op" id="7772139">,</span>&nbsp;<span class="ident" id="7772141">Value</span><span class="op" id="7772146">:</span>&nbsp;<span class="string" id="7772148">&#34;two&#34;</span><span class="op" id="7772153">,</span>&nbsp;<span class="ident" id="7772155">MaxAge</span><span class="op" id="7772161">:</span>&nbsp;<span class="num" id="7772163">3600</span><span class="op" id="7772167">}</span><span class="op" id="7772168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7772172">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7772200">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772203">}</span><span class="op" id="7772204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772211">&amp;</span><span class="ident" id="7772212">Cookie</span><span class="op" id="7772218">{</span><span class="ident" id="7772219">Name</span><span class="op" id="7772223">:</span>&nbsp;<span class="string" id="7772225">&#34;cookie-3&#34;</span><span class="op" id="7772235">,</span>&nbsp;<span class="ident" id="7772237">Value</span><span class="op" id="7772242">:</span>&nbsp;<span class="string" id="7772244">&#34;three&#34;</span><span class="op" id="7772251">,</span>&nbsp;<span class="ident" id="7772253">Domain</span><span class="op" id="7772259">:</span>&nbsp;<span class="string" id="7772261">&#34;.example.com&#34;</span><span class="op" id="7772275">}</span><span class="op" id="7772276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7772280">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="7772316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772319">}</span><span class="op" id="7772320">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772327">&amp;</span><span class="ident" id="7772328">Cookie</span><span class="op" id="7772334">{</span><span class="ident" id="7772335">Name</span><span class="op" id="7772339">:</span>&nbsp;<span class="string" id="7772341">&#34;cookie-4&#34;</span><span class="op" id="7772351">,</span>&nbsp;<span class="ident" id="7772353">Value</span><span class="op" id="7772358">:</span>&nbsp;<span class="string" id="7772360">&#34;four&#34;</span><span class="op" id="7772366">,</span>&nbsp;<span class="ident" id="7772368">Path</span><span class="op" id="7772372">:</span>&nbsp;<span class="string" id="7772374">&#34;/restricted/&#34;</span><span class="op" id="7772388">}</span><span class="op" id="7772389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7772393">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7772427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772430">}</span><span class="op" id="7772431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772434">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772438">&amp;</span><span class="ident" id="7772439">Cookie</span><span class="op" id="7772445">{</span><span class="ident" id="7772446">Name</span><span class="op" id="7772450">:</span>&nbsp;<span class="string" id="7772452">&#34;cookie-5&#34;</span><span class="op" id="7772462">,</span>&nbsp;<span class="ident" id="7772464">Value</span><span class="op" id="7772469">:</span>&nbsp;<span class="string" id="7772471">&#34;five&#34;</span><span class="op" id="7772477">,</span>&nbsp;<span class="ident" id="7772479">Domain</span><span class="op" id="7772485">:</span>&nbsp;<span class="string" id="7772487">&#34;wrong;bad.abc&#34;</span><span class="op" id="7772502">}</span><span class="op" id="7772503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7772507">&#34;cookie-5=five&#34;</span><span class="op" id="7772522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772525">}</span><span class="op" id="7772526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772533">&amp;</span><span class="ident" id="7772534">Cookie</span><span class="op" id="7772540">{</span><span class="ident" id="7772541">Name</span><span class="op" id="7772545">:</span>&nbsp;<span class="string" id="7772547">&#34;cookie-6&#34;</span><span class="op" id="7772557">,</span>&nbsp;<span class="ident" id="7772559">Value</span><span class="op" id="7772564">:</span>&nbsp;<span class="string" id="7772566">&#34;six&#34;</span><span class="op" id="7772571">,</span>&nbsp;<span class="ident" id="7772573">Domain</span><span class="op" id="7772579">:</span>&nbsp;<span class="string" id="7772581">&#34;bad-.abc&#34;</span><span class="op" id="7772591">}</span><span class="op" id="7772592">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7772596">&#34;cookie-6=six&#34;</span><span class="op" id="7772610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772613">}</span><span class="op" id="7772614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772621">&amp;</span><span class="ident" id="7772622">Cookie</span><span class="op" id="7772628">{</span><span class="ident" id="7772629">Name</span><span class="op" id="7772633">:</span>&nbsp;<span class="string" id="7772635">&#34;cookie-7&#34;</span><span class="op" id="7772645">,</span>&nbsp;<span class="ident" id="7772647">Value</span><span class="op" id="7772652">:</span>&nbsp;<span class="string" id="7772654">&#34;seven&#34;</span><span class="op" id="7772661">,</span>&nbsp;<span class="ident" id="7772663">Domain</span><span class="op" id="7772669">:</span>&nbsp;<span class="string" id="7772671">&#34;127.0.0.1&#34;</span><span class="op" id="7772682">}</span><span class="op" id="7772683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7772687">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="7772721">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772724">}</span><span class="op" id="7772725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772732">&amp;</span><span class="ident" id="7772733">Cookie</span><span class="op" id="7772739">{</span><span class="ident" id="7772740">Name</span><span class="op" id="7772744">:</span>&nbsp;<span class="string" id="7772746">&#34;cookie-8&#34;</span><span class="op" id="7772756">,</span>&nbsp;<span class="ident" id="7772758">Value</span><span class="op" id="7772763">:</span>&nbsp;<span class="string" id="7772765">&#34;eight&#34;</span><span class="op" id="7772772">,</span>&nbsp;<span class="ident" id="7772774">Domain</span><span class="op" id="7772780">:</span>&nbsp;<span class="string" id="7772782">&#34;::1&#34;</span><span class="op" id="7772787">}</span><span class="op" id="7772788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7772792">&#34;cookie-8=eight&#34;</span><span class="op" id="7772808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772811">}</span><span class="op" id="7772812">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7772815">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7772887">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7772950">&amp;</span><span class="ident" id="7772951">Cookie</span><span class="op" id="7772957">{</span><span class="ident" id="7772958">Name</span><span class="op" id="7772962">:</span>&nbsp;<span class="string" id="7772964">&#34;special-1&#34;</span><span class="op" id="7772975">,</span>&nbsp;<span class="ident" id="7772977">Value</span><span class="op" id="7772982">:</span>&nbsp;<span class="string" id="7772984">&#34;a&nbsp;z&#34;</span><span class="op" id="7772989">}</span><span class="op" id="7772990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7772994">`special-1=a&nbsp;z`</span><span class="op" id="7773009">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773012">}</span><span class="op" id="7773013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773020">&amp;</span><span class="ident" id="7773021">Cookie</span><span class="op" id="7773027">{</span><span class="ident" id="7773028">Name</span><span class="op" id="7773032">:</span>&nbsp;<span class="string" id="7773034">&#34;special-2&#34;</span><span class="op" id="7773045">,</span>&nbsp;<span class="ident" id="7773047">Value</span><span class="op" id="7773052">:</span>&nbsp;<span class="string" id="7773054">&#34;&nbsp;z&#34;</span><span class="op" id="7773058">}</span><span class="op" id="7773059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7773063">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7773079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773082">}</span><span class="op" id="7773083">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773090">&amp;</span><span class="ident" id="7773091">Cookie</span><span class="op" id="7773097">{</span><span class="ident" id="7773098">Name</span><span class="op" id="7773102">:</span>&nbsp;<span class="string" id="7773104">&#34;special-3&#34;</span><span class="op" id="7773115">,</span>&nbsp;<span class="ident" id="7773117">Value</span><span class="op" id="7773122">:</span>&nbsp;<span class="string" id="7773124">&#34;a&nbsp;&#34;</span><span class="op" id="7773128">}</span><span class="op" id="7773129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7773133">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7773149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773152">}</span><span class="op" id="7773153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773156">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773160">&amp;</span><span class="ident" id="7773161">Cookie</span><span class="op" id="7773167">{</span><span class="ident" id="7773168">Name</span><span class="op" id="7773172">:</span>&nbsp;<span class="string" id="7773174">&#34;special-4&#34;</span><span class="op" id="7773185">,</span>&nbsp;<span class="ident" id="7773187">Value</span><span class="op" id="7773192">:</span>&nbsp;<span class="string" id="7773194">&#34;&nbsp;&#34;</span><span class="op" id="7773197">}</span><span class="op" id="7773198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7773202">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7773217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773220">}</span><span class="op" id="7773221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773228">&amp;</span><span class="ident" id="7773229">Cookie</span><span class="op" id="7773235">{</span><span class="ident" id="7773236">Name</span><span class="op" id="7773240">:</span>&nbsp;<span class="string" id="7773242">&#34;special-5&#34;</span><span class="op" id="7773253">,</span>&nbsp;<span class="ident" id="7773255">Value</span><span class="op" id="7773260">:</span>&nbsp;<span class="string" id="7773262">&#34;a,z&#34;</span><span class="op" id="7773267">}</span><span class="op" id="7773268">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7773272">`special-5=a,z`</span><span class="op" id="7773287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773290">}</span><span class="op" id="7773291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773298">&amp;</span><span class="ident" id="7773299">Cookie</span><span class="op" id="7773305">{</span><span class="ident" id="7773306">Name</span><span class="op" id="7773310">:</span>&nbsp;<span class="string" id="7773312">&#34;special-6&#34;</span><span class="op" id="7773323">,</span>&nbsp;<span class="ident" id="7773325">Value</span><span class="op" id="7773330">:</span>&nbsp;<span class="string" id="7773332">&#34;,z&#34;</span><span class="op" id="7773336">}</span><span class="op" id="7773337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7773341">`special-6=&#34;,z&#34;`</span><span class="op" id="7773357">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773360">}</span><span class="op" id="7773361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773368">&amp;</span><span class="ident" id="7773369">Cookie</span><span class="op" id="7773375">{</span><span class="ident" id="7773376">Name</span><span class="op" id="7773380">:</span>&nbsp;<span class="string" id="7773382">&#34;special-7&#34;</span><span class="op" id="7773393">,</span>&nbsp;<span class="ident" id="7773395">Value</span><span class="op" id="7773400">:</span>&nbsp;<span class="string" id="7773402">&#34;a,&#34;</span><span class="op" id="7773406">}</span><span class="op" id="7773407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7773411">`special-7=&#34;a,&#34;`</span><span class="op" id="7773427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773430">}</span><span class="op" id="7773431">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773438">&amp;</span><span class="ident" id="7773439">Cookie</span><span class="op" id="7773445">{</span><span class="ident" id="7773446">Name</span><span class="op" id="7773450">:</span>&nbsp;<span class="string" id="7773452">&#34;special-8&#34;</span><span class="op" id="7773463">,</span>&nbsp;<span class="ident" id="7773465">Value</span><span class="op" id="7773470">:</span>&nbsp;<span class="string" id="7773472">&#34;,&#34;</span><span class="op" id="7773475">}</span><span class="op" id="7773476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7773480">`special-8=&#34;,&#34;`</span><span class="op" id="7773495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773498">}</span><span class="op" id="7773499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773502">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773506">&amp;</span><span class="ident" id="7773507">Cookie</span><span class="op" id="7773513">{</span><span class="ident" id="7773514">Name</span><span class="op" id="7773518">:</span>&nbsp;<span class="string" id="7773520">&#34;empty-value&#34;</span><span class="op" id="7773533">,</span>&nbsp;<span class="ident" id="7773535">Value</span><span class="op" id="7773540">:</span>&nbsp;<span class="string" id="7773542">&#34;&#34;</span><span class="op" id="7773544">}</span><span class="op" id="7773545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7773549">`empty-value=`</span><span class="op" id="7773563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773566">}</span><span class="op" id="7773567">,</span><br>
<span class="lineno"></span><span class="op" id="7773569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7773572">func</span>&nbsp;<span class="ident" id="7773577">TestWriteSetCookies</span><span class="op" id="7773596">(</span><span class="ident" id="7773597">t</span>&nbsp;<span class="op" id="7773599">*</span><span class="ident" id="7773600">testing</span><span class="op" id="7773607">.</span><span class="ident" id="7773608">T</span><span class="op" id="7773609">)</span>&nbsp;<span class="op" id="7773611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7773614">defer</span>&nbsp;<span class="ident" id="7773620">log</span><span class="op" id="7773623">.</span><span class="ident" id="7773624">SetOutput</span><span class="op" id="7773633">(</span><span class="ident" id="7773634">os</span><span class="op" id="7773636">.</span><span class="ident" id="7773637">Stderr</span><span class="op" id="7773643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7773646">var</span>&nbsp;<span class="ident" id="7773650">logbuf</span>&nbsp;<span class="ident" id="7773657">bytes</span><span class="op" id="7773662">.</span><span class="ident" id="7773663">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7773671">log</span><span class="op" id="7773674">.</span><span class="ident" id="7773675">SetOutput</span><span class="op" id="7773684">(</span><span class="op" id="7773685">&amp;</span><span class="ident" id="7773686">logbuf</span><span class="op" id="7773692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7773696">for</span>&nbsp;<span class="ident" id="7773700">i</span><span class="op" id="7773701">,</span>&nbsp;<span class="ident" id="7773703">tt</span>&nbsp;<span class="op" id="7773706">:=</span>&nbsp;<span class="keyword" id="7773709">range</span>&nbsp;<span class="ident" id="7773715">writeSetCookiesTests</span>&nbsp;<span class="op" id="7773736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7773740">if</span>&nbsp;<span class="ident" id="7773743">g</span><span class="op" id="7773744">,</span>&nbsp;<span class="ident" id="7773746">e</span>&nbsp;<span class="op" id="7773748">:=</span>&nbsp;<span class="ident" id="7773751">tt</span><span class="op" id="7773753">.</span><span class="ident" id="7773754">Cookie</span><span class="op" id="7773760">.</span><span class="ident" id="7773761">String</span><span class="op" id="7773767">(</span><span class="op" id="7773768">)</span><span class="op" id="7773769">,</span>&nbsp;<span class="ident" id="7773771">tt</span><span class="op" id="7773773">.</span><span class="ident" id="7773774">Raw</span><span class="op" id="7773777">;</span>&nbsp;<span class="ident" id="7773779">g</span>&nbsp;<span class="op" id="7773781">!=</span>&nbsp;<span class="ident" id="7773784">e</span>&nbsp;<span class="op" id="7773786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7773791">t</span><span class="op" id="7773792">.</span><span class="ident" id="7773793">Errorf</span><span class="op" id="7773799">(</span><span class="string" id="7773800">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7773837">,</span>&nbsp;<span class="ident" id="7773839">i</span><span class="op" id="7773840">,</span>&nbsp;<span class="ident" id="7773842">e</span><span class="op" id="7773843">,</span>&nbsp;<span class="ident" id="7773845">g</span><span class="op" id="7773846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7773851">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773862">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7773865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7773869">if</span>&nbsp;<span class="ident" id="7773872">got</span><span class="op" id="7773875">,</span>&nbsp;<span class="ident" id="7773877">sub</span>&nbsp;<span class="op" id="7773881">:=</span>&nbsp;<span class="ident" id="7773884">logbuf</span><span class="op" id="7773890">.</span><span class="ident" id="7773891">String</span><span class="op" id="7773897">(</span><span class="op" id="7773898">)</span><span class="op" id="7773899">,</span>&nbsp;<span class="string" id="7773901">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="7773928">;</span>&nbsp;<span class="op" id="7773930">!</span><span class="ident" id="7773931">strings</span><span class="op" id="7773938">.</span><span class="ident" id="7773939">Contains</span><span class="op" id="7773947">(</span><span class="ident" id="7773948">got</span><span class="op" id="7773951">,</span>&nbsp;<span class="ident" id="7773953">sub</span><span class="op" id="7773956">)</span>&nbsp;<span class="op" id="7773958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7773962">t</span><span class="op" id="7773963">.</span><span class="ident" id="7773964">Errorf</span><span class="op" id="7773970">(</span><span class="string" id="7773971">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7774018">,</span>&nbsp;<span class="ident" id="7774020">sub</span><span class="op" id="7774023">,</span>&nbsp;<span class="ident" id="7774025">got</span><span class="op" id="7774028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774031">}</span><br>
<span class="lineno">110</span><span class="op" id="7774033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7774036">type</span>&nbsp;<span class="ident" id="7774041">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="7774066">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7774074">func</span>&nbsp;<span class="op" id="7774079">(</span><span class="ident" id="7774080">ho</span>&nbsp;<span class="ident" id="7774083">headerOnlyResponseWriter</span><span class="op" id="7774107">)</span>&nbsp;<span class="ident" id="7774109">Header</span><span class="op" id="7774115">(</span><span class="op" id="7774116">)</span>&nbsp;<span class="ident" id="7774118">Header</span>&nbsp;<span class="op" id="7774125">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7774128">return</span>&nbsp;<span class="ident" id="7774135">Header</span><span class="op" id="7774141">(</span><span class="ident" id="7774142">ho</span><span class="op" id="7774144">)</span><br>
<span class="lineno"></span><span class="op" id="7774146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7774149">func</span>&nbsp;<span class="op" id="7774154">(</span><span class="ident" id="7774155">ho</span>&nbsp;<span class="ident" id="7774158">headerOnlyResponseWriter</span><span class="op" id="7774182">)</span>&nbsp;<span class="ident" id="7774184">Write</span><span class="op" id="7774189">(</span><span class="op" id="7774190">[</span><span class="op" id="7774191">]</span><span class="builtintype" id="7774192">byte</span><span class="op" id="7774196">)</span>&nbsp;<span class="op" id="7774198">(</span><span class="builtintype" id="7774199">int</span><span class="op" id="7774202">,</span>&nbsp;<span class="builtintype" id="7774204">error</span><span class="op" id="7774209">)</span>&nbsp;<span class="op" id="7774211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7774214">panic</span><span class="op" id="7774219">(</span><span class="string" id="7774220">&#34;NOIMPL&#34;</span><span class="op" id="7774228">)</span><br>
<span class="lineno">120</span><span class="op" id="7774230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7774233">func</span>&nbsp;<span class="op" id="7774238">(</span><span class="ident" id="7774239">ho</span>&nbsp;<span class="ident" id="7774242">headerOnlyResponseWriter</span><span class="op" id="7774266">)</span>&nbsp;<span class="ident" id="7774268">WriteHeader</span><span class="op" id="7774279">(</span><span class="builtintype" id="7774280">int</span><span class="op" id="7774283">)</span>&nbsp;<span class="op" id="7774285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7774288">panic</span><span class="op" id="7774293">(</span><span class="string" id="7774294">&#34;NOIMPL&#34;</span><span class="op" id="7774302">)</span><br>
<span class="lineno"></span><span class="op" id="7774304">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7774307">func</span>&nbsp;<span class="ident" id="7774312">TestSetCookie</span><span class="op" id="7774325">(</span><span class="ident" id="7774326">t</span>&nbsp;<span class="op" id="7774328">*</span><span class="ident" id="7774329">testing</span><span class="op" id="7774336">.</span><span class="ident" id="7774337">T</span><span class="op" id="7774338">)</span>&nbsp;<span class="op" id="7774340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774343">m</span>&nbsp;<span class="op" id="7774345">:=</span>&nbsp;<span class="builtinfunc" id="7774348">make</span><span class="op" id="7774352">(</span><span class="ident" id="7774353">Header</span><span class="op" id="7774359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774362">SetCookie</span><span class="op" id="7774371">(</span><span class="ident" id="7774372">headerOnlyResponseWriter</span><span class="op" id="7774396">(</span><span class="ident" id="7774397">m</span><span class="op" id="7774398">)</span><span class="op" id="7774399">,</span>&nbsp;<span class="op" id="7774401">&amp;</span><span class="ident" id="7774402">Cookie</span><span class="op" id="7774408">{</span><span class="ident" id="7774409">Name</span><span class="op" id="7774413">:</span>&nbsp;<span class="string" id="7774415">&#34;cookie-1&#34;</span><span class="op" id="7774425">,</span>&nbsp;<span class="ident" id="7774427">Value</span><span class="op" id="7774432">:</span>&nbsp;<span class="string" id="7774434">&#34;one&#34;</span><span class="op" id="7774439">,</span>&nbsp;<span class="ident" id="7774441">Path</span><span class="op" id="7774445">:</span>&nbsp;<span class="string" id="7774447">&#34;/restricted/&#34;</span><span class="op" id="7774461">}</span><span class="op" id="7774462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774465">SetCookie</span><span class="op" id="7774474">(</span><span class="ident" id="7774475">headerOnlyResponseWriter</span><span class="op" id="7774499">(</span><span class="ident" id="7774500">m</span><span class="op" id="7774501">)</span><span class="op" id="7774502">,</span>&nbsp;<span class="op" id="7774504">&amp;</span><span class="ident" id="7774505">Cookie</span><span class="op" id="7774511">{</span><span class="ident" id="7774512">Name</span><span class="op" id="7774516">:</span>&nbsp;<span class="string" id="7774518">&#34;cookie-2&#34;</span><span class="op" id="7774528">,</span>&nbsp;<span class="ident" id="7774530">Value</span><span class="op" id="7774535">:</span>&nbsp;<span class="string" id="7774537">&#34;two&#34;</span><span class="op" id="7774542">,</span>&nbsp;<span class="ident" id="7774544">MaxAge</span><span class="op" id="7774550">:</span>&nbsp;<span class="num" id="7774552">3600</span><span class="op" id="7774556">}</span><span class="op" id="7774557">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7774560">if</span>&nbsp;<span class="ident" id="7774563">l</span>&nbsp;<span class="op" id="7774565">:=</span>&nbsp;<span class="builtinfunc" id="7774568">len</span><span class="op" id="7774571">(</span><span class="ident" id="7774572">m</span><span class="op" id="7774573">[</span><span class="string" id="7774574">&#34;Set-Cookie&#34;</span><span class="op" id="7774586">]</span><span class="op" id="7774587">)</span><span class="op" id="7774588">;</span>&nbsp;<span class="ident" id="7774590">l</span>&nbsp;<span class="op" id="7774592">!=</span>&nbsp;<span class="num" id="7774595">2</span>&nbsp;<span class="op" id="7774597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774601">t</span><span class="op" id="7774602">.</span><span class="ident" id="7774603">Fatalf</span><span class="op" id="7774609">(</span><span class="string" id="7774610">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7774639">,</span>&nbsp;<span class="num" id="7774641">2</span><span class="op" id="7774642">,</span>&nbsp;<span class="ident" id="7774644">l</span><span class="op" id="7774645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7774651">if</span>&nbsp;<span class="ident" id="7774654">g</span><span class="op" id="7774655">,</span>&nbsp;<span class="ident" id="7774657">e</span>&nbsp;<span class="op" id="7774659">:=</span>&nbsp;<span class="ident" id="7774662">m</span><span class="op" id="7774663">[</span><span class="string" id="7774664">&#34;Set-Cookie&#34;</span><span class="op" id="7774676">]</span><span class="op" id="7774677">[</span><span class="num" id="7774678">0</span><span class="op" id="7774679">]</span><span class="op" id="7774680">,</span>&nbsp;<span class="string" id="7774682">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7774715">;</span>&nbsp;<span class="ident" id="7774717">g</span>&nbsp;<span class="op" id="7774719">!=</span>&nbsp;<span class="ident" id="7774722">e</span>&nbsp;<span class="op" id="7774724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774728">t</span><span class="op" id="7774729">.</span><span class="ident" id="7774730">Errorf</span><span class="op" id="7774736">(</span><span class="string" id="7774737">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7774765">,</span>&nbsp;<span class="ident" id="7774767">e</span><span class="op" id="7774768">,</span>&nbsp;<span class="ident" id="7774770">g</span><span class="op" id="7774771">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7774777">if</span>&nbsp;<span class="ident" id="7774780">g</span><span class="op" id="7774781">,</span>&nbsp;<span class="ident" id="7774783">e</span>&nbsp;<span class="op" id="7774785">:=</span>&nbsp;<span class="ident" id="7774788">m</span><span class="op" id="7774789">[</span><span class="string" id="7774790">&#34;Set-Cookie&#34;</span><span class="op" id="7774802">]</span><span class="op" id="7774803">[</span><span class="num" id="7774804">1</span><span class="op" id="7774805">]</span><span class="op" id="7774806">,</span>&nbsp;<span class="string" id="7774808">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7774836">;</span>&nbsp;<span class="ident" id="7774838">g</span>&nbsp;<span class="op" id="7774840">!=</span>&nbsp;<span class="ident" id="7774843">e</span>&nbsp;<span class="op" id="7774845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774849">t</span><span class="op" id="7774850">.</span><span class="ident" id="7774851">Errorf</span><span class="op" id="7774857">(</span><span class="string" id="7774858">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7774886">,</span>&nbsp;<span class="ident" id="7774888">e</span><span class="op" id="7774889">,</span>&nbsp;<span class="ident" id="7774891">g</span><span class="op" id="7774892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774895">}</span><br>
<span class="lineno"></span><span class="op" id="7774897">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7774900">var</span>&nbsp;<span class="ident" id="7774904">addCookieTests</span>&nbsp;<span class="op" id="7774919">=</span>&nbsp;<span class="op" id="7774921">[</span><span class="op" id="7774922">]</span><span class="keyword" id="7774923">struct</span>&nbsp;<span class="op" id="7774930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774933">Cookies</span>&nbsp;<span class="op" id="7774941">[</span><span class="op" id="7774942">]</span><span class="op" id="7774943">*</span><span class="ident" id="7774944">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7774952">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7774960">string</span><br>
<span class="lineno"></span><span class="op" id="7774967">}</span><span class="op" id="7774968">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774975">[</span><span class="op" id="7774976">]</span><span class="op" id="7774977">*</span><span class="ident" id="7774978">Cookie</span><span class="op" id="7774984">{</span><span class="op" id="7774985">}</span><span class="op" id="7774986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7774990">&#34;&#34;</span><span class="op" id="7774992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774995">}</span><span class="op" id="7774996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7774999">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775003">[</span><span class="op" id="7775004">]</span><span class="op" id="7775005">*</span><span class="ident" id="7775006">Cookie</span><span class="op" id="7775012">{</span><span class="op" id="7775013">{</span><span class="ident" id="7775014">Name</span><span class="op" id="7775018">:</span>&nbsp;<span class="string" id="7775020">&#34;cookie-1&#34;</span><span class="op" id="7775030">,</span>&nbsp;<span class="ident" id="7775032">Value</span><span class="op" id="7775037">:</span>&nbsp;<span class="string" id="7775039">&#34;v$1&#34;</span><span class="op" id="7775044">}</span><span class="op" id="7775045">}</span><span class="op" id="7775046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7775050">&#34;cookie-1=v$1&#34;</span><span class="op" id="7775064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775067">}</span><span class="op" id="7775068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775075">[</span><span class="op" id="7775076">]</span><span class="op" id="7775077">*</span><span class="ident" id="7775078">Cookie</span><span class="op" id="7775084">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775089">{</span><span class="ident" id="7775090">Name</span><span class="op" id="7775094">:</span>&nbsp;<span class="string" id="7775096">&#34;cookie-1&#34;</span><span class="op" id="7775106">,</span>&nbsp;<span class="ident" id="7775108">Value</span><span class="op" id="7775113">:</span>&nbsp;<span class="string" id="7775115">&#34;v$1&#34;</span><span class="op" id="7775120">}</span><span class="op" id="7775121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775126">{</span><span class="ident" id="7775127">Name</span><span class="op" id="7775131">:</span>&nbsp;<span class="string" id="7775133">&#34;cookie-2&#34;</span><span class="op" id="7775143">,</span>&nbsp;<span class="ident" id="7775145">Value</span><span class="op" id="7775150">:</span>&nbsp;<span class="string" id="7775152">&#34;v$2&#34;</span><span class="op" id="7775157">}</span><span class="op" id="7775158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775163">{</span><span class="ident" id="7775164">Name</span><span class="op" id="7775168">:</span>&nbsp;<span class="string" id="7775170">&#34;cookie-3&#34;</span><span class="op" id="7775180">,</span>&nbsp;<span class="ident" id="7775182">Value</span><span class="op" id="7775187">:</span>&nbsp;<span class="string" id="7775189">&#34;v$3&#34;</span><span class="op" id="7775194">}</span><span class="op" id="7775195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775199">}</span><span class="op" id="7775200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7775204">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="7775246">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775249">}</span><span class="op" id="7775250">,</span><br>
<span class="lineno"></span><span class="op" id="7775252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7775255">func</span>&nbsp;<span class="ident" id="7775260">TestAddCookie</span><span class="op" id="7775273">(</span><span class="ident" id="7775274">t</span>&nbsp;<span class="op" id="7775276">*</span><span class="ident" id="7775277">testing</span><span class="op" id="7775284">.</span><span class="ident" id="7775285">T</span><span class="op" id="7775286">)</span>&nbsp;<span class="op" id="7775288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775291">for</span>&nbsp;<span class="ident" id="7775295">i</span><span class="op" id="7775296">,</span>&nbsp;<span class="ident" id="7775298">tt</span>&nbsp;<span class="op" id="7775301">:=</span>&nbsp;<span class="keyword" id="7775304">range</span>&nbsp;<span class="ident" id="7775310">addCookieTests</span>&nbsp;<span class="op" id="7775325">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775329">req</span><span class="op" id="7775332">,</span>&nbsp;<span class="ident" id="7775334">_</span>&nbsp;<span class="op" id="7775336">:=</span>&nbsp;<span class="ident" id="7775339">NewRequest</span><span class="op" id="7775349">(</span><span class="string" id="7775350">&#34;GET&#34;</span><span class="op" id="7775355">,</span>&nbsp;<span class="string" id="7775357">&#34;http://example.com/&#34;</span><span class="op" id="7775378">,</span>&nbsp;<span class="ident" id="7775380">nil</span><span class="op" id="7775383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775387">for</span>&nbsp;<span class="ident" id="7775391">_</span><span class="op" id="7775392">,</span>&nbsp;<span class="ident" id="7775394">c</span>&nbsp;<span class="op" id="7775396">:=</span>&nbsp;<span class="keyword" id="7775399">range</span>&nbsp;<span class="ident" id="7775405">tt</span><span class="op" id="7775407">.</span><span class="ident" id="7775408">Cookies</span>&nbsp;<span class="op" id="7775416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775421">req</span><span class="op" id="7775424">.</span><span class="ident" id="7775425">AddCookie</span><span class="op" id="7775434">(</span><span class="ident" id="7775435">c</span><span class="op" id="7775436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775444">if</span>&nbsp;<span class="ident" id="7775447">g</span>&nbsp;<span class="op" id="7775449">:=</span>&nbsp;<span class="ident" id="7775452">req</span><span class="op" id="7775455">.</span><span class="ident" id="7775456">Header</span><span class="op" id="7775462">.</span><span class="ident" id="7775463">Get</span><span class="op" id="7775466">(</span><span class="string" id="7775467">&#34;Cookie&#34;</span><span class="op" id="7775475">)</span><span class="op" id="7775476">;</span>&nbsp;<span class="ident" id="7775478">g</span>&nbsp;<span class="op" id="7775480">!=</span>&nbsp;<span class="ident" id="7775483">tt</span><span class="op" id="7775485">.</span><span class="ident" id="7775486">Raw</span>&nbsp;<span class="op" id="7775490">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775495">t</span><span class="op" id="7775496">.</span><span class="ident" id="7775497">Errorf</span><span class="op" id="7775503">(</span><span class="string" id="7775504">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="7775536">,</span>&nbsp;<span class="ident" id="7775538">i</span><span class="op" id="7775539">,</span>&nbsp;<span class="ident" id="7775541">tt</span><span class="op" id="7775543">.</span><span class="ident" id="7775544">Raw</span><span class="op" id="7775547">,</span>&nbsp;<span class="ident" id="7775549">g</span><span class="op" id="7775550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7775555">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775569">}</span><br>
<span class="lineno"></span><span class="op" id="7775571">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7775574">var</span>&nbsp;<span class="ident" id="7775578">readSetCookiesTests</span>&nbsp;<span class="op" id="7775598">=</span>&nbsp;<span class="op" id="7775600">[</span><span class="op" id="7775601">]</span><span class="keyword" id="7775602">struct</span>&nbsp;<span class="op" id="7775609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775612">Header</span>&nbsp;&nbsp;<span class="ident" id="7775620">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775628">Cookies</span>&nbsp;<span class="op" id="7775636">[</span><span class="op" id="7775637">]</span><span class="op" id="7775638">*</span><span class="ident" id="7775639">Cookie</span><br>
<span class="lineno"></span><span class="op" id="7775646">}</span><span class="op" id="7775647">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775654">Header</span><span class="op" id="7775660">{</span><span class="string" id="7775661">&#34;Set-Cookie&#34;</span><span class="op" id="7775673">:</span>&nbsp;<span class="op" id="7775675">{</span><span class="string" id="7775676">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7775690">}</span><span class="op" id="7775691">}</span><span class="op" id="7775692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775696">[</span><span class="op" id="7775697">]</span><span class="op" id="7775698">*</span><span class="ident" id="7775699">Cookie</span><span class="op" id="7775705">{</span><span class="op" id="7775706">{</span><span class="ident" id="7775707">Name</span><span class="op" id="7775711">:</span>&nbsp;<span class="string" id="7775713">&#34;Cookie-1&#34;</span><span class="op" id="7775723">,</span>&nbsp;<span class="ident" id="7775725">Value</span><span class="op" id="7775730">:</span>&nbsp;<span class="string" id="7775732">&#34;v$1&#34;</span><span class="op" id="7775737">,</span>&nbsp;<span class="ident" id="7775739">Raw</span><span class="op" id="7775742">:</span>&nbsp;<span class="string" id="7775744">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7775758">}</span><span class="op" id="7775759">}</span><span class="op" id="7775760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775763">}</span><span class="op" id="7775764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775767">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775771">Header</span><span class="op" id="7775777">{</span><span class="string" id="7775778">&#34;Set-Cookie&#34;</span><span class="op" id="7775790">:</span>&nbsp;<span class="op" id="7775792">{</span><span class="string" id="7775793">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7775892">}</span><span class="op" id="7775893">}</span><span class="op" id="7775894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7775898">[</span><span class="op" id="7775899">]</span><span class="op" id="7775900">*</span><span class="ident" id="7775901">Cookie</span><span class="op" id="7775907">{</span><span class="op" id="7775908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775913">Name</span><span class="op" id="7775917">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7775925">&#34;NID&#34;</span><span class="op" id="7775930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775935">Value</span><span class="op" id="7775940">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7775947">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="7775966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775971">Path</span><span class="op" id="7775975">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7775983">&#34;/&#34;</span><span class="op" id="7775986">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7775991">Domain</span><span class="op" id="7775997">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776003">&#34;.google.ch&#34;</span><span class="op" id="7776015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776020">HttpOnly</span><span class="op" id="7776028">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7776032">true</span><span class="op" id="7776036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776041">Expires</span><span class="op" id="7776048">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776053">time</span><span class="op" id="7776057">.</span><span class="ident" id="7776058">Date</span><span class="op" id="7776062">(</span><span class="num" id="7776063">2011</span><span class="op" id="7776067">,</span>&nbsp;<span class="num" id="7776069">11</span><span class="op" id="7776071">,</span>&nbsp;<span class="num" id="7776073">23</span><span class="op" id="7776075">,</span>&nbsp;<span class="num" id="7776077">1</span><span class="op" id="7776078">,</span>&nbsp;<span class="num" id="7776080">5</span><span class="op" id="7776081">,</span>&nbsp;<span class="num" id="7776083">3</span><span class="op" id="7776084">,</span>&nbsp;<span class="num" id="7776086">0</span><span class="op" id="7776087">,</span>&nbsp;<span class="ident" id="7776089">time</span><span class="op" id="7776093">.</span><span class="ident" id="7776094">UTC</span><span class="op" id="7776097">)</span><span class="op" id="7776098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776103">RawExpires</span><span class="op" id="7776113">:</span>&nbsp;<span class="string" id="7776115">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="7776146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776151">Raw</span><span class="op" id="7776154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776163">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7776262">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776266">}</span><span class="op" id="7776267">}</span><span class="op" id="7776268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776271">}</span><span class="op" id="7776272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776279">Header</span><span class="op" id="7776285">{</span><span class="string" id="7776286">&#34;Set-Cookie&#34;</span><span class="op" id="7776298">:</span>&nbsp;<span class="op" id="7776300">{</span><span class="string" id="7776301">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7776375">}</span><span class="op" id="7776376">}</span><span class="op" id="7776377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776381">[</span><span class="op" id="7776382">]</span><span class="op" id="7776383">*</span><span class="ident" id="7776384">Cookie</span><span class="op" id="7776390">{</span><span class="op" id="7776391">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776396">Name</span><span class="op" id="7776400">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776408">&#34;.ASPXAUTH&#34;</span><span class="op" id="7776419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776424">Value</span><span class="op" id="7776429">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776436">&#34;7E3AA&#34;</span><span class="op" id="7776443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776448">Path</span><span class="op" id="7776452">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776460">&#34;/&#34;</span><span class="op" id="7776463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776468">Expires</span><span class="op" id="7776475">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776480">time</span><span class="op" id="7776484">.</span><span class="ident" id="7776485">Date</span><span class="op" id="7776489">(</span><span class="num" id="7776490">2012</span><span class="op" id="7776494">,</span>&nbsp;<span class="num" id="7776496">3</span><span class="op" id="7776497">,</span>&nbsp;<span class="num" id="7776499">7</span><span class="op" id="7776500">,</span>&nbsp;<span class="num" id="7776502">14</span><span class="op" id="7776504">,</span>&nbsp;<span class="num" id="7776506">25</span><span class="op" id="7776508">,</span>&nbsp;<span class="num" id="7776510">6</span><span class="op" id="7776511">,</span>&nbsp;<span class="num" id="7776513">0</span><span class="op" id="7776514">,</span>&nbsp;<span class="ident" id="7776516">time</span><span class="op" id="7776520">.</span><span class="ident" id="7776521">UTC</span><span class="op" id="7776524">)</span><span class="op" id="7776525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776530">RawExpires</span><span class="op" id="7776540">:</span>&nbsp;<span class="string" id="7776542">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="7776573">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776578">HttpOnly</span><span class="op" id="7776586">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7776590">true</span><span class="op" id="7776594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776599">Raw</span><span class="op" id="7776602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776611">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7776685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776689">}</span><span class="op" id="7776690">}</span><span class="op" id="7776691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776694">}</span><span class="op" id="7776695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776698">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776702">Header</span><span class="op" id="7776708">{</span><span class="string" id="7776709">&#34;Set-Cookie&#34;</span><span class="op" id="7776721">:</span>&nbsp;<span class="op" id="7776723">{</span><span class="string" id="7776724">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7776765">}</span><span class="op" id="7776766">}</span><span class="op" id="7776767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776771">[</span><span class="op" id="7776772">]</span><span class="op" id="7776773">*</span><span class="ident" id="7776774">Cookie</span><span class="op" id="7776780">{</span><span class="op" id="7776781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776786">Name</span><span class="op" id="7776790">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776796">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="7776815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776820">Value</span><span class="op" id="7776825">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776830">&#34;foo&#34;</span><span class="op" id="7776835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776840">Path</span><span class="op" id="7776844">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776850">&#34;/&#34;</span><span class="op" id="7776853">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776858">HttpOnly</span><span class="op" id="7776866">:</span>&nbsp;<span class="builtintype" id="7776868">true</span><span class="op" id="7776872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7776877">Raw</span><span class="op" id="7776880">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7776887">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7776928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776932">}</span><span class="op" id="7776933">}</span><span class="op" id="7776934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7776937">}</span><span class="op" id="7776938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7776941">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7777014">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777062">Header</span><span class="op" id="7777068">{</span><span class="string" id="7777069">&#34;Set-Cookie&#34;</span><span class="op" id="7777081">:</span>&nbsp;<span class="op" id="7777083">{</span><span class="string" id="7777084">`special-1=a&nbsp;z`</span><span class="op" id="7777099">}</span><span class="op" id="7777100">}</span><span class="op" id="7777101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777105">[</span><span class="op" id="7777106">]</span><span class="op" id="7777107">*</span><span class="ident" id="7777108">Cookie</span><span class="op" id="7777114">{</span><span class="op" id="7777115">{</span><span class="ident" id="7777116">Name</span><span class="op" id="7777120">:</span>&nbsp;<span class="string" id="7777122">&#34;special-1&#34;</span><span class="op" id="7777133">,</span>&nbsp;<span class="ident" id="7777135">Value</span><span class="op" id="7777140">:</span>&nbsp;<span class="string" id="7777142">&#34;a&nbsp;z&#34;</span><span class="op" id="7777147">,</span>&nbsp;<span class="ident" id="7777149">Raw</span><span class="op" id="7777152">:</span>&nbsp;<span class="string" id="7777154">`special-1=a&nbsp;z`</span><span class="op" id="7777169">}</span><span class="op" id="7777170">}</span><span class="op" id="7777171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777174">}</span><span class="op" id="7777175">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777182">Header</span><span class="op" id="7777188">{</span><span class="string" id="7777189">&#34;Set-Cookie&#34;</span><span class="op" id="7777201">:</span>&nbsp;<span class="op" id="7777203">{</span><span class="string" id="7777204">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7777220">}</span><span class="op" id="7777221">}</span><span class="op" id="7777222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777226">[</span><span class="op" id="7777227">]</span><span class="op" id="7777228">*</span><span class="ident" id="7777229">Cookie</span><span class="op" id="7777235">{</span><span class="op" id="7777236">{</span><span class="ident" id="7777237">Name</span><span class="op" id="7777241">:</span>&nbsp;<span class="string" id="7777243">&#34;special-2&#34;</span><span class="op" id="7777254">,</span>&nbsp;<span class="ident" id="7777256">Value</span><span class="op" id="7777261">:</span>&nbsp;<span class="string" id="7777263">&#34;&nbsp;z&#34;</span><span class="op" id="7777267">,</span>&nbsp;<span class="ident" id="7777269">Raw</span><span class="op" id="7777272">:</span>&nbsp;<span class="string" id="7777274">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7777290">}</span><span class="op" id="7777291">}</span><span class="op" id="7777292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777295">}</span><span class="op" id="7777296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777299">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777303">Header</span><span class="op" id="7777309">{</span><span class="string" id="7777310">&#34;Set-Cookie&#34;</span><span class="op" id="7777322">:</span>&nbsp;<span class="op" id="7777324">{</span><span class="string" id="7777325">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7777341">}</span><span class="op" id="7777342">}</span><span class="op" id="7777343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777347">[</span><span class="op" id="7777348">]</span><span class="op" id="7777349">*</span><span class="ident" id="7777350">Cookie</span><span class="op" id="7777356">{</span><span class="op" id="7777357">{</span><span class="ident" id="7777358">Name</span><span class="op" id="7777362">:</span>&nbsp;<span class="string" id="7777364">&#34;special-3&#34;</span><span class="op" id="7777375">,</span>&nbsp;<span class="ident" id="7777377">Value</span><span class="op" id="7777382">:</span>&nbsp;<span class="string" id="7777384">&#34;a&nbsp;&#34;</span><span class="op" id="7777388">,</span>&nbsp;<span class="ident" id="7777390">Raw</span><span class="op" id="7777393">:</span>&nbsp;<span class="string" id="7777395">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7777411">}</span><span class="op" id="7777412">}</span><span class="op" id="7777413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777416">}</span><span class="op" id="7777417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777424">Header</span><span class="op" id="7777430">{</span><span class="string" id="7777431">&#34;Set-Cookie&#34;</span><span class="op" id="7777443">:</span>&nbsp;<span class="op" id="7777445">{</span><span class="string" id="7777446">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7777461">}</span><span class="op" id="7777462">}</span><span class="op" id="7777463">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777467">[</span><span class="op" id="7777468">]</span><span class="op" id="7777469">*</span><span class="ident" id="7777470">Cookie</span><span class="op" id="7777476">{</span><span class="op" id="7777477">{</span><span class="ident" id="7777478">Name</span><span class="op" id="7777482">:</span>&nbsp;<span class="string" id="7777484">&#34;special-4&#34;</span><span class="op" id="7777495">,</span>&nbsp;<span class="ident" id="7777497">Value</span><span class="op" id="7777502">:</span>&nbsp;<span class="string" id="7777504">&#34;&nbsp;&#34;</span><span class="op" id="7777507">,</span>&nbsp;<span class="ident" id="7777509">Raw</span><span class="op" id="7777512">:</span>&nbsp;<span class="string" id="7777514">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7777529">}</span><span class="op" id="7777530">}</span><span class="op" id="7777531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777534">}</span><span class="op" id="7777535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777542">Header</span><span class="op" id="7777548">{</span><span class="string" id="7777549">&#34;Set-Cookie&#34;</span><span class="op" id="7777561">:</span>&nbsp;<span class="op" id="7777563">{</span><span class="string" id="7777564">`special-5=a,z`</span><span class="op" id="7777579">}</span><span class="op" id="7777580">}</span><span class="op" id="7777581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777585">[</span><span class="op" id="7777586">]</span><span class="op" id="7777587">*</span><span class="ident" id="7777588">Cookie</span><span class="op" id="7777594">{</span><span class="op" id="7777595">{</span><span class="ident" id="7777596">Name</span><span class="op" id="7777600">:</span>&nbsp;<span class="string" id="7777602">&#34;special-5&#34;</span><span class="op" id="7777613">,</span>&nbsp;<span class="ident" id="7777615">Value</span><span class="op" id="7777620">:</span>&nbsp;<span class="string" id="7777622">&#34;a,z&#34;</span><span class="op" id="7777627">,</span>&nbsp;<span class="ident" id="7777629">Raw</span><span class="op" id="7777632">:</span>&nbsp;<span class="string" id="7777634">`special-5=a,z`</span><span class="op" id="7777649">}</span><span class="op" id="7777650">}</span><span class="op" id="7777651">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777654">}</span><span class="op" id="7777655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777662">Header</span><span class="op" id="7777668">{</span><span class="string" id="7777669">&#34;Set-Cookie&#34;</span><span class="op" id="7777681">:</span>&nbsp;<span class="op" id="7777683">{</span><span class="string" id="7777684">`special-6=&#34;,z&#34;`</span><span class="op" id="7777700">}</span><span class="op" id="7777701">}</span><span class="op" id="7777702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777706">[</span><span class="op" id="7777707">]</span><span class="op" id="7777708">*</span><span class="ident" id="7777709">Cookie</span><span class="op" id="7777715">{</span><span class="op" id="7777716">{</span><span class="ident" id="7777717">Name</span><span class="op" id="7777721">:</span>&nbsp;<span class="string" id="7777723">&#34;special-6&#34;</span><span class="op" id="7777734">,</span>&nbsp;<span class="ident" id="7777736">Value</span><span class="op" id="7777741">:</span>&nbsp;<span class="string" id="7777743">&#34;,z&#34;</span><span class="op" id="7777747">,</span>&nbsp;<span class="ident" id="7777749">Raw</span><span class="op" id="7777752">:</span>&nbsp;<span class="string" id="7777754">`special-6=&#34;,z&#34;`</span><span class="op" id="7777770">}</span><span class="op" id="7777771">}</span><span class="op" id="7777772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777775">}</span><span class="op" id="7777776">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777783">Header</span><span class="op" id="7777789">{</span><span class="string" id="7777790">&#34;Set-Cookie&#34;</span><span class="op" id="7777802">:</span>&nbsp;<span class="op" id="7777804">{</span><span class="string" id="7777805">`special-7=a,`</span><span class="op" id="7777819">}</span><span class="op" id="7777820">}</span><span class="op" id="7777821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777825">[</span><span class="op" id="7777826">]</span><span class="op" id="7777827">*</span><span class="ident" id="7777828">Cookie</span><span class="op" id="7777834">{</span><span class="op" id="7777835">{</span><span class="ident" id="7777836">Name</span><span class="op" id="7777840">:</span>&nbsp;<span class="string" id="7777842">&#34;special-7&#34;</span><span class="op" id="7777853">,</span>&nbsp;<span class="ident" id="7777855">Value</span><span class="op" id="7777860">:</span>&nbsp;<span class="string" id="7777862">&#34;a,&#34;</span><span class="op" id="7777866">,</span>&nbsp;<span class="ident" id="7777868">Raw</span><span class="op" id="7777871">:</span>&nbsp;<span class="string" id="7777873">`special-7=a,`</span><span class="op" id="7777887">}</span><span class="op" id="7777888">}</span><span class="op" id="7777889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777892">}</span><span class="op" id="7777893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777896">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777900">Header</span><span class="op" id="7777906">{</span><span class="string" id="7777907">&#34;Set-Cookie&#34;</span><span class="op" id="7777919">:</span>&nbsp;<span class="op" id="7777921">{</span><span class="string" id="7777922">`special-8=&#34;,&#34;`</span><span class="op" id="7777937">}</span><span class="op" id="7777938">}</span><span class="op" id="7777939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777943">[</span><span class="op" id="7777944">]</span><span class="op" id="7777945">*</span><span class="ident" id="7777946">Cookie</span><span class="op" id="7777952">{</span><span class="op" id="7777953">{</span><span class="ident" id="7777954">Name</span><span class="op" id="7777958">:</span>&nbsp;<span class="string" id="7777960">&#34;special-8&#34;</span><span class="op" id="7777971">,</span>&nbsp;<span class="ident" id="7777973">Value</span><span class="op" id="7777978">:</span>&nbsp;<span class="string" id="7777980">&#34;,&#34;</span><span class="op" id="7777983">,</span>&nbsp;<span class="ident" id="7777985">Raw</span><span class="op" id="7777988">:</span>&nbsp;<span class="string" id="7777990">`special-8=&#34;,&#34;`</span><span class="op" id="7778005">}</span><span class="op" id="7778006">}</span><span class="op" id="7778007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778010">}</span><span class="op" id="7778011">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7778015">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7778074">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7778137">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7778201">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7778212">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="7778356">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7778359">func</span>&nbsp;<span class="ident" id="7778364">toJSON</span><span class="op" id="7778370">(</span><span class="ident" id="7778371">v</span>&nbsp;<span class="keyword" id="7778373">interface</span><span class="op" id="7778382">{</span><span class="op" id="7778383">}</span><span class="op" id="7778384">)</span>&nbsp;<span class="builtintype" id="7778386">string</span>&nbsp;<span class="op" id="7778393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778396">b</span><span class="op" id="7778397">,</span>&nbsp;<span class="ident" id="7778399">err</span>&nbsp;<span class="op" id="7778403">:=</span>&nbsp;<span class="ident" id="7778406">json</span><span class="op" id="7778410">.</span><span class="ident" id="7778411">Marshal</span><span class="op" id="7778418">(</span><span class="ident" id="7778419">v</span><span class="op" id="7778420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778423">if</span>&nbsp;<span class="ident" id="7778426">err</span>&nbsp;<span class="op" id="7778430">!=</span>&nbsp;<span class="ident" id="7778433">nil</span>&nbsp;<span class="op" id="7778437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778441">return</span>&nbsp;<span class="ident" id="7778448">fmt</span><span class="op" id="7778451">.</span><span class="ident" id="7778452">Sprintf</span><span class="op" id="7778459">(</span><span class="string" id="7778460">&#34;%#v&#34;</span><span class="op" id="7778465">,</span>&nbsp;<span class="ident" id="7778467">v</span><span class="op" id="7778468">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778474">return</span>&nbsp;<span class="builtintype" id="7778481">string</span><span class="op" id="7778487">(</span><span class="ident" id="7778488">b</span><span class="op" id="7778489">)</span><br>
<span class="lineno"></span><span class="op" id="7778491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7778494">func</span>&nbsp;<span class="ident" id="7778499">TestReadSetCookies</span><span class="op" id="7778517">(</span><span class="ident" id="7778518">t</span>&nbsp;<span class="op" id="7778520">*</span><span class="ident" id="7778521">testing</span><span class="op" id="7778528">.</span><span class="ident" id="7778529">T</span><span class="op" id="7778530">)</span>&nbsp;<span class="op" id="7778532">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778535">for</span>&nbsp;<span class="ident" id="7778539">i</span><span class="op" id="7778540">,</span>&nbsp;<span class="ident" id="7778542">tt</span>&nbsp;<span class="op" id="7778545">:=</span>&nbsp;<span class="keyword" id="7778548">range</span>&nbsp;<span class="ident" id="7778554">readSetCookiesTests</span>&nbsp;<span class="op" id="7778574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778578">for</span>&nbsp;<span class="ident" id="7778582">n</span>&nbsp;<span class="op" id="7778584">:=</span>&nbsp;<span class="num" id="7778587">0</span><span class="op" id="7778588">;</span>&nbsp;<span class="ident" id="7778590">n</span>&nbsp;<span class="op" id="7778592">&lt;</span>&nbsp;<span class="num" id="7778594">2</span><span class="op" id="7778595">;</span>&nbsp;<span class="ident" id="7778597">n</span><span class="op" id="7778598">++</span>&nbsp;<span class="op" id="7778601">{</span>&nbsp;<span class="comment" id="7778603">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778659">c</span>&nbsp;<span class="op" id="7778661">:=</span>&nbsp;<span class="ident" id="7778664">readSetCookies</span><span class="op" id="7778678">(</span><span class="ident" id="7778679">tt</span><span class="op" id="7778681">.</span><span class="ident" id="7778682">Header</span><span class="op" id="7778688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778693">if</span>&nbsp;<span class="op" id="7778696">!</span><span class="ident" id="7778697">reflect</span><span class="op" id="7778704">.</span><span class="ident" id="7778705">DeepEqual</span><span class="op" id="7778714">(</span><span class="ident" id="7778715">c</span><span class="op" id="7778716">,</span>&nbsp;<span class="ident" id="7778718">tt</span><span class="op" id="7778720">.</span><span class="ident" id="7778721">Cookies</span><span class="op" id="7778728">)</span>&nbsp;<span class="op" id="7778730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778736">t</span><span class="op" id="7778737">.</span><span class="ident" id="7778738">Errorf</span><span class="op" id="7778744">(</span><span class="string" id="7778745">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="7778787">,</span>&nbsp;<span class="ident" id="7778789">i</span><span class="op" id="7778790">,</span>&nbsp;<span class="ident" id="7778792">toJSON</span><span class="op" id="7778798">(</span><span class="ident" id="7778799">c</span><span class="op" id="7778800">)</span><span class="op" id="7778801">,</span>&nbsp;<span class="ident" id="7778803">toJSON</span><span class="op" id="7778809">(</span><span class="ident" id="7778810">tt</span><span class="op" id="7778812">.</span><span class="ident" id="7778813">Cookies</span><span class="op" id="7778820">)</span><span class="op" id="7778821">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778827">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778846">}</span><br>
<span class="lineno"></span><span class="op" id="7778848">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="7778851">var</span>&nbsp;<span class="ident" id="7778855">readCookiesTests</span>&nbsp;<span class="op" id="7778872">=</span>&nbsp;<span class="op" id="7778874">[</span><span class="op" id="7778875">]</span><span class="keyword" id="7778876">struct</span>&nbsp;<span class="op" id="7778883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778886">Header</span>&nbsp;&nbsp;<span class="ident" id="7778894">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778902">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="7778910">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778918">Cookies</span>&nbsp;<span class="op" id="7778926">[</span><span class="op" id="7778927">]</span><span class="op" id="7778928">*</span><span class="ident" id="7778929">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="7778936">}</span><span class="op" id="7778937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778944">Header</span><span class="op" id="7778950">{</span><span class="string" id="7778951">&#34;Cookie&#34;</span><span class="op" id="7778959">:</span>&nbsp;<span class="op" id="7778961">{</span><span class="string" id="7778962">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7778976">,</span>&nbsp;<span class="string" id="7778978">&#34;c2=v2&#34;</span><span class="op" id="7778985">}</span><span class="op" id="7778986">}</span><span class="op" id="7778987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7778991">&#34;&#34;</span><span class="op" id="7778993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778997">[</span><span class="op" id="7778998">]</span><span class="op" id="7778999">*</span><span class="ident" id="7779000">Cookie</span><span class="op" id="7779006">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779011">{</span><span class="ident" id="7779012">Name</span><span class="op" id="7779016">:</span>&nbsp;<span class="string" id="7779018">&#34;Cookie-1&#34;</span><span class="op" id="7779028">,</span>&nbsp;<span class="ident" id="7779030">Value</span><span class="op" id="7779035">:</span>&nbsp;<span class="string" id="7779037">&#34;v$1&#34;</span><span class="op" id="7779042">}</span><span class="op" id="7779043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779048">{</span><span class="ident" id="7779049">Name</span><span class="op" id="7779053">:</span>&nbsp;<span class="string" id="7779055">&#34;c2&#34;</span><span class="op" id="7779059">,</span>&nbsp;<span class="ident" id="7779061">Value</span><span class="op" id="7779066">:</span>&nbsp;<span class="string" id="7779068">&#34;v2&#34;</span><span class="op" id="7779072">}</span><span class="op" id="7779073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779077">}</span><span class="op" id="7779078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779081">}</span><span class="op" id="7779082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779085">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779089">Header</span><span class="op" id="7779095">{</span><span class="string" id="7779096">&#34;Cookie&#34;</span><span class="op" id="7779104">:</span>&nbsp;<span class="op" id="7779106">{</span><span class="string" id="7779107">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7779121">,</span>&nbsp;<span class="string" id="7779123">&#34;c2=v2&#34;</span><span class="op" id="7779130">}</span><span class="op" id="7779131">}</span><span class="op" id="7779132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7779136">&#34;c2&#34;</span><span class="op" id="7779140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779144">[</span><span class="op" id="7779145">]</span><span class="op" id="7779146">*</span><span class="ident" id="7779147">Cookie</span><span class="op" id="7779153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779158">{</span><span class="ident" id="7779159">Name</span><span class="op" id="7779163">:</span>&nbsp;<span class="string" id="7779165">&#34;c2&#34;</span><span class="op" id="7779169">,</span>&nbsp;<span class="ident" id="7779171">Value</span><span class="op" id="7779176">:</span>&nbsp;<span class="string" id="7779178">&#34;v2&#34;</span><span class="op" id="7779182">}</span><span class="op" id="7779183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779187">}</span><span class="op" id="7779188">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779191">}</span><span class="op" id="7779192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779199">Header</span><span class="op" id="7779205">{</span><span class="string" id="7779206">&#34;Cookie&#34;</span><span class="op" id="7779214">:</span>&nbsp;<span class="op" id="7779216">{</span><span class="string" id="7779217">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7779238">}</span><span class="op" id="7779239">}</span><span class="op" id="7779240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7779244">&#34;&#34;</span><span class="op" id="7779246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779250">[</span><span class="op" id="7779251">]</span><span class="op" id="7779252">*</span><span class="ident" id="7779253">Cookie</span><span class="op" id="7779259">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779264">{</span><span class="ident" id="7779265">Name</span><span class="op" id="7779269">:</span>&nbsp;<span class="string" id="7779271">&#34;Cookie-1&#34;</span><span class="op" id="7779281">,</span>&nbsp;<span class="ident" id="7779283">Value</span><span class="op" id="7779288">:</span>&nbsp;<span class="string" id="7779290">&#34;v$1&#34;</span><span class="op" id="7779295">}</span><span class="op" id="7779296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779301">{</span><span class="ident" id="7779302">Name</span><span class="op" id="7779306">:</span>&nbsp;<span class="string" id="7779308">&#34;c2&#34;</span><span class="op" id="7779312">,</span>&nbsp;<span class="ident" id="7779314">Value</span><span class="op" id="7779319">:</span>&nbsp;<span class="string" id="7779321">&#34;v2&#34;</span><span class="op" id="7779325">}</span><span class="op" id="7779326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779330">}</span><span class="op" id="7779331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779334">}</span><span class="op" id="7779335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779338">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779342">Header</span><span class="op" id="7779348">{</span><span class="string" id="7779349">&#34;Cookie&#34;</span><span class="op" id="7779357">:</span>&nbsp;<span class="op" id="7779359">{</span><span class="string" id="7779360">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7779381">}</span><span class="op" id="7779382">}</span><span class="op" id="7779383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7779387">&#34;c2&#34;</span><span class="op" id="7779391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779395">[</span><span class="op" id="7779396">]</span><span class="op" id="7779397">*</span><span class="ident" id="7779398">Cookie</span><span class="op" id="7779404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779409">{</span><span class="ident" id="7779410">Name</span><span class="op" id="7779414">:</span>&nbsp;<span class="string" id="7779416">&#34;c2&#34;</span><span class="op" id="7779420">,</span>&nbsp;<span class="ident" id="7779422">Value</span><span class="op" id="7779427">:</span>&nbsp;<span class="string" id="7779429">&#34;v2&#34;</span><span class="op" id="7779433">}</span><span class="op" id="7779434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779438">}</span><span class="op" id="7779439">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779442">}</span><span class="op" id="7779443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779450">Header</span><span class="op" id="7779456">{</span><span class="string" id="7779457">&#34;Cookie&#34;</span><span class="op" id="7779465">:</span>&nbsp;<span class="op" id="7779467">{</span><span class="string" id="7779468">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="7779493">}</span><span class="op" id="7779494">}</span><span class="op" id="7779495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7779499">&#34;&#34;</span><span class="op" id="7779501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779505">[</span><span class="op" id="7779506">]</span><span class="op" id="7779507">*</span><span class="ident" id="7779508">Cookie</span><span class="op" id="7779514">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779519">{</span><span class="ident" id="7779520">Name</span><span class="op" id="7779524">:</span>&nbsp;<span class="string" id="7779526">&#34;Cookie-1&#34;</span><span class="op" id="7779536">,</span>&nbsp;<span class="ident" id="7779538">Value</span><span class="op" id="7779543">:</span>&nbsp;<span class="string" id="7779545">&#34;v$1&#34;</span><span class="op" id="7779550">}</span><span class="op" id="7779551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779556">{</span><span class="ident" id="7779557">Name</span><span class="op" id="7779561">:</span>&nbsp;<span class="string" id="7779563">&#34;c2&#34;</span><span class="op" id="7779567">,</span>&nbsp;<span class="ident" id="7779569">Value</span><span class="op" id="7779574">:</span>&nbsp;<span class="string" id="7779576">&#34;v2&#34;</span><span class="op" id="7779580">}</span><span class="op" id="7779581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779585">}</span><span class="op" id="7779586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779589">}</span><span class="op" id="7779590">,</span><br>
<span class="lineno"></span><span class="op" id="7779592">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="7779595">func</span>&nbsp;<span class="ident" id="7779600">TestReadCookies</span><span class="op" id="7779615">(</span><span class="ident" id="7779616">t</span>&nbsp;<span class="op" id="7779618">*</span><span class="ident" id="7779619">testing</span><span class="op" id="7779626">.</span><span class="ident" id="7779627">T</span><span class="op" id="7779628">)</span>&nbsp;<span class="op" id="7779630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779633">for</span>&nbsp;<span class="ident" id="7779637">i</span><span class="op" id="7779638">,</span>&nbsp;<span class="ident" id="7779640">tt</span>&nbsp;<span class="op" id="7779643">:=</span>&nbsp;<span class="keyword" id="7779646">range</span>&nbsp;<span class="ident" id="7779652">readCookiesTests</span>&nbsp;<span class="op" id="7779669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779673">for</span>&nbsp;<span class="ident" id="7779677">n</span>&nbsp;<span class="op" id="7779679">:=</span>&nbsp;<span class="num" id="7779682">0</span><span class="op" id="7779683">;</span>&nbsp;<span class="ident" id="7779685">n</span>&nbsp;<span class="op" id="7779687">&lt;</span>&nbsp;<span class="num" id="7779689">2</span><span class="op" id="7779690">;</span>&nbsp;<span class="ident" id="7779692">n</span><span class="op" id="7779693">++</span>&nbsp;<span class="op" id="7779696">{</span>&nbsp;<span class="comment" id="7779698">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779751">c</span>&nbsp;<span class="op" id="7779753">:=</span>&nbsp;<span class="ident" id="7779756">readCookies</span><span class="op" id="7779767">(</span><span class="ident" id="7779768">tt</span><span class="op" id="7779770">.</span><span class="ident" id="7779771">Header</span><span class="op" id="7779777">,</span>&nbsp;<span class="ident" id="7779779">tt</span><span class="op" id="7779781">.</span><span class="ident" id="7779782">Filter</span><span class="op" id="7779788">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779793">if</span>&nbsp;<span class="op" id="7779796">!</span><span class="ident" id="7779797">reflect</span><span class="op" id="7779804">.</span><span class="ident" id="7779805">DeepEqual</span><span class="op" id="7779814">(</span><span class="ident" id="7779815">c</span><span class="op" id="7779816">,</span>&nbsp;<span class="ident" id="7779818">tt</span><span class="op" id="7779820">.</span><span class="ident" id="7779821">Cookies</span><span class="op" id="7779828">)</span>&nbsp;<span class="op" id="7779830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779836">t</span><span class="op" id="7779837">.</span><span class="ident" id="7779838">Errorf</span><span class="op" id="7779844">(</span><span class="string" id="7779845">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="7779885">,</span>&nbsp;<span class="ident" id="7779887">i</span><span class="op" id="7779888">,</span>&nbsp;<span class="ident" id="7779890">toJSON</span><span class="op" id="7779896">(</span><span class="ident" id="7779897">c</span><span class="op" id="7779898">)</span><span class="op" id="7779899">,</span>&nbsp;<span class="ident" id="7779901">toJSON</span><span class="op" id="7779907">(</span><span class="ident" id="7779908">tt</span><span class="op" id="7779910">.</span><span class="ident" id="7779911">Cookies</span><span class="op" id="7779918">)</span><span class="op" id="7779919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779925">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779941">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779944">}</span><br>
<span class="lineno"></span><span class="op" id="7779946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7779949">func</span>&nbsp;<span class="ident" id="7779954">TestSetCookieDoubleQuotes</span><span class="op" id="7779979">(</span><span class="ident" id="7779980">t</span>&nbsp;<span class="op" id="7779982">*</span><span class="ident" id="7779983">testing</span><span class="op" id="7779990">.</span><span class="ident" id="7779991">T</span><span class="op" id="7779992">)</span>&nbsp;<span class="op" id="7779994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779997">res</span>&nbsp;<span class="op" id="7780001">:=</span>&nbsp;<span class="op" id="7780004">&amp;</span><span class="ident" id="7780005">Response</span><span class="op" id="7780013">{</span><span class="ident" id="7780014">Header</span><span class="op" id="7780020">:</span>&nbsp;<span class="ident" id="7780022">Header</span><span class="op" id="7780028">{</span><span class="op" id="7780029">}</span><span class="op" id="7780030">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780033">res</span><span class="op" id="7780036">.</span><span class="ident" id="7780037">Header</span><span class="op" id="7780043">.</span><span class="ident" id="7780044">Add</span><span class="op" id="7780047">(</span><span class="string" id="7780048">&#34;Set-Cookie&#34;</span><span class="op" id="7780060">,</span>&nbsp;<span class="string" id="7780062">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="7780088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780091">res</span><span class="op" id="7780094">.</span><span class="ident" id="7780095">Header</span><span class="op" id="7780101">.</span><span class="ident" id="7780102">Add</span><span class="op" id="7780105">(</span><span class="string" id="7780106">&#34;Set-Cookie&#34;</span><span class="op" id="7780118">,</span>&nbsp;<span class="string" id="7780120">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="7780155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780158">res</span><span class="op" id="7780161">.</span><span class="ident" id="7780162">Header</span><span class="op" id="7780168">.</span><span class="ident" id="7780169">Add</span><span class="op" id="7780172">(</span><span class="string" id="7780173">&#34;Set-Cookie&#34;</span><span class="op" id="7780185">,</span>&nbsp;<span class="string" id="7780187">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="7780219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780222">res</span><span class="op" id="7780225">.</span><span class="ident" id="7780226">Header</span><span class="op" id="7780232">.</span><span class="ident" id="7780233">Add</span><span class="op" id="7780236">(</span><span class="string" id="7780237">&#34;Set-Cookie&#34;</span><span class="op" id="7780249">,</span>&nbsp;<span class="string" id="7780251">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="7780281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780284">got</span>&nbsp;<span class="op" id="7780288">:=</span>&nbsp;<span class="ident" id="7780291">res</span><span class="op" id="7780294">.</span><span class="ident" id="7780295">Cookies</span><span class="op" id="7780302">(</span><span class="op" id="7780303">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780306">want</span>&nbsp;<span class="op" id="7780311">:=</span>&nbsp;<span class="op" id="7780314">[</span><span class="op" id="7780315">]</span><span class="op" id="7780316">*</span><span class="ident" id="7780317">Cookie</span><span class="op" id="7780323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780327">{</span><span class="ident" id="7780328">Name</span><span class="op" id="7780332">:</span>&nbsp;<span class="string" id="7780334">&#34;quoted0&#34;</span><span class="op" id="7780343">,</span>&nbsp;<span class="ident" id="7780345">Value</span><span class="op" id="7780350">:</span>&nbsp;<span class="string" id="7780352">&#34;none&#34;</span><span class="op" id="7780358">,</span>&nbsp;<span class="ident" id="7780360">MaxAge</span><span class="op" id="7780366">:</span>&nbsp;<span class="num" id="7780368">30</span><span class="op" id="7780370">}</span><span class="op" id="7780371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780375">{</span><span class="ident" id="7780376">Name</span><span class="op" id="7780380">:</span>&nbsp;<span class="string" id="7780382">&#34;quoted1&#34;</span><span class="op" id="7780391">,</span>&nbsp;<span class="ident" id="7780393">Value</span><span class="op" id="7780398">:</span>&nbsp;<span class="string" id="7780400">&#34;cookieValue&#34;</span><span class="op" id="7780413">,</span>&nbsp;<span class="ident" id="7780415">MaxAge</span><span class="op" id="7780421">:</span>&nbsp;<span class="num" id="7780423">31</span><span class="op" id="7780425">}</span><span class="op" id="7780426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780430">{</span><span class="ident" id="7780431">Name</span><span class="op" id="7780435">:</span>&nbsp;<span class="string" id="7780437">&#34;quoted2&#34;</span><span class="op" id="7780446">,</span>&nbsp;<span class="ident" id="7780448">Value</span><span class="op" id="7780453">:</span>&nbsp;<span class="string" id="7780455">&#34;cookieAV&#34;</span><span class="op" id="7780465">}</span><span class="op" id="7780466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780470">{</span><span class="ident" id="7780471">Name</span><span class="op" id="7780475">:</span>&nbsp;<span class="string" id="7780477">&#34;quoted3&#34;</span><span class="op" id="7780486">,</span>&nbsp;<span class="ident" id="7780488">Value</span><span class="op" id="7780493">:</span>&nbsp;<span class="string" id="7780495">&#34;both&#34;</span><span class="op" id="7780501">}</span><span class="op" id="7780502">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7780508">if</span>&nbsp;<span class="builtinfunc" id="7780511">len</span><span class="op" id="7780514">(</span><span class="ident" id="7780515">got</span><span class="op" id="7780518">)</span>&nbsp;<span class="op" id="7780520">!=</span>&nbsp;<span class="builtinfunc" id="7780523">len</span><span class="op" id="7780526">(</span><span class="ident" id="7780527">want</span><span class="op" id="7780531">)</span>&nbsp;<span class="op" id="7780533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780537">t</span><span class="op" id="7780538">.</span><span class="ident" id="7780539">Fatal</span><span class="op" id="7780544">(</span><span class="string" id="7780545">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7780570">,</span>&nbsp;<span class="builtinfunc" id="7780572">len</span><span class="op" id="7780575">(</span><span class="ident" id="7780576">got</span><span class="op" id="7780579">)</span><span class="op" id="7780580">,</span>&nbsp;<span class="builtinfunc" id="7780582">len</span><span class="op" id="7780585">(</span><span class="ident" id="7780586">want</span><span class="op" id="7780590">)</span><span class="op" id="7780591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7780597">for</span>&nbsp;<span class="ident" id="7780601">i</span><span class="op" id="7780602">,</span>&nbsp;<span class="ident" id="7780604">w</span>&nbsp;<span class="op" id="7780606">:=</span>&nbsp;<span class="keyword" id="7780609">range</span>&nbsp;<span class="ident" id="7780615">want</span>&nbsp;<span class="op" id="7780620">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780624">g</span>&nbsp;<span class="op" id="7780626">:=</span>&nbsp;<span class="ident" id="7780629">got</span><span class="op" id="7780632">[</span><span class="ident" id="7780633">i</span><span class="op" id="7780634">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7780638">if</span>&nbsp;<span class="ident" id="7780641">g</span><span class="op" id="7780642">.</span><span class="ident" id="7780643">Name</span>&nbsp;<span class="op" id="7780648">!=</span>&nbsp;<span class="ident" id="7780651">w</span><span class="op" id="7780652">.</span><span class="ident" id="7780653">Name</span>&nbsp;<span class="op" id="7780658">||</span>&nbsp;<span class="ident" id="7780661">g</span><span class="op" id="7780662">.</span><span class="ident" id="7780663">Value</span>&nbsp;<span class="op" id="7780669">!=</span>&nbsp;<span class="ident" id="7780672">w</span><span class="op" id="7780673">.</span><span class="ident" id="7780674">Value</span>&nbsp;<span class="op" id="7780680">||</span>&nbsp;<span class="ident" id="7780683">g</span><span class="op" id="7780684">.</span><span class="ident" id="7780685">MaxAge</span>&nbsp;<span class="op" id="7780692">!=</span>&nbsp;<span class="ident" id="7780695">w</span><span class="op" id="7780696">.</span><span class="ident" id="7780697">MaxAge</span>&nbsp;<span class="op" id="7780704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780709">t</span><span class="op" id="7780710">.</span><span class="ident" id="7780711">Errorf</span><span class="op" id="7780717">(</span><span class="string" id="7780718">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7780749">,</span>&nbsp;<span class="ident" id="7780751">i</span><span class="op" id="7780752">,</span>&nbsp;<span class="ident" id="7780754">g</span><span class="op" id="7780755">,</span>&nbsp;<span class="ident" id="7780757">w</span><span class="op" id="7780758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780765">}</span><br>
<span class="lineno">360</span><span class="op" id="7780767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7780770">func</span>&nbsp;<span class="ident" id="7780775">TestCookieSanitizeValue</span><span class="op" id="7780798">(</span><span class="ident" id="7780799">t</span>&nbsp;<span class="op" id="7780801">*</span><span class="ident" id="7780802">testing</span><span class="op" id="7780809">.</span><span class="ident" id="7780810">T</span><span class="op" id="7780811">)</span>&nbsp;<span class="op" id="7780813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7780816">defer</span>&nbsp;<span class="ident" id="7780822">log</span><span class="op" id="7780825">.</span><span class="ident" id="7780826">SetOutput</span><span class="op" id="7780835">(</span><span class="ident" id="7780836">os</span><span class="op" id="7780838">.</span><span class="ident" id="7780839">Stderr</span><span class="op" id="7780845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7780848">var</span>&nbsp;<span class="ident" id="7780852">logbuf</span>&nbsp;<span class="ident" id="7780859">bytes</span><span class="op" id="7780864">.</span><span class="ident" id="7780865">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780873">log</span><span class="op" id="7780876">.</span><span class="ident" id="7780877">SetOutput</span><span class="op" id="7780886">(</span><span class="op" id="7780887">&amp;</span><span class="ident" id="7780888">logbuf</span><span class="op" id="7780894">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780898">tests</span>&nbsp;<span class="op" id="7780904">:=</span>&nbsp;<span class="op" id="7780907">[</span><span class="op" id="7780908">]</span><span class="keyword" id="7780909">struct</span>&nbsp;<span class="op" id="7780916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780920">in</span><span class="op" id="7780922">,</span>&nbsp;<span class="ident" id="7780924">want</span>&nbsp;<span class="builtintype" id="7780929">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780937">}</span><span class="op" id="7780938">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780942">{</span><span class="string" id="7780943">&#34;foo&#34;</span><span class="op" id="7780948">,</span>&nbsp;<span class="string" id="7780950">&#34;foo&#34;</span><span class="op" id="7780955">}</span><span class="op" id="7780956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780960">{</span><span class="string" id="7780961">&#34;foo;bar&#34;</span><span class="op" id="7780970">,</span>&nbsp;<span class="string" id="7780972">&#34;foobar&#34;</span><span class="op" id="7780980">}</span><span class="op" id="7780981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780985">{</span><span class="string" id="7780986">&#34;foo\\bar&#34;</span><span class="op" id="7780996">,</span>&nbsp;<span class="string" id="7780998">&#34;foobar&#34;</span><span class="op" id="7781006">}</span><span class="op" id="7781007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781011">{</span><span class="string" id="7781012">&#34;foo\&#34;bar&#34;</span><span class="op" id="7781022">,</span>&nbsp;<span class="string" id="7781024">&#34;foobar&#34;</span><span class="op" id="7781032">}</span><span class="op" id="7781033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781037">{</span><span class="string" id="7781038">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="7781056">,</span>&nbsp;<span class="string" id="7781058">&#34;\x7e&#34;</span><span class="op" id="7781064">}</span><span class="op" id="7781065">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781069">{</span><span class="string" id="7781070">`&#34;withquotes&#34;`</span><span class="op" id="7781084">,</span>&nbsp;<span class="string" id="7781086">&#34;withquotes&#34;</span><span class="op" id="7781098">}</span><span class="op" id="7781099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781103">{</span><span class="string" id="7781104">&#34;a&nbsp;z&#34;</span><span class="op" id="7781109">,</span>&nbsp;<span class="string" id="7781111">&#34;a&nbsp;z&#34;</span><span class="op" id="7781116">}</span><span class="op" id="7781117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781121">{</span><span class="string" id="7781122">&#34;&nbsp;z&#34;</span><span class="op" id="7781126">,</span>&nbsp;<span class="string" id="7781128">`&#34;&nbsp;z&#34;`</span><span class="op" id="7781134">}</span><span class="op" id="7781135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781139">{</span><span class="string" id="7781140">&#34;a&nbsp;&#34;</span><span class="op" id="7781144">,</span>&nbsp;<span class="string" id="7781146">`&#34;a&nbsp;&#34;`</span><span class="op" id="7781152">}</span><span class="op" id="7781153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781156">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7781159">for</span>&nbsp;<span class="ident" id="7781163">_</span><span class="op" id="7781164">,</span>&nbsp;<span class="ident" id="7781166">tt</span>&nbsp;<span class="op" id="7781169">:=</span>&nbsp;<span class="keyword" id="7781172">range</span>&nbsp;<span class="ident" id="7781178">tests</span>&nbsp;<span class="op" id="7781184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7781188">if</span>&nbsp;<span class="ident" id="7781191">got</span>&nbsp;<span class="op" id="7781195">:=</span>&nbsp;<span class="ident" id="7781198">sanitizeCookieValue</span><span class="op" id="7781217">(</span><span class="ident" id="7781218">tt</span><span class="op" id="7781220">.</span><span class="ident" id="7781221">in</span><span class="op" id="7781223">)</span><span class="op" id="7781224">;</span>&nbsp;<span class="ident" id="7781226">got</span>&nbsp;<span class="op" id="7781230">!=</span>&nbsp;<span class="ident" id="7781233">tt</span><span class="op" id="7781235">.</span><span class="ident" id="7781236">want</span>&nbsp;<span class="op" id="7781241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7781246">t</span><span class="op" id="7781247">.</span><span class="ident" id="7781248">Errorf</span><span class="op" id="7781254">(</span><span class="string" id="7781255">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7781294">,</span>&nbsp;<span class="ident" id="7781296">tt</span><span class="op" id="7781298">.</span><span class="ident" id="7781299">in</span><span class="op" id="7781301">,</span>&nbsp;<span class="ident" id="7781303">got</span><span class="op" id="7781306">,</span>&nbsp;<span class="ident" id="7781308">tt</span><span class="op" id="7781310">.</span><span class="ident" id="7781311">want</span><span class="op" id="7781315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781322">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7781326">if</span>&nbsp;<span class="ident" id="7781329">got</span><span class="op" id="7781332">,</span>&nbsp;<span class="ident" id="7781334">sub</span>&nbsp;<span class="op" id="7781338">:=</span>&nbsp;<span class="ident" id="7781341">logbuf</span><span class="op" id="7781347">.</span><span class="ident" id="7781348">String</span><span class="op" id="7781354">(</span><span class="op" id="7781355">)</span><span class="op" id="7781356">,</span>&nbsp;<span class="string" id="7781358">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7781382">;</span>&nbsp;<span class="op" id="7781384">!</span><span class="ident" id="7781385">strings</span><span class="op" id="7781392">.</span><span class="ident" id="7781393">Contains</span><span class="op" id="7781401">(</span><span class="ident" id="7781402">got</span><span class="op" id="7781405">,</span>&nbsp;<span class="ident" id="7781407">sub</span><span class="op" id="7781410">)</span>&nbsp;<span class="op" id="7781412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7781416">t</span><span class="op" id="7781417">.</span><span class="ident" id="7781418">Errorf</span><span class="op" id="7781424">(</span><span class="string" id="7781425">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7781472">,</span>&nbsp;<span class="ident" id="7781474">sub</span><span class="op" id="7781477">,</span>&nbsp;<span class="ident" id="7781479">got</span><span class="op" id="7781482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781485">}</span><br>
<span class="lineno"></span><span class="op" id="7781487">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="7781490">func</span>&nbsp;<span class="ident" id="7781495">TestCookieSanitizePath</span><span class="op" id="7781517">(</span><span class="ident" id="7781518">t</span>&nbsp;<span class="op" id="7781520">*</span><span class="ident" id="7781521">testing</span><span class="op" id="7781528">.</span><span class="ident" id="7781529">T</span><span class="op" id="7781530">)</span>&nbsp;<span class="op" id="7781532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7781535">defer</span>&nbsp;<span class="ident" id="7781541">log</span><span class="op" id="7781544">.</span><span class="ident" id="7781545">SetOutput</span><span class="op" id="7781554">(</span><span class="ident" id="7781555">os</span><span class="op" id="7781557">.</span><span class="ident" id="7781558">Stderr</span><span class="op" id="7781564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7781567">var</span>&nbsp;<span class="ident" id="7781571">logbuf</span>&nbsp;<span class="ident" id="7781578">bytes</span><span class="op" id="7781583">.</span><span class="ident" id="7781584">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7781592">log</span><span class="op" id="7781595">.</span><span class="ident" id="7781596">SetOutput</span><span class="op" id="7781605">(</span><span class="op" id="7781606">&amp;</span><span class="ident" id="7781607">logbuf</span><span class="op" id="7781613">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7781617">tests</span>&nbsp;<span class="op" id="7781623">:=</span>&nbsp;<span class="op" id="7781626">[</span><span class="op" id="7781627">]</span><span class="keyword" id="7781628">struct</span>&nbsp;<span class="op" id="7781635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7781639">in</span><span class="op" id="7781641">,</span>&nbsp;<span class="ident" id="7781643">want</span>&nbsp;<span class="builtintype" id="7781648">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781656">}</span><span class="op" id="7781657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781661">{</span><span class="string" id="7781662">&#34;/path&#34;</span><span class="op" id="7781669">,</span>&nbsp;<span class="string" id="7781671">&#34;/path&#34;</span><span class="op" id="7781678">}</span><span class="op" id="7781679">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781683">{</span><span class="string" id="7781684">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7781703">,</span>&nbsp;<span class="string" id="7781705">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7781724">}</span><span class="op" id="7781725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781729">{</span><span class="string" id="7781730">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="7781762">,</span>&nbsp;<span class="string" id="7781764">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="7781790">}</span><span class="op" id="7781791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7781797">for</span>&nbsp;<span class="ident" id="7781801">_</span><span class="op" id="7781802">,</span>&nbsp;<span class="ident" id="7781804">tt</span>&nbsp;<span class="op" id="7781807">:=</span>&nbsp;<span class="keyword" id="7781810">range</span>&nbsp;<span class="ident" id="7781816">tests</span>&nbsp;<span class="op" id="7781822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7781826">if</span>&nbsp;<span class="ident" id="7781829">got</span>&nbsp;<span class="op" id="7781833">:=</span>&nbsp;<span class="ident" id="7781836">sanitizeCookiePath</span><span class="op" id="7781854">(</span><span class="ident" id="7781855">tt</span><span class="op" id="7781857">.</span><span class="ident" id="7781858">in</span><span class="op" id="7781860">)</span><span class="op" id="7781861">;</span>&nbsp;<span class="ident" id="7781863">got</span>&nbsp;<span class="op" id="7781867">!=</span>&nbsp;<span class="ident" id="7781870">tt</span><span class="op" id="7781872">.</span><span class="ident" id="7781873">want</span>&nbsp;<span class="op" id="7781878">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7781883">t</span><span class="op" id="7781884">.</span><span class="ident" id="7781885">Errorf</span><span class="op" id="7781891">(</span><span class="string" id="7781892">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7781930">,</span>&nbsp;<span class="ident" id="7781932">tt</span><span class="op" id="7781934">.</span><span class="ident" id="7781935">in</span><span class="op" id="7781937">,</span>&nbsp;<span class="ident" id="7781939">got</span><span class="op" id="7781942">,</span>&nbsp;<span class="ident" id="7781944">tt</span><span class="op" id="7781946">.</span><span class="ident" id="7781947">want</span><span class="op" id="7781951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7781958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7781962">if</span>&nbsp;<span class="ident" id="7781965">got</span><span class="op" id="7781968">,</span>&nbsp;<span class="ident" id="7781970">sub</span>&nbsp;<span class="op" id="7781974">:=</span>&nbsp;<span class="ident" id="7781977">logbuf</span><span class="op" id="7781983">.</span><span class="ident" id="7781984">String</span><span class="op" id="7781990">(</span><span class="op" id="7781991">)</span><span class="op" id="7781992">,</span>&nbsp;<span class="string" id="7781994">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7782018">;</span>&nbsp;<span class="op" id="7782020">!</span><span class="ident" id="7782021">strings</span><span class="op" id="7782028">.</span><span class="ident" id="7782029">Contains</span><span class="op" id="7782037">(</span><span class="ident" id="7782038">got</span><span class="op" id="7782041">,</span>&nbsp;<span class="ident" id="7782043">sub</span><span class="op" id="7782046">)</span>&nbsp;<span class="op" id="7782048">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7782052">t</span><span class="op" id="7782053">.</span><span class="ident" id="7782054">Errorf</span><span class="op" id="7782060">(</span><span class="string" id="7782061">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7782108">,</span>&nbsp;<span class="ident" id="7782110">sub</span><span class="op" id="7782113">,</span>&nbsp;<span class="ident" id="7782115">got</span><span class="op" id="7782118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7782121">}</span><br>
<span class="lineno"></span><span class="op" id="7782123">}</span>
</div>
</body>
</html>
