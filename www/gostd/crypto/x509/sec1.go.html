<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3955033">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3955088">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3955142">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3955193">package</span>&nbsp;<span class="ident" id="3955201">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3955207">import</span>&nbsp;<span class="op" id="3955214">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3955217">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3955233">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3955252">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3955269">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3955279">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3955286">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3955297">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3955300">const</span>&nbsp;<span class="ident" id="3955306">ecPrivKeyVersion</span>&nbsp;<span class="op" id="3955323">=</span>&nbsp;<span class="num" id="3955325">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3955328">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="3955400">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="3955415">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="3955428">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="3955489">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3955562">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="3955587">type</span>&nbsp;<span class="ident" id="3955592">ecPrivateKey</span>&nbsp;<span class="keyword" id="3955605">struct</span>&nbsp;<span class="op" id="3955612">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955615">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3955629">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955634">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3955648">[</span><span class="op" id="3955649">]</span><span class="builtintype" id="3955650">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955656">NamedCurveOID</span>&nbsp;<span class="ident" id="3955670">asn1</span><span class="op" id="3955674">.</span><span class="ident" id="3955675">ObjectIdentifier</span>&nbsp;<span class="string" id="3955692">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955726">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955740">asn1</span><span class="op" id="3955744">.</span><span class="ident" id="3955745">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3955762">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3955795">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3955798">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="3955873">func</span>&nbsp;<span class="ident" id="3955878">ParseECPrivateKey</span><span class="op" id="3955895">(</span><span class="ident" id="3955896">der</span>&nbsp;<span class="op" id="3955900">[</span><span class="op" id="3955901">]</span><span class="builtintype" id="3955902">byte</span><span class="op" id="3955906">)</span>&nbsp;<span class="op" id="3955908">(</span><span class="ident" id="3955909">key</span>&nbsp;<span class="op" id="3955913">*</span><span class="ident" id="3955914">ecdsa</span><span class="op" id="3955919">.</span><span class="ident" id="3955920">PrivateKey</span><span class="op" id="3955930">,</span>&nbsp;<span class="ident" id="3955932">err</span>&nbsp;<span class="builtintype" id="3955936">error</span><span class="op" id="3955941">)</span>&nbsp;<span class="op" id="3955943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955946">return</span>&nbsp;<span class="ident" id="3955953">parseECPrivateKey</span><span class="op" id="3955970">(</span><span class="ident" id="3955971">nil</span><span class="op" id="3955974">,</span>&nbsp;<span class="ident" id="3955976">der</span><span class="op" id="3955979">)</span><br>
<span class="lineno"></span><span class="op" id="3955981">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3955984">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="3956058">func</span>&nbsp;<span class="ident" id="3956063">MarshalECPrivateKey</span><span class="op" id="3956082">(</span><span class="ident" id="3956083">key</span>&nbsp;<span class="op" id="3956087">*</span><span class="ident" id="3956088">ecdsa</span><span class="op" id="3956093">.</span><span class="ident" id="3956094">PrivateKey</span><span class="op" id="3956104">)</span>&nbsp;<span class="op" id="3956106">(</span><span class="op" id="3956107">[</span><span class="op" id="3956108">]</span><span class="builtintype" id="3956109">byte</span><span class="op" id="3956113">,</span>&nbsp;<span class="builtintype" id="3956115">error</span><span class="op" id="3956120">)</span>&nbsp;<span class="op" id="3956122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956125">oid</span><span class="op" id="3956128">,</span>&nbsp;<span class="ident" id="3956130">ok</span>&nbsp;<span class="op" id="3956133">:=</span>&nbsp;<span class="ident" id="3956136">oidFromNamedCurve</span><span class="op" id="3956153">(</span><span class="ident" id="3956154">key</span><span class="op" id="3956157">.</span><span class="ident" id="3956158">Curve</span><span class="op" id="3956163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956166">if</span>&nbsp;<span class="op" id="3956169">!</span><span class="ident" id="3956170">ok</span>&nbsp;<span class="op" id="3956173">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956177">return</span>&nbsp;<span class="ident" id="3956184">nil</span><span class="op" id="3956187">,</span>&nbsp;<span class="ident" id="3956189">errors</span><span class="op" id="3956195">.</span><span class="ident" id="3956196">New</span><span class="op" id="3956199">(</span><span class="string" id="3956200">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3956230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956236">return</span>&nbsp;<span class="ident" id="3956243">asn1</span><span class="op" id="3956247">.</span><span class="ident" id="3956248">Marshal</span><span class="op" id="3956255">(</span><span class="ident" id="3956256">ecPrivateKey</span><span class="op" id="3956268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956272">Version</span><span class="op" id="3956279">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3956287">1</span><span class="op" id="3956288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956292">PrivateKey</span><span class="op" id="3956302">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956307">key</span><span class="op" id="3956310">.</span><span class="ident" id="3956311">D</span><span class="op" id="3956312">.</span><span class="ident" id="3956313">Bytes</span><span class="op" id="3956318">(</span><span class="op" id="3956319">)</span><span class="op" id="3956320">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956324">NamedCurveOID</span><span class="op" id="3956337">:</span>&nbsp;<span class="ident" id="3956339">oid</span><span class="op" id="3956342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956346">PublicKey</span><span class="op" id="3956355">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956361">asn1</span><span class="op" id="3956365">.</span><span class="ident" id="3956366">BitString</span><span class="op" id="3956375">{</span><span class="ident" id="3956376">Bytes</span><span class="op" id="3956381">:</span>&nbsp;<span class="ident" id="3956383">elliptic</span><span class="op" id="3956391">.</span><span class="ident" id="3956392">Marshal</span><span class="op" id="3956399">(</span><span class="ident" id="3956400">key</span><span class="op" id="3956403">.</span><span class="ident" id="3956404">Curve</span><span class="op" id="3956409">,</span>&nbsp;<span class="ident" id="3956411">key</span><span class="op" id="3956414">.</span><span class="ident" id="3956415">X</span><span class="op" id="3956416">,</span>&nbsp;<span class="ident" id="3956418">key</span><span class="op" id="3956421">.</span><span class="ident" id="3956422">Y</span><span class="op" id="3956423">)</span><span class="op" id="3956424">}</span><span class="op" id="3956425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956428">}</span><span class="op" id="3956429">)</span><br>
<span class="lineno"></span><span class="op" id="3956431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3956434">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="3956509">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3956585">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="3956662">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="3956713">func</span>&nbsp;<span class="ident" id="3956718">parseECPrivateKey</span><span class="op" id="3956735">(</span><span class="ident" id="3956736">namedCurveOID</span>&nbsp;<span class="op" id="3956750">*</span><span class="ident" id="3956751">asn1</span><span class="op" id="3956755">.</span><span class="ident" id="3956756">ObjectIdentifier</span><span class="op" id="3956772">,</span>&nbsp;<span class="ident" id="3956774">der</span>&nbsp;<span class="op" id="3956778">[</span><span class="op" id="3956779">]</span><span class="builtintype" id="3956780">byte</span><span class="op" id="3956784">)</span>&nbsp;<span class="op" id="3956786">(</span><span class="ident" id="3956787">key</span>&nbsp;<span class="op" id="3956791">*</span><span class="ident" id="3956792">ecdsa</span><span class="op" id="3956797">.</span><span class="ident" id="3956798">PrivateKey</span><span class="op" id="3956808">,</span>&nbsp;<span class="ident" id="3956810">err</span>&nbsp;<span class="builtintype" id="3956814">error</span><span class="op" id="3956819">)</span>&nbsp;<span class="op" id="3956821">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956824">var</span>&nbsp;<span class="ident" id="3956828">privKey</span>&nbsp;<span class="ident" id="3956836">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956850">if</span>&nbsp;<span class="ident" id="3956853">_</span><span class="op" id="3956854">,</span>&nbsp;<span class="ident" id="3956856">err</span>&nbsp;<span class="op" id="3956860">:=</span>&nbsp;<span class="ident" id="3956863">asn1</span><span class="op" id="3956867">.</span><span class="ident" id="3956868">Unmarshal</span><span class="op" id="3956877">(</span><span class="ident" id="3956878">der</span><span class="op" id="3956881">,</span>&nbsp;<span class="op" id="3956883">&amp;</span><span class="ident" id="3956884">privKey</span><span class="op" id="3956891">)</span><span class="op" id="3956892">;</span>&nbsp;<span class="ident" id="3956894">err</span>&nbsp;<span class="op" id="3956898">!=</span>&nbsp;<span class="ident" id="3956901">nil</span>&nbsp;<span class="op" id="3956905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956909">return</span>&nbsp;<span class="ident" id="3956916">nil</span><span class="op" id="3956919">,</span>&nbsp;<span class="ident" id="3956921">errors</span><span class="op" id="3956927">.</span><span class="ident" id="3956928">New</span><span class="op" id="3956931">(</span><span class="string" id="3956932">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="3956973">+</span>&nbsp;<span class="ident" id="3956975">err</span><span class="op" id="3956978">.</span><span class="ident" id="3956979">Error</span><span class="op" id="3956984">(</span><span class="op" id="3956985">)</span><span class="op" id="3956986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956992">if</span>&nbsp;<span class="ident" id="3956995">privKey</span><span class="op" id="3957002">.</span><span class="ident" id="3957003">Version</span>&nbsp;<span class="op" id="3957011">!=</span>&nbsp;<span class="ident" id="3957014">ecPrivKeyVersion</span>&nbsp;<span class="op" id="3957031">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957035">return</span>&nbsp;<span class="ident" id="3957042">nil</span><span class="op" id="3957045">,</span>&nbsp;<span class="ident" id="3957047">fmt</span><span class="op" id="3957050">.</span><span class="ident" id="3957051">Errorf</span><span class="op" id="3957057">(</span><span class="string" id="3957058">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="3957099">,</span>&nbsp;<span class="ident" id="3957101">privKey</span><span class="op" id="3957108">.</span><span class="ident" id="3957109">Version</span><span class="op" id="3957116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957123">var</span>&nbsp;<span class="ident" id="3957127">curve</span>&nbsp;<span class="ident" id="3957133">elliptic</span><span class="op" id="3957141">.</span><span class="ident" id="3957142">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957149">if</span>&nbsp;<span class="ident" id="3957152">namedCurveOID</span>&nbsp;<span class="op" id="3957166">!=</span>&nbsp;<span class="ident" id="3957169">nil</span>&nbsp;<span class="op" id="3957173">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957177">curve</span>&nbsp;<span class="op" id="3957183">=</span>&nbsp;<span class="ident" id="3957185">namedCurveFromOID</span><span class="op" id="3957202">(</span><span class="op" id="3957203">*</span><span class="ident" id="3957204">namedCurveOID</span><span class="op" id="3957217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957220">}</span>&nbsp;<span class="keyword" id="3957222">else</span>&nbsp;<span class="op" id="3957227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957231">curve</span>&nbsp;<span class="op" id="3957237">=</span>&nbsp;<span class="ident" id="3957239">namedCurveFromOID</span><span class="op" id="3957256">(</span><span class="ident" id="3957257">privKey</span><span class="op" id="3957264">.</span><span class="ident" id="3957265">NamedCurveOID</span><span class="op" id="3957278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957284">if</span>&nbsp;<span class="ident" id="3957287">curve</span>&nbsp;<span class="op" id="3957293">==</span>&nbsp;<span class="ident" id="3957296">nil</span>&nbsp;<span class="op" id="3957300">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957304">return</span>&nbsp;<span class="ident" id="3957311">nil</span><span class="op" id="3957314">,</span>&nbsp;<span class="ident" id="3957316">errors</span><span class="op" id="3957322">.</span><span class="ident" id="3957323">New</span><span class="op" id="3957326">(</span><span class="string" id="3957327">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3957357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957364">k</span>&nbsp;<span class="op" id="3957366">:=</span>&nbsp;<span class="builtinfunc" id="3957369">new</span><span class="op" id="3957372">(</span><span class="ident" id="3957373">big</span><span class="op" id="3957376">.</span><span class="ident" id="3957377">Int</span><span class="op" id="3957380">)</span><span class="op" id="3957381">.</span><span class="ident" id="3957382">SetBytes</span><span class="op" id="3957390">(</span><span class="ident" id="3957391">privKey</span><span class="op" id="3957398">.</span><span class="ident" id="3957399">PrivateKey</span><span class="op" id="3957409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957412">if</span>&nbsp;<span class="ident" id="3957415">k</span><span class="op" id="3957416">.</span><span class="ident" id="3957417">Cmp</span><span class="op" id="3957420">(</span><span class="ident" id="3957421">curve</span><span class="op" id="3957426">.</span><span class="ident" id="3957427">Params</span><span class="op" id="3957433">(</span><span class="op" id="3957434">)</span><span class="op" id="3957435">.</span><span class="ident" id="3957436">N</span><span class="op" id="3957437">)</span>&nbsp;<span class="op" id="3957439">&gt;=</span>&nbsp;<span class="num" id="3957442">0</span>&nbsp;<span class="op" id="3957444">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957448">return</span>&nbsp;<span class="ident" id="3957455">nil</span><span class="op" id="3957458">,</span>&nbsp;<span class="ident" id="3957460">errors</span><span class="op" id="3957466">.</span><span class="ident" id="3957467">New</span><span class="op" id="3957470">(</span><span class="string" id="3957471">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="3957519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957525">priv</span>&nbsp;<span class="op" id="3957530">:=</span>&nbsp;<span class="builtinfunc" id="3957533">new</span><span class="op" id="3957536">(</span><span class="ident" id="3957537">ecdsa</span><span class="op" id="3957542">.</span><span class="ident" id="3957543">PrivateKey</span><span class="op" id="3957553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957556">priv</span><span class="op" id="3957560">.</span><span class="ident" id="3957561">Curve</span>&nbsp;<span class="op" id="3957567">=</span>&nbsp;<span class="ident" id="3957569">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957576">priv</span><span class="op" id="3957580">.</span><span class="ident" id="3957581">D</span>&nbsp;<span class="op" id="3957583">=</span>&nbsp;<span class="ident" id="3957585">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957588">priv</span><span class="op" id="3957592">.</span><span class="ident" id="3957593">X</span><span class="op" id="3957594">,</span>&nbsp;<span class="ident" id="3957596">priv</span><span class="op" id="3957600">.</span><span class="ident" id="3957601">Y</span>&nbsp;<span class="op" id="3957603">=</span>&nbsp;<span class="ident" id="3957605">curve</span><span class="op" id="3957610">.</span><span class="ident" id="3957611">ScalarBaseMult</span><span class="op" id="3957625">(</span><span class="ident" id="3957626">privKey</span><span class="op" id="3957633">.</span><span class="ident" id="3957634">PrivateKey</span><span class="op" id="3957644">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957648">return</span>&nbsp;<span class="ident" id="3957655">priv</span><span class="op" id="3957659">,</span>&nbsp;<span class="ident" id="3957661">nil</span><br>
<span class="lineno"></span><span class="op" id="3957665">}</span>
</div>
</body>
</html>
