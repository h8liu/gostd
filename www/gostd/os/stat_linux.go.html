<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html" class="current">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2573222">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2573277">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2573331">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2573382">package</span>&nbsp;<span class="ident" id="2573390">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2573394">import</span>&nbsp;<span class="op" id="2573401">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2573404">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2573415">&#34;time&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2573422">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2573425">func</span>&nbsp;<span class="ident" id="2573430">sameFile</span><span class="op" id="2573438">(</span><span class="ident" id="2573439">fs1</span><span class="op" id="2573442">,</span>&nbsp;<span class="ident" id="2573444">fs2</span>&nbsp;<span class="op" id="2573448">*</span><span class="ident" id="2573449">fileStat</span><span class="op" id="2573457">)</span>&nbsp;<span class="builtintype" id="2573459">bool</span>&nbsp;<span class="op" id="2573464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573467">stat1</span>&nbsp;<span class="op" id="2573473">:=</span>&nbsp;<span class="ident" id="2573476">fs1</span><span class="op" id="2573479">.</span><span class="ident" id="2573480">sys</span><span class="op" id="2573483">.</span><span class="op" id="2573484">(</span><span class="op" id="2573485">*</span><span class="ident" id="2573486">syscall</span><span class="op" id="2573493">.</span><span class="ident" id="2573494">Stat_t</span><span class="op" id="2573500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573503">stat2</span>&nbsp;<span class="op" id="2573509">:=</span>&nbsp;<span class="ident" id="2573512">fs2</span><span class="op" id="2573515">.</span><span class="ident" id="2573516">sys</span><span class="op" id="2573519">.</span><span class="op" id="2573520">(</span><span class="op" id="2573521">*</span><span class="ident" id="2573522">syscall</span><span class="op" id="2573529">.</span><span class="ident" id="2573530">Stat_t</span><span class="op" id="2573536">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2573539">return</span>&nbsp;<span class="ident" id="2573546">stat1</span><span class="op" id="2573551">.</span><span class="ident" id="2573552">Dev</span>&nbsp;<span class="op" id="2573556">==</span>&nbsp;<span class="ident" id="2573559">stat2</span><span class="op" id="2573564">.</span><span class="ident" id="2573565">Dev</span>&nbsp;<span class="op" id="2573569">&amp;&amp;</span>&nbsp;<span class="ident" id="2573572">stat1</span><span class="op" id="2573577">.</span><span class="ident" id="2573578">Ino</span>&nbsp;<span class="op" id="2573582">==</span>&nbsp;<span class="ident" id="2573585">stat2</span><span class="op" id="2573590">.</span><span class="ident" id="2573591">Ino</span><br>
<span class="lineno"></span><span class="op" id="2573595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2573598">func</span>&nbsp;<span class="ident" id="2573603">fileInfoFromStat</span><span class="op" id="2573619">(</span><span class="ident" id="2573620">st</span>&nbsp;<span class="op" id="2573623">*</span><span class="ident" id="2573624">syscall</span><span class="op" id="2573631">.</span><span class="ident" id="2573632">Stat_t</span><span class="op" id="2573638">,</span>&nbsp;<span class="ident" id="2573640">name</span>&nbsp;<span class="builtintype" id="2573645">string</span><span class="op" id="2573651">)</span>&nbsp;<span class="ident" id="2573653">FileInfo</span>&nbsp;<span class="op" id="2573662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573665">fs</span>&nbsp;<span class="op" id="2573668">:=</span>&nbsp;<span class="op" id="2573671">&amp;</span><span class="ident" id="2573672">fileStat</span><span class="op" id="2573680">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573684">name</span><span class="op" id="2573688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573693">basename</span><span class="op" id="2573701">(</span><span class="ident" id="2573702">name</span><span class="op" id="2573706">)</span><span class="op" id="2573707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573711">size</span><span class="op" id="2573715">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573720">int64</span><span class="op" id="2573725">(</span><span class="ident" id="2573726">st</span><span class="op" id="2573728">.</span><span class="ident" id="2573729">Size</span><span class="op" id="2573733">)</span><span class="op" id="2573734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573738">modTime</span><span class="op" id="2573745">:</span>&nbsp;<span class="ident" id="2573747">timespecToTime</span><span class="op" id="2573761">(</span><span class="ident" id="2573762">st</span><span class="op" id="2573764">.</span><span class="ident" id="2573765">Mtim</span><span class="op" id="2573769">)</span><span class="op" id="2573770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573774">sys</span><span class="op" id="2573777">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573783">st</span><span class="op" id="2573785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2573788">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573791">fs</span><span class="op" id="2573793">.</span><span class="ident" id="2573794">mode</span>&nbsp;<span class="op" id="2573799">=</span>&nbsp;<span class="ident" id="2573801">FileMode</span><span class="op" id="2573809">(</span><span class="ident" id="2573810">st</span><span class="op" id="2573812">.</span><span class="ident" id="2573813">Mode</span>&nbsp;<span class="op" id="2573818">&amp;</span>&nbsp;<span class="num" id="2573820">0777</span><span class="op" id="2573824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2573827">switch</span>&nbsp;<span class="ident" id="2573834">st</span><span class="op" id="2573836">.</span><span class="ident" id="2573837">Mode</span>&nbsp;<span class="op" id="2573842">&amp;</span>&nbsp;<span class="ident" id="2573844">syscall</span><span class="op" id="2573851">.</span><span class="ident" id="2573852">S_IFMT</span>&nbsp;<span class="op" id="2573859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2573862">case</span>&nbsp;<span class="ident" id="2573867">syscall</span><span class="op" id="2573874">.</span><span class="ident" id="2573875">S_IFBLK</span><span class="op" id="2573882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573886">fs</span><span class="op" id="2573888">.</span><span class="ident" id="2573889">mode</span>&nbsp;<span class="op" id="2573894">|=</span>&nbsp;<span class="ident" id="2573897">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2573909">case</span>&nbsp;<span class="ident" id="2573914">syscall</span><span class="op" id="2573921">.</span><span class="ident" id="2573922">S_IFCHR</span><span class="op" id="2573929">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573933">fs</span><span class="op" id="2573935">.</span><span class="ident" id="2573936">mode</span>&nbsp;<span class="op" id="2573941">|=</span>&nbsp;<span class="ident" id="2573944">ModeDevice</span>&nbsp;<span class="op" id="2573955">|</span>&nbsp;<span class="ident" id="2573957">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2573973">case</span>&nbsp;<span class="ident" id="2573978">syscall</span><span class="op" id="2573985">.</span><span class="ident" id="2573986">S_IFDIR</span><span class="op" id="2573993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573997">fs</span><span class="op" id="2573999">.</span><span class="ident" id="2574000">mode</span>&nbsp;<span class="op" id="2574005">|=</span>&nbsp;<span class="ident" id="2574008">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574017">case</span>&nbsp;<span class="ident" id="2574022">syscall</span><span class="op" id="2574029">.</span><span class="ident" id="2574030">S_IFIFO</span><span class="op" id="2574037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574041">fs</span><span class="op" id="2574043">.</span><span class="ident" id="2574044">mode</span>&nbsp;<span class="op" id="2574049">|=</span>&nbsp;<span class="ident" id="2574052">ModeNamedPipe</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574067">case</span>&nbsp;<span class="ident" id="2574072">syscall</span><span class="op" id="2574079">.</span><span class="ident" id="2574080">S_IFLNK</span><span class="op" id="2574087">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574091">fs</span><span class="op" id="2574093">.</span><span class="ident" id="2574094">mode</span>&nbsp;<span class="op" id="2574099">|=</span>&nbsp;<span class="ident" id="2574102">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574115">case</span>&nbsp;<span class="ident" id="2574120">syscall</span><span class="op" id="2574127">.</span><span class="ident" id="2574128">S_IFREG</span><span class="op" id="2574135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2574139">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574157">case</span>&nbsp;<span class="ident" id="2574162">syscall</span><span class="op" id="2574169">.</span><span class="ident" id="2574170">S_IFSOCK</span><span class="op" id="2574178">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574182">fs</span><span class="op" id="2574184">.</span><span class="ident" id="2574185">mode</span>&nbsp;<span class="op" id="2574190">|=</span>&nbsp;<span class="ident" id="2574193">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574208">if</span>&nbsp;<span class="ident" id="2574211">st</span><span class="op" id="2574213">.</span><span class="ident" id="2574214">Mode</span><span class="op" id="2574218">&amp;</span><span class="ident" id="2574219">syscall</span><span class="op" id="2574226">.</span><span class="ident" id="2574227">S_ISGID</span>&nbsp;<span class="op" id="2574235">!=</span>&nbsp;<span class="num" id="2574238">0</span>&nbsp;<span class="op" id="2574240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574244">fs</span><span class="op" id="2574246">.</span><span class="ident" id="2574247">mode</span>&nbsp;<span class="op" id="2574252">|=</span>&nbsp;<span class="ident" id="2574255">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574267">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574270">if</span>&nbsp;<span class="ident" id="2574273">st</span><span class="op" id="2574275">.</span><span class="ident" id="2574276">Mode</span><span class="op" id="2574280">&amp;</span><span class="ident" id="2574281">syscall</span><span class="op" id="2574288">.</span><span class="ident" id="2574289">S_ISUID</span>&nbsp;<span class="op" id="2574297">!=</span>&nbsp;<span class="num" id="2574300">0</span>&nbsp;<span class="op" id="2574302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574306">fs</span><span class="op" id="2574308">.</span><span class="ident" id="2574309">mode</span>&nbsp;<span class="op" id="2574314">|=</span>&nbsp;<span class="ident" id="2574317">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574332">if</span>&nbsp;<span class="ident" id="2574335">st</span><span class="op" id="2574337">.</span><span class="ident" id="2574338">Mode</span><span class="op" id="2574342">&amp;</span><span class="ident" id="2574343">syscall</span><span class="op" id="2574350">.</span><span class="ident" id="2574351">S_ISVTX</span>&nbsp;<span class="op" id="2574359">!=</span>&nbsp;<span class="num" id="2574362">0</span>&nbsp;<span class="op" id="2574364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574368">fs</span><span class="op" id="2574370">.</span><span class="ident" id="2574371">mode</span>&nbsp;<span class="op" id="2574376">|=</span>&nbsp;<span class="ident" id="2574379">ModeSticky</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574394">return</span>&nbsp;<span class="ident" id="2574401">fs</span><br>
<span class="lineno"></span><span class="op" id="2574404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2574407">func</span>&nbsp;<span class="ident" id="2574412">timespecToTime</span><span class="op" id="2574426">(</span><span class="ident" id="2574427">ts</span>&nbsp;<span class="ident" id="2574430">syscall</span><span class="op" id="2574437">.</span><span class="ident" id="2574438">Timespec</span><span class="op" id="2574446">)</span>&nbsp;<span class="ident" id="2574448">time</span><span class="op" id="2574452">.</span><span class="ident" id="2574453">Time</span>&nbsp;<span class="op" id="2574458">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574461">return</span>&nbsp;<span class="ident" id="2574468">time</span><span class="op" id="2574472">.</span><span class="ident" id="2574473">Unix</span><span class="op" id="2574477">(</span><span class="ident" id="2574478">int64</span><span class="op" id="2574483">(</span><span class="ident" id="2574484">ts</span><span class="op" id="2574486">.</span><span class="ident" id="2574487">Sec</span><span class="op" id="2574490">)</span><span class="op" id="2574491">,</span>&nbsp;<span class="ident" id="2574493">int64</span><span class="op" id="2574498">(</span><span class="ident" id="2574499">ts</span><span class="op" id="2574501">.</span><span class="ident" id="2574502">Nsec</span><span class="op" id="2574506">)</span><span class="op" id="2574507">)</span><br>
<span class="lineno"></span><span class="op" id="2574509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2574512">//&nbsp;For&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="2574528">func</span>&nbsp;<span class="ident" id="2574533">atime</span><span class="op" id="2574538">(</span><span class="ident" id="2574539">fi</span>&nbsp;<span class="ident" id="2574542">FileInfo</span><span class="op" id="2574550">)</span>&nbsp;<span class="ident" id="2574552">time</span><span class="op" id="2574556">.</span><span class="ident" id="2574557">Time</span>&nbsp;<span class="op" id="2574562">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574565">return</span>&nbsp;<span class="ident" id="2574572">timespecToTime</span><span class="op" id="2574586">(</span><span class="ident" id="2574587">fi</span><span class="op" id="2574589">.</span><span class="ident" id="2574590">Sys</span><span class="op" id="2574593">(</span><span class="op" id="2574594">)</span><span class="op" id="2574595">.</span><span class="op" id="2574596">(</span><span class="op" id="2574597">*</span><span class="ident" id="2574598">syscall</span><span class="op" id="2574605">.</span><span class="ident" id="2574606">Stat_t</span><span class="op" id="2574612">)</span><span class="op" id="2574613">.</span><span class="ident" id="2574614">Atim</span><span class="op" id="2574618">)</span><br>
<span class="lineno"></span><span class="op" id="2574620">}</span>
</div>
</body>
</html>
