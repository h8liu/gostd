<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5185911">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5185966">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5186020">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5186071">//&nbsp;Package&nbsp;smtp&nbsp;implements&nbsp;the&nbsp;Simple&nbsp;Mail&nbsp;Transfer&nbsp;Protocol&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;5321.</span><br>
<span class="lineno"></span><span class="comment" id="5186156">//&nbsp;It&nbsp;also&nbsp;implements&nbsp;the&nbsp;following&nbsp;extensions:</span><br>
<span class="lineno"></span><span class="comment" id="5186204">//&nbsp;&nbsp;&nbsp;&nbsp8BITMIME&nbsp;&nbsp;RFC&nbsp;1652</span><br>
<span class="lineno"></span><span class="comment" id="5186226">//&nbsp;&nbsp;&nbsp;&nbspAUTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RFC&nbsp;2554</span><br>
<span class="lineno"></span><span class="comment" id="5186248">//&nbsp;&nbsp;&nbsp;&nbspSTARTTLS&nbsp;&nbsp;RFC&nbsp;3207</span><br>
<span class="lineno">10</span><span class="comment" id="5186270">//&nbsp;Additional&nbsp;extensions&nbsp;may&nbsp;be&nbsp;handled&nbsp;by&nbsp;clients.</span><br>
<span class="lineno"></span><span class="keyword" id="5186322">package</span>&nbsp;<span class="ident" id="5186330">smtp</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5186336">import</span>&nbsp;<span class="op" id="5186343">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186346">&#34;crypto/tls&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186360">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186379">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186389">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186395">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186402">&#34;net/textproto&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186419">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5186429">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5186432">//&nbsp;A&nbsp;Client&nbsp;represents&nbsp;a&nbsp;client&nbsp;connection&nbsp;to&nbsp;an&nbsp;SMTP&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="5186494">type</span>&nbsp;<span class="ident" id="5186499">Client</span>&nbsp;<span class="keyword" id="5186506">struct</span>&nbsp;<span class="op" id="5186513">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186516">//&nbsp;Text&nbsp;is&nbsp;the&nbsp;textproto.Conn&nbsp;used&nbsp;by&nbsp;the&nbsp;Client.&nbsp;It&nbsp;is&nbsp;exported&nbsp;to&nbsp;allow&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186595">//&nbsp;clients&nbsp;to&nbsp;add&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186626">Text</span>&nbsp;<span class="op" id="5186631">*</span><span class="ident" id="5186632"><a href="/net/smtp/smtp.go.html#5186402">textproto</a></span><span class="op" id="5186641">.</span><span class="ident" id="5186642">Conn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186648">//&nbsp;keep&nbsp;a&nbsp;reference&nbsp;to&nbsp;the&nbsp;connection&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;create&nbsp;a&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186721">//&nbsp;connection&nbsp;later</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186742">conn</span>&nbsp;<span class="ident" id="5186747"><a href="/net/smtp/smtp.go.html#5186395">net</a></span><span class="op" id="5186750">.</span><span class="ident" id="5186751">Conn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186757">//&nbsp;whether&nbsp;the&nbsp;Client&nbsp;is&nbsp;using&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186793">tls</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5186804">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186810">serverName</span>&nbsp;<span class="builtintype" id="5186821">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186829">//&nbsp;map&nbsp;of&nbsp;supported&nbsp;extensions</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186861">ext</span>&nbsp;<span class="keyword" id="5186865">map</span><span class="op" id="5186868">[</span><span class="builtintype" id="5186869">string</span><span class="op" id="5186875">]</span><span class="builtintype" id="5186876">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186884">//&nbsp;supported&nbsp;auth&nbsp;mechanisms</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186914">auth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5186925">[</span><span class="op" id="5186926">]</span><span class="builtintype" id="5186927">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186935">localName</span>&nbsp;&nbsp;<span class="builtintype" id="5186946">string</span>&nbsp;<span class="comment" id="5186953">//&nbsp;the&nbsp;name&nbsp;to&nbsp;use&nbsp;in&nbsp;HELO/EHLO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186986">didHello</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5186997">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5187004">//&nbsp;whether&nbsp;we&#39;ve&nbsp;said&nbsp;HELO/EHLO</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187037">helloError</span>&nbsp;<span class="builtintype" id="5187048">error</span>&nbsp;&nbsp;<span class="comment" id="5187055">//&nbsp;the&nbsp;error&nbsp;from&nbsp;the&nbsp;hello</span><br>
<span class="lineno"></span><span class="op" id="5187083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5187086">//&nbsp;Dial&nbsp;returns&nbsp;a&nbsp;new&nbsp;Client&nbsp;connected&nbsp;to&nbsp;an&nbsp;SMTP&nbsp;server&nbsp;at&nbsp;addr.</span><br>
<span class="lineno"></span><span class="comment" id="5187152">//&nbsp;The&nbsp;addr&nbsp;must&nbsp;include&nbsp;a&nbsp;port&nbsp;number.</span><br>
<span class="lineno">45</span><span class="keyword" id="5187192">func</span>&nbsp;<span class="ident" id="5187197">Dial</span><span class="op" id="5187201">(</span><span class="ident" id="5187202">addr</span>&nbsp;<span class="builtintype" id="5187207">string</span><span class="op" id="5187213">)</span>&nbsp;<span class="op" id="5187215">(</span><span class="op" id="5187216">*</span><span class="ident" id="5187217"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5187223">,</span>&nbsp;<span class="builtintype" id="5187225">error</span><span class="op" id="5187230">)</span>&nbsp;<span class="op" id="5187232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187235">conn</span><span class="op" id="5187239">,</span>&nbsp;<span class="ident" id="5187241">err</span>&nbsp;<span class="op" id="5187245">:=</span>&nbsp;<span class="ident" id="5187248"><a href="/net/smtp/smtp.go.html#5186395">net</a></span><span class="op" id="5187251">.</span><span class="ident" id="5187252">Dial</span><span class="op" id="5187256">(</span><span class="string" id="5187257">&#34;tcp&#34;</span><span class="op" id="5187262">,</span>&nbsp;<span class="ident" id="5187264"><a href="/net/smtp/smtp.go.html#5187202">addr</a></span><span class="op" id="5187268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187271">if</span>&nbsp;<span class="ident" id="5187274"><a href="/net/smtp/smtp.go.html#5187241">err</a></span>&nbsp;<span class="op" id="5187278">!=</span>&nbsp;<span class="ident" id="5187281">nil</span>&nbsp;<span class="op" id="5187285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187289">return</span>&nbsp;<span class="ident" id="5187296">nil</span><span class="op" id="5187299">,</span>&nbsp;<span class="ident" id="5187301"><a href="/net/smtp/smtp.go.html#5187241">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187306">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187309">host</span><span class="op" id="5187313">,</span>&nbsp;<span class="ident" id="5187315">_</span><span class="op" id="5187316">,</span>&nbsp;<span class="ident" id="5187318">_</span>&nbsp;<span class="op" id="5187320">:=</span>&nbsp;<span class="ident" id="5187323"><a href="/net/smtp/smtp.go.html#5186395">net</a></span><span class="op" id="5187326">.</span><span class="ident" id="5187327">SplitHostPort</span><span class="op" id="5187340">(</span><span class="ident" id="5187341"><a href="/net/smtp/smtp.go.html#5187202">addr</a></span><span class="op" id="5187345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187348">return</span>&nbsp;<span class="ident" id="5187355"><a href="/net/smtp/smtp.go.html#5187509">NewClient</a></span><span class="op" id="5187364">(</span><span class="ident" id="5187365"><a href="/net/smtp/smtp.go.html#5187235">conn</a></span><span class="op" id="5187369">,</span>&nbsp;<span class="ident" id="5187371"><a href="/net/smtp/smtp.go.html#5187309">host</a></span><span class="op" id="5187375">)</span><br>
<span class="lineno"></span><span class="op" id="5187377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5187380">//&nbsp;NewClient&nbsp;returns&nbsp;a&nbsp;new&nbsp;Client&nbsp;using&nbsp;an&nbsp;existing&nbsp;connection&nbsp;and&nbsp;host&nbsp;as&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="5187457">//&nbsp;server&nbsp;name&nbsp;to&nbsp;be&nbsp;used&nbsp;when&nbsp;authenticating.</span><br>
<span class="lineno"></span><span class="keyword" id="5187504">func</span>&nbsp;<span class="ident" id="5187509">NewClient</span><span class="op" id="5187518">(</span><span class="ident" id="5187519">conn</span>&nbsp;<span class="ident" id="5187524"><a href="/net/smtp/smtp.go.html#5186395">net</a></span><span class="op" id="5187527">.</span><span class="ident" id="5187528">Conn</span><span class="op" id="5187532">,</span>&nbsp;<span class="ident" id="5187534">host</span>&nbsp;<span class="builtintype" id="5187539">string</span><span class="op" id="5187545">)</span>&nbsp;<span class="op" id="5187547">(</span><span class="op" id="5187548">*</span><span class="ident" id="5187549"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5187555">,</span>&nbsp;<span class="builtintype" id="5187557">error</span><span class="op" id="5187562">)</span>&nbsp;<span class="op" id="5187564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187567">text</span>&nbsp;<span class="op" id="5187572">:=</span>&nbsp;<span class="ident" id="5187575"><a href="/net/smtp/smtp.go.html#5186402">textproto</a></span><span class="op" id="5187584">.</span><span class="ident" id="5187585">NewConn</span><span class="op" id="5187592">(</span><span class="ident" id="5187593"><a href="/net/smtp/smtp.go.html#5187519">conn</a></span><span class="op" id="5187597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187600">_</span><span class="op" id="5187601">,</span>&nbsp;<span class="ident" id="5187603">_</span><span class="op" id="5187604">,</span>&nbsp;<span class="ident" id="5187606">err</span>&nbsp;<span class="op" id="5187610">:=</span>&nbsp;<span class="ident" id="5187613"><a href="/net/smtp/smtp.go.html#5187567">text</a></span><span class="op" id="5187617">.</span><span class="ident" id="5187618">ReadResponse</span><span class="op" id="5187630">(</span><span class="num" id="5187631">220</span><span class="op" id="5187634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187637">if</span>&nbsp;<span class="ident" id="5187640"><a href="/net/smtp/smtp.go.html#5187606">err</a></span>&nbsp;<span class="op" id="5187644">!=</span>&nbsp;<span class="ident" id="5187647">nil</span>&nbsp;<span class="op" id="5187651">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187655"><a href="/net/smtp/smtp.go.html#5187567">text</a></span><span class="op" id="5187659">.</span><span class="ident" id="5187660">Close</span><span class="op" id="5187665">(</span><span class="op" id="5187666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187670">return</span>&nbsp;<span class="ident" id="5187677">nil</span><span class="op" id="5187680">,</span>&nbsp;<span class="ident" id="5187682"><a href="/net/smtp/smtp.go.html#5187606">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187690">c</span>&nbsp;<span class="op" id="5187692">:=</span>&nbsp;<span class="op" id="5187695">&amp;</span><span class="ident" id="5187696"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5187702">{</span><span class="ident" id="5187703">Text</span><span class="op" id="5187707">:</span>&nbsp;<span class="ident" id="5187709"><a href="/net/smtp/smtp.go.html#5187567">text</a></span><span class="op" id="5187713">,</span>&nbsp;<span class="ident" id="5187715">conn</span><span class="op" id="5187719">:</span>&nbsp;<span class="ident" id="5187721"><a href="/net/smtp/smtp.go.html#5187519">conn</a></span><span class="op" id="5187725">,</span>&nbsp;<span class="ident" id="5187727">serverName</span><span class="op" id="5187737">:</span>&nbsp;<span class="ident" id="5187739"><a href="/net/smtp/smtp.go.html#5187534">host</a></span><span class="op" id="5187743">,</span>&nbsp;<span class="ident" id="5187745">localName</span><span class="op" id="5187754">:</span>&nbsp;<span class="string" id="5187756">&#34;localhost&#34;</span><span class="op" id="5187767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187770">return</span>&nbsp;<span class="ident" id="5187777"><a href="/net/smtp/smtp.go.html#5187690">c</a></span><span class="op" id="5187778">,</span>&nbsp;<span class="ident" id="5187780">nil</span><br>
<span class="lineno">65</span><span class="op" id="5187784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5187787">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="5187819">func</span>&nbsp;<span class="op" id="5187824">(</span><span class="ident" id="5187825">c</span>&nbsp;<span class="op" id="5187827">*</span><span class="ident" id="5187828"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5187834">)</span>&nbsp;<span class="ident" id="5187836">Close</span><span class="op" id="5187841">(</span><span class="op" id="5187842">)</span>&nbsp;<span class="builtintype" id="5187844">error</span>&nbsp;<span class="op" id="5187850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187853">return</span>&nbsp;<span class="ident" id="5187860"><a href="/net/smtp/smtp.go.html#5187825">c</a></span><span class="op" id="5187861">.</span><span class="ident" id="5187862">Text</span><span class="op" id="5187866">.</span><span class="ident" id="5187867">Close</span><span class="op" id="5187872">(</span><span class="op" id="5187873">)</span><br>
<span class="lineno">70</span><span class="op" id="5187875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5187878">//&nbsp;hello&nbsp;runs&nbsp;a&nbsp;hello&nbsp;exchange&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span><span class="keyword" id="5187920">func</span>&nbsp;<span class="op" id="5187925">(</span><span class="ident" id="5187926">c</span>&nbsp;<span class="op" id="5187928">*</span><span class="ident" id="5187929"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5187935">)</span>&nbsp;<span class="ident" id="5187937">hello</span><span class="op" id="5187942">(</span><span class="op" id="5187943">)</span>&nbsp;<span class="builtintype" id="5187945">error</span>&nbsp;<span class="op" id="5187951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187954">if</span>&nbsp;<span class="op" id="5187957">!</span><span class="ident" id="5187958"><a href="/net/smtp/smtp.go.html#5187926">c</a></span><span class="op" id="5187959">.</span><span class="ident" id="5187960">didHello</span>&nbsp;<span class="op" id="5187969">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187973"><a href="/net/smtp/smtp.go.html#5187926">c</a></span><span class="op" id="5187974">.</span><span class="ident" id="5187975">didHello</span>&nbsp;<span class="op" id="5187984">=</span>&nbsp;<span class="ident" id="5187986">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187993">err</span>&nbsp;<span class="op" id="5187997">:=</span>&nbsp;<span class="ident" id="5188000"><a href="/net/smtp/smtp.go.html#5187926">c</a></span><span class="op" id="5188001">.</span><span class="ident" id="5188002">ehlo</span><span class="op" id="5188006">(</span><span class="op" id="5188007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188011">if</span>&nbsp;<span class="ident" id="5188014"><a href="/net/smtp/smtp.go.html#5187993">err</a></span>&nbsp;<span class="op" id="5188018">!=</span>&nbsp;<span class="ident" id="5188021">nil</span>&nbsp;<span class="op" id="5188025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188030"><a href="/net/smtp/smtp.go.html#5187926">c</a></span><span class="op" id="5188031">.</span><span class="ident" id="5188032">helloError</span>&nbsp;<span class="op" id="5188043">=</span>&nbsp;<span class="ident" id="5188045"><a href="/net/smtp/smtp.go.html#5187926">c</a></span><span class="op" id="5188046">.</span><span class="ident" id="5188047">helo</span><span class="op" id="5188051">(</span><span class="op" id="5188052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5188056">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5188059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188062">return</span>&nbsp;<span class="ident" id="5188069"><a href="/net/smtp/smtp.go.html#5187926">c</a></span><span class="op" id="5188070">.</span><span class="ident" id="5188071">helloError</span><br>
<span class="lineno"></span><span class="op" id="5188082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5188085">//&nbsp;Hello&nbsp;sends&nbsp;a&nbsp;HELO&nbsp;or&nbsp;EHLO&nbsp;to&nbsp;the&nbsp;server&nbsp;as&nbsp;the&nbsp;given&nbsp;host&nbsp;name.</span><br>
<span class="lineno">85</span><span class="comment" id="5188153">//&nbsp;Calling&nbsp;this&nbsp;method&nbsp;is&nbsp;only&nbsp;necessary&nbsp;if&nbsp;the&nbsp;client&nbsp;needs&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="5188222">//&nbsp;over&nbsp;the&nbsp;host&nbsp;name&nbsp;used.&nbsp;&nbsp;The&nbsp;client&nbsp;will&nbsp;introduce&nbsp;itself&nbsp;as&nbsp;&#34;localhost&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5188299">//&nbsp;automatically&nbsp;otherwise.&nbsp;&nbsp;If&nbsp;Hello&nbsp;is&nbsp;called,&nbsp;it&nbsp;must&nbsp;be&nbsp;called&nbsp;before</span><br>
<span class="lineno"></span><span class="comment" id="5188373">//&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="5188402">func</span>&nbsp;<span class="op" id="5188407">(</span><span class="ident" id="5188408">c</span>&nbsp;<span class="op" id="5188410">*</span><span class="ident" id="5188411"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5188417">)</span>&nbsp;<span class="ident" id="5188419">Hello</span><span class="op" id="5188424">(</span><span class="ident" id="5188425">localName</span>&nbsp;<span class="builtintype" id="5188435">string</span><span class="op" id="5188441">)</span>&nbsp;<span class="builtintype" id="5188443">error</span>&nbsp;<span class="op" id="5188449">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188452">if</span>&nbsp;<span class="ident" id="5188455"><a href="/net/smtp/smtp.go.html#5188408">c</a></span><span class="op" id="5188456">.</span><span class="ident" id="5188457">didHello</span>&nbsp;<span class="op" id="5188466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188470">return</span>&nbsp;<span class="ident" id="5188477"><a href="/net/smtp/smtp.go.html#5186379">errors</a></span><span class="op" id="5188483">.</span><span class="ident" id="5188484">New</span><span class="op" id="5188487">(</span><span class="string" id="5188488">&#34;smtp:&nbsp;Hello&nbsp;called&nbsp;after&nbsp;other&nbsp;methods&#34;</span><span class="op" id="5188528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5188531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188534"><a href="/net/smtp/smtp.go.html#5188408">c</a></span><span class="op" id="5188535">.</span><span class="ident" id="5188536">localName</span>&nbsp;<span class="op" id="5188546">=</span>&nbsp;<span class="ident" id="5188548"><a href="/net/smtp/smtp.go.html#5188425">localName</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188559">return</span>&nbsp;<span class="ident" id="5188566"><a href="/net/smtp/smtp.go.html#5188408">c</a></span><span class="op" id="5188567">.</span><span class="ident" id="5188568">hello</span><span class="op" id="5188573">(</span><span class="op" id="5188574">)</span><br>
<span class="lineno">95</span><span class="op" id="5188576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5188579">//&nbsp;cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;function&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;and&nbsp;returns&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="keyword" id="5188658">func</span>&nbsp;<span class="op" id="5188663">(</span><span class="ident" id="5188664">c</span>&nbsp;<span class="op" id="5188666">*</span><span class="ident" id="5188667"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5188673">)</span>&nbsp;<span class="ident" id="5188675">cmd</span><span class="op" id="5188678">(</span><span class="ident" id="5188679">expectCode</span>&nbsp;<span class="builtintype" id="5188690">int</span><span class="op" id="5188693">,</span>&nbsp;<span class="ident" id="5188695">format</span>&nbsp;<span class="builtintype" id="5188702">string</span><span class="op" id="5188708">,</span>&nbsp;<span class="ident" id="5188710">args</span>&nbsp;<span class="op" id="5188715">...</span><span class="keyword" id="5188718">interface</span><span class="op" id="5188727">{</span><span class="op" id="5188728">}</span><span class="op" id="5188729">)</span>&nbsp;<span class="op" id="5188731">(</span><span class="builtintype" id="5188732">int</span><span class="op" id="5188735">,</span>&nbsp;<span class="builtintype" id="5188737">string</span><span class="op" id="5188743">,</span>&nbsp;<span class="builtintype" id="5188745">error</span><span class="op" id="5188750">)</span>&nbsp;<span class="op" id="5188752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188755">id</span><span class="op" id="5188757">,</span>&nbsp;<span class="ident" id="5188759">err</span>&nbsp;<span class="op" id="5188763">:=</span>&nbsp;<span class="ident" id="5188766"><a href="/net/smtp/smtp.go.html#5188664">c</a></span><span class="op" id="5188767">.</span><span class="ident" id="5188768">Text</span><span class="op" id="5188772">.</span><span class="ident" id="5188773">Cmd</span><span class="op" id="5188776">(</span><span class="ident" id="5188777"><a href="/net/smtp/smtp.go.html#5188695">format</a></span><span class="op" id="5188783">,</span>&nbsp;<span class="ident" id="5188785"><a href="/net/smtp/smtp.go.html#5188710">args</a></span><span class="op" id="5188789">...</span><span class="op" id="5188792">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188795">if</span>&nbsp;<span class="ident" id="5188798"><a href="/net/smtp/smtp.go.html#5188759">err</a></span>&nbsp;<span class="op" id="5188802">!=</span>&nbsp;<span class="ident" id="5188805">nil</span>&nbsp;<span class="op" id="5188809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188813">return</span>&nbsp;<span class="num" id="5188820">0</span><span class="op" id="5188821">,</span>&nbsp;<span class="string" id="5188823">&#34;&#34;</span><span class="op" id="5188825">,</span>&nbsp;<span class="ident" id="5188827"><a href="/net/smtp/smtp.go.html#5188759">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5188832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188835"><a href="/net/smtp/smtp.go.html#5188664">c</a></span><span class="op" id="5188836">.</span><span class="ident" id="5188837">Text</span><span class="op" id="5188841">.</span><span class="ident" id="5188842">StartResponse</span><span class="op" id="5188855">(</span><span class="ident" id="5188856"><a href="/net/smtp/smtp.go.html#5188755">id</a></span><span class="op" id="5188858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188861">defer</span>&nbsp;<span class="ident" id="5188867"><a href="/net/smtp/smtp.go.html#5188664">c</a></span><span class="op" id="5188868">.</span><span class="ident" id="5188869">Text</span><span class="op" id="5188873">.</span><span class="ident" id="5188874">EndResponse</span><span class="op" id="5188885">(</span><span class="ident" id="5188886"><a href="/net/smtp/smtp.go.html#5188755">id</a></span><span class="op" id="5188888">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188891">code</span><span class="op" id="5188895">,</span>&nbsp;<span class="ident" id="5188897">msg</span><span class="op" id="5188900">,</span>&nbsp;<span class="ident" id="5188902"><a href="/net/smtp/smtp.go.html#5188759">err</a></span>&nbsp;<span class="op" id="5188906">:=</span>&nbsp;<span class="ident" id="5188909"><a href="/net/smtp/smtp.go.html#5188664">c</a></span><span class="op" id="5188910">.</span><span class="ident" id="5188911">Text</span><span class="op" id="5188915">.</span><span class="ident" id="5188916">ReadResponse</span><span class="op" id="5188928">(</span><span class="ident" id="5188929"><a href="/net/smtp/smtp.go.html#5188679">expectCode</a></span><span class="op" id="5188939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188942">return</span>&nbsp;<span class="ident" id="5188949"><a href="/net/smtp/smtp.go.html#5188891">code</a></span><span class="op" id="5188953">,</span>&nbsp;<span class="ident" id="5188955"><a href="/net/smtp/smtp.go.html#5188897">msg</a></span><span class="op" id="5188958">,</span>&nbsp;<span class="ident" id="5188960"><a href="/net/smtp/smtp.go.html#5188759">err</a></span><br>
<span class="lineno"></span><span class="op" id="5188964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5188967">//&nbsp;helo&nbsp;sends&nbsp;the&nbsp;HELO&nbsp;greeting&nbsp;to&nbsp;the&nbsp;server.&nbsp;It&nbsp;should&nbsp;be&nbsp;used&nbsp;only&nbsp;when&nbsp;the</span><br>
<span class="lineno">110</span><span class="comment" id="5189046">//&nbsp;server&nbsp;does&nbsp;not&nbsp;support&nbsp;ehlo.</span><br>
<span class="lineno"></span><span class="keyword" id="5189079">func</span>&nbsp;<span class="op" id="5189084">(</span><span class="ident" id="5189085">c</span>&nbsp;<span class="op" id="5189087">*</span><span class="ident" id="5189088"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5189094">)</span>&nbsp;<span class="ident" id="5189096">helo</span><span class="op" id="5189100">(</span><span class="op" id="5189101">)</span>&nbsp;<span class="builtintype" id="5189103">error</span>&nbsp;<span class="op" id="5189109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189112"><a href="/net/smtp/smtp.go.html#5189085">c</a></span><span class="op" id="5189113">.</span><span class="ident" id="5189114">ext</span>&nbsp;<span class="op" id="5189118">=</span>&nbsp;<span class="ident" id="5189120">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189125">_</span><span class="op" id="5189126">,</span>&nbsp;<span class="ident" id="5189128">_</span><span class="op" id="5189129">,</span>&nbsp;<span class="ident" id="5189131">err</span>&nbsp;<span class="op" id="5189135">:=</span>&nbsp;<span class="ident" id="5189138"><a href="/net/smtp/smtp.go.html#5189085">c</a></span><span class="op" id="5189139">.</span><span class="ident" id="5189140">cmd</span><span class="op" id="5189143">(</span><span class="num" id="5189144">250</span><span class="op" id="5189147">,</span>&nbsp;<span class="string" id="5189149">&#34;HELO&nbsp;%s&#34;</span><span class="op" id="5189158">,</span>&nbsp;<span class="ident" id="5189160"><a href="/net/smtp/smtp.go.html#5189085">c</a></span><span class="op" id="5189161">.</span><span class="ident" id="5189162">localName</span><span class="op" id="5189171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189174">return</span>&nbsp;<span class="ident" id="5189181"><a href="/net/smtp/smtp.go.html#5189131">err</a></span><br>
<span class="lineno">115</span><span class="op" id="5189185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5189188">//&nbsp;ehlo&nbsp;sends&nbsp;the&nbsp;EHLO&nbsp;(extended&nbsp;hello)&nbsp;greeting&nbsp;to&nbsp;the&nbsp;server.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="5189255">//&nbsp;should&nbsp;be&nbsp;the&nbsp;preferred&nbsp;greeting&nbsp;for&nbsp;servers&nbsp;that&nbsp;support&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="5189320">func</span>&nbsp;<span class="op" id="5189325">(</span><span class="ident" id="5189326">c</span>&nbsp;<span class="op" id="5189328">*</span><span class="ident" id="5189329"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5189335">)</span>&nbsp;<span class="ident" id="5189337">ehlo</span><span class="op" id="5189341">(</span><span class="op" id="5189342">)</span>&nbsp;<span class="builtintype" id="5189344">error</span>&nbsp;<span class="op" id="5189350">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189353">_</span><span class="op" id="5189354">,</span>&nbsp;<span class="ident" id="5189356">msg</span><span class="op" id="5189359">,</span>&nbsp;<span class="ident" id="5189361">err</span>&nbsp;<span class="op" id="5189365">:=</span>&nbsp;<span class="ident" id="5189368"><a href="/net/smtp/smtp.go.html#5189326">c</a></span><span class="op" id="5189369">.</span><span class="ident" id="5189370">cmd</span><span class="op" id="5189373">(</span><span class="num" id="5189374">250</span><span class="op" id="5189377">,</span>&nbsp;<span class="string" id="5189379">&#34;EHLO&nbsp;%s&#34;</span><span class="op" id="5189388">,</span>&nbsp;<span class="ident" id="5189390"><a href="/net/smtp/smtp.go.html#5189326">c</a></span><span class="op" id="5189391">.</span><span class="ident" id="5189392">localName</span><span class="op" id="5189401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189404">if</span>&nbsp;<span class="ident" id="5189407"><a href="/net/smtp/smtp.go.html#5189361">err</a></span>&nbsp;<span class="op" id="5189411">!=</span>&nbsp;<span class="ident" id="5189414">nil</span>&nbsp;<span class="op" id="5189418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189422">return</span>&nbsp;<span class="ident" id="5189429"><a href="/net/smtp/smtp.go.html#5189361">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189437">ext</span>&nbsp;<span class="op" id="5189441">:=</span>&nbsp;<span class="builtinfunc" id="5189444">make</span><span class="op" id="5189448">(</span><span class="keyword" id="5189449">map</span><span class="op" id="5189452">[</span><span class="builtintype" id="5189453">string</span><span class="op" id="5189459">]</span><span class="builtintype" id="5189460">string</span><span class="op" id="5189466">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189469">extList</span>&nbsp;<span class="op" id="5189477">:=</span>&nbsp;<span class="ident" id="5189480"><a href="/net/smtp/smtp.go.html#5186419">strings</a></span><span class="op" id="5189487">.</span><span class="ident" id="5189488">Split</span><span class="op" id="5189493">(</span><span class="ident" id="5189494"><a href="/net/smtp/smtp.go.html#5189356">msg</a></span><span class="op" id="5189497">,</span>&nbsp;<span class="string" id="5189499">&#34;\n&#34;</span><span class="op" id="5189503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189506">if</span>&nbsp;<span class="builtinfunc" id="5189509">len</span><span class="op" id="5189512">(</span><span class="ident" id="5189513"><a href="/net/smtp/smtp.go.html#5189469">extList</a></span><span class="op" id="5189520">)</span>&nbsp;<span class="op" id="5189522">&gt;</span>&nbsp;<span class="num" id="5189524">1</span>&nbsp;<span class="op" id="5189526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189530"><a href="/net/smtp/smtp.go.html#5189469">extList</a></span>&nbsp;<span class="op" id="5189538">=</span>&nbsp;<span class="ident" id="5189540"><a href="/net/smtp/smtp.go.html#5189469">extList</a></span><span class="op" id="5189547">[</span><span class="num" id="5189548">1</span><span class="op" id="5189549">:</span><span class="op" id="5189550">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189554">for</span>&nbsp;<span class="ident" id="5189558">_</span><span class="op" id="5189559">,</span>&nbsp;<span class="ident" id="5189561">line</span>&nbsp;<span class="op" id="5189566">:=</span>&nbsp;<span class="keyword" id="5189569">range</span>&nbsp;<span class="ident" id="5189575"><a href="/net/smtp/smtp.go.html#5189469">extList</a></span>&nbsp;<span class="op" id="5189583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189588">args</span>&nbsp;<span class="op" id="5189593">:=</span>&nbsp;<span class="ident" id="5189596"><a href="/net/smtp/smtp.go.html#5186419">strings</a></span><span class="op" id="5189603">.</span><span class="ident" id="5189604">SplitN</span><span class="op" id="5189610">(</span><span class="ident" id="5189611"><a href="/net/smtp/smtp.go.html#5189561">line</a></span><span class="op" id="5189615">,</span>&nbsp;<span class="string" id="5189617">&#34;&nbsp;&#34;</span><span class="op" id="5189620">,</span>&nbsp;<span class="num" id="5189622">2</span><span class="op" id="5189623">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189628">if</span>&nbsp;<span class="builtinfunc" id="5189631">len</span><span class="op" id="5189634">(</span><span class="ident" id="5189635"><a href="/net/smtp/smtp.go.html#5189588">args</a></span><span class="op" id="5189639">)</span>&nbsp;<span class="op" id="5189641">&gt;</span>&nbsp;<span class="num" id="5189643">1</span>&nbsp;<span class="op" id="5189645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189651"><a href="/net/smtp/smtp.go.html#5189437">ext</a></span><span class="op" id="5189654">[</span><span class="ident" id="5189655"><a href="/net/smtp/smtp.go.html#5189588">args</a></span><span class="op" id="5189659">[</span><span class="num" id="5189660">0</span><span class="op" id="5189661">]</span><span class="op" id="5189662">]</span>&nbsp;<span class="op" id="5189664">=</span>&nbsp;<span class="ident" id="5189666"><a href="/net/smtp/smtp.go.html#5189588">args</a></span><span class="op" id="5189670">[</span><span class="num" id="5189671">1</span><span class="op" id="5189672">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189677">}</span>&nbsp;<span class="keyword" id="5189679">else</span>&nbsp;<span class="op" id="5189684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189690"><a href="/net/smtp/smtp.go.html#5189437">ext</a></span><span class="op" id="5189693">[</span><span class="ident" id="5189694"><a href="/net/smtp/smtp.go.html#5189588">args</a></span><span class="op" id="5189698">[</span><span class="num" id="5189699">0</span><span class="op" id="5189700">]</span><span class="op" id="5189701">]</span>&nbsp;<span class="op" id="5189703">=</span>&nbsp;<span class="string" id="5189705">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189711">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189721">if</span>&nbsp;<span class="ident" id="5189724">mechs</span><span class="op" id="5189729">,</span>&nbsp;<span class="ident" id="5189731">ok</span>&nbsp;<span class="op" id="5189734">:=</span>&nbsp;<span class="ident" id="5189737"><a href="/net/smtp/smtp.go.html#5189437">ext</a></span><span class="op" id="5189740">[</span><span class="string" id="5189741">&#34;AUTH&#34;</span><span class="op" id="5189747">]</span><span class="op" id="5189748">;</span>&nbsp;<span class="ident" id="5189750"><a href="/net/smtp/smtp.go.html#5189731">ok</a></span>&nbsp;<span class="op" id="5189753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189757"><a href="/net/smtp/smtp.go.html#5189326">c</a></span><span class="op" id="5189758">.</span><span class="ident" id="5189759">auth</span>&nbsp;<span class="op" id="5189764">=</span>&nbsp;<span class="ident" id="5189766"><a href="/net/smtp/smtp.go.html#5186419">strings</a></span><span class="op" id="5189773">.</span><span class="ident" id="5189774">Split</span><span class="op" id="5189779">(</span><span class="ident" id="5189780"><a href="/net/smtp/smtp.go.html#5189724">mechs</a></span><span class="op" id="5189785">,</span>&nbsp;<span class="string" id="5189787">&#34;&nbsp;&#34;</span><span class="op" id="5189790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189793">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189796"><a href="/net/smtp/smtp.go.html#5189326">c</a></span><span class="op" id="5189797">.</span><span class="ident" id="5189798">ext</span>&nbsp;<span class="op" id="5189802">=</span>&nbsp;<span class="ident" id="5189804"><a href="/net/smtp/smtp.go.html#5189437">ext</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189809">return</span>&nbsp;<span class="ident" id="5189816"><a href="/net/smtp/smtp.go.html#5189361">err</a></span><br>
<span class="lineno"></span><span class="op" id="5189820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5189823">//&nbsp;StartTLS&nbsp;sends&nbsp;the&nbsp;STARTTLS&nbsp;command&nbsp;and&nbsp;encrypts&nbsp;all&nbsp;further&nbsp;communication.</span><br>
<span class="lineno">145</span><span class="comment" id="5189902">//&nbsp;Only&nbsp;servers&nbsp;that&nbsp;advertise&nbsp;the&nbsp;STARTTLS&nbsp;extension&nbsp;support&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="5189979">func</span>&nbsp;<span class="op" id="5189984">(</span><span class="ident" id="5189985">c</span>&nbsp;<span class="op" id="5189987">*</span><span class="ident" id="5189988"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5189994">)</span>&nbsp;<span class="ident" id="5189996">StartTLS</span><span class="op" id="5190004">(</span><span class="ident" id="5190005">config</span>&nbsp;<span class="op" id="5190012">*</span><span class="ident" id="5190013"><a href="/net/smtp/smtp.go.html#5186346">tls</a></span><span class="op" id="5190016">.</span><span class="ident" id="5190017">Config</span><span class="op" id="5190023">)</span>&nbsp;<span class="builtintype" id="5190025">error</span>&nbsp;<span class="op" id="5190031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190034">if</span>&nbsp;<span class="ident" id="5190037">err</span>&nbsp;<span class="op" id="5190041">:=</span>&nbsp;<span class="ident" id="5190044"><a href="/net/smtp/smtp.go.html#5189985">c</a></span><span class="op" id="5190045">.</span><span class="ident" id="5190046">hello</span><span class="op" id="5190051">(</span><span class="op" id="5190052">)</span><span class="op" id="5190053">;</span>&nbsp;<span class="ident" id="5190055"><a href="/net/smtp/smtp.go.html#5190037">err</a></span>&nbsp;<span class="op" id="5190059">!=</span>&nbsp;<span class="ident" id="5190062">nil</span>&nbsp;<span class="op" id="5190066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190070">return</span>&nbsp;<span class="ident" id="5190077"><a href="/net/smtp/smtp.go.html#5190037">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190082">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190085">_</span><span class="op" id="5190086">,</span>&nbsp;<span class="ident" id="5190088">_</span><span class="op" id="5190089">,</span>&nbsp;<span class="ident" id="5190091">err</span>&nbsp;<span class="op" id="5190095">:=</span>&nbsp;<span class="ident" id="5190098"><a href="/net/smtp/smtp.go.html#5189985">c</a></span><span class="op" id="5190099">.</span><span class="ident" id="5190100">cmd</span><span class="op" id="5190103">(</span><span class="num" id="5190104">220</span><span class="op" id="5190107">,</span>&nbsp;<span class="string" id="5190109">&#34;STARTTLS&#34;</span><span class="op" id="5190119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190122">if</span>&nbsp;<span class="ident" id="5190125"><a href="/net/smtp/smtp.go.html#5190091">err</a></span>&nbsp;<span class="op" id="5190129">!=</span>&nbsp;<span class="ident" id="5190132">nil</span>&nbsp;<span class="op" id="5190136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190140">return</span>&nbsp;<span class="ident" id="5190147"><a href="/net/smtp/smtp.go.html#5190091">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190155"><a href="/net/smtp/smtp.go.html#5189985">c</a></span><span class="op" id="5190156">.</span><span class="ident" id="5190157">conn</span>&nbsp;<span class="op" id="5190162">=</span>&nbsp;<span class="ident" id="5190164"><a href="/net/smtp/smtp.go.html#5186346">tls</a></span><span class="op" id="5190167">.</span><span class="ident" id="5190168">Client</span><span class="op" id="5190174">(</span><span class="ident" id="5190175"><a href="/net/smtp/smtp.go.html#5189985">c</a></span><span class="op" id="5190176">.</span><span class="ident" id="5190177">conn</span><span class="op" id="5190181">,</span>&nbsp;<span class="ident" id="5190183"><a href="/net/smtp/smtp.go.html#5190005">config</a></span><span class="op" id="5190189">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190192"><a href="/net/smtp/smtp.go.html#5189985">c</a></span><span class="op" id="5190193">.</span><span class="ident" id="5190194">Text</span>&nbsp;<span class="op" id="5190199">=</span>&nbsp;<span class="ident" id="5190201"><a href="/net/smtp/smtp.go.html#5186402">textproto</a></span><span class="op" id="5190210">.</span><span class="ident" id="5190211">NewConn</span><span class="op" id="5190218">(</span><span class="ident" id="5190219"><a href="/net/smtp/smtp.go.html#5189985">c</a></span><span class="op" id="5190220">.</span><span class="ident" id="5190221">conn</span><span class="op" id="5190225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190228"><a href="/net/smtp/smtp.go.html#5189985">c</a></span><span class="op" id="5190229">.</span><span class="ident" id="5190230">tls</span>&nbsp;<span class="op" id="5190234">=</span>&nbsp;<span class="ident" id="5190236">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190242">return</span>&nbsp;<span class="ident" id="5190249"><a href="/net/smtp/smtp.go.html#5189985">c</a></span><span class="op" id="5190250">.</span><span class="ident" id="5190251">ehlo</span><span class="op" id="5190255">(</span><span class="op" id="5190256">)</span><br>
<span class="lineno"></span><span class="op" id="5190258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="5190261">//&nbsp;Verify&nbsp;checks&nbsp;the&nbsp;validity&nbsp;of&nbsp;an&nbsp;email&nbsp;address&nbsp;on&nbsp;the&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="5190326">//&nbsp;If&nbsp;Verify&nbsp;returns&nbsp;nil,&nbsp;the&nbsp;address&nbsp;is&nbsp;valid.&nbsp;A&nbsp;non-nil&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5190391">//&nbsp;does&nbsp;not&nbsp;necessarily&nbsp;indicate&nbsp;an&nbsp;invalid&nbsp;address.&nbsp;Many&nbsp;servers</span><br>
<span class="lineno"></span><span class="comment" id="5190457">//&nbsp;will&nbsp;not&nbsp;verify&nbsp;addresses&nbsp;for&nbsp;security&nbsp;reasons.</span><br>
<span class="lineno"></span><span class="keyword" id="5190508">func</span>&nbsp;<span class="op" id="5190513">(</span><span class="ident" id="5190514">c</span>&nbsp;<span class="op" id="5190516">*</span><span class="ident" id="5190517"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5190523">)</span>&nbsp;<span class="ident" id="5190525">Verify</span><span class="op" id="5190531">(</span><span class="ident" id="5190532">addr</span>&nbsp;<span class="builtintype" id="5190537">string</span><span class="op" id="5190543">)</span>&nbsp;<span class="builtintype" id="5190545">error</span>&nbsp;<span class="op" id="5190551">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190554">if</span>&nbsp;<span class="ident" id="5190557">err</span>&nbsp;<span class="op" id="5190561">:=</span>&nbsp;<span class="ident" id="5190564"><a href="/net/smtp/smtp.go.html#5190514">c</a></span><span class="op" id="5190565">.</span><span class="ident" id="5190566">hello</span><span class="op" id="5190571">(</span><span class="op" id="5190572">)</span><span class="op" id="5190573">;</span>&nbsp;<span class="ident" id="5190575"><a href="/net/smtp/smtp.go.html#5190557">err</a></span>&nbsp;<span class="op" id="5190579">!=</span>&nbsp;<span class="ident" id="5190582">nil</span>&nbsp;<span class="op" id="5190586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190590">return</span>&nbsp;<span class="ident" id="5190597"><a href="/net/smtp/smtp.go.html#5190557">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190605">_</span><span class="op" id="5190606">,</span>&nbsp;<span class="ident" id="5190608">_</span><span class="op" id="5190609">,</span>&nbsp;<span class="ident" id="5190611">err</span>&nbsp;<span class="op" id="5190615">:=</span>&nbsp;<span class="ident" id="5190618"><a href="/net/smtp/smtp.go.html#5190514">c</a></span><span class="op" id="5190619">.</span><span class="ident" id="5190620">cmd</span><span class="op" id="5190623">(</span><span class="num" id="5190624">250</span><span class="op" id="5190627">,</span>&nbsp;<span class="string" id="5190629">&#34;VRFY&nbsp;%s&#34;</span><span class="op" id="5190638">,</span>&nbsp;<span class="ident" id="5190640"><a href="/net/smtp/smtp.go.html#5190532">addr</a></span><span class="op" id="5190644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190647">return</span>&nbsp;<span class="ident" id="5190654"><a href="/net/smtp/smtp.go.html#5190611">err</a></span><br>
<span class="lineno">170</span><span class="op" id="5190658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5190661">//&nbsp;Auth&nbsp;authenticates&nbsp;a&nbsp;client&nbsp;using&nbsp;the&nbsp;provided&nbsp;authentication&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="comment" id="5190737">//&nbsp;A&nbsp;failed&nbsp;authentication&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="5190787">//&nbsp;Only&nbsp;servers&nbsp;that&nbsp;advertise&nbsp;the&nbsp;AUTH&nbsp;extension&nbsp;support&nbsp;this&nbsp;function.</span><br>
<span class="lineno">175</span><span class="keyword" id="5190860">func</span>&nbsp;<span class="op" id="5190865">(</span><span class="ident" id="5190866">c</span>&nbsp;<span class="op" id="5190868">*</span><span class="ident" id="5190869"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5190875">)</span>&nbsp;<span class="ident" id="5190877">Auth</span><span class="op" id="5190881">(</span><span class="ident" id="5190882">a</span>&nbsp;<span class="ident" id="5190884"><a href="/net/smtp/auth.go.html#5182815">Auth</a></span><span class="op" id="5190888">)</span>&nbsp;<span class="builtintype" id="5190890">error</span>&nbsp;<span class="op" id="5190896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190899">if</span>&nbsp;<span class="ident" id="5190902">err</span>&nbsp;<span class="op" id="5190906">:=</span>&nbsp;<span class="ident" id="5190909"><a href="/net/smtp/smtp.go.html#5190866">c</a></span><span class="op" id="5190910">.</span><span class="ident" id="5190911">hello</span><span class="op" id="5190916">(</span><span class="op" id="5190917">)</span><span class="op" id="5190918">;</span>&nbsp;<span class="ident" id="5190920"><a href="/net/smtp/smtp.go.html#5190902">err</a></span>&nbsp;<span class="op" id="5190924">!=</span>&nbsp;<span class="ident" id="5190927">nil</span>&nbsp;<span class="op" id="5190931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190935">return</span>&nbsp;<span class="ident" id="5190942"><a href="/net/smtp/smtp.go.html#5190902">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190950">encoding</span>&nbsp;<span class="op" id="5190959">:=</span>&nbsp;<span class="ident" id="5190962"><a href="/net/smtp/smtp.go.html#5186360">base64</a></span><span class="op" id="5190968">.</span><span class="ident" id="5190969">StdEncoding</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190982">mech</span><span class="op" id="5190986">,</span>&nbsp;<span class="ident" id="5190988">resp</span><span class="op" id="5190992">,</span>&nbsp;<span class="ident" id="5190994">err</span>&nbsp;<span class="op" id="5190998">:=</span>&nbsp;<span class="ident" id="5191001"><a href="/net/smtp/smtp.go.html#5190882">a</a></span><span class="op" id="5191002">.</span><span class="ident" id="5191003">Start</span><span class="op" id="5191008">(</span><span class="op" id="5191009">&amp;</span><span class="ident" id="5191010"><a href="/net/smtp/auth.go.html#5183772">ServerInfo</a></span><span class="op" id="5191020">{</span><span class="ident" id="5191021"><a href="/net/smtp/smtp.go.html#5190866">c</a></span><span class="op" id="5191022">.</span><span class="ident" id="5191023">serverName</span><span class="op" id="5191033">,</span>&nbsp;<span class="ident" id="5191035"><a href="/net/smtp/smtp.go.html#5190866">c</a></span><span class="op" id="5191036">.</span><span class="ident" id="5191037">tls</span><span class="op" id="5191040">,</span>&nbsp;<span class="ident" id="5191042"><a href="/net/smtp/smtp.go.html#5190866">c</a></span><span class="op" id="5191043">.</span><span class="ident" id="5191044">auth</span><span class="op" id="5191048">}</span><span class="op" id="5191049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191052">if</span>&nbsp;<span class="ident" id="5191055"><a href="/net/smtp/smtp.go.html#5190994">err</a></span>&nbsp;<span class="op" id="5191059">!=</span>&nbsp;<span class="ident" id="5191062">nil</span>&nbsp;<span class="op" id="5191066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191070"><a href="/net/smtp/smtp.go.html#5190866">c</a></span><span class="op" id="5191071">.</span><span class="ident" id="5191072">Quit</span><span class="op" id="5191076">(</span><span class="op" id="5191077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191081">return</span>&nbsp;<span class="ident" id="5191088"><a href="/net/smtp/smtp.go.html#5190994">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191093">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191096">resp64</span>&nbsp;<span class="op" id="5191103">:=</span>&nbsp;<span class="builtinfunc" id="5191106">make</span><span class="op" id="5191110">(</span><span class="op" id="5191111">[</span><span class="op" id="5191112">]</span><span class="builtintype" id="5191113">byte</span><span class="op" id="5191117">,</span>&nbsp;<span class="ident" id="5191119"><a href="/net/smtp/smtp.go.html#5190950">encoding</a></span><span class="op" id="5191127">.</span><span class="ident" id="5191128">EncodedLen</span><span class="op" id="5191138">(</span><span class="builtinfunc" id="5191139">len</span><span class="op" id="5191142">(</span><span class="ident" id="5191143"><a href="/net/smtp/smtp.go.html#5190988">resp</a></span><span class="op" id="5191147">)</span><span class="op" id="5191148">)</span><span class="op" id="5191149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191152"><a href="/net/smtp/smtp.go.html#5190950">encoding</a></span><span class="op" id="5191160">.</span><span class="ident" id="5191161">Encode</span><span class="op" id="5191167">(</span><span class="ident" id="5191168"><a href="/net/smtp/smtp.go.html#5191096">resp64</a></span><span class="op" id="5191174">,</span>&nbsp;<span class="ident" id="5191176"><a href="/net/smtp/smtp.go.html#5190988">resp</a></span><span class="op" id="5191180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191183">code</span><span class="op" id="5191187">,</span>&nbsp;<span class="ident" id="5191189">msg64</span><span class="op" id="5191194">,</span>&nbsp;<span class="ident" id="5191196"><a href="/net/smtp/smtp.go.html#5190994">err</a></span>&nbsp;<span class="op" id="5191200">:=</span>&nbsp;<span class="ident" id="5191203"><a href="/net/smtp/smtp.go.html#5190866">c</a></span><span class="op" id="5191204">.</span><span class="ident" id="5191205">cmd</span><span class="op" id="5191208">(</span><span class="num" id="5191209">0</span><span class="op" id="5191210">,</span>&nbsp;<span class="string" id="5191212">&#34;AUTH&nbsp;%s&nbsp;%s&#34;</span><span class="op" id="5191224">,</span>&nbsp;<span class="ident" id="5191226"><a href="/net/smtp/smtp.go.html#5190982">mech</a></span><span class="op" id="5191230">,</span>&nbsp;<span class="ident" id="5191232"><a href="/net/smtp/smtp.go.html#5191096">resp64</a></span><span class="op" id="5191238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191241">for</span>&nbsp;<span class="ident" id="5191245"><a href="/net/smtp/smtp.go.html#5190994">err</a></span>&nbsp;<span class="op" id="5191249">==</span>&nbsp;<span class="ident" id="5191252">nil</span>&nbsp;<span class="op" id="5191256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191260">var</span>&nbsp;<span class="ident" id="5191264">msg</span>&nbsp;<span class="op" id="5191268">[</span><span class="op" id="5191269">]</span><span class="builtintype" id="5191270">byte</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191277">switch</span>&nbsp;<span class="ident" id="5191284"><a href="/net/smtp/smtp.go.html#5191183">code</a></span>&nbsp;<span class="op" id="5191289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191293">case</span>&nbsp;<span class="num" id="5191298">334</span><span class="op" id="5191301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191306"><a href="/net/smtp/smtp.go.html#5191264">msg</a></span><span class="op" id="5191309">,</span>&nbsp;<span class="ident" id="5191311"><a href="/net/smtp/smtp.go.html#5190994">err</a></span>&nbsp;<span class="op" id="5191315">=</span>&nbsp;<span class="ident" id="5191317"><a href="/net/smtp/smtp.go.html#5190950">encoding</a></span><span class="op" id="5191325">.</span><span class="ident" id="5191326">DecodeString</span><span class="op" id="5191338">(</span><span class="ident" id="5191339"><a href="/net/smtp/smtp.go.html#5191189">msg64</a></span><span class="op" id="5191344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191348">case</span>&nbsp;<span class="num" id="5191353">235</span><span class="op" id="5191356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5191361">//&nbsp;the&nbsp;last&nbsp;message&nbsp;isn&#39;t&nbsp;base64&nbsp;because&nbsp;it&nbsp;isn&#39;t&nbsp;a&nbsp;challenge</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191426"><a href="/net/smtp/smtp.go.html#5191264">msg</a></span>&nbsp;<span class="op" id="5191430">=</span>&nbsp;<span class="op" id="5191432">[</span><span class="op" id="5191433">]</span><span class="builtintype" id="5191434">byte</span><span class="op" id="5191438">(</span><span class="ident" id="5191439"><a href="/net/smtp/smtp.go.html#5191189">msg64</a></span><span class="op" id="5191444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191448">default</span><span class="op" id="5191455">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191460"><a href="/net/smtp/smtp.go.html#5190994">err</a></span>&nbsp;<span class="op" id="5191464">=</span>&nbsp;<span class="op" id="5191466">&amp;</span><span class="ident" id="5191467"><a href="/net/smtp/smtp.go.html#5186402">textproto</a></span><span class="op" id="5191476">.</span><span class="ident" id="5191477">Error</span><span class="op" id="5191482">{</span><span class="ident" id="5191483">Code</span><span class="op" id="5191487">:</span>&nbsp;<span class="ident" id="5191489"><a href="/net/smtp/smtp.go.html#5191183">code</a></span><span class="op" id="5191493">,</span>&nbsp;<span class="ident" id="5191495">Msg</span><span class="op" id="5191498">:</span>&nbsp;<span class="ident" id="5191500"><a href="/net/smtp/smtp.go.html#5191189">msg64</a></span><span class="op" id="5191505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191513">if</span>&nbsp;<span class="ident" id="5191516"><a href="/net/smtp/smtp.go.html#5190994">err</a></span>&nbsp;<span class="op" id="5191520">==</span>&nbsp;<span class="ident" id="5191523">nil</span>&nbsp;<span class="op" id="5191527">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191532"><a href="/net/smtp/smtp.go.html#5190988">resp</a></span><span class="op" id="5191536">,</span>&nbsp;<span class="ident" id="5191538"><a href="/net/smtp/smtp.go.html#5190994">err</a></span>&nbsp;<span class="op" id="5191542">=</span>&nbsp;<span class="ident" id="5191544"><a href="/net/smtp/smtp.go.html#5190882">a</a></span><span class="op" id="5191545">.</span><span class="ident" id="5191546">Next</span><span class="op" id="5191550">(</span><span class="ident" id="5191551"><a href="/net/smtp/smtp.go.html#5191264">msg</a></span><span class="op" id="5191554">,</span>&nbsp;<span class="ident" id="5191556"><a href="/net/smtp/smtp.go.html#5191183">code</a></span>&nbsp;<span class="op" id="5191561">==</span>&nbsp;<span class="num" id="5191564">334</span><span class="op" id="5191567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191575">if</span>&nbsp;<span class="ident" id="5191578"><a href="/net/smtp/smtp.go.html#5190994">err</a></span>&nbsp;<span class="op" id="5191582">!=</span>&nbsp;<span class="ident" id="5191585">nil</span>&nbsp;<span class="op" id="5191589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5191594">//&nbsp;abort&nbsp;the&nbsp;AUTH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191615"><a href="/net/smtp/smtp.go.html#5190866">c</a></span><span class="op" id="5191616">.</span><span class="ident" id="5191617">cmd</span><span class="op" id="5191620">(</span><span class="num" id="5191621">501</span><span class="op" id="5191624">,</span>&nbsp;<span class="string" id="5191626">&#34;*&#34;</span><span class="op" id="5191629">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191634"><a href="/net/smtp/smtp.go.html#5190866">c</a></span><span class="op" id="5191635">.</span><span class="ident" id="5191636">Quit</span><span class="op" id="5191640">(</span><span class="op" id="5191641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191646">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191658">if</span>&nbsp;<span class="ident" id="5191661"><a href="/net/smtp/smtp.go.html#5190988">resp</a></span>&nbsp;<span class="op" id="5191666">==</span>&nbsp;<span class="ident" id="5191669">nil</span>&nbsp;<span class="op" id="5191673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191678">break</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191690"><a href="/net/smtp/smtp.go.html#5191096">resp64</a></span>&nbsp;<span class="op" id="5191697">=</span>&nbsp;<span class="builtinfunc" id="5191699">make</span><span class="op" id="5191703">(</span><span class="op" id="5191704">[</span><span class="op" id="5191705">]</span><span class="builtintype" id="5191706">byte</span><span class="op" id="5191710">,</span>&nbsp;<span class="ident" id="5191712"><a href="/net/smtp/smtp.go.html#5190950">encoding</a></span><span class="op" id="5191720">.</span><span class="ident" id="5191721">EncodedLen</span><span class="op" id="5191731">(</span><span class="builtinfunc" id="5191732">len</span><span class="op" id="5191735">(</span><span class="ident" id="5191736"><a href="/net/smtp/smtp.go.html#5190988">resp</a></span><span class="op" id="5191740">)</span><span class="op" id="5191741">)</span><span class="op" id="5191742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191746"><a href="/net/smtp/smtp.go.html#5190950">encoding</a></span><span class="op" id="5191754">.</span><span class="ident" id="5191755">Encode</span><span class="op" id="5191761">(</span><span class="ident" id="5191762"><a href="/net/smtp/smtp.go.html#5191096">resp64</a></span><span class="op" id="5191768">,</span>&nbsp;<span class="ident" id="5191770"><a href="/net/smtp/smtp.go.html#5190988">resp</a></span><span class="op" id="5191774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191778"><a href="/net/smtp/smtp.go.html#5191183">code</a></span><span class="op" id="5191782">,</span>&nbsp;<span class="ident" id="5191784"><a href="/net/smtp/smtp.go.html#5191189">msg64</a></span><span class="op" id="5191789">,</span>&nbsp;<span class="ident" id="5191791"><a href="/net/smtp/smtp.go.html#5190994">err</a></span>&nbsp;<span class="op" id="5191795">=</span>&nbsp;<span class="ident" id="5191797"><a href="/net/smtp/smtp.go.html#5190866">c</a></span><span class="op" id="5191798">.</span><span class="ident" id="5191799">cmd</span><span class="op" id="5191802">(</span><span class="num" id="5191803">0</span><span class="op" id="5191804">,</span>&nbsp;<span class="builtintype" id="5191806">string</span><span class="op" id="5191812">(</span><span class="ident" id="5191813"><a href="/net/smtp/smtp.go.html#5191096">resp64</a></span><span class="op" id="5191819">)</span><span class="op" id="5191820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191823">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191826">return</span>&nbsp;<span class="ident" id="5191833"><a href="/net/smtp/smtp.go.html#5190994">err</a></span><br>
<span class="lineno"></span><span class="op" id="5191837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5191840">//&nbsp;Mail&nbsp;issues&nbsp;a&nbsp;MAIL&nbsp;command&nbsp;to&nbsp;the&nbsp;server&nbsp;using&nbsp;the&nbsp;provided&nbsp;email&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5191918">//&nbsp;If&nbsp;the&nbsp;server&nbsp;supports&nbsp;the&nbsp;8BITMIME&nbsp;extension,&nbsp;Mail&nbsp;adds&nbsp;the&nbsp;BODY=8BITMIME</span><br>
<span class="lineno">220</span><span class="comment" id="5191996">//&nbsp;parameter.</span><br>
<span class="lineno"></span><span class="comment" id="5192010">//&nbsp;This&nbsp;initiates&nbsp;a&nbsp;mail&nbsp;transaction&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;one&nbsp;or&nbsp;more&nbsp;Rcpt&nbsp;calls.</span><br>
<span class="lineno"></span><span class="keyword" id="5192090">func</span>&nbsp;<span class="op" id="5192095">(</span><span class="ident" id="5192096">c</span>&nbsp;<span class="op" id="5192098">*</span><span class="ident" id="5192099"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5192105">)</span>&nbsp;<span class="ident" id="5192107">Mail</span><span class="op" id="5192111">(</span><span class="ident" id="5192112">from</span>&nbsp;<span class="builtintype" id="5192117">string</span><span class="op" id="5192123">)</span>&nbsp;<span class="builtintype" id="5192125">error</span>&nbsp;<span class="op" id="5192131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192134">if</span>&nbsp;<span class="ident" id="5192137">err</span>&nbsp;<span class="op" id="5192141">:=</span>&nbsp;<span class="ident" id="5192144"><a href="/net/smtp/smtp.go.html#5192096">c</a></span><span class="op" id="5192145">.</span><span class="ident" id="5192146">hello</span><span class="op" id="5192151">(</span><span class="op" id="5192152">)</span><span class="op" id="5192153">;</span>&nbsp;<span class="ident" id="5192155"><a href="/net/smtp/smtp.go.html#5192137">err</a></span>&nbsp;<span class="op" id="5192159">!=</span>&nbsp;<span class="ident" id="5192162">nil</span>&nbsp;<span class="op" id="5192166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192170">return</span>&nbsp;<span class="ident" id="5192177"><a href="/net/smtp/smtp.go.html#5192137">err</a></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192185">cmdStr</span>&nbsp;<span class="op" id="5192192">:=</span>&nbsp;<span class="string" id="5192195">&#34;MAIL&nbsp;FROM:&lt;%s&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192213">if</span>&nbsp;<span class="ident" id="5192216"><a href="/net/smtp/smtp.go.html#5192096">c</a></span><span class="op" id="5192217">.</span><span class="ident" id="5192218">ext</span>&nbsp;<span class="op" id="5192222">!=</span>&nbsp;<span class="ident" id="5192225">nil</span>&nbsp;<span class="op" id="5192229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192233">if</span>&nbsp;<span class="ident" id="5192236">_</span><span class="op" id="5192237">,</span>&nbsp;<span class="ident" id="5192239">ok</span>&nbsp;<span class="op" id="5192242">:=</span>&nbsp;<span class="ident" id="5192245"><a href="/net/smtp/smtp.go.html#5192096">c</a></span><span class="op" id="5192246">.</span><span class="ident" id="5192247">ext</span><span class="op" id="5192250">[</span><span class="string" id="5192251">&#34;8BITMIME&#34;</span><span class="op" id="5192261">]</span><span class="op" id="5192262">;</span>&nbsp;<span class="ident" id="5192264"><a href="/net/smtp/smtp.go.html#5192239">ok</a></span>&nbsp;<span class="op" id="5192267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192272"><a href="/net/smtp/smtp.go.html#5192185">cmdStr</a></span>&nbsp;<span class="op" id="5192279">+=</span>&nbsp;<span class="string" id="5192282">&#34;&nbsp;BODY=8BITMIME&#34;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192307">_</span><span class="op" id="5192308">,</span>&nbsp;<span class="ident" id="5192310">_</span><span class="op" id="5192311">,</span>&nbsp;<span class="ident" id="5192313">err</span>&nbsp;<span class="op" id="5192317">:=</span>&nbsp;<span class="ident" id="5192320"><a href="/net/smtp/smtp.go.html#5192096">c</a></span><span class="op" id="5192321">.</span><span class="ident" id="5192322">cmd</span><span class="op" id="5192325">(</span><span class="num" id="5192326">250</span><span class="op" id="5192329">,</span>&nbsp;<span class="ident" id="5192331"><a href="/net/smtp/smtp.go.html#5192185">cmdStr</a></span><span class="op" id="5192337">,</span>&nbsp;<span class="ident" id="5192339"><a href="/net/smtp/smtp.go.html#5192112">from</a></span><span class="op" id="5192343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192346">return</span>&nbsp;<span class="ident" id="5192353"><a href="/net/smtp/smtp.go.html#5192313">err</a></span><br>
<span class="lineno"></span><span class="op" id="5192357">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="5192360">//&nbsp;Rcpt&nbsp;issues&nbsp;a&nbsp;RCPT&nbsp;command&nbsp;to&nbsp;the&nbsp;server&nbsp;using&nbsp;the&nbsp;provided&nbsp;email&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5192438">//&nbsp;A&nbsp;call&nbsp;to&nbsp;Rcpt&nbsp;must&nbsp;be&nbsp;preceded&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Mail&nbsp;and&nbsp;may&nbsp;be&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5192514">//&nbsp;a&nbsp;Data&nbsp;call&nbsp;or&nbsp;another&nbsp;Rcpt&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="5192551">func</span>&nbsp;<span class="op" id="5192556">(</span><span class="ident" id="5192557">c</span>&nbsp;<span class="op" id="5192559">*</span><span class="ident" id="5192560"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5192566">)</span>&nbsp;<span class="ident" id="5192568">Rcpt</span><span class="op" id="5192572">(</span><span class="ident" id="5192573">to</span>&nbsp;<span class="builtintype" id="5192576">string</span><span class="op" id="5192582">)</span>&nbsp;<span class="builtintype" id="5192584">error</span>&nbsp;<span class="op" id="5192590">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192593">_</span><span class="op" id="5192594">,</span>&nbsp;<span class="ident" id="5192596">_</span><span class="op" id="5192597">,</span>&nbsp;<span class="ident" id="5192599">err</span>&nbsp;<span class="op" id="5192603">:=</span>&nbsp;<span class="ident" id="5192606"><a href="/net/smtp/smtp.go.html#5192557">c</a></span><span class="op" id="5192607">.</span><span class="ident" id="5192608">cmd</span><span class="op" id="5192611">(</span><span class="num" id="5192612">25</span><span class="op" id="5192614">,</span>&nbsp;<span class="string" id="5192616">&#34;RCPT&nbsp;TO:&lt;%s&gt;&#34;</span><span class="op" id="5192630">,</span>&nbsp;<span class="ident" id="5192632"><a href="/net/smtp/smtp.go.html#5192573">to</a></span><span class="op" id="5192634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192637">return</span>&nbsp;<span class="ident" id="5192644"><a href="/net/smtp/smtp.go.html#5192599">err</a></span><br>
<span class="lineno"></span><span class="op" id="5192648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5192651">type</span>&nbsp;<span class="ident" id="5192656">dataCloser</span>&nbsp;<span class="keyword" id="5192667">struct</span>&nbsp;<span class="op" id="5192674">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192677">c</span>&nbsp;<span class="op" id="5192679">*</span><span class="ident" id="5192680"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192688"><a href="/net/smtp/smtp.go.html#5186389">io</a></span><span class="op" id="5192690">.</span><span class="ident" id="5192691">WriteCloser</span><br>
<span class="lineno"></span><span class="op" id="5192703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5192706">func</span>&nbsp;<span class="op" id="5192711">(</span><span class="ident" id="5192712">d</span>&nbsp;<span class="op" id="5192714">*</span><span class="ident" id="5192715"><a href="/net/smtp/smtp.go.html#5192656">dataCloser</a></span><span class="op" id="5192725">)</span>&nbsp;<span class="ident" id="5192727">Close</span><span class="op" id="5192732">(</span><span class="op" id="5192733">)</span>&nbsp;<span class="builtintype" id="5192735">error</span>&nbsp;<span class="op" id="5192741">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192744"><a href="/net/smtp/smtp.go.html#5192712">d</a></span><span class="op" id="5192745">.</span><span class="ident" id="5192746">WriteCloser</span><span class="op" id="5192757">.</span><span class="ident" id="5192758">Close</span><span class="op" id="5192763">(</span><span class="op" id="5192764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192767">_</span><span class="op" id="5192768">,</span>&nbsp;<span class="ident" id="5192770">_</span><span class="op" id="5192771">,</span>&nbsp;<span class="ident" id="5192773">err</span>&nbsp;<span class="op" id="5192777">:=</span>&nbsp;<span class="ident" id="5192780"><a href="/net/smtp/smtp.go.html#5192712">d</a></span><span class="op" id="5192781">.</span><span class="ident" id="5192782">c</span><span class="op" id="5192783">.</span><span class="ident" id="5192784">Text</span><span class="op" id="5192788">.</span><span class="ident" id="5192789">ReadResponse</span><span class="op" id="5192801">(</span><span class="num" id="5192802">250</span><span class="op" id="5192805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192808">return</span>&nbsp;<span class="ident" id="5192815"><a href="/net/smtp/smtp.go.html#5192773">err</a></span><br>
<span class="lineno"></span><span class="op" id="5192819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="5192822">//&nbsp;Data&nbsp;issues&nbsp;a&nbsp;DATA&nbsp;command&nbsp;to&nbsp;the&nbsp;server&nbsp;and&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5192892">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;write&nbsp;the&nbsp;data.&nbsp;The&nbsp;caller&nbsp;should&nbsp;close&nbsp;the&nbsp;writer</span><br>
<span class="lineno"></span><span class="comment" id="5192961">//&nbsp;before&nbsp;calling&nbsp;any&nbsp;more&nbsp;methods&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="5193002">//&nbsp;A&nbsp;call&nbsp;to&nbsp;Data&nbsp;must&nbsp;be&nbsp;preceded&nbsp;by&nbsp;one&nbsp;or&nbsp;more&nbsp;calls&nbsp;to&nbsp;Rcpt.</span><br>
<span class="lineno"></span><span class="keyword" id="5193067">func</span>&nbsp;<span class="op" id="5193072">(</span><span class="ident" id="5193073">c</span>&nbsp;<span class="op" id="5193075">*</span><span class="ident" id="5193076"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5193082">)</span>&nbsp;<span class="ident" id="5193084">Data</span><span class="op" id="5193088">(</span><span class="op" id="5193089">)</span>&nbsp;<span class="op" id="5193091">(</span><span class="ident" id="5193092"><a href="/net/smtp/smtp.go.html#5186389">io</a></span><span class="op" id="5193094">.</span><span class="ident" id="5193095">WriteCloser</span><span class="op" id="5193106">,</span>&nbsp;<span class="builtintype" id="5193108">error</span><span class="op" id="5193113">)</span>&nbsp;<span class="op" id="5193115">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193118">_</span><span class="op" id="5193119">,</span>&nbsp;<span class="ident" id="5193121">_</span><span class="op" id="5193122">,</span>&nbsp;<span class="ident" id="5193124">err</span>&nbsp;<span class="op" id="5193128">:=</span>&nbsp;<span class="ident" id="5193131"><a href="/net/smtp/smtp.go.html#5193073">c</a></span><span class="op" id="5193132">.</span><span class="ident" id="5193133">cmd</span><span class="op" id="5193136">(</span><span class="num" id="5193137">354</span><span class="op" id="5193140">,</span>&nbsp;<span class="string" id="5193142">&#34;DATA&#34;</span><span class="op" id="5193148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193151">if</span>&nbsp;<span class="ident" id="5193154"><a href="/net/smtp/smtp.go.html#5193124">err</a></span>&nbsp;<span class="op" id="5193158">!=</span>&nbsp;<span class="ident" id="5193161">nil</span>&nbsp;<span class="op" id="5193165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193169">return</span>&nbsp;<span class="ident" id="5193176">nil</span><span class="op" id="5193179">,</span>&nbsp;<span class="ident" id="5193181"><a href="/net/smtp/smtp.go.html#5193124">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193189">return</span>&nbsp;<span class="op" id="5193196">&amp;</span><span class="ident" id="5193197"><a href="/net/smtp/smtp.go.html#5192656">dataCloser</a></span><span class="op" id="5193207">{</span><span class="ident" id="5193208"><a href="/net/smtp/smtp.go.html#5193073">c</a></span><span class="op" id="5193209">,</span>&nbsp;<span class="ident" id="5193211"><a href="/net/smtp/smtp.go.html#5193073">c</a></span><span class="op" id="5193212">.</span><span class="ident" id="5193213">Text</span><span class="op" id="5193217">.</span><span class="ident" id="5193218">DotWriter</span><span class="op" id="5193227">(</span><span class="op" id="5193228">)</span><span class="op" id="5193229">}</span><span class="op" id="5193230">,</span>&nbsp;<span class="ident" id="5193232">nil</span><br>
<span class="lineno">265</span><span class="op" id="5193236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5193239">var</span>&nbsp;<span class="ident" id="5193243">testHookStartTLS</span>&nbsp;<span class="keyword" id="5193260">func</span><span class="op" id="5193264">(</span><span class="op" id="5193265">*</span><span class="ident" id="5193266"><a href="/net/smtp/smtp.go.html#5186346">tls</a></span><span class="op" id="5193269">.</span><span class="ident" id="5193270">Config</span><span class="op" id="5193276">)</span>&nbsp;<span class="comment" id="5193278">//&nbsp;nil,&nbsp;except&nbsp;for&nbsp;tests</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5193304">//&nbsp;SendMail&nbsp;connects&nbsp;to&nbsp;the&nbsp;server&nbsp;at&nbsp;addr,&nbsp;switches&nbsp;to&nbsp;TLS&nbsp;if</span><br>
<span class="lineno">270</span><span class="comment" id="5193367">//&nbsp;possible,&nbsp;authenticates&nbsp;with&nbsp;the&nbsp;optional&nbsp;mechanism&nbsp;a&nbsp;if&nbsp;possible,</span><br>
<span class="lineno"></span><span class="comment" id="5193437">//&nbsp;and&nbsp;then&nbsp;sends&nbsp;an&nbsp;email&nbsp;from&nbsp;address&nbsp;from,&nbsp;to&nbsp;addresses&nbsp;to,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5193505">//&nbsp;message&nbsp;msg.</span><br>
<span class="lineno"></span><span class="keyword" id="5193521">func</span>&nbsp;<span class="ident" id="5193526">SendMail</span><span class="op" id="5193534">(</span><span class="ident" id="5193535">addr</span>&nbsp;<span class="builtintype" id="5193540">string</span><span class="op" id="5193546">,</span>&nbsp;<span class="ident" id="5193548">a</span>&nbsp;<span class="ident" id="5193550"><a href="/net/smtp/auth.go.html#5182815">Auth</a></span><span class="op" id="5193554">,</span>&nbsp;<span class="ident" id="5193556">from</span>&nbsp;<span class="builtintype" id="5193561">string</span><span class="op" id="5193567">,</span>&nbsp;<span class="ident" id="5193569">to</span>&nbsp;<span class="op" id="5193572">[</span><span class="op" id="5193573">]</span><span class="builtintype" id="5193574">string</span><span class="op" id="5193580">,</span>&nbsp;<span class="ident" id="5193582">msg</span>&nbsp;<span class="op" id="5193586">[</span><span class="op" id="5193587">]</span><span class="builtintype" id="5193588">byte</span><span class="op" id="5193592">)</span>&nbsp;<span class="builtintype" id="5193594">error</span>&nbsp;<span class="op" id="5193600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193603">c</span><span class="op" id="5193604">,</span>&nbsp;<span class="ident" id="5193606">err</span>&nbsp;<span class="op" id="5193610">:=</span>&nbsp;<span class="ident" id="5193613"><a href="/net/smtp/smtp.go.html#5187197">Dial</a></span><span class="op" id="5193617">(</span><span class="ident" id="5193618"><a href="/net/smtp/smtp.go.html#5193535">addr</a></span><span class="op" id="5193622">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193625">if</span>&nbsp;<span class="ident" id="5193628"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5193632">!=</span>&nbsp;<span class="ident" id="5193635">nil</span>&nbsp;<span class="op" id="5193639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193643">return</span>&nbsp;<span class="ident" id="5193650"><a href="/net/smtp/smtp.go.html#5193606">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193658">defer</span>&nbsp;<span class="ident" id="5193664"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5193665">.</span><span class="ident" id="5193666">Close</span><span class="op" id="5193671">(</span><span class="op" id="5193672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193675">if</span>&nbsp;<span class="ident" id="5193678"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5193682">=</span>&nbsp;<span class="ident" id="5193684"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5193685">.</span><span class="ident" id="5193686">hello</span><span class="op" id="5193691">(</span><span class="op" id="5193692">)</span><span class="op" id="5193693">;</span>&nbsp;<span class="ident" id="5193695"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5193699">!=</span>&nbsp;<span class="ident" id="5193702">nil</span>&nbsp;<span class="op" id="5193706">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193710">return</span>&nbsp;<span class="ident" id="5193717"><a href="/net/smtp/smtp.go.html#5193606">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193725">if</span>&nbsp;<span class="ident" id="5193728">ok</span><span class="op" id="5193730">,</span>&nbsp;<span class="ident" id="5193732">_</span>&nbsp;<span class="op" id="5193734">:=</span>&nbsp;<span class="ident" id="5193737"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5193738">.</span><span class="ident" id="5193739">Extension</span><span class="op" id="5193748">(</span><span class="string" id="5193749">&#34;STARTTLS&#34;</span><span class="op" id="5193759">)</span><span class="op" id="5193760">;</span>&nbsp;<span class="ident" id="5193762"><a href="/net/smtp/smtp.go.html#5193728">ok</a></span>&nbsp;<span class="op" id="5193765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193769">config</span>&nbsp;<span class="op" id="5193776">:=</span>&nbsp;<span class="op" id="5193779">&amp;</span><span class="ident" id="5193780"><a href="/net/smtp/smtp.go.html#5186346">tls</a></span><span class="op" id="5193783">.</span><span class="ident" id="5193784">Config</span><span class="op" id="5193790">{</span><span class="ident" id="5193791">ServerName</span><span class="op" id="5193801">:</span>&nbsp;<span class="ident" id="5193803"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5193804">.</span><span class="ident" id="5193805">serverName</span><span class="op" id="5193815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193819">if</span>&nbsp;<span class="ident" id="5193822"><a href="/net/smtp/smtp.go.html#5193243">testHookStartTLS</a></span>&nbsp;<span class="op" id="5193839">!=</span>&nbsp;<span class="ident" id="5193842">nil</span>&nbsp;<span class="op" id="5193846">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193851"><a href="/net/smtp/smtp.go.html#5193243">testHookStartTLS</a></span><span class="op" id="5193867">(</span><span class="ident" id="5193868"><a href="/net/smtp/smtp.go.html#5193769">config</a></span><span class="op" id="5193874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193882">if</span>&nbsp;<span class="ident" id="5193885"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5193889">=</span>&nbsp;<span class="ident" id="5193891"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5193892">.</span><span class="ident" id="5193893">StartTLS</span><span class="op" id="5193901">(</span><span class="ident" id="5193902"><a href="/net/smtp/smtp.go.html#5193769">config</a></span><span class="op" id="5193908">)</span><span class="op" id="5193909">;</span>&nbsp;<span class="ident" id="5193911"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5193915">!=</span>&nbsp;<span class="ident" id="5193918">nil</span>&nbsp;<span class="op" id="5193922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193927">return</span>&nbsp;<span class="ident" id="5193934"><a href="/net/smtp/smtp.go.html#5193606">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193940">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193946">if</span>&nbsp;<span class="ident" id="5193949"><a href="/net/smtp/smtp.go.html#5193548">a</a></span>&nbsp;<span class="op" id="5193951">!=</span>&nbsp;<span class="ident" id="5193954">nil</span>&nbsp;<span class="op" id="5193958">&amp;&amp;</span>&nbsp;<span class="ident" id="5193961"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5193962">.</span><span class="ident" id="5193963">ext</span>&nbsp;<span class="op" id="5193967">!=</span>&nbsp;<span class="ident" id="5193970">nil</span>&nbsp;<span class="op" id="5193974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193978">if</span>&nbsp;<span class="ident" id="5193981">_</span><span class="op" id="5193982">,</span>&nbsp;<span class="ident" id="5193984">ok</span>&nbsp;<span class="op" id="5193987">:=</span>&nbsp;<span class="ident" id="5193990"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5193991">.</span><span class="ident" id="5193992">ext</span><span class="op" id="5193995">[</span><span class="string" id="5193996">&#34;AUTH&#34;</span><span class="op" id="5194002">]</span><span class="op" id="5194003">;</span>&nbsp;<span class="ident" id="5194005"><a href="/net/smtp/smtp.go.html#5193984">ok</a></span>&nbsp;<span class="op" id="5194008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194013">if</span>&nbsp;<span class="ident" id="5194016"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194020">=</span>&nbsp;<span class="ident" id="5194022"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5194023">.</span><span class="ident" id="5194024">Auth</span><span class="op" id="5194028">(</span><span class="ident" id="5194029"><a href="/net/smtp/smtp.go.html#5193548">a</a></span><span class="op" id="5194030">)</span><span class="op" id="5194031">;</span>&nbsp;<span class="ident" id="5194033"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194037">!=</span>&nbsp;<span class="ident" id="5194040">nil</span>&nbsp;<span class="op" id="5194044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194050">return</span>&nbsp;<span class="ident" id="5194057"><a href="/net/smtp/smtp.go.html#5193606">err</a></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194074">if</span>&nbsp;<span class="ident" id="5194077"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194081">=</span>&nbsp;<span class="ident" id="5194083"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5194084">.</span><span class="ident" id="5194085">Mail</span><span class="op" id="5194089">(</span><span class="ident" id="5194090"><a href="/net/smtp/smtp.go.html#5193556">from</a></span><span class="op" id="5194094">)</span><span class="op" id="5194095">;</span>&nbsp;<span class="ident" id="5194097"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194101">!=</span>&nbsp;<span class="ident" id="5194104">nil</span>&nbsp;<span class="op" id="5194108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194112">return</span>&nbsp;<span class="ident" id="5194119"><a href="/net/smtp/smtp.go.html#5193606">err</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194127">for</span>&nbsp;<span class="ident" id="5194131">_</span><span class="op" id="5194132">,</span>&nbsp;<span class="ident" id="5194134">addr</span>&nbsp;<span class="op" id="5194139">:=</span>&nbsp;<span class="keyword" id="5194142">range</span>&nbsp;<span class="ident" id="5194148"><a href="/net/smtp/smtp.go.html#5193569">to</a></span>&nbsp;<span class="op" id="5194151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194155">if</span>&nbsp;<span class="ident" id="5194158"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194162">=</span>&nbsp;<span class="ident" id="5194164"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5194165">.</span><span class="ident" id="5194166">Rcpt</span><span class="op" id="5194170">(</span><span class="ident" id="5194171"><a href="/net/smtp/smtp.go.html#5194134">addr</a></span><span class="op" id="5194175">)</span><span class="op" id="5194176">;</span>&nbsp;<span class="ident" id="5194178"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194182">!=</span>&nbsp;<span class="ident" id="5194185">nil</span>&nbsp;<span class="op" id="5194189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194194">return</span>&nbsp;<span class="ident" id="5194201"><a href="/net/smtp/smtp.go.html#5193606">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194207">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5194213">w</span><span class="op" id="5194214">,</span>&nbsp;<span class="ident" id="5194216"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194220">:=</span>&nbsp;<span class="ident" id="5194223"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5194224">.</span><span class="ident" id="5194225">Data</span><span class="op" id="5194229">(</span><span class="op" id="5194230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194233">if</span>&nbsp;<span class="ident" id="5194236"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194240">!=</span>&nbsp;<span class="ident" id="5194243">nil</span>&nbsp;<span class="op" id="5194247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194251">return</span>&nbsp;<span class="ident" id="5194258"><a href="/net/smtp/smtp.go.html#5193606">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194263">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5194266">_</span><span class="op" id="5194267">,</span>&nbsp;<span class="ident" id="5194269"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194273">=</span>&nbsp;<span class="ident" id="5194275"><a href="/net/smtp/smtp.go.html#5194213">w</a></span><span class="op" id="5194276">.</span><span class="ident" id="5194277">Write</span><span class="op" id="5194282">(</span><span class="ident" id="5194283"><a href="/net/smtp/smtp.go.html#5193582">msg</a></span><span class="op" id="5194286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194289">if</span>&nbsp;<span class="ident" id="5194292"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194296">!=</span>&nbsp;<span class="ident" id="5194299">nil</span>&nbsp;<span class="op" id="5194303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194307">return</span>&nbsp;<span class="ident" id="5194314"><a href="/net/smtp/smtp.go.html#5193606">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5194322"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194326">=</span>&nbsp;<span class="ident" id="5194328"><a href="/net/smtp/smtp.go.html#5194213">w</a></span><span class="op" id="5194329">.</span><span class="ident" id="5194330">Close</span><span class="op" id="5194335">(</span><span class="op" id="5194336">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194339">if</span>&nbsp;<span class="ident" id="5194342"><a href="/net/smtp/smtp.go.html#5193606">err</a></span>&nbsp;<span class="op" id="5194346">!=</span>&nbsp;<span class="ident" id="5194349">nil</span>&nbsp;<span class="op" id="5194353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194357">return</span>&nbsp;<span class="ident" id="5194364"><a href="/net/smtp/smtp.go.html#5193606">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194372">return</span>&nbsp;<span class="ident" id="5194379"><a href="/net/smtp/smtp.go.html#5193603">c</a></span><span class="op" id="5194380">.</span><span class="ident" id="5194381">Quit</span><span class="op" id="5194385">(</span><span class="op" id="5194386">)</span><br>
<span class="lineno"></span><span class="op" id="5194388">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5194391">//&nbsp;Extension&nbsp;reports&nbsp;whether&nbsp;an&nbsp;extension&nbsp;is&nbsp;support&nbsp;by&nbsp;the&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="5194459">//&nbsp;The&nbsp;extension&nbsp;name&nbsp;is&nbsp;case-insensitive.&nbsp;If&nbsp;the&nbsp;extension&nbsp;is&nbsp;supported,</span><br>
<span class="lineno"></span><span class="comment" id="5194533">//&nbsp;Extension&nbsp;also&nbsp;returns&nbsp;a&nbsp;string&nbsp;that&nbsp;contains&nbsp;any&nbsp;parameters&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5194601">//&nbsp;server&nbsp;specifies&nbsp;for&nbsp;the&nbsp;extension.</span><br>
<span class="lineno">325</span><span class="keyword" id="5194640">func</span>&nbsp;<span class="op" id="5194645">(</span><span class="ident" id="5194646">c</span>&nbsp;<span class="op" id="5194648">*</span><span class="ident" id="5194649"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5194655">)</span>&nbsp;<span class="ident" id="5194657">Extension</span><span class="op" id="5194666">(</span><span class="ident" id="5194667">ext</span>&nbsp;<span class="builtintype" id="5194671">string</span><span class="op" id="5194677">)</span>&nbsp;<span class="op" id="5194679">(</span><span class="builtintype" id="5194680">bool</span><span class="op" id="5194684">,</span>&nbsp;<span class="builtintype" id="5194686">string</span><span class="op" id="5194692">)</span>&nbsp;<span class="op" id="5194694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194697">if</span>&nbsp;<span class="ident" id="5194700">err</span>&nbsp;<span class="op" id="5194704">:=</span>&nbsp;<span class="ident" id="5194707"><a href="/net/smtp/smtp.go.html#5194646">c</a></span><span class="op" id="5194708">.</span><span class="ident" id="5194709">hello</span><span class="op" id="5194714">(</span><span class="op" id="5194715">)</span><span class="op" id="5194716">;</span>&nbsp;<span class="ident" id="5194718"><a href="/net/smtp/smtp.go.html#5194700">err</a></span>&nbsp;<span class="op" id="5194722">!=</span>&nbsp;<span class="ident" id="5194725">nil</span>&nbsp;<span class="op" id="5194729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194733">return</span>&nbsp;<span class="ident" id="5194740">false</span><span class="op" id="5194745">,</span>&nbsp;<span class="string" id="5194747">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194754">if</span>&nbsp;<span class="ident" id="5194757"><a href="/net/smtp/smtp.go.html#5194646">c</a></span><span class="op" id="5194758">.</span><span class="ident" id="5194759">ext</span>&nbsp;<span class="op" id="5194763">==</span>&nbsp;<span class="ident" id="5194766">nil</span>&nbsp;<span class="op" id="5194770">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194774">return</span>&nbsp;<span class="ident" id="5194781">false</span><span class="op" id="5194786">,</span>&nbsp;<span class="string" id="5194788">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5194792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5194795"><a href="/net/smtp/smtp.go.html#5194667">ext</a></span>&nbsp;<span class="op" id="5194799">=</span>&nbsp;<span class="ident" id="5194801"><a href="/net/smtp/smtp.go.html#5186419">strings</a></span><span class="op" id="5194808">.</span><span class="ident" id="5194809">ToUpper</span><span class="op" id="5194816">(</span><span class="ident" id="5194817"><a href="/net/smtp/smtp.go.html#5194667">ext</a></span><span class="op" id="5194820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5194823">param</span><span class="op" id="5194828">,</span>&nbsp;<span class="ident" id="5194830">ok</span>&nbsp;<span class="op" id="5194833">:=</span>&nbsp;<span class="ident" id="5194836"><a href="/net/smtp/smtp.go.html#5194646">c</a></span><span class="op" id="5194837">.</span><span class="ident" id="5194838">ext</span><span class="op" id="5194841">[</span><span class="ident" id="5194842"><a href="/net/smtp/smtp.go.html#5194667">ext</a></span><span class="op" id="5194845">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194848">return</span>&nbsp;<span class="ident" id="5194855"><a href="/net/smtp/smtp.go.html#5194830">ok</a></span><span class="op" id="5194857">,</span>&nbsp;<span class="ident" id="5194859"><a href="/net/smtp/smtp.go.html#5194823">param</a></span><br>
<span class="lineno">335</span><span class="op" id="5194865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5194868">//&nbsp;Reset&nbsp;sends&nbsp;the&nbsp;RSET&nbsp;command&nbsp;to&nbsp;the&nbsp;server,&nbsp;aborting&nbsp;the&nbsp;current&nbsp;mail</span><br>
<span class="lineno"></span><span class="comment" id="5194941">//&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="5194957">func</span>&nbsp;<span class="op" id="5194962">(</span><span class="ident" id="5194963">c</span>&nbsp;<span class="op" id="5194965">*</span><span class="ident" id="5194966"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5194972">)</span>&nbsp;<span class="ident" id="5194974">Reset</span><span class="op" id="5194979">(</span><span class="op" id="5194980">)</span>&nbsp;<span class="builtintype" id="5194982">error</span>&nbsp;<span class="op" id="5194988">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194991">if</span>&nbsp;<span class="ident" id="5194994">err</span>&nbsp;<span class="op" id="5194998">:=</span>&nbsp;<span class="ident" id="5195001"><a href="/net/smtp/smtp.go.html#5194963">c</a></span><span class="op" id="5195002">.</span><span class="ident" id="5195003">hello</span><span class="op" id="5195008">(</span><span class="op" id="5195009">)</span><span class="op" id="5195010">;</span>&nbsp;<span class="ident" id="5195012"><a href="/net/smtp/smtp.go.html#5194994">err</a></span>&nbsp;<span class="op" id="5195016">!=</span>&nbsp;<span class="ident" id="5195019">nil</span>&nbsp;<span class="op" id="5195023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195027">return</span>&nbsp;<span class="ident" id="5195034"><a href="/net/smtp/smtp.go.html#5194994">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5195039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195042">_</span><span class="op" id="5195043">,</span>&nbsp;<span class="ident" id="5195045">_</span><span class="op" id="5195046">,</span>&nbsp;<span class="ident" id="5195048">err</span>&nbsp;<span class="op" id="5195052">:=</span>&nbsp;<span class="ident" id="5195055"><a href="/net/smtp/smtp.go.html#5194963">c</a></span><span class="op" id="5195056">.</span><span class="ident" id="5195057">cmd</span><span class="op" id="5195060">(</span><span class="num" id="5195061">250</span><span class="op" id="5195064">,</span>&nbsp;<span class="string" id="5195066">&#34;RSET&#34;</span><span class="op" id="5195072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195075">return</span>&nbsp;<span class="ident" id="5195082"><a href="/net/smtp/smtp.go.html#5195048">err</a></span><br>
<span class="lineno">345</span><span class="op" id="5195086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5195089">//&nbsp;Quit&nbsp;sends&nbsp;the&nbsp;QUIT&nbsp;command&nbsp;and&nbsp;closes&nbsp;the&nbsp;connection&nbsp;to&nbsp;the&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="5195161">func</span>&nbsp;<span class="op" id="5195166">(</span><span class="ident" id="5195167">c</span>&nbsp;<span class="op" id="5195169">*</span><span class="ident" id="5195170"><a href="/net/smtp/smtp.go.html#5186499">Client</a></span><span class="op" id="5195176">)</span>&nbsp;<span class="ident" id="5195178">Quit</span><span class="op" id="5195182">(</span><span class="op" id="5195183">)</span>&nbsp;<span class="builtintype" id="5195185">error</span>&nbsp;<span class="op" id="5195191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195194">if</span>&nbsp;<span class="ident" id="5195197">err</span>&nbsp;<span class="op" id="5195201">:=</span>&nbsp;<span class="ident" id="5195204"><a href="/net/smtp/smtp.go.html#5195167">c</a></span><span class="op" id="5195205">.</span><span class="ident" id="5195206">hello</span><span class="op" id="5195211">(</span><span class="op" id="5195212">)</span><span class="op" id="5195213">;</span>&nbsp;<span class="ident" id="5195215"><a href="/net/smtp/smtp.go.html#5195197">err</a></span>&nbsp;<span class="op" id="5195219">!=</span>&nbsp;<span class="ident" id="5195222">nil</span>&nbsp;<span class="op" id="5195226">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195230">return</span>&nbsp;<span class="ident" id="5195237"><a href="/net/smtp/smtp.go.html#5195197">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5195242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195245">_</span><span class="op" id="5195246">,</span>&nbsp;<span class="ident" id="5195248">_</span><span class="op" id="5195249">,</span>&nbsp;<span class="ident" id="5195251">err</span>&nbsp;<span class="op" id="5195255">:=</span>&nbsp;<span class="ident" id="5195258"><a href="/net/smtp/smtp.go.html#5195167">c</a></span><span class="op" id="5195259">.</span><span class="ident" id="5195260">cmd</span><span class="op" id="5195263">(</span><span class="num" id="5195264">221</span><span class="op" id="5195267">,</span>&nbsp;<span class="string" id="5195269">&#34;QUIT&#34;</span><span class="op" id="5195275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195278">if</span>&nbsp;<span class="ident" id="5195281"><a href="/net/smtp/smtp.go.html#5195251">err</a></span>&nbsp;<span class="op" id="5195285">!=</span>&nbsp;<span class="ident" id="5195288">nil</span>&nbsp;<span class="op" id="5195292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195296">return</span>&nbsp;<span class="ident" id="5195303"><a href="/net/smtp/smtp.go.html#5195251">err</a></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5195308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195311">return</span>&nbsp;<span class="ident" id="5195318"><a href="/net/smtp/smtp.go.html#5195167">c</a></span><span class="op" id="5195319">.</span><span class="ident" id="5195320">Text</span><span class="op" id="5195324">.</span><span class="ident" id="5195325">Close</span><span class="op" id="5195330">(</span><span class="op" id="5195331">)</span><br>
<span class="lineno"></span><span class="op" id="5195333">}</span>
</div>
</body>
</html>
