<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html" class="current">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7184316">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7184371">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7184425">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7184476">package</span>&nbsp;<span class="ident" id="7184484">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7184489">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7184521">import</span>&nbsp;<span class="op" id="7184528">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7184531">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7184540">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7184546">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7184556">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7184566">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7184569">const</span>&nbsp;<span class="op" id="7184575">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184578">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184592">=</span>&nbsp;<span class="string" id="7184594">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184640">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184654">=</span>&nbsp;<span class="string" id="7184656">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184692">Rmicroseconds</span>&nbsp;<span class="op" id="7184706">=</span>&nbsp;<span class="string" id="7184708">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184744">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184758">=</span>&nbsp;<span class="string" id="7184760">`(54|56):`</span>&nbsp;<span class="comment" id="7184771">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184833">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184847">=</span>&nbsp;<span class="string" id="7184849">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7184875">+</span>&nbsp;<span class="ident" id="7184877">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184884">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184898">=</span>&nbsp;<span class="string" id="7184900">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7184923">+</span>&nbsp;<span class="ident" id="7184925">Rline</span><br>
<span class="lineno"></span><span class="op" id="7184931">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7184934">type</span>&nbsp;<span class="ident" id="7184939">tester</span>&nbsp;<span class="keyword" id="7184946">struct</span>&nbsp;<span class="op" id="7184953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184956">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7184964">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184969">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="7184977">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184985">pattern</span>&nbsp;<span class="builtintype" id="7184993">string</span>&nbsp;<span class="comment" id="7185000">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="7185073">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="7185076">var</span>&nbsp;<span class="ident" id="7185080">tests</span>&nbsp;<span class="op" id="7185086">=</span>&nbsp;<span class="op" id="7185088">[</span><span class="op" id="7185089">]</span><span class="ident" id="7185090">tester</span><span class="op" id="7185096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7185099">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185122">{</span><span class="num" id="7185123">0</span><span class="op" id="7185124">,</span>&nbsp;<span class="string" id="7185126">&#34;&#34;</span><span class="op" id="7185128">,</span>&nbsp;<span class="string" id="7185130">&#34;&#34;</span><span class="op" id="7185132">}</span><span class="op" id="7185133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185136">{</span><span class="num" id="7185137">0</span><span class="op" id="7185138">,</span>&nbsp;<span class="string" id="7185140">&#34;XXX&#34;</span><span class="op" id="7185145">,</span>&nbsp;<span class="string" id="7185147">&#34;XXX&#34;</span><span class="op" id="7185152">}</span><span class="op" id="7185153">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185156">{</span><span class="ident" id="7185157">Ldate</span><span class="op" id="7185162">,</span>&nbsp;<span class="string" id="7185164">&#34;&#34;</span><span class="op" id="7185166">,</span>&nbsp;<span class="ident" id="7185168">Rdate</span>&nbsp;<span class="op" id="7185174">+</span>&nbsp;<span class="string" id="7185176">&#34;&nbsp;&#34;</span><span class="op" id="7185179">}</span><span class="op" id="7185180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185183">{</span><span class="ident" id="7185184">Ltime</span><span class="op" id="7185189">,</span>&nbsp;<span class="string" id="7185191">&#34;&#34;</span><span class="op" id="7185193">,</span>&nbsp;<span class="ident" id="7185195">Rtime</span>&nbsp;<span class="op" id="7185201">+</span>&nbsp;<span class="string" id="7185203">&#34;&nbsp;&#34;</span><span class="op" id="7185206">}</span><span class="op" id="7185207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185210">{</span><span class="ident" id="7185211">Ltime</span>&nbsp;<span class="op" id="7185217">|</span>&nbsp;<span class="ident" id="7185219">Lmicroseconds</span><span class="op" id="7185232">,</span>&nbsp;<span class="string" id="7185234">&#34;&#34;</span><span class="op" id="7185236">,</span>&nbsp;<span class="ident" id="7185238">Rtime</span>&nbsp;<span class="op" id="7185244">+</span>&nbsp;<span class="ident" id="7185246">Rmicroseconds</span>&nbsp;<span class="op" id="7185260">+</span>&nbsp;<span class="string" id="7185262">&#34;&nbsp;&#34;</span><span class="op" id="7185265">}</span><span class="op" id="7185266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185269">{</span><span class="ident" id="7185270">Lmicroseconds</span><span class="op" id="7185283">,</span>&nbsp;<span class="string" id="7185285">&#34;&#34;</span><span class="op" id="7185287">,</span>&nbsp;<span class="ident" id="7185289">Rtime</span>&nbsp;<span class="op" id="7185295">+</span>&nbsp;<span class="ident" id="7185297">Rmicroseconds</span>&nbsp;<span class="op" id="7185311">+</span>&nbsp;<span class="string" id="7185313">&#34;&nbsp;&#34;</span><span class="op" id="7185316">}</span><span class="op" id="7185317">,</span>&nbsp;<span class="comment" id="7185319">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185345">{</span><span class="ident" id="7185346">Llongfile</span><span class="op" id="7185355">,</span>&nbsp;<span class="string" id="7185357">&#34;&#34;</span><span class="op" id="7185359">,</span>&nbsp;<span class="ident" id="7185361">Rlongfile</span>&nbsp;<span class="op" id="7185371">+</span>&nbsp;<span class="string" id="7185373">&#34;&nbsp;&#34;</span><span class="op" id="7185376">}</span><span class="op" id="7185377">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185380">{</span><span class="ident" id="7185381">Lshortfile</span><span class="op" id="7185391">,</span>&nbsp;<span class="string" id="7185393">&#34;&#34;</span><span class="op" id="7185395">,</span>&nbsp;<span class="ident" id="7185397">Rshortfile</span>&nbsp;<span class="op" id="7185408">+</span>&nbsp;<span class="string" id="7185410">&#34;&nbsp;&#34;</span><span class="op" id="7185413">}</span><span class="op" id="7185414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185417">{</span><span class="ident" id="7185418">Llongfile</span>&nbsp;<span class="op" id="7185428">|</span>&nbsp;<span class="ident" id="7185430">Lshortfile</span><span class="op" id="7185440">,</span>&nbsp;<span class="string" id="7185442">&#34;&#34;</span><span class="op" id="7185444">,</span>&nbsp;<span class="ident" id="7185446">Rshortfile</span>&nbsp;<span class="op" id="7185457">+</span>&nbsp;<span class="string" id="7185459">&#34;&nbsp;&#34;</span><span class="op" id="7185462">}</span><span class="op" id="7185463">,</span>&nbsp;<span class="comment" id="7185465">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7185498">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185522">{</span><span class="ident" id="7185523">Ldate</span>&nbsp;<span class="op" id="7185529">|</span>&nbsp;<span class="ident" id="7185531">Ltime</span>&nbsp;<span class="op" id="7185537">|</span>&nbsp;<span class="ident" id="7185539">Lmicroseconds</span>&nbsp;<span class="op" id="7185553">|</span>&nbsp;<span class="ident" id="7185555">Llongfile</span><span class="op" id="7185564">,</span>&nbsp;<span class="string" id="7185566">&#34;XXX&#34;</span><span class="op" id="7185571">,</span>&nbsp;<span class="string" id="7185573">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7185579">+</span>&nbsp;<span class="ident" id="7185581">Rdate</span>&nbsp;<span class="op" id="7185587">+</span>&nbsp;<span class="string" id="7185589">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7185593">+</span>&nbsp;<span class="ident" id="7185595">Rtime</span>&nbsp;<span class="op" id="7185601">+</span>&nbsp;<span class="ident" id="7185603">Rmicroseconds</span>&nbsp;<span class="op" id="7185617">+</span>&nbsp;<span class="string" id="7185619">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7185623">+</span>&nbsp;<span class="ident" id="7185625">Rlongfile</span>&nbsp;<span class="op" id="7185635">+</span>&nbsp;<span class="string" id="7185637">&#34;&nbsp;&#34;</span><span class="op" id="7185640">}</span><span class="op" id="7185641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185644">{</span><span class="ident" id="7185645">Ldate</span>&nbsp;<span class="op" id="7185651">|</span>&nbsp;<span class="ident" id="7185653">Ltime</span>&nbsp;<span class="op" id="7185659">|</span>&nbsp;<span class="ident" id="7185661">Lmicroseconds</span>&nbsp;<span class="op" id="7185675">|</span>&nbsp;<span class="ident" id="7185677">Lshortfile</span><span class="op" id="7185687">,</span>&nbsp;<span class="string" id="7185689">&#34;XXX&#34;</span><span class="op" id="7185694">,</span>&nbsp;<span class="string" id="7185696">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7185702">+</span>&nbsp;<span class="ident" id="7185704">Rdate</span>&nbsp;<span class="op" id="7185710">+</span>&nbsp;<span class="string" id="7185712">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7185716">+</span>&nbsp;<span class="ident" id="7185718">Rtime</span>&nbsp;<span class="op" id="7185724">+</span>&nbsp;<span class="ident" id="7185726">Rmicroseconds</span>&nbsp;<span class="op" id="7185740">+</span>&nbsp;<span class="string" id="7185742">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7185746">+</span>&nbsp;<span class="ident" id="7185748">Rshortfile</span>&nbsp;<span class="op" id="7185759">+</span>&nbsp;<span class="string" id="7185761">&#34;&nbsp;&#34;</span><span class="op" id="7185764">}</span><span class="op" id="7185765">,</span><br>
<span class="lineno">45</span><span class="op" id="7185767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7185770">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="7185852">func</span>&nbsp;<span class="ident" id="7185857">testPrint</span><span class="op" id="7185866">(</span><span class="ident" id="7185867">t</span>&nbsp;<span class="op" id="7185869">*</span><span class="ident" id="7185870">testing</span><span class="op" id="7185877">.</span><span class="ident" id="7185878">T</span><span class="op" id="7185879">,</span>&nbsp;<span class="ident" id="7185881">flag</span>&nbsp;<span class="builtintype" id="7185886">int</span><span class="op" id="7185889">,</span>&nbsp;<span class="ident" id="7185891">prefix</span>&nbsp;<span class="builtintype" id="7185898">string</span><span class="op" id="7185904">,</span>&nbsp;<span class="ident" id="7185906">pattern</span>&nbsp;<span class="builtintype" id="7185914">string</span><span class="op" id="7185920">,</span>&nbsp;<span class="ident" id="7185922">useFormat</span>&nbsp;<span class="builtintype" id="7185932">bool</span><span class="op" id="7185936">)</span>&nbsp;<span class="op" id="7185938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185941">buf</span>&nbsp;<span class="op" id="7185945">:=</span>&nbsp;<span class="builtinfunc" id="7185948">new</span><span class="op" id="7185951">(</span><span class="ident" id="7185952">bytes</span><span class="op" id="7185957">.</span><span class="ident" id="7185958">Buffer</span><span class="op" id="7185964">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185967">SetOutput</span><span class="op" id="7185976">(</span><span class="ident" id="7185977">buf</span><span class="op" id="7185980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185983">SetFlags</span><span class="op" id="7185991">(</span><span class="ident" id="7185992">flag</span><span class="op" id="7185996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185999">SetPrefix</span><span class="op" id="7186008">(</span><span class="ident" id="7186009">prefix</span><span class="op" id="7186015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186018">if</span>&nbsp;<span class="ident" id="7186021">useFormat</span>&nbsp;<span class="op" id="7186031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186035">Printf</span><span class="op" id="7186041">(</span><span class="string" id="7186042">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="7186058">,</span>&nbsp;<span class="num" id="7186060">23</span><span class="op" id="7186062">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7186065">}</span>&nbsp;<span class="keyword" id="7186067">else</span>&nbsp;<span class="op" id="7186072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186076">Println</span><span class="op" id="7186083">(</span><span class="string" id="7186084">&#34;hello&#34;</span><span class="op" id="7186091">,</span>&nbsp;<span class="num" id="7186093">23</span><span class="op" id="7186095">,</span>&nbsp;<span class="string" id="7186097">&#34;world&#34;</span><span class="op" id="7186104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7186107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186110">line</span>&nbsp;<span class="op" id="7186115">:=</span>&nbsp;<span class="ident" id="7186118">buf</span><span class="op" id="7186121">.</span><span class="ident" id="7186122">String</span><span class="op" id="7186128">(</span><span class="op" id="7186129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186132">line</span>&nbsp;<span class="op" id="7186137">=</span>&nbsp;<span class="ident" id="7186139">line</span><span class="op" id="7186143">[</span><span class="num" id="7186144">0</span>&nbsp;<span class="op" id="7186146">:</span>&nbsp;<span class="builtinfunc" id="7186148">len</span><span class="op" id="7186151">(</span><span class="ident" id="7186152">line</span><span class="op" id="7186156">)</span><span class="op" id="7186157">-</span><span class="num" id="7186158">1</span><span class="op" id="7186159">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186162">pattern</span>&nbsp;<span class="op" id="7186170">=</span>&nbsp;<span class="string" id="7186172">&#34;^&#34;</span>&nbsp;<span class="op" id="7186176">+</span>&nbsp;<span class="ident" id="7186178">pattern</span>&nbsp;<span class="op" id="7186186">+</span>&nbsp;<span class="string" id="7186188">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186207">matched</span><span class="op" id="7186214">,</span>&nbsp;<span class="ident" id="7186216">err4</span>&nbsp;<span class="op" id="7186221">:=</span>&nbsp;<span class="ident" id="7186224">regexp</span><span class="op" id="7186230">.</span><span class="ident" id="7186231">MatchString</span><span class="op" id="7186242">(</span><span class="ident" id="7186243">pattern</span><span class="op" id="7186250">,</span>&nbsp;<span class="ident" id="7186252">line</span><span class="op" id="7186256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186259">if</span>&nbsp;<span class="ident" id="7186262">err4</span>&nbsp;<span class="op" id="7186267">!=</span>&nbsp;<span class="builtintype" id="7186270">nil</span>&nbsp;<span class="op" id="7186274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186278">t</span><span class="op" id="7186279">.</span><span class="ident" id="7186280">Fatal</span><span class="op" id="7186285">(</span><span class="string" id="7186286">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="7186312">,</span>&nbsp;<span class="ident" id="7186314">err4</span><span class="op" id="7186318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7186321">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186324">if</span>&nbsp;<span class="op" id="7186327">!</span><span class="ident" id="7186328">matched</span>&nbsp;<span class="op" id="7186336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186340">t</span><span class="op" id="7186341">.</span><span class="ident" id="7186342">Errorf</span><span class="op" id="7186348">(</span><span class="string" id="7186349">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7186383">,</span>&nbsp;<span class="ident" id="7186385">pattern</span><span class="op" id="7186392">,</span>&nbsp;<span class="ident" id="7186394">line</span><span class="op" id="7186398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7186401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186404">SetOutput</span><span class="op" id="7186413">(</span><span class="ident" id="7186414">os</span><span class="op" id="7186416">.</span><span class="ident" id="7186417">Stderr</span><span class="op" id="7186423">)</span><br>
<span class="lineno"></span><span class="op" id="7186425">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7186428">func</span>&nbsp;<span class="ident" id="7186433">TestAll</span><span class="op" id="7186440">(</span><span class="ident" id="7186441">t</span>&nbsp;<span class="op" id="7186443">*</span><span class="ident" id="7186444">testing</span><span class="op" id="7186451">.</span><span class="ident" id="7186452">T</span><span class="op" id="7186453">)</span>&nbsp;<span class="op" id="7186455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186458">for</span>&nbsp;<span class="ident" id="7186462">_</span><span class="op" id="7186463">,</span>&nbsp;<span class="ident" id="7186465">testcase</span>&nbsp;<span class="op" id="7186474">:=</span>&nbsp;<span class="keyword" id="7186477">range</span>&nbsp;<span class="ident" id="7186483">tests</span>&nbsp;<span class="op" id="7186489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186493">testPrint</span><span class="op" id="7186502">(</span><span class="ident" id="7186503">t</span><span class="op" id="7186504">,</span>&nbsp;<span class="ident" id="7186506">testcase</span><span class="op" id="7186514">.</span><span class="ident" id="7186515">flag</span><span class="op" id="7186519">,</span>&nbsp;<span class="ident" id="7186521">testcase</span><span class="op" id="7186529">.</span><span class="ident" id="7186530">prefix</span><span class="op" id="7186536">,</span>&nbsp;<span class="ident" id="7186538">testcase</span><span class="op" id="7186546">.</span><span class="ident" id="7186547">pattern</span><span class="op" id="7186554">,</span>&nbsp;<span class="builtintype" id="7186556">false</span><span class="op" id="7186561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186565">testPrint</span><span class="op" id="7186574">(</span><span class="ident" id="7186575">t</span><span class="op" id="7186576">,</span>&nbsp;<span class="ident" id="7186578">testcase</span><span class="op" id="7186586">.</span><span class="ident" id="7186587">flag</span><span class="op" id="7186591">,</span>&nbsp;<span class="ident" id="7186593">testcase</span><span class="op" id="7186601">.</span><span class="ident" id="7186602">prefix</span><span class="op" id="7186608">,</span>&nbsp;<span class="ident" id="7186610">testcase</span><span class="op" id="7186618">.</span><span class="ident" id="7186619">pattern</span><span class="op" id="7186626">,</span>&nbsp;<span class="builtintype" id="7186628">true</span><span class="op" id="7186632">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7186635">}</span><br>
<span class="lineno"></span><span class="op" id="7186637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7186640">func</span>&nbsp;<span class="ident" id="7186645">TestOutput</span><span class="op" id="7186655">(</span><span class="ident" id="7186656">t</span>&nbsp;<span class="op" id="7186658">*</span><span class="ident" id="7186659">testing</span><span class="op" id="7186666">.</span><span class="ident" id="7186667">T</span><span class="op" id="7186668">)</span>&nbsp;<span class="op" id="7186670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186673">const</span>&nbsp;<span class="ident" id="7186679">testString</span>&nbsp;<span class="op" id="7186690">=</span>&nbsp;<span class="string" id="7186692">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186700">var</span>&nbsp;<span class="ident" id="7186704">b</span>&nbsp;<span class="ident" id="7186706">bytes</span><span class="op" id="7186711">.</span><span class="ident" id="7186712">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186720">l</span>&nbsp;<span class="op" id="7186722">:=</span>&nbsp;<span class="ident" id="7186725">New</span><span class="op" id="7186728">(</span><span class="op" id="7186729">&amp;</span><span class="ident" id="7186730">b</span><span class="op" id="7186731">,</span>&nbsp;<span class="string" id="7186733">&#34;&#34;</span><span class="op" id="7186735">,</span>&nbsp;<span class="num" id="7186737">0</span><span class="op" id="7186738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186741">l</span><span class="op" id="7186742">.</span><span class="ident" id="7186743">Println</span><span class="op" id="7186750">(</span><span class="ident" id="7186751">testString</span><span class="op" id="7186761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186764">if</span>&nbsp;<span class="ident" id="7186767">expect</span>&nbsp;<span class="op" id="7186774">:=</span>&nbsp;<span class="ident" id="7186777">testString</span>&nbsp;<span class="op" id="7186788">+</span>&nbsp;<span class="string" id="7186790">&#34;\n&#34;</span><span class="op" id="7186794">;</span>&nbsp;<span class="ident" id="7186796">b</span><span class="op" id="7186797">.</span><span class="ident" id="7186798">String</span><span class="op" id="7186804">(</span><span class="op" id="7186805">)</span>&nbsp;<span class="op" id="7186807">!=</span>&nbsp;<span class="ident" id="7186810">expect</span>&nbsp;<span class="op" id="7186817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186821">t</span><span class="op" id="7186822">.</span><span class="ident" id="7186823">Errorf</span><span class="op" id="7186829">(</span><span class="string" id="7186830">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7186864">,</span>&nbsp;<span class="ident" id="7186866">expect</span><span class="op" id="7186872">,</span>&nbsp;<span class="ident" id="7186874">b</span><span class="op" id="7186875">.</span><span class="ident" id="7186876">String</span><span class="op" id="7186882">(</span><span class="op" id="7186883">)</span><span class="op" id="7186884">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7186887">}</span><br>
<span class="lineno"></span><span class="op" id="7186889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7186892">func</span>&nbsp;<span class="ident" id="7186897">TestFlagAndPrefixSetting</span><span class="op" id="7186921">(</span><span class="ident" id="7186922">t</span>&nbsp;<span class="op" id="7186924">*</span><span class="ident" id="7186925">testing</span><span class="op" id="7186932">.</span><span class="ident" id="7186933">T</span><span class="op" id="7186934">)</span>&nbsp;<span class="op" id="7186936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186939">var</span>&nbsp;<span class="ident" id="7186943">b</span>&nbsp;<span class="ident" id="7186945">bytes</span><span class="op" id="7186950">.</span><span class="ident" id="7186951">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186959">l</span>&nbsp;<span class="op" id="7186961">:=</span>&nbsp;<span class="ident" id="7186964">New</span><span class="op" id="7186967">(</span><span class="op" id="7186968">&amp;</span><span class="ident" id="7186969">b</span><span class="op" id="7186970">,</span>&nbsp;<span class="string" id="7186972">&#34;Test:&#34;</span><span class="op" id="7186979">,</span>&nbsp;<span class="ident" id="7186981">LstdFlags</span><span class="op" id="7186990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186993">f</span>&nbsp;<span class="op" id="7186995">:=</span>&nbsp;<span class="ident" id="7186998">l</span><span class="op" id="7186999">.</span><span class="ident" id="7187000">Flags</span><span class="op" id="7187005">(</span><span class="op" id="7187006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7187009">if</span>&nbsp;<span class="ident" id="7187012">f</span>&nbsp;<span class="op" id="7187014">!=</span>&nbsp;<span class="ident" id="7187017">LstdFlags</span>&nbsp;<span class="op" id="7187027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187031">t</span><span class="op" id="7187032">.</span><span class="ident" id="7187033">Errorf</span><span class="op" id="7187039">(</span><span class="string" id="7187040">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7187069">,</span>&nbsp;<span class="ident" id="7187071">LstdFlags</span><span class="op" id="7187080">,</span>&nbsp;<span class="ident" id="7187082">f</span><span class="op" id="7187083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7187086">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187089">l</span><span class="op" id="7187090">.</span><span class="ident" id="7187091">SetFlags</span><span class="op" id="7187099">(</span><span class="ident" id="7187100">f</span>&nbsp;<span class="op" id="7187102">|</span>&nbsp;<span class="ident" id="7187104">Lmicroseconds</span><span class="op" id="7187117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187120">f</span>&nbsp;<span class="op" id="7187122">=</span>&nbsp;<span class="ident" id="7187124">l</span><span class="op" id="7187125">.</span><span class="ident" id="7187126">Flags</span><span class="op" id="7187131">(</span><span class="op" id="7187132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7187135">if</span>&nbsp;<span class="ident" id="7187138">f</span>&nbsp;<span class="op" id="7187140">!=</span>&nbsp;<span class="ident" id="7187143">LstdFlags</span><span class="op" id="7187152">|</span><span class="ident" id="7187153">Lmicroseconds</span>&nbsp;<span class="op" id="7187167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187171">t</span><span class="op" id="7187172">.</span><span class="ident" id="7187173">Errorf</span><span class="op" id="7187179">(</span><span class="string" id="7187180">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7187209">,</span>&nbsp;<span class="ident" id="7187211">LstdFlags</span><span class="op" id="7187220">|</span><span class="ident" id="7187221">Lmicroseconds</span><span class="op" id="7187234">,</span>&nbsp;<span class="ident" id="7187236">f</span><span class="op" id="7187237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7187240">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187243">p</span>&nbsp;<span class="op" id="7187245">:=</span>&nbsp;<span class="ident" id="7187248">l</span><span class="op" id="7187249">.</span><span class="ident" id="7187250">Prefix</span><span class="op" id="7187256">(</span><span class="op" id="7187257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7187260">if</span>&nbsp;<span class="ident" id="7187263">p</span>&nbsp;<span class="op" id="7187265">!=</span>&nbsp;<span class="string" id="7187268">&#34;Test:&#34;</span>&nbsp;<span class="op" id="7187276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187280">t</span><span class="op" id="7187281">.</span><span class="ident" id="7187282">Errorf</span><span class="op" id="7187288">(</span><span class="string" id="7187289">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7187322">,</span>&nbsp;<span class="ident" id="7187324">p</span><span class="op" id="7187325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7187328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187331">l</span><span class="op" id="7187332">.</span><span class="ident" id="7187333">SetPrefix</span><span class="op" id="7187342">(</span><span class="string" id="7187343">&#34;Reality:&#34;</span><span class="op" id="7187353">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187356">p</span>&nbsp;<span class="op" id="7187358">=</span>&nbsp;<span class="ident" id="7187360">l</span><span class="op" id="7187361">.</span><span class="ident" id="7187362">Prefix</span><span class="op" id="7187368">(</span><span class="op" id="7187369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7187372">if</span>&nbsp;<span class="ident" id="7187375">p</span>&nbsp;<span class="op" id="7187377">!=</span>&nbsp;<span class="string" id="7187380">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="7187391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187395">t</span><span class="op" id="7187396">.</span><span class="ident" id="7187397">Errorf</span><span class="op" id="7187403">(</span><span class="string" id="7187404">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7187440">,</span>&nbsp;<span class="ident" id="7187442">p</span><span class="op" id="7187443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7187446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7187449">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187529">l</span><span class="op" id="7187530">.</span><span class="ident" id="7187531">Print</span><span class="op" id="7187536">(</span><span class="string" id="7187537">&#34;hello&#34;</span><span class="op" id="7187544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187547">pattern</span>&nbsp;<span class="op" id="7187555">:=</span>&nbsp;<span class="string" id="7187558">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="7187570">+</span>&nbsp;<span class="ident" id="7187572">Rdate</span>&nbsp;<span class="op" id="7187578">+</span>&nbsp;<span class="string" id="7187580">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7187584">+</span>&nbsp;<span class="ident" id="7187586">Rtime</span>&nbsp;<span class="op" id="7187592">+</span>&nbsp;<span class="ident" id="7187594">Rmicroseconds</span>&nbsp;<span class="op" id="7187608">+</span>&nbsp;<span class="string" id="7187610">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187622">matched</span><span class="op" id="7187629">,</span>&nbsp;<span class="ident" id="7187631">err</span>&nbsp;<span class="op" id="7187635">:=</span>&nbsp;<span class="ident" id="7187638">regexp</span><span class="op" id="7187644">.</span><span class="ident" id="7187645">Match</span><span class="op" id="7187650">(</span><span class="ident" id="7187651">pattern</span><span class="op" id="7187658">,</span>&nbsp;<span class="ident" id="7187660">b</span><span class="op" id="7187661">.</span><span class="ident" id="7187662">Bytes</span><span class="op" id="7187667">(</span><span class="op" id="7187668">)</span><span class="op" id="7187669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7187672">if</span>&nbsp;<span class="ident" id="7187675">err</span>&nbsp;<span class="op" id="7187679">!=</span>&nbsp;<span class="builtintype" id="7187682">nil</span>&nbsp;<span class="op" id="7187686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187690">t</span><span class="op" id="7187691">.</span><span class="ident" id="7187692">Fatalf</span><span class="op" id="7187698">(</span><span class="string" id="7187699">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="7187731">,</span>&nbsp;<span class="ident" id="7187733">pattern</span><span class="op" id="7187740">,</span>&nbsp;<span class="ident" id="7187742">err</span><span class="op" id="7187745">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7187748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7187751">if</span>&nbsp;<span class="op" id="7187754">!</span><span class="ident" id="7187755">matched</span>&nbsp;<span class="op" id="7187763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7187767">t</span><span class="op" id="7187768">.</span><span class="ident" id="7187769">Error</span><span class="op" id="7187774">(</span><span class="string" id="7187775">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="7187806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7187809">}</span><br>
<span class="lineno"></span><span class="op" id="7187811">}</span>
</div>
</body>
</html>
