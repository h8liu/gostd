<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6326938">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6326994">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6327048">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6327099">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6327153">package</span>&nbsp;<span class="ident" id="6327161">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6327166">import</span>&nbsp;<span class="op" id="6327173">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327176">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327185">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327200">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327219">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327229">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327236">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327242">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6327247">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6327250">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="6327283">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6327322">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="6327369">type</span>&nbsp;<span class="ident" id="6327374">FileHeader</span>&nbsp;<span class="keyword" id="6327385">struct</span>&nbsp;<span class="op" id="6327392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327395">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327406">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327413">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327424">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327430">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327441">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327450">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327461">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327468">ABIVersion</span>&nbsp;<span class="builtintype" id="6327479">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327486">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="6327497">binary</span><span class="op" id="6327503">.</span><span class="ident" id="6327504">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327515">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327526">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327532">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327543">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327552">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327563">uint64</span><br>
<span class="lineno">35</span><span class="op" id="6327570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6327573">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6327612">type</span>&nbsp;<span class="ident" id="6327617">File</span>&nbsp;<span class="keyword" id="6327622">struct</span>&nbsp;<span class="op" id="6327629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327632">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327644">Sections</span>&nbsp;&nbsp;<span class="op" id="6327654">[</span><span class="op" id="6327655">]</span><span class="op" id="6327656">*</span><span class="ident" id="6327657">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327666">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6327676">[</span><span class="op" id="6327677">]</span><span class="op" id="6327678">*</span><span class="ident" id="6327679">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327685">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327695">io</span><span class="op" id="6327697">.</span><span class="ident" id="6327698">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327706">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6327716">[</span><span class="op" id="6327717">]</span><span class="ident" id="6327718">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327727">gnuVersym</span>&nbsp;<span class="op" id="6327737">[</span><span class="op" id="6327738">]</span><span class="builtintype" id="6327739">byte</span><br>
<span class="lineno">45</span><span class="op" id="6327744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6327747">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6327806">type</span>&nbsp;<span class="ident" id="6327811">SectionHeader</span>&nbsp;<span class="keyword" id="6327825">struct</span>&nbsp;<span class="op" id="6327832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327835">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6327845">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327853">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327863">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327876">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327886">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327899">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327909">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327917">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327927">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327935">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6327945">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327953">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6327963">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327971">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6327981">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327989">Addralign</span>&nbsp;<span class="ident" id="6327999">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328007">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6328017">uint64</span><br>
<span class="lineno"></span><span class="op" id="6328024">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6328027">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6328084">type</span>&nbsp;<span class="ident" id="6328089">Section</span>&nbsp;<span class="keyword" id="6328097">struct</span>&nbsp;<span class="op" id="6328104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328107">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6328123">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6328161">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6328201">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6328236">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6328284">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6328334">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328358">io</span><span class="op" id="6328360">.</span><span class="ident" id="6328361">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328371">sr</span>&nbsp;<span class="op" id="6328374">*</span><span class="ident" id="6328375">io</span><span class="op" id="6328377">.</span><span class="ident" id="6328378">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6328392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="6328395">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6328454">func</span>&nbsp;<span class="op" id="6328459">(</span><span class="ident" id="6328460">s</span>&nbsp;<span class="op" id="6328462">*</span><span class="ident" id="6328463">Section</span><span class="op" id="6328470">)</span>&nbsp;<span class="ident" id="6328472">Data</span><span class="op" id="6328476">(</span><span class="op" id="6328477">)</span>&nbsp;<span class="op" id="6328479">(</span><span class="op" id="6328480">[</span><span class="op" id="6328481">]</span><span class="builtintype" id="6328482">byte</span><span class="op" id="6328486">,</span>&nbsp;<span class="builtintype" id="6328488">error</span><span class="op" id="6328493">)</span>&nbsp;<span class="op" id="6328495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328498">dat</span>&nbsp;<span class="op" id="6328502">:=</span>&nbsp;<span class="builtinfunc" id="6328505">make</span><span class="op" id="6328509">(</span><span class="op" id="6328510">[</span><span class="op" id="6328511">]</span><span class="builtintype" id="6328512">byte</span><span class="op" id="6328516">,</span>&nbsp;<span class="ident" id="6328518">s</span><span class="op" id="6328519">.</span><span class="ident" id="6328520">sr</span><span class="op" id="6328522">.</span><span class="ident" id="6328523">Size</span><span class="op" id="6328527">(</span><span class="op" id="6328528">)</span><span class="op" id="6328529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328532">n</span><span class="op" id="6328533">,</span>&nbsp;<span class="ident" id="6328535">err</span>&nbsp;<span class="op" id="6328539">:=</span>&nbsp;<span class="ident" id="6328542">s</span><span class="op" id="6328543">.</span><span class="ident" id="6328544">sr</span><span class="op" id="6328546">.</span><span class="ident" id="6328547">ReadAt</span><span class="op" id="6328553">(</span><span class="ident" id="6328554">dat</span><span class="op" id="6328557">,</span>&nbsp;<span class="num" id="6328559">0</span><span class="op" id="6328560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328563">if</span>&nbsp;<span class="ident" id="6328566">n</span>&nbsp;<span class="op" id="6328568">==</span>&nbsp;<span class="builtinfunc" id="6328571">len</span><span class="op" id="6328574">(</span><span class="ident" id="6328575">dat</span><span class="op" id="6328578">)</span>&nbsp;<span class="op" id="6328580">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328584">err</span>&nbsp;<span class="op" id="6328588">=</span>&nbsp;<span class="ident" id="6328590">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328598">return</span>&nbsp;<span class="ident" id="6328605">dat</span><span class="op" id="6328608">[</span><span class="num" id="6328609">0</span><span class="op" id="6328610">:</span><span class="ident" id="6328611">n</span><span class="op" id="6328612">]</span><span class="op" id="6328613">,</span>&nbsp;<span class="ident" id="6328615">err</span><br>
<span class="lineno"></span><span class="op" id="6328619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="6328622">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6328685">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6328710">func</span>&nbsp;<span class="op" id="6328715">(</span><span class="ident" id="6328716">f</span>&nbsp;<span class="op" id="6328718">*</span><span class="ident" id="6328719">File</span><span class="op" id="6328723">)</span>&nbsp;<span class="ident" id="6328725">stringTable</span><span class="op" id="6328736">(</span><span class="ident" id="6328737">link</span>&nbsp;<span class="builtintype" id="6328742">uint32</span><span class="op" id="6328748">)</span>&nbsp;<span class="op" id="6328750">(</span><span class="op" id="6328751">[</span><span class="op" id="6328752">]</span><span class="builtintype" id="6328753">byte</span><span class="op" id="6328757">,</span>&nbsp;<span class="builtintype" id="6328759">error</span><span class="op" id="6328764">)</span>&nbsp;<span class="op" id="6328766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328769">if</span>&nbsp;<span class="ident" id="6328772">link</span>&nbsp;<span class="op" id="6328777">&lt;=</span>&nbsp;<span class="num" id="6328780">0</span>&nbsp;<span class="op" id="6328782">||</span>&nbsp;<span class="ident" id="6328785">link</span>&nbsp;<span class="op" id="6328790">&gt;=</span>&nbsp;<span class="builtintype" id="6328793">uint32</span><span class="op" id="6328799">(</span><span class="builtinfunc" id="6328800">len</span><span class="op" id="6328803">(</span><span class="ident" id="6328804">f</span><span class="op" id="6328805">.</span><span class="ident" id="6328806">Sections</span><span class="op" id="6328814">)</span><span class="op" id="6328815">)</span>&nbsp;<span class="op" id="6328817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328821">return</span>&nbsp;<span class="ident" id="6328828">nil</span><span class="op" id="6328831">,</span>&nbsp;<span class="ident" id="6328833">errors</span><span class="op" id="6328839">.</span><span class="ident" id="6328840">New</span><span class="op" id="6328843">(</span><span class="string" id="6328844">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="6328883">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328889">return</span>&nbsp;<span class="ident" id="6328896">f</span><span class="op" id="6328897">.</span><span class="ident" id="6328898">Sections</span><span class="op" id="6328906">[</span><span class="ident" id="6328907">link</span><span class="op" id="6328911">]</span><span class="op" id="6328912">.</span><span class="ident" id="6328913">Data</span><span class="op" id="6328917">(</span><span class="op" id="6328918">)</span><br>
<span class="lineno"></span><span class="op" id="6328920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6328923">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="6328981">func</span>&nbsp;<span class="op" id="6328986">(</span><span class="ident" id="6328987">s</span>&nbsp;<span class="op" id="6328989">*</span><span class="ident" id="6328990">Section</span><span class="op" id="6328997">)</span>&nbsp;<span class="ident" id="6328999">Open</span><span class="op" id="6329003">(</span><span class="op" id="6329004">)</span>&nbsp;<span class="ident" id="6329006">io</span><span class="op" id="6329008">.</span><span class="ident" id="6329009">ReadSeeker</span>&nbsp;<span class="op" id="6329020">{</span>&nbsp;<span class="keyword" id="6329022">return</span>&nbsp;<span class="ident" id="6329029">io</span><span class="op" id="6329031">.</span><span class="ident" id="6329032">NewSectionReader</span><span class="op" id="6329048">(</span><span class="ident" id="6329049">s</span><span class="op" id="6329050">.</span><span class="ident" id="6329051">sr</span><span class="op" id="6329053">,</span>&nbsp;<span class="num" id="6329055">0</span><span class="op" id="6329056">,</span>&nbsp;<span class="num" id="6329058">1</span><span class="op" id="6329059">&lt;&lt;</span><span class="num" id="6329061">63</span><span class="op" id="6329063">-</span><span class="num" id="6329064">1</span><span class="op" id="6329065">)</span>&nbsp;<span class="op" id="6329067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6329070">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6329126">type</span>&nbsp;<span class="ident" id="6329131">ProgHeader</span>&nbsp;<span class="keyword" id="6329142">struct</span>&nbsp;<span class="op" id="6329149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329152">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6329159">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329169">Flags</span>&nbsp;&nbsp;<span class="ident" id="6329176">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329186">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6329193">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329201">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="6329208">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329216">Paddr</span>&nbsp;&nbsp;<span class="ident" id="6329223">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329231">Filesz</span>&nbsp;<span class="ident" id="6329238">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329246">Memsz</span>&nbsp;&nbsp;<span class="ident" id="6329253">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329261">Align</span>&nbsp;&nbsp;<span class="ident" id="6329268">uint64</span><br>
<span class="lineno"></span><span class="op" id="6329275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6329278">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="6329345">type</span>&nbsp;<span class="ident" id="6329350">Prog</span>&nbsp;<span class="keyword" id="6329355">struct</span>&nbsp;<span class="op" id="6329362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329365">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329378">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329416">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329456">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329491">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329539">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6329589">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329613">io</span><span class="op" id="6329615">.</span><span class="ident" id="6329616">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329626">sr</span>&nbsp;<span class="op" id="6329629">*</span><span class="ident" id="6329630">io</span><span class="op" id="6329632">.</span><span class="ident" id="6329633">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6329647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6329650">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6329713">func</span>&nbsp;<span class="op" id="6329718">(</span><span class="ident" id="6329719">p</span>&nbsp;<span class="op" id="6329721">*</span><span class="ident" id="6329722">Prog</span><span class="op" id="6329726">)</span>&nbsp;<span class="ident" id="6329728">Open</span><span class="op" id="6329732">(</span><span class="op" id="6329733">)</span>&nbsp;<span class="ident" id="6329735">io</span><span class="op" id="6329737">.</span><span class="ident" id="6329738">ReadSeeker</span>&nbsp;<span class="op" id="6329749">{</span>&nbsp;<span class="keyword" id="6329751">return</span>&nbsp;<span class="ident" id="6329758">io</span><span class="op" id="6329760">.</span><span class="ident" id="6329761">NewSectionReader</span><span class="op" id="6329777">(</span><span class="ident" id="6329778">p</span><span class="op" id="6329779">.</span><span class="ident" id="6329780">sr</span><span class="op" id="6329782">,</span>&nbsp;<span class="num" id="6329784">0</span><span class="op" id="6329785">,</span>&nbsp;<span class="num" id="6329787">1</span><span class="op" id="6329788">&lt;&lt;</span><span class="num" id="6329790">63</span><span class="op" id="6329792">-</span><span class="num" id="6329793">1</span><span class="op" id="6329794">)</span>&nbsp;<span class="op" id="6329796">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="6329799">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6329863">type</span>&nbsp;<span class="ident" id="6329868">Symbol</span>&nbsp;<span class="keyword" id="6329875">struct</span>&nbsp;<span class="op" id="6329882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329885">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6329897">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329905">Info</span><span class="op" id="6329909">,</span>&nbsp;<span class="ident" id="6329911">Other</span>&nbsp;<span class="builtintype" id="6329917">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329923">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6329935">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329949">Value</span><span class="op" id="6329954">,</span>&nbsp;<span class="ident" id="6329956">Size</span>&nbsp;<span class="ident" id="6329961">uint64</span><br>
<span class="lineno"></span><span class="op" id="6329968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6329971">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6329993">type</span>&nbsp;<span class="ident" id="6329998">FormatError</span>&nbsp;<span class="keyword" id="6330010">struct</span>&nbsp;<span class="op" id="6330017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330020">off</span>&nbsp;<span class="ident" id="6330024">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330031">msg</span>&nbsp;<span class="builtintype" id="6330035">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330043">val</span>&nbsp;<span class="keyword" id="6330047">interface</span><span class="op" id="6330056">{</span><span class="op" id="6330057">}</span><br>
<span class="lineno"></span><span class="op" id="6330059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6330062">func</span>&nbsp;<span class="op" id="6330067">(</span><span class="ident" id="6330068">e</span>&nbsp;<span class="op" id="6330070">*</span><span class="ident" id="6330071">FormatError</span><span class="op" id="6330082">)</span>&nbsp;<span class="ident" id="6330084">Error</span><span class="op" id="6330089">(</span><span class="op" id="6330090">)</span>&nbsp;<span class="builtintype" id="6330092">string</span>&nbsp;<span class="op" id="6330099">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330102">msg</span>&nbsp;<span class="op" id="6330106">:=</span>&nbsp;<span class="ident" id="6330109">e</span><span class="op" id="6330110">.</span><span class="ident" id="6330111">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330116">if</span>&nbsp;<span class="ident" id="6330119">e</span><span class="op" id="6330120">.</span><span class="ident" id="6330121">val</span>&nbsp;<span class="op" id="6330125">!=</span>&nbsp;<span class="ident" id="6330128">nil</span>&nbsp;<span class="op" id="6330132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330136">msg</span>&nbsp;<span class="op" id="6330140">+=</span>&nbsp;<span class="ident" id="6330143">fmt</span><span class="op" id="6330146">.</span><span class="ident" id="6330147">Sprintf</span><span class="op" id="6330154">(</span><span class="string" id="6330155">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="6330163">,</span>&nbsp;<span class="ident" id="6330165">e</span><span class="op" id="6330166">.</span><span class="ident" id="6330167">val</span><span class="op" id="6330170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330176">msg</span>&nbsp;<span class="op" id="6330180">+=</span>&nbsp;<span class="ident" id="6330183">fmt</span><span class="op" id="6330186">.</span><span class="ident" id="6330187">Sprintf</span><span class="op" id="6330194">(</span><span class="string" id="6330195">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6330218">,</span>&nbsp;<span class="ident" id="6330220">e</span><span class="op" id="6330221">.</span><span class="ident" id="6330222">off</span><span class="op" id="6330225">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330228">return</span>&nbsp;<span class="ident" id="6330235">msg</span><br>
<span class="lineno"></span><span class="op" id="6330239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6330242">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6330327">func</span>&nbsp;<span class="ident" id="6330332">Open</span><span class="op" id="6330336">(</span><span class="ident" id="6330337">name</span>&nbsp;<span class="builtintype" id="6330342">string</span><span class="op" id="6330348">)</span>&nbsp;<span class="op" id="6330350">(</span><span class="op" id="6330351">*</span><span class="ident" id="6330352">File</span><span class="op" id="6330356">,</span>&nbsp;<span class="builtintype" id="6330358">error</span><span class="op" id="6330363">)</span>&nbsp;<span class="op" id="6330365">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330368">f</span><span class="op" id="6330369">,</span>&nbsp;<span class="ident" id="6330371">err</span>&nbsp;<span class="op" id="6330375">:=</span>&nbsp;<span class="ident" id="6330378">os</span><span class="op" id="6330380">.</span><span class="ident" id="6330381">Open</span><span class="op" id="6330385">(</span><span class="ident" id="6330386">name</span><span class="op" id="6330390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330393">if</span>&nbsp;<span class="ident" id="6330396">err</span>&nbsp;<span class="op" id="6330400">!=</span>&nbsp;<span class="ident" id="6330403">nil</span>&nbsp;<span class="op" id="6330407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330411">return</span>&nbsp;<span class="ident" id="6330418">nil</span><span class="op" id="6330421">,</span>&nbsp;<span class="ident" id="6330423">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330431">ff</span><span class="op" id="6330433">,</span>&nbsp;<span class="ident" id="6330435">err</span>&nbsp;<span class="op" id="6330439">:=</span>&nbsp;<span class="ident" id="6330442">NewFile</span><span class="op" id="6330449">(</span><span class="ident" id="6330450">f</span><span class="op" id="6330451">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330454">if</span>&nbsp;<span class="ident" id="6330457">err</span>&nbsp;<span class="op" id="6330461">!=</span>&nbsp;<span class="ident" id="6330464">nil</span>&nbsp;<span class="op" id="6330468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330472">f</span><span class="op" id="6330473">.</span><span class="ident" id="6330474">Close</span><span class="op" id="6330479">(</span><span class="op" id="6330480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330484">return</span>&nbsp;<span class="ident" id="6330491">nil</span><span class="op" id="6330494">,</span>&nbsp;<span class="ident" id="6330496">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330504">ff</span><span class="op" id="6330506">.</span><span class="ident" id="6330507">closer</span>&nbsp;<span class="op" id="6330514">=</span>&nbsp;<span class="ident" id="6330516">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330519">return</span>&nbsp;<span class="ident" id="6330526">ff</span><span class="op" id="6330528">,</span>&nbsp;<span class="ident" id="6330530">nil</span><br>
<span class="lineno"></span><span class="op" id="6330534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6330537">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6330563">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="6330630">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="6330654">func</span>&nbsp;<span class="op" id="6330659">(</span><span class="ident" id="6330660">f</span>&nbsp;<span class="op" id="6330662">*</span><span class="ident" id="6330663">File</span><span class="op" id="6330667">)</span>&nbsp;<span class="ident" id="6330669">Close</span><span class="op" id="6330674">(</span><span class="op" id="6330675">)</span>&nbsp;<span class="builtintype" id="6330677">error</span>&nbsp;<span class="op" id="6330683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330686">var</span>&nbsp;<span class="ident" id="6330690">err</span>&nbsp;<span class="builtintype" id="6330694">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330701">if</span>&nbsp;<span class="ident" id="6330704">f</span><span class="op" id="6330705">.</span><span class="ident" id="6330706">closer</span>&nbsp;<span class="op" id="6330713">!=</span>&nbsp;<span class="ident" id="6330716">nil</span>&nbsp;<span class="op" id="6330720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330724">err</span>&nbsp;<span class="op" id="6330728">=</span>&nbsp;<span class="ident" id="6330730">f</span><span class="op" id="6330731">.</span><span class="ident" id="6330732">closer</span><span class="op" id="6330738">.</span><span class="ident" id="6330739">Close</span><span class="op" id="6330744">(</span><span class="op" id="6330745">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330749">f</span><span class="op" id="6330750">.</span><span class="ident" id="6330751">closer</span>&nbsp;<span class="op" id="6330758">=</span>&nbsp;<span class="ident" id="6330760">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330768">return</span>&nbsp;<span class="ident" id="6330775">err</span><br>
<span class="lineno"></span><span class="op" id="6330779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="6330782">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6330839">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6330890">func</span>&nbsp;<span class="op" id="6330895">(</span><span class="ident" id="6330896">f</span>&nbsp;<span class="op" id="6330898">*</span><span class="ident" id="6330899">File</span><span class="op" id="6330903">)</span>&nbsp;<span class="ident" id="6330905">SectionByType</span><span class="op" id="6330918">(</span><span class="ident" id="6330919">typ</span>&nbsp;<span class="ident" id="6330923">SectionType</span><span class="op" id="6330934">)</span>&nbsp;<span class="op" id="6330936">*</span><span class="ident" id="6330937">Section</span>&nbsp;<span class="op" id="6330945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330948">for</span>&nbsp;<span class="ident" id="6330952">_</span><span class="op" id="6330953">,</span>&nbsp;<span class="ident" id="6330955">s</span>&nbsp;<span class="op" id="6330957">:=</span>&nbsp;<span class="keyword" id="6330960">range</span>&nbsp;<span class="ident" id="6330966">f</span><span class="op" id="6330967">.</span><span class="ident" id="6330968">Sections</span>&nbsp;<span class="op" id="6330977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330981">if</span>&nbsp;<span class="ident" id="6330984">s</span><span class="op" id="6330985">.</span><span class="ident" id="6330986">Type</span>&nbsp;<span class="op" id="6330991">==</span>&nbsp;<span class="ident" id="6330994">typ</span>&nbsp;<span class="op" id="6330998">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331003">return</span>&nbsp;<span class="ident" id="6331010">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331020">return</span>&nbsp;<span class="ident" id="6331027">nil</span><br>
<span class="lineno"></span><span class="op" id="6331031">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="6331034">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6331117">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="6331187">func</span>&nbsp;<span class="ident" id="6331192">NewFile</span><span class="op" id="6331199">(</span><span class="ident" id="6331200">r</span>&nbsp;<span class="ident" id="6331202">io</span><span class="op" id="6331204">.</span><span class="ident" id="6331205">ReaderAt</span><span class="op" id="6331213">)</span>&nbsp;<span class="op" id="6331215">(</span><span class="op" id="6331216">*</span><span class="ident" id="6331217">File</span><span class="op" id="6331221">,</span>&nbsp;<span class="builtintype" id="6331223">error</span><span class="op" id="6331228">)</span>&nbsp;<span class="op" id="6331230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331233">sr</span>&nbsp;<span class="op" id="6331236">:=</span>&nbsp;<span class="ident" id="6331239">io</span><span class="op" id="6331241">.</span><span class="ident" id="6331242">NewSectionReader</span><span class="op" id="6331258">(</span><span class="ident" id="6331259">r</span><span class="op" id="6331260">,</span>&nbsp;<span class="num" id="6331262">0</span><span class="op" id="6331263">,</span>&nbsp;<span class="num" id="6331265">1</span><span class="op" id="6331266">&lt;&lt;</span><span class="num" id="6331268">63</span><span class="op" id="6331270">-</span><span class="num" id="6331271">1</span><span class="op" id="6331272">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331275">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331310">var</span>&nbsp;<span class="ident" id="6331314">ident</span>&nbsp;<span class="op" id="6331320">[</span><span class="num" id="6331321">16</span><span class="op" id="6331323">]</span><span class="builtintype" id="6331324">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331331">if</span>&nbsp;<span class="ident" id="6331334">_</span><span class="op" id="6331335">,</span>&nbsp;<span class="ident" id="6331337">err</span>&nbsp;<span class="op" id="6331341">:=</span>&nbsp;<span class="ident" id="6331344">r</span><span class="op" id="6331345">.</span><span class="ident" id="6331346">ReadAt</span><span class="op" id="6331352">(</span><span class="ident" id="6331353">ident</span><span class="op" id="6331358">[</span><span class="num" id="6331359">0</span><span class="op" id="6331360">:</span><span class="op" id="6331361">]</span><span class="op" id="6331362">,</span>&nbsp;<span class="num" id="6331364">0</span><span class="op" id="6331365">)</span><span class="op" id="6331366">;</span>&nbsp;<span class="ident" id="6331368">err</span>&nbsp;<span class="op" id="6331372">!=</span>&nbsp;<span class="ident" id="6331375">nil</span>&nbsp;<span class="op" id="6331379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331383">return</span>&nbsp;<span class="ident" id="6331390">nil</span><span class="op" id="6331393">,</span>&nbsp;<span class="ident" id="6331395">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331400">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331403">if</span>&nbsp;<span class="ident" id="6331406">ident</span><span class="op" id="6331411">[</span><span class="num" id="6331412">0</span><span class="op" id="6331413">]</span>&nbsp;<span class="op" id="6331415">!=</span>&nbsp;<span class="string" id="6331418">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="6331425">||</span>&nbsp;<span class="ident" id="6331428">ident</span><span class="op" id="6331433">[</span><span class="num" id="6331434">1</span><span class="op" id="6331435">]</span>&nbsp;<span class="op" id="6331437">!=</span>&nbsp;<span class="string" id="6331440">&#39;E&#39;</span>&nbsp;<span class="op" id="6331444">||</span>&nbsp;<span class="ident" id="6331447">ident</span><span class="op" id="6331452">[</span><span class="num" id="6331453">2</span><span class="op" id="6331454">]</span>&nbsp;<span class="op" id="6331456">!=</span>&nbsp;<span class="string" id="6331459">&#39;L&#39;</span>&nbsp;<span class="op" id="6331463">||</span>&nbsp;<span class="ident" id="6331466">ident</span><span class="op" id="6331471">[</span><span class="num" id="6331472">3</span><span class="op" id="6331473">]</span>&nbsp;<span class="op" id="6331475">!=</span>&nbsp;<span class="string" id="6331478">&#39;F&#39;</span>&nbsp;<span class="op" id="6331482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331486">return</span>&nbsp;<span class="ident" id="6331493">nil</span><span class="op" id="6331496">,</span>&nbsp;<span class="op" id="6331498">&amp;</span><span class="ident" id="6331499">FormatError</span><span class="op" id="6331510">{</span><span class="num" id="6331511">0</span><span class="op" id="6331512">,</span>&nbsp;<span class="string" id="6331514">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6331532">,</span>&nbsp;<span class="ident" id="6331534">ident</span><span class="op" id="6331539">[</span><span class="num" id="6331540">0</span><span class="op" id="6331541">:</span><span class="num" id="6331542">4</span><span class="op" id="6331543">]</span><span class="op" id="6331544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331551">f</span>&nbsp;<span class="op" id="6331553">:=</span>&nbsp;<span class="builtinfunc" id="6331556">new</span><span class="op" id="6331559">(</span><span class="ident" id="6331560">File</span><span class="op" id="6331564">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331567">f</span><span class="op" id="6331568">.</span><span class="ident" id="6331569">Class</span>&nbsp;<span class="op" id="6331575">=</span>&nbsp;<span class="ident" id="6331577">Class</span><span class="op" id="6331582">(</span><span class="ident" id="6331583">ident</span><span class="op" id="6331588">[</span><span class="ident" id="6331589">EI_CLASS</span><span class="op" id="6331597">]</span><span class="op" id="6331598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331601">switch</span>&nbsp;<span class="ident" id="6331608">f</span><span class="op" id="6331609">.</span><span class="ident" id="6331610">Class</span>&nbsp;<span class="op" id="6331616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331619">case</span>&nbsp;<span class="ident" id="6331624">ELFCLASS32</span><span class="op" id="6331634">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331637">case</span>&nbsp;<span class="ident" id="6331642">ELFCLASS64</span><span class="op" id="6331652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331656">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331663">default</span><span class="op" id="6331670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331674">return</span>&nbsp;<span class="ident" id="6331681">nil</span><span class="op" id="6331684">,</span>&nbsp;<span class="op" id="6331686">&amp;</span><span class="ident" id="6331687">FormatError</span><span class="op" id="6331698">{</span><span class="num" id="6331699">0</span><span class="op" id="6331700">,</span>&nbsp;<span class="string" id="6331702">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="6331721">,</span>&nbsp;<span class="ident" id="6331723">f</span><span class="op" id="6331724">.</span><span class="ident" id="6331725">Class</span><span class="op" id="6331730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331737">f</span><span class="op" id="6331738">.</span><span class="ident" id="6331739">Data</span>&nbsp;<span class="op" id="6331744">=</span>&nbsp;<span class="ident" id="6331746">Data</span><span class="op" id="6331750">(</span><span class="ident" id="6331751">ident</span><span class="op" id="6331756">[</span><span class="ident" id="6331757">EI_DATA</span><span class="op" id="6331764">]</span><span class="op" id="6331765">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331768">switch</span>&nbsp;<span class="ident" id="6331775">f</span><span class="op" id="6331776">.</span><span class="ident" id="6331777">Data</span>&nbsp;<span class="op" id="6331782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331785">case</span>&nbsp;<span class="ident" id="6331790">ELFDATA2LSB</span><span class="op" id="6331801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331805">f</span><span class="op" id="6331806">.</span><span class="ident" id="6331807">ByteOrder</span>&nbsp;<span class="op" id="6331817">=</span>&nbsp;<span class="ident" id="6331819">binary</span><span class="op" id="6331825">.</span><span class="ident" id="6331826">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331840">case</span>&nbsp;<span class="ident" id="6331845">ELFDATA2MSB</span><span class="op" id="6331856">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331860">f</span><span class="op" id="6331861">.</span><span class="ident" id="6331862">ByteOrder</span>&nbsp;<span class="op" id="6331872">=</span>&nbsp;<span class="ident" id="6331874">binary</span><span class="op" id="6331880">.</span><span class="ident" id="6331881">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331892">default</span><span class="op" id="6331899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6331903">return</span>&nbsp;<span class="ident" id="6331910">nil</span><span class="op" id="6331913">,</span>&nbsp;<span class="op" id="6331915">&amp;</span><span class="ident" id="6331916">FormatError</span><span class="op" id="6331927">{</span><span class="num" id="6331928">0</span><span class="op" id="6331929">,</span>&nbsp;<span class="string" id="6331931">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="6331958">,</span>&nbsp;<span class="ident" id="6331960">f</span><span class="op" id="6331961">.</span><span class="ident" id="6331962">Data</span><span class="op" id="6331966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6331969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331973">f</span><span class="op" id="6331974">.</span><span class="ident" id="6331975">Version</span>&nbsp;<span class="op" id="6331983">=</span>&nbsp;<span class="ident" id="6331985">Version</span><span class="op" id="6331992">(</span><span class="ident" id="6331993">ident</span><span class="op" id="6331998">[</span><span class="ident" id="6331999">EI_VERSION</span><span class="op" id="6332009">]</span><span class="op" id="6332010">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332013">if</span>&nbsp;<span class="ident" id="6332016">f</span><span class="op" id="6332017">.</span><span class="ident" id="6332018">Version</span>&nbsp;<span class="op" id="6332026">!=</span>&nbsp;<span class="ident" id="6332029">EV_CURRENT</span>&nbsp;<span class="op" id="6332040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332044">return</span>&nbsp;<span class="ident" id="6332051">nil</span><span class="op" id="6332054">,</span>&nbsp;<span class="op" id="6332056">&amp;</span><span class="ident" id="6332057">FormatError</span><span class="op" id="6332068">{</span><span class="num" id="6332069">0</span><span class="op" id="6332070">,</span>&nbsp;<span class="string" id="6332072">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6332093">,</span>&nbsp;<span class="ident" id="6332095">f</span><span class="op" id="6332096">.</span><span class="ident" id="6332097">Version</span><span class="op" id="6332104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6332107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332111">f</span><span class="op" id="6332112">.</span><span class="ident" id="6332113">OSABI</span>&nbsp;<span class="op" id="6332119">=</span>&nbsp;<span class="ident" id="6332121">OSABI</span><span class="op" id="6332126">(</span><span class="ident" id="6332127">ident</span><span class="op" id="6332132">[</span><span class="ident" id="6332133">EI_OSABI</span><span class="op" id="6332141">]</span><span class="op" id="6332142">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332145">f</span><span class="op" id="6332146">.</span><span class="ident" id="6332147">ABIVersion</span>&nbsp;<span class="op" id="6332158">=</span>&nbsp;<span class="ident" id="6332160">ident</span><span class="op" id="6332165">[</span><span class="ident" id="6332166">EI_ABIVERSION</span><span class="op" id="6332179">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332183">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332208">var</span>&nbsp;<span class="ident" id="6332212">phoff</span>&nbsp;<span class="ident" id="6332218">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332225">var</span>&nbsp;<span class="ident" id="6332229">phentsize</span><span class="op" id="6332238">,</span>&nbsp;<span class="ident" id="6332240">phnum</span>&nbsp;<span class="builtintype" id="6332246">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332251">var</span>&nbsp;<span class="ident" id="6332255">shoff</span>&nbsp;<span class="ident" id="6332261">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332268">var</span>&nbsp;<span class="ident" id="6332272">shentsize</span><span class="op" id="6332281">,</span>&nbsp;<span class="ident" id="6332283">shnum</span><span class="op" id="6332288">,</span>&nbsp;<span class="ident" id="6332290">shstrndx</span>&nbsp;<span class="builtintype" id="6332299">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332304">shstrndx</span>&nbsp;<span class="op" id="6332313">=</span>&nbsp;<span class="op" id="6332315">-</span><span class="num" id="6332316">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332319">switch</span>&nbsp;<span class="ident" id="6332326">f</span><span class="op" id="6332327">.</span><span class="ident" id="6332328">Class</span>&nbsp;<span class="op" id="6332334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332337">case</span>&nbsp;<span class="ident" id="6332342">ELFCLASS32</span><span class="op" id="6332352">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332356">hdr</span>&nbsp;<span class="op" id="6332360">:=</span>&nbsp;<span class="builtinfunc" id="6332363">new</span><span class="op" id="6332366">(</span><span class="ident" id="6332367">Header32</span><span class="op" id="6332375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332379">sr</span><span class="op" id="6332381">.</span><span class="ident" id="6332382">Seek</span><span class="op" id="6332386">(</span><span class="num" id="6332387">0</span><span class="op" id="6332388">,</span>&nbsp;<span class="ident" id="6332390">os</span><span class="op" id="6332392">.</span><span class="ident" id="6332393">SEEK_SET</span><span class="op" id="6332401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332405">if</span>&nbsp;<span class="ident" id="6332408">err</span>&nbsp;<span class="op" id="6332412">:=</span>&nbsp;<span class="ident" id="6332415">binary</span><span class="op" id="6332421">.</span><span class="ident" id="6332422">Read</span><span class="op" id="6332426">(</span><span class="ident" id="6332427">sr</span><span class="op" id="6332429">,</span>&nbsp;<span class="ident" id="6332431">f</span><span class="op" id="6332432">.</span><span class="ident" id="6332433">ByteOrder</span><span class="op" id="6332442">,</span>&nbsp;<span class="ident" id="6332444">hdr</span><span class="op" id="6332447">)</span><span class="op" id="6332448">;</span>&nbsp;<span class="ident" id="6332450">err</span>&nbsp;<span class="op" id="6332454">!=</span>&nbsp;<span class="ident" id="6332457">nil</span>&nbsp;<span class="op" id="6332461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332466">return</span>&nbsp;<span class="ident" id="6332473">nil</span><span class="op" id="6332476">,</span>&nbsp;<span class="ident" id="6332478">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6332484">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332488">f</span><span class="op" id="6332489">.</span><span class="ident" id="6332490">Type</span>&nbsp;<span class="op" id="6332495">=</span>&nbsp;<span class="ident" id="6332497">Type</span><span class="op" id="6332501">(</span><span class="ident" id="6332502">hdr</span><span class="op" id="6332505">.</span><span class="ident" id="6332506">Type</span><span class="op" id="6332510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332514">f</span><span class="op" id="6332515">.</span><span class="ident" id="6332516">Machine</span>&nbsp;<span class="op" id="6332524">=</span>&nbsp;<span class="ident" id="6332526">Machine</span><span class="op" id="6332533">(</span><span class="ident" id="6332534">hdr</span><span class="op" id="6332537">.</span><span class="ident" id="6332538">Machine</span><span class="op" id="6332545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332549">f</span><span class="op" id="6332550">.</span><span class="ident" id="6332551">Entry</span>&nbsp;<span class="op" id="6332557">=</span>&nbsp;<span class="ident" id="6332559">uint64</span><span class="op" id="6332565">(</span><span class="ident" id="6332566">hdr</span><span class="op" id="6332569">.</span><span class="ident" id="6332570">Entry</span><span class="op" id="6332575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332579">if</span>&nbsp;<span class="ident" id="6332582">v</span>&nbsp;<span class="op" id="6332584">:=</span>&nbsp;<span class="ident" id="6332587">Version</span><span class="op" id="6332594">(</span><span class="ident" id="6332595">hdr</span><span class="op" id="6332598">.</span><span class="ident" id="6332599">Version</span><span class="op" id="6332606">)</span><span class="op" id="6332607">;</span>&nbsp;<span class="ident" id="6332609">v</span>&nbsp;<span class="op" id="6332611">!=</span>&nbsp;<span class="ident" id="6332614">f</span><span class="op" id="6332615">.</span><span class="ident" id="6332616">Version</span>&nbsp;<span class="op" id="6332624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332629">return</span>&nbsp;<span class="ident" id="6332636">nil</span><span class="op" id="6332639">,</span>&nbsp;<span class="op" id="6332641">&amp;</span><span class="ident" id="6332642">FormatError</span><span class="op" id="6332653">{</span><span class="num" id="6332654">0</span><span class="op" id="6332655">,</span>&nbsp;<span class="string" id="6332657">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6332681">,</span>&nbsp;<span class="ident" id="6332683">v</span><span class="op" id="6332684">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6332688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332692">phoff</span>&nbsp;<span class="op" id="6332698">=</span>&nbsp;<span class="ident" id="6332700">int64</span><span class="op" id="6332705">(</span><span class="ident" id="6332706">hdr</span><span class="op" id="6332709">.</span><span class="ident" id="6332710">Phoff</span><span class="op" id="6332715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332719">phentsize</span>&nbsp;<span class="op" id="6332729">=</span>&nbsp;<span class="builtintype" id="6332731">int</span><span class="op" id="6332734">(</span><span class="ident" id="6332735">hdr</span><span class="op" id="6332738">.</span><span class="ident" id="6332739">Phentsize</span><span class="op" id="6332748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332752">phnum</span>&nbsp;<span class="op" id="6332758">=</span>&nbsp;<span class="builtintype" id="6332760">int</span><span class="op" id="6332763">(</span><span class="ident" id="6332764">hdr</span><span class="op" id="6332767">.</span><span class="ident" id="6332768">Phnum</span><span class="op" id="6332773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332777">shoff</span>&nbsp;<span class="op" id="6332783">=</span>&nbsp;<span class="ident" id="6332785">int64</span><span class="op" id="6332790">(</span><span class="ident" id="6332791">hdr</span><span class="op" id="6332794">.</span><span class="ident" id="6332795">Shoff</span><span class="op" id="6332800">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332804">shentsize</span>&nbsp;<span class="op" id="6332814">=</span>&nbsp;<span class="builtintype" id="6332816">int</span><span class="op" id="6332819">(</span><span class="ident" id="6332820">hdr</span><span class="op" id="6332823">.</span><span class="ident" id="6332824">Shentsize</span><span class="op" id="6332833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332837">shnum</span>&nbsp;<span class="op" id="6332843">=</span>&nbsp;<span class="builtintype" id="6332845">int</span><span class="op" id="6332848">(</span><span class="ident" id="6332849">hdr</span><span class="op" id="6332852">.</span><span class="ident" id="6332853">Shnum</span><span class="op" id="6332858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332862">shstrndx</span>&nbsp;<span class="op" id="6332871">=</span>&nbsp;<span class="builtintype" id="6332873">int</span><span class="op" id="6332876">(</span><span class="ident" id="6332877">hdr</span><span class="op" id="6332880">.</span><span class="ident" id="6332881">Shstrndx</span><span class="op" id="6332889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332892">case</span>&nbsp;<span class="ident" id="6332897">ELFCLASS64</span><span class="op" id="6332907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332911">hdr</span>&nbsp;<span class="op" id="6332915">:=</span>&nbsp;<span class="builtinfunc" id="6332918">new</span><span class="op" id="6332921">(</span><span class="ident" id="6332922">Header64</span><span class="op" id="6332930">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332934">sr</span><span class="op" id="6332936">.</span><span class="ident" id="6332937">Seek</span><span class="op" id="6332941">(</span><span class="num" id="6332942">0</span><span class="op" id="6332943">,</span>&nbsp;<span class="ident" id="6332945">os</span><span class="op" id="6332947">.</span><span class="ident" id="6332948">SEEK_SET</span><span class="op" id="6332956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332960">if</span>&nbsp;<span class="ident" id="6332963">err</span>&nbsp;<span class="op" id="6332967">:=</span>&nbsp;<span class="ident" id="6332970">binary</span><span class="op" id="6332976">.</span><span class="ident" id="6332977">Read</span><span class="op" id="6332981">(</span><span class="ident" id="6332982">sr</span><span class="op" id="6332984">,</span>&nbsp;<span class="ident" id="6332986">f</span><span class="op" id="6332987">.</span><span class="ident" id="6332988">ByteOrder</span><span class="op" id="6332997">,</span>&nbsp;<span class="ident" id="6332999">hdr</span><span class="op" id="6333002">)</span><span class="op" id="6333003">;</span>&nbsp;<span class="ident" id="6333005">err</span>&nbsp;<span class="op" id="6333009">!=</span>&nbsp;<span class="ident" id="6333012">nil</span>&nbsp;<span class="op" id="6333016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333021">return</span>&nbsp;<span class="ident" id="6333028">nil</span><span class="op" id="6333031">,</span>&nbsp;<span class="ident" id="6333033">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6333039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333043">f</span><span class="op" id="6333044">.</span><span class="ident" id="6333045">Type</span>&nbsp;<span class="op" id="6333050">=</span>&nbsp;<span class="ident" id="6333052">Type</span><span class="op" id="6333056">(</span><span class="ident" id="6333057">hdr</span><span class="op" id="6333060">.</span><span class="ident" id="6333061">Type</span><span class="op" id="6333065">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333069">f</span><span class="op" id="6333070">.</span><span class="ident" id="6333071">Machine</span>&nbsp;<span class="op" id="6333079">=</span>&nbsp;<span class="ident" id="6333081">Machine</span><span class="op" id="6333088">(</span><span class="ident" id="6333089">hdr</span><span class="op" id="6333092">.</span><span class="ident" id="6333093">Machine</span><span class="op" id="6333100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333104">f</span><span class="op" id="6333105">.</span><span class="ident" id="6333106">Entry</span>&nbsp;<span class="op" id="6333112">=</span>&nbsp;<span class="ident" id="6333114">uint64</span><span class="op" id="6333120">(</span><span class="ident" id="6333121">hdr</span><span class="op" id="6333124">.</span><span class="ident" id="6333125">Entry</span><span class="op" id="6333130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333134">if</span>&nbsp;<span class="ident" id="6333137">v</span>&nbsp;<span class="op" id="6333139">:=</span>&nbsp;<span class="ident" id="6333142">Version</span><span class="op" id="6333149">(</span><span class="ident" id="6333150">hdr</span><span class="op" id="6333153">.</span><span class="ident" id="6333154">Version</span><span class="op" id="6333161">)</span><span class="op" id="6333162">;</span>&nbsp;<span class="ident" id="6333164">v</span>&nbsp;<span class="op" id="6333166">!=</span>&nbsp;<span class="ident" id="6333169">f</span><span class="op" id="6333170">.</span><span class="ident" id="6333171">Version</span>&nbsp;<span class="op" id="6333179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333184">return</span>&nbsp;<span class="ident" id="6333191">nil</span><span class="op" id="6333194">,</span>&nbsp;<span class="op" id="6333196">&amp;</span><span class="ident" id="6333197">FormatError</span><span class="op" id="6333208">{</span><span class="num" id="6333209">0</span><span class="op" id="6333210">,</span>&nbsp;<span class="string" id="6333212">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6333236">,</span>&nbsp;<span class="ident" id="6333238">v</span><span class="op" id="6333239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6333243">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333247">phoff</span>&nbsp;<span class="op" id="6333253">=</span>&nbsp;<span class="ident" id="6333255">int64</span><span class="op" id="6333260">(</span><span class="ident" id="6333261">hdr</span><span class="op" id="6333264">.</span><span class="ident" id="6333265">Phoff</span><span class="op" id="6333270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333274">phentsize</span>&nbsp;<span class="op" id="6333284">=</span>&nbsp;<span class="builtintype" id="6333286">int</span><span class="op" id="6333289">(</span><span class="ident" id="6333290">hdr</span><span class="op" id="6333293">.</span><span class="ident" id="6333294">Phentsize</span><span class="op" id="6333303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333307">phnum</span>&nbsp;<span class="op" id="6333313">=</span>&nbsp;<span class="builtintype" id="6333315">int</span><span class="op" id="6333318">(</span><span class="ident" id="6333319">hdr</span><span class="op" id="6333322">.</span><span class="ident" id="6333323">Phnum</span><span class="op" id="6333328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333332">shoff</span>&nbsp;<span class="op" id="6333338">=</span>&nbsp;<span class="ident" id="6333340">int64</span><span class="op" id="6333345">(</span><span class="ident" id="6333346">hdr</span><span class="op" id="6333349">.</span><span class="ident" id="6333350">Shoff</span><span class="op" id="6333355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333359">shentsize</span>&nbsp;<span class="op" id="6333369">=</span>&nbsp;<span class="builtintype" id="6333371">int</span><span class="op" id="6333374">(</span><span class="ident" id="6333375">hdr</span><span class="op" id="6333378">.</span><span class="ident" id="6333379">Shentsize</span><span class="op" id="6333388">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333392">shnum</span>&nbsp;<span class="op" id="6333398">=</span>&nbsp;<span class="builtintype" id="6333400">int</span><span class="op" id="6333403">(</span><span class="ident" id="6333404">hdr</span><span class="op" id="6333407">.</span><span class="ident" id="6333408">Shnum</span><span class="op" id="6333413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333417">shstrndx</span>&nbsp;<span class="op" id="6333426">=</span>&nbsp;<span class="builtintype" id="6333428">int</span><span class="op" id="6333431">(</span><span class="ident" id="6333432">hdr</span><span class="op" id="6333435">.</span><span class="ident" id="6333436">Shstrndx</span><span class="op" id="6333444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6333447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333451">if</span>&nbsp;<span class="ident" id="6333454">shnum</span>&nbsp;<span class="op" id="6333460">&gt;</span>&nbsp;<span class="num" id="6333462">0</span>&nbsp;<span class="op" id="6333464">&amp;&amp;</span>&nbsp;<span class="ident" id="6333467">shoff</span>&nbsp;<span class="op" id="6333473">&gt;</span>&nbsp;<span class="num" id="6333475">0</span>&nbsp;<span class="op" id="6333477">&amp;&amp;</span>&nbsp;<span class="op" id="6333480">(</span><span class="ident" id="6333481">shstrndx</span>&nbsp;<span class="op" id="6333490">&lt;</span>&nbsp;<span class="num" id="6333492">0</span>&nbsp;<span class="op" id="6333494">||</span>&nbsp;<span class="ident" id="6333497">shstrndx</span>&nbsp;<span class="op" id="6333506">&gt;=</span>&nbsp;<span class="ident" id="6333509">shnum</span><span class="op" id="6333514">)</span>&nbsp;<span class="op" id="6333516">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333520">return</span>&nbsp;<span class="ident" id="6333527">nil</span><span class="op" id="6333530">,</span>&nbsp;<span class="op" id="6333532">&amp;</span><span class="ident" id="6333533">FormatError</span><span class="op" id="6333544">{</span><span class="num" id="6333545">0</span><span class="op" id="6333546">,</span>&nbsp;<span class="string" id="6333548">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="6333570">,</span>&nbsp;<span class="ident" id="6333572">shstrndx</span><span class="op" id="6333580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6333583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333587">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333612">f</span><span class="op" id="6333613">.</span><span class="ident" id="6333614">Progs</span>&nbsp;<span class="op" id="6333620">=</span>&nbsp;<span class="builtinfunc" id="6333622">make</span><span class="op" id="6333626">(</span><span class="op" id="6333627">[</span><span class="op" id="6333628">]</span><span class="op" id="6333629">*</span><span class="ident" id="6333630">Prog</span><span class="op" id="6333634">,</span>&nbsp;<span class="ident" id="6333636">phnum</span><span class="op" id="6333641">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333644">for</span>&nbsp;<span class="ident" id="6333648">i</span>&nbsp;<span class="op" id="6333650">:=</span>&nbsp;<span class="num" id="6333653">0</span><span class="op" id="6333654">;</span>&nbsp;<span class="ident" id="6333656">i</span>&nbsp;<span class="op" id="6333658">&lt;</span>&nbsp;<span class="ident" id="6333660">phnum</span><span class="op" id="6333665">;</span>&nbsp;<span class="ident" id="6333667">i</span><span class="op" id="6333668">++</span>&nbsp;<span class="op" id="6333671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333675">off</span>&nbsp;<span class="op" id="6333679">:=</span>&nbsp;<span class="ident" id="6333682">phoff</span>&nbsp;<span class="op" id="6333688">+</span>&nbsp;<span class="ident" id="6333690">int64</span><span class="op" id="6333695">(</span><span class="ident" id="6333696">i</span><span class="op" id="6333697">)</span><span class="op" id="6333698">*</span><span class="ident" id="6333699">int64</span><span class="op" id="6333704">(</span><span class="ident" id="6333705">phentsize</span><span class="op" id="6333714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333718">sr</span><span class="op" id="6333720">.</span><span class="ident" id="6333721">Seek</span><span class="op" id="6333725">(</span><span class="ident" id="6333726">off</span><span class="op" id="6333729">,</span>&nbsp;<span class="ident" id="6333731">os</span><span class="op" id="6333733">.</span><span class="ident" id="6333734">SEEK_SET</span><span class="op" id="6333742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333746">p</span>&nbsp;<span class="op" id="6333748">:=</span>&nbsp;<span class="builtinfunc" id="6333751">new</span><span class="op" id="6333754">(</span><span class="ident" id="6333755">Prog</span><span class="op" id="6333759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333763">switch</span>&nbsp;<span class="ident" id="6333770">f</span><span class="op" id="6333771">.</span><span class="ident" id="6333772">Class</span>&nbsp;<span class="op" id="6333778">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333782">case</span>&nbsp;<span class="ident" id="6333787">ELFCLASS32</span><span class="op" id="6333797">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333802">ph</span>&nbsp;<span class="op" id="6333805">:=</span>&nbsp;<span class="builtinfunc" id="6333808">new</span><span class="op" id="6333811">(</span><span class="ident" id="6333812">Prog32</span><span class="op" id="6333818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333823">if</span>&nbsp;<span class="ident" id="6333826">err</span>&nbsp;<span class="op" id="6333830">:=</span>&nbsp;<span class="ident" id="6333833">binary</span><span class="op" id="6333839">.</span><span class="ident" id="6333840">Read</span><span class="op" id="6333844">(</span><span class="ident" id="6333845">sr</span><span class="op" id="6333847">,</span>&nbsp;<span class="ident" id="6333849">f</span><span class="op" id="6333850">.</span><span class="ident" id="6333851">ByteOrder</span><span class="op" id="6333860">,</span>&nbsp;<span class="ident" id="6333862">ph</span><span class="op" id="6333864">)</span><span class="op" id="6333865">;</span>&nbsp;<span class="ident" id="6333867">err</span>&nbsp;<span class="op" id="6333871">!=</span>&nbsp;<span class="ident" id="6333874">nil</span>&nbsp;<span class="op" id="6333878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333884">return</span>&nbsp;<span class="ident" id="6333891">nil</span><span class="op" id="6333894">,</span>&nbsp;<span class="ident" id="6333896">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6333903">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333908">p</span><span class="op" id="6333909">.</span><span class="ident" id="6333910">ProgHeader</span>&nbsp;<span class="op" id="6333921">=</span>&nbsp;<span class="ident" id="6333923">ProgHeader</span><span class="op" id="6333933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333939">Type</span><span class="op" id="6333943">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6333947">ProgType</span><span class="op" id="6333955">(</span><span class="ident" id="6333956">ph</span><span class="op" id="6333958">.</span><span class="ident" id="6333959">Type</span><span class="op" id="6333963">)</span><span class="op" id="6333964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333970">Flags</span><span class="op" id="6333975">:</span>&nbsp;&nbsp;<span class="ident" id="6333978">ProgFlag</span><span class="op" id="6333986">(</span><span class="ident" id="6333987">ph</span><span class="op" id="6333989">.</span><span class="ident" id="6333990">Flags</span><span class="op" id="6333995">)</span><span class="op" id="6333996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334002">Off</span><span class="op" id="6334005">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6334010">uint64</span><span class="op" id="6334016">(</span><span class="ident" id="6334017">ph</span><span class="op" id="6334019">.</span><span class="ident" id="6334020">Off</span><span class="op" id="6334023">)</span><span class="op" id="6334024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334030">Vaddr</span><span class="op" id="6334035">:</span>&nbsp;&nbsp;<span class="ident" id="6334038">uint64</span><span class="op" id="6334044">(</span><span class="ident" id="6334045">ph</span><span class="op" id="6334047">.</span><span class="ident" id="6334048">Vaddr</span><span class="op" id="6334053">)</span><span class="op" id="6334054">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334060">Paddr</span><span class="op" id="6334065">:</span>&nbsp;&nbsp;<span class="ident" id="6334068">uint64</span><span class="op" id="6334074">(</span><span class="ident" id="6334075">ph</span><span class="op" id="6334077">.</span><span class="ident" id="6334078">Paddr</span><span class="op" id="6334083">)</span><span class="op" id="6334084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334090">Filesz</span><span class="op" id="6334096">:</span>&nbsp;<span class="ident" id="6334098">uint64</span><span class="op" id="6334104">(</span><span class="ident" id="6334105">ph</span><span class="op" id="6334107">.</span><span class="ident" id="6334108">Filesz</span><span class="op" id="6334114">)</span><span class="op" id="6334115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334121">Memsz</span><span class="op" id="6334126">:</span>&nbsp;&nbsp;<span class="ident" id="6334129">uint64</span><span class="op" id="6334135">(</span><span class="ident" id="6334136">ph</span><span class="op" id="6334138">.</span><span class="ident" id="6334139">Memsz</span><span class="op" id="6334144">)</span><span class="op" id="6334145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334151">Align</span><span class="op" id="6334156">:</span>&nbsp;&nbsp;<span class="ident" id="6334159">uint64</span><span class="op" id="6334165">(</span><span class="ident" id="6334166">ph</span><span class="op" id="6334168">.</span><span class="ident" id="6334169">Align</span><span class="op" id="6334174">)</span><span class="op" id="6334175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6334180">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334184">case</span>&nbsp;<span class="ident" id="6334189">ELFCLASS64</span><span class="op" id="6334199">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334204">ph</span>&nbsp;<span class="op" id="6334207">:=</span>&nbsp;<span class="builtinfunc" id="6334210">new</span><span class="op" id="6334213">(</span><span class="ident" id="6334214">Prog64</span><span class="op" id="6334220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334225">if</span>&nbsp;<span class="ident" id="6334228">err</span>&nbsp;<span class="op" id="6334232">:=</span>&nbsp;<span class="ident" id="6334235">binary</span><span class="op" id="6334241">.</span><span class="ident" id="6334242">Read</span><span class="op" id="6334246">(</span><span class="ident" id="6334247">sr</span><span class="op" id="6334249">,</span>&nbsp;<span class="ident" id="6334251">f</span><span class="op" id="6334252">.</span><span class="ident" id="6334253">ByteOrder</span><span class="op" id="6334262">,</span>&nbsp;<span class="ident" id="6334264">ph</span><span class="op" id="6334266">)</span><span class="op" id="6334267">;</span>&nbsp;<span class="ident" id="6334269">err</span>&nbsp;<span class="op" id="6334273">!=</span>&nbsp;<span class="ident" id="6334276">nil</span>&nbsp;<span class="op" id="6334280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334286">return</span>&nbsp;<span class="ident" id="6334293">nil</span><span class="op" id="6334296">,</span>&nbsp;<span class="ident" id="6334298">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6334305">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334310">p</span><span class="op" id="6334311">.</span><span class="ident" id="6334312">ProgHeader</span>&nbsp;<span class="op" id="6334323">=</span>&nbsp;<span class="ident" id="6334325">ProgHeader</span><span class="op" id="6334335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334341">Type</span><span class="op" id="6334345">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6334349">ProgType</span><span class="op" id="6334357">(</span><span class="ident" id="6334358">ph</span><span class="op" id="6334360">.</span><span class="ident" id="6334361">Type</span><span class="op" id="6334365">)</span><span class="op" id="6334366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334372">Flags</span><span class="op" id="6334377">:</span>&nbsp;&nbsp;<span class="ident" id="6334380">ProgFlag</span><span class="op" id="6334388">(</span><span class="ident" id="6334389">ph</span><span class="op" id="6334391">.</span><span class="ident" id="6334392">Flags</span><span class="op" id="6334397">)</span><span class="op" id="6334398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334404">Off</span><span class="op" id="6334407">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6334412">uint64</span><span class="op" id="6334418">(</span><span class="ident" id="6334419">ph</span><span class="op" id="6334421">.</span><span class="ident" id="6334422">Off</span><span class="op" id="6334425">)</span><span class="op" id="6334426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334432">Vaddr</span><span class="op" id="6334437">:</span>&nbsp;&nbsp;<span class="ident" id="6334440">uint64</span><span class="op" id="6334446">(</span><span class="ident" id="6334447">ph</span><span class="op" id="6334449">.</span><span class="ident" id="6334450">Vaddr</span><span class="op" id="6334455">)</span><span class="op" id="6334456">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334462">Paddr</span><span class="op" id="6334467">:</span>&nbsp;&nbsp;<span class="ident" id="6334470">uint64</span><span class="op" id="6334476">(</span><span class="ident" id="6334477">ph</span><span class="op" id="6334479">.</span><span class="ident" id="6334480">Paddr</span><span class="op" id="6334485">)</span><span class="op" id="6334486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334492">Filesz</span><span class="op" id="6334498">:</span>&nbsp;<span class="ident" id="6334500">uint64</span><span class="op" id="6334506">(</span><span class="ident" id="6334507">ph</span><span class="op" id="6334509">.</span><span class="ident" id="6334510">Filesz</span><span class="op" id="6334516">)</span><span class="op" id="6334517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334523">Memsz</span><span class="op" id="6334528">:</span>&nbsp;&nbsp;<span class="ident" id="6334531">uint64</span><span class="op" id="6334537">(</span><span class="ident" id="6334538">ph</span><span class="op" id="6334540">.</span><span class="ident" id="6334541">Memsz</span><span class="op" id="6334546">)</span><span class="op" id="6334547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334553">Align</span><span class="op" id="6334558">:</span>&nbsp;&nbsp;<span class="ident" id="6334561">uint64</span><span class="op" id="6334567">(</span><span class="ident" id="6334568">ph</span><span class="op" id="6334570">.</span><span class="ident" id="6334571">Align</span><span class="op" id="6334576">)</span><span class="op" id="6334577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6334582">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6334586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334590">p</span><span class="op" id="6334591">.</span><span class="ident" id="6334592">sr</span>&nbsp;<span class="op" id="6334595">=</span>&nbsp;<span class="ident" id="6334597">io</span><span class="op" id="6334599">.</span><span class="ident" id="6334600">NewSectionReader</span><span class="op" id="6334616">(</span><span class="ident" id="6334617">r</span><span class="op" id="6334618">,</span>&nbsp;<span class="ident" id="6334620">int64</span><span class="op" id="6334625">(</span><span class="ident" id="6334626">p</span><span class="op" id="6334627">.</span><span class="ident" id="6334628">Off</span><span class="op" id="6334631">)</span><span class="op" id="6334632">,</span>&nbsp;<span class="ident" id="6334634">int64</span><span class="op" id="6334639">(</span><span class="ident" id="6334640">p</span><span class="op" id="6334641">.</span><span class="ident" id="6334642">Filesz</span><span class="op" id="6334648">)</span><span class="op" id="6334649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334653">p</span><span class="op" id="6334654">.</span><span class="ident" id="6334655">ReaderAt</span>&nbsp;<span class="op" id="6334664">=</span>&nbsp;<span class="ident" id="6334666">p</span><span class="op" id="6334667">.</span><span class="ident" id="6334668">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334673">f</span><span class="op" id="6334674">.</span><span class="ident" id="6334675">Progs</span><span class="op" id="6334680">[</span><span class="ident" id="6334681">i</span><span class="op" id="6334682">]</span>&nbsp;<span class="op" id="6334684">=</span>&nbsp;<span class="ident" id="6334686">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6334689">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334693">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334718">f</span><span class="op" id="6334719">.</span><span class="ident" id="6334720">Sections</span>&nbsp;<span class="op" id="6334729">=</span>&nbsp;<span class="builtinfunc" id="6334731">make</span><span class="op" id="6334735">(</span><span class="op" id="6334736">[</span><span class="op" id="6334737">]</span><span class="op" id="6334738">*</span><span class="ident" id="6334739">Section</span><span class="op" id="6334746">,</span>&nbsp;<span class="ident" id="6334748">shnum</span><span class="op" id="6334753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334756">names</span>&nbsp;<span class="op" id="6334762">:=</span>&nbsp;<span class="builtinfunc" id="6334765">make</span><span class="op" id="6334769">(</span><span class="op" id="6334770">[</span><span class="op" id="6334771">]</span><span class="builtintype" id="6334772">uint32</span><span class="op" id="6334778">,</span>&nbsp;<span class="ident" id="6334780">shnum</span><span class="op" id="6334785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334788">for</span>&nbsp;<span class="ident" id="6334792">i</span>&nbsp;<span class="op" id="6334794">:=</span>&nbsp;<span class="num" id="6334797">0</span><span class="op" id="6334798">;</span>&nbsp;<span class="ident" id="6334800">i</span>&nbsp;<span class="op" id="6334802">&lt;</span>&nbsp;<span class="ident" id="6334804">shnum</span><span class="op" id="6334809">;</span>&nbsp;<span class="ident" id="6334811">i</span><span class="op" id="6334812">++</span>&nbsp;<span class="op" id="6334815">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334819">off</span>&nbsp;<span class="op" id="6334823">:=</span>&nbsp;<span class="ident" id="6334826">shoff</span>&nbsp;<span class="op" id="6334832">+</span>&nbsp;<span class="ident" id="6334834">int64</span><span class="op" id="6334839">(</span><span class="ident" id="6334840">i</span><span class="op" id="6334841">)</span><span class="op" id="6334842">*</span><span class="ident" id="6334843">int64</span><span class="op" id="6334848">(</span><span class="ident" id="6334849">shentsize</span><span class="op" id="6334858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334862">sr</span><span class="op" id="6334864">.</span><span class="ident" id="6334865">Seek</span><span class="op" id="6334869">(</span><span class="ident" id="6334870">off</span><span class="op" id="6334873">,</span>&nbsp;<span class="ident" id="6334875">os</span><span class="op" id="6334877">.</span><span class="ident" id="6334878">SEEK_SET</span><span class="op" id="6334886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334890">s</span>&nbsp;<span class="op" id="6334892">:=</span>&nbsp;<span class="builtinfunc" id="6334895">new</span><span class="op" id="6334898">(</span><span class="ident" id="6334899">Section</span><span class="op" id="6334906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334910">switch</span>&nbsp;<span class="ident" id="6334917">f</span><span class="op" id="6334918">.</span><span class="ident" id="6334919">Class</span>&nbsp;<span class="op" id="6334925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334929">case</span>&nbsp;<span class="ident" id="6334934">ELFCLASS32</span><span class="op" id="6334944">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334949">sh</span>&nbsp;<span class="op" id="6334952">:=</span>&nbsp;<span class="builtinfunc" id="6334955">new</span><span class="op" id="6334958">(</span><span class="ident" id="6334959">Section32</span><span class="op" id="6334968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334973">if</span>&nbsp;<span class="ident" id="6334976">err</span>&nbsp;<span class="op" id="6334980">:=</span>&nbsp;<span class="ident" id="6334983">binary</span><span class="op" id="6334989">.</span><span class="ident" id="6334990">Read</span><span class="op" id="6334994">(</span><span class="ident" id="6334995">sr</span><span class="op" id="6334997">,</span>&nbsp;<span class="ident" id="6334999">f</span><span class="op" id="6335000">.</span><span class="ident" id="6335001">ByteOrder</span><span class="op" id="6335010">,</span>&nbsp;<span class="ident" id="6335012">sh</span><span class="op" id="6335014">)</span><span class="op" id="6335015">;</span>&nbsp;<span class="ident" id="6335017">err</span>&nbsp;<span class="op" id="6335021">!=</span>&nbsp;<span class="ident" id="6335024">nil</span>&nbsp;<span class="op" id="6335028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335034">return</span>&nbsp;<span class="ident" id="6335041">nil</span><span class="op" id="6335044">,</span>&nbsp;<span class="ident" id="6335046">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335058">names</span><span class="op" id="6335063">[</span><span class="ident" id="6335064">i</span><span class="op" id="6335065">]</span>&nbsp;<span class="op" id="6335067">=</span>&nbsp;<span class="ident" id="6335069">sh</span><span class="op" id="6335071">.</span><span class="ident" id="6335072">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335080">s</span><span class="op" id="6335081">.</span><span class="ident" id="6335082">SectionHeader</span>&nbsp;<span class="op" id="6335096">=</span>&nbsp;<span class="ident" id="6335098">SectionHeader</span><span class="op" id="6335111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335117">Type</span><span class="op" id="6335121">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335128">SectionType</span><span class="op" id="6335139">(</span><span class="ident" id="6335140">sh</span><span class="op" id="6335142">.</span><span class="ident" id="6335143">Type</span><span class="op" id="6335147">)</span><span class="op" id="6335148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335154">Flags</span><span class="op" id="6335159">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335165">SectionFlag</span><span class="op" id="6335176">(</span><span class="ident" id="6335177">sh</span><span class="op" id="6335179">.</span><span class="ident" id="6335180">Flags</span><span class="op" id="6335185">)</span><span class="op" id="6335186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335192">Addr</span><span class="op" id="6335196">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335203">uint64</span><span class="op" id="6335209">(</span><span class="ident" id="6335210">sh</span><span class="op" id="6335212">.</span><span class="ident" id="6335213">Addr</span><span class="op" id="6335217">)</span><span class="op" id="6335218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335224">Offset</span><span class="op" id="6335230">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335235">uint64</span><span class="op" id="6335241">(</span><span class="ident" id="6335242">sh</span><span class="op" id="6335244">.</span><span class="ident" id="6335245">Off</span><span class="op" id="6335248">)</span><span class="op" id="6335249">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335255">Size</span><span class="op" id="6335259">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335266">uint64</span><span class="op" id="6335272">(</span><span class="ident" id="6335273">sh</span><span class="op" id="6335275">.</span><span class="ident" id="6335276">Size</span><span class="op" id="6335280">)</span><span class="op" id="6335281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335287">Link</span><span class="op" id="6335291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6335298">uint32</span><span class="op" id="6335304">(</span><span class="ident" id="6335305">sh</span><span class="op" id="6335307">.</span><span class="ident" id="6335308">Link</span><span class="op" id="6335312">)</span><span class="op" id="6335313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335319">Info</span><span class="op" id="6335323">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6335330">uint32</span><span class="op" id="6335336">(</span><span class="ident" id="6335337">sh</span><span class="op" id="6335339">.</span><span class="ident" id="6335340">Info</span><span class="op" id="6335344">)</span><span class="op" id="6335345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335351">Addralign</span><span class="op" id="6335360">:</span>&nbsp;<span class="ident" id="6335362">uint64</span><span class="op" id="6335368">(</span><span class="ident" id="6335369">sh</span><span class="op" id="6335371">.</span><span class="ident" id="6335372">Addralign</span><span class="op" id="6335381">)</span><span class="op" id="6335382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335388">Entsize</span><span class="op" id="6335395">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6335399">uint64</span><span class="op" id="6335405">(</span><span class="ident" id="6335406">sh</span><span class="op" id="6335408">.</span><span class="ident" id="6335409">Entsize</span><span class="op" id="6335416">)</span><span class="op" id="6335417">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335426">case</span>&nbsp;<span class="ident" id="6335431">ELFCLASS64</span><span class="op" id="6335441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335446">sh</span>&nbsp;<span class="op" id="6335449">:=</span>&nbsp;<span class="builtinfunc" id="6335452">new</span><span class="op" id="6335455">(</span><span class="ident" id="6335456">Section64</span><span class="op" id="6335465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335470">if</span>&nbsp;<span class="ident" id="6335473">err</span>&nbsp;<span class="op" id="6335477">:=</span>&nbsp;<span class="ident" id="6335480">binary</span><span class="op" id="6335486">.</span><span class="ident" id="6335487">Read</span><span class="op" id="6335491">(</span><span class="ident" id="6335492">sr</span><span class="op" id="6335494">,</span>&nbsp;<span class="ident" id="6335496">f</span><span class="op" id="6335497">.</span><span class="ident" id="6335498">ByteOrder</span><span class="op" id="6335507">,</span>&nbsp;<span class="ident" id="6335509">sh</span><span class="op" id="6335511">)</span><span class="op" id="6335512">;</span>&nbsp;<span class="ident" id="6335514">err</span>&nbsp;<span class="op" id="6335518">!=</span>&nbsp;<span class="ident" id="6335521">nil</span>&nbsp;<span class="op" id="6335525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335531">return</span>&nbsp;<span class="ident" id="6335538">nil</span><span class="op" id="6335541">,</span>&nbsp;<span class="ident" id="6335543">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335555">names</span><span class="op" id="6335560">[</span><span class="ident" id="6335561">i</span><span class="op" id="6335562">]</span>&nbsp;<span class="op" id="6335564">=</span>&nbsp;<span class="ident" id="6335566">sh</span><span class="op" id="6335568">.</span><span class="ident" id="6335569">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335577">s</span><span class="op" id="6335578">.</span><span class="ident" id="6335579">SectionHeader</span>&nbsp;<span class="op" id="6335593">=</span>&nbsp;<span class="ident" id="6335595">SectionHeader</span><span class="op" id="6335608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335614">Type</span><span class="op" id="6335618">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335625">SectionType</span><span class="op" id="6335636">(</span><span class="ident" id="6335637">sh</span><span class="op" id="6335639">.</span><span class="ident" id="6335640">Type</span><span class="op" id="6335644">)</span><span class="op" id="6335645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335651">Flags</span><span class="op" id="6335656">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335662">SectionFlag</span><span class="op" id="6335673">(</span><span class="ident" id="6335674">sh</span><span class="op" id="6335676">.</span><span class="ident" id="6335677">Flags</span><span class="op" id="6335682">)</span><span class="op" id="6335683">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335689">Offset</span><span class="op" id="6335695">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335700">uint64</span><span class="op" id="6335706">(</span><span class="ident" id="6335707">sh</span><span class="op" id="6335709">.</span><span class="ident" id="6335710">Off</span><span class="op" id="6335713">)</span><span class="op" id="6335714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335720">Size</span><span class="op" id="6335724">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335731">uint64</span><span class="op" id="6335737">(</span><span class="ident" id="6335738">sh</span><span class="op" id="6335740">.</span><span class="ident" id="6335741">Size</span><span class="op" id="6335745">)</span><span class="op" id="6335746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335752">Addr</span><span class="op" id="6335756">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6335763">uint64</span><span class="op" id="6335769">(</span><span class="ident" id="6335770">sh</span><span class="op" id="6335772">.</span><span class="ident" id="6335773">Addr</span><span class="op" id="6335777">)</span><span class="op" id="6335778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335784">Link</span><span class="op" id="6335788">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6335795">uint32</span><span class="op" id="6335801">(</span><span class="ident" id="6335802">sh</span><span class="op" id="6335804">.</span><span class="ident" id="6335805">Link</span><span class="op" id="6335809">)</span><span class="op" id="6335810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335816">Info</span><span class="op" id="6335820">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6335827">uint32</span><span class="op" id="6335833">(</span><span class="ident" id="6335834">sh</span><span class="op" id="6335836">.</span><span class="ident" id="6335837">Info</span><span class="op" id="6335841">)</span><span class="op" id="6335842">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335848">Addralign</span><span class="op" id="6335857">:</span>&nbsp;<span class="ident" id="6335859">uint64</span><span class="op" id="6335865">(</span><span class="ident" id="6335866">sh</span><span class="op" id="6335868">.</span><span class="ident" id="6335869">Addralign</span><span class="op" id="6335878">)</span><span class="op" id="6335879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335885">Entsize</span><span class="op" id="6335892">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6335896">uint64</span><span class="op" id="6335902">(</span><span class="ident" id="6335903">sh</span><span class="op" id="6335905">.</span><span class="ident" id="6335906">Entsize</span><span class="op" id="6335913">)</span><span class="op" id="6335914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335927">s</span><span class="op" id="6335928">.</span><span class="ident" id="6335929">sr</span>&nbsp;<span class="op" id="6335932">=</span>&nbsp;<span class="ident" id="6335934">io</span><span class="op" id="6335936">.</span><span class="ident" id="6335937">NewSectionReader</span><span class="op" id="6335953">(</span><span class="ident" id="6335954">r</span><span class="op" id="6335955">,</span>&nbsp;<span class="ident" id="6335957">int64</span><span class="op" id="6335962">(</span><span class="ident" id="6335963">s</span><span class="op" id="6335964">.</span><span class="ident" id="6335965">Offset</span><span class="op" id="6335971">)</span><span class="op" id="6335972">,</span>&nbsp;<span class="ident" id="6335974">int64</span><span class="op" id="6335979">(</span><span class="ident" id="6335980">s</span><span class="op" id="6335981">.</span><span class="ident" id="6335982">Size</span><span class="op" id="6335986">)</span><span class="op" id="6335987">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335991">s</span><span class="op" id="6335992">.</span><span class="ident" id="6335993">ReaderAt</span>&nbsp;<span class="op" id="6336002">=</span>&nbsp;<span class="ident" id="6336004">s</span><span class="op" id="6336005">.</span><span class="ident" id="6336006">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336011">f</span><span class="op" id="6336012">.</span><span class="ident" id="6336013">Sections</span><span class="op" id="6336021">[</span><span class="ident" id="6336022">i</span><span class="op" id="6336023">]</span>&nbsp;<span class="op" id="6336025">=</span>&nbsp;<span class="ident" id="6336027">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336034">if</span>&nbsp;<span class="builtinfunc" id="6336037">len</span><span class="op" id="6336040">(</span><span class="ident" id="6336041">f</span><span class="op" id="6336042">.</span><span class="ident" id="6336043">Sections</span><span class="op" id="6336051">)</span>&nbsp;<span class="op" id="6336053">==</span>&nbsp;<span class="num" id="6336056">0</span>&nbsp;<span class="op" id="6336058">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336062">return</span>&nbsp;<span class="ident" id="6336069">f</span><span class="op" id="6336070">,</span>&nbsp;<span class="ident" id="6336072">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6336081">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336119">shstrtab</span><span class="op" id="6336127">,</span>&nbsp;<span class="ident" id="6336129">err</span>&nbsp;<span class="op" id="6336133">:=</span>&nbsp;<span class="ident" id="6336136">f</span><span class="op" id="6336137">.</span><span class="ident" id="6336138">Sections</span><span class="op" id="6336146">[</span><span class="ident" id="6336147">shstrndx</span><span class="op" id="6336155">]</span><span class="op" id="6336156">.</span><span class="ident" id="6336157">Data</span><span class="op" id="6336161">(</span><span class="op" id="6336162">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336165">if</span>&nbsp;<span class="ident" id="6336168">err</span>&nbsp;<span class="op" id="6336172">!=</span>&nbsp;<span class="ident" id="6336175">nil</span>&nbsp;<span class="op" id="6336179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336183">return</span>&nbsp;<span class="ident" id="6336190">nil</span><span class="op" id="6336193">,</span>&nbsp;<span class="ident" id="6336195">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336203">for</span>&nbsp;<span class="ident" id="6336207">i</span><span class="op" id="6336208">,</span>&nbsp;<span class="ident" id="6336210">s</span>&nbsp;<span class="op" id="6336212">:=</span>&nbsp;<span class="keyword" id="6336215">range</span>&nbsp;<span class="ident" id="6336221">f</span><span class="op" id="6336222">.</span><span class="ident" id="6336223">Sections</span>&nbsp;<span class="op" id="6336232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336236">var</span>&nbsp;<span class="ident" id="6336240">ok</span>&nbsp;<span class="builtintype" id="6336243">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336250">s</span><span class="op" id="6336251">.</span><span class="ident" id="6336252">Name</span><span class="op" id="6336256">,</span>&nbsp;<span class="ident" id="6336258">ok</span>&nbsp;<span class="op" id="6336261">=</span>&nbsp;<span class="ident" id="6336263">getString</span><span class="op" id="6336272">(</span><span class="ident" id="6336273">shstrtab</span><span class="op" id="6336281">,</span>&nbsp;<span class="builtintype" id="6336283">int</span><span class="op" id="6336286">(</span><span class="ident" id="6336287">names</span><span class="op" id="6336292">[</span><span class="ident" id="6336293">i</span><span class="op" id="6336294">]</span><span class="op" id="6336295">)</span><span class="op" id="6336296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336300">if</span>&nbsp;<span class="op" id="6336303">!</span><span class="ident" id="6336304">ok</span>&nbsp;<span class="op" id="6336307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336312">return</span>&nbsp;<span class="ident" id="6336319">nil</span><span class="op" id="6336322">,</span>&nbsp;<span class="op" id="6336324">&amp;</span><span class="ident" id="6336325">FormatError</span><span class="op" id="6336336">{</span><span class="ident" id="6336337">shoff</span>&nbsp;<span class="op" id="6336343">+</span>&nbsp;<span class="ident" id="6336345">int64</span><span class="op" id="6336350">(</span><span class="ident" id="6336351">i</span><span class="op" id="6336352">*</span><span class="ident" id="6336353">shentsize</span><span class="op" id="6336362">)</span><span class="op" id="6336363">,</span>&nbsp;<span class="string" id="6336365">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="6336389">,</span>&nbsp;<span class="ident" id="6336391">names</span><span class="op" id="6336396">[</span><span class="ident" id="6336397">i</span><span class="op" id="6336398">]</span><span class="op" id="6336399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336406">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336410">return</span>&nbsp;<span class="ident" id="6336417">f</span><span class="op" id="6336418">,</span>&nbsp;<span class="ident" id="6336420">nil</span><br>
<span class="lineno"></span><span class="op" id="6336424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6336427">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="6336498">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6336562">func</span>&nbsp;<span class="op" id="6336567">(</span><span class="ident" id="6336568">f</span>&nbsp;<span class="op" id="6336570">*</span><span class="ident" id="6336571">File</span><span class="op" id="6336575">)</span>&nbsp;<span class="ident" id="6336577">getSymbols</span><span class="op" id="6336587">(</span><span class="ident" id="6336588">typ</span>&nbsp;<span class="ident" id="6336592">SectionType</span><span class="op" id="6336603">)</span>&nbsp;<span class="op" id="6336605">(</span><span class="op" id="6336606">[</span><span class="op" id="6336607">]</span><span class="ident" id="6336608">Symbol</span><span class="op" id="6336614">,</span>&nbsp;<span class="op" id="6336616">[</span><span class="op" id="6336617">]</span><span class="builtintype" id="6336618">byte</span><span class="op" id="6336622">,</span>&nbsp;<span class="builtintype" id="6336624">error</span><span class="op" id="6336629">)</span>&nbsp;<span class="op" id="6336631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336634">switch</span>&nbsp;<span class="ident" id="6336641">f</span><span class="op" id="6336642">.</span><span class="ident" id="6336643">Class</span>&nbsp;<span class="op" id="6336649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336652">case</span>&nbsp;<span class="ident" id="6336657">ELFCLASS64</span><span class="op" id="6336667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336671">return</span>&nbsp;<span class="ident" id="6336678">f</span><span class="op" id="6336679">.</span><span class="ident" id="6336680">getSymbols64</span><span class="op" id="6336692">(</span><span class="ident" id="6336693">typ</span><span class="op" id="6336696">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336700">case</span>&nbsp;<span class="ident" id="6336705">ELFCLASS32</span><span class="op" id="6336715">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336719">return</span>&nbsp;<span class="ident" id="6336726">f</span><span class="op" id="6336727">.</span><span class="ident" id="6336728">getSymbols32</span><span class="op" id="6336740">(</span><span class="ident" id="6336741">typ</span><span class="op" id="6336744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336751">return</span>&nbsp;<span class="ident" id="6336758">nil</span><span class="op" id="6336761">,</span>&nbsp;<span class="ident" id="6336763">nil</span><span class="op" id="6336766">,</span>&nbsp;<span class="ident" id="6336768">errors</span><span class="op" id="6336774">.</span><span class="ident" id="6336775">New</span><span class="op" id="6336778">(</span><span class="string" id="6336779">&#34;not&nbsp;implemented&#34;</span><span class="op" id="6336796">)</span><br>
<span class="lineno"></span><span class="op" id="6336798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6336801">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="6336869">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="6336913">var</span>&nbsp;<span class="ident" id="6336917">ErrNoSymbols</span>&nbsp;<span class="op" id="6336930">=</span>&nbsp;<span class="ident" id="6336932">errors</span><span class="op" id="6336938">.</span><span class="ident" id="6336939">New</span><span class="op" id="6336942">(</span><span class="string" id="6336943">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6336962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6336965">func</span>&nbsp;<span class="op" id="6336970">(</span><span class="ident" id="6336971">f</span>&nbsp;<span class="op" id="6336973">*</span><span class="ident" id="6336974">File</span><span class="op" id="6336978">)</span>&nbsp;<span class="ident" id="6336980">getSymbols32</span><span class="op" id="6336992">(</span><span class="ident" id="6336993">typ</span>&nbsp;<span class="ident" id="6336997">SectionType</span><span class="op" id="6337008">)</span>&nbsp;<span class="op" id="6337010">(</span><span class="op" id="6337011">[</span><span class="op" id="6337012">]</span><span class="ident" id="6337013">Symbol</span><span class="op" id="6337019">,</span>&nbsp;<span class="op" id="6337021">[</span><span class="op" id="6337022">]</span><span class="builtintype" id="6337023">byte</span><span class="op" id="6337027">,</span>&nbsp;<span class="builtintype" id="6337029">error</span><span class="op" id="6337034">)</span>&nbsp;<span class="op" id="6337036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337039">symtabSection</span>&nbsp;<span class="op" id="6337053">:=</span>&nbsp;<span class="ident" id="6337056">f</span><span class="op" id="6337057">.</span><span class="ident" id="6337058">SectionByType</span><span class="op" id="6337071">(</span><span class="ident" id="6337072">typ</span><span class="op" id="6337075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337078">if</span>&nbsp;<span class="ident" id="6337081">symtabSection</span>&nbsp;<span class="op" id="6337095">==</span>&nbsp;<span class="ident" id="6337098">nil</span>&nbsp;<span class="op" id="6337102">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337106">return</span>&nbsp;<span class="ident" id="6337113">nil</span><span class="op" id="6337116">,</span>&nbsp;<span class="ident" id="6337118">nil</span><span class="op" id="6337121">,</span>&nbsp;<span class="ident" id="6337123">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337141">data</span><span class="op" id="6337145">,</span>&nbsp;<span class="ident" id="6337147">err</span>&nbsp;<span class="op" id="6337151">:=</span>&nbsp;<span class="ident" id="6337154">symtabSection</span><span class="op" id="6337167">.</span><span class="ident" id="6337168">Data</span><span class="op" id="6337172">(</span><span class="op" id="6337173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337176">if</span>&nbsp;<span class="ident" id="6337179">err</span>&nbsp;<span class="op" id="6337183">!=</span>&nbsp;<span class="ident" id="6337186">nil</span>&nbsp;<span class="op" id="6337190">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337194">return</span>&nbsp;<span class="ident" id="6337201">nil</span><span class="op" id="6337204">,</span>&nbsp;<span class="ident" id="6337206">nil</span><span class="op" id="6337209">,</span>&nbsp;<span class="ident" id="6337211">errors</span><span class="op" id="6337217">.</span><span class="ident" id="6337218">New</span><span class="op" id="6337221">(</span><span class="string" id="6337222">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6337250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337256">symtab</span>&nbsp;<span class="op" id="6337263">:=</span>&nbsp;<span class="ident" id="6337266">bytes</span><span class="op" id="6337271">.</span><span class="ident" id="6337272">NewReader</span><span class="op" id="6337281">(</span><span class="ident" id="6337282">data</span><span class="op" id="6337286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337289">if</span>&nbsp;<span class="ident" id="6337292">symtab</span><span class="op" id="6337298">.</span><span class="ident" id="6337299">Len</span><span class="op" id="6337302">(</span><span class="op" id="6337303">)</span><span class="op" id="6337304">%</span><span class="ident" id="6337305">Sym32Size</span>&nbsp;<span class="op" id="6337315">!=</span>&nbsp;<span class="num" id="6337318">0</span>&nbsp;<span class="op" id="6337320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337324">return</span>&nbsp;<span class="ident" id="6337331">nil</span><span class="op" id="6337334">,</span>&nbsp;<span class="ident" id="6337336">nil</span><span class="op" id="6337339">,</span>&nbsp;<span class="ident" id="6337341">errors</span><span class="op" id="6337347">.</span><span class="ident" id="6337348">New</span><span class="op" id="6337351">(</span><span class="string" id="6337352">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="6337407">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337414">strdata</span><span class="op" id="6337421">,</span>&nbsp;<span class="ident" id="6337423">err</span>&nbsp;<span class="op" id="6337427">:=</span>&nbsp;<span class="ident" id="6337430">f</span><span class="op" id="6337431">.</span><span class="ident" id="6337432">stringTable</span><span class="op" id="6337443">(</span><span class="ident" id="6337444">symtabSection</span><span class="op" id="6337457">.</span><span class="ident" id="6337458">Link</span><span class="op" id="6337462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337465">if</span>&nbsp;<span class="ident" id="6337468">err</span>&nbsp;<span class="op" id="6337472">!=</span>&nbsp;<span class="ident" id="6337475">nil</span>&nbsp;<span class="op" id="6337479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337483">return</span>&nbsp;<span class="ident" id="6337490">nil</span><span class="op" id="6337493">,</span>&nbsp;<span class="ident" id="6337495">nil</span><span class="op" id="6337498">,</span>&nbsp;<span class="ident" id="6337500">errors</span><span class="op" id="6337506">.</span><span class="ident" id="6337507">New</span><span class="op" id="6337510">(</span><span class="string" id="6337511">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="6337545">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337552">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337586">var</span>&nbsp;<span class="ident" id="6337590">skip</span>&nbsp;<span class="op" id="6337595">[</span><span class="ident" id="6337596">Sym32Size</span><span class="op" id="6337605">]</span><span class="builtintype" id="6337606">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337612">symtab</span><span class="op" id="6337618">.</span><span class="ident" id="6337619">Read</span><span class="op" id="6337623">(</span><span class="ident" id="6337624">skip</span><span class="op" id="6337628">[</span><span class="op" id="6337629">:</span><span class="op" id="6337630">]</span><span class="op" id="6337631">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337635">symbols</span>&nbsp;<span class="op" id="6337643">:=</span>&nbsp;<span class="builtinfunc" id="6337646">make</span><span class="op" id="6337650">(</span><span class="op" id="6337651">[</span><span class="op" id="6337652">]</span><span class="ident" id="6337653">Symbol</span><span class="op" id="6337659">,</span>&nbsp;<span class="ident" id="6337661">symtab</span><span class="op" id="6337667">.</span><span class="ident" id="6337668">Len</span><span class="op" id="6337671">(</span><span class="op" id="6337672">)</span><span class="op" id="6337673">/</span><span class="ident" id="6337674">Sym32Size</span><span class="op" id="6337683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337687">i</span>&nbsp;<span class="op" id="6337689">:=</span>&nbsp;<span class="num" id="6337692">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337695">var</span>&nbsp;<span class="ident" id="6337699">sym</span>&nbsp;<span class="ident" id="6337703">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337710">for</span>&nbsp;<span class="ident" id="6337714">symtab</span><span class="op" id="6337720">.</span><span class="ident" id="6337721">Len</span><span class="op" id="6337724">(</span><span class="op" id="6337725">)</span>&nbsp;<span class="op" id="6337727">&gt;</span>&nbsp;<span class="num" id="6337729">0</span>&nbsp;<span class="op" id="6337731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337735">binary</span><span class="op" id="6337741">.</span><span class="ident" id="6337742">Read</span><span class="op" id="6337746">(</span><span class="ident" id="6337747">symtab</span><span class="op" id="6337753">,</span>&nbsp;<span class="ident" id="6337755">f</span><span class="op" id="6337756">.</span><span class="ident" id="6337757">ByteOrder</span><span class="op" id="6337766">,</span>&nbsp;<span class="op" id="6337768">&amp;</span><span class="ident" id="6337769">sym</span><span class="op" id="6337772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337776">str</span><span class="op" id="6337779">,</span>&nbsp;<span class="ident" id="6337781">_</span>&nbsp;<span class="op" id="6337783">:=</span>&nbsp;<span class="ident" id="6337786">getString</span><span class="op" id="6337795">(</span><span class="ident" id="6337796">strdata</span><span class="op" id="6337803">,</span>&nbsp;<span class="builtintype" id="6337805">int</span><span class="op" id="6337808">(</span><span class="ident" id="6337809">sym</span><span class="op" id="6337812">.</span><span class="ident" id="6337813">Name</span><span class="op" id="6337817">)</span><span class="op" id="6337818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337822">symbols</span><span class="op" id="6337829">[</span><span class="ident" id="6337830">i</span><span class="op" id="6337831">]</span><span class="op" id="6337832">.</span><span class="ident" id="6337833">Name</span>&nbsp;<span class="op" id="6337838">=</span>&nbsp;<span class="ident" id="6337840">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337846">symbols</span><span class="op" id="6337853">[</span><span class="ident" id="6337854">i</span><span class="op" id="6337855">]</span><span class="op" id="6337856">.</span><span class="ident" id="6337857">Info</span>&nbsp;<span class="op" id="6337862">=</span>&nbsp;<span class="ident" id="6337864">sym</span><span class="op" id="6337867">.</span><span class="ident" id="6337868">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337875">symbols</span><span class="op" id="6337882">[</span><span class="ident" id="6337883">i</span><span class="op" id="6337884">]</span><span class="op" id="6337885">.</span><span class="ident" id="6337886">Other</span>&nbsp;<span class="op" id="6337892">=</span>&nbsp;<span class="ident" id="6337894">sym</span><span class="op" id="6337897">.</span><span class="ident" id="6337898">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337906">symbols</span><span class="op" id="6337913">[</span><span class="ident" id="6337914">i</span><span class="op" id="6337915">]</span><span class="op" id="6337916">.</span><span class="ident" id="6337917">Section</span>&nbsp;<span class="op" id="6337925">=</span>&nbsp;<span class="ident" id="6337927">SectionIndex</span><span class="op" id="6337939">(</span><span class="ident" id="6337940">sym</span><span class="op" id="6337943">.</span><span class="ident" id="6337944">Shndx</span><span class="op" id="6337949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337953">symbols</span><span class="op" id="6337960">[</span><span class="ident" id="6337961">i</span><span class="op" id="6337962">]</span><span class="op" id="6337963">.</span><span class="ident" id="6337964">Value</span>&nbsp;<span class="op" id="6337970">=</span>&nbsp;<span class="ident" id="6337972">uint64</span><span class="op" id="6337978">(</span><span class="ident" id="6337979">sym</span><span class="op" id="6337982">.</span><span class="ident" id="6337983">Value</span><span class="op" id="6337988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337992">symbols</span><span class="op" id="6337999">[</span><span class="ident" id="6338000">i</span><span class="op" id="6338001">]</span><span class="op" id="6338002">.</span><span class="ident" id="6338003">Size</span>&nbsp;<span class="op" id="6338008">=</span>&nbsp;<span class="ident" id="6338010">uint64</span><span class="op" id="6338016">(</span><span class="ident" id="6338017">sym</span><span class="op" id="6338020">.</span><span class="ident" id="6338021">Size</span><span class="op" id="6338025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338029">i</span><span class="op" id="6338030">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338038">return</span>&nbsp;<span class="ident" id="6338045">symbols</span><span class="op" id="6338052">,</span>&nbsp;<span class="ident" id="6338054">strdata</span><span class="op" id="6338061">,</span>&nbsp;<span class="ident" id="6338063">nil</span><br>
<span class="lineno"></span><span class="op" id="6338067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="6338070">func</span>&nbsp;<span class="op" id="6338075">(</span><span class="ident" id="6338076">f</span>&nbsp;<span class="op" id="6338078">*</span><span class="ident" id="6338079">File</span><span class="op" id="6338083">)</span>&nbsp;<span class="ident" id="6338085">getSymbols64</span><span class="op" id="6338097">(</span><span class="ident" id="6338098">typ</span>&nbsp;<span class="ident" id="6338102">SectionType</span><span class="op" id="6338113">)</span>&nbsp;<span class="op" id="6338115">(</span><span class="op" id="6338116">[</span><span class="op" id="6338117">]</span><span class="ident" id="6338118">Symbol</span><span class="op" id="6338124">,</span>&nbsp;<span class="op" id="6338126">[</span><span class="op" id="6338127">]</span><span class="builtintype" id="6338128">byte</span><span class="op" id="6338132">,</span>&nbsp;<span class="builtintype" id="6338134">error</span><span class="op" id="6338139">)</span>&nbsp;<span class="op" id="6338141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338144">symtabSection</span>&nbsp;<span class="op" id="6338158">:=</span>&nbsp;<span class="ident" id="6338161">f</span><span class="op" id="6338162">.</span><span class="ident" id="6338163">SectionByType</span><span class="op" id="6338176">(</span><span class="ident" id="6338177">typ</span><span class="op" id="6338180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338183">if</span>&nbsp;<span class="ident" id="6338186">symtabSection</span>&nbsp;<span class="op" id="6338200">==</span>&nbsp;<span class="ident" id="6338203">nil</span>&nbsp;<span class="op" id="6338207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338211">return</span>&nbsp;<span class="ident" id="6338218">nil</span><span class="op" id="6338221">,</span>&nbsp;<span class="ident" id="6338223">nil</span><span class="op" id="6338226">,</span>&nbsp;<span class="ident" id="6338228">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338242">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338246">data</span><span class="op" id="6338250">,</span>&nbsp;<span class="ident" id="6338252">err</span>&nbsp;<span class="op" id="6338256">:=</span>&nbsp;<span class="ident" id="6338259">symtabSection</span><span class="op" id="6338272">.</span><span class="ident" id="6338273">Data</span><span class="op" id="6338277">(</span><span class="op" id="6338278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338281">if</span>&nbsp;<span class="ident" id="6338284">err</span>&nbsp;<span class="op" id="6338288">!=</span>&nbsp;<span class="ident" id="6338291">nil</span>&nbsp;<span class="op" id="6338295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338299">return</span>&nbsp;<span class="ident" id="6338306">nil</span><span class="op" id="6338309">,</span>&nbsp;<span class="ident" id="6338311">nil</span><span class="op" id="6338314">,</span>&nbsp;<span class="ident" id="6338316">errors</span><span class="op" id="6338322">.</span><span class="ident" id="6338323">New</span><span class="op" id="6338326">(</span><span class="string" id="6338327">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6338355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338358">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338361">symtab</span>&nbsp;<span class="op" id="6338368">:=</span>&nbsp;<span class="ident" id="6338371">bytes</span><span class="op" id="6338376">.</span><span class="ident" id="6338377">NewReader</span><span class="op" id="6338386">(</span><span class="ident" id="6338387">data</span><span class="op" id="6338391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338394">if</span>&nbsp;<span class="ident" id="6338397">symtab</span><span class="op" id="6338403">.</span><span class="ident" id="6338404">Len</span><span class="op" id="6338407">(</span><span class="op" id="6338408">)</span><span class="op" id="6338409">%</span><span class="ident" id="6338410">Sym64Size</span>&nbsp;<span class="op" id="6338420">!=</span>&nbsp;<span class="num" id="6338423">0</span>&nbsp;<span class="op" id="6338425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338429">return</span>&nbsp;<span class="ident" id="6338436">nil</span><span class="op" id="6338439">,</span>&nbsp;<span class="ident" id="6338441">nil</span><span class="op" id="6338444">,</span>&nbsp;<span class="ident" id="6338446">errors</span><span class="op" id="6338452">.</span><span class="ident" id="6338453">New</span><span class="op" id="6338456">(</span><span class="string" id="6338457">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="6338514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338521">strdata</span><span class="op" id="6338528">,</span>&nbsp;<span class="ident" id="6338530">err</span>&nbsp;<span class="op" id="6338534">:=</span>&nbsp;<span class="ident" id="6338537">f</span><span class="op" id="6338538">.</span><span class="ident" id="6338539">stringTable</span><span class="op" id="6338550">(</span><span class="ident" id="6338551">symtabSection</span><span class="op" id="6338564">.</span><span class="ident" id="6338565">Link</span><span class="op" id="6338569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338572">if</span>&nbsp;<span class="ident" id="6338575">err</span>&nbsp;<span class="op" id="6338579">!=</span>&nbsp;<span class="ident" id="6338582">nil</span>&nbsp;<span class="op" id="6338586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338590">return</span>&nbsp;<span class="ident" id="6338597">nil</span><span class="op" id="6338600">,</span>&nbsp;<span class="ident" id="6338602">nil</span><span class="op" id="6338605">,</span>&nbsp;<span class="ident" id="6338607">errors</span><span class="op" id="6338613">.</span><span class="ident" id="6338614">New</span><span class="op" id="6338617">(</span><span class="string" id="6338618">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="6338652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6338659">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338693">var</span>&nbsp;<span class="ident" id="6338697">skip</span>&nbsp;<span class="op" id="6338702">[</span><span class="ident" id="6338703">Sym64Size</span><span class="op" id="6338712">]</span><span class="builtintype" id="6338713">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338719">symtab</span><span class="op" id="6338725">.</span><span class="ident" id="6338726">Read</span><span class="op" id="6338730">(</span><span class="ident" id="6338731">skip</span><span class="op" id="6338735">[</span><span class="op" id="6338736">:</span><span class="op" id="6338737">]</span><span class="op" id="6338738">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338742">symbols</span>&nbsp;<span class="op" id="6338750">:=</span>&nbsp;<span class="builtinfunc" id="6338753">make</span><span class="op" id="6338757">(</span><span class="op" id="6338758">[</span><span class="op" id="6338759">]</span><span class="ident" id="6338760">Symbol</span><span class="op" id="6338766">,</span>&nbsp;<span class="ident" id="6338768">symtab</span><span class="op" id="6338774">.</span><span class="ident" id="6338775">Len</span><span class="op" id="6338778">(</span><span class="op" id="6338779">)</span><span class="op" id="6338780">/</span><span class="ident" id="6338781">Sym64Size</span><span class="op" id="6338790">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338794">i</span>&nbsp;<span class="op" id="6338796">:=</span>&nbsp;<span class="num" id="6338799">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338802">var</span>&nbsp;<span class="ident" id="6338806">sym</span>&nbsp;<span class="ident" id="6338810">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338817">for</span>&nbsp;<span class="ident" id="6338821">symtab</span><span class="op" id="6338827">.</span><span class="ident" id="6338828">Len</span><span class="op" id="6338831">(</span><span class="op" id="6338832">)</span>&nbsp;<span class="op" id="6338834">&gt;</span>&nbsp;<span class="num" id="6338836">0</span>&nbsp;<span class="op" id="6338838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338842">binary</span><span class="op" id="6338848">.</span><span class="ident" id="6338849">Read</span><span class="op" id="6338853">(</span><span class="ident" id="6338854">symtab</span><span class="op" id="6338860">,</span>&nbsp;<span class="ident" id="6338862">f</span><span class="op" id="6338863">.</span><span class="ident" id="6338864">ByteOrder</span><span class="op" id="6338873">,</span>&nbsp;<span class="op" id="6338875">&amp;</span><span class="ident" id="6338876">sym</span><span class="op" id="6338879">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338883">str</span><span class="op" id="6338886">,</span>&nbsp;<span class="ident" id="6338888">_</span>&nbsp;<span class="op" id="6338890">:=</span>&nbsp;<span class="ident" id="6338893">getString</span><span class="op" id="6338902">(</span><span class="ident" id="6338903">strdata</span><span class="op" id="6338910">,</span>&nbsp;<span class="builtintype" id="6338912">int</span><span class="op" id="6338915">(</span><span class="ident" id="6338916">sym</span><span class="op" id="6338919">.</span><span class="ident" id="6338920">Name</span><span class="op" id="6338924">)</span><span class="op" id="6338925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338929">symbols</span><span class="op" id="6338936">[</span><span class="ident" id="6338937">i</span><span class="op" id="6338938">]</span><span class="op" id="6338939">.</span><span class="ident" id="6338940">Name</span>&nbsp;<span class="op" id="6338945">=</span>&nbsp;<span class="ident" id="6338947">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338953">symbols</span><span class="op" id="6338960">[</span><span class="ident" id="6338961">i</span><span class="op" id="6338962">]</span><span class="op" id="6338963">.</span><span class="ident" id="6338964">Info</span>&nbsp;<span class="op" id="6338969">=</span>&nbsp;<span class="ident" id="6338971">sym</span><span class="op" id="6338974">.</span><span class="ident" id="6338975">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338982">symbols</span><span class="op" id="6338989">[</span><span class="ident" id="6338990">i</span><span class="op" id="6338991">]</span><span class="op" id="6338992">.</span><span class="ident" id="6338993">Other</span>&nbsp;<span class="op" id="6338999">=</span>&nbsp;<span class="ident" id="6339001">sym</span><span class="op" id="6339004">.</span><span class="ident" id="6339005">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339013">symbols</span><span class="op" id="6339020">[</span><span class="ident" id="6339021">i</span><span class="op" id="6339022">]</span><span class="op" id="6339023">.</span><span class="ident" id="6339024">Section</span>&nbsp;<span class="op" id="6339032">=</span>&nbsp;<span class="ident" id="6339034">SectionIndex</span><span class="op" id="6339046">(</span><span class="ident" id="6339047">sym</span><span class="op" id="6339050">.</span><span class="ident" id="6339051">Shndx</span><span class="op" id="6339056">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339060">symbols</span><span class="op" id="6339067">[</span><span class="ident" id="6339068">i</span><span class="op" id="6339069">]</span><span class="op" id="6339070">.</span><span class="ident" id="6339071">Value</span>&nbsp;<span class="op" id="6339077">=</span>&nbsp;<span class="ident" id="6339079">sym</span><span class="op" id="6339082">.</span><span class="ident" id="6339083">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339091">symbols</span><span class="op" id="6339098">[</span><span class="ident" id="6339099">i</span><span class="op" id="6339100">]</span><span class="op" id="6339101">.</span><span class="ident" id="6339102">Size</span>&nbsp;<span class="op" id="6339107">=</span>&nbsp;<span class="ident" id="6339109">sym</span><span class="op" id="6339112">.</span><span class="ident" id="6339113">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339120">i</span><span class="op" id="6339121">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339129">return</span>&nbsp;<span class="ident" id="6339136">symbols</span><span class="op" id="6339143">,</span>&nbsp;<span class="ident" id="6339145">strdata</span><span class="op" id="6339152">,</span>&nbsp;<span class="ident" id="6339154">nil</span><br>
<span class="lineno"></span><span class="op" id="6339158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6339161">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6339218">func</span>&nbsp;<span class="ident" id="6339223">getString</span><span class="op" id="6339232">(</span><span class="ident" id="6339233">section</span>&nbsp;<span class="op" id="6339241">[</span><span class="op" id="6339242">]</span><span class="builtintype" id="6339243">byte</span><span class="op" id="6339247">,</span>&nbsp;<span class="ident" id="6339249">start</span>&nbsp;<span class="builtintype" id="6339255">int</span><span class="op" id="6339258">)</span>&nbsp;<span class="op" id="6339260">(</span><span class="builtintype" id="6339261">string</span><span class="op" id="6339267">,</span>&nbsp;<span class="builtintype" id="6339269">bool</span><span class="op" id="6339273">)</span>&nbsp;<span class="op" id="6339275">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339278">if</span>&nbsp;<span class="ident" id="6339281">start</span>&nbsp;<span class="op" id="6339287">&lt;</span>&nbsp;<span class="num" id="6339289">0</span>&nbsp;<span class="op" id="6339291">||</span>&nbsp;<span class="ident" id="6339294">start</span>&nbsp;<span class="op" id="6339300">&gt;=</span>&nbsp;<span class="builtinfunc" id="6339303">len</span><span class="op" id="6339306">(</span><span class="ident" id="6339307">section</span><span class="op" id="6339314">)</span>&nbsp;<span class="op" id="6339316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339320">return</span>&nbsp;<span class="string" id="6339327">&#34;&#34;</span><span class="op" id="6339329">,</span>&nbsp;<span class="builtintype" id="6339331">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339342">for</span>&nbsp;<span class="ident" id="6339346">end</span>&nbsp;<span class="op" id="6339350">:=</span>&nbsp;<span class="ident" id="6339353">start</span><span class="op" id="6339358">;</span>&nbsp;<span class="ident" id="6339360">end</span>&nbsp;<span class="op" id="6339364">&lt;</span>&nbsp;<span class="builtinfunc" id="6339366">len</span><span class="op" id="6339369">(</span><span class="ident" id="6339370">section</span><span class="op" id="6339377">)</span><span class="op" id="6339378">;</span>&nbsp;<span class="ident" id="6339380">end</span><span class="op" id="6339383">++</span>&nbsp;<span class="op" id="6339386">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339390">if</span>&nbsp;<span class="ident" id="6339393">section</span><span class="op" id="6339400">[</span><span class="ident" id="6339401">end</span><span class="op" id="6339404">]</span>&nbsp;<span class="op" id="6339406">==</span>&nbsp;<span class="num" id="6339409">0</span>&nbsp;<span class="op" id="6339411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339416">return</span>&nbsp;<span class="builtintype" id="6339423">string</span><span class="op" id="6339429">(</span><span class="ident" id="6339430">section</span><span class="op" id="6339437">[</span><span class="ident" id="6339438">start</span><span class="op" id="6339443">:</span><span class="ident" id="6339444">end</span><span class="op" id="6339447">]</span><span class="op" id="6339448">)</span><span class="op" id="6339449">,</span>&nbsp;<span class="builtintype" id="6339451">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339464">return</span>&nbsp;<span class="string" id="6339471">&#34;&#34;</span><span class="op" id="6339473">,</span>&nbsp;<span class="builtintype" id="6339475">false</span><br>
<span class="lineno">510</span><span class="op" id="6339481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6339484">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6339552">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6339571">func</span>&nbsp;<span class="op" id="6339576">(</span><span class="ident" id="6339577">f</span>&nbsp;<span class="op" id="6339579">*</span><span class="ident" id="6339580">File</span><span class="op" id="6339584">)</span>&nbsp;<span class="ident" id="6339586">Section</span><span class="op" id="6339593">(</span><span class="ident" id="6339594">name</span>&nbsp;<span class="builtintype" id="6339599">string</span><span class="op" id="6339605">)</span>&nbsp;<span class="op" id="6339607">*</span><span class="ident" id="6339608">Section</span>&nbsp;<span class="op" id="6339616">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339619">for</span>&nbsp;<span class="ident" id="6339623">_</span><span class="op" id="6339624">,</span>&nbsp;<span class="ident" id="6339626">s</span>&nbsp;<span class="op" id="6339628">:=</span>&nbsp;<span class="keyword" id="6339631">range</span>&nbsp;<span class="ident" id="6339637">f</span><span class="op" id="6339638">.</span><span class="ident" id="6339639">Sections</span>&nbsp;<span class="op" id="6339648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339652">if</span>&nbsp;<span class="ident" id="6339655">s</span><span class="op" id="6339656">.</span><span class="ident" id="6339657">Name</span>&nbsp;<span class="op" id="6339662">==</span>&nbsp;<span class="ident" id="6339665">name</span>&nbsp;<span class="op" id="6339670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339675">return</span>&nbsp;<span class="ident" id="6339682">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339689">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339692">return</span>&nbsp;<span class="ident" id="6339699">nil</span><br>
<span class="lineno"></span><span class="op" id="6339703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6339706">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="6339784">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="6339803">func</span>&nbsp;<span class="op" id="6339808">(</span><span class="ident" id="6339809">f</span>&nbsp;<span class="op" id="6339811">*</span><span class="ident" id="6339812">File</span><span class="op" id="6339816">)</span>&nbsp;<span class="ident" id="6339818">applyRelocations</span><span class="op" id="6339834">(</span><span class="ident" id="6339835">dst</span>&nbsp;<span class="op" id="6339839">[</span><span class="op" id="6339840">]</span><span class="builtintype" id="6339841">byte</span><span class="op" id="6339845">,</span>&nbsp;<span class="ident" id="6339847">rels</span>&nbsp;<span class="op" id="6339852">[</span><span class="op" id="6339853">]</span><span class="builtintype" id="6339854">byte</span><span class="op" id="6339858">)</span>&nbsp;<span class="builtintype" id="6339860">error</span>&nbsp;<span class="op" id="6339866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339869">if</span>&nbsp;<span class="ident" id="6339872">f</span><span class="op" id="6339873">.</span><span class="ident" id="6339874">Class</span>&nbsp;<span class="op" id="6339880">==</span>&nbsp;<span class="ident" id="6339883">ELFCLASS64</span>&nbsp;<span class="op" id="6339894">&amp;&amp;</span>&nbsp;<span class="ident" id="6339897">f</span><span class="op" id="6339898">.</span><span class="ident" id="6339899">Machine</span>&nbsp;<span class="op" id="6339907">==</span>&nbsp;<span class="ident" id="6339910">EM_X86_64</span>&nbsp;<span class="op" id="6339920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339924">return</span>&nbsp;<span class="ident" id="6339931">f</span><span class="op" id="6339932">.</span><span class="ident" id="6339933">applyRelocationsAMD64</span><span class="op" id="6339954">(</span><span class="ident" id="6339955">dst</span><span class="op" id="6339958">,</span>&nbsp;<span class="ident" id="6339960">rels</span><span class="op" id="6339964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339970">if</span>&nbsp;<span class="ident" id="6339973">f</span><span class="op" id="6339974">.</span><span class="ident" id="6339975">Class</span>&nbsp;<span class="op" id="6339981">==</span>&nbsp;<span class="ident" id="6339984">ELFCLASS32</span>&nbsp;<span class="op" id="6339995">&amp;&amp;</span>&nbsp;<span class="ident" id="6339998">f</span><span class="op" id="6339999">.</span><span class="ident" id="6340000">Machine</span>&nbsp;<span class="op" id="6340008">==</span>&nbsp;<span class="ident" id="6340011">EM_386</span>&nbsp;<span class="op" id="6340018">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340022">return</span>&nbsp;<span class="ident" id="6340029">f</span><span class="op" id="6340030">.</span><span class="ident" id="6340031">applyRelocations386</span><span class="op" id="6340050">(</span><span class="ident" id="6340051">dst</span><span class="op" id="6340054">,</span>&nbsp;<span class="ident" id="6340056">rels</span><span class="op" id="6340060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340066">if</span>&nbsp;<span class="ident" id="6340069">f</span><span class="op" id="6340070">.</span><span class="ident" id="6340071">Class</span>&nbsp;<span class="op" id="6340077">==</span>&nbsp;<span class="ident" id="6340080">ELFCLASS64</span>&nbsp;<span class="op" id="6340091">&amp;&amp;</span>&nbsp;<span class="ident" id="6340094">f</span><span class="op" id="6340095">.</span><span class="ident" id="6340096">Machine</span>&nbsp;<span class="op" id="6340104">==</span>&nbsp;<span class="ident" id="6340107">EM_AARCH64</span>&nbsp;<span class="op" id="6340118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340122">return</span>&nbsp;<span class="ident" id="6340129">f</span><span class="op" id="6340130">.</span><span class="ident" id="6340131">applyRelocationsARM64</span><span class="op" id="6340152">(</span><span class="ident" id="6340153">dst</span><span class="op" id="6340156">,</span>&nbsp;<span class="ident" id="6340158">rels</span><span class="op" id="6340162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340165">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340169">return</span>&nbsp;<span class="ident" id="6340176">errors</span><span class="op" id="6340182">.</span><span class="ident" id="6340183">New</span><span class="op" id="6340186">(</span><span class="string" id="6340187">&#34;not&nbsp;implemented&#34;</span><span class="op" id="6340204">)</span><br>
<span class="lineno"></span><span class="op" id="6340206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6340209">func</span>&nbsp;<span class="op" id="6340214">(</span><span class="ident" id="6340215">f</span>&nbsp;<span class="op" id="6340217">*</span><span class="ident" id="6340218">File</span><span class="op" id="6340222">)</span>&nbsp;<span class="ident" id="6340224">applyRelocationsAMD64</span><span class="op" id="6340245">(</span><span class="ident" id="6340246">dst</span>&nbsp;<span class="op" id="6340250">[</span><span class="op" id="6340251">]</span><span class="builtintype" id="6340252">byte</span><span class="op" id="6340256">,</span>&nbsp;<span class="ident" id="6340258">rels</span>&nbsp;<span class="op" id="6340263">[</span><span class="op" id="6340264">]</span><span class="builtintype" id="6340265">byte</span><span class="op" id="6340269">)</span>&nbsp;<span class="builtintype" id="6340271">error</span>&nbsp;<span class="op" id="6340277">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6340280">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340310">if</span>&nbsp;<span class="builtinfunc" id="6340313">len</span><span class="op" id="6340316">(</span><span class="ident" id="6340317">rels</span><span class="op" id="6340321">)</span><span class="op" id="6340322">%</span><span class="num" id="6340323">24</span>&nbsp;<span class="op" id="6340326">!=</span>&nbsp;<span class="num" id="6340329">0</span>&nbsp;<span class="op" id="6340331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340335">return</span>&nbsp;<span class="ident" id="6340342">errors</span><span class="op" id="6340348">.</span><span class="ident" id="6340349">New</span><span class="op" id="6340352">(</span><span class="string" id="6340353">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="6340407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340414">symbols</span><span class="op" id="6340421">,</span>&nbsp;<span class="ident" id="6340423">_</span><span class="op" id="6340424">,</span>&nbsp;<span class="ident" id="6340426">err</span>&nbsp;<span class="op" id="6340430">:=</span>&nbsp;<span class="ident" id="6340433">f</span><span class="op" id="6340434">.</span><span class="ident" id="6340435">getSymbols</span><span class="op" id="6340445">(</span><span class="ident" id="6340446">SHT_SYMTAB</span><span class="op" id="6340456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340459">if</span>&nbsp;<span class="ident" id="6340462">err</span>&nbsp;<span class="op" id="6340466">!=</span>&nbsp;<span class="ident" id="6340469">nil</span>&nbsp;<span class="op" id="6340473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340477">return</span>&nbsp;<span class="ident" id="6340484">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340493">b</span>&nbsp;<span class="op" id="6340495">:=</span>&nbsp;<span class="ident" id="6340498">bytes</span><span class="op" id="6340503">.</span><span class="ident" id="6340504">NewReader</span><span class="op" id="6340513">(</span><span class="ident" id="6340514">rels</span><span class="op" id="6340518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340521">var</span>&nbsp;<span class="ident" id="6340525">rela</span>&nbsp;<span class="ident" id="6340530">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340539">for</span>&nbsp;<span class="ident" id="6340543">b</span><span class="op" id="6340544">.</span><span class="ident" id="6340545">Len</span><span class="op" id="6340548">(</span><span class="op" id="6340549">)</span>&nbsp;<span class="op" id="6340551">&gt;</span>&nbsp;<span class="num" id="6340553">0</span>&nbsp;<span class="op" id="6340555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340559">binary</span><span class="op" id="6340565">.</span><span class="ident" id="6340566">Read</span><span class="op" id="6340570">(</span><span class="ident" id="6340571">b</span><span class="op" id="6340572">,</span>&nbsp;<span class="ident" id="6340574">f</span><span class="op" id="6340575">.</span><span class="ident" id="6340576">ByteOrder</span><span class="op" id="6340585">,</span>&nbsp;<span class="op" id="6340587">&amp;</span><span class="ident" id="6340588">rela</span><span class="op" id="6340592">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340596">symNo</span>&nbsp;<span class="op" id="6340602">:=</span>&nbsp;<span class="ident" id="6340605">rela</span><span class="op" id="6340609">.</span><span class="ident" id="6340610">Info</span>&nbsp;<span class="op" id="6340615">&gt;&gt;</span>&nbsp;<span class="num" id="6340618">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340623">t</span>&nbsp;<span class="op" id="6340625">:=</span>&nbsp;<span class="ident" id="6340628">R_X86_64</span><span class="op" id="6340636">(</span><span class="ident" id="6340637">rela</span><span class="op" id="6340641">.</span><span class="ident" id="6340642">Info</span>&nbsp;<span class="op" id="6340647">&amp;</span>&nbsp;<span class="num" id="6340649">0xffff</span><span class="op" id="6340655">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340660">if</span>&nbsp;<span class="ident" id="6340663">symNo</span>&nbsp;<span class="op" id="6340669">==</span>&nbsp;<span class="num" id="6340672">0</span>&nbsp;<span class="op" id="6340674">||</span>&nbsp;<span class="ident" id="6340677">symNo</span>&nbsp;<span class="op" id="6340683">&gt;</span>&nbsp;<span class="ident" id="6340685">uint64</span><span class="op" id="6340691">(</span><span class="builtinfunc" id="6340692">len</span><span class="op" id="6340695">(</span><span class="ident" id="6340696">symbols</span><span class="op" id="6340703">)</span><span class="op" id="6340704">)</span>&nbsp;<span class="op" id="6340706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340711">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340726">sym</span>&nbsp;<span class="op" id="6340730">:=</span>&nbsp;<span class="op" id="6340733">&amp;</span><span class="ident" id="6340734">symbols</span><span class="op" id="6340741">[</span><span class="ident" id="6340742">symNo</span><span class="op" id="6340747">-</span><span class="num" id="6340748">1</span><span class="op" id="6340749">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340753">if</span>&nbsp;<span class="ident" id="6340756">SymType</span><span class="op" id="6340763">(</span><span class="ident" id="6340764">sym</span><span class="op" id="6340767">.</span><span class="ident" id="6340768">Info</span><span class="op" id="6340772">&amp;</span><span class="num" id="6340773">0xf</span><span class="op" id="6340776">)</span>&nbsp;<span class="op" id="6340778">!=</span>&nbsp;<span class="ident" id="6340781">STT_SECTION</span>&nbsp;<span class="op" id="6340793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6340798">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340853">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6340869">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6340922">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6340977">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341024">switch</span>&nbsp;<span class="ident" id="6341031">t</span>&nbsp;<span class="op" id="6341033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341037">case</span>&nbsp;<span class="ident" id="6341042">R_X86_64_64</span><span class="op" id="6341053">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341058">if</span>&nbsp;<span class="ident" id="6341061">rela</span><span class="op" id="6341065">.</span><span class="ident" id="6341066">Off</span><span class="op" id="6341069">+</span><span class="num" id="6341070">8</span>&nbsp;<span class="op" id="6341072">&gt;=</span>&nbsp;<span class="ident" id="6341075">uint64</span><span class="op" id="6341081">(</span><span class="builtinfunc" id="6341082">len</span><span class="op" id="6341085">(</span><span class="ident" id="6341086">dst</span><span class="op" id="6341089">)</span><span class="op" id="6341090">)</span>&nbsp;<span class="op" id="6341092">||</span>&nbsp;<span class="ident" id="6341095">rela</span><span class="op" id="6341099">.</span><span class="ident" id="6341100">Addend</span>&nbsp;<span class="op" id="6341107">&lt;</span>&nbsp;<span class="num" id="6341109">0</span>&nbsp;<span class="op" id="6341111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341117">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341134">f</span><span class="op" id="6341135">.</span><span class="ident" id="6341136">ByteOrder</span><span class="op" id="6341145">.</span><span class="ident" id="6341146">PutUint64</span><span class="op" id="6341155">(</span><span class="ident" id="6341156">dst</span><span class="op" id="6341159">[</span><span class="ident" id="6341160">rela</span><span class="op" id="6341164">.</span><span class="ident" id="6341165">Off</span><span class="op" id="6341168">:</span><span class="ident" id="6341169">rela</span><span class="op" id="6341173">.</span><span class="ident" id="6341174">Off</span><span class="op" id="6341177">+</span><span class="num" id="6341178">8</span><span class="op" id="6341179">]</span><span class="op" id="6341180">,</span>&nbsp;<span class="ident" id="6341182">uint64</span><span class="op" id="6341188">(</span><span class="ident" id="6341189">rela</span><span class="op" id="6341193">.</span><span class="ident" id="6341194">Addend</span><span class="op" id="6341200">)</span><span class="op" id="6341201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341205">case</span>&nbsp;<span class="ident" id="6341210">R_X86_64_32</span><span class="op" id="6341221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341226">if</span>&nbsp;<span class="ident" id="6341229">rela</span><span class="op" id="6341233">.</span><span class="ident" id="6341234">Off</span><span class="op" id="6341237">+</span><span class="num" id="6341238">4</span>&nbsp;<span class="op" id="6341240">&gt;=</span>&nbsp;<span class="ident" id="6341243">uint64</span><span class="op" id="6341249">(</span><span class="builtinfunc" id="6341250">len</span><span class="op" id="6341253">(</span><span class="ident" id="6341254">dst</span><span class="op" id="6341257">)</span><span class="op" id="6341258">)</span>&nbsp;<span class="op" id="6341260">||</span>&nbsp;<span class="ident" id="6341263">rela</span><span class="op" id="6341267">.</span><span class="ident" id="6341268">Addend</span>&nbsp;<span class="op" id="6341275">&lt;</span>&nbsp;<span class="num" id="6341277">0</span>&nbsp;<span class="op" id="6341279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341285">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341302">f</span><span class="op" id="6341303">.</span><span class="ident" id="6341304">ByteOrder</span><span class="op" id="6341313">.</span><span class="ident" id="6341314">PutUint32</span><span class="op" id="6341323">(</span><span class="ident" id="6341324">dst</span><span class="op" id="6341327">[</span><span class="ident" id="6341328">rela</span><span class="op" id="6341332">.</span><span class="ident" id="6341333">Off</span><span class="op" id="6341336">:</span><span class="ident" id="6341337">rela</span><span class="op" id="6341341">.</span><span class="ident" id="6341342">Off</span><span class="op" id="6341345">+</span><span class="num" id="6341346">4</span><span class="op" id="6341347">]</span><span class="op" id="6341348">,</span>&nbsp;<span class="builtintype" id="6341350">uint32</span><span class="op" id="6341356">(</span><span class="ident" id="6341357">rela</span><span class="op" id="6341361">.</span><span class="ident" id="6341362">Addend</span><span class="op" id="6341368">)</span><span class="op" id="6341369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341380">return</span>&nbsp;<span class="ident" id="6341387">nil</span><br>
<span class="lineno"></span><span class="op" id="6341391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6341394">func</span>&nbsp;<span class="op" id="6341399">(</span><span class="ident" id="6341400">f</span>&nbsp;<span class="op" id="6341402">*</span><span class="ident" id="6341403">File</span><span class="op" id="6341407">)</span>&nbsp;<span class="ident" id="6341409">applyRelocations386</span><span class="op" id="6341428">(</span><span class="ident" id="6341429">dst</span>&nbsp;<span class="op" id="6341433">[</span><span class="op" id="6341434">]</span><span class="builtintype" id="6341435">byte</span><span class="op" id="6341439">,</span>&nbsp;<span class="ident" id="6341441">rels</span>&nbsp;<span class="op" id="6341446">[</span><span class="op" id="6341447">]</span><span class="builtintype" id="6341448">byte</span><span class="op" id="6341452">)</span>&nbsp;<span class="builtintype" id="6341454">error</span>&nbsp;<span class="op" id="6341460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6341463">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341491">if</span>&nbsp;<span class="builtinfunc" id="6341494">len</span><span class="op" id="6341497">(</span><span class="ident" id="6341498">rels</span><span class="op" id="6341502">)</span><span class="op" id="6341503">%</span><span class="num" id="6341504">8</span>&nbsp;<span class="op" id="6341506">!=</span>&nbsp;<span class="num" id="6341509">0</span>&nbsp;<span class="op" id="6341511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341515">return</span>&nbsp;<span class="ident" id="6341522">errors</span><span class="op" id="6341528">.</span><span class="ident" id="6341529">New</span><span class="op" id="6341532">(</span><span class="string" id="6341533">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="6341586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341593">symbols</span><span class="op" id="6341600">,</span>&nbsp;<span class="ident" id="6341602">_</span><span class="op" id="6341603">,</span>&nbsp;<span class="ident" id="6341605">err</span>&nbsp;<span class="op" id="6341609">:=</span>&nbsp;<span class="ident" id="6341612">f</span><span class="op" id="6341613">.</span><span class="ident" id="6341614">getSymbols</span><span class="op" id="6341624">(</span><span class="ident" id="6341625">SHT_SYMTAB</span><span class="op" id="6341635">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341638">if</span>&nbsp;<span class="ident" id="6341641">err</span>&nbsp;<span class="op" id="6341645">!=</span>&nbsp;<span class="ident" id="6341648">nil</span>&nbsp;<span class="op" id="6341652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341656">return</span>&nbsp;<span class="ident" id="6341663">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341672">b</span>&nbsp;<span class="op" id="6341674">:=</span>&nbsp;<span class="ident" id="6341677">bytes</span><span class="op" id="6341682">.</span><span class="ident" id="6341683">NewReader</span><span class="op" id="6341692">(</span><span class="ident" id="6341693">rels</span><span class="op" id="6341697">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341700">var</span>&nbsp;<span class="ident" id="6341704">rel</span>&nbsp;<span class="ident" id="6341708">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341716">for</span>&nbsp;<span class="ident" id="6341720">b</span><span class="op" id="6341721">.</span><span class="ident" id="6341722">Len</span><span class="op" id="6341725">(</span><span class="op" id="6341726">)</span>&nbsp;<span class="op" id="6341728">&gt;</span>&nbsp;<span class="num" id="6341730">0</span>&nbsp;<span class="op" id="6341732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341736">binary</span><span class="op" id="6341742">.</span><span class="ident" id="6341743">Read</span><span class="op" id="6341747">(</span><span class="ident" id="6341748">b</span><span class="op" id="6341749">,</span>&nbsp;<span class="ident" id="6341751">f</span><span class="op" id="6341752">.</span><span class="ident" id="6341753">ByteOrder</span><span class="op" id="6341762">,</span>&nbsp;<span class="op" id="6341764">&amp;</span><span class="ident" id="6341765">rel</span><span class="op" id="6341768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341772">symNo</span>&nbsp;<span class="op" id="6341778">:=</span>&nbsp;<span class="ident" id="6341781">rel</span><span class="op" id="6341784">.</span><span class="ident" id="6341785">Info</span>&nbsp;<span class="op" id="6341790">&gt;&gt;</span>&nbsp;<span class="num" id="6341793">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341797">t</span>&nbsp;<span class="op" id="6341799">:=</span>&nbsp;<span class="ident" id="6341802">R_386</span><span class="op" id="6341807">(</span><span class="ident" id="6341808">rel</span><span class="op" id="6341811">.</span><span class="ident" id="6341812">Info</span>&nbsp;<span class="op" id="6341817">&amp;</span>&nbsp;<span class="num" id="6341819">0xff</span><span class="op" id="6341823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341828">if</span>&nbsp;<span class="ident" id="6341831">symNo</span>&nbsp;<span class="op" id="6341837">==</span>&nbsp;<span class="num" id="6341840">0</span>&nbsp;<span class="op" id="6341842">||</span>&nbsp;<span class="ident" id="6341845">symNo</span>&nbsp;<span class="op" id="6341851">&gt;</span>&nbsp;<span class="builtintype" id="6341853">uint32</span><span class="op" id="6341859">(</span><span class="builtinfunc" id="6341860">len</span><span class="op" id="6341863">(</span><span class="ident" id="6341864">symbols</span><span class="op" id="6341871">)</span><span class="op" id="6341872">)</span>&nbsp;<span class="op" id="6341874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341879">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341890">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341894">sym</span>&nbsp;<span class="op" id="6341898">:=</span>&nbsp;<span class="op" id="6341901">&amp;</span><span class="ident" id="6341902">symbols</span><span class="op" id="6341909">[</span><span class="ident" id="6341910">symNo</span><span class="op" id="6341915">-</span><span class="num" id="6341916">1</span><span class="op" id="6341917">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341922">if</span>&nbsp;<span class="ident" id="6341925">t</span>&nbsp;<span class="op" id="6341927">==</span>&nbsp;<span class="ident" id="6341930">R_386_32</span>&nbsp;<span class="op" id="6341939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341944">if</span>&nbsp;<span class="ident" id="6341947">rel</span><span class="op" id="6341950">.</span><span class="ident" id="6341951">Off</span><span class="op" id="6341954">+</span><span class="num" id="6341955">4</span>&nbsp;<span class="op" id="6341957">&gt;=</span>&nbsp;<span class="builtintype" id="6341960">uint32</span><span class="op" id="6341966">(</span><span class="builtinfunc" id="6341967">len</span><span class="op" id="6341970">(</span><span class="ident" id="6341971">dst</span><span class="op" id="6341974">)</span><span class="op" id="6341975">)</span>&nbsp;<span class="op" id="6341977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341983">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342000">val</span>&nbsp;<span class="op" id="6342004">:=</span>&nbsp;<span class="ident" id="6342007">f</span><span class="op" id="6342008">.</span><span class="ident" id="6342009">ByteOrder</span><span class="op" id="6342018">.</span><span class="ident" id="6342019">Uint32</span><span class="op" id="6342025">(</span><span class="ident" id="6342026">dst</span><span class="op" id="6342029">[</span><span class="ident" id="6342030">rel</span><span class="op" id="6342033">.</span><span class="ident" id="6342034">Off</span>&nbsp;<span class="op" id="6342038">:</span>&nbsp;<span class="ident" id="6342040">rel</span><span class="op" id="6342043">.</span><span class="ident" id="6342044">Off</span><span class="op" id="6342047">+</span><span class="num" id="6342048">4</span><span class="op" id="6342049">]</span><span class="op" id="6342050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342055">val</span>&nbsp;<span class="op" id="6342059">+=</span>&nbsp;<span class="builtintype" id="6342062">uint32</span><span class="op" id="6342068">(</span><span class="ident" id="6342069">sym</span><span class="op" id="6342072">.</span><span class="ident" id="6342073">Value</span><span class="op" id="6342078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342083">f</span><span class="op" id="6342084">.</span><span class="ident" id="6342085">ByteOrder</span><span class="op" id="6342094">.</span><span class="ident" id="6342095">PutUint32</span><span class="op" id="6342104">(</span><span class="ident" id="6342105">dst</span><span class="op" id="6342108">[</span><span class="ident" id="6342109">rel</span><span class="op" id="6342112">.</span><span class="ident" id="6342113">Off</span><span class="op" id="6342116">:</span><span class="ident" id="6342117">rel</span><span class="op" id="6342120">.</span><span class="ident" id="6342121">Off</span><span class="op" id="6342124">+</span><span class="num" id="6342125">4</span><span class="op" id="6342126">]</span><span class="op" id="6342127">,</span>&nbsp;<span class="ident" id="6342129">val</span><span class="op" id="6342132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342136">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342143">return</span>&nbsp;<span class="ident" id="6342150">nil</span><br>
<span class="lineno"></span><span class="op" id="6342154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="6342157">func</span>&nbsp;<span class="op" id="6342162">(</span><span class="ident" id="6342163">f</span>&nbsp;<span class="op" id="6342165">*</span><span class="ident" id="6342166">File</span><span class="op" id="6342170">)</span>&nbsp;<span class="ident" id="6342172">applyRelocationsARM64</span><span class="op" id="6342193">(</span><span class="ident" id="6342194">dst</span>&nbsp;<span class="op" id="6342198">[</span><span class="op" id="6342199">]</span><span class="builtintype" id="6342200">byte</span><span class="op" id="6342204">,</span>&nbsp;<span class="ident" id="6342206">rels</span>&nbsp;<span class="op" id="6342211">[</span><span class="op" id="6342212">]</span><span class="builtintype" id="6342213">byte</span><span class="op" id="6342217">)</span>&nbsp;<span class="builtintype" id="6342219">error</span>&nbsp;<span class="op" id="6342225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342228">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342258">if</span>&nbsp;<span class="builtinfunc" id="6342261">len</span><span class="op" id="6342264">(</span><span class="ident" id="6342265">rels</span><span class="op" id="6342269">)</span><span class="op" id="6342270">%</span><span class="num" id="6342271">24</span>&nbsp;<span class="op" id="6342274">!=</span>&nbsp;<span class="num" id="6342277">0</span>&nbsp;<span class="op" id="6342279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342283">return</span>&nbsp;<span class="ident" id="6342290">errors</span><span class="op" id="6342296">.</span><span class="ident" id="6342297">New</span><span class="op" id="6342300">(</span><span class="string" id="6342301">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="6342355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342358">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342362">symbols</span><span class="op" id="6342369">,</span>&nbsp;<span class="ident" id="6342371">_</span><span class="op" id="6342372">,</span>&nbsp;<span class="ident" id="6342374">err</span>&nbsp;<span class="op" id="6342378">:=</span>&nbsp;<span class="ident" id="6342381">f</span><span class="op" id="6342382">.</span><span class="ident" id="6342383">getSymbols</span><span class="op" id="6342393">(</span><span class="ident" id="6342394">SHT_SYMTAB</span><span class="op" id="6342404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342407">if</span>&nbsp;<span class="ident" id="6342410">err</span>&nbsp;<span class="op" id="6342414">!=</span>&nbsp;<span class="ident" id="6342417">nil</span>&nbsp;<span class="op" id="6342421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342425">return</span>&nbsp;<span class="ident" id="6342432">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342437">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342441">b</span>&nbsp;<span class="op" id="6342443">:=</span>&nbsp;<span class="ident" id="6342446">bytes</span><span class="op" id="6342451">.</span><span class="ident" id="6342452">NewReader</span><span class="op" id="6342461">(</span><span class="ident" id="6342462">rels</span><span class="op" id="6342466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342469">var</span>&nbsp;<span class="ident" id="6342473">rela</span>&nbsp;<span class="ident" id="6342478">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342487">for</span>&nbsp;<span class="ident" id="6342491">b</span><span class="op" id="6342492">.</span><span class="ident" id="6342493">Len</span><span class="op" id="6342496">(</span><span class="op" id="6342497">)</span>&nbsp;<span class="op" id="6342499">&gt;</span>&nbsp;<span class="num" id="6342501">0</span>&nbsp;<span class="op" id="6342503">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342507">binary</span><span class="op" id="6342513">.</span><span class="ident" id="6342514">Read</span><span class="op" id="6342518">(</span><span class="ident" id="6342519">b</span><span class="op" id="6342520">,</span>&nbsp;<span class="ident" id="6342522">f</span><span class="op" id="6342523">.</span><span class="ident" id="6342524">ByteOrder</span><span class="op" id="6342533">,</span>&nbsp;<span class="op" id="6342535">&amp;</span><span class="ident" id="6342536">rela</span><span class="op" id="6342540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342544">symNo</span>&nbsp;<span class="op" id="6342550">:=</span>&nbsp;<span class="ident" id="6342553">rela</span><span class="op" id="6342557">.</span><span class="ident" id="6342558">Info</span>&nbsp;<span class="op" id="6342563">&gt;&gt;</span>&nbsp;<span class="num" id="6342566">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342571">t</span>&nbsp;<span class="op" id="6342573">:=</span>&nbsp;<span class="ident" id="6342576">R_AARCH64</span><span class="op" id="6342585">(</span><span class="ident" id="6342586">rela</span><span class="op" id="6342590">.</span><span class="ident" id="6342591">Info</span>&nbsp;<span class="op" id="6342596">&amp;</span>&nbsp;<span class="num" id="6342598">0xffff</span><span class="op" id="6342604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342609">if</span>&nbsp;<span class="ident" id="6342612">symNo</span>&nbsp;<span class="op" id="6342618">==</span>&nbsp;<span class="num" id="6342621">0</span>&nbsp;<span class="op" id="6342623">||</span>&nbsp;<span class="ident" id="6342626">symNo</span>&nbsp;<span class="op" id="6342632">&gt;</span>&nbsp;<span class="ident" id="6342634">uint64</span><span class="op" id="6342640">(</span><span class="builtinfunc" id="6342641">len</span><span class="op" id="6342644">(</span><span class="ident" id="6342645">symbols</span><span class="op" id="6342652">)</span><span class="op" id="6342653">)</span>&nbsp;<span class="op" id="6342655">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342660">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342675">sym</span>&nbsp;<span class="op" id="6342679">:=</span>&nbsp;<span class="op" id="6342682">&amp;</span><span class="ident" id="6342683">symbols</span><span class="op" id="6342690">[</span><span class="ident" id="6342691">symNo</span><span class="op" id="6342696">-</span><span class="num" id="6342697">1</span><span class="op" id="6342698">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342702">if</span>&nbsp;<span class="ident" id="6342705">SymType</span><span class="op" id="6342712">(</span><span class="ident" id="6342713">sym</span><span class="op" id="6342716">.</span><span class="ident" id="6342717">Info</span><span class="op" id="6342721">&amp;</span><span class="num" id="6342722">0xf</span><span class="op" id="6342725">)</span>&nbsp;<span class="op" id="6342727">!=</span>&nbsp;<span class="ident" id="6342730">STT_SECTION</span>&nbsp;<span class="op" id="6342742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342747">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342802">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342818">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342871">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342926">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342973">switch</span>&nbsp;<span class="ident" id="6342980">t</span>&nbsp;<span class="op" id="6342982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342986">case</span>&nbsp;<span class="ident" id="6342991">R_AARCH64_ABS64</span><span class="op" id="6343006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343011">if</span>&nbsp;<span class="ident" id="6343014">rela</span><span class="op" id="6343018">.</span><span class="ident" id="6343019">Off</span><span class="op" id="6343022">+</span><span class="num" id="6343023">8</span>&nbsp;<span class="op" id="6343025">&gt;=</span>&nbsp;<span class="ident" id="6343028">uint64</span><span class="op" id="6343034">(</span><span class="builtinfunc" id="6343035">len</span><span class="op" id="6343038">(</span><span class="ident" id="6343039">dst</span><span class="op" id="6343042">)</span><span class="op" id="6343043">)</span>&nbsp;<span class="op" id="6343045">||</span>&nbsp;<span class="ident" id="6343048">rela</span><span class="op" id="6343052">.</span><span class="ident" id="6343053">Addend</span>&nbsp;<span class="op" id="6343060">&lt;</span>&nbsp;<span class="num" id="6343062">0</span>&nbsp;<span class="op" id="6343064">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343070">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343087">f</span><span class="op" id="6343088">.</span><span class="ident" id="6343089">ByteOrder</span><span class="op" id="6343098">.</span><span class="ident" id="6343099">PutUint64</span><span class="op" id="6343108">(</span><span class="ident" id="6343109">dst</span><span class="op" id="6343112">[</span><span class="ident" id="6343113">rela</span><span class="op" id="6343117">.</span><span class="ident" id="6343118">Off</span><span class="op" id="6343121">:</span><span class="ident" id="6343122">rela</span><span class="op" id="6343126">.</span><span class="ident" id="6343127">Off</span><span class="op" id="6343130">+</span><span class="num" id="6343131">8</span><span class="op" id="6343132">]</span><span class="op" id="6343133">,</span>&nbsp;<span class="ident" id="6343135">uint64</span><span class="op" id="6343141">(</span><span class="ident" id="6343142">rela</span><span class="op" id="6343146">.</span><span class="ident" id="6343147">Addend</span><span class="op" id="6343153">)</span><span class="op" id="6343154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343158">case</span>&nbsp;<span class="ident" id="6343163">R_AARCH64_ABS32</span><span class="op" id="6343178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343183">if</span>&nbsp;<span class="ident" id="6343186">rela</span><span class="op" id="6343190">.</span><span class="ident" id="6343191">Off</span><span class="op" id="6343194">+</span><span class="num" id="6343195">4</span>&nbsp;<span class="op" id="6343197">&gt;=</span>&nbsp;<span class="ident" id="6343200">uint64</span><span class="op" id="6343206">(</span><span class="builtinfunc" id="6343207">len</span><span class="op" id="6343210">(</span><span class="ident" id="6343211">dst</span><span class="op" id="6343214">)</span><span class="op" id="6343215">)</span>&nbsp;<span class="op" id="6343217">||</span>&nbsp;<span class="ident" id="6343220">rela</span><span class="op" id="6343224">.</span><span class="ident" id="6343225">Addend</span>&nbsp;<span class="op" id="6343232">&lt;</span>&nbsp;<span class="num" id="6343234">0</span>&nbsp;<span class="op" id="6343236">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343242">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343259">f</span><span class="op" id="6343260">.</span><span class="ident" id="6343261">ByteOrder</span><span class="op" id="6343270">.</span><span class="ident" id="6343271">PutUint32</span><span class="op" id="6343280">(</span><span class="ident" id="6343281">dst</span><span class="op" id="6343284">[</span><span class="ident" id="6343285">rela</span><span class="op" id="6343289">.</span><span class="ident" id="6343290">Off</span><span class="op" id="6343293">:</span><span class="ident" id="6343294">rela</span><span class="op" id="6343298">.</span><span class="ident" id="6343299">Off</span><span class="op" id="6343302">+</span><span class="num" id="6343303">4</span><span class="op" id="6343304">]</span><span class="op" id="6343305">,</span>&nbsp;<span class="builtintype" id="6343307">uint32</span><span class="op" id="6343313">(</span><span class="ident" id="6343314">rela</span><span class="op" id="6343318">.</span><span class="ident" id="6343319">Addend</span><span class="op" id="6343325">)</span><span class="op" id="6343326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343333">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343337">return</span>&nbsp;<span class="ident" id="6343344">nil</span><br>
<span class="lineno"></span><span class="op" id="6343348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6343351">func</span>&nbsp;<span class="op" id="6343356">(</span><span class="ident" id="6343357">f</span>&nbsp;<span class="op" id="6343359">*</span><span class="ident" id="6343360">File</span><span class="op" id="6343364">)</span>&nbsp;<span class="ident" id="6343366">DWARF</span><span class="op" id="6343371">(</span><span class="op" id="6343372">)</span>&nbsp;<span class="op" id="6343374">(</span><span class="op" id="6343375">*</span><span class="ident" id="6343376">dwarf</span><span class="op" id="6343381">.</span><span class="ident" id="6343382">Data</span><span class="op" id="6343386">,</span>&nbsp;<span class="builtintype" id="6343388">error</span><span class="op" id="6343393">)</span>&nbsp;<span class="op" id="6343395">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343398">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343449">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343504">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343563">var</span>&nbsp;<span class="ident" id="6343567">names</span>&nbsp;<span class="op" id="6343573">=</span>&nbsp;<span class="op" id="6343575">[</span><span class="op" id="6343576">...</span><span class="op" id="6343579">]</span><span class="builtintype" id="6343580">string</span><span class="op" id="6343586">{</span><span class="string" id="6343587">&#34;abbrev&#34;</span><span class="op" id="6343595">,</span>&nbsp;<span class="string" id="6343597">&#34;info&#34;</span><span class="op" id="6343603">,</span>&nbsp;<span class="string" id="6343605">&#34;str&#34;</span><span class="op" id="6343610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343613">var</span>&nbsp;<span class="ident" id="6343617">dat</span>&nbsp;<span class="op" id="6343621">[</span><span class="builtinfunc" id="6343622">len</span><span class="op" id="6343625">(</span><span class="ident" id="6343626">names</span><span class="op" id="6343631">)</span><span class="op" id="6343632">]</span><span class="op" id="6343633">[</span><span class="op" id="6343634">]</span><span class="builtintype" id="6343635">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343641">for</span>&nbsp;<span class="ident" id="6343645">i</span><span class="op" id="6343646">,</span>&nbsp;<span class="ident" id="6343648">name</span>&nbsp;<span class="op" id="6343653">:=</span>&nbsp;<span class="keyword" id="6343656">range</span>&nbsp;<span class="ident" id="6343662">names</span>&nbsp;<span class="op" id="6343668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343672">name</span>&nbsp;<span class="op" id="6343677">=</span>&nbsp;<span class="string" id="6343679">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="6343689">+</span>&nbsp;<span class="ident" id="6343691">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343698">s</span>&nbsp;<span class="op" id="6343700">:=</span>&nbsp;<span class="ident" id="6343703">f</span><span class="op" id="6343704">.</span><span class="ident" id="6343705">Section</span><span class="op" id="6343712">(</span><span class="ident" id="6343713">name</span><span class="op" id="6343717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343721">if</span>&nbsp;<span class="ident" id="6343724">s</span>&nbsp;<span class="op" id="6343726">==</span>&nbsp;<span class="ident" id="6343729">nil</span>&nbsp;<span class="op" id="6343733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343738">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343753">b</span><span class="op" id="6343754">,</span>&nbsp;<span class="ident" id="6343756">err</span>&nbsp;<span class="op" id="6343760">:=</span>&nbsp;<span class="ident" id="6343763">s</span><span class="op" id="6343764">.</span><span class="ident" id="6343765">Data</span><span class="op" id="6343769">(</span><span class="op" id="6343770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343774">if</span>&nbsp;<span class="ident" id="6343777">err</span>&nbsp;<span class="op" id="6343781">!=</span>&nbsp;<span class="ident" id="6343784">nil</span>&nbsp;<span class="op" id="6343788">&amp;&amp;</span>&nbsp;<span class="ident" id="6343791">uint64</span><span class="op" id="6343797">(</span><span class="builtinfunc" id="6343798">len</span><span class="op" id="6343801">(</span><span class="ident" id="6343802">b</span><span class="op" id="6343803">)</span><span class="op" id="6343804">)</span>&nbsp;<span class="op" id="6343806">&lt;</span>&nbsp;<span class="ident" id="6343808">s</span><span class="op" id="6343809">.</span><span class="ident" id="6343810">Size</span>&nbsp;<span class="op" id="6343815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343820">return</span>&nbsp;<span class="ident" id="6343827">nil</span><span class="op" id="6343830">,</span>&nbsp;<span class="ident" id="6343832">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343838">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343842">dat</span><span class="op" id="6343845">[</span><span class="ident" id="6343846">i</span><span class="op" id="6343847">]</span>&nbsp;<span class="op" id="6343849">=</span>&nbsp;<span class="ident" id="6343851">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343858">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343931">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344004">rela</span>&nbsp;<span class="op" id="6344009">:=</span>&nbsp;<span class="ident" id="6344012">f</span><span class="op" id="6344013">.</span><span class="ident" id="6344014">Section</span><span class="op" id="6344021">(</span><span class="string" id="6344022">&#34;.rela.debug_info&#34;</span><span class="op" id="6344040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344043">if</span>&nbsp;<span class="ident" id="6344046">rela</span>&nbsp;<span class="op" id="6344051">!=</span>&nbsp;<span class="ident" id="6344054">nil</span>&nbsp;<span class="op" id="6344058">&amp;&amp;</span>&nbsp;<span class="ident" id="6344061">rela</span><span class="op" id="6344065">.</span><span class="ident" id="6344066">Type</span>&nbsp;<span class="op" id="6344071">==</span>&nbsp;<span class="ident" id="6344074">SHT_RELA</span>&nbsp;<span class="op" id="6344083">&amp;&amp;</span>&nbsp;<span class="op" id="6344086">(</span><span class="ident" id="6344087">f</span><span class="op" id="6344088">.</span><span class="ident" id="6344089">Machine</span>&nbsp;<span class="op" id="6344097">==</span>&nbsp;<span class="ident" id="6344100">EM_X86_64</span>&nbsp;<span class="op" id="6344110">||</span>&nbsp;<span class="ident" id="6344113">f</span><span class="op" id="6344114">.</span><span class="ident" id="6344115">Machine</span>&nbsp;<span class="op" id="6344123">==</span>&nbsp;<span class="ident" id="6344126">EM_AARCH64</span><span class="op" id="6344136">)</span>&nbsp;<span class="op" id="6344138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344142">data</span><span class="op" id="6344146">,</span>&nbsp;<span class="ident" id="6344148">err</span>&nbsp;<span class="op" id="6344152">:=</span>&nbsp;<span class="ident" id="6344155">rela</span><span class="op" id="6344159">.</span><span class="ident" id="6344160">Data</span><span class="op" id="6344164">(</span><span class="op" id="6344165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344169">if</span>&nbsp;<span class="ident" id="6344172">err</span>&nbsp;<span class="op" id="6344176">!=</span>&nbsp;<span class="ident" id="6344179">nil</span>&nbsp;<span class="op" id="6344183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344188">return</span>&nbsp;<span class="ident" id="6344195">nil</span><span class="op" id="6344198">,</span>&nbsp;<span class="ident" id="6344200">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344210">err</span>&nbsp;<span class="op" id="6344214">=</span>&nbsp;<span class="ident" id="6344216">f</span><span class="op" id="6344217">.</span><span class="ident" id="6344218">applyRelocations</span><span class="op" id="6344234">(</span><span class="ident" id="6344235">dat</span><span class="op" id="6344238">[</span><span class="num" id="6344239">1</span><span class="op" id="6344240">]</span><span class="op" id="6344241">,</span>&nbsp;<span class="ident" id="6344243">data</span><span class="op" id="6344247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344251">if</span>&nbsp;<span class="ident" id="6344254">err</span>&nbsp;<span class="op" id="6344258">!=</span>&nbsp;<span class="ident" id="6344261">nil</span>&nbsp;<span class="op" id="6344265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344270">return</span>&nbsp;<span class="ident" id="6344277">nil</span><span class="op" id="6344280">,</span>&nbsp;<span class="ident" id="6344282">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344288">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344295">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344361">rel</span>&nbsp;<span class="op" id="6344365">:=</span>&nbsp;<span class="ident" id="6344368">f</span><span class="op" id="6344369">.</span><span class="ident" id="6344370">Section</span><span class="op" id="6344377">(</span><span class="string" id="6344378">&#34;.rel.debug_info&#34;</span><span class="op" id="6344395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344398">if</span>&nbsp;<span class="ident" id="6344401">rel</span>&nbsp;<span class="op" id="6344405">!=</span>&nbsp;<span class="ident" id="6344408">nil</span>&nbsp;<span class="op" id="6344412">&amp;&amp;</span>&nbsp;<span class="ident" id="6344415">rel</span><span class="op" id="6344418">.</span><span class="ident" id="6344419">Type</span>&nbsp;<span class="op" id="6344424">==</span>&nbsp;<span class="ident" id="6344427">SHT_REL</span>&nbsp;<span class="op" id="6344435">&amp;&amp;</span>&nbsp;<span class="ident" id="6344438">f</span><span class="op" id="6344439">.</span><span class="ident" id="6344440">Machine</span>&nbsp;<span class="op" id="6344448">==</span>&nbsp;<span class="ident" id="6344451">EM_386</span>&nbsp;<span class="op" id="6344458">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344462">data</span><span class="op" id="6344466">,</span>&nbsp;<span class="ident" id="6344468">err</span>&nbsp;<span class="op" id="6344472">:=</span>&nbsp;<span class="ident" id="6344475">rel</span><span class="op" id="6344478">.</span><span class="ident" id="6344479">Data</span><span class="op" id="6344483">(</span><span class="op" id="6344484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344488">if</span>&nbsp;<span class="ident" id="6344491">err</span>&nbsp;<span class="op" id="6344495">!=</span>&nbsp;<span class="ident" id="6344498">nil</span>&nbsp;<span class="op" id="6344502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344507">return</span>&nbsp;<span class="ident" id="6344514">nil</span><span class="op" id="6344517">,</span>&nbsp;<span class="ident" id="6344519">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344529">err</span>&nbsp;<span class="op" id="6344533">=</span>&nbsp;<span class="ident" id="6344535">f</span><span class="op" id="6344536">.</span><span class="ident" id="6344537">applyRelocations</span><span class="op" id="6344553">(</span><span class="ident" id="6344554">dat</span><span class="op" id="6344557">[</span><span class="num" id="6344558">1</span><span class="op" id="6344559">]</span><span class="op" id="6344560">,</span>&nbsp;<span class="ident" id="6344562">data</span><span class="op" id="6344566">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344570">if</span>&nbsp;<span class="ident" id="6344573">err</span>&nbsp;<span class="op" id="6344577">!=</span>&nbsp;<span class="ident" id="6344580">nil</span>&nbsp;<span class="op" id="6344584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344589">return</span>&nbsp;<span class="ident" id="6344596">nil</span><span class="op" id="6344599">,</span>&nbsp;<span class="ident" id="6344601">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344614">abbrev</span><span class="op" id="6344620">,</span>&nbsp;<span class="ident" id="6344622">info</span><span class="op" id="6344626">,</span>&nbsp;<span class="ident" id="6344628">str</span>&nbsp;<span class="op" id="6344632">:=</span>&nbsp;<span class="ident" id="6344635">dat</span><span class="op" id="6344638">[</span><span class="num" id="6344639">0</span><span class="op" id="6344640">]</span><span class="op" id="6344641">,</span>&nbsp;<span class="ident" id="6344643">dat</span><span class="op" id="6344646">[</span><span class="num" id="6344647">1</span><span class="op" id="6344648">]</span><span class="op" id="6344649">,</span>&nbsp;<span class="ident" id="6344651">dat</span><span class="op" id="6344654">[</span><span class="num" id="6344655">2</span><span class="op" id="6344656">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344659">d</span><span class="op" id="6344660">,</span>&nbsp;<span class="ident" id="6344662">err</span>&nbsp;<span class="op" id="6344666">:=</span>&nbsp;<span class="ident" id="6344669">dwarf</span><span class="op" id="6344674">.</span><span class="ident" id="6344675">New</span><span class="op" id="6344678">(</span><span class="ident" id="6344679">abbrev</span><span class="op" id="6344685">,</span>&nbsp;<span class="ident" id="6344687">nil</span><span class="op" id="6344690">,</span>&nbsp;<span class="ident" id="6344692">nil</span><span class="op" id="6344695">,</span>&nbsp;<span class="ident" id="6344697">info</span><span class="op" id="6344701">,</span>&nbsp;<span class="ident" id="6344703">nil</span><span class="op" id="6344706">,</span>&nbsp;<span class="ident" id="6344708">nil</span><span class="op" id="6344711">,</span>&nbsp;<span class="ident" id="6344713">nil</span><span class="op" id="6344716">,</span>&nbsp;<span class="ident" id="6344718">str</span><span class="op" id="6344721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344724">if</span>&nbsp;<span class="ident" id="6344727">err</span>&nbsp;<span class="op" id="6344731">!=</span>&nbsp;<span class="ident" id="6344734">nil</span>&nbsp;<span class="op" id="6344738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344742">return</span>&nbsp;<span class="ident" id="6344749">nil</span><span class="op" id="6344752">,</span>&nbsp;<span class="ident" id="6344754">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344759">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344763">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344806">for</span>&nbsp;<span class="ident" id="6344810">i</span><span class="op" id="6344811">,</span>&nbsp;<span class="ident" id="6344813">s</span>&nbsp;<span class="op" id="6344815">:=</span>&nbsp;<span class="keyword" id="6344818">range</span>&nbsp;<span class="ident" id="6344824">f</span><span class="op" id="6344825">.</span><span class="ident" id="6344826">Sections</span>&nbsp;<span class="op" id="6344835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344839">if</span>&nbsp;<span class="ident" id="6344842">s</span><span class="op" id="6344843">.</span><span class="ident" id="6344844">Name</span>&nbsp;<span class="op" id="6344849">==</span>&nbsp;<span class="string" id="6344852">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="6344867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344872">b</span><span class="op" id="6344873">,</span>&nbsp;<span class="ident" id="6344875">err</span>&nbsp;<span class="op" id="6344879">:=</span>&nbsp;<span class="ident" id="6344882">s</span><span class="op" id="6344883">.</span><span class="ident" id="6344884">Data</span><span class="op" id="6344888">(</span><span class="op" id="6344889">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344894">if</span>&nbsp;<span class="ident" id="6344897">err</span>&nbsp;<span class="op" id="6344901">!=</span>&nbsp;<span class="ident" id="6344904">nil</span>&nbsp;<span class="op" id="6344908">&amp;&amp;</span>&nbsp;<span class="ident" id="6344911">uint64</span><span class="op" id="6344917">(</span><span class="builtinfunc" id="6344918">len</span><span class="op" id="6344921">(</span><span class="ident" id="6344922">b</span><span class="op" id="6344923">)</span><span class="op" id="6344924">)</span>&nbsp;<span class="op" id="6344926">&lt;</span>&nbsp;<span class="ident" id="6344928">s</span><span class="op" id="6344929">.</span><span class="ident" id="6344930">Size</span>&nbsp;<span class="op" id="6344935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344941">return</span>&nbsp;<span class="ident" id="6344948">nil</span><span class="op" id="6344951">,</span>&nbsp;<span class="ident" id="6344953">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344966">for</span>&nbsp;<span class="ident" id="6344970">_</span><span class="op" id="6344971">,</span>&nbsp;<span class="ident" id="6344973">r</span>&nbsp;<span class="op" id="6344975">:=</span>&nbsp;<span class="keyword" id="6344978">range</span>&nbsp;<span class="ident" id="6344984">f</span><span class="op" id="6344985">.</span><span class="ident" id="6344986">Sections</span>&nbsp;<span class="op" id="6344995">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345001">if</span>&nbsp;<span class="ident" id="6345004">r</span><span class="op" id="6345005">.</span><span class="ident" id="6345006">Type</span>&nbsp;<span class="op" id="6345011">!=</span>&nbsp;<span class="ident" id="6345014">SHT_RELA</span>&nbsp;<span class="op" id="6345023">&amp;&amp;</span>&nbsp;<span class="ident" id="6345026">r</span><span class="op" id="6345027">.</span><span class="ident" id="6345028">Type</span>&nbsp;<span class="op" id="6345033">!=</span>&nbsp;<span class="ident" id="6345036">SHT_REL</span>&nbsp;<span class="op" id="6345044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345051">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345070">if</span>&nbsp;<span class="builtintype" id="6345073">int</span><span class="op" id="6345076">(</span><span class="ident" id="6345077">r</span><span class="op" id="6345078">.</span><span class="ident" id="6345079">Info</span><span class="op" id="6345083">)</span>&nbsp;<span class="op" id="6345085">!=</span>&nbsp;<span class="ident" id="6345088">i</span>&nbsp;<span class="op" id="6345090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345097">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345116">rd</span><span class="op" id="6345118">,</span>&nbsp;<span class="ident" id="6345120">err</span>&nbsp;<span class="op" id="6345124">:=</span>&nbsp;<span class="ident" id="6345127">r</span><span class="op" id="6345128">.</span><span class="ident" id="6345129">Data</span><span class="op" id="6345133">(</span><span class="op" id="6345134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345140">if</span>&nbsp;<span class="ident" id="6345143">err</span>&nbsp;<span class="op" id="6345147">!=</span>&nbsp;<span class="ident" id="6345150">nil</span>&nbsp;<span class="op" id="6345154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345161">return</span>&nbsp;<span class="ident" id="6345168">nil</span><span class="op" id="6345171">,</span>&nbsp;<span class="ident" id="6345173">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345181">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345187">err</span>&nbsp;<span class="op" id="6345191">=</span>&nbsp;<span class="ident" id="6345193">f</span><span class="op" id="6345194">.</span><span class="ident" id="6345195">applyRelocations</span><span class="op" id="6345211">(</span><span class="ident" id="6345212">b</span><span class="op" id="6345213">,</span>&nbsp;<span class="ident" id="6345215">rd</span><span class="op" id="6345217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345223">if</span>&nbsp;<span class="ident" id="6345226">err</span>&nbsp;<span class="op" id="6345230">!=</span>&nbsp;<span class="ident" id="6345233">nil</span>&nbsp;<span class="op" id="6345237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345244">return</span>&nbsp;<span class="ident" id="6345251">nil</span><span class="op" id="6345254">,</span>&nbsp;<span class="ident" id="6345256">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345269">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345275">err</span>&nbsp;<span class="op" id="6345279">=</span>&nbsp;<span class="ident" id="6345281">d</span><span class="op" id="6345282">.</span><span class="ident" id="6345283">AddTypes</span><span class="op" id="6345291">(</span><span class="ident" id="6345292">fmt</span><span class="op" id="6345295">.</span><span class="ident" id="6345296">Sprintf</span><span class="op" id="6345303">(</span><span class="string" id="6345304">&#34;types-%d&#34;</span><span class="op" id="6345314">,</span>&nbsp;<span class="ident" id="6345316">i</span><span class="op" id="6345317">)</span><span class="op" id="6345318">,</span>&nbsp;<span class="ident" id="6345320">b</span><span class="op" id="6345321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345326">if</span>&nbsp;<span class="ident" id="6345329">err</span>&nbsp;<span class="op" id="6345333">!=</span>&nbsp;<span class="ident" id="6345336">nil</span>&nbsp;<span class="op" id="6345340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345346">return</span>&nbsp;<span class="ident" id="6345353">nil</span><span class="op" id="6345356">,</span>&nbsp;<span class="ident" id="6345358">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345365">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345376">return</span>&nbsp;<span class="ident" id="6345383">d</span><span class="op" id="6345384">,</span>&nbsp;<span class="ident" id="6345386">nil</span><br>
<span class="lineno"></span><span class="op" id="6345390">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="6345393">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="6345476">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="6345497">//</span><br>
<span class="lineno"></span><span class="comment" id="6345500">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="6345576">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="6345650">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="6345696">func</span>&nbsp;<span class="op" id="6345701">(</span><span class="ident" id="6345702">f</span>&nbsp;<span class="op" id="6345704">*</span><span class="ident" id="6345705">File</span><span class="op" id="6345709">)</span>&nbsp;<span class="ident" id="6345711">Symbols</span><span class="op" id="6345718">(</span><span class="op" id="6345719">)</span>&nbsp;<span class="op" id="6345721">(</span><span class="op" id="6345722">[</span><span class="op" id="6345723">]</span><span class="ident" id="6345724">Symbol</span><span class="op" id="6345730">,</span>&nbsp;<span class="builtintype" id="6345732">error</span><span class="op" id="6345737">)</span>&nbsp;<span class="op" id="6345739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345742">sym</span><span class="op" id="6345745">,</span>&nbsp;<span class="ident" id="6345747">_</span><span class="op" id="6345748">,</span>&nbsp;<span class="ident" id="6345750">err</span>&nbsp;<span class="op" id="6345754">:=</span>&nbsp;<span class="ident" id="6345757">f</span><span class="op" id="6345758">.</span><span class="ident" id="6345759">getSymbols</span><span class="op" id="6345769">(</span><span class="ident" id="6345770">SHT_SYMTAB</span><span class="op" id="6345780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345783">return</span>&nbsp;<span class="ident" id="6345790">sym</span><span class="op" id="6345793">,</span>&nbsp;<span class="ident" id="6345795">err</span><br>
<span class="lineno">770</span><span class="op" id="6345799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6345802">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="6345872">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="6345921">//</span><br>
<span class="lineno">775</span><span class="comment" id="6345924">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="6346008">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="6346082">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="6346128">func</span>&nbsp;<span class="op" id="6346133">(</span><span class="ident" id="6346134">f</span>&nbsp;<span class="op" id="6346136">*</span><span class="ident" id="6346137">File</span><span class="op" id="6346141">)</span>&nbsp;<span class="ident" id="6346143">DynamicSymbols</span><span class="op" id="6346157">(</span><span class="op" id="6346158">)</span>&nbsp;<span class="op" id="6346160">(</span><span class="op" id="6346161">[</span><span class="op" id="6346162">]</span><span class="ident" id="6346163">Symbol</span><span class="op" id="6346169">,</span>&nbsp;<span class="builtintype" id="6346171">error</span><span class="op" id="6346176">)</span>&nbsp;<span class="op" id="6346178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346181">sym</span><span class="op" id="6346184">,</span>&nbsp;<span class="ident" id="6346186">_</span><span class="op" id="6346187">,</span>&nbsp;<span class="ident" id="6346189">err</span>&nbsp;<span class="op" id="6346193">:=</span>&nbsp;<span class="ident" id="6346196">f</span><span class="op" id="6346197">.</span><span class="ident" id="6346198">getSymbols</span><span class="op" id="6346208">(</span><span class="ident" id="6346209">SHT_DYNSYM</span><span class="op" id="6346219">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346222">return</span>&nbsp;<span class="ident" id="6346229">sym</span><span class="op" id="6346232">,</span>&nbsp;<span class="ident" id="6346234">err</span><br>
<span class="lineno"></span><span class="op" id="6346238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6346241">type</span>&nbsp;<span class="ident" id="6346246">ImportedSymbol</span>&nbsp;<span class="keyword" id="6346261">struct</span>&nbsp;<span class="op" id="6346268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346271">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6346279">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346287">Version</span>&nbsp;<span class="builtintype" id="6346295">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346303">Library</span>&nbsp;<span class="builtintype" id="6346311">string</span><br>
<span class="lineno"></span><span class="op" id="6346318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6346321">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="6346373">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6346428">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6346482">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="6346518">func</span>&nbsp;<span class="op" id="6346523">(</span><span class="ident" id="6346524">f</span>&nbsp;<span class="op" id="6346526">*</span><span class="ident" id="6346527">File</span><span class="op" id="6346531">)</span>&nbsp;<span class="ident" id="6346533">ImportedSymbols</span><span class="op" id="6346548">(</span><span class="op" id="6346549">)</span>&nbsp;<span class="op" id="6346551">(</span><span class="op" id="6346552">[</span><span class="op" id="6346553">]</span><span class="ident" id="6346554">ImportedSymbol</span><span class="op" id="6346568">,</span>&nbsp;<span class="builtintype" id="6346570">error</span><span class="op" id="6346575">)</span>&nbsp;<span class="op" id="6346577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346580">sym</span><span class="op" id="6346583">,</span>&nbsp;<span class="ident" id="6346585">str</span><span class="op" id="6346588">,</span>&nbsp;<span class="ident" id="6346590">err</span>&nbsp;<span class="op" id="6346594">:=</span>&nbsp;<span class="ident" id="6346597">f</span><span class="op" id="6346598">.</span><span class="ident" id="6346599">getSymbols</span><span class="op" id="6346609">(</span><span class="ident" id="6346610">SHT_DYNSYM</span><span class="op" id="6346620">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346623">if</span>&nbsp;<span class="ident" id="6346626">err</span>&nbsp;<span class="op" id="6346630">!=</span>&nbsp;<span class="ident" id="6346633">nil</span>&nbsp;<span class="op" id="6346637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346641">return</span>&nbsp;<span class="ident" id="6346648">nil</span><span class="op" id="6346651">,</span>&nbsp;<span class="ident" id="6346653">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346661">f</span><span class="op" id="6346662">.</span><span class="ident" id="6346663">gnuVersionInit</span><span class="op" id="6346677">(</span><span class="ident" id="6346678">str</span><span class="op" id="6346681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346684">var</span>&nbsp;<span class="ident" id="6346688">all</span>&nbsp;<span class="op" id="6346692">[</span><span class="op" id="6346693">]</span><span class="ident" id="6346694">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346710">for</span>&nbsp;<span class="ident" id="6346714">i</span><span class="op" id="6346715">,</span>&nbsp;<span class="ident" id="6346717">s</span>&nbsp;<span class="op" id="6346719">:=</span>&nbsp;<span class="keyword" id="6346722">range</span>&nbsp;<span class="ident" id="6346728">sym</span>&nbsp;<span class="op" id="6346732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346736">if</span>&nbsp;<span class="ident" id="6346739">ST_BIND</span><span class="op" id="6346746">(</span><span class="ident" id="6346747">s</span><span class="op" id="6346748">.</span><span class="ident" id="6346749">Info</span><span class="op" id="6346753">)</span>&nbsp;<span class="op" id="6346755">==</span>&nbsp;<span class="ident" id="6346758">STB_GLOBAL</span>&nbsp;<span class="op" id="6346769">&amp;&amp;</span>&nbsp;<span class="ident" id="6346772">s</span><span class="op" id="6346773">.</span><span class="ident" id="6346774">Section</span>&nbsp;<span class="op" id="6346782">==</span>&nbsp;<span class="ident" id="6346785">SHN_UNDEF</span>&nbsp;<span class="op" id="6346795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346800">all</span>&nbsp;<span class="op" id="6346804">=</span>&nbsp;<span class="builtinfunc" id="6346806">append</span><span class="op" id="6346812">(</span><span class="ident" id="6346813">all</span><span class="op" id="6346816">,</span>&nbsp;<span class="ident" id="6346818">ImportedSymbol</span><span class="op" id="6346832">{</span><span class="ident" id="6346833">Name</span><span class="op" id="6346837">:</span>&nbsp;<span class="ident" id="6346839">s</span><span class="op" id="6346840">.</span><span class="ident" id="6346841">Name</span><span class="op" id="6346845">}</span><span class="op" id="6346846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346851">f</span><span class="op" id="6346852">.</span><span class="ident" id="6346853">gnuVersion</span><span class="op" id="6346863">(</span><span class="ident" id="6346864">i</span><span class="op" id="6346865">,</span>&nbsp;<span class="op" id="6346867">&amp;</span><span class="ident" id="6346868">all</span><span class="op" id="6346871">[</span><span class="builtinfunc" id="6346872">len</span><span class="op" id="6346875">(</span><span class="ident" id="6346876">all</span><span class="op" id="6346879">)</span><span class="op" id="6346880">-</span><span class="num" id="6346881">1</span><span class="op" id="6346882">]</span><span class="op" id="6346883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346887">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346893">return</span>&nbsp;<span class="ident" id="6346900">all</span><span class="op" id="6346903">,</span>&nbsp;<span class="ident" id="6346905">nil</span><br>
<span class="lineno"></span><span class="op" id="6346909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6346912">type</span>&nbsp;<span class="ident" id="6346917">verneed</span>&nbsp;<span class="keyword" id="6346925">struct</span>&nbsp;<span class="op" id="6346932">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346935">File</span>&nbsp;<span class="builtintype" id="6346940">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346948">Name</span>&nbsp;<span class="builtintype" id="6346953">string</span><br>
<span class="lineno"></span><span class="op" id="6346960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6346963">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="6347011">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="6347046">func</span>&nbsp;<span class="op" id="6347051">(</span><span class="ident" id="6347052">f</span>&nbsp;<span class="op" id="6347054">*</span><span class="ident" id="6347055">File</span><span class="op" id="6347059">)</span>&nbsp;<span class="ident" id="6347061">gnuVersionInit</span><span class="op" id="6347075">(</span><span class="ident" id="6347076">str</span>&nbsp;<span class="op" id="6347080">[</span><span class="op" id="6347081">]</span><span class="builtintype" id="6347082">byte</span><span class="op" id="6347086">)</span>&nbsp;<span class="op" id="6347088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6347091">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347127">vn</span>&nbsp;<span class="op" id="6347130">:=</span>&nbsp;<span class="ident" id="6347133">f</span><span class="op" id="6347134">.</span><span class="ident" id="6347135">SectionByType</span><span class="op" id="6347148">(</span><span class="ident" id="6347149">SHT_GNU_VERNEED</span><span class="op" id="6347164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347167">if</span>&nbsp;<span class="ident" id="6347170">vn</span>&nbsp;<span class="op" id="6347173">==</span>&nbsp;<span class="ident" id="6347176">nil</span>&nbsp;<span class="op" id="6347180">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347184">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347195">d</span><span class="op" id="6347196">,</span>&nbsp;<span class="ident" id="6347198">_</span>&nbsp;<span class="op" id="6347200">:=</span>&nbsp;<span class="ident" id="6347203">vn</span><span class="op" id="6347205">.</span><span class="ident" id="6347206">Data</span><span class="op" id="6347210">(</span><span class="op" id="6347211">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347215">var</span>&nbsp;<span class="ident" id="6347219">need</span>&nbsp;<span class="op" id="6347224">[</span><span class="op" id="6347225">]</span><span class="ident" id="6347226">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347235">i</span>&nbsp;<span class="op" id="6347237">:=</span>&nbsp;<span class="num" id="6347240">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347243">for</span>&nbsp;<span class="op" id="6347247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347251">if</span>&nbsp;<span class="ident" id="6347254">i</span><span class="op" id="6347255">+</span><span class="num" id="6347256">16</span>&nbsp;<span class="op" id="6347259">&gt;</span>&nbsp;<span class="builtinfunc" id="6347261">len</span><span class="op" id="6347264">(</span><span class="ident" id="6347265">d</span><span class="op" id="6347266">)</span>&nbsp;<span class="op" id="6347268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347273">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347281">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347285">vers</span>&nbsp;<span class="op" id="6347290">:=</span>&nbsp;<span class="ident" id="6347293">f</span><span class="op" id="6347294">.</span><span class="ident" id="6347295">ByteOrder</span><span class="op" id="6347304">.</span><span class="ident" id="6347305">Uint16</span><span class="op" id="6347311">(</span><span class="ident" id="6347312">d</span><span class="op" id="6347313">[</span><span class="ident" id="6347314">i</span>&nbsp;<span class="op" id="6347316">:</span>&nbsp;<span class="ident" id="6347318">i</span><span class="op" id="6347319">+</span><span class="num" id="6347320">2</span><span class="op" id="6347321">]</span><span class="op" id="6347322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347326">if</span>&nbsp;<span class="ident" id="6347329">vers</span>&nbsp;<span class="op" id="6347334">!=</span>&nbsp;<span class="num" id="6347337">1</span>&nbsp;<span class="op" id="6347339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347344">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347356">cnt</span>&nbsp;<span class="op" id="6347360">:=</span>&nbsp;<span class="ident" id="6347363">f</span><span class="op" id="6347364">.</span><span class="ident" id="6347365">ByteOrder</span><span class="op" id="6347374">.</span><span class="ident" id="6347375">Uint16</span><span class="op" id="6347381">(</span><span class="ident" id="6347382">d</span><span class="op" id="6347383">[</span><span class="ident" id="6347384">i</span><span class="op" id="6347385">+</span><span class="num" id="6347386">2</span>&nbsp;<span class="op" id="6347388">:</span>&nbsp;<span class="ident" id="6347390">i</span><span class="op" id="6347391">+</span><span class="num" id="6347392">4</span><span class="op" id="6347393">]</span><span class="op" id="6347394">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347398">fileoff</span>&nbsp;<span class="op" id="6347406">:=</span>&nbsp;<span class="ident" id="6347409">f</span><span class="op" id="6347410">.</span><span class="ident" id="6347411">ByteOrder</span><span class="op" id="6347420">.</span><span class="ident" id="6347421">Uint32</span><span class="op" id="6347427">(</span><span class="ident" id="6347428">d</span><span class="op" id="6347429">[</span><span class="ident" id="6347430">i</span><span class="op" id="6347431">+</span><span class="num" id="6347432">4</span>&nbsp;<span class="op" id="6347434">:</span>&nbsp;<span class="ident" id="6347436">i</span><span class="op" id="6347437">+</span><span class="num" id="6347438">8</span><span class="op" id="6347439">]</span><span class="op" id="6347440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347444">aux</span>&nbsp;<span class="op" id="6347448">:=</span>&nbsp;<span class="ident" id="6347451">f</span><span class="op" id="6347452">.</span><span class="ident" id="6347453">ByteOrder</span><span class="op" id="6347462">.</span><span class="ident" id="6347463">Uint32</span><span class="op" id="6347469">(</span><span class="ident" id="6347470">d</span><span class="op" id="6347471">[</span><span class="ident" id="6347472">i</span><span class="op" id="6347473">+</span><span class="num" id="6347474">8</span>&nbsp;<span class="op" id="6347476">:</span>&nbsp;<span class="ident" id="6347478">i</span><span class="op" id="6347479">+</span><span class="num" id="6347480">12</span><span class="op" id="6347482">]</span><span class="op" id="6347483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347487">next</span>&nbsp;<span class="op" id="6347492">:=</span>&nbsp;<span class="ident" id="6347495">f</span><span class="op" id="6347496">.</span><span class="ident" id="6347497">ByteOrder</span><span class="op" id="6347506">.</span><span class="ident" id="6347507">Uint32</span><span class="op" id="6347513">(</span><span class="ident" id="6347514">d</span><span class="op" id="6347515">[</span><span class="ident" id="6347516">i</span><span class="op" id="6347517">+</span><span class="num" id="6347518">12</span>&nbsp;<span class="op" id="6347521">:</span>&nbsp;<span class="ident" id="6347523">i</span><span class="op" id="6347524">+</span><span class="num" id="6347525">16</span><span class="op" id="6347527">]</span><span class="op" id="6347528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347532">file</span><span class="op" id="6347536">,</span>&nbsp;<span class="ident" id="6347538">_</span>&nbsp;<span class="op" id="6347540">:=</span>&nbsp;<span class="ident" id="6347543">getString</span><span class="op" id="6347552">(</span><span class="ident" id="6347553">str</span><span class="op" id="6347556">,</span>&nbsp;<span class="builtintype" id="6347558">int</span><span class="op" id="6347561">(</span><span class="ident" id="6347562">fileoff</span><span class="op" id="6347569">)</span><span class="op" id="6347570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347575">var</span>&nbsp;<span class="ident" id="6347579">name</span>&nbsp;<span class="builtintype" id="6347584">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347593">j</span>&nbsp;<span class="op" id="6347595">:=</span>&nbsp;<span class="ident" id="6347598">i</span>&nbsp;<span class="op" id="6347600">+</span>&nbsp;<span class="builtintype" id="6347602">int</span><span class="op" id="6347605">(</span><span class="ident" id="6347606">aux</span><span class="op" id="6347609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347613">for</span>&nbsp;<span class="ident" id="6347617">c</span>&nbsp;<span class="op" id="6347619">:=</span>&nbsp;<span class="num" id="6347622">0</span><span class="op" id="6347623">;</span>&nbsp;<span class="ident" id="6347625">c</span>&nbsp;<span class="op" id="6347627">&lt;</span>&nbsp;<span class="builtintype" id="6347629">int</span><span class="op" id="6347632">(</span><span class="ident" id="6347633">cnt</span><span class="op" id="6347636">)</span><span class="op" id="6347637">;</span>&nbsp;<span class="ident" id="6347639">c</span><span class="op" id="6347640">++</span>&nbsp;<span class="op" id="6347643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347648">if</span>&nbsp;<span class="ident" id="6347651">j</span><span class="op" id="6347652">+</span><span class="num" id="6347653">16</span>&nbsp;<span class="op" id="6347656">&gt;</span>&nbsp;<span class="builtinfunc" id="6347658">len</span><span class="op" id="6347661">(</span><span class="ident" id="6347662">d</span><span class="op" id="6347663">)</span>&nbsp;<span class="op" id="6347665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347671">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6347685">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6347728">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347774">other</span>&nbsp;<span class="op" id="6347780">:=</span>&nbsp;<span class="ident" id="6347783">f</span><span class="op" id="6347784">.</span><span class="ident" id="6347785">ByteOrder</span><span class="op" id="6347794">.</span><span class="ident" id="6347795">Uint16</span><span class="op" id="6347801">(</span><span class="ident" id="6347802">d</span><span class="op" id="6347803">[</span><span class="ident" id="6347804">j</span><span class="op" id="6347805">+</span><span class="num" id="6347806">6</span>&nbsp;<span class="op" id="6347808">:</span>&nbsp;<span class="ident" id="6347810">j</span><span class="op" id="6347811">+</span><span class="num" id="6347812">8</span><span class="op" id="6347813">]</span><span class="op" id="6347814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347819">nameoff</span>&nbsp;<span class="op" id="6347827">:=</span>&nbsp;<span class="ident" id="6347830">f</span><span class="op" id="6347831">.</span><span class="ident" id="6347832">ByteOrder</span><span class="op" id="6347841">.</span><span class="ident" id="6347842">Uint32</span><span class="op" id="6347848">(</span><span class="ident" id="6347849">d</span><span class="op" id="6347850">[</span><span class="ident" id="6347851">j</span><span class="op" id="6347852">+</span><span class="num" id="6347853">8</span>&nbsp;<span class="op" id="6347855">:</span>&nbsp;<span class="ident" id="6347857">j</span><span class="op" id="6347858">+</span><span class="num" id="6347859">12</span><span class="op" id="6347861">]</span><span class="op" id="6347862">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347867">next</span>&nbsp;<span class="op" id="6347872">:=</span>&nbsp;<span class="ident" id="6347875">f</span><span class="op" id="6347876">.</span><span class="ident" id="6347877">ByteOrder</span><span class="op" id="6347886">.</span><span class="ident" id="6347887">Uint32</span><span class="op" id="6347893">(</span><span class="ident" id="6347894">d</span><span class="op" id="6347895">[</span><span class="ident" id="6347896">j</span><span class="op" id="6347897">+</span><span class="num" id="6347898">12</span>&nbsp;<span class="op" id="6347901">:</span>&nbsp;<span class="ident" id="6347903">j</span><span class="op" id="6347904">+</span><span class="num" id="6347905">16</span><span class="op" id="6347907">]</span><span class="op" id="6347908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347913">name</span><span class="op" id="6347917">,</span>&nbsp;<span class="ident" id="6347919">_</span>&nbsp;<span class="op" id="6347921">=</span>&nbsp;<span class="ident" id="6347923">getString</span><span class="op" id="6347932">(</span><span class="ident" id="6347933">str</span><span class="op" id="6347936">,</span>&nbsp;<span class="builtintype" id="6347938">int</span><span class="op" id="6347941">(</span><span class="ident" id="6347942">nameoff</span><span class="op" id="6347949">)</span><span class="op" id="6347950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347955">ndx</span>&nbsp;<span class="op" id="6347959">:=</span>&nbsp;<span class="builtintype" id="6347962">int</span><span class="op" id="6347965">(</span><span class="ident" id="6347966">other</span><span class="op" id="6347971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347976">if</span>&nbsp;<span class="ident" id="6347979">ndx</span>&nbsp;<span class="op" id="6347983">&gt;=</span>&nbsp;<span class="builtinfunc" id="6347986">len</span><span class="op" id="6347989">(</span><span class="ident" id="6347990">need</span><span class="op" id="6347994">)</span>&nbsp;<span class="op" id="6347996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348002">a</span>&nbsp;<span class="op" id="6348004">:=</span>&nbsp;<span class="builtinfunc" id="6348007">make</span><span class="op" id="6348011">(</span><span class="op" id="6348012">[</span><span class="op" id="6348013">]</span><span class="ident" id="6348014">verneed</span><span class="op" id="6348021">,</span>&nbsp;<span class="num" id="6348023">2</span><span class="op" id="6348024">*</span><span class="op" id="6348025">(</span><span class="ident" id="6348026">ndx</span><span class="op" id="6348029">+</span><span class="num" id="6348030">1</span><span class="op" id="6348031">)</span><span class="op" id="6348032">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6348038">copy</span><span class="op" id="6348042">(</span><span class="ident" id="6348043">a</span><span class="op" id="6348044">,</span>&nbsp;<span class="ident" id="6348046">need</span><span class="op" id="6348050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348056">need</span>&nbsp;<span class="op" id="6348061">=</span>&nbsp;<span class="ident" id="6348063">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348074">need</span><span class="op" id="6348078">[</span><span class="ident" id="6348079">ndx</span><span class="op" id="6348082">]</span>&nbsp;<span class="op" id="6348084">=</span>&nbsp;<span class="ident" id="6348086">verneed</span><span class="op" id="6348093">{</span><span class="ident" id="6348094">file</span><span class="op" id="6348098">,</span>&nbsp;<span class="ident" id="6348100">name</span><span class="op" id="6348104">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348109">if</span>&nbsp;<span class="ident" id="6348112">next</span>&nbsp;<span class="op" id="6348117">==</span>&nbsp;<span class="num" id="6348120">0</span>&nbsp;<span class="op" id="6348122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348128">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348142">j</span>&nbsp;<span class="op" id="6348144">+=</span>&nbsp;<span class="builtintype" id="6348147">int</span><span class="op" id="6348150">(</span><span class="ident" id="6348151">next</span><span class="op" id="6348155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348159">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348164">if</span>&nbsp;<span class="ident" id="6348167">next</span>&nbsp;<span class="op" id="6348172">==</span>&nbsp;<span class="num" id="6348175">0</span>&nbsp;<span class="op" id="6348177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348182">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348194">i</span>&nbsp;<span class="op" id="6348196">+=</span>&nbsp;<span class="builtintype" id="6348199">int</span><span class="op" id="6348202">(</span><span class="ident" id="6348203">next</span><span class="op" id="6348207">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6348214">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348272">vs</span>&nbsp;<span class="op" id="6348275">:=</span>&nbsp;<span class="ident" id="6348278">f</span><span class="op" id="6348279">.</span><span class="ident" id="6348280">SectionByType</span><span class="op" id="6348293">(</span><span class="ident" id="6348294">SHT_GNU_VERSYM</span><span class="op" id="6348308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348311">if</span>&nbsp;<span class="ident" id="6348314">vs</span>&nbsp;<span class="op" id="6348317">==</span>&nbsp;<span class="ident" id="6348320">nil</span>&nbsp;<span class="op" id="6348324">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348328">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348339">d</span><span class="op" id="6348340">,</span>&nbsp;<span class="ident" id="6348342">_</span>&nbsp;<span class="op" id="6348344">=</span>&nbsp;<span class="ident" id="6348346">vs</span><span class="op" id="6348348">.</span><span class="ident" id="6348349">Data</span><span class="op" id="6348353">(</span><span class="op" id="6348354">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348358">f</span><span class="op" id="6348359">.</span><span class="ident" id="6348360">gnuNeed</span>&nbsp;<span class="op" id="6348368">=</span>&nbsp;<span class="ident" id="6348370">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348376">f</span><span class="op" id="6348377">.</span><span class="ident" id="6348378">gnuVersym</span>&nbsp;<span class="op" id="6348388">=</span>&nbsp;<span class="ident" id="6348390">d</span><br>
<span class="lineno"></span><span class="op" id="6348392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6348395">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="6348454">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="6348503">func</span>&nbsp;<span class="op" id="6348508">(</span><span class="ident" id="6348509">f</span>&nbsp;<span class="op" id="6348511">*</span><span class="ident" id="6348512">File</span><span class="op" id="6348516">)</span>&nbsp;<span class="ident" id="6348518">gnuVersion</span><span class="op" id="6348528">(</span><span class="ident" id="6348529">i</span>&nbsp;<span class="builtintype" id="6348531">int</span><span class="op" id="6348534">,</span>&nbsp;<span class="ident" id="6348536">sym</span>&nbsp;<span class="op" id="6348540">*</span><span class="ident" id="6348541">ImportedSymbol</span><span class="op" id="6348555">)</span>&nbsp;<span class="op" id="6348557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6348560">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348589">i</span>&nbsp;<span class="op" id="6348591">=</span>&nbsp;<span class="op" id="6348593">(</span><span class="ident" id="6348594">i</span>&nbsp;<span class="op" id="6348596">+</span>&nbsp;<span class="num" id="6348598">1</span><span class="op" id="6348599">)</span>&nbsp;<span class="op" id="6348601">*</span>&nbsp;<span class="num" id="6348603">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348606">if</span>&nbsp;<span class="ident" id="6348609">i</span>&nbsp;<span class="op" id="6348611">&gt;=</span>&nbsp;<span class="builtinfunc" id="6348614">len</span><span class="op" id="6348617">(</span><span class="ident" id="6348618">f</span><span class="op" id="6348619">.</span><span class="ident" id="6348620">gnuVersym</span><span class="op" id="6348629">)</span>&nbsp;<span class="op" id="6348631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348635">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348646">j</span>&nbsp;<span class="op" id="6348648">:=</span>&nbsp;<span class="builtintype" id="6348651">int</span><span class="op" id="6348654">(</span><span class="ident" id="6348655">f</span><span class="op" id="6348656">.</span><span class="ident" id="6348657">ByteOrder</span><span class="op" id="6348666">.</span><span class="ident" id="6348667">Uint16</span><span class="op" id="6348673">(</span><span class="ident" id="6348674">f</span><span class="op" id="6348675">.</span><span class="ident" id="6348676">gnuVersym</span><span class="op" id="6348685">[</span><span class="ident" id="6348686">i</span><span class="op" id="6348687">:</span><span class="op" id="6348688">]</span><span class="op" id="6348689">)</span><span class="op" id="6348690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348693">if</span>&nbsp;<span class="ident" id="6348696">j</span>&nbsp;<span class="op" id="6348698">&lt;</span>&nbsp;<span class="num" id="6348700">2</span>&nbsp;<span class="op" id="6348702">||</span>&nbsp;<span class="ident" id="6348705">j</span>&nbsp;<span class="op" id="6348707">&gt;=</span>&nbsp;<span class="builtinfunc" id="6348710">len</span><span class="op" id="6348713">(</span><span class="ident" id="6348714">f</span><span class="op" id="6348715">.</span><span class="ident" id="6348716">gnuNeed</span><span class="op" id="6348723">)</span>&nbsp;<span class="op" id="6348725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348729">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348737">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348740">n</span>&nbsp;<span class="op" id="6348742">:=</span>&nbsp;<span class="op" id="6348745">&amp;</span><span class="ident" id="6348746">f</span><span class="op" id="6348747">.</span><span class="ident" id="6348748">gnuNeed</span><span class="op" id="6348755">[</span><span class="ident" id="6348756">j</span><span class="op" id="6348757">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348760">sym</span><span class="op" id="6348763">.</span><span class="ident" id="6348764">Library</span>&nbsp;<span class="op" id="6348772">=</span>&nbsp;<span class="ident" id="6348774">n</span><span class="op" id="6348775">.</span><span class="ident" id="6348776">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348782">sym</span><span class="op" id="6348785">.</span><span class="ident" id="6348786">Version</span>&nbsp;<span class="op" id="6348794">=</span>&nbsp;<span class="ident" id="6348796">n</span><span class="op" id="6348797">.</span><span class="ident" id="6348798">Name</span><br>
<span class="lineno"></span><span class="op" id="6348803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="6348806">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="6348862">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6348917">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="6348965">func</span>&nbsp;<span class="op" id="6348970">(</span><span class="ident" id="6348971">f</span>&nbsp;<span class="op" id="6348973">*</span><span class="ident" id="6348974">File</span><span class="op" id="6348978">)</span>&nbsp;<span class="ident" id="6348980">ImportedLibraries</span><span class="op" id="6348997">(</span><span class="op" id="6348998">)</span>&nbsp;<span class="op" id="6349000">(</span><span class="op" id="6349001">[</span><span class="op" id="6349002">]</span><span class="builtintype" id="6349003">string</span><span class="op" id="6349009">,</span>&nbsp;<span class="builtintype" id="6349011">error</span><span class="op" id="6349016">)</span>&nbsp;<span class="op" id="6349018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349021">return</span>&nbsp;<span class="ident" id="6349028">f</span><span class="op" id="6349029">.</span><span class="ident" id="6349030">DynString</span><span class="op" id="6349039">(</span><span class="ident" id="6349040">DT_NEEDED</span><span class="op" id="6349049">)</span><br>
<span class="lineno">905</span><span class="op" id="6349051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6349054">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="6349134">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="6349146">//</span><br>
<span class="lineno">910</span><span class="comment" id="6349149">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6349233">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="6349248">func</span>&nbsp;<span class="op" id="6349253">(</span><span class="ident" id="6349254">f</span>&nbsp;<span class="op" id="6349256">*</span><span class="ident" id="6349257">File</span><span class="op" id="6349261">)</span>&nbsp;<span class="ident" id="6349263">DynString</span><span class="op" id="6349272">(</span><span class="ident" id="6349273">tag</span>&nbsp;<span class="ident" id="6349277">DynTag</span><span class="op" id="6349283">)</span>&nbsp;<span class="op" id="6349285">(</span><span class="op" id="6349286">[</span><span class="op" id="6349287">]</span><span class="builtintype" id="6349288">string</span><span class="op" id="6349294">,</span>&nbsp;<span class="builtintype" id="6349296">error</span><span class="op" id="6349301">)</span>&nbsp;<span class="op" id="6349303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349306">switch</span>&nbsp;<span class="ident" id="6349313">tag</span>&nbsp;<span class="op" id="6349317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349320">case</span>&nbsp;<span class="ident" id="6349325">DT_NEEDED</span><span class="op" id="6349334">,</span>&nbsp;<span class="ident" id="6349336">DT_SONAME</span><span class="op" id="6349345">,</span>&nbsp;<span class="ident" id="6349347">DT_RPATH</span><span class="op" id="6349355">,</span>&nbsp;<span class="ident" id="6349357">DT_RUNPATH</span><span class="op" id="6349367">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349370">default</span><span class="op" id="6349377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349381">return</span>&nbsp;<span class="ident" id="6349388">nil</span><span class="op" id="6349391">,</span>&nbsp;<span class="ident" id="6349393">fmt</span><span class="op" id="6349396">.</span><span class="ident" id="6349397">Errorf</span><span class="op" id="6349403">(</span><span class="string" id="6349404">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="6349430">,</span>&nbsp;<span class="ident" id="6349432">tag</span><span class="op" id="6349435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349441">ds</span>&nbsp;<span class="op" id="6349444">:=</span>&nbsp;<span class="ident" id="6349447">f</span><span class="op" id="6349448">.</span><span class="ident" id="6349449">SectionByType</span><span class="op" id="6349462">(</span><span class="ident" id="6349463">SHT_DYNAMIC</span><span class="op" id="6349474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349477">if</span>&nbsp;<span class="ident" id="6349480">ds</span>&nbsp;<span class="op" id="6349483">==</span>&nbsp;<span class="ident" id="6349486">nil</span>&nbsp;<span class="op" id="6349490">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6349494">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349528">return</span>&nbsp;<span class="ident" id="6349535">nil</span><span class="op" id="6349538">,</span>&nbsp;<span class="ident" id="6349540">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349548">d</span><span class="op" id="6349549">,</span>&nbsp;<span class="ident" id="6349551">err</span>&nbsp;<span class="op" id="6349555">:=</span>&nbsp;<span class="ident" id="6349558">ds</span><span class="op" id="6349560">.</span><span class="ident" id="6349561">Data</span><span class="op" id="6349565">(</span><span class="op" id="6349566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349569">if</span>&nbsp;<span class="ident" id="6349572">err</span>&nbsp;<span class="op" id="6349576">!=</span>&nbsp;<span class="ident" id="6349579">nil</span>&nbsp;<span class="op" id="6349583">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349587">return</span>&nbsp;<span class="ident" id="6349594">nil</span><span class="op" id="6349597">,</span>&nbsp;<span class="ident" id="6349599">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349607">str</span><span class="op" id="6349610">,</span>&nbsp;<span class="ident" id="6349612">err</span>&nbsp;<span class="op" id="6349616">:=</span>&nbsp;<span class="ident" id="6349619">f</span><span class="op" id="6349620">.</span><span class="ident" id="6349621">stringTable</span><span class="op" id="6349632">(</span><span class="ident" id="6349633">ds</span><span class="op" id="6349635">.</span><span class="ident" id="6349636">Link</span><span class="op" id="6349640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349643">if</span>&nbsp;<span class="ident" id="6349646">err</span>&nbsp;<span class="op" id="6349650">!=</span>&nbsp;<span class="ident" id="6349653">nil</span>&nbsp;<span class="op" id="6349657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349661">return</span>&nbsp;<span class="ident" id="6349668">nil</span><span class="op" id="6349671">,</span>&nbsp;<span class="ident" id="6349673">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349681">var</span>&nbsp;<span class="ident" id="6349685">all</span>&nbsp;<span class="op" id="6349689">[</span><span class="op" id="6349690">]</span><span class="builtintype" id="6349691">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349699">for</span>&nbsp;<span class="builtinfunc" id="6349703">len</span><span class="op" id="6349706">(</span><span class="ident" id="6349707">d</span><span class="op" id="6349708">)</span>&nbsp;<span class="op" id="6349710">&gt;</span>&nbsp;<span class="num" id="6349712">0</span>&nbsp;<span class="op" id="6349714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349718">var</span>&nbsp;<span class="ident" id="6349722">t</span>&nbsp;<span class="ident" id="6349724">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349733">var</span>&nbsp;<span class="ident" id="6349737">v</span>&nbsp;<span class="ident" id="6349739">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349748">switch</span>&nbsp;<span class="ident" id="6349755">f</span><span class="op" id="6349756">.</span><span class="ident" id="6349757">Class</span>&nbsp;<span class="op" id="6349763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349767">case</span>&nbsp;<span class="ident" id="6349772">ELFCLASS32</span><span class="op" id="6349782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349787">t</span>&nbsp;<span class="op" id="6349789">=</span>&nbsp;<span class="ident" id="6349791">DynTag</span><span class="op" id="6349797">(</span><span class="ident" id="6349798">f</span><span class="op" id="6349799">.</span><span class="ident" id="6349800">ByteOrder</span><span class="op" id="6349809">.</span><span class="ident" id="6349810">Uint32</span><span class="op" id="6349816">(</span><span class="ident" id="6349817">d</span><span class="op" id="6349818">[</span><span class="num" id="6349819">0</span><span class="op" id="6349820">:</span><span class="num" id="6349821">4</span><span class="op" id="6349822">]</span><span class="op" id="6349823">)</span><span class="op" id="6349824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349829">v</span>&nbsp;<span class="op" id="6349831">=</span>&nbsp;<span class="ident" id="6349833">uint64</span><span class="op" id="6349839">(</span><span class="ident" id="6349840">f</span><span class="op" id="6349841">.</span><span class="ident" id="6349842">ByteOrder</span><span class="op" id="6349851">.</span><span class="ident" id="6349852">Uint32</span><span class="op" id="6349858">(</span><span class="ident" id="6349859">d</span><span class="op" id="6349860">[</span><span class="num" id="6349861">4</span><span class="op" id="6349862">:</span><span class="num" id="6349863">8</span><span class="op" id="6349864">]</span><span class="op" id="6349865">)</span><span class="op" id="6349866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349871">d</span>&nbsp;<span class="op" id="6349873">=</span>&nbsp;<span class="ident" id="6349875">d</span><span class="op" id="6349876">[</span><span class="num" id="6349877">8</span><span class="op" id="6349878">:</span><span class="op" id="6349879">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349883">case</span>&nbsp;<span class="ident" id="6349888">ELFCLASS64</span><span class="op" id="6349898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349903">t</span>&nbsp;<span class="op" id="6349905">=</span>&nbsp;<span class="ident" id="6349907">DynTag</span><span class="op" id="6349913">(</span><span class="ident" id="6349914">f</span><span class="op" id="6349915">.</span><span class="ident" id="6349916">ByteOrder</span><span class="op" id="6349925">.</span><span class="ident" id="6349926">Uint64</span><span class="op" id="6349932">(</span><span class="ident" id="6349933">d</span><span class="op" id="6349934">[</span><span class="num" id="6349935">0</span><span class="op" id="6349936">:</span><span class="num" id="6349937">8</span><span class="op" id="6349938">]</span><span class="op" id="6349939">)</span><span class="op" id="6349940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349945">v</span>&nbsp;<span class="op" id="6349947">=</span>&nbsp;<span class="ident" id="6349949">f</span><span class="op" id="6349950">.</span><span class="ident" id="6349951">ByteOrder</span><span class="op" id="6349960">.</span><span class="ident" id="6349961">Uint64</span><span class="op" id="6349967">(</span><span class="ident" id="6349968">d</span><span class="op" id="6349969">[</span><span class="num" id="6349970">8</span><span class="op" id="6349971">:</span><span class="num" id="6349972">16</span><span class="op" id="6349974">]</span><span class="op" id="6349975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6349980">d</span>&nbsp;<span class="op" id="6349982">=</span>&nbsp;<span class="ident" id="6349984">d</span><span class="op" id="6349985">[</span><span class="num" id="6349986">16</span><span class="op" id="6349988">:</span><span class="op" id="6349989">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6349993">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349997">if</span>&nbsp;<span class="ident" id="6350000">t</span>&nbsp;<span class="op" id="6350002">==</span>&nbsp;<span class="ident" id="6350005">tag</span>&nbsp;<span class="op" id="6350009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6350014">s</span><span class="op" id="6350015">,</span>&nbsp;<span class="ident" id="6350017">ok</span>&nbsp;<span class="op" id="6350020">:=</span>&nbsp;<span class="ident" id="6350023">getString</span><span class="op" id="6350032">(</span><span class="ident" id="6350033">str</span><span class="op" id="6350036">,</span>&nbsp;<span class="builtintype" id="6350038">int</span><span class="op" id="6350041">(</span><span class="ident" id="6350042">v</span><span class="op" id="6350043">)</span><span class="op" id="6350044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350049">if</span>&nbsp;<span class="ident" id="6350052">ok</span>&nbsp;<span class="op" id="6350055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6350061">all</span>&nbsp;<span class="op" id="6350065">=</span>&nbsp;<span class="builtinfunc" id="6350067">append</span><span class="op" id="6350073">(</span><span class="ident" id="6350074">all</span><span class="op" id="6350077">,</span>&nbsp;<span class="ident" id="6350079">s</span><span class="op" id="6350080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350085">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6350092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6350095">return</span>&nbsp;<span class="ident" id="6350102">all</span><span class="op" id="6350105">,</span>&nbsp;<span class="ident" id="6350107">nil</span><br>
<span class="lineno"></span><span class="op" id="6350111">}</span>
</div>
</body>
</html>
