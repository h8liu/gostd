<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2032196">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2032251">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2032305">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2032356">//go:generate&nbsp;go&nbsp;run&nbsp;makeisprint.go&nbsp;-output&nbsp;isprint.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2032412">package</span>&nbsp;<span class="ident" id="2032420">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2032429">import</span>&nbsp;<span class="op" id="2032436">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2032439">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2032454">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2032457">const</span>&nbsp;<span class="ident" id="2032463">lowerhex</span>&nbsp;<span class="op" id="2032472">=</span>&nbsp;<span class="string" id="2032474">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2032494">func</span>&nbsp;<span class="ident" id="2032499">quoteWith</span><span class="op" id="2032508">(</span><span class="ident" id="2032509">s</span>&nbsp;<span class="builtintype" id="2032511">string</span><span class="op" id="2032517">,</span>&nbsp;<span class="ident" id="2032519">quote</span>&nbsp;<span class="builtintype" id="2032525">byte</span><span class="op" id="2032529">,</span>&nbsp;<span class="ident" id="2032531">ASCIIonly</span>&nbsp;<span class="builtintype" id="2032541">bool</span><span class="op" id="2032545">)</span>&nbsp;<span class="builtintype" id="2032547">string</span>&nbsp;<span class="op" id="2032554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2032557">var</span>&nbsp;<span class="ident" id="2032561">runeTmp</span>&nbsp;<span class="op" id="2032569">[</span><span class="ident" id="2032570">utf8</span><span class="op" id="2032574">.</span><span class="ident" id="2032575">UTFMax</span><span class="op" id="2032581">]</span><span class="builtintype" id="2032582">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2032588">buf</span>&nbsp;<span class="op" id="2032592">:=</span>&nbsp;<span class="builtinfunc" id="2032595">make</span><span class="op" id="2032599">(</span><span class="op" id="2032600">[</span><span class="op" id="2032601">]</span><span class="builtintype" id="2032602">byte</span><span class="op" id="2032606">,</span>&nbsp;<span class="num" id="2032608">0</span><span class="op" id="2032609">,</span>&nbsp;<span class="num" id="2032611">3</span><span class="op" id="2032612">*</span><span class="builtinfunc" id="2032613">len</span><span class="op" id="2032616">(</span><span class="ident" id="2032617">s</span><span class="op" id="2032618">)</span><span class="op" id="2032619">/</span><span class="num" id="2032620">2</span><span class="op" id="2032621">)</span>&nbsp;<span class="comment" id="2032623">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2032658">buf</span>&nbsp;<span class="op" id="2032662">=</span>&nbsp;<span class="builtinfunc" id="2032664">append</span><span class="op" id="2032670">(</span><span class="ident" id="2032671">buf</span><span class="op" id="2032674">,</span>&nbsp;<span class="ident" id="2032676">quote</span><span class="op" id="2032681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2032684">for</span>&nbsp;<span class="ident" id="2032688">width</span>&nbsp;<span class="op" id="2032694">:=</span>&nbsp;<span class="num" id="2032697">0</span><span class="op" id="2032698">;</span>&nbsp;<span class="builtinfunc" id="2032700">len</span><span class="op" id="2032703">(</span><span class="ident" id="2032704">s</span><span class="op" id="2032705">)</span>&nbsp;<span class="op" id="2032707">&gt;</span>&nbsp;<span class="num" id="2032709">0</span><span class="op" id="2032710">;</span>&nbsp;<span class="ident" id="2032712">s</span>&nbsp;<span class="op" id="2032714">=</span>&nbsp;<span class="ident" id="2032716">s</span><span class="op" id="2032717">[</span><span class="ident" id="2032718">width</span><span class="op" id="2032723">:</span><span class="op" id="2032724">]</span>&nbsp;<span class="op" id="2032726">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2032730">r</span>&nbsp;<span class="op" id="2032732">:=</span>&nbsp;<span class="builtintype" id="2032735">rune</span><span class="op" id="2032739">(</span><span class="ident" id="2032740">s</span><span class="op" id="2032741">[</span><span class="num" id="2032742">0</span><span class="op" id="2032743">]</span><span class="op" id="2032744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2032748">width</span>&nbsp;<span class="op" id="2032754">=</span>&nbsp;<span class="num" id="2032756">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2032760">if</span>&nbsp;<span class="ident" id="2032763">r</span>&nbsp;<span class="op" id="2032765">&gt;=</span>&nbsp;<span class="ident" id="2032768">utf8</span><span class="op" id="2032772">.</span><span class="ident" id="2032773">RuneSelf</span>&nbsp;<span class="op" id="2032782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2032787">r</span><span class="op" id="2032788">,</span>&nbsp;<span class="ident" id="2032790">width</span>&nbsp;<span class="op" id="2032796">=</span>&nbsp;<span class="ident" id="2032798">utf8</span><span class="op" id="2032802">.</span><span class="ident" id="2032803">DecodeRuneInString</span><span class="op" id="2032821">(</span><span class="ident" id="2032822">s</span><span class="op" id="2032823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2032827">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2032831">if</span>&nbsp;<span class="ident" id="2032834">width</span>&nbsp;<span class="op" id="2032840">==</span>&nbsp;<span class="num" id="2032843">1</span>&nbsp;<span class="op" id="2032845">&amp;&amp;</span>&nbsp;<span class="ident" id="2032848">r</span>&nbsp;<span class="op" id="2032850">==</span>&nbsp;<span class="ident" id="2032853">utf8</span><span class="op" id="2032857">.</span><span class="ident" id="2032858">RuneError</span>&nbsp;<span class="op" id="2032868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2032873">buf</span>&nbsp;<span class="op" id="2032877">=</span>&nbsp;<span class="builtinfunc" id="2032879">append</span><span class="op" id="2032885">(</span><span class="ident" id="2032886">buf</span><span class="op" id="2032889">,</span>&nbsp;<span class="string" id="2032891">`\x`</span><span class="op" id="2032895">...</span><span class="op" id="2032898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2032903">buf</span>&nbsp;<span class="op" id="2032907">=</span>&nbsp;<span class="builtinfunc" id="2032909">append</span><span class="op" id="2032915">(</span><span class="ident" id="2032916">buf</span><span class="op" id="2032919">,</span>&nbsp;<span class="ident" id="2032921">lowerhex</span><span class="op" id="2032929">[</span><span class="ident" id="2032930">s</span><span class="op" id="2032931">[</span><span class="num" id="2032932">0</span><span class="op" id="2032933">]</span><span class="op" id="2032934">&gt;&gt;</span><span class="num" id="2032936">4</span><span class="op" id="2032937">]</span><span class="op" id="2032938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2032943">buf</span>&nbsp;<span class="op" id="2032947">=</span>&nbsp;<span class="builtinfunc" id="2032949">append</span><span class="op" id="2032955">(</span><span class="ident" id="2032956">buf</span><span class="op" id="2032959">,</span>&nbsp;<span class="ident" id="2032961">lowerhex</span><span class="op" id="2032969">[</span><span class="ident" id="2032970">s</span><span class="op" id="2032971">[</span><span class="num" id="2032972">0</span><span class="op" id="2032973">]</span><span class="op" id="2032974">&amp;</span><span class="num" id="2032975">0xF</span><span class="op" id="2032978">]</span><span class="op" id="2032979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2032984">continue</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2032995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2032999">if</span>&nbsp;<span class="ident" id="2033002">r</span>&nbsp;<span class="op" id="2033004">==</span>&nbsp;<span class="builtintype" id="2033007">rune</span><span class="op" id="2033011">(</span><span class="ident" id="2033012">quote</span><span class="op" id="2033017">)</span>&nbsp;<span class="op" id="2033019">||</span>&nbsp;<span class="ident" id="2033022">r</span>&nbsp;<span class="op" id="2033024">==</span>&nbsp;<span class="string" id="2033027">&#39;\\&#39;</span>&nbsp;<span class="op" id="2033032">{</span>&nbsp;<span class="comment" id="2033034">//&nbsp;always&nbsp;backslashed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033059">buf</span>&nbsp;<span class="op" id="2033063">=</span>&nbsp;<span class="builtinfunc" id="2033065">append</span><span class="op" id="2033071">(</span><span class="ident" id="2033072">buf</span><span class="op" id="2033075">,</span>&nbsp;<span class="string" id="2033077">&#39;\\&#39;</span><span class="op" id="2033081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033086">buf</span>&nbsp;<span class="op" id="2033090">=</span>&nbsp;<span class="builtinfunc" id="2033092">append</span><span class="op" id="2033098">(</span><span class="ident" id="2033099">buf</span><span class="op" id="2033102">,</span>&nbsp;<span class="builtintype" id="2033104">byte</span><span class="op" id="2033108">(</span><span class="ident" id="2033109">r</span><span class="op" id="2033110">)</span><span class="op" id="2033111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033116">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2033127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033131">if</span>&nbsp;<span class="ident" id="2033134">ASCIIonly</span>&nbsp;<span class="op" id="2033144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033149">if</span>&nbsp;<span class="ident" id="2033152">r</span>&nbsp;<span class="op" id="2033154">&lt;</span>&nbsp;<span class="ident" id="2033156">utf8</span><span class="op" id="2033160">.</span><span class="ident" id="2033161">RuneSelf</span>&nbsp;<span class="op" id="2033170">&amp;&amp;</span>&nbsp;<span class="ident" id="2033173">IsPrint</span><span class="op" id="2033180">(</span><span class="ident" id="2033181">r</span><span class="op" id="2033182">)</span>&nbsp;<span class="op" id="2033184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033190">buf</span>&nbsp;<span class="op" id="2033194">=</span>&nbsp;<span class="builtinfunc" id="2033196">append</span><span class="op" id="2033202">(</span><span class="ident" id="2033203">buf</span><span class="op" id="2033206">,</span>&nbsp;<span class="builtintype" id="2033208">byte</span><span class="op" id="2033212">(</span><span class="ident" id="2033213">r</span><span class="op" id="2033214">)</span><span class="op" id="2033215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033221">continue</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2033233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2033237">}</span>&nbsp;<span class="keyword" id="2033239">else</span>&nbsp;<span class="keyword" id="2033244">if</span>&nbsp;<span class="ident" id="2033247">IsPrint</span><span class="op" id="2033254">(</span><span class="ident" id="2033255">r</span><span class="op" id="2033256">)</span>&nbsp;<span class="op" id="2033258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033263">n</span>&nbsp;<span class="op" id="2033265">:=</span>&nbsp;<span class="ident" id="2033268">utf8</span><span class="op" id="2033272">.</span><span class="ident" id="2033273">EncodeRune</span><span class="op" id="2033283">(</span><span class="ident" id="2033284">runeTmp</span><span class="op" id="2033291">[</span><span class="op" id="2033292">:</span><span class="op" id="2033293">]</span><span class="op" id="2033294">,</span>&nbsp;<span class="ident" id="2033296">r</span><span class="op" id="2033297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033302">buf</span>&nbsp;<span class="op" id="2033306">=</span>&nbsp;<span class="builtinfunc" id="2033308">append</span><span class="op" id="2033314">(</span><span class="ident" id="2033315">buf</span><span class="op" id="2033318">,</span>&nbsp;<span class="ident" id="2033320">runeTmp</span><span class="op" id="2033327">[</span><span class="op" id="2033328">:</span><span class="ident" id="2033329">n</span><span class="op" id="2033330">]</span><span class="op" id="2033331">...</span><span class="op" id="2033334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033339">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2033350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033354">switch</span>&nbsp;<span class="ident" id="2033361">r</span>&nbsp;<span class="op" id="2033363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033367">case</span>&nbsp;<span class="string" id="2033372">&#39;\a&#39;</span><span class="op" id="2033376">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033381">buf</span>&nbsp;<span class="op" id="2033385">=</span>&nbsp;<span class="builtinfunc" id="2033387">append</span><span class="op" id="2033393">(</span><span class="ident" id="2033394">buf</span><span class="op" id="2033397">,</span>&nbsp;<span class="string" id="2033399">`\a`</span><span class="op" id="2033403">...</span><span class="op" id="2033406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033410">case</span>&nbsp;<span class="string" id="2033415">&#39;\b&#39;</span><span class="op" id="2033419">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033424">buf</span>&nbsp;<span class="op" id="2033428">=</span>&nbsp;<span class="builtinfunc" id="2033430">append</span><span class="op" id="2033436">(</span><span class="ident" id="2033437">buf</span><span class="op" id="2033440">,</span>&nbsp;<span class="string" id="2033442">`\b`</span><span class="op" id="2033446">...</span><span class="op" id="2033449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033453">case</span>&nbsp;<span class="string" id="2033458">&#39;\f&#39;</span><span class="op" id="2033462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033467">buf</span>&nbsp;<span class="op" id="2033471">=</span>&nbsp;<span class="builtinfunc" id="2033473">append</span><span class="op" id="2033479">(</span><span class="ident" id="2033480">buf</span><span class="op" id="2033483">,</span>&nbsp;<span class="string" id="2033485">`\f`</span><span class="op" id="2033489">...</span><span class="op" id="2033492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033496">case</span>&nbsp;<span class="string" id="2033501">&#39;\n&#39;</span><span class="op" id="2033505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033510">buf</span>&nbsp;<span class="op" id="2033514">=</span>&nbsp;<span class="builtinfunc" id="2033516">append</span><span class="op" id="2033522">(</span><span class="ident" id="2033523">buf</span><span class="op" id="2033526">,</span>&nbsp;<span class="string" id="2033528">`\n`</span><span class="op" id="2033532">...</span><span class="op" id="2033535">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033539">case</span>&nbsp;<span class="string" id="2033544">&#39;\r&#39;</span><span class="op" id="2033548">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033553">buf</span>&nbsp;<span class="op" id="2033557">=</span>&nbsp;<span class="builtinfunc" id="2033559">append</span><span class="op" id="2033565">(</span><span class="ident" id="2033566">buf</span><span class="op" id="2033569">,</span>&nbsp;<span class="string" id="2033571">`\r`</span><span class="op" id="2033575">...</span><span class="op" id="2033578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033582">case</span>&nbsp;<span class="string" id="2033587">&#39;\t&#39;</span><span class="op" id="2033591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033596">buf</span>&nbsp;<span class="op" id="2033600">=</span>&nbsp;<span class="builtinfunc" id="2033602">append</span><span class="op" id="2033608">(</span><span class="ident" id="2033609">buf</span><span class="op" id="2033612">,</span>&nbsp;<span class="string" id="2033614">`\t`</span><span class="op" id="2033618">...</span><span class="op" id="2033621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033625">case</span>&nbsp;<span class="string" id="2033630">&#39;\v&#39;</span><span class="op" id="2033634">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033639">buf</span>&nbsp;<span class="op" id="2033643">=</span>&nbsp;<span class="builtinfunc" id="2033645">append</span><span class="op" id="2033651">(</span><span class="ident" id="2033652">buf</span><span class="op" id="2033655">,</span>&nbsp;<span class="string" id="2033657">`\v`</span><span class="op" id="2033661">...</span><span class="op" id="2033664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033668">default</span><span class="op" id="2033675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033680">switch</span>&nbsp;<span class="op" id="2033687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033692">case</span>&nbsp;<span class="ident" id="2033697">r</span>&nbsp;<span class="op" id="2033699">&lt;</span>&nbsp;<span class="string" id="2033701">&#39;&nbsp;&#39;</span><span class="op" id="2033704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033710">buf</span>&nbsp;<span class="op" id="2033714">=</span>&nbsp;<span class="builtinfunc" id="2033716">append</span><span class="op" id="2033722">(</span><span class="ident" id="2033723">buf</span><span class="op" id="2033726">,</span>&nbsp;<span class="string" id="2033728">`\x`</span><span class="op" id="2033732">...</span><span class="op" id="2033735">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033741">buf</span>&nbsp;<span class="op" id="2033745">=</span>&nbsp;<span class="builtinfunc" id="2033747">append</span><span class="op" id="2033753">(</span><span class="ident" id="2033754">buf</span><span class="op" id="2033757">,</span>&nbsp;<span class="ident" id="2033759">lowerhex</span><span class="op" id="2033767">[</span><span class="ident" id="2033768">s</span><span class="op" id="2033769">[</span><span class="num" id="2033770">0</span><span class="op" id="2033771">]</span><span class="op" id="2033772">&gt;&gt;</span><span class="num" id="2033774">4</span><span class="op" id="2033775">]</span><span class="op" id="2033776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033782">buf</span>&nbsp;<span class="op" id="2033786">=</span>&nbsp;<span class="builtinfunc" id="2033788">append</span><span class="op" id="2033794">(</span><span class="ident" id="2033795">buf</span><span class="op" id="2033798">,</span>&nbsp;<span class="ident" id="2033800">lowerhex</span><span class="op" id="2033808">[</span><span class="ident" id="2033809">s</span><span class="op" id="2033810">[</span><span class="num" id="2033811">0</span><span class="op" id="2033812">]</span><span class="op" id="2033813">&amp;</span><span class="num" id="2033814">0xF</span><span class="op" id="2033817">]</span><span class="op" id="2033818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033823">case</span>&nbsp;<span class="ident" id="2033828">r</span>&nbsp;<span class="op" id="2033830">&gt;</span>&nbsp;<span class="ident" id="2033832">utf8</span><span class="op" id="2033836">.</span><span class="ident" id="2033837">MaxRune</span><span class="op" id="2033844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033850">r</span>&nbsp;<span class="op" id="2033852">=</span>&nbsp;<span class="num" id="2033854">0xFFFD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033865">fallthrough</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033880">case</span>&nbsp;<span class="ident" id="2033885">r</span>&nbsp;<span class="op" id="2033887">&lt;</span>&nbsp;<span class="num" id="2033889">0x10000</span><span class="op" id="2033896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033902">buf</span>&nbsp;<span class="op" id="2033906">=</span>&nbsp;<span class="builtinfunc" id="2033908">append</span><span class="op" id="2033914">(</span><span class="ident" id="2033915">buf</span><span class="op" id="2033918">,</span>&nbsp;<span class="string" id="2033920">`\u`</span><span class="op" id="2033924">...</span><span class="op" id="2033927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2033933">for</span>&nbsp;<span class="ident" id="2033937">s</span>&nbsp;<span class="op" id="2033939">:=</span>&nbsp;<span class="num" id="2033942">12</span><span class="op" id="2033944">;</span>&nbsp;<span class="ident" id="2033946">s</span>&nbsp;<span class="op" id="2033948">&gt;=</span>&nbsp;<span class="num" id="2033951">0</span><span class="op" id="2033952">;</span>&nbsp;<span class="ident" id="2033954">s</span>&nbsp;<span class="op" id="2033956">-=</span>&nbsp;<span class="num" id="2033959">4</span>&nbsp;<span class="op" id="2033961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2033968">buf</span>&nbsp;<span class="op" id="2033972">=</span>&nbsp;<span class="builtinfunc" id="2033974">append</span><span class="op" id="2033980">(</span><span class="ident" id="2033981">buf</span><span class="op" id="2033984">,</span>&nbsp;<span class="ident" id="2033986">lowerhex</span><span class="op" id="2033994">[</span><span class="ident" id="2033995">r</span><span class="op" id="2033996">&gt;&gt;</span><span class="builtintype" id="2033998">uint</span><span class="op" id="2034002">(</span><span class="ident" id="2034003">s</span><span class="op" id="2034004">)</span><span class="op" id="2034005">&amp;</span><span class="num" id="2034006">0xF</span><span class="op" id="2034009">]</span><span class="op" id="2034010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2034016">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2034021">default</span><span class="op" id="2034028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2034034">buf</span>&nbsp;<span class="op" id="2034038">=</span>&nbsp;<span class="builtinfunc" id="2034040">append</span><span class="op" id="2034046">(</span><span class="ident" id="2034047">buf</span><span class="op" id="2034050">,</span>&nbsp;<span class="string" id="2034052">`\U`</span><span class="op" id="2034056">...</span><span class="op" id="2034059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2034065">for</span>&nbsp;<span class="ident" id="2034069">s</span>&nbsp;<span class="op" id="2034071">:=</span>&nbsp;<span class="num" id="2034074">28</span><span class="op" id="2034076">;</span>&nbsp;<span class="ident" id="2034078">s</span>&nbsp;<span class="op" id="2034080">&gt;=</span>&nbsp;<span class="num" id="2034083">0</span><span class="op" id="2034084">;</span>&nbsp;<span class="ident" id="2034086">s</span>&nbsp;<span class="op" id="2034088">-=</span>&nbsp;<span class="num" id="2034091">4</span>&nbsp;<span class="op" id="2034093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2034100">buf</span>&nbsp;<span class="op" id="2034104">=</span>&nbsp;<span class="builtinfunc" id="2034106">append</span><span class="op" id="2034112">(</span><span class="ident" id="2034113">buf</span><span class="op" id="2034116">,</span>&nbsp;<span class="ident" id="2034118">lowerhex</span><span class="op" id="2034126">[</span><span class="ident" id="2034127">r</span><span class="op" id="2034128">&gt;&gt;</span><span class="builtintype" id="2034130">uint</span><span class="op" id="2034134">(</span><span class="ident" id="2034135">s</span><span class="op" id="2034136">)</span><span class="op" id="2034137">&amp;</span><span class="num" id="2034138">0xF</span><span class="op" id="2034141">]</span><span class="op" id="2034142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2034148">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2034153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2034157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2034160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2034163">buf</span>&nbsp;<span class="op" id="2034167">=</span>&nbsp;<span class="builtinfunc" id="2034169">append</span><span class="op" id="2034175">(</span><span class="ident" id="2034176">buf</span><span class="op" id="2034179">,</span>&nbsp;<span class="ident" id="2034181">quote</span><span class="op" id="2034186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2034189">return</span>&nbsp;<span class="builtintype" id="2034196">string</span><span class="op" id="2034202">(</span><span class="ident" id="2034203">buf</span><span class="op" id="2034206">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="op" id="2034209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2034212">//&nbsp;Quote&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.&nbsp;&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2034284">//&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno">90</span><span class="comment" id="2034355">//&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2034420">//&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2034432">func</span>&nbsp;<span class="ident" id="2034437">Quote</span><span class="op" id="2034442">(</span><span class="ident" id="2034443">s</span>&nbsp;<span class="builtintype" id="2034445">string</span><span class="op" id="2034451">)</span>&nbsp;<span class="builtintype" id="2034453">string</span>&nbsp;<span class="op" id="2034460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2034463">return</span>&nbsp;<span class="ident" id="2034470">quoteWith</span><span class="op" id="2034479">(</span><span class="ident" id="2034480">s</span><span class="op" id="2034481">,</span>&nbsp;<span class="string" id="2034483">&#39;&#34;&#39;</span><span class="op" id="2034486">,</span>&nbsp;<span class="builtintype" id="2034488">false</span><span class="op" id="2034493">)</span><br>
<span class="lineno"></span><span class="op" id="2034495">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="2034498">//&nbsp;AppendQuote&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno"></span><span class="comment" id="2034571">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;Quote,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2034637">func</span>&nbsp;<span class="ident" id="2034642">AppendQuote</span><span class="op" id="2034653">(</span><span class="ident" id="2034654">dst</span>&nbsp;<span class="op" id="2034658">[</span><span class="op" id="2034659">]</span><span class="builtintype" id="2034660">byte</span><span class="op" id="2034664">,</span>&nbsp;<span class="ident" id="2034666">s</span>&nbsp;<span class="builtintype" id="2034668">string</span><span class="op" id="2034674">)</span>&nbsp;<span class="op" id="2034676">[</span><span class="op" id="2034677">]</span><span class="builtintype" id="2034678">byte</span>&nbsp;<span class="op" id="2034683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2034686">return</span>&nbsp;<span class="builtinfunc" id="2034693">append</span><span class="op" id="2034699">(</span><span class="ident" id="2034700">dst</span><span class="op" id="2034703">,</span>&nbsp;<span class="ident" id="2034705">Quote</span><span class="op" id="2034710">(</span><span class="ident" id="2034711">s</span><span class="op" id="2034712">)</span><span class="op" id="2034713">...</span><span class="op" id="2034716">)</span><br>
<span class="lineno">100</span><span class="op" id="2034718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2034721">//&nbsp;QuoteToASCII&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2034795">//&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2034870">//&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno">105</span><span class="keyword" id="2034946">func</span>&nbsp;<span class="ident" id="2034951">QuoteToASCII</span><span class="op" id="2034963">(</span><span class="ident" id="2034964">s</span>&nbsp;<span class="builtintype" id="2034966">string</span><span class="op" id="2034972">)</span>&nbsp;<span class="builtintype" id="2034974">string</span>&nbsp;<span class="op" id="2034981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2034984">return</span>&nbsp;<span class="ident" id="2034991">quoteWith</span><span class="op" id="2035000">(</span><span class="ident" id="2035001">s</span><span class="op" id="2035002">,</span>&nbsp;<span class="string" id="2035004">&#39;&#34;&#39;</span><span class="op" id="2035007">,</span>&nbsp;<span class="builtintype" id="2035009">true</span><span class="op" id="2035013">)</span><br>
<span class="lineno"></span><span class="op" id="2035015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2035018">//&nbsp;AppendQuoteToASCII&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno">110</span><span class="comment" id="2035098">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2035171">func</span>&nbsp;<span class="ident" id="2035176">AppendQuoteToASCII</span><span class="op" id="2035194">(</span><span class="ident" id="2035195">dst</span>&nbsp;<span class="op" id="2035199">[</span><span class="op" id="2035200">]</span><span class="builtintype" id="2035201">byte</span><span class="op" id="2035205">,</span>&nbsp;<span class="ident" id="2035207">s</span>&nbsp;<span class="builtintype" id="2035209">string</span><span class="op" id="2035215">)</span>&nbsp;<span class="op" id="2035217">[</span><span class="op" id="2035218">]</span><span class="builtintype" id="2035219">byte</span>&nbsp;<span class="op" id="2035224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2035227">return</span>&nbsp;<span class="builtinfunc" id="2035234">append</span><span class="op" id="2035240">(</span><span class="ident" id="2035241">dst</span><span class="op" id="2035244">,</span>&nbsp;<span class="ident" id="2035246">QuoteToASCII</span><span class="op" id="2035258">(</span><span class="ident" id="2035259">s</span><span class="op" id="2035260">)</span><span class="op" id="2035261">...</span><span class="op" id="2035264">)</span><br>
<span class="lineno"></span><span class="op" id="2035266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="2035269">//&nbsp;QuoteRune&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2035344">//&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)</span><br>
<span class="lineno"></span><span class="comment" id="2035422">//&nbsp;for&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2035500">func</span>&nbsp;<span class="ident" id="2035505">QuoteRune</span><span class="op" id="2035514">(</span><span class="ident" id="2035515">r</span>&nbsp;<span class="builtintype" id="2035517">rune</span><span class="op" id="2035521">)</span>&nbsp;<span class="builtintype" id="2035523">string</span>&nbsp;<span class="op" id="2035530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2035533">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2035570">return</span>&nbsp;<span class="ident" id="2035577">quoteWith</span><span class="op" id="2035586">(</span><span class="builtintype" id="2035587">string</span><span class="op" id="2035593">(</span><span class="ident" id="2035594">r</span><span class="op" id="2035595">)</span><span class="op" id="2035596">,</span>&nbsp;<span class="string" id="2035598">&#39;\&#39;&#39;</span><span class="op" id="2035602">,</span>&nbsp;<span class="builtintype" id="2035604">false</span><span class="op" id="2035609">)</span><br>
<span class="lineno"></span><span class="op" id="2035611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2035614">//&nbsp;AppendQuoteRune&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2035701">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRune,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">125</span><span class="keyword" id="2035771">func</span>&nbsp;<span class="ident" id="2035776">AppendQuoteRune</span><span class="op" id="2035791">(</span><span class="ident" id="2035792">dst</span>&nbsp;<span class="op" id="2035796">[</span><span class="op" id="2035797">]</span><span class="builtintype" id="2035798">byte</span><span class="op" id="2035802">,</span>&nbsp;<span class="ident" id="2035804">r</span>&nbsp;<span class="builtintype" id="2035806">rune</span><span class="op" id="2035810">)</span>&nbsp;<span class="op" id="2035812">[</span><span class="op" id="2035813">]</span><span class="builtintype" id="2035814">byte</span>&nbsp;<span class="op" id="2035819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2035822">return</span>&nbsp;<span class="builtinfunc" id="2035829">append</span><span class="op" id="2035835">(</span><span class="ident" id="2035836">dst</span><span class="op" id="2035839">,</span>&nbsp;<span class="ident" id="2035841">QuoteRune</span><span class="op" id="2035850">(</span><span class="ident" id="2035851">r</span><span class="op" id="2035852">)</span><span class="op" id="2035853">...</span><span class="op" id="2035856">)</span><br>
<span class="lineno"></span><span class="op" id="2035858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2035861">//&nbsp;QuoteRuneToASCII&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing</span><br>
<span class="lineno">130</span><span class="comment" id="2035939">//&nbsp;the&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,</span><br>
<span class="lineno"></span><span class="comment" id="2036013">//&nbsp;\u0100)&nbsp;for&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="2036089">//&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2036104">func</span>&nbsp;<span class="ident" id="2036109">QuoteRuneToASCII</span><span class="op" id="2036125">(</span><span class="ident" id="2036126">r</span>&nbsp;<span class="builtintype" id="2036128">rune</span><span class="op" id="2036132">)</span>&nbsp;<span class="builtintype" id="2036134">string</span>&nbsp;<span class="op" id="2036141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2036144">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2036181">return</span>&nbsp;<span class="ident" id="2036188">quoteWith</span><span class="op" id="2036197">(</span><span class="builtintype" id="2036198">string</span><span class="op" id="2036204">(</span><span class="ident" id="2036205">r</span><span class="op" id="2036206">)</span><span class="op" id="2036207">,</span>&nbsp;<span class="string" id="2036209">&#39;\&#39;&#39;</span><span class="op" id="2036213">,</span>&nbsp;<span class="builtintype" id="2036215">true</span><span class="op" id="2036219">)</span><br>
<span class="lineno"></span><span class="op" id="2036221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2036224">//&nbsp;AppendQuoteRuneToASCII&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2036318">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRuneToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">140</span><span class="keyword" id="2036395">func</span>&nbsp;<span class="ident" id="2036400">AppendQuoteRuneToASCII</span><span class="op" id="2036422">(</span><span class="ident" id="2036423">dst</span>&nbsp;<span class="op" id="2036427">[</span><span class="op" id="2036428">]</span><span class="builtintype" id="2036429">byte</span><span class="op" id="2036433">,</span>&nbsp;<span class="ident" id="2036435">r</span>&nbsp;<span class="builtintype" id="2036437">rune</span><span class="op" id="2036441">)</span>&nbsp;<span class="op" id="2036443">[</span><span class="op" id="2036444">]</span><span class="builtintype" id="2036445">byte</span>&nbsp;<span class="op" id="2036450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2036453">return</span>&nbsp;<span class="builtinfunc" id="2036460">append</span><span class="op" id="2036466">(</span><span class="ident" id="2036467">dst</span><span class="op" id="2036470">,</span>&nbsp;<span class="ident" id="2036472">QuoteRuneToASCII</span><span class="op" id="2036488">(</span><span class="ident" id="2036489">r</span><span class="op" id="2036490">)</span><span class="op" id="2036491">...</span><span class="op" id="2036494">)</span><br>
<span class="lineno"></span><span class="op" id="2036496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2036499">//&nbsp;CanBackquote&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;represented</span><br>
<span class="lineno">145</span><span class="comment" id="2036563">//&nbsp;unchanged&nbsp;as&nbsp;a&nbsp;single-line&nbsp;backquoted&nbsp;string&nbsp;without&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="2036627">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;tab.</span><br>
<span class="lineno"></span><span class="keyword" id="2036657">func</span>&nbsp;<span class="ident" id="2036662">CanBackquote</span><span class="op" id="2036674">(</span><span class="ident" id="2036675">s</span>&nbsp;<span class="builtintype" id="2036677">string</span><span class="op" id="2036683">)</span>&nbsp;<span class="builtintype" id="2036685">bool</span>&nbsp;<span class="op" id="2036690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2036693">for</span>&nbsp;<span class="builtinfunc" id="2036697">len</span><span class="op" id="2036700">(</span><span class="ident" id="2036701">s</span><span class="op" id="2036702">)</span>&nbsp;<span class="op" id="2036704">&gt;</span>&nbsp;<span class="num" id="2036706">0</span>&nbsp;<span class="op" id="2036708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2036712">r</span><span class="op" id="2036713">,</span>&nbsp;<span class="ident" id="2036715">wid</span>&nbsp;<span class="op" id="2036719">:=</span>&nbsp;<span class="ident" id="2036722">utf8</span><span class="op" id="2036726">.</span><span class="ident" id="2036727">DecodeRuneInString</span><span class="op" id="2036745">(</span><span class="ident" id="2036746">s</span><span class="op" id="2036747">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2036751">s</span>&nbsp;<span class="op" id="2036753">=</span>&nbsp;<span class="ident" id="2036755">s</span><span class="op" id="2036756">[</span><span class="ident" id="2036757">wid</span><span class="op" id="2036760">:</span><span class="op" id="2036761">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2036765">if</span>&nbsp;<span class="ident" id="2036768">wid</span>&nbsp;<span class="op" id="2036772">&gt;</span>&nbsp;<span class="num" id="2036774">1</span>&nbsp;<span class="op" id="2036776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2036781">if</span>&nbsp;<span class="ident" id="2036784">r</span>&nbsp;<span class="op" id="2036786">==</span>&nbsp;<span class="string" id="2036789">&#39;\ufeff&#39;</span>&nbsp;<span class="op" id="2036798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2036804">return</span>&nbsp;<span class="builtintype" id="2036811">false</span>&nbsp;<span class="comment" id="2036817">//&nbsp;BOMs&nbsp;are&nbsp;invisible&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2036868">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2036873">continue</span>&nbsp;<span class="comment" id="2036882">//&nbsp;All&nbsp;other&nbsp;multibyte&nbsp;runes&nbsp;are&nbsp;correctly&nbsp;encoded&nbsp;and&nbsp;assumed&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2036958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2036962">if</span>&nbsp;<span class="ident" id="2036965">r</span>&nbsp;<span class="op" id="2036967">==</span>&nbsp;<span class="ident" id="2036970">utf8</span><span class="op" id="2036974">.</span><span class="ident" id="2036975">RuneError</span>&nbsp;<span class="op" id="2036985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2036990">return</span>&nbsp;<span class="builtintype" id="2036997">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2037005">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037009">if</span>&nbsp;<span class="op" id="2037012">(</span><span class="ident" id="2037013">r</span>&nbsp;<span class="op" id="2037015">&lt;</span>&nbsp;<span class="string" id="2037017">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2037021">&amp;&amp;</span>&nbsp;<span class="ident" id="2037024">r</span>&nbsp;<span class="op" id="2037026">!=</span>&nbsp;<span class="string" id="2037029">&#39;\t&#39;</span><span class="op" id="2037033">)</span>&nbsp;<span class="op" id="2037035">||</span>&nbsp;<span class="ident" id="2037038">r</span>&nbsp;<span class="op" id="2037040">==</span>&nbsp;<span class="string" id="2037043">&#39;`&#39;</span>&nbsp;<span class="op" id="2037047">||</span>&nbsp;<span class="ident" id="2037050">r</span>&nbsp;<span class="op" id="2037052">==</span>&nbsp;<span class="string" id="2037055">&#39;\u007F&#39;</span>&nbsp;<span class="op" id="2037064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037069">return</span>&nbsp;<span class="builtintype" id="2037076">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2037084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2037087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037090">return</span>&nbsp;<span class="builtintype" id="2037097">true</span><br>
<span class="lineno">165</span><span class="op" id="2037102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2037105">func</span>&nbsp;<span class="ident" id="2037110">unhex</span><span class="op" id="2037115">(</span><span class="ident" id="2037116">b</span>&nbsp;<span class="builtintype" id="2037118">byte</span><span class="op" id="2037122">)</span>&nbsp;<span class="op" id="2037124">(</span><span class="ident" id="2037125">v</span>&nbsp;<span class="builtintype" id="2037127">rune</span><span class="op" id="2037131">,</span>&nbsp;<span class="ident" id="2037133">ok</span>&nbsp;<span class="builtintype" id="2037136">bool</span><span class="op" id="2037140">)</span>&nbsp;<span class="op" id="2037142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2037145">c</span>&nbsp;<span class="op" id="2037147">:=</span>&nbsp;<span class="builtintype" id="2037150">rune</span><span class="op" id="2037154">(</span><span class="ident" id="2037155">b</span><span class="op" id="2037156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037159">switch</span>&nbsp;<span class="op" id="2037166">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037169">case</span>&nbsp;<span class="string" id="2037174">&#39;0&#39;</span>&nbsp;<span class="op" id="2037178">&lt;=</span>&nbsp;<span class="ident" id="2037181">c</span>&nbsp;<span class="op" id="2037183">&amp;&amp;</span>&nbsp;<span class="ident" id="2037186">c</span>&nbsp;<span class="op" id="2037188">&lt;=</span>&nbsp;<span class="string" id="2037191">&#39;9&#39;</span><span class="op" id="2037194">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037198">return</span>&nbsp;<span class="ident" id="2037205">c</span>&nbsp;<span class="op" id="2037207">-</span>&nbsp;<span class="string" id="2037209">&#39;0&#39;</span><span class="op" id="2037212">,</span>&nbsp;<span class="builtintype" id="2037214">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037220">case</span>&nbsp;<span class="string" id="2037225">&#39;a&#39;</span>&nbsp;<span class="op" id="2037229">&lt;=</span>&nbsp;<span class="ident" id="2037232">c</span>&nbsp;<span class="op" id="2037234">&amp;&amp;</span>&nbsp;<span class="ident" id="2037237">c</span>&nbsp;<span class="op" id="2037239">&lt;=</span>&nbsp;<span class="string" id="2037242">&#39;f&#39;</span><span class="op" id="2037245">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037249">return</span>&nbsp;<span class="ident" id="2037256">c</span>&nbsp;<span class="op" id="2037258">-</span>&nbsp;<span class="string" id="2037260">&#39;a&#39;</span>&nbsp;<span class="op" id="2037264">+</span>&nbsp;<span class="num" id="2037266">10</span><span class="op" id="2037268">,</span>&nbsp;<span class="builtintype" id="2037270">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037276">case</span>&nbsp;<span class="string" id="2037281">&#39;A&#39;</span>&nbsp;<span class="op" id="2037285">&lt;=</span>&nbsp;<span class="ident" id="2037288">c</span>&nbsp;<span class="op" id="2037290">&amp;&amp;</span>&nbsp;<span class="ident" id="2037293">c</span>&nbsp;<span class="op" id="2037295">&lt;=</span>&nbsp;<span class="string" id="2037298">&#39;F&#39;</span><span class="op" id="2037301">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037305">return</span>&nbsp;<span class="ident" id="2037312">c</span>&nbsp;<span class="op" id="2037314">-</span>&nbsp;<span class="string" id="2037316">&#39;A&#39;</span>&nbsp;<span class="op" id="2037320">+</span>&nbsp;<span class="num" id="2037322">10</span><span class="op" id="2037324">,</span>&nbsp;<span class="builtintype" id="2037326">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2037332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2037335">return</span><br>
<span class="lineno"></span><span class="op" id="2037342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2037345">//&nbsp;UnquoteChar&nbsp;decodes&nbsp;the&nbsp;first&nbsp;character&nbsp;or&nbsp;byte&nbsp;in&nbsp;the&nbsp;escaped&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2037418">//&nbsp;or&nbsp;character&nbsp;literal&nbsp;represented&nbsp;by&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2037471">//&nbsp;It&nbsp;returns&nbsp;four&nbsp;values:</span><br>
<span class="lineno"></span><span class="comment" id="2037498">//</span><br>
<span class="lineno"></span><span class="comment" id="2037501">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;value,&nbsp;the&nbsp;decoded&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;byte&nbsp;value;</span><br>
<span class="lineno">185</span><span class="comment" id="2037560">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;multibyte,&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;decoded&nbsp;character&nbsp;requires&nbsp;a&nbsp;multibyte&nbsp;UTF-8&nbsp;representation;</span><br>
<span class="lineno"></span><span class="comment" id="2037671">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;tail,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string&nbsp;after&nbsp;the&nbsp;character;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2037736">//&nbsp;&nbsp;&nbsp;&nbsp4)&nbsp;an&nbsp;error&nbsp;that&nbsp;will&nbsp;be&nbsp;nil&nbsp;if&nbsp;the&nbsp;character&nbsp;is&nbsp;syntactically&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="2037809">//</span><br>
<span class="lineno"></span><span class="comment" id="2037812">//&nbsp;The&nbsp;second&nbsp;argument,&nbsp;quote,&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;literal&nbsp;being&nbsp;parsed</span><br>
<span class="lineno">190</span><span class="comment" id="2037886">//&nbsp;and&nbsp;therefore&nbsp;which&nbsp;escaped&nbsp;quote&nbsp;character&nbsp;is&nbsp;permitted.</span><br>
<span class="lineno"></span><span class="comment" id="2037947">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;single&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;the&nbsp;sequence&nbsp;\&#39;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="2038030">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;double&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;\&#34;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2038100">//&nbsp;If&nbsp;set&nbsp;to&nbsp;zero,&nbsp;it&nbsp;does&nbsp;not&nbsp;permit&nbsp;either&nbsp;escape&nbsp;and&nbsp;allows&nbsp;both&nbsp;quote&nbsp;characters&nbsp;to&nbsp;appear&nbsp;unescaped.</span><br>
<span class="lineno"></span><span class="keyword" id="2038206">func</span>&nbsp;<span class="ident" id="2038211">UnquoteChar</span><span class="op" id="2038222">(</span><span class="ident" id="2038223">s</span>&nbsp;<span class="builtintype" id="2038225">string</span><span class="op" id="2038231">,</span>&nbsp;<span class="ident" id="2038233">quote</span>&nbsp;<span class="builtintype" id="2038239">byte</span><span class="op" id="2038243">)</span>&nbsp;<span class="op" id="2038245">(</span><span class="ident" id="2038246">value</span>&nbsp;<span class="builtintype" id="2038252">rune</span><span class="op" id="2038256">,</span>&nbsp;<span class="ident" id="2038258">multibyte</span>&nbsp;<span class="builtintype" id="2038268">bool</span><span class="op" id="2038272">,</span>&nbsp;<span class="ident" id="2038274">tail</span>&nbsp;<span class="builtintype" id="2038279">string</span><span class="op" id="2038285">,</span>&nbsp;<span class="ident" id="2038287">err</span>&nbsp;<span class="builtintype" id="2038291">error</span><span class="op" id="2038296">)</span>&nbsp;<span class="op" id="2038298">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2038301">//&nbsp;easy&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038316">switch</span>&nbsp;<span class="ident" id="2038323">c</span>&nbsp;<span class="op" id="2038325">:=</span>&nbsp;<span class="ident" id="2038328">s</span><span class="op" id="2038329">[</span><span class="num" id="2038330">0</span><span class="op" id="2038331">]</span><span class="op" id="2038332">;</span>&nbsp;<span class="op" id="2038334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038337">case</span>&nbsp;<span class="ident" id="2038342">c</span>&nbsp;<span class="op" id="2038344">==</span>&nbsp;<span class="ident" id="2038347">quote</span>&nbsp;<span class="op" id="2038353">&amp;&amp;</span>&nbsp;<span class="op" id="2038356">(</span><span class="ident" id="2038357">quote</span>&nbsp;<span class="op" id="2038363">==</span>&nbsp;<span class="string" id="2038366">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2038371">||</span>&nbsp;<span class="ident" id="2038374">quote</span>&nbsp;<span class="op" id="2038380">==</span>&nbsp;<span class="string" id="2038383">&#39;&#34;&#39;</span><span class="op" id="2038386">)</span><span class="op" id="2038387">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038391">err</span>&nbsp;<span class="op" id="2038395">=</span>&nbsp;<span class="ident" id="2038397">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038409">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038417">case</span>&nbsp;<span class="ident" id="2038422">c</span>&nbsp;<span class="op" id="2038424">&gt;=</span>&nbsp;<span class="ident" id="2038427">utf8</span><span class="op" id="2038431">.</span><span class="ident" id="2038432">RuneSelf</span><span class="op" id="2038440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038444">r</span><span class="op" id="2038445">,</span>&nbsp;<span class="ident" id="2038447">size</span>&nbsp;<span class="op" id="2038452">:=</span>&nbsp;<span class="ident" id="2038455">utf8</span><span class="op" id="2038459">.</span><span class="ident" id="2038460">DecodeRuneInString</span><span class="op" id="2038478">(</span><span class="ident" id="2038479">s</span><span class="op" id="2038480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038484">return</span>&nbsp;<span class="ident" id="2038491">r</span><span class="op" id="2038492">,</span>&nbsp;<span class="builtintype" id="2038494">true</span><span class="op" id="2038498">,</span>&nbsp;<span class="ident" id="2038500">s</span><span class="op" id="2038501">[</span><span class="ident" id="2038502">size</span><span class="op" id="2038506">:</span><span class="op" id="2038507">]</span><span class="op" id="2038508">,</span>&nbsp;<span class="ident" id="2038510">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038515">case</span>&nbsp;<span class="ident" id="2038520">c</span>&nbsp;<span class="op" id="2038522">!=</span>&nbsp;<span class="string" id="2038525">&#39;\\&#39;</span><span class="op" id="2038529">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038533">return</span>&nbsp;<span class="builtintype" id="2038540">rune</span><span class="op" id="2038544">(</span><span class="ident" id="2038545">s</span><span class="op" id="2038546">[</span><span class="num" id="2038547">0</span><span class="op" id="2038548">]</span><span class="op" id="2038549">)</span><span class="op" id="2038550">,</span>&nbsp;<span class="builtintype" id="2038552">false</span><span class="op" id="2038557">,</span>&nbsp;<span class="ident" id="2038559">s</span><span class="op" id="2038560">[</span><span class="num" id="2038561">1</span><span class="op" id="2038562">:</span><span class="op" id="2038563">]</span><span class="op" id="2038564">,</span>&nbsp;<span class="ident" id="2038566">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2038571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2038575">//&nbsp;hard&nbsp;case:&nbsp;c&nbsp;is&nbsp;backslash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038605">if</span>&nbsp;<span class="builtinfunc" id="2038608">len</span><span class="op" id="2038611">(</span><span class="ident" id="2038612">s</span><span class="op" id="2038613">)</span>&nbsp;<span class="op" id="2038615">&lt;=</span>&nbsp;<span class="num" id="2038618">1</span>&nbsp;<span class="op" id="2038620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038624">err</span>&nbsp;<span class="op" id="2038628">=</span>&nbsp;<span class="ident" id="2038630">ErrSyntax</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038642">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2038650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038653">c</span>&nbsp;<span class="op" id="2038655">:=</span>&nbsp;<span class="ident" id="2038658">s</span><span class="op" id="2038659">[</span><span class="num" id="2038660">1</span><span class="op" id="2038661">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038664">s</span>&nbsp;<span class="op" id="2038666">=</span>&nbsp;<span class="ident" id="2038668">s</span><span class="op" id="2038669">[</span><span class="num" id="2038670">2</span><span class="op" id="2038671">:</span><span class="op" id="2038672">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038676">switch</span>&nbsp;<span class="ident" id="2038683">c</span>&nbsp;<span class="op" id="2038685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038688">case</span>&nbsp;<span class="string" id="2038693">&#39;a&#39;</span><span class="op" id="2038696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038700">value</span>&nbsp;<span class="op" id="2038706">=</span>&nbsp;<span class="string" id="2038708">&#39;\a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038714">case</span>&nbsp;<span class="string" id="2038719">&#39;b&#39;</span><span class="op" id="2038722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038726">value</span>&nbsp;<span class="op" id="2038732">=</span>&nbsp;<span class="string" id="2038734">&#39;\b&#39;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038740">case</span>&nbsp;<span class="string" id="2038745">&#39;f&#39;</span><span class="op" id="2038748">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038752">value</span>&nbsp;<span class="op" id="2038758">=</span>&nbsp;<span class="string" id="2038760">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038766">case</span>&nbsp;<span class="string" id="2038771">&#39;n&#39;</span><span class="op" id="2038774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038778">value</span>&nbsp;<span class="op" id="2038784">=</span>&nbsp;<span class="string" id="2038786">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038792">case</span>&nbsp;<span class="string" id="2038797">&#39;r&#39;</span><span class="op" id="2038800">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038804">value</span>&nbsp;<span class="op" id="2038810">=</span>&nbsp;<span class="string" id="2038812">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038818">case</span>&nbsp;<span class="string" id="2038823">&#39;t&#39;</span><span class="op" id="2038826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038830">value</span>&nbsp;<span class="op" id="2038836">=</span>&nbsp;<span class="string" id="2038838">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038844">case</span>&nbsp;<span class="string" id="2038849">&#39;v&#39;</span><span class="op" id="2038852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038856">value</span>&nbsp;<span class="op" id="2038862">=</span>&nbsp;<span class="string" id="2038864">&#39;\v&#39;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038870">case</span>&nbsp;<span class="string" id="2038875">&#39;x&#39;</span><span class="op" id="2038878">,</span>&nbsp;<span class="string" id="2038880">&#39;u&#39;</span><span class="op" id="2038883">,</span>&nbsp;<span class="string" id="2038885">&#39;U&#39;</span><span class="op" id="2038888">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038892">n</span>&nbsp;<span class="op" id="2038894">:=</span>&nbsp;<span class="num" id="2038897">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038901">switch</span>&nbsp;<span class="ident" id="2038908">c</span>&nbsp;<span class="op" id="2038910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038914">case</span>&nbsp;<span class="string" id="2038919">&#39;x&#39;</span><span class="op" id="2038922">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038927">n</span>&nbsp;<span class="op" id="2038929">=</span>&nbsp;<span class="num" id="2038931">2</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038935">case</span>&nbsp;<span class="string" id="2038940">&#39;u&#39;</span><span class="op" id="2038943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038948">n</span>&nbsp;<span class="op" id="2038950">=</span>&nbsp;<span class="num" id="2038952">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038956">case</span>&nbsp;<span class="string" id="2038961">&#39;U&#39;</span><span class="op" id="2038964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2038969">n</span>&nbsp;<span class="op" id="2038971">=</span>&nbsp;<span class="num" id="2038973">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2038977">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038981">var</span>&nbsp;<span class="ident" id="2038985">v</span>&nbsp;<span class="builtintype" id="2038987">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2038994">if</span>&nbsp;<span class="builtinfunc" id="2038997">len</span><span class="op" id="2039000">(</span><span class="ident" id="2039001">s</span><span class="op" id="2039002">)</span>&nbsp;<span class="op" id="2039004">&lt;</span>&nbsp;<span class="ident" id="2039006">n</span>&nbsp;<span class="op" id="2039008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039013">err</span>&nbsp;<span class="op" id="2039017">=</span>&nbsp;<span class="ident" id="2039019">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039032">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039041">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039045">for</span>&nbsp;<span class="ident" id="2039049">j</span>&nbsp;<span class="op" id="2039051">:=</span>&nbsp;<span class="num" id="2039054">0</span><span class="op" id="2039055">;</span>&nbsp;<span class="ident" id="2039057">j</span>&nbsp;<span class="op" id="2039059">&lt;</span>&nbsp;<span class="ident" id="2039061">n</span><span class="op" id="2039062">;</span>&nbsp;<span class="ident" id="2039064">j</span><span class="op" id="2039065">++</span>&nbsp;<span class="op" id="2039068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039073">x</span><span class="op" id="2039074">,</span>&nbsp;<span class="ident" id="2039076">ok</span>&nbsp;<span class="op" id="2039079">:=</span>&nbsp;<span class="ident" id="2039082">unhex</span><span class="op" id="2039087">(</span><span class="ident" id="2039088">s</span><span class="op" id="2039089">[</span><span class="ident" id="2039090">j</span><span class="op" id="2039091">]</span><span class="op" id="2039092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039097">if</span>&nbsp;<span class="op" id="2039100">!</span><span class="ident" id="2039101">ok</span>&nbsp;<span class="op" id="2039104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039110">err</span>&nbsp;<span class="op" id="2039114">=</span>&nbsp;<span class="ident" id="2039116">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039130">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039145">v</span>&nbsp;<span class="op" id="2039147">=</span>&nbsp;<span class="ident" id="2039149">v</span><span class="op" id="2039150">&lt;&lt;</span><span class="num" id="2039152">4</span>&nbsp;<span class="op" id="2039154">|</span>&nbsp;<span class="ident" id="2039156">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039164">s</span>&nbsp;<span class="op" id="2039166">=</span>&nbsp;<span class="ident" id="2039168">s</span><span class="op" id="2039169">[</span><span class="ident" id="2039170">n</span><span class="op" id="2039171">:</span><span class="op" id="2039172">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039176">if</span>&nbsp;<span class="ident" id="2039179">c</span>&nbsp;<span class="op" id="2039181">==</span>&nbsp;<span class="string" id="2039184">&#39;x&#39;</span>&nbsp;<span class="op" id="2039188">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2039193">//&nbsp;single-byte&nbsp;string,&nbsp;possibly&nbsp;not&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039238">value</span>&nbsp;<span class="op" id="2039244">=</span>&nbsp;<span class="ident" id="2039246">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039251">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039263">if</span>&nbsp;<span class="ident" id="2039266">v</span>&nbsp;<span class="op" id="2039268">&gt;</span>&nbsp;<span class="ident" id="2039270">utf8</span><span class="op" id="2039274">.</span><span class="ident" id="2039275">MaxRune</span>&nbsp;<span class="op" id="2039283">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039288">err</span>&nbsp;<span class="op" id="2039292">=</span>&nbsp;<span class="ident" id="2039294">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039307">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039320">value</span>&nbsp;<span class="op" id="2039326">=</span>&nbsp;<span class="ident" id="2039328">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039332">multibyte</span>&nbsp;<span class="op" id="2039342">=</span>&nbsp;<span class="builtintype" id="2039344">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039350">case</span>&nbsp;<span class="string" id="2039355">&#39;0&#39;</span><span class="op" id="2039358">,</span>&nbsp;<span class="string" id="2039360">&#39;1&#39;</span><span class="op" id="2039363">,</span>&nbsp;<span class="string" id="2039365">&#39;2&#39;</span><span class="op" id="2039368">,</span>&nbsp;<span class="string" id="2039370">&#39;3&#39;</span><span class="op" id="2039373">,</span>&nbsp;<span class="string" id="2039375">&#39;4&#39;</span><span class="op" id="2039378">,</span>&nbsp;<span class="string" id="2039380">&#39;5&#39;</span><span class="op" id="2039383">,</span>&nbsp;<span class="string" id="2039385">&#39;6&#39;</span><span class="op" id="2039388">,</span>&nbsp;<span class="string" id="2039390">&#39;7&#39;</span><span class="op" id="2039393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039397">v</span>&nbsp;<span class="op" id="2039399">:=</span>&nbsp;<span class="builtintype" id="2039402">rune</span><span class="op" id="2039406">(</span><span class="ident" id="2039407">c</span><span class="op" id="2039408">)</span>&nbsp;<span class="op" id="2039410">-</span>&nbsp;<span class="string" id="2039412">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039418">if</span>&nbsp;<span class="builtinfunc" id="2039421">len</span><span class="op" id="2039424">(</span><span class="ident" id="2039425">s</span><span class="op" id="2039426">)</span>&nbsp;<span class="op" id="2039428">&lt;</span>&nbsp;<span class="num" id="2039430">2</span>&nbsp;<span class="op" id="2039432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039437">err</span>&nbsp;<span class="op" id="2039441">=</span>&nbsp;<span class="ident" id="2039443">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039456">return</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039469">for</span>&nbsp;<span class="ident" id="2039473">j</span>&nbsp;<span class="op" id="2039475">:=</span>&nbsp;<span class="num" id="2039478">0</span><span class="op" id="2039479">;</span>&nbsp;<span class="ident" id="2039481">j</span>&nbsp;<span class="op" id="2039483">&lt;</span>&nbsp;<span class="num" id="2039485">2</span><span class="op" id="2039486">;</span>&nbsp;<span class="ident" id="2039488">j</span><span class="op" id="2039489">++</span>&nbsp;<span class="op" id="2039492">{</span>&nbsp;<span class="comment" id="2039494">//&nbsp;one&nbsp;digit&nbsp;already;&nbsp;two&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039528">x</span>&nbsp;<span class="op" id="2039530">:=</span>&nbsp;<span class="builtintype" id="2039533">rune</span><span class="op" id="2039537">(</span><span class="ident" id="2039538">s</span><span class="op" id="2039539">[</span><span class="ident" id="2039540">j</span><span class="op" id="2039541">]</span><span class="op" id="2039542">)</span>&nbsp;<span class="op" id="2039544">-</span>&nbsp;<span class="string" id="2039546">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039553">if</span>&nbsp;<span class="ident" id="2039556">x</span>&nbsp;<span class="op" id="2039558">&lt;</span>&nbsp;<span class="num" id="2039560">0</span>&nbsp;<span class="op" id="2039562">||</span>&nbsp;<span class="ident" id="2039565">x</span>&nbsp;<span class="op" id="2039567">&gt;</span>&nbsp;<span class="num" id="2039569">7</span>&nbsp;<span class="op" id="2039571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039577">err</span>&nbsp;<span class="op" id="2039581">=</span>&nbsp;<span class="ident" id="2039583">ErrSyntax</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039597">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039612">v</span>&nbsp;<span class="op" id="2039614">=</span>&nbsp;<span class="op" id="2039616">(</span><span class="ident" id="2039617">v</span>&nbsp;<span class="op" id="2039619">&lt;&lt;</span>&nbsp;<span class="num" id="2039622">3</span><span class="op" id="2039623">)</span>&nbsp;<span class="op" id="2039625">|</span>&nbsp;<span class="ident" id="2039627">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039635">s</span>&nbsp;<span class="op" id="2039637">=</span>&nbsp;<span class="ident" id="2039639">s</span><span class="op" id="2039640">[</span><span class="num" id="2039641">2</span><span class="op" id="2039642">:</span><span class="op" id="2039643">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039647">if</span>&nbsp;<span class="ident" id="2039650">v</span>&nbsp;<span class="op" id="2039652">&gt;</span>&nbsp;<span class="num" id="2039654">255</span>&nbsp;<span class="op" id="2039658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039663">err</span>&nbsp;<span class="op" id="2039667">=</span>&nbsp;<span class="ident" id="2039669">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039682">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039695">value</span>&nbsp;<span class="op" id="2039701">=</span>&nbsp;<span class="ident" id="2039703">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039706">case</span>&nbsp;<span class="string" id="2039711">&#39;\\&#39;</span><span class="op" id="2039715">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039719">value</span>&nbsp;<span class="op" id="2039725">=</span>&nbsp;<span class="string" id="2039727">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039733">case</span>&nbsp;<span class="string" id="2039738">&#39;\&#39;&#39;</span><span class="op" id="2039742">,</span>&nbsp;<span class="string" id="2039744">&#39;&#34;&#39;</span><span class="op" id="2039747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039751">if</span>&nbsp;<span class="ident" id="2039754">c</span>&nbsp;<span class="op" id="2039756">!=</span>&nbsp;<span class="ident" id="2039759">quote</span>&nbsp;<span class="op" id="2039765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039770">err</span>&nbsp;<span class="op" id="2039774">=</span>&nbsp;<span class="ident" id="2039776">ErrSyntax</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039789">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039802">value</span>&nbsp;<span class="op" id="2039808">=</span>&nbsp;<span class="builtintype" id="2039810">rune</span><span class="op" id="2039814">(</span><span class="ident" id="2039815">c</span><span class="op" id="2039816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039819">default</span><span class="op" id="2039826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039830">err</span>&nbsp;<span class="op" id="2039834">=</span>&nbsp;<span class="ident" id="2039836">ErrSyntax</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039848">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2039856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2039859">tail</span>&nbsp;<span class="op" id="2039864">=</span>&nbsp;<span class="ident" id="2039866">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2039869">return</span><br>
<span class="lineno"></span><span class="op" id="2039876">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2039879">//&nbsp;Unquote&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;double-quoted,</span><br>
<span class="lineno"></span><span class="comment" id="2039938">//&nbsp;or&nbsp;backquoted&nbsp;Go&nbsp;string&nbsp;literal,&nbsp;returning&nbsp;the&nbsp;string&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2040001">//&nbsp;that&nbsp;s&nbsp;quotes.&nbsp;&nbsp;(If&nbsp;s&nbsp;is&nbsp;single-quoted,&nbsp;it&nbsp;would&nbsp;be&nbsp;a&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="2040061">//&nbsp;character&nbsp;literal;&nbsp;Unquote&nbsp;returns&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno">305</span><span class="comment" id="2040117">//&nbsp;one-character&nbsp;string.)</span><br>
<span class="lineno"></span><span class="keyword" id="2040143">func</span>&nbsp;<span class="ident" id="2040148">Unquote</span><span class="op" id="2040155">(</span><span class="ident" id="2040156">s</span>&nbsp;<span class="builtintype" id="2040158">string</span><span class="op" id="2040164">)</span>&nbsp;<span class="op" id="2040166">(</span><span class="ident" id="2040167">t</span>&nbsp;<span class="builtintype" id="2040169">string</span><span class="op" id="2040175">,</span>&nbsp;<span class="ident" id="2040177">err</span>&nbsp;<span class="builtintype" id="2040181">error</span><span class="op" id="2040186">)</span>&nbsp;<span class="op" id="2040188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2040191">n</span>&nbsp;<span class="op" id="2040193">:=</span>&nbsp;<span class="builtinfunc" id="2040196">len</span><span class="op" id="2040199">(</span><span class="ident" id="2040200">s</span><span class="op" id="2040201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040204">if</span>&nbsp;<span class="ident" id="2040207">n</span>&nbsp;<span class="op" id="2040209">&lt;</span>&nbsp;<span class="num" id="2040211">2</span>&nbsp;<span class="op" id="2040213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040217">return</span>&nbsp;<span class="string" id="2040224">&#34;&#34;</span><span class="op" id="2040226">,</span>&nbsp;<span class="ident" id="2040228">ErrSyntax</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2040239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2040242">quote</span>&nbsp;<span class="op" id="2040248">:=</span>&nbsp;<span class="ident" id="2040251">s</span><span class="op" id="2040252">[</span><span class="num" id="2040253">0</span><span class="op" id="2040254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040257">if</span>&nbsp;<span class="ident" id="2040260">quote</span>&nbsp;<span class="op" id="2040266">!=</span>&nbsp;<span class="ident" id="2040269">s</span><span class="op" id="2040270">[</span><span class="ident" id="2040271">n</span><span class="op" id="2040272">-</span><span class="num" id="2040273">1</span><span class="op" id="2040274">]</span>&nbsp;<span class="op" id="2040276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040280">return</span>&nbsp;<span class="string" id="2040287">&#34;&#34;</span><span class="op" id="2040289">,</span>&nbsp;<span class="ident" id="2040291">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2040302">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2040305">s</span>&nbsp;<span class="op" id="2040307">=</span>&nbsp;<span class="ident" id="2040309">s</span><span class="op" id="2040310">[</span><span class="num" id="2040311">1</span>&nbsp;<span class="op" id="2040313">:</span>&nbsp;<span class="ident" id="2040315">n</span><span class="op" id="2040316">-</span><span class="num" id="2040317">1</span><span class="op" id="2040318">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040322">if</span>&nbsp;<span class="ident" id="2040325">quote</span>&nbsp;<span class="op" id="2040331">==</span>&nbsp;<span class="string" id="2040334">&#39;`&#39;</span>&nbsp;<span class="op" id="2040338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040342">if</span>&nbsp;<span class="ident" id="2040345">contains</span><span class="op" id="2040353">(</span><span class="ident" id="2040354">s</span><span class="op" id="2040355">,</span>&nbsp;<span class="string" id="2040357">&#39;`&#39;</span><span class="op" id="2040360">)</span>&nbsp;<span class="op" id="2040362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040367">return</span>&nbsp;<span class="string" id="2040374">&#34;&#34;</span><span class="op" id="2040376">,</span>&nbsp;<span class="ident" id="2040378">ErrSyntax</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2040390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040394">return</span>&nbsp;<span class="ident" id="2040401">s</span><span class="op" id="2040402">,</span>&nbsp;<span class="ident" id="2040404">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2040409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040412">if</span>&nbsp;<span class="ident" id="2040415">quote</span>&nbsp;<span class="op" id="2040421">!=</span>&nbsp;<span class="string" id="2040424">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2040428">&amp;&amp;</span>&nbsp;<span class="ident" id="2040431">quote</span>&nbsp;<span class="op" id="2040437">!=</span>&nbsp;<span class="string" id="2040440">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2040445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040449">return</span>&nbsp;<span class="string" id="2040456">&#34;&#34;</span><span class="op" id="2040458">,</span>&nbsp;<span class="ident" id="2040460">ErrSyntax</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2040471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040474">if</span>&nbsp;<span class="ident" id="2040477">contains</span><span class="op" id="2040485">(</span><span class="ident" id="2040486">s</span><span class="op" id="2040487">,</span>&nbsp;<span class="string" id="2040489">&#39;\n&#39;</span><span class="op" id="2040493">)</span>&nbsp;<span class="op" id="2040495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040499">return</span>&nbsp;<span class="string" id="2040506">&#34;&#34;</span><span class="op" id="2040508">,</span>&nbsp;<span class="ident" id="2040510">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2040521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2040525">//&nbsp;Is&nbsp;it&nbsp;trivial?&nbsp;&nbsp;Avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040563">if</span>&nbsp;<span class="op" id="2040566">!</span><span class="ident" id="2040567">contains</span><span class="op" id="2040575">(</span><span class="ident" id="2040576">s</span><span class="op" id="2040577">,</span>&nbsp;<span class="string" id="2040579">&#39;\\&#39;</span><span class="op" id="2040583">)</span>&nbsp;<span class="op" id="2040585">&amp;&amp;</span>&nbsp;<span class="op" id="2040588">!</span><span class="ident" id="2040589">contains</span><span class="op" id="2040597">(</span><span class="ident" id="2040598">s</span><span class="op" id="2040599">,</span>&nbsp;<span class="ident" id="2040601">quote</span><span class="op" id="2040606">)</span>&nbsp;<span class="op" id="2040608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040612">switch</span>&nbsp;<span class="ident" id="2040619">quote</span>&nbsp;<span class="op" id="2040625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040629">case</span>&nbsp;<span class="string" id="2040634">&#39;&#34;&#39;</span><span class="op" id="2040637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040642">return</span>&nbsp;<span class="ident" id="2040649">s</span><span class="op" id="2040650">,</span>&nbsp;<span class="ident" id="2040652">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040658">case</span>&nbsp;<span class="string" id="2040663">&#39;\&#39;&#39;</span><span class="op" id="2040667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2040672">r</span><span class="op" id="2040673">,</span>&nbsp;<span class="ident" id="2040675">size</span>&nbsp;<span class="op" id="2040680">:=</span>&nbsp;<span class="ident" id="2040683">utf8</span><span class="op" id="2040687">.</span><span class="ident" id="2040688">DecodeRuneInString</span><span class="op" id="2040706">(</span><span class="ident" id="2040707">s</span><span class="op" id="2040708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040713">if</span>&nbsp;<span class="ident" id="2040716">size</span>&nbsp;<span class="op" id="2040721">==</span>&nbsp;<span class="builtinfunc" id="2040724">len</span><span class="op" id="2040727">(</span><span class="ident" id="2040728">s</span><span class="op" id="2040729">)</span>&nbsp;<span class="op" id="2040731">&amp;&amp;</span>&nbsp;<span class="op" id="2040734">(</span><span class="ident" id="2040735">r</span>&nbsp;<span class="op" id="2040737">!=</span>&nbsp;<span class="ident" id="2040740">utf8</span><span class="op" id="2040744">.</span><span class="ident" id="2040745">RuneError</span>&nbsp;<span class="op" id="2040755">||</span>&nbsp;<span class="ident" id="2040758">size</span>&nbsp;<span class="op" id="2040763">!=</span>&nbsp;<span class="num" id="2040766">1</span><span class="op" id="2040767">)</span>&nbsp;<span class="op" id="2040769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040775">return</span>&nbsp;<span class="ident" id="2040782">s</span><span class="op" id="2040783">,</span>&nbsp;<span class="ident" id="2040785">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2040792">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2040796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2040799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040803">var</span>&nbsp;<span class="ident" id="2040807">runeTmp</span>&nbsp;<span class="op" id="2040815">[</span><span class="ident" id="2040816">utf8</span><span class="op" id="2040820">.</span><span class="ident" id="2040821">UTFMax</span><span class="op" id="2040827">]</span><span class="builtintype" id="2040828">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2040834">buf</span>&nbsp;<span class="op" id="2040838">:=</span>&nbsp;<span class="builtinfunc" id="2040841">make</span><span class="op" id="2040845">(</span><span class="op" id="2040846">[</span><span class="op" id="2040847">]</span><span class="builtintype" id="2040848">byte</span><span class="op" id="2040852">,</span>&nbsp;<span class="num" id="2040854">0</span><span class="op" id="2040855">,</span>&nbsp;<span class="num" id="2040857">3</span><span class="op" id="2040858">*</span><span class="builtinfunc" id="2040859">len</span><span class="op" id="2040862">(</span><span class="ident" id="2040863">s</span><span class="op" id="2040864">)</span><span class="op" id="2040865">/</span><span class="num" id="2040866">2</span><span class="op" id="2040867">)</span>&nbsp;<span class="comment" id="2040869">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040904">for</span>&nbsp;<span class="builtinfunc" id="2040908">len</span><span class="op" id="2040911">(</span><span class="ident" id="2040912">s</span><span class="op" id="2040913">)</span>&nbsp;<span class="op" id="2040915">&gt;</span>&nbsp;<span class="num" id="2040917">0</span>&nbsp;<span class="op" id="2040919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2040923">c</span><span class="op" id="2040924">,</span>&nbsp;<span class="ident" id="2040926">multibyte</span><span class="op" id="2040935">,</span>&nbsp;<span class="ident" id="2040937">ss</span><span class="op" id="2040939">,</span>&nbsp;<span class="ident" id="2040941">err</span>&nbsp;<span class="op" id="2040945">:=</span>&nbsp;<span class="ident" id="2040948">UnquoteChar</span><span class="op" id="2040959">(</span><span class="ident" id="2040960">s</span><span class="op" id="2040961">,</span>&nbsp;<span class="ident" id="2040963">quote</span><span class="op" id="2040968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040972">if</span>&nbsp;<span class="ident" id="2040975">err</span>&nbsp;<span class="op" id="2040979">!=</span>&nbsp;<span class="ident" id="2040982">nil</span>&nbsp;<span class="op" id="2040986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2040991">return</span>&nbsp;<span class="string" id="2040998">&#34;&#34;</span><span class="op" id="2041000">,</span>&nbsp;<span class="ident" id="2041002">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041008">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041012">s</span>&nbsp;<span class="op" id="2041014">=</span>&nbsp;<span class="ident" id="2041016">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041021">if</span>&nbsp;<span class="ident" id="2041024">c</span>&nbsp;<span class="op" id="2041026">&lt;</span>&nbsp;<span class="ident" id="2041028">utf8</span><span class="op" id="2041032">.</span><span class="ident" id="2041033">RuneSelf</span>&nbsp;<span class="op" id="2041042">||</span>&nbsp;<span class="op" id="2041045">!</span><span class="ident" id="2041046">multibyte</span>&nbsp;<span class="op" id="2041056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041061">buf</span>&nbsp;<span class="op" id="2041065">=</span>&nbsp;<span class="builtinfunc" id="2041067">append</span><span class="op" id="2041073">(</span><span class="ident" id="2041074">buf</span><span class="op" id="2041077">,</span>&nbsp;<span class="builtintype" id="2041079">byte</span><span class="op" id="2041083">(</span><span class="ident" id="2041084">c</span><span class="op" id="2041085">)</span><span class="op" id="2041086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041090">}</span>&nbsp;<span class="keyword" id="2041092">else</span>&nbsp;<span class="op" id="2041097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041102">n</span>&nbsp;<span class="op" id="2041104">:=</span>&nbsp;<span class="ident" id="2041107">utf8</span><span class="op" id="2041111">.</span><span class="ident" id="2041112">EncodeRune</span><span class="op" id="2041122">(</span><span class="ident" id="2041123">runeTmp</span><span class="op" id="2041130">[</span><span class="op" id="2041131">:</span><span class="op" id="2041132">]</span><span class="op" id="2041133">,</span>&nbsp;<span class="ident" id="2041135">c</span><span class="op" id="2041136">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041141">buf</span>&nbsp;<span class="op" id="2041145">=</span>&nbsp;<span class="builtinfunc" id="2041147">append</span><span class="op" id="2041153">(</span><span class="ident" id="2041154">buf</span><span class="op" id="2041157">,</span>&nbsp;<span class="ident" id="2041159">runeTmp</span><span class="op" id="2041166">[</span><span class="op" id="2041167">:</span><span class="ident" id="2041168">n</span><span class="op" id="2041169">]</span><span class="op" id="2041170">...</span><span class="op" id="2041173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041181">if</span>&nbsp;<span class="ident" id="2041184">quote</span>&nbsp;<span class="op" id="2041190">==</span>&nbsp;<span class="string" id="2041193">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2041198">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2041201">len</span><span class="op" id="2041204">(</span><span class="ident" id="2041205">s</span><span class="op" id="2041206">)</span>&nbsp;<span class="op" id="2041208">!=</span>&nbsp;<span class="num" id="2041211">0</span>&nbsp;<span class="op" id="2041213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2041218">//&nbsp;single-quoted&nbsp;must&nbsp;be&nbsp;single&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041263">return</span>&nbsp;<span class="string" id="2041270">&#34;&#34;</span><span class="op" id="2041272">,</span>&nbsp;<span class="ident" id="2041274">ErrSyntax</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041292">return</span>&nbsp;<span class="builtintype" id="2041299">string</span><span class="op" id="2041305">(</span><span class="ident" id="2041306">buf</span><span class="op" id="2041309">)</span><span class="op" id="2041310">,</span>&nbsp;<span class="ident" id="2041312">nil</span><br>
<span class="lineno"></span><span class="op" id="2041316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="2041319">//&nbsp;contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;contains&nbsp;the&nbsp;byte&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2041379">func</span>&nbsp;<span class="ident" id="2041384">contains</span><span class="op" id="2041392">(</span><span class="ident" id="2041393">s</span>&nbsp;<span class="builtintype" id="2041395">string</span><span class="op" id="2041401">,</span>&nbsp;<span class="ident" id="2041403">c</span>&nbsp;<span class="builtintype" id="2041405">byte</span><span class="op" id="2041409">)</span>&nbsp;<span class="builtintype" id="2041411">bool</span>&nbsp;<span class="op" id="2041416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041419">for</span>&nbsp;<span class="ident" id="2041423">i</span>&nbsp;<span class="op" id="2041425">:=</span>&nbsp;<span class="num" id="2041428">0</span><span class="op" id="2041429">;</span>&nbsp;<span class="ident" id="2041431">i</span>&nbsp;<span class="op" id="2041433">&lt;</span>&nbsp;<span class="builtinfunc" id="2041435">len</span><span class="op" id="2041438">(</span><span class="ident" id="2041439">s</span><span class="op" id="2041440">)</span><span class="op" id="2041441">;</span>&nbsp;<span class="ident" id="2041443">i</span><span class="op" id="2041444">++</span>&nbsp;<span class="op" id="2041447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041451">if</span>&nbsp;<span class="ident" id="2041454">s</span><span class="op" id="2041455">[</span><span class="ident" id="2041456">i</span><span class="op" id="2041457">]</span>&nbsp;<span class="op" id="2041459">==</span>&nbsp;<span class="ident" id="2041462">c</span>&nbsp;<span class="op" id="2041464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041469">return</span>&nbsp;<span class="builtintype" id="2041476">true</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041489">return</span>&nbsp;<span class="builtintype" id="2041496">false</span><br>
<span class="lineno"></span><span class="op" id="2041502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2041505">//&nbsp;bsearch16&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2041562">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch16&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2041614">func</span>&nbsp;<span class="ident" id="2041619">bsearch16</span><span class="op" id="2041628">(</span><span class="ident" id="2041629">a</span>&nbsp;<span class="op" id="2041631">[</span><span class="op" id="2041632">]</span><span class="builtintype" id="2041633">uint16</span><span class="op" id="2041639">,</span>&nbsp;<span class="ident" id="2041641">x</span>&nbsp;<span class="builtintype" id="2041643">uint16</span><span class="op" id="2041649">)</span>&nbsp;<span class="builtintype" id="2041651">int</span>&nbsp;<span class="op" id="2041655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041658">i</span><span class="op" id="2041659">,</span>&nbsp;<span class="ident" id="2041661">j</span>&nbsp;<span class="op" id="2041663">:=</span>&nbsp;<span class="num" id="2041666">0</span><span class="op" id="2041667">,</span>&nbsp;<span class="builtinfunc" id="2041669">len</span><span class="op" id="2041672">(</span><span class="ident" id="2041673">a</span><span class="op" id="2041674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041677">for</span>&nbsp;<span class="ident" id="2041681">i</span>&nbsp;<span class="op" id="2041683">&lt;</span>&nbsp;<span class="ident" id="2041685">j</span>&nbsp;<span class="op" id="2041687">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041691">h</span>&nbsp;<span class="op" id="2041693">:=</span>&nbsp;<span class="ident" id="2041696">i</span>&nbsp;<span class="op" id="2041698">+</span>&nbsp;<span class="op" id="2041700">(</span><span class="ident" id="2041701">j</span><span class="op" id="2041702">-</span><span class="ident" id="2041703">i</span><span class="op" id="2041704">)</span><span class="op" id="2041705">/</span><span class="num" id="2041706">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041710">if</span>&nbsp;<span class="ident" id="2041713">a</span><span class="op" id="2041714">[</span><span class="ident" id="2041715">h</span><span class="op" id="2041716">]</span>&nbsp;<span class="op" id="2041718">&lt;</span>&nbsp;<span class="ident" id="2041720">x</span>&nbsp;<span class="op" id="2041722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041727">i</span>&nbsp;<span class="op" id="2041729">=</span>&nbsp;<span class="ident" id="2041731">h</span>&nbsp;<span class="op" id="2041733">+</span>&nbsp;<span class="num" id="2041735">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041739">}</span>&nbsp;<span class="keyword" id="2041741">else</span>&nbsp;<span class="op" id="2041746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041751">j</span>&nbsp;<span class="op" id="2041753">=</span>&nbsp;<span class="ident" id="2041755">h</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2041762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041765">return</span>&nbsp;<span class="ident" id="2041772">i</span><br>
<span class="lineno"></span><span class="op" id="2041774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="2041777">//&nbsp;bsearch32&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2041834">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch32&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2041886">func</span>&nbsp;<span class="ident" id="2041891">bsearch32</span><span class="op" id="2041900">(</span><span class="ident" id="2041901">a</span>&nbsp;<span class="op" id="2041903">[</span><span class="op" id="2041904">]</span><span class="builtintype" id="2041905">uint32</span><span class="op" id="2041911">,</span>&nbsp;<span class="ident" id="2041913">x</span>&nbsp;<span class="builtintype" id="2041915">uint32</span><span class="op" id="2041921">)</span>&nbsp;<span class="builtintype" id="2041923">int</span>&nbsp;<span class="op" id="2041927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041930">i</span><span class="op" id="2041931">,</span>&nbsp;<span class="ident" id="2041933">j</span>&nbsp;<span class="op" id="2041935">:=</span>&nbsp;<span class="num" id="2041938">0</span><span class="op" id="2041939">,</span>&nbsp;<span class="builtinfunc" id="2041941">len</span><span class="op" id="2041944">(</span><span class="ident" id="2041945">a</span><span class="op" id="2041946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041949">for</span>&nbsp;<span class="ident" id="2041953">i</span>&nbsp;<span class="op" id="2041955">&lt;</span>&nbsp;<span class="ident" id="2041957">j</span>&nbsp;<span class="op" id="2041959">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041963">h</span>&nbsp;<span class="op" id="2041965">:=</span>&nbsp;<span class="ident" id="2041968">i</span>&nbsp;<span class="op" id="2041970">+</span>&nbsp;<span class="op" id="2041972">(</span><span class="ident" id="2041973">j</span><span class="op" id="2041974">-</span><span class="ident" id="2041975">i</span><span class="op" id="2041976">)</span><span class="op" id="2041977">/</span><span class="num" id="2041978">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2041982">if</span>&nbsp;<span class="ident" id="2041985">a</span><span class="op" id="2041986">[</span><span class="ident" id="2041987">h</span><span class="op" id="2041988">]</span>&nbsp;<span class="op" id="2041990">&lt;</span>&nbsp;<span class="ident" id="2041992">x</span>&nbsp;<span class="op" id="2041994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2041999">i</span>&nbsp;<span class="op" id="2042001">=</span>&nbsp;<span class="ident" id="2042003">h</span>&nbsp;<span class="op" id="2042005">+</span>&nbsp;<span class="num" id="2042007">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042011">}</span>&nbsp;<span class="keyword" id="2042013">else</span>&nbsp;<span class="op" id="2042018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042023">j</span>&nbsp;<span class="op" id="2042025">=</span>&nbsp;<span class="ident" id="2042027">h</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042037">return</span>&nbsp;<span class="ident" id="2042044">i</span><br>
<span class="lineno"></span><span class="op" id="2042046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="2042049">//&nbsp;TODO:&nbsp;IsPrint&nbsp;is&nbsp;a&nbsp;local&nbsp;implementation&nbsp;of&nbsp;unicode.IsPrint,&nbsp;verified&nbsp;by&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="2042134">//&nbsp;to&nbsp;give&nbsp;the&nbsp;same&nbsp;answer.&nbsp;It&nbsp;allows&nbsp;this&nbsp;package&nbsp;not&nbsp;to&nbsp;depend&nbsp;on&nbsp;unicode,</span><br>
<span class="lineno"></span><span class="comment" id="2042211">//&nbsp;and&nbsp;therefore&nbsp;not&nbsp;pull&nbsp;in&nbsp;all&nbsp;the&nbsp;Unicode&nbsp;tables.&nbsp;If&nbsp;the&nbsp;linker&nbsp;were&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2042290">//&nbsp;at&nbsp;tossing&nbsp;unused&nbsp;tables,&nbsp;we&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;this&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="2042360">//&nbsp;That&nbsp;would&nbsp;be&nbsp;nice.</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="2042384">//&nbsp;IsPrint&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;defined&nbsp;as&nbsp;printable&nbsp;by&nbsp;Go,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2042456">//&nbsp;the&nbsp;same&nbsp;definition&nbsp;as&nbsp;unicode.IsPrint:&nbsp;letters,&nbsp;numbers,&nbsp;punctuation,</span><br>
<span class="lineno"></span><span class="comment" id="2042530">//&nbsp;symbols&nbsp;and&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2042558">func</span>&nbsp;<span class="ident" id="2042563">IsPrint</span><span class="op" id="2042570">(</span><span class="ident" id="2042571">r</span>&nbsp;<span class="builtintype" id="2042573">rune</span><span class="op" id="2042577">)</span>&nbsp;<span class="builtintype" id="2042579">bool</span>&nbsp;<span class="op" id="2042584">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042587">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;Latin-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042614">if</span>&nbsp;<span class="ident" id="2042617">r</span>&nbsp;<span class="op" id="2042619">&lt;=</span>&nbsp;<span class="num" id="2042622">0xFF</span>&nbsp;<span class="op" id="2042627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042631">if</span>&nbsp;<span class="num" id="2042634">0x20</span>&nbsp;<span class="op" id="2042639">&lt;=</span>&nbsp;<span class="ident" id="2042642">r</span>&nbsp;<span class="op" id="2042644">&amp;&amp;</span>&nbsp;<span class="ident" id="2042647">r</span>&nbsp;<span class="op" id="2042649">&lt;=</span>&nbsp;<span class="num" id="2042652">0x7E</span>&nbsp;<span class="op" id="2042657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042662">//&nbsp;All&nbsp;the&nbsp;ASCII&nbsp;is&nbsp;printable&nbsp;from&nbsp;space&nbsp;through&nbsp;DEL-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042721">return</span>&nbsp;<span class="builtintype" id="2042728">true</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042739">if</span>&nbsp;<span class="num" id="2042742">0xA1</span>&nbsp;<span class="op" id="2042747">&lt;=</span>&nbsp;<span class="ident" id="2042750">r</span>&nbsp;<span class="op" id="2042752">&amp;&amp;</span>&nbsp;<span class="ident" id="2042755">r</span>&nbsp;<span class="op" id="2042757">&lt;=</span>&nbsp;<span class="num" id="2042760">0xFF</span>&nbsp;<span class="op" id="2042765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042770">//&nbsp;Similarly&nbsp;for&nbsp;&nbsp;through&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042807">return</span>&nbsp;<span class="ident" id="2042814">r</span>&nbsp;<span class="op" id="2042816">!=</span>&nbsp;<span class="num" id="2042819">0xAD</span>&nbsp;<span class="comment" id="2042824">//&nbsp;...except&nbsp;for&nbsp;the&nbsp;bizarre&nbsp;soft&nbsp;hyphen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042868">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042872">return</span>&nbsp;<span class="builtintype" id="2042879">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042890">//&nbsp;Same&nbsp;algorithm,&nbsp;either&nbsp;on&nbsp;uint16&nbsp;or&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042944">//&nbsp;First,&nbsp;find&nbsp;first&nbsp;i&nbsp;such&nbsp;that&nbsp;isPrint[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2042995">//&nbsp;This&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;either&nbsp;the&nbsp;start&nbsp;or&nbsp;end&nbsp;of&nbsp;a&nbsp;pair&nbsp;that&nbsp;might&nbsp;span&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043073">//&nbsp;The&nbsp;start&nbsp;is&nbsp;even&nbsp;(isPrint[i&amp;^1])&nbsp;and&nbsp;the&nbsp;end&nbsp;is&nbsp;odd&nbsp;(isPrint[i|1]).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2043146">//&nbsp;If&nbsp;we&nbsp;find&nbsp;x&nbsp;in&nbsp;a&nbsp;range,&nbsp;make&nbsp;sure&nbsp;x&nbsp;is&nbsp;not&nbsp;in&nbsp;isNotPrint&nbsp;list.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043215">if</span>&nbsp;<span class="num" id="2043218">0</span>&nbsp;<span class="op" id="2043220">&lt;=</span>&nbsp;<span class="ident" id="2043223">r</span>&nbsp;<span class="op" id="2043225">&amp;&amp;</span>&nbsp;<span class="ident" id="2043228">r</span>&nbsp;<span class="op" id="2043230">&lt;</span>&nbsp;<span class="num" id="2043232">1</span><span class="op" id="2043233">&lt;&lt;</span><span class="num" id="2043235">16</span>&nbsp;<span class="op" id="2043238">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043242">rr</span><span class="op" id="2043244">,</span>&nbsp;<span class="ident" id="2043246">isPrint</span><span class="op" id="2043253">,</span>&nbsp;<span class="ident" id="2043255">isNotPrint</span>&nbsp;<span class="op" id="2043266">:=</span>&nbsp;<span class="builtintype" id="2043269">uint16</span><span class="op" id="2043275">(</span><span class="ident" id="2043276">r</span><span class="op" id="2043277">)</span><span class="op" id="2043278">,</span>&nbsp;<span class="ident" id="2043280">isPrint16</span><span class="op" id="2043289">,</span>&nbsp;<span class="ident" id="2043291">isNotPrint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043306">i</span>&nbsp;<span class="op" id="2043308">:=</span>&nbsp;<span class="ident" id="2043311">bsearch16</span><span class="op" id="2043320">(</span><span class="ident" id="2043321">isPrint</span><span class="op" id="2043328">,</span>&nbsp;<span class="ident" id="2043330">rr</span><span class="op" id="2043332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043336">if</span>&nbsp;<span class="ident" id="2043339">i</span>&nbsp;<span class="op" id="2043341">&gt;=</span>&nbsp;<span class="builtinfunc" id="2043344">len</span><span class="op" id="2043347">(</span><span class="ident" id="2043348">isPrint</span><span class="op" id="2043355">)</span>&nbsp;<span class="op" id="2043357">||</span>&nbsp;<span class="ident" id="2043360">rr</span>&nbsp;<span class="op" id="2043363">&lt;</span>&nbsp;<span class="ident" id="2043365">isPrint</span><span class="op" id="2043372">[</span><span class="ident" id="2043373">i</span><span class="op" id="2043374">&amp;^</span><span class="num" id="2043376">1</span><span class="op" id="2043377">]</span>&nbsp;<span class="op" id="2043379">||</span>&nbsp;<span class="ident" id="2043382">isPrint</span><span class="op" id="2043389">[</span><span class="ident" id="2043390">i</span><span class="op" id="2043391">|</span><span class="num" id="2043392">1</span><span class="op" id="2043393">]</span>&nbsp;<span class="op" id="2043395">&lt;</span>&nbsp;<span class="ident" id="2043397">rr</span>&nbsp;<span class="op" id="2043400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043405">return</span>&nbsp;<span class="builtintype" id="2043412">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043420">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043424">j</span>&nbsp;<span class="op" id="2043426">:=</span>&nbsp;<span class="ident" id="2043429">bsearch16</span><span class="op" id="2043438">(</span><span class="ident" id="2043439">isNotPrint</span><span class="op" id="2043449">,</span>&nbsp;<span class="ident" id="2043451">rr</span><span class="op" id="2043453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043457">return</span>&nbsp;<span class="ident" id="2043464">j</span>&nbsp;<span class="op" id="2043466">&gt;=</span>&nbsp;<span class="builtinfunc" id="2043469">len</span><span class="op" id="2043472">(</span><span class="ident" id="2043473">isNotPrint</span><span class="op" id="2043483">)</span>&nbsp;<span class="op" id="2043485">||</span>&nbsp;<span class="ident" id="2043488">isNotPrint</span><span class="op" id="2043498">[</span><span class="ident" id="2043499">j</span><span class="op" id="2043500">]</span>&nbsp;<span class="op" id="2043502">!=</span>&nbsp;<span class="ident" id="2043505">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043513">rr</span><span class="op" id="2043515">,</span>&nbsp;<span class="ident" id="2043517">isPrint</span><span class="op" id="2043524">,</span>&nbsp;<span class="ident" id="2043526">isNotPrint</span>&nbsp;<span class="op" id="2043537">:=</span>&nbsp;<span class="builtintype" id="2043540">uint32</span><span class="op" id="2043546">(</span><span class="ident" id="2043547">r</span><span class="op" id="2043548">)</span><span class="op" id="2043549">,</span>&nbsp;<span class="ident" id="2043551">isPrint32</span><span class="op" id="2043560">,</span>&nbsp;<span class="ident" id="2043562">isNotPrint32</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043576">i</span>&nbsp;<span class="op" id="2043578">:=</span>&nbsp;<span class="ident" id="2043581">bsearch32</span><span class="op" id="2043590">(</span><span class="ident" id="2043591">isPrint</span><span class="op" id="2043598">,</span>&nbsp;<span class="ident" id="2043600">rr</span><span class="op" id="2043602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043605">if</span>&nbsp;<span class="ident" id="2043608">i</span>&nbsp;<span class="op" id="2043610">&gt;=</span>&nbsp;<span class="builtinfunc" id="2043613">len</span><span class="op" id="2043616">(</span><span class="ident" id="2043617">isPrint</span><span class="op" id="2043624">)</span>&nbsp;<span class="op" id="2043626">||</span>&nbsp;<span class="ident" id="2043629">rr</span>&nbsp;<span class="op" id="2043632">&lt;</span>&nbsp;<span class="ident" id="2043634">isPrint</span><span class="op" id="2043641">[</span><span class="ident" id="2043642">i</span><span class="op" id="2043643">&amp;^</span><span class="num" id="2043645">1</span><span class="op" id="2043646">]</span>&nbsp;<span class="op" id="2043648">||</span>&nbsp;<span class="ident" id="2043651">isPrint</span><span class="op" id="2043658">[</span><span class="ident" id="2043659">i</span><span class="op" id="2043660">|</span><span class="num" id="2043661">1</span><span class="op" id="2043662">]</span>&nbsp;<span class="op" id="2043664">&lt;</span>&nbsp;<span class="ident" id="2043666">rr</span>&nbsp;<span class="op" id="2043669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043673">return</span>&nbsp;<span class="builtintype" id="2043680">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043690">if</span>&nbsp;<span class="ident" id="2043693">r</span>&nbsp;<span class="op" id="2043695">&gt;=</span>&nbsp;<span class="num" id="2043698">0x20000</span>&nbsp;<span class="op" id="2043706">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043710">return</span>&nbsp;<span class="builtintype" id="2043717">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043726">r</span>&nbsp;<span class="op" id="2043728">-=</span>&nbsp;<span class="num" id="2043731">0x10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043740">j</span>&nbsp;<span class="op" id="2043742">:=</span>&nbsp;<span class="ident" id="2043745">bsearch16</span><span class="op" id="2043754">(</span><span class="ident" id="2043755">isNotPrint</span><span class="op" id="2043765">,</span>&nbsp;<span class="builtintype" id="2043767">uint16</span><span class="op" id="2043773">(</span><span class="ident" id="2043774">r</span><span class="op" id="2043775">)</span><span class="op" id="2043776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043779">return</span>&nbsp;<span class="ident" id="2043786">j</span>&nbsp;<span class="op" id="2043788">&gt;=</span>&nbsp;<span class="builtinfunc" id="2043791">len</span><span class="op" id="2043794">(</span><span class="ident" id="2043795">isNotPrint</span><span class="op" id="2043805">)</span>&nbsp;<span class="op" id="2043807">||</span>&nbsp;<span class="ident" id="2043810">isNotPrint</span><span class="op" id="2043820">[</span><span class="ident" id="2043821">j</span><span class="op" id="2043822">]</span>&nbsp;<span class="op" id="2043824">!=</span>&nbsp;<span class="builtintype" id="2043827">uint16</span><span class="op" id="2043833">(</span><span class="ident" id="2043834">r</span><span class="op" id="2043835">)</span><br>
<span class="lineno">455</span><span class="op" id="2043837">}</span>
</div>
</body>
</html>
