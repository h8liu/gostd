<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword">package</span>&nbsp;<span class="ident">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P256.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">import</span>&nbsp;<span class="op">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">p256Curve</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="ident">CurveParams</span><br>
<span class="lineno">15</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256</span>&nbsp;<span class="ident">p256Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;RInverse&nbsp;contains&nbsp;1/R&nbsp;mod&nbsp;p&nbsp;-&nbsp;the&nbsp;inverse&nbsp;of&nbsp;the&nbsp;Montgomery&nbsp;constant</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(2**257).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256RInverse</span>&nbsp;<span class="op">*</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><br>
<span class="lineno"></span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">initP256</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256</span><span class="op">.</span><span class="ident">CurveParams</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">CurveParams</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256</span><span class="op">.</span><span class="ident">P</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetString</span><span class="op">(</span><span class="string">&#34;115792089210356248762697446949407573530086143415290314195533631308867097853951&#34;</span><span class="op">,</span>&nbsp;<span class="num">10</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256</span><span class="op">.</span><span class="ident">N</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetString</span><span class="op">(</span><span class="string">&#34;115792089210356248762697446949407573529996955224135760342422259061068512044369&#34;</span><span class="op">,</span>&nbsp;<span class="num">10</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256</span><span class="op">.</span><span class="ident">B</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetString</span><span class="op">(</span><span class="string">&#34;5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b&#34;</span><span class="op">,</span>&nbsp;<span class="num">16</span><span class="op">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256</span><span class="op">.</span><span class="ident">Gx</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetString</span><span class="op">(</span><span class="string">&#34;6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296&#34;</span><span class="op">,</span>&nbsp;<span class="num">16</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256</span><span class="op">.</span><span class="ident">Gy</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetString</span><span class="op">(</span><span class="string">&#34;4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5&#34;</span><span class="op">,</span>&nbsp;<span class="num">16</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256</span><span class="op">.</span><span class="ident">BitSize</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256RInverse</span><span class="op">,</span>&nbsp;<span class="ident">_</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetString</span><span class="op">(</span><span class="string">&#34;7fffffff00000001fffffffe8000000100000000ffffffff0000000180000000&#34;</span><span class="op">,</span>&nbsp;<span class="num">16</span><span class="op">)</span><br>
<span class="lineno">35</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">curve</span>&nbsp;<span class="ident">p256Curve</span><span class="op">)</span>&nbsp;<span class="ident">Params</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">CurveParams</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">curve</span><span class="op">.</span><span class="ident">CurveParams</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256GetScalar&nbsp;endian-swaps&nbsp;the&nbsp;big-endian&nbsp;scalar&nbsp;value&nbsp;from&nbsp;in&nbsp;and&nbsp;writes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;to&nbsp;out.&nbsp;If&nbsp;the&nbsp;scalar&nbsp;is&nbsp;equal&nbsp;or&nbsp;greater&nbsp;than&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;group,&nbsp;it&#39;s</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;reduced&nbsp;modulo&nbsp;that&nbsp;order.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256GetScalar</span><span class="op">(</span><span class="ident">out</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="num">32</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">,</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">n</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">SetBytes</span><span class="op">(</span><span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">scalarBytes</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">n</span><span class="op">.</span><span class="ident">Cmp</span><span class="op">(</span><span class="ident">p256</span><span class="op">.</span><span class="ident">N</span><span class="op">)</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">n</span><span class="op">.</span><span class="ident">Mod</span><span class="op">(</span><span class="ident">n</span><span class="op">,</span>&nbsp;<span class="ident">p256</span><span class="op">.</span><span class="ident">N</span><span class="op">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">scalarBytes</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">n</span><span class="op">.</span><span class="ident">Bytes</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">scalarBytes</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">scalarBytes</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="builtinfunc">len</span><span class="op">(</span><span class="ident">scalarBytes</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="num">1</span><span class="op">+</span><span class="ident">i</span><span class="op">)</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">p256Curve</span><span class="op">)</span>&nbsp;<span class="ident">ScalarBaseMult</span><span class="op">(</span><span class="ident">scalar</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">scalarReversed</span>&nbsp;<span class="op">[</span><span class="num">32</span><span class="op">]</span><span class="builtintype">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256GetScalar</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">scalarReversed</span><span class="op">,</span>&nbsp;<span class="ident">scalar</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="ident">z1</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ScalarBaseMult</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">scalarReversed</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">p256ToAffine</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">p256Curve</span><span class="op">)</span>&nbsp;<span class="ident">ScalarMult</span><span class="op">(</span><span class="ident">bigX</span><span class="op">,</span>&nbsp;<span class="ident">bigY</span>&nbsp;<span class="op">*</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">,</span>&nbsp;<span class="ident">scalar</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">scalarReversed</span>&nbsp;<span class="op">[</span><span class="num">32</span><span class="op">]</span><span class="builtintype">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256GetScalar</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">scalarReversed</span><span class="op">,</span>&nbsp;<span class="ident">scalar</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">px</span><span class="op">,</span>&nbsp;<span class="ident">py</span><span class="op">,</span>&nbsp;<span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="ident">z1</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256FromBig</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">px</span><span class="op">,</span>&nbsp;<span class="ident">bigX</span><span class="op">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256FromBig</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">py</span><span class="op">,</span>&nbsp;<span class="ident">bigY</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ScalarMult</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">px</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">py</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">scalarReversed</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">p256ToAffine</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;as&nbsp;nine,&nbsp;unsigned&nbsp;32-bit&nbsp;words.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;value&nbsp;of&nbsp;an&nbsp;field&nbsp;element&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;x[0]&nbsp;+&nbsp;(x[1]&nbsp;*&nbsp;2**29)&nbsp;+&nbsp;(x[2]&nbsp;*&nbsp;2**57)&nbsp;+&nbsp;...&nbsp;+&nbsp;(x[8]&nbsp;*&nbsp;2**228)</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">85</span><span class="comment">//&nbsp;That&nbsp;is,&nbsp;each&nbsp;limb&nbsp;is&nbsp;alternately&nbsp;29&nbsp;or&nbsp;28-bits&nbsp;wide&nbsp;in&nbsp;little-endian</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;This&nbsp;means&nbsp;that&nbsp;a&nbsp;field&nbsp;element&nbsp;hits&nbsp;2**257,&nbsp;rather&nbsp;than&nbsp;2**256&nbsp;as&nbsp;we&nbsp;would</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;like.&nbsp;A&nbsp;28,&nbsp;29,&nbsp;...&nbsp;pattern&nbsp;would&nbsp;cause&nbsp;us&nbsp;to&nbsp;hit&nbsp;2**256,&nbsp;but&nbsp;that&nbsp;causes</span><br>
<span class="lineno">90</span><span class="comment">//&nbsp;problems&nbsp;when&nbsp;multiplying&nbsp;as&nbsp;terms&nbsp;end&nbsp;up&nbsp;one&nbsp;bit&nbsp;short&nbsp;of&nbsp;a&nbsp;limb&nbsp;which</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;would&nbsp;require&nbsp;much&nbsp;bit-shifting&nbsp;to&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Finally,&nbsp;the&nbsp;values&nbsp;stored&nbsp;in&nbsp;a&nbsp;field&nbsp;element&nbsp;are&nbsp;in&nbsp;Montgomery&nbsp;form.&nbsp;So&nbsp;the</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;value&nbsp;|y|&nbsp;is&nbsp;stored&nbsp;as&nbsp;(y*R)&nbsp;mod&nbsp;p,&nbsp;where&nbsp;p&nbsp;is&nbsp;the&nbsp;P-256&nbsp;prime&nbsp;and&nbsp;R&nbsp;is</span><br>
<span class="lineno">95</span><span class="comment">//&nbsp;2**257.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">const</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Limbs</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">bottom29Bits</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0x1fffffff</span><br>
<span class="lineno">100</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;p256One&nbsp;is&nbsp;the&nbsp;number&nbsp;1&nbsp;as&nbsp;a&nbsp;field&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256One</span>&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">{</span><span class="num">2</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0xffff800</span><span class="op">,</span>&nbsp;<span class="num">0x1fffffff</span><span class="op">,</span>&nbsp;<span class="num">0xfffffff</span><span class="op">,</span>&nbsp;<span class="num">0x1fbfffff</span><span class="op">,</span>&nbsp;<span class="num">0x1ffffff</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Zero</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">{</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;p256P&nbsp;is&nbsp;the&nbsp;prime&nbsp;modulus&nbsp;as&nbsp;a&nbsp;field&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256P</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">{</span><span class="num">0x1fffffff</span><span class="op">,</span>&nbsp;<span class="num">0xfffffff</span><span class="op">,</span>&nbsp;<span class="num">0x1fffffff</span><span class="op">,</span>&nbsp;<span class="num">0x3ff</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x200000</span><span class="op">,</span>&nbsp;<span class="num">0xf000000</span><span class="op">,</span>&nbsp;<span class="num">0xfffffff</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;p2562P&nbsp;is&nbsp;the&nbsp;twice&nbsp;prime&nbsp;modulus&nbsp;as&nbsp;a&nbsp;field&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p2562P</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">{</span><span class="num">0x1ffffffe</span><span class="op">,</span>&nbsp;<span class="num">0xfffffff</span><span class="op">,</span>&nbsp;<span class="num">0x1fffffff</span><span class="op">,</span>&nbsp;<span class="num">0x7ff</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x400000</span><span class="op">,</span>&nbsp;<span class="num">0xe000000</span><span class="op">,</span>&nbsp;<span class="num">0x1fffffff</span><span class="op">}</span><br>
<span class="lineno">110</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256Precomputed&nbsp;contains&nbsp;precomputed&nbsp;values&nbsp;to&nbsp;aid&nbsp;the&nbsp;calculation&nbsp;of&nbsp;scalar</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;multiples&nbsp;of&nbsp;the&nbsp;base&nbsp;point,&nbsp;G.&nbsp;It&#39;s&nbsp;actually&nbsp;two,&nbsp;equal&nbsp;length,&nbsp;tables</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;concatenated.</span><br>
<span class="lineno">115</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;first&nbsp;table&nbsp;contains&nbsp;(x,y)&nbsp;field&nbsp;element&nbsp;pairs&nbsp;for&nbsp;16&nbsp;multiples&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;base&nbsp;point,&nbsp;G.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;Index&nbsp;&nbsp;|&nbsp;&nbsp;Index&nbsp;(binary)&nbsp;|&nbsp;Value</span><br>
<span class="lineno">120</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0000&nbsp;&nbsp;|&nbsp;0G&nbsp;(all&nbsp;zeros,&nbsp;omitted)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0001&nbsp;&nbsp;|&nbsp;G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0010&nbsp;&nbsp;|&nbsp;2**64G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0011&nbsp;&nbsp;|&nbsp;2**64G&nbsp;+&nbsp;G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0100&nbsp;&nbsp;|&nbsp;2**128G</span><br>
<span class="lineno">125</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0101&nbsp;&nbsp;|&nbsp;2**128G&nbsp;+&nbsp;G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0110&nbsp;&nbsp;|&nbsp;2**128G&nbsp;+&nbsp;2**64G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0111&nbsp;&nbsp;|&nbsp;2**128G&nbsp;+&nbsp;2**64G&nbsp;+&nbsp;G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1000&nbsp;&nbsp;|&nbsp;2**192G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;|&nbsp;2**192G&nbsp;+&nbsp;G</span><br>
<span class="lineno">130</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1010&nbsp;&nbsp;|&nbsp;2**192G&nbsp;+&nbsp;2**64G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1011&nbsp;&nbsp;|&nbsp;2**192G&nbsp;+&nbsp;2**64G&nbsp;+&nbsp;G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1100&nbsp;&nbsp;|&nbsp;2**192G&nbsp;+&nbsp;2**128G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1101&nbsp;&nbsp;|&nbsp;2**192G&nbsp;+&nbsp;2**128G&nbsp;+&nbsp;G</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1110&nbsp;&nbsp;|&nbsp;2**192G&nbsp;+&nbsp;2**128G&nbsp;+&nbsp;2**64G</span><br>
<span class="lineno">135</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1111&nbsp;&nbsp;|&nbsp;2**192G&nbsp;+&nbsp;2**128G&nbsp;+&nbsp;2**64G&nbsp;+&nbsp;G</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;second&nbsp;table&nbsp;follows&nbsp;the&nbsp;same&nbsp;style,&nbsp;but&nbsp;the&nbsp;terms&nbsp;are&nbsp;2**32G,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;2**96G,&nbsp;2**160G,&nbsp;2**224G.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">140</span><span class="comment">//&nbsp;This&nbsp;is&nbsp;~2KB&nbsp;of&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">p256Precomputed</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span>&nbsp;<span class="op">*</span>&nbsp;<span class="num">2</span>&nbsp;<span class="op">*</span>&nbsp;<span class="num">15</span>&nbsp;<span class="op">*</span>&nbsp;<span class="num">2</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x11522878</span><span class="op">,</span>&nbsp;<span class="num">0xe730d41</span><span class="op">,</span>&nbsp;<span class="num">0xdb60179</span><span class="op">,</span>&nbsp;<span class="num">0x4afe2ff</span><span class="op">,</span>&nbsp;<span class="num">0x12883add</span><span class="op">,</span>&nbsp;<span class="num">0xcaddd88</span><span class="op">,</span>&nbsp;<span class="num">0x119e7edc</span><span class="op">,</span>&nbsp;<span class="num">0xd4a6eab</span><span class="op">,</span>&nbsp;<span class="num">0x3120bee</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1d2aac15</span><span class="op">,</span>&nbsp;<span class="num">0xf25357c</span><span class="op">,</span>&nbsp;<span class="num">0x19e45cdd</span><span class="op">,</span>&nbsp;<span class="num">0x5c721d0</span><span class="op">,</span>&nbsp;<span class="num">0x1992c5a5</span><span class="op">,</span>&nbsp;<span class="num">0xa237487</span><span class="op">,</span>&nbsp;<span class="num">0x154ba21</span><span class="op">,</span>&nbsp;<span class="num">0x14b10bb</span><span class="op">,</span>&nbsp;<span class="num">0xae3fe3</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xd41a576</span><span class="op">,</span>&nbsp;<span class="num">0x922fc51</span><span class="op">,</span>&nbsp;<span class="num">0x234994f</span><span class="op">,</span>&nbsp;<span class="num">0x60b60d3</span><span class="op">,</span>&nbsp;<span class="num">0x164586ae</span><span class="op">,</span>&nbsp;<span class="num">0xce95f18</span><span class="op">,</span>&nbsp;<span class="num">0x1fe49073</span><span class="op">,</span>&nbsp;<span class="num">0x3fa36cc</span><span class="op">,</span>&nbsp;<span class="num">0x5ebcd2c</span><span class="op">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xb402f2f</span><span class="op">,</span>&nbsp;<span class="num">0x15c70bf</span><span class="op">,</span>&nbsp;<span class="num">0x1561925c</span><span class="op">,</span>&nbsp;<span class="num">0x5a26704</span><span class="op">,</span>&nbsp;<span class="num">0xda91e90</span><span class="op">,</span>&nbsp;<span class="num">0xcdc1c7f</span><span class="op">,</span>&nbsp;<span class="num">0x1ea12446</span><span class="op">,</span>&nbsp;<span class="num">0xe1ade1e</span><span class="op">,</span>&nbsp;<span class="num">0xec91f22</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x26f7778</span><span class="op">,</span>&nbsp;<span class="num">0x566847e</span><span class="op">,</span>&nbsp;<span class="num">0xa0bec9e</span><span class="op">,</span>&nbsp;<span class="num">0x234f453</span><span class="op">,</span>&nbsp;<span class="num">0x1a31f21a</span><span class="op">,</span>&nbsp;<span class="num">0xd85e75c</span><span class="op">,</span>&nbsp;<span class="num">0x56c7109</span><span class="op">,</span>&nbsp;<span class="num">0xa267a00</span><span class="op">,</span>&nbsp;<span class="num">0xb57c050</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x98fb57</span><span class="op">,</span>&nbsp;<span class="num">0xaa837cc</span><span class="op">,</span>&nbsp;<span class="num">0x60c0792</span><span class="op">,</span>&nbsp;<span class="num">0xcfa5e19</span><span class="op">,</span>&nbsp;<span class="num">0x61bab9e</span><span class="op">,</span>&nbsp;<span class="num">0x589e39b</span><span class="op">,</span>&nbsp;<span class="num">0xa324c5</span><span class="op">,</span>&nbsp;<span class="num">0x7d6dee7</span><span class="op">,</span>&nbsp;<span class="num">0x2976e4b</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1fc4124a</span><span class="op">,</span>&nbsp;<span class="num">0xa8c244b</span><span class="op">,</span>&nbsp;<span class="num">0x1ce86762</span><span class="op">,</span>&nbsp;<span class="num">0xcd61c7e</span><span class="op">,</span>&nbsp;<span class="num">0x1831c8e0</span><span class="op">,</span>&nbsp;<span class="num">0x75774e1</span><span class="op">,</span>&nbsp;<span class="num">0x1d96a5a9</span><span class="op">,</span>&nbsp;<span class="num">0x843a649</span><span class="op">,</span>&nbsp;<span class="num">0xc3ab0fa</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x6e2e7d5</span><span class="op">,</span>&nbsp;<span class="num">0x7673a2a</span><span class="op">,</span>&nbsp;<span class="num">0x178b65e8</span><span class="op">,</span>&nbsp;<span class="num">0x4003e9b</span><span class="op">,</span>&nbsp;<span class="num">0x1a1f11c2</span><span class="op">,</span>&nbsp;<span class="num">0x7816ea</span><span class="op">,</span>&nbsp;<span class="num">0xf643e11</span><span class="op">,</span>&nbsp;<span class="num">0x58c43df</span><span class="op">,</span>&nbsp;<span class="num">0xf423fc2</span><span class="op">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x19633ffa</span><span class="op">,</span>&nbsp;<span class="num">0x891f2b2</span><span class="op">,</span>&nbsp;<span class="num">0x123c231c</span><span class="op">,</span>&nbsp;<span class="num">0x46add8c</span><span class="op">,</span>&nbsp;<span class="num">0x54700dd</span><span class="op">,</span>&nbsp;<span class="num">0x59e2b17</span><span class="op">,</span>&nbsp;<span class="num">0x172db40f</span><span class="op">,</span>&nbsp;<span class="num">0x83e277d</span><span class="op">,</span>&nbsp;<span class="num">0xb0dd609</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xfd1da12</span><span class="op">,</span>&nbsp;<span class="num">0x35c6e52</span><span class="op">,</span>&nbsp;<span class="num">0x19ede20c</span><span class="op">,</span>&nbsp;<span class="num">0xd19e0c0</span><span class="op">,</span>&nbsp;<span class="num">0x97d0f40</span><span class="op">,</span>&nbsp;<span class="num">0xb015b19</span><span class="op">,</span>&nbsp;<span class="num">0x449e3f5</span><span class="op">,</span>&nbsp;<span class="num">0xe10c9e</span><span class="op">,</span>&nbsp;<span class="num">0x33ab581</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x56a67ab</span><span class="op">,</span>&nbsp;<span class="num">0x577734d</span><span class="op">,</span>&nbsp;<span class="num">0x1dddc062</span><span class="op">,</span>&nbsp;<span class="num">0xc57b10d</span><span class="op">,</span>&nbsp;<span class="num">0x149b39d</span><span class="op">,</span>&nbsp;<span class="num">0x26a9e7b</span><span class="op">,</span>&nbsp;<span class="num">0xc35df9f</span><span class="op">,</span>&nbsp;<span class="num">0x48764cd</span><span class="op">,</span>&nbsp;<span class="num">0x76dbcca</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xca4b366</span><span class="op">,</span>&nbsp;<span class="num">0xe9303ab</span><span class="op">,</span>&nbsp;<span class="num">0x1a7480e7</span><span class="op">,</span>&nbsp;<span class="num">0x57e9e81</span><span class="op">,</span>&nbsp;<span class="num">0x1e13eb50</span><span class="op">,</span>&nbsp;<span class="num">0xf466cf3</span><span class="op">,</span>&nbsp;<span class="num">0x6f16b20</span><span class="op">,</span>&nbsp;<span class="num">0x4ba3173</span><span class="op">,</span>&nbsp;<span class="num">0xc168c33</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x15cb5439</span><span class="op">,</span>&nbsp;<span class="num">0x6a38e11</span><span class="op">,</span>&nbsp;<span class="num">0x73658bd</span><span class="op">,</span>&nbsp;<span class="num">0xb29564f</span><span class="op">,</span>&nbsp;<span class="num">0x3f6dc5b</span><span class="op">,</span>&nbsp;<span class="num">0x53b97e</span><span class="op">,</span>&nbsp;<span class="num">0x1322c4c0</span><span class="op">,</span>&nbsp;<span class="num">0x65dd7ff</span><span class="op">,</span>&nbsp;<span class="num">0x3a1e4f6</span><span class="op">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x14e614aa</span><span class="op">,</span>&nbsp;<span class="num">0x9246317</span><span class="op">,</span>&nbsp;<span class="num">0x1bc83aca</span><span class="op">,</span>&nbsp;<span class="num">0xad97eed</span><span class="op">,</span>&nbsp;<span class="num">0xd38ce4a</span><span class="op">,</span>&nbsp;<span class="num">0xf82b006</span><span class="op">,</span>&nbsp;<span class="num">0x341f077</span><span class="op">,</span>&nbsp;<span class="num">0xa6add89</span><span class="op">,</span>&nbsp;<span class="num">0x4894acd</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x9f162d5</span><span class="op">,</span>&nbsp;<span class="num">0xf8410ef</span><span class="op">,</span>&nbsp;<span class="num">0x1b266a56</span><span class="op">,</span>&nbsp;<span class="num">0xd7f223</span><span class="op">,</span>&nbsp;<span class="num">0x3e0cb92</span><span class="op">,</span>&nbsp;<span class="num">0xe39b672</span><span class="op">,</span>&nbsp;<span class="num">0x6a2901a</span><span class="op">,</span>&nbsp;<span class="num">0x69a8556</span><span class="op">,</span>&nbsp;<span class="num">0x7e7c0</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x9b7d8d3</span><span class="op">,</span>&nbsp;<span class="num">0x309a80</span><span class="op">,</span>&nbsp;<span class="num">0x1ad05f7f</span><span class="op">,</span>&nbsp;<span class="num">0xc2fb5dd</span><span class="op">,</span>&nbsp;<span class="num">0xcbfd41d</span><span class="op">,</span>&nbsp;<span class="num">0x9ceb638</span><span class="op">,</span>&nbsp;<span class="num">0x1051825c</span><span class="op">,</span>&nbsp;<span class="num">0xda0cf5b</span><span class="op">,</span>&nbsp;<span class="num">0x812e881</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x6f35669</span><span class="op">,</span>&nbsp;<span class="num">0x6a56f2c</span><span class="op">,</span>&nbsp;<span class="num">0x1df8d184</span><span class="op">,</span>&nbsp;<span class="num">0x345820</span><span class="op">,</span>&nbsp;<span class="num">0x1477d477</span><span class="op">,</span>&nbsp;<span class="num">0x1645db1</span><span class="op">,</span>&nbsp;<span class="num">0xbe80c51</span><span class="op">,</span>&nbsp;<span class="num">0xc22be3e</span><span class="op">,</span>&nbsp;<span class="num">0xe35e65a</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1aeb7aa0</span><span class="op">,</span>&nbsp;<span class="num">0xc375315</span><span class="op">,</span>&nbsp;<span class="num">0xf67bc99</span><span class="op">,</span>&nbsp;<span class="num">0x7fdd7b9</span><span class="op">,</span>&nbsp;<span class="num">0x191fc1be</span><span class="op">,</span>&nbsp;<span class="num">0x61235d</span><span class="op">,</span>&nbsp;<span class="num">0x2c184e9</span><span class="op">,</span>&nbsp;<span class="num">0x1c5a839</span><span class="op">,</span>&nbsp;<span class="num">0x47a1e26</span><span class="op">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xb7cb456</span><span class="op">,</span>&nbsp;<span class="num">0x93e225d</span><span class="op">,</span>&nbsp;<span class="num">0x14f3c6ed</span><span class="op">,</span>&nbsp;<span class="num">0xccc1ac9</span><span class="op">,</span>&nbsp;<span class="num">0x17fe37f3</span><span class="op">,</span>&nbsp;<span class="num">0x4988989</span><span class="op">,</span>&nbsp;<span class="num">0x1a90c502</span><span class="op">,</span>&nbsp;<span class="num">0x2f32042</span><span class="op">,</span>&nbsp;<span class="num">0xa17769b</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xafd8c7c</span><span class="op">,</span>&nbsp;<span class="num">0x8191c6e</span><span class="op">,</span>&nbsp;<span class="num">0x1dcdb237</span><span class="op">,</span>&nbsp;<span class="num">0x16200c0</span><span class="op">,</span>&nbsp;<span class="num">0x107b32a1</span><span class="op">,</span>&nbsp;<span class="num">0x66c08db</span><span class="op">,</span>&nbsp;<span class="num">0x10d06a02</span><span class="op">,</span>&nbsp;<span class="num">0x3fc93</span><span class="op">,</span>&nbsp;<span class="num">0x5620023</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x16722b27</span><span class="op">,</span>&nbsp;<span class="num">0x68b5c59</span><span class="op">,</span>&nbsp;<span class="num">0x270fcfc</span><span class="op">,</span>&nbsp;<span class="num">0xfad0ecc</span><span class="op">,</span>&nbsp;<span class="num">0xe5de1c2</span><span class="op">,</span>&nbsp;<span class="num">0xeab466b</span><span class="op">,</span>&nbsp;<span class="num">0x2fc513c</span><span class="op">,</span>&nbsp;<span class="num">0x407f75c</span><span class="op">,</span>&nbsp;<span class="num">0xbaab133</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x9705fe9</span><span class="op">,</span>&nbsp;<span class="num">0xb88b8e7</span><span class="op">,</span>&nbsp;<span class="num">0x734c993</span><span class="op">,</span>&nbsp;<span class="num">0x1e1ff8f</span><span class="op">,</span>&nbsp;<span class="num">0x19156970</span><span class="op">,</span>&nbsp;<span class="num">0xabd0f00</span><span class="op">,</span>&nbsp;<span class="num">0x10469ea7</span><span class="op">,</span>&nbsp;<span class="num">0x3293ac0</span><span class="op">,</span>&nbsp;<span class="num">0xcdc98aa</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1d843fd</span><span class="op">,</span>&nbsp;<span class="num">0xe14bfe8</span><span class="op">,</span>&nbsp;<span class="num">0x15be825f</span><span class="op">,</span>&nbsp;<span class="num">0x8b5212</span><span class="op">,</span>&nbsp;<span class="num">0xeb3fb67</span><span class="op">,</span>&nbsp;<span class="num">0x81cbd29</span><span class="op">,</span>&nbsp;<span class="num">0xbc62f16</span><span class="op">,</span>&nbsp;<span class="num">0x2b6fcc7</span><span class="op">,</span>&nbsp;<span class="num">0xf5a4e29</span><span class="op">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x13560b66</span><span class="op">,</span>&nbsp;<span class="num">0xc0b6ac2</span><span class="op">,</span>&nbsp;<span class="num">0x51ae690</span><span class="op">,</span>&nbsp;<span class="num">0xd41e271</span><span class="op">,</span>&nbsp;<span class="num">0xf3e9bd4</span><span class="op">,</span>&nbsp;<span class="num">0x1d70aab</span><span class="op">,</span>&nbsp;<span class="num">0x1029f72</span><span class="op">,</span>&nbsp;<span class="num">0x73e1c35</span><span class="op">,</span>&nbsp;<span class="num">0xee70fbc</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xad81baf</span><span class="op">,</span>&nbsp;<span class="num">0x9ecc49a</span><span class="op">,</span>&nbsp;<span class="num">0x86c741e</span><span class="op">,</span>&nbsp;<span class="num">0xfe6be30</span><span class="op">,</span>&nbsp;<span class="num">0x176752e7</span><span class="op">,</span>&nbsp;<span class="num">0x23d416</span><span class="op">,</span>&nbsp;<span class="num">0x1f83de85</span><span class="op">,</span>&nbsp;<span class="num">0x27de188</span><span class="op">,</span>&nbsp;<span class="num">0x66f70b8</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x181cd51f</span><span class="op">,</span>&nbsp;<span class="num">0x96b6e4c</span><span class="op">,</span>&nbsp;<span class="num">0x188f2335</span><span class="op">,</span>&nbsp;<span class="num">0xa5df759</span><span class="op">,</span>&nbsp;<span class="num">0x17a77eb6</span><span class="op">,</span>&nbsp;<span class="num">0xfeb0e73</span><span class="op">,</span>&nbsp;<span class="num">0x154ae914</span><span class="op">,</span>&nbsp;<span class="num">0x2f3ec51</span><span class="op">,</span>&nbsp;<span class="num">0x3826b59</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xb91f17d</span><span class="op">,</span>&nbsp;<span class="num">0x1c72949</span><span class="op">,</span>&nbsp;<span class="num">0x1362bf0a</span><span class="op">,</span>&nbsp;<span class="num">0xe23fddf</span><span class="op">,</span>&nbsp;<span class="num">0xa5614b0</span><span class="op">,</span>&nbsp;<span class="num">0xf7d8f</span><span class="op">,</span>&nbsp;<span class="num">0x79061</span><span class="op">,</span>&nbsp;<span class="num">0x823d9d2</span><span class="op">,</span>&nbsp;<span class="num">0x8213f39</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1128ae0b</span><span class="op">,</span>&nbsp;<span class="num">0xd095d05</span><span class="op">,</span>&nbsp;<span class="num">0xb85c0c2</span><span class="op">,</span>&nbsp;<span class="num">0x1ecb2ef</span><span class="op">,</span>&nbsp;<span class="num">0x24ddc84</span><span class="op">,</span>&nbsp;<span class="num">0xe35e901</span><span class="op">,</span>&nbsp;<span class="num">0x18411a4a</span><span class="op">,</span>&nbsp;<span class="num">0xf5ddc3d</span><span class="op">,</span>&nbsp;<span class="num">0x3786689</span><span class="op">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x52260e8</span><span class="op">,</span>&nbsp;<span class="num">0x5ae3564</span><span class="op">,</span>&nbsp;<span class="num">0x542b10d</span><span class="op">,</span>&nbsp;<span class="num">0x8d93a45</span><span class="op">,</span>&nbsp;<span class="num">0x19952aa4</span><span class="op">,</span>&nbsp;<span class="num">0x996cc41</span><span class="op">,</span>&nbsp;<span class="num">0x1051a729</span><span class="op">,</span>&nbsp;<span class="num">0x4be3499</span><span class="op">,</span>&nbsp;<span class="num">0x52b23aa</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x109f307e</span><span class="op">,</span>&nbsp;<span class="num">0x6f5b6bb</span><span class="op">,</span>&nbsp;<span class="num">0x1f84e1e7</span><span class="op">,</span>&nbsp;<span class="num">0x77a0cfa</span><span class="op">,</span>&nbsp;<span class="num">0x10c4df3f</span><span class="op">,</span>&nbsp;<span class="num">0x25a02ea</span><span class="op">,</span>&nbsp;<span class="num">0xb048035</span><span class="op">,</span>&nbsp;<span class="num">0xe31de66</span><span class="op">,</span>&nbsp;<span class="num">0xc6ecaa3</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x28ea335</span><span class="op">,</span>&nbsp;<span class="num">0x2886024</span><span class="op">,</span>&nbsp;<span class="num">0x1372f020</span><span class="op">,</span>&nbsp;<span class="num">0xf55d35</span><span class="op">,</span>&nbsp;<span class="num">0x15e4684c</span><span class="op">,</span>&nbsp;<span class="num">0xf2a9e17</span><span class="op">,</span>&nbsp;<span class="num">0x1a4a7529</span><span class="op">,</span>&nbsp;<span class="num">0xcb7beb1</span><span class="op">,</span>&nbsp;<span class="num">0xb2a78a1</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1ab21f1f</span><span class="op">,</span>&nbsp;<span class="num">0x6361ccf</span><span class="op">,</span>&nbsp;<span class="num">0x6c9179d</span><span class="op">,</span>&nbsp;<span class="num">0xb135627</span><span class="op">,</span>&nbsp;<span class="num">0x1267b974</span><span class="op">,</span>&nbsp;<span class="num">0x4408bad</span><span class="op">,</span>&nbsp;<span class="num">0x1cbff658</span><span class="op">,</span>&nbsp;<span class="num">0xe3d6511</span><span class="op">,</span>&nbsp;<span class="num">0xc7d76f</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1cc7a69</span><span class="op">,</span>&nbsp;<span class="num">0xe7ee31b</span><span class="op">,</span>&nbsp;<span class="num">0x54fab4f</span><span class="op">,</span>&nbsp;<span class="num">0x2b914f</span><span class="op">,</span>&nbsp;<span class="num">0x1ad27a30</span><span class="op">,</span>&nbsp;<span class="num">0xcd3579e</span><span class="op">,</span>&nbsp;<span class="num">0xc50124c</span><span class="op">,</span>&nbsp;<span class="num">0x50daa90</span><span class="op">,</span>&nbsp;<span class="num">0xb13f72</span><span class="op">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xb06aa75</span><span class="op">,</span>&nbsp;<span class="num">0x70f5cc6</span><span class="op">,</span>&nbsp;<span class="num">0x1649e5aa</span><span class="op">,</span>&nbsp;<span class="num">0x84a5312</span><span class="op">,</span>&nbsp;<span class="num">0x329043c</span><span class="op">,</span>&nbsp;<span class="num">0x41c4011</span><span class="op">,</span>&nbsp;<span class="num">0x13d32411</span><span class="op">,</span>&nbsp;<span class="num">0xb04a838</span><span class="op">,</span>&nbsp;<span class="num">0xd760d2d</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1713b532</span><span class="op">,</span>&nbsp;<span class="num">0xbaa0c03</span><span class="op">,</span>&nbsp;<span class="num">0x84022ab</span><span class="op">,</span>&nbsp;<span class="num">0x6bcf5c1</span><span class="op">,</span>&nbsp;<span class="num">0x2f45379</span><span class="op">,</span>&nbsp;<span class="num">0x18ae070</span><span class="op">,</span>&nbsp;<span class="num">0x18c9e11e</span><span class="op">,</span>&nbsp;<span class="num">0x20bca9a</span><span class="op">,</span>&nbsp;<span class="num">0x66f496b</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x3eef294</span><span class="op">,</span>&nbsp;<span class="num">0x67500d2</span><span class="op">,</span>&nbsp;<span class="num">0xd7f613c</span><span class="op">,</span>&nbsp;<span class="num">0x2dbbeb</span><span class="op">,</span>&nbsp;<span class="num">0xb741038</span><span class="op">,</span>&nbsp;<span class="num">0xe04133f</span><span class="op">,</span>&nbsp;<span class="num">0x1582968d</span><span class="op">,</span>&nbsp;<span class="num">0xbe985f7</span><span class="op">,</span>&nbsp;<span class="num">0x1acbc1a</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1a6a939f</span><span class="op">,</span>&nbsp;<span class="num">0x33e50f6</span><span class="op">,</span>&nbsp;<span class="num">0xd665ed4</span><span class="op">,</span>&nbsp;<span class="num">0xb4b7bd6</span><span class="op">,</span>&nbsp;<span class="num">0x1e5a3799</span><span class="op">,</span>&nbsp;<span class="num">0x6b33847</span><span class="op">,</span>&nbsp;<span class="num">0x17fa56ff</span><span class="op">,</span>&nbsp;<span class="num">0x65ef930</span><span class="op">,</span>&nbsp;<span class="num">0x21dc4a</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x2b37659</span><span class="op">,</span>&nbsp;<span class="num">0x450fe17</span><span class="op">,</span>&nbsp;<span class="num">0xb357b65</span><span class="op">,</span>&nbsp;<span class="num">0xdf5efac</span><span class="op">,</span>&nbsp;<span class="num">0x15397bef</span><span class="op">,</span>&nbsp;<span class="num">0x9d35a7f</span><span class="op">,</span>&nbsp;<span class="num">0x112ac15f</span><span class="op">,</span>&nbsp;<span class="num">0x624e62e</span><span class="op">,</span>&nbsp;<span class="num">0xa90ae2f</span><span class="op">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x107eecd2</span><span class="op">,</span>&nbsp;<span class="num">0x1f69bbe</span><span class="op">,</span>&nbsp;<span class="num">0x77d6bce</span><span class="op">,</span>&nbsp;<span class="num">0x5741394</span><span class="op">,</span>&nbsp;<span class="num">0x13c684fc</span><span class="op">,</span>&nbsp;<span class="num">0x950c910</span><span class="op">,</span>&nbsp;<span class="num">0x725522b</span><span class="op">,</span>&nbsp;<span class="num">0xdc78583</span><span class="op">,</span>&nbsp;<span class="num">0x40eeabb</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1fde328a</span><span class="op">,</span>&nbsp;<span class="num">0xbd61d96</span><span class="op">,</span>&nbsp;<span class="num">0xd28c387</span><span class="op">,</span>&nbsp;<span class="num">0x9e77d89</span><span class="op">,</span>&nbsp;<span class="num">0x12550c40</span><span class="op">,</span>&nbsp;<span class="num">0x759cb7d</span><span class="op">,</span>&nbsp;<span class="num">0x367ef34</span><span class="op">,</span>&nbsp;<span class="num">0xae2a960</span><span class="op">,</span>&nbsp;<span class="num">0x91b8bdc</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x93462a9</span><span class="op">,</span>&nbsp;<span class="num">0xf469ef</span><span class="op">,</span>&nbsp;<span class="num">0xb2e9aef</span><span class="op">,</span>&nbsp;<span class="num">0xd2ca771</span><span class="op">,</span>&nbsp;<span class="num">0x54e1f42</span><span class="op">,</span>&nbsp;<span class="num">0x7aaa49</span><span class="op">,</span>&nbsp;<span class="num">0x6316abb</span><span class="op">,</span>&nbsp;<span class="num">0x2413c8e</span><span class="op">,</span>&nbsp;<span class="num">0x5425bf9</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1bed3e3a</span><span class="op">,</span>&nbsp;<span class="num">0xf272274</span><span class="op">,</span>&nbsp;<span class="num">0x1f5e7326</span><span class="op">,</span>&nbsp;<span class="num">0x6416517</span><span class="op">,</span>&nbsp;<span class="num">0xea27072</span><span class="op">,</span>&nbsp;<span class="num">0x9cedea7</span><span class="op">,</span>&nbsp;<span class="num">0x6e7633</span><span class="op">,</span>&nbsp;<span class="num">0x7c91952</span><span class="op">,</span>&nbsp;<span class="num">0xd806dce</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x8e2a7e1</span><span class="op">,</span>&nbsp;<span class="num">0xe421e1a</span><span class="op">,</span>&nbsp;<span class="num">0x418c9e1</span><span class="op">,</span>&nbsp;<span class="num">0x1dbc890</span><span class="op">,</span>&nbsp;<span class="num">0x1b395c36</span><span class="op">,</span>&nbsp;<span class="num">0xa1dc175</span><span class="op">,</span>&nbsp;<span class="num">0x1dc4ef73</span><span class="op">,</span>&nbsp;<span class="num">0x8956f34</span><span class="op">,</span>&nbsp;<span class="num">0xe4b5cf2</span><span class="op">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1b0d3a18</span><span class="op">,</span>&nbsp;<span class="num">0x3194a36</span><span class="op">,</span>&nbsp;<span class="num">0x6c2641f</span><span class="op">,</span>&nbsp;<span class="num">0xe44124c</span><span class="op">,</span>&nbsp;<span class="num">0xa2f4eaa</span><span class="op">,</span>&nbsp;<span class="num">0xa8c25ba</span><span class="op">,</span>&nbsp;<span class="num">0xf927ed7</span><span class="op">,</span>&nbsp;<span class="num">0x627b614</span><span class="op">,</span>&nbsp;<span class="num">0x7371cca</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xba16694</span><span class="op">,</span>&nbsp;<span class="num">0x417bc03</span><span class="op">,</span>&nbsp;<span class="num">0x7c0a7e3</span><span class="op">,</span>&nbsp;<span class="num">0x9c35c19</span><span class="op">,</span>&nbsp;<span class="num">0x1168a205</span><span class="op">,</span>&nbsp;<span class="num">0x8b6b00d</span><span class="op">,</span>&nbsp;<span class="num">0x10e3edc9</span><span class="op">,</span>&nbsp;<span class="num">0x9c19bf2</span><span class="op">,</span>&nbsp;<span class="num">0x5882229</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1b2b4162</span><span class="op">,</span>&nbsp;<span class="num">0xa5cef1a</span><span class="op">,</span>&nbsp;<span class="num">0x1543622b</span><span class="op">,</span>&nbsp;<span class="num">0x9bd433e</span><span class="op">,</span>&nbsp;<span class="num">0x364e04d</span><span class="op">,</span>&nbsp;<span class="num">0x7480792</span><span class="op">,</span>&nbsp;<span class="num">0x5c9b5b3</span><span class="op">,</span>&nbsp;<span class="num">0xe85ff25</span><span class="op">,</span>&nbsp;<span class="num">0x408ef57</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1814cfa4</span><span class="op">,</span>&nbsp;<span class="num">0x121b41b</span><span class="op">,</span>&nbsp;<span class="num">0xd248a0f</span><span class="op">,</span>&nbsp;<span class="num">0x3b05222</span><span class="op">,</span>&nbsp;<span class="num">0x39bb16a</span><span class="op">,</span>&nbsp;<span class="num">0xc75966d</span><span class="op">,</span>&nbsp;<span class="num">0xa038113</span><span class="op">,</span>&nbsp;<span class="num">0xa4a1769</span><span class="op">,</span>&nbsp;<span class="num">0x11fbc6c</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x917e50e</span><span class="op">,</span>&nbsp;<span class="num">0xeec3da8</span><span class="op">,</span>&nbsp;<span class="num">0x169d6eac</span><span class="op">,</span>&nbsp;<span class="num">0x10c1699</span><span class="op">,</span>&nbsp;<span class="num">0xa416153</span><span class="op">,</span>&nbsp;<span class="num">0xf724912</span><span class="op">,</span>&nbsp;<span class="num">0x15cd60b7</span><span class="op">,</span>&nbsp;<span class="num">0x4acbad9</span><span class="op">,</span>&nbsp;<span class="num">0x5efc5fa</span><span class="op">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xf150ed7</span><span class="op">,</span>&nbsp;<span class="num">0x122b51</span><span class="op">,</span>&nbsp;<span class="num">0x1104b40a</span><span class="op">,</span>&nbsp;<span class="num">0xcb7f442</span><span class="op">,</span>&nbsp;<span class="num">0xfbb28ff</span><span class="op">,</span>&nbsp;<span class="num">0x6ac53ca</span><span class="op">,</span>&nbsp;<span class="num">0x196142cc</span><span class="op">,</span>&nbsp;<span class="num">0x7bf0fa9</span><span class="op">,</span>&nbsp;<span class="num">0x957651</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x4e0f215</span><span class="op">,</span>&nbsp;<span class="num">0xed439f8</span><span class="op">,</span>&nbsp;<span class="num">0x3f46bd5</span><span class="op">,</span>&nbsp;<span class="num">0x5ace82f</span><span class="op">,</span>&nbsp;<span class="num">0x110916b6</span><span class="op">,</span>&nbsp;<span class="num">0x6db078</span><span class="op">,</span>&nbsp;<span class="num">0xffd7d57</span><span class="op">,</span>&nbsp;<span class="num">0xf2ecaac</span><span class="op">,</span>&nbsp;<span class="num">0xca86dec</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x15d6b2da</span><span class="op">,</span>&nbsp;<span class="num">0x965ecc9</span><span class="op">,</span>&nbsp;<span class="num">0x1c92b4c2</span><span class="op">,</span>&nbsp;<span class="num">0x1f3811</span><span class="op">,</span>&nbsp;<span class="num">0x1cb080f5</span><span class="op">,</span>&nbsp;<span class="num">0x2d8b804</span><span class="op">,</span>&nbsp;<span class="num">0x19d1c12d</span><span class="op">,</span>&nbsp;<span class="num">0xf20bd46</span><span class="op">,</span>&nbsp;<span class="num">0x1951fa7</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xa3656c3</span><span class="op">,</span>&nbsp;<span class="num">0x523a425</span><span class="op">,</span>&nbsp;<span class="num">0xfcd0692</span><span class="op">,</span>&nbsp;<span class="num">0xd44ddc8</span><span class="op">,</span>&nbsp;<span class="num">0x131f0f5b</span><span class="op">,</span>&nbsp;<span class="num">0xaf80e4a</span><span class="op">,</span>&nbsp;<span class="num">0xcd9fc74</span><span class="op">,</span>&nbsp;<span class="num">0x99bb618</span><span class="op">,</span>&nbsp;<span class="num">0x2db944c</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xa673090</span><span class="op">,</span>&nbsp;<span class="num">0x1c210e1</span><span class="op">,</span>&nbsp;<span class="num">0x178c8d23</span><span class="op">,</span>&nbsp;<span class="num">0x1474383</span><span class="op">,</span>&nbsp;<span class="num">0x10b8743d</span><span class="op">,</span>&nbsp;<span class="num">0x985a55b</span><span class="op">,</span>&nbsp;<span class="num">0x2e74779</span><span class="op">,</span>&nbsp;<span class="num">0x576138</span><span class="op">,</span>&nbsp;<span class="num">0x9587927</span><span class="op">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x133130fa</span><span class="op">,</span>&nbsp;<span class="num">0xbe05516</span><span class="op">,</span>&nbsp;<span class="num">0x9f4d619</span><span class="op">,</span>&nbsp;<span class="num">0xbb62570</span><span class="op">,</span>&nbsp;<span class="num">0x99ec591</span><span class="op">,</span>&nbsp;<span class="num">0xd9468fe</span><span class="op">,</span>&nbsp;<span class="num">0x1d07782d</span><span class="op">,</span>&nbsp;<span class="num">0xfc72e0b</span><span class="op">,</span>&nbsp;<span class="num">0x701b298</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x1863863b</span><span class="op">,</span>&nbsp;<span class="num">0x85954b8</span><span class="op">,</span>&nbsp;<span class="num">0x121a0c36</span><span class="op">,</span>&nbsp;<span class="num">0x9e7fedf</span><span class="op">,</span>&nbsp;<span class="num">0xf64b429</span><span class="op">,</span>&nbsp;<span class="num">0x9b9d71e</span><span class="op">,</span>&nbsp;<span class="num">0x14e2f5d8</span><span class="op">,</span>&nbsp;<span class="num">0xf858d3a</span><span class="op">,</span>&nbsp;<span class="num">0x942eea8</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xda5b765</span><span class="op">,</span>&nbsp;<span class="num">0x6edafff</span><span class="op">,</span>&nbsp;<span class="num">0xa9d18cc</span><span class="op">,</span>&nbsp;<span class="num">0xc65e4ba</span><span class="op">,</span>&nbsp;<span class="num">0x1c747e86</span><span class="op">,</span>&nbsp;<span class="num">0xe4ea915</span><span class="op">,</span>&nbsp;<span class="num">0x1981d7a1</span><span class="op">,</span>&nbsp;<span class="num">0x8395659</span><span class="op">,</span>&nbsp;<span class="num">0x52ed4e2</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x87d43b7</span><span class="op">,</span>&nbsp;<span class="num">0x37ab11b</span><span class="op">,</span>&nbsp;<span class="num">0x19d292ce</span><span class="op">,</span>&nbsp;<span class="num">0xf8d4692</span><span class="op">,</span>&nbsp;<span class="num">0x18c3053f</span><span class="op">,</span>&nbsp;<span class="num">0x8863e13</span><span class="op">,</span>&nbsp;<span class="num">0x4c146c0</span><span class="op">,</span>&nbsp;<span class="num">0x6bdf55a</span><span class="op">,</span>&nbsp;<span class="num">0x4e4457d</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x16152289</span><span class="op">,</span>&nbsp;<span class="num">0xac78ec2</span><span class="op">,</span>&nbsp;<span class="num">0x1a59c5a2</span><span class="op">,</span>&nbsp;<span class="num">0x2028b97</span><span class="op">,</span>&nbsp;<span class="num">0x71c2d01</span><span class="op">,</span>&nbsp;<span class="num">0x295851f</span><span class="op">,</span>&nbsp;<span class="num">0x404747b</span><span class="op">,</span>&nbsp;<span class="num">0x878558d</span><span class="op">,</span>&nbsp;<span class="num">0x7d29aa4</span><span class="op">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0x13d8341f</span><span class="op">,</span>&nbsp;<span class="num">0x8daefd7</span><span class="op">,</span>&nbsp;<span class="num">0x139c972d</span><span class="op">,</span>&nbsp;<span class="num">0x6b7ea75</span><span class="op">,</span>&nbsp;<span class="num">0xd4a9dde</span><span class="op">,</span>&nbsp;<span class="num">0xff163d8</span><span class="op">,</span>&nbsp;<span class="num">0x81d55d7</span><span class="op">,</span>&nbsp;<span class="num">0xa5bef68</span><span class="op">,</span>&nbsp;<span class="num">0xb7b30d8</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0xbe73d6f</span><span class="op">,</span>&nbsp;<span class="num">0xaa88141</span><span class="op">,</span>&nbsp;<span class="num">0xd976c81</span><span class="op">,</span>&nbsp;<span class="num">0x7e7a9cc</span><span class="op">,</span>&nbsp;<span class="num">0x18beb771</span><span class="op">,</span>&nbsp;<span class="num">0xd773cbd</span><span class="op">,</span>&nbsp;<span class="num">0x13f51951</span><span class="op">,</span>&nbsp;<span class="num">0x9d0c177</span><span class="op">,</span>&nbsp;<span class="num">0x1c49a78</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Field&nbsp;element&nbsp;operations:</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;nonZeroToAllOnes&nbsp;returns:</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;0xffffffff&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;2**31</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;0&nbsp;for&nbsp;x&nbsp;==&nbsp;0&nbsp;or&nbsp;x&nbsp;&gt;&nbsp;2**31.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">nonZeroToAllOnes</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="builtintype">uint32</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">(</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">31</span><span class="op">)</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256ReduceCarry&nbsp;adds&nbsp;a&nbsp;multiple&nbsp;of&nbsp;p&nbsp;in&nbsp;order&nbsp;to&nbsp;cancel&nbsp;|carry|,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;which&nbsp;is&nbsp;a&nbsp;term&nbsp;at&nbsp;2**257.</span><br>
<span class="lineno">215</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;carry&nbsp;&lt;&nbsp;2**3,&nbsp;inout[0,2,...]&nbsp;&lt;&nbsp;2**29,&nbsp;inout[1,3,...]&nbsp;&lt;&nbsp;2**28.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;exit:&nbsp;inout[0,2,..]&nbsp;&lt;&nbsp;2**30,&nbsp;inout[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256ReduceCarry</span><span class="op">(</span><span class="ident">inout</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">carry</span>&nbsp;<span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry_mask</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">nonZeroToAllOnes</span><span class="op">(</span><span class="ident">carry</span><span class="op">)</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">inout</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">inout</span><span class="op">[</span><span class="num">3</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="num">0x10000000</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">carry_mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;carry&nbsp;&lt;&nbsp;2**3&nbsp;thus&nbsp;(carry&nbsp;&lt;&lt;&nbsp;11)&nbsp;&lt;&nbsp;2**14&nbsp;and&nbsp;we&nbsp;added&nbsp;2**28&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;previous&nbsp;line&nbsp;therefore&nbsp;this&nbsp;doesn&#39;t&nbsp;underflow.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">inout</span><span class="op">[</span><span class="num">3</span><span class="op">]</span>&nbsp;<span class="op">-=</span>&nbsp;<span class="ident">carry</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">inout</span><span class="op">[</span><span class="num">4</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="num">0x20000000</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">carry_mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">inout</span><span class="op">[</span><span class="num">5</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="num">0x10000000</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">carry_mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">inout</span><span class="op">[</span><span class="num">6</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="num">0x20000000</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">carry_mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">inout</span><span class="op">[</span><span class="num">6</span><span class="op">]</span>&nbsp;<span class="op">-=</span>&nbsp;<span class="ident">carry</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">22</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;This&nbsp;may&nbsp;underflow&nbsp;if&nbsp;carry&nbsp;is&nbsp;non-zero&nbsp;but,&nbsp;if&nbsp;so,&nbsp;we&#39;ll&nbsp;fix&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;next&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">inout</span><span class="op">[</span><span class="num">7</span><span class="op">]</span>&nbsp;<span class="op">-=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">carry_mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">inout</span><span class="op">[</span><span class="num">7</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">25</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256Sum&nbsp;sets&nbsp;out&nbsp;=&nbsp;in+in2.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;entry,&nbsp;in[i]+in2[i]&nbsp;must&nbsp;not&nbsp;overflow&nbsp;a&nbsp;32-bit&nbsp;word.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;exit:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">240</span><span class="keyword">func</span>&nbsp;<span class="ident">p256Sum</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">in2</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">in</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">in2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span><span class="op">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">p256Limbs</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">in</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">in2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ReduceCarry</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">carry</span><span class="op">)</span><br>
<span class="lineno">260</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">const</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">two30m2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">30</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">two30p13m2</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">30</span>&nbsp;<span class="op">+</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">13</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">2</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">two31m2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">31</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">two31p24m2</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">31</span>&nbsp;<span class="op">+</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">24</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">two30m27m2</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">30</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">27</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">&lt;&lt;</span><span class="num">2</span><br>
<span class="lineno"></span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment">//&nbsp;p256Zero31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">p256Zero31</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">{</span><span class="ident">two31m3</span><span class="op">,</span>&nbsp;<span class="ident">two30m2</span><span class="op">,</span>&nbsp;<span class="ident">two31m2</span><span class="op">,</span>&nbsp;<span class="ident">two30p13m2</span><span class="op">,</span>&nbsp;<span class="ident">two31m2</span><span class="op">,</span>&nbsp;<span class="ident">two30m2</span><span class="op">,</span>&nbsp;<span class="ident">two31p24m2</span><span class="op">,</span>&nbsp;<span class="ident">two30m27m2</span><span class="op">,</span>&nbsp;<span class="ident">two31m2</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256Diff&nbsp;sets&nbsp;out&nbsp;=&nbsp;in-in2.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">275</span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;in[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;in[1,3,...]&nbsp;&lt;&nbsp;2**29&nbsp;and</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in2[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;in2[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;exit:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">in2</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">carry</span>&nbsp;<span class="builtintype">uint32</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">in</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">in2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">p256Zero31</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span><span class="op">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">p256Limbs</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">in</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">in2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">p256Zero31</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ReduceCarry</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">carry</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256ReduceDegree&nbsp;sets&nbsp;out&nbsp;=&nbsp;tmp/R&nbsp;mod&nbsp;p&nbsp;where&nbsp;tmp&nbsp;contains&nbsp;64-bit&nbsp;words&nbsp;with</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;the&nbsp;same&nbsp;29,28,...&nbsp;bit&nbsp;positions&nbsp;as&nbsp;an&nbsp;field&nbsp;element.</span><br>
<span class="lineno">305</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;values&nbsp;in&nbsp;field&nbsp;elements&nbsp;are&nbsp;in&nbsp;Montgomery&nbsp;form:&nbsp;x*R&nbsp;mod&nbsp;p&nbsp;where&nbsp;R&nbsp;=</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;2**257.&nbsp;Since&nbsp;we&nbsp;just&nbsp;multiplied&nbsp;two&nbsp;Montgomery&nbsp;values&nbsp;together,&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;is&nbsp;x*y*R*R&nbsp;mod&nbsp;p.&nbsp;We&nbsp;wish&nbsp;to&nbsp;divide&nbsp;by&nbsp;R&nbsp;in&nbsp;order&nbsp;for&nbsp;the&nbsp;result&nbsp;also&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;in&nbsp;Montgomery&nbsp;form.</span><br>
<span class="lineno">310</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;tmp[i]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;exit:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256ReduceDegree</span><span class="op">(</span><span class="ident">out</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">tmp</span>&nbsp;<span class="op">[</span><span class="num">17</span><span class="op">]</span><span class="ident">uint64</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;following&nbsp;table&nbsp;may&nbsp;be&nbsp;helpful&nbsp;when&nbsp;reading&nbsp;this&nbsp;code:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Limb&nbsp;number:&nbsp;&nbsp;&nbsp;0&nbsp;|&nbsp;1&nbsp;|&nbsp;2&nbsp;|&nbsp;3&nbsp;|&nbsp;4&nbsp;|&nbsp;5&nbsp;|&nbsp;6&nbsp;|&nbsp;7&nbsp;|&nbsp;8&nbsp;|&nbsp;9&nbsp;|&nbsp;10...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Width&nbsp;(bits):&nbsp;&nbsp;29|&nbsp;28|&nbsp;29|&nbsp;28|&nbsp;29|&nbsp;28|&nbsp;29|&nbsp;28|&nbsp;29|&nbsp;28|&nbsp;29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Start&nbsp;bit:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;|&nbsp;29|&nbsp;57|&nbsp;86|114|143|171|200|228|257|285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;(odd&nbsp;phase):&nbsp;0&nbsp;|&nbsp;28|&nbsp;57|&nbsp;85|114|142|171|199|228|256|285</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">tmp2</span>&nbsp;<span class="op">[</span><span class="num">18</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">carry</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">xMask</span>&nbsp;<span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;tmp&nbsp;contains&nbsp;64-bit&nbsp;words&nbsp;with&nbsp;the&nbsp;same&nbsp;29,28,29-bit&nbsp;positions&nbsp;as&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;field&nbsp;element.&nbsp;So&nbsp;the&nbsp;top&nbsp;of&nbsp;an&nbsp;element&nbsp;of&nbsp;tmp&nbsp;might&nbsp;overlap&nbsp;with</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;another&nbsp;element&nbsp;two&nbsp;positions&nbsp;down.&nbsp;The&nbsp;following&nbsp;loop&nbsp;eliminates</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;this&nbsp;overlap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="op">(</span><span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">&gt;&gt;</span><span class="num">32</span><span class="op">)</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">3</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">2</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">17</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="ident">i</span><span class="op">-</span><span class="num">2</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">32</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="ident">i</span><span class="op">-</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="ident">i</span><span class="op">-</span><span class="num">1</span><span class="op">]</span><span class="op">&gt;&gt;</span><span class="num">32</span><span class="op">)</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">4</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span><span class="op">++</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">17</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="ident">i</span><span class="op">-</span><span class="num">2</span><span class="op">]</span><span class="op">&gt;&gt;</span><span class="num">32</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="ident">i</span><span class="op">-</span><span class="num">1</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="op">(</span><span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="ident">i</span><span class="op">-</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">32</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">3</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="num">17</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="num">15</span><span class="op">]</span><span class="op">&gt;&gt;</span><span class="num">32</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="num">17</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="num">16</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="num">17</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">tmp</span><span class="op">[</span><span class="num">16</span><span class="op">]</span><span class="op">&gt;&gt;</span><span class="num">32</span><span class="op">)</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">3</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="num">17</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Montgomery&nbsp;elimination&nbsp;of&nbsp;terms:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Since&nbsp;R&nbsp;is&nbsp;2**257,&nbsp;we&nbsp;can&nbsp;divide&nbsp;by&nbsp;R&nbsp;with&nbsp;a&nbsp;bitwise&nbsp;shift&nbsp;if&nbsp;we&nbsp;can</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;ensure&nbsp;that&nbsp;the&nbsp;right-most&nbsp;257&nbsp;bits&nbsp;are&nbsp;all&nbsp;zero.&nbsp;We&nbsp;can&nbsp;make&nbsp;that&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;by&nbsp;adding&nbsp;multiplies&nbsp;of&nbsp;p&nbsp;without&nbsp;affecting&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;So&nbsp;we&nbsp;eliminate&nbsp;limbs&nbsp;from&nbsp;right&nbsp;to&nbsp;left.&nbsp;Since&nbsp;the&nbsp;bottom&nbsp;29&nbsp;bits&nbsp;of&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;are&nbsp;all&nbsp;ones,&nbsp;then&nbsp;by&nbsp;adding&nbsp;tmp2[0]*p&nbsp;to&nbsp;tmp2&nbsp;we&#39;ll&nbsp;make&nbsp;tmp2[0]&nbsp;==&nbsp;0.</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;We&nbsp;can&nbsp;do&nbsp;that&nbsp;for&nbsp;8&nbsp;further&nbsp;limbs&nbsp;and&nbsp;then&nbsp;right&nbsp;shift&nbsp;to&nbsp;eliminate&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;extra&nbsp;factor&nbsp;of&nbsp;R.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="num">2</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">xMask</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nonZeroToAllOnes</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;bounds&nbsp;calculations&nbsp;for&nbsp;this&nbsp;loop&nbsp;are&nbsp;tricky.&nbsp;Each&nbsp;iteration&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;the&nbsp;loop&nbsp;eliminates&nbsp;two&nbsp;words&nbsp;by&nbsp;adding&nbsp;values&nbsp;to&nbsp;words&nbsp;to&nbsp;their</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;following&nbsp;table&nbsp;contains&nbsp;the&nbsp;amounts&nbsp;added&nbsp;to&nbsp;each&nbsp;word&nbsp;(as&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;offset&nbsp;from&nbsp;the&nbsp;value&nbsp;of&nbsp;i&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;loop).&nbsp;The&nbsp;amounts&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;accounted&nbsp;for&nbsp;from&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;half&nbsp;of&nbsp;the&nbsp;loop&nbsp;separately</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;and&nbsp;are&nbsp;written&nbsp;as,&nbsp;for&nbsp;example,&nbsp;28&nbsp;to&nbsp;mean&nbsp;a&nbsp;value&nbsp;&lt;2**28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Word:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Added&nbsp;in&nbsp;top&nbsp;half:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29&nbsp;&nbsp;21&nbsp;&nbsp;29&nbsp;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;29</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Added&nbsp;in&nbsp;bottom&nbsp;half:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;21&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;value&nbsp;that&nbsp;is&nbsp;currently&nbsp;offset&nbsp;7&nbsp;will&nbsp;be&nbsp;offset&nbsp;5&nbsp;for&nbsp;the&nbsp;next</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;iteration&nbsp;and&nbsp;then&nbsp;offset&nbsp;3&nbsp;for&nbsp;the&nbsp;iteration&nbsp;after&nbsp;that.&nbsp;Therefore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;the&nbsp;total&nbsp;value&nbsp;added&nbsp;will&nbsp;be&nbsp;the&nbsp;values&nbsp;added&nbsp;at&nbsp;7,&nbsp;5&nbsp;and&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;following&nbsp;table&nbsp;accumulates&nbsp;these&nbsp;values.&nbsp;The&nbsp;sums&nbsp;at&nbsp;the&nbsp;bottom</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;are&nbsp;written&nbsp;as,&nbsp;for&nbsp;example,&nbsp;29+28,&nbsp;to&nbsp;mean&nbsp;a&nbsp;value&nbsp;&lt;&nbsp;2**29+2**28.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Word:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;10&nbsp;&nbsp;11&nbsp;&nbsp;12&nbsp;&nbsp;13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;11&nbsp;&nbsp;10&nbsp;&nbsp;29&nbsp;&nbsp;21&nbsp;&nbsp;29&nbsp;&nbsp;28&nbsp;&nbsp;28&nbsp;&nbsp;28&nbsp;&nbsp;28&nbsp;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29&nbsp;&nbsp;28&nbsp;&nbsp;11&nbsp;&nbsp;28&nbsp;&nbsp;29&nbsp;&nbsp;28&nbsp;&nbsp;29&nbsp;&nbsp;28&nbsp;&nbsp;29&nbsp;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29&nbsp;&nbsp;28&nbsp;&nbsp;21&nbsp;&nbsp;21&nbsp;&nbsp;29&nbsp;&nbsp;21&nbsp;&nbsp;29&nbsp;&nbsp;21</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;29&nbsp;&nbsp;28&nbsp;&nbsp;21&nbsp;&nbsp;28&nbsp;&nbsp;21&nbsp;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;29&nbsp;&nbsp;28&nbsp;&nbsp;29&nbsp;&nbsp;28&nbsp;&nbsp;29&nbsp;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;10&nbsp;&nbsp;29&nbsp;&nbsp;10&nbsp;&nbsp;29&nbsp;&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29&nbsp;&nbsp;28&nbsp;&nbsp;11&nbsp;&nbsp;28&nbsp;&nbsp;11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--------------------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30+&nbsp;31+&nbsp;30+&nbsp;31+&nbsp;30+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28+&nbsp;29+&nbsp;28+&nbsp;29+&nbsp;21+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;21+&nbsp;28+&nbsp;21+&nbsp;28+&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;21+&nbsp;10&nbsp;&nbsp;21+</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;So&nbsp;the&nbsp;greatest&nbsp;amount&nbsp;is&nbsp;added&nbsp;to&nbsp;tmp2[10]&nbsp;and&nbsp;tmp2[12].&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;tmp2[10/12]&nbsp;has&nbsp;an&nbsp;initial&nbsp;value&nbsp;of&nbsp;&lt;2**29,&nbsp;then&nbsp;the&nbsp;maximum&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;will&nbsp;be&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30&nbsp;+&nbsp;2**28&nbsp;+&nbsp;2**21&nbsp;+&nbsp;2**11,&nbsp;which&nbsp;is&nbsp;&lt;&nbsp;2**32,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;as&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">3</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">10</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">4</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">18</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">6</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">21</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">7</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;At&nbsp;position&nbsp;200,&nbsp;which&nbsp;is&nbsp;the&nbsp;starting&nbsp;bit&nbsp;position&nbsp;for&nbsp;word&nbsp;7,&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;have&nbsp;a&nbsp;factor&nbsp;of&nbsp;0xf000000&nbsp;=&nbsp;2**28&nbsp;-&nbsp;2**24.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">7</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="num">0x10000000</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">xMask</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">xMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">7</span><span class="op">]</span>&nbsp;<span class="op">-=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">24</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">-=</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="num">0x20000000</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">xMask</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">-=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">28</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">9</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">xMask</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span><span class="op">+</span><span class="num">1</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">p256Limbs</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">2</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">xMask</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nonZeroToAllOnes</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">4</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">11</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">5</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">18</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">7</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">21</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;At&nbsp;position&nbsp;199,&nbsp;which&nbsp;is&nbsp;the&nbsp;starting&nbsp;bit&nbsp;of&nbsp;the&nbsp;8th&nbsp;word&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;dealing&nbsp;with&nbsp;a&nbsp;context&nbsp;starting&nbsp;on&nbsp;an&nbsp;odd&nbsp;word,&nbsp;we&nbsp;have&nbsp;a&nbsp;factor&nbsp;of</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;0x1e000000&nbsp;=&nbsp;2**29&nbsp;-&nbsp;2**25.&nbsp;Since&nbsp;we&nbsp;have&nbsp;not&nbsp;updated&nbsp;i,&nbsp;the&nbsp;8th</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;word&nbsp;from&nbsp;i+1&nbsp;is&nbsp;i+8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="num">0x20000000</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">xMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">9</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">xMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">-=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">25</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">9</span><span class="op">]</span>&nbsp;<span class="op">-=</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">9</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="num">0x10000000</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">xMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">9</span><span class="op">]</span>&nbsp;<span class="op">-=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">10</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">xMask</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;We&nbsp;merge&nbsp;the&nbsp;right&nbsp;shift&nbsp;with&nbsp;a&nbsp;carry&nbsp;chain.&nbsp;The&nbsp;words&nbsp;above&nbsp;2**257&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;widths&nbsp;of&nbsp;28,29,...&nbsp;which&nbsp;we&nbsp;need&nbsp;to&nbsp;correct&nbsp;when&nbsp;copying&nbsp;them&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">8</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;maximum&nbsp;value&nbsp;of&nbsp;tmp2[i&nbsp;+&nbsp;9]&nbsp;occurs&nbsp;on&nbsp;the&nbsp;first&nbsp;iteration&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;is&nbsp;&lt;&nbsp;2**30+2**29+2**28.&nbsp;Adding&nbsp;2**29&nbsp;(from&nbsp;tmp2[i&nbsp;+&nbsp;10])&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;therefore&nbsp;safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">9</span><span class="op">]</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="op">(</span><span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">10</span><span class="op">]</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">28</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span><span class="op">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">9</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">tmp2</span><span class="op">[</span><span class="num">17</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ReduceCarry</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">carry</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="comment">//&nbsp;p256Square&nbsp;sets&nbsp;out=in*in.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;in[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;in[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;exit:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256Square</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">tmp</span>&nbsp;<span class="op">[</span><span class="num">17</span><span class="op">]</span><span class="ident">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">2</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">3</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">4</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">2</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">5</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">6</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">2</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">7</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;tmp[8]&nbsp;has&nbsp;the&nbsp;greatest&nbsp;value&nbsp;of&nbsp;2**61&nbsp;+&nbsp;2**60&nbsp;+&nbsp;2**61&nbsp;+&nbsp;2**60&nbsp;+&nbsp;2**60,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;which&nbsp;is&nbsp;&lt;&nbsp;2**64&nbsp;as&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">2</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">2</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">9</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">10</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">2</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">11</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">12</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">2</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">13</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">14</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">15</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">16</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ReduceDegree</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256Mul&nbsp;sets&nbsp;out=in*in2.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">555</span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;in[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;in[1,3,...]&nbsp;&lt;&nbsp;2**29&nbsp;and</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in2[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;in2[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;exit:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256Mul</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">in2</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">tmp</span>&nbsp;<span class="op">[</span><span class="num">17</span><span class="op">]</span><span class="ident">uint64</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">2</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">3</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">4</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">5</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">6</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">7</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;tmp[8]&nbsp;has&nbsp;the&nbsp;greatest&nbsp;value&nbsp;but&nbsp;doesn&#39;t&nbsp;overflow.&nbsp;See&nbsp;logic&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;p256Square.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">8</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">9</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">10</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">11</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">12</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">13</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">14</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">15</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">7</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;&lt;</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">[</span><span class="num">16</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">uint64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="op">(</span><span class="ident">uint64</span><span class="op">(</span><span class="ident">in2</span><span class="op">[</span><span class="num">8</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ReduceDegree</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256Assign</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="ident">out</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="ident">in</span><br>
<span class="lineno">650</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256Invert&nbsp;calculates&nbsp;|out|&nbsp;=&nbsp;|in|^{-1}</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Based&nbsp;on&nbsp;Fermat&#39;s&nbsp;Little&nbsp;Theorem:</span><br>
<span class="lineno">655</span><span class="comment">//&nbsp;&nbsp;&nbsp;a^p&nbsp;=&nbsp;a&nbsp;(mod&nbsp;p)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;a^{p-1}&nbsp;=&nbsp;1&nbsp;(mod&nbsp;p)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;a^{p-2}&nbsp;=&nbsp;a^{-1}&nbsp;(mod&nbsp;p)</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256Invert</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="ident">ftmp2</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;each&nbsp;e_I&nbsp;will&nbsp;hold&nbsp;|in|^{2^I&nbsp;-&nbsp;1}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">e2</span><span class="op">,</span>&nbsp;<span class="ident">e4</span><span class="op">,</span>&nbsp;<span class="ident">e8</span><span class="op">,</span>&nbsp;<span class="ident">e16</span><span class="op">,</span>&nbsp;<span class="ident">e32</span><span class="op">,</span>&nbsp;<span class="ident">e64</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^2&nbsp;-&nbsp;2^0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Assign</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">e2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^3&nbsp;-&nbsp;2^1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^4&nbsp;-&nbsp;2^2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e2</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^4&nbsp;-&nbsp;2^0</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Assign</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">e4</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^5&nbsp;-&nbsp;2^1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^6&nbsp;-&nbsp;2^2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^7&nbsp;-&nbsp;2^3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^8&nbsp;-&nbsp;2^4</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e4</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^8&nbsp;-&nbsp;2^0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Assign</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">e8</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">8</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="comment">//&nbsp;2^16&nbsp;-&nbsp;2^8</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e8</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^16&nbsp;-&nbsp;2^0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Assign</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">e16</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">16</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="comment">//&nbsp;2^32&nbsp;-&nbsp;2^16</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e16</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^32&nbsp;-&nbsp;2^0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Assign</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">e32</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">32</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="comment">//&nbsp;2^64&nbsp;-&nbsp;2^32</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Assign</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">e64</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^64&nbsp;-&nbsp;2^32&nbsp;+&nbsp;2^0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">192</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="comment">//&nbsp;2^256&nbsp;-&nbsp;2^224&nbsp;+&nbsp;2^192</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e64</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e32</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^64&nbsp;-&nbsp;2^0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">16</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="comment">//&nbsp;2^80&nbsp;-&nbsp;2^16</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e16</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^80&nbsp;-&nbsp;2^0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">8</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="comment">//&nbsp;2^88&nbsp;-&nbsp;2^8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e8</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^88&nbsp;-&nbsp;2^0</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">4</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="comment">//&nbsp;2^92&nbsp;-&nbsp;2^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e4</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^92&nbsp;-&nbsp;2^0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^93&nbsp;-&nbsp;2^1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^94&nbsp;-&nbsp;2^2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">e2</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^94&nbsp;-&nbsp;2^0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^95&nbsp;-&nbsp;2^1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2^96&nbsp;-&nbsp;2^2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span>&nbsp;&nbsp;<span class="comment">//&nbsp;2^96&nbsp;-&nbsp;3</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ftmp</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2^256&nbsp;-&nbsp;2^224&nbsp;+&nbsp;2^192&nbsp;+&nbsp;2^96&nbsp;-&nbsp;3</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256Scalar3&nbsp;sets&nbsp;out=3*out.</span><br>
<span class="lineno">720</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;exit:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256Scalar3</span><span class="op">(</span><span class="ident">out</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">carry</span>&nbsp;<span class="builtintype">uint32</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">*=</span>&nbsp;<span class="num">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span><span class="op">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">p256Limbs</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">*=</span>&nbsp;<span class="num">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ReduceCarry</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">carry</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256Scalar4&nbsp;sets&nbsp;out=4*out.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;exit:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno">750</span><span class="keyword">func</span>&nbsp;<span class="ident">p256Scalar4</span><span class="op">(</span><span class="ident">out</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">carry</span><span class="op">,</span>&nbsp;<span class="ident">nextCarry</span>&nbsp;<span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nextCarry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">27</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&lt;&lt;=</span>&nbsp;<span class="num">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nextCarry</span>&nbsp;<span class="op">+</span>&nbsp;<span class="op">(</span><span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span><span class="op">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">p256Limbs</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nextCarry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">26</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&lt;&lt;=</span>&nbsp;<span class="num">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nextCarry</span>&nbsp;<span class="op">+</span>&nbsp;<span class="op">(</span><span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><span class="op">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ReduceCarry</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">carry</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">775</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256Scalar8&nbsp;sets&nbsp;out=8*out.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;exit:&nbsp;out[0,2,...]&nbsp;&lt;&nbsp;2**30,&nbsp;out[1,3,...]&nbsp;&lt;&nbsp;2**29.</span><br>
<span class="lineno">780</span><span class="keyword">func</span>&nbsp;<span class="ident">p256Scalar8</span><span class="op">(</span><span class="ident">out</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">carry</span><span class="op">,</span>&nbsp;<span class="ident">nextCarry</span>&nbsp;<span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nextCarry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">26</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&lt;&lt;=</span>&nbsp;<span class="num">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nextCarry</span>&nbsp;<span class="op">+</span>&nbsp;<span class="op">(</span><span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">29</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span><span class="op">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">p256Limbs</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nextCarry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&lt;&lt;=</span>&nbsp;<span class="num">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="ident">carry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">carry</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nextCarry</span>&nbsp;<span class="op">+</span>&nbsp;<span class="op">(</span><span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">28</span><span class="op">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256ReduceCarry</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">carry</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">805</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Group&nbsp;operations:</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Elements&nbsp;of&nbsp;the&nbsp;elliptic&nbsp;curve&nbsp;group&nbsp;are&nbsp;represented&nbsp;in&nbsp;Jacobian</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;coordinates:&nbsp;(x,&nbsp;y,&nbsp;z).&nbsp;An&nbsp;affine&nbsp;point&nbsp;(x&#39;,&nbsp;y&#39;)&nbsp;is&nbsp;x&#39;=x/z**2,&nbsp;y&#39;=y/z**3&nbsp;in</span><br>
<span class="lineno">810</span><span class="comment">//&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256PointDouble&nbsp;sets&nbsp;{xOut,yOut,zOut}&nbsp;=&nbsp;2*{x,y,z}.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#doubling-dbl-2009-l</span><br>
<span class="lineno">815</span><span class="keyword">func</span>&nbsp;<span class="ident">p256PointDouble</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">delta</span><span class="op">,</span>&nbsp;<span class="ident">gamma</span><span class="op">,</span>&nbsp;<span class="ident">alpha</span><span class="op">,</span>&nbsp;<span class="ident">beta</span><span class="op">,</span>&nbsp;<span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="ident">tmp2</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">delta</span><span class="op">,</span>&nbsp;<span class="ident">z</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">gamma</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">beta</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">gamma</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Sum</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">delta</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp2</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">delta</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">alpha</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp2</span><span class="op">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Scalar3</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">alpha</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Sum</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">z</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">gamma</span><span class="op">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">delta</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Scalar4</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">beta</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">alpha</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">beta</span><span class="op">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">beta</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">beta</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">alpha</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">gamma</span><span class="op">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Scalar8</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp2</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp2</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256PointAddMixed&nbsp;sets&nbsp;{xOut,yOut,zOut}&nbsp;=&nbsp;{x1,y1,z1}&nbsp;+&nbsp;{x2,y2,1}.</span><br>
<span class="lineno">845</span><span class="comment">//&nbsp;(i.e.&nbsp;the&nbsp;second&nbsp;point&nbsp;is&nbsp;affine.)</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#addition-add-2007-bl</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Note&nbsp;that&nbsp;this&nbsp;function&nbsp;does&nbsp;not&nbsp;handle&nbsp;P+P,&nbsp;infinity+P&nbsp;nor&nbsp;P+infinity</span><br>
<span class="lineno">850</span><span class="comment">//&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256PointAddMixed</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="ident">z1</span><span class="op">,</span>&nbsp;<span class="ident">x2</span><span class="op">,</span>&nbsp;<span class="ident">y2</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">z1z1</span><span class="op">,</span>&nbsp;<span class="ident">z1z1z1</span><span class="op">,</span>&nbsp;<span class="ident">s2</span><span class="op">,</span>&nbsp;<span class="ident">u2</span><span class="op">,</span>&nbsp;<span class="ident">h</span><span class="op">,</span>&nbsp;<span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">j</span><span class="op">,</span>&nbsp;<span class="ident">r</span><span class="op">,</span>&nbsp;<span class="ident">rr</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">tmp</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">z1z1</span><span class="op">,</span>&nbsp;<span class="ident">z1</span><span class="op">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Sum</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="ident">z1</span><span class="op">,</span>&nbsp;<span class="ident">z1</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">u2</span><span class="op">,</span>&nbsp;<span class="ident">x2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1z1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">z1z1z1</span><span class="op">,</span>&nbsp;<span class="ident">z1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1z1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">s2</span><span class="op">,</span>&nbsp;<span class="ident">y2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1z1z1</span><span class="op">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">h</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">u2</span><span class="op">,</span>&nbsp;<span class="ident">x1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Sum</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">i</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">h</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">h</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">i</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">j</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">h</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">r</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">s2</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Sum</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">r</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">r</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">r</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">h</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">rr</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">r</span><span class="op">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">rr</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">j</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">)</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">r</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">j</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">880</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256PointAdd&nbsp;sets&nbsp;{xOut,yOut,zOut}&nbsp;=&nbsp;{x1,y1,z1}&nbsp;+&nbsp;{x2,y2,z2}.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#addition-add-2007-bl</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">885</span><span class="comment">//&nbsp;Note&nbsp;that&nbsp;this&nbsp;function&nbsp;does&nbsp;not&nbsp;handle&nbsp;P+P,&nbsp;infinity+P&nbsp;nor&nbsp;P+infinity</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256PointAdd</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="ident">z1</span><span class="op">,</span>&nbsp;<span class="ident">x2</span><span class="op">,</span>&nbsp;<span class="ident">y2</span><span class="op">,</span>&nbsp;<span class="ident">z2</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">z1z1</span><span class="op">,</span>&nbsp;<span class="ident">z1z1z1</span><span class="op">,</span>&nbsp;<span class="ident">z2z2</span><span class="op">,</span>&nbsp;<span class="ident">z2z2z2</span><span class="op">,</span>&nbsp;<span class="ident">s1</span><span class="op">,</span>&nbsp;<span class="ident">s2</span><span class="op">,</span>&nbsp;<span class="ident">u1</span><span class="op">,</span>&nbsp;<span class="ident">u2</span><span class="op">,</span>&nbsp;<span class="ident">h</span><span class="op">,</span>&nbsp;<span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">j</span><span class="op">,</span>&nbsp;<span class="ident">r</span><span class="op">,</span>&nbsp;<span class="ident">rr</span><span class="op">,</span>&nbsp;<span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">tmp</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">z1z1</span><span class="op">,</span>&nbsp;<span class="ident">z1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">z2z2</span><span class="op">,</span>&nbsp;<span class="ident">z2</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">u1</span><span class="op">,</span>&nbsp;<span class="ident">x1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z2z2</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Sum</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="ident">z1</span><span class="op">,</span>&nbsp;<span class="ident">z2</span><span class="op">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1z1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z2z2</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">z2z2z2</span><span class="op">,</span>&nbsp;<span class="ident">z2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z2z2</span><span class="op">)</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">s1</span><span class="op">,</span>&nbsp;<span class="ident">y1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z2z2z2</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">u2</span><span class="op">,</span>&nbsp;<span class="ident">x2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1z1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">z1z1z1</span><span class="op">,</span>&nbsp;<span class="ident">z1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1z1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">s2</span><span class="op">,</span>&nbsp;<span class="ident">y2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">z1z1z1</span><span class="op">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">h</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">u2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">u1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Sum</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">i</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">h</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">h</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">i</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">j</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">h</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">r</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">s2</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">s1</span><span class="op">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Sum</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">r</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">r</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">r</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">v</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">u1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">h</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">rr</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">r</span><span class="op">)</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">rr</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">j</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">v</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">v</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">r</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">s1</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">j</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Diff</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256CopyConditional&nbsp;sets&nbsp;out=in&nbsp;if&nbsp;mask&nbsp;=&nbsp;0xffffffff&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;mask&nbsp;is&nbsp;either&nbsp;0&nbsp;or&nbsp;0xffffffff.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">mask</span>&nbsp;<span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">p256Limbs</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">mask</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">^</span>&nbsp;<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">^=</span>&nbsp;<span class="ident">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256SelectAffinePoint&nbsp;sets&nbsp;{out_x,out_y}&nbsp;to&nbsp;the&nbsp;index&#39;th&nbsp;entry&nbsp;of&nbsp;table.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;index&nbsp;&lt;&nbsp;16,&nbsp;table[0]&nbsp;must&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256SelectAffinePoint</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">table</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">index</span>&nbsp;<span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">xOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">xOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">yOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">yOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">945</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="num">1</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">16</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">^</span>&nbsp;<span class="ident">index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">mask</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">mask</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">1</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span><span class="op">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">xOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">xOut</span><span class="op">[</span><span class="ident">j</span><span class="op">]</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">table</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">table</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">table</span><span class="op">[</span><span class="num">1</span><span class="op">:</span><span class="op">]</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">yOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">yOut</span><span class="op">[</span><span class="ident">j</span><span class="op">]</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">table</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">table</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">table</span><span class="op">[</span><span class="num">1</span><span class="op">:</span><span class="op">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256SelectJacobianPoint&nbsp;sets&nbsp;{out_x,out_y,out_z}&nbsp;to&nbsp;the&nbsp;index&#39;th&nbsp;entry&nbsp;of</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;table.</span><br>
<span class="lineno">965</span><span class="comment">//&nbsp;On&nbsp;entry:&nbsp;index&nbsp;&lt;&nbsp;16,&nbsp;table[0]&nbsp;must&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256SelectJacobianPoint</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">table</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="num">16</span><span class="op">]</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">index</span>&nbsp;<span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">xOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">xOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">yOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">yOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">zOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">zOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;implicit&nbsp;value&nbsp;at&nbsp;index&nbsp;0&nbsp;is&nbsp;all&nbsp;zero.&nbsp;We&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;perform&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;iteration&nbsp;of&nbsp;the&nbsp;loop&nbsp;because&nbsp;we&nbsp;already&nbsp;set&nbsp;out_*&nbsp;to&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="num">1</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">16</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">^</span>&nbsp;<span class="ident">index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">mask</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">mask</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="num">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span><span class="op">--</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">xOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">xOut</span><span class="op">[</span><span class="ident">j</span><span class="op">]</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">table</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">[</span><span class="ident">j</span><span class="op">]</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">yOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">yOut</span><span class="op">[</span><span class="ident">j</span><span class="op">]</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">table</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">[</span><span class="ident">j</span><span class="op">]</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">mask</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">zOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">zOut</span><span class="op">[</span><span class="ident">j</span><span class="op">]</span>&nbsp;<span class="op">|=</span>&nbsp;<span class="ident">table</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">[</span><span class="ident">j</span><span class="op">]</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">995</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256GetBit&nbsp;returns&nbsp;the&nbsp;bit&#39;th&nbsp;bit&nbsp;of&nbsp;scalar.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256GetBit</span><span class="op">(</span><span class="ident">scalar</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="num">32</span><span class="op">]</span><span class="builtintype">uint8</span><span class="op">,</span>&nbsp;<span class="ident">bit</span>&nbsp;<span class="builtintype">uint</span><span class="op">)</span>&nbsp;<span class="builtintype">uint32</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="ident">scalar</span><span class="op">[</span><span class="ident">bit</span><span class="op">&gt;&gt;</span><span class="num">3</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="op">(</span><span class="ident">bit</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="num">7</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="num">1</span><span class="op">)</span><br>
<span class="lineno">1000</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256ScalarBaseMult&nbsp;sets&nbsp;{xOut,yOut,zOut}&nbsp;=&nbsp;scalar*G&nbsp;where&nbsp;scalar&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;little-endian&nbsp;number.&nbsp;Note&nbsp;that&nbsp;the&nbsp;value&nbsp;of&nbsp;scalar&nbsp;must&nbsp;be&nbsp;less&nbsp;than&nbsp;the</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;order&nbsp;of&nbsp;the&nbsp;group.</span><br>
<span class="lineno">1005</span><span class="keyword">func</span>&nbsp;<span class="ident">p256ScalarBaseMult</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">scalar</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="num">32</span><span class="op">]</span><span class="builtintype">uint8</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nIsInfinityMask</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">^</span><span class="builtintype">uint32</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">pIsNoninfiniteMask</span><span class="op">,</span>&nbsp;<span class="ident">mask</span><span class="op">,</span>&nbsp;<span class="ident">tableOffset</span>&nbsp;<span class="builtintype">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">px</span><span class="op">,</span>&nbsp;<span class="ident">py</span><span class="op">,</span>&nbsp;<span class="ident">tx</span><span class="op">,</span>&nbsp;<span class="ident">ty</span><span class="op">,</span>&nbsp;<span class="ident">tz</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">xOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">xOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">yOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">yOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">zOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">zOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;loop&nbsp;adds&nbsp;bits&nbsp;at&nbsp;positions&nbsp;0,&nbsp;64,&nbsp;128&nbsp;and&nbsp;192,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;positions&nbsp;32,96,160&nbsp;and&nbsp;224&nbsp;and&nbsp;does&nbsp;this&nbsp;32&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">32</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointDouble</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tableOffset</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtintype">uint</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">&lt;=</span>&nbsp;<span class="num">32</span><span class="op">;</span>&nbsp;<span class="ident">j</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="num">32</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">bit0</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">p256GetBit</span><span class="op">(</span><span class="ident">scalar</span><span class="op">,</span>&nbsp;<span class="num">31</span><span class="op">-</span><span class="ident">i</span><span class="op">+</span><span class="ident">j</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">bit1</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">p256GetBit</span><span class="op">(</span><span class="ident">scalar</span><span class="op">,</span>&nbsp;<span class="num">95</span><span class="op">-</span><span class="ident">i</span><span class="op">+</span><span class="ident">j</span><span class="op">)</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">bit2</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">p256GetBit</span><span class="op">(</span><span class="ident">scalar</span><span class="op">,</span>&nbsp;<span class="num">159</span><span class="op">-</span><span class="ident">i</span><span class="op">+</span><span class="ident">j</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">bit3</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">p256GetBit</span><span class="op">(</span><span class="ident">scalar</span><span class="op">,</span>&nbsp;<span class="num">223</span><span class="op">-</span><span class="ident">i</span><span class="op">+</span><span class="ident">j</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">index</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">bit0</span>&nbsp;<span class="op">|</span>&nbsp;<span class="op">(</span><span class="ident">bit1</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">|</span>&nbsp;<span class="op">(</span><span class="ident">bit2</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">2</span><span class="op">)</span>&nbsp;<span class="op">|</span>&nbsp;<span class="op">(</span><span class="ident">bit3</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">3</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256SelectAffinePoint</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">px</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">py</span><span class="op">,</span>&nbsp;<span class="ident">p256Precomputed</span><span class="op">[</span><span class="ident">tableOffset</span><span class="op">:</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="ident">index</span><span class="op">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tableOffset</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="num">30</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">p256Limbs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Since&nbsp;scalar&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;group,&nbsp;we&nbsp;know&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;{xOut,yOut,zOut}&nbsp;!=&nbsp;{px,py,1},&nbsp;unless&nbsp;both&nbsp;are&nbsp;zero,&nbsp;which&nbsp;we&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;below.</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointAddMixed</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tx</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ty</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tz</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">px</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">py</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;The&nbsp;result&nbsp;of&nbsp;pointAddMixed&nbsp;is&nbsp;incorrect&nbsp;if&nbsp;{xOut,yOut,zOut}&nbsp;is&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;(a.k.a.&nbsp;&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity).&nbsp;We&nbsp;handle&nbsp;that&nbsp;situation&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;copying&nbsp;the&nbsp;point&nbsp;from&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">px</span><span class="op">,</span>&nbsp;<span class="ident">nIsInfinityMask</span><span class="op">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">py</span><span class="op">,</span>&nbsp;<span class="ident">nIsInfinityMask</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">p256One</span><span class="op">,</span>&nbsp;<span class="ident">nIsInfinityMask</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Equally,&nbsp;the&nbsp;result&nbsp;is&nbsp;also&nbsp;wrong&nbsp;if&nbsp;the&nbsp;point&nbsp;from&nbsp;the&nbsp;table&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;zero,&nbsp;which&nbsp;happens&nbsp;when&nbsp;the&nbsp;index&nbsp;is&nbsp;zero.&nbsp;We&nbsp;handle&nbsp;that&nbsp;by</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;only&nbsp;copying&nbsp;from&nbsp;{tx,ty,tz}&nbsp;to&nbsp;{xOut,yOut,zOut}&nbsp;if&nbsp;index&nbsp;!=&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">pIsNoninfiniteMask</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nonZeroToAllOnes</span><span class="op">(</span><span class="ident">index</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">pIsNoninfiniteMask</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="op">^</span><span class="ident">nIsInfinityMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tx</span><span class="op">,</span>&nbsp;<span class="ident">mask</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ty</span><span class="op">,</span>&nbsp;<span class="ident">mask</span><span class="op">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tz</span><span class="op">,</span>&nbsp;<span class="ident">mask</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;If&nbsp;p&nbsp;was&nbsp;not&nbsp;zero,&nbsp;then&nbsp;n&nbsp;is&nbsp;now&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nIsInfinityMask</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="op">^</span><span class="ident">pIsNoninfiniteMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">1060</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256PointToAffine&nbsp;converts&nbsp;a&nbsp;Jacobian&nbsp;point&nbsp;to&nbsp;an&nbsp;affine&nbsp;point.&nbsp;If&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;is&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;then&nbsp;it&nbsp;returns&nbsp;(0,&nbsp;0)&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256PointToAffine</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">zInv</span><span class="op">,</span>&nbsp;<span class="ident">zInvSq</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Invert</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">zInv</span><span class="op">,</span>&nbsp;<span class="ident">z</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Square</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">zInvSq</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">zInv</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">zInvSq</span><span class="op">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">zInv</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">zInv</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">zInvSq</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256Mul</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">zInv</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256ToAffine&nbsp;returns&nbsp;a&nbsp;pair&nbsp;of&nbsp;*big.Int&nbsp;containing&nbsp;the&nbsp;affine&nbsp;representation</span><br>
<span class="lineno">1075</span><span class="comment">//&nbsp;of&nbsp;{x,y,z}.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256ToAffine</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span>&nbsp;<span class="op">*</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">xx</span><span class="op">,</span>&nbsp;<span class="ident">yy</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointToAffine</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">xx</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">yy</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">,</span>&nbsp;<span class="ident">z</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">p256ToBig</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">xx</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">p256ToBig</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">yy</span><span class="op">)</span><br>
<span class="lineno">1080</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256ScalarMult&nbsp;sets&nbsp;{xOut,yOut,zOut}&nbsp;=&nbsp;scalar*{x,y}.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256ScalarMult</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">scalar</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="num">32</span><span class="op">]</span><span class="builtintype">uint8</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">px</span><span class="op">,</span>&nbsp;<span class="ident">py</span><span class="op">,</span>&nbsp;<span class="ident">pz</span><span class="op">,</span>&nbsp;<span class="ident">tx</span><span class="op">,</span>&nbsp;<span class="ident">ty</span><span class="op">,</span>&nbsp;<span class="ident">tz</span>&nbsp;<span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">precomp</span>&nbsp;<span class="op">[</span><span class="num">16</span><span class="op">]</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">nIsInfinityMask</span><span class="op">,</span>&nbsp;<span class="ident">index</span><span class="op">,</span>&nbsp;<span class="ident">pIsNoninfiniteMask</span><span class="op">,</span>&nbsp;<span class="ident">mask</span>&nbsp;<span class="builtintype">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;We&nbsp;precompute&nbsp;0,1,2,...&nbsp;times&nbsp;{x,y}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">precomp</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="ident">x</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">precomp</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">[</span><span class="num">1</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span><span class="ident">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">precomp</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">[</span><span class="num">2</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p256One</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">2</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">16</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">+=</span>&nbsp;<span class="num">2</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointDouble</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">/</span><span class="num">2</span><span class="op">]</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">/</span><span class="num">2</span><span class="op">]</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">/</span><span class="num">2</span><span class="op">]</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointAddMixed</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">1</span><span class="op">]</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">1</span><span class="op">]</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">+</span><span class="num">1</span><span class="op">]</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">,</span>&nbsp;<span class="ident">x</span><span class="op">,</span>&nbsp;<span class="ident">y</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">xOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">xOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">yOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">yOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">zOut</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">zOut</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nIsInfinityMask</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">^</span><span class="builtintype">uint32</span><span class="op">(</span><span class="num">0</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;We&nbsp;add&nbsp;in&nbsp;a&nbsp;window&nbsp;of&nbsp;four&nbsp;bits&nbsp;each&nbsp;iteration&nbsp;and&nbsp;do&nbsp;this&nbsp;64&nbsp;times.</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">64</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointDouble</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointDouble</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointDouble</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointDouble</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">index</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">scalar</span><span class="op">[</span><span class="num">31</span><span class="op">-</span><span class="ident">i</span><span class="op">/</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">(</span><span class="ident">i</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">index</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="num">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">index</span>&nbsp;<span class="op">&gt;&gt;=</span>&nbsp;<span class="num">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;See&nbsp;the&nbsp;comments&nbsp;in&nbsp;scalarBaseMult&nbsp;about&nbsp;handling&nbsp;infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256SelectJacobianPoint</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">px</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">py</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">pz</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">precomp</span><span class="op">,</span>&nbsp;<span class="ident">index</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256PointAdd</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tx</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ty</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tz</span><span class="op">,</span>&nbsp;<span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">px</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">py</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">pz</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">px</span><span class="op">,</span>&nbsp;<span class="ident">nIsInfinityMask</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">py</span><span class="op">,</span>&nbsp;<span class="ident">nIsInfinityMask</span><span class="op">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">pz</span><span class="op">,</span>&nbsp;<span class="ident">nIsInfinityMask</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">pIsNoninfiniteMask</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">nonZeroToAllOnes</span><span class="op">(</span><span class="ident">index</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">pIsNoninfiniteMask</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="op">^</span><span class="ident">nIsInfinityMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">xOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tx</span><span class="op">,</span>&nbsp;<span class="ident">mask</span><span class="op">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">yOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ty</span><span class="op">,</span>&nbsp;<span class="ident">mask</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p256CopyConditional</span><span class="op">(</span><span class="ident">zOut</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tz</span><span class="op">,</span>&nbsp;<span class="ident">mask</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">nIsInfinityMask</span>&nbsp;<span class="op">&amp;=</span>&nbsp;<span class="op">^</span><span class="ident">pIsNoninfiniteMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256FromBig&nbsp;sets&nbsp;out&nbsp;=&nbsp;R*in.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256FromBig</span><span class="op">(</span><span class="ident">out</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">,</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">*</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><span class="op">.</span><span class="ident">Lsh</span><span class="op">(</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="num">257</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">.</span><span class="ident">Mod</span><span class="op">(</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="ident">p256</span><span class="op">.</span><span class="ident">P</span><span class="op">)</span><br>
<span class="lineno">1145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">p256Limbs</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">bits</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tmp</span><span class="op">.</span><span class="ident">Bits</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">bits</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">bits</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom29Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">.</span><span class="ident">Rsh</span><span class="op">(</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="num">29</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">i</span><span class="op">++</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">p256Limbs</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">bits</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tmp</span><span class="op">.</span><span class="ident">Bits</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">bits</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtintype">uint32</span><span class="op">(</span><span class="ident">bits</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="ident">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">.</span><span class="ident">Rsh</span><span class="op">(</span><span class="ident">tmp</span><span class="op">,</span>&nbsp;<span class="num">28</span><span class="op">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;p256ToBig&nbsp;returns&nbsp;a&nbsp;*big.Int&nbsp;containing&nbsp;the&nbsp;value&nbsp;of&nbsp;in.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">p256ToBig</span><span class="op">(</span><span class="ident">in</span>&nbsp;<span class="op">*</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">]</span><span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">result</span><span class="op">,</span>&nbsp;<span class="ident">tmp</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="builtinfunc">new</span><span class="op">(</span><span class="ident">big</span><span class="op">.</span><span class="ident">Int</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">result</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="ident">int64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="ident">p256Limbs</span><span class="op">-</span><span class="num">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">p256Limbs</span>&nbsp;<span class="op">-</span>&nbsp;<span class="num">2</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">--</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">(</span><span class="ident">i</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="num">1</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">result</span><span class="op">.</span><span class="ident">Lsh</span><span class="op">(</span><span class="ident">result</span><span class="op">,</span>&nbsp;<span class="num">29</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">result</span><span class="op">.</span><span class="ident">Lsh</span><span class="op">(</span><span class="ident">result</span><span class="op">,</span>&nbsp;<span class="num">28</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tmp</span><span class="op">.</span><span class="ident">SetInt64</span><span class="op">(</span><span class="ident">int64</span><span class="op">(</span><span class="ident">in</span><span class="op">[</span><span class="ident">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">result</span><span class="op">.</span><span class="ident">Add</span><span class="op">(</span><span class="ident">result</span><span class="op">,</span>&nbsp;<span class="ident">tmp</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">result</span><span class="op">.</span><span class="ident">Mul</span><span class="op">(</span><span class="ident">result</span><span class="op">,</span>&nbsp;<span class="ident">p256RInverse</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">result</span><span class="op">.</span><span class="ident">Mod</span><span class="op">(</span><span class="ident">result</span><span class="op">,</span>&nbsp;<span class="ident">p256</span><span class="op">.</span><span class="ident">P</span><span class="op">)</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">result</span><br>
<span class="lineno"></span><span class="op">}</span>
</div>
</body>
</html>
