<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/subtle</h2>
<ul>
<li><a href="/gostd/crypto/subtle/constant_time.go.html" class="current">constant_time.go</a></li>
<li><a href="/gostd/crypto/subtle/constant_time_test.go.html">constant_time_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4428065">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4428120">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4428174">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4428225">//&nbsp;Package&nbsp;subtle&nbsp;implements&nbsp;functions&nbsp;that&nbsp;are&nbsp;often&nbsp;useful&nbsp;in&nbsp;cryptographic</span><br>
<span class="lineno"></span><span class="comment" id="4428303">//&nbsp;code&nbsp;but&nbsp;require&nbsp;careful&nbsp;thought&nbsp;to&nbsp;use&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="4428357">package</span>&nbsp;<span class="ident" id="4428365">subtle</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4428373">//&nbsp;ConstantTimeCompare&nbsp;returns&nbsp;1&nbsp;iff&nbsp;the&nbsp;two&nbsp;slices,&nbsp;x</span><br>
<span class="lineno">10</span><span class="comment" id="4428428">//&nbsp;and&nbsp;y,&nbsp;have&nbsp;equal&nbsp;contents.&nbsp;The&nbsp;time&nbsp;taken&nbsp;is&nbsp;a&nbsp;function&nbsp;of&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4428505">//&nbsp;the&nbsp;slices&nbsp;and&nbsp;is&nbsp;independent&nbsp;of&nbsp;the&nbsp;contents.</span><br>
<span class="lineno"></span><span class="keyword" id="4428555">func</span>&nbsp;<span class="ident" id="4428560">ConstantTimeCompare</span><span class="op" id="4428579">(</span><span class="ident" id="4428580">x</span><span class="op" id="4428581">,</span>&nbsp;<span class="ident" id="4428583">y</span>&nbsp;<span class="op" id="4428585">[</span><span class="op" id="4428586">]</span><span class="builtintype" id="4428587">byte</span><span class="op" id="4428591">)</span>&nbsp;<span class="builtintype" id="4428593">int</span>&nbsp;<span class="op" id="4428597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428600">if</span>&nbsp;<span class="builtinfunc" id="4428603">len</span><span class="op" id="4428606">(</span><span class="ident" id="4428607"><a href="/gostd/crypto/subtle/constant_time.go.html#4428580">x</a></span><span class="op" id="4428608">)</span>&nbsp;<span class="op" id="4428610">!=</span>&nbsp;<span class="builtinfunc" id="4428613">len</span><span class="op" id="4428616">(</span><span class="ident" id="4428617"><a href="/gostd/crypto/subtle/constant_time.go.html#4428583">y</a></span><span class="op" id="4428618">)</span>&nbsp;<span class="op" id="4428620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428624">return</span>&nbsp;<span class="num" id="4428631">0</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428638">var</span>&nbsp;<span class="ident" id="4428642">v</span>&nbsp;<span class="builtintype" id="4428644">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428651">for</span>&nbsp;<span class="ident" id="4428655">i</span>&nbsp;<span class="op" id="4428657">:=</span>&nbsp;<span class="num" id="4428660">0</span><span class="op" id="4428661">;</span>&nbsp;<span class="ident" id="4428663"><a href="/gostd/crypto/subtle/constant_time.go.html#4428655">i</a></span>&nbsp;<span class="op" id="4428665">&lt;</span>&nbsp;<span class="builtinfunc" id="4428667">len</span><span class="op" id="4428670">(</span><span class="ident" id="4428671"><a href="/gostd/crypto/subtle/constant_time.go.html#4428580">x</a></span><span class="op" id="4428672">)</span><span class="op" id="4428673">;</span>&nbsp;<span class="ident" id="4428675"><a href="/gostd/crypto/subtle/constant_time.go.html#4428655">i</a></span><span class="op" id="4428676">++</span>&nbsp;<span class="op" id="4428679">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428683"><a href="/gostd/crypto/subtle/constant_time.go.html#4428642">v</a></span>&nbsp;<span class="op" id="4428685">|=</span>&nbsp;<span class="ident" id="4428688"><a href="/gostd/crypto/subtle/constant_time.go.html#4428580">x</a></span><span class="op" id="4428689">[</span><span class="ident" id="4428690"><a href="/gostd/crypto/subtle/constant_time.go.html#4428655">i</a></span><span class="op" id="4428691">]</span>&nbsp;<span class="op" id="4428693">^</span>&nbsp;<span class="ident" id="4428695"><a href="/gostd/crypto/subtle/constant_time.go.html#4428583">y</a></span><span class="op" id="4428696">[</span><span class="ident" id="4428697"><a href="/gostd/crypto/subtle/constant_time.go.html#4428655">i</a></span><span class="op" id="4428698">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428705">return</span>&nbsp;<span class="ident" id="4428712"><a href="/gostd/crypto/subtle/constant_time.go.html#4428992">ConstantTimeByteEq</a></span><span class="op" id="4428730">(</span><span class="ident" id="4428731"><a href="/gostd/crypto/subtle/constant_time.go.html#4428642">v</a></span><span class="op" id="4428732">,</span>&nbsp;<span class="num" id="4428734">0</span><span class="op" id="4428735">)</span><br>
<span class="lineno"></span><span class="op" id="4428737">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4428740">//&nbsp;ConstantTimeSelect&nbsp;returns&nbsp;x&nbsp;if&nbsp;v&nbsp;is&nbsp;1&nbsp;and&nbsp;y&nbsp;if&nbsp;v&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="4428799">//&nbsp;Its&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;if&nbsp;v&nbsp;takes&nbsp;any&nbsp;other&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4428856">func</span>&nbsp;<span class="ident" id="4428861">ConstantTimeSelect</span><span class="op" id="4428879">(</span><span class="ident" id="4428880">v</span><span class="op" id="4428881">,</span>&nbsp;<span class="ident" id="4428883">x</span><span class="op" id="4428884">,</span>&nbsp;<span class="ident" id="4428886">y</span>&nbsp;<span class="builtintype" id="4428888">int</span><span class="op" id="4428891">)</span>&nbsp;<span class="builtintype" id="4428893">int</span>&nbsp;<span class="op" id="4428897">{</span>&nbsp;<span class="keyword" id="4428899">return</span>&nbsp;<span class="op" id="4428906">^</span><span class="op" id="4428907">(</span><span class="ident" id="4428908"><a href="/gostd/crypto/subtle/constant_time.go.html#4428880">v</a></span><span class="op" id="4428909">-</span><span class="num" id="4428910">1</span><span class="op" id="4428911">)</span><span class="op" id="4428912">&amp;</span><span class="ident" id="4428913"><a href="/gostd/crypto/subtle/constant_time.go.html#4428883">x</a></span>&nbsp;<span class="op" id="4428915">|</span>&nbsp;<span class="op" id="4428917">(</span><span class="ident" id="4428918"><a href="/gostd/crypto/subtle/constant_time.go.html#4428880">v</a></span><span class="op" id="4428919">-</span><span class="num" id="4428920">1</span><span class="op" id="4428921">)</span><span class="op" id="4428922">&amp;</span><span class="ident" id="4428923"><a href="/gostd/crypto/subtle/constant_time.go.html#4428886">y</a></span>&nbsp;<span class="op" id="4428925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4428928">//&nbsp;ConstantTimeByteEq&nbsp;returns&nbsp;1&nbsp;if&nbsp;x&nbsp;==&nbsp;y&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="4428987">func</span>&nbsp;<span class="ident" id="4428992">ConstantTimeByteEq</span><span class="op" id="4429010">(</span><span class="ident" id="4429011">x</span><span class="op" id="4429012">,</span>&nbsp;<span class="ident" id="4429014">y</span>&nbsp;<span class="builtintype" id="4429016">uint8</span><span class="op" id="4429021">)</span>&nbsp;<span class="builtintype" id="4429023">int</span>&nbsp;<span class="op" id="4429027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429030">z</span>&nbsp;<span class="op" id="4429032">:=</span>&nbsp;<span class="op" id="4429035">^</span><span class="op" id="4429036">(</span><span class="ident" id="4429037"><a href="/gostd/crypto/subtle/constant_time.go.html#4429011">x</a></span>&nbsp;<span class="op" id="4429039">^</span>&nbsp;<span class="ident" id="4429041"><a href="/gostd/crypto/subtle/constant_time.go.html#4429014">y</a></span><span class="op" id="4429042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429045"><a href="/gostd/crypto/subtle/constant_time.go.html#4429030">z</a></span>&nbsp;<span class="op" id="4429047">&amp;=</span>&nbsp;<span class="ident" id="4429050"><a href="/gostd/crypto/subtle/constant_time.go.html#4429030">z</a></span>&nbsp;<span class="op" id="4429052">&gt;&gt;</span>&nbsp;<span class="num" id="4429055">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429058"><a href="/gostd/crypto/subtle/constant_time.go.html#4429030">z</a></span>&nbsp;<span class="op" id="4429060">&amp;=</span>&nbsp;<span class="ident" id="4429063"><a href="/gostd/crypto/subtle/constant_time.go.html#4429030">z</a></span>&nbsp;<span class="op" id="4429065">&gt;&gt;</span>&nbsp;<span class="num" id="4429068">2</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429071"><a href="/gostd/crypto/subtle/constant_time.go.html#4429030">z</a></span>&nbsp;<span class="op" id="4429073">&amp;=</span>&nbsp;<span class="ident" id="4429076"><a href="/gostd/crypto/subtle/constant_time.go.html#4429030">z</a></span>&nbsp;<span class="op" id="4429078">&gt;&gt;</span>&nbsp;<span class="num" id="4429081">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429085">return</span>&nbsp;<span class="builtintype" id="4429092">int</span><span class="op" id="4429095">(</span><span class="ident" id="4429096"><a href="/gostd/crypto/subtle/constant_time.go.html#4429030">z</a></span><span class="op" id="4429097">)</span><br>
<span class="lineno"></span><span class="op" id="4429099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4429102">//&nbsp;ConstantTimeEq&nbsp;returns&nbsp;1&nbsp;if&nbsp;x&nbsp;==&nbsp;y&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="4429157">func</span>&nbsp;<span class="ident" id="4429162">ConstantTimeEq</span><span class="op" id="4429176">(</span><span class="ident" id="4429177">x</span><span class="op" id="4429178">,</span>&nbsp;<span class="ident" id="4429180">y</span>&nbsp;<span class="builtintype" id="4429182">int32</span><span class="op" id="4429187">)</span>&nbsp;<span class="builtintype" id="4429189">int</span>&nbsp;<span class="op" id="4429193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429196">z</span>&nbsp;<span class="op" id="4429198">:=</span>&nbsp;<span class="op" id="4429201">^</span><span class="op" id="4429202">(</span><span class="ident" id="4429203"><a href="/gostd/crypto/subtle/constant_time.go.html#4429177">x</a></span>&nbsp;<span class="op" id="4429205">^</span>&nbsp;<span class="ident" id="4429207"><a href="/gostd/crypto/subtle/constant_time.go.html#4429180">y</a></span><span class="op" id="4429208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429211"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429213">&amp;=</span>&nbsp;<span class="ident" id="4429216"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429218">&gt;&gt;</span>&nbsp;<span class="num" id="4429221">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429225"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429227">&amp;=</span>&nbsp;<span class="ident" id="4429230"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429232">&gt;&gt;</span>&nbsp;<span class="num" id="4429235">8</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429238"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429240">&amp;=</span>&nbsp;<span class="ident" id="4429243"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429245">&gt;&gt;</span>&nbsp;<span class="num" id="4429248">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429251"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429253">&amp;=</span>&nbsp;<span class="ident" id="4429256"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429258">&gt;&gt;</span>&nbsp;<span class="num" id="4429261">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429264"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429266">&amp;=</span>&nbsp;<span class="ident" id="4429269"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429271">&gt;&gt;</span>&nbsp;<span class="num" id="4429274">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429278">return</span>&nbsp;<span class="builtintype" id="4429285">int</span><span class="op" id="4429288">(</span><span class="ident" id="4429289"><a href="/gostd/crypto/subtle/constant_time.go.html#4429196">z</a></span>&nbsp;<span class="op" id="4429291">&amp;</span>&nbsp;<span class="num" id="4429293">1</span><span class="op" id="4429294">)</span><br>
<span class="lineno">50</span><span class="op" id="4429296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4429299">//&nbsp;ConstantTimeCopy&nbsp;copies&nbsp;the&nbsp;contents&nbsp;of&nbsp;y&nbsp;into&nbsp;x&nbsp;(a&nbsp;slice&nbsp;of&nbsp;equal&nbsp;length)</span><br>
<span class="lineno"></span><span class="comment" id="4429377">//&nbsp;if&nbsp;v&nbsp;==&nbsp;1.&nbsp;If&nbsp;v&nbsp;==&nbsp;0,&nbsp;x&nbsp;is&nbsp;left&nbsp;unchanged.&nbsp;Its&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;if&nbsp;v</span><br>
<span class="lineno"></span><span class="comment" id="4429454">//&nbsp;takes&nbsp;any&nbsp;other&nbsp;value.</span><br>
<span class="lineno">55</span><span class="keyword" id="4429480">func</span>&nbsp;<span class="ident" id="4429485">ConstantTimeCopy</span><span class="op" id="4429501">(</span><span class="ident" id="4429502">v</span>&nbsp;<span class="builtintype" id="4429504">int</span><span class="op" id="4429507">,</span>&nbsp;<span class="ident" id="4429509">x</span><span class="op" id="4429510">,</span>&nbsp;<span class="ident" id="4429512">y</span>&nbsp;<span class="op" id="4429514">[</span><span class="op" id="4429515">]</span><span class="builtintype" id="4429516">byte</span><span class="op" id="4429520">)</span>&nbsp;<span class="op" id="4429522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429525">if</span>&nbsp;<span class="builtinfunc" id="4429528">len</span><span class="op" id="4429531">(</span><span class="ident" id="4429532"><a href="/gostd/crypto/subtle/constant_time.go.html#4429509">x</a></span><span class="op" id="4429533">)</span>&nbsp;<span class="op" id="4429535">!=</span>&nbsp;<span class="builtinfunc" id="4429538">len</span><span class="op" id="4429541">(</span><span class="ident" id="4429542"><a href="/gostd/crypto/subtle/constant_time.go.html#4429512">y</a></span><span class="op" id="4429543">)</span>&nbsp;<span class="op" id="4429545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4429549">panic</span><span class="op" id="4429554">(</span><span class="string" id="4429555">&#34;subtle:&nbsp;slices&nbsp;have&nbsp;different&nbsp;lengths&#34;</span><span class="op" id="4429594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4429597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429601">xmask</span>&nbsp;<span class="op" id="4429607">:=</span>&nbsp;<span class="builtintype" id="4429610">byte</span><span class="op" id="4429614">(</span><span class="ident" id="4429615"><a href="/gostd/crypto/subtle/constant_time.go.html#4429502">v</a></span>&nbsp;<span class="op" id="4429617">-</span>&nbsp;<span class="num" id="4429619">1</span><span class="op" id="4429620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429623">ymask</span>&nbsp;<span class="op" id="4429629">:=</span>&nbsp;<span class="builtintype" id="4429632">byte</span><span class="op" id="4429636">(</span><span class="op" id="4429637">^</span><span class="op" id="4429638">(</span><span class="ident" id="4429639"><a href="/gostd/crypto/subtle/constant_time.go.html#4429502">v</a></span>&nbsp;<span class="op" id="4429641">-</span>&nbsp;<span class="num" id="4429643">1</span><span class="op" id="4429644">)</span><span class="op" id="4429645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429648">for</span>&nbsp;<span class="ident" id="4429652">i</span>&nbsp;<span class="op" id="4429654">:=</span>&nbsp;<span class="num" id="4429657">0</span><span class="op" id="4429658">;</span>&nbsp;<span class="ident" id="4429660"><a href="/gostd/crypto/subtle/constant_time.go.html#4429652">i</a></span>&nbsp;<span class="op" id="4429662">&lt;</span>&nbsp;<span class="builtinfunc" id="4429664">len</span><span class="op" id="4429667">(</span><span class="ident" id="4429668"><a href="/gostd/crypto/subtle/constant_time.go.html#4429509">x</a></span><span class="op" id="4429669">)</span><span class="op" id="4429670">;</span>&nbsp;<span class="ident" id="4429672"><a href="/gostd/crypto/subtle/constant_time.go.html#4429652">i</a></span><span class="op" id="4429673">++</span>&nbsp;<span class="op" id="4429676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429680"><a href="/gostd/crypto/subtle/constant_time.go.html#4429509">x</a></span><span class="op" id="4429681">[</span><span class="ident" id="4429682"><a href="/gostd/crypto/subtle/constant_time.go.html#4429652">i</a></span><span class="op" id="4429683">]</span>&nbsp;<span class="op" id="4429685">=</span>&nbsp;<span class="ident" id="4429687"><a href="/gostd/crypto/subtle/constant_time.go.html#4429509">x</a></span><span class="op" id="4429688">[</span><span class="ident" id="4429689"><a href="/gostd/crypto/subtle/constant_time.go.html#4429652">i</a></span><span class="op" id="4429690">]</span><span class="op" id="4429691">&amp;</span><span class="ident" id="4429692"><a href="/gostd/crypto/subtle/constant_time.go.html#4429601">xmask</a></span>&nbsp;<span class="op" id="4429698">|</span>&nbsp;<span class="ident" id="4429700"><a href="/gostd/crypto/subtle/constant_time.go.html#4429512">y</a></span><span class="op" id="4429701">[</span><span class="ident" id="4429702"><a href="/gostd/crypto/subtle/constant_time.go.html#4429652">i</a></span><span class="op" id="4429703">]</span><span class="op" id="4429704">&amp;</span><span class="ident" id="4429705"><a href="/gostd/crypto/subtle/constant_time.go.html#4429623">ymask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4429712">}</span><br>
<span class="lineno">65</span><span class="op" id="4429714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4429717">//&nbsp;ConstantTimeLessOrEq&nbsp;returns&nbsp;1&nbsp;if&nbsp;x&nbsp;&lt;=&nbsp;y&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4429778">//&nbsp;Its&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;if&nbsp;x&nbsp;or&nbsp;y&nbsp;are&nbsp;negative&nbsp;or&nbsp;&gt;&nbsp;2**31&nbsp;-&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="4429846">func</span>&nbsp;<span class="ident" id="4429851">ConstantTimeLessOrEq</span><span class="op" id="4429871">(</span><span class="ident" id="4429872">x</span><span class="op" id="4429873">,</span>&nbsp;<span class="ident" id="4429875">y</span>&nbsp;<span class="builtintype" id="4429877">int</span><span class="op" id="4429880">)</span>&nbsp;<span class="builtintype" id="4429882">int</span>&nbsp;<span class="op" id="4429886">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429889">x32</span>&nbsp;<span class="op" id="4429893">:=</span>&nbsp;<span class="builtintype" id="4429896">int32</span><span class="op" id="4429901">(</span><span class="ident" id="4429902"><a href="/gostd/crypto/subtle/constant_time.go.html#4429872">x</a></span><span class="op" id="4429903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429906">y32</span>&nbsp;<span class="op" id="4429910">:=</span>&nbsp;<span class="builtintype" id="4429913">int32</span><span class="op" id="4429918">(</span><span class="ident" id="4429919"><a href="/gostd/crypto/subtle/constant_time.go.html#4429875">y</a></span><span class="op" id="4429920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429923">return</span>&nbsp;<span class="builtintype" id="4429930">int</span><span class="op" id="4429933">(</span><span class="op" id="4429934">(</span><span class="op" id="4429935">(</span><span class="ident" id="4429936"><a href="/gostd/crypto/subtle/constant_time.go.html#4429889">x32</a></span>&nbsp;<span class="op" id="4429940">-</span>&nbsp;<span class="ident" id="4429942"><a href="/gostd/crypto/subtle/constant_time.go.html#4429906">y32</a></span>&nbsp;<span class="op" id="4429946">-</span>&nbsp;<span class="num" id="4429948">1</span><span class="op" id="4429949">)</span>&nbsp;<span class="op" id="4429951">&gt;&gt;</span>&nbsp;<span class="num" id="4429954">31</span><span class="op" id="4429956">)</span>&nbsp;<span class="op" id="4429958">&amp;</span>&nbsp;<span class="num" id="4429960">1</span><span class="op" id="4429961">)</span><br>
<span class="lineno"></span><span class="op" id="4429963">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
