<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html</h2>
<ul>
<li><a href="/gostd/html/entity.go.html">entity.go</a></li>
<li><a href="/gostd/html/entity_test.go.html">entity_test.go</a></li>
<li><a href="/gostd/html/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/escape_test.go.html">escape_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6404841">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6404896">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6404950">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6405001">package</span>&nbsp;<span class="ident" id="6405009">html</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6405015">import</span>&nbsp;<span class="op" id="6405022">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6405025">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6405036">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6405051">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6405054">func</span>&nbsp;<span class="ident" id="6405059">TestEntityLength</span><span class="op" id="6405075">(</span><span class="ident" id="6405076">t</span>&nbsp;<span class="op" id="6405078">*</span><span class="ident" id="6405079">testing</span><span class="op" id="6405086">.</span><span class="ident" id="6405087">T</span><span class="op" id="6405088">)</span>&nbsp;<span class="op" id="6405090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6405093">//&nbsp;We&nbsp;verify&nbsp;that&nbsp;the&nbsp;length&nbsp;of&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;each&nbsp;value&nbsp;is&nbsp;&lt;=&nbsp;1&nbsp;+&nbsp;len(key).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6405175">//&nbsp;The&nbsp;+1&nbsp;comes&nbsp;from&nbsp;the&nbsp;leading&nbsp;&#34;&amp;&#34;.&nbsp;This&nbsp;property&nbsp;implies&nbsp;that&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6405255">//&nbsp;unescaped&nbsp;text&nbsp;is&nbsp;&lt;=&nbsp;the&nbsp;length&nbsp;of&nbsp;escaped&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6405308">for</span>&nbsp;<span class="ident" id="6405312">k</span><span class="op" id="6405313">,</span>&nbsp;<span class="ident" id="6405315">v</span>&nbsp;<span class="op" id="6405317">:=</span>&nbsp;<span class="keyword" id="6405320">range</span>&nbsp;<span class="ident" id="6405326">entity</span>&nbsp;<span class="op" id="6405333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6405337">if</span>&nbsp;<span class="num" id="6405340">1</span><span class="op" id="6405341">+</span><span class="builtinfunc" id="6405342">len</span><span class="op" id="6405345">(</span><span class="ident" id="6405346">k</span><span class="op" id="6405347">)</span>&nbsp;<span class="op" id="6405349">&lt;</span>&nbsp;<span class="ident" id="6405351">utf8</span><span class="op" id="6405355">.</span><span class="ident" id="6405356">RuneLen</span><span class="op" id="6405363">(</span><span class="ident" id="6405364">v</span><span class="op" id="6405365">)</span>&nbsp;<span class="op" id="6405367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6405372">t</span><span class="op" id="6405373">.</span><span class="ident" id="6405374">Error</span><span class="op" id="6405379">(</span><span class="string" id="6405380">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="6405399">+</span>&nbsp;<span class="ident" id="6405401">k</span>&nbsp;<span class="op" id="6405403">+</span>&nbsp;<span class="string" id="6405405">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="6405444">+</span>&nbsp;<span class="builtintype" id="6405446">string</span><span class="op" id="6405452">(</span><span class="ident" id="6405453">v</span><span class="op" id="6405454">)</span><span class="op" id="6405455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6405459">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6405463">if</span>&nbsp;<span class="builtinfunc" id="6405466">len</span><span class="op" id="6405469">(</span><span class="ident" id="6405470">k</span><span class="op" id="6405471">)</span>&nbsp;<span class="op" id="6405473">&gt;</span>&nbsp;<span class="ident" id="6405475">longestEntityWithoutSemicolon</span>&nbsp;<span class="op" id="6405505">&amp;&amp;</span>&nbsp;<span class="ident" id="6405508">k</span><span class="op" id="6405509">[</span><span class="builtinfunc" id="6405510">len</span><span class="op" id="6405513">(</span><span class="ident" id="6405514">k</span><span class="op" id="6405515">)</span><span class="op" id="6405516">-</span><span class="num" id="6405517">1</span><span class="op" id="6405518">]</span>&nbsp;<span class="op" id="6405520">!=</span>&nbsp;<span class="string" id="6405523">&#39;;&#39;</span>&nbsp;<span class="op" id="6405527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6405532">t</span><span class="op" id="6405533">.</span><span class="ident" id="6405534">Errorf</span><span class="op" id="6405540">(</span><span class="string" id="6405541">&#34;entity&nbsp;name&nbsp;%s&nbsp;is&nbsp;%d&nbsp;characters,&nbsp;but&nbsp;longestEntityWithoutSemicolon=%d&#34;</span><span class="op" id="6405612">,</span>&nbsp;<span class="ident" id="6405614">k</span><span class="op" id="6405615">,</span>&nbsp;<span class="builtinfunc" id="6405617">len</span><span class="op" id="6405620">(</span><span class="ident" id="6405621">k</span><span class="op" id="6405622">)</span><span class="op" id="6405623">,</span>&nbsp;<span class="ident" id="6405625">longestEntityWithoutSemicolon</span><span class="op" id="6405654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6405658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6405661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6405664">for</span>&nbsp;<span class="ident" id="6405668">k</span><span class="op" id="6405669">,</span>&nbsp;<span class="ident" id="6405671">v</span>&nbsp;<span class="op" id="6405673">:=</span>&nbsp;<span class="keyword" id="6405676">range</span>&nbsp;<span class="ident" id="6405682">entity2</span>&nbsp;<span class="op" id="6405690">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6405694">if</span>&nbsp;<span class="num" id="6405697">1</span><span class="op" id="6405698">+</span><span class="builtinfunc" id="6405699">len</span><span class="op" id="6405702">(</span><span class="ident" id="6405703">k</span><span class="op" id="6405704">)</span>&nbsp;<span class="op" id="6405706">&lt;</span>&nbsp;<span class="ident" id="6405708">utf8</span><span class="op" id="6405712">.</span><span class="ident" id="6405713">RuneLen</span><span class="op" id="6405720">(</span><span class="ident" id="6405721">v</span><span class="op" id="6405722">[</span><span class="num" id="6405723">0</span><span class="op" id="6405724">]</span><span class="op" id="6405725">)</span><span class="op" id="6405726">+</span><span class="ident" id="6405727">utf8</span><span class="op" id="6405731">.</span><span class="ident" id="6405732">RuneLen</span><span class="op" id="6405739">(</span><span class="ident" id="6405740">v</span><span class="op" id="6405741">[</span><span class="num" id="6405742">1</span><span class="op" id="6405743">]</span><span class="op" id="6405744">)</span>&nbsp;<span class="op" id="6405746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6405751">t</span><span class="op" id="6405752">.</span><span class="ident" id="6405753">Error</span><span class="op" id="6405758">(</span><span class="string" id="6405759">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="6405778">+</span>&nbsp;<span class="ident" id="6405780">k</span>&nbsp;<span class="op" id="6405782">+</span>&nbsp;<span class="string" id="6405784">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="6405823">+</span>&nbsp;<span class="builtintype" id="6405825">string</span><span class="op" id="6405831">(</span><span class="ident" id="6405832">v</span><span class="op" id="6405833">[</span><span class="num" id="6405834">0</span><span class="op" id="6405835">]</span><span class="op" id="6405836">)</span>&nbsp;<span class="op" id="6405838">+</span>&nbsp;<span class="builtintype" id="6405840">string</span><span class="op" id="6405846">(</span><span class="ident" id="6405847">v</span><span class="op" id="6405848">[</span><span class="num" id="6405849">1</span><span class="op" id="6405850">]</span><span class="op" id="6405851">)</span><span class="op" id="6405852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6405856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6405859">}</span><br>
<span class="lineno"></span><span class="op" id="6405861">}</span>
</div>
</body>
</html>
