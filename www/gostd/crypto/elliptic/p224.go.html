<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html" class="current">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4889431">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4889487">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4889541">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4889592">package</span>&nbsp;<span class="ident" id="4889600">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4889610">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4889685">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4889703">//</span><br>
<span class="lineno">10</span><span class="comment" id="4889706">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4889786">import</span>&nbsp;<span class="op" id="4889793">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4889796">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4889807">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4889810">var</span>&nbsp;<span class="ident" id="4889814">p224</span>&nbsp;<span class="ident" id="4889819">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4889830">type</span>&nbsp;<span class="ident" id="4889835">p224Curve</span>&nbsp;<span class="keyword" id="4889845">struct</span>&nbsp;<span class="op" id="4889852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4889855">*</span><span class="ident" id="4889856">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889869">gx</span><span class="op" id="4889871">,</span>&nbsp;<span class="ident" id="4889873">gy</span><span class="op" id="4889875">,</span>&nbsp;<span class="ident" id="4889877">b</span>&nbsp;<span class="ident" id="4889879">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4889896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4889899">func</span>&nbsp;<span class="ident" id="4889904">initP224</span><span class="op" id="4889912">(</span><span class="op" id="4889913">)</span>&nbsp;<span class="op" id="4889915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4889918">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889952">p224</span><span class="op" id="4889956">.</span><span class="ident" id="4889957">CurveParams</span>&nbsp;<span class="op" id="4889969">=</span>&nbsp;<span class="builtinfunc" id="4889971">new</span><span class="op" id="4889974">(</span><span class="ident" id="4889975">CurveParams</span><span class="op" id="4889986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889989">p224</span><span class="op" id="4889993">.</span><span class="ident" id="4889994">P</span><span class="op" id="4889995">,</span>&nbsp;<span class="ident" id="4889997">_</span>&nbsp;<span class="op" id="4889999">=</span>&nbsp;<span class="builtinfunc" id="4890001">new</span><span class="op" id="4890004">(</span><span class="ident" id="4890005">big</span><span class="op" id="4890008">.</span><span class="ident" id="4890009">Int</span><span class="op" id="4890012">)</span><span class="op" id="4890013">.</span><span class="ident" id="4890014">SetString</span><span class="op" id="4890023">(</span><span class="string" id="4890024">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4890094">,</span>&nbsp;<span class="num" id="4890096">10</span><span class="op" id="4890098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890101">p224</span><span class="op" id="4890105">.</span><span class="ident" id="4890106">N</span><span class="op" id="4890107">,</span>&nbsp;<span class="ident" id="4890109">_</span>&nbsp;<span class="op" id="4890111">=</span>&nbsp;<span class="builtinfunc" id="4890113">new</span><span class="op" id="4890116">(</span><span class="ident" id="4890117">big</span><span class="op" id="4890120">.</span><span class="ident" id="4890121">Int</span><span class="op" id="4890124">)</span><span class="op" id="4890125">.</span><span class="ident" id="4890126">SetString</span><span class="op" id="4890135">(</span><span class="string" id="4890136">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4890206">,</span>&nbsp;<span class="num" id="4890208">10</span><span class="op" id="4890210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890213">p224</span><span class="op" id="4890217">.</span><span class="ident" id="4890218">B</span><span class="op" id="4890219">,</span>&nbsp;<span class="ident" id="4890221">_</span>&nbsp;<span class="op" id="4890223">=</span>&nbsp;<span class="builtinfunc" id="4890225">new</span><span class="op" id="4890228">(</span><span class="ident" id="4890229">big</span><span class="op" id="4890232">.</span><span class="ident" id="4890233">Int</span><span class="op" id="4890236">)</span><span class="op" id="4890237">.</span><span class="ident" id="4890238">SetString</span><span class="op" id="4890247">(</span><span class="string" id="4890248">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4890306">,</span>&nbsp;<span class="num" id="4890308">16</span><span class="op" id="4890310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890313">p224</span><span class="op" id="4890317">.</span><span class="ident" id="4890318">Gx</span><span class="op" id="4890320">,</span>&nbsp;<span class="ident" id="4890322">_</span>&nbsp;<span class="op" id="4890324">=</span>&nbsp;<span class="builtinfunc" id="4890326">new</span><span class="op" id="4890329">(</span><span class="ident" id="4890330">big</span><span class="op" id="4890333">.</span><span class="ident" id="4890334">Int</span><span class="op" id="4890337">)</span><span class="op" id="4890338">.</span><span class="ident" id="4890339">SetString</span><span class="op" id="4890348">(</span><span class="string" id="4890349">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4890407">,</span>&nbsp;<span class="num" id="4890409">16</span><span class="op" id="4890411">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890414">p224</span><span class="op" id="4890418">.</span><span class="ident" id="4890419">Gy</span><span class="op" id="4890421">,</span>&nbsp;<span class="ident" id="4890423">_</span>&nbsp;<span class="op" id="4890425">=</span>&nbsp;<span class="builtinfunc" id="4890427">new</span><span class="op" id="4890430">(</span><span class="ident" id="4890431">big</span><span class="op" id="4890434">.</span><span class="ident" id="4890435">Int</span><span class="op" id="4890438">)</span><span class="op" id="4890439">.</span><span class="ident" id="4890440">SetString</span><span class="op" id="4890449">(</span><span class="string" id="4890450">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4890508">,</span>&nbsp;<span class="num" id="4890510">16</span><span class="op" id="4890512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890515">p224</span><span class="op" id="4890519">.</span><span class="ident" id="4890520">BitSize</span>&nbsp;<span class="op" id="4890528">=</span>&nbsp;<span class="num" id="4890530">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890536">p224FromBig</span><span class="op" id="4890547">(</span><span class="op" id="4890548">&amp;</span><span class="ident" id="4890549">p224</span><span class="op" id="4890553">.</span><span class="ident" id="4890554">gx</span><span class="op" id="4890556">,</span>&nbsp;<span class="ident" id="4890558">p224</span><span class="op" id="4890562">.</span><span class="ident" id="4890563">Gx</span><span class="op" id="4890565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890568">p224FromBig</span><span class="op" id="4890579">(</span><span class="op" id="4890580">&amp;</span><span class="ident" id="4890581">p224</span><span class="op" id="4890585">.</span><span class="ident" id="4890586">gy</span><span class="op" id="4890588">,</span>&nbsp;<span class="ident" id="4890590">p224</span><span class="op" id="4890594">.</span><span class="ident" id="4890595">Gy</span><span class="op" id="4890597">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890600">p224FromBig</span><span class="op" id="4890611">(</span><span class="op" id="4890612">&amp;</span><span class="ident" id="4890613">p224</span><span class="op" id="4890617">.</span><span class="ident" id="4890618">b</span><span class="op" id="4890619">,</span>&nbsp;<span class="ident" id="4890621">p224</span><span class="op" id="4890625">.</span><span class="ident" id="4890626">B</span><span class="op" id="4890627">)</span><br>
<span class="lineno"></span><span class="op" id="4890629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4890632">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4890711">func</span>&nbsp;<span class="ident" id="4890716">P224</span><span class="op" id="4890720">(</span><span class="op" id="4890721">)</span>&nbsp;<span class="ident" id="4890723">Curve</span>&nbsp;<span class="op" id="4890729">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890732">initonce</span><span class="op" id="4890740">.</span><span class="ident" id="4890741">Do</span><span class="op" id="4890743">(</span><span class="ident" id="4890744">initAll</span><span class="op" id="4890751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4890754">return</span>&nbsp;<span class="ident" id="4890761">p224</span><br>
<span class="lineno"></span><span class="op" id="4890766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4890769">func</span>&nbsp;<span class="op" id="4890774">(</span><span class="ident" id="4890775">curve</span>&nbsp;<span class="ident" id="4890781">p224Curve</span><span class="op" id="4890790">)</span>&nbsp;<span class="ident" id="4890792">Params</span><span class="op" id="4890798">(</span><span class="op" id="4890799">)</span>&nbsp;<span class="op" id="4890801">*</span><span class="ident" id="4890802">CurveParams</span>&nbsp;<span class="op" id="4890814">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4890817">return</span>&nbsp;<span class="ident" id="4890824">curve</span><span class="op" id="4890829">.</span><span class="ident" id="4890830">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4890842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4890845">func</span>&nbsp;<span class="op" id="4890850">(</span><span class="ident" id="4890851">curve</span>&nbsp;<span class="ident" id="4890857">p224Curve</span><span class="op" id="4890866">)</span>&nbsp;<span class="ident" id="4890868">IsOnCurve</span><span class="op" id="4890877">(</span><span class="ident" id="4890878">bigX</span><span class="op" id="4890882">,</span>&nbsp;<span class="ident" id="4890884">bigY</span>&nbsp;<span class="op" id="4890889">*</span><span class="ident" id="4890890">big</span><span class="op" id="4890893">.</span><span class="ident" id="4890894">Int</span><span class="op" id="4890897">)</span>&nbsp;<span class="builtintype" id="4890899">bool</span>&nbsp;<span class="op" id="4890904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4890907">var</span>&nbsp;<span class="ident" id="4890911">x</span><span class="op" id="4890912">,</span>&nbsp;<span class="ident" id="4890914">y</span>&nbsp;<span class="ident" id="4890916">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890934">p224FromBig</span><span class="op" id="4890945">(</span><span class="op" id="4890946">&amp;</span><span class="ident" id="4890947">x</span><span class="op" id="4890948">,</span>&nbsp;<span class="ident" id="4890950">bigX</span><span class="op" id="4890954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4890957">p224FromBig</span><span class="op" id="4890968">(</span><span class="op" id="4890969">&amp;</span><span class="ident" id="4890970">y</span><span class="op" id="4890971">,</span>&nbsp;<span class="ident" id="4890973">bigY</span><span class="op" id="4890977">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4890981">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891004">var</span>&nbsp;<span class="ident" id="4891008">tmp</span>&nbsp;<span class="ident" id="4891012">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891035">var</span>&nbsp;<span class="ident" id="4891039">x3</span>&nbsp;<span class="ident" id="4891042">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891060">p224Square</span><span class="op" id="4891070">(</span><span class="op" id="4891071">&amp;</span><span class="ident" id="4891072">x3</span><span class="op" id="4891074">,</span>&nbsp;<span class="op" id="4891076">&amp;</span><span class="ident" id="4891077">x</span><span class="op" id="4891078">,</span>&nbsp;<span class="op" id="4891080">&amp;</span><span class="ident" id="4891081">tmp</span><span class="op" id="4891084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891087">p224Mul</span><span class="op" id="4891094">(</span><span class="op" id="4891095">&amp;</span><span class="ident" id="4891096">x3</span><span class="op" id="4891098">,</span>&nbsp;<span class="op" id="4891100">&amp;</span><span class="ident" id="4891101">x3</span><span class="op" id="4891103">,</span>&nbsp;<span class="op" id="4891105">&amp;</span><span class="ident" id="4891106">x</span><span class="op" id="4891107">,</span>&nbsp;<span class="op" id="4891109">&amp;</span><span class="ident" id="4891110">tmp</span><span class="op" id="4891113">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891117">for</span>&nbsp;<span class="ident" id="4891121">i</span>&nbsp;<span class="op" id="4891123">:=</span>&nbsp;<span class="num" id="4891126">0</span><span class="op" id="4891127">;</span>&nbsp;<span class="ident" id="4891129">i</span>&nbsp;<span class="op" id="4891131">&lt;</span>&nbsp;<span class="num" id="4891133">8</span><span class="op" id="4891134">;</span>&nbsp;<span class="ident" id="4891136">i</span><span class="op" id="4891137">++</span>&nbsp;<span class="op" id="4891140">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891144">x</span><span class="op" id="4891145">[</span><span class="ident" id="4891146">i</span><span class="op" id="4891147">]</span>&nbsp;<span class="op" id="4891149">*=</span>&nbsp;<span class="num" id="4891152">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4891155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891158">p224Sub</span><span class="op" id="4891165">(</span><span class="op" id="4891166">&amp;</span><span class="ident" id="4891167">x3</span><span class="op" id="4891169">,</span>&nbsp;<span class="op" id="4891171">&amp;</span><span class="ident" id="4891172">x3</span><span class="op" id="4891174">,</span>&nbsp;<span class="op" id="4891176">&amp;</span><span class="ident" id="4891177">x</span><span class="op" id="4891178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891181">p224Reduce</span><span class="op" id="4891191">(</span><span class="op" id="4891192">&amp;</span><span class="ident" id="4891193">x3</span><span class="op" id="4891195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891198">p224Add</span><span class="op" id="4891205">(</span><span class="op" id="4891206">&amp;</span><span class="ident" id="4891207">x3</span><span class="op" id="4891209">,</span>&nbsp;<span class="op" id="4891211">&amp;</span><span class="ident" id="4891212">x3</span><span class="op" id="4891214">,</span>&nbsp;<span class="op" id="4891216">&amp;</span><span class="ident" id="4891217">curve</span><span class="op" id="4891222">.</span><span class="ident" id="4891223">b</span><span class="op" id="4891224">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891227">p224Contract</span><span class="op" id="4891239">(</span><span class="op" id="4891240">&amp;</span><span class="ident" id="4891241">x3</span><span class="op" id="4891243">,</span>&nbsp;<span class="op" id="4891245">&amp;</span><span class="ident" id="4891246">x3</span><span class="op" id="4891248">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891252">p224Square</span><span class="op" id="4891262">(</span><span class="op" id="4891263">&amp;</span><span class="ident" id="4891264">y</span><span class="op" id="4891265">,</span>&nbsp;<span class="op" id="4891267">&amp;</span><span class="ident" id="4891268">y</span><span class="op" id="4891269">,</span>&nbsp;<span class="op" id="4891271">&amp;</span><span class="ident" id="4891272">tmp</span><span class="op" id="4891275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891278">p224Contract</span><span class="op" id="4891290">(</span><span class="op" id="4891291">&amp;</span><span class="ident" id="4891292">y</span><span class="op" id="4891293">,</span>&nbsp;<span class="op" id="4891295">&amp;</span><span class="ident" id="4891296">y</span><span class="op" id="4891297">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891301">for</span>&nbsp;<span class="ident" id="4891305">i</span>&nbsp;<span class="op" id="4891307">:=</span>&nbsp;<span class="num" id="4891310">0</span><span class="op" id="4891311">;</span>&nbsp;<span class="ident" id="4891313">i</span>&nbsp;<span class="op" id="4891315">&lt;</span>&nbsp;<span class="num" id="4891317">8</span><span class="op" id="4891318">;</span>&nbsp;<span class="ident" id="4891320">i</span><span class="op" id="4891321">++</span>&nbsp;<span class="op" id="4891324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891328">if</span>&nbsp;<span class="ident" id="4891331">y</span><span class="op" id="4891332">[</span><span class="ident" id="4891333">i</span><span class="op" id="4891334">]</span>&nbsp;<span class="op" id="4891336">!=</span>&nbsp;<span class="ident" id="4891339">x3</span><span class="op" id="4891341">[</span><span class="ident" id="4891342">i</span><span class="op" id="4891343">]</span>&nbsp;<span class="op" id="4891345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891350">return</span>&nbsp;<span class="builtintype" id="4891357">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4891365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4891368">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891371">return</span>&nbsp;<span class="builtintype" id="4891378">true</span><br>
<span class="lineno"></span><span class="op" id="4891383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4891386">func</span>&nbsp;<span class="op" id="4891391">(</span><span class="ident" id="4891392">p224Curve</span><span class="op" id="4891401">)</span>&nbsp;<span class="ident" id="4891403">Add</span><span class="op" id="4891406">(</span><span class="ident" id="4891407">bigX1</span><span class="op" id="4891412">,</span>&nbsp;<span class="ident" id="4891414">bigY1</span><span class="op" id="4891419">,</span>&nbsp;<span class="ident" id="4891421">bigX2</span><span class="op" id="4891426">,</span>&nbsp;<span class="ident" id="4891428">bigY2</span>&nbsp;<span class="op" id="4891434">*</span><span class="ident" id="4891435">big</span><span class="op" id="4891438">.</span><span class="ident" id="4891439">Int</span><span class="op" id="4891442">)</span>&nbsp;<span class="op" id="4891444">(</span><span class="ident" id="4891445">x</span><span class="op" id="4891446">,</span>&nbsp;<span class="ident" id="4891448">y</span>&nbsp;<span class="op" id="4891450">*</span><span class="ident" id="4891451">big</span><span class="op" id="4891454">.</span><span class="ident" id="4891455">Int</span><span class="op" id="4891458">)</span>&nbsp;<span class="op" id="4891460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891463">var</span>&nbsp;<span class="ident" id="4891467">x1</span><span class="op" id="4891469">,</span>&nbsp;<span class="ident" id="4891471">y1</span><span class="op" id="4891473">,</span>&nbsp;<span class="ident" id="4891475">z1</span><span class="op" id="4891477">,</span>&nbsp;<span class="ident" id="4891479">x2</span><span class="op" id="4891481">,</span>&nbsp;<span class="ident" id="4891483">y2</span><span class="op" id="4891485">,</span>&nbsp;<span class="ident" id="4891487">z2</span><span class="op" id="4891489">,</span>&nbsp;<span class="ident" id="4891491">x3</span><span class="op" id="4891493">,</span>&nbsp;<span class="ident" id="4891495">y3</span><span class="op" id="4891497">,</span>&nbsp;<span class="ident" id="4891499">z3</span>&nbsp;<span class="ident" id="4891502">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891521">p224FromBig</span><span class="op" id="4891532">(</span><span class="op" id="4891533">&amp;</span><span class="ident" id="4891534">x1</span><span class="op" id="4891536">,</span>&nbsp;<span class="ident" id="4891538">bigX1</span><span class="op" id="4891543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891546">p224FromBig</span><span class="op" id="4891557">(</span><span class="op" id="4891558">&amp;</span><span class="ident" id="4891559">y1</span><span class="op" id="4891561">,</span>&nbsp;<span class="ident" id="4891563">bigY1</span><span class="op" id="4891568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891571">if</span>&nbsp;<span class="ident" id="4891574">bigX1</span><span class="op" id="4891579">.</span><span class="ident" id="4891580">Sign</span><span class="op" id="4891584">(</span><span class="op" id="4891585">)</span>&nbsp;<span class="op" id="4891587">!=</span>&nbsp;<span class="num" id="4891590">0</span>&nbsp;<span class="op" id="4891592">||</span>&nbsp;<span class="ident" id="4891595">bigY1</span><span class="op" id="4891600">.</span><span class="ident" id="4891601">Sign</span><span class="op" id="4891605">(</span><span class="op" id="4891606">)</span>&nbsp;<span class="op" id="4891608">!=</span>&nbsp;<span class="num" id="4891611">0</span>&nbsp;<span class="op" id="4891613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891617">z1</span><span class="op" id="4891619">[</span><span class="num" id="4891620">0</span><span class="op" id="4891621">]</span>&nbsp;<span class="op" id="4891623">=</span>&nbsp;<span class="num" id="4891625">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4891628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891631">p224FromBig</span><span class="op" id="4891642">(</span><span class="op" id="4891643">&amp;</span><span class="ident" id="4891644">x2</span><span class="op" id="4891646">,</span>&nbsp;<span class="ident" id="4891648">bigX2</span><span class="op" id="4891653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891656">p224FromBig</span><span class="op" id="4891667">(</span><span class="op" id="4891668">&amp;</span><span class="ident" id="4891669">y2</span><span class="op" id="4891671">,</span>&nbsp;<span class="ident" id="4891673">bigY2</span><span class="op" id="4891678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891681">if</span>&nbsp;<span class="ident" id="4891684">bigX2</span><span class="op" id="4891689">.</span><span class="ident" id="4891690">Sign</span><span class="op" id="4891694">(</span><span class="op" id="4891695">)</span>&nbsp;<span class="op" id="4891697">!=</span>&nbsp;<span class="num" id="4891700">0</span>&nbsp;<span class="op" id="4891702">||</span>&nbsp;<span class="ident" id="4891705">bigY2</span><span class="op" id="4891710">.</span><span class="ident" id="4891711">Sign</span><span class="op" id="4891715">(</span><span class="op" id="4891716">)</span>&nbsp;<span class="op" id="4891718">!=</span>&nbsp;<span class="num" id="4891721">0</span>&nbsp;<span class="op" id="4891723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891727">z2</span><span class="op" id="4891729">[</span><span class="num" id="4891730">0</span><span class="op" id="4891731">]</span>&nbsp;<span class="op" id="4891733">=</span>&nbsp;<span class="num" id="4891735">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4891738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891742">p224AddJacobian</span><span class="op" id="4891757">(</span><span class="op" id="4891758">&amp;</span><span class="ident" id="4891759">x3</span><span class="op" id="4891761">,</span>&nbsp;<span class="op" id="4891763">&amp;</span><span class="ident" id="4891764">y3</span><span class="op" id="4891766">,</span>&nbsp;<span class="op" id="4891768">&amp;</span><span class="ident" id="4891769">z3</span><span class="op" id="4891771">,</span>&nbsp;<span class="op" id="4891773">&amp;</span><span class="ident" id="4891774">x1</span><span class="op" id="4891776">,</span>&nbsp;<span class="op" id="4891778">&amp;</span><span class="ident" id="4891779">y1</span><span class="op" id="4891781">,</span>&nbsp;<span class="op" id="4891783">&amp;</span><span class="ident" id="4891784">z1</span><span class="op" id="4891786">,</span>&nbsp;<span class="op" id="4891788">&amp;</span><span class="ident" id="4891789">x2</span><span class="op" id="4891791">,</span>&nbsp;<span class="op" id="4891793">&amp;</span><span class="ident" id="4891794">y2</span><span class="op" id="4891796">,</span>&nbsp;<span class="op" id="4891798">&amp;</span><span class="ident" id="4891799">z2</span><span class="op" id="4891801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891804">return</span>&nbsp;<span class="ident" id="4891811">p224ToAffine</span><span class="op" id="4891823">(</span><span class="op" id="4891824">&amp;</span><span class="ident" id="4891825">x3</span><span class="op" id="4891827">,</span>&nbsp;<span class="op" id="4891829">&amp;</span><span class="ident" id="4891830">y3</span><span class="op" id="4891832">,</span>&nbsp;<span class="op" id="4891834">&amp;</span><span class="ident" id="4891835">z3</span><span class="op" id="4891837">)</span><br>
<span class="lineno"></span><span class="op" id="4891839">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4891842">func</span>&nbsp;<span class="op" id="4891847">(</span><span class="ident" id="4891848">p224Curve</span><span class="op" id="4891857">)</span>&nbsp;<span class="ident" id="4891859">Double</span><span class="op" id="4891865">(</span><span class="ident" id="4891866">bigX1</span><span class="op" id="4891871">,</span>&nbsp;<span class="ident" id="4891873">bigY1</span>&nbsp;<span class="op" id="4891879">*</span><span class="ident" id="4891880">big</span><span class="op" id="4891883">.</span><span class="ident" id="4891884">Int</span><span class="op" id="4891887">)</span>&nbsp;<span class="op" id="4891889">(</span><span class="ident" id="4891890">x</span><span class="op" id="4891891">,</span>&nbsp;<span class="ident" id="4891893">y</span>&nbsp;<span class="op" id="4891895">*</span><span class="ident" id="4891896">big</span><span class="op" id="4891899">.</span><span class="ident" id="4891900">Int</span><span class="op" id="4891903">)</span>&nbsp;<span class="op" id="4891905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891908">var</span>&nbsp;<span class="ident" id="4891912">x1</span><span class="op" id="4891914">,</span>&nbsp;<span class="ident" id="4891916">y1</span><span class="op" id="4891918">,</span>&nbsp;<span class="ident" id="4891920">z1</span><span class="op" id="4891922">,</span>&nbsp;<span class="ident" id="4891924">x2</span><span class="op" id="4891926">,</span>&nbsp;<span class="ident" id="4891928">y2</span><span class="op" id="4891930">,</span>&nbsp;<span class="ident" id="4891932">z2</span>&nbsp;<span class="ident" id="4891935">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891954">p224FromBig</span><span class="op" id="4891965">(</span><span class="op" id="4891966">&amp;</span><span class="ident" id="4891967">x1</span><span class="op" id="4891969">,</span>&nbsp;<span class="ident" id="4891971">bigX1</span><span class="op" id="4891976">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891979">p224FromBig</span><span class="op" id="4891990">(</span><span class="op" id="4891991">&amp;</span><span class="ident" id="4891992">y1</span><span class="op" id="4891994">,</span>&nbsp;<span class="ident" id="4891996">bigY1</span><span class="op" id="4892001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892004">z1</span><span class="op" id="4892006">[</span><span class="num" id="4892007">0</span><span class="op" id="4892008">]</span>&nbsp;<span class="op" id="4892010">=</span>&nbsp;<span class="num" id="4892012">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892016">p224DoubleJacobian</span><span class="op" id="4892034">(</span><span class="op" id="4892035">&amp;</span><span class="ident" id="4892036">x2</span><span class="op" id="4892038">,</span>&nbsp;<span class="op" id="4892040">&amp;</span><span class="ident" id="4892041">y2</span><span class="op" id="4892043">,</span>&nbsp;<span class="op" id="4892045">&amp;</span><span class="ident" id="4892046">z2</span><span class="op" id="4892048">,</span>&nbsp;<span class="op" id="4892050">&amp;</span><span class="ident" id="4892051">x1</span><span class="op" id="4892053">,</span>&nbsp;<span class="op" id="4892055">&amp;</span><span class="ident" id="4892056">y1</span><span class="op" id="4892058">,</span>&nbsp;<span class="op" id="4892060">&amp;</span><span class="ident" id="4892061">z1</span><span class="op" id="4892063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892066">return</span>&nbsp;<span class="ident" id="4892073">p224ToAffine</span><span class="op" id="4892085">(</span><span class="op" id="4892086">&amp;</span><span class="ident" id="4892087">x2</span><span class="op" id="4892089">,</span>&nbsp;<span class="op" id="4892091">&amp;</span><span class="ident" id="4892092">y2</span><span class="op" id="4892094">,</span>&nbsp;<span class="op" id="4892096">&amp;</span><span class="ident" id="4892097">z2</span><span class="op" id="4892099">)</span><br>
<span class="lineno">105</span><span class="op" id="4892101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4892104">func</span>&nbsp;<span class="op" id="4892109">(</span><span class="ident" id="4892110">p224Curve</span><span class="op" id="4892119">)</span>&nbsp;<span class="ident" id="4892121">ScalarMult</span><span class="op" id="4892131">(</span><span class="ident" id="4892132">bigX1</span><span class="op" id="4892137">,</span>&nbsp;<span class="ident" id="4892139">bigY1</span>&nbsp;<span class="op" id="4892145">*</span><span class="ident" id="4892146">big</span><span class="op" id="4892149">.</span><span class="ident" id="4892150">Int</span><span class="op" id="4892153">,</span>&nbsp;<span class="ident" id="4892155">scalar</span>&nbsp;<span class="op" id="4892162">[</span><span class="op" id="4892163">]</span><span class="builtintype" id="4892164">byte</span><span class="op" id="4892168">)</span>&nbsp;<span class="op" id="4892170">(</span><span class="ident" id="4892171">x</span><span class="op" id="4892172">,</span>&nbsp;<span class="ident" id="4892174">y</span>&nbsp;<span class="op" id="4892176">*</span><span class="ident" id="4892177">big</span><span class="op" id="4892180">.</span><span class="ident" id="4892181">Int</span><span class="op" id="4892184">)</span>&nbsp;<span class="op" id="4892186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892189">var</span>&nbsp;<span class="ident" id="4892193">x1</span><span class="op" id="4892195">,</span>&nbsp;<span class="ident" id="4892197">y1</span><span class="op" id="4892199">,</span>&nbsp;<span class="ident" id="4892201">z1</span><span class="op" id="4892203">,</span>&nbsp;<span class="ident" id="4892205">x2</span><span class="op" id="4892207">,</span>&nbsp;<span class="ident" id="4892209">y2</span><span class="op" id="4892211">,</span>&nbsp;<span class="ident" id="4892213">z2</span>&nbsp;<span class="ident" id="4892216">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892235">p224FromBig</span><span class="op" id="4892246">(</span><span class="op" id="4892247">&amp;</span><span class="ident" id="4892248">x1</span><span class="op" id="4892250">,</span>&nbsp;<span class="ident" id="4892252">bigX1</span><span class="op" id="4892257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892260">p224FromBig</span><span class="op" id="4892271">(</span><span class="op" id="4892272">&amp;</span><span class="ident" id="4892273">y1</span><span class="op" id="4892275">,</span>&nbsp;<span class="ident" id="4892277">bigY1</span><span class="op" id="4892282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892285">z1</span><span class="op" id="4892287">[</span><span class="num" id="4892288">0</span><span class="op" id="4892289">]</span>&nbsp;<span class="op" id="4892291">=</span>&nbsp;<span class="num" id="4892293">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892297">p224ScalarMult</span><span class="op" id="4892311">(</span><span class="op" id="4892312">&amp;</span><span class="ident" id="4892313">x2</span><span class="op" id="4892315">,</span>&nbsp;<span class="op" id="4892317">&amp;</span><span class="ident" id="4892318">y2</span><span class="op" id="4892320">,</span>&nbsp;<span class="op" id="4892322">&amp;</span><span class="ident" id="4892323">z2</span><span class="op" id="4892325">,</span>&nbsp;<span class="op" id="4892327">&amp;</span><span class="ident" id="4892328">x1</span><span class="op" id="4892330">,</span>&nbsp;<span class="op" id="4892332">&amp;</span><span class="ident" id="4892333">y1</span><span class="op" id="4892335">,</span>&nbsp;<span class="op" id="4892337">&amp;</span><span class="ident" id="4892338">z1</span><span class="op" id="4892340">,</span>&nbsp;<span class="ident" id="4892342">scalar</span><span class="op" id="4892348">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892351">return</span>&nbsp;<span class="ident" id="4892358">p224ToAffine</span><span class="op" id="4892370">(</span><span class="op" id="4892371">&amp;</span><span class="ident" id="4892372">x2</span><span class="op" id="4892374">,</span>&nbsp;<span class="op" id="4892376">&amp;</span><span class="ident" id="4892377">y2</span><span class="op" id="4892379">,</span>&nbsp;<span class="op" id="4892381">&amp;</span><span class="ident" id="4892382">z2</span><span class="op" id="4892384">)</span><br>
<span class="lineno"></span><span class="op" id="4892386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4892389">func</span>&nbsp;<span class="op" id="4892394">(</span><span class="ident" id="4892395">curve</span>&nbsp;<span class="ident" id="4892401">p224Curve</span><span class="op" id="4892410">)</span>&nbsp;<span class="ident" id="4892412">ScalarBaseMult</span><span class="op" id="4892426">(</span><span class="ident" id="4892427">scalar</span>&nbsp;<span class="op" id="4892434">[</span><span class="op" id="4892435">]</span><span class="builtintype" id="4892436">byte</span><span class="op" id="4892440">)</span>&nbsp;<span class="op" id="4892442">(</span><span class="ident" id="4892443">x</span><span class="op" id="4892444">,</span>&nbsp;<span class="ident" id="4892446">y</span>&nbsp;<span class="op" id="4892448">*</span><span class="ident" id="4892449">big</span><span class="op" id="4892452">.</span><span class="ident" id="4892453">Int</span><span class="op" id="4892456">)</span>&nbsp;<span class="op" id="4892458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892461">var</span>&nbsp;<span class="ident" id="4892465">z1</span><span class="op" id="4892467">,</span>&nbsp;<span class="ident" id="4892469">x2</span><span class="op" id="4892471">,</span>&nbsp;<span class="ident" id="4892473">y2</span><span class="op" id="4892475">,</span>&nbsp;<span class="ident" id="4892477">z2</span>&nbsp;<span class="ident" id="4892480">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892499">z1</span><span class="op" id="4892501">[</span><span class="num" id="4892502">0</span><span class="op" id="4892503">]</span>&nbsp;<span class="op" id="4892505">=</span>&nbsp;<span class="num" id="4892507">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892510">p224ScalarMult</span><span class="op" id="4892524">(</span><span class="op" id="4892525">&amp;</span><span class="ident" id="4892526">x2</span><span class="op" id="4892528">,</span>&nbsp;<span class="op" id="4892530">&amp;</span><span class="ident" id="4892531">y2</span><span class="op" id="4892533">,</span>&nbsp;<span class="op" id="4892535">&amp;</span><span class="ident" id="4892536">z2</span><span class="op" id="4892538">,</span>&nbsp;<span class="op" id="4892540">&amp;</span><span class="ident" id="4892541">curve</span><span class="op" id="4892546">.</span><span class="ident" id="4892547">gx</span><span class="op" id="4892549">,</span>&nbsp;<span class="op" id="4892551">&amp;</span><span class="ident" id="4892552">curve</span><span class="op" id="4892557">.</span><span class="ident" id="4892558">gy</span><span class="op" id="4892560">,</span>&nbsp;<span class="op" id="4892562">&amp;</span><span class="ident" id="4892563">z1</span><span class="op" id="4892565">,</span>&nbsp;<span class="ident" id="4892567">scalar</span><span class="op" id="4892573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892576">return</span>&nbsp;<span class="ident" id="4892583">p224ToAffine</span><span class="op" id="4892595">(</span><span class="op" id="4892596">&amp;</span><span class="ident" id="4892597">x2</span><span class="op" id="4892599">,</span>&nbsp;<span class="op" id="4892601">&amp;</span><span class="ident" id="4892602">y2</span><span class="op" id="4892604">,</span>&nbsp;<span class="op" id="4892606">&amp;</span><span class="ident" id="4892607">z2</span><span class="op" id="4892609">)</span><br>
<span class="lineno"></span><span class="op" id="4892611">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4892614">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4892642">//</span><br>
<span class="lineno"></span><span class="comment" id="4892645">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4892724">//</span><br>
<span class="lineno">130</span><span class="comment" id="4892727">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4892805">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4892865">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4892924">//</span><br>
<span class="lineno"></span><span class="comment" id="4892927">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4893007">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4893086">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4893149">type</span>&nbsp;<span class="ident" id="4893154">p224FieldElement</span>&nbsp;<span class="op" id="4893171">[</span><span class="num" id="4893172">8</span><span class="op" id="4893173">]</span><span class="builtintype" id="4893174">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4893182">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4893253">var</span>&nbsp;<span class="ident" id="4893257">p224P</span>&nbsp;<span class="op" id="4893263">=</span>&nbsp;<span class="op" id="4893265">[</span><span class="num" id="4893266">8</span><span class="op" id="4893267">]</span><span class="builtintype" id="4893268">uint32</span><span class="op" id="4893274">{</span><span class="num" id="4893275">1</span><span class="op" id="4893276">,</span>&nbsp;<span class="num" id="4893278">0</span><span class="op" id="4893279">,</span>&nbsp;<span class="num" id="4893281">0</span><span class="op" id="4893282">,</span>&nbsp;<span class="num" id="4893284">0xffff000</span><span class="op" id="4893293">,</span>&nbsp;<span class="num" id="4893295">0xfffffff</span><span class="op" id="4893304">,</span>&nbsp;<span class="num" id="4893306">0xfffffff</span><span class="op" id="4893315">,</span>&nbsp;<span class="num" id="4893317">0xfffffff</span><span class="op" id="4893326">,</span>&nbsp;<span class="num" id="4893328">0xfffffff</span><span class="op" id="4893337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4893340">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4893397">//</span><br>
<span class="lineno"></span><span class="comment" id="4893400">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4893416">func</span>&nbsp;<span class="ident" id="4893421">p224IsZero</span><span class="op" id="4893431">(</span><span class="ident" id="4893432">a</span>&nbsp;<span class="op" id="4893434">*</span><span class="ident" id="4893435">p224FieldElement</span><span class="op" id="4893451">)</span>&nbsp;<span class="builtintype" id="4893453">uint32</span>&nbsp;<span class="op" id="4893460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4893463">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4893533">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4893568">var</span>&nbsp;<span class="ident" id="4893572">minimal</span>&nbsp;<span class="ident" id="4893580">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893598">p224Contract</span><span class="op" id="4893610">(</span><span class="op" id="4893611">&amp;</span><span class="ident" id="4893612">minimal</span><span class="op" id="4893619">,</span>&nbsp;<span class="ident" id="4893621">a</span><span class="op" id="4893622">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4893626">var</span>&nbsp;<span class="ident" id="4893630">isZero</span><span class="op" id="4893636">,</span>&nbsp;<span class="ident" id="4893638">isP</span>&nbsp;<span class="builtintype" id="4893642">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4893650">for</span>&nbsp;<span class="ident" id="4893654">i</span><span class="op" id="4893655">,</span>&nbsp;<span class="ident" id="4893657">v</span>&nbsp;<span class="op" id="4893659">:=</span>&nbsp;<span class="keyword" id="4893662">range</span>&nbsp;<span class="ident" id="4893668">minimal</span>&nbsp;<span class="op" id="4893676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893680">isZero</span>&nbsp;<span class="op" id="4893687">|=</span>&nbsp;<span class="ident" id="4893690">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893694">isP</span>&nbsp;<span class="op" id="4893698">|=</span>&nbsp;<span class="ident" id="4893701">v</span>&nbsp;<span class="op" id="4893703">-</span>&nbsp;<span class="ident" id="4893705">p224P</span><span class="op" id="4893710">[</span><span class="ident" id="4893711">i</span><span class="op" id="4893712">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4893715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4893719">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893778">isZero</span>&nbsp;<span class="op" id="4893785">|=</span>&nbsp;<span class="ident" id="4893788">isZero</span>&nbsp;<span class="op" id="4893795">&gt;&gt;</span>&nbsp;<span class="num" id="4893798">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893802">isZero</span>&nbsp;<span class="op" id="4893809">|=</span>&nbsp;<span class="ident" id="4893812">isZero</span>&nbsp;<span class="op" id="4893819">&gt;&gt;</span>&nbsp;<span class="num" id="4893822">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893825">isZero</span>&nbsp;<span class="op" id="4893832">|=</span>&nbsp;<span class="ident" id="4893835">isZero</span>&nbsp;<span class="op" id="4893842">&gt;&gt;</span>&nbsp;<span class="num" id="4893845">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893848">isZero</span>&nbsp;<span class="op" id="4893855">|=</span>&nbsp;<span class="ident" id="4893858">isZero</span>&nbsp;<span class="op" id="4893865">&gt;&gt;</span>&nbsp;<span class="num" id="4893868">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893871">isZero</span>&nbsp;<span class="op" id="4893878">|=</span>&nbsp;<span class="ident" id="4893881">isZero</span>&nbsp;<span class="op" id="4893888">&gt;&gt;</span>&nbsp;<span class="num" id="4893891">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893895">isP</span>&nbsp;<span class="op" id="4893899">|=</span>&nbsp;<span class="ident" id="4893902">isP</span>&nbsp;<span class="op" id="4893906">&gt;&gt;</span>&nbsp;<span class="num" id="4893909">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893913">isP</span>&nbsp;<span class="op" id="4893917">|=</span>&nbsp;<span class="ident" id="4893920">isP</span>&nbsp;<span class="op" id="4893924">&gt;&gt;</span>&nbsp;<span class="num" id="4893927">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893930">isP</span>&nbsp;<span class="op" id="4893934">|=</span>&nbsp;<span class="ident" id="4893937">isP</span>&nbsp;<span class="op" id="4893941">&gt;&gt;</span>&nbsp;<span class="num" id="4893944">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893947">isP</span>&nbsp;<span class="op" id="4893951">|=</span>&nbsp;<span class="ident" id="4893954">isP</span>&nbsp;<span class="op" id="4893958">&gt;&gt;</span>&nbsp;<span class="num" id="4893961">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4893964">isP</span>&nbsp;<span class="op" id="4893968">|=</span>&nbsp;<span class="ident" id="4893971">isP</span>&nbsp;<span class="op" id="4893975">&gt;&gt;</span>&nbsp;<span class="num" id="4893978">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4893982">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4894046">result</span>&nbsp;<span class="op" id="4894053">:=</span>&nbsp;<span class="ident" id="4894056">isZero</span>&nbsp;<span class="op" id="4894063">&amp;</span>&nbsp;<span class="ident" id="4894065">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4894070">result</span>&nbsp;<span class="op" id="4894077">=</span>&nbsp;<span class="op" id="4894079">(</span><span class="op" id="4894080">^</span><span class="ident" id="4894081">result</span><span class="op" id="4894087">)</span>&nbsp;<span class="op" id="4894089">&amp;</span>&nbsp;<span class="num" id="4894091">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4894095">return</span>&nbsp;<span class="ident" id="4894102">result</span><br>
<span class="lineno">175</span><span class="op" id="4894109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4894112">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4894143">//</span><br>
<span class="lineno"></span><span class="comment" id="4894146">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4894169">func</span>&nbsp;<span class="ident" id="4894174">p224Add</span><span class="op" id="4894181">(</span><span class="ident" id="4894182">out</span><span class="op" id="4894185">,</span>&nbsp;<span class="ident" id="4894187">a</span><span class="op" id="4894188">,</span>&nbsp;<span class="ident" id="4894190">b</span>&nbsp;<span class="op" id="4894192">*</span><span class="ident" id="4894193">p224FieldElement</span><span class="op" id="4894209">)</span>&nbsp;<span class="op" id="4894211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4894214">for</span>&nbsp;<span class="ident" id="4894218">i</span>&nbsp;<span class="op" id="4894220">:=</span>&nbsp;<span class="num" id="4894223">0</span><span class="op" id="4894224">;</span>&nbsp;<span class="ident" id="4894226">i</span>&nbsp;<span class="op" id="4894228">&lt;</span>&nbsp;<span class="num" id="4894230">8</span><span class="op" id="4894231">;</span>&nbsp;<span class="ident" id="4894233">i</span><span class="op" id="4894234">++</span>&nbsp;<span class="op" id="4894237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4894241">out</span><span class="op" id="4894244">[</span><span class="ident" id="4894245">i</span><span class="op" id="4894246">]</span>&nbsp;<span class="op" id="4894248">=</span>&nbsp;<span class="ident" id="4894250">a</span><span class="op" id="4894251">[</span><span class="ident" id="4894252">i</span><span class="op" id="4894253">]</span>&nbsp;<span class="op" id="4894255">+</span>&nbsp;<span class="ident" id="4894257">b</span><span class="op" id="4894258">[</span><span class="ident" id="4894259">i</span><span class="op" id="4894260">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4894263">}</span><br>
<span class="lineno"></span><span class="op" id="4894265">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4894268">const</span>&nbsp;<span class="ident" id="4894274">two31p3</span>&nbsp;<span class="op" id="4894282">=</span>&nbsp;<span class="num" id="4894284">1</span><span class="op" id="4894285">&lt;&lt;</span><span class="num" id="4894287">31</span>&nbsp;<span class="op" id="4894290">+</span>&nbsp;<span class="num" id="4894292">1</span><span class="op" id="4894293">&lt;&lt;</span><span class="num" id="4894295">3</span><br>
<span class="lineno"></span><span class="keyword" id="4894297">const</span>&nbsp;<span class="ident" id="4894303">two31m3</span>&nbsp;<span class="op" id="4894311">=</span>&nbsp;<span class="num" id="4894313">1</span><span class="op" id="4894314">&lt;&lt;</span><span class="num" id="4894316">31</span>&nbsp;<span class="op" id="4894319">-</span>&nbsp;<span class="num" id="4894321">1</span><span class="op" id="4894322">&lt;&lt;</span><span class="num" id="4894324">3</span><br>
<span class="lineno"></span><span class="keyword" id="4894326">const</span>&nbsp;<span class="ident" id="4894332">two31m15m3</span>&nbsp;<span class="op" id="4894343">=</span>&nbsp;<span class="num" id="4894345">1</span><span class="op" id="4894346">&lt;&lt;</span><span class="num" id="4894348">31</span>&nbsp;<span class="op" id="4894351">-</span>&nbsp;<span class="num" id="4894353">1</span><span class="op" id="4894354">&lt;&lt;</span><span class="num" id="4894356">15</span>&nbsp;<span class="op" id="4894359">-</span>&nbsp;<span class="num" id="4894361">1</span><span class="op" id="4894362">&lt;&lt;</span><span class="num" id="4894364">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4894367">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4894444">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4894524">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4894546">var</span>&nbsp;<span class="ident" id="4894550">p224ZeroModP31</span>&nbsp;<span class="op" id="4894565">=</span>&nbsp;<span class="op" id="4894567">[</span><span class="op" id="4894568">]</span><span class="builtintype" id="4894569">uint32</span><span class="op" id="4894575">{</span><span class="ident" id="4894576">two31p3</span><span class="op" id="4894583">,</span>&nbsp;<span class="ident" id="4894585">two31m3</span><span class="op" id="4894592">,</span>&nbsp;<span class="ident" id="4894594">two31m3</span><span class="op" id="4894601">,</span>&nbsp;<span class="ident" id="4894603">two31m15m3</span><span class="op" id="4894613">,</span>&nbsp;<span class="ident" id="4894615">two31m3</span><span class="op" id="4894622">,</span>&nbsp;<span class="ident" id="4894624">two31m3</span><span class="op" id="4894631">,</span>&nbsp;<span class="ident" id="4894633">two31m3</span><span class="op" id="4894640">,</span>&nbsp;<span class="ident" id="4894642">two31m3</span><span class="op" id="4894649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4894652">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4894683">//</span><br>
<span class="lineno"></span><span class="comment" id="4894686">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4894708">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4894726">func</span>&nbsp;<span class="ident" id="4894731">p224Sub</span><span class="op" id="4894738">(</span><span class="ident" id="4894739">out</span><span class="op" id="4894742">,</span>&nbsp;<span class="ident" id="4894744">a</span><span class="op" id="4894745">,</span>&nbsp;<span class="ident" id="4894747">b</span>&nbsp;<span class="op" id="4894749">*</span><span class="ident" id="4894750">p224FieldElement</span><span class="op" id="4894766">)</span>&nbsp;<span class="op" id="4894768">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4894771">for</span>&nbsp;<span class="ident" id="4894775">i</span>&nbsp;<span class="op" id="4894777">:=</span>&nbsp;<span class="num" id="4894780">0</span><span class="op" id="4894781">;</span>&nbsp;<span class="ident" id="4894783">i</span>&nbsp;<span class="op" id="4894785">&lt;</span>&nbsp;<span class="num" id="4894787">8</span><span class="op" id="4894788">;</span>&nbsp;<span class="ident" id="4894790">i</span><span class="op" id="4894791">++</span>&nbsp;<span class="op" id="4894794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4894798">out</span><span class="op" id="4894801">[</span><span class="ident" id="4894802">i</span><span class="op" id="4894803">]</span>&nbsp;<span class="op" id="4894805">=</span>&nbsp;<span class="ident" id="4894807">a</span><span class="op" id="4894808">[</span><span class="ident" id="4894809">i</span><span class="op" id="4894810">]</span>&nbsp;<span class="op" id="4894812">+</span>&nbsp;<span class="ident" id="4894814">p224ZeroModP31</span><span class="op" id="4894828">[</span><span class="ident" id="4894829">i</span><span class="op" id="4894830">]</span>&nbsp;<span class="op" id="4894832">-</span>&nbsp;<span class="ident" id="4894834">b</span><span class="op" id="4894835">[</span><span class="ident" id="4894836">i</span><span class="op" id="4894837">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4894840">}</span><br>
<span class="lineno"></span><span class="op" id="4894842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4894845">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4894921">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4894999">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4895047">type</span>&nbsp;<span class="ident" id="4895052">p224LargeFieldElement</span>&nbsp;<span class="op" id="4895074">[</span><span class="num" id="4895075">15</span><span class="op" id="4895077">]</span><span class="ident" id="4895078">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4895086">const</span>&nbsp;<span class="ident" id="4895092">two63p35</span>&nbsp;<span class="op" id="4895101">=</span>&nbsp;<span class="num" id="4895103">1</span><span class="op" id="4895104">&lt;&lt;</span><span class="num" id="4895106">63</span>&nbsp;<span class="op" id="4895109">+</span>&nbsp;<span class="num" id="4895111">1</span><span class="op" id="4895112">&lt;&lt;</span><span class="num" id="4895114">35</span><br>
<span class="lineno"></span><span class="keyword" id="4895117">const</span>&nbsp;<span class="ident" id="4895123">two63m35</span>&nbsp;<span class="op" id="4895132">=</span>&nbsp;<span class="num" id="4895134">1</span><span class="op" id="4895135">&lt;&lt;</span><span class="num" id="4895137">63</span>&nbsp;<span class="op" id="4895140">-</span>&nbsp;<span class="num" id="4895142">1</span><span class="op" id="4895143">&lt;&lt;</span><span class="num" id="4895145">35</span><br>
<span class="lineno"></span><span class="keyword" id="4895148">const</span>&nbsp;<span class="ident" id="4895154">two63m35m19</span>&nbsp;<span class="op" id="4895166">=</span>&nbsp;<span class="num" id="4895168">1</span><span class="op" id="4895169">&lt;&lt;</span><span class="num" id="4895171">63</span>&nbsp;<span class="op" id="4895174">-</span>&nbsp;<span class="num" id="4895176">1</span><span class="op" id="4895177">&lt;&lt;</span><span class="num" id="4895179">35</span>&nbsp;<span class="op" id="4895182">-</span>&nbsp;<span class="num" id="4895184">1</span><span class="op" id="4895185">&lt;&lt;</span><span class="num" id="4895187">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4895191">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4895270">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4895303">var</span>&nbsp;<span class="ident" id="4895307">p224ZeroModP63</span>&nbsp;<span class="op" id="4895322">=</span>&nbsp;<span class="op" id="4895324">[</span><span class="num" id="4895325">8</span><span class="op" id="4895326">]</span><span class="ident" id="4895327">uint64</span><span class="op" id="4895333">{</span><span class="ident" id="4895334">two63p35</span><span class="op" id="4895342">,</span>&nbsp;<span class="ident" id="4895344">two63m35</span><span class="op" id="4895352">,</span>&nbsp;<span class="ident" id="4895354">two63m35</span><span class="op" id="4895362">,</span>&nbsp;<span class="ident" id="4895364">two63m35</span><span class="op" id="4895372">,</span>&nbsp;<span class="ident" id="4895374">two63m35m19</span><span class="op" id="4895385">,</span>&nbsp;<span class="ident" id="4895387">two63m35</span><span class="op" id="4895395">,</span>&nbsp;<span class="ident" id="4895397">two63m35</span><span class="op" id="4895405">,</span>&nbsp;<span class="ident" id="4895407">two63m35</span><span class="op" id="4895415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4895418">const</span>&nbsp;<span class="ident" id="4895424">bottom12Bits</span>&nbsp;<span class="op" id="4895437">=</span>&nbsp;<span class="num" id="4895439">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4895445">const</span>&nbsp;<span class="ident" id="4895451">bottom28Bits</span>&nbsp;<span class="op" id="4895464">=</span>&nbsp;<span class="num" id="4895466">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4895477">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4895508">//</span><br>
<span class="lineno"></span><span class="comment" id="4895511">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4895557">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4895575">func</span>&nbsp;<span class="ident" id="4895580">p224Mul</span><span class="op" id="4895587">(</span><span class="ident" id="4895588">out</span><span class="op" id="4895591">,</span>&nbsp;<span class="ident" id="4895593">a</span><span class="op" id="4895594">,</span>&nbsp;<span class="ident" id="4895596">b</span>&nbsp;<span class="op" id="4895598">*</span><span class="ident" id="4895599">p224FieldElement</span><span class="op" id="4895615">,</span>&nbsp;<span class="ident" id="4895617">tmp</span>&nbsp;<span class="op" id="4895621">*</span><span class="ident" id="4895622">p224LargeFieldElement</span><span class="op" id="4895643">)</span>&nbsp;<span class="op" id="4895645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4895648">for</span>&nbsp;<span class="ident" id="4895652">i</span>&nbsp;<span class="op" id="4895654">:=</span>&nbsp;<span class="num" id="4895657">0</span><span class="op" id="4895658">;</span>&nbsp;<span class="ident" id="4895660">i</span>&nbsp;<span class="op" id="4895662">&lt;</span>&nbsp;<span class="num" id="4895664">15</span><span class="op" id="4895666">;</span>&nbsp;<span class="ident" id="4895668">i</span><span class="op" id="4895669">++</span>&nbsp;<span class="op" id="4895672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4895676">tmp</span><span class="op" id="4895679">[</span><span class="ident" id="4895680">i</span><span class="op" id="4895681">]</span>&nbsp;<span class="op" id="4895683">=</span>&nbsp;<span class="num" id="4895685">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4895688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4895692">for</span>&nbsp;<span class="ident" id="4895696">i</span>&nbsp;<span class="op" id="4895698">:=</span>&nbsp;<span class="num" id="4895701">0</span><span class="op" id="4895702">;</span>&nbsp;<span class="ident" id="4895704">i</span>&nbsp;<span class="op" id="4895706">&lt;</span>&nbsp;<span class="num" id="4895708">8</span><span class="op" id="4895709">;</span>&nbsp;<span class="ident" id="4895711">i</span><span class="op" id="4895712">++</span>&nbsp;<span class="op" id="4895715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4895719">for</span>&nbsp;<span class="ident" id="4895723">j</span>&nbsp;<span class="op" id="4895725">:=</span>&nbsp;<span class="num" id="4895728">0</span><span class="op" id="4895729">;</span>&nbsp;<span class="ident" id="4895731">j</span>&nbsp;<span class="op" id="4895733">&lt;</span>&nbsp;<span class="num" id="4895735">8</span><span class="op" id="4895736">;</span>&nbsp;<span class="ident" id="4895738">j</span><span class="op" id="4895739">++</span>&nbsp;<span class="op" id="4895742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4895747">tmp</span><span class="op" id="4895750">[</span><span class="ident" id="4895751">i</span><span class="op" id="4895752">+</span><span class="ident" id="4895753">j</span><span class="op" id="4895754">]</span>&nbsp;<span class="op" id="4895756">+=</span>&nbsp;<span class="ident" id="4895759">uint64</span><span class="op" id="4895765">(</span><span class="ident" id="4895766">a</span><span class="op" id="4895767">[</span><span class="ident" id="4895768">i</span><span class="op" id="4895769">]</span><span class="op" id="4895770">)</span>&nbsp;<span class="op" id="4895772">*</span>&nbsp;<span class="ident" id="4895774">uint64</span><span class="op" id="4895780">(</span><span class="ident" id="4895781">b</span><span class="op" id="4895782">[</span><span class="ident" id="4895783">j</span><span class="op" id="4895784">]</span><span class="op" id="4895785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4895789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4895792">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4895796">p224ReduceLarge</span><span class="op" id="4895811">(</span><span class="ident" id="4895812">out</span><span class="op" id="4895815">,</span>&nbsp;<span class="ident" id="4895817">tmp</span><span class="op" id="4895820">)</span><br>
<span class="lineno"></span><span class="op" id="4895822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4895825">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4895855">//</span><br>
<span class="lineno"></span><span class="comment" id="4895858">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4895874">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4895892">func</span>&nbsp;<span class="ident" id="4895897">p224Square</span><span class="op" id="4895907">(</span><span class="ident" id="4895908">out</span><span class="op" id="4895911">,</span>&nbsp;<span class="ident" id="4895913">a</span>&nbsp;<span class="op" id="4895915">*</span><span class="ident" id="4895916">p224FieldElement</span><span class="op" id="4895932">,</span>&nbsp;<span class="ident" id="4895934">tmp</span>&nbsp;<span class="op" id="4895938">*</span><span class="ident" id="4895939">p224LargeFieldElement</span><span class="op" id="4895960">)</span>&nbsp;<span class="op" id="4895962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4895965">for</span>&nbsp;<span class="ident" id="4895969">i</span>&nbsp;<span class="op" id="4895971">:=</span>&nbsp;<span class="num" id="4895974">0</span><span class="op" id="4895975">;</span>&nbsp;<span class="ident" id="4895977">i</span>&nbsp;<span class="op" id="4895979">&lt;</span>&nbsp;<span class="num" id="4895981">15</span><span class="op" id="4895983">;</span>&nbsp;<span class="ident" id="4895985">i</span><span class="op" id="4895986">++</span>&nbsp;<span class="op" id="4895989">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4895993">tmp</span><span class="op" id="4895996">[</span><span class="ident" id="4895997">i</span><span class="op" id="4895998">]</span>&nbsp;<span class="op" id="4896000">=</span>&nbsp;<span class="num" id="4896002">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4896005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4896009">for</span>&nbsp;<span class="ident" id="4896013">i</span>&nbsp;<span class="op" id="4896015">:=</span>&nbsp;<span class="num" id="4896018">0</span><span class="op" id="4896019">;</span>&nbsp;<span class="ident" id="4896021">i</span>&nbsp;<span class="op" id="4896023">&lt;</span>&nbsp;<span class="num" id="4896025">8</span><span class="op" id="4896026">;</span>&nbsp;<span class="ident" id="4896028">i</span><span class="op" id="4896029">++</span>&nbsp;<span class="op" id="4896032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4896036">for</span>&nbsp;<span class="ident" id="4896040">j</span>&nbsp;<span class="op" id="4896042">:=</span>&nbsp;<span class="num" id="4896045">0</span><span class="op" id="4896046">;</span>&nbsp;<span class="ident" id="4896048">j</span>&nbsp;<span class="op" id="4896050">&lt;=</span>&nbsp;<span class="ident" id="4896053">i</span><span class="op" id="4896054">;</span>&nbsp;<span class="ident" id="4896056">j</span><span class="op" id="4896057">++</span>&nbsp;<span class="op" id="4896060">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896065">r</span>&nbsp;<span class="op" id="4896067">:=</span>&nbsp;<span class="ident" id="4896070">uint64</span><span class="op" id="4896076">(</span><span class="ident" id="4896077">a</span><span class="op" id="4896078">[</span><span class="ident" id="4896079">i</span><span class="op" id="4896080">]</span><span class="op" id="4896081">)</span>&nbsp;<span class="op" id="4896083">*</span>&nbsp;<span class="ident" id="4896085">uint64</span><span class="op" id="4896091">(</span><span class="ident" id="4896092">a</span><span class="op" id="4896093">[</span><span class="ident" id="4896094">j</span><span class="op" id="4896095">]</span><span class="op" id="4896096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4896101">if</span>&nbsp;<span class="ident" id="4896104">i</span>&nbsp;<span class="op" id="4896106">==</span>&nbsp;<span class="ident" id="4896109">j</span>&nbsp;<span class="op" id="4896111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896117">tmp</span><span class="op" id="4896120">[</span><span class="ident" id="4896121">i</span><span class="op" id="4896122">+</span><span class="ident" id="4896123">j</span><span class="op" id="4896124">]</span>&nbsp;<span class="op" id="4896126">+=</span>&nbsp;<span class="ident" id="4896129">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4896134">}</span>&nbsp;<span class="keyword" id="4896136">else</span>&nbsp;<span class="op" id="4896141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896147">tmp</span><span class="op" id="4896150">[</span><span class="ident" id="4896151">i</span><span class="op" id="4896152">+</span><span class="ident" id="4896153">j</span><span class="op" id="4896154">]</span>&nbsp;<span class="op" id="4896156">+=</span>&nbsp;<span class="ident" id="4896159">r</span>&nbsp;<span class="op" id="4896161">&lt;&lt;</span>&nbsp;<span class="num" id="4896164">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4896169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4896173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4896176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896180">p224ReduceLarge</span><span class="op" id="4896195">(</span><span class="ident" id="4896196">out</span><span class="op" id="4896199">,</span>&nbsp;<span class="ident" id="4896201">tmp</span><span class="op" id="4896204">)</span><br>
<span class="lineno">260</span><span class="op" id="4896206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4896209">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4896280">//</span><br>
<span class="lineno"></span><span class="comment" id="4896283">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4896300">func</span>&nbsp;<span class="ident" id="4896305">p224ReduceLarge</span><span class="op" id="4896320">(</span><span class="ident" id="4896321">out</span>&nbsp;<span class="op" id="4896325">*</span><span class="ident" id="4896326">p224FieldElement</span><span class="op" id="4896342">,</span>&nbsp;<span class="ident" id="4896344">in</span>&nbsp;<span class="op" id="4896347">*</span><span class="ident" id="4896348">p224LargeFieldElement</span><span class="op" id="4896369">)</span>&nbsp;<span class="op" id="4896371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4896374">for</span>&nbsp;<span class="ident" id="4896378">i</span>&nbsp;<span class="op" id="4896380">:=</span>&nbsp;<span class="num" id="4896383">0</span><span class="op" id="4896384">;</span>&nbsp;<span class="ident" id="4896386">i</span>&nbsp;<span class="op" id="4896388">&lt;</span>&nbsp;<span class="num" id="4896390">8</span><span class="op" id="4896391">;</span>&nbsp;<span class="ident" id="4896393">i</span><span class="op" id="4896394">++</span>&nbsp;<span class="op" id="4896397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896401">in</span><span class="op" id="4896403">[</span><span class="ident" id="4896404">i</span><span class="op" id="4896405">]</span>&nbsp;<span class="op" id="4896407">+=</span>&nbsp;<span class="ident" id="4896410">p224ZeroModP63</span><span class="op" id="4896424">[</span><span class="ident" id="4896425">i</span><span class="op" id="4896426">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4896429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896433">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4896487">for</span>&nbsp;<span class="ident" id="4896491">i</span>&nbsp;<span class="op" id="4896493">:=</span>&nbsp;<span class="num" id="4896496">14</span><span class="op" id="4896498">;</span>&nbsp;<span class="ident" id="4896500">i</span>&nbsp;<span class="op" id="4896502">&gt;=</span>&nbsp;<span class="num" id="4896505">8</span><span class="op" id="4896506">;</span>&nbsp;<span class="ident" id="4896508">i</span><span class="op" id="4896509">--</span>&nbsp;<span class="op" id="4896512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896516">in</span><span class="op" id="4896518">[</span><span class="ident" id="4896519">i</span><span class="op" id="4896520">-</span><span class="num" id="4896521">8</span><span class="op" id="4896522">]</span>&nbsp;<span class="op" id="4896524">-=</span>&nbsp;<span class="ident" id="4896527">in</span><span class="op" id="4896529">[</span><span class="ident" id="4896530">i</span><span class="op" id="4896531">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896535">in</span><span class="op" id="4896537">[</span><span class="ident" id="4896538">i</span><span class="op" id="4896539">-</span><span class="num" id="4896540">5</span><span class="op" id="4896541">]</span>&nbsp;<span class="op" id="4896543">+=</span>&nbsp;<span class="op" id="4896546">(</span><span class="ident" id="4896547">in</span><span class="op" id="4896549">[</span><span class="ident" id="4896550">i</span><span class="op" id="4896551">]</span>&nbsp;<span class="op" id="4896553">&amp;</span>&nbsp;<span class="num" id="4896555">0xffff</span><span class="op" id="4896561">)</span>&nbsp;<span class="op" id="4896563">&lt;&lt;</span>&nbsp;<span class="num" id="4896566">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896571">in</span><span class="op" id="4896573">[</span><span class="ident" id="4896574">i</span><span class="op" id="4896575">-</span><span class="num" id="4896576">4</span><span class="op" id="4896577">]</span>&nbsp;<span class="op" id="4896579">+=</span>&nbsp;<span class="ident" id="4896582">in</span><span class="op" id="4896584">[</span><span class="ident" id="4896585">i</span><span class="op" id="4896586">]</span>&nbsp;<span class="op" id="4896588">&gt;&gt;</span>&nbsp;<span class="num" id="4896591">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4896595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896598">in</span><span class="op" id="4896600">[</span><span class="num" id="4896601">8</span><span class="op" id="4896602">]</span>&nbsp;<span class="op" id="4896604">=</span>&nbsp;<span class="num" id="4896606">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896609">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896631">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896702">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4896733">for</span>&nbsp;<span class="ident" id="4896737">i</span>&nbsp;<span class="op" id="4896739">:=</span>&nbsp;<span class="num" id="4896742">1</span><span class="op" id="4896743">;</span>&nbsp;<span class="ident" id="4896745">i</span>&nbsp;<span class="op" id="4896747">&lt;</span>&nbsp;<span class="num" id="4896749">8</span><span class="op" id="4896750">;</span>&nbsp;<span class="ident" id="4896752">i</span><span class="op" id="4896753">++</span>&nbsp;<span class="op" id="4896756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896760">in</span><span class="op" id="4896762">[</span><span class="ident" id="4896763">i</span><span class="op" id="4896764">+</span><span class="num" id="4896765">1</span><span class="op" id="4896766">]</span>&nbsp;<span class="op" id="4896768">+=</span>&nbsp;<span class="ident" id="4896771">in</span><span class="op" id="4896773">[</span><span class="ident" id="4896774">i</span><span class="op" id="4896775">]</span>&nbsp;<span class="op" id="4896777">&gt;&gt;</span>&nbsp;<span class="num" id="4896780">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896785">out</span><span class="op" id="4896788">[</span><span class="ident" id="4896789">i</span><span class="op" id="4896790">]</span>&nbsp;<span class="op" id="4896792">=</span>&nbsp;<span class="builtintype" id="4896794">uint32</span><span class="op" id="4896800">(</span><span class="ident" id="4896801">in</span><span class="op" id="4896803">[</span><span class="ident" id="4896804">i</span><span class="op" id="4896805">]</span>&nbsp;<span class="op" id="4896807">&amp;</span>&nbsp;<span class="ident" id="4896809">bottom28Bits</span><span class="op" id="4896821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4896824">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896827">in</span><span class="op" id="4896829">[</span><span class="num" id="4896830">0</span><span class="op" id="4896831">]</span>&nbsp;<span class="op" id="4896833">-=</span>&nbsp;<span class="ident" id="4896836">in</span><span class="op" id="4896838">[</span><span class="num" id="4896839">8</span><span class="op" id="4896840">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896843">out</span><span class="op" id="4896846">[</span><span class="num" id="4896847">3</span><span class="op" id="4896848">]</span>&nbsp;<span class="op" id="4896850">+=</span>&nbsp;<span class="builtintype" id="4896853">uint32</span><span class="op" id="4896859">(</span><span class="ident" id="4896860">in</span><span class="op" id="4896862">[</span><span class="num" id="4896863">8</span><span class="op" id="4896864">]</span><span class="op" id="4896865">&amp;</span><span class="num" id="4896866">0xffff</span><span class="op" id="4896872">)</span>&nbsp;<span class="op" id="4896874">&lt;&lt;</span>&nbsp;<span class="num" id="4896877">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896881">out</span><span class="op" id="4896884">[</span><span class="num" id="4896885">4</span><span class="op" id="4896886">]</span>&nbsp;<span class="op" id="4896888">+=</span>&nbsp;<span class="builtintype" id="4896891">uint32</span><span class="op" id="4896897">(</span><span class="ident" id="4896898">in</span><span class="op" id="4896900">[</span><span class="num" id="4896901">8</span><span class="op" id="4896902">]</span>&nbsp;<span class="op" id="4896904">&gt;&gt;</span>&nbsp;<span class="num" id="4896907">16</span><span class="op" id="4896909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896912">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896930">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896949">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896968">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896995">out</span><span class="op" id="4896998">[</span><span class="num" id="4896999">0</span><span class="op" id="4897000">]</span>&nbsp;<span class="op" id="4897002">=</span>&nbsp;<span class="builtintype" id="4897004">uint32</span><span class="op" id="4897010">(</span><span class="ident" id="4897011">in</span><span class="op" id="4897013">[</span><span class="num" id="4897014">0</span><span class="op" id="4897015">]</span>&nbsp;<span class="op" id="4897017">&amp;</span>&nbsp;<span class="ident" id="4897019">bottom28Bits</span><span class="op" id="4897031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897034">out</span><span class="op" id="4897037">[</span><span class="num" id="4897038">1</span><span class="op" id="4897039">]</span>&nbsp;<span class="op" id="4897041">+=</span>&nbsp;<span class="builtintype" id="4897044">uint32</span><span class="op" id="4897050">(</span><span class="op" id="4897051">(</span><span class="ident" id="4897052">in</span><span class="op" id="4897054">[</span><span class="num" id="4897055">0</span><span class="op" id="4897056">]</span>&nbsp;<span class="op" id="4897058">&gt;&gt;</span>&nbsp;<span class="num" id="4897061">28</span><span class="op" id="4897063">)</span>&nbsp;<span class="op" id="4897065">&amp;</span>&nbsp;<span class="ident" id="4897067">bottom28Bits</span><span class="op" id="4897079">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897082">out</span><span class="op" id="4897085">[</span><span class="num" id="4897086">2</span><span class="op" id="4897087">]</span>&nbsp;<span class="op" id="4897089">+=</span>&nbsp;<span class="builtintype" id="4897092">uint32</span><span class="op" id="4897098">(</span><span class="ident" id="4897099">in</span><span class="op" id="4897101">[</span><span class="num" id="4897102">0</span><span class="op" id="4897103">]</span>&nbsp;<span class="op" id="4897105">&gt;&gt;</span>&nbsp;<span class="num" id="4897108">56</span><span class="op" id="4897110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4897113">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4897132">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4897154">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4897175">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4897178">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4897237">//</span><br>
<span class="lineno"></span><span class="comment" id="4897240">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4897274">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4897299">func</span>&nbsp;<span class="ident" id="4897304">p224Reduce</span><span class="op" id="4897314">(</span><span class="ident" id="4897315">a</span>&nbsp;<span class="op" id="4897317">*</span><span class="ident" id="4897318">p224FieldElement</span><span class="op" id="4897334">)</span>&nbsp;<span class="op" id="4897336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4897339">for</span>&nbsp;<span class="ident" id="4897343">i</span>&nbsp;<span class="op" id="4897345">:=</span>&nbsp;<span class="num" id="4897348">0</span><span class="op" id="4897349">;</span>&nbsp;<span class="ident" id="4897351">i</span>&nbsp;<span class="op" id="4897353">&lt;</span>&nbsp;<span class="num" id="4897355">7</span><span class="op" id="4897356">;</span>&nbsp;<span class="ident" id="4897358">i</span><span class="op" id="4897359">++</span>&nbsp;<span class="op" id="4897362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897366">a</span><span class="op" id="4897367">[</span><span class="ident" id="4897368">i</span><span class="op" id="4897369">+</span><span class="num" id="4897370">1</span><span class="op" id="4897371">]</span>&nbsp;<span class="op" id="4897373">+=</span>&nbsp;<span class="ident" id="4897376">a</span><span class="op" id="4897377">[</span><span class="ident" id="4897378">i</span><span class="op" id="4897379">]</span>&nbsp;<span class="op" id="4897381">&gt;&gt;</span>&nbsp;<span class="num" id="4897384">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897389">a</span><span class="op" id="4897390">[</span><span class="ident" id="4897391">i</span><span class="op" id="4897392">]</span>&nbsp;<span class="op" id="4897394">&amp;=</span>&nbsp;<span class="ident" id="4897397">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4897411">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897414">top</span>&nbsp;<span class="op" id="4897418">:=</span>&nbsp;<span class="ident" id="4897421">a</span><span class="op" id="4897422">[</span><span class="num" id="4897423">7</span><span class="op" id="4897424">]</span>&nbsp;<span class="op" id="4897426">&gt;&gt;</span>&nbsp;<span class="num" id="4897429">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897433">a</span><span class="op" id="4897434">[</span><span class="num" id="4897435">7</span><span class="op" id="4897436">]</span>&nbsp;<span class="op" id="4897438">&amp;=</span>&nbsp;<span class="ident" id="4897441">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4897456">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897471">mask</span>&nbsp;<span class="op" id="4897476">:=</span>&nbsp;<span class="ident" id="4897479">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897484">mask</span>&nbsp;<span class="op" id="4897489">|=</span>&nbsp;<span class="ident" id="4897492">mask</span>&nbsp;<span class="op" id="4897497">&gt;&gt;</span>&nbsp;<span class="num" id="4897500">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897503">mask</span>&nbsp;<span class="op" id="4897508">|=</span>&nbsp;<span class="ident" id="4897511">mask</span>&nbsp;<span class="op" id="4897516">&gt;&gt;</span>&nbsp;<span class="num" id="4897519">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897522">mask</span>&nbsp;<span class="op" id="4897527">&lt;&lt;=</span>&nbsp;<span class="num" id="4897531">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897535">mask</span>&nbsp;<span class="op" id="4897540">=</span>&nbsp;<span class="builtintype" id="4897542">uint32</span><span class="op" id="4897548">(</span><span class="builtintype" id="4897549">int32</span><span class="op" id="4897554">(</span><span class="ident" id="4897555">mask</span><span class="op" id="4897559">)</span>&nbsp;<span class="op" id="4897561">&gt;&gt;</span>&nbsp;<span class="num" id="4897564">31</span><span class="op" id="4897566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4897569">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897623">a</span><span class="op" id="4897624">[</span><span class="num" id="4897625">0</span><span class="op" id="4897626">]</span>&nbsp;<span class="op" id="4897628">-=</span>&nbsp;<span class="ident" id="4897631">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897636">a</span><span class="op" id="4897637">[</span><span class="num" id="4897638">3</span><span class="op" id="4897639">]</span>&nbsp;<span class="op" id="4897641">+=</span>&nbsp;<span class="ident" id="4897644">top</span>&nbsp;<span class="op" id="4897648">&lt;&lt;</span>&nbsp;<span class="num" id="4897651">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4897656">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4897725">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4897795">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897819">a</span><span class="op" id="4897820">[</span><span class="num" id="4897821">3</span><span class="op" id="4897822">]</span>&nbsp;<span class="op" id="4897824">-=</span>&nbsp;<span class="num" id="4897827">1</span>&nbsp;<span class="op" id="4897829">&amp;</span>&nbsp;<span class="ident" id="4897831">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897837">a</span><span class="op" id="4897838">[</span><span class="num" id="4897839">2</span><span class="op" id="4897840">]</span>&nbsp;<span class="op" id="4897842">+=</span>&nbsp;<span class="ident" id="4897845">mask</span>&nbsp;<span class="op" id="4897850">&amp;</span>&nbsp;<span class="op" id="4897852">(</span><span class="num" id="4897853">1</span><span class="op" id="4897854">&lt;&lt;</span><span class="num" id="4897856">28</span>&nbsp;<span class="op" id="4897859">-</span>&nbsp;<span class="num" id="4897861">1</span><span class="op" id="4897862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897865">a</span><span class="op" id="4897866">[</span><span class="num" id="4897867">1</span><span class="op" id="4897868">]</span>&nbsp;<span class="op" id="4897870">+=</span>&nbsp;<span class="ident" id="4897873">mask</span>&nbsp;<span class="op" id="4897878">&amp;</span>&nbsp;<span class="op" id="4897880">(</span><span class="num" id="4897881">1</span><span class="op" id="4897882">&lt;&lt;</span><span class="num" id="4897884">28</span>&nbsp;<span class="op" id="4897887">-</span>&nbsp;<span class="num" id="4897889">1</span><span class="op" id="4897890">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897893">a</span><span class="op" id="4897894">[</span><span class="num" id="4897895">0</span><span class="op" id="4897896">]</span>&nbsp;<span class="op" id="4897898">+=</span>&nbsp;<span class="ident" id="4897901">mask</span>&nbsp;<span class="op" id="4897906">&amp;</span>&nbsp;<span class="op" id="4897908">(</span><span class="num" id="4897909">1</span>&nbsp;<span class="op" id="4897911">&lt;&lt;</span>&nbsp;<span class="num" id="4897914">28</span><span class="op" id="4897916">)</span><br>
<span class="lineno"></span><span class="op" id="4897918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4897921">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4897999">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4898032">func</span>&nbsp;<span class="ident" id="4898037">p224Invert</span><span class="op" id="4898047">(</span><span class="ident" id="4898048">out</span><span class="op" id="4898051">,</span>&nbsp;<span class="ident" id="4898053">in</span>&nbsp;<span class="op" id="4898056">*</span><span class="ident" id="4898057">p224FieldElement</span><span class="op" id="4898073">)</span>&nbsp;<span class="op" id="4898075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898078">var</span>&nbsp;<span class="ident" id="4898082">f1</span><span class="op" id="4898084">,</span>&nbsp;<span class="ident" id="4898086">f2</span><span class="op" id="4898088">,</span>&nbsp;<span class="ident" id="4898090">f3</span><span class="op" id="4898092">,</span>&nbsp;<span class="ident" id="4898094">f4</span>&nbsp;<span class="ident" id="4898097">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898115">var</span>&nbsp;<span class="ident" id="4898119">c</span>&nbsp;<span class="ident" id="4898121">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898145">p224Square</span><span class="op" id="4898155">(</span><span class="op" id="4898156">&amp;</span><span class="ident" id="4898157">f1</span><span class="op" id="4898159">,</span>&nbsp;<span class="ident" id="4898161">in</span><span class="op" id="4898163">,</span>&nbsp;<span class="op" id="4898165">&amp;</span><span class="ident" id="4898166">c</span><span class="op" id="4898167">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4898172">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898178">p224Mul</span><span class="op" id="4898185">(</span><span class="op" id="4898186">&amp;</span><span class="ident" id="4898187">f1</span><span class="op" id="4898189">,</span>&nbsp;<span class="op" id="4898191">&amp;</span><span class="ident" id="4898192">f1</span><span class="op" id="4898194">,</span>&nbsp;<span class="ident" id="4898196">in</span><span class="op" id="4898198">,</span>&nbsp;<span class="op" id="4898200">&amp;</span><span class="ident" id="4898201">c</span><span class="op" id="4898202">)</span>&nbsp;&nbsp;<span class="comment" id="4898205">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898218">p224Square</span><span class="op" id="4898228">(</span><span class="op" id="4898229">&amp;</span><span class="ident" id="4898230">f1</span><span class="op" id="4898232">,</span>&nbsp;<span class="op" id="4898234">&amp;</span><span class="ident" id="4898235">f1</span><span class="op" id="4898237">,</span>&nbsp;<span class="op" id="4898239">&amp;</span><span class="ident" id="4898240">c</span><span class="op" id="4898241">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4898245">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898258">p224Mul</span><span class="op" id="4898265">(</span><span class="op" id="4898266">&amp;</span><span class="ident" id="4898267">f1</span><span class="op" id="4898269">,</span>&nbsp;<span class="op" id="4898271">&amp;</span><span class="ident" id="4898272">f1</span><span class="op" id="4898274">,</span>&nbsp;<span class="ident" id="4898276">in</span><span class="op" id="4898278">,</span>&nbsp;<span class="op" id="4898280">&amp;</span><span class="ident" id="4898281">c</span><span class="op" id="4898282">)</span>&nbsp;&nbsp;<span class="comment" id="4898285">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898298">p224Square</span><span class="op" id="4898308">(</span><span class="op" id="4898309">&amp;</span><span class="ident" id="4898310">f2</span><span class="op" id="4898312">,</span>&nbsp;<span class="op" id="4898314">&amp;</span><span class="ident" id="4898315">f1</span><span class="op" id="4898317">,</span>&nbsp;<span class="op" id="4898319">&amp;</span><span class="ident" id="4898320">c</span><span class="op" id="4898321">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4898325">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898338">p224Square</span><span class="op" id="4898348">(</span><span class="op" id="4898349">&amp;</span><span class="ident" id="4898350">f2</span><span class="op" id="4898352">,</span>&nbsp;<span class="op" id="4898354">&amp;</span><span class="ident" id="4898355">f2</span><span class="op" id="4898357">,</span>&nbsp;<span class="op" id="4898359">&amp;</span><span class="ident" id="4898360">c</span><span class="op" id="4898361">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4898365">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898378">p224Square</span><span class="op" id="4898388">(</span><span class="op" id="4898389">&amp;</span><span class="ident" id="4898390">f2</span><span class="op" id="4898392">,</span>&nbsp;<span class="op" id="4898394">&amp;</span><span class="ident" id="4898395">f2</span><span class="op" id="4898397">,</span>&nbsp;<span class="op" id="4898399">&amp;</span><span class="ident" id="4898400">c</span><span class="op" id="4898401">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4898405">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898418">p224Mul</span><span class="op" id="4898425">(</span><span class="op" id="4898426">&amp;</span><span class="ident" id="4898427">f1</span><span class="op" id="4898429">,</span>&nbsp;<span class="op" id="4898431">&amp;</span><span class="ident" id="4898432">f1</span><span class="op" id="4898434">,</span>&nbsp;<span class="op" id="4898436">&amp;</span><span class="ident" id="4898437">f2</span><span class="op" id="4898439">,</span>&nbsp;<span class="op" id="4898441">&amp;</span><span class="ident" id="4898442">c</span><span class="op" id="4898443">)</span>&nbsp;<span class="comment" id="4898445">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898458">p224Square</span><span class="op" id="4898468">(</span><span class="op" id="4898469">&amp;</span><span class="ident" id="4898470">f2</span><span class="op" id="4898472">,</span>&nbsp;<span class="op" id="4898474">&amp;</span><span class="ident" id="4898475">f1</span><span class="op" id="4898477">,</span>&nbsp;<span class="op" id="4898479">&amp;</span><span class="ident" id="4898480">c</span><span class="op" id="4898481">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4898485">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898498">for</span>&nbsp;<span class="ident" id="4898502">i</span>&nbsp;<span class="op" id="4898504">:=</span>&nbsp;<span class="num" id="4898507">0</span><span class="op" id="4898508">;</span>&nbsp;<span class="ident" id="4898510">i</span>&nbsp;<span class="op" id="4898512">&lt;</span>&nbsp;<span class="num" id="4898514">5</span><span class="op" id="4898515">;</span>&nbsp;<span class="ident" id="4898517">i</span><span class="op" id="4898518">++</span>&nbsp;<span class="op" id="4898521">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4898525">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898543">p224Square</span><span class="op" id="4898553">(</span><span class="op" id="4898554">&amp;</span><span class="ident" id="4898555">f2</span><span class="op" id="4898557">,</span>&nbsp;<span class="op" id="4898559">&amp;</span><span class="ident" id="4898560">f2</span><span class="op" id="4898562">,</span>&nbsp;<span class="op" id="4898564">&amp;</span><span class="ident" id="4898565">c</span><span class="op" id="4898566">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4898569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898572">p224Mul</span><span class="op" id="4898579">(</span><span class="op" id="4898580">&amp;</span><span class="ident" id="4898581">f2</span><span class="op" id="4898583">,</span>&nbsp;<span class="op" id="4898585">&amp;</span><span class="ident" id="4898586">f2</span><span class="op" id="4898588">,</span>&nbsp;<span class="op" id="4898590">&amp;</span><span class="ident" id="4898591">f1</span><span class="op" id="4898593">,</span>&nbsp;<span class="op" id="4898595">&amp;</span><span class="ident" id="4898596">c</span><span class="op" id="4898597">)</span>&nbsp;<span class="comment" id="4898599">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898613">p224Square</span><span class="op" id="4898623">(</span><span class="op" id="4898624">&amp;</span><span class="ident" id="4898625">f3</span><span class="op" id="4898627">,</span>&nbsp;<span class="op" id="4898629">&amp;</span><span class="ident" id="4898630">f2</span><span class="op" id="4898632">,</span>&nbsp;<span class="op" id="4898634">&amp;</span><span class="ident" id="4898635">c</span><span class="op" id="4898636">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4898640">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898654">for</span>&nbsp;<span class="ident" id="4898658">i</span>&nbsp;<span class="op" id="4898660">:=</span>&nbsp;<span class="num" id="4898663">0</span><span class="op" id="4898664">;</span>&nbsp;<span class="ident" id="4898666">i</span>&nbsp;<span class="op" id="4898668">&lt;</span>&nbsp;<span class="num" id="4898670">11</span><span class="op" id="4898672">;</span>&nbsp;<span class="ident" id="4898674">i</span><span class="op" id="4898675">++</span>&nbsp;<span class="op" id="4898678">{</span>&nbsp;&nbsp;<span class="comment" id="4898681">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898700">p224Square</span><span class="op" id="4898710">(</span><span class="op" id="4898711">&amp;</span><span class="ident" id="4898712">f3</span><span class="op" id="4898714">,</span>&nbsp;<span class="op" id="4898716">&amp;</span><span class="ident" id="4898717">f3</span><span class="op" id="4898719">,</span>&nbsp;<span class="op" id="4898721">&amp;</span><span class="ident" id="4898722">c</span><span class="op" id="4898723">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4898726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898729">p224Mul</span><span class="op" id="4898736">(</span><span class="op" id="4898737">&amp;</span><span class="ident" id="4898738">f2</span><span class="op" id="4898740">,</span>&nbsp;<span class="op" id="4898742">&amp;</span><span class="ident" id="4898743">f3</span><span class="op" id="4898745">,</span>&nbsp;<span class="op" id="4898747">&amp;</span><span class="ident" id="4898748">f2</span><span class="op" id="4898750">,</span>&nbsp;<span class="op" id="4898752">&amp;</span><span class="ident" id="4898753">c</span><span class="op" id="4898754">)</span>&nbsp;<span class="comment" id="4898756">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898770">p224Square</span><span class="op" id="4898780">(</span><span class="op" id="4898781">&amp;</span><span class="ident" id="4898782">f3</span><span class="op" id="4898784">,</span>&nbsp;<span class="op" id="4898786">&amp;</span><span class="ident" id="4898787">f2</span><span class="op" id="4898789">,</span>&nbsp;<span class="op" id="4898791">&amp;</span><span class="ident" id="4898792">c</span><span class="op" id="4898793">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4898797">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898811">for</span>&nbsp;<span class="ident" id="4898815">i</span>&nbsp;<span class="op" id="4898817">:=</span>&nbsp;<span class="num" id="4898820">0</span><span class="op" id="4898821">;</span>&nbsp;<span class="ident" id="4898823">i</span>&nbsp;<span class="op" id="4898825">&lt;</span>&nbsp;<span class="num" id="4898827">23</span><span class="op" id="4898829">;</span>&nbsp;<span class="ident" id="4898831">i</span><span class="op" id="4898832">++</span>&nbsp;<span class="op" id="4898835">{</span>&nbsp;&nbsp;<span class="comment" id="4898838">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898857">p224Square</span><span class="op" id="4898867">(</span><span class="op" id="4898868">&amp;</span><span class="ident" id="4898869">f3</span><span class="op" id="4898871">,</span>&nbsp;<span class="op" id="4898873">&amp;</span><span class="ident" id="4898874">f3</span><span class="op" id="4898876">,</span>&nbsp;<span class="op" id="4898878">&amp;</span><span class="ident" id="4898879">c</span><span class="op" id="4898880">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4898883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898886">p224Mul</span><span class="op" id="4898893">(</span><span class="op" id="4898894">&amp;</span><span class="ident" id="4898895">f3</span><span class="op" id="4898897">,</span>&nbsp;<span class="op" id="4898899">&amp;</span><span class="ident" id="4898900">f3</span><span class="op" id="4898902">,</span>&nbsp;<span class="op" id="4898904">&amp;</span><span class="ident" id="4898905">f2</span><span class="op" id="4898907">,</span>&nbsp;<span class="op" id="4898909">&amp;</span><span class="ident" id="4898910">c</span><span class="op" id="4898911">)</span>&nbsp;<span class="comment" id="4898913">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898927">p224Square</span><span class="op" id="4898937">(</span><span class="op" id="4898938">&amp;</span><span class="ident" id="4898939">f4</span><span class="op" id="4898941">,</span>&nbsp;<span class="op" id="4898943">&amp;</span><span class="ident" id="4898944">f3</span><span class="op" id="4898946">,</span>&nbsp;<span class="op" id="4898948">&amp;</span><span class="ident" id="4898949">c</span><span class="op" id="4898950">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4898954">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898968">for</span>&nbsp;<span class="ident" id="4898972">i</span>&nbsp;<span class="op" id="4898974">:=</span>&nbsp;<span class="num" id="4898977">0</span><span class="op" id="4898978">;</span>&nbsp;<span class="ident" id="4898980">i</span>&nbsp;<span class="op" id="4898982">&lt;</span>&nbsp;<span class="num" id="4898984">47</span><span class="op" id="4898986">;</span>&nbsp;<span class="ident" id="4898988">i</span><span class="op" id="4898989">++</span>&nbsp;<span class="op" id="4898992">{</span>&nbsp;&nbsp;<span class="comment" id="4898995">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899014">p224Square</span><span class="op" id="4899024">(</span><span class="op" id="4899025">&amp;</span><span class="ident" id="4899026">f4</span><span class="op" id="4899028">,</span>&nbsp;<span class="op" id="4899030">&amp;</span><span class="ident" id="4899031">f4</span><span class="op" id="4899033">,</span>&nbsp;<span class="op" id="4899035">&amp;</span><span class="ident" id="4899036">c</span><span class="op" id="4899037">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4899040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899043">p224Mul</span><span class="op" id="4899050">(</span><span class="op" id="4899051">&amp;</span><span class="ident" id="4899052">f3</span><span class="op" id="4899054">,</span>&nbsp;<span class="op" id="4899056">&amp;</span><span class="ident" id="4899057">f3</span><span class="op" id="4899059">,</span>&nbsp;<span class="op" id="4899061">&amp;</span><span class="ident" id="4899062">f4</span><span class="op" id="4899064">,</span>&nbsp;<span class="op" id="4899066">&amp;</span><span class="ident" id="4899067">c</span><span class="op" id="4899068">)</span>&nbsp;<span class="comment" id="4899070">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899084">p224Square</span><span class="op" id="4899094">(</span><span class="op" id="4899095">&amp;</span><span class="ident" id="4899096">f4</span><span class="op" id="4899098">,</span>&nbsp;<span class="op" id="4899100">&amp;</span><span class="ident" id="4899101">f3</span><span class="op" id="4899103">,</span>&nbsp;<span class="op" id="4899105">&amp;</span><span class="ident" id="4899106">c</span><span class="op" id="4899107">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4899111">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4899125">for</span>&nbsp;<span class="ident" id="4899129">i</span>&nbsp;<span class="op" id="4899131">:=</span>&nbsp;<span class="num" id="4899134">0</span><span class="op" id="4899135">;</span>&nbsp;<span class="ident" id="4899137">i</span>&nbsp;<span class="op" id="4899139">&lt;</span>&nbsp;<span class="num" id="4899141">23</span><span class="op" id="4899143">;</span>&nbsp;<span class="ident" id="4899145">i</span><span class="op" id="4899146">++</span>&nbsp;<span class="op" id="4899149">{</span>&nbsp;&nbsp;<span class="comment" id="4899152">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899172">p224Square</span><span class="op" id="4899182">(</span><span class="op" id="4899183">&amp;</span><span class="ident" id="4899184">f4</span><span class="op" id="4899186">,</span>&nbsp;<span class="op" id="4899188">&amp;</span><span class="ident" id="4899189">f4</span><span class="op" id="4899191">,</span>&nbsp;<span class="op" id="4899193">&amp;</span><span class="ident" id="4899194">c</span><span class="op" id="4899195">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4899198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899201">p224Mul</span><span class="op" id="4899208">(</span><span class="op" id="4899209">&amp;</span><span class="ident" id="4899210">f2</span><span class="op" id="4899212">,</span>&nbsp;<span class="op" id="4899214">&amp;</span><span class="ident" id="4899215">f4</span><span class="op" id="4899217">,</span>&nbsp;<span class="op" id="4899219">&amp;</span><span class="ident" id="4899220">f2</span><span class="op" id="4899222">,</span>&nbsp;<span class="op" id="4899224">&amp;</span><span class="ident" id="4899225">c</span><span class="op" id="4899226">)</span>&nbsp;<span class="comment" id="4899228">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4899243">for</span>&nbsp;<span class="ident" id="4899247">i</span>&nbsp;<span class="op" id="4899249">:=</span>&nbsp;<span class="num" id="4899252">0</span><span class="op" id="4899253">;</span>&nbsp;<span class="ident" id="4899255">i</span>&nbsp;<span class="op" id="4899257">&lt;</span>&nbsp;<span class="num" id="4899259">6</span><span class="op" id="4899260">;</span>&nbsp;<span class="ident" id="4899262">i</span><span class="op" id="4899263">++</span>&nbsp;<span class="op" id="4899266">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4899270">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899289">p224Square</span><span class="op" id="4899299">(</span><span class="op" id="4899300">&amp;</span><span class="ident" id="4899301">f2</span><span class="op" id="4899303">,</span>&nbsp;<span class="op" id="4899305">&amp;</span><span class="ident" id="4899306">f2</span><span class="op" id="4899308">,</span>&nbsp;<span class="op" id="4899310">&amp;</span><span class="ident" id="4899311">c</span><span class="op" id="4899312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4899315">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899318">p224Mul</span><span class="op" id="4899325">(</span><span class="op" id="4899326">&amp;</span><span class="ident" id="4899327">f1</span><span class="op" id="4899329">,</span>&nbsp;<span class="op" id="4899331">&amp;</span><span class="ident" id="4899332">f1</span><span class="op" id="4899334">,</span>&nbsp;<span class="op" id="4899336">&amp;</span><span class="ident" id="4899337">f2</span><span class="op" id="4899339">,</span>&nbsp;<span class="op" id="4899341">&amp;</span><span class="ident" id="4899342">c</span><span class="op" id="4899343">)</span>&nbsp;<span class="comment" id="4899345">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899360">p224Square</span><span class="op" id="4899370">(</span><span class="op" id="4899371">&amp;</span><span class="ident" id="4899372">f1</span><span class="op" id="4899374">,</span>&nbsp;<span class="op" id="4899376">&amp;</span><span class="ident" id="4899377">f1</span><span class="op" id="4899379">,</span>&nbsp;<span class="op" id="4899381">&amp;</span><span class="ident" id="4899382">c</span><span class="op" id="4899383">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4899387">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899402">p224Mul</span><span class="op" id="4899409">(</span><span class="op" id="4899410">&amp;</span><span class="ident" id="4899411">f1</span><span class="op" id="4899413">,</span>&nbsp;<span class="op" id="4899415">&amp;</span><span class="ident" id="4899416">f1</span><span class="op" id="4899418">,</span>&nbsp;<span class="ident" id="4899420">in</span><span class="op" id="4899422">,</span>&nbsp;<span class="op" id="4899424">&amp;</span><span class="ident" id="4899425">c</span><span class="op" id="4899426">)</span>&nbsp;&nbsp;<span class="comment" id="4899429">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4899444">for</span>&nbsp;<span class="ident" id="4899448">i</span>&nbsp;<span class="op" id="4899450">:=</span>&nbsp;<span class="num" id="4899453">0</span><span class="op" id="4899454">;</span>&nbsp;<span class="ident" id="4899456">i</span>&nbsp;<span class="op" id="4899458">&lt;</span>&nbsp;<span class="num" id="4899460">97</span><span class="op" id="4899462">;</span>&nbsp;<span class="ident" id="4899464">i</span><span class="op" id="4899465">++</span>&nbsp;<span class="op" id="4899468">{</span>&nbsp;&nbsp;<span class="comment" id="4899471">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899491">p224Square</span><span class="op" id="4899501">(</span><span class="op" id="4899502">&amp;</span><span class="ident" id="4899503">f1</span><span class="op" id="4899505">,</span>&nbsp;<span class="op" id="4899507">&amp;</span><span class="ident" id="4899508">f1</span><span class="op" id="4899510">,</span>&nbsp;<span class="op" id="4899512">&amp;</span><span class="ident" id="4899513">c</span><span class="op" id="4899514">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4899517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899520">p224Mul</span><span class="op" id="4899527">(</span><span class="ident" id="4899528">out</span><span class="op" id="4899531">,</span>&nbsp;<span class="op" id="4899533">&amp;</span><span class="ident" id="4899534">f1</span><span class="op" id="4899536">,</span>&nbsp;<span class="op" id="4899538">&amp;</span><span class="ident" id="4899539">f3</span><span class="op" id="4899541">,</span>&nbsp;<span class="op" id="4899543">&amp;</span><span class="ident" id="4899544">c</span><span class="op" id="4899545">)</span>&nbsp;<span class="comment" id="4899547">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4899569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4899572">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4899641">//</span><br>
<span class="lineno"></span><span class="comment" id="4899644">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4899671">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4899697">func</span>&nbsp;<span class="ident" id="4899702">p224Contract</span><span class="op" id="4899714">(</span><span class="ident" id="4899715">out</span><span class="op" id="4899718">,</span>&nbsp;<span class="ident" id="4899720">in</span>&nbsp;<span class="op" id="4899723">*</span><span class="ident" id="4899724">p224FieldElement</span><span class="op" id="4899740">)</span>&nbsp;<span class="op" id="4899742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4899745">copy</span><span class="op" id="4899749">(</span><span class="ident" id="4899750">out</span><span class="op" id="4899753">[</span><span class="op" id="4899754">:</span><span class="op" id="4899755">]</span><span class="op" id="4899756">,</span>&nbsp;<span class="ident" id="4899758">in</span><span class="op" id="4899760">[</span><span class="op" id="4899761">:</span><span class="op" id="4899762">]</span><span class="op" id="4899763">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4899767">for</span>&nbsp;<span class="ident" id="4899771">i</span>&nbsp;<span class="op" id="4899773">:=</span>&nbsp;<span class="num" id="4899776">0</span><span class="op" id="4899777">;</span>&nbsp;<span class="ident" id="4899779">i</span>&nbsp;<span class="op" id="4899781">&lt;</span>&nbsp;<span class="num" id="4899783">7</span><span class="op" id="4899784">;</span>&nbsp;<span class="ident" id="4899786">i</span><span class="op" id="4899787">++</span>&nbsp;<span class="op" id="4899790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899794">out</span><span class="op" id="4899797">[</span><span class="ident" id="4899798">i</span><span class="op" id="4899799">+</span><span class="num" id="4899800">1</span><span class="op" id="4899801">]</span>&nbsp;<span class="op" id="4899803">+=</span>&nbsp;<span class="ident" id="4899806">out</span><span class="op" id="4899809">[</span><span class="ident" id="4899810">i</span><span class="op" id="4899811">]</span>&nbsp;<span class="op" id="4899813">&gt;&gt;</span>&nbsp;<span class="num" id="4899816">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899821">out</span><span class="op" id="4899824">[</span><span class="ident" id="4899825">i</span><span class="op" id="4899826">]</span>&nbsp;<span class="op" id="4899828">&amp;=</span>&nbsp;<span class="ident" id="4899831">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4899845">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899848">top</span>&nbsp;<span class="op" id="4899852">:=</span>&nbsp;<span class="ident" id="4899855">out</span><span class="op" id="4899858">[</span><span class="num" id="4899859">7</span><span class="op" id="4899860">]</span>&nbsp;<span class="op" id="4899862">&gt;&gt;</span>&nbsp;<span class="num" id="4899865">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899869">out</span><span class="op" id="4899872">[</span><span class="num" id="4899873">7</span><span class="op" id="4899874">]</span>&nbsp;<span class="op" id="4899876">&amp;=</span>&nbsp;<span class="ident" id="4899879">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899894">out</span><span class="op" id="4899897">[</span><span class="num" id="4899898">0</span><span class="op" id="4899899">]</span>&nbsp;<span class="op" id="4899901">-=</span>&nbsp;<span class="ident" id="4899904">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899909">out</span><span class="op" id="4899912">[</span><span class="num" id="4899913">3</span><span class="op" id="4899914">]</span>&nbsp;<span class="op" id="4899916">+=</span>&nbsp;<span class="ident" id="4899919">top</span>&nbsp;<span class="op" id="4899923">&lt;&lt;</span>&nbsp;<span class="num" id="4899926">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4899931">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900003">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900073">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900106">for</span>&nbsp;<span class="ident" id="4900110">i</span>&nbsp;<span class="op" id="4900112">:=</span>&nbsp;<span class="num" id="4900115">0</span><span class="op" id="4900116">;</span>&nbsp;<span class="ident" id="4900118">i</span>&nbsp;<span class="op" id="4900120">&lt;</span>&nbsp;<span class="num" id="4900122">3</span><span class="op" id="4900123">;</span>&nbsp;<span class="ident" id="4900125">i</span><span class="op" id="4900126">++</span>&nbsp;<span class="op" id="4900129">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900133">mask</span>&nbsp;<span class="op" id="4900138">:=</span>&nbsp;<span class="builtintype" id="4900141">uint32</span><span class="op" id="4900147">(</span><span class="builtintype" id="4900148">int32</span><span class="op" id="4900153">(</span><span class="ident" id="4900154">out</span><span class="op" id="4900157">[</span><span class="ident" id="4900158">i</span><span class="op" id="4900159">]</span><span class="op" id="4900160">)</span>&nbsp;<span class="op" id="4900162">&gt;&gt;</span>&nbsp;<span class="num" id="4900165">31</span><span class="op" id="4900167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900171">out</span><span class="op" id="4900174">[</span><span class="ident" id="4900175">i</span><span class="op" id="4900176">]</span>&nbsp;<span class="op" id="4900178">+=</span>&nbsp;<span class="op" id="4900181">(</span><span class="num" id="4900182">1</span>&nbsp;<span class="op" id="4900184">&lt;&lt;</span>&nbsp;<span class="num" id="4900187">28</span><span class="op" id="4900189">)</span>&nbsp;<span class="op" id="4900191">&amp;</span>&nbsp;<span class="ident" id="4900193">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900200">out</span><span class="op" id="4900203">[</span><span class="ident" id="4900204">i</span><span class="op" id="4900205">+</span><span class="num" id="4900206">1</span><span class="op" id="4900207">]</span>&nbsp;<span class="op" id="4900209">-=</span>&nbsp;<span class="num" id="4900212">1</span>&nbsp;<span class="op" id="4900214">&amp;</span>&nbsp;<span class="ident" id="4900216">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900226">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900301">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900318">for</span>&nbsp;<span class="ident" id="4900322">i</span>&nbsp;<span class="op" id="4900324">:=</span>&nbsp;<span class="num" id="4900327">3</span><span class="op" id="4900328">;</span>&nbsp;<span class="ident" id="4900330">i</span>&nbsp;<span class="op" id="4900332">&lt;</span>&nbsp;<span class="num" id="4900334">7</span><span class="op" id="4900335">;</span>&nbsp;<span class="ident" id="4900337">i</span><span class="op" id="4900338">++</span>&nbsp;<span class="op" id="4900341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900345">out</span><span class="op" id="4900348">[</span><span class="ident" id="4900349">i</span><span class="op" id="4900350">+</span><span class="num" id="4900351">1</span><span class="op" id="4900352">]</span>&nbsp;<span class="op" id="4900354">+=</span>&nbsp;<span class="ident" id="4900357">out</span><span class="op" id="4900360">[</span><span class="ident" id="4900361">i</span><span class="op" id="4900362">]</span>&nbsp;<span class="op" id="4900364">&gt;&gt;</span>&nbsp;<span class="num" id="4900367">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900372">out</span><span class="op" id="4900375">[</span><span class="ident" id="4900376">i</span><span class="op" id="4900377">]</span>&nbsp;<span class="op" id="4900379">&amp;=</span>&nbsp;<span class="ident" id="4900382">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900399">top</span>&nbsp;<span class="op" id="4900403">=</span>&nbsp;<span class="ident" id="4900405">out</span><span class="op" id="4900408">[</span><span class="num" id="4900409">7</span><span class="op" id="4900410">]</span>&nbsp;<span class="op" id="4900412">&gt;&gt;</span>&nbsp;<span class="num" id="4900415">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900419">out</span><span class="op" id="4900422">[</span><span class="num" id="4900423">7</span><span class="op" id="4900424">]</span>&nbsp;<span class="op" id="4900426">&amp;=</span>&nbsp;<span class="ident" id="4900429">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900444">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900502">out</span><span class="op" id="4900505">[</span><span class="num" id="4900506">0</span><span class="op" id="4900507">]</span>&nbsp;<span class="op" id="4900509">-=</span>&nbsp;<span class="ident" id="4900512">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900517">out</span><span class="op" id="4900520">[</span><span class="num" id="4900521">3</span><span class="op" id="4900522">]</span>&nbsp;<span class="op" id="4900524">+=</span>&nbsp;<span class="ident" id="4900527">top</span>&nbsp;<span class="op" id="4900531">&lt;&lt;</span>&nbsp;<span class="num" id="4900534">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900539">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900587">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900662">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900741">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900767">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900845">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900925">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901000">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901076">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901155">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901178">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901255">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901325">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4901352">for</span>&nbsp;<span class="ident" id="4901356">i</span>&nbsp;<span class="op" id="4901358">:=</span>&nbsp;<span class="num" id="4901361">0</span><span class="op" id="4901362">;</span>&nbsp;<span class="ident" id="4901364">i</span>&nbsp;<span class="op" id="4901366">&lt;</span>&nbsp;<span class="num" id="4901368">3</span><span class="op" id="4901369">;</span>&nbsp;<span class="ident" id="4901371">i</span><span class="op" id="4901372">++</span>&nbsp;<span class="op" id="4901375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901379">mask</span>&nbsp;<span class="op" id="4901384">:=</span>&nbsp;<span class="builtintype" id="4901387">uint32</span><span class="op" id="4901393">(</span><span class="builtintype" id="4901394">int32</span><span class="op" id="4901399">(</span><span class="ident" id="4901400">out</span><span class="op" id="4901403">[</span><span class="ident" id="4901404">i</span><span class="op" id="4901405">]</span><span class="op" id="4901406">)</span>&nbsp;<span class="op" id="4901408">&gt;&gt;</span>&nbsp;<span class="num" id="4901411">31</span><span class="op" id="4901413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901417">out</span><span class="op" id="4901420">[</span><span class="ident" id="4901421">i</span><span class="op" id="4901422">]</span>&nbsp;<span class="op" id="4901424">+=</span>&nbsp;<span class="op" id="4901427">(</span><span class="num" id="4901428">1</span>&nbsp;<span class="op" id="4901430">&lt;&lt;</span>&nbsp;<span class="num" id="4901433">28</span><span class="op" id="4901435">)</span>&nbsp;<span class="op" id="4901437">&amp;</span>&nbsp;<span class="ident" id="4901439">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901446">out</span><span class="op" id="4901449">[</span><span class="ident" id="4901450">i</span><span class="op" id="4901451">+</span><span class="num" id="4901452">1</span><span class="op" id="4901453">]</span>&nbsp;<span class="op" id="4901455">-=</span>&nbsp;<span class="num" id="4901458">1</span>&nbsp;<span class="op" id="4901460">&amp;</span>&nbsp;<span class="ident" id="4901462">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4901468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901472">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901533">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901602">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901671">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901742">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901752">top4AllOnes</span>&nbsp;<span class="op" id="4901764">:=</span>&nbsp;<span class="builtintype" id="4901767">uint32</span><span class="op" id="4901773">(</span><span class="num" id="4901774">0xffffffff</span><span class="op" id="4901784">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4901787">for</span>&nbsp;<span class="ident" id="4901791">i</span>&nbsp;<span class="op" id="4901793">:=</span>&nbsp;<span class="num" id="4901796">4</span><span class="op" id="4901797">;</span>&nbsp;<span class="ident" id="4901799">i</span>&nbsp;<span class="op" id="4901801">&lt;</span>&nbsp;<span class="num" id="4901803">8</span><span class="op" id="4901804">;</span>&nbsp;<span class="ident" id="4901806">i</span><span class="op" id="4901807">++</span>&nbsp;<span class="op" id="4901810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901814">top4AllOnes</span>&nbsp;<span class="op" id="4901826">&amp;=</span>&nbsp;<span class="ident" id="4901829">out</span><span class="op" id="4901832">[</span><span class="ident" id="4901833">i</span><span class="op" id="4901834">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4901837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901840">top4AllOnes</span>&nbsp;<span class="op" id="4901852">|=</span>&nbsp;<span class="num" id="4901855">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4901867">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901934">top4AllOnes</span>&nbsp;<span class="op" id="4901946">&amp;=</span>&nbsp;<span class="ident" id="4901949">top4AllOnes</span>&nbsp;<span class="op" id="4901961">&gt;&gt;</span>&nbsp;<span class="num" id="4901964">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901968">top4AllOnes</span>&nbsp;<span class="op" id="4901980">&amp;=</span>&nbsp;<span class="ident" id="4901983">top4AllOnes</span>&nbsp;<span class="op" id="4901995">&gt;&gt;</span>&nbsp;<span class="num" id="4901998">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902001">top4AllOnes</span>&nbsp;<span class="op" id="4902013">&amp;=</span>&nbsp;<span class="ident" id="4902016">top4AllOnes</span>&nbsp;<span class="op" id="4902028">&gt;&gt;</span>&nbsp;<span class="num" id="4902031">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902034">top4AllOnes</span>&nbsp;<span class="op" id="4902046">&amp;=</span>&nbsp;<span class="ident" id="4902049">top4AllOnes</span>&nbsp;<span class="op" id="4902061">&gt;&gt;</span>&nbsp;<span class="num" id="4902064">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902067">top4AllOnes</span>&nbsp;<span class="op" id="4902079">&amp;=</span>&nbsp;<span class="ident" id="4902082">top4AllOnes</span>&nbsp;<span class="op" id="4902094">&gt;&gt;</span>&nbsp;<span class="num" id="4902097">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902100">top4AllOnes</span>&nbsp;<span class="op" id="4902112">=</span>&nbsp;<span class="builtintype" id="4902114">uint32</span><span class="op" id="4902120">(</span><span class="builtintype" id="4902121">int32</span><span class="op" id="4902126">(</span><span class="ident" id="4902127">top4AllOnes</span><span class="op" id="4902138">&lt;&lt;</span><span class="num" id="4902140">31</span><span class="op" id="4902142">)</span>&nbsp;<span class="op" id="4902144">&gt;&gt;</span>&nbsp;<span class="num" id="4902147">31</span><span class="op" id="4902149">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902153">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902214">bottom3NonZero</span>&nbsp;<span class="op" id="4902229">:=</span>&nbsp;<span class="ident" id="4902232">out</span><span class="op" id="4902235">[</span><span class="num" id="4902236">0</span><span class="op" id="4902237">]</span>&nbsp;<span class="op" id="4902239">|</span>&nbsp;<span class="ident" id="4902241">out</span><span class="op" id="4902244">[</span><span class="num" id="4902245">1</span><span class="op" id="4902246">]</span>&nbsp;<span class="op" id="4902248">|</span>&nbsp;<span class="ident" id="4902250">out</span><span class="op" id="4902253">[</span><span class="num" id="4902254">2</span><span class="op" id="4902255">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902258">bottom3NonZero</span>&nbsp;<span class="op" id="4902273">|=</span>&nbsp;<span class="ident" id="4902276">bottom3NonZero</span>&nbsp;<span class="op" id="4902291">&gt;&gt;</span>&nbsp;<span class="num" id="4902294">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902298">bottom3NonZero</span>&nbsp;<span class="op" id="4902313">|=</span>&nbsp;<span class="ident" id="4902316">bottom3NonZero</span>&nbsp;<span class="op" id="4902331">&gt;&gt;</span>&nbsp;<span class="num" id="4902334">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902337">bottom3NonZero</span>&nbsp;<span class="op" id="4902352">|=</span>&nbsp;<span class="ident" id="4902355">bottom3NonZero</span>&nbsp;<span class="op" id="4902370">&gt;&gt;</span>&nbsp;<span class="num" id="4902373">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902376">bottom3NonZero</span>&nbsp;<span class="op" id="4902391">|=</span>&nbsp;<span class="ident" id="4902394">bottom3NonZero</span>&nbsp;<span class="op" id="4902409">&gt;&gt;</span>&nbsp;<span class="num" id="4902412">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902415">bottom3NonZero</span>&nbsp;<span class="op" id="4902430">|=</span>&nbsp;<span class="ident" id="4902433">bottom3NonZero</span>&nbsp;<span class="op" id="4902448">&gt;&gt;</span>&nbsp;<span class="num" id="4902451">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902454">bottom3NonZero</span>&nbsp;<span class="op" id="4902469">=</span>&nbsp;<span class="builtintype" id="4902471">uint32</span><span class="op" id="4902477">(</span><span class="builtintype" id="4902478">int32</span><span class="op" id="4902483">(</span><span class="ident" id="4902484">bottom3NonZero</span><span class="op" id="4902498">&lt;&lt;</span><span class="num" id="4902500">31</span><span class="op" id="4902502">)</span>&nbsp;<span class="op" id="4902504">&gt;&gt;</span>&nbsp;<span class="num" id="4902507">31</span><span class="op" id="4902509">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902513">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902560">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902637">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902710">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902748">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902804">n</span>&nbsp;<span class="op" id="4902806">:=</span>&nbsp;<span class="ident" id="4902809">out</span><span class="op" id="4902812">[</span><span class="num" id="4902813">3</span><span class="op" id="4902814">]</span>&nbsp;<span class="op" id="4902816">-</span>&nbsp;<span class="num" id="4902818">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902829">out3Equal</span>&nbsp;<span class="op" id="4902839">:=</span>&nbsp;<span class="ident" id="4902842">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902845">out3Equal</span>&nbsp;<span class="op" id="4902855">|=</span>&nbsp;<span class="ident" id="4902858">out3Equal</span>&nbsp;<span class="op" id="4902868">&gt;&gt;</span>&nbsp;<span class="num" id="4902871">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902875">out3Equal</span>&nbsp;<span class="op" id="4902885">|=</span>&nbsp;<span class="ident" id="4902888">out3Equal</span>&nbsp;<span class="op" id="4902898">&gt;&gt;</span>&nbsp;<span class="num" id="4902901">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902904">out3Equal</span>&nbsp;<span class="op" id="4902914">|=</span>&nbsp;<span class="ident" id="4902917">out3Equal</span>&nbsp;<span class="op" id="4902927">&gt;&gt;</span>&nbsp;<span class="num" id="4902930">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902933">out3Equal</span>&nbsp;<span class="op" id="4902943">|=</span>&nbsp;<span class="ident" id="4902946">out3Equal</span>&nbsp;<span class="op" id="4902956">&gt;&gt;</span>&nbsp;<span class="num" id="4902959">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902962">out3Equal</span>&nbsp;<span class="op" id="4902972">|=</span>&nbsp;<span class="ident" id="4902975">out3Equal</span>&nbsp;<span class="op" id="4902985">&gt;&gt;</span>&nbsp;<span class="num" id="4902988">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902991">out3Equal</span>&nbsp;<span class="op" id="4903001">=</span>&nbsp;<span class="op" id="4903003">^</span><span class="builtintype" id="4903004">uint32</span><span class="op" id="4903010">(</span><span class="builtintype" id="4903011">int32</span><span class="op" id="4903016">(</span><span class="ident" id="4903017">out3Equal</span><span class="op" id="4903026">&lt;&lt;</span><span class="num" id="4903028">31</span><span class="op" id="4903030">)</span>&nbsp;<span class="op" id="4903032">&gt;&gt;</span>&nbsp;<span class="num" id="4903035">31</span><span class="op" id="4903037">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4903041">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903094">out3GT</span>&nbsp;<span class="op" id="4903101">:=</span>&nbsp;<span class="op" id="4903104">^</span><span class="builtintype" id="4903105">uint32</span><span class="op" id="4903111">(</span><span class="builtintype" id="4903112">int32</span><span class="op" id="4903117">(</span><span class="ident" id="4903118">n</span><span class="op" id="4903119">)</span>&nbsp;<span class="op" id="4903121">&gt;&gt;</span>&nbsp;<span class="num" id="4903124">31</span><span class="op" id="4903126">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903130">mask</span>&nbsp;<span class="op" id="4903135">:=</span>&nbsp;<span class="ident" id="4903138">top4AllOnes</span>&nbsp;<span class="op" id="4903150">&amp;</span>&nbsp;<span class="op" id="4903152">(</span><span class="op" id="4903153">(</span><span class="ident" id="4903154">out3Equal</span>&nbsp;<span class="op" id="4903164">&amp;</span>&nbsp;<span class="ident" id="4903166">bottom3NonZero</span><span class="op" id="4903180">)</span>&nbsp;<span class="op" id="4903182">|</span>&nbsp;<span class="ident" id="4903184">out3GT</span><span class="op" id="4903190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903193">out</span><span class="op" id="4903196">[</span><span class="num" id="4903197">0</span><span class="op" id="4903198">]</span>&nbsp;<span class="op" id="4903200">-=</span>&nbsp;<span class="num" id="4903203">1</span>&nbsp;<span class="op" id="4903205">&amp;</span>&nbsp;<span class="ident" id="4903207">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903213">out</span><span class="op" id="4903216">[</span><span class="num" id="4903217">3</span><span class="op" id="4903218">]</span>&nbsp;<span class="op" id="4903220">-=</span>&nbsp;<span class="num" id="4903223">0xffff000</span>&nbsp;<span class="op" id="4903233">&amp;</span>&nbsp;<span class="ident" id="4903235">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903241">out</span><span class="op" id="4903244">[</span><span class="num" id="4903245">4</span><span class="op" id="4903246">]</span>&nbsp;<span class="op" id="4903248">-=</span>&nbsp;<span class="num" id="4903251">0xfffffff</span>&nbsp;<span class="op" id="4903261">&amp;</span>&nbsp;<span class="ident" id="4903263">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903269">out</span><span class="op" id="4903272">[</span><span class="num" id="4903273">5</span><span class="op" id="4903274">]</span>&nbsp;<span class="op" id="4903276">-=</span>&nbsp;<span class="num" id="4903279">0xfffffff</span>&nbsp;<span class="op" id="4903289">&amp;</span>&nbsp;<span class="ident" id="4903291">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903297">out</span><span class="op" id="4903300">[</span><span class="num" id="4903301">6</span><span class="op" id="4903302">]</span>&nbsp;<span class="op" id="4903304">-=</span>&nbsp;<span class="num" id="4903307">0xfffffff</span>&nbsp;<span class="op" id="4903317">&amp;</span>&nbsp;<span class="ident" id="4903319">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903325">out</span><span class="op" id="4903328">[</span><span class="num" id="4903329">7</span><span class="op" id="4903330">]</span>&nbsp;<span class="op" id="4903332">-=</span>&nbsp;<span class="num" id="4903335">0xfffffff</span>&nbsp;<span class="op" id="4903345">&amp;</span>&nbsp;<span class="ident" id="4903347">mask</span><br>
<span class="lineno">495</span><span class="op" id="4903352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4903355">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4903383">//</span><br>
<span class="lineno"></span><span class="comment" id="4903386">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4903462">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4903522">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4903575">func</span>&nbsp;<span class="ident" id="4903580">p224AddJacobian</span><span class="op" id="4903595">(</span><span class="ident" id="4903596">x3</span><span class="op" id="4903598">,</span>&nbsp;<span class="ident" id="4903600">y3</span><span class="op" id="4903602">,</span>&nbsp;<span class="ident" id="4903604">z3</span><span class="op" id="4903606">,</span>&nbsp;<span class="ident" id="4903608">x1</span><span class="op" id="4903610">,</span>&nbsp;<span class="ident" id="4903612">y1</span><span class="op" id="4903614">,</span>&nbsp;<span class="ident" id="4903616">z1</span><span class="op" id="4903618">,</span>&nbsp;<span class="ident" id="4903620">x2</span><span class="op" id="4903622">,</span>&nbsp;<span class="ident" id="4903624">y2</span><span class="op" id="4903626">,</span>&nbsp;<span class="ident" id="4903628">z2</span>&nbsp;<span class="op" id="4903631">*</span><span class="ident" id="4903632">p224FieldElement</span><span class="op" id="4903648">)</span>&nbsp;<span class="op" id="4903650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4903653">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4903747">var</span>&nbsp;<span class="ident" id="4903751">z1z1</span><span class="op" id="4903755">,</span>&nbsp;<span class="ident" id="4903757">z2z2</span><span class="op" id="4903761">,</span>&nbsp;<span class="ident" id="4903763">u1</span><span class="op" id="4903765">,</span>&nbsp;<span class="ident" id="4903767">u2</span><span class="op" id="4903769">,</span>&nbsp;<span class="ident" id="4903771">s1</span><span class="op" id="4903773">,</span>&nbsp;<span class="ident" id="4903775">s2</span><span class="op" id="4903777">,</span>&nbsp;<span class="ident" id="4903779">h</span><span class="op" id="4903780">,</span>&nbsp;<span class="ident" id="4903782">i</span><span class="op" id="4903783">,</span>&nbsp;<span class="ident" id="4903785">j</span><span class="op" id="4903786">,</span>&nbsp;<span class="ident" id="4903788">r</span><span class="op" id="4903789">,</span>&nbsp;<span class="ident" id="4903791">v</span>&nbsp;<span class="ident" id="4903793">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4903811">var</span>&nbsp;<span class="ident" id="4903815">c</span>&nbsp;<span class="ident" id="4903817">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903841">z1IsZero</span>&nbsp;<span class="op" id="4903850">:=</span>&nbsp;<span class="ident" id="4903853">p224IsZero</span><span class="op" id="4903863">(</span><span class="ident" id="4903864">z1</span><span class="op" id="4903866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903869">z2IsZero</span>&nbsp;<span class="op" id="4903878">:=</span>&nbsp;<span class="ident" id="4903881">p224IsZero</span><span class="op" id="4903891">(</span><span class="ident" id="4903892">z2</span><span class="op" id="4903894">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4903898">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903914">p224Square</span><span class="op" id="4903924">(</span><span class="op" id="4903925">&amp;</span><span class="ident" id="4903926">z1z1</span><span class="op" id="4903930">,</span>&nbsp;<span class="ident" id="4903932">z1</span><span class="op" id="4903934">,</span>&nbsp;<span class="op" id="4903936">&amp;</span><span class="ident" id="4903937">c</span><span class="op" id="4903938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4903941">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903957">p224Square</span><span class="op" id="4903967">(</span><span class="op" id="4903968">&amp;</span><span class="ident" id="4903969">z2z2</span><span class="op" id="4903973">,</span>&nbsp;<span class="ident" id="4903975">z2</span><span class="op" id="4903977">,</span>&nbsp;<span class="op" id="4903979">&amp;</span><span class="ident" id="4903980">c</span><span class="op" id="4903981">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4903984">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904001">p224Mul</span><span class="op" id="4904008">(</span><span class="op" id="4904009">&amp;</span><span class="ident" id="4904010">u1</span><span class="op" id="4904012">,</span>&nbsp;<span class="ident" id="4904014">x1</span><span class="op" id="4904016">,</span>&nbsp;<span class="op" id="4904018">&amp;</span><span class="ident" id="4904019">z2z2</span><span class="op" id="4904023">,</span>&nbsp;<span class="op" id="4904025">&amp;</span><span class="ident" id="4904026">c</span><span class="op" id="4904027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904030">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904047">p224Mul</span><span class="op" id="4904054">(</span><span class="op" id="4904055">&amp;</span><span class="ident" id="4904056">u2</span><span class="op" id="4904058">,</span>&nbsp;<span class="ident" id="4904060">x2</span><span class="op" id="4904062">,</span>&nbsp;<span class="op" id="4904064">&amp;</span><span class="ident" id="4904065">z1z1</span><span class="op" id="4904069">,</span>&nbsp;<span class="op" id="4904071">&amp;</span><span class="ident" id="4904072">c</span><span class="op" id="4904073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904076">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904096">p224Mul</span><span class="op" id="4904103">(</span><span class="op" id="4904104">&amp;</span><span class="ident" id="4904105">s1</span><span class="op" id="4904107">,</span>&nbsp;<span class="ident" id="4904109">z2</span><span class="op" id="4904111">,</span>&nbsp;<span class="op" id="4904113">&amp;</span><span class="ident" id="4904114">z2z2</span><span class="op" id="4904118">,</span>&nbsp;<span class="op" id="4904120">&amp;</span><span class="ident" id="4904121">c</span><span class="op" id="4904122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904125">p224Mul</span><span class="op" id="4904132">(</span><span class="op" id="4904133">&amp;</span><span class="ident" id="4904134">s1</span><span class="op" id="4904136">,</span>&nbsp;<span class="ident" id="4904138">y1</span><span class="op" id="4904140">,</span>&nbsp;<span class="op" id="4904142">&amp;</span><span class="ident" id="4904143">s1</span><span class="op" id="4904145">,</span>&nbsp;<span class="op" id="4904147">&amp;</span><span class="ident" id="4904148">c</span><span class="op" id="4904149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904152">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904172">p224Mul</span><span class="op" id="4904179">(</span><span class="op" id="4904180">&amp;</span><span class="ident" id="4904181">s2</span><span class="op" id="4904183">,</span>&nbsp;<span class="ident" id="4904185">z1</span><span class="op" id="4904187">,</span>&nbsp;<span class="op" id="4904189">&amp;</span><span class="ident" id="4904190">z1z1</span><span class="op" id="4904194">,</span>&nbsp;<span class="op" id="4904196">&amp;</span><span class="ident" id="4904197">c</span><span class="op" id="4904198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904201">p224Mul</span><span class="op" id="4904208">(</span><span class="op" id="4904209">&amp;</span><span class="ident" id="4904210">s2</span><span class="op" id="4904212">,</span>&nbsp;<span class="ident" id="4904214">y2</span><span class="op" id="4904216">,</span>&nbsp;<span class="op" id="4904218">&amp;</span><span class="ident" id="4904219">s2</span><span class="op" id="4904221">,</span>&nbsp;<span class="op" id="4904223">&amp;</span><span class="ident" id="4904224">c</span><span class="op" id="4904225">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904228">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904242">p224Sub</span><span class="op" id="4904249">(</span><span class="op" id="4904250">&amp;</span><span class="ident" id="4904251">h</span><span class="op" id="4904252">,</span>&nbsp;<span class="op" id="4904254">&amp;</span><span class="ident" id="4904255">u2</span><span class="op" id="4904257">,</span>&nbsp;<span class="op" id="4904259">&amp;</span><span class="ident" id="4904260">u1</span><span class="op" id="4904262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904265">p224Reduce</span><span class="op" id="4904275">(</span><span class="op" id="4904276">&amp;</span><span class="ident" id="4904277">h</span><span class="op" id="4904278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904281">xEqual</span>&nbsp;<span class="op" id="4904288">:=</span>&nbsp;<span class="ident" id="4904291">p224IsZero</span><span class="op" id="4904301">(</span><span class="op" id="4904302">&amp;</span><span class="ident" id="4904303">h</span><span class="op" id="4904304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904307">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4904323">for</span>&nbsp;<span class="ident" id="4904327">j</span>&nbsp;<span class="op" id="4904329">:=</span>&nbsp;<span class="num" id="4904332">0</span><span class="op" id="4904333">;</span>&nbsp;<span class="ident" id="4904335">j</span>&nbsp;<span class="op" id="4904337">&lt;</span>&nbsp;<span class="num" id="4904339">8</span><span class="op" id="4904340">;</span>&nbsp;<span class="ident" id="4904342">j</span><span class="op" id="4904343">++</span>&nbsp;<span class="op" id="4904346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904350">i</span><span class="op" id="4904351">[</span><span class="ident" id="4904352">j</span><span class="op" id="4904353">]</span>&nbsp;<span class="op" id="4904355">=</span>&nbsp;<span class="ident" id="4904357">h</span><span class="op" id="4904358">[</span><span class="ident" id="4904359">j</span><span class="op" id="4904360">]</span>&nbsp;<span class="op" id="4904362">&lt;&lt;</span>&nbsp;<span class="num" id="4904365">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4904368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904371">p224Reduce</span><span class="op" id="4904381">(</span><span class="op" id="4904382">&amp;</span><span class="ident" id="4904383">i</span><span class="op" id="4904384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904387">p224Square</span><span class="op" id="4904397">(</span><span class="op" id="4904398">&amp;</span><span class="ident" id="4904399">i</span><span class="op" id="4904400">,</span>&nbsp;<span class="op" id="4904402">&amp;</span><span class="ident" id="4904403">i</span><span class="op" id="4904404">,</span>&nbsp;<span class="op" id="4904406">&amp;</span><span class="ident" id="4904407">c</span><span class="op" id="4904408">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904411">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904423">p224Mul</span><span class="op" id="4904430">(</span><span class="op" id="4904431">&amp;</span><span class="ident" id="4904432">j</span><span class="op" id="4904433">,</span>&nbsp;<span class="op" id="4904435">&amp;</span><span class="ident" id="4904436">h</span><span class="op" id="4904437">,</span>&nbsp;<span class="op" id="4904439">&amp;</span><span class="ident" id="4904440">i</span><span class="op" id="4904441">,</span>&nbsp;<span class="op" id="4904443">&amp;</span><span class="ident" id="4904444">c</span><span class="op" id="4904445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904448">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904466">p224Sub</span><span class="op" id="4904473">(</span><span class="op" id="4904474">&amp;</span><span class="ident" id="4904475">r</span><span class="op" id="4904476">,</span>&nbsp;<span class="op" id="4904478">&amp;</span><span class="ident" id="4904479">s2</span><span class="op" id="4904481">,</span>&nbsp;<span class="op" id="4904483">&amp;</span><span class="ident" id="4904484">s1</span><span class="op" id="4904486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904489">p224Reduce</span><span class="op" id="4904499">(</span><span class="op" id="4904500">&amp;</span><span class="ident" id="4904501">r</span><span class="op" id="4904502">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904505">yEqual</span>&nbsp;<span class="op" id="4904512">:=</span>&nbsp;<span class="ident" id="4904515">p224IsZero</span><span class="op" id="4904525">(</span><span class="op" id="4904526">&amp;</span><span class="ident" id="4904527">r</span><span class="op" id="4904528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4904531">if</span>&nbsp;<span class="ident" id="4904534">xEqual</span>&nbsp;<span class="op" id="4904541">==</span>&nbsp;<span class="num" id="4904544">1</span>&nbsp;<span class="op" id="4904546">&amp;&amp;</span>&nbsp;<span class="ident" id="4904549">yEqual</span>&nbsp;<span class="op" id="4904556">==</span>&nbsp;<span class="num" id="4904559">1</span>&nbsp;<span class="op" id="4904561">&amp;&amp;</span>&nbsp;<span class="ident" id="4904564">z1IsZero</span>&nbsp;<span class="op" id="4904573">==</span>&nbsp;<span class="num" id="4904576">0</span>&nbsp;<span class="op" id="4904578">&amp;&amp;</span>&nbsp;<span class="ident" id="4904581">z2IsZero</span>&nbsp;<span class="op" id="4904590">==</span>&nbsp;<span class="num" id="4904593">0</span>&nbsp;<span class="op" id="4904595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904599">p224DoubleJacobian</span><span class="op" id="4904617">(</span><span class="ident" id="4904618">x3</span><span class="op" id="4904620">,</span>&nbsp;<span class="ident" id="4904622">y3</span><span class="op" id="4904624">,</span>&nbsp;<span class="ident" id="4904626">z3</span><span class="op" id="4904628">,</span>&nbsp;<span class="ident" id="4904630">x1</span><span class="op" id="4904632">,</span>&nbsp;<span class="ident" id="4904634">y1</span><span class="op" id="4904636">,</span>&nbsp;<span class="ident" id="4904638">z1</span><span class="op" id="4904640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4904644">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4904652">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4904655">for</span>&nbsp;<span class="ident" id="4904659">i</span>&nbsp;<span class="op" id="4904661">:=</span>&nbsp;<span class="num" id="4904664">0</span><span class="op" id="4904665">;</span>&nbsp;<span class="ident" id="4904667">i</span>&nbsp;<span class="op" id="4904669">&lt;</span>&nbsp;<span class="num" id="4904671">8</span><span class="op" id="4904672">;</span>&nbsp;<span class="ident" id="4904674">i</span><span class="op" id="4904675">++</span>&nbsp;<span class="op" id="4904678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904682">r</span><span class="op" id="4904683">[</span><span class="ident" id="4904684">i</span><span class="op" id="4904685">]</span>&nbsp;<span class="op" id="4904687">&lt;&lt;=</span>&nbsp;<span class="num" id="4904691">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4904694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904697">p224Reduce</span><span class="op" id="4904707">(</span><span class="op" id="4904708">&amp;</span><span class="ident" id="4904709">r</span><span class="op" id="4904710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904713">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904726">p224Mul</span><span class="op" id="4904733">(</span><span class="op" id="4904734">&amp;</span><span class="ident" id="4904735">v</span><span class="op" id="4904736">,</span>&nbsp;<span class="op" id="4904738">&amp;</span><span class="ident" id="4904739">u1</span><span class="op" id="4904741">,</span>&nbsp;<span class="op" id="4904743">&amp;</span><span class="ident" id="4904744">i</span><span class="op" id="4904745">,</span>&nbsp;<span class="op" id="4904747">&amp;</span><span class="ident" id="4904748">c</span><span class="op" id="4904749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904752">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904785">p224Add</span><span class="op" id="4904792">(</span><span class="op" id="4904793">&amp;</span><span class="ident" id="4904794">z1z1</span><span class="op" id="4904798">,</span>&nbsp;<span class="op" id="4904800">&amp;</span><span class="ident" id="4904801">z1z1</span><span class="op" id="4904805">,</span>&nbsp;<span class="op" id="4904807">&amp;</span><span class="ident" id="4904808">z2z2</span><span class="op" id="4904812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904815">p224Add</span><span class="op" id="4904822">(</span><span class="op" id="4904823">&amp;</span><span class="ident" id="4904824">z2z2</span><span class="op" id="4904828">,</span>&nbsp;<span class="ident" id="4904830">z1</span><span class="op" id="4904832">,</span>&nbsp;<span class="ident" id="4904834">z2</span><span class="op" id="4904836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904839">p224Reduce</span><span class="op" id="4904849">(</span><span class="op" id="4904850">&amp;</span><span class="ident" id="4904851">z2z2</span><span class="op" id="4904855">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904858">p224Square</span><span class="op" id="4904868">(</span><span class="op" id="4904869">&amp;</span><span class="ident" id="4904870">z2z2</span><span class="op" id="4904874">,</span>&nbsp;<span class="op" id="4904876">&amp;</span><span class="ident" id="4904877">z2z2</span><span class="op" id="4904881">,</span>&nbsp;<span class="op" id="4904883">&amp;</span><span class="ident" id="4904884">c</span><span class="op" id="4904885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904888">p224Sub</span><span class="op" id="4904895">(</span><span class="ident" id="4904896">z3</span><span class="op" id="4904898">,</span>&nbsp;<span class="op" id="4904900">&amp;</span><span class="ident" id="4904901">z2z2</span><span class="op" id="4904905">,</span>&nbsp;<span class="op" id="4904907">&amp;</span><span class="ident" id="4904908">z1z1</span><span class="op" id="4904912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904915">p224Reduce</span><span class="op" id="4904925">(</span><span class="ident" id="4904926">z3</span><span class="op" id="4904928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904931">p224Mul</span><span class="op" id="4904938">(</span><span class="ident" id="4904939">z3</span><span class="op" id="4904941">,</span>&nbsp;<span class="ident" id="4904943">z3</span><span class="op" id="4904945">,</span>&nbsp;<span class="op" id="4904947">&amp;</span><span class="ident" id="4904948">h</span><span class="op" id="4904949">,</span>&nbsp;<span class="op" id="4904951">&amp;</span><span class="ident" id="4904952">c</span><span class="op" id="4904953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904956">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4904975">for</span>&nbsp;<span class="ident" id="4904979">i</span>&nbsp;<span class="op" id="4904981">:=</span>&nbsp;<span class="num" id="4904984">0</span><span class="op" id="4904985">;</span>&nbsp;<span class="ident" id="4904987">i</span>&nbsp;<span class="op" id="4904989">&lt;</span>&nbsp;<span class="num" id="4904991">8</span><span class="op" id="4904992">;</span>&nbsp;<span class="ident" id="4904994">i</span><span class="op" id="4904995">++</span>&nbsp;<span class="op" id="4904998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905002">z1z1</span><span class="op" id="4905006">[</span><span class="ident" id="4905007">i</span><span class="op" id="4905008">]</span>&nbsp;<span class="op" id="4905010">=</span>&nbsp;<span class="ident" id="4905012">v</span><span class="op" id="4905013">[</span><span class="ident" id="4905014">i</span><span class="op" id="4905015">]</span>&nbsp;<span class="op" id="4905017">&lt;&lt;</span>&nbsp;<span class="num" id="4905020">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4905023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905026">p224Add</span><span class="op" id="4905033">(</span><span class="op" id="4905034">&amp;</span><span class="ident" id="4905035">z1z1</span><span class="op" id="4905039">,</span>&nbsp;<span class="op" id="4905041">&amp;</span><span class="ident" id="4905042">j</span><span class="op" id="4905043">,</span>&nbsp;<span class="op" id="4905045">&amp;</span><span class="ident" id="4905046">z1z1</span><span class="op" id="4905050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905053">p224Reduce</span><span class="op" id="4905063">(</span><span class="op" id="4905064">&amp;</span><span class="ident" id="4905065">z1z1</span><span class="op" id="4905069">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905072">p224Square</span><span class="op" id="4905082">(</span><span class="ident" id="4905083">x3</span><span class="op" id="4905085">,</span>&nbsp;<span class="op" id="4905087">&amp;</span><span class="ident" id="4905088">r</span><span class="op" id="4905089">,</span>&nbsp;<span class="op" id="4905091">&amp;</span><span class="ident" id="4905092">c</span><span class="op" id="4905093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905096">p224Sub</span><span class="op" id="4905103">(</span><span class="ident" id="4905104">x3</span><span class="op" id="4905106">,</span>&nbsp;<span class="ident" id="4905108">x3</span><span class="op" id="4905110">,</span>&nbsp;<span class="op" id="4905112">&amp;</span><span class="ident" id="4905113">z1z1</span><span class="op" id="4905117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905120">p224Reduce</span><span class="op" id="4905130">(</span><span class="ident" id="4905131">x3</span><span class="op" id="4905133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4905136">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4905161">for</span>&nbsp;<span class="ident" id="4905165">i</span>&nbsp;<span class="op" id="4905167">:=</span>&nbsp;<span class="num" id="4905170">0</span><span class="op" id="4905171">;</span>&nbsp;<span class="ident" id="4905173">i</span>&nbsp;<span class="op" id="4905175">&lt;</span>&nbsp;<span class="num" id="4905177">8</span><span class="op" id="4905178">;</span>&nbsp;<span class="ident" id="4905180">i</span><span class="op" id="4905181">++</span>&nbsp;<span class="op" id="4905184">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905188">s1</span><span class="op" id="4905190">[</span><span class="ident" id="4905191">i</span><span class="op" id="4905192">]</span>&nbsp;<span class="op" id="4905194">&lt;&lt;=</span>&nbsp;<span class="num" id="4905198">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4905201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905204">p224Mul</span><span class="op" id="4905211">(</span><span class="op" id="4905212">&amp;</span><span class="ident" id="4905213">s1</span><span class="op" id="4905215">,</span>&nbsp;<span class="op" id="4905217">&amp;</span><span class="ident" id="4905218">s1</span><span class="op" id="4905220">,</span>&nbsp;<span class="op" id="4905222">&amp;</span><span class="ident" id="4905223">j</span><span class="op" id="4905224">,</span>&nbsp;<span class="op" id="4905226">&amp;</span><span class="ident" id="4905227">c</span><span class="op" id="4905228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905231">p224Sub</span><span class="op" id="4905238">(</span><span class="op" id="4905239">&amp;</span><span class="ident" id="4905240">z1z1</span><span class="op" id="4905244">,</span>&nbsp;<span class="op" id="4905246">&amp;</span><span class="ident" id="4905247">v</span><span class="op" id="4905248">,</span>&nbsp;<span class="ident" id="4905250">x3</span><span class="op" id="4905252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905255">p224Reduce</span><span class="op" id="4905265">(</span><span class="op" id="4905266">&amp;</span><span class="ident" id="4905267">z1z1</span><span class="op" id="4905271">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905274">p224Mul</span><span class="op" id="4905281">(</span><span class="op" id="4905282">&amp;</span><span class="ident" id="4905283">z1z1</span><span class="op" id="4905287">,</span>&nbsp;<span class="op" id="4905289">&amp;</span><span class="ident" id="4905290">z1z1</span><span class="op" id="4905294">,</span>&nbsp;<span class="op" id="4905296">&amp;</span><span class="ident" id="4905297">r</span><span class="op" id="4905298">,</span>&nbsp;<span class="op" id="4905300">&amp;</span><span class="ident" id="4905301">c</span><span class="op" id="4905302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905305">p224Sub</span><span class="op" id="4905312">(</span><span class="ident" id="4905313">y3</span><span class="op" id="4905315">,</span>&nbsp;<span class="op" id="4905317">&amp;</span><span class="ident" id="4905318">z1z1</span><span class="op" id="4905322">,</span>&nbsp;<span class="op" id="4905324">&amp;</span><span class="ident" id="4905325">s1</span><span class="op" id="4905327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905330">p224Reduce</span><span class="op" id="4905340">(</span><span class="ident" id="4905341">y3</span><span class="op" id="4905343">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905347">p224CopyConditional</span><span class="op" id="4905366">(</span><span class="ident" id="4905367">x3</span><span class="op" id="4905369">,</span>&nbsp;<span class="ident" id="4905371">x2</span><span class="op" id="4905373">,</span>&nbsp;<span class="ident" id="4905375">z1IsZero</span><span class="op" id="4905383">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905386">p224CopyConditional</span><span class="op" id="4905405">(</span><span class="ident" id="4905406">x3</span><span class="op" id="4905408">,</span>&nbsp;<span class="ident" id="4905410">x1</span><span class="op" id="4905412">,</span>&nbsp;<span class="ident" id="4905414">z2IsZero</span><span class="op" id="4905422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905425">p224CopyConditional</span><span class="op" id="4905444">(</span><span class="ident" id="4905445">y3</span><span class="op" id="4905447">,</span>&nbsp;<span class="ident" id="4905449">y2</span><span class="op" id="4905451">,</span>&nbsp;<span class="ident" id="4905453">z1IsZero</span><span class="op" id="4905461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905464">p224CopyConditional</span><span class="op" id="4905483">(</span><span class="ident" id="4905484">y3</span><span class="op" id="4905486">,</span>&nbsp;<span class="ident" id="4905488">y1</span><span class="op" id="4905490">,</span>&nbsp;<span class="ident" id="4905492">z2IsZero</span><span class="op" id="4905500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905503">p224CopyConditional</span><span class="op" id="4905522">(</span><span class="ident" id="4905523">z3</span><span class="op" id="4905525">,</span>&nbsp;<span class="ident" id="4905527">z2</span><span class="op" id="4905529">,</span>&nbsp;<span class="ident" id="4905531">z1IsZero</span><span class="op" id="4905539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905542">p224CopyConditional</span><span class="op" id="4905561">(</span><span class="ident" id="4905562">z3</span><span class="op" id="4905564">,</span>&nbsp;<span class="ident" id="4905566">z1</span><span class="op" id="4905568">,</span>&nbsp;<span class="ident" id="4905570">z2IsZero</span><span class="op" id="4905578">)</span><br>
<span class="lineno">585</span><span class="op" id="4905580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4905583">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4905626">func</span>&nbsp;<span class="ident" id="4905631">p224DoubleJacobian</span><span class="op" id="4905649">(</span><span class="ident" id="4905650">x3</span><span class="op" id="4905652">,</span>&nbsp;<span class="ident" id="4905654">y3</span><span class="op" id="4905656">,</span>&nbsp;<span class="ident" id="4905658">z3</span><span class="op" id="4905660">,</span>&nbsp;<span class="ident" id="4905662">x1</span><span class="op" id="4905664">,</span>&nbsp;<span class="ident" id="4905666">y1</span><span class="op" id="4905668">,</span>&nbsp;<span class="ident" id="4905670">z1</span>&nbsp;<span class="op" id="4905673">*</span><span class="ident" id="4905674">p224FieldElement</span><span class="op" id="4905690">)</span>&nbsp;<span class="op" id="4905692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4905695">var</span>&nbsp;<span class="ident" id="4905699">delta</span><span class="op" id="4905704">,</span>&nbsp;<span class="ident" id="4905706">gamma</span><span class="op" id="4905711">,</span>&nbsp;<span class="ident" id="4905713">beta</span><span class="op" id="4905717">,</span>&nbsp;<span class="ident" id="4905719">alpha</span><span class="op" id="4905724">,</span>&nbsp;<span class="ident" id="4905726">t</span>&nbsp;<span class="ident" id="4905728">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4905746">var</span>&nbsp;<span class="ident" id="4905750">c</span>&nbsp;<span class="ident" id="4905752">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905776">p224Square</span><span class="op" id="4905786">(</span><span class="op" id="4905787">&amp;</span><span class="ident" id="4905788">delta</span><span class="op" id="4905793">,</span>&nbsp;<span class="ident" id="4905795">z1</span><span class="op" id="4905797">,</span>&nbsp;<span class="op" id="4905799">&amp;</span><span class="ident" id="4905800">c</span><span class="op" id="4905801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905804">p224Square</span><span class="op" id="4905814">(</span><span class="op" id="4905815">&amp;</span><span class="ident" id="4905816">gamma</span><span class="op" id="4905821">,</span>&nbsp;<span class="ident" id="4905823">y1</span><span class="op" id="4905825">,</span>&nbsp;<span class="op" id="4905827">&amp;</span><span class="ident" id="4905828">c</span><span class="op" id="4905829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905832">p224Mul</span><span class="op" id="4905839">(</span><span class="op" id="4905840">&amp;</span><span class="ident" id="4905841">beta</span><span class="op" id="4905845">,</span>&nbsp;<span class="ident" id="4905847">x1</span><span class="op" id="4905849">,</span>&nbsp;<span class="op" id="4905851">&amp;</span><span class="ident" id="4905852">gamma</span><span class="op" id="4905857">,</span>&nbsp;<span class="op" id="4905859">&amp;</span><span class="ident" id="4905860">c</span><span class="op" id="4905861">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4905865">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905901">p224Add</span><span class="op" id="4905908">(</span><span class="op" id="4905909">&amp;</span><span class="ident" id="4905910">t</span><span class="op" id="4905911">,</span>&nbsp;<span class="ident" id="4905913">x1</span><span class="op" id="4905915">,</span>&nbsp;<span class="op" id="4905917">&amp;</span><span class="ident" id="4905918">delta</span><span class="op" id="4905923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4905926">for</span>&nbsp;<span class="ident" id="4905930">i</span>&nbsp;<span class="op" id="4905932">:=</span>&nbsp;<span class="num" id="4905935">0</span><span class="op" id="4905936">;</span>&nbsp;<span class="ident" id="4905938">i</span>&nbsp;<span class="op" id="4905940">&lt;</span>&nbsp;<span class="num" id="4905942">8</span><span class="op" id="4905943">;</span>&nbsp;<span class="ident" id="4905945">i</span><span class="op" id="4905946">++</span>&nbsp;<span class="op" id="4905949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905953">t</span><span class="op" id="4905954">[</span><span class="ident" id="4905955">i</span><span class="op" id="4905956">]</span>&nbsp;<span class="op" id="4905958">+=</span>&nbsp;<span class="ident" id="4905961">t</span><span class="op" id="4905962">[</span><span class="ident" id="4905963">i</span><span class="op" id="4905964">]</span>&nbsp;<span class="op" id="4905966">&lt;&lt;</span>&nbsp;<span class="num" id="4905969">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4905972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905975">p224Reduce</span><span class="op" id="4905985">(</span><span class="op" id="4905986">&amp;</span><span class="ident" id="4905987">t</span><span class="op" id="4905988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905991">p224Sub</span><span class="op" id="4905998">(</span><span class="op" id="4905999">&amp;</span><span class="ident" id="4906000">alpha</span><span class="op" id="4906005">,</span>&nbsp;<span class="ident" id="4906007">x1</span><span class="op" id="4906009">,</span>&nbsp;<span class="op" id="4906011">&amp;</span><span class="ident" id="4906012">delta</span><span class="op" id="4906017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906020">p224Reduce</span><span class="op" id="4906030">(</span><span class="op" id="4906031">&amp;</span><span class="ident" id="4906032">alpha</span><span class="op" id="4906037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906040">p224Mul</span><span class="op" id="4906047">(</span><span class="op" id="4906048">&amp;</span><span class="ident" id="4906049">alpha</span><span class="op" id="4906054">,</span>&nbsp;<span class="op" id="4906056">&amp;</span><span class="ident" id="4906057">alpha</span><span class="op" id="4906062">,</span>&nbsp;<span class="op" id="4906064">&amp;</span><span class="ident" id="4906065">t</span><span class="op" id="4906066">,</span>&nbsp;<span class="op" id="4906068">&amp;</span><span class="ident" id="4906069">c</span><span class="op" id="4906070">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4906074">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906105">p224Add</span><span class="op" id="4906112">(</span><span class="ident" id="4906113">z3</span><span class="op" id="4906115">,</span>&nbsp;<span class="ident" id="4906117">y1</span><span class="op" id="4906119">,</span>&nbsp;<span class="ident" id="4906121">z1</span><span class="op" id="4906123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906126">p224Reduce</span><span class="op" id="4906136">(</span><span class="ident" id="4906137">z3</span><span class="op" id="4906139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906142">p224Square</span><span class="op" id="4906152">(</span><span class="ident" id="4906153">z3</span><span class="op" id="4906155">,</span>&nbsp;<span class="ident" id="4906157">z3</span><span class="op" id="4906159">,</span>&nbsp;<span class="op" id="4906161">&amp;</span><span class="ident" id="4906162">c</span><span class="op" id="4906163">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906166">p224Sub</span><span class="op" id="4906173">(</span><span class="ident" id="4906174">z3</span><span class="op" id="4906176">,</span>&nbsp;<span class="ident" id="4906178">z3</span><span class="op" id="4906180">,</span>&nbsp;<span class="op" id="4906182">&amp;</span><span class="ident" id="4906183">gamma</span><span class="op" id="4906188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906191">p224Reduce</span><span class="op" id="4906201">(</span><span class="ident" id="4906202">z3</span><span class="op" id="4906204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906207">p224Sub</span><span class="op" id="4906214">(</span><span class="ident" id="4906215">z3</span><span class="op" id="4906217">,</span>&nbsp;<span class="ident" id="4906219">z3</span><span class="op" id="4906221">,</span>&nbsp;<span class="op" id="4906223">&amp;</span><span class="ident" id="4906224">delta</span><span class="op" id="4906229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906232">p224Reduce</span><span class="op" id="4906242">(</span><span class="ident" id="4906243">z3</span><span class="op" id="4906245">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4906249">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4906273">for</span>&nbsp;<span class="ident" id="4906277">i</span>&nbsp;<span class="op" id="4906279">:=</span>&nbsp;<span class="num" id="4906282">0</span><span class="op" id="4906283">;</span>&nbsp;<span class="ident" id="4906285">i</span>&nbsp;<span class="op" id="4906287">&lt;</span>&nbsp;<span class="num" id="4906289">8</span><span class="op" id="4906290">;</span>&nbsp;<span class="ident" id="4906292">i</span><span class="op" id="4906293">++</span>&nbsp;<span class="op" id="4906296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906300">delta</span><span class="op" id="4906305">[</span><span class="ident" id="4906306">i</span><span class="op" id="4906307">]</span>&nbsp;<span class="op" id="4906309">=</span>&nbsp;<span class="ident" id="4906311">beta</span><span class="op" id="4906315">[</span><span class="ident" id="4906316">i</span><span class="op" id="4906317">]</span>&nbsp;<span class="op" id="4906319">&lt;&lt;</span>&nbsp;<span class="num" id="4906322">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4906325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906328">p224Reduce</span><span class="op" id="4906338">(</span><span class="op" id="4906339">&amp;</span><span class="ident" id="4906340">delta</span><span class="op" id="4906345">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906348">p224Square</span><span class="op" id="4906358">(</span><span class="ident" id="4906359">x3</span><span class="op" id="4906361">,</span>&nbsp;<span class="op" id="4906363">&amp;</span><span class="ident" id="4906364">alpha</span><span class="op" id="4906369">,</span>&nbsp;<span class="op" id="4906371">&amp;</span><span class="ident" id="4906372">c</span><span class="op" id="4906373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906376">p224Sub</span><span class="op" id="4906383">(</span><span class="ident" id="4906384">x3</span><span class="op" id="4906386">,</span>&nbsp;<span class="ident" id="4906388">x3</span><span class="op" id="4906390">,</span>&nbsp;<span class="op" id="4906392">&amp;</span><span class="ident" id="4906393">delta</span><span class="op" id="4906398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906401">p224Reduce</span><span class="op" id="4906411">(</span><span class="ident" id="4906412">x3</span><span class="op" id="4906414">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4906418">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4906455">for</span>&nbsp;<span class="ident" id="4906459">i</span>&nbsp;<span class="op" id="4906461">:=</span>&nbsp;<span class="num" id="4906464">0</span><span class="op" id="4906465">;</span>&nbsp;<span class="ident" id="4906467">i</span>&nbsp;<span class="op" id="4906469">&lt;</span>&nbsp;<span class="num" id="4906471">8</span><span class="op" id="4906472">;</span>&nbsp;<span class="ident" id="4906474">i</span><span class="op" id="4906475">++</span>&nbsp;<span class="op" id="4906478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906482">beta</span><span class="op" id="4906486">[</span><span class="ident" id="4906487">i</span><span class="op" id="4906488">]</span>&nbsp;<span class="op" id="4906490">&lt;&lt;=</span>&nbsp;<span class="num" id="4906494">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4906497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906500">p224Sub</span><span class="op" id="4906507">(</span><span class="op" id="4906508">&amp;</span><span class="ident" id="4906509">beta</span><span class="op" id="4906513">,</span>&nbsp;<span class="op" id="4906515">&amp;</span><span class="ident" id="4906516">beta</span><span class="op" id="4906520">,</span>&nbsp;<span class="ident" id="4906522">x3</span><span class="op" id="4906524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906527">p224Reduce</span><span class="op" id="4906537">(</span><span class="op" id="4906538">&amp;</span><span class="ident" id="4906539">beta</span><span class="op" id="4906543">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906546">p224Square</span><span class="op" id="4906556">(</span><span class="op" id="4906557">&amp;</span><span class="ident" id="4906558">gamma</span><span class="op" id="4906563">,</span>&nbsp;<span class="op" id="4906565">&amp;</span><span class="ident" id="4906566">gamma</span><span class="op" id="4906571">,</span>&nbsp;<span class="op" id="4906573">&amp;</span><span class="ident" id="4906574">c</span><span class="op" id="4906575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4906578">for</span>&nbsp;<span class="ident" id="4906582">i</span>&nbsp;<span class="op" id="4906584">:=</span>&nbsp;<span class="num" id="4906587">0</span><span class="op" id="4906588">;</span>&nbsp;<span class="ident" id="4906590">i</span>&nbsp;<span class="op" id="4906592">&lt;</span>&nbsp;<span class="num" id="4906594">8</span><span class="op" id="4906595">;</span>&nbsp;<span class="ident" id="4906597">i</span><span class="op" id="4906598">++</span>&nbsp;<span class="op" id="4906601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906605">gamma</span><span class="op" id="4906610">[</span><span class="ident" id="4906611">i</span><span class="op" id="4906612">]</span>&nbsp;<span class="op" id="4906614">&lt;&lt;=</span>&nbsp;<span class="num" id="4906618">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4906621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906624">p224Reduce</span><span class="op" id="4906634">(</span><span class="op" id="4906635">&amp;</span><span class="ident" id="4906636">gamma</span><span class="op" id="4906641">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906644">p224Mul</span><span class="op" id="4906651">(</span><span class="ident" id="4906652">y3</span><span class="op" id="4906654">,</span>&nbsp;<span class="op" id="4906656">&amp;</span><span class="ident" id="4906657">alpha</span><span class="op" id="4906662">,</span>&nbsp;<span class="op" id="4906664">&amp;</span><span class="ident" id="4906665">beta</span><span class="op" id="4906669">,</span>&nbsp;<span class="op" id="4906671">&amp;</span><span class="ident" id="4906672">c</span><span class="op" id="4906673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906676">p224Sub</span><span class="op" id="4906683">(</span><span class="ident" id="4906684">y3</span><span class="op" id="4906686">,</span>&nbsp;<span class="ident" id="4906688">y3</span><span class="op" id="4906690">,</span>&nbsp;<span class="op" id="4906692">&amp;</span><span class="ident" id="4906693">gamma</span><span class="op" id="4906698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906701">p224Reduce</span><span class="op" id="4906711">(</span><span class="ident" id="4906712">y3</span><span class="op" id="4906714">)</span><br>
<span class="lineno"></span><span class="op" id="4906716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4906719">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4906799">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4906841">func</span>&nbsp;<span class="ident" id="4906846">p224CopyConditional</span><span class="op" id="4906865">(</span><span class="ident" id="4906866">out</span><span class="op" id="4906869">,</span>&nbsp;<span class="ident" id="4906871">in</span>&nbsp;<span class="op" id="4906874">*</span><span class="ident" id="4906875">p224FieldElement</span><span class="op" id="4906891">,</span>&nbsp;<span class="ident" id="4906893">control</span>&nbsp;<span class="builtintype" id="4906901">uint32</span><span class="op" id="4906907">)</span>&nbsp;<span class="op" id="4906909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906912">control</span>&nbsp;<span class="op" id="4906920">&lt;&lt;=</span>&nbsp;<span class="num" id="4906924">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906928">control</span>&nbsp;<span class="op" id="4906936">=</span>&nbsp;<span class="builtintype" id="4906938">uint32</span><span class="op" id="4906944">(</span><span class="builtintype" id="4906945">int32</span><span class="op" id="4906950">(</span><span class="ident" id="4906951">control</span><span class="op" id="4906958">)</span>&nbsp;<span class="op" id="4906960">&gt;&gt;</span>&nbsp;<span class="num" id="4906963">31</span><span class="op" id="4906965">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4906969">for</span>&nbsp;<span class="ident" id="4906973">i</span>&nbsp;<span class="op" id="4906975">:=</span>&nbsp;<span class="num" id="4906978">0</span><span class="op" id="4906979">;</span>&nbsp;<span class="ident" id="4906981">i</span>&nbsp;<span class="op" id="4906983">&lt;</span>&nbsp;<span class="num" id="4906985">8</span><span class="op" id="4906986">;</span>&nbsp;<span class="ident" id="4906988">i</span><span class="op" id="4906989">++</span>&nbsp;<span class="op" id="4906992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906996">out</span><span class="op" id="4906999">[</span><span class="ident" id="4907000">i</span><span class="op" id="4907001">]</span>&nbsp;<span class="op" id="4907003">^=</span>&nbsp;<span class="op" id="4907006">(</span><span class="ident" id="4907007">out</span><span class="op" id="4907010">[</span><span class="ident" id="4907011">i</span><span class="op" id="4907012">]</span>&nbsp;<span class="op" id="4907014">^</span>&nbsp;<span class="ident" id="4907016">in</span><span class="op" id="4907018">[</span><span class="ident" id="4907019">i</span><span class="op" id="4907020">]</span><span class="op" id="4907021">)</span>&nbsp;<span class="op" id="4907023">&amp;</span>&nbsp;<span class="ident" id="4907025">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4907034">}</span><br>
<span class="lineno"></span><span class="op" id="4907036">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4907039">func</span>&nbsp;<span class="ident" id="4907044">p224ScalarMult</span><span class="op" id="4907058">(</span><span class="ident" id="4907059">outX</span><span class="op" id="4907063">,</span>&nbsp;<span class="ident" id="4907065">outY</span><span class="op" id="4907069">,</span>&nbsp;<span class="ident" id="4907071">outZ</span><span class="op" id="4907075">,</span>&nbsp;<span class="ident" id="4907077">inX</span><span class="op" id="4907080">,</span>&nbsp;<span class="ident" id="4907082">inY</span><span class="op" id="4907085">,</span>&nbsp;<span class="ident" id="4907087">inZ</span>&nbsp;<span class="op" id="4907091">*</span><span class="ident" id="4907092">p224FieldElement</span><span class="op" id="4907108">,</span>&nbsp;<span class="ident" id="4907110">scalar</span>&nbsp;<span class="op" id="4907117">[</span><span class="op" id="4907118">]</span><span class="builtintype" id="4907119">byte</span><span class="op" id="4907123">)</span>&nbsp;<span class="op" id="4907125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907128">var</span>&nbsp;<span class="ident" id="4907132">xx</span><span class="op" id="4907134">,</span>&nbsp;<span class="ident" id="4907136">yy</span><span class="op" id="4907138">,</span>&nbsp;<span class="ident" id="4907140">zz</span>&nbsp;<span class="ident" id="4907143">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907161">for</span>&nbsp;<span class="ident" id="4907165">i</span>&nbsp;<span class="op" id="4907167">:=</span>&nbsp;<span class="num" id="4907170">0</span><span class="op" id="4907171">;</span>&nbsp;<span class="ident" id="4907173">i</span>&nbsp;<span class="op" id="4907175">&lt;</span>&nbsp;<span class="num" id="4907177">8</span><span class="op" id="4907178">;</span>&nbsp;<span class="ident" id="4907180">i</span><span class="op" id="4907181">++</span>&nbsp;<span class="op" id="4907184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907188">outX</span><span class="op" id="4907192">[</span><span class="ident" id="4907193">i</span><span class="op" id="4907194">]</span>&nbsp;<span class="op" id="4907196">=</span>&nbsp;<span class="num" id="4907198">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907202">outY</span><span class="op" id="4907206">[</span><span class="ident" id="4907207">i</span><span class="op" id="4907208">]</span>&nbsp;<span class="op" id="4907210">=</span>&nbsp;<span class="num" id="4907212">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907216">outZ</span><span class="op" id="4907220">[</span><span class="ident" id="4907221">i</span><span class="op" id="4907222">]</span>&nbsp;<span class="op" id="4907224">=</span>&nbsp;<span class="num" id="4907226">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4907229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907233">for</span>&nbsp;<span class="ident" id="4907237">_</span><span class="op" id="4907238">,</span>&nbsp;<span class="builtintype" id="4907240">byte</span>&nbsp;<span class="op" id="4907245">:=</span>&nbsp;<span class="keyword" id="4907248">range</span>&nbsp;<span class="ident" id="4907254">scalar</span>&nbsp;<span class="op" id="4907261">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907265">for</span>&nbsp;<span class="ident" id="4907269">bitNum</span>&nbsp;<span class="op" id="4907276">:=</span>&nbsp;<span class="builtintype" id="4907279">uint</span><span class="op" id="4907283">(</span><span class="num" id="4907284">0</span><span class="op" id="4907285">)</span><span class="op" id="4907286">;</span>&nbsp;<span class="ident" id="4907288">bitNum</span>&nbsp;<span class="op" id="4907295">&lt;</span>&nbsp;<span class="num" id="4907297">8</span><span class="op" id="4907298">;</span>&nbsp;<span class="ident" id="4907300">bitNum</span><span class="op" id="4907306">++</span>&nbsp;<span class="op" id="4907309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907314">p224DoubleJacobian</span><span class="op" id="4907332">(</span><span class="ident" id="4907333">outX</span><span class="op" id="4907337">,</span>&nbsp;<span class="ident" id="4907339">outY</span><span class="op" id="4907343">,</span>&nbsp;<span class="ident" id="4907345">outZ</span><span class="op" id="4907349">,</span>&nbsp;<span class="ident" id="4907351">outX</span><span class="op" id="4907355">,</span>&nbsp;<span class="ident" id="4907357">outY</span><span class="op" id="4907361">,</span>&nbsp;<span class="ident" id="4907363">outZ</span><span class="op" id="4907367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907372">bit</span>&nbsp;<span class="op" id="4907376">:=</span>&nbsp;<span class="builtintype" id="4907379">uint32</span><span class="op" id="4907385">(</span><span class="op" id="4907386">(</span><span class="builtintype" id="4907387">byte</span>&nbsp;<span class="op" id="4907392">&gt;&gt;</span>&nbsp;<span class="op" id="4907395">(</span><span class="num" id="4907396">7</span>&nbsp;<span class="op" id="4907398">-</span>&nbsp;<span class="ident" id="4907400">bitNum</span><span class="op" id="4907406">)</span><span class="op" id="4907407">)</span>&nbsp;<span class="op" id="4907409">&amp;</span>&nbsp;<span class="num" id="4907411">1</span><span class="op" id="4907412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907417">p224AddJacobian</span><span class="op" id="4907432">(</span><span class="op" id="4907433">&amp;</span><span class="ident" id="4907434">xx</span><span class="op" id="4907436">,</span>&nbsp;<span class="op" id="4907438">&amp;</span><span class="ident" id="4907439">yy</span><span class="op" id="4907441">,</span>&nbsp;<span class="op" id="4907443">&amp;</span><span class="ident" id="4907444">zz</span><span class="op" id="4907446">,</span>&nbsp;<span class="ident" id="4907448">inX</span><span class="op" id="4907451">,</span>&nbsp;<span class="ident" id="4907453">inY</span><span class="op" id="4907456">,</span>&nbsp;<span class="ident" id="4907458">inZ</span><span class="op" id="4907461">,</span>&nbsp;<span class="ident" id="4907463">outX</span><span class="op" id="4907467">,</span>&nbsp;<span class="ident" id="4907469">outY</span><span class="op" id="4907473">,</span>&nbsp;<span class="ident" id="4907475">outZ</span><span class="op" id="4907479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907484">p224CopyConditional</span><span class="op" id="4907503">(</span><span class="ident" id="4907504">outX</span><span class="op" id="4907508">,</span>&nbsp;<span class="op" id="4907510">&amp;</span><span class="ident" id="4907511">xx</span><span class="op" id="4907513">,</span>&nbsp;<span class="ident" id="4907515">bit</span><span class="op" id="4907518">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907523">p224CopyConditional</span><span class="op" id="4907542">(</span><span class="ident" id="4907543">outY</span><span class="op" id="4907547">,</span>&nbsp;<span class="op" id="4907549">&amp;</span><span class="ident" id="4907550">yy</span><span class="op" id="4907552">,</span>&nbsp;<span class="ident" id="4907554">bit</span><span class="op" id="4907557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907562">p224CopyConditional</span><span class="op" id="4907581">(</span><span class="ident" id="4907582">outZ</span><span class="op" id="4907586">,</span>&nbsp;<span class="op" id="4907588">&amp;</span><span class="ident" id="4907589">zz</span><span class="op" id="4907591">,</span>&nbsp;<span class="ident" id="4907593">bit</span><span class="op" id="4907596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4907600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4907603">}</span><br>
<span class="lineno"></span><span class="op" id="4907605">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4907608">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4907663">func</span>&nbsp;<span class="ident" id="4907668">p224ToAffine</span><span class="op" id="4907680">(</span><span class="ident" id="4907681">x</span><span class="op" id="4907682">,</span>&nbsp;<span class="ident" id="4907684">y</span><span class="op" id="4907685">,</span>&nbsp;<span class="ident" id="4907687">z</span>&nbsp;<span class="op" id="4907689">*</span><span class="ident" id="4907690">p224FieldElement</span><span class="op" id="4907706">)</span>&nbsp;<span class="op" id="4907708">(</span><span class="op" id="4907709">*</span><span class="ident" id="4907710">big</span><span class="op" id="4907713">.</span><span class="ident" id="4907714">Int</span><span class="op" id="4907717">,</span>&nbsp;<span class="op" id="4907719">*</span><span class="ident" id="4907720">big</span><span class="op" id="4907723">.</span><span class="ident" id="4907724">Int</span><span class="op" id="4907727">)</span>&nbsp;<span class="op" id="4907729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907732">var</span>&nbsp;<span class="ident" id="4907736">zinv</span><span class="op" id="4907740">,</span>&nbsp;<span class="ident" id="4907742">zinvsq</span><span class="op" id="4907748">,</span>&nbsp;<span class="ident" id="4907750">outx</span><span class="op" id="4907754">,</span>&nbsp;<span class="ident" id="4907756">outy</span>&nbsp;<span class="ident" id="4907761">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907779">var</span>&nbsp;<span class="ident" id="4907783">tmp</span>&nbsp;<span class="ident" id="4907787">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907811">if</span>&nbsp;<span class="ident" id="4907814">isPointAtInfinity</span>&nbsp;<span class="op" id="4907832">:=</span>&nbsp;<span class="ident" id="4907835">p224IsZero</span><span class="op" id="4907845">(</span><span class="ident" id="4907846">z</span><span class="op" id="4907847">)</span><span class="op" id="4907848">;</span>&nbsp;<span class="ident" id="4907850">isPointAtInfinity</span>&nbsp;<span class="op" id="4907868">==</span>&nbsp;<span class="num" id="4907871">1</span>&nbsp;<span class="op" id="4907873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907877">return</span>&nbsp;<span class="builtinfunc" id="4907884">new</span><span class="op" id="4907887">(</span><span class="ident" id="4907888">big</span><span class="op" id="4907891">.</span><span class="ident" id="4907892">Int</span><span class="op" id="4907895">)</span><span class="op" id="4907896">,</span>&nbsp;<span class="builtinfunc" id="4907898">new</span><span class="op" id="4907901">(</span><span class="ident" id="4907902">big</span><span class="op" id="4907905">.</span><span class="ident" id="4907906">Int</span><span class="op" id="4907909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4907912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907916">p224Invert</span><span class="op" id="4907926">(</span><span class="op" id="4907927">&amp;</span><span class="ident" id="4907928">zinv</span><span class="op" id="4907932">,</span>&nbsp;<span class="ident" id="4907934">z</span><span class="op" id="4907935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907938">p224Square</span><span class="op" id="4907948">(</span><span class="op" id="4907949">&amp;</span><span class="ident" id="4907950">zinvsq</span><span class="op" id="4907956">,</span>&nbsp;<span class="op" id="4907958">&amp;</span><span class="ident" id="4907959">zinv</span><span class="op" id="4907963">,</span>&nbsp;<span class="op" id="4907965">&amp;</span><span class="ident" id="4907966">tmp</span><span class="op" id="4907969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907972">p224Mul</span><span class="op" id="4907979">(</span><span class="ident" id="4907980">x</span><span class="op" id="4907981">,</span>&nbsp;<span class="ident" id="4907983">x</span><span class="op" id="4907984">,</span>&nbsp;<span class="op" id="4907986">&amp;</span><span class="ident" id="4907987">zinvsq</span><span class="op" id="4907993">,</span>&nbsp;<span class="op" id="4907995">&amp;</span><span class="ident" id="4907996">tmp</span><span class="op" id="4907999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908002">p224Mul</span><span class="op" id="4908009">(</span><span class="op" id="4908010">&amp;</span><span class="ident" id="4908011">zinvsq</span><span class="op" id="4908017">,</span>&nbsp;<span class="op" id="4908019">&amp;</span><span class="ident" id="4908020">zinvsq</span><span class="op" id="4908026">,</span>&nbsp;<span class="op" id="4908028">&amp;</span><span class="ident" id="4908029">zinv</span><span class="op" id="4908033">,</span>&nbsp;<span class="op" id="4908035">&amp;</span><span class="ident" id="4908036">tmp</span><span class="op" id="4908039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908042">p224Mul</span><span class="op" id="4908049">(</span><span class="ident" id="4908050">y</span><span class="op" id="4908051">,</span>&nbsp;<span class="ident" id="4908053">y</span><span class="op" id="4908054">,</span>&nbsp;<span class="op" id="4908056">&amp;</span><span class="ident" id="4908057">zinvsq</span><span class="op" id="4908063">,</span>&nbsp;<span class="op" id="4908065">&amp;</span><span class="ident" id="4908066">tmp</span><span class="op" id="4908069">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908073">p224Contract</span><span class="op" id="4908085">(</span><span class="op" id="4908086">&amp;</span><span class="ident" id="4908087">outx</span><span class="op" id="4908091">,</span>&nbsp;<span class="ident" id="4908093">x</span><span class="op" id="4908094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908097">p224Contract</span><span class="op" id="4908109">(</span><span class="op" id="4908110">&amp;</span><span class="ident" id="4908111">outy</span><span class="op" id="4908115">,</span>&nbsp;<span class="ident" id="4908117">y</span><span class="op" id="4908118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908121">return</span>&nbsp;<span class="ident" id="4908128">p224ToBig</span><span class="op" id="4908137">(</span><span class="op" id="4908138">&amp;</span><span class="ident" id="4908139">outx</span><span class="op" id="4908143">)</span><span class="op" id="4908144">,</span>&nbsp;<span class="ident" id="4908146">p224ToBig</span><span class="op" id="4908155">(</span><span class="op" id="4908156">&amp;</span><span class="ident" id="4908157">outy</span><span class="op" id="4908161">)</span><br>
<span class="lineno"></span><span class="op" id="4908163">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4908166">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4908241">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4908293">func</span>&nbsp;<span class="ident" id="4908298">get28BitsFromEnd</span><span class="op" id="4908314">(</span><span class="ident" id="4908315">buf</span>&nbsp;<span class="op" id="4908319">[</span><span class="op" id="4908320">]</span><span class="builtintype" id="4908321">byte</span><span class="op" id="4908325">,</span>&nbsp;<span class="ident" id="4908327">shift</span>&nbsp;<span class="builtintype" id="4908333">uint</span><span class="op" id="4908337">)</span>&nbsp;<span class="op" id="4908339">(</span><span class="builtintype" id="4908340">uint32</span><span class="op" id="4908346">,</span>&nbsp;<span class="op" id="4908348">[</span><span class="op" id="4908349">]</span><span class="builtintype" id="4908350">byte</span><span class="op" id="4908354">)</span>&nbsp;<span class="op" id="4908356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908359">var</span>&nbsp;<span class="ident" id="4908363">ret</span>&nbsp;<span class="builtintype" id="4908367">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908376">for</span>&nbsp;<span class="ident" id="4908380">i</span>&nbsp;<span class="op" id="4908382">:=</span>&nbsp;<span class="builtintype" id="4908385">uint</span><span class="op" id="4908389">(</span><span class="num" id="4908390">0</span><span class="op" id="4908391">)</span><span class="op" id="4908392">;</span>&nbsp;<span class="ident" id="4908394">i</span>&nbsp;<span class="op" id="4908396">&lt;</span>&nbsp;<span class="num" id="4908398">4</span><span class="op" id="4908399">;</span>&nbsp;<span class="ident" id="4908401">i</span><span class="op" id="4908402">++</span>&nbsp;<span class="op" id="4908405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908409">var</span>&nbsp;<span class="ident" id="4908413">b</span>&nbsp;<span class="builtintype" id="4908415">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908422">if</span>&nbsp;<span class="ident" id="4908425">l</span>&nbsp;<span class="op" id="4908427">:=</span>&nbsp;<span class="builtinfunc" id="4908430">len</span><span class="op" id="4908433">(</span><span class="ident" id="4908434">buf</span><span class="op" id="4908437">)</span><span class="op" id="4908438">;</span>&nbsp;<span class="ident" id="4908440">l</span>&nbsp;<span class="op" id="4908442">&gt;</span>&nbsp;<span class="num" id="4908444">0</span>&nbsp;<span class="op" id="4908446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908451">b</span>&nbsp;<span class="op" id="4908453">=</span>&nbsp;<span class="ident" id="4908455">buf</span><span class="op" id="4908458">[</span><span class="ident" id="4908459">l</span><span class="op" id="4908460">-</span><span class="num" id="4908461">1</span><span class="op" id="4908462">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4908467">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4908537">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908562">if</span>&nbsp;<span class="ident" id="4908565">i</span>&nbsp;<span class="op" id="4908567">!=</span>&nbsp;<span class="num" id="4908570">3</span>&nbsp;<span class="op" id="4908572">||</span>&nbsp;<span class="ident" id="4908575">shift</span>&nbsp;<span class="op" id="4908581">==</span>&nbsp;<span class="num" id="4908584">4</span>&nbsp;<span class="op" id="4908586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908592">buf</span>&nbsp;<span class="op" id="4908596">=</span>&nbsp;<span class="ident" id="4908598">buf</span><span class="op" id="4908601">[</span><span class="op" id="4908602">:</span><span class="ident" id="4908603">l</span><span class="op" id="4908604">-</span><span class="num" id="4908605">1</span><span class="op" id="4908606">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4908611">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4908615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908619">ret</span>&nbsp;<span class="op" id="4908623">|=</span>&nbsp;<span class="builtintype" id="4908626">uint32</span><span class="op" id="4908632">(</span><span class="ident" id="4908633">b</span><span class="op" id="4908634">)</span>&nbsp;<span class="op" id="4908636">&lt;&lt;</span>&nbsp;<span class="op" id="4908639">(</span><span class="num" id="4908640">8</span>&nbsp;<span class="op" id="4908642">*</span>&nbsp;<span class="ident" id="4908644">i</span><span class="op" id="4908645">)</span>&nbsp;<span class="op" id="4908647">&gt;&gt;</span>&nbsp;<span class="ident" id="4908650">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4908657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908660">ret</span>&nbsp;<span class="op" id="4908664">&amp;=</span>&nbsp;<span class="ident" id="4908667">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908681">return</span>&nbsp;<span class="ident" id="4908688">ret</span><span class="op" id="4908691">,</span>&nbsp;<span class="ident" id="4908693">buf</span><br>
<span class="lineno">710</span><span class="op" id="4908697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4908700">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4908732">func</span>&nbsp;<span class="ident" id="4908737">p224FromBig</span><span class="op" id="4908748">(</span><span class="ident" id="4908749">out</span>&nbsp;<span class="op" id="4908753">*</span><span class="ident" id="4908754">p224FieldElement</span><span class="op" id="4908770">,</span>&nbsp;<span class="ident" id="4908772">in</span>&nbsp;<span class="op" id="4908775">*</span><span class="ident" id="4908776">big</span><span class="op" id="4908779">.</span><span class="ident" id="4908780">Int</span><span class="op" id="4908783">)</span>&nbsp;<span class="op" id="4908785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908788">bytes</span>&nbsp;<span class="op" id="4908794">:=</span>&nbsp;<span class="ident" id="4908797">in</span><span class="op" id="4908799">.</span><span class="ident" id="4908800">Bytes</span><span class="op" id="4908805">(</span><span class="op" id="4908806">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908809">out</span><span class="op" id="4908812">[</span><span class="num" id="4908813">0</span><span class="op" id="4908814">]</span><span class="op" id="4908815">,</span>&nbsp;<span class="ident" id="4908817">bytes</span>&nbsp;<span class="op" id="4908823">=</span>&nbsp;<span class="ident" id="4908825">get28BitsFromEnd</span><span class="op" id="4908841">(</span><span class="ident" id="4908842">bytes</span><span class="op" id="4908847">,</span>&nbsp;<span class="num" id="4908849">0</span><span class="op" id="4908850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908853">out</span><span class="op" id="4908856">[</span><span class="num" id="4908857">1</span><span class="op" id="4908858">]</span><span class="op" id="4908859">,</span>&nbsp;<span class="ident" id="4908861">bytes</span>&nbsp;<span class="op" id="4908867">=</span>&nbsp;<span class="ident" id="4908869">get28BitsFromEnd</span><span class="op" id="4908885">(</span><span class="ident" id="4908886">bytes</span><span class="op" id="4908891">,</span>&nbsp;<span class="num" id="4908893">4</span><span class="op" id="4908894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908897">out</span><span class="op" id="4908900">[</span><span class="num" id="4908901">2</span><span class="op" id="4908902">]</span><span class="op" id="4908903">,</span>&nbsp;<span class="ident" id="4908905">bytes</span>&nbsp;<span class="op" id="4908911">=</span>&nbsp;<span class="ident" id="4908913">get28BitsFromEnd</span><span class="op" id="4908929">(</span><span class="ident" id="4908930">bytes</span><span class="op" id="4908935">,</span>&nbsp;<span class="num" id="4908937">0</span><span class="op" id="4908938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908941">out</span><span class="op" id="4908944">[</span><span class="num" id="4908945">3</span><span class="op" id="4908946">]</span><span class="op" id="4908947">,</span>&nbsp;<span class="ident" id="4908949">bytes</span>&nbsp;<span class="op" id="4908955">=</span>&nbsp;<span class="ident" id="4908957">get28BitsFromEnd</span><span class="op" id="4908973">(</span><span class="ident" id="4908974">bytes</span><span class="op" id="4908979">,</span>&nbsp;<span class="num" id="4908981">4</span><span class="op" id="4908982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908985">out</span><span class="op" id="4908988">[</span><span class="num" id="4908989">4</span><span class="op" id="4908990">]</span><span class="op" id="4908991">,</span>&nbsp;<span class="ident" id="4908993">bytes</span>&nbsp;<span class="op" id="4908999">=</span>&nbsp;<span class="ident" id="4909001">get28BitsFromEnd</span><span class="op" id="4909017">(</span><span class="ident" id="4909018">bytes</span><span class="op" id="4909023">,</span>&nbsp;<span class="num" id="4909025">0</span><span class="op" id="4909026">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909029">out</span><span class="op" id="4909032">[</span><span class="num" id="4909033">5</span><span class="op" id="4909034">]</span><span class="op" id="4909035">,</span>&nbsp;<span class="ident" id="4909037">bytes</span>&nbsp;<span class="op" id="4909043">=</span>&nbsp;<span class="ident" id="4909045">get28BitsFromEnd</span><span class="op" id="4909061">(</span><span class="ident" id="4909062">bytes</span><span class="op" id="4909067">,</span>&nbsp;<span class="num" id="4909069">4</span><span class="op" id="4909070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909073">out</span><span class="op" id="4909076">[</span><span class="num" id="4909077">6</span><span class="op" id="4909078">]</span><span class="op" id="4909079">,</span>&nbsp;<span class="ident" id="4909081">bytes</span>&nbsp;<span class="op" id="4909087">=</span>&nbsp;<span class="ident" id="4909089">get28BitsFromEnd</span><span class="op" id="4909105">(</span><span class="ident" id="4909106">bytes</span><span class="op" id="4909111">,</span>&nbsp;<span class="num" id="4909113">0</span><span class="op" id="4909114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909117">out</span><span class="op" id="4909120">[</span><span class="num" id="4909121">7</span><span class="op" id="4909122">]</span><span class="op" id="4909123">,</span>&nbsp;<span class="ident" id="4909125">bytes</span>&nbsp;<span class="op" id="4909131">=</span>&nbsp;<span class="ident" id="4909133">get28BitsFromEnd</span><span class="op" id="4909149">(</span><span class="ident" id="4909150">bytes</span><span class="op" id="4909155">,</span>&nbsp;<span class="num" id="4909157">4</span><span class="op" id="4909158">)</span><br>
<span class="lineno"></span><span class="op" id="4909160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4909163">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4909201">func</span>&nbsp;<span class="ident" id="4909206">p224ToBig</span><span class="op" id="4909215">(</span><span class="ident" id="4909216">in</span>&nbsp;<span class="op" id="4909219">*</span><span class="ident" id="4909220">p224FieldElement</span><span class="op" id="4909236">)</span>&nbsp;<span class="op" id="4909238">*</span><span class="ident" id="4909239">big</span><span class="op" id="4909242">.</span><span class="ident" id="4909243">Int</span>&nbsp;<span class="op" id="4909247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909250">var</span>&nbsp;<span class="ident" id="4909254">buf</span>&nbsp;<span class="op" id="4909258">[</span><span class="num" id="4909259">28</span><span class="op" id="4909261">]</span><span class="builtintype" id="4909262">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909268">buf</span><span class="op" id="4909271">[</span><span class="num" id="4909272">27</span><span class="op" id="4909274">]</span>&nbsp;<span class="op" id="4909276">=</span>&nbsp;<span class="builtintype" id="4909278">byte</span><span class="op" id="4909282">(</span><span class="ident" id="4909283">in</span><span class="op" id="4909285">[</span><span class="num" id="4909286">0</span><span class="op" id="4909287">]</span><span class="op" id="4909288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909291">buf</span><span class="op" id="4909294">[</span><span class="num" id="4909295">26</span><span class="op" id="4909297">]</span>&nbsp;<span class="op" id="4909299">=</span>&nbsp;<span class="builtintype" id="4909301">byte</span><span class="op" id="4909305">(</span><span class="ident" id="4909306">in</span><span class="op" id="4909308">[</span><span class="num" id="4909309">0</span><span class="op" id="4909310">]</span>&nbsp;<span class="op" id="4909312">&gt;&gt;</span>&nbsp;<span class="num" id="4909315">8</span><span class="op" id="4909316">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909319">buf</span><span class="op" id="4909322">[</span><span class="num" id="4909323">25</span><span class="op" id="4909325">]</span>&nbsp;<span class="op" id="4909327">=</span>&nbsp;<span class="builtintype" id="4909329">byte</span><span class="op" id="4909333">(</span><span class="ident" id="4909334">in</span><span class="op" id="4909336">[</span><span class="num" id="4909337">0</span><span class="op" id="4909338">]</span>&nbsp;<span class="op" id="4909340">&gt;&gt;</span>&nbsp;<span class="num" id="4909343">16</span><span class="op" id="4909345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909348">buf</span><span class="op" id="4909351">[</span><span class="num" id="4909352">24</span><span class="op" id="4909354">]</span>&nbsp;<span class="op" id="4909356">=</span>&nbsp;<span class="builtintype" id="4909358">byte</span><span class="op" id="4909362">(</span><span class="op" id="4909363">(</span><span class="op" id="4909364">(</span><span class="ident" id="4909365">in</span><span class="op" id="4909367">[</span><span class="num" id="4909368">0</span><span class="op" id="4909369">]</span>&nbsp;<span class="op" id="4909371">&gt;&gt;</span>&nbsp;<span class="num" id="4909374">24</span><span class="op" id="4909376">)</span>&nbsp;<span class="op" id="4909378">&amp;</span>&nbsp;<span class="num" id="4909380">0x0f</span><span class="op" id="4909384">)</span>&nbsp;<span class="op" id="4909386">|</span>&nbsp;<span class="op" id="4909388">(</span><span class="ident" id="4909389">in</span><span class="op" id="4909391">[</span><span class="num" id="4909392">1</span><span class="op" id="4909393">]</span><span class="op" id="4909394">&lt;&lt;</span><span class="num" id="4909396">4</span><span class="op" id="4909397">)</span><span class="op" id="4909398">&amp;</span><span class="num" id="4909399">0xf0</span><span class="op" id="4909403">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909407">buf</span><span class="op" id="4909410">[</span><span class="num" id="4909411">23</span><span class="op" id="4909413">]</span>&nbsp;<span class="op" id="4909415">=</span>&nbsp;<span class="builtintype" id="4909417">byte</span><span class="op" id="4909421">(</span><span class="ident" id="4909422">in</span><span class="op" id="4909424">[</span><span class="num" id="4909425">1</span><span class="op" id="4909426">]</span>&nbsp;<span class="op" id="4909428">&gt;&gt;</span>&nbsp;<span class="num" id="4909431">4</span><span class="op" id="4909432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909435">buf</span><span class="op" id="4909438">[</span><span class="num" id="4909439">22</span><span class="op" id="4909441">]</span>&nbsp;<span class="op" id="4909443">=</span>&nbsp;<span class="builtintype" id="4909445">byte</span><span class="op" id="4909449">(</span><span class="ident" id="4909450">in</span><span class="op" id="4909452">[</span><span class="num" id="4909453">1</span><span class="op" id="4909454">]</span>&nbsp;<span class="op" id="4909456">&gt;&gt;</span>&nbsp;<span class="num" id="4909459">12</span><span class="op" id="4909461">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909464">buf</span><span class="op" id="4909467">[</span><span class="num" id="4909468">21</span><span class="op" id="4909470">]</span>&nbsp;<span class="op" id="4909472">=</span>&nbsp;<span class="builtintype" id="4909474">byte</span><span class="op" id="4909478">(</span><span class="ident" id="4909479">in</span><span class="op" id="4909481">[</span><span class="num" id="4909482">1</span><span class="op" id="4909483">]</span>&nbsp;<span class="op" id="4909485">&gt;&gt;</span>&nbsp;<span class="num" id="4909488">20</span><span class="op" id="4909490">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909494">buf</span><span class="op" id="4909497">[</span><span class="num" id="4909498">20</span><span class="op" id="4909500">]</span>&nbsp;<span class="op" id="4909502">=</span>&nbsp;<span class="builtintype" id="4909504">byte</span><span class="op" id="4909508">(</span><span class="ident" id="4909509">in</span><span class="op" id="4909511">[</span><span class="num" id="4909512">2</span><span class="op" id="4909513">]</span><span class="op" id="4909514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909517">buf</span><span class="op" id="4909520">[</span><span class="num" id="4909521">19</span><span class="op" id="4909523">]</span>&nbsp;<span class="op" id="4909525">=</span>&nbsp;<span class="builtintype" id="4909527">byte</span><span class="op" id="4909531">(</span><span class="ident" id="4909532">in</span><span class="op" id="4909534">[</span><span class="num" id="4909535">2</span><span class="op" id="4909536">]</span>&nbsp;<span class="op" id="4909538">&gt;&gt;</span>&nbsp;<span class="num" id="4909541">8</span><span class="op" id="4909542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909545">buf</span><span class="op" id="4909548">[</span><span class="num" id="4909549">18</span><span class="op" id="4909551">]</span>&nbsp;<span class="op" id="4909553">=</span>&nbsp;<span class="builtintype" id="4909555">byte</span><span class="op" id="4909559">(</span><span class="ident" id="4909560">in</span><span class="op" id="4909562">[</span><span class="num" id="4909563">2</span><span class="op" id="4909564">]</span>&nbsp;<span class="op" id="4909566">&gt;&gt;</span>&nbsp;<span class="num" id="4909569">16</span><span class="op" id="4909571">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909574">buf</span><span class="op" id="4909577">[</span><span class="num" id="4909578">17</span><span class="op" id="4909580">]</span>&nbsp;<span class="op" id="4909582">=</span>&nbsp;<span class="builtintype" id="4909584">byte</span><span class="op" id="4909588">(</span><span class="op" id="4909589">(</span><span class="op" id="4909590">(</span><span class="ident" id="4909591">in</span><span class="op" id="4909593">[</span><span class="num" id="4909594">2</span><span class="op" id="4909595">]</span>&nbsp;<span class="op" id="4909597">&gt;&gt;</span>&nbsp;<span class="num" id="4909600">24</span><span class="op" id="4909602">)</span>&nbsp;<span class="op" id="4909604">&amp;</span>&nbsp;<span class="num" id="4909606">0x0f</span><span class="op" id="4909610">)</span>&nbsp;<span class="op" id="4909612">|</span>&nbsp;<span class="op" id="4909614">(</span><span class="ident" id="4909615">in</span><span class="op" id="4909617">[</span><span class="num" id="4909618">3</span><span class="op" id="4909619">]</span><span class="op" id="4909620">&lt;&lt;</span><span class="num" id="4909622">4</span><span class="op" id="4909623">)</span><span class="op" id="4909624">&amp;</span><span class="num" id="4909625">0xf0</span><span class="op" id="4909629">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909633">buf</span><span class="op" id="4909636">[</span><span class="num" id="4909637">16</span><span class="op" id="4909639">]</span>&nbsp;<span class="op" id="4909641">=</span>&nbsp;<span class="builtintype" id="4909643">byte</span><span class="op" id="4909647">(</span><span class="ident" id="4909648">in</span><span class="op" id="4909650">[</span><span class="num" id="4909651">3</span><span class="op" id="4909652">]</span>&nbsp;<span class="op" id="4909654">&gt;&gt;</span>&nbsp;<span class="num" id="4909657">4</span><span class="op" id="4909658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909661">buf</span><span class="op" id="4909664">[</span><span class="num" id="4909665">15</span><span class="op" id="4909667">]</span>&nbsp;<span class="op" id="4909669">=</span>&nbsp;<span class="builtintype" id="4909671">byte</span><span class="op" id="4909675">(</span><span class="ident" id="4909676">in</span><span class="op" id="4909678">[</span><span class="num" id="4909679">3</span><span class="op" id="4909680">]</span>&nbsp;<span class="op" id="4909682">&gt;&gt;</span>&nbsp;<span class="num" id="4909685">12</span><span class="op" id="4909687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909690">buf</span><span class="op" id="4909693">[</span><span class="num" id="4909694">14</span><span class="op" id="4909696">]</span>&nbsp;<span class="op" id="4909698">=</span>&nbsp;<span class="builtintype" id="4909700">byte</span><span class="op" id="4909704">(</span><span class="ident" id="4909705">in</span><span class="op" id="4909707">[</span><span class="num" id="4909708">3</span><span class="op" id="4909709">]</span>&nbsp;<span class="op" id="4909711">&gt;&gt;</span>&nbsp;<span class="num" id="4909714">20</span><span class="op" id="4909716">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909720">buf</span><span class="op" id="4909723">[</span><span class="num" id="4909724">13</span><span class="op" id="4909726">]</span>&nbsp;<span class="op" id="4909728">=</span>&nbsp;<span class="builtintype" id="4909730">byte</span><span class="op" id="4909734">(</span><span class="ident" id="4909735">in</span><span class="op" id="4909737">[</span><span class="num" id="4909738">4</span><span class="op" id="4909739">]</span><span class="op" id="4909740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909743">buf</span><span class="op" id="4909746">[</span><span class="num" id="4909747">12</span><span class="op" id="4909749">]</span>&nbsp;<span class="op" id="4909751">=</span>&nbsp;<span class="builtintype" id="4909753">byte</span><span class="op" id="4909757">(</span><span class="ident" id="4909758">in</span><span class="op" id="4909760">[</span><span class="num" id="4909761">4</span><span class="op" id="4909762">]</span>&nbsp;<span class="op" id="4909764">&gt;&gt;</span>&nbsp;<span class="num" id="4909767">8</span><span class="op" id="4909768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909771">buf</span><span class="op" id="4909774">[</span><span class="num" id="4909775">11</span><span class="op" id="4909777">]</span>&nbsp;<span class="op" id="4909779">=</span>&nbsp;<span class="builtintype" id="4909781">byte</span><span class="op" id="4909785">(</span><span class="ident" id="4909786">in</span><span class="op" id="4909788">[</span><span class="num" id="4909789">4</span><span class="op" id="4909790">]</span>&nbsp;<span class="op" id="4909792">&gt;&gt;</span>&nbsp;<span class="num" id="4909795">16</span><span class="op" id="4909797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909800">buf</span><span class="op" id="4909803">[</span><span class="num" id="4909804">10</span><span class="op" id="4909806">]</span>&nbsp;<span class="op" id="4909808">=</span>&nbsp;<span class="builtintype" id="4909810">byte</span><span class="op" id="4909814">(</span><span class="op" id="4909815">(</span><span class="op" id="4909816">(</span><span class="ident" id="4909817">in</span><span class="op" id="4909819">[</span><span class="num" id="4909820">4</span><span class="op" id="4909821">]</span>&nbsp;<span class="op" id="4909823">&gt;&gt;</span>&nbsp;<span class="num" id="4909826">24</span><span class="op" id="4909828">)</span>&nbsp;<span class="op" id="4909830">&amp;</span>&nbsp;<span class="num" id="4909832">0x0f</span><span class="op" id="4909836">)</span>&nbsp;<span class="op" id="4909838">|</span>&nbsp;<span class="op" id="4909840">(</span><span class="ident" id="4909841">in</span><span class="op" id="4909843">[</span><span class="num" id="4909844">5</span><span class="op" id="4909845">]</span><span class="op" id="4909846">&lt;&lt;</span><span class="num" id="4909848">4</span><span class="op" id="4909849">)</span><span class="op" id="4909850">&amp;</span><span class="num" id="4909851">0xf0</span><span class="op" id="4909855">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909859">buf</span><span class="op" id="4909862">[</span><span class="num" id="4909863">9</span><span class="op" id="4909864">]</span>&nbsp;<span class="op" id="4909866">=</span>&nbsp;<span class="builtintype" id="4909868">byte</span><span class="op" id="4909872">(</span><span class="ident" id="4909873">in</span><span class="op" id="4909875">[</span><span class="num" id="4909876">5</span><span class="op" id="4909877">]</span>&nbsp;<span class="op" id="4909879">&gt;&gt;</span>&nbsp;<span class="num" id="4909882">4</span><span class="op" id="4909883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909886">buf</span><span class="op" id="4909889">[</span><span class="num" id="4909890">8</span><span class="op" id="4909891">]</span>&nbsp;<span class="op" id="4909893">=</span>&nbsp;<span class="builtintype" id="4909895">byte</span><span class="op" id="4909899">(</span><span class="ident" id="4909900">in</span><span class="op" id="4909902">[</span><span class="num" id="4909903">5</span><span class="op" id="4909904">]</span>&nbsp;<span class="op" id="4909906">&gt;&gt;</span>&nbsp;<span class="num" id="4909909">12</span><span class="op" id="4909911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909914">buf</span><span class="op" id="4909917">[</span><span class="num" id="4909918">7</span><span class="op" id="4909919">]</span>&nbsp;<span class="op" id="4909921">=</span>&nbsp;<span class="builtintype" id="4909923">byte</span><span class="op" id="4909927">(</span><span class="ident" id="4909928">in</span><span class="op" id="4909930">[</span><span class="num" id="4909931">5</span><span class="op" id="4909932">]</span>&nbsp;<span class="op" id="4909934">&gt;&gt;</span>&nbsp;<span class="num" id="4909937">20</span><span class="op" id="4909939">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909943">buf</span><span class="op" id="4909946">[</span><span class="num" id="4909947">6</span><span class="op" id="4909948">]</span>&nbsp;<span class="op" id="4909950">=</span>&nbsp;<span class="builtintype" id="4909952">byte</span><span class="op" id="4909956">(</span><span class="ident" id="4909957">in</span><span class="op" id="4909959">[</span><span class="num" id="4909960">6</span><span class="op" id="4909961">]</span><span class="op" id="4909962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909965">buf</span><span class="op" id="4909968">[</span><span class="num" id="4909969">5</span><span class="op" id="4909970">]</span>&nbsp;<span class="op" id="4909972">=</span>&nbsp;<span class="builtintype" id="4909974">byte</span><span class="op" id="4909978">(</span><span class="ident" id="4909979">in</span><span class="op" id="4909981">[</span><span class="num" id="4909982">6</span><span class="op" id="4909983">]</span>&nbsp;<span class="op" id="4909985">&gt;&gt;</span>&nbsp;<span class="num" id="4909988">8</span><span class="op" id="4909989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909992">buf</span><span class="op" id="4909995">[</span><span class="num" id="4909996">4</span><span class="op" id="4909997">]</span>&nbsp;<span class="op" id="4909999">=</span>&nbsp;<span class="builtintype" id="4910001">byte</span><span class="op" id="4910005">(</span><span class="ident" id="4910006">in</span><span class="op" id="4910008">[</span><span class="num" id="4910009">6</span><span class="op" id="4910010">]</span>&nbsp;<span class="op" id="4910012">&gt;&gt;</span>&nbsp;<span class="num" id="4910015">16</span><span class="op" id="4910017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910020">buf</span><span class="op" id="4910023">[</span><span class="num" id="4910024">3</span><span class="op" id="4910025">]</span>&nbsp;<span class="op" id="4910027">=</span>&nbsp;<span class="builtintype" id="4910029">byte</span><span class="op" id="4910033">(</span><span class="op" id="4910034">(</span><span class="op" id="4910035">(</span><span class="ident" id="4910036">in</span><span class="op" id="4910038">[</span><span class="num" id="4910039">6</span><span class="op" id="4910040">]</span>&nbsp;<span class="op" id="4910042">&gt;&gt;</span>&nbsp;<span class="num" id="4910045">24</span><span class="op" id="4910047">)</span>&nbsp;<span class="op" id="4910049">&amp;</span>&nbsp;<span class="num" id="4910051">0x0f</span><span class="op" id="4910055">)</span>&nbsp;<span class="op" id="4910057">|</span>&nbsp;<span class="op" id="4910059">(</span><span class="ident" id="4910060">in</span><span class="op" id="4910062">[</span><span class="num" id="4910063">7</span><span class="op" id="4910064">]</span><span class="op" id="4910065">&lt;&lt;</span><span class="num" id="4910067">4</span><span class="op" id="4910068">)</span><span class="op" id="4910069">&amp;</span><span class="num" id="4910070">0xf0</span><span class="op" id="4910074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910078">buf</span><span class="op" id="4910081">[</span><span class="num" id="4910082">2</span><span class="op" id="4910083">]</span>&nbsp;<span class="op" id="4910085">=</span>&nbsp;<span class="builtintype" id="4910087">byte</span><span class="op" id="4910091">(</span><span class="ident" id="4910092">in</span><span class="op" id="4910094">[</span><span class="num" id="4910095">7</span><span class="op" id="4910096">]</span>&nbsp;<span class="op" id="4910098">&gt;&gt;</span>&nbsp;<span class="num" id="4910101">4</span><span class="op" id="4910102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910105">buf</span><span class="op" id="4910108">[</span><span class="num" id="4910109">1</span><span class="op" id="4910110">]</span>&nbsp;<span class="op" id="4910112">=</span>&nbsp;<span class="builtintype" id="4910114">byte</span><span class="op" id="4910118">(</span><span class="ident" id="4910119">in</span><span class="op" id="4910121">[</span><span class="num" id="4910122">7</span><span class="op" id="4910123">]</span>&nbsp;<span class="op" id="4910125">&gt;&gt;</span>&nbsp;<span class="num" id="4910128">12</span><span class="op" id="4910130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910133">buf</span><span class="op" id="4910136">[</span><span class="num" id="4910137">0</span><span class="op" id="4910138">]</span>&nbsp;<span class="op" id="4910140">=</span>&nbsp;<span class="builtintype" id="4910142">byte</span><span class="op" id="4910146">(</span><span class="ident" id="4910147">in</span><span class="op" id="4910149">[</span><span class="num" id="4910150">7</span><span class="op" id="4910151">]</span>&nbsp;<span class="op" id="4910153">&gt;&gt;</span>&nbsp;<span class="num" id="4910156">20</span><span class="op" id="4910158">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910162">return</span>&nbsp;<span class="builtinfunc" id="4910169">new</span><span class="op" id="4910172">(</span><span class="ident" id="4910173">big</span><span class="op" id="4910176">.</span><span class="ident" id="4910177">Int</span><span class="op" id="4910180">)</span><span class="op" id="4910181">.</span><span class="ident" id="4910182">SetBytes</span><span class="op" id="4910190">(</span><span class="ident" id="4910191">buf</span><span class="op" id="4910194">[</span><span class="op" id="4910195">:</span><span class="op" id="4910196">]</span><span class="op" id="4910197">)</span><br>
<span class="lineno">765</span><span class="op" id="4910199">}</span>
</div>
</body>
</html>
