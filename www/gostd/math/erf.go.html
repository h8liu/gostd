<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html" class="current">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2111631">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2111686">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2111740">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2111791">package</span>&nbsp;<span class="ident" id="2111799">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2111805">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2111877">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2111931">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2111983">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2112038">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2112068">//</span><br>
<span class="lineno"></span><span class="comment" id="2112071">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2112127">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2112196">//</span><br>
<span class="lineno"></span><span class="comment" id="2112199">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2112258">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2112314">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2112371">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2112388">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2112444">//</span><br>
<span class="lineno">25</span><span class="comment" id="2112447">//</span><br>
<span class="lineno"></span><span class="comment" id="2112450">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2112474">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2112499">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2112530">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="2112562">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="2112605">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="2112636">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2112667">//</span><br>
<span class="lineno"></span><span class="comment" id="2112670">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="2112697">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2112711">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="2112745">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2112784">//</span><br>
<span class="lineno"></span><span class="comment" id="2112787">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="2112798">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2112833">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2112869">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="2112935">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2113001">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="2113065">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="2113107">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="2113163">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2113213">//</span><br>
<span class="lineno"></span><span class="comment" id="2113216">//</span><br>
<span class="lineno">50</span><span class="comment" id="2113219">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="2113271">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="2113345">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2113365">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="2113432">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="2113499">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2113567">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2113637">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="2113698">//</span><br>
<span class="lineno"></span><span class="comment" id="2113701">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="2113760">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="2113817">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="2113872">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2113928">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2113984">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="2114036">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="2114103">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="2114149">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="2114198">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2114263">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="2114326">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="2114386">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2114403">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2114446">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2114489">//</span><br>
<span class="lineno">75</span><span class="comment" id="2114492">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="2114538">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="2114593">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2114631">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2114648">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="2114703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2114746">//</span><br>
<span class="lineno"></span><span class="comment" id="2114749">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="2114781">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2114845">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="2114916">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="2114977">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2115042">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="2115089">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2115106">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="2115161">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2115204">//</span><br>
<span class="lineno"></span><span class="comment" id="2115207">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="2115222">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="2115284">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="2115329">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="2115371">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="2115410">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="2115473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="2115488">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="2115546">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="2115582">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2115642">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="2115679">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2115735">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="2115798">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="2115853">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="2115899">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="2115945">//</span><br>
<span class="lineno"></span><span class="comment" id="2115948">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="2115977">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="2116040">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2116103">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2116145">//</span><br>
<span class="lineno"></span><span class="comment" id="2116148">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="2116173">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="2116233">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="2116293">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2116331">const</span>&nbsp;<span class="op" id="2116337">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116340">erx</span>&nbsp;<span class="op" id="2116344">=</span>&nbsp;<span class="num" id="2116346">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="2116373">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2116396">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116455">efx</span>&nbsp;&nbsp;<span class="op" id="2116460">=</span>&nbsp;<span class="num" id="2116462">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="2116490">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116513">efx8</span>&nbsp;<span class="op" id="2116518">=</span>&nbsp;<span class="num" id="2116520">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="2116548">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116571">pp0</span>&nbsp;&nbsp;<span class="op" id="2116576">=</span>&nbsp;<span class="num" id="2116578">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="2116606">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116629">pp1</span>&nbsp;&nbsp;<span class="op" id="2116634">=</span>&nbsp;<span class="op" id="2116636">-</span><span class="num" id="2116637">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="2116664">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116687">pp2</span>&nbsp;&nbsp;<span class="op" id="2116692">=</span>&nbsp;<span class="op" id="2116694">-</span><span class="num" id="2116695">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="2116722">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116745">pp3</span>&nbsp;&nbsp;<span class="op" id="2116750">=</span>&nbsp;<span class="op" id="2116752">-</span><span class="num" id="2116753">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="2116780">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116803">pp4</span>&nbsp;&nbsp;<span class="op" id="2116808">=</span>&nbsp;<span class="op" id="2116810">-</span><span class="num" id="2116811">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="2116838">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116861">qq1</span>&nbsp;&nbsp;<span class="op" id="2116866">=</span>&nbsp;<span class="num" id="2116868">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="2116896">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116919">qq2</span>&nbsp;&nbsp;<span class="op" id="2116924">=</span>&nbsp;<span class="num" id="2116926">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="2116954">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2116977">qq3</span>&nbsp;&nbsp;<span class="op" id="2116982">=</span>&nbsp;<span class="num" id="2116984">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="2117012">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117035">qq4</span>&nbsp;&nbsp;<span class="op" id="2117040">=</span>&nbsp;<span class="num" id="2117042">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="2117070">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117093">qq5</span>&nbsp;&nbsp;<span class="op" id="2117098">=</span>&nbsp;<span class="op" id="2117100">-</span><span class="num" id="2117101">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="2117128">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2117151">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117214">pa0</span>&nbsp;<span class="op" id="2117218">=</span>&nbsp;<span class="op" id="2117220">-</span><span class="num" id="2117221">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="2117248">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117271">pa1</span>&nbsp;<span class="op" id="2117275">=</span>&nbsp;<span class="num" id="2117277">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="2117305">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117328">pa2</span>&nbsp;<span class="op" id="2117332">=</span>&nbsp;<span class="op" id="2117334">-</span><span class="num" id="2117335">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="2117362">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117385">pa3</span>&nbsp;<span class="op" id="2117389">=</span>&nbsp;<span class="num" id="2117391">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="2117419">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117442">pa4</span>&nbsp;<span class="op" id="2117446">=</span>&nbsp;<span class="op" id="2117448">-</span><span class="num" id="2117449">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="2117476">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117499">pa5</span>&nbsp;<span class="op" id="2117503">=</span>&nbsp;<span class="num" id="2117505">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="2117533">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117556">pa6</span>&nbsp;<span class="op" id="2117560">=</span>&nbsp;<span class="op" id="2117562">-</span><span class="num" id="2117563">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="2117590">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117613">qa1</span>&nbsp;<span class="op" id="2117617">=</span>&nbsp;<span class="num" id="2117619">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="2117647">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117670">qa2</span>&nbsp;<span class="op" id="2117674">=</span>&nbsp;<span class="num" id="2117676">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="2117704">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117727">qa3</span>&nbsp;<span class="op" id="2117731">=</span>&nbsp;<span class="num" id="2117733">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="2117761">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117784">qa4</span>&nbsp;<span class="op" id="2117788">=</span>&nbsp;<span class="num" id="2117790">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="2117818">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117841">qa5</span>&nbsp;<span class="op" id="2117845">=</span>&nbsp;<span class="num" id="2117847">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="2117875">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2117898">qa6</span>&nbsp;<span class="op" id="2117902">=</span>&nbsp;<span class="num" id="2117904">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="2117932">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2117955">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118017">ra0</span>&nbsp;<span class="op" id="2118021">=</span>&nbsp;<span class="op" id="2118023">-</span><span class="num" id="2118024">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="2118051">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118074">ra1</span>&nbsp;<span class="op" id="2118078">=</span>&nbsp;<span class="op" id="2118080">-</span><span class="num" id="2118081">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="2118108">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118131">ra2</span>&nbsp;<span class="op" id="2118135">=</span>&nbsp;<span class="op" id="2118137">-</span><span class="num" id="2118138">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="2118165">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118188">ra3</span>&nbsp;<span class="op" id="2118192">=</span>&nbsp;<span class="op" id="2118194">-</span><span class="num" id="2118195">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="2118222">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118245">ra4</span>&nbsp;<span class="op" id="2118249">=</span>&nbsp;<span class="op" id="2118251">-</span><span class="num" id="2118252">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="2118279">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118302">ra5</span>&nbsp;<span class="op" id="2118306">=</span>&nbsp;<span class="op" id="2118308">-</span><span class="num" id="2118309">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="2118336">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118359">ra6</span>&nbsp;<span class="op" id="2118363">=</span>&nbsp;<span class="op" id="2118365">-</span><span class="num" id="2118366">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="2118393">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118416">ra7</span>&nbsp;<span class="op" id="2118420">=</span>&nbsp;<span class="op" id="2118422">-</span><span class="num" id="2118423">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="2118450">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118473">sa1</span>&nbsp;<span class="op" id="2118477">=</span>&nbsp;<span class="num" id="2118479">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="2118507">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118530">sa2</span>&nbsp;<span class="op" id="2118534">=</span>&nbsp;<span class="num" id="2118536">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="2118564">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118587">sa3</span>&nbsp;<span class="op" id="2118591">=</span>&nbsp;<span class="num" id="2118593">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="2118621">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118644">sa4</span>&nbsp;<span class="op" id="2118648">=</span>&nbsp;<span class="num" id="2118650">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="2118678">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118701">sa5</span>&nbsp;<span class="op" id="2118705">=</span>&nbsp;<span class="num" id="2118707">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="2118735">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118758">sa6</span>&nbsp;<span class="op" id="2118762">=</span>&nbsp;<span class="num" id="2118764">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="2118792">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118815">sa7</span>&nbsp;<span class="op" id="2118819">=</span>&nbsp;<span class="num" id="2118821">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="2118849">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118872">sa8</span>&nbsp;<span class="op" id="2118876">=</span>&nbsp;<span class="op" id="2118878">-</span><span class="num" id="2118879">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="2118906">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2118929">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2118988">rb0</span>&nbsp;<span class="op" id="2118992">=</span>&nbsp;<span class="op" id="2118994">-</span><span class="num" id="2118995">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="2119022">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119045">rb1</span>&nbsp;<span class="op" id="2119049">=</span>&nbsp;<span class="op" id="2119051">-</span><span class="num" id="2119052">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="2119079">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119102">rb2</span>&nbsp;<span class="op" id="2119106">=</span>&nbsp;<span class="op" id="2119108">-</span><span class="num" id="2119109">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="2119136">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119159">rb3</span>&nbsp;<span class="op" id="2119163">=</span>&nbsp;<span class="op" id="2119165">-</span><span class="num" id="2119166">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="2119193">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119216">rb4</span>&nbsp;<span class="op" id="2119220">=</span>&nbsp;<span class="op" id="2119222">-</span><span class="num" id="2119223">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="2119250">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119273">rb5</span>&nbsp;<span class="op" id="2119277">=</span>&nbsp;<span class="op" id="2119279">-</span><span class="num" id="2119280">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="2119307">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119330">rb6</span>&nbsp;<span class="op" id="2119334">=</span>&nbsp;<span class="op" id="2119336">-</span><span class="num" id="2119337">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="2119364">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119387">sb1</span>&nbsp;<span class="op" id="2119391">=</span>&nbsp;<span class="num" id="2119393">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="2119421">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119444">sb2</span>&nbsp;<span class="op" id="2119448">=</span>&nbsp;<span class="num" id="2119450">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="2119478">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119501">sb3</span>&nbsp;<span class="op" id="2119505">=</span>&nbsp;<span class="num" id="2119507">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="2119535">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119558">sb4</span>&nbsp;<span class="op" id="2119562">=</span>&nbsp;<span class="num" id="2119564">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="2119592">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119615">sb5</span>&nbsp;<span class="op" id="2119619">=</span>&nbsp;<span class="num" id="2119621">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="2119649">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119672">sb6</span>&nbsp;<span class="op" id="2119676">=</span>&nbsp;<span class="num" id="2119678">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="2119706">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119729">sb7</span>&nbsp;<span class="op" id="2119733">=</span>&nbsp;<span class="op" id="2119735">-</span><span class="num" id="2119736">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="2119763">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="2119785">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2119788">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2119828">//</span><br>
<span class="lineno"></span><span class="comment" id="2119831">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="2119853">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2119870">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="2119888">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2119906">func</span>&nbsp;<span class="ident" id="2119911">Erf</span><span class="op" id="2119914">(</span><span class="ident" id="2119915">x</span>&nbsp;<span class="builtintype" id="2119917">float64</span><span class="op" id="2119924">)</span>&nbsp;<span class="builtintype" id="2119926">float64</span>&nbsp;<span class="op" id="2119934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2119937">const</span>&nbsp;<span class="op" id="2119943">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2119947">VeryTiny</span>&nbsp;<span class="op" id="2119956">=</span>&nbsp;<span class="num" id="2119958">2.848094538889218e-306</span>&nbsp;<span class="comment" id="2119981">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120005">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120014">=</span>&nbsp;<span class="num" id="2120016">1.0</span>&nbsp;<span class="op" id="2120020">/</span>&nbsp;<span class="op" id="2120022">(</span><span class="num" id="2120023">1</span>&nbsp;<span class="op" id="2120025">&lt;&lt;</span>&nbsp;<span class="num" id="2120028">28</span><span class="op" id="2120030">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2120039">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2120053">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120071">switch</span>&nbsp;<span class="op" id="2120078">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120081">case</span>&nbsp;<span class="ident" id="2120086">IsNaN</span><span class="op" id="2120091">(</span><span class="ident" id="2120092">x</span><span class="op" id="2120093">)</span><span class="op" id="2120094">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120098">return</span>&nbsp;<span class="ident" id="2120105">NaN</span><span class="op" id="2120108">(</span><span class="op" id="2120109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120112">case</span>&nbsp;<span class="ident" id="2120117">IsInf</span><span class="op" id="2120122">(</span><span class="ident" id="2120123">x</span><span class="op" id="2120124">,</span>&nbsp;<span class="num" id="2120126">1</span><span class="op" id="2120127">)</span><span class="op" id="2120128">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120132">return</span>&nbsp;<span class="num" id="2120139">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120142">case</span>&nbsp;<span class="ident" id="2120147">IsInf</span><span class="op" id="2120152">(</span><span class="ident" id="2120153">x</span><span class="op" id="2120154">,</span>&nbsp;<span class="op" id="2120156">-</span><span class="num" id="2120157">1</span><span class="op" id="2120158">)</span><span class="op" id="2120159">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120163">return</span>&nbsp;<span class="op" id="2120170">-</span><span class="num" id="2120171">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120177">sign</span>&nbsp;<span class="op" id="2120182">:=</span>&nbsp;<span class="builtintype" id="2120185">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120192">if</span>&nbsp;<span class="ident" id="2120195">x</span>&nbsp;<span class="op" id="2120197">&lt;</span>&nbsp;<span class="num" id="2120199">0</span>&nbsp;<span class="op" id="2120201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120205">x</span>&nbsp;<span class="op" id="2120207">=</span>&nbsp;<span class="op" id="2120209">-</span><span class="ident" id="2120210">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120214">sign</span>&nbsp;<span class="op" id="2120219">=</span>&nbsp;<span class="builtintype" id="2120221">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120230">if</span>&nbsp;<span class="ident" id="2120233">x</span>&nbsp;<span class="op" id="2120235">&lt;</span>&nbsp;<span class="num" id="2120237">0.84375</span>&nbsp;<span class="op" id="2120245">{</span>&nbsp;<span class="comment" id="2120247">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120266">var</span>&nbsp;<span class="ident" id="2120270">temp</span>&nbsp;<span class="builtintype" id="2120275">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120285">if</span>&nbsp;<span class="ident" id="2120288">x</span>&nbsp;<span class="op" id="2120290">&lt;</span>&nbsp;<span class="ident" id="2120292">Small</span>&nbsp;<span class="op" id="2120298">{</span>&nbsp;<span class="comment" id="2120300">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120319">if</span>&nbsp;<span class="ident" id="2120322">x</span>&nbsp;<span class="op" id="2120324">&lt;</span>&nbsp;<span class="ident" id="2120326">VeryTiny</span>&nbsp;<span class="op" id="2120335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120341">temp</span>&nbsp;<span class="op" id="2120346">=</span>&nbsp;<span class="num" id="2120348">0.125</span>&nbsp;<span class="op" id="2120354">*</span>&nbsp;<span class="op" id="2120356">(</span><span class="num" id="2120357">8.0</span><span class="op" id="2120360">*</span><span class="ident" id="2120361">x</span>&nbsp;<span class="op" id="2120363">+</span>&nbsp;<span class="ident" id="2120365">efx8</span><span class="op" id="2120369">*</span><span class="ident" id="2120370">x</span><span class="op" id="2120371">)</span>&nbsp;<span class="comment" id="2120373">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120395">}</span>&nbsp;<span class="keyword" id="2120397">else</span>&nbsp;<span class="op" id="2120402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120408">temp</span>&nbsp;<span class="op" id="2120413">=</span>&nbsp;<span class="ident" id="2120415">x</span>&nbsp;<span class="op" id="2120417">+</span>&nbsp;<span class="ident" id="2120419">efx</span><span class="op" id="2120422">*</span><span class="ident" id="2120423">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120428">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120432">}</span>&nbsp;<span class="keyword" id="2120434">else</span>&nbsp;<span class="op" id="2120439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120444">z</span>&nbsp;<span class="op" id="2120446">:=</span>&nbsp;<span class="ident" id="2120449">x</span>&nbsp;<span class="op" id="2120451">*</span>&nbsp;<span class="ident" id="2120453">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120458">r</span>&nbsp;<span class="op" id="2120460">:=</span>&nbsp;<span class="ident" id="2120463">pp0</span>&nbsp;<span class="op" id="2120467">+</span>&nbsp;<span class="ident" id="2120469">z</span><span class="op" id="2120470">*</span><span class="op" id="2120471">(</span><span class="ident" id="2120472">pp1</span><span class="op" id="2120475">+</span><span class="ident" id="2120476">z</span><span class="op" id="2120477">*</span><span class="op" id="2120478">(</span><span class="ident" id="2120479">pp2</span><span class="op" id="2120482">+</span><span class="ident" id="2120483">z</span><span class="op" id="2120484">*</span><span class="op" id="2120485">(</span><span class="ident" id="2120486">pp3</span><span class="op" id="2120489">+</span><span class="ident" id="2120490">z</span><span class="op" id="2120491">*</span><span class="ident" id="2120492">pp4</span><span class="op" id="2120495">)</span><span class="op" id="2120496">)</span><span class="op" id="2120497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120502">s</span>&nbsp;<span class="op" id="2120504">:=</span>&nbsp;<span class="num" id="2120507">1</span>&nbsp;<span class="op" id="2120509">+</span>&nbsp;<span class="ident" id="2120511">z</span><span class="op" id="2120512">*</span><span class="op" id="2120513">(</span><span class="ident" id="2120514">qq1</span><span class="op" id="2120517">+</span><span class="ident" id="2120518">z</span><span class="op" id="2120519">*</span><span class="op" id="2120520">(</span><span class="ident" id="2120521">qq2</span><span class="op" id="2120524">+</span><span class="ident" id="2120525">z</span><span class="op" id="2120526">*</span><span class="op" id="2120527">(</span><span class="ident" id="2120528">qq3</span><span class="op" id="2120531">+</span><span class="ident" id="2120532">z</span><span class="op" id="2120533">*</span><span class="op" id="2120534">(</span><span class="ident" id="2120535">qq4</span><span class="op" id="2120538">+</span><span class="ident" id="2120539">z</span><span class="op" id="2120540">*</span><span class="ident" id="2120541">qq5</span><span class="op" id="2120544">)</span><span class="op" id="2120545">)</span><span class="op" id="2120546">)</span><span class="op" id="2120547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120552">y</span>&nbsp;<span class="op" id="2120554">:=</span>&nbsp;<span class="ident" id="2120557">r</span>&nbsp;<span class="op" id="2120559">/</span>&nbsp;<span class="ident" id="2120561">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120566">temp</span>&nbsp;<span class="op" id="2120571">=</span>&nbsp;<span class="ident" id="2120573">x</span>&nbsp;<span class="op" id="2120575">+</span>&nbsp;<span class="ident" id="2120577">x</span><span class="op" id="2120578">*</span><span class="ident" id="2120579">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120587">if</span>&nbsp;<span class="ident" id="2120590">sign</span>&nbsp;<span class="op" id="2120595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120600">return</span>&nbsp;<span class="op" id="2120607">-</span><span class="ident" id="2120608">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120615">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120619">return</span>&nbsp;<span class="ident" id="2120626">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120635">if</span>&nbsp;<span class="ident" id="2120638">x</span>&nbsp;<span class="op" id="2120640">&lt;</span>&nbsp;<span class="num" id="2120642">1.25</span>&nbsp;<span class="op" id="2120647">{</span>&nbsp;<span class="comment" id="2120649">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120676">s</span>&nbsp;<span class="op" id="2120678">:=</span>&nbsp;<span class="ident" id="2120681">x</span>&nbsp;<span class="op" id="2120683">-</span>&nbsp;<span class="num" id="2120685">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120689">P</span>&nbsp;<span class="op" id="2120691">:=</span>&nbsp;<span class="ident" id="2120694">pa0</span>&nbsp;<span class="op" id="2120698">+</span>&nbsp;<span class="ident" id="2120700">s</span><span class="op" id="2120701">*</span><span class="op" id="2120702">(</span><span class="ident" id="2120703">pa1</span><span class="op" id="2120706">+</span><span class="ident" id="2120707">s</span><span class="op" id="2120708">*</span><span class="op" id="2120709">(</span><span class="ident" id="2120710">pa2</span><span class="op" id="2120713">+</span><span class="ident" id="2120714">s</span><span class="op" id="2120715">*</span><span class="op" id="2120716">(</span><span class="ident" id="2120717">pa3</span><span class="op" id="2120720">+</span><span class="ident" id="2120721">s</span><span class="op" id="2120722">*</span><span class="op" id="2120723">(</span><span class="ident" id="2120724">pa4</span><span class="op" id="2120727">+</span><span class="ident" id="2120728">s</span><span class="op" id="2120729">*</span><span class="op" id="2120730">(</span><span class="ident" id="2120731">pa5</span><span class="op" id="2120734">+</span><span class="ident" id="2120735">s</span><span class="op" id="2120736">*</span><span class="ident" id="2120737">pa6</span><span class="op" id="2120740">)</span><span class="op" id="2120741">)</span><span class="op" id="2120742">)</span><span class="op" id="2120743">)</span><span class="op" id="2120744">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120748">Q</span>&nbsp;<span class="op" id="2120750">:=</span>&nbsp;<span class="num" id="2120753">1</span>&nbsp;<span class="op" id="2120755">+</span>&nbsp;<span class="ident" id="2120757">s</span><span class="op" id="2120758">*</span><span class="op" id="2120759">(</span><span class="ident" id="2120760">qa1</span><span class="op" id="2120763">+</span><span class="ident" id="2120764">s</span><span class="op" id="2120765">*</span><span class="op" id="2120766">(</span><span class="ident" id="2120767">qa2</span><span class="op" id="2120770">+</span><span class="ident" id="2120771">s</span><span class="op" id="2120772">*</span><span class="op" id="2120773">(</span><span class="ident" id="2120774">qa3</span><span class="op" id="2120777">+</span><span class="ident" id="2120778">s</span><span class="op" id="2120779">*</span><span class="op" id="2120780">(</span><span class="ident" id="2120781">qa4</span><span class="op" id="2120784">+</span><span class="ident" id="2120785">s</span><span class="op" id="2120786">*</span><span class="op" id="2120787">(</span><span class="ident" id="2120788">qa5</span><span class="op" id="2120791">+</span><span class="ident" id="2120792">s</span><span class="op" id="2120793">*</span><span class="ident" id="2120794">qa6</span><span class="op" id="2120797">)</span><span class="op" id="2120798">)</span><span class="op" id="2120799">)</span><span class="op" id="2120800">)</span><span class="op" id="2120801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120805">if</span>&nbsp;<span class="ident" id="2120808">sign</span>&nbsp;<span class="op" id="2120813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120818">return</span>&nbsp;<span class="op" id="2120825">-</span><span class="ident" id="2120826">erx</span>&nbsp;<span class="op" id="2120830">-</span>&nbsp;<span class="ident" id="2120832">P</span><span class="op" id="2120833">/</span><span class="ident" id="2120834">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120842">return</span>&nbsp;<span class="ident" id="2120849">erx</span>&nbsp;<span class="op" id="2120853">+</span>&nbsp;<span class="ident" id="2120855">P</span><span class="op" id="2120856">/</span><span class="ident" id="2120857">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120863">if</span>&nbsp;<span class="ident" id="2120866">x</span>&nbsp;<span class="op" id="2120868">&gt;=</span>&nbsp;<span class="num" id="2120871">6</span>&nbsp;<span class="op" id="2120873">{</span>&nbsp;<span class="comment" id="2120875">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120895">if</span>&nbsp;<span class="ident" id="2120898">sign</span>&nbsp;<span class="op" id="2120903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120908">return</span>&nbsp;<span class="op" id="2120915">-</span><span class="num" id="2120916">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120920">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120924">return</span>&nbsp;<span class="num" id="2120931">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2120934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2120937">s</span>&nbsp;<span class="op" id="2120939">:=</span>&nbsp;<span class="num" id="2120942">1</span>&nbsp;<span class="op" id="2120944">/</span>&nbsp;<span class="op" id="2120946">(</span><span class="ident" id="2120947">x</span>&nbsp;<span class="op" id="2120949">*</span>&nbsp;<span class="ident" id="2120951">x</span><span class="op" id="2120952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120955">var</span>&nbsp;<span class="ident" id="2120959">R</span><span class="op" id="2120960">,</span>&nbsp;<span class="ident" id="2120962">S</span>&nbsp;<span class="builtintype" id="2120964">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2120973">if</span>&nbsp;<span class="ident" id="2120976">x</span>&nbsp;<span class="op" id="2120978">&lt;</span>&nbsp;<span class="num" id="2120980">1</span><span class="op" id="2120981">/</span><span class="num" id="2120982">0.35</span>&nbsp;<span class="op" id="2120987">{</span>&nbsp;<span class="comment" id="2120989">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121021">R</span>&nbsp;<span class="op" id="2121023">=</span>&nbsp;<span class="ident" id="2121025">ra0</span>&nbsp;<span class="op" id="2121029">+</span>&nbsp;<span class="ident" id="2121031">s</span><span class="op" id="2121032">*</span><span class="op" id="2121033">(</span><span class="ident" id="2121034">ra1</span><span class="op" id="2121037">+</span><span class="ident" id="2121038">s</span><span class="op" id="2121039">*</span><span class="op" id="2121040">(</span><span class="ident" id="2121041">ra2</span><span class="op" id="2121044">+</span><span class="ident" id="2121045">s</span><span class="op" id="2121046">*</span><span class="op" id="2121047">(</span><span class="ident" id="2121048">ra3</span><span class="op" id="2121051">+</span><span class="ident" id="2121052">s</span><span class="op" id="2121053">*</span><span class="op" id="2121054">(</span><span class="ident" id="2121055">ra4</span><span class="op" id="2121058">+</span><span class="ident" id="2121059">s</span><span class="op" id="2121060">*</span><span class="op" id="2121061">(</span><span class="ident" id="2121062">ra5</span><span class="op" id="2121065">+</span><span class="ident" id="2121066">s</span><span class="op" id="2121067">*</span><span class="op" id="2121068">(</span><span class="ident" id="2121069">ra6</span><span class="op" id="2121072">+</span><span class="ident" id="2121073">s</span><span class="op" id="2121074">*</span><span class="ident" id="2121075">ra7</span><span class="op" id="2121078">)</span><span class="op" id="2121079">)</span><span class="op" id="2121080">)</span><span class="op" id="2121081">)</span><span class="op" id="2121082">)</span><span class="op" id="2121083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121087">S</span>&nbsp;<span class="op" id="2121089">=</span>&nbsp;<span class="num" id="2121091">1</span>&nbsp;<span class="op" id="2121093">+</span>&nbsp;<span class="ident" id="2121095">s</span><span class="op" id="2121096">*</span><span class="op" id="2121097">(</span><span class="ident" id="2121098">sa1</span><span class="op" id="2121101">+</span><span class="ident" id="2121102">s</span><span class="op" id="2121103">*</span><span class="op" id="2121104">(</span><span class="ident" id="2121105">sa2</span><span class="op" id="2121108">+</span><span class="ident" id="2121109">s</span><span class="op" id="2121110">*</span><span class="op" id="2121111">(</span><span class="ident" id="2121112">sa3</span><span class="op" id="2121115">+</span><span class="ident" id="2121116">s</span><span class="op" id="2121117">*</span><span class="op" id="2121118">(</span><span class="ident" id="2121119">sa4</span><span class="op" id="2121122">+</span><span class="ident" id="2121123">s</span><span class="op" id="2121124">*</span><span class="op" id="2121125">(</span><span class="ident" id="2121126">sa5</span><span class="op" id="2121129">+</span><span class="ident" id="2121130">s</span><span class="op" id="2121131">*</span><span class="op" id="2121132">(</span><span class="ident" id="2121133">sa6</span><span class="op" id="2121136">+</span><span class="ident" id="2121137">s</span><span class="op" id="2121138">*</span><span class="op" id="2121139">(</span><span class="ident" id="2121140">sa7</span><span class="op" id="2121143">+</span><span class="ident" id="2121144">s</span><span class="op" id="2121145">*</span><span class="ident" id="2121146">sa8</span><span class="op" id="2121149">)</span><span class="op" id="2121150">)</span><span class="op" id="2121151">)</span><span class="op" id="2121152">)</span><span class="op" id="2121153">)</span><span class="op" id="2121154">)</span><span class="op" id="2121155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2121158">}</span>&nbsp;<span class="keyword" id="2121160">else</span>&nbsp;<span class="op" id="2121165">{</span>&nbsp;<span class="comment" id="2121167">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121200">R</span>&nbsp;<span class="op" id="2121202">=</span>&nbsp;<span class="ident" id="2121204">rb0</span>&nbsp;<span class="op" id="2121208">+</span>&nbsp;<span class="ident" id="2121210">s</span><span class="op" id="2121211">*</span><span class="op" id="2121212">(</span><span class="ident" id="2121213">rb1</span><span class="op" id="2121216">+</span><span class="ident" id="2121217">s</span><span class="op" id="2121218">*</span><span class="op" id="2121219">(</span><span class="ident" id="2121220">rb2</span><span class="op" id="2121223">+</span><span class="ident" id="2121224">s</span><span class="op" id="2121225">*</span><span class="op" id="2121226">(</span><span class="ident" id="2121227">rb3</span><span class="op" id="2121230">+</span><span class="ident" id="2121231">s</span><span class="op" id="2121232">*</span><span class="op" id="2121233">(</span><span class="ident" id="2121234">rb4</span><span class="op" id="2121237">+</span><span class="ident" id="2121238">s</span><span class="op" id="2121239">*</span><span class="op" id="2121240">(</span><span class="ident" id="2121241">rb5</span><span class="op" id="2121244">+</span><span class="ident" id="2121245">s</span><span class="op" id="2121246">*</span><span class="ident" id="2121247">rb6</span><span class="op" id="2121250">)</span><span class="op" id="2121251">)</span><span class="op" id="2121252">)</span><span class="op" id="2121253">)</span><span class="op" id="2121254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121258">S</span>&nbsp;<span class="op" id="2121260">=</span>&nbsp;<span class="num" id="2121262">1</span>&nbsp;<span class="op" id="2121264">+</span>&nbsp;<span class="ident" id="2121266">s</span><span class="op" id="2121267">*</span><span class="op" id="2121268">(</span><span class="ident" id="2121269">sb1</span><span class="op" id="2121272">+</span><span class="ident" id="2121273">s</span><span class="op" id="2121274">*</span><span class="op" id="2121275">(</span><span class="ident" id="2121276">sb2</span><span class="op" id="2121279">+</span><span class="ident" id="2121280">s</span><span class="op" id="2121281">*</span><span class="op" id="2121282">(</span><span class="ident" id="2121283">sb3</span><span class="op" id="2121286">+</span><span class="ident" id="2121287">s</span><span class="op" id="2121288">*</span><span class="op" id="2121289">(</span><span class="ident" id="2121290">sb4</span><span class="op" id="2121293">+</span><span class="ident" id="2121294">s</span><span class="op" id="2121295">*</span><span class="op" id="2121296">(</span><span class="ident" id="2121297">sb5</span><span class="op" id="2121300">+</span><span class="ident" id="2121301">s</span><span class="op" id="2121302">*</span><span class="op" id="2121303">(</span><span class="ident" id="2121304">sb6</span><span class="op" id="2121307">+</span><span class="ident" id="2121308">s</span><span class="op" id="2121309">*</span><span class="ident" id="2121310">sb7</span><span class="op" id="2121313">)</span><span class="op" id="2121314">)</span><span class="op" id="2121315">)</span><span class="op" id="2121316">)</span><span class="op" id="2121317">)</span><span class="op" id="2121318">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2121321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121324">z</span>&nbsp;<span class="op" id="2121326">:=</span>&nbsp;<span class="ident" id="2121329">Float64frombits</span><span class="op" id="2121344">(</span><span class="ident" id="2121345">Float64bits</span><span class="op" id="2121356">(</span><span class="ident" id="2121357">x</span><span class="op" id="2121358">)</span>&nbsp;<span class="op" id="2121360">&amp;</span>&nbsp;<span class="num" id="2121362">0xffffffff00000000</span><span class="op" id="2121380">)</span>&nbsp;<span class="comment" id="2121382">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121421">r</span>&nbsp;<span class="op" id="2121423">:=</span>&nbsp;<span class="ident" id="2121426">Exp</span><span class="op" id="2121429">(</span><span class="op" id="2121430">-</span><span class="ident" id="2121431">z</span><span class="op" id="2121432">*</span><span class="ident" id="2121433">z</span><span class="op" id="2121434">-</span><span class="num" id="2121435">0.5625</span><span class="op" id="2121441">)</span>&nbsp;<span class="op" id="2121443">*</span>&nbsp;<span class="ident" id="2121445">Exp</span><span class="op" id="2121448">(</span><span class="op" id="2121449">(</span><span class="ident" id="2121450">z</span><span class="op" id="2121451">-</span><span class="ident" id="2121452">x</span><span class="op" id="2121453">)</span><span class="op" id="2121454">*</span><span class="op" id="2121455">(</span><span class="ident" id="2121456">z</span><span class="op" id="2121457">+</span><span class="ident" id="2121458">x</span><span class="op" id="2121459">)</span><span class="op" id="2121460">+</span><span class="ident" id="2121461">R</span><span class="op" id="2121462">/</span><span class="ident" id="2121463">S</span><span class="op" id="2121464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121467">if</span>&nbsp;<span class="ident" id="2121470">sign</span>&nbsp;<span class="op" id="2121475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121479">return</span>&nbsp;<span class="ident" id="2121486">r</span><span class="op" id="2121487">/</span><span class="ident" id="2121488">x</span>&nbsp;<span class="op" id="2121490">-</span>&nbsp;<span class="num" id="2121492">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2121495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121498">return</span>&nbsp;<span class="num" id="2121505">1</span>&nbsp;<span class="op" id="2121507">-</span>&nbsp;<span class="ident" id="2121509">r</span><span class="op" id="2121510">/</span><span class="ident" id="2121511">x</span><br>
<span class="lineno"></span><span class="op" id="2121513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2121516">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="2121571">//</span><br>
<span class="lineno"></span><span class="comment" id="2121574">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2121596">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2121614">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2121632">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="2121651">func</span>&nbsp;<span class="ident" id="2121656">Erfc</span><span class="op" id="2121660">(</span><span class="ident" id="2121661">x</span>&nbsp;<span class="builtintype" id="2121663">float64</span><span class="op" id="2121670">)</span>&nbsp;<span class="builtintype" id="2121672">float64</span>&nbsp;<span class="op" id="2121680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121683">const</span>&nbsp;<span class="ident" id="2121689">Tiny</span>&nbsp;<span class="op" id="2121694">=</span>&nbsp;<span class="num" id="2121696">1.0</span>&nbsp;<span class="op" id="2121700">/</span>&nbsp;<span class="op" id="2121702">(</span><span class="num" id="2121703">1</span>&nbsp;<span class="op" id="2121705">&lt;&lt;</span>&nbsp;<span class="num" id="2121708">56</span><span class="op" id="2121710">)</span>&nbsp;<span class="comment" id="2121712">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2121723">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121741">switch</span>&nbsp;<span class="op" id="2121748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121751">case</span>&nbsp;<span class="ident" id="2121756">IsNaN</span><span class="op" id="2121761">(</span><span class="ident" id="2121762">x</span><span class="op" id="2121763">)</span><span class="op" id="2121764">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121768">return</span>&nbsp;<span class="ident" id="2121775">NaN</span><span class="op" id="2121778">(</span><span class="op" id="2121779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121782">case</span>&nbsp;<span class="ident" id="2121787">IsInf</span><span class="op" id="2121792">(</span><span class="ident" id="2121793">x</span><span class="op" id="2121794">,</span>&nbsp;<span class="num" id="2121796">1</span><span class="op" id="2121797">)</span><span class="op" id="2121798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121802">return</span>&nbsp;<span class="num" id="2121809">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121812">case</span>&nbsp;<span class="ident" id="2121817">IsInf</span><span class="op" id="2121822">(</span><span class="ident" id="2121823">x</span><span class="op" id="2121824">,</span>&nbsp;<span class="op" id="2121826">-</span><span class="num" id="2121827">1</span><span class="op" id="2121828">)</span><span class="op" id="2121829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121833">return</span>&nbsp;<span class="num" id="2121840">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2121843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121846">sign</span>&nbsp;<span class="op" id="2121851">:=</span>&nbsp;<span class="builtintype" id="2121854">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121861">if</span>&nbsp;<span class="ident" id="2121864">x</span>&nbsp;<span class="op" id="2121866">&lt;</span>&nbsp;<span class="num" id="2121868">0</span>&nbsp;<span class="op" id="2121870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121874">x</span>&nbsp;<span class="op" id="2121876">=</span>&nbsp;<span class="op" id="2121878">-</span><span class="ident" id="2121879">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121883">sign</span>&nbsp;<span class="op" id="2121888">=</span>&nbsp;<span class="builtintype" id="2121890">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2121896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121899">if</span>&nbsp;<span class="ident" id="2121902">x</span>&nbsp;<span class="op" id="2121904">&lt;</span>&nbsp;<span class="num" id="2121906">0.84375</span>&nbsp;<span class="op" id="2121914">{</span>&nbsp;<span class="comment" id="2121916">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121935">var</span>&nbsp;<span class="ident" id="2121939">temp</span>&nbsp;<span class="builtintype" id="2121944">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2121954">if</span>&nbsp;<span class="ident" id="2121957">x</span>&nbsp;<span class="op" id="2121959">&lt;</span>&nbsp;<span class="ident" id="2121961">Tiny</span>&nbsp;<span class="op" id="2121966">{</span>&nbsp;<span class="comment" id="2121968">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2121987">temp</span>&nbsp;<span class="op" id="2121992">=</span>&nbsp;<span class="ident" id="2121994">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2121998">}</span>&nbsp;<span class="keyword" id="2122000">else</span>&nbsp;<span class="op" id="2122005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122010">z</span>&nbsp;<span class="op" id="2122012">:=</span>&nbsp;<span class="ident" id="2122015">x</span>&nbsp;<span class="op" id="2122017">*</span>&nbsp;<span class="ident" id="2122019">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122024">r</span>&nbsp;<span class="op" id="2122026">:=</span>&nbsp;<span class="ident" id="2122029">pp0</span>&nbsp;<span class="op" id="2122033">+</span>&nbsp;<span class="ident" id="2122035">z</span><span class="op" id="2122036">*</span><span class="op" id="2122037">(</span><span class="ident" id="2122038">pp1</span><span class="op" id="2122041">+</span><span class="ident" id="2122042">z</span><span class="op" id="2122043">*</span><span class="op" id="2122044">(</span><span class="ident" id="2122045">pp2</span><span class="op" id="2122048">+</span><span class="ident" id="2122049">z</span><span class="op" id="2122050">*</span><span class="op" id="2122051">(</span><span class="ident" id="2122052">pp3</span><span class="op" id="2122055">+</span><span class="ident" id="2122056">z</span><span class="op" id="2122057">*</span><span class="ident" id="2122058">pp4</span><span class="op" id="2122061">)</span><span class="op" id="2122062">)</span><span class="op" id="2122063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122068">s</span>&nbsp;<span class="op" id="2122070">:=</span>&nbsp;<span class="num" id="2122073">1</span>&nbsp;<span class="op" id="2122075">+</span>&nbsp;<span class="ident" id="2122077">z</span><span class="op" id="2122078">*</span><span class="op" id="2122079">(</span><span class="ident" id="2122080">qq1</span><span class="op" id="2122083">+</span><span class="ident" id="2122084">z</span><span class="op" id="2122085">*</span><span class="op" id="2122086">(</span><span class="ident" id="2122087">qq2</span><span class="op" id="2122090">+</span><span class="ident" id="2122091">z</span><span class="op" id="2122092">*</span><span class="op" id="2122093">(</span><span class="ident" id="2122094">qq3</span><span class="op" id="2122097">+</span><span class="ident" id="2122098">z</span><span class="op" id="2122099">*</span><span class="op" id="2122100">(</span><span class="ident" id="2122101">qq4</span><span class="op" id="2122104">+</span><span class="ident" id="2122105">z</span><span class="op" id="2122106">*</span><span class="ident" id="2122107">qq5</span><span class="op" id="2122110">)</span><span class="op" id="2122111">)</span><span class="op" id="2122112">)</span><span class="op" id="2122113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122118">y</span>&nbsp;<span class="op" id="2122120">:=</span>&nbsp;<span class="ident" id="2122123">r</span>&nbsp;<span class="op" id="2122125">/</span>&nbsp;<span class="ident" id="2122127">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122132">if</span>&nbsp;<span class="ident" id="2122135">x</span>&nbsp;<span class="op" id="2122137">&lt;</span>&nbsp;<span class="num" id="2122139">0.25</span>&nbsp;<span class="op" id="2122144">{</span>&nbsp;<span class="comment" id="2122146">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122163">temp</span>&nbsp;<span class="op" id="2122168">=</span>&nbsp;<span class="ident" id="2122170">x</span>&nbsp;<span class="op" id="2122172">+</span>&nbsp;<span class="ident" id="2122174">x</span><span class="op" id="2122175">*</span><span class="ident" id="2122176">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122181">}</span>&nbsp;<span class="keyword" id="2122183">else</span>&nbsp;<span class="op" id="2122188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122194">temp</span>&nbsp;<span class="op" id="2122199">=</span>&nbsp;<span class="num" id="2122201">0.5</span>&nbsp;<span class="op" id="2122205">+</span>&nbsp;<span class="op" id="2122207">(</span><span class="ident" id="2122208">x</span><span class="op" id="2122209">*</span><span class="ident" id="2122210">y</span>&nbsp;<span class="op" id="2122212">+</span>&nbsp;<span class="op" id="2122214">(</span><span class="ident" id="2122215">x</span>&nbsp;<span class="op" id="2122217">-</span>&nbsp;<span class="num" id="2122219">0.5</span><span class="op" id="2122222">)</span><span class="op" id="2122223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122228">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122236">if</span>&nbsp;<span class="ident" id="2122239">sign</span>&nbsp;<span class="op" id="2122244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122249">return</span>&nbsp;<span class="num" id="2122256">1</span>&nbsp;<span class="op" id="2122258">+</span>&nbsp;<span class="ident" id="2122260">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122271">return</span>&nbsp;<span class="num" id="2122278">1</span>&nbsp;<span class="op" id="2122280">-</span>&nbsp;<span class="ident" id="2122282">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122291">if</span>&nbsp;<span class="ident" id="2122294">x</span>&nbsp;<span class="op" id="2122296">&lt;</span>&nbsp;<span class="num" id="2122298">1.25</span>&nbsp;<span class="op" id="2122303">{</span>&nbsp;<span class="comment" id="2122305">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122332">s</span>&nbsp;<span class="op" id="2122334">:=</span>&nbsp;<span class="ident" id="2122337">x</span>&nbsp;<span class="op" id="2122339">-</span>&nbsp;<span class="num" id="2122341">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122345">P</span>&nbsp;<span class="op" id="2122347">:=</span>&nbsp;<span class="ident" id="2122350">pa0</span>&nbsp;<span class="op" id="2122354">+</span>&nbsp;<span class="ident" id="2122356">s</span><span class="op" id="2122357">*</span><span class="op" id="2122358">(</span><span class="ident" id="2122359">pa1</span><span class="op" id="2122362">+</span><span class="ident" id="2122363">s</span><span class="op" id="2122364">*</span><span class="op" id="2122365">(</span><span class="ident" id="2122366">pa2</span><span class="op" id="2122369">+</span><span class="ident" id="2122370">s</span><span class="op" id="2122371">*</span><span class="op" id="2122372">(</span><span class="ident" id="2122373">pa3</span><span class="op" id="2122376">+</span><span class="ident" id="2122377">s</span><span class="op" id="2122378">*</span><span class="op" id="2122379">(</span><span class="ident" id="2122380">pa4</span><span class="op" id="2122383">+</span><span class="ident" id="2122384">s</span><span class="op" id="2122385">*</span><span class="op" id="2122386">(</span><span class="ident" id="2122387">pa5</span><span class="op" id="2122390">+</span><span class="ident" id="2122391">s</span><span class="op" id="2122392">*</span><span class="ident" id="2122393">pa6</span><span class="op" id="2122396">)</span><span class="op" id="2122397">)</span><span class="op" id="2122398">)</span><span class="op" id="2122399">)</span><span class="op" id="2122400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122404">Q</span>&nbsp;<span class="op" id="2122406">:=</span>&nbsp;<span class="num" id="2122409">1</span>&nbsp;<span class="op" id="2122411">+</span>&nbsp;<span class="ident" id="2122413">s</span><span class="op" id="2122414">*</span><span class="op" id="2122415">(</span><span class="ident" id="2122416">qa1</span><span class="op" id="2122419">+</span><span class="ident" id="2122420">s</span><span class="op" id="2122421">*</span><span class="op" id="2122422">(</span><span class="ident" id="2122423">qa2</span><span class="op" id="2122426">+</span><span class="ident" id="2122427">s</span><span class="op" id="2122428">*</span><span class="op" id="2122429">(</span><span class="ident" id="2122430">qa3</span><span class="op" id="2122433">+</span><span class="ident" id="2122434">s</span><span class="op" id="2122435">*</span><span class="op" id="2122436">(</span><span class="ident" id="2122437">qa4</span><span class="op" id="2122440">+</span><span class="ident" id="2122441">s</span><span class="op" id="2122442">*</span><span class="op" id="2122443">(</span><span class="ident" id="2122444">qa5</span><span class="op" id="2122447">+</span><span class="ident" id="2122448">s</span><span class="op" id="2122449">*</span><span class="ident" id="2122450">qa6</span><span class="op" id="2122453">)</span><span class="op" id="2122454">)</span><span class="op" id="2122455">)</span><span class="op" id="2122456">)</span><span class="op" id="2122457">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122461">if</span>&nbsp;<span class="ident" id="2122464">sign</span>&nbsp;<span class="op" id="2122469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122474">return</span>&nbsp;<span class="num" id="2122481">1</span>&nbsp;<span class="op" id="2122483">+</span>&nbsp;<span class="ident" id="2122485">erx</span>&nbsp;<span class="op" id="2122489">+</span>&nbsp;<span class="ident" id="2122491">P</span><span class="op" id="2122492">/</span><span class="ident" id="2122493">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122501">return</span>&nbsp;<span class="num" id="2122508">1</span>&nbsp;<span class="op" id="2122510">-</span>&nbsp;<span class="ident" id="2122512">erx</span>&nbsp;<span class="op" id="2122516">-</span>&nbsp;<span class="ident" id="2122518">P</span><span class="op" id="2122519">/</span><span class="ident" id="2122520">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122527">if</span>&nbsp;<span class="ident" id="2122530">x</span>&nbsp;<span class="op" id="2122532">&lt;</span>&nbsp;<span class="num" id="2122534">28</span>&nbsp;<span class="op" id="2122537">{</span>&nbsp;<span class="comment" id="2122539">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122553">s</span>&nbsp;<span class="op" id="2122555">:=</span>&nbsp;<span class="num" id="2122558">1</span>&nbsp;<span class="op" id="2122560">/</span>&nbsp;<span class="op" id="2122562">(</span><span class="ident" id="2122563">x</span>&nbsp;<span class="op" id="2122565">*</span>&nbsp;<span class="ident" id="2122567">x</span><span class="op" id="2122568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122572">var</span>&nbsp;<span class="ident" id="2122576">R</span><span class="op" id="2122577">,</span>&nbsp;<span class="ident" id="2122579">S</span>&nbsp;<span class="builtintype" id="2122581">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122591">if</span>&nbsp;<span class="ident" id="2122594">x</span>&nbsp;<span class="op" id="2122596">&lt;</span>&nbsp;<span class="num" id="2122598">1</span><span class="op" id="2122599">/</span><span class="num" id="2122600">0.35</span>&nbsp;<span class="op" id="2122605">{</span>&nbsp;<span class="comment" id="2122607">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122639">R</span>&nbsp;<span class="op" id="2122641">=</span>&nbsp;<span class="ident" id="2122643">ra0</span>&nbsp;<span class="op" id="2122647">+</span>&nbsp;<span class="ident" id="2122649">s</span><span class="op" id="2122650">*</span><span class="op" id="2122651">(</span><span class="ident" id="2122652">ra1</span><span class="op" id="2122655">+</span><span class="ident" id="2122656">s</span><span class="op" id="2122657">*</span><span class="op" id="2122658">(</span><span class="ident" id="2122659">ra2</span><span class="op" id="2122662">+</span><span class="ident" id="2122663">s</span><span class="op" id="2122664">*</span><span class="op" id="2122665">(</span><span class="ident" id="2122666">ra3</span><span class="op" id="2122669">+</span><span class="ident" id="2122670">s</span><span class="op" id="2122671">*</span><span class="op" id="2122672">(</span><span class="ident" id="2122673">ra4</span><span class="op" id="2122676">+</span><span class="ident" id="2122677">s</span><span class="op" id="2122678">*</span><span class="op" id="2122679">(</span><span class="ident" id="2122680">ra5</span><span class="op" id="2122683">+</span><span class="ident" id="2122684">s</span><span class="op" id="2122685">*</span><span class="op" id="2122686">(</span><span class="ident" id="2122687">ra6</span><span class="op" id="2122690">+</span><span class="ident" id="2122691">s</span><span class="op" id="2122692">*</span><span class="ident" id="2122693">ra7</span><span class="op" id="2122696">)</span><span class="op" id="2122697">)</span><span class="op" id="2122698">)</span><span class="op" id="2122699">)</span><span class="op" id="2122700">)</span><span class="op" id="2122701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122706">S</span>&nbsp;<span class="op" id="2122708">=</span>&nbsp;<span class="num" id="2122710">1</span>&nbsp;<span class="op" id="2122712">+</span>&nbsp;<span class="ident" id="2122714">s</span><span class="op" id="2122715">*</span><span class="op" id="2122716">(</span><span class="ident" id="2122717">sa1</span><span class="op" id="2122720">+</span><span class="ident" id="2122721">s</span><span class="op" id="2122722">*</span><span class="op" id="2122723">(</span><span class="ident" id="2122724">sa2</span><span class="op" id="2122727">+</span><span class="ident" id="2122728">s</span><span class="op" id="2122729">*</span><span class="op" id="2122730">(</span><span class="ident" id="2122731">sa3</span><span class="op" id="2122734">+</span><span class="ident" id="2122735">s</span><span class="op" id="2122736">*</span><span class="op" id="2122737">(</span><span class="ident" id="2122738">sa4</span><span class="op" id="2122741">+</span><span class="ident" id="2122742">s</span><span class="op" id="2122743">*</span><span class="op" id="2122744">(</span><span class="ident" id="2122745">sa5</span><span class="op" id="2122748">+</span><span class="ident" id="2122749">s</span><span class="op" id="2122750">*</span><span class="op" id="2122751">(</span><span class="ident" id="2122752">sa6</span><span class="op" id="2122755">+</span><span class="ident" id="2122756">s</span><span class="op" id="2122757">*</span><span class="op" id="2122758">(</span><span class="ident" id="2122759">sa7</span><span class="op" id="2122762">+</span><span class="ident" id="2122763">s</span><span class="op" id="2122764">*</span><span class="ident" id="2122765">sa8</span><span class="op" id="2122768">)</span><span class="op" id="2122769">)</span><span class="op" id="2122770">)</span><span class="op" id="2122771">)</span><span class="op" id="2122772">)</span><span class="op" id="2122773">)</span><span class="op" id="2122774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122778">}</span>&nbsp;<span class="keyword" id="2122780">else</span>&nbsp;<span class="op" id="2122785">{</span>&nbsp;<span class="comment" id="2122787">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122820">if</span>&nbsp;<span class="ident" id="2122823">sign</span>&nbsp;<span class="op" id="2122828">&amp;&amp;</span>&nbsp;<span class="ident" id="2122831">x</span>&nbsp;<span class="op" id="2122833">&gt;</span>&nbsp;<span class="num" id="2122835">6</span>&nbsp;<span class="op" id="2122837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2122843">return</span>&nbsp;<span class="num" id="2122850">2</span>&nbsp;<span class="comment" id="2122852">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122870">R</span>&nbsp;<span class="op" id="2122872">=</span>&nbsp;<span class="ident" id="2122874">rb0</span>&nbsp;<span class="op" id="2122878">+</span>&nbsp;<span class="ident" id="2122880">s</span><span class="op" id="2122881">*</span><span class="op" id="2122882">(</span><span class="ident" id="2122883">rb1</span><span class="op" id="2122886">+</span><span class="ident" id="2122887">s</span><span class="op" id="2122888">*</span><span class="op" id="2122889">(</span><span class="ident" id="2122890">rb2</span><span class="op" id="2122893">+</span><span class="ident" id="2122894">s</span><span class="op" id="2122895">*</span><span class="op" id="2122896">(</span><span class="ident" id="2122897">rb3</span><span class="op" id="2122900">+</span><span class="ident" id="2122901">s</span><span class="op" id="2122902">*</span><span class="op" id="2122903">(</span><span class="ident" id="2122904">rb4</span><span class="op" id="2122907">+</span><span class="ident" id="2122908">s</span><span class="op" id="2122909">*</span><span class="op" id="2122910">(</span><span class="ident" id="2122911">rb5</span><span class="op" id="2122914">+</span><span class="ident" id="2122915">s</span><span class="op" id="2122916">*</span><span class="ident" id="2122917">rb6</span><span class="op" id="2122920">)</span><span class="op" id="2122921">)</span><span class="op" id="2122922">)</span><span class="op" id="2122923">)</span><span class="op" id="2122924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122929">S</span>&nbsp;<span class="op" id="2122931">=</span>&nbsp;<span class="num" id="2122933">1</span>&nbsp;<span class="op" id="2122935">+</span>&nbsp;<span class="ident" id="2122937">s</span><span class="op" id="2122938">*</span><span class="op" id="2122939">(</span><span class="ident" id="2122940">sb1</span><span class="op" id="2122943">+</span><span class="ident" id="2122944">s</span><span class="op" id="2122945">*</span><span class="op" id="2122946">(</span><span class="ident" id="2122947">sb2</span><span class="op" id="2122950">+</span><span class="ident" id="2122951">s</span><span class="op" id="2122952">*</span><span class="op" id="2122953">(</span><span class="ident" id="2122954">sb3</span><span class="op" id="2122957">+</span><span class="ident" id="2122958">s</span><span class="op" id="2122959">*</span><span class="op" id="2122960">(</span><span class="ident" id="2122961">sb4</span><span class="op" id="2122964">+</span><span class="ident" id="2122965">s</span><span class="op" id="2122966">*</span><span class="op" id="2122967">(</span><span class="ident" id="2122968">sb5</span><span class="op" id="2122971">+</span><span class="ident" id="2122972">s</span><span class="op" id="2122973">*</span><span class="op" id="2122974">(</span><span class="ident" id="2122975">sb6</span><span class="op" id="2122978">+</span><span class="ident" id="2122979">s</span><span class="op" id="2122980">*</span><span class="ident" id="2122981">sb7</span><span class="op" id="2122984">)</span><span class="op" id="2122985">)</span><span class="op" id="2122986">)</span><span class="op" id="2122987">)</span><span class="op" id="2122988">)</span><span class="op" id="2122989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2122993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2122997">z</span>&nbsp;<span class="op" id="2122999">:=</span>&nbsp;<span class="ident" id="2123002">Float64frombits</span><span class="op" id="2123017">(</span><span class="ident" id="2123018">Float64bits</span><span class="op" id="2123029">(</span><span class="ident" id="2123030">x</span><span class="op" id="2123031">)</span>&nbsp;<span class="op" id="2123033">&amp;</span>&nbsp;<span class="num" id="2123035">0xffffffff00000000</span><span class="op" id="2123053">)</span>&nbsp;<span class="comment" id="2123055">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2123095">r</span>&nbsp;<span class="op" id="2123097">:=</span>&nbsp;<span class="ident" id="2123100">Exp</span><span class="op" id="2123103">(</span><span class="op" id="2123104">-</span><span class="ident" id="2123105">z</span><span class="op" id="2123106">*</span><span class="ident" id="2123107">z</span><span class="op" id="2123108">-</span><span class="num" id="2123109">0.5625</span><span class="op" id="2123115">)</span>&nbsp;<span class="op" id="2123117">*</span>&nbsp;<span class="ident" id="2123119">Exp</span><span class="op" id="2123122">(</span><span class="op" id="2123123">(</span><span class="ident" id="2123124">z</span><span class="op" id="2123125">-</span><span class="ident" id="2123126">x</span><span class="op" id="2123127">)</span><span class="op" id="2123128">*</span><span class="op" id="2123129">(</span><span class="ident" id="2123130">z</span><span class="op" id="2123131">+</span><span class="ident" id="2123132">x</span><span class="op" id="2123133">)</span><span class="op" id="2123134">+</span><span class="ident" id="2123135">R</span><span class="op" id="2123136">/</span><span class="ident" id="2123137">S</span><span class="op" id="2123138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2123142">if</span>&nbsp;<span class="ident" id="2123145">sign</span>&nbsp;<span class="op" id="2123150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2123155">return</span>&nbsp;<span class="num" id="2123162">2</span>&nbsp;<span class="op" id="2123164">-</span>&nbsp;<span class="ident" id="2123166">r</span><span class="op" id="2123167">/</span><span class="ident" id="2123168">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2123172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2123176">return</span>&nbsp;<span class="ident" id="2123183">r</span>&nbsp;<span class="op" id="2123185">/</span>&nbsp;<span class="ident" id="2123187">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2123190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2123193">if</span>&nbsp;<span class="ident" id="2123196">sign</span>&nbsp;<span class="op" id="2123201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2123205">return</span>&nbsp;<span class="num" id="2123212">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2123215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2123218">return</span>&nbsp;<span class="num" id="2123225">0</span><br>
<span class="lineno">335</span><span class="op" id="2123227">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
