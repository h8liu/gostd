<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/ast</h2>
<ul>
<li><a href="/gostd/go/ast/ast.go.html">ast.go</a></li>
<li><a href="/gostd/go/ast/ast_test.go.html">ast_test.go</a></li>
<li><a href="/gostd/go/ast/commentmap.go.html">commentmap.go</a></li>
<li><a href="/gostd/go/ast/commentmap_test.go.html">commentmap_test.go</a></li>
<li><a href="/gostd/go/ast/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/ast/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/ast/filter_test.go.html">filter_test.go</a></li>
<li><a href="/gostd/go/ast/import.go.html">import.go</a></li>
<li><a href="/gostd/go/ast/print.go.html">print.go</a></li>
<li><a href="/gostd/go/ast/print_test.go.html">print_test.go</a></li>
<li><a href="/gostd/go/ast/resolve.go.html">resolve.go</a></li>
<li><a href="/gostd/go/ast/scope.go.html">scope.go</a></li>
<li><a href="/gostd/go/ast/walk.go.html">walk.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2324100">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2324155">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2324209">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2324260">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;printing&nbsp;support&nbsp;for&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2324310">package</span>&nbsp;<span class="ident" id="2324318">ast</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2324323">import</span>&nbsp;<span class="op" id="2324330">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2324333">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2324340">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2324352">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2324358">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2324364">&#34;reflect&#34;</span><br>
<span class="lineno">15</span><span class="op" id="2324374">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2324377">//&nbsp;A&nbsp;FieldFilter&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Fprint&nbsp;to&nbsp;control&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="2324443">type</span>&nbsp;<span class="ident" id="2324448">FieldFilter</span>&nbsp;<span class="keyword" id="2324460">func</span><span class="op" id="2324464">(</span><span class="ident" id="2324465">name</span>&nbsp;<span class="builtintype" id="2324470">string</span><span class="op" id="2324476">,</span>&nbsp;<span class="ident" id="2324478">value</span>&nbsp;<span class="ident" id="2324484">reflect</span><span class="op" id="2324491">.</span><span class="ident" id="2324492">Value</span><span class="op" id="2324497">)</span>&nbsp;<span class="builtintype" id="2324499">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2324505">//&nbsp;NotNilFilter&nbsp;returns&nbsp;true&nbsp;for&nbsp;field&nbsp;values&nbsp;that&nbsp;are&nbsp;not&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="2324569">//&nbsp;it&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="2324600">func</span>&nbsp;<span class="ident" id="2324605">NotNilFilter</span><span class="op" id="2324617">(</span><span class="ident" id="2324618">_</span>&nbsp;<span class="builtintype" id="2324620">string</span><span class="op" id="2324626">,</span>&nbsp;<span class="ident" id="2324628">v</span>&nbsp;<span class="ident" id="2324630">reflect</span><span class="op" id="2324637">.</span><span class="ident" id="2324638">Value</span><span class="op" id="2324643">)</span>&nbsp;<span class="builtintype" id="2324645">bool</span>&nbsp;<span class="op" id="2324650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324653">switch</span>&nbsp;<span class="ident" id="2324660">v</span><span class="op" id="2324661">.</span><span class="ident" id="2324662">Kind</span><span class="op" id="2324666">(</span><span class="op" id="2324667">)</span>&nbsp;<span class="op" id="2324669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324672">case</span>&nbsp;<span class="ident" id="2324677">reflect</span><span class="op" id="2324684">.</span><span class="ident" id="2324685">Chan</span><span class="op" id="2324689">,</span>&nbsp;<span class="ident" id="2324691">reflect</span><span class="op" id="2324698">.</span><span class="ident" id="2324699">Func</span><span class="op" id="2324703">,</span>&nbsp;<span class="ident" id="2324705">reflect</span><span class="op" id="2324712">.</span><span class="ident" id="2324713">Interface</span><span class="op" id="2324722">,</span>&nbsp;<span class="ident" id="2324724">reflect</span><span class="op" id="2324731">.</span><span class="ident" id="2324732">Map</span><span class="op" id="2324735">,</span>&nbsp;<span class="ident" id="2324737">reflect</span><span class="op" id="2324744">.</span><span class="ident" id="2324745">Ptr</span><span class="op" id="2324748">,</span>&nbsp;<span class="ident" id="2324750">reflect</span><span class="op" id="2324757">.</span><span class="ident" id="2324758">Slice</span><span class="op" id="2324763">:</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324767">return</span>&nbsp;<span class="op" id="2324774">!</span><span class="ident" id="2324775">v</span><span class="op" id="2324776">.</span><span class="ident" id="2324777">IsNil</span><span class="op" id="2324782">(</span><span class="op" id="2324783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2324786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2324789">return</span>&nbsp;<span class="builtintype" id="2324796">true</span><br>
<span class="lineno"></span><span class="op" id="2324801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="2324804">//&nbsp;Fprint&nbsp;prints&nbsp;the&nbsp;(sub-)tree&nbsp;starting&nbsp;at&nbsp;AST&nbsp;node&nbsp;x&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="2324865">//&nbsp;If&nbsp;fset&nbsp;!=&nbsp;nil,&nbsp;position&nbsp;information&nbsp;is&nbsp;interpreted&nbsp;relative</span><br>
<span class="lineno"></span><span class="comment" id="2324929">//&nbsp;to&nbsp;that&nbsp;file&nbsp;set.&nbsp;Otherwise&nbsp;positions&nbsp;are&nbsp;printed&nbsp;as&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2324993">//&nbsp;values&nbsp;(file&nbsp;set&nbsp;specific&nbsp;offsets).</span><br>
<span class="lineno"></span><span class="comment" id="2325032">//</span><br>
<span class="lineno">35</span><span class="comment" id="2325035">//&nbsp;A&nbsp;non-nil&nbsp;FieldFilter&nbsp;f&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;control&nbsp;the&nbsp;output:</span><br>
<span class="lineno"></span><span class="comment" id="2325101">//&nbsp;struct&nbsp;fields&nbsp;for&nbsp;which&nbsp;f(fieldname,&nbsp;fieldvalue)&nbsp;is&nbsp;true&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2325165">//&nbsp;printed;&nbsp;all&nbsp;others&nbsp;are&nbsp;filtered&nbsp;from&nbsp;the&nbsp;output.&nbsp;Unexported</span><br>
<span class="lineno"></span><span class="comment" id="2325229">//&nbsp;struct&nbsp;fields&nbsp;are&nbsp;never&nbsp;printed.</span><br>
<span class="lineno"></span><span class="comment" id="2325265">//</span><br>
<span class="lineno">40</span><span class="keyword" id="2325268">func</span>&nbsp;<span class="ident" id="2325273">Fprint</span><span class="op" id="2325279">(</span><span class="ident" id="2325280">w</span>&nbsp;<span class="ident" id="2325282">io</span><span class="op" id="2325284">.</span><span class="ident" id="2325285">Writer</span><span class="op" id="2325291">,</span>&nbsp;<span class="ident" id="2325293">fset</span>&nbsp;<span class="op" id="2325298">*</span><span class="ident" id="2325299">token</span><span class="op" id="2325304">.</span><span class="ident" id="2325305">FileSet</span><span class="op" id="2325312">,</span>&nbsp;<span class="ident" id="2325314">x</span>&nbsp;<span class="keyword" id="2325316">interface</span><span class="op" id="2325325">{</span><span class="op" id="2325326">}</span><span class="op" id="2325327">,</span>&nbsp;<span class="ident" id="2325329">f</span>&nbsp;<span class="ident" id="2325331">FieldFilter</span><span class="op" id="2325342">)</span>&nbsp;<span class="op" id="2325344">(</span><span class="ident" id="2325345">err</span>&nbsp;<span class="builtintype" id="2325349">error</span><span class="op" id="2325354">)</span>&nbsp;<span class="op" id="2325356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325359">//&nbsp;setup&nbsp;printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325377">p</span>&nbsp;<span class="op" id="2325379">:=</span>&nbsp;<span class="ident" id="2325382">printer</span><span class="op" id="2325389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325393">output</span><span class="op" id="2325399">:</span>&nbsp;<span class="ident" id="2325401">w</span><span class="op" id="2325402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325406">fset</span><span class="op" id="2325410">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2325414">fset</span><span class="op" id="2325418">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325422">filter</span><span class="op" id="2325428">:</span>&nbsp;<span class="ident" id="2325430">f</span><span class="op" id="2325431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325435">ptrmap</span><span class="op" id="2325441">:</span>&nbsp;<span class="builtinfunc" id="2325443">make</span><span class="op" id="2325447">(</span><span class="keyword" id="2325448">map</span><span class="op" id="2325451">[</span><span class="keyword" id="2325452">interface</span><span class="op" id="2325461">{</span><span class="op" id="2325462">}</span><span class="op" id="2325463">]</span><span class="builtintype" id="2325464">int</span><span class="op" id="2325467">)</span><span class="op" id="2325468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325472">last</span><span class="op" id="2325476">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2325480">&#39;\n&#39;</span><span class="op" id="2325484">,</span>&nbsp;<span class="comment" id="2325486">//&nbsp;force&nbsp;printing&nbsp;of&nbsp;line&nbsp;number&nbsp;on&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325538">//&nbsp;install&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325564">defer</span>&nbsp;<span class="keyword" id="2325570">func</span><span class="op" id="2325574">(</span><span class="op" id="2325575">)</span>&nbsp;<span class="op" id="2325577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325581">if</span>&nbsp;<span class="ident" id="2325584">e</span>&nbsp;<span class="op" id="2325586">:=</span>&nbsp;<span class="builtinfunc" id="2325589">recover</span><span class="op" id="2325596">(</span><span class="op" id="2325597">)</span><span class="op" id="2325598">;</span>&nbsp;<span class="ident" id="2325600">e</span>&nbsp;<span class="op" id="2325602">!=</span>&nbsp;<span class="ident" id="2325605">nil</span>&nbsp;<span class="op" id="2325609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325614">err</span>&nbsp;<span class="op" id="2325618">=</span>&nbsp;<span class="ident" id="2325620">e</span><span class="op" id="2325621">.</span><span class="op" id="2325622">(</span><span class="ident" id="2325623">localError</span><span class="op" id="2325633">)</span><span class="op" id="2325634">.</span><span class="ident" id="2325635">err</span>&nbsp;<span class="comment" id="2325639">//&nbsp;re-panics&nbsp;if&nbsp;it&#39;s&nbsp;not&nbsp;a&nbsp;localError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325679">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325682">}</span><span class="op" id="2325683">(</span><span class="op" id="2325684">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2325688">//&nbsp;print&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325700">if</span>&nbsp;<span class="ident" id="2325703">x</span>&nbsp;<span class="op" id="2325705">==</span>&nbsp;<span class="ident" id="2325708">nil</span>&nbsp;<span class="op" id="2325712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325716">p</span><span class="op" id="2325717">.</span><span class="ident" id="2325718">printf</span><span class="op" id="2325724">(</span><span class="string" id="2325725">&#34;nil\n&#34;</span><span class="op" id="2325732">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325736">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2325744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325747">p</span><span class="op" id="2325748">.</span><span class="builtinfunc" id="2325749">print</span><span class="op" id="2325754">(</span><span class="ident" id="2325755">reflect</span><span class="op" id="2325762">.</span><span class="ident" id="2325763">ValueOf</span><span class="op" id="2325770">(</span><span class="ident" id="2325771">x</span><span class="op" id="2325772">)</span><span class="op" id="2325773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2325776">p</span><span class="op" id="2325777">.</span><span class="ident" id="2325778">printf</span><span class="op" id="2325784">(</span><span class="string" id="2325785">&#34;\n&#34;</span><span class="op" id="2325789">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325793">return</span><br>
<span class="lineno"></span><span class="op" id="2325800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2325803">//&nbsp;Print&nbsp;prints&nbsp;x&nbsp;to&nbsp;standard&nbsp;output,&nbsp;skipping&nbsp;nil&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="2325862">//&nbsp;Print(fset,&nbsp;x)&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;Fprint(os.Stdout,&nbsp;fset,&nbsp;x,&nbsp;NotNilFilter).</span><br>
<span class="lineno">70</span><span class="keyword" id="2325937">func</span>&nbsp;<span class="ident" id="2325942">Print</span><span class="op" id="2325947">(</span><span class="ident" id="2325948">fset</span>&nbsp;<span class="op" id="2325953">*</span><span class="ident" id="2325954">token</span><span class="op" id="2325959">.</span><span class="ident" id="2325960">FileSet</span><span class="op" id="2325967">,</span>&nbsp;<span class="ident" id="2325969">x</span>&nbsp;<span class="keyword" id="2325971">interface</span><span class="op" id="2325980">{</span><span class="op" id="2325981">}</span><span class="op" id="2325982">)</span>&nbsp;<span class="builtintype" id="2325984">error</span>&nbsp;<span class="op" id="2325990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2325993">return</span>&nbsp;<span class="ident" id="2326000">Fprint</span><span class="op" id="2326006">(</span><span class="ident" id="2326007">os</span><span class="op" id="2326009">.</span><span class="ident" id="2326010">Stdout</span><span class="op" id="2326016">,</span>&nbsp;<span class="ident" id="2326018">fset</span><span class="op" id="2326022">,</span>&nbsp;<span class="ident" id="2326024">x</span><span class="op" id="2326025">,</span>&nbsp;<span class="ident" id="2326027">NotNilFilter</span><span class="op" id="2326039">)</span><br>
<span class="lineno"></span><span class="op" id="2326041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2326044">type</span>&nbsp;<span class="ident" id="2326049">printer</span>&nbsp;<span class="keyword" id="2326057">struct</span>&nbsp;<span class="op" id="2326064">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326067">output</span>&nbsp;<span class="ident" id="2326074">io</span><span class="op" id="2326076">.</span><span class="ident" id="2326077">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326085">fset</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2326092">*</span><span class="ident" id="2326093">token</span><span class="op" id="2326098">.</span><span class="ident" id="2326099">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326108">filter</span>&nbsp;<span class="ident" id="2326115">FieldFilter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326128">ptrmap</span>&nbsp;<span class="keyword" id="2326135">map</span><span class="op" id="2326138">[</span><span class="keyword" id="2326139">interface</span><span class="op" id="2326148">{</span><span class="op" id="2326149">}</span><span class="op" id="2326150">]</span><span class="builtintype" id="2326151">int</span>&nbsp;<span class="comment" id="2326155">//&nbsp;*T&nbsp;-&gt;&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326177">indent</span>&nbsp;<span class="builtintype" id="2326184">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2326204">//&nbsp;current&nbsp;indentation&nbsp;level</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326234">last</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2326241">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2326261">//&nbsp;the&nbsp;last&nbsp;byte&nbsp;processed&nbsp;by&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326298">line</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2326305">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2326325">//&nbsp;current&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span><span class="op" id="2326348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2326351">var</span>&nbsp;<span class="ident" id="2326355">indent</span>&nbsp;<span class="op" id="2326362">=</span>&nbsp;<span class="op" id="2326364">[</span><span class="op" id="2326365">]</span><span class="builtintype" id="2326366">byte</span><span class="op" id="2326370">(</span><span class="string" id="2326371">&#34;.&nbsp;&nbsp;&#34;</span><span class="op" id="2326376">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="2326379">func</span>&nbsp;<span class="op" id="2326384">(</span><span class="ident" id="2326385">p</span>&nbsp;<span class="op" id="2326387">*</span><span class="ident" id="2326388">printer</span><span class="op" id="2326395">)</span>&nbsp;<span class="ident" id="2326397">Write</span><span class="op" id="2326402">(</span><span class="ident" id="2326403">data</span>&nbsp;<span class="op" id="2326408">[</span><span class="op" id="2326409">]</span><span class="builtintype" id="2326410">byte</span><span class="op" id="2326414">)</span>&nbsp;<span class="op" id="2326416">(</span><span class="ident" id="2326417">n</span>&nbsp;<span class="builtintype" id="2326419">int</span><span class="op" id="2326422">,</span>&nbsp;<span class="ident" id="2326424">err</span>&nbsp;<span class="builtintype" id="2326428">error</span><span class="op" id="2326433">)</span>&nbsp;<span class="op" id="2326435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326438">var</span>&nbsp;<span class="ident" id="2326442">m</span>&nbsp;<span class="builtintype" id="2326444">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326449">for</span>&nbsp;<span class="ident" id="2326453">i</span><span class="op" id="2326454">,</span>&nbsp;<span class="ident" id="2326456">b</span>&nbsp;<span class="op" id="2326458">:=</span>&nbsp;<span class="keyword" id="2326461">range</span>&nbsp;<span class="ident" id="2326467">data</span>&nbsp;<span class="op" id="2326472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2326476">//&nbsp;invariant:&nbsp;data[0:n]&nbsp;has&nbsp;been&nbsp;written</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326519">if</span>&nbsp;<span class="ident" id="2326522">b</span>&nbsp;<span class="op" id="2326524">==</span>&nbsp;<span class="string" id="2326527">&#39;\n&#39;</span>&nbsp;<span class="op" id="2326532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326537">m</span><span class="op" id="2326538">,</span>&nbsp;<span class="ident" id="2326540">err</span>&nbsp;<span class="op" id="2326544">=</span>&nbsp;<span class="ident" id="2326546">p</span><span class="op" id="2326547">.</span><span class="ident" id="2326548">output</span><span class="op" id="2326554">.</span><span class="ident" id="2326555">Write</span><span class="op" id="2326560">(</span><span class="ident" id="2326561">data</span><span class="op" id="2326565">[</span><span class="ident" id="2326566">n</span>&nbsp;<span class="op" id="2326568">:</span>&nbsp;<span class="ident" id="2326570">i</span><span class="op" id="2326571">+</span><span class="num" id="2326572">1</span><span class="op" id="2326573">]</span><span class="op" id="2326574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326579">n</span>&nbsp;<span class="op" id="2326581">+=</span>&nbsp;<span class="ident" id="2326584">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326589">if</span>&nbsp;<span class="ident" id="2326592">err</span>&nbsp;<span class="op" id="2326596">!=</span>&nbsp;<span class="ident" id="2326599">nil</span>&nbsp;<span class="op" id="2326603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326609">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326624">p</span><span class="op" id="2326625">.</span><span class="ident" id="2326626">line</span><span class="op" id="2326630">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326635">}</span>&nbsp;<span class="keyword" id="2326637">else</span>&nbsp;<span class="keyword" id="2326642">if</span>&nbsp;<span class="ident" id="2326645">p</span><span class="op" id="2326646">.</span><span class="ident" id="2326647">last</span>&nbsp;<span class="op" id="2326652">==</span>&nbsp;<span class="string" id="2326655">&#39;\n&#39;</span>&nbsp;<span class="op" id="2326660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326665">_</span><span class="op" id="2326666">,</span>&nbsp;<span class="ident" id="2326668">err</span>&nbsp;<span class="op" id="2326672">=</span>&nbsp;<span class="ident" id="2326674">fmt</span><span class="op" id="2326677">.</span><span class="ident" id="2326678">Fprintf</span><span class="op" id="2326685">(</span><span class="ident" id="2326686">p</span><span class="op" id="2326687">.</span><span class="ident" id="2326688">output</span><span class="op" id="2326694">,</span>&nbsp;<span class="string" id="2326696">&#34;%6d&nbsp;&nbsp;&#34;</span><span class="op" id="2326703">,</span>&nbsp;<span class="ident" id="2326705">p</span><span class="op" id="2326706">.</span><span class="ident" id="2326707">line</span><span class="op" id="2326711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326716">if</span>&nbsp;<span class="ident" id="2326719">err</span>&nbsp;<span class="op" id="2326723">!=</span>&nbsp;<span class="ident" id="2326726">nil</span>&nbsp;<span class="op" id="2326730">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326736">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326751">for</span>&nbsp;<span class="ident" id="2326755">j</span>&nbsp;<span class="op" id="2326757">:=</span>&nbsp;<span class="ident" id="2326760">p</span><span class="op" id="2326761">.</span><span class="ident" id="2326762">indent</span><span class="op" id="2326768">;</span>&nbsp;<span class="ident" id="2326770">j</span>&nbsp;<span class="op" id="2326772">&gt;</span>&nbsp;<span class="num" id="2326774">0</span><span class="op" id="2326775">;</span>&nbsp;<span class="ident" id="2326777">j</span><span class="op" id="2326778">--</span>&nbsp;<span class="op" id="2326781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326787">_</span><span class="op" id="2326788">,</span>&nbsp;<span class="ident" id="2326790">err</span>&nbsp;<span class="op" id="2326794">=</span>&nbsp;<span class="ident" id="2326796">p</span><span class="op" id="2326797">.</span><span class="ident" id="2326798">output</span><span class="op" id="2326804">.</span><span class="ident" id="2326805">Write</span><span class="op" id="2326810">(</span><span class="ident" id="2326811">indent</span><span class="op" id="2326817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326823">if</span>&nbsp;<span class="ident" id="2326826">err</span>&nbsp;<span class="op" id="2326830">!=</span>&nbsp;<span class="ident" id="2326833">nil</span>&nbsp;<span class="op" id="2326837">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326844">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326868">p</span><span class="op" id="2326869">.</span><span class="ident" id="2326870">last</span>&nbsp;<span class="op" id="2326875">=</span>&nbsp;<span class="ident" id="2326877">b</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326883">if</span>&nbsp;<span class="builtinfunc" id="2326886">len</span><span class="op" id="2326889">(</span><span class="ident" id="2326890">data</span><span class="op" id="2326894">)</span>&nbsp;<span class="op" id="2326896">&gt;</span>&nbsp;<span class="ident" id="2326898">n</span>&nbsp;<span class="op" id="2326900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326904">m</span><span class="op" id="2326905">,</span>&nbsp;<span class="ident" id="2326907">err</span>&nbsp;<span class="op" id="2326911">=</span>&nbsp;<span class="ident" id="2326913">p</span><span class="op" id="2326914">.</span><span class="ident" id="2326915">output</span><span class="op" id="2326921">.</span><span class="ident" id="2326922">Write</span><span class="op" id="2326927">(</span><span class="ident" id="2326928">data</span><span class="op" id="2326932">[</span><span class="ident" id="2326933">n</span><span class="op" id="2326934">:</span><span class="op" id="2326935">]</span><span class="op" id="2326936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326940">n</span>&nbsp;<span class="op" id="2326942">+=</span>&nbsp;<span class="ident" id="2326945">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326948">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326951">return</span><br>
<span class="lineno"></span><span class="op" id="2326958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2326961">//&nbsp;localError&nbsp;wraps&nbsp;locally&nbsp;caught&nbsp;errors&nbsp;so&nbsp;we&nbsp;can&nbsp;distinguish</span><br>
<span class="lineno"></span><span class="comment" id="2327025">//&nbsp;them&nbsp;from&nbsp;genuine&nbsp;panics&nbsp;which&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;return&nbsp;as&nbsp;errors.</span><br>
<span class="lineno">120</span><span class="keyword" id="2327094">type</span>&nbsp;<span class="ident" id="2327099">localError</span>&nbsp;<span class="keyword" id="2327110">struct</span>&nbsp;<span class="op" id="2327117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327120">err</span>&nbsp;<span class="builtintype" id="2327124">error</span><br>
<span class="lineno"></span><span class="op" id="2327130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2327133">//&nbsp;printf&nbsp;is&nbsp;a&nbsp;convenience&nbsp;wrapper&nbsp;that&nbsp;takes&nbsp;care&nbsp;of&nbsp;print&nbsp;errors.</span><br>
<span class="lineno">125</span><span class="keyword" id="2327201">func</span>&nbsp;<span class="op" id="2327206">(</span><span class="ident" id="2327207">p</span>&nbsp;<span class="op" id="2327209">*</span><span class="ident" id="2327210">printer</span><span class="op" id="2327217">)</span>&nbsp;<span class="ident" id="2327219">printf</span><span class="op" id="2327225">(</span><span class="ident" id="2327226">format</span>&nbsp;<span class="builtintype" id="2327233">string</span><span class="op" id="2327239">,</span>&nbsp;<span class="ident" id="2327241">args</span>&nbsp;<span class="op" id="2327246">...</span><span class="keyword" id="2327249">interface</span><span class="op" id="2327258">{</span><span class="op" id="2327259">}</span><span class="op" id="2327260">)</span>&nbsp;<span class="op" id="2327262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327265">if</span>&nbsp;<span class="ident" id="2327268">_</span><span class="op" id="2327269">,</span>&nbsp;<span class="ident" id="2327271">err</span>&nbsp;<span class="op" id="2327275">:=</span>&nbsp;<span class="ident" id="2327278">fmt</span><span class="op" id="2327281">.</span><span class="ident" id="2327282">Fprintf</span><span class="op" id="2327289">(</span><span class="ident" id="2327290">p</span><span class="op" id="2327291">,</span>&nbsp;<span class="ident" id="2327293">format</span><span class="op" id="2327299">,</span>&nbsp;<span class="ident" id="2327301">args</span><span class="op" id="2327305">...</span><span class="op" id="2327308">)</span><span class="op" id="2327309">;</span>&nbsp;<span class="ident" id="2327311">err</span>&nbsp;<span class="op" id="2327315">!=</span>&nbsp;<span class="ident" id="2327318">nil</span>&nbsp;<span class="op" id="2327322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2327326">panic</span><span class="op" id="2327331">(</span><span class="ident" id="2327332">localError</span><span class="op" id="2327342">{</span><span class="ident" id="2327343">err</span><span class="op" id="2327346">}</span><span class="op" id="2327347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2327350">}</span><br>
<span class="lineno"></span><span class="op" id="2327352">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2327355">//&nbsp;Implementation&nbsp;note:&nbsp;Print&nbsp;is&nbsp;written&nbsp;for&nbsp;AST&nbsp;nodes&nbsp;but&nbsp;could&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2327423">//&nbsp;used&nbsp;to&nbsp;print&nbsp;arbitrary&nbsp;data&nbsp;structures;&nbsp;such&nbsp;a&nbsp;version&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="2327489">//&nbsp;probably&nbsp;be&nbsp;in&nbsp;a&nbsp;different&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="2327528">//</span><br>
<span class="lineno">135</span><span class="comment" id="2327531">//&nbsp;Note:&nbsp;This&nbsp;code&nbsp;detects&nbsp;(some)&nbsp;cycles&nbsp;created&nbsp;via&nbsp;pointers&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="2327597">//&nbsp;not&nbsp;cycles&nbsp;that&nbsp;are&nbsp;created&nbsp;via&nbsp;slices&nbsp;or&nbsp;maps&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2327662">//&nbsp;same&nbsp;slice&nbsp;or&nbsp;map.&nbsp;Code&nbsp;for&nbsp;general&nbsp;data&nbsp;structures&nbsp;probably</span><br>
<span class="lineno"></span><span class="comment" id="2327726">//&nbsp;should&nbsp;catch&nbsp;those&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="2327758">func</span>&nbsp;<span class="op" id="2327763">(</span><span class="ident" id="2327764">p</span>&nbsp;<span class="op" id="2327766">*</span><span class="ident" id="2327767">printer</span><span class="op" id="2327774">)</span>&nbsp;<span class="builtinfunc" id="2327776">print</span><span class="op" id="2327781">(</span><span class="ident" id="2327782">x</span>&nbsp;<span class="ident" id="2327784">reflect</span><span class="op" id="2327791">.</span><span class="ident" id="2327792">Value</span><span class="op" id="2327797">)</span>&nbsp;<span class="op" id="2327799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327802">if</span>&nbsp;<span class="op" id="2327805">!</span><span class="ident" id="2327806">NotNilFilter</span><span class="op" id="2327818">(</span><span class="string" id="2327819">&#34;&#34;</span><span class="op" id="2327821">,</span>&nbsp;<span class="ident" id="2327823">x</span><span class="op" id="2327824">)</span>&nbsp;<span class="op" id="2327826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327830">p</span><span class="op" id="2327831">.</span><span class="ident" id="2327832">printf</span><span class="op" id="2327838">(</span><span class="string" id="2327839">&#34;nil&#34;</span><span class="op" id="2327844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327848">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2327856">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327860">switch</span>&nbsp;<span class="ident" id="2327867">x</span><span class="op" id="2327868">.</span><span class="ident" id="2327869">Kind</span><span class="op" id="2327873">(</span><span class="op" id="2327874">)</span>&nbsp;<span class="op" id="2327876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327879">case</span>&nbsp;<span class="ident" id="2327884">reflect</span><span class="op" id="2327891">.</span><span class="ident" id="2327892">Interface</span><span class="op" id="2327901">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327905">p</span><span class="op" id="2327906">.</span><span class="builtinfunc" id="2327907">print</span><span class="op" id="2327912">(</span><span class="ident" id="2327913">x</span><span class="op" id="2327914">.</span><span class="ident" id="2327915">Elem</span><span class="op" id="2327919">(</span><span class="op" id="2327920">)</span><span class="op" id="2327921">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327925">case</span>&nbsp;<span class="ident" id="2327930">reflect</span><span class="op" id="2327937">.</span><span class="ident" id="2327938">Map</span><span class="op" id="2327941">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327945">p</span><span class="op" id="2327946">.</span><span class="ident" id="2327947">printf</span><span class="op" id="2327953">(</span><span class="string" id="2327954">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="2327971">,</span>&nbsp;<span class="ident" id="2327973">x</span><span class="op" id="2327974">.</span><span class="ident" id="2327975">Type</span><span class="op" id="2327979">(</span><span class="op" id="2327980">)</span><span class="op" id="2327981">,</span>&nbsp;<span class="ident" id="2327983">x</span><span class="op" id="2327984">.</span><span class="ident" id="2327985">Len</span><span class="op" id="2327988">(</span><span class="op" id="2327989">)</span><span class="op" id="2327990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327994">if</span>&nbsp;<span class="ident" id="2327997">x</span><span class="op" id="2327998">.</span><span class="ident" id="2327999">Len</span><span class="op" id="2328002">(</span><span class="op" id="2328003">)</span>&nbsp;<span class="op" id="2328005">&gt;</span>&nbsp;<span class="num" id="2328007">0</span>&nbsp;<span class="op" id="2328009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328014">p</span><span class="op" id="2328015">.</span><span class="ident" id="2328016">indent</span><span class="op" id="2328022">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328028">p</span><span class="op" id="2328029">.</span><span class="ident" id="2328030">printf</span><span class="op" id="2328036">(</span><span class="string" id="2328037">&#34;\n&#34;</span><span class="op" id="2328041">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328046">for</span>&nbsp;<span class="ident" id="2328050">_</span><span class="op" id="2328051">,</span>&nbsp;<span class="ident" id="2328053">key</span>&nbsp;<span class="op" id="2328057">:=</span>&nbsp;<span class="keyword" id="2328060">range</span>&nbsp;<span class="ident" id="2328066">x</span><span class="op" id="2328067">.</span><span class="ident" id="2328068">MapKeys</span><span class="op" id="2328075">(</span><span class="op" id="2328076">)</span>&nbsp;<span class="op" id="2328078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328084">p</span><span class="op" id="2328085">.</span><span class="builtinfunc" id="2328086">print</span><span class="op" id="2328091">(</span><span class="ident" id="2328092">key</span><span class="op" id="2328095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328101">p</span><span class="op" id="2328102">.</span><span class="ident" id="2328103">printf</span><span class="op" id="2328109">(</span><span class="string" id="2328110">&#34;:&nbsp;&#34;</span><span class="op" id="2328114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328120">p</span><span class="op" id="2328121">.</span><span class="builtinfunc" id="2328122">print</span><span class="op" id="2328127">(</span><span class="ident" id="2328128">x</span><span class="op" id="2328129">.</span><span class="ident" id="2328130">MapIndex</span><span class="op" id="2328138">(</span><span class="ident" id="2328139">key</span><span class="op" id="2328142">)</span><span class="op" id="2328143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328149">p</span><span class="op" id="2328150">.</span><span class="ident" id="2328151">printf</span><span class="op" id="2328157">(</span><span class="string" id="2328158">&#34;\n&#34;</span><span class="op" id="2328162">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328172">p</span><span class="op" id="2328173">.</span><span class="ident" id="2328174">indent</span><span class="op" id="2328180">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328189">p</span><span class="op" id="2328190">.</span><span class="ident" id="2328191">printf</span><span class="op" id="2328197">(</span><span class="string" id="2328198">&#34;}&#34;</span><span class="op" id="2328201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328205">case</span>&nbsp;<span class="ident" id="2328210">reflect</span><span class="op" id="2328217">.</span><span class="ident" id="2328218">Ptr</span><span class="op" id="2328221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328225">p</span><span class="op" id="2328226">.</span><span class="ident" id="2328227">printf</span><span class="op" id="2328233">(</span><span class="string" id="2328234">&#34;*&#34;</span><span class="op" id="2328237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2328241">//&nbsp;type-checked&nbsp;ASTs&nbsp;may&nbsp;contain&nbsp;cycles&nbsp;-&nbsp;use&nbsp;ptrmap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2328296">//&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;objects&nbsp;that&nbsp;have&nbsp;been&nbsp;printed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2328349">//&nbsp;already&nbsp;and&nbsp;print&nbsp;the&nbsp;respective&nbsp;line&nbsp;number&nbsp;instead</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328407">ptr</span>&nbsp;<span class="op" id="2328411">:=</span>&nbsp;<span class="ident" id="2328414">x</span><span class="op" id="2328415">.</span><span class="ident" id="2328416">Interface</span><span class="op" id="2328425">(</span><span class="op" id="2328426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328430">if</span>&nbsp;<span class="ident" id="2328433">line</span><span class="op" id="2328437">,</span>&nbsp;<span class="ident" id="2328439">exists</span>&nbsp;<span class="op" id="2328446">:=</span>&nbsp;<span class="ident" id="2328449">p</span><span class="op" id="2328450">.</span><span class="ident" id="2328451">ptrmap</span><span class="op" id="2328457">[</span><span class="ident" id="2328458">ptr</span><span class="op" id="2328461">]</span><span class="op" id="2328462">;</span>&nbsp;<span class="ident" id="2328464">exists</span>&nbsp;<span class="op" id="2328471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328476">p</span><span class="op" id="2328477">.</span><span class="ident" id="2328478">printf</span><span class="op" id="2328484">(</span><span class="string" id="2328485">&#34;(obj&nbsp;@&nbsp;%d)&#34;</span><span class="op" id="2328497">,</span>&nbsp;<span class="ident" id="2328499">line</span><span class="op" id="2328503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328507">}</span>&nbsp;<span class="keyword" id="2328509">else</span>&nbsp;<span class="op" id="2328514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328519">p</span><span class="op" id="2328520">.</span><span class="ident" id="2328521">ptrmap</span><span class="op" id="2328527">[</span><span class="ident" id="2328528">ptr</span><span class="op" id="2328531">]</span>&nbsp;<span class="op" id="2328533">=</span>&nbsp;<span class="ident" id="2328535">p</span><span class="op" id="2328536">.</span><span class="ident" id="2328537">line</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328545">p</span><span class="op" id="2328546">.</span><span class="builtinfunc" id="2328547">print</span><span class="op" id="2328552">(</span><span class="ident" id="2328553">x</span><span class="op" id="2328554">.</span><span class="ident" id="2328555">Elem</span><span class="op" id="2328559">(</span><span class="op" id="2328560">)</span><span class="op" id="2328561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328569">case</span>&nbsp;<span class="ident" id="2328574">reflect</span><span class="op" id="2328581">.</span><span class="ident" id="2328582">Array</span><span class="op" id="2328587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328591">p</span><span class="op" id="2328592">.</span><span class="ident" id="2328593">printf</span><span class="op" id="2328599">(</span><span class="string" id="2328600">&#34;%s&nbsp;{&#34;</span><span class="op" id="2328606">,</span>&nbsp;<span class="ident" id="2328608">x</span><span class="op" id="2328609">.</span><span class="ident" id="2328610">Type</span><span class="op" id="2328614">(</span><span class="op" id="2328615">)</span><span class="op" id="2328616">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328620">if</span>&nbsp;<span class="ident" id="2328623">x</span><span class="op" id="2328624">.</span><span class="ident" id="2328625">Len</span><span class="op" id="2328628">(</span><span class="op" id="2328629">)</span>&nbsp;<span class="op" id="2328631">&gt;</span>&nbsp;<span class="num" id="2328633">0</span>&nbsp;<span class="op" id="2328635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328640">p</span><span class="op" id="2328641">.</span><span class="ident" id="2328642">indent</span><span class="op" id="2328648">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328654">p</span><span class="op" id="2328655">.</span><span class="ident" id="2328656">printf</span><span class="op" id="2328662">(</span><span class="string" id="2328663">&#34;\n&#34;</span><span class="op" id="2328667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328672">for</span>&nbsp;<span class="ident" id="2328676">i</span><span class="op" id="2328677">,</span>&nbsp;<span class="ident" id="2328679">n</span>&nbsp;<span class="op" id="2328681">:=</span>&nbsp;<span class="num" id="2328684">0</span><span class="op" id="2328685">,</span>&nbsp;<span class="ident" id="2328687">x</span><span class="op" id="2328688">.</span><span class="ident" id="2328689">Len</span><span class="op" id="2328692">(</span><span class="op" id="2328693">)</span><span class="op" id="2328694">;</span>&nbsp;<span class="ident" id="2328696">i</span>&nbsp;<span class="op" id="2328698">&lt;</span>&nbsp;<span class="ident" id="2328700">n</span><span class="op" id="2328701">;</span>&nbsp;<span class="ident" id="2328703">i</span><span class="op" id="2328704">++</span>&nbsp;<span class="op" id="2328707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328713">p</span><span class="op" id="2328714">.</span><span class="ident" id="2328715">printf</span><span class="op" id="2328721">(</span><span class="string" id="2328722">&#34;%d:&nbsp;&#34;</span><span class="op" id="2328728">,</span>&nbsp;<span class="ident" id="2328730">i</span><span class="op" id="2328731">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328737">p</span><span class="op" id="2328738">.</span><span class="builtinfunc" id="2328739">print</span><span class="op" id="2328744">(</span><span class="ident" id="2328745">x</span><span class="op" id="2328746">.</span><span class="ident" id="2328747">Index</span><span class="op" id="2328752">(</span><span class="ident" id="2328753">i</span><span class="op" id="2328754">)</span><span class="op" id="2328755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328761">p</span><span class="op" id="2328762">.</span><span class="ident" id="2328763">printf</span><span class="op" id="2328769">(</span><span class="string" id="2328770">&#34;\n&#34;</span><span class="op" id="2328774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328784">p</span><span class="op" id="2328785">.</span><span class="ident" id="2328786">indent</span><span class="op" id="2328792">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328797">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328801">p</span><span class="op" id="2328802">.</span><span class="ident" id="2328803">printf</span><span class="op" id="2328809">(</span><span class="string" id="2328810">&#34;}&#34;</span><span class="op" id="2328813">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328817">case</span>&nbsp;<span class="ident" id="2328822">reflect</span><span class="op" id="2328829">.</span><span class="ident" id="2328830">Slice</span><span class="op" id="2328835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328839">if</span>&nbsp;<span class="ident" id="2328842">s</span><span class="op" id="2328843">,</span>&nbsp;<span class="ident" id="2328845">ok</span>&nbsp;<span class="op" id="2328848">:=</span>&nbsp;<span class="ident" id="2328851">x</span><span class="op" id="2328852">.</span><span class="ident" id="2328853">Interface</span><span class="op" id="2328862">(</span><span class="op" id="2328863">)</span><span class="op" id="2328864">.</span><span class="op" id="2328865">(</span><span class="op" id="2328866">[</span><span class="op" id="2328867">]</span><span class="builtintype" id="2328868">byte</span><span class="op" id="2328872">)</span><span class="op" id="2328873">;</span>&nbsp;<span class="ident" id="2328875">ok</span>&nbsp;<span class="op" id="2328878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328883">p</span><span class="op" id="2328884">.</span><span class="ident" id="2328885">printf</span><span class="op" id="2328891">(</span><span class="string" id="2328892">&#34;%#q&#34;</span><span class="op" id="2328897">,</span>&nbsp;<span class="ident" id="2328899">s</span><span class="op" id="2328900">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328905">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328918">p</span><span class="op" id="2328919">.</span><span class="ident" id="2328920">printf</span><span class="op" id="2328926">(</span><span class="string" id="2328927">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="2328944">,</span>&nbsp;<span class="ident" id="2328946">x</span><span class="op" id="2328947">.</span><span class="ident" id="2328948">Type</span><span class="op" id="2328952">(</span><span class="op" id="2328953">)</span><span class="op" id="2328954">,</span>&nbsp;<span class="ident" id="2328956">x</span><span class="op" id="2328957">.</span><span class="ident" id="2328958">Len</span><span class="op" id="2328961">(</span><span class="op" id="2328962">)</span><span class="op" id="2328963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328967">if</span>&nbsp;<span class="ident" id="2328970">x</span><span class="op" id="2328971">.</span><span class="ident" id="2328972">Len</span><span class="op" id="2328975">(</span><span class="op" id="2328976">)</span>&nbsp;<span class="op" id="2328978">&gt;</span>&nbsp;<span class="num" id="2328980">0</span>&nbsp;<span class="op" id="2328982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328987">p</span><span class="op" id="2328988">.</span><span class="ident" id="2328989">indent</span><span class="op" id="2328995">++</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329001">p</span><span class="op" id="2329002">.</span><span class="ident" id="2329003">printf</span><span class="op" id="2329009">(</span><span class="string" id="2329010">&#34;\n&#34;</span><span class="op" id="2329014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329019">for</span>&nbsp;<span class="ident" id="2329023">i</span><span class="op" id="2329024">,</span>&nbsp;<span class="ident" id="2329026">n</span>&nbsp;<span class="op" id="2329028">:=</span>&nbsp;<span class="num" id="2329031">0</span><span class="op" id="2329032">,</span>&nbsp;<span class="ident" id="2329034">x</span><span class="op" id="2329035">.</span><span class="ident" id="2329036">Len</span><span class="op" id="2329039">(</span><span class="op" id="2329040">)</span><span class="op" id="2329041">;</span>&nbsp;<span class="ident" id="2329043">i</span>&nbsp;<span class="op" id="2329045">&lt;</span>&nbsp;<span class="ident" id="2329047">n</span><span class="op" id="2329048">;</span>&nbsp;<span class="ident" id="2329050">i</span><span class="op" id="2329051">++</span>&nbsp;<span class="op" id="2329054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329060">p</span><span class="op" id="2329061">.</span><span class="ident" id="2329062">printf</span><span class="op" id="2329068">(</span><span class="string" id="2329069">&#34;%d:&nbsp;&#34;</span><span class="op" id="2329075">,</span>&nbsp;<span class="ident" id="2329077">i</span><span class="op" id="2329078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329084">p</span><span class="op" id="2329085">.</span><span class="builtinfunc" id="2329086">print</span><span class="op" id="2329091">(</span><span class="ident" id="2329092">x</span><span class="op" id="2329093">.</span><span class="ident" id="2329094">Index</span><span class="op" id="2329099">(</span><span class="ident" id="2329100">i</span><span class="op" id="2329101">)</span><span class="op" id="2329102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329108">p</span><span class="op" id="2329109">.</span><span class="ident" id="2329110">printf</span><span class="op" id="2329116">(</span><span class="string" id="2329117">&#34;\n&#34;</span><span class="op" id="2329121">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329131">p</span><span class="op" id="2329132">.</span><span class="ident" id="2329133">indent</span><span class="op" id="2329139">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329148">p</span><span class="op" id="2329149">.</span><span class="ident" id="2329150">printf</span><span class="op" id="2329156">(</span><span class="string" id="2329157">&#34;}&#34;</span><span class="op" id="2329160">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329164">case</span>&nbsp;<span class="ident" id="2329169">reflect</span><span class="op" id="2329176">.</span><span class="ident" id="2329177">Struct</span><span class="op" id="2329183">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329187">t</span>&nbsp;<span class="op" id="2329189">:=</span>&nbsp;<span class="ident" id="2329192">x</span><span class="op" id="2329193">.</span><span class="ident" id="2329194">Type</span><span class="op" id="2329198">(</span><span class="op" id="2329199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329203">p</span><span class="op" id="2329204">.</span><span class="ident" id="2329205">printf</span><span class="op" id="2329211">(</span><span class="string" id="2329212">&#34;%s&nbsp;{&#34;</span><span class="op" id="2329218">,</span>&nbsp;<span class="ident" id="2329220">t</span><span class="op" id="2329221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329225">p</span><span class="op" id="2329226">.</span><span class="ident" id="2329227">indent</span><span class="op" id="2329233">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329238">first</span>&nbsp;<span class="op" id="2329244">:=</span>&nbsp;<span class="builtintype" id="2329247">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329254">for</span>&nbsp;<span class="ident" id="2329258">i</span><span class="op" id="2329259">,</span>&nbsp;<span class="ident" id="2329261">n</span>&nbsp;<span class="op" id="2329263">:=</span>&nbsp;<span class="num" id="2329266">0</span><span class="op" id="2329267">,</span>&nbsp;<span class="ident" id="2329269">t</span><span class="op" id="2329270">.</span><span class="ident" id="2329271">NumField</span><span class="op" id="2329279">(</span><span class="op" id="2329280">)</span><span class="op" id="2329281">;</span>&nbsp;<span class="ident" id="2329283">i</span>&nbsp;<span class="op" id="2329285">&lt;</span>&nbsp;<span class="ident" id="2329287">n</span><span class="op" id="2329288">;</span>&nbsp;<span class="ident" id="2329290">i</span><span class="op" id="2329291">++</span>&nbsp;<span class="op" id="2329294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329299">//&nbsp;exclude&nbsp;non-exported&nbsp;fields&nbsp;because&nbsp;their</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329347">//&nbsp;values&nbsp;cannot&nbsp;be&nbsp;accessed&nbsp;via&nbsp;reflection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329394">if</span>&nbsp;<span class="ident" id="2329397">name</span>&nbsp;<span class="op" id="2329402">:=</span>&nbsp;<span class="ident" id="2329405">t</span><span class="op" id="2329406">.</span><span class="ident" id="2329407">Field</span><span class="op" id="2329412">(</span><span class="ident" id="2329413">i</span><span class="op" id="2329414">)</span><span class="op" id="2329415">.</span><span class="ident" id="2329416">Name</span><span class="op" id="2329420">;</span>&nbsp;<span class="ident" id="2329422">IsExported</span><span class="op" id="2329432">(</span><span class="ident" id="2329433">name</span><span class="op" id="2329437">)</span>&nbsp;<span class="op" id="2329439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329445">value</span>&nbsp;<span class="op" id="2329451">:=</span>&nbsp;<span class="ident" id="2329454">x</span><span class="op" id="2329455">.</span><span class="ident" id="2329456">Field</span><span class="op" id="2329461">(</span><span class="ident" id="2329462">i</span><span class="op" id="2329463">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329469">if</span>&nbsp;<span class="ident" id="2329472">p</span><span class="op" id="2329473">.</span><span class="ident" id="2329474">filter</span>&nbsp;<span class="op" id="2329481">==</span>&nbsp;<span class="ident" id="2329484">nil</span>&nbsp;<span class="op" id="2329488">||</span>&nbsp;<span class="ident" id="2329491">p</span><span class="op" id="2329492">.</span><span class="ident" id="2329493">filter</span><span class="op" id="2329499">(</span><span class="ident" id="2329500">name</span><span class="op" id="2329504">,</span>&nbsp;<span class="ident" id="2329506">value</span><span class="op" id="2329511">)</span>&nbsp;<span class="op" id="2329513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329520">if</span>&nbsp;<span class="ident" id="2329523">first</span>&nbsp;<span class="op" id="2329529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329537">p</span><span class="op" id="2329538">.</span><span class="ident" id="2329539">printf</span><span class="op" id="2329545">(</span><span class="string" id="2329546">&#34;\n&#34;</span><span class="op" id="2329550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329558">first</span>&nbsp;<span class="op" id="2329564">=</span>&nbsp;<span class="builtintype" id="2329566">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329577">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329584">p</span><span class="op" id="2329585">.</span><span class="ident" id="2329586">printf</span><span class="op" id="2329592">(</span><span class="string" id="2329593">&#34;%s:&nbsp;&#34;</span><span class="op" id="2329599">,</span>&nbsp;<span class="ident" id="2329601">name</span><span class="op" id="2329605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329612">p</span><span class="op" id="2329613">.</span><span class="builtinfunc" id="2329614">print</span><span class="op" id="2329619">(</span><span class="ident" id="2329620">value</span><span class="op" id="2329625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329632">p</span><span class="op" id="2329633">.</span><span class="ident" id="2329634">printf</span><span class="op" id="2329640">(</span><span class="string" id="2329641">&#34;\n&#34;</span><span class="op" id="2329645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329656">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329664">p</span><span class="op" id="2329665">.</span><span class="ident" id="2329666">indent</span><span class="op" id="2329672">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329677">p</span><span class="op" id="2329678">.</span><span class="ident" id="2329679">printf</span><span class="op" id="2329685">(</span><span class="string" id="2329686">&#34;}&#34;</span><span class="op" id="2329689">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329693">default</span><span class="op" id="2329700">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329704">v</span>&nbsp;<span class="op" id="2329706">:=</span>&nbsp;<span class="ident" id="2329709">x</span><span class="op" id="2329710">.</span><span class="ident" id="2329711">Interface</span><span class="op" id="2329720">(</span><span class="op" id="2329721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329725">switch</span>&nbsp;<span class="ident" id="2329732">v</span>&nbsp;<span class="op" id="2329734">:=</span>&nbsp;<span class="ident" id="2329737">v</span><span class="op" id="2329738">.</span><span class="op" id="2329739">(</span><span class="keyword" id="2329740">type</span><span class="op" id="2329744">)</span>&nbsp;<span class="op" id="2329746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329750">case</span>&nbsp;<span class="builtintype" id="2329755">string</span><span class="op" id="2329761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329766">//&nbsp;print&nbsp;strings&nbsp;in&nbsp;quotes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329796">p</span><span class="op" id="2329797">.</span><span class="ident" id="2329798">printf</span><span class="op" id="2329804">(</span><span class="string" id="2329805">&#34;%q&#34;</span><span class="op" id="2329809">,</span>&nbsp;<span class="ident" id="2329811">v</span><span class="op" id="2329812">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329817">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329826">case</span>&nbsp;<span class="ident" id="2329831">token</span><span class="op" id="2329836">.</span><span class="ident" id="2329837">Pos</span><span class="op" id="2329840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329845">//&nbsp;position&nbsp;values&nbsp;can&nbsp;be&nbsp;printed&nbsp;nicely&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329911">if</span>&nbsp;<span class="ident" id="2329914">p</span><span class="op" id="2329915">.</span><span class="ident" id="2329916">fset</span>&nbsp;<span class="op" id="2329921">!=</span>&nbsp;<span class="ident" id="2329924">nil</span>&nbsp;<span class="op" id="2329928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329934">p</span><span class="op" id="2329935">.</span><span class="ident" id="2329936">printf</span><span class="op" id="2329942">(</span><span class="string" id="2329943">&#34;%s&#34;</span><span class="op" id="2329947">,</span>&nbsp;<span class="ident" id="2329949">p</span><span class="op" id="2329950">.</span><span class="ident" id="2329951">fset</span><span class="op" id="2329955">.</span><span class="ident" id="2329956">Position</span><span class="op" id="2329964">(</span><span class="ident" id="2329965">v</span><span class="op" id="2329966">)</span><span class="op" id="2329967">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329973">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329991">//&nbsp;default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2330004">p</span><span class="op" id="2330005">.</span><span class="ident" id="2330006">printf</span><span class="op" id="2330012">(</span><span class="string" id="2330013">&#34;%v&#34;</span><span class="op" id="2330017">,</span>&nbsp;<span class="ident" id="2330019">v</span><span class="op" id="2330020">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2330023">}</span><br>
<span class="lineno"></span><span class="op" id="2330025">}</span>
</div>
</body>
</html>
