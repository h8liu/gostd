<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp/syntax</h2>
<ul>
<li><a href="/gostd/regexp/syntax/compile.go.html">compile.go</a></li>
<li><a href="/gostd/regexp/syntax/doc.go.html">doc.go</a></li>
<li><a href="/gostd/regexp/syntax/parse.go.html">parse.go</a></li>
<li><a href="/gostd/regexp/syntax/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/regexp/syntax/perl_groups.go.html">perl_groups.go</a></li>
<li><a href="/gostd/regexp/syntax/prog.go.html" class="current">prog.go</a></li>
<li><a href="/gostd/regexp/syntax/prog_test.go.html">prog_test.go</a></li>
<li><a href="/gostd/regexp/syntax/regexp.go.html">regexp.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify.go.html">simplify.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify_test.go.html">simplify_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5263197">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5263252">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5263306">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5263357">package</span>&nbsp;<span class="ident" id="5263365">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5263373">import</span>&nbsp;<span class="op" id="5263380">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5263383">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5263392">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5263403">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="5263413">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5263416">//&nbsp;Compiled&nbsp;program.</span><br>
<span class="lineno"></span><span class="comment" id="5263437">//&nbsp;May&nbsp;not&nbsp;belong&nbsp;in&nbsp;this&nbsp;package,&nbsp;but&nbsp;convenient&nbsp;for&nbsp;now.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5263497">//&nbsp;A&nbsp;Prog&nbsp;is&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="5263549">type</span>&nbsp;<span class="ident" id="5263554">Prog</span>&nbsp;<span class="keyword" id="5263559">struct</span>&nbsp;<span class="op" id="5263566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263569">Inst</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5263576">[</span><span class="op" id="5263577">]</span><span class="ident" id="5263578">Inst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263584">Start</span>&nbsp;&nbsp;<span class="builtintype" id="5263591">int</span>&nbsp;<span class="comment" id="5263595">//&nbsp;index&nbsp;of&nbsp;start&nbsp;instruction</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263626">NumCap</span>&nbsp;<span class="builtintype" id="5263633">int</span>&nbsp;<span class="comment" id="5263637">//&nbsp;number&nbsp;of&nbsp;InstCapture&nbsp;insts&nbsp;in&nbsp;re</span><br>
<span class="lineno"></span><span class="op" id="5263674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5263677">//&nbsp;An&nbsp;InstOp&nbsp;is&nbsp;an&nbsp;instruction&nbsp;opcode.</span><br>
<span class="lineno"></span><span class="keyword" id="5263716">type</span>&nbsp;<span class="ident" id="5263721">InstOp</span>&nbsp;<span class="builtintype" id="5263728">uint8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5263735">const</span>&nbsp;<span class="op" id="5263741">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263744">InstAlt</span>&nbsp;<span class="ident" id="5263752">InstOp</span>&nbsp;<span class="op" id="5263759">=</span>&nbsp;<span class="ident" id="5263761">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263767">InstAltMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263781">InstCapture</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263794">InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263810">InstMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263821">InstFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263831">InstNop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263840">InstRune</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263850">InstRune1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263861">InstRuneAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5263874">InstRuneAnyNotNL</span><br>
<span class="lineno"></span><span class="op" id="5263891">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="5263894">var</span>&nbsp;<span class="ident" id="5263898">instOpNames</span>&nbsp;<span class="op" id="5263910">=</span>&nbsp;<span class="op" id="5263912">[</span><span class="op" id="5263913">]</span><span class="builtintype" id="5263914">string</span><span class="op" id="5263920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5263923">&#34;InstAlt&#34;</span><span class="op" id="5263932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5263935">&#34;InstAltMatch&#34;</span><span class="op" id="5263949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5263952">&#34;InstCapture&#34;</span><span class="op" id="5263965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5263968">&#34;InstEmptyWidth&#34;</span><span class="op" id="5263984">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5263987">&#34;InstMatch&#34;</span><span class="op" id="5263998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5264001">&#34;InstFail&#34;</span><span class="op" id="5264011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5264014">&#34;InstNop&#34;</span><span class="op" id="5264023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5264026">&#34;InstRune&#34;</span><span class="op" id="5264036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5264039">&#34;InstRune1&#34;</span><span class="op" id="5264050">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5264053">&#34;InstRuneAny&#34;</span><span class="op" id="5264066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5264069">&#34;InstRuneAnyNotNL&#34;</span><span class="op" id="5264087">,</span><br>
<span class="lineno"></span><span class="op" id="5264089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5264092">func</span>&nbsp;<span class="op" id="5264097">(</span><span class="ident" id="5264098">i</span>&nbsp;<span class="ident" id="5264100">InstOp</span><span class="op" id="5264106">)</span>&nbsp;<span class="ident" id="5264108">String</span><span class="op" id="5264114">(</span><span class="op" id="5264115">)</span>&nbsp;<span class="builtintype" id="5264117">string</span>&nbsp;<span class="op" id="5264124">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264127">if</span>&nbsp;<span class="builtintype" id="5264130">uint</span><span class="op" id="5264134">(</span><span class="ident" id="5264135">i</span><span class="op" id="5264136">)</span>&nbsp;<span class="op" id="5264138">&gt;=</span>&nbsp;<span class="builtintype" id="5264141">uint</span><span class="op" id="5264145">(</span><span class="builtinfunc" id="5264146">len</span><span class="op" id="5264149">(</span><span class="ident" id="5264150">instOpNames</span><span class="op" id="5264161">)</span><span class="op" id="5264162">)</span>&nbsp;<span class="op" id="5264164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264168">return</span>&nbsp;<span class="string" id="5264175">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5264179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264182">return</span>&nbsp;<span class="ident" id="5264189">instOpNames</span><span class="op" id="5264200">[</span><span class="ident" id="5264201">i</span><span class="op" id="5264202">]</span><br>
<span class="lineno"></span><span class="op" id="5264204">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5264207">//&nbsp;An&nbsp;EmptyOp&nbsp;specifies&nbsp;a&nbsp;kind&nbsp;or&nbsp;mixture&nbsp;of&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="keyword" id="5264275">type</span>&nbsp;<span class="ident" id="5264280">EmptyOp</span>&nbsp;<span class="builtintype" id="5264288">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5264295">const</span>&nbsp;<span class="op" id="5264301">(</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264304">EmptyBeginLine</span>&nbsp;<span class="ident" id="5264319">EmptyOp</span>&nbsp;<span class="op" id="5264327">=</span>&nbsp;<span class="num" id="5264329">1</span>&nbsp;<span class="op" id="5264331">&lt;&lt;</span>&nbsp;<span class="ident" id="5264334">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264340">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264354">EmptyBeginText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264370">EmptyEndText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264384">EmptyWordBoundary</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264403">EmptyNoWordBoundary</span><br>
<span class="lineno"></span><span class="op" id="5264423">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5264426">//&nbsp;EmptyOpContext&nbsp;returns&nbsp;the&nbsp;zero-width&nbsp;assertions</span><br>
<span class="lineno"></span><span class="comment" id="5264478">//&nbsp;satisfied&nbsp;at&nbsp;the&nbsp;position&nbsp;between&nbsp;the&nbsp;runes&nbsp;r1&nbsp;and&nbsp;r2.</span><br>
<span class="lineno">75</span><span class="comment" id="5264536">//&nbsp;Passing&nbsp;r1&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5264587">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5264620">//&nbsp;Passing&nbsp;r2&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5264671">//&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="5264698">func</span>&nbsp;<span class="ident" id="5264703">EmptyOpContext</span><span class="op" id="5264717">(</span><span class="ident" id="5264718">r1</span><span class="op" id="5264720">,</span>&nbsp;<span class="ident" id="5264722">r2</span>&nbsp;<span class="builtintype" id="5264725">rune</span><span class="op" id="5264729">)</span>&nbsp;<span class="ident" id="5264731">EmptyOp</span>&nbsp;<span class="op" id="5264739">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264742">var</span>&nbsp;<span class="ident" id="5264746">op</span>&nbsp;<span class="ident" id="5264749">EmptyOp</span>&nbsp;<span class="op" id="5264757">=</span>&nbsp;<span class="ident" id="5264759">EmptyNoWordBoundary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264780">var</span>&nbsp;<span class="ident" id="5264784">boundary</span>&nbsp;<span class="builtintype" id="5264793">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264799">switch</span>&nbsp;<span class="op" id="5264806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264809">case</span>&nbsp;<span class="ident" id="5264814">IsWordChar</span><span class="op" id="5264824">(</span><span class="ident" id="5264825">r1</span><span class="op" id="5264827">)</span><span class="op" id="5264828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264832">boundary</span>&nbsp;<span class="op" id="5264841">=</span>&nbsp;<span class="num" id="5264843">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264846">case</span>&nbsp;<span class="ident" id="5264851">r1</span>&nbsp;<span class="op" id="5264854">==</span>&nbsp;<span class="string" id="5264857">&#39;\n&#39;</span><span class="op" id="5264861">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264865">op</span>&nbsp;<span class="op" id="5264868">|=</span>&nbsp;<span class="ident" id="5264871">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264887">case</span>&nbsp;<span class="ident" id="5264892">r1</span>&nbsp;<span class="op" id="5264895">&lt;</span>&nbsp;<span class="num" id="5264897">0</span><span class="op" id="5264898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264902">op</span>&nbsp;<span class="op" id="5264905">|=</span>&nbsp;<span class="ident" id="5264908">EmptyBeginText</span>&nbsp;<span class="op" id="5264923">|</span>&nbsp;<span class="ident" id="5264925">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5264941">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264944">switch</span>&nbsp;<span class="op" id="5264951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264954">case</span>&nbsp;<span class="ident" id="5264959">IsWordChar</span><span class="op" id="5264969">(</span><span class="ident" id="5264970">r2</span><span class="op" id="5264972">)</span><span class="op" id="5264973">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5264977">boundary</span>&nbsp;<span class="op" id="5264986">^=</span>&nbsp;<span class="num" id="5264989">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5264992">case</span>&nbsp;<span class="ident" id="5264997">r2</span>&nbsp;<span class="op" id="5265000">==</span>&nbsp;<span class="string" id="5265003">&#39;\n&#39;</span><span class="op" id="5265007">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5265011">op</span>&nbsp;<span class="op" id="5265014">|=</span>&nbsp;<span class="ident" id="5265017">EmptyEndLine</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5265031">case</span>&nbsp;<span class="ident" id="5265036">r2</span>&nbsp;<span class="op" id="5265039">&lt;</span>&nbsp;<span class="num" id="5265041">0</span><span class="op" id="5265042">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5265046">op</span>&nbsp;<span class="op" id="5265049">|=</span>&nbsp;<span class="ident" id="5265052">EmptyEndText</span>&nbsp;<span class="op" id="5265065">|</span>&nbsp;<span class="ident" id="5265067">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5265081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5265084">if</span>&nbsp;<span class="ident" id="5265087">boundary</span>&nbsp;<span class="op" id="5265096">!=</span>&nbsp;<span class="num" id="5265099">0</span>&nbsp;<span class="op" id="5265101">{</span>&nbsp;<span class="comment" id="5265103">//&nbsp;IsWordChar(r1)&nbsp;!=&nbsp;IsWordChar(r2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5265141">op</span>&nbsp;<span class="op" id="5265144">^=</span>&nbsp;<span class="op" id="5265147">(</span><span class="ident" id="5265148">EmptyWordBoundary</span>&nbsp;<span class="op" id="5265166">|</span>&nbsp;<span class="ident" id="5265168">EmptyNoWordBoundary</span><span class="op" id="5265187">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5265190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5265193">return</span>&nbsp;<span class="ident" id="5265200">op</span><br>
<span class="lineno"></span><span class="op" id="5265203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5265206">//&nbsp;IsWordChar&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;consider&nbsp;a&nbsp;``word&nbsp;character&#39;&#39;</span><br>
<span class="lineno">105</span><span class="comment" id="5265271">//&nbsp;during&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;the&nbsp;\b&nbsp;and&nbsp;\B&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="comment" id="5265336">//&nbsp;These&nbsp;assertions&nbsp;are&nbsp;ASCII-only:&nbsp;the&nbsp;word&nbsp;characters&nbsp;are&nbsp;[A-Za-z0-9_].</span><br>
<span class="lineno"></span><span class="keyword" id="5265410">func</span>&nbsp;<span class="ident" id="5265415">IsWordChar</span><span class="op" id="5265425">(</span><span class="ident" id="5265426">r</span>&nbsp;<span class="builtintype" id="5265428">rune</span><span class="op" id="5265432">)</span>&nbsp;<span class="builtintype" id="5265434">bool</span>&nbsp;<span class="op" id="5265439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5265442">return</span>&nbsp;<span class="string" id="5265449">&#39;A&#39;</span>&nbsp;<span class="op" id="5265453">&lt;=</span>&nbsp;<span class="ident" id="5265456">r</span>&nbsp;<span class="op" id="5265458">&amp;&amp;</span>&nbsp;<span class="ident" id="5265461">r</span>&nbsp;<span class="op" id="5265463">&lt;=</span>&nbsp;<span class="string" id="5265466">&#39;Z&#39;</span>&nbsp;<span class="op" id="5265470">||</span>&nbsp;<span class="string" id="5265473">&#39;a&#39;</span>&nbsp;<span class="op" id="5265477">&lt;=</span>&nbsp;<span class="ident" id="5265480">r</span>&nbsp;<span class="op" id="5265482">&amp;&amp;</span>&nbsp;<span class="ident" id="5265485">r</span>&nbsp;<span class="op" id="5265487">&lt;=</span>&nbsp;<span class="string" id="5265490">&#39;z&#39;</span>&nbsp;<span class="op" id="5265494">||</span>&nbsp;<span class="string" id="5265497">&#39;0&#39;</span>&nbsp;<span class="op" id="5265501">&lt;=</span>&nbsp;<span class="ident" id="5265504">r</span>&nbsp;<span class="op" id="5265506">&amp;&amp;</span>&nbsp;<span class="ident" id="5265509">r</span>&nbsp;<span class="op" id="5265511">&lt;=</span>&nbsp;<span class="string" id="5265514">&#39;9&#39;</span>&nbsp;<span class="op" id="5265518">||</span>&nbsp;<span class="ident" id="5265521">r</span>&nbsp;<span class="op" id="5265523">==</span>&nbsp;<span class="string" id="5265526">&#39;_&#39;</span><br>
<span class="lineno"></span><span class="op" id="5265530">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5265533">//&nbsp;An&nbsp;Inst&nbsp;is&nbsp;a&nbsp;single&nbsp;instruction&nbsp;in&nbsp;a&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="5265601">type</span>&nbsp;<span class="ident" id="5265606">Inst</span>&nbsp;<span class="keyword" id="5265611">struct</span>&nbsp;<span class="op" id="5265618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5265621">Op</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5265626">InstOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5265634">Out</span>&nbsp;&nbsp;<span class="builtintype" id="5265639">uint32</span>&nbsp;<span class="comment" id="5265646">//&nbsp;all&nbsp;but&nbsp;InstMatch,&nbsp;InstFail</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5265678">Arg</span>&nbsp;&nbsp;<span class="builtintype" id="5265683">uint32</span>&nbsp;<span class="comment" id="5265690">//&nbsp;InstAlt,&nbsp;InstAltMatch,&nbsp;InstCapture,&nbsp;InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5265745">Rune</span>&nbsp;<span class="op" id="5265750">[</span><span class="op" id="5265751">]</span><span class="builtintype" id="5265752">rune</span><br>
<span class="lineno"></span><span class="op" id="5265757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5265760">func</span>&nbsp;<span class="op" id="5265765">(</span><span class="ident" id="5265766">p</span>&nbsp;<span class="op" id="5265768">*</span><span class="ident" id="5265769">Prog</span><span class="op" id="5265773">)</span>&nbsp;<span class="ident" id="5265775">String</span><span class="op" id="5265781">(</span><span class="op" id="5265782">)</span>&nbsp;<span class="builtintype" id="5265784">string</span>&nbsp;<span class="op" id="5265791">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5265794">var</span>&nbsp;<span class="ident" id="5265798">b</span>&nbsp;<span class="ident" id="5265800">bytes</span><span class="op" id="5265805">.</span><span class="ident" id="5265806">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5265814">dumpProg</span><span class="op" id="5265822">(</span><span class="op" id="5265823">&amp;</span><span class="ident" id="5265824">b</span><span class="op" id="5265825">,</span>&nbsp;<span class="ident" id="5265827">p</span><span class="op" id="5265828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5265831">return</span>&nbsp;<span class="ident" id="5265838">b</span><span class="op" id="5265839">.</span><span class="ident" id="5265840">String</span><span class="op" id="5265846">(</span><span class="op" id="5265847">)</span><br>
<span class="lineno"></span><span class="op" id="5265849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5265852">//&nbsp;skipNop&nbsp;follows&nbsp;any&nbsp;no-op&nbsp;or&nbsp;capturing&nbsp;instructions</span><br>
<span class="lineno"></span><span class="comment" id="5265907">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;pc.</span><br>
<span class="lineno"></span><span class="keyword" id="5265940">func</span>&nbsp;<span class="op" id="5265945">(</span><span class="ident" id="5265946">p</span>&nbsp;<span class="op" id="5265948">*</span><span class="ident" id="5265949">Prog</span><span class="op" id="5265953">)</span>&nbsp;<span class="ident" id="5265955">skipNop</span><span class="op" id="5265962">(</span><span class="ident" id="5265963">pc</span>&nbsp;<span class="builtintype" id="5265966">uint32</span><span class="op" id="5265972">)</span>&nbsp;<span class="op" id="5265974">(</span><span class="op" id="5265975">*</span><span class="ident" id="5265976">Inst</span><span class="op" id="5265980">,</span>&nbsp;<span class="builtintype" id="5265982">uint32</span><span class="op" id="5265988">)</span>&nbsp;<span class="op" id="5265990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5265993">i</span>&nbsp;<span class="op" id="5265995">:=</span>&nbsp;<span class="op" id="5265998">&amp;</span><span class="ident" id="5265999">p</span><span class="op" id="5266000">.</span><span class="ident" id="5266001">Inst</span><span class="op" id="5266005">[</span><span class="ident" id="5266006">pc</span><span class="op" id="5266008">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266011">for</span>&nbsp;<span class="ident" id="5266015">i</span><span class="op" id="5266016">.</span><span class="ident" id="5266017">Op</span>&nbsp;<span class="op" id="5266020">==</span>&nbsp;<span class="ident" id="5266023">InstNop</span>&nbsp;<span class="op" id="5266031">||</span>&nbsp;<span class="ident" id="5266034">i</span><span class="op" id="5266035">.</span><span class="ident" id="5266036">Op</span>&nbsp;<span class="op" id="5266039">==</span>&nbsp;<span class="ident" id="5266042">InstCapture</span>&nbsp;<span class="op" id="5266054">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5266058">pc</span>&nbsp;<span class="op" id="5266061">=</span>&nbsp;<span class="ident" id="5266063">i</span><span class="op" id="5266064">.</span><span class="ident" id="5266065">Out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5266071">i</span>&nbsp;<span class="op" id="5266073">=</span>&nbsp;<span class="op" id="5266075">&amp;</span><span class="ident" id="5266076">p</span><span class="op" id="5266077">.</span><span class="ident" id="5266078">Inst</span><span class="op" id="5266082">[</span><span class="ident" id="5266083">pc</span><span class="op" id="5266085">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5266088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266091">return</span>&nbsp;<span class="ident" id="5266098">i</span><span class="op" id="5266099">,</span>&nbsp;<span class="ident" id="5266101">pc</span><br>
<span class="lineno"></span><span class="op" id="5266104">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="5266107">//&nbsp;op&nbsp;returns&nbsp;i.Op&nbsp;but&nbsp;merges&nbsp;all&nbsp;the&nbsp;Rune&nbsp;special&nbsp;cases&nbsp;into&nbsp;InstRune</span><br>
<span class="lineno"></span><span class="keyword" id="5266178">func</span>&nbsp;<span class="op" id="5266183">(</span><span class="ident" id="5266184">i</span>&nbsp;<span class="op" id="5266186">*</span><span class="ident" id="5266187">Inst</span><span class="op" id="5266191">)</span>&nbsp;<span class="ident" id="5266193">op</span><span class="op" id="5266195">(</span><span class="op" id="5266196">)</span>&nbsp;<span class="ident" id="5266198">InstOp</span>&nbsp;<span class="op" id="5266205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5266208">op</span>&nbsp;<span class="op" id="5266211">:=</span>&nbsp;<span class="ident" id="5266214">i</span><span class="op" id="5266215">.</span><span class="ident" id="5266216">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266220">switch</span>&nbsp;<span class="ident" id="5266227">op</span>&nbsp;<span class="op" id="5266230">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266233">case</span>&nbsp;<span class="ident" id="5266238">InstRune1</span><span class="op" id="5266247">,</span>&nbsp;<span class="ident" id="5266249">InstRuneAny</span><span class="op" id="5266260">,</span>&nbsp;<span class="ident" id="5266262">InstRuneAnyNotNL</span><span class="op" id="5266278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5266282">op</span>&nbsp;<span class="op" id="5266285">=</span>&nbsp;<span class="ident" id="5266287">InstRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5266297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266300">return</span>&nbsp;<span class="ident" id="5266307">op</span><br>
<span class="lineno"></span><span class="op" id="5266310">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="5266313">//&nbsp;Prefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;all&nbsp;matches&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5266373">//&nbsp;regexp&nbsp;must&nbsp;start&nbsp;with.&nbsp;&nbsp;Complete&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="5266432">//&nbsp;is&nbsp;the&nbsp;entire&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5266456">func</span>&nbsp;<span class="op" id="5266461">(</span><span class="ident" id="5266462">p</span>&nbsp;<span class="op" id="5266464">*</span><span class="ident" id="5266465">Prog</span><span class="op" id="5266469">)</span>&nbsp;<span class="ident" id="5266471">Prefix</span><span class="op" id="5266477">(</span><span class="op" id="5266478">)</span>&nbsp;<span class="op" id="5266480">(</span><span class="ident" id="5266481">prefix</span>&nbsp;<span class="builtintype" id="5266488">string</span><span class="op" id="5266494">,</span>&nbsp;<span class="ident" id="5266496">complete</span>&nbsp;<span class="builtintype" id="5266505">bool</span><span class="op" id="5266509">)</span>&nbsp;<span class="op" id="5266511">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5266514">i</span><span class="op" id="5266515">,</span>&nbsp;<span class="ident" id="5266517">_</span>&nbsp;<span class="op" id="5266519">:=</span>&nbsp;<span class="ident" id="5266522">p</span><span class="op" id="5266523">.</span><span class="ident" id="5266524">skipNop</span><span class="op" id="5266531">(</span><span class="builtintype" id="5266532">uint32</span><span class="op" id="5266538">(</span><span class="ident" id="5266539">p</span><span class="op" id="5266540">.</span><span class="ident" id="5266541">Start</span><span class="op" id="5266546">)</span><span class="op" id="5266547">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5266551">//&nbsp;Avoid&nbsp;allocation&nbsp;of&nbsp;buffer&nbsp;if&nbsp;prefix&nbsp;is&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266602">if</span>&nbsp;<span class="ident" id="5266605">i</span><span class="op" id="5266606">.</span><span class="ident" id="5266607">op</span><span class="op" id="5266609">(</span><span class="op" id="5266610">)</span>&nbsp;<span class="op" id="5266612">!=</span>&nbsp;<span class="ident" id="5266615">InstRune</span>&nbsp;<span class="op" id="5266624">||</span>&nbsp;<span class="builtinfunc" id="5266627">len</span><span class="op" id="5266630">(</span><span class="ident" id="5266631">i</span><span class="op" id="5266632">.</span><span class="ident" id="5266633">Rune</span><span class="op" id="5266637">)</span>&nbsp;<span class="op" id="5266639">!=</span>&nbsp;<span class="num" id="5266642">1</span>&nbsp;<span class="op" id="5266644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266648">return</span>&nbsp;<span class="string" id="5266655">&#34;&#34;</span><span class="op" id="5266657">,</span>&nbsp;<span class="ident" id="5266659">i</span><span class="op" id="5266660">.</span><span class="ident" id="5266661">Op</span>&nbsp;<span class="op" id="5266664">==</span>&nbsp;<span class="ident" id="5266667">InstMatch</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5266678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5266682">//&nbsp;Have&nbsp;prefix;&nbsp;gather&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266718">var</span>&nbsp;<span class="ident" id="5266722">buf</span>&nbsp;<span class="ident" id="5266726">bytes</span><span class="op" id="5266731">.</span><span class="ident" id="5266732">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266740">for</span>&nbsp;<span class="ident" id="5266744">i</span><span class="op" id="5266745">.</span><span class="ident" id="5266746">op</span><span class="op" id="5266748">(</span><span class="op" id="5266749">)</span>&nbsp;<span class="op" id="5266751">==</span>&nbsp;<span class="ident" id="5266754">InstRune</span>&nbsp;<span class="op" id="5266763">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5266766">len</span><span class="op" id="5266769">(</span><span class="ident" id="5266770">i</span><span class="op" id="5266771">.</span><span class="ident" id="5266772">Rune</span><span class="op" id="5266776">)</span>&nbsp;<span class="op" id="5266778">==</span>&nbsp;<span class="num" id="5266781">1</span>&nbsp;<span class="op" id="5266783">&amp;&amp;</span>&nbsp;<span class="ident" id="5266786">Flags</span><span class="op" id="5266791">(</span><span class="ident" id="5266792">i</span><span class="op" id="5266793">.</span><span class="ident" id="5266794">Arg</span><span class="op" id="5266797">)</span><span class="op" id="5266798">&amp;</span><span class="ident" id="5266799">FoldCase</span>&nbsp;<span class="op" id="5266808">==</span>&nbsp;<span class="num" id="5266811">0</span>&nbsp;<span class="op" id="5266813">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5266817">buf</span><span class="op" id="5266820">.</span><span class="ident" id="5266821">WriteRune</span><span class="op" id="5266830">(</span><span class="ident" id="5266831">i</span><span class="op" id="5266832">.</span><span class="ident" id="5266833">Rune</span><span class="op" id="5266837">[</span><span class="num" id="5266838">0</span><span class="op" id="5266839">]</span><span class="op" id="5266840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5266844">i</span><span class="op" id="5266845">,</span>&nbsp;<span class="ident" id="5266847">_</span>&nbsp;<span class="op" id="5266849">=</span>&nbsp;<span class="ident" id="5266851">p</span><span class="op" id="5266852">.</span><span class="ident" id="5266853">skipNop</span><span class="op" id="5266860">(</span><span class="ident" id="5266861">i</span><span class="op" id="5266862">.</span><span class="ident" id="5266863">Out</span><span class="op" id="5266866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5266869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5266872">return</span>&nbsp;<span class="ident" id="5266879">buf</span><span class="op" id="5266882">.</span><span class="ident" id="5266883">String</span><span class="op" id="5266889">(</span><span class="op" id="5266890">)</span><span class="op" id="5266891">,</span>&nbsp;<span class="ident" id="5266893">i</span><span class="op" id="5266894">.</span><span class="ident" id="5266895">Op</span>&nbsp;<span class="op" id="5266898">==</span>&nbsp;<span class="ident" id="5266901">InstMatch</span><br>
<span class="lineno"></span><span class="op" id="5266911">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="5266914">//&nbsp;StartCond&nbsp;returns&nbsp;the&nbsp;leading&nbsp;empty-width&nbsp;conditions&nbsp;that&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="5266980">//&nbsp;be&nbsp;true&nbsp;in&nbsp;any&nbsp;match.&nbsp;&nbsp;It&nbsp;returns&nbsp;^EmptyOp(0)&nbsp;if&nbsp;no&nbsp;matches&nbsp;are&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="5267057">func</span>&nbsp;<span class="op" id="5267062">(</span><span class="ident" id="5267063">p</span>&nbsp;<span class="op" id="5267065">*</span><span class="ident" id="5267066">Prog</span><span class="op" id="5267070">)</span>&nbsp;<span class="ident" id="5267072">StartCond</span><span class="op" id="5267081">(</span><span class="op" id="5267082">)</span>&nbsp;<span class="ident" id="5267084">EmptyOp</span>&nbsp;<span class="op" id="5267092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267095">var</span>&nbsp;<span class="ident" id="5267099">flag</span>&nbsp;<span class="ident" id="5267104">EmptyOp</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5267113">pc</span>&nbsp;<span class="op" id="5267116">:=</span>&nbsp;<span class="builtintype" id="5267119">uint32</span><span class="op" id="5267125">(</span><span class="ident" id="5267126">p</span><span class="op" id="5267127">.</span><span class="ident" id="5267128">Start</span><span class="op" id="5267133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5267136">i</span>&nbsp;<span class="op" id="5267138">:=</span>&nbsp;<span class="op" id="5267141">&amp;</span><span class="ident" id="5267142">p</span><span class="op" id="5267143">.</span><span class="ident" id="5267144">Inst</span><span class="op" id="5267148">[</span><span class="ident" id="5267149">pc</span><span class="op" id="5267151">]</span><br>
<span class="lineno"></span><span class="ident" id="5267153">Loop</span><span class="op" id="5267157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267160">for</span>&nbsp;<span class="op" id="5267164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267168">switch</span>&nbsp;<span class="ident" id="5267175">i</span><span class="op" id="5267176">.</span><span class="ident" id="5267177">Op</span>&nbsp;<span class="op" id="5267180">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267184">case</span>&nbsp;<span class="ident" id="5267189">InstEmptyWidth</span><span class="op" id="5267203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5267208">flag</span>&nbsp;<span class="op" id="5267213">|=</span>&nbsp;<span class="ident" id="5267216">EmptyOp</span><span class="op" id="5267223">(</span><span class="ident" id="5267224">i</span><span class="op" id="5267225">.</span><span class="ident" id="5267226">Arg</span><span class="op" id="5267229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267233">case</span>&nbsp;<span class="ident" id="5267238">InstFail</span><span class="op" id="5267246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267251">return</span>&nbsp;<span class="op" id="5267258">^</span><span class="ident" id="5267259">EmptyOp</span><span class="op" id="5267266">(</span><span class="num" id="5267267">0</span><span class="op" id="5267268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267272">case</span>&nbsp;<span class="ident" id="5267277">InstCapture</span><span class="op" id="5267288">,</span>&nbsp;<span class="ident" id="5267290">InstNop</span><span class="op" id="5267297">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5267302">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267312">default</span><span class="op" id="5267319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267324">break</span>&nbsp;<span class="ident" id="5267330">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5267337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5267341">pc</span>&nbsp;<span class="op" id="5267344">=</span>&nbsp;<span class="ident" id="5267346">i</span><span class="op" id="5267347">.</span><span class="ident" id="5267348">Out</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5267354">i</span>&nbsp;<span class="op" id="5267356">=</span>&nbsp;<span class="op" id="5267358">&amp;</span><span class="ident" id="5267359">p</span><span class="op" id="5267360">.</span><span class="ident" id="5267361">Inst</span><span class="op" id="5267365">[</span><span class="ident" id="5267366">pc</span><span class="op" id="5267368">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5267371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267374">return</span>&nbsp;<span class="ident" id="5267381">flag</span><br>
<span class="lineno"></span><span class="op" id="5267386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="5267389">const</span>&nbsp;<span class="ident" id="5267395">noMatch</span>&nbsp;<span class="op" id="5267403">=</span>&nbsp;<span class="op" id="5267405">-</span><span class="num" id="5267406">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5267409">//&nbsp;MatchRune&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5267480">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="5267531">func</span>&nbsp;<span class="op" id="5267536">(</span><span class="ident" id="5267537">i</span>&nbsp;<span class="op" id="5267539">*</span><span class="ident" id="5267540">Inst</span><span class="op" id="5267544">)</span>&nbsp;<span class="ident" id="5267546">MatchRune</span><span class="op" id="5267555">(</span><span class="ident" id="5267556">r</span>&nbsp;<span class="builtintype" id="5267558">rune</span><span class="op" id="5267562">)</span>&nbsp;<span class="builtintype" id="5267564">bool</span>&nbsp;<span class="op" id="5267569">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5267572">return</span>&nbsp;<span class="ident" id="5267579">i</span><span class="op" id="5267580">.</span><span class="ident" id="5267581">MatchRunePos</span><span class="op" id="5267593">(</span><span class="ident" id="5267594">r</span><span class="op" id="5267595">)</span>&nbsp;<span class="op" id="5267597">!=</span>&nbsp;<span class="ident" id="5267600">noMatch</span><br>
<span class="lineno"></span><span class="op" id="5267608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5267611">//&nbsp;MatchRunePos&nbsp;checks&nbsp;whether&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5267684">//&nbsp;If&nbsp;so,&nbsp;MatchRunePos&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;matching&nbsp;rune&nbsp;pair</span><br>
<span class="lineno">200</span><span class="comment" id="5267751">//&nbsp;(or,&nbsp;when&nbsp;len(i.Rune)&nbsp;==&nbsp;1,&nbsp;rune&nbsp;singleton).</span><br>
<span class="lineno"></span><span class="comment" id="5267799">//&nbsp;If&nbsp;not,&nbsp;MatchRunePos&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="comment" id="5267835">//&nbsp;MatchRunePos&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="5267896">func</span>&nbsp;<span class="op" id="5267901">(</span><span class="ident" id="5267902">i</span>&nbsp;<span class="op" id="5267904">*</span><span class="ident" id="5267905">Inst</span><span class="op" id="5267909">)</span>&nbsp;<span class="ident" id="5267911">MatchRunePos</span><span class="op" id="5267923">(</span><span class="ident" id="5267924">r</span>&nbsp;<span class="builtintype" id="5267926">rune</span><span class="op" id="5267930">)</span>&nbsp;<span class="builtintype" id="5267932">int</span>&nbsp;<span class="op" id="5267936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5267939">rune</span>&nbsp;<span class="op" id="5267944">:=</span>&nbsp;<span class="ident" id="5267947">i</span><span class="op" id="5267948">.</span><span class="ident" id="5267949">Rune</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5267956">//&nbsp;Special&nbsp;case:&nbsp;single-rune&nbsp;slice&nbsp;is&nbsp;from&nbsp;literal&nbsp;string,&nbsp;not&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268032">if</span>&nbsp;<span class="builtinfunc" id="5268035">len</span><span class="op" id="5268038">(</span><span class="builtintype" id="5268039">rune</span><span class="op" id="5268043">)</span>&nbsp;<span class="op" id="5268045">==</span>&nbsp;<span class="num" id="5268048">1</span>&nbsp;<span class="op" id="5268050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5268054">r0</span>&nbsp;<span class="op" id="5268057">:=</span>&nbsp;<span class="builtintype" id="5268060">rune</span><span class="op" id="5268064">[</span><span class="num" id="5268065">0</span><span class="op" id="5268066">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268070">if</span>&nbsp;<span class="ident" id="5268073">r</span>&nbsp;<span class="op" id="5268075">==</span>&nbsp;<span class="ident" id="5268078">r0</span>&nbsp;<span class="op" id="5268081">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268086">return</span>&nbsp;<span class="num" id="5268093">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268101">if</span>&nbsp;<span class="ident" id="5268104">Flags</span><span class="op" id="5268109">(</span><span class="ident" id="5268110">i</span><span class="op" id="5268111">.</span><span class="ident" id="5268112">Arg</span><span class="op" id="5268115">)</span><span class="op" id="5268116">&amp;</span><span class="ident" id="5268117">FoldCase</span>&nbsp;<span class="op" id="5268126">!=</span>&nbsp;<span class="num" id="5268129">0</span>&nbsp;<span class="op" id="5268131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268136">for</span>&nbsp;<span class="ident" id="5268140">r1</span>&nbsp;<span class="op" id="5268143">:=</span>&nbsp;<span class="ident" id="5268146">unicode</span><span class="op" id="5268153">.</span><span class="ident" id="5268154">SimpleFold</span><span class="op" id="5268164">(</span><span class="ident" id="5268165">r0</span><span class="op" id="5268167">)</span><span class="op" id="5268168">;</span>&nbsp;<span class="ident" id="5268170">r1</span>&nbsp;<span class="op" id="5268173">!=</span>&nbsp;<span class="ident" id="5268176">r0</span><span class="op" id="5268178">;</span>&nbsp;<span class="ident" id="5268180">r1</span>&nbsp;<span class="op" id="5268183">=</span>&nbsp;<span class="ident" id="5268185">unicode</span><span class="op" id="5268192">.</span><span class="ident" id="5268193">SimpleFold</span><span class="op" id="5268203">(</span><span class="ident" id="5268204">r1</span><span class="op" id="5268206">)</span>&nbsp;<span class="op" id="5268208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268214">if</span>&nbsp;<span class="ident" id="5268217">r</span>&nbsp;<span class="op" id="5268219">==</span>&nbsp;<span class="ident" id="5268222">r1</span>&nbsp;<span class="op" id="5268225">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268232">return</span>&nbsp;<span class="num" id="5268239">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268258">return</span>&nbsp;<span class="ident" id="5268265">noMatch</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5268278">//&nbsp;Peek&nbsp;at&nbsp;the&nbsp;first&nbsp;few&nbsp;pairs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5268311">//&nbsp;Should&nbsp;handle&nbsp;ASCII&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268341">for</span>&nbsp;<span class="ident" id="5268345">j</span>&nbsp;<span class="op" id="5268347">:=</span>&nbsp;<span class="num" id="5268350">0</span><span class="op" id="5268351">;</span>&nbsp;<span class="ident" id="5268353">j</span>&nbsp;<span class="op" id="5268355">&lt;</span>&nbsp;<span class="builtinfunc" id="5268357">len</span><span class="op" id="5268360">(</span><span class="builtintype" id="5268361">rune</span><span class="op" id="5268365">)</span>&nbsp;<span class="op" id="5268367">&amp;&amp;</span>&nbsp;<span class="ident" id="5268370">j</span>&nbsp;<span class="op" id="5268372">&lt;=</span>&nbsp;<span class="num" id="5268375">8</span><span class="op" id="5268376">;</span>&nbsp;<span class="ident" id="5268378">j</span>&nbsp;<span class="op" id="5268380">+=</span>&nbsp;<span class="num" id="5268383">2</span>&nbsp;<span class="op" id="5268385">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268389">if</span>&nbsp;<span class="ident" id="5268392">r</span>&nbsp;<span class="op" id="5268394">&lt;</span>&nbsp;<span class="builtintype" id="5268396">rune</span><span class="op" id="5268400">[</span><span class="ident" id="5268401">j</span><span class="op" id="5268402">]</span>&nbsp;<span class="op" id="5268404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268409">return</span>&nbsp;<span class="ident" id="5268416">noMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268430">if</span>&nbsp;<span class="ident" id="5268433">r</span>&nbsp;<span class="op" id="5268435">&lt;=</span>&nbsp;<span class="builtintype" id="5268438">rune</span><span class="op" id="5268442">[</span><span class="ident" id="5268443">j</span><span class="op" id="5268444">+</span><span class="num" id="5268445">1</span><span class="op" id="5268446">]</span>&nbsp;<span class="op" id="5268448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268453">return</span>&nbsp;<span class="ident" id="5268460">j</span>&nbsp;<span class="op" id="5268462">/</span>&nbsp;<span class="num" id="5268464">2</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5268475">//&nbsp;Otherwise&nbsp;binary&nbsp;search.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5268504">lo</span>&nbsp;<span class="op" id="5268507">:=</span>&nbsp;<span class="num" id="5268510">0</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5268513">hi</span>&nbsp;<span class="op" id="5268516">:=</span>&nbsp;<span class="builtinfunc" id="5268519">len</span><span class="op" id="5268522">(</span><span class="builtintype" id="5268523">rune</span><span class="op" id="5268527">)</span>&nbsp;<span class="op" id="5268529">/</span>&nbsp;<span class="num" id="5268531">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268534">for</span>&nbsp;<span class="ident" id="5268538">lo</span>&nbsp;<span class="op" id="5268541">&lt;</span>&nbsp;<span class="ident" id="5268543">hi</span>&nbsp;<span class="op" id="5268546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5268550">m</span>&nbsp;<span class="op" id="5268552">:=</span>&nbsp;<span class="ident" id="5268555">lo</span>&nbsp;<span class="op" id="5268558">+</span>&nbsp;<span class="op" id="5268560">(</span><span class="ident" id="5268561">hi</span><span class="op" id="5268563">-</span><span class="ident" id="5268564">lo</span><span class="op" id="5268566">)</span><span class="op" id="5268567">/</span><span class="num" id="5268568">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268572">if</span>&nbsp;<span class="ident" id="5268575">c</span>&nbsp;<span class="op" id="5268577">:=</span>&nbsp;<span class="builtintype" id="5268580">rune</span><span class="op" id="5268584">[</span><span class="num" id="5268585">2</span><span class="op" id="5268586">*</span><span class="ident" id="5268587">m</span><span class="op" id="5268588">]</span><span class="op" id="5268589">;</span>&nbsp;<span class="ident" id="5268591">c</span>&nbsp;<span class="op" id="5268593">&lt;=</span>&nbsp;<span class="ident" id="5268596">r</span>&nbsp;<span class="op" id="5268598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268603">if</span>&nbsp;<span class="ident" id="5268606">r</span>&nbsp;<span class="op" id="5268608">&lt;=</span>&nbsp;<span class="builtintype" id="5268611">rune</span><span class="op" id="5268615">[</span><span class="num" id="5268616">2</span><span class="op" id="5268617">*</span><span class="ident" id="5268618">m</span><span class="op" id="5268619">+</span><span class="num" id="5268620">1</span><span class="op" id="5268621">]</span>&nbsp;<span class="op" id="5268623">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268629">return</span>&nbsp;<span class="ident" id="5268636">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5268646">lo</span>&nbsp;<span class="op" id="5268649">=</span>&nbsp;<span class="ident" id="5268651">m</span>&nbsp;<span class="op" id="5268653">+</span>&nbsp;<span class="num" id="5268655">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268659">}</span>&nbsp;<span class="keyword" id="5268661">else</span>&nbsp;<span class="op" id="5268666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5268671">hi</span>&nbsp;<span class="op" id="5268674">=</span>&nbsp;<span class="ident" id="5268676">m</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268686">return</span>&nbsp;<span class="ident" id="5268693">noMatch</span><br>
<span class="lineno"></span><span class="op" id="5268701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="5268704">//&nbsp;As&nbsp;per&nbsp;re2&#39;s&nbsp;Prog::IsWordChar.&nbsp;Determines&nbsp;whether&nbsp;rune&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;word&nbsp;char.</span><br>
<span class="lineno"></span><span class="comment" id="5268785">//&nbsp;Since&nbsp;we&nbsp;act&nbsp;on&nbsp;runes,&nbsp;it&nbsp;would&nbsp;be&nbsp;easy&nbsp;to&nbsp;support&nbsp;Unicode&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="5268853">func</span>&nbsp;<span class="ident" id="5268858">wordRune</span><span class="op" id="5268866">(</span><span class="ident" id="5268867">r</span>&nbsp;<span class="builtintype" id="5268869">rune</span><span class="op" id="5268873">)</span>&nbsp;<span class="builtintype" id="5268875">bool</span>&nbsp;<span class="op" id="5268880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5268883">return</span>&nbsp;<span class="ident" id="5268890">r</span>&nbsp;<span class="op" id="5268892">==</span>&nbsp;<span class="string" id="5268895">&#39;_&#39;</span>&nbsp;<span class="op" id="5268899">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268904">(</span><span class="string" id="5268905">&#39;A&#39;</span>&nbsp;<span class="op" id="5268909">&lt;=</span>&nbsp;<span class="ident" id="5268912">r</span>&nbsp;<span class="op" id="5268914">&amp;&amp;</span>&nbsp;<span class="ident" id="5268917">r</span>&nbsp;<span class="op" id="5268919">&lt;=</span>&nbsp;<span class="string" id="5268922">&#39;Z&#39;</span><span class="op" id="5268925">)</span>&nbsp;<span class="op" id="5268927">||</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268932">(</span><span class="string" id="5268933">&#39;a&#39;</span>&nbsp;<span class="op" id="5268937">&lt;=</span>&nbsp;<span class="ident" id="5268940">r</span>&nbsp;<span class="op" id="5268942">&amp;&amp;</span>&nbsp;<span class="ident" id="5268945">r</span>&nbsp;<span class="op" id="5268947">&lt;=</span>&nbsp;<span class="string" id="5268950">&#39;z&#39;</span><span class="op" id="5268953">)</span>&nbsp;<span class="op" id="5268955">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5268960">(</span><span class="string" id="5268961">&#39;0&#39;</span>&nbsp;<span class="op" id="5268965">&lt;=</span>&nbsp;<span class="ident" id="5268968">r</span>&nbsp;<span class="op" id="5268970">&amp;&amp;</span>&nbsp;<span class="ident" id="5268973">r</span>&nbsp;<span class="op" id="5268975">&lt;=</span>&nbsp;<span class="string" id="5268978">&#39;9&#39;</span><span class="op" id="5268981">)</span><br>
<span class="lineno"></span><span class="op" id="5268983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5268986">//&nbsp;MatchEmptyWidth&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches</span><br>
<span class="lineno">260</span><span class="comment" id="5269045">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;between&nbsp;the&nbsp;runes&nbsp;before&nbsp;and&nbsp;after.</span><br>
<span class="lineno"></span><span class="comment" id="5269100">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstEmptyWidth.</span><br>
<span class="lineno"></span><span class="keyword" id="5269157">func</span>&nbsp;<span class="op" id="5269162">(</span><span class="ident" id="5269163">i</span>&nbsp;<span class="op" id="5269165">*</span><span class="ident" id="5269166">Inst</span><span class="op" id="5269170">)</span>&nbsp;<span class="ident" id="5269172">MatchEmptyWidth</span><span class="op" id="5269187">(</span><span class="ident" id="5269188">before</span>&nbsp;<span class="builtintype" id="5269195">rune</span><span class="op" id="5269199">,</span>&nbsp;<span class="ident" id="5269201">after</span>&nbsp;<span class="builtintype" id="5269207">rune</span><span class="op" id="5269211">)</span>&nbsp;<span class="builtintype" id="5269213">bool</span>&nbsp;<span class="op" id="5269218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269221">switch</span>&nbsp;<span class="ident" id="5269228">EmptyOp</span><span class="op" id="5269235">(</span><span class="ident" id="5269236">i</span><span class="op" id="5269237">.</span><span class="ident" id="5269238">Arg</span><span class="op" id="5269241">)</span>&nbsp;<span class="op" id="5269243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269246">case</span>&nbsp;<span class="ident" id="5269251">EmptyBeginLine</span><span class="op" id="5269265">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269269">return</span>&nbsp;<span class="ident" id="5269276">before</span>&nbsp;<span class="op" id="5269283">==</span>&nbsp;<span class="string" id="5269286">&#39;\n&#39;</span>&nbsp;<span class="op" id="5269291">||</span>&nbsp;<span class="ident" id="5269294">before</span>&nbsp;<span class="op" id="5269301">==</span>&nbsp;<span class="op" id="5269304">-</span><span class="num" id="5269305">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269308">case</span>&nbsp;<span class="ident" id="5269313">EmptyEndLine</span><span class="op" id="5269325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269329">return</span>&nbsp;<span class="ident" id="5269336">after</span>&nbsp;<span class="op" id="5269342">==</span>&nbsp;<span class="string" id="5269345">&#39;\n&#39;</span>&nbsp;<span class="op" id="5269350">||</span>&nbsp;<span class="ident" id="5269353">after</span>&nbsp;<span class="op" id="5269359">==</span>&nbsp;<span class="op" id="5269362">-</span><span class="num" id="5269363">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269366">case</span>&nbsp;<span class="ident" id="5269371">EmptyBeginText</span><span class="op" id="5269385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269389">return</span>&nbsp;<span class="ident" id="5269396">before</span>&nbsp;<span class="op" id="5269403">==</span>&nbsp;<span class="op" id="5269406">-</span><span class="num" id="5269407">1</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269410">case</span>&nbsp;<span class="ident" id="5269415">EmptyEndText</span><span class="op" id="5269427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269431">return</span>&nbsp;<span class="ident" id="5269438">after</span>&nbsp;<span class="op" id="5269444">==</span>&nbsp;<span class="op" id="5269447">-</span><span class="num" id="5269448">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269451">case</span>&nbsp;<span class="ident" id="5269456">EmptyWordBoundary</span><span class="op" id="5269473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269477">return</span>&nbsp;<span class="ident" id="5269484">wordRune</span><span class="op" id="5269492">(</span><span class="ident" id="5269493">before</span><span class="op" id="5269499">)</span>&nbsp;<span class="op" id="5269501">!=</span>&nbsp;<span class="ident" id="5269504">wordRune</span><span class="op" id="5269512">(</span><span class="ident" id="5269513">after</span><span class="op" id="5269518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269521">case</span>&nbsp;<span class="ident" id="5269526">EmptyNoWordBoundary</span><span class="op" id="5269545">:</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269549">return</span>&nbsp;<span class="ident" id="5269556">wordRune</span><span class="op" id="5269564">(</span><span class="ident" id="5269565">before</span><span class="op" id="5269571">)</span>&nbsp;<span class="op" id="5269573">==</span>&nbsp;<span class="ident" id="5269576">wordRune</span><span class="op" id="5269584">(</span><span class="ident" id="5269585">after</span><span class="op" id="5269590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5269593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5269596">panic</span><span class="op" id="5269601">(</span><span class="string" id="5269602">&#34;unknown&nbsp;empty&nbsp;width&nbsp;arg&#34;</span><span class="op" id="5269627">)</span><br>
<span class="lineno"></span><span class="op" id="5269629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="5269632">func</span>&nbsp;<span class="op" id="5269637">(</span><span class="ident" id="5269638">i</span>&nbsp;<span class="op" id="5269640">*</span><span class="ident" id="5269641">Inst</span><span class="op" id="5269645">)</span>&nbsp;<span class="ident" id="5269647">String</span><span class="op" id="5269653">(</span><span class="op" id="5269654">)</span>&nbsp;<span class="builtintype" id="5269656">string</span>&nbsp;<span class="op" id="5269663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269666">var</span>&nbsp;<span class="ident" id="5269670">b</span>&nbsp;<span class="ident" id="5269672">bytes</span><span class="op" id="5269677">.</span><span class="ident" id="5269678">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5269686">dumpInst</span><span class="op" id="5269694">(</span><span class="op" id="5269695">&amp;</span><span class="ident" id="5269696">b</span><span class="op" id="5269697">,</span>&nbsp;<span class="ident" id="5269699">i</span><span class="op" id="5269700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269703">return</span>&nbsp;<span class="ident" id="5269710">b</span><span class="op" id="5269711">.</span><span class="ident" id="5269712">String</span><span class="op" id="5269718">(</span><span class="op" id="5269719">)</span><br>
<span class="lineno"></span><span class="op" id="5269721">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="5269724">func</span>&nbsp;<span class="ident" id="5269729">bw</span><span class="op" id="5269731">(</span><span class="ident" id="5269732">b</span>&nbsp;<span class="op" id="5269734">*</span><span class="ident" id="5269735">bytes</span><span class="op" id="5269740">.</span><span class="ident" id="5269741">Buffer</span><span class="op" id="5269747">,</span>&nbsp;<span class="ident" id="5269749">args</span>&nbsp;<span class="op" id="5269754">...</span><span class="builtintype" id="5269757">string</span><span class="op" id="5269763">)</span>&nbsp;<span class="op" id="5269765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269768">for</span>&nbsp;<span class="ident" id="5269772">_</span><span class="op" id="5269773">,</span>&nbsp;<span class="ident" id="5269775">s</span>&nbsp;<span class="op" id="5269777">:=</span>&nbsp;<span class="keyword" id="5269780">range</span>&nbsp;<span class="ident" id="5269786">args</span>&nbsp;<span class="op" id="5269791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5269795">b</span><span class="op" id="5269796">.</span><span class="ident" id="5269797">WriteString</span><span class="op" id="5269808">(</span><span class="ident" id="5269809">s</span><span class="op" id="5269810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5269813">}</span><br>
<span class="lineno">290</span><span class="op" id="5269815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5269818">func</span>&nbsp;<span class="ident" id="5269823">dumpProg</span><span class="op" id="5269831">(</span><span class="ident" id="5269832">b</span>&nbsp;<span class="op" id="5269834">*</span><span class="ident" id="5269835">bytes</span><span class="op" id="5269840">.</span><span class="ident" id="5269841">Buffer</span><span class="op" id="5269847">,</span>&nbsp;<span class="ident" id="5269849">p</span>&nbsp;<span class="op" id="5269851">*</span><span class="ident" id="5269852">Prog</span><span class="op" id="5269856">)</span>&nbsp;<span class="op" id="5269858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269861">for</span>&nbsp;<span class="ident" id="5269865">j</span>&nbsp;<span class="op" id="5269867">:=</span>&nbsp;<span class="keyword" id="5269870">range</span>&nbsp;<span class="ident" id="5269876">p</span><span class="op" id="5269877">.</span><span class="ident" id="5269878">Inst</span>&nbsp;<span class="op" id="5269883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5269887">i</span>&nbsp;<span class="op" id="5269889">:=</span>&nbsp;<span class="op" id="5269892">&amp;</span><span class="ident" id="5269893">p</span><span class="op" id="5269894">.</span><span class="ident" id="5269895">Inst</span><span class="op" id="5269899">[</span><span class="ident" id="5269900">j</span><span class="op" id="5269901">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5269905">pc</span>&nbsp;<span class="op" id="5269908">:=</span>&nbsp;<span class="ident" id="5269911">strconv</span><span class="op" id="5269918">.</span><span class="ident" id="5269919">Itoa</span><span class="op" id="5269923">(</span><span class="ident" id="5269924">j</span><span class="op" id="5269925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269929">if</span>&nbsp;<span class="builtinfunc" id="5269932">len</span><span class="op" id="5269935">(</span><span class="ident" id="5269936">pc</span><span class="op" id="5269938">)</span>&nbsp;<span class="op" id="5269940">&lt;</span>&nbsp;<span class="num" id="5269942">3</span>&nbsp;<span class="op" id="5269944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5269949">b</span><span class="op" id="5269950">.</span><span class="ident" id="5269951">WriteString</span><span class="op" id="5269962">(</span><span class="string" id="5269963">&#34;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="5269968">[</span><span class="builtinfunc" id="5269969">len</span><span class="op" id="5269972">(</span><span class="ident" id="5269973">pc</span><span class="op" id="5269975">)</span><span class="op" id="5269976">:</span><span class="op" id="5269977">]</span><span class="op" id="5269978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5269982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5269986">if</span>&nbsp;<span class="ident" id="5269989">j</span>&nbsp;<span class="op" id="5269991">==</span>&nbsp;<span class="ident" id="5269994">p</span><span class="op" id="5269995">.</span><span class="ident" id="5269996">Start</span>&nbsp;<span class="op" id="5270002">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270007">pc</span>&nbsp;<span class="op" id="5270010">+=</span>&nbsp;<span class="string" id="5270013">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5270019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270023">bw</span><span class="op" id="5270025">(</span><span class="ident" id="5270026">b</span><span class="op" id="5270027">,</span>&nbsp;<span class="ident" id="5270029">pc</span><span class="op" id="5270031">,</span>&nbsp;<span class="string" id="5270033">&#34;\t&#34;</span><span class="op" id="5270037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270041">dumpInst</span><span class="op" id="5270049">(</span><span class="ident" id="5270050">b</span><span class="op" id="5270051">,</span>&nbsp;<span class="ident" id="5270053">i</span><span class="op" id="5270054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270058">bw</span><span class="op" id="5270060">(</span><span class="ident" id="5270061">b</span><span class="op" id="5270062">,</span>&nbsp;<span class="string" id="5270064">&#34;\n&#34;</span><span class="op" id="5270068">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5270071">}</span><br>
<span class="lineno"></span><span class="op" id="5270073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5270076">func</span>&nbsp;<span class="ident" id="5270081">u32</span><span class="op" id="5270084">(</span><span class="ident" id="5270085">i</span>&nbsp;<span class="builtintype" id="5270087">uint32</span><span class="op" id="5270093">)</span>&nbsp;<span class="builtintype" id="5270095">string</span>&nbsp;<span class="op" id="5270102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270105">return</span>&nbsp;<span class="ident" id="5270112">strconv</span><span class="op" id="5270119">.</span><span class="ident" id="5270120">FormatUint</span><span class="op" id="5270130">(</span><span class="ident" id="5270131">uint64</span><span class="op" id="5270137">(</span><span class="ident" id="5270138">i</span><span class="op" id="5270139">)</span><span class="op" id="5270140">,</span>&nbsp;<span class="num" id="5270142">10</span><span class="op" id="5270144">)</span><br>
<span class="lineno">310</span><span class="op" id="5270146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5270149">func</span>&nbsp;<span class="ident" id="5270154">dumpInst</span><span class="op" id="5270162">(</span><span class="ident" id="5270163">b</span>&nbsp;<span class="op" id="5270165">*</span><span class="ident" id="5270166">bytes</span><span class="op" id="5270171">.</span><span class="ident" id="5270172">Buffer</span><span class="op" id="5270178">,</span>&nbsp;<span class="ident" id="5270180">i</span>&nbsp;<span class="op" id="5270182">*</span><span class="ident" id="5270183">Inst</span><span class="op" id="5270187">)</span>&nbsp;<span class="op" id="5270189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270192">switch</span>&nbsp;<span class="ident" id="5270199">i</span><span class="op" id="5270200">.</span><span class="ident" id="5270201">Op</span>&nbsp;<span class="op" id="5270204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270207">case</span>&nbsp;<span class="ident" id="5270212">InstAlt</span><span class="op" id="5270219">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270223">bw</span><span class="op" id="5270225">(</span><span class="ident" id="5270226">b</span><span class="op" id="5270227">,</span>&nbsp;<span class="string" id="5270229">&#34;alt&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5270238">,</span>&nbsp;<span class="ident" id="5270240">u32</span><span class="op" id="5270243">(</span><span class="ident" id="5270244">i</span><span class="op" id="5270245">.</span><span class="ident" id="5270246">Out</span><span class="op" id="5270249">)</span><span class="op" id="5270250">,</span>&nbsp;<span class="string" id="5270252">&#34;,&nbsp;&#34;</span><span class="op" id="5270256">,</span>&nbsp;<span class="ident" id="5270258">u32</span><span class="op" id="5270261">(</span><span class="ident" id="5270262">i</span><span class="op" id="5270263">.</span><span class="ident" id="5270264">Arg</span><span class="op" id="5270267">)</span><span class="op" id="5270268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270271">case</span>&nbsp;<span class="ident" id="5270276">InstAltMatch</span><span class="op" id="5270288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270292">bw</span><span class="op" id="5270294">(</span><span class="ident" id="5270295">b</span><span class="op" id="5270296">,</span>&nbsp;<span class="string" id="5270298">&#34;altmatch&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5270312">,</span>&nbsp;<span class="ident" id="5270314">u32</span><span class="op" id="5270317">(</span><span class="ident" id="5270318">i</span><span class="op" id="5270319">.</span><span class="ident" id="5270320">Out</span><span class="op" id="5270323">)</span><span class="op" id="5270324">,</span>&nbsp;<span class="string" id="5270326">&#34;,&nbsp;&#34;</span><span class="op" id="5270330">,</span>&nbsp;<span class="ident" id="5270332">u32</span><span class="op" id="5270335">(</span><span class="ident" id="5270336">i</span><span class="op" id="5270337">.</span><span class="ident" id="5270338">Arg</span><span class="op" id="5270341">)</span><span class="op" id="5270342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270345">case</span>&nbsp;<span class="ident" id="5270350">InstCapture</span><span class="op" id="5270361">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270365">bw</span><span class="op" id="5270367">(</span><span class="ident" id="5270368">b</span><span class="op" id="5270369">,</span>&nbsp;<span class="string" id="5270371">&#34;cap&nbsp;&#34;</span><span class="op" id="5270377">,</span>&nbsp;<span class="ident" id="5270379">u32</span><span class="op" id="5270382">(</span><span class="ident" id="5270383">i</span><span class="op" id="5270384">.</span><span class="ident" id="5270385">Arg</span><span class="op" id="5270388">)</span><span class="op" id="5270389">,</span>&nbsp;<span class="string" id="5270391">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5270397">,</span>&nbsp;<span class="ident" id="5270399">u32</span><span class="op" id="5270402">(</span><span class="ident" id="5270403">i</span><span class="op" id="5270404">.</span><span class="ident" id="5270405">Out</span><span class="op" id="5270408">)</span><span class="op" id="5270409">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270412">case</span>&nbsp;<span class="ident" id="5270417">InstEmptyWidth</span><span class="op" id="5270431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270435">bw</span><span class="op" id="5270437">(</span><span class="ident" id="5270438">b</span><span class="op" id="5270439">,</span>&nbsp;<span class="string" id="5270441">&#34;empty&nbsp;&#34;</span><span class="op" id="5270449">,</span>&nbsp;<span class="ident" id="5270451">u32</span><span class="op" id="5270454">(</span><span class="ident" id="5270455">i</span><span class="op" id="5270456">.</span><span class="ident" id="5270457">Arg</span><span class="op" id="5270460">)</span><span class="op" id="5270461">,</span>&nbsp;<span class="string" id="5270463">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5270469">,</span>&nbsp;<span class="ident" id="5270471">u32</span><span class="op" id="5270474">(</span><span class="ident" id="5270475">i</span><span class="op" id="5270476">.</span><span class="ident" id="5270477">Out</span><span class="op" id="5270480">)</span><span class="op" id="5270481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270484">case</span>&nbsp;<span class="ident" id="5270489">InstMatch</span><span class="op" id="5270498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270502">bw</span><span class="op" id="5270504">(</span><span class="ident" id="5270505">b</span><span class="op" id="5270506">,</span>&nbsp;<span class="string" id="5270508">&#34;match&#34;</span><span class="op" id="5270515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270518">case</span>&nbsp;<span class="ident" id="5270523">InstFail</span><span class="op" id="5270531">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270535">bw</span><span class="op" id="5270537">(</span><span class="ident" id="5270538">b</span><span class="op" id="5270539">,</span>&nbsp;<span class="string" id="5270541">&#34;fail&#34;</span><span class="op" id="5270547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270550">case</span>&nbsp;<span class="ident" id="5270555">InstNop</span><span class="op" id="5270562">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270566">bw</span><span class="op" id="5270568">(</span><span class="ident" id="5270569">b</span><span class="op" id="5270570">,</span>&nbsp;<span class="string" id="5270572">&#34;nop&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5270581">,</span>&nbsp;<span class="ident" id="5270583">u32</span><span class="op" id="5270586">(</span><span class="ident" id="5270587">i</span><span class="op" id="5270588">.</span><span class="ident" id="5270589">Out</span><span class="op" id="5270592">)</span><span class="op" id="5270593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270596">case</span>&nbsp;<span class="ident" id="5270601">InstRune</span><span class="op" id="5270609">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270613">if</span>&nbsp;<span class="ident" id="5270616">i</span><span class="op" id="5270617">.</span><span class="ident" id="5270618">Rune</span>&nbsp;<span class="op" id="5270623">==</span>&nbsp;<span class="builtintype" id="5270626">nil</span>&nbsp;<span class="op" id="5270630">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5270635">//&nbsp;shouldn&#39;t&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270658">bw</span><span class="op" id="5270660">(</span><span class="ident" id="5270661">b</span><span class="op" id="5270662">,</span>&nbsp;<span class="string" id="5270664">&#34;rune&nbsp;&lt;nil&gt;&#34;</span><span class="op" id="5270676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5270680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270684">bw</span><span class="op" id="5270686">(</span><span class="ident" id="5270687">b</span><span class="op" id="5270688">,</span>&nbsp;<span class="string" id="5270690">&#34;rune&nbsp;&#34;</span><span class="op" id="5270697">,</span>&nbsp;<span class="ident" id="5270699">strconv</span><span class="op" id="5270706">.</span><span class="ident" id="5270707">QuoteToASCII</span><span class="op" id="5270719">(</span><span class="builtintype" id="5270720">string</span><span class="op" id="5270726">(</span><span class="ident" id="5270727">i</span><span class="op" id="5270728">.</span><span class="ident" id="5270729">Rune</span><span class="op" id="5270733">)</span><span class="op" id="5270734">)</span><span class="op" id="5270735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270739">if</span>&nbsp;<span class="ident" id="5270742">Flags</span><span class="op" id="5270747">(</span><span class="ident" id="5270748">i</span><span class="op" id="5270749">.</span><span class="ident" id="5270750">Arg</span><span class="op" id="5270753">)</span><span class="op" id="5270754">&amp;</span><span class="ident" id="5270755">FoldCase</span>&nbsp;<span class="op" id="5270764">!=</span>&nbsp;<span class="num" id="5270767">0</span>&nbsp;<span class="op" id="5270769">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270774">bw</span><span class="op" id="5270776">(</span><span class="ident" id="5270777">b</span><span class="op" id="5270778">,</span>&nbsp;<span class="string" id="5270780">&#34;/i&#34;</span><span class="op" id="5270784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5270788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270792">bw</span><span class="op" id="5270794">(</span><span class="ident" id="5270795">b</span><span class="op" id="5270796">,</span>&nbsp;<span class="string" id="5270798">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5270804">,</span>&nbsp;<span class="ident" id="5270806">u32</span><span class="op" id="5270809">(</span><span class="ident" id="5270810">i</span><span class="op" id="5270811">.</span><span class="ident" id="5270812">Out</span><span class="op" id="5270815">)</span><span class="op" id="5270816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270819">case</span>&nbsp;<span class="ident" id="5270824">InstRune1</span><span class="op" id="5270833">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270837">bw</span><span class="op" id="5270839">(</span><span class="ident" id="5270840">b</span><span class="op" id="5270841">,</span>&nbsp;<span class="string" id="5270843">&#34;rune1&nbsp;&#34;</span><span class="op" id="5270851">,</span>&nbsp;<span class="ident" id="5270853">strconv</span><span class="op" id="5270860">.</span><span class="ident" id="5270861">QuoteToASCII</span><span class="op" id="5270873">(</span><span class="builtintype" id="5270874">string</span><span class="op" id="5270880">(</span><span class="ident" id="5270881">i</span><span class="op" id="5270882">.</span><span class="ident" id="5270883">Rune</span><span class="op" id="5270887">)</span><span class="op" id="5270888">)</span><span class="op" id="5270889">,</span>&nbsp;<span class="string" id="5270891">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5270897">,</span>&nbsp;<span class="ident" id="5270899">u32</span><span class="op" id="5270902">(</span><span class="ident" id="5270903">i</span><span class="op" id="5270904">.</span><span class="ident" id="5270905">Out</span><span class="op" id="5270908">)</span><span class="op" id="5270909">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270912">case</span>&nbsp;<span class="ident" id="5270917">InstRuneAny</span><span class="op" id="5270928">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270932">bw</span><span class="op" id="5270934">(</span><span class="ident" id="5270935">b</span><span class="op" id="5270936">,</span>&nbsp;<span class="string" id="5270938">&#34;any&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5270947">,</span>&nbsp;<span class="ident" id="5270949">u32</span><span class="op" id="5270952">(</span><span class="ident" id="5270953">i</span><span class="op" id="5270954">.</span><span class="ident" id="5270955">Out</span><span class="op" id="5270958">)</span><span class="op" id="5270959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5270962">case</span>&nbsp;<span class="ident" id="5270967">InstRuneAnyNotNL</span><span class="op" id="5270983">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5270987">bw</span><span class="op" id="5270989">(</span><span class="ident" id="5270990">b</span><span class="op" id="5270991">,</span>&nbsp;<span class="string" id="5270993">&#34;anynotnl&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5271007">,</span>&nbsp;<span class="ident" id="5271009">u32</span><span class="op" id="5271012">(</span><span class="ident" id="5271013">i</span><span class="op" id="5271014">.</span><span class="ident" id="5271015">Out</span><span class="op" id="5271018">)</span><span class="op" id="5271019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5271022">}</span><br>
<span class="lineno">345</span><span class="op" id="5271024">}</span>
</div>
</body>
</html>
