<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3725404">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3725459">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3725513">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3725564">//&nbsp;Package&nbsp;subtle&nbsp;implements&nbsp;functions&nbsp;that&nbsp;are&nbsp;often&nbsp;useful&nbsp;in&nbsp;cryptographic</span><br>
<span class="lineno"></span><span class="comment" id="3725642">//&nbsp;code&nbsp;but&nbsp;require&nbsp;careful&nbsp;thought&nbsp;to&nbsp;use&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="3725696">package</span>&nbsp;<span class="ident" id="3725704">subtle</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3725712">//&nbsp;ConstantTimeCompare&nbsp;returns&nbsp;1&nbsp;iff&nbsp;the&nbsp;two&nbsp;slices,&nbsp;x</span><br>
<span class="lineno">10</span><span class="comment" id="3725767">//&nbsp;and&nbsp;y,&nbsp;have&nbsp;equal&nbsp;contents.&nbsp;The&nbsp;time&nbsp;taken&nbsp;is&nbsp;a&nbsp;function&nbsp;of&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3725844">//&nbsp;the&nbsp;slices&nbsp;and&nbsp;is&nbsp;independent&nbsp;of&nbsp;the&nbsp;contents.</span><br>
<span class="lineno"></span><span class="keyword" id="3725894">func</span>&nbsp;<span class="ident" id="3725899">ConstantTimeCompare</span><span class="op" id="3725918">(</span><span class="ident" id="3725919">x</span><span class="op" id="3725920">,</span>&nbsp;<span class="ident" id="3725922">y</span>&nbsp;<span class="op" id="3725924">[</span><span class="op" id="3725925">]</span><span class="builtintype" id="3725926">byte</span><span class="op" id="3725930">)</span>&nbsp;<span class="builtintype" id="3725932">int</span>&nbsp;<span class="op" id="3725936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725939">if</span>&nbsp;<span class="builtinfunc" id="3725942">len</span><span class="op" id="3725945">(</span><span class="ident" id="3725946"><a href="/crypto/subtle/constant_time.go.html#3725919">x</a></span><span class="op" id="3725947">)</span>&nbsp;<span class="op" id="3725949">!=</span>&nbsp;<span class="builtinfunc" id="3725952">len</span><span class="op" id="3725955">(</span><span class="ident" id="3725956"><a href="/crypto/subtle/constant_time.go.html#3725922">y</a></span><span class="op" id="3725957">)</span>&nbsp;<span class="op" id="3725959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725963">return</span>&nbsp;<span class="num" id="3725970">0</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3725973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725977">var</span>&nbsp;<span class="ident" id="3725981">v</span>&nbsp;<span class="builtintype" id="3725983">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725990">for</span>&nbsp;<span class="ident" id="3725994">i</span>&nbsp;<span class="op" id="3725996">:=</span>&nbsp;<span class="num" id="3725999">0</span><span class="op" id="3726000">;</span>&nbsp;<span class="ident" id="3726002"><a href="/crypto/subtle/constant_time.go.html#3725994">i</a></span>&nbsp;<span class="op" id="3726004">&lt;</span>&nbsp;<span class="builtinfunc" id="3726006">len</span><span class="op" id="3726009">(</span><span class="ident" id="3726010"><a href="/crypto/subtle/constant_time.go.html#3725919">x</a></span><span class="op" id="3726011">)</span><span class="op" id="3726012">;</span>&nbsp;<span class="ident" id="3726014"><a href="/crypto/subtle/constant_time.go.html#3725994">i</a></span><span class="op" id="3726015">++</span>&nbsp;<span class="op" id="3726018">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726022"><a href="/crypto/subtle/constant_time.go.html#3725981">v</a></span>&nbsp;<span class="op" id="3726024">|=</span>&nbsp;<span class="ident" id="3726027"><a href="/crypto/subtle/constant_time.go.html#3725919">x</a></span><span class="op" id="3726028">[</span><span class="ident" id="3726029"><a href="/crypto/subtle/constant_time.go.html#3725994">i</a></span><span class="op" id="3726030">]</span>&nbsp;<span class="op" id="3726032">^</span>&nbsp;<span class="ident" id="3726034"><a href="/crypto/subtle/constant_time.go.html#3725922">y</a></span><span class="op" id="3726035">[</span><span class="ident" id="3726036"><a href="/crypto/subtle/constant_time.go.html#3725994">i</a></span><span class="op" id="3726037">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726044">return</span>&nbsp;<span class="ident" id="3726051"><a href="/crypto/subtle/constant_time.go.html#3726331">ConstantTimeByteEq</a></span><span class="op" id="3726069">(</span><span class="ident" id="3726070"><a href="/crypto/subtle/constant_time.go.html#3725981">v</a></span><span class="op" id="3726071">,</span>&nbsp;<span class="num" id="3726073">0</span><span class="op" id="3726074">)</span><br>
<span class="lineno"></span><span class="op" id="3726076">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3726079">//&nbsp;ConstantTimeSelect&nbsp;returns&nbsp;x&nbsp;if&nbsp;v&nbsp;is&nbsp;1&nbsp;and&nbsp;y&nbsp;if&nbsp;v&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="3726138">//&nbsp;Its&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;if&nbsp;v&nbsp;takes&nbsp;any&nbsp;other&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3726195">func</span>&nbsp;<span class="ident" id="3726200">ConstantTimeSelect</span><span class="op" id="3726218">(</span><span class="ident" id="3726219">v</span><span class="op" id="3726220">,</span>&nbsp;<span class="ident" id="3726222">x</span><span class="op" id="3726223">,</span>&nbsp;<span class="ident" id="3726225">y</span>&nbsp;<span class="builtintype" id="3726227">int</span><span class="op" id="3726230">)</span>&nbsp;<span class="builtintype" id="3726232">int</span>&nbsp;<span class="op" id="3726236">{</span>&nbsp;<span class="keyword" id="3726238">return</span>&nbsp;<span class="op" id="3726245">^</span><span class="op" id="3726246">(</span><span class="ident" id="3726247"><a href="/crypto/subtle/constant_time.go.html#3726219">v</a></span><span class="op" id="3726248">-</span><span class="num" id="3726249">1</span><span class="op" id="3726250">)</span><span class="op" id="3726251">&amp;</span><span class="ident" id="3726252"><a href="/crypto/subtle/constant_time.go.html#3726222">x</a></span>&nbsp;<span class="op" id="3726254">|</span>&nbsp;<span class="op" id="3726256">(</span><span class="ident" id="3726257"><a href="/crypto/subtle/constant_time.go.html#3726219">v</a></span><span class="op" id="3726258">-</span><span class="num" id="3726259">1</span><span class="op" id="3726260">)</span><span class="op" id="3726261">&amp;</span><span class="ident" id="3726262"><a href="/crypto/subtle/constant_time.go.html#3726225">y</a></span>&nbsp;<span class="op" id="3726264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="3726267">//&nbsp;ConstantTimeByteEq&nbsp;returns&nbsp;1&nbsp;if&nbsp;x&nbsp;==&nbsp;y&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="3726326">func</span>&nbsp;<span class="ident" id="3726331">ConstantTimeByteEq</span><span class="op" id="3726349">(</span><span class="ident" id="3726350">x</span><span class="op" id="3726351">,</span>&nbsp;<span class="ident" id="3726353">y</span>&nbsp;<span class="builtintype" id="3726355">uint8</span><span class="op" id="3726360">)</span>&nbsp;<span class="builtintype" id="3726362">int</span>&nbsp;<span class="op" id="3726366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726369">z</span>&nbsp;<span class="op" id="3726371">:=</span>&nbsp;<span class="op" id="3726374">^</span><span class="op" id="3726375">(</span><span class="ident" id="3726376"><a href="/crypto/subtle/constant_time.go.html#3726350">x</a></span>&nbsp;<span class="op" id="3726378">^</span>&nbsp;<span class="ident" id="3726380"><a href="/crypto/subtle/constant_time.go.html#3726353">y</a></span><span class="op" id="3726381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726384"><a href="/crypto/subtle/constant_time.go.html#3726369">z</a></span>&nbsp;<span class="op" id="3726386">&amp;=</span>&nbsp;<span class="ident" id="3726389"><a href="/crypto/subtle/constant_time.go.html#3726369">z</a></span>&nbsp;<span class="op" id="3726391">&gt;&gt;</span>&nbsp;<span class="num" id="3726394">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726397"><a href="/crypto/subtle/constant_time.go.html#3726369">z</a></span>&nbsp;<span class="op" id="3726399">&amp;=</span>&nbsp;<span class="ident" id="3726402"><a href="/crypto/subtle/constant_time.go.html#3726369">z</a></span>&nbsp;<span class="op" id="3726404">&gt;&gt;</span>&nbsp;<span class="num" id="3726407">2</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726410"><a href="/crypto/subtle/constant_time.go.html#3726369">z</a></span>&nbsp;<span class="op" id="3726412">&amp;=</span>&nbsp;<span class="ident" id="3726415"><a href="/crypto/subtle/constant_time.go.html#3726369">z</a></span>&nbsp;<span class="op" id="3726417">&gt;&gt;</span>&nbsp;<span class="num" id="3726420">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726424">return</span>&nbsp;<span class="builtintype" id="3726431">int</span><span class="op" id="3726434">(</span><span class="ident" id="3726435"><a href="/crypto/subtle/constant_time.go.html#3726369">z</a></span><span class="op" id="3726436">)</span><br>
<span class="lineno"></span><span class="op" id="3726438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="3726441">//&nbsp;ConstantTimeEq&nbsp;returns&nbsp;1&nbsp;if&nbsp;x&nbsp;==&nbsp;y&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="3726496">func</span>&nbsp;<span class="ident" id="3726501">ConstantTimeEq</span><span class="op" id="3726515">(</span><span class="ident" id="3726516">x</span><span class="op" id="3726517">,</span>&nbsp;<span class="ident" id="3726519">y</span>&nbsp;<span class="builtintype" id="3726521">int32</span><span class="op" id="3726526">)</span>&nbsp;<span class="builtintype" id="3726528">int</span>&nbsp;<span class="op" id="3726532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726535">z</span>&nbsp;<span class="op" id="3726537">:=</span>&nbsp;<span class="op" id="3726540">^</span><span class="op" id="3726541">(</span><span class="ident" id="3726542"><a href="/crypto/subtle/constant_time.go.html#3726516">x</a></span>&nbsp;<span class="op" id="3726544">^</span>&nbsp;<span class="ident" id="3726546"><a href="/crypto/subtle/constant_time.go.html#3726519">y</a></span><span class="op" id="3726547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726550"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726552">&amp;=</span>&nbsp;<span class="ident" id="3726555"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726557">&gt;&gt;</span>&nbsp;<span class="num" id="3726560">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726564"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726566">&amp;=</span>&nbsp;<span class="ident" id="3726569"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726571">&gt;&gt;</span>&nbsp;<span class="num" id="3726574">8</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726577"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726579">&amp;=</span>&nbsp;<span class="ident" id="3726582"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726584">&gt;&gt;</span>&nbsp;<span class="num" id="3726587">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726590"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726592">&amp;=</span>&nbsp;<span class="ident" id="3726595"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726597">&gt;&gt;</span>&nbsp;<span class="num" id="3726600">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726603"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726605">&amp;=</span>&nbsp;<span class="ident" id="3726608"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726610">&gt;&gt;</span>&nbsp;<span class="num" id="3726613">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726617">return</span>&nbsp;<span class="builtintype" id="3726624">int</span><span class="op" id="3726627">(</span><span class="ident" id="3726628"><a href="/crypto/subtle/constant_time.go.html#3726535">z</a></span>&nbsp;<span class="op" id="3726630">&amp;</span>&nbsp;<span class="num" id="3726632">1</span><span class="op" id="3726633">)</span><br>
<span class="lineno">50</span><span class="op" id="3726635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3726638">//&nbsp;ConstantTimeCopy&nbsp;copies&nbsp;the&nbsp;contents&nbsp;of&nbsp;y&nbsp;into&nbsp;x&nbsp;(a&nbsp;slice&nbsp;of&nbsp;equal&nbsp;length)</span><br>
<span class="lineno"></span><span class="comment" id="3726716">//&nbsp;if&nbsp;v&nbsp;==&nbsp;1.&nbsp;If&nbsp;v&nbsp;==&nbsp;0,&nbsp;x&nbsp;is&nbsp;left&nbsp;unchanged.&nbsp;Its&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;if&nbsp;v</span><br>
<span class="lineno"></span><span class="comment" id="3726793">//&nbsp;takes&nbsp;any&nbsp;other&nbsp;value.</span><br>
<span class="lineno">55</span><span class="keyword" id="3726819">func</span>&nbsp;<span class="ident" id="3726824">ConstantTimeCopy</span><span class="op" id="3726840">(</span><span class="ident" id="3726841">v</span>&nbsp;<span class="builtintype" id="3726843">int</span><span class="op" id="3726846">,</span>&nbsp;<span class="ident" id="3726848">x</span><span class="op" id="3726849">,</span>&nbsp;<span class="ident" id="3726851">y</span>&nbsp;<span class="op" id="3726853">[</span><span class="op" id="3726854">]</span><span class="builtintype" id="3726855">byte</span><span class="op" id="3726859">)</span>&nbsp;<span class="op" id="3726861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726864">if</span>&nbsp;<span class="builtinfunc" id="3726867">len</span><span class="op" id="3726870">(</span><span class="ident" id="3726871"><a href="/crypto/subtle/constant_time.go.html#3726848">x</a></span><span class="op" id="3726872">)</span>&nbsp;<span class="op" id="3726874">!=</span>&nbsp;<span class="builtinfunc" id="3726877">len</span><span class="op" id="3726880">(</span><span class="ident" id="3726881"><a href="/crypto/subtle/constant_time.go.html#3726851">y</a></span><span class="op" id="3726882">)</span>&nbsp;<span class="op" id="3726884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3726888">panic</span><span class="op" id="3726893">(</span><span class="string" id="3726894">&#34;subtle:&nbsp;slices&nbsp;have&nbsp;different&nbsp;lengths&#34;</span><span class="op" id="3726933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726940">xmask</span>&nbsp;<span class="op" id="3726946">:=</span>&nbsp;<span class="builtintype" id="3726949">byte</span><span class="op" id="3726953">(</span><span class="ident" id="3726954"><a href="/crypto/subtle/constant_time.go.html#3726841">v</a></span>&nbsp;<span class="op" id="3726956">-</span>&nbsp;<span class="num" id="3726958">1</span><span class="op" id="3726959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726962">ymask</span>&nbsp;<span class="op" id="3726968">:=</span>&nbsp;<span class="builtintype" id="3726971">byte</span><span class="op" id="3726975">(</span><span class="op" id="3726976">^</span><span class="op" id="3726977">(</span><span class="ident" id="3726978"><a href="/crypto/subtle/constant_time.go.html#3726841">v</a></span>&nbsp;<span class="op" id="3726980">-</span>&nbsp;<span class="num" id="3726982">1</span><span class="op" id="3726983">)</span><span class="op" id="3726984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726987">for</span>&nbsp;<span class="ident" id="3726991">i</span>&nbsp;<span class="op" id="3726993">:=</span>&nbsp;<span class="num" id="3726996">0</span><span class="op" id="3726997">;</span>&nbsp;<span class="ident" id="3726999"><a href="/crypto/subtle/constant_time.go.html#3726991">i</a></span>&nbsp;<span class="op" id="3727001">&lt;</span>&nbsp;<span class="builtinfunc" id="3727003">len</span><span class="op" id="3727006">(</span><span class="ident" id="3727007"><a href="/crypto/subtle/constant_time.go.html#3726848">x</a></span><span class="op" id="3727008">)</span><span class="op" id="3727009">;</span>&nbsp;<span class="ident" id="3727011"><a href="/crypto/subtle/constant_time.go.html#3726991">i</a></span><span class="op" id="3727012">++</span>&nbsp;<span class="op" id="3727015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3727019"><a href="/crypto/subtle/constant_time.go.html#3726848">x</a></span><span class="op" id="3727020">[</span><span class="ident" id="3727021"><a href="/crypto/subtle/constant_time.go.html#3726991">i</a></span><span class="op" id="3727022">]</span>&nbsp;<span class="op" id="3727024">=</span>&nbsp;<span class="ident" id="3727026"><a href="/crypto/subtle/constant_time.go.html#3726848">x</a></span><span class="op" id="3727027">[</span><span class="ident" id="3727028"><a href="/crypto/subtle/constant_time.go.html#3726991">i</a></span><span class="op" id="3727029">]</span><span class="op" id="3727030">&amp;</span><span class="ident" id="3727031"><a href="/crypto/subtle/constant_time.go.html#3726940">xmask</a></span>&nbsp;<span class="op" id="3727037">|</span>&nbsp;<span class="ident" id="3727039"><a href="/crypto/subtle/constant_time.go.html#3726851">y</a></span><span class="op" id="3727040">[</span><span class="ident" id="3727041"><a href="/crypto/subtle/constant_time.go.html#3726991">i</a></span><span class="op" id="3727042">]</span><span class="op" id="3727043">&amp;</span><span class="ident" id="3727044"><a href="/crypto/subtle/constant_time.go.html#3726962">ymask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3727051">}</span><br>
<span class="lineno">65</span><span class="op" id="3727053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3727056">//&nbsp;ConstantTimeLessOrEq&nbsp;returns&nbsp;1&nbsp;if&nbsp;x&nbsp;&lt;=&nbsp;y&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="3727117">//&nbsp;Its&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;if&nbsp;x&nbsp;or&nbsp;y&nbsp;are&nbsp;negative&nbsp;or&nbsp;&gt;&nbsp;2**31&nbsp;-&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="3727185">func</span>&nbsp;<span class="ident" id="3727190">ConstantTimeLessOrEq</span><span class="op" id="3727210">(</span><span class="ident" id="3727211">x</span><span class="op" id="3727212">,</span>&nbsp;<span class="ident" id="3727214">y</span>&nbsp;<span class="builtintype" id="3727216">int</span><span class="op" id="3727219">)</span>&nbsp;<span class="builtintype" id="3727221">int</span>&nbsp;<span class="op" id="3727225">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3727228">x32</span>&nbsp;<span class="op" id="3727232">:=</span>&nbsp;<span class="builtintype" id="3727235">int32</span><span class="op" id="3727240">(</span><span class="ident" id="3727241"><a href="/crypto/subtle/constant_time.go.html#3727211">x</a></span><span class="op" id="3727242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3727245">y32</span>&nbsp;<span class="op" id="3727249">:=</span>&nbsp;<span class="builtintype" id="3727252">int32</span><span class="op" id="3727257">(</span><span class="ident" id="3727258"><a href="/crypto/subtle/constant_time.go.html#3727214">y</a></span><span class="op" id="3727259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727262">return</span>&nbsp;<span class="builtintype" id="3727269">int</span><span class="op" id="3727272">(</span><span class="op" id="3727273">(</span><span class="op" id="3727274">(</span><span class="ident" id="3727275"><a href="/crypto/subtle/constant_time.go.html#3727228">x32</a></span>&nbsp;<span class="op" id="3727279">-</span>&nbsp;<span class="ident" id="3727281"><a href="/crypto/subtle/constant_time.go.html#3727245">y32</a></span>&nbsp;<span class="op" id="3727285">-</span>&nbsp;<span class="num" id="3727287">1</span><span class="op" id="3727288">)</span>&nbsp;<span class="op" id="3727290">&gt;&gt;</span>&nbsp;<span class="num" id="3727293">31</span><span class="op" id="3727295">)</span>&nbsp;<span class="op" id="3727297">&amp;</span>&nbsp;<span class="num" id="3727299">1</span><span class="op" id="3727300">)</span><br>
<span class="lineno"></span><span class="op" id="3727302">}</span>
</div>
</body>
</html>
