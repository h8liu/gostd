<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/ast</h2>
<ul>
<li><a href="/gostd/go/ast/ast.go.html">ast.go</a></li>
<li><a href="/gostd/go/ast/ast_test.go.html">ast_test.go</a></li>
<li><a href="/gostd/go/ast/commentmap.go.html">commentmap.go</a></li>
<li><a href="/gostd/go/ast/commentmap_test.go.html">commentmap_test.go</a></li>
<li><a href="/gostd/go/ast/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/ast/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/ast/filter_test.go.html">filter_test.go</a></li>
<li><a href="/gostd/go/ast/import.go.html">import.go</a></li>
<li><a href="/gostd/go/ast/print.go.html" class="current">print.go</a></li>
<li><a href="/gostd/go/ast/print_test.go.html">print_test.go</a></li>
<li><a href="/gostd/go/ast/resolve.go.html">resolve.go</a></li>
<li><a href="/gostd/go/ast/scope.go.html">scope.go</a></li>
<li><a href="/gostd/go/ast/walk.go.html">walk.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4951857">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4951912">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4951966">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4952017">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;printing&nbsp;support&nbsp;for&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4952067">package</span>&nbsp;<span class="ident" id="4952075">ast</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4952080">import</span>&nbsp;<span class="op" id="4952087">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4952090">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4952097">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4952109">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4952115">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4952121">&#34;reflect&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4952131">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4952134">//&nbsp;A&nbsp;FieldFilter&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Fprint&nbsp;to&nbsp;control&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="4952200">type</span>&nbsp;<span class="ident" id="4952205">FieldFilter</span>&nbsp;<span class="keyword" id="4952217">func</span><span class="op" id="4952221">(</span><span class="ident" id="4952222">name</span>&nbsp;<span class="builtintype" id="4952227">string</span><span class="op" id="4952233">,</span>&nbsp;<span class="ident" id="4952235">value</span>&nbsp;<span class="ident" id="4952241">reflect</span><span class="op" id="4952248">.</span><span class="ident" id="4952249">Value</span><span class="op" id="4952254">)</span>&nbsp;<span class="builtintype" id="4952256">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4952262">//&nbsp;NotNilFilter&nbsp;returns&nbsp;true&nbsp;for&nbsp;field&nbsp;values&nbsp;that&nbsp;are&nbsp;not&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="4952326">//&nbsp;it&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="4952357">func</span>&nbsp;<span class="ident" id="4952362">NotNilFilter</span><span class="op" id="4952374">(</span><span class="ident" id="4952375">_</span>&nbsp;<span class="builtintype" id="4952377">string</span><span class="op" id="4952383">,</span>&nbsp;<span class="ident" id="4952385">v</span>&nbsp;<span class="ident" id="4952387">reflect</span><span class="op" id="4952394">.</span><span class="ident" id="4952395">Value</span><span class="op" id="4952400">)</span>&nbsp;<span class="builtintype" id="4952402">bool</span>&nbsp;<span class="op" id="4952407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4952410">switch</span>&nbsp;<span class="ident" id="4952417">v</span><span class="op" id="4952418">.</span><span class="ident" id="4952419">Kind</span><span class="op" id="4952423">(</span><span class="op" id="4952424">)</span>&nbsp;<span class="op" id="4952426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4952429">case</span>&nbsp;<span class="ident" id="4952434">reflect</span><span class="op" id="4952441">.</span><span class="ident" id="4952442">Chan</span><span class="op" id="4952446">,</span>&nbsp;<span class="ident" id="4952448">reflect</span><span class="op" id="4952455">.</span><span class="ident" id="4952456">Func</span><span class="op" id="4952460">,</span>&nbsp;<span class="ident" id="4952462">reflect</span><span class="op" id="4952469">.</span><span class="ident" id="4952470">Interface</span><span class="op" id="4952479">,</span>&nbsp;<span class="ident" id="4952481">reflect</span><span class="op" id="4952488">.</span><span class="ident" id="4952489">Map</span><span class="op" id="4952492">,</span>&nbsp;<span class="ident" id="4952494">reflect</span><span class="op" id="4952501">.</span><span class="ident" id="4952502">Ptr</span><span class="op" id="4952505">,</span>&nbsp;<span class="ident" id="4952507">reflect</span><span class="op" id="4952514">.</span><span class="ident" id="4952515">Slice</span><span class="op" id="4952520">:</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4952524">return</span>&nbsp;<span class="op" id="4952531">!</span><span class="ident" id="4952532">v</span><span class="op" id="4952533">.</span><span class="ident" id="4952534">IsNil</span><span class="op" id="4952539">(</span><span class="op" id="4952540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4952543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4952546">return</span>&nbsp;<span class="builtintype" id="4952553">true</span><br>
<span class="lineno"></span><span class="op" id="4952558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4952561">//&nbsp;Fprint&nbsp;prints&nbsp;the&nbsp;(sub-)tree&nbsp;starting&nbsp;at&nbsp;AST&nbsp;node&nbsp;x&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4952622">//&nbsp;If&nbsp;fset&nbsp;!=&nbsp;nil,&nbsp;position&nbsp;information&nbsp;is&nbsp;interpreted&nbsp;relative</span><br>
<span class="lineno"></span><span class="comment" id="4952686">//&nbsp;to&nbsp;that&nbsp;file&nbsp;set.&nbsp;Otherwise&nbsp;positions&nbsp;are&nbsp;printed&nbsp;as&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="4952750">//&nbsp;values&nbsp;(file&nbsp;set&nbsp;specific&nbsp;offsets).</span><br>
<span class="lineno"></span><span class="comment" id="4952789">//</span><br>
<span class="lineno">35</span><span class="comment" id="4952792">//&nbsp;A&nbsp;non-nil&nbsp;FieldFilter&nbsp;f&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;control&nbsp;the&nbsp;output:</span><br>
<span class="lineno"></span><span class="comment" id="4952858">//&nbsp;struct&nbsp;fields&nbsp;for&nbsp;which&nbsp;f(fieldname,&nbsp;fieldvalue)&nbsp;is&nbsp;true&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4952922">//&nbsp;printed;&nbsp;all&nbsp;others&nbsp;are&nbsp;filtered&nbsp;from&nbsp;the&nbsp;output.&nbsp;Unexported</span><br>
<span class="lineno"></span><span class="comment" id="4952986">//&nbsp;struct&nbsp;fields&nbsp;are&nbsp;never&nbsp;printed.</span><br>
<span class="lineno"></span><span class="comment" id="4953022">//</span><br>
<span class="lineno">40</span><span class="keyword" id="4953025">func</span>&nbsp;<span class="ident" id="4953030">Fprint</span><span class="op" id="4953036">(</span><span class="ident" id="4953037">w</span>&nbsp;<span class="ident" id="4953039">io</span><span class="op" id="4953041">.</span><span class="ident" id="4953042">Writer</span><span class="op" id="4953048">,</span>&nbsp;<span class="ident" id="4953050">fset</span>&nbsp;<span class="op" id="4953055">*</span><span class="ident" id="4953056">token</span><span class="op" id="4953061">.</span><span class="ident" id="4953062">FileSet</span><span class="op" id="4953069">,</span>&nbsp;<span class="ident" id="4953071">x</span>&nbsp;<span class="keyword" id="4953073">interface</span><span class="op" id="4953082">{</span><span class="op" id="4953083">}</span><span class="op" id="4953084">,</span>&nbsp;<span class="ident" id="4953086">f</span>&nbsp;<span class="ident" id="4953088">FieldFilter</span><span class="op" id="4953099">)</span>&nbsp;<span class="op" id="4953101">(</span><span class="ident" id="4953102">err</span>&nbsp;<span class="builtintype" id="4953106">error</span><span class="op" id="4953111">)</span>&nbsp;<span class="op" id="4953113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4953116">//&nbsp;setup&nbsp;printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953134">p</span>&nbsp;<span class="op" id="4953136">:=</span>&nbsp;<span class="ident" id="4953139">printer</span><span class="op" id="4953146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953150">output</span><span class="op" id="4953156">:</span>&nbsp;<span class="ident" id="4953158">w</span><span class="op" id="4953159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953163">fset</span><span class="op" id="4953167">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4953171">fset</span><span class="op" id="4953175">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953179">filter</span><span class="op" id="4953185">:</span>&nbsp;<span class="ident" id="4953187">f</span><span class="op" id="4953188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953192">ptrmap</span><span class="op" id="4953198">:</span>&nbsp;<span class="builtinfunc" id="4953200">make</span><span class="op" id="4953204">(</span><span class="keyword" id="4953205">map</span><span class="op" id="4953208">[</span><span class="keyword" id="4953209">interface</span><span class="op" id="4953218">{</span><span class="op" id="4953219">}</span><span class="op" id="4953220">]</span><span class="builtintype" id="4953221">int</span><span class="op" id="4953224">)</span><span class="op" id="4953225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953229">last</span><span class="op" id="4953233">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4953237">&#39;\n&#39;</span><span class="op" id="4953241">,</span>&nbsp;<span class="comment" id="4953243">//&nbsp;force&nbsp;printing&nbsp;of&nbsp;line&nbsp;number&nbsp;on&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4953291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4953295">//&nbsp;install&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4953321">defer</span>&nbsp;<span class="keyword" id="4953327">func</span><span class="op" id="4953331">(</span><span class="op" id="4953332">)</span>&nbsp;<span class="op" id="4953334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4953338">if</span>&nbsp;<span class="ident" id="4953341">e</span>&nbsp;<span class="op" id="4953343">:=</span>&nbsp;<span class="builtinfunc" id="4953346">recover</span><span class="op" id="4953353">(</span><span class="op" id="4953354">)</span><span class="op" id="4953355">;</span>&nbsp;<span class="ident" id="4953357">e</span>&nbsp;<span class="op" id="4953359">!=</span>&nbsp;<span class="builtintype" id="4953362">nil</span>&nbsp;<span class="op" id="4953366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953371">err</span>&nbsp;<span class="op" id="4953375">=</span>&nbsp;<span class="ident" id="4953377">e</span><span class="op" id="4953378">.</span><span class="op" id="4953379">(</span><span class="ident" id="4953380">localError</span><span class="op" id="4953390">)</span><span class="op" id="4953391">.</span><span class="ident" id="4953392">err</span>&nbsp;<span class="comment" id="4953396">//&nbsp;re-panics&nbsp;if&nbsp;it&#39;s&nbsp;not&nbsp;a&nbsp;localError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4953436">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4953439">}</span><span class="op" id="4953440">(</span><span class="op" id="4953441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4953445">//&nbsp;print&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4953457">if</span>&nbsp;<span class="ident" id="4953460">x</span>&nbsp;<span class="op" id="4953462">==</span>&nbsp;<span class="builtintype" id="4953465">nil</span>&nbsp;<span class="op" id="4953469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953473">p</span><span class="op" id="4953474">.</span><span class="ident" id="4953475">printf</span><span class="op" id="4953481">(</span><span class="string" id="4953482">&#34;nil\n&#34;</span><span class="op" id="4953489">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4953493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4953501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953504">p</span><span class="op" id="4953505">.</span><span class="builtinfunc" id="4953506">print</span><span class="op" id="4953511">(</span><span class="ident" id="4953512">reflect</span><span class="op" id="4953519">.</span><span class="ident" id="4953520">ValueOf</span><span class="op" id="4953527">(</span><span class="ident" id="4953528">x</span><span class="op" id="4953529">)</span><span class="op" id="4953530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953533">p</span><span class="op" id="4953534">.</span><span class="ident" id="4953535">printf</span><span class="op" id="4953541">(</span><span class="string" id="4953542">&#34;\n&#34;</span><span class="op" id="4953546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4953550">return</span><br>
<span class="lineno"></span><span class="op" id="4953557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4953560">//&nbsp;Print&nbsp;prints&nbsp;x&nbsp;to&nbsp;standard&nbsp;output,&nbsp;skipping&nbsp;nil&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="4953619">//&nbsp;Print(fset,&nbsp;x)&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;Fprint(os.Stdout,&nbsp;fset,&nbsp;x,&nbsp;NotNilFilter).</span><br>
<span class="lineno">70</span><span class="keyword" id="4953694">func</span>&nbsp;<span class="ident" id="4953699">Print</span><span class="op" id="4953704">(</span><span class="ident" id="4953705">fset</span>&nbsp;<span class="op" id="4953710">*</span><span class="ident" id="4953711">token</span><span class="op" id="4953716">.</span><span class="ident" id="4953717">FileSet</span><span class="op" id="4953724">,</span>&nbsp;<span class="ident" id="4953726">x</span>&nbsp;<span class="keyword" id="4953728">interface</span><span class="op" id="4953737">{</span><span class="op" id="4953738">}</span><span class="op" id="4953739">)</span>&nbsp;<span class="builtintype" id="4953741">error</span>&nbsp;<span class="op" id="4953747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4953750">return</span>&nbsp;<span class="ident" id="4953757">Fprint</span><span class="op" id="4953763">(</span><span class="ident" id="4953764">os</span><span class="op" id="4953766">.</span><span class="ident" id="4953767">Stdout</span><span class="op" id="4953773">,</span>&nbsp;<span class="ident" id="4953775">fset</span><span class="op" id="4953779">,</span>&nbsp;<span class="ident" id="4953781">x</span><span class="op" id="4953782">,</span>&nbsp;<span class="ident" id="4953784">NotNilFilter</span><span class="op" id="4953796">)</span><br>
<span class="lineno"></span><span class="op" id="4953798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4953801">type</span>&nbsp;<span class="ident" id="4953806">printer</span>&nbsp;<span class="keyword" id="4953814">struct</span>&nbsp;<span class="op" id="4953821">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953824">output</span>&nbsp;<span class="ident" id="4953831">io</span><span class="op" id="4953833">.</span><span class="ident" id="4953834">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953842">fset</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4953849">*</span><span class="ident" id="4953850">token</span><span class="op" id="4953855">.</span><span class="ident" id="4953856">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953865">filter</span>&nbsp;<span class="ident" id="4953872">FieldFilter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953885">ptrmap</span>&nbsp;<span class="keyword" id="4953892">map</span><span class="op" id="4953895">[</span><span class="keyword" id="4953896">interface</span><span class="op" id="4953905">{</span><span class="op" id="4953906">}</span><span class="op" id="4953907">]</span><span class="builtintype" id="4953908">int</span>&nbsp;<span class="comment" id="4953912">//&nbsp;*T&nbsp;-&gt;&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953934">indent</span>&nbsp;<span class="builtintype" id="4953941">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4953961">//&nbsp;current&nbsp;indentation&nbsp;level</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4953991">last</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4953998">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4954018">//&nbsp;the&nbsp;last&nbsp;byte&nbsp;processed&nbsp;by&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954055">line</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4954062">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4954082">//&nbsp;current&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span><span class="op" id="4954105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4954108">var</span>&nbsp;<span class="ident" id="4954112">indent</span>&nbsp;<span class="op" id="4954119">=</span>&nbsp;<span class="op" id="4954121">[</span><span class="op" id="4954122">]</span><span class="builtintype" id="4954123">byte</span><span class="op" id="4954127">(</span><span class="string" id="4954128">&#34;.&nbsp;&nbsp;&#34;</span><span class="op" id="4954133">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4954136">func</span>&nbsp;<span class="op" id="4954141">(</span><span class="ident" id="4954142">p</span>&nbsp;<span class="op" id="4954144">*</span><span class="ident" id="4954145">printer</span><span class="op" id="4954152">)</span>&nbsp;<span class="ident" id="4954154">Write</span><span class="op" id="4954159">(</span><span class="ident" id="4954160">data</span>&nbsp;<span class="op" id="4954165">[</span><span class="op" id="4954166">]</span><span class="builtintype" id="4954167">byte</span><span class="op" id="4954171">)</span>&nbsp;<span class="op" id="4954173">(</span><span class="ident" id="4954174">n</span>&nbsp;<span class="builtintype" id="4954176">int</span><span class="op" id="4954179">,</span>&nbsp;<span class="ident" id="4954181">err</span>&nbsp;<span class="builtintype" id="4954185">error</span><span class="op" id="4954190">)</span>&nbsp;<span class="op" id="4954192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954195">var</span>&nbsp;<span class="ident" id="4954199">m</span>&nbsp;<span class="builtintype" id="4954201">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954206">for</span>&nbsp;<span class="ident" id="4954210">i</span><span class="op" id="4954211">,</span>&nbsp;<span class="ident" id="4954213">b</span>&nbsp;<span class="op" id="4954215">:=</span>&nbsp;<span class="keyword" id="4954218">range</span>&nbsp;<span class="ident" id="4954224">data</span>&nbsp;<span class="op" id="4954229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4954233">//&nbsp;invariant:&nbsp;data[0:n]&nbsp;has&nbsp;been&nbsp;written</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954276">if</span>&nbsp;<span class="ident" id="4954279">b</span>&nbsp;<span class="op" id="4954281">==</span>&nbsp;<span class="string" id="4954284">&#39;\n&#39;</span>&nbsp;<span class="op" id="4954289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954294">m</span><span class="op" id="4954295">,</span>&nbsp;<span class="ident" id="4954297">err</span>&nbsp;<span class="op" id="4954301">=</span>&nbsp;<span class="ident" id="4954303">p</span><span class="op" id="4954304">.</span><span class="ident" id="4954305">output</span><span class="op" id="4954311">.</span><span class="ident" id="4954312">Write</span><span class="op" id="4954317">(</span><span class="ident" id="4954318">data</span><span class="op" id="4954322">[</span><span class="ident" id="4954323">n</span>&nbsp;<span class="op" id="4954325">:</span>&nbsp;<span class="ident" id="4954327">i</span><span class="op" id="4954328">+</span><span class="num" id="4954329">1</span><span class="op" id="4954330">]</span><span class="op" id="4954331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954336">n</span>&nbsp;<span class="op" id="4954338">+=</span>&nbsp;<span class="ident" id="4954341">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954346">if</span>&nbsp;<span class="ident" id="4954349">err</span>&nbsp;<span class="op" id="4954353">!=</span>&nbsp;<span class="builtintype" id="4954356">nil</span>&nbsp;<span class="op" id="4954360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954366">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4954376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954381">p</span><span class="op" id="4954382">.</span><span class="ident" id="4954383">line</span><span class="op" id="4954387">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4954392">}</span>&nbsp;<span class="keyword" id="4954394">else</span>&nbsp;<span class="keyword" id="4954399">if</span>&nbsp;<span class="ident" id="4954402">p</span><span class="op" id="4954403">.</span><span class="ident" id="4954404">last</span>&nbsp;<span class="op" id="4954409">==</span>&nbsp;<span class="string" id="4954412">&#39;\n&#39;</span>&nbsp;<span class="op" id="4954417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954422">_</span><span class="op" id="4954423">,</span>&nbsp;<span class="ident" id="4954425">err</span>&nbsp;<span class="op" id="4954429">=</span>&nbsp;<span class="ident" id="4954431">fmt</span><span class="op" id="4954434">.</span><span class="ident" id="4954435">Fprintf</span><span class="op" id="4954442">(</span><span class="ident" id="4954443">p</span><span class="op" id="4954444">.</span><span class="ident" id="4954445">output</span><span class="op" id="4954451">,</span>&nbsp;<span class="string" id="4954453">&#34;%6d&nbsp;&nbsp;&#34;</span><span class="op" id="4954460">,</span>&nbsp;<span class="ident" id="4954462">p</span><span class="op" id="4954463">.</span><span class="ident" id="4954464">line</span><span class="op" id="4954468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954473">if</span>&nbsp;<span class="ident" id="4954476">err</span>&nbsp;<span class="op" id="4954480">!=</span>&nbsp;<span class="builtintype" id="4954483">nil</span>&nbsp;<span class="op" id="4954487">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4954503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954508">for</span>&nbsp;<span class="ident" id="4954512">j</span>&nbsp;<span class="op" id="4954514">:=</span>&nbsp;<span class="ident" id="4954517">p</span><span class="op" id="4954518">.</span><span class="ident" id="4954519">indent</span><span class="op" id="4954525">;</span>&nbsp;<span class="ident" id="4954527">j</span>&nbsp;<span class="op" id="4954529">&gt;</span>&nbsp;<span class="num" id="4954531">0</span><span class="op" id="4954532">;</span>&nbsp;<span class="ident" id="4954534">j</span><span class="op" id="4954535">--</span>&nbsp;<span class="op" id="4954538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954544">_</span><span class="op" id="4954545">,</span>&nbsp;<span class="ident" id="4954547">err</span>&nbsp;<span class="op" id="4954551">=</span>&nbsp;<span class="ident" id="4954553">p</span><span class="op" id="4954554">.</span><span class="ident" id="4954555">output</span><span class="op" id="4954561">.</span><span class="ident" id="4954562">Write</span><span class="op" id="4954567">(</span><span class="ident" id="4954568">indent</span><span class="op" id="4954574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954580">if</span>&nbsp;<span class="ident" id="4954583">err</span>&nbsp;<span class="op" id="4954587">!=</span>&nbsp;<span class="builtintype" id="4954590">nil</span>&nbsp;<span class="op" id="4954594">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954601">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4954612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4954617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4954621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954625">p</span><span class="op" id="4954626">.</span><span class="ident" id="4954627">last</span>&nbsp;<span class="op" id="4954632">=</span>&nbsp;<span class="ident" id="4954634">b</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4954637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954640">if</span>&nbsp;<span class="builtinfunc" id="4954643">len</span><span class="op" id="4954646">(</span><span class="ident" id="4954647">data</span><span class="op" id="4954651">)</span>&nbsp;<span class="op" id="4954653">&gt;</span>&nbsp;<span class="ident" id="4954655">n</span>&nbsp;<span class="op" id="4954657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954661">m</span><span class="op" id="4954662">,</span>&nbsp;<span class="ident" id="4954664">err</span>&nbsp;<span class="op" id="4954668">=</span>&nbsp;<span class="ident" id="4954670">p</span><span class="op" id="4954671">.</span><span class="ident" id="4954672">output</span><span class="op" id="4954678">.</span><span class="ident" id="4954679">Write</span><span class="op" id="4954684">(</span><span class="ident" id="4954685">data</span><span class="op" id="4954689">[</span><span class="ident" id="4954690">n</span><span class="op" id="4954691">:</span><span class="op" id="4954692">]</span><span class="op" id="4954693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954697">n</span>&nbsp;<span class="op" id="4954699">+=</span>&nbsp;<span class="ident" id="4954702">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4954705">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4954708">return</span><br>
<span class="lineno"></span><span class="op" id="4954715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4954718">//&nbsp;localError&nbsp;wraps&nbsp;locally&nbsp;caught&nbsp;errors&nbsp;so&nbsp;we&nbsp;can&nbsp;distinguish</span><br>
<span class="lineno"></span><span class="comment" id="4954782">//&nbsp;them&nbsp;from&nbsp;genuine&nbsp;panics&nbsp;which&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;return&nbsp;as&nbsp;errors.</span><br>
<span class="lineno">120</span><span class="keyword" id="4954851">type</span>&nbsp;<span class="ident" id="4954856">localError</span>&nbsp;<span class="keyword" id="4954867">struct</span>&nbsp;<span class="op" id="4954874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4954877">err</span>&nbsp;<span class="builtintype" id="4954881">error</span><br>
<span class="lineno"></span><span class="op" id="4954887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4954890">//&nbsp;printf&nbsp;is&nbsp;a&nbsp;convenience&nbsp;wrapper&nbsp;that&nbsp;takes&nbsp;care&nbsp;of&nbsp;print&nbsp;errors.</span><br>
<span class="lineno">125</span><span class="keyword" id="4954958">func</span>&nbsp;<span class="op" id="4954963">(</span><span class="ident" id="4954964">p</span>&nbsp;<span class="op" id="4954966">*</span><span class="ident" id="4954967">printer</span><span class="op" id="4954974">)</span>&nbsp;<span class="ident" id="4954976">printf</span><span class="op" id="4954982">(</span><span class="ident" id="4954983">format</span>&nbsp;<span class="builtintype" id="4954990">string</span><span class="op" id="4954996">,</span>&nbsp;<span class="ident" id="4954998">args</span>&nbsp;<span class="op" id="4955003">...</span><span class="keyword" id="4955006">interface</span><span class="op" id="4955015">{</span><span class="op" id="4955016">}</span><span class="op" id="4955017">)</span>&nbsp;<span class="op" id="4955019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4955022">if</span>&nbsp;<span class="ident" id="4955025">_</span><span class="op" id="4955026">,</span>&nbsp;<span class="ident" id="4955028">err</span>&nbsp;<span class="op" id="4955032">:=</span>&nbsp;<span class="ident" id="4955035">fmt</span><span class="op" id="4955038">.</span><span class="ident" id="4955039">Fprintf</span><span class="op" id="4955046">(</span><span class="ident" id="4955047">p</span><span class="op" id="4955048">,</span>&nbsp;<span class="ident" id="4955050">format</span><span class="op" id="4955056">,</span>&nbsp;<span class="ident" id="4955058">args</span><span class="op" id="4955062">...</span><span class="op" id="4955065">)</span><span class="op" id="4955066">;</span>&nbsp;<span class="ident" id="4955068">err</span>&nbsp;<span class="op" id="4955072">!=</span>&nbsp;<span class="builtintype" id="4955075">nil</span>&nbsp;<span class="op" id="4955079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4955083">panic</span><span class="op" id="4955088">(</span><span class="ident" id="4955089">localError</span><span class="op" id="4955099">{</span><span class="ident" id="4955100">err</span><span class="op" id="4955103">}</span><span class="op" id="4955104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4955107">}</span><br>
<span class="lineno"></span><span class="op" id="4955109">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="4955112">//&nbsp;Implementation&nbsp;note:&nbsp;Print&nbsp;is&nbsp;written&nbsp;for&nbsp;AST&nbsp;nodes&nbsp;but&nbsp;could&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4955180">//&nbsp;used&nbsp;to&nbsp;print&nbsp;arbitrary&nbsp;data&nbsp;structures;&nbsp;such&nbsp;a&nbsp;version&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="4955246">//&nbsp;probably&nbsp;be&nbsp;in&nbsp;a&nbsp;different&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="4955285">//</span><br>
<span class="lineno">135</span><span class="comment" id="4955288">//&nbsp;Note:&nbsp;This&nbsp;code&nbsp;detects&nbsp;(some)&nbsp;cycles&nbsp;created&nbsp;via&nbsp;pointers&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="4955354">//&nbsp;not&nbsp;cycles&nbsp;that&nbsp;are&nbsp;created&nbsp;via&nbsp;slices&nbsp;or&nbsp;maps&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4955419">//&nbsp;same&nbsp;slice&nbsp;or&nbsp;map.&nbsp;Code&nbsp;for&nbsp;general&nbsp;data&nbsp;structures&nbsp;probably</span><br>
<span class="lineno"></span><span class="comment" id="4955483">//&nbsp;should&nbsp;catch&nbsp;those&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="4955515">func</span>&nbsp;<span class="op" id="4955520">(</span><span class="ident" id="4955521">p</span>&nbsp;<span class="op" id="4955523">*</span><span class="ident" id="4955524">printer</span><span class="op" id="4955531">)</span>&nbsp;<span class="builtinfunc" id="4955533">print</span><span class="op" id="4955538">(</span><span class="ident" id="4955539">x</span>&nbsp;<span class="ident" id="4955541">reflect</span><span class="op" id="4955548">.</span><span class="ident" id="4955549">Value</span><span class="op" id="4955554">)</span>&nbsp;<span class="op" id="4955556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4955559">if</span>&nbsp;<span class="op" id="4955562">!</span><span class="ident" id="4955563">NotNilFilter</span><span class="op" id="4955575">(</span><span class="string" id="4955576">&#34;&#34;</span><span class="op" id="4955578">,</span>&nbsp;<span class="ident" id="4955580">x</span><span class="op" id="4955581">)</span>&nbsp;<span class="op" id="4955583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955587">p</span><span class="op" id="4955588">.</span><span class="ident" id="4955589">printf</span><span class="op" id="4955595">(</span><span class="string" id="4955596">&#34;nil&#34;</span><span class="op" id="4955601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4955605">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4955613">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4955617">switch</span>&nbsp;<span class="ident" id="4955624">x</span><span class="op" id="4955625">.</span><span class="ident" id="4955626">Kind</span><span class="op" id="4955630">(</span><span class="op" id="4955631">)</span>&nbsp;<span class="op" id="4955633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4955636">case</span>&nbsp;<span class="ident" id="4955641">reflect</span><span class="op" id="4955648">.</span><span class="ident" id="4955649">Interface</span><span class="op" id="4955658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955662">p</span><span class="op" id="4955663">.</span><span class="builtinfunc" id="4955664">print</span><span class="op" id="4955669">(</span><span class="ident" id="4955670">x</span><span class="op" id="4955671">.</span><span class="ident" id="4955672">Elem</span><span class="op" id="4955676">(</span><span class="op" id="4955677">)</span><span class="op" id="4955678">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4955682">case</span>&nbsp;<span class="ident" id="4955687">reflect</span><span class="op" id="4955694">.</span><span class="ident" id="4955695">Map</span><span class="op" id="4955698">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955702">p</span><span class="op" id="4955703">.</span><span class="ident" id="4955704">printf</span><span class="op" id="4955710">(</span><span class="string" id="4955711">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="4955728">,</span>&nbsp;<span class="ident" id="4955730">x</span><span class="op" id="4955731">.</span><span class="ident" id="4955732">Type</span><span class="op" id="4955736">(</span><span class="op" id="4955737">)</span><span class="op" id="4955738">,</span>&nbsp;<span class="ident" id="4955740">x</span><span class="op" id="4955741">.</span><span class="ident" id="4955742">Len</span><span class="op" id="4955745">(</span><span class="op" id="4955746">)</span><span class="op" id="4955747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4955751">if</span>&nbsp;<span class="ident" id="4955754">x</span><span class="op" id="4955755">.</span><span class="ident" id="4955756">Len</span><span class="op" id="4955759">(</span><span class="op" id="4955760">)</span>&nbsp;<span class="op" id="4955762">&gt;</span>&nbsp;<span class="num" id="4955764">0</span>&nbsp;<span class="op" id="4955766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955771">p</span><span class="op" id="4955772">.</span><span class="ident" id="4955773">indent</span><span class="op" id="4955779">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955785">p</span><span class="op" id="4955786">.</span><span class="ident" id="4955787">printf</span><span class="op" id="4955793">(</span><span class="string" id="4955794">&#34;\n&#34;</span><span class="op" id="4955798">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4955803">for</span>&nbsp;<span class="ident" id="4955807">_</span><span class="op" id="4955808">,</span>&nbsp;<span class="ident" id="4955810">key</span>&nbsp;<span class="op" id="4955814">:=</span>&nbsp;<span class="keyword" id="4955817">range</span>&nbsp;<span class="ident" id="4955823">x</span><span class="op" id="4955824">.</span><span class="ident" id="4955825">MapKeys</span><span class="op" id="4955832">(</span><span class="op" id="4955833">)</span>&nbsp;<span class="op" id="4955835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955841">p</span><span class="op" id="4955842">.</span><span class="builtinfunc" id="4955843">print</span><span class="op" id="4955848">(</span><span class="ident" id="4955849">key</span><span class="op" id="4955852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955858">p</span><span class="op" id="4955859">.</span><span class="ident" id="4955860">printf</span><span class="op" id="4955866">(</span><span class="string" id="4955867">&#34;:&nbsp;&#34;</span><span class="op" id="4955871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955877">p</span><span class="op" id="4955878">.</span><span class="builtinfunc" id="4955879">print</span><span class="op" id="4955884">(</span><span class="ident" id="4955885">x</span><span class="op" id="4955886">.</span><span class="ident" id="4955887">MapIndex</span><span class="op" id="4955895">(</span><span class="ident" id="4955896">key</span><span class="op" id="4955899">)</span><span class="op" id="4955900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955906">p</span><span class="op" id="4955907">.</span><span class="ident" id="4955908">printf</span><span class="op" id="4955914">(</span><span class="string" id="4955915">&#34;\n&#34;</span><span class="op" id="4955919">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4955924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955929">p</span><span class="op" id="4955930">.</span><span class="ident" id="4955931">indent</span><span class="op" id="4955937">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4955942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955946">p</span><span class="op" id="4955947">.</span><span class="ident" id="4955948">printf</span><span class="op" id="4955954">(</span><span class="string" id="4955955">&#34;}&#34;</span><span class="op" id="4955958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4955962">case</span>&nbsp;<span class="ident" id="4955967">reflect</span><span class="op" id="4955974">.</span><span class="ident" id="4955975">Ptr</span><span class="op" id="4955978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4955982">p</span><span class="op" id="4955983">.</span><span class="ident" id="4955984">printf</span><span class="op" id="4955990">(</span><span class="string" id="4955991">&#34;*&#34;</span><span class="op" id="4955994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4955998">//&nbsp;type-checked&nbsp;ASTs&nbsp;may&nbsp;contain&nbsp;cycles&nbsp;-&nbsp;use&nbsp;ptrmap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4956053">//&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;objects&nbsp;that&nbsp;have&nbsp;been&nbsp;printed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4956106">//&nbsp;already&nbsp;and&nbsp;print&nbsp;the&nbsp;respective&nbsp;line&nbsp;number&nbsp;instead</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956164">ptr</span>&nbsp;<span class="op" id="4956168">:=</span>&nbsp;<span class="ident" id="4956171">x</span><span class="op" id="4956172">.</span><span class="ident" id="4956173">Interface</span><span class="op" id="4956182">(</span><span class="op" id="4956183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956187">if</span>&nbsp;<span class="ident" id="4956190">line</span><span class="op" id="4956194">,</span>&nbsp;<span class="ident" id="4956196">exists</span>&nbsp;<span class="op" id="4956203">:=</span>&nbsp;<span class="ident" id="4956206">p</span><span class="op" id="4956207">.</span><span class="ident" id="4956208">ptrmap</span><span class="op" id="4956214">[</span><span class="ident" id="4956215">ptr</span><span class="op" id="4956218">]</span><span class="op" id="4956219">;</span>&nbsp;<span class="ident" id="4956221">exists</span>&nbsp;<span class="op" id="4956228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956233">p</span><span class="op" id="4956234">.</span><span class="ident" id="4956235">printf</span><span class="op" id="4956241">(</span><span class="string" id="4956242">&#34;(obj&nbsp;@&nbsp;%d)&#34;</span><span class="op" id="4956254">,</span>&nbsp;<span class="ident" id="4956256">line</span><span class="op" id="4956260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4956264">}</span>&nbsp;<span class="keyword" id="4956266">else</span>&nbsp;<span class="op" id="4956271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956276">p</span><span class="op" id="4956277">.</span><span class="ident" id="4956278">ptrmap</span><span class="op" id="4956284">[</span><span class="ident" id="4956285">ptr</span><span class="op" id="4956288">]</span>&nbsp;<span class="op" id="4956290">=</span>&nbsp;<span class="ident" id="4956292">p</span><span class="op" id="4956293">.</span><span class="ident" id="4956294">line</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956302">p</span><span class="op" id="4956303">.</span><span class="builtinfunc" id="4956304">print</span><span class="op" id="4956309">(</span><span class="ident" id="4956310">x</span><span class="op" id="4956311">.</span><span class="ident" id="4956312">Elem</span><span class="op" id="4956316">(</span><span class="op" id="4956317">)</span><span class="op" id="4956318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4956322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956326">case</span>&nbsp;<span class="ident" id="4956331">reflect</span><span class="op" id="4956338">.</span><span class="ident" id="4956339">Array</span><span class="op" id="4956344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956348">p</span><span class="op" id="4956349">.</span><span class="ident" id="4956350">printf</span><span class="op" id="4956356">(</span><span class="string" id="4956357">&#34;%s&nbsp;{&#34;</span><span class="op" id="4956363">,</span>&nbsp;<span class="ident" id="4956365">x</span><span class="op" id="4956366">.</span><span class="ident" id="4956367">Type</span><span class="op" id="4956371">(</span><span class="op" id="4956372">)</span><span class="op" id="4956373">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956377">if</span>&nbsp;<span class="ident" id="4956380">x</span><span class="op" id="4956381">.</span><span class="ident" id="4956382">Len</span><span class="op" id="4956385">(</span><span class="op" id="4956386">)</span>&nbsp;<span class="op" id="4956388">&gt;</span>&nbsp;<span class="num" id="4956390">0</span>&nbsp;<span class="op" id="4956392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956397">p</span><span class="op" id="4956398">.</span><span class="ident" id="4956399">indent</span><span class="op" id="4956405">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956411">p</span><span class="op" id="4956412">.</span><span class="ident" id="4956413">printf</span><span class="op" id="4956419">(</span><span class="string" id="4956420">&#34;\n&#34;</span><span class="op" id="4956424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956429">for</span>&nbsp;<span class="ident" id="4956433">i</span><span class="op" id="4956434">,</span>&nbsp;<span class="ident" id="4956436">n</span>&nbsp;<span class="op" id="4956438">:=</span>&nbsp;<span class="num" id="4956441">0</span><span class="op" id="4956442">,</span>&nbsp;<span class="ident" id="4956444">x</span><span class="op" id="4956445">.</span><span class="ident" id="4956446">Len</span><span class="op" id="4956449">(</span><span class="op" id="4956450">)</span><span class="op" id="4956451">;</span>&nbsp;<span class="ident" id="4956453">i</span>&nbsp;<span class="op" id="4956455">&lt;</span>&nbsp;<span class="ident" id="4956457">n</span><span class="op" id="4956458">;</span>&nbsp;<span class="ident" id="4956460">i</span><span class="op" id="4956461">++</span>&nbsp;<span class="op" id="4956464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956470">p</span><span class="op" id="4956471">.</span><span class="ident" id="4956472">printf</span><span class="op" id="4956478">(</span><span class="string" id="4956479">&#34;%d:&nbsp;&#34;</span><span class="op" id="4956485">,</span>&nbsp;<span class="ident" id="4956487">i</span><span class="op" id="4956488">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956494">p</span><span class="op" id="4956495">.</span><span class="builtinfunc" id="4956496">print</span><span class="op" id="4956501">(</span><span class="ident" id="4956502">x</span><span class="op" id="4956503">.</span><span class="ident" id="4956504">Index</span><span class="op" id="4956509">(</span><span class="ident" id="4956510">i</span><span class="op" id="4956511">)</span><span class="op" id="4956512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956518">p</span><span class="op" id="4956519">.</span><span class="ident" id="4956520">printf</span><span class="op" id="4956526">(</span><span class="string" id="4956527">&#34;\n&#34;</span><span class="op" id="4956531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4956536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956541">p</span><span class="op" id="4956542">.</span><span class="ident" id="4956543">indent</span><span class="op" id="4956549">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4956554">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956558">p</span><span class="op" id="4956559">.</span><span class="ident" id="4956560">printf</span><span class="op" id="4956566">(</span><span class="string" id="4956567">&#34;}&#34;</span><span class="op" id="4956570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956574">case</span>&nbsp;<span class="ident" id="4956579">reflect</span><span class="op" id="4956586">.</span><span class="ident" id="4956587">Slice</span><span class="op" id="4956592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956596">if</span>&nbsp;<span class="ident" id="4956599">s</span><span class="op" id="4956600">,</span>&nbsp;<span class="ident" id="4956602">ok</span>&nbsp;<span class="op" id="4956605">:=</span>&nbsp;<span class="ident" id="4956608">x</span><span class="op" id="4956609">.</span><span class="ident" id="4956610">Interface</span><span class="op" id="4956619">(</span><span class="op" id="4956620">)</span><span class="op" id="4956621">.</span><span class="op" id="4956622">(</span><span class="op" id="4956623">[</span><span class="op" id="4956624">]</span><span class="builtintype" id="4956625">byte</span><span class="op" id="4956629">)</span><span class="op" id="4956630">;</span>&nbsp;<span class="ident" id="4956632">ok</span>&nbsp;<span class="op" id="4956635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956640">p</span><span class="op" id="4956641">.</span><span class="ident" id="4956642">printf</span><span class="op" id="4956648">(</span><span class="string" id="4956649">&#34;%#q&#34;</span><span class="op" id="4956654">,</span>&nbsp;<span class="ident" id="4956656">s</span><span class="op" id="4956657">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956662">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4956671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956675">p</span><span class="op" id="4956676">.</span><span class="ident" id="4956677">printf</span><span class="op" id="4956683">(</span><span class="string" id="4956684">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="4956701">,</span>&nbsp;<span class="ident" id="4956703">x</span><span class="op" id="4956704">.</span><span class="ident" id="4956705">Type</span><span class="op" id="4956709">(</span><span class="op" id="4956710">)</span><span class="op" id="4956711">,</span>&nbsp;<span class="ident" id="4956713">x</span><span class="op" id="4956714">.</span><span class="ident" id="4956715">Len</span><span class="op" id="4956718">(</span><span class="op" id="4956719">)</span><span class="op" id="4956720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956724">if</span>&nbsp;<span class="ident" id="4956727">x</span><span class="op" id="4956728">.</span><span class="ident" id="4956729">Len</span><span class="op" id="4956732">(</span><span class="op" id="4956733">)</span>&nbsp;<span class="op" id="4956735">&gt;</span>&nbsp;<span class="num" id="4956737">0</span>&nbsp;<span class="op" id="4956739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956744">p</span><span class="op" id="4956745">.</span><span class="ident" id="4956746">indent</span><span class="op" id="4956752">++</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956758">p</span><span class="op" id="4956759">.</span><span class="ident" id="4956760">printf</span><span class="op" id="4956766">(</span><span class="string" id="4956767">&#34;\n&#34;</span><span class="op" id="4956771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956776">for</span>&nbsp;<span class="ident" id="4956780">i</span><span class="op" id="4956781">,</span>&nbsp;<span class="ident" id="4956783">n</span>&nbsp;<span class="op" id="4956785">:=</span>&nbsp;<span class="num" id="4956788">0</span><span class="op" id="4956789">,</span>&nbsp;<span class="ident" id="4956791">x</span><span class="op" id="4956792">.</span><span class="ident" id="4956793">Len</span><span class="op" id="4956796">(</span><span class="op" id="4956797">)</span><span class="op" id="4956798">;</span>&nbsp;<span class="ident" id="4956800">i</span>&nbsp;<span class="op" id="4956802">&lt;</span>&nbsp;<span class="ident" id="4956804">n</span><span class="op" id="4956805">;</span>&nbsp;<span class="ident" id="4956807">i</span><span class="op" id="4956808">++</span>&nbsp;<span class="op" id="4956811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956817">p</span><span class="op" id="4956818">.</span><span class="ident" id="4956819">printf</span><span class="op" id="4956825">(</span><span class="string" id="4956826">&#34;%d:&nbsp;&#34;</span><span class="op" id="4956832">,</span>&nbsp;<span class="ident" id="4956834">i</span><span class="op" id="4956835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956841">p</span><span class="op" id="4956842">.</span><span class="builtinfunc" id="4956843">print</span><span class="op" id="4956848">(</span><span class="ident" id="4956849">x</span><span class="op" id="4956850">.</span><span class="ident" id="4956851">Index</span><span class="op" id="4956856">(</span><span class="ident" id="4956857">i</span><span class="op" id="4956858">)</span><span class="op" id="4956859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956865">p</span><span class="op" id="4956866">.</span><span class="ident" id="4956867">printf</span><span class="op" id="4956873">(</span><span class="string" id="4956874">&#34;\n&#34;</span><span class="op" id="4956878">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4956883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956888">p</span><span class="op" id="4956889">.</span><span class="ident" id="4956890">indent</span><span class="op" id="4956896">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4956901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956905">p</span><span class="op" id="4956906">.</span><span class="ident" id="4956907">printf</span><span class="op" id="4956913">(</span><span class="string" id="4956914">&#34;}&#34;</span><span class="op" id="4956917">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4956921">case</span>&nbsp;<span class="ident" id="4956926">reflect</span><span class="op" id="4956933">.</span><span class="ident" id="4956934">Struct</span><span class="op" id="4956940">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956944">t</span>&nbsp;<span class="op" id="4956946">:=</span>&nbsp;<span class="ident" id="4956949">x</span><span class="op" id="4956950">.</span><span class="ident" id="4956951">Type</span><span class="op" id="4956955">(</span><span class="op" id="4956956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956960">p</span><span class="op" id="4956961">.</span><span class="ident" id="4956962">printf</span><span class="op" id="4956968">(</span><span class="string" id="4956969">&#34;%s&nbsp;{&#34;</span><span class="op" id="4956975">,</span>&nbsp;<span class="ident" id="4956977">t</span><span class="op" id="4956978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956982">p</span><span class="op" id="4956983">.</span><span class="ident" id="4956984">indent</span><span class="op" id="4956990">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4956995">first</span>&nbsp;<span class="op" id="4957001">:=</span>&nbsp;<span class="builtintype" id="4957004">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957011">for</span>&nbsp;<span class="ident" id="4957015">i</span><span class="op" id="4957016">,</span>&nbsp;<span class="ident" id="4957018">n</span>&nbsp;<span class="op" id="4957020">:=</span>&nbsp;<span class="num" id="4957023">0</span><span class="op" id="4957024">,</span>&nbsp;<span class="ident" id="4957026">t</span><span class="op" id="4957027">.</span><span class="ident" id="4957028">NumField</span><span class="op" id="4957036">(</span><span class="op" id="4957037">)</span><span class="op" id="4957038">;</span>&nbsp;<span class="ident" id="4957040">i</span>&nbsp;<span class="op" id="4957042">&lt;</span>&nbsp;<span class="ident" id="4957044">n</span><span class="op" id="4957045">;</span>&nbsp;<span class="ident" id="4957047">i</span><span class="op" id="4957048">++</span>&nbsp;<span class="op" id="4957051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4957056">//&nbsp;exclude&nbsp;non-exported&nbsp;fields&nbsp;because&nbsp;their</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4957104">//&nbsp;values&nbsp;cannot&nbsp;be&nbsp;accessed&nbsp;via&nbsp;reflection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957151">if</span>&nbsp;<span class="ident" id="4957154">name</span>&nbsp;<span class="op" id="4957159">:=</span>&nbsp;<span class="ident" id="4957162">t</span><span class="op" id="4957163">.</span><span class="ident" id="4957164">Field</span><span class="op" id="4957169">(</span><span class="ident" id="4957170">i</span><span class="op" id="4957171">)</span><span class="op" id="4957172">.</span><span class="ident" id="4957173">Name</span><span class="op" id="4957177">;</span>&nbsp;<span class="ident" id="4957179">IsExported</span><span class="op" id="4957189">(</span><span class="ident" id="4957190">name</span><span class="op" id="4957194">)</span>&nbsp;<span class="op" id="4957196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957202">value</span>&nbsp;<span class="op" id="4957208">:=</span>&nbsp;<span class="ident" id="4957211">x</span><span class="op" id="4957212">.</span><span class="ident" id="4957213">Field</span><span class="op" id="4957218">(</span><span class="ident" id="4957219">i</span><span class="op" id="4957220">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957226">if</span>&nbsp;<span class="ident" id="4957229">p</span><span class="op" id="4957230">.</span><span class="ident" id="4957231">filter</span>&nbsp;<span class="op" id="4957238">==</span>&nbsp;<span class="builtintype" id="4957241">nil</span>&nbsp;<span class="op" id="4957245">||</span>&nbsp;<span class="ident" id="4957248">p</span><span class="op" id="4957249">.</span><span class="ident" id="4957250">filter</span><span class="op" id="4957256">(</span><span class="ident" id="4957257">name</span><span class="op" id="4957261">,</span>&nbsp;<span class="ident" id="4957263">value</span><span class="op" id="4957268">)</span>&nbsp;<span class="op" id="4957270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957277">if</span>&nbsp;<span class="ident" id="4957280">first</span>&nbsp;<span class="op" id="4957286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957294">p</span><span class="op" id="4957295">.</span><span class="ident" id="4957296">printf</span><span class="op" id="4957302">(</span><span class="string" id="4957303">&#34;\n&#34;</span><span class="op" id="4957307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957315">first</span>&nbsp;<span class="op" id="4957321">=</span>&nbsp;<span class="builtintype" id="4957323">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4957334">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957341">p</span><span class="op" id="4957342">.</span><span class="ident" id="4957343">printf</span><span class="op" id="4957349">(</span><span class="string" id="4957350">&#34;%s:&nbsp;&#34;</span><span class="op" id="4957356">,</span>&nbsp;<span class="ident" id="4957358">name</span><span class="op" id="4957362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957369">p</span><span class="op" id="4957370">.</span><span class="builtinfunc" id="4957371">print</span><span class="op" id="4957376">(</span><span class="ident" id="4957377">value</span><span class="op" id="4957382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957389">p</span><span class="op" id="4957390">.</span><span class="ident" id="4957391">printf</span><span class="op" id="4957397">(</span><span class="string" id="4957398">&#34;\n&#34;</span><span class="op" id="4957402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4957408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4957413">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4957417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957421">p</span><span class="op" id="4957422">.</span><span class="ident" id="4957423">indent</span><span class="op" id="4957429">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957434">p</span><span class="op" id="4957435">.</span><span class="ident" id="4957436">printf</span><span class="op" id="4957442">(</span><span class="string" id="4957443">&#34;}&#34;</span><span class="op" id="4957446">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957450">default</span><span class="op" id="4957457">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957461">v</span>&nbsp;<span class="op" id="4957463">:=</span>&nbsp;<span class="ident" id="4957466">x</span><span class="op" id="4957467">.</span><span class="ident" id="4957468">Interface</span><span class="op" id="4957477">(</span><span class="op" id="4957478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957482">switch</span>&nbsp;<span class="ident" id="4957489">v</span>&nbsp;<span class="op" id="4957491">:=</span>&nbsp;<span class="ident" id="4957494">v</span><span class="op" id="4957495">.</span><span class="op" id="4957496">(</span><span class="keyword" id="4957497">type</span><span class="op" id="4957501">)</span>&nbsp;<span class="op" id="4957503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957507">case</span>&nbsp;<span class="builtintype" id="4957512">string</span><span class="op" id="4957518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4957523">//&nbsp;print&nbsp;strings&nbsp;in&nbsp;quotes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957553">p</span><span class="op" id="4957554">.</span><span class="ident" id="4957555">printf</span><span class="op" id="4957561">(</span><span class="string" id="4957562">&#34;%q&#34;</span><span class="op" id="4957566">,</span>&nbsp;<span class="ident" id="4957568">v</span><span class="op" id="4957569">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957574">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957583">case</span>&nbsp;<span class="ident" id="4957588">token</span><span class="op" id="4957593">.</span><span class="ident" id="4957594">Pos</span><span class="op" id="4957597">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4957602">//&nbsp;position&nbsp;values&nbsp;can&nbsp;be&nbsp;printed&nbsp;nicely&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957668">if</span>&nbsp;<span class="ident" id="4957671">p</span><span class="op" id="4957672">.</span><span class="ident" id="4957673">fset</span>&nbsp;<span class="op" id="4957678">!=</span>&nbsp;<span class="builtintype" id="4957681">nil</span>&nbsp;<span class="op" id="4957685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957691">p</span><span class="op" id="4957692">.</span><span class="ident" id="4957693">printf</span><span class="op" id="4957699">(</span><span class="string" id="4957700">&#34;%s&#34;</span><span class="op" id="4957704">,</span>&nbsp;<span class="ident" id="4957706">p</span><span class="op" id="4957707">.</span><span class="ident" id="4957708">fset</span><span class="op" id="4957712">.</span><span class="ident" id="4957713">Position</span><span class="op" id="4957721">(</span><span class="ident" id="4957722">v</span><span class="op" id="4957723">)</span><span class="op" id="4957724">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4957730">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4957740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4957744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4957748">//&nbsp;default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4957761">p</span><span class="op" id="4957762">.</span><span class="ident" id="4957763">printf</span><span class="op" id="4957769">(</span><span class="string" id="4957770">&#34;%v&#34;</span><span class="op" id="4957774">,</span>&nbsp;<span class="ident" id="4957776">v</span><span class="op" id="4957777">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4957780">}</span><br>
<span class="lineno"></span><span class="op" id="4957782">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
