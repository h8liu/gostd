<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/jpeg</h2>
<ul>
<li><a href="/gostd/image/jpeg/dct_test.go.html">dct_test.go</a></li>
<li><a href="/gostd/image/jpeg/fdct.go.html">fdct.go</a></li>
<li><a href="/gostd/image/jpeg/huffman.go.html">huffman.go</a></li>
<li><a href="/gostd/image/jpeg/idct.go.html">idct.go</a></li>
<li><a href="/gostd/image/jpeg/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/jpeg/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/jpeg/scan.go.html">scan.go</a></li>
<li><a href="/gostd/image/jpeg/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/jpeg/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7155635">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7155690">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7155744">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7155795">package</span>&nbsp;<span class="ident" id="7155803">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7155809">import</span>&nbsp;<span class="op" id="7155816">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7155819">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7155828">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7155835">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7155844">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7155859">&#34;image/png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7155872">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7155885">&#34;math/rand&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7155898">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7155904">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7155914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7155917">//&nbsp;zigzag&nbsp;maps&nbsp;from&nbsp;the&nbsp;natural&nbsp;ordering&nbsp;to&nbsp;the&nbsp;zig-zag&nbsp;ordering.&nbsp;For&nbsp;example,</span><br>
<span class="lineno">20</span><span class="comment" id="7155996">//&nbsp;zigzag[0*8&nbsp;+&nbsp;3]&nbsp;is&nbsp;the&nbsp;zig-zag&nbsp;sequence&nbsp;number&nbsp;of&nbsp;the&nbsp;element&nbsp;in&nbsp;the&nbsp;fourth</span><br>
<span class="lineno"></span><span class="comment" id="7156075">//&nbsp;column&nbsp;and&nbsp;first&nbsp;row.</span><br>
<span class="lineno"></span><span class="keyword" id="7156100">var</span>&nbsp;<span class="ident" id="7156104">zigzag</span>&nbsp;<span class="op" id="7156111">=</span>&nbsp;<span class="op" id="7156113">[</span><span class="ident" id="7156114">blockSize</span><span class="op" id="7156123">]</span><span class="builtintype" id="7156124">int</span><span class="op" id="7156127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156130">0</span><span class="op" id="7156131">,</span>&nbsp;<span class="num" id="7156133">1</span><span class="op" id="7156134">,</span>&nbsp;<span class="num" id="7156136">5</span><span class="op" id="7156137">,</span>&nbsp;<span class="num" id="7156139">6</span><span class="op" id="7156140">,</span>&nbsp;<span class="num" id="7156142">14</span><span class="op" id="7156144">,</span>&nbsp;<span class="num" id="7156146">15</span><span class="op" id="7156148">,</span>&nbsp;<span class="num" id="7156150">27</span><span class="op" id="7156152">,</span>&nbsp;<span class="num" id="7156154">28</span><span class="op" id="7156156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156159">2</span><span class="op" id="7156160">,</span>&nbsp;<span class="num" id="7156162">4</span><span class="op" id="7156163">,</span>&nbsp;<span class="num" id="7156165">7</span><span class="op" id="7156166">,</span>&nbsp;<span class="num" id="7156168">13</span><span class="op" id="7156170">,</span>&nbsp;<span class="num" id="7156172">16</span><span class="op" id="7156174">,</span>&nbsp;<span class="num" id="7156176">26</span><span class="op" id="7156178">,</span>&nbsp;<span class="num" id="7156180">29</span><span class="op" id="7156182">,</span>&nbsp;<span class="num" id="7156184">42</span><span class="op" id="7156186">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156189">3</span><span class="op" id="7156190">,</span>&nbsp;<span class="num" id="7156192">8</span><span class="op" id="7156193">,</span>&nbsp;<span class="num" id="7156195">12</span><span class="op" id="7156197">,</span>&nbsp;<span class="num" id="7156199">17</span><span class="op" id="7156201">,</span>&nbsp;<span class="num" id="7156203">25</span><span class="op" id="7156205">,</span>&nbsp;<span class="num" id="7156207">30</span><span class="op" id="7156209">,</span>&nbsp;<span class="num" id="7156211">41</span><span class="op" id="7156213">,</span>&nbsp;<span class="num" id="7156215">43</span><span class="op" id="7156217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156220">9</span><span class="op" id="7156221">,</span>&nbsp;<span class="num" id="7156223">11</span><span class="op" id="7156225">,</span>&nbsp;<span class="num" id="7156227">18</span><span class="op" id="7156229">,</span>&nbsp;<span class="num" id="7156231">24</span><span class="op" id="7156233">,</span>&nbsp;<span class="num" id="7156235">31</span><span class="op" id="7156237">,</span>&nbsp;<span class="num" id="7156239">40</span><span class="op" id="7156241">,</span>&nbsp;<span class="num" id="7156243">44</span><span class="op" id="7156245">,</span>&nbsp;<span class="num" id="7156247">53</span><span class="op" id="7156249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156252">10</span><span class="op" id="7156254">,</span>&nbsp;<span class="num" id="7156256">19</span><span class="op" id="7156258">,</span>&nbsp;<span class="num" id="7156260">23</span><span class="op" id="7156262">,</span>&nbsp;<span class="num" id="7156264">32</span><span class="op" id="7156266">,</span>&nbsp;<span class="num" id="7156268">39</span><span class="op" id="7156270">,</span>&nbsp;<span class="num" id="7156272">45</span><span class="op" id="7156274">,</span>&nbsp;<span class="num" id="7156276">52</span><span class="op" id="7156278">,</span>&nbsp;<span class="num" id="7156280">54</span><span class="op" id="7156282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156285">20</span><span class="op" id="7156287">,</span>&nbsp;<span class="num" id="7156289">22</span><span class="op" id="7156291">,</span>&nbsp;<span class="num" id="7156293">33</span><span class="op" id="7156295">,</span>&nbsp;<span class="num" id="7156297">38</span><span class="op" id="7156299">,</span>&nbsp;<span class="num" id="7156301">46</span><span class="op" id="7156303">,</span>&nbsp;<span class="num" id="7156305">51</span><span class="op" id="7156307">,</span>&nbsp;<span class="num" id="7156309">55</span><span class="op" id="7156311">,</span>&nbsp;<span class="num" id="7156313">60</span><span class="op" id="7156315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156318">21</span><span class="op" id="7156320">,</span>&nbsp;<span class="num" id="7156322">34</span><span class="op" id="7156324">,</span>&nbsp;<span class="num" id="7156326">37</span><span class="op" id="7156328">,</span>&nbsp;<span class="num" id="7156330">47</span><span class="op" id="7156332">,</span>&nbsp;<span class="num" id="7156334">50</span><span class="op" id="7156336">,</span>&nbsp;<span class="num" id="7156338">56</span><span class="op" id="7156340">,</span>&nbsp;<span class="num" id="7156342">59</span><span class="op" id="7156344">,</span>&nbsp;<span class="num" id="7156346">61</span><span class="op" id="7156348">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156351">35</span><span class="op" id="7156353">,</span>&nbsp;<span class="num" id="7156355">36</span><span class="op" id="7156357">,</span>&nbsp;<span class="num" id="7156359">48</span><span class="op" id="7156361">,</span>&nbsp;<span class="num" id="7156363">49</span><span class="op" id="7156365">,</span>&nbsp;<span class="num" id="7156367">57</span><span class="op" id="7156369">,</span>&nbsp;<span class="num" id="7156371">58</span><span class="op" id="7156373">,</span>&nbsp;<span class="num" id="7156375">62</span><span class="op" id="7156377">,</span>&nbsp;<span class="num" id="7156379">63</span><span class="op" id="7156381">,</span><br>
<span class="lineno"></span><span class="op" id="7156383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7156386">func</span>&nbsp;<span class="ident" id="7156391">TestZigUnzig</span><span class="op" id="7156403">(</span><span class="ident" id="7156404">t</span>&nbsp;<span class="op" id="7156406">*</span><span class="ident" id="7156407">testing</span><span class="op" id="7156414">.</span><span class="ident" id="7156415">T</span><span class="op" id="7156416">)</span>&nbsp;<span class="op" id="7156418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7156421">for</span>&nbsp;<span class="ident" id="7156425">i</span>&nbsp;<span class="op" id="7156427">:=</span>&nbsp;<span class="num" id="7156430">0</span><span class="op" id="7156431">;</span>&nbsp;<span class="ident" id="7156433">i</span>&nbsp;<span class="op" id="7156435">&lt;</span>&nbsp;<span class="ident" id="7156437">blockSize</span><span class="op" id="7156446">;</span>&nbsp;<span class="ident" id="7156448">i</span><span class="op" id="7156449">++</span>&nbsp;<span class="op" id="7156452">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7156456">if</span>&nbsp;<span class="ident" id="7156459">unzig</span><span class="op" id="7156464">[</span><span class="ident" id="7156465">zigzag</span><span class="op" id="7156471">[</span><span class="ident" id="7156472">i</span><span class="op" id="7156473">]</span><span class="op" id="7156474">]</span>&nbsp;<span class="op" id="7156476">!=</span>&nbsp;<span class="ident" id="7156479">i</span>&nbsp;<span class="op" id="7156481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7156486">t</span><span class="op" id="7156487">.</span><span class="ident" id="7156488">Errorf</span><span class="op" id="7156494">(</span><span class="string" id="7156495">&#34;unzig[zigzag[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7156520">,</span>&nbsp;<span class="ident" id="7156522">i</span><span class="op" id="7156523">,</span>&nbsp;<span class="ident" id="7156525">unzig</span><span class="op" id="7156530">[</span><span class="ident" id="7156531">zigzag</span><span class="op" id="7156537">[</span><span class="ident" id="7156538">i</span><span class="op" id="7156539">]</span><span class="op" id="7156540">]</span><span class="op" id="7156541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7156545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7156549">if</span>&nbsp;<span class="ident" id="7156552">zigzag</span><span class="op" id="7156558">[</span><span class="ident" id="7156559">unzig</span><span class="op" id="7156564">[</span><span class="ident" id="7156565">i</span><span class="op" id="7156566">]</span><span class="op" id="7156567">]</span>&nbsp;<span class="op" id="7156569">!=</span>&nbsp;<span class="ident" id="7156572">i</span>&nbsp;<span class="op" id="7156574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7156579">t</span><span class="op" id="7156580">.</span><span class="ident" id="7156581">Errorf</span><span class="op" id="7156587">(</span><span class="string" id="7156588">&#34;zigzag[unzig[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7156613">,</span>&nbsp;<span class="ident" id="7156615">i</span><span class="op" id="7156616">,</span>&nbsp;<span class="ident" id="7156618">zigzag</span><span class="op" id="7156624">[</span><span class="ident" id="7156625">unzig</span><span class="op" id="7156630">[</span><span class="ident" id="7156631">i</span><span class="op" id="7156632">]</span><span class="op" id="7156633">]</span><span class="op" id="7156634">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7156638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7156641">}</span><br>
<span class="lineno"></span><span class="op" id="7156643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7156646">//&nbsp;unscaledQuantInNaturalOrder&nbsp;are&nbsp;the&nbsp;unscaled&nbsp;quantization&nbsp;tables&nbsp;in</span><br>
<span class="lineno">45</span><span class="comment" id="7156717">//&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;K.1.</span><br>
<span class="lineno"></span><span class="keyword" id="7156778">var</span>&nbsp;<span class="ident" id="7156782">unscaledQuantInNaturalOrder</span>&nbsp;<span class="op" id="7156810">=</span>&nbsp;<span class="op" id="7156812">[</span><span class="ident" id="7156813">nQuantIndex</span><span class="op" id="7156824">]</span><span class="op" id="7156825">[</span><span class="ident" id="7156826">blockSize</span><span class="op" id="7156835">]</span><span class="builtintype" id="7156836">byte</span><span class="op" id="7156840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7156843">//&nbsp;Luminance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7156858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156862">16</span><span class="op" id="7156864">,</span>&nbsp;<span class="num" id="7156866">11</span><span class="op" id="7156868">,</span>&nbsp;<span class="num" id="7156870">10</span><span class="op" id="7156872">,</span>&nbsp;<span class="num" id="7156874">16</span><span class="op" id="7156876">,</span>&nbsp;<span class="num" id="7156878">24</span><span class="op" id="7156880">,</span>&nbsp;<span class="num" id="7156882">40</span><span class="op" id="7156884">,</span>&nbsp;<span class="num" id="7156886">51</span><span class="op" id="7156888">,</span>&nbsp;<span class="num" id="7156890">61</span><span class="op" id="7156892">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156896">12</span><span class="op" id="7156898">,</span>&nbsp;<span class="num" id="7156900">12</span><span class="op" id="7156902">,</span>&nbsp;<span class="num" id="7156904">14</span><span class="op" id="7156906">,</span>&nbsp;<span class="num" id="7156908">19</span><span class="op" id="7156910">,</span>&nbsp;<span class="num" id="7156912">26</span><span class="op" id="7156914">,</span>&nbsp;<span class="num" id="7156916">58</span><span class="op" id="7156918">,</span>&nbsp;<span class="num" id="7156920">60</span><span class="op" id="7156922">,</span>&nbsp;<span class="num" id="7156924">55</span><span class="op" id="7156926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156930">14</span><span class="op" id="7156932">,</span>&nbsp;<span class="num" id="7156934">13</span><span class="op" id="7156936">,</span>&nbsp;<span class="num" id="7156938">16</span><span class="op" id="7156940">,</span>&nbsp;<span class="num" id="7156942">24</span><span class="op" id="7156944">,</span>&nbsp;<span class="num" id="7156946">40</span><span class="op" id="7156948">,</span>&nbsp;<span class="num" id="7156950">57</span><span class="op" id="7156952">,</span>&nbsp;<span class="num" id="7156954">69</span><span class="op" id="7156956">,</span>&nbsp;<span class="num" id="7156958">56</span><span class="op" id="7156960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156964">14</span><span class="op" id="7156966">,</span>&nbsp;<span class="num" id="7156968">17</span><span class="op" id="7156970">,</span>&nbsp;<span class="num" id="7156972">22</span><span class="op" id="7156974">,</span>&nbsp;<span class="num" id="7156976">29</span><span class="op" id="7156978">,</span>&nbsp;<span class="num" id="7156980">51</span><span class="op" id="7156982">,</span>&nbsp;<span class="num" id="7156984">87</span><span class="op" id="7156986">,</span>&nbsp;<span class="num" id="7156988">80</span><span class="op" id="7156990">,</span>&nbsp;<span class="num" id="7156992">62</span><span class="op" id="7156994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7156998">18</span><span class="op" id="7157000">,</span>&nbsp;<span class="num" id="7157002">22</span><span class="op" id="7157004">,</span>&nbsp;<span class="num" id="7157006">37</span><span class="op" id="7157008">,</span>&nbsp;<span class="num" id="7157010">56</span><span class="op" id="7157012">,</span>&nbsp;<span class="num" id="7157014">68</span><span class="op" id="7157016">,</span>&nbsp;<span class="num" id="7157018">109</span><span class="op" id="7157021">,</span>&nbsp;<span class="num" id="7157023">103</span><span class="op" id="7157026">,</span>&nbsp;<span class="num" id="7157028">77</span><span class="op" id="7157030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157034">24</span><span class="op" id="7157036">,</span>&nbsp;<span class="num" id="7157038">35</span><span class="op" id="7157040">,</span>&nbsp;<span class="num" id="7157042">55</span><span class="op" id="7157044">,</span>&nbsp;<span class="num" id="7157046">64</span><span class="op" id="7157048">,</span>&nbsp;<span class="num" id="7157050">81</span><span class="op" id="7157052">,</span>&nbsp;<span class="num" id="7157054">104</span><span class="op" id="7157057">,</span>&nbsp;<span class="num" id="7157059">113</span><span class="op" id="7157062">,</span>&nbsp;<span class="num" id="7157064">92</span><span class="op" id="7157066">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157070">49</span><span class="op" id="7157072">,</span>&nbsp;<span class="num" id="7157074">64</span><span class="op" id="7157076">,</span>&nbsp;<span class="num" id="7157078">78</span><span class="op" id="7157080">,</span>&nbsp;<span class="num" id="7157082">87</span><span class="op" id="7157084">,</span>&nbsp;<span class="num" id="7157086">103</span><span class="op" id="7157089">,</span>&nbsp;<span class="num" id="7157091">121</span><span class="op" id="7157094">,</span>&nbsp;<span class="num" id="7157096">120</span><span class="op" id="7157099">,</span>&nbsp;<span class="num" id="7157101">101</span><span class="op" id="7157104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157108">72</span><span class="op" id="7157110">,</span>&nbsp;<span class="num" id="7157112">92</span><span class="op" id="7157114">,</span>&nbsp;<span class="num" id="7157116">95</span><span class="op" id="7157118">,</span>&nbsp;<span class="num" id="7157120">98</span><span class="op" id="7157122">,</span>&nbsp;<span class="num" id="7157124">112</span><span class="op" id="7157127">,</span>&nbsp;<span class="num" id="7157129">100</span><span class="op" id="7157132">,</span>&nbsp;<span class="num" id="7157134">103</span><span class="op" id="7157137">,</span>&nbsp;<span class="num" id="7157139">99</span><span class="op" id="7157141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7157144">}</span><span class="op" id="7157145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7157148">//&nbsp;Chrominance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7157165">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157169">17</span><span class="op" id="7157171">,</span>&nbsp;<span class="num" id="7157173">18</span><span class="op" id="7157175">,</span>&nbsp;<span class="num" id="7157177">24</span><span class="op" id="7157179">,</span>&nbsp;<span class="num" id="7157181">47</span><span class="op" id="7157183">,</span>&nbsp;<span class="num" id="7157185">99</span><span class="op" id="7157187">,</span>&nbsp;<span class="num" id="7157189">99</span><span class="op" id="7157191">,</span>&nbsp;<span class="num" id="7157193">99</span><span class="op" id="7157195">,</span>&nbsp;<span class="num" id="7157197">99</span><span class="op" id="7157199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157203">18</span><span class="op" id="7157205">,</span>&nbsp;<span class="num" id="7157207">21</span><span class="op" id="7157209">,</span>&nbsp;<span class="num" id="7157211">26</span><span class="op" id="7157213">,</span>&nbsp;<span class="num" id="7157215">66</span><span class="op" id="7157217">,</span>&nbsp;<span class="num" id="7157219">99</span><span class="op" id="7157221">,</span>&nbsp;<span class="num" id="7157223">99</span><span class="op" id="7157225">,</span>&nbsp;<span class="num" id="7157227">99</span><span class="op" id="7157229">,</span>&nbsp;<span class="num" id="7157231">99</span><span class="op" id="7157233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157237">24</span><span class="op" id="7157239">,</span>&nbsp;<span class="num" id="7157241">26</span><span class="op" id="7157243">,</span>&nbsp;<span class="num" id="7157245">56</span><span class="op" id="7157247">,</span>&nbsp;<span class="num" id="7157249">99</span><span class="op" id="7157251">,</span>&nbsp;<span class="num" id="7157253">99</span><span class="op" id="7157255">,</span>&nbsp;<span class="num" id="7157257">99</span><span class="op" id="7157259">,</span>&nbsp;<span class="num" id="7157261">99</span><span class="op" id="7157263">,</span>&nbsp;<span class="num" id="7157265">99</span><span class="op" id="7157267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157271">47</span><span class="op" id="7157273">,</span>&nbsp;<span class="num" id="7157275">66</span><span class="op" id="7157277">,</span>&nbsp;<span class="num" id="7157279">99</span><span class="op" id="7157281">,</span>&nbsp;<span class="num" id="7157283">99</span><span class="op" id="7157285">,</span>&nbsp;<span class="num" id="7157287">99</span><span class="op" id="7157289">,</span>&nbsp;<span class="num" id="7157291">99</span><span class="op" id="7157293">,</span>&nbsp;<span class="num" id="7157295">99</span><span class="op" id="7157297">,</span>&nbsp;<span class="num" id="7157299">99</span><span class="op" id="7157301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157305">99</span><span class="op" id="7157307">,</span>&nbsp;<span class="num" id="7157309">99</span><span class="op" id="7157311">,</span>&nbsp;<span class="num" id="7157313">99</span><span class="op" id="7157315">,</span>&nbsp;<span class="num" id="7157317">99</span><span class="op" id="7157319">,</span>&nbsp;<span class="num" id="7157321">99</span><span class="op" id="7157323">,</span>&nbsp;<span class="num" id="7157325">99</span><span class="op" id="7157327">,</span>&nbsp;<span class="num" id="7157329">99</span><span class="op" id="7157331">,</span>&nbsp;<span class="num" id="7157333">99</span><span class="op" id="7157335">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157339">99</span><span class="op" id="7157341">,</span>&nbsp;<span class="num" id="7157343">99</span><span class="op" id="7157345">,</span>&nbsp;<span class="num" id="7157347">99</span><span class="op" id="7157349">,</span>&nbsp;<span class="num" id="7157351">99</span><span class="op" id="7157353">,</span>&nbsp;<span class="num" id="7157355">99</span><span class="op" id="7157357">,</span>&nbsp;<span class="num" id="7157359">99</span><span class="op" id="7157361">,</span>&nbsp;<span class="num" id="7157363">99</span><span class="op" id="7157365">,</span>&nbsp;<span class="num" id="7157367">99</span><span class="op" id="7157369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157373">99</span><span class="op" id="7157375">,</span>&nbsp;<span class="num" id="7157377">99</span><span class="op" id="7157379">,</span>&nbsp;<span class="num" id="7157381">99</span><span class="op" id="7157383">,</span>&nbsp;<span class="num" id="7157385">99</span><span class="op" id="7157387">,</span>&nbsp;<span class="num" id="7157389">99</span><span class="op" id="7157391">,</span>&nbsp;<span class="num" id="7157393">99</span><span class="op" id="7157395">,</span>&nbsp;<span class="num" id="7157397">99</span><span class="op" id="7157399">,</span>&nbsp;<span class="num" id="7157401">99</span><span class="op" id="7157403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7157407">99</span><span class="op" id="7157409">,</span>&nbsp;<span class="num" id="7157411">99</span><span class="op" id="7157413">,</span>&nbsp;<span class="num" id="7157415">99</span><span class="op" id="7157417">,</span>&nbsp;<span class="num" id="7157419">99</span><span class="op" id="7157421">,</span>&nbsp;<span class="num" id="7157423">99</span><span class="op" id="7157425">,</span>&nbsp;<span class="num" id="7157427">99</span><span class="op" id="7157429">,</span>&nbsp;<span class="num" id="7157431">99</span><span class="op" id="7157433">,</span>&nbsp;<span class="num" id="7157435">99</span><span class="op" id="7157437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7157440">}</span><span class="op" id="7157441">,</span><br>
<span class="lineno"></span><span class="op" id="7157443">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7157446">func</span>&nbsp;<span class="ident" id="7157451">TestUnscaledQuant</span><span class="op" id="7157468">(</span><span class="ident" id="7157469">t</span>&nbsp;<span class="op" id="7157471">*</span><span class="ident" id="7157472">testing</span><span class="op" id="7157479">.</span><span class="ident" id="7157480">T</span><span class="op" id="7157481">)</span>&nbsp;<span class="op" id="7157483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7157486">bad</span>&nbsp;<span class="op" id="7157490">:=</span>&nbsp;<span class="builtintype" id="7157493">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7157500">for</span>&nbsp;<span class="ident" id="7157504">i</span>&nbsp;<span class="op" id="7157506">:=</span>&nbsp;<span class="ident" id="7157509">quantIndex</span><span class="op" id="7157519">(</span><span class="num" id="7157520">0</span><span class="op" id="7157521">)</span><span class="op" id="7157522">;</span>&nbsp;<span class="ident" id="7157524">i</span>&nbsp;<span class="op" id="7157526">&lt;</span>&nbsp;<span class="ident" id="7157528">nQuantIndex</span><span class="op" id="7157539">;</span>&nbsp;<span class="ident" id="7157541">i</span><span class="op" id="7157542">++</span>&nbsp;<span class="op" id="7157545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7157549">for</span>&nbsp;<span class="ident" id="7157553">zig</span>&nbsp;<span class="op" id="7157557">:=</span>&nbsp;<span class="num" id="7157560">0</span><span class="op" id="7157561">;</span>&nbsp;<span class="ident" id="7157563">zig</span>&nbsp;<span class="op" id="7157567">&lt;</span>&nbsp;<span class="ident" id="7157569">blockSize</span><span class="op" id="7157578">;</span>&nbsp;<span class="ident" id="7157580">zig</span><span class="op" id="7157583">++</span>&nbsp;<span class="op" id="7157586">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7157591">got</span>&nbsp;<span class="op" id="7157595">:=</span>&nbsp;<span class="ident" id="7157598">unscaledQuant</span><span class="op" id="7157611">[</span><span class="ident" id="7157612">i</span><span class="op" id="7157613">]</span><span class="op" id="7157614">[</span><span class="ident" id="7157615">zig</span><span class="op" id="7157618">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7157623">want</span>&nbsp;<span class="op" id="7157628">:=</span>&nbsp;<span class="ident" id="7157631">unscaledQuantInNaturalOrder</span><span class="op" id="7157658">[</span><span class="ident" id="7157659">i</span><span class="op" id="7157660">]</span><span class="op" id="7157661">[</span><span class="ident" id="7157662">unzig</span><span class="op" id="7157667">[</span><span class="ident" id="7157668">zig</span><span class="op" id="7157671">]</span><span class="op" id="7157672">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7157677">if</span>&nbsp;<span class="ident" id="7157680">got</span>&nbsp;<span class="op" id="7157684">!=</span>&nbsp;<span class="ident" id="7157687">want</span>&nbsp;<span class="op" id="7157692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7157698">t</span><span class="op" id="7157699">.</span><span class="ident" id="7157700">Errorf</span><span class="op" id="7157706">(</span><span class="string" id="7157707">&#34;i=%d,&nbsp;zig=%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7157738">,</span>&nbsp;<span class="ident" id="7157740">i</span><span class="op" id="7157741">,</span>&nbsp;<span class="ident" id="7157743">zig</span><span class="op" id="7157746">,</span>&nbsp;<span class="ident" id="7157748">got</span><span class="op" id="7157751">,</span>&nbsp;<span class="ident" id="7157753">want</span><span class="op" id="7157757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7157763">bad</span>&nbsp;<span class="op" id="7157767">=</span>&nbsp;<span class="builtintype" id="7157769">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7157777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7157781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7157784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7157787">if</span>&nbsp;<span class="ident" id="7157790">bad</span>&nbsp;<span class="op" id="7157794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7157798">names</span>&nbsp;<span class="op" id="7157804">:=</span>&nbsp;<span class="op" id="7157807">[</span><span class="ident" id="7157808">nQuantIndex</span><span class="op" id="7157819">]</span><span class="builtintype" id="7157820">string</span><span class="op" id="7157826">{</span><span class="string" id="7157827">&#34;Luminance&#34;</span><span class="op" id="7157838">,</span>&nbsp;<span class="string" id="7157840">&#34;Chrominance&#34;</span><span class="op" id="7157853">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7157857">buf</span>&nbsp;<span class="op" id="7157861">:=</span>&nbsp;<span class="op" id="7157864">&amp;</span><span class="ident" id="7157865">bytes</span><span class="op" id="7157870">.</span><span class="ident" id="7157871">Buffer</span><span class="op" id="7157877">{</span><span class="op" id="7157878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7157882">for</span>&nbsp;<span class="ident" id="7157886">i</span><span class="op" id="7157887">,</span>&nbsp;<span class="ident" id="7157889">name</span>&nbsp;<span class="op" id="7157894">:=</span>&nbsp;<span class="keyword" id="7157897">range</span>&nbsp;<span class="ident" id="7157903">names</span>&nbsp;<span class="op" id="7157909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7157914">fmt</span><span class="op" id="7157917">.</span><span class="ident" id="7157918">Fprintf</span><span class="op" id="7157925">(</span><span class="ident" id="7157926">buf</span><span class="op" id="7157929">,</span>&nbsp;<span class="string" id="7157931">&#34;//&nbsp;%s.\n{\n&#34;</span><span class="op" id="7157944">,</span>&nbsp;<span class="ident" id="7157946">name</span><span class="op" id="7157950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7157955">for</span>&nbsp;<span class="ident" id="7157959">zig</span>&nbsp;<span class="op" id="7157963">:=</span>&nbsp;<span class="num" id="7157966">0</span><span class="op" id="7157967">;</span>&nbsp;<span class="ident" id="7157969">zig</span>&nbsp;<span class="op" id="7157973">&lt;</span>&nbsp;<span class="ident" id="7157975">blockSize</span><span class="op" id="7157984">;</span>&nbsp;<span class="ident" id="7157986">zig</span><span class="op" id="7157989">++</span>&nbsp;<span class="op" id="7157992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7157998">fmt</span><span class="op" id="7158001">.</span><span class="ident" id="7158002">Fprintf</span><span class="op" id="7158009">(</span><span class="ident" id="7158010">buf</span><span class="op" id="7158013">,</span>&nbsp;<span class="string" id="7158015">&#34;%d,&nbsp;&#34;</span><span class="op" id="7158021">,</span>&nbsp;<span class="ident" id="7158023">unscaledQuantInNaturalOrder</span><span class="op" id="7158050">[</span><span class="ident" id="7158051">i</span><span class="op" id="7158052">]</span><span class="op" id="7158053">[</span><span class="ident" id="7158054">unzig</span><span class="op" id="7158059">[</span><span class="ident" id="7158060">zig</span><span class="op" id="7158063">]</span><span class="op" id="7158064">]</span><span class="op" id="7158065">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158071">if</span>&nbsp;<span class="ident" id="7158074">zig</span><span class="op" id="7158077">%</span><span class="num" id="7158078">8</span>&nbsp;<span class="op" id="7158080">==</span>&nbsp;<span class="num" id="7158083">7</span>&nbsp;<span class="op" id="7158085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158092">buf</span><span class="op" id="7158095">.</span><span class="ident" id="7158096">WriteString</span><span class="op" id="7158107">(</span><span class="string" id="7158108">&#34;\n&#34;</span><span class="op" id="7158112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158128">buf</span><span class="op" id="7158131">.</span><span class="ident" id="7158132">WriteString</span><span class="op" id="7158143">(</span><span class="string" id="7158144">&#34;},\n&#34;</span><span class="op" id="7158150">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158158">t</span><span class="op" id="7158159">.</span><span class="ident" id="7158160">Logf</span><span class="op" id="7158164">(</span><span class="string" id="7158165">&#34;expected&nbsp;unscaledQuant&nbsp;values:\n%s&#34;</span><span class="op" id="7158201">,</span>&nbsp;<span class="ident" id="7158203">buf</span><span class="op" id="7158206">.</span><span class="ident" id="7158207">String</span><span class="op" id="7158213">(</span><span class="op" id="7158214">)</span><span class="op" id="7158215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158218">}</span><br>
<span class="lineno"></span><span class="op" id="7158220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7158223">var</span>&nbsp;<span class="ident" id="7158227">testCase</span>&nbsp;<span class="op" id="7158236">=</span>&nbsp;<span class="op" id="7158238">[</span><span class="op" id="7158239">]</span><span class="keyword" id="7158240">struct</span>&nbsp;<span class="op" id="7158247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158250">filename</span>&nbsp;&nbsp;<span class="builtintype" id="7158260">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158268">quality</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7158278">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158283">tolerance</span>&nbsp;<span class="ident" id="7158293">int64</span><br>
<span class="lineno"></span><span class="op" id="7158299">}</span><span class="op" id="7158300">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158303">{</span><span class="string" id="7158304">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7158331">,</span>&nbsp;<span class="num" id="7158333">1</span><span class="op" id="7158334">,</span>&nbsp;<span class="num" id="7158336">24</span>&nbsp;<span class="op" id="7158339">&lt;&lt;</span>&nbsp;<span class="num" id="7158342">8</span><span class="op" id="7158343">}</span><span class="op" id="7158344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158347">{</span><span class="string" id="7158348">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7158375">,</span>&nbsp;<span class="num" id="7158377">20</span><span class="op" id="7158379">,</span>&nbsp;<span class="num" id="7158381">12</span>&nbsp;<span class="op" id="7158384">&lt;&lt;</span>&nbsp;<span class="num" id="7158387">8</span><span class="op" id="7158388">}</span><span class="op" id="7158389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158392">{</span><span class="string" id="7158393">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7158420">,</span>&nbsp;<span class="num" id="7158422">60</span><span class="op" id="7158424">,</span>&nbsp;<span class="num" id="7158426">8</span>&nbsp;<span class="op" id="7158428">&lt;&lt;</span>&nbsp;<span class="num" id="7158431">8</span><span class="op" id="7158432">}</span><span class="op" id="7158433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158436">{</span><span class="string" id="7158437">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7158464">,</span>&nbsp;<span class="num" id="7158466">80</span><span class="op" id="7158468">,</span>&nbsp;<span class="num" id="7158470">6</span>&nbsp;<span class="op" id="7158472">&lt;&lt;</span>&nbsp;<span class="num" id="7158475">8</span><span class="op" id="7158476">}</span><span class="op" id="7158477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158480">{</span><span class="string" id="7158481">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7158508">,</span>&nbsp;<span class="num" id="7158510">90</span><span class="op" id="7158512">,</span>&nbsp;<span class="num" id="7158514">4</span>&nbsp;<span class="op" id="7158516">&lt;&lt;</span>&nbsp;<span class="num" id="7158519">8</span><span class="op" id="7158520">}</span><span class="op" id="7158521">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158524">{</span><span class="string" id="7158525">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7158552">,</span>&nbsp;<span class="num" id="7158554">100</span><span class="op" id="7158557">,</span>&nbsp;<span class="num" id="7158559">2</span>&nbsp;<span class="op" id="7158561">&lt;&lt;</span>&nbsp;<span class="num" id="7158564">8</span><span class="op" id="7158565">}</span><span class="op" id="7158566">,</span><br>
<span class="lineno"></span><span class="op" id="7158568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7158571">func</span>&nbsp;<span class="ident" id="7158576">delta</span><span class="op" id="7158581">(</span><span class="ident" id="7158582">u0</span><span class="op" id="7158584">,</span>&nbsp;<span class="ident" id="7158586">u1</span>&nbsp;<span class="builtintype" id="7158589">uint32</span><span class="op" id="7158595">)</span>&nbsp;<span class="ident" id="7158597">int64</span>&nbsp;<span class="op" id="7158603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158606">d</span>&nbsp;<span class="op" id="7158608">:=</span>&nbsp;<span class="ident" id="7158611">int64</span><span class="op" id="7158616">(</span><span class="ident" id="7158617">u0</span><span class="op" id="7158619">)</span>&nbsp;<span class="op" id="7158621">-</span>&nbsp;<span class="ident" id="7158623">int64</span><span class="op" id="7158628">(</span><span class="ident" id="7158629">u1</span><span class="op" id="7158631">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158634">if</span>&nbsp;<span class="ident" id="7158637">d</span>&nbsp;<span class="op" id="7158639">&lt;</span>&nbsp;<span class="num" id="7158641">0</span>&nbsp;<span class="op" id="7158643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158647">return</span>&nbsp;<span class="op" id="7158654">-</span><span class="ident" id="7158655">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158661">return</span>&nbsp;<span class="ident" id="7158668">d</span><br>
<span class="lineno"></span><span class="op" id="7158670">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7158673">func</span>&nbsp;<span class="ident" id="7158678">readPng</span><span class="op" id="7158685">(</span><span class="ident" id="7158686">filename</span>&nbsp;<span class="builtintype" id="7158695">string</span><span class="op" id="7158701">)</span>&nbsp;<span class="op" id="7158703">(</span><span class="ident" id="7158704">image</span><span class="op" id="7158709">.</span><span class="ident" id="7158710">Image</span><span class="op" id="7158715">,</span>&nbsp;<span class="builtintype" id="7158717">error</span><span class="op" id="7158722">)</span>&nbsp;<span class="op" id="7158724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158727">f</span><span class="op" id="7158728">,</span>&nbsp;<span class="ident" id="7158730">err</span>&nbsp;<span class="op" id="7158734">:=</span>&nbsp;<span class="ident" id="7158737">os</span><span class="op" id="7158739">.</span><span class="ident" id="7158740">Open</span><span class="op" id="7158744">(</span><span class="ident" id="7158745">filename</span><span class="op" id="7158753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158756">if</span>&nbsp;<span class="ident" id="7158759">err</span>&nbsp;<span class="op" id="7158763">!=</span>&nbsp;<span class="ident" id="7158766">nil</span>&nbsp;<span class="op" id="7158770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158774">return</span>&nbsp;<span class="ident" id="7158781">nil</span><span class="op" id="7158784">,</span>&nbsp;<span class="ident" id="7158786">err</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7158791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158794">defer</span>&nbsp;<span class="ident" id="7158800">f</span><span class="op" id="7158801">.</span><span class="ident" id="7158802">Close</span><span class="op" id="7158807">(</span><span class="op" id="7158808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158811">return</span>&nbsp;<span class="ident" id="7158818">png</span><span class="op" id="7158821">.</span><span class="ident" id="7158822">Decode</span><span class="op" id="7158828">(</span><span class="ident" id="7158829">f</span><span class="op" id="7158830">)</span><br>
<span class="lineno"></span><span class="op" id="7158832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7158835">func</span>&nbsp;<span class="ident" id="7158840">TestWriter</span><span class="op" id="7158850">(</span><span class="ident" id="7158851">t</span>&nbsp;<span class="op" id="7158853">*</span><span class="ident" id="7158854">testing</span><span class="op" id="7158861">.</span><span class="ident" id="7158862">T</span><span class="op" id="7158863">)</span>&nbsp;<span class="op" id="7158865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158868">for</span>&nbsp;<span class="ident" id="7158872">_</span><span class="op" id="7158873">,</span>&nbsp;<span class="ident" id="7158875">tc</span>&nbsp;<span class="op" id="7158878">:=</span>&nbsp;<span class="keyword" id="7158881">range</span>&nbsp;<span class="ident" id="7158887">testCase</span>&nbsp;<span class="op" id="7158896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7158900">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158921">m0</span><span class="op" id="7158923">,</span>&nbsp;<span class="ident" id="7158925">err</span>&nbsp;<span class="op" id="7158929">:=</span>&nbsp;<span class="ident" id="7158932">readPng</span><span class="op" id="7158939">(</span><span class="ident" id="7158940">tc</span><span class="op" id="7158942">.</span><span class="ident" id="7158943">filename</span><span class="op" id="7158951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7158955">if</span>&nbsp;<span class="ident" id="7158958">err</span>&nbsp;<span class="op" id="7158962">!=</span>&nbsp;<span class="ident" id="7158965">nil</span>&nbsp;<span class="op" id="7158969">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158974">t</span><span class="op" id="7158975">.</span><span class="ident" id="7158976">Error</span><span class="op" id="7158981">(</span><span class="ident" id="7158982">tc</span><span class="op" id="7158984">.</span><span class="ident" id="7158985">filename</span><span class="op" id="7158993">,</span>&nbsp;<span class="ident" id="7158995">err</span><span class="op" id="7158998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159003">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7159014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7159018">//&nbsp;Encode&nbsp;that&nbsp;image&nbsp;as&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159050">var</span>&nbsp;<span class="ident" id="7159054">buf</span>&nbsp;<span class="ident" id="7159058">bytes</span><span class="op" id="7159063">.</span><span class="ident" id="7159064">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159073">err</span>&nbsp;<span class="op" id="7159077">=</span>&nbsp;<span class="ident" id="7159079">Encode</span><span class="op" id="7159085">(</span><span class="op" id="7159086">&amp;</span><span class="ident" id="7159087">buf</span><span class="op" id="7159090">,</span>&nbsp;<span class="ident" id="7159092">m0</span><span class="op" id="7159094">,</span>&nbsp;<span class="op" id="7159096">&amp;</span><span class="ident" id="7159097">Options</span><span class="op" id="7159104">{</span><span class="ident" id="7159105">Quality</span><span class="op" id="7159112">:</span>&nbsp;<span class="ident" id="7159114">tc</span><span class="op" id="7159116">.</span><span class="ident" id="7159117">quality</span><span class="op" id="7159124">}</span><span class="op" id="7159125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159129">if</span>&nbsp;<span class="ident" id="7159132">err</span>&nbsp;<span class="op" id="7159136">!=</span>&nbsp;<span class="ident" id="7159139">nil</span>&nbsp;<span class="op" id="7159143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159148">t</span><span class="op" id="7159149">.</span><span class="ident" id="7159150">Error</span><span class="op" id="7159155">(</span><span class="ident" id="7159156">tc</span><span class="op" id="7159158">.</span><span class="ident" id="7159159">filename</span><span class="op" id="7159167">,</span>&nbsp;<span class="ident" id="7159169">err</span><span class="op" id="7159172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159177">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7159188">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7159192">//&nbsp;Decode&nbsp;that&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159215">m1</span><span class="op" id="7159217">,</span>&nbsp;<span class="ident" id="7159219">err</span>&nbsp;<span class="op" id="7159223">:=</span>&nbsp;<span class="ident" id="7159226">Decode</span><span class="op" id="7159232">(</span><span class="op" id="7159233">&amp;</span><span class="ident" id="7159234">buf</span><span class="op" id="7159237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159241">if</span>&nbsp;<span class="ident" id="7159244">err</span>&nbsp;<span class="op" id="7159248">!=</span>&nbsp;<span class="ident" id="7159251">nil</span>&nbsp;<span class="op" id="7159255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159260">t</span><span class="op" id="7159261">.</span><span class="ident" id="7159262">Error</span><span class="op" id="7159267">(</span><span class="ident" id="7159268">tc</span><span class="op" id="7159270">.</span><span class="ident" id="7159271">filename</span><span class="op" id="7159279">,</span>&nbsp;<span class="ident" id="7159281">err</span><span class="op" id="7159284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159289">continue</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7159300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159304">if</span>&nbsp;<span class="ident" id="7159307">m0</span><span class="op" id="7159309">.</span><span class="ident" id="7159310">Bounds</span><span class="op" id="7159316">(</span><span class="op" id="7159317">)</span>&nbsp;<span class="op" id="7159319">!=</span>&nbsp;<span class="ident" id="7159322">m1</span><span class="op" id="7159324">.</span><span class="ident" id="7159325">Bounds</span><span class="op" id="7159331">(</span><span class="op" id="7159332">)</span>&nbsp;<span class="op" id="7159334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159339">t</span><span class="op" id="7159340">.</span><span class="ident" id="7159341">Errorf</span><span class="op" id="7159347">(</span><span class="string" id="7159348">&#34;%s,&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7159378">,</span>&nbsp;<span class="ident" id="7159380">tc</span><span class="op" id="7159382">.</span><span class="ident" id="7159383">filename</span><span class="op" id="7159391">,</span>&nbsp;<span class="ident" id="7159393">m0</span><span class="op" id="7159395">.</span><span class="ident" id="7159396">Bounds</span><span class="op" id="7159402">(</span><span class="op" id="7159403">)</span><span class="op" id="7159404">,</span>&nbsp;<span class="ident" id="7159406">m1</span><span class="op" id="7159408">.</span><span class="ident" id="7159409">Bounds</span><span class="op" id="7159415">(</span><span class="op" id="7159416">)</span><span class="op" id="7159417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159422">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7159433">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7159437">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159492">if</span>&nbsp;<span class="ident" id="7159495">averageDelta</span><span class="op" id="7159507">(</span><span class="ident" id="7159508">m0</span><span class="op" id="7159510">,</span>&nbsp;<span class="ident" id="7159512">m1</span><span class="op" id="7159514">)</span>&nbsp;<span class="op" id="7159516">&gt;</span>&nbsp;<span class="ident" id="7159518">tc</span><span class="op" id="7159520">.</span><span class="ident" id="7159521">tolerance</span>&nbsp;<span class="op" id="7159531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159536">t</span><span class="op" id="7159537">.</span><span class="ident" id="7159538">Errorf</span><span class="op" id="7159544">(</span><span class="string" id="7159545">&#34;%s,&nbsp;quality=%d:&nbsp;average&nbsp;delta&nbsp;is&nbsp;too&nbsp;high&#34;</span><span class="op" id="7159588">,</span>&nbsp;<span class="ident" id="7159590">tc</span><span class="op" id="7159592">.</span><span class="ident" id="7159593">filename</span><span class="op" id="7159601">,</span>&nbsp;<span class="ident" id="7159603">tc</span><span class="op" id="7159605">.</span><span class="ident" id="7159606">quality</span><span class="op" id="7159613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159618">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7159629">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7159632">}</span><br>
<span class="lineno"></span><span class="op" id="7159634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7159637">//&nbsp;TestWriteGrayscale&nbsp;tests&nbsp;that&nbsp;a&nbsp;grayscale&nbsp;images&nbsp;survives&nbsp;a&nbsp;round-trip</span><br>
<span class="lineno"></span><span class="comment" id="7159711">//&nbsp;through&nbsp;encode/decode&nbsp;cycle.</span><br>
<span class="lineno">165</span><span class="keyword" id="7159743">func</span>&nbsp;<span class="ident" id="7159748">TestWriteGrayscale</span><span class="op" id="7159766">(</span><span class="ident" id="7159767">t</span>&nbsp;<span class="op" id="7159769">*</span><span class="ident" id="7159770">testing</span><span class="op" id="7159777">.</span><span class="ident" id="7159778">T</span><span class="op" id="7159779">)</span>&nbsp;<span class="op" id="7159781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159784">m0</span>&nbsp;<span class="op" id="7159787">:=</span>&nbsp;<span class="ident" id="7159790">image</span><span class="op" id="7159795">.</span><span class="ident" id="7159796">NewGray</span><span class="op" id="7159803">(</span><span class="ident" id="7159804">image</span><span class="op" id="7159809">.</span><span class="ident" id="7159810">Rect</span><span class="op" id="7159814">(</span><span class="num" id="7159815">0</span><span class="op" id="7159816">,</span>&nbsp;<span class="num" id="7159818">0</span><span class="op" id="7159819">,</span>&nbsp;<span class="num" id="7159821">32</span><span class="op" id="7159823">,</span>&nbsp;<span class="num" id="7159825">32</span><span class="op" id="7159827">)</span><span class="op" id="7159828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159831">for</span>&nbsp;<span class="ident" id="7159835">i</span>&nbsp;<span class="op" id="7159837">:=</span>&nbsp;<span class="keyword" id="7159840">range</span>&nbsp;<span class="ident" id="7159846">m0</span><span class="op" id="7159848">.</span><span class="ident" id="7159849">Pix</span>&nbsp;<span class="op" id="7159853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159857">m0</span><span class="op" id="7159859">.</span><span class="ident" id="7159860">Pix</span><span class="op" id="7159863">[</span><span class="ident" id="7159864">i</span><span class="op" id="7159865">]</span>&nbsp;<span class="op" id="7159867">=</span>&nbsp;<span class="builtintype" id="7159869">uint8</span><span class="op" id="7159874">(</span><span class="ident" id="7159875">i</span><span class="op" id="7159876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7159879">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159882">var</span>&nbsp;<span class="ident" id="7159886">buf</span>&nbsp;<span class="ident" id="7159890">bytes</span><span class="op" id="7159895">.</span><span class="ident" id="7159896">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159904">if</span>&nbsp;<span class="ident" id="7159907">err</span>&nbsp;<span class="op" id="7159911">:=</span>&nbsp;<span class="ident" id="7159914">Encode</span><span class="op" id="7159920">(</span><span class="op" id="7159921">&amp;</span><span class="ident" id="7159922">buf</span><span class="op" id="7159925">,</span>&nbsp;<span class="ident" id="7159927">m0</span><span class="op" id="7159929">,</span>&nbsp;<span class="ident" id="7159931">nil</span><span class="op" id="7159934">)</span><span class="op" id="7159935">;</span>&nbsp;<span class="ident" id="7159937">err</span>&nbsp;<span class="op" id="7159941">!=</span>&nbsp;<span class="ident" id="7159944">nil</span>&nbsp;<span class="op" id="7159948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159952">t</span><span class="op" id="7159953">.</span><span class="ident" id="7159954">Fatal</span><span class="op" id="7159959">(</span><span class="ident" id="7159960">err</span><span class="op" id="7159963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7159966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7159969">m1</span><span class="op" id="7159971">,</span>&nbsp;<span class="ident" id="7159973">err</span>&nbsp;<span class="op" id="7159977">:=</span>&nbsp;<span class="ident" id="7159980">Decode</span><span class="op" id="7159986">(</span><span class="op" id="7159987">&amp;</span><span class="ident" id="7159988">buf</span><span class="op" id="7159991">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7159994">if</span>&nbsp;<span class="ident" id="7159997">err</span>&nbsp;<span class="op" id="7160001">!=</span>&nbsp;<span class="ident" id="7160004">nil</span>&nbsp;<span class="op" id="7160008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160012">t</span><span class="op" id="7160013">.</span><span class="ident" id="7160014">Fatal</span><span class="op" id="7160019">(</span><span class="ident" id="7160020">err</span><span class="op" id="7160023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7160026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7160029">if</span>&nbsp;<span class="ident" id="7160032">m0</span><span class="op" id="7160034">.</span><span class="ident" id="7160035">Bounds</span><span class="op" id="7160041">(</span><span class="op" id="7160042">)</span>&nbsp;<span class="op" id="7160044">!=</span>&nbsp;<span class="ident" id="7160047">m1</span><span class="op" id="7160049">.</span><span class="ident" id="7160050">Bounds</span><span class="op" id="7160056">(</span><span class="op" id="7160057">)</span>&nbsp;<span class="op" id="7160059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160063">t</span><span class="op" id="7160064">.</span><span class="ident" id="7160065">Fatalf</span><span class="op" id="7160071">(</span><span class="string" id="7160072">&#34;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7160098">,</span>&nbsp;<span class="ident" id="7160100">m0</span><span class="op" id="7160102">.</span><span class="ident" id="7160103">Bounds</span><span class="op" id="7160109">(</span><span class="op" id="7160110">)</span><span class="op" id="7160111">,</span>&nbsp;<span class="ident" id="7160113">m1</span><span class="op" id="7160115">.</span><span class="ident" id="7160116">Bounds</span><span class="op" id="7160122">(</span><span class="op" id="7160123">)</span><span class="op" id="7160124">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7160127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7160130">if</span>&nbsp;<span class="ident" id="7160133">_</span><span class="op" id="7160134">,</span>&nbsp;<span class="ident" id="7160136">ok</span>&nbsp;<span class="op" id="7160139">:=</span>&nbsp;<span class="ident" id="7160142">m1</span><span class="op" id="7160144">.</span><span class="op" id="7160145">(</span><span class="op" id="7160146">*</span><span class="ident" id="7160147">image</span><span class="op" id="7160152">.</span><span class="ident" id="7160153">Gray</span><span class="op" id="7160157">)</span><span class="op" id="7160158">;</span>&nbsp;<span class="op" id="7160160">!</span><span class="ident" id="7160161">ok</span>&nbsp;<span class="op" id="7160164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160168">t</span><span class="op" id="7160169">.</span><span class="ident" id="7160170">Errorf</span><span class="op" id="7160176">(</span><span class="string" id="7160177">&#34;got&nbsp;%T,&nbsp;want&nbsp;*image.Gray&#34;</span><span class="op" id="7160203">,</span>&nbsp;<span class="ident" id="7160205">m1</span><span class="op" id="7160207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7160210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7160213">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160267">want</span>&nbsp;<span class="op" id="7160272">:=</span>&nbsp;<span class="ident" id="7160275">int64</span><span class="op" id="7160280">(</span><span class="num" id="7160281">2</span>&nbsp;<span class="op" id="7160283">&lt;&lt;</span>&nbsp;<span class="num" id="7160286">8</span><span class="op" id="7160287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7160290">if</span>&nbsp;<span class="ident" id="7160293">got</span>&nbsp;<span class="op" id="7160297">:=</span>&nbsp;<span class="ident" id="7160300">averageDelta</span><span class="op" id="7160312">(</span><span class="ident" id="7160313">m0</span><span class="op" id="7160315">,</span>&nbsp;<span class="ident" id="7160317">m1</span><span class="op" id="7160319">)</span><span class="op" id="7160320">;</span>&nbsp;<span class="ident" id="7160322">got</span>&nbsp;<span class="op" id="7160326">&gt;</span>&nbsp;<span class="ident" id="7160328">want</span>&nbsp;<span class="op" id="7160333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160337">t</span><span class="op" id="7160338">.</span><span class="ident" id="7160339">Errorf</span><span class="op" id="7160345">(</span><span class="string" id="7160346">&#34;average&nbsp;delta&nbsp;too&nbsp;high;&nbsp;got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&#34;</span><span class="op" id="7160390">,</span>&nbsp;<span class="ident" id="7160392">got</span><span class="op" id="7160395">,</span>&nbsp;<span class="ident" id="7160397">want</span><span class="op" id="7160401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7160404">}</span><br>
<span class="lineno"></span><span class="op" id="7160406">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="7160409">//&nbsp;averageDelta&nbsp;returns&nbsp;the&nbsp;average&nbsp;delta&nbsp;in&nbsp;RGB&nbsp;space.&nbsp;The&nbsp;two&nbsp;images&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="7160485">//&nbsp;have&nbsp;the&nbsp;same&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword" id="7160510">func</span>&nbsp;<span class="ident" id="7160515">averageDelta</span><span class="op" id="7160527">(</span><span class="ident" id="7160528">m0</span><span class="op" id="7160530">,</span>&nbsp;<span class="ident" id="7160532">m1</span>&nbsp;<span class="ident" id="7160535">image</span><span class="op" id="7160540">.</span><span class="ident" id="7160541">Image</span><span class="op" id="7160546">)</span>&nbsp;<span class="ident" id="7160548">int64</span>&nbsp;<span class="op" id="7160554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160557">b</span>&nbsp;<span class="op" id="7160559">:=</span>&nbsp;<span class="ident" id="7160562">m0</span><span class="op" id="7160564">.</span><span class="ident" id="7160565">Bounds</span><span class="op" id="7160571">(</span><span class="op" id="7160572">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7160575">var</span>&nbsp;<span class="ident" id="7160579">sum</span><span class="op" id="7160582">,</span>&nbsp;<span class="ident" id="7160584">n</span>&nbsp;<span class="ident" id="7160586">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7160593">for</span>&nbsp;<span class="ident" id="7160597">y</span>&nbsp;<span class="op" id="7160599">:=</span>&nbsp;<span class="ident" id="7160602">b</span><span class="op" id="7160603">.</span><span class="ident" id="7160604">Min</span><span class="op" id="7160607">.</span><span class="ident" id="7160608">Y</span><span class="op" id="7160609">;</span>&nbsp;<span class="ident" id="7160611">y</span>&nbsp;<span class="op" id="7160613">&lt;</span>&nbsp;<span class="ident" id="7160615">b</span><span class="op" id="7160616">.</span><span class="ident" id="7160617">Max</span><span class="op" id="7160620">.</span><span class="ident" id="7160621">Y</span><span class="op" id="7160622">;</span>&nbsp;<span class="ident" id="7160624">y</span><span class="op" id="7160625">++</span>&nbsp;<span class="op" id="7160628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7160632">for</span>&nbsp;<span class="ident" id="7160636">x</span>&nbsp;<span class="op" id="7160638">:=</span>&nbsp;<span class="ident" id="7160641">b</span><span class="op" id="7160642">.</span><span class="ident" id="7160643">Min</span><span class="op" id="7160646">.</span><span class="ident" id="7160647">X</span><span class="op" id="7160648">;</span>&nbsp;<span class="ident" id="7160650">x</span>&nbsp;<span class="op" id="7160652">&lt;</span>&nbsp;<span class="ident" id="7160654">b</span><span class="op" id="7160655">.</span><span class="ident" id="7160656">Max</span><span class="op" id="7160659">.</span><span class="ident" id="7160660">X</span><span class="op" id="7160661">;</span>&nbsp;<span class="ident" id="7160663">x</span><span class="op" id="7160664">++</span>&nbsp;<span class="op" id="7160667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160672">c0</span>&nbsp;<span class="op" id="7160675">:=</span>&nbsp;<span class="ident" id="7160678">m0</span><span class="op" id="7160680">.</span><span class="ident" id="7160681">At</span><span class="op" id="7160683">(</span><span class="ident" id="7160684">x</span><span class="op" id="7160685">,</span>&nbsp;<span class="ident" id="7160687">y</span><span class="op" id="7160688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160693">c1</span>&nbsp;<span class="op" id="7160696">:=</span>&nbsp;<span class="ident" id="7160699">m1</span><span class="op" id="7160701">.</span><span class="ident" id="7160702">At</span><span class="op" id="7160704">(</span><span class="ident" id="7160705">x</span><span class="op" id="7160706">,</span>&nbsp;<span class="ident" id="7160708">y</span><span class="op" id="7160709">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160714">r0</span><span class="op" id="7160716">,</span>&nbsp;<span class="ident" id="7160718">g0</span><span class="op" id="7160720">,</span>&nbsp;<span class="ident" id="7160722">b0</span><span class="op" id="7160724">,</span>&nbsp;<span class="ident" id="7160726">_</span>&nbsp;<span class="op" id="7160728">:=</span>&nbsp;<span class="ident" id="7160731">c0</span><span class="op" id="7160733">.</span><span class="ident" id="7160734">RGBA</span><span class="op" id="7160738">(</span><span class="op" id="7160739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160744">r1</span><span class="op" id="7160746">,</span>&nbsp;<span class="ident" id="7160748">g1</span><span class="op" id="7160750">,</span>&nbsp;<span class="ident" id="7160752">b1</span><span class="op" id="7160754">,</span>&nbsp;<span class="ident" id="7160756">_</span>&nbsp;<span class="op" id="7160758">:=</span>&nbsp;<span class="ident" id="7160761">c1</span><span class="op" id="7160763">.</span><span class="ident" id="7160764">RGBA</span><span class="op" id="7160768">(</span><span class="op" id="7160769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160774">sum</span>&nbsp;<span class="op" id="7160778">+=</span>&nbsp;<span class="ident" id="7160781">delta</span><span class="op" id="7160786">(</span><span class="ident" id="7160787">r0</span><span class="op" id="7160789">,</span>&nbsp;<span class="ident" id="7160791">r1</span><span class="op" id="7160793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160798">sum</span>&nbsp;<span class="op" id="7160802">+=</span>&nbsp;<span class="ident" id="7160805">delta</span><span class="op" id="7160810">(</span><span class="ident" id="7160811">g0</span><span class="op" id="7160813">,</span>&nbsp;<span class="ident" id="7160815">g1</span><span class="op" id="7160817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160822">sum</span>&nbsp;<span class="op" id="7160826">+=</span>&nbsp;<span class="ident" id="7160829">delta</span><span class="op" id="7160834">(</span><span class="ident" id="7160835">b0</span><span class="op" id="7160837">,</span>&nbsp;<span class="ident" id="7160839">b1</span><span class="op" id="7160841">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160846">n</span>&nbsp;<span class="op" id="7160848">+=</span>&nbsp;<span class="num" id="7160851">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7160855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7160858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7160861">return</span>&nbsp;<span class="ident" id="7160868">sum</span>&nbsp;<span class="op" id="7160872">/</span>&nbsp;<span class="ident" id="7160874">n</span><br>
<span class="lineno"></span><span class="op" id="7160876">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="7160879">func</span>&nbsp;<span class="ident" id="7160884">BenchmarkEncode</span><span class="op" id="7160899">(</span><span class="ident" id="7160900">b</span>&nbsp;<span class="op" id="7160902">*</span><span class="ident" id="7160903">testing</span><span class="op" id="7160910">.</span><span class="ident" id="7160911">B</span><span class="op" id="7160912">)</span>&nbsp;<span class="op" id="7160914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160917">b</span><span class="op" id="7160918">.</span><span class="ident" id="7160919">StopTimer</span><span class="op" id="7160928">(</span><span class="op" id="7160929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160932">img</span>&nbsp;<span class="op" id="7160936">:=</span>&nbsp;<span class="ident" id="7160939">image</span><span class="op" id="7160944">.</span><span class="ident" id="7160945">NewRGBA</span><span class="op" id="7160952">(</span><span class="ident" id="7160953">image</span><span class="op" id="7160958">.</span><span class="ident" id="7160959">Rect</span><span class="op" id="7160963">(</span><span class="num" id="7160964">0</span><span class="op" id="7160965">,</span>&nbsp;<span class="num" id="7160967">0</span><span class="op" id="7160968">,</span>&nbsp;<span class="num" id="7160970">640</span><span class="op" id="7160973">,</span>&nbsp;<span class="num" id="7160975">480</span><span class="op" id="7160978">)</span><span class="op" id="7160979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7160982">bo</span>&nbsp;<span class="op" id="7160985">:=</span>&nbsp;<span class="ident" id="7160988">img</span><span class="op" id="7160991">.</span><span class="ident" id="7160992">Bounds</span><span class="op" id="7160998">(</span><span class="op" id="7160999">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7161002">rnd</span>&nbsp;<span class="op" id="7161006">:=</span>&nbsp;<span class="ident" id="7161009">rand</span><span class="op" id="7161013">.</span><span class="ident" id="7161014">New</span><span class="op" id="7161017">(</span><span class="ident" id="7161018">rand</span><span class="op" id="7161022">.</span><span class="ident" id="7161023">NewSource</span><span class="op" id="7161032">(</span><span class="num" id="7161033">123</span><span class="op" id="7161036">)</span><span class="op" id="7161037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7161040">for</span>&nbsp;<span class="ident" id="7161044">y</span>&nbsp;<span class="op" id="7161046">:=</span>&nbsp;<span class="ident" id="7161049">bo</span><span class="op" id="7161051">.</span><span class="ident" id="7161052">Min</span><span class="op" id="7161055">.</span><span class="ident" id="7161056">Y</span><span class="op" id="7161057">;</span>&nbsp;<span class="ident" id="7161059">y</span>&nbsp;<span class="op" id="7161061">&lt;</span>&nbsp;<span class="ident" id="7161063">bo</span><span class="op" id="7161065">.</span><span class="ident" id="7161066">Max</span><span class="op" id="7161069">.</span><span class="ident" id="7161070">Y</span><span class="op" id="7161071">;</span>&nbsp;<span class="ident" id="7161073">y</span><span class="op" id="7161074">++</span>&nbsp;<span class="op" id="7161077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7161081">for</span>&nbsp;<span class="ident" id="7161085">x</span>&nbsp;<span class="op" id="7161087">:=</span>&nbsp;<span class="ident" id="7161090">bo</span><span class="op" id="7161092">.</span><span class="ident" id="7161093">Min</span><span class="op" id="7161096">.</span><span class="ident" id="7161097">X</span><span class="op" id="7161098">;</span>&nbsp;<span class="ident" id="7161100">x</span>&nbsp;<span class="op" id="7161102">&lt;</span>&nbsp;<span class="ident" id="7161104">bo</span><span class="op" id="7161106">.</span><span class="ident" id="7161107">Max</span><span class="op" id="7161110">.</span><span class="ident" id="7161111">X</span><span class="op" id="7161112">;</span>&nbsp;<span class="ident" id="7161114">x</span><span class="op" id="7161115">++</span>&nbsp;<span class="op" id="7161118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7161123">img</span><span class="op" id="7161126">.</span><span class="ident" id="7161127">SetRGBA</span><span class="op" id="7161134">(</span><span class="ident" id="7161135">x</span><span class="op" id="7161136">,</span>&nbsp;<span class="ident" id="7161138">y</span><span class="op" id="7161139">,</span>&nbsp;<span class="ident" id="7161141">color</span><span class="op" id="7161146">.</span><span class="ident" id="7161147">RGBA</span><span class="op" id="7161151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7161157">uint8</span><span class="op" id="7161162">(</span><span class="ident" id="7161163">rnd</span><span class="op" id="7161166">.</span><span class="ident" id="7161167">Intn</span><span class="op" id="7161171">(</span><span class="num" id="7161172">256</span><span class="op" id="7161175">)</span><span class="op" id="7161176">)</span><span class="op" id="7161177">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7161183">uint8</span><span class="op" id="7161188">(</span><span class="ident" id="7161189">rnd</span><span class="op" id="7161192">.</span><span class="ident" id="7161193">Intn</span><span class="op" id="7161197">(</span><span class="num" id="7161198">256</span><span class="op" id="7161201">)</span><span class="op" id="7161202">)</span><span class="op" id="7161203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7161209">uint8</span><span class="op" id="7161214">(</span><span class="ident" id="7161215">rnd</span><span class="op" id="7161218">.</span><span class="ident" id="7161219">Intn</span><span class="op" id="7161223">(</span><span class="num" id="7161224">256</span><span class="op" id="7161227">)</span><span class="op" id="7161228">)</span><span class="op" id="7161229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7161235">255</span><span class="op" id="7161238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161243">}</span><span class="op" id="7161244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161248">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7161254">b</span><span class="op" id="7161255">.</span><span class="ident" id="7161256">SetBytes</span><span class="op" id="7161264">(</span><span class="num" id="7161265">640</span>&nbsp;<span class="op" id="7161269">*</span>&nbsp;<span class="num" id="7161271">480</span>&nbsp;<span class="op" id="7161275">*</span>&nbsp;<span class="num" id="7161277">4</span><span class="op" id="7161278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7161281">b</span><span class="op" id="7161282">.</span><span class="ident" id="7161283">StartTimer</span><span class="op" id="7161293">(</span><span class="op" id="7161294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7161297">options</span>&nbsp;<span class="op" id="7161305">:=</span>&nbsp;<span class="op" id="7161308">&amp;</span><span class="ident" id="7161309">Options</span><span class="op" id="7161316">{</span><span class="ident" id="7161317">Quality</span><span class="op" id="7161324">:</span>&nbsp;<span class="num" id="7161326">90</span><span class="op" id="7161328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7161331">for</span>&nbsp;<span class="ident" id="7161335">i</span>&nbsp;<span class="op" id="7161337">:=</span>&nbsp;<span class="num" id="7161340">0</span><span class="op" id="7161341">;</span>&nbsp;<span class="ident" id="7161343">i</span>&nbsp;<span class="op" id="7161345">&lt;</span>&nbsp;<span class="ident" id="7161347">b</span><span class="op" id="7161348">.</span><span class="ident" id="7161349">N</span><span class="op" id="7161350">;</span>&nbsp;<span class="ident" id="7161352">i</span><span class="op" id="7161353">++</span>&nbsp;<span class="op" id="7161356">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7161360">Encode</span><span class="op" id="7161366">(</span><span class="ident" id="7161367">ioutil</span><span class="op" id="7161373">.</span><span class="ident" id="7161374">Discard</span><span class="op" id="7161381">,</span>&nbsp;<span class="ident" id="7161383">img</span><span class="op" id="7161386">,</span>&nbsp;<span class="ident" id="7161388">options</span><span class="op" id="7161395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161398">}</span><br>
<span class="lineno"></span><span class="op" id="7161400">}</span>
</div>
</body>
</html>
