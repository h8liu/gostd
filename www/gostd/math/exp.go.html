<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2074205">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2074260">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2074314">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2074365">package</span>&nbsp;<span class="ident" id="2074373">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2074379">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2074429">//</span><br>
<span class="lineno"></span><span class="comment" id="2074432">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="2074454">//&nbsp;&nbsp;&nbsp;&nbspExp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2074474">//&nbsp;&nbsp;&nbsp;&nbspExp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2074492">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="2074536">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="2074573">func</span>&nbsp;<span class="ident" id="2074578">Exp</span><span class="op" id="2074581">(</span><span class="ident" id="2074582">x</span>&nbsp;<span class="builtintype" id="2074584">float64</span><span class="op" id="2074591">)</span>&nbsp;<span class="builtintype" id="2074593">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2074602">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2074662">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="2074720">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2074779">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="2074809">//</span><br>
<span class="lineno"></span><span class="comment" id="2074812">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2074868">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2074937">//</span><br>
<span class="lineno"></span><span class="comment" id="2074940">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="2074996">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2075053">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2075070">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2075126">//</span><br>
<span class="lineno"></span><span class="comment" id="2075129">//</span><br>
<span class="lineno">30</span><span class="comment" id="2075132">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="2075142">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2075175">//</span><br>
<span class="lineno"></span><span class="comment" id="2075178">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="2075188">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="2075216">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="2075275">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2075323">//</span><br>
<span class="lineno"></span><span class="comment" id="2075326">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="2075375">//</span><br>
<span class="lineno">40</span><span class="comment" id="2075378">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2075437">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="2075455">//</span><br>
<span class="lineno"></span><span class="comment" id="2075458">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="2075524">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="2075558">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="2075572">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2075647">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2075715">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2075784">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="2075850">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2075871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="2075941">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="2076008">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2076020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="2076072">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2076121">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2076165">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="2076212">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="2076247">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="2076284">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="2076320">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2076363">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="2076430">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2076474">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="2076488">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2076546">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="2076607">//</span><br>
<span class="lineno"></span><span class="comment" id="2076610">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="2076647">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="2076676">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="2076710">//</span><br>
<span class="lineno"></span><span class="comment" id="2076713">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2076731">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="2076773">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="2076801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="2076854">//</span><br>
<span class="lineno"></span><span class="comment" id="2076857">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2076870">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2076940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="2076980">//</span><br>
<span class="lineno"></span><span class="comment" id="2076983">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2076998">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="2077022">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="2077090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="2077159">//</span><br>
<span class="lineno"></span><span class="comment" id="2077162">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2077176">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2077242">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2077306">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="2077372">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2077417">func</span>&nbsp;<span class="ident" id="2077422">exp</span><span class="op" id="2077425">(</span><span class="ident" id="2077426">x</span>&nbsp;<span class="builtintype" id="2077428">float64</span><span class="op" id="2077435">)</span>&nbsp;<span class="builtintype" id="2077437">float64</span>&nbsp;<span class="op" id="2077445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077448">const</span>&nbsp;<span class="op" id="2077454">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077458">Ln2Hi</span>&nbsp;<span class="op" id="2077464">=</span>&nbsp;<span class="num" id="2077466">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077495">Ln2Lo</span>&nbsp;<span class="op" id="2077501">=</span>&nbsp;<span class="num" id="2077503">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077532">Log2e</span>&nbsp;<span class="op" id="2077538">=</span>&nbsp;<span class="num" id="2077540">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077570">Overflow</span>&nbsp;&nbsp;<span class="op" id="2077580">=</span>&nbsp;<span class="num" id="2077582">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077611">Underflow</span>&nbsp;<span class="op" id="2077621">=</span>&nbsp;<span class="op" id="2077623">-</span><span class="num" id="2077624">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077653">NearZero</span>&nbsp;&nbsp;<span class="op" id="2077663">=</span>&nbsp;<span class="num" id="2077665">1.0</span>&nbsp;<span class="op" id="2077669">/</span>&nbsp;<span class="op" id="2077671">(</span><span class="num" id="2077672">1</span>&nbsp;<span class="op" id="2077674">&lt;&lt;</span>&nbsp;<span class="num" id="2077677">28</span><span class="op" id="2077679">)</span>&nbsp;<span class="comment" id="2077681">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077696">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077714">switch</span>&nbsp;<span class="op" id="2077721">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077724">case</span>&nbsp;<span class="ident" id="2077729">IsNaN</span><span class="op" id="2077734">(</span><span class="ident" id="2077735">x</span><span class="op" id="2077736">)</span>&nbsp;<span class="op" id="2077738">||</span>&nbsp;<span class="ident" id="2077741">IsInf</span><span class="op" id="2077746">(</span><span class="ident" id="2077747">x</span><span class="op" id="2077748">,</span>&nbsp;<span class="num" id="2077750">1</span><span class="op" id="2077751">)</span><span class="op" id="2077752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077756">return</span>&nbsp;<span class="ident" id="2077763">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077766">case</span>&nbsp;<span class="ident" id="2077771">IsInf</span><span class="op" id="2077776">(</span><span class="ident" id="2077777">x</span><span class="op" id="2077778">,</span>&nbsp;<span class="op" id="2077780">-</span><span class="num" id="2077781">1</span><span class="op" id="2077782">)</span><span class="op" id="2077783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077787">return</span>&nbsp;<span class="num" id="2077794">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077797">case</span>&nbsp;<span class="ident" id="2077802">x</span>&nbsp;<span class="op" id="2077804">&gt;</span>&nbsp;<span class="ident" id="2077806">Overflow</span><span class="op" id="2077814">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077818">return</span>&nbsp;<span class="ident" id="2077825">Inf</span><span class="op" id="2077828">(</span><span class="num" id="2077829">1</span><span class="op" id="2077830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077833">case</span>&nbsp;<span class="ident" id="2077838">x</span>&nbsp;<span class="op" id="2077840">&lt;</span>&nbsp;<span class="ident" id="2077842">Underflow</span><span class="op" id="2077851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077855">return</span>&nbsp;<span class="num" id="2077862">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077865">case</span>&nbsp;<span class="op" id="2077870">-</span><span class="ident" id="2077871">NearZero</span>&nbsp;<span class="op" id="2077880">&lt;</span>&nbsp;<span class="ident" id="2077882">x</span>&nbsp;<span class="op" id="2077884">&amp;&amp;</span>&nbsp;<span class="ident" id="2077887">x</span>&nbsp;<span class="op" id="2077889">&lt;</span>&nbsp;<span class="ident" id="2077891">NearZero</span><span class="op" id="2077899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077903">return</span>&nbsp;<span class="num" id="2077910">1</span>&nbsp;<span class="op" id="2077912">+</span>&nbsp;<span class="ident" id="2077914">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077921">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077978">var</span>&nbsp;<span class="ident" id="2077982">k</span>&nbsp;<span class="builtintype" id="2077984">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077989">switch</span>&nbsp;<span class="op" id="2077996">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077999">case</span>&nbsp;<span class="ident" id="2078004">x</span>&nbsp;<span class="op" id="2078006">&lt;</span>&nbsp;<span class="num" id="2078008">0</span><span class="op" id="2078009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078013">k</span>&nbsp;<span class="op" id="2078015">=</span>&nbsp;<span class="builtintype" id="2078017">int</span><span class="op" id="2078020">(</span><span class="ident" id="2078021">Log2e</span><span class="op" id="2078026">*</span><span class="ident" id="2078027">x</span>&nbsp;<span class="op" id="2078029">-</span>&nbsp;<span class="num" id="2078031">0.5</span><span class="op" id="2078034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078037">case</span>&nbsp;<span class="ident" id="2078042">x</span>&nbsp;<span class="op" id="2078044">&gt;</span>&nbsp;<span class="num" id="2078046">0</span><span class="op" id="2078047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078051">k</span>&nbsp;<span class="op" id="2078053">=</span>&nbsp;<span class="builtintype" id="2078055">int</span><span class="op" id="2078058">(</span><span class="ident" id="2078059">Log2e</span><span class="op" id="2078064">*</span><span class="ident" id="2078065">x</span>&nbsp;<span class="op" id="2078067">+</span>&nbsp;<span class="num" id="2078069">0.5</span><span class="op" id="2078072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078075">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078078">hi</span>&nbsp;<span class="op" id="2078081">:=</span>&nbsp;<span class="ident" id="2078084">x</span>&nbsp;<span class="op" id="2078086">-</span>&nbsp;<span class="builtintype" id="2078088">float64</span><span class="op" id="2078095">(</span><span class="ident" id="2078096">k</span><span class="op" id="2078097">)</span><span class="op" id="2078098">*</span><span class="ident" id="2078099">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078106">lo</span>&nbsp;<span class="op" id="2078109">:=</span>&nbsp;<span class="builtintype" id="2078112">float64</span><span class="op" id="2078119">(</span><span class="ident" id="2078120">k</span><span class="op" id="2078121">)</span>&nbsp;<span class="op" id="2078123">*</span>&nbsp;<span class="ident" id="2078125">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078133">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078145">return</span>&nbsp;<span class="ident" id="2078152">expmulti</span><span class="op" id="2078160">(</span><span class="ident" id="2078161">hi</span><span class="op" id="2078163">,</span>&nbsp;<span class="ident" id="2078165">lo</span><span class="op" id="2078167">,</span>&nbsp;<span class="ident" id="2078169">k</span><span class="op" id="2078170">)</span><br>
<span class="lineno">130</span><span class="op" id="2078172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2078175">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2078226">//</span><br>
<span class="lineno"></span><span class="comment" id="2078229">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="2078267">func</span>&nbsp;<span class="ident" id="2078272">Exp2</span><span class="op" id="2078276">(</span><span class="ident" id="2078277">x</span>&nbsp;<span class="builtintype" id="2078279">float64</span><span class="op" id="2078286">)</span>&nbsp;<span class="builtintype" id="2078288">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2078297">func</span>&nbsp;<span class="ident" id="2078302">exp2</span><span class="op" id="2078306">(</span><span class="ident" id="2078307">x</span>&nbsp;<span class="builtintype" id="2078309">float64</span><span class="op" id="2078316">)</span>&nbsp;<span class="builtintype" id="2078318">float64</span>&nbsp;<span class="op" id="2078326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078329">const</span>&nbsp;<span class="op" id="2078335">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078339">Ln2Hi</span>&nbsp;<span class="op" id="2078345">=</span>&nbsp;<span class="num" id="2078347">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078376">Ln2Lo</span>&nbsp;<span class="op" id="2078382">=</span>&nbsp;<span class="num" id="2078384">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078414">Overflow</span>&nbsp;&nbsp;<span class="op" id="2078424">=</span>&nbsp;<span class="num" id="2078426">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078451">Underflow</span>&nbsp;<span class="op" id="2078461">=</span>&nbsp;<span class="op" id="2078463">-</span><span class="num" id="2078464">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078476">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078480">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078498">switch</span>&nbsp;<span class="op" id="2078505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078508">case</span>&nbsp;<span class="ident" id="2078513">IsNaN</span><span class="op" id="2078518">(</span><span class="ident" id="2078519">x</span><span class="op" id="2078520">)</span>&nbsp;<span class="op" id="2078522">||</span>&nbsp;<span class="ident" id="2078525">IsInf</span><span class="op" id="2078530">(</span><span class="ident" id="2078531">x</span><span class="op" id="2078532">,</span>&nbsp;<span class="num" id="2078534">1</span><span class="op" id="2078535">)</span><span class="op" id="2078536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078540">return</span>&nbsp;<span class="ident" id="2078547">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078550">case</span>&nbsp;<span class="ident" id="2078555">IsInf</span><span class="op" id="2078560">(</span><span class="ident" id="2078561">x</span><span class="op" id="2078562">,</span>&nbsp;<span class="op" id="2078564">-</span><span class="num" id="2078565">1</span><span class="op" id="2078566">)</span><span class="op" id="2078567">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078571">return</span>&nbsp;<span class="num" id="2078578">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078581">case</span>&nbsp;<span class="ident" id="2078586">x</span>&nbsp;<span class="op" id="2078588">&gt;</span>&nbsp;<span class="ident" id="2078590">Overflow</span><span class="op" id="2078598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078602">return</span>&nbsp;<span class="ident" id="2078609">Inf</span><span class="op" id="2078612">(</span><span class="num" id="2078613">1</span><span class="op" id="2078614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078617">case</span>&nbsp;<span class="ident" id="2078622">x</span>&nbsp;<span class="op" id="2078624">&lt;</span>&nbsp;<span class="ident" id="2078626">Underflow</span><span class="op" id="2078635">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078639">return</span>&nbsp;<span class="num" id="2078646">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078653">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078716">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078765">var</span>&nbsp;<span class="ident" id="2078769">k</span>&nbsp;<span class="builtintype" id="2078771">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078776">switch</span>&nbsp;<span class="op" id="2078783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078786">case</span>&nbsp;<span class="ident" id="2078791">x</span>&nbsp;<span class="op" id="2078793">&gt;</span>&nbsp;<span class="num" id="2078795">0</span><span class="op" id="2078796">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078800">k</span>&nbsp;<span class="op" id="2078802">=</span>&nbsp;<span class="builtintype" id="2078804">int</span><span class="op" id="2078807">(</span><span class="ident" id="2078808">x</span>&nbsp;<span class="op" id="2078810">+</span>&nbsp;<span class="num" id="2078812">0.5</span><span class="op" id="2078815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078818">case</span>&nbsp;<span class="ident" id="2078823">x</span>&nbsp;<span class="op" id="2078825">&lt;</span>&nbsp;<span class="num" id="2078827">0</span><span class="op" id="2078828">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078832">k</span>&nbsp;<span class="op" id="2078834">=</span>&nbsp;<span class="builtintype" id="2078836">int</span><span class="op" id="2078839">(</span><span class="ident" id="2078840">x</span>&nbsp;<span class="op" id="2078842">-</span>&nbsp;<span class="num" id="2078844">0.5</span><span class="op" id="2078847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078853">t</span>&nbsp;<span class="op" id="2078855">:=</span>&nbsp;<span class="ident" id="2078858">x</span>&nbsp;<span class="op" id="2078860">-</span>&nbsp;<span class="builtintype" id="2078862">float64</span><span class="op" id="2078869">(</span><span class="ident" id="2078870">k</span><span class="op" id="2078871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078874">hi</span>&nbsp;<span class="op" id="2078877">:=</span>&nbsp;<span class="ident" id="2078880">t</span>&nbsp;<span class="op" id="2078882">*</span>&nbsp;<span class="ident" id="2078884">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078891">lo</span>&nbsp;<span class="op" id="2078894">:=</span>&nbsp;<span class="op" id="2078897">-</span><span class="ident" id="2078898">t</span>&nbsp;<span class="op" id="2078900">*</span>&nbsp;<span class="ident" id="2078902">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078910">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078922">return</span>&nbsp;<span class="ident" id="2078929">expmulti</span><span class="op" id="2078937">(</span><span class="ident" id="2078938">hi</span><span class="op" id="2078940">,</span>&nbsp;<span class="ident" id="2078942">lo</span><span class="op" id="2078944">,</span>&nbsp;<span class="ident" id="2078946">k</span><span class="op" id="2078947">)</span><br>
<span class="lineno"></span><span class="op" id="2078949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2078952">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="2079020">func</span>&nbsp;<span class="ident" id="2079025">expmulti</span><span class="op" id="2079033">(</span><span class="ident" id="2079034">hi</span><span class="op" id="2079036">,</span>&nbsp;<span class="ident" id="2079038">lo</span>&nbsp;<span class="builtintype" id="2079041">float64</span><span class="op" id="2079048">,</span>&nbsp;<span class="ident" id="2079050">k</span>&nbsp;<span class="builtintype" id="2079052">int</span><span class="op" id="2079055">)</span>&nbsp;<span class="builtintype" id="2079057">float64</span>&nbsp;<span class="op" id="2079065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079068">const</span>&nbsp;<span class="op" id="2079074">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079078">P1</span>&nbsp;<span class="op" id="2079081">=</span>&nbsp;<span class="num" id="2079083">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="2079111">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079142">P2</span>&nbsp;<span class="op" id="2079145">=</span>&nbsp;<span class="op" id="2079147">-</span><span class="num" id="2079148">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="2079175">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079206">P3</span>&nbsp;<span class="op" id="2079209">=</span>&nbsp;<span class="num" id="2079211">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="2079239">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079270">P4</span>&nbsp;<span class="op" id="2079273">=</span>&nbsp;<span class="op" id="2079275">-</span><span class="num" id="2079276">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="2079303">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079334">P5</span>&nbsp;<span class="op" id="2079337">=</span>&nbsp;<span class="num" id="2079339">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="2079367">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079401">r</span>&nbsp;<span class="op" id="2079403">:=</span>&nbsp;<span class="ident" id="2079406">hi</span>&nbsp;<span class="op" id="2079409">-</span>&nbsp;<span class="ident" id="2079411">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079415">t</span>&nbsp;<span class="op" id="2079417">:=</span>&nbsp;<span class="ident" id="2079420">r</span>&nbsp;<span class="op" id="2079422">*</span>&nbsp;<span class="ident" id="2079424">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079427">c</span>&nbsp;<span class="op" id="2079429">:=</span>&nbsp;<span class="ident" id="2079432">r</span>&nbsp;<span class="op" id="2079434">-</span>&nbsp;<span class="ident" id="2079436">t</span><span class="op" id="2079437">*</span><span class="op" id="2079438">(</span><span class="ident" id="2079439">P1</span><span class="op" id="2079441">+</span><span class="ident" id="2079442">t</span><span class="op" id="2079443">*</span><span class="op" id="2079444">(</span><span class="ident" id="2079445">P2</span><span class="op" id="2079447">+</span><span class="ident" id="2079448">t</span><span class="op" id="2079449">*</span><span class="op" id="2079450">(</span><span class="ident" id="2079451">P3</span><span class="op" id="2079453">+</span><span class="ident" id="2079454">t</span><span class="op" id="2079455">*</span><span class="op" id="2079456">(</span><span class="ident" id="2079457">P4</span><span class="op" id="2079459">+</span><span class="ident" id="2079460">t</span><span class="op" id="2079461">*</span><span class="ident" id="2079462">P5</span><span class="op" id="2079464">)</span><span class="op" id="2079465">)</span><span class="op" id="2079466">)</span><span class="op" id="2079467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079470">y</span>&nbsp;<span class="op" id="2079472">:=</span>&nbsp;<span class="num" id="2079475">1</span>&nbsp;<span class="op" id="2079477">-</span>&nbsp;<span class="op" id="2079479">(</span><span class="op" id="2079480">(</span><span class="ident" id="2079481">lo</span>&nbsp;<span class="op" id="2079484">-</span>&nbsp;<span class="op" id="2079486">(</span><span class="ident" id="2079487">r</span><span class="op" id="2079488">*</span><span class="ident" id="2079489">c</span><span class="op" id="2079490">)</span><span class="op" id="2079491">/</span><span class="op" id="2079492">(</span><span class="num" id="2079493">2</span><span class="op" id="2079494">-</span><span class="ident" id="2079495">c</span><span class="op" id="2079496">)</span><span class="op" id="2079497">)</span>&nbsp;<span class="op" id="2079499">-</span>&nbsp;<span class="ident" id="2079501">hi</span><span class="op" id="2079503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2079506">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079559">return</span>&nbsp;<span class="ident" id="2079566">Ldexp</span><span class="op" id="2079571">(</span><span class="ident" id="2079572">y</span><span class="op" id="2079573">,</span>&nbsp;<span class="ident" id="2079575">k</span><span class="op" id="2079576">)</span><br>
<span class="lineno"></span><span class="op" id="2079578">}</span>
</div>
</body>
</html>
