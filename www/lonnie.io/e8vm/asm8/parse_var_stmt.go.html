<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5829704">package</span>&nbsp;<span class="ident" id="5829712">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5829718">import</span>&nbsp;<span class="op" id="5829725">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5829728">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno">5</span><span class="op" id="5829750">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5829753">func</span>&nbsp;<span class="ident" id="5829758">parseArgs</span><span class="op" id="5829767">(</span><span class="ident" id="5829768">p</span>&nbsp;<span class="op" id="5829770">*</span><span class="ident" id="5829771">parser</span><span class="op" id="5829777">)</span>&nbsp;<span class="op" id="5829779">(</span><span class="ident" id="5829780">typ</span>&nbsp;<span class="op" id="5829784">*</span><span class="ident" id="5829785">lex8</span><span class="op" id="5829789">.</span><span class="ident" id="5829790">Token</span><span class="op" id="5829795">,</span>&nbsp;<span class="ident" id="5829797">args</span>&nbsp;<span class="op" id="5829802">[</span><span class="op" id="5829803">]</span><span class="op" id="5829804">*</span><span class="ident" id="5829805">lex8</span><span class="op" id="5829809">.</span><span class="ident" id="5829810">Token</span><span class="op" id="5829815">)</span>&nbsp;<span class="op" id="5829817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829820">typ</span>&nbsp;<span class="op" id="5829824">=</span>&nbsp;<span class="ident" id="5829826">p</span><span class="op" id="5829827">.</span><span class="ident" id="5829828">expect</span><span class="op" id="5829834">(</span><span class="ident" id="5829835">Operand</span><span class="op" id="5829842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829845">if</span>&nbsp;<span class="ident" id="5829848">typ</span>&nbsp;<span class="op" id="5829852">==</span>&nbsp;<span class="ident" id="5829855">nil</span>&nbsp;<span class="op" id="5829859">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829863">p</span><span class="op" id="5829864">.</span><span class="ident" id="5829865">skipErrStmt</span><span class="op" id="5829876">(</span><span class="op" id="5829877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829881">return</span>&nbsp;<span class="ident" id="5829888">nil</span><span class="op" id="5829891">,</span>&nbsp;<span class="ident" id="5829893">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5829898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829902">for</span>&nbsp;<span class="op" id="5829906">!</span><span class="ident" id="5829907">p</span><span class="op" id="5829908">.</span><span class="ident" id="5829909">acceptType</span><span class="op" id="5829919">(</span><span class="ident" id="5829920">Semi</span><span class="op" id="5829924">)</span>&nbsp;<span class="op" id="5829926">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829930">if</span>&nbsp;<span class="op" id="5829933">!</span><span class="ident" id="5829934">p</span><span class="op" id="5829935">.</span><span class="ident" id="5829936">hasErr</span><span class="op" id="5829942">(</span><span class="op" id="5829943">)</span>&nbsp;<span class="op" id="5829945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829950">t</span>&nbsp;<span class="op" id="5829952">:=</span>&nbsp;<span class="ident" id="5829955">p</span><span class="op" id="5829956">.</span><span class="ident" id="5829957">token</span><span class="op" id="5829962">(</span><span class="op" id="5829963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829968">if</span>&nbsp;<span class="ident" id="5829971">t</span><span class="op" id="5829972">.</span><span class="ident" id="5829973">Type</span>&nbsp;<span class="op" id="5829978">==</span>&nbsp;<span class="ident" id="5829981">Operand</span>&nbsp;<span class="op" id="5829989">||</span>&nbsp;<span class="ident" id="5829992">t</span><span class="op" id="5829993">.</span><span class="ident" id="5829994">Type</span>&nbsp;<span class="op" id="5829999">==</span>&nbsp;<span class="ident" id="5830002">String</span>&nbsp;<span class="op" id="5830009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830015">args</span>&nbsp;<span class="op" id="5830020">=</span>&nbsp;<span class="builtinfunc" id="5830022">append</span><span class="op" id="5830028">(</span><span class="ident" id="5830029">args</span><span class="op" id="5830033">,</span>&nbsp;<span class="ident" id="5830035">t</span><span class="op" id="5830036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830041">}</span>&nbsp;<span class="keyword" id="5830043">else</span>&nbsp;<span class="op" id="5830048">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830054">p</span><span class="op" id="5830055">.</span><span class="ident" id="5830056">err</span><span class="op" id="5830059">(</span><span class="ident" id="5830060">t</span><span class="op" id="5830061">.</span><span class="ident" id="5830062">Pos</span><span class="op" id="5830065">,</span>&nbsp;<span class="string" id="5830067">&#34;expect&nbsp;operand&nbsp;or&nbsp;string,&nbsp;got&nbsp;%s&#34;</span><span class="op" id="5830101">,</span>&nbsp;<span class="ident" id="5830103">typeStr</span><span class="op" id="5830110">(</span><span class="ident" id="5830111">t</span><span class="op" id="5830112">.</span><span class="ident" id="5830113">Type</span><span class="op" id="5830117">)</span><span class="op" id="5830118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830131">if</span>&nbsp;<span class="ident" id="5830134">p</span><span class="op" id="5830135">.</span><span class="ident" id="5830136">see</span><span class="op" id="5830139">(</span><span class="ident" id="5830140">lex8</span><span class="op" id="5830144">.</span><span class="ident" id="5830145">EOF</span><span class="op" id="5830148">)</span>&nbsp;<span class="op" id="5830150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830155">break</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830167">p</span><span class="op" id="5830168">.</span><span class="ident" id="5830169">next</span><span class="op" id="5830173">(</span><span class="op" id="5830174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830181">p</span><span class="op" id="5830182">.</span><span class="ident" id="5830183">clearErr</span><span class="op" id="5830191">(</span><span class="op" id="5830192">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830196">return</span>&nbsp;<span class="ident" id="5830203">typ</span><span class="op" id="5830206">,</span>&nbsp;<span class="ident" id="5830208">args</span><br>
<span class="lineno"></span><span class="op" id="5830213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5830216">func</span>&nbsp;<span class="ident" id="5830221">parseData</span><span class="op" id="5830230">(</span><span class="ident" id="5830231">p</span>&nbsp;<span class="op" id="5830233">*</span><span class="ident" id="5830234">parser</span><span class="op" id="5830240">,</span>&nbsp;<span class="ident" id="5830242">t</span>&nbsp;<span class="op" id="5830244">*</span><span class="ident" id="5830245">lex8</span><span class="op" id="5830249">.</span><span class="ident" id="5830250">Token</span><span class="op" id="5830255">,</span>&nbsp;<span class="ident" id="5830257">args</span>&nbsp;<span class="op" id="5830262">[</span><span class="op" id="5830263">]</span><span class="op" id="5830264">*</span><span class="ident" id="5830265">lex8</span><span class="op" id="5830269">.</span><span class="ident" id="5830270">Token</span><span class="op" id="5830275">)</span>&nbsp;<span class="op" id="5830277">(</span><span class="op" id="5830278">[</span><span class="op" id="5830279">]</span><span class="builtintype" id="5830280">byte</span><span class="op" id="5830284">,</span>&nbsp;<span class="builtintype" id="5830286">uint32</span><span class="op" id="5830292">)</span>&nbsp;<span class="op" id="5830294">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830297">switch</span>&nbsp;<span class="ident" id="5830304">t</span><span class="op" id="5830305">.</span><span class="ident" id="5830306">Lit</span>&nbsp;<span class="op" id="5830310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830313">case</span>&nbsp;<span class="string" id="5830318">&#34;str&#34;</span><span class="op" id="5830323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830327">return</span>&nbsp;<span class="ident" id="5830334">parseDataStr</span><span class="op" id="5830346">(</span><span class="ident" id="5830347">p</span><span class="op" id="5830348">,</span>&nbsp;<span class="ident" id="5830350">args</span><span class="op" id="5830354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830357">case</span>&nbsp;<span class="string" id="5830362">&#34;x&#34;</span><span class="op" id="5830365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830369">return</span>&nbsp;<span class="ident" id="5830376">parseDataHex</span><span class="op" id="5830388">(</span><span class="ident" id="5830389">p</span><span class="op" id="5830390">,</span>&nbsp;<span class="ident" id="5830392">args</span><span class="op" id="5830396">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830399">case</span>&nbsp;<span class="string" id="5830404">&#34;u32&#34;</span><span class="op" id="5830409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830413">return</span>&nbsp;<span class="ident" id="5830420">parseDataNums</span><span class="op" id="5830433">(</span><span class="ident" id="5830434">p</span><span class="op" id="5830435">,</span>&nbsp;<span class="ident" id="5830437">args</span><span class="op" id="5830441">,</span>&nbsp;<span class="ident" id="5830443">modeWord</span><span class="op" id="5830451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830454">case</span>&nbsp;<span class="string" id="5830459">&#34;i32&#34;</span><span class="op" id="5830464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830468">return</span>&nbsp;<span class="ident" id="5830475">parseDataNums</span><span class="op" id="5830488">(</span><span class="ident" id="5830489">p</span><span class="op" id="5830490">,</span>&nbsp;<span class="ident" id="5830492">args</span><span class="op" id="5830496">,</span>&nbsp;<span class="ident" id="5830498">modeWord</span><span class="op" id="5830506">|</span><span class="ident" id="5830507">modeSigned</span><span class="op" id="5830517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830520">case</span>&nbsp;<span class="string" id="5830525">&#34;u8&#34;</span><span class="op" id="5830529">,</span>&nbsp;<span class="string" id="5830531">&#34;byte&#34;</span><span class="op" id="5830537">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830541">return</span>&nbsp;<span class="ident" id="5830548">parseDataNums</span><span class="op" id="5830561">(</span><span class="ident" id="5830562">p</span><span class="op" id="5830563">,</span>&nbsp;<span class="ident" id="5830565">args</span><span class="op" id="5830569">,</span>&nbsp;<span class="num" id="5830571">0</span><span class="op" id="5830572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830575">case</span>&nbsp;<span class="string" id="5830580">&#34;i8&#34;</span><span class="op" id="5830584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830588">return</span>&nbsp;<span class="ident" id="5830595">parseDataNums</span><span class="op" id="5830608">(</span><span class="ident" id="5830609">p</span><span class="op" id="5830610">,</span>&nbsp;<span class="ident" id="5830612">args</span><span class="op" id="5830616">,</span>&nbsp;<span class="ident" id="5830618">modeSigned</span><span class="op" id="5830628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830631">case</span>&nbsp;<span class="string" id="5830636">&#34;f32&#34;</span><span class="op" id="5830641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830645">return</span>&nbsp;<span class="ident" id="5830652">parseDataNums</span><span class="op" id="5830665">(</span><span class="ident" id="5830666">p</span><span class="op" id="5830667">,</span>&nbsp;<span class="ident" id="5830669">args</span><span class="op" id="5830673">,</span>&nbsp;<span class="ident" id="5830675">modeWord</span><span class="op" id="5830683">|</span><span class="ident" id="5830684">modeFloat</span><span class="op" id="5830693">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830696">default</span><span class="op" id="5830703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830707">p</span><span class="op" id="5830708">.</span><span class="ident" id="5830709">err</span><span class="op" id="5830712">(</span><span class="ident" id="5830713">t</span><span class="op" id="5830714">.</span><span class="ident" id="5830715">Pos</span><span class="op" id="5830718">,</span>&nbsp;<span class="string" id="5830720">&#34;unknown&nbsp;data&nbsp;type&nbsp;%q&#34;</span><span class="op" id="5830742">,</span>&nbsp;<span class="ident" id="5830744">t</span><span class="op" id="5830745">.</span><span class="ident" id="5830746">Lit</span><span class="op" id="5830749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830753">return</span>&nbsp;<span class="ident" id="5830760">nil</span><span class="op" id="5830763">,</span>&nbsp;<span class="num" id="5830765">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830768">}</span><br>
<span class="lineno"></span><span class="op" id="5830770">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="5830773">func</span>&nbsp;<span class="ident" id="5830778">parseVarStmt</span><span class="op" id="5830790">(</span><span class="ident" id="5830791">p</span>&nbsp;<span class="op" id="5830793">*</span><span class="ident" id="5830794">parser</span><span class="op" id="5830800">)</span>&nbsp;<span class="op" id="5830802">*</span><span class="ident" id="5830803">varStmt</span>&nbsp;<span class="op" id="5830811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830814">typ</span><span class="op" id="5830817">,</span>&nbsp;<span class="ident" id="5830819">args</span>&nbsp;<span class="op" id="5830824">:=</span>&nbsp;<span class="ident" id="5830827">parseArgs</span><span class="op" id="5830836">(</span><span class="ident" id="5830837">p</span><span class="op" id="5830838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830841">if</span>&nbsp;<span class="ident" id="5830844">typ</span>&nbsp;<span class="op" id="5830848">==</span>&nbsp;<span class="ident" id="5830851">nil</span>&nbsp;<span class="op" id="5830855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830859">return</span>&nbsp;<span class="ident" id="5830866">nil</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830875">ret</span>&nbsp;<span class="op" id="5830879">:=</span>&nbsp;<span class="builtinfunc" id="5830882">new</span><span class="op" id="5830885">(</span><span class="ident" id="5830886">varStmt</span><span class="op" id="5830893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830896">ret</span><span class="op" id="5830899">.</span><span class="ident" id="5830900">typ</span>&nbsp;<span class="op" id="5830904">=</span>&nbsp;<span class="ident" id="5830906">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830911">ret</span><span class="op" id="5830914">.</span><span class="ident" id="5830915">args</span>&nbsp;<span class="op" id="5830920">=</span>&nbsp;<span class="ident" id="5830922">args</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830928">ret</span><span class="op" id="5830931">.</span><span class="ident" id="5830932">data</span><span class="op" id="5830936">,</span>&nbsp;<span class="ident" id="5830938">ret</span><span class="op" id="5830941">.</span><span class="ident" id="5830942">align</span>&nbsp;<span class="op" id="5830948">=</span>&nbsp;<span class="ident" id="5830950">parseData</span><span class="op" id="5830959">(</span><span class="ident" id="5830960">p</span><span class="op" id="5830961">,</span>&nbsp;<span class="ident" id="5830963">typ</span><span class="op" id="5830966">,</span>&nbsp;<span class="ident" id="5830968">args</span><span class="op" id="5830972">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830976">return</span>&nbsp;<span class="ident" id="5830983">ret</span><br>
<span class="lineno"></span><span class="op" id="5830987">}</span>
</div>
</body>
</html>
