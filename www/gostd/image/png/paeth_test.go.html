<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html" class="current">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6489997">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6490052">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6490106">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6490157">package</span>&nbsp;<span class="ident" id="6490165">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6490170">import</span>&nbsp;<span class="op" id="6490177">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490180">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490189">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6490202">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6490212">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6490215">func</span>&nbsp;<span class="ident" id="6490220">slowAbs</span><span class="op" id="6490227">(</span><span class="ident" id="6490228">x</span>&nbsp;<span class="builtintype" id="6490230">int</span><span class="op" id="6490233">)</span>&nbsp;<span class="builtintype" id="6490235">int</span>&nbsp;<span class="op" id="6490239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490242">if</span>&nbsp;<span class="ident" id="6490245">x</span>&nbsp;<span class="op" id="6490247">&lt;</span>&nbsp;<span class="num" id="6490249">0</span>&nbsp;<span class="op" id="6490251">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490255">return</span>&nbsp;<span class="op" id="6490262">-</span><span class="ident" id="6490263">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490269">return</span>&nbsp;<span class="ident" id="6490276">x</span><br>
<span class="lineno"></span><span class="op" id="6490278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="6490281">//&nbsp;slowPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Paeth&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="6490353">//&nbsp;It&nbsp;is&nbsp;a&nbsp;straight&nbsp;port&nbsp;of&nbsp;the&nbsp;sample&nbsp;code&nbsp;in&nbsp;the&nbsp;PNG&nbsp;spec,&nbsp;section&nbsp;9.4.</span><br>
<span class="lineno"></span><span class="keyword" id="6490427">func</span>&nbsp;<span class="ident" id="6490432">slowPaeth</span><span class="op" id="6490441">(</span><span class="ident" id="6490442">a</span><span class="op" id="6490443">,</span>&nbsp;<span class="ident" id="6490445">b</span><span class="op" id="6490446">,</span>&nbsp;<span class="ident" id="6490448">c</span>&nbsp;<span class="builtintype" id="6490450">uint8</span><span class="op" id="6490455">)</span>&nbsp;<span class="builtintype" id="6490457">uint8</span>&nbsp;<span class="op" id="6490463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490466">p</span>&nbsp;<span class="op" id="6490468">:=</span>&nbsp;<span class="builtintype" id="6490471">int</span><span class="op" id="6490474">(</span><span class="ident" id="6490475">a</span><span class="op" id="6490476">)</span>&nbsp;<span class="op" id="6490478">+</span>&nbsp;<span class="builtintype" id="6490480">int</span><span class="op" id="6490483">(</span><span class="ident" id="6490484">b</span><span class="op" id="6490485">)</span>&nbsp;<span class="op" id="6490487">-</span>&nbsp;<span class="builtintype" id="6490489">int</span><span class="op" id="6490492">(</span><span class="ident" id="6490493">c</span><span class="op" id="6490494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490497">pa</span>&nbsp;<span class="op" id="6490500">:=</span>&nbsp;<span class="ident" id="6490503">slowAbs</span><span class="op" id="6490510">(</span><span class="ident" id="6490511">p</span>&nbsp;<span class="op" id="6490513">-</span>&nbsp;<span class="builtintype" id="6490515">int</span><span class="op" id="6490518">(</span><span class="ident" id="6490519">a</span><span class="op" id="6490520">)</span><span class="op" id="6490521">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490524">pb</span>&nbsp;<span class="op" id="6490527">:=</span>&nbsp;<span class="ident" id="6490530">slowAbs</span><span class="op" id="6490537">(</span><span class="ident" id="6490538">p</span>&nbsp;<span class="op" id="6490540">-</span>&nbsp;<span class="builtintype" id="6490542">int</span><span class="op" id="6490545">(</span><span class="ident" id="6490546">b</span><span class="op" id="6490547">)</span><span class="op" id="6490548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490551">pc</span>&nbsp;<span class="op" id="6490554">:=</span>&nbsp;<span class="ident" id="6490557">slowAbs</span><span class="op" id="6490564">(</span><span class="ident" id="6490565">p</span>&nbsp;<span class="op" id="6490567">-</span>&nbsp;<span class="builtintype" id="6490569">int</span><span class="op" id="6490572">(</span><span class="ident" id="6490573">c</span><span class="op" id="6490574">)</span><span class="op" id="6490575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490578">if</span>&nbsp;<span class="ident" id="6490581">pa</span>&nbsp;<span class="op" id="6490584">&lt;=</span>&nbsp;<span class="ident" id="6490587">pb</span>&nbsp;<span class="op" id="6490590">&amp;&amp;</span>&nbsp;<span class="ident" id="6490593">pa</span>&nbsp;<span class="op" id="6490596">&lt;=</span>&nbsp;<span class="ident" id="6490599">pc</span>&nbsp;<span class="op" id="6490602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490606">return</span>&nbsp;<span class="ident" id="6490613">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490616">}</span>&nbsp;<span class="keyword" id="6490618">else</span>&nbsp;<span class="keyword" id="6490623">if</span>&nbsp;<span class="ident" id="6490626">pb</span>&nbsp;<span class="op" id="6490629">&lt;=</span>&nbsp;<span class="ident" id="6490632">pc</span>&nbsp;<span class="op" id="6490635">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490639">return</span>&nbsp;<span class="ident" id="6490646">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490652">return</span>&nbsp;<span class="ident" id="6490659">c</span><br>
<span class="lineno"></span><span class="op" id="6490661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="6490664">//&nbsp;slowFilterPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;func&nbsp;filterPaeth.</span><br>
<span class="lineno"></span><span class="keyword" id="6490740">func</span>&nbsp;<span class="ident" id="6490745">slowFilterPaeth</span><span class="op" id="6490760">(</span><span class="ident" id="6490761">cdat</span><span class="op" id="6490765">,</span>&nbsp;<span class="ident" id="6490767">pdat</span>&nbsp;<span class="op" id="6490772">[</span><span class="op" id="6490773">]</span><span class="builtintype" id="6490774">byte</span><span class="op" id="6490778">,</span>&nbsp;<span class="ident" id="6490780">bytesPerPixel</span>&nbsp;<span class="builtintype" id="6490794">int</span><span class="op" id="6490797">)</span>&nbsp;<span class="op" id="6490799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490802">for</span>&nbsp;<span class="ident" id="6490806">i</span>&nbsp;<span class="op" id="6490808">:=</span>&nbsp;<span class="num" id="6490811">0</span><span class="op" id="6490812">;</span>&nbsp;<span class="ident" id="6490814">i</span>&nbsp;<span class="op" id="6490816">&lt;</span>&nbsp;<span class="ident" id="6490818">bytesPerPixel</span><span class="op" id="6490831">;</span>&nbsp;<span class="ident" id="6490833">i</span><span class="op" id="6490834">++</span>&nbsp;<span class="op" id="6490837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490841">cdat</span><span class="op" id="6490845">[</span><span class="ident" id="6490846">i</span><span class="op" id="6490847">]</span>&nbsp;<span class="op" id="6490849">+=</span>&nbsp;<span class="ident" id="6490852">paeth</span><span class="op" id="6490857">(</span><span class="num" id="6490858">0</span><span class="op" id="6490859">,</span>&nbsp;<span class="ident" id="6490861">pdat</span><span class="op" id="6490865">[</span><span class="ident" id="6490866">i</span><span class="op" id="6490867">]</span><span class="op" id="6490868">,</span>&nbsp;<span class="num" id="6490870">0</span><span class="op" id="6490871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490874">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490877">for</span>&nbsp;<span class="ident" id="6490881">i</span>&nbsp;<span class="op" id="6490883">:=</span>&nbsp;<span class="ident" id="6490886">bytesPerPixel</span><span class="op" id="6490899">;</span>&nbsp;<span class="ident" id="6490901">i</span>&nbsp;<span class="op" id="6490903">&lt;</span>&nbsp;<span class="builtinfunc" id="6490905">len</span><span class="op" id="6490908">(</span><span class="ident" id="6490909">cdat</span><span class="op" id="6490913">)</span><span class="op" id="6490914">;</span>&nbsp;<span class="ident" id="6490916">i</span><span class="op" id="6490917">++</span>&nbsp;<span class="op" id="6490920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490924">cdat</span><span class="op" id="6490928">[</span><span class="ident" id="6490929">i</span><span class="op" id="6490930">]</span>&nbsp;<span class="op" id="6490932">+=</span>&nbsp;<span class="ident" id="6490935">paeth</span><span class="op" id="6490940">(</span><span class="ident" id="6490941">cdat</span><span class="op" id="6490945">[</span><span class="ident" id="6490946">i</span><span class="op" id="6490947">-</span><span class="ident" id="6490948">bytesPerPixel</span><span class="op" id="6490961">]</span><span class="op" id="6490962">,</span>&nbsp;<span class="ident" id="6490964">pdat</span><span class="op" id="6490968">[</span><span class="ident" id="6490969">i</span><span class="op" id="6490970">]</span><span class="op" id="6490971">,</span>&nbsp;<span class="ident" id="6490973">pdat</span><span class="op" id="6490977">[</span><span class="ident" id="6490978">i</span><span class="op" id="6490979">-</span><span class="ident" id="6490980">bytesPerPixel</span><span class="op" id="6490993">]</span><span class="op" id="6490994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490997">}</span><br>
<span class="lineno"></span><span class="op" id="6490999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="6491002">func</span>&nbsp;<span class="ident" id="6491007">TestPaeth</span><span class="op" id="6491016">(</span><span class="ident" id="6491017">t</span>&nbsp;<span class="op" id="6491019">*</span><span class="ident" id="6491020">testing</span><span class="op" id="6491027">.</span><span class="ident" id="6491028">T</span><span class="op" id="6491029">)</span>&nbsp;<span class="op" id="6491031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491034">for</span>&nbsp;<span class="ident" id="6491038">a</span>&nbsp;<span class="op" id="6491040">:=</span>&nbsp;<span class="num" id="6491043">0</span><span class="op" id="6491044">;</span>&nbsp;<span class="ident" id="6491046">a</span>&nbsp;<span class="op" id="6491048">&lt;</span>&nbsp;<span class="num" id="6491050">256</span><span class="op" id="6491053">;</span>&nbsp;<span class="ident" id="6491055">a</span>&nbsp;<span class="op" id="6491057">+=</span>&nbsp;<span class="num" id="6491060">15</span>&nbsp;<span class="op" id="6491063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491067">for</span>&nbsp;<span class="ident" id="6491071">b</span>&nbsp;<span class="op" id="6491073">:=</span>&nbsp;<span class="num" id="6491076">0</span><span class="op" id="6491077">;</span>&nbsp;<span class="ident" id="6491079">b</span>&nbsp;<span class="op" id="6491081">&lt;</span>&nbsp;<span class="num" id="6491083">256</span><span class="op" id="6491086">;</span>&nbsp;<span class="ident" id="6491088">b</span>&nbsp;<span class="op" id="6491090">+=</span>&nbsp;<span class="num" id="6491093">15</span>&nbsp;<span class="op" id="6491096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491101">for</span>&nbsp;<span class="ident" id="6491105">c</span>&nbsp;<span class="op" id="6491107">:=</span>&nbsp;<span class="num" id="6491110">0</span><span class="op" id="6491111">;</span>&nbsp;<span class="ident" id="6491113">c</span>&nbsp;<span class="op" id="6491115">&lt;</span>&nbsp;<span class="num" id="6491117">256</span><span class="op" id="6491120">;</span>&nbsp;<span class="ident" id="6491122">c</span>&nbsp;<span class="op" id="6491124">+=</span>&nbsp;<span class="num" id="6491127">15</span>&nbsp;<span class="op" id="6491130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491136">got</span>&nbsp;<span class="op" id="6491140">:=</span>&nbsp;<span class="ident" id="6491143">paeth</span><span class="op" id="6491148">(</span><span class="builtintype" id="6491149">uint8</span><span class="op" id="6491154">(</span><span class="ident" id="6491155">a</span><span class="op" id="6491156">)</span><span class="op" id="6491157">,</span>&nbsp;<span class="builtintype" id="6491159">uint8</span><span class="op" id="6491164">(</span><span class="ident" id="6491165">b</span><span class="op" id="6491166">)</span><span class="op" id="6491167">,</span>&nbsp;<span class="builtintype" id="6491169">uint8</span><span class="op" id="6491174">(</span><span class="ident" id="6491175">c</span><span class="op" id="6491176">)</span><span class="op" id="6491177">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491183">want</span>&nbsp;<span class="op" id="6491188">:=</span>&nbsp;<span class="ident" id="6491191">slowPaeth</span><span class="op" id="6491200">(</span><span class="builtintype" id="6491201">uint8</span><span class="op" id="6491206">(</span><span class="ident" id="6491207">a</span><span class="op" id="6491208">)</span><span class="op" id="6491209">,</span>&nbsp;<span class="builtintype" id="6491211">uint8</span><span class="op" id="6491216">(</span><span class="ident" id="6491217">b</span><span class="op" id="6491218">)</span><span class="op" id="6491219">,</span>&nbsp;<span class="builtintype" id="6491221">uint8</span><span class="op" id="6491226">(</span><span class="ident" id="6491227">c</span><span class="op" id="6491228">)</span><span class="op" id="6491229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491235">if</span>&nbsp;<span class="ident" id="6491238">got</span>&nbsp;<span class="op" id="6491242">!=</span>&nbsp;<span class="ident" id="6491245">want</span>&nbsp;<span class="op" id="6491250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491257">t</span><span class="op" id="6491258">.</span><span class="ident" id="6491259">Errorf</span><span class="op" id="6491265">(</span><span class="string" id="6491266">&#34;a,&nbsp;b,&nbsp;c&nbsp;=&nbsp;%d,&nbsp;%d,&nbsp;%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6491305">,</span>&nbsp;<span class="ident" id="6491307">a</span><span class="op" id="6491308">,</span>&nbsp;<span class="ident" id="6491310">b</span><span class="op" id="6491311">,</span>&nbsp;<span class="ident" id="6491313">c</span><span class="op" id="6491314">,</span>&nbsp;<span class="ident" id="6491316">got</span><span class="op" id="6491319">,</span>&nbsp;<span class="ident" id="6491321">want</span><span class="op" id="6491325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491336">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491343">}</span><br>
<span class="lineno"></span><span class="op" id="6491345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6491348">func</span>&nbsp;<span class="ident" id="6491353">BenchmarkPaeth</span><span class="op" id="6491367">(</span><span class="ident" id="6491368">b</span>&nbsp;<span class="op" id="6491370">*</span><span class="ident" id="6491371">testing</span><span class="op" id="6491378">.</span><span class="ident" id="6491379">B</span><span class="op" id="6491380">)</span>&nbsp;<span class="op" id="6491382">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491385">for</span>&nbsp;<span class="ident" id="6491389">i</span>&nbsp;<span class="op" id="6491391">:=</span>&nbsp;<span class="num" id="6491394">0</span><span class="op" id="6491395">;</span>&nbsp;<span class="ident" id="6491397">i</span>&nbsp;<span class="op" id="6491399">&lt;</span>&nbsp;<span class="ident" id="6491401">b</span><span class="op" id="6491402">.</span><span class="ident" id="6491403">N</span><span class="op" id="6491404">;</span>&nbsp;<span class="ident" id="6491406">i</span><span class="op" id="6491407">++</span>&nbsp;<span class="op" id="6491410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491414">paeth</span><span class="op" id="6491419">(</span><span class="builtintype" id="6491420">uint8</span><span class="op" id="6491425">(</span><span class="ident" id="6491426">i</span><span class="op" id="6491427">&gt;&gt;</span><span class="num" id="6491429">16</span><span class="op" id="6491431">)</span><span class="op" id="6491432">,</span>&nbsp;<span class="builtintype" id="6491434">uint8</span><span class="op" id="6491439">(</span><span class="ident" id="6491440">i</span><span class="op" id="6491441">&gt;&gt;</span><span class="num" id="6491443">8</span><span class="op" id="6491444">)</span><span class="op" id="6491445">,</span>&nbsp;<span class="builtintype" id="6491447">uint8</span><span class="op" id="6491452">(</span><span class="ident" id="6491453">i</span><span class="op" id="6491454">)</span><span class="op" id="6491455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491458">}</span><br>
<span class="lineno"></span><span class="op" id="6491460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6491463">func</span>&nbsp;<span class="ident" id="6491468">TestPaethDecode</span><span class="op" id="6491483">(</span><span class="ident" id="6491484">t</span>&nbsp;<span class="op" id="6491486">*</span><span class="ident" id="6491487">testing</span><span class="op" id="6491494">.</span><span class="ident" id="6491495">T</span><span class="op" id="6491496">)</span>&nbsp;<span class="op" id="6491498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491501">pdat0</span>&nbsp;<span class="op" id="6491507">:=</span>&nbsp;<span class="builtinfunc" id="6491510">make</span><span class="op" id="6491514">(</span><span class="op" id="6491515">[</span><span class="op" id="6491516">]</span><span class="builtintype" id="6491517">byte</span><span class="op" id="6491521">,</span>&nbsp;<span class="num" id="6491523">32</span><span class="op" id="6491525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491528">pdat1</span>&nbsp;<span class="op" id="6491534">:=</span>&nbsp;<span class="builtinfunc" id="6491537">make</span><span class="op" id="6491541">(</span><span class="op" id="6491542">[</span><span class="op" id="6491543">]</span><span class="builtintype" id="6491544">byte</span><span class="op" id="6491548">,</span>&nbsp;<span class="num" id="6491550">32</span><span class="op" id="6491552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491555">pdat2</span>&nbsp;<span class="op" id="6491561">:=</span>&nbsp;<span class="builtinfunc" id="6491564">make</span><span class="op" id="6491568">(</span><span class="op" id="6491569">[</span><span class="op" id="6491570">]</span><span class="builtintype" id="6491571">byte</span><span class="op" id="6491575">,</span>&nbsp;<span class="num" id="6491577">32</span><span class="op" id="6491579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491582">cdat0</span>&nbsp;<span class="op" id="6491588">:=</span>&nbsp;<span class="builtinfunc" id="6491591">make</span><span class="op" id="6491595">(</span><span class="op" id="6491596">[</span><span class="op" id="6491597">]</span><span class="builtintype" id="6491598">byte</span><span class="op" id="6491602">,</span>&nbsp;<span class="num" id="6491604">32</span><span class="op" id="6491606">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491609">cdat1</span>&nbsp;<span class="op" id="6491615">:=</span>&nbsp;<span class="builtinfunc" id="6491618">make</span><span class="op" id="6491622">(</span><span class="op" id="6491623">[</span><span class="op" id="6491624">]</span><span class="builtintype" id="6491625">byte</span><span class="op" id="6491629">,</span>&nbsp;<span class="num" id="6491631">32</span><span class="op" id="6491633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491636">cdat2</span>&nbsp;<span class="op" id="6491642">:=</span>&nbsp;<span class="builtinfunc" id="6491645">make</span><span class="op" id="6491649">(</span><span class="op" id="6491650">[</span><span class="op" id="6491651">]</span><span class="builtintype" id="6491652">byte</span><span class="op" id="6491656">,</span>&nbsp;<span class="num" id="6491658">32</span><span class="op" id="6491660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491663">r</span>&nbsp;<span class="op" id="6491665">:=</span>&nbsp;<span class="ident" id="6491668">rand</span><span class="op" id="6491672">.</span><span class="ident" id="6491673">New</span><span class="op" id="6491676">(</span><span class="ident" id="6491677">rand</span><span class="op" id="6491681">.</span><span class="ident" id="6491682">NewSource</span><span class="op" id="6491691">(</span><span class="num" id="6491692">1</span><span class="op" id="6491693">)</span><span class="op" id="6491694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491697">for</span>&nbsp;<span class="ident" id="6491701">bytesPerPixel</span>&nbsp;<span class="op" id="6491715">:=</span>&nbsp;<span class="num" id="6491718">1</span><span class="op" id="6491719">;</span>&nbsp;<span class="ident" id="6491721">bytesPerPixel</span>&nbsp;<span class="op" id="6491735">&lt;=</span>&nbsp;<span class="num" id="6491738">8</span><span class="op" id="6491739">;</span>&nbsp;<span class="ident" id="6491741">bytesPerPixel</span><span class="op" id="6491754">++</span>&nbsp;<span class="op" id="6491757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491761">for</span>&nbsp;<span class="ident" id="6491765">i</span>&nbsp;<span class="op" id="6491767">:=</span>&nbsp;<span class="num" id="6491770">0</span><span class="op" id="6491771">;</span>&nbsp;<span class="ident" id="6491773">i</span>&nbsp;<span class="op" id="6491775">&lt;</span>&nbsp;<span class="num" id="6491777">100</span><span class="op" id="6491780">;</span>&nbsp;<span class="ident" id="6491782">i</span><span class="op" id="6491783">++</span>&nbsp;<span class="op" id="6491786">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491791">for</span>&nbsp;<span class="ident" id="6491795">j</span>&nbsp;<span class="op" id="6491797">:=</span>&nbsp;<span class="keyword" id="6491800">range</span>&nbsp;<span class="ident" id="6491806">pdat0</span>&nbsp;<span class="op" id="6491812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491818">pdat0</span><span class="op" id="6491823">[</span><span class="ident" id="6491824">j</span><span class="op" id="6491825">]</span>&nbsp;<span class="op" id="6491827">=</span>&nbsp;<span class="builtintype" id="6491829">uint8</span><span class="op" id="6491834">(</span><span class="ident" id="6491835">r</span><span class="op" id="6491836">.</span><span class="ident" id="6491837">Uint32</span><span class="op" id="6491843">(</span><span class="op" id="6491844">)</span><span class="op" id="6491845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491851">cdat0</span><span class="op" id="6491856">[</span><span class="ident" id="6491857">j</span><span class="op" id="6491858">]</span>&nbsp;<span class="op" id="6491860">=</span>&nbsp;<span class="builtintype" id="6491862">uint8</span><span class="op" id="6491867">(</span><span class="ident" id="6491868">r</span><span class="op" id="6491869">.</span><span class="ident" id="6491870">Uint32</span><span class="op" id="6491876">(</span><span class="op" id="6491877">)</span><span class="op" id="6491878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6491888">copy</span><span class="op" id="6491892">(</span><span class="ident" id="6491893">pdat1</span><span class="op" id="6491898">,</span>&nbsp;<span class="ident" id="6491900">pdat0</span><span class="op" id="6491905">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6491910">copy</span><span class="op" id="6491914">(</span><span class="ident" id="6491915">pdat2</span><span class="op" id="6491920">,</span>&nbsp;<span class="ident" id="6491922">pdat0</span><span class="op" id="6491927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6491932">copy</span><span class="op" id="6491936">(</span><span class="ident" id="6491937">cdat1</span><span class="op" id="6491942">,</span>&nbsp;<span class="ident" id="6491944">cdat0</span><span class="op" id="6491949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6491954">copy</span><span class="op" id="6491958">(</span><span class="ident" id="6491959">cdat2</span><span class="op" id="6491964">,</span>&nbsp;<span class="ident" id="6491966">cdat0</span><span class="op" id="6491971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491976">filterPaeth</span><span class="op" id="6491987">(</span><span class="ident" id="6491988">cdat1</span><span class="op" id="6491993">,</span>&nbsp;<span class="ident" id="6491995">pdat1</span><span class="op" id="6492000">,</span>&nbsp;<span class="ident" id="6492002">bytesPerPixel</span><span class="op" id="6492015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492020">slowFilterPaeth</span><span class="op" id="6492035">(</span><span class="ident" id="6492036">cdat2</span><span class="op" id="6492041">,</span>&nbsp;<span class="ident" id="6492043">pdat2</span><span class="op" id="6492048">,</span>&nbsp;<span class="ident" id="6492050">bytesPerPixel</span><span class="op" id="6492063">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492068">if</span>&nbsp;<span class="op" id="6492071">!</span><span class="ident" id="6492072">bytes</span><span class="op" id="6492077">.</span><span class="ident" id="6492078">Equal</span><span class="op" id="6492083">(</span><span class="ident" id="6492084">cdat1</span><span class="op" id="6492089">,</span>&nbsp;<span class="ident" id="6492091">cdat2</span><span class="op" id="6492096">)</span>&nbsp;<span class="op" id="6492098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492104">t</span><span class="op" id="6492105">.</span><span class="ident" id="6492106">Errorf</span><span class="op" id="6492112">(</span><span class="string" id="6492113">&#34;bytesPerPixel:&nbsp;%d\npdat0:&nbsp;%&nbsp;x\ncdat0:&nbsp;%&nbsp;x\ngot:&nbsp;&nbsp;&nbsp;%&nbsp;x\nwant:&nbsp;&nbsp;%&nbsp;x&#34;</span><span class="op" id="6492180">,</span>&nbsp;<span class="ident" id="6492182">bytesPerPixel</span><span class="op" id="6492195">,</span>&nbsp;<span class="ident" id="6492197">pdat0</span><span class="op" id="6492202">,</span>&nbsp;<span class="ident" id="6492204">cdat0</span><span class="op" id="6492209">,</span>&nbsp;<span class="ident" id="6492211">cdat1</span><span class="op" id="6492216">,</span>&nbsp;<span class="ident" id="6492218">cdat2</span><span class="op" id="6492223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492229">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492242">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492245">}</span><br>
<span class="lineno"></span><span class="op" id="6492247">}</span>
</div>
</body>
</html>
