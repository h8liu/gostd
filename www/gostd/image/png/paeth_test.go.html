<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6529178">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6529233">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6529287">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6529338">package</span>&nbsp;<span class="ident" id="6529346">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6529351">import</span>&nbsp;<span class="op" id="6529358">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6529361">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6529370">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6529383">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6529393">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6529396">func</span>&nbsp;<span class="ident" id="6529401">slowAbs</span><span class="op" id="6529408">(</span><span class="ident" id="6529409">x</span>&nbsp;<span class="builtintype" id="6529411">int</span><span class="op" id="6529414">)</span>&nbsp;<span class="builtintype" id="6529416">int</span>&nbsp;<span class="op" id="6529420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6529423">if</span>&nbsp;<span class="ident" id="6529426">x</span>&nbsp;<span class="op" id="6529428">&lt;</span>&nbsp;<span class="num" id="6529430">0</span>&nbsp;<span class="op" id="6529432">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6529436">return</span>&nbsp;<span class="op" id="6529443">-</span><span class="ident" id="6529444">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6529447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6529450">return</span>&nbsp;<span class="ident" id="6529457">x</span><br>
<span class="lineno"></span><span class="op" id="6529459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="6529462">//&nbsp;slowPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Paeth&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="6529534">//&nbsp;It&nbsp;is&nbsp;a&nbsp;straight&nbsp;port&nbsp;of&nbsp;the&nbsp;sample&nbsp;code&nbsp;in&nbsp;the&nbsp;PNG&nbsp;spec,&nbsp;section&nbsp;9.4.</span><br>
<span class="lineno"></span><span class="keyword" id="6529608">func</span>&nbsp;<span class="ident" id="6529613">slowPaeth</span><span class="op" id="6529622">(</span><span class="ident" id="6529623">a</span><span class="op" id="6529624">,</span>&nbsp;<span class="ident" id="6529626">b</span><span class="op" id="6529627">,</span>&nbsp;<span class="ident" id="6529629">c</span>&nbsp;<span class="builtintype" id="6529631">uint8</span><span class="op" id="6529636">)</span>&nbsp;<span class="builtintype" id="6529638">uint8</span>&nbsp;<span class="op" id="6529644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6529647">p</span>&nbsp;<span class="op" id="6529649">:=</span>&nbsp;<span class="builtintype" id="6529652">int</span><span class="op" id="6529655">(</span><span class="ident" id="6529656">a</span><span class="op" id="6529657">)</span>&nbsp;<span class="op" id="6529659">+</span>&nbsp;<span class="builtintype" id="6529661">int</span><span class="op" id="6529664">(</span><span class="ident" id="6529665">b</span><span class="op" id="6529666">)</span>&nbsp;<span class="op" id="6529668">-</span>&nbsp;<span class="builtintype" id="6529670">int</span><span class="op" id="6529673">(</span><span class="ident" id="6529674">c</span><span class="op" id="6529675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6529678">pa</span>&nbsp;<span class="op" id="6529681">:=</span>&nbsp;<span class="ident" id="6529684">slowAbs</span><span class="op" id="6529691">(</span><span class="ident" id="6529692">p</span>&nbsp;<span class="op" id="6529694">-</span>&nbsp;<span class="builtintype" id="6529696">int</span><span class="op" id="6529699">(</span><span class="ident" id="6529700">a</span><span class="op" id="6529701">)</span><span class="op" id="6529702">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6529705">pb</span>&nbsp;<span class="op" id="6529708">:=</span>&nbsp;<span class="ident" id="6529711">slowAbs</span><span class="op" id="6529718">(</span><span class="ident" id="6529719">p</span>&nbsp;<span class="op" id="6529721">-</span>&nbsp;<span class="builtintype" id="6529723">int</span><span class="op" id="6529726">(</span><span class="ident" id="6529727">b</span><span class="op" id="6529728">)</span><span class="op" id="6529729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6529732">pc</span>&nbsp;<span class="op" id="6529735">:=</span>&nbsp;<span class="ident" id="6529738">slowAbs</span><span class="op" id="6529745">(</span><span class="ident" id="6529746">p</span>&nbsp;<span class="op" id="6529748">-</span>&nbsp;<span class="builtintype" id="6529750">int</span><span class="op" id="6529753">(</span><span class="ident" id="6529754">c</span><span class="op" id="6529755">)</span><span class="op" id="6529756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6529759">if</span>&nbsp;<span class="ident" id="6529762">pa</span>&nbsp;<span class="op" id="6529765">&lt;=</span>&nbsp;<span class="ident" id="6529768">pb</span>&nbsp;<span class="op" id="6529771">&amp;&amp;</span>&nbsp;<span class="ident" id="6529774">pa</span>&nbsp;<span class="op" id="6529777">&lt;=</span>&nbsp;<span class="ident" id="6529780">pc</span>&nbsp;<span class="op" id="6529783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6529787">return</span>&nbsp;<span class="ident" id="6529794">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6529797">}</span>&nbsp;<span class="keyword" id="6529799">else</span>&nbsp;<span class="keyword" id="6529804">if</span>&nbsp;<span class="ident" id="6529807">pb</span>&nbsp;<span class="op" id="6529810">&lt;=</span>&nbsp;<span class="ident" id="6529813">pc</span>&nbsp;<span class="op" id="6529816">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6529820">return</span>&nbsp;<span class="ident" id="6529827">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6529830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6529833">return</span>&nbsp;<span class="ident" id="6529840">c</span><br>
<span class="lineno"></span><span class="op" id="6529842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="6529845">//&nbsp;slowFilterPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;func&nbsp;filterPaeth.</span><br>
<span class="lineno"></span><span class="keyword" id="6529921">func</span>&nbsp;<span class="ident" id="6529926">slowFilterPaeth</span><span class="op" id="6529941">(</span><span class="ident" id="6529942">cdat</span><span class="op" id="6529946">,</span>&nbsp;<span class="ident" id="6529948">pdat</span>&nbsp;<span class="op" id="6529953">[</span><span class="op" id="6529954">]</span><span class="builtintype" id="6529955">byte</span><span class="op" id="6529959">,</span>&nbsp;<span class="ident" id="6529961">bytesPerPixel</span>&nbsp;<span class="builtintype" id="6529975">int</span><span class="op" id="6529978">)</span>&nbsp;<span class="op" id="6529980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6529983">for</span>&nbsp;<span class="ident" id="6529987">i</span>&nbsp;<span class="op" id="6529989">:=</span>&nbsp;<span class="num" id="6529992">0</span><span class="op" id="6529993">;</span>&nbsp;<span class="ident" id="6529995">i</span>&nbsp;<span class="op" id="6529997">&lt;</span>&nbsp;<span class="ident" id="6529999">bytesPerPixel</span><span class="op" id="6530012">;</span>&nbsp;<span class="ident" id="6530014">i</span><span class="op" id="6530015">++</span>&nbsp;<span class="op" id="6530018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530022">cdat</span><span class="op" id="6530026">[</span><span class="ident" id="6530027">i</span><span class="op" id="6530028">]</span>&nbsp;<span class="op" id="6530030">+=</span>&nbsp;<span class="ident" id="6530033">paeth</span><span class="op" id="6530038">(</span><span class="num" id="6530039">0</span><span class="op" id="6530040">,</span>&nbsp;<span class="ident" id="6530042">pdat</span><span class="op" id="6530046">[</span><span class="ident" id="6530047">i</span><span class="op" id="6530048">]</span><span class="op" id="6530049">,</span>&nbsp;<span class="num" id="6530051">0</span><span class="op" id="6530052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6530055">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6530058">for</span>&nbsp;<span class="ident" id="6530062">i</span>&nbsp;<span class="op" id="6530064">:=</span>&nbsp;<span class="ident" id="6530067">bytesPerPixel</span><span class="op" id="6530080">;</span>&nbsp;<span class="ident" id="6530082">i</span>&nbsp;<span class="op" id="6530084">&lt;</span>&nbsp;<span class="builtinfunc" id="6530086">len</span><span class="op" id="6530089">(</span><span class="ident" id="6530090">cdat</span><span class="op" id="6530094">)</span><span class="op" id="6530095">;</span>&nbsp;<span class="ident" id="6530097">i</span><span class="op" id="6530098">++</span>&nbsp;<span class="op" id="6530101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530105">cdat</span><span class="op" id="6530109">[</span><span class="ident" id="6530110">i</span><span class="op" id="6530111">]</span>&nbsp;<span class="op" id="6530113">+=</span>&nbsp;<span class="ident" id="6530116">paeth</span><span class="op" id="6530121">(</span><span class="ident" id="6530122">cdat</span><span class="op" id="6530126">[</span><span class="ident" id="6530127">i</span><span class="op" id="6530128">-</span><span class="ident" id="6530129">bytesPerPixel</span><span class="op" id="6530142">]</span><span class="op" id="6530143">,</span>&nbsp;<span class="ident" id="6530145">pdat</span><span class="op" id="6530149">[</span><span class="ident" id="6530150">i</span><span class="op" id="6530151">]</span><span class="op" id="6530152">,</span>&nbsp;<span class="ident" id="6530154">pdat</span><span class="op" id="6530158">[</span><span class="ident" id="6530159">i</span><span class="op" id="6530160">-</span><span class="ident" id="6530161">bytesPerPixel</span><span class="op" id="6530174">]</span><span class="op" id="6530175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6530178">}</span><br>
<span class="lineno"></span><span class="op" id="6530180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="6530183">func</span>&nbsp;<span class="ident" id="6530188">TestPaeth</span><span class="op" id="6530197">(</span><span class="ident" id="6530198">t</span>&nbsp;<span class="op" id="6530200">*</span><span class="ident" id="6530201">testing</span><span class="op" id="6530208">.</span><span class="ident" id="6530209">T</span><span class="op" id="6530210">)</span>&nbsp;<span class="op" id="6530212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6530215">for</span>&nbsp;<span class="ident" id="6530219">a</span>&nbsp;<span class="op" id="6530221">:=</span>&nbsp;<span class="num" id="6530224">0</span><span class="op" id="6530225">;</span>&nbsp;<span class="ident" id="6530227">a</span>&nbsp;<span class="op" id="6530229">&lt;</span>&nbsp;<span class="num" id="6530231">256</span><span class="op" id="6530234">;</span>&nbsp;<span class="ident" id="6530236">a</span>&nbsp;<span class="op" id="6530238">+=</span>&nbsp;<span class="num" id="6530241">15</span>&nbsp;<span class="op" id="6530244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6530248">for</span>&nbsp;<span class="ident" id="6530252">b</span>&nbsp;<span class="op" id="6530254">:=</span>&nbsp;<span class="num" id="6530257">0</span><span class="op" id="6530258">;</span>&nbsp;<span class="ident" id="6530260">b</span>&nbsp;<span class="op" id="6530262">&lt;</span>&nbsp;<span class="num" id="6530264">256</span><span class="op" id="6530267">;</span>&nbsp;<span class="ident" id="6530269">b</span>&nbsp;<span class="op" id="6530271">+=</span>&nbsp;<span class="num" id="6530274">15</span>&nbsp;<span class="op" id="6530277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6530282">for</span>&nbsp;<span class="ident" id="6530286">c</span>&nbsp;<span class="op" id="6530288">:=</span>&nbsp;<span class="num" id="6530291">0</span><span class="op" id="6530292">;</span>&nbsp;<span class="ident" id="6530294">c</span>&nbsp;<span class="op" id="6530296">&lt;</span>&nbsp;<span class="num" id="6530298">256</span><span class="op" id="6530301">;</span>&nbsp;<span class="ident" id="6530303">c</span>&nbsp;<span class="op" id="6530305">+=</span>&nbsp;<span class="num" id="6530308">15</span>&nbsp;<span class="op" id="6530311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530317">got</span>&nbsp;<span class="op" id="6530321">:=</span>&nbsp;<span class="ident" id="6530324">paeth</span><span class="op" id="6530329">(</span><span class="builtintype" id="6530330">uint8</span><span class="op" id="6530335">(</span><span class="ident" id="6530336">a</span><span class="op" id="6530337">)</span><span class="op" id="6530338">,</span>&nbsp;<span class="builtintype" id="6530340">uint8</span><span class="op" id="6530345">(</span><span class="ident" id="6530346">b</span><span class="op" id="6530347">)</span><span class="op" id="6530348">,</span>&nbsp;<span class="builtintype" id="6530350">uint8</span><span class="op" id="6530355">(</span><span class="ident" id="6530356">c</span><span class="op" id="6530357">)</span><span class="op" id="6530358">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530364">want</span>&nbsp;<span class="op" id="6530369">:=</span>&nbsp;<span class="ident" id="6530372">slowPaeth</span><span class="op" id="6530381">(</span><span class="builtintype" id="6530382">uint8</span><span class="op" id="6530387">(</span><span class="ident" id="6530388">a</span><span class="op" id="6530389">)</span><span class="op" id="6530390">,</span>&nbsp;<span class="builtintype" id="6530392">uint8</span><span class="op" id="6530397">(</span><span class="ident" id="6530398">b</span><span class="op" id="6530399">)</span><span class="op" id="6530400">,</span>&nbsp;<span class="builtintype" id="6530402">uint8</span><span class="op" id="6530407">(</span><span class="ident" id="6530408">c</span><span class="op" id="6530409">)</span><span class="op" id="6530410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6530416">if</span>&nbsp;<span class="ident" id="6530419">got</span>&nbsp;<span class="op" id="6530423">!=</span>&nbsp;<span class="ident" id="6530426">want</span>&nbsp;<span class="op" id="6530431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530438">t</span><span class="op" id="6530439">.</span><span class="ident" id="6530440">Errorf</span><span class="op" id="6530446">(</span><span class="string" id="6530447">&#34;a,&nbsp;b,&nbsp;c&nbsp;=&nbsp;%d,&nbsp;%d,&nbsp;%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6530486">,</span>&nbsp;<span class="ident" id="6530488">a</span><span class="op" id="6530489">,</span>&nbsp;<span class="ident" id="6530491">b</span><span class="op" id="6530492">,</span>&nbsp;<span class="ident" id="6530494">c</span><span class="op" id="6530495">,</span>&nbsp;<span class="ident" id="6530497">got</span><span class="op" id="6530500">,</span>&nbsp;<span class="ident" id="6530502">want</span><span class="op" id="6530506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6530512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6530517">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6530521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6530524">}</span><br>
<span class="lineno"></span><span class="op" id="6530526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6530529">func</span>&nbsp;<span class="ident" id="6530534">BenchmarkPaeth</span><span class="op" id="6530548">(</span><span class="ident" id="6530549">b</span>&nbsp;<span class="op" id="6530551">*</span><span class="ident" id="6530552">testing</span><span class="op" id="6530559">.</span><span class="ident" id="6530560">B</span><span class="op" id="6530561">)</span>&nbsp;<span class="op" id="6530563">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6530566">for</span>&nbsp;<span class="ident" id="6530570">i</span>&nbsp;<span class="op" id="6530572">:=</span>&nbsp;<span class="num" id="6530575">0</span><span class="op" id="6530576">;</span>&nbsp;<span class="ident" id="6530578">i</span>&nbsp;<span class="op" id="6530580">&lt;</span>&nbsp;<span class="ident" id="6530582">b</span><span class="op" id="6530583">.</span><span class="ident" id="6530584">N</span><span class="op" id="6530585">;</span>&nbsp;<span class="ident" id="6530587">i</span><span class="op" id="6530588">++</span>&nbsp;<span class="op" id="6530591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530595">paeth</span><span class="op" id="6530600">(</span><span class="builtintype" id="6530601">uint8</span><span class="op" id="6530606">(</span><span class="ident" id="6530607">i</span><span class="op" id="6530608">&gt;&gt;</span><span class="num" id="6530610">16</span><span class="op" id="6530612">)</span><span class="op" id="6530613">,</span>&nbsp;<span class="builtintype" id="6530615">uint8</span><span class="op" id="6530620">(</span><span class="ident" id="6530621">i</span><span class="op" id="6530622">&gt;&gt;</span><span class="num" id="6530624">8</span><span class="op" id="6530625">)</span><span class="op" id="6530626">,</span>&nbsp;<span class="builtintype" id="6530628">uint8</span><span class="op" id="6530633">(</span><span class="ident" id="6530634">i</span><span class="op" id="6530635">)</span><span class="op" id="6530636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6530639">}</span><br>
<span class="lineno"></span><span class="op" id="6530641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6530644">func</span>&nbsp;<span class="ident" id="6530649">TestPaethDecode</span><span class="op" id="6530664">(</span><span class="ident" id="6530665">t</span>&nbsp;<span class="op" id="6530667">*</span><span class="ident" id="6530668">testing</span><span class="op" id="6530675">.</span><span class="ident" id="6530676">T</span><span class="op" id="6530677">)</span>&nbsp;<span class="op" id="6530679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530682">pdat0</span>&nbsp;<span class="op" id="6530688">:=</span>&nbsp;<span class="builtinfunc" id="6530691">make</span><span class="op" id="6530695">(</span><span class="op" id="6530696">[</span><span class="op" id="6530697">]</span><span class="builtintype" id="6530698">byte</span><span class="op" id="6530702">,</span>&nbsp;<span class="num" id="6530704">32</span><span class="op" id="6530706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530709">pdat1</span>&nbsp;<span class="op" id="6530715">:=</span>&nbsp;<span class="builtinfunc" id="6530718">make</span><span class="op" id="6530722">(</span><span class="op" id="6530723">[</span><span class="op" id="6530724">]</span><span class="builtintype" id="6530725">byte</span><span class="op" id="6530729">,</span>&nbsp;<span class="num" id="6530731">32</span><span class="op" id="6530733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530736">pdat2</span>&nbsp;<span class="op" id="6530742">:=</span>&nbsp;<span class="builtinfunc" id="6530745">make</span><span class="op" id="6530749">(</span><span class="op" id="6530750">[</span><span class="op" id="6530751">]</span><span class="builtintype" id="6530752">byte</span><span class="op" id="6530756">,</span>&nbsp;<span class="num" id="6530758">32</span><span class="op" id="6530760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530763">cdat0</span>&nbsp;<span class="op" id="6530769">:=</span>&nbsp;<span class="builtinfunc" id="6530772">make</span><span class="op" id="6530776">(</span><span class="op" id="6530777">[</span><span class="op" id="6530778">]</span><span class="builtintype" id="6530779">byte</span><span class="op" id="6530783">,</span>&nbsp;<span class="num" id="6530785">32</span><span class="op" id="6530787">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530790">cdat1</span>&nbsp;<span class="op" id="6530796">:=</span>&nbsp;<span class="builtinfunc" id="6530799">make</span><span class="op" id="6530803">(</span><span class="op" id="6530804">[</span><span class="op" id="6530805">]</span><span class="builtintype" id="6530806">byte</span><span class="op" id="6530810">,</span>&nbsp;<span class="num" id="6530812">32</span><span class="op" id="6530814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530817">cdat2</span>&nbsp;<span class="op" id="6530823">:=</span>&nbsp;<span class="builtinfunc" id="6530826">make</span><span class="op" id="6530830">(</span><span class="op" id="6530831">[</span><span class="op" id="6530832">]</span><span class="builtintype" id="6530833">byte</span><span class="op" id="6530837">,</span>&nbsp;<span class="num" id="6530839">32</span><span class="op" id="6530841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530844">r</span>&nbsp;<span class="op" id="6530846">:=</span>&nbsp;<span class="ident" id="6530849">rand</span><span class="op" id="6530853">.</span><span class="ident" id="6530854">New</span><span class="op" id="6530857">(</span><span class="ident" id="6530858">rand</span><span class="op" id="6530862">.</span><span class="ident" id="6530863">NewSource</span><span class="op" id="6530872">(</span><span class="num" id="6530873">1</span><span class="op" id="6530874">)</span><span class="op" id="6530875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6530878">for</span>&nbsp;<span class="ident" id="6530882">bytesPerPixel</span>&nbsp;<span class="op" id="6530896">:=</span>&nbsp;<span class="num" id="6530899">1</span><span class="op" id="6530900">;</span>&nbsp;<span class="ident" id="6530902">bytesPerPixel</span>&nbsp;<span class="op" id="6530916">&lt;=</span>&nbsp;<span class="num" id="6530919">8</span><span class="op" id="6530920">;</span>&nbsp;<span class="ident" id="6530922">bytesPerPixel</span><span class="op" id="6530935">++</span>&nbsp;<span class="op" id="6530938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6530942">for</span>&nbsp;<span class="ident" id="6530946">i</span>&nbsp;<span class="op" id="6530948">:=</span>&nbsp;<span class="num" id="6530951">0</span><span class="op" id="6530952">;</span>&nbsp;<span class="ident" id="6530954">i</span>&nbsp;<span class="op" id="6530956">&lt;</span>&nbsp;<span class="num" id="6530958">100</span><span class="op" id="6530961">;</span>&nbsp;<span class="ident" id="6530963">i</span><span class="op" id="6530964">++</span>&nbsp;<span class="op" id="6530967">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6530972">for</span>&nbsp;<span class="ident" id="6530976">j</span>&nbsp;<span class="op" id="6530978">:=</span>&nbsp;<span class="keyword" id="6530981">range</span>&nbsp;<span class="ident" id="6530987">pdat0</span>&nbsp;<span class="op" id="6530993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6530999">pdat0</span><span class="op" id="6531004">[</span><span class="ident" id="6531005">j</span><span class="op" id="6531006">]</span>&nbsp;<span class="op" id="6531008">=</span>&nbsp;<span class="builtintype" id="6531010">uint8</span><span class="op" id="6531015">(</span><span class="ident" id="6531016">r</span><span class="op" id="6531017">.</span><span class="ident" id="6531018">Uint32</span><span class="op" id="6531024">(</span><span class="op" id="6531025">)</span><span class="op" id="6531026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6531032">cdat0</span><span class="op" id="6531037">[</span><span class="ident" id="6531038">j</span><span class="op" id="6531039">]</span>&nbsp;<span class="op" id="6531041">=</span>&nbsp;<span class="builtintype" id="6531043">uint8</span><span class="op" id="6531048">(</span><span class="ident" id="6531049">r</span><span class="op" id="6531050">.</span><span class="ident" id="6531051">Uint32</span><span class="op" id="6531057">(</span><span class="op" id="6531058">)</span><span class="op" id="6531059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6531064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6531069">copy</span><span class="op" id="6531073">(</span><span class="ident" id="6531074">pdat1</span><span class="op" id="6531079">,</span>&nbsp;<span class="ident" id="6531081">pdat0</span><span class="op" id="6531086">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6531091">copy</span><span class="op" id="6531095">(</span><span class="ident" id="6531096">pdat2</span><span class="op" id="6531101">,</span>&nbsp;<span class="ident" id="6531103">pdat0</span><span class="op" id="6531108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6531113">copy</span><span class="op" id="6531117">(</span><span class="ident" id="6531118">cdat1</span><span class="op" id="6531123">,</span>&nbsp;<span class="ident" id="6531125">cdat0</span><span class="op" id="6531130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6531135">copy</span><span class="op" id="6531139">(</span><span class="ident" id="6531140">cdat2</span><span class="op" id="6531145">,</span>&nbsp;<span class="ident" id="6531147">cdat0</span><span class="op" id="6531152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6531157">filterPaeth</span><span class="op" id="6531168">(</span><span class="ident" id="6531169">cdat1</span><span class="op" id="6531174">,</span>&nbsp;<span class="ident" id="6531176">pdat1</span><span class="op" id="6531181">,</span>&nbsp;<span class="ident" id="6531183">bytesPerPixel</span><span class="op" id="6531196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6531201">slowFilterPaeth</span><span class="op" id="6531216">(</span><span class="ident" id="6531217">cdat2</span><span class="op" id="6531222">,</span>&nbsp;<span class="ident" id="6531224">pdat2</span><span class="op" id="6531229">,</span>&nbsp;<span class="ident" id="6531231">bytesPerPixel</span><span class="op" id="6531244">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6531249">if</span>&nbsp;<span class="op" id="6531252">!</span><span class="ident" id="6531253">bytes</span><span class="op" id="6531258">.</span><span class="ident" id="6531259">Equal</span><span class="op" id="6531264">(</span><span class="ident" id="6531265">cdat1</span><span class="op" id="6531270">,</span>&nbsp;<span class="ident" id="6531272">cdat2</span><span class="op" id="6531277">)</span>&nbsp;<span class="op" id="6531279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6531285">t</span><span class="op" id="6531286">.</span><span class="ident" id="6531287">Errorf</span><span class="op" id="6531293">(</span><span class="string" id="6531294">&#34;bytesPerPixel:&nbsp;%d\npdat0:&nbsp;%&nbsp;x\ncdat0:&nbsp;%&nbsp;x\ngot:&nbsp;&nbsp;&nbsp;%&nbsp;x\nwant:&nbsp;&nbsp;%&nbsp;x&#34;</span><span class="op" id="6531361">,</span>&nbsp;<span class="ident" id="6531363">bytesPerPixel</span><span class="op" id="6531376">,</span>&nbsp;<span class="ident" id="6531378">pdat0</span><span class="op" id="6531383">,</span>&nbsp;<span class="ident" id="6531385">cdat0</span><span class="op" id="6531390">,</span>&nbsp;<span class="ident" id="6531392">cdat1</span><span class="op" id="6531397">,</span>&nbsp;<span class="ident" id="6531399">cdat2</span><span class="op" id="6531404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6531410">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6531419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6531423">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6531426">}</span><br>
<span class="lineno"></span><span class="op" id="6531428">}</span>
</div>
</body>
</html>
