<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8496336">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8496391">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8496445">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8496496">package</span>&nbsp;<span class="ident" id="8496504">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8496510">import</span>&nbsp;<span class="op" id="8496517">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496520">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496529">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496543">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496559">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496578">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496593">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8496607">_</span>&nbsp;<span class="string" id="8496609">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8496626">_</span>&nbsp;<span class="string" id="8496628">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496645">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496665">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496682">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496701">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496717">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496733">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496745">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496752">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496763">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496774">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496785">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8496796">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8496803">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8496806">func</span>&nbsp;<span class="ident" id="8496811">TestParsePKCS1PrivateKey</span><span class="op" id="8496835">(</span><span class="ident" id="8496836">t</span>&nbsp;<span class="op" id="8496838">*</span><span class="ident" id="8496839">testing</span><span class="op" id="8496846">.</span><span class="ident" id="8496847">T</span><span class="op" id="8496848">)</span>&nbsp;<span class="op" id="8496850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8496853">block</span><span class="op" id="8496858">,</span>&nbsp;<span class="ident" id="8496860">_</span>&nbsp;<span class="op" id="8496862">:=</span>&nbsp;<span class="ident" id="8496865">pem</span><span class="op" id="8496868">.</span><span class="ident" id="8496869">Decode</span><span class="op" id="8496875">(</span><span class="op" id="8496876">[</span><span class="op" id="8496877">]</span><span class="builtintype" id="8496878">byte</span><span class="op" id="8496882">(</span><span class="ident" id="8496883">pemPrivateKey</span><span class="op" id="8496896">)</span><span class="op" id="8496897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8496900">priv</span><span class="op" id="8496904">,</span>&nbsp;<span class="ident" id="8496906">err</span>&nbsp;<span class="op" id="8496910">:=</span>&nbsp;<span class="ident" id="8496913">ParsePKCS1PrivateKey</span><span class="op" id="8496933">(</span><span class="ident" id="8496934">block</span><span class="op" id="8496939">.</span><span class="ident" id="8496940">Bytes</span><span class="op" id="8496945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8496948">if</span>&nbsp;<span class="ident" id="8496951">err</span>&nbsp;<span class="op" id="8496955">!=</span>&nbsp;<span class="ident" id="8496958">nil</span>&nbsp;<span class="op" id="8496962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8496966">t</span><span class="op" id="8496967">.</span><span class="ident" id="8496968">Errorf</span><span class="op" id="8496974">(</span><span class="string" id="8496975">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8497008">,</span>&nbsp;<span class="ident" id="8497010">err</span><span class="op" id="8497013">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8497017">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8497025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8497028">if</span>&nbsp;<span class="ident" id="8497031">priv</span><span class="op" id="8497035">.</span><span class="ident" id="8497036">PublicKey</span><span class="op" id="8497045">.</span><span class="ident" id="8497046">N</span><span class="op" id="8497047">.</span><span class="ident" id="8497048">Cmp</span><span class="op" id="8497051">(</span><span class="ident" id="8497052">rsaPrivateKey</span><span class="op" id="8497065">.</span><span class="ident" id="8497066">PublicKey</span><span class="op" id="8497075">.</span><span class="ident" id="8497076">N</span><span class="op" id="8497077">)</span>&nbsp;<span class="op" id="8497079">!=</span>&nbsp;<span class="num" id="8497082">0</span>&nbsp;<span class="op" id="8497084">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497089">priv</span><span class="op" id="8497093">.</span><span class="ident" id="8497094">PublicKey</span><span class="op" id="8497103">.</span><span class="ident" id="8497104">E</span>&nbsp;<span class="op" id="8497106">!=</span>&nbsp;<span class="ident" id="8497109">rsaPrivateKey</span><span class="op" id="8497122">.</span><span class="ident" id="8497123">PublicKey</span><span class="op" id="8497132">.</span><span class="ident" id="8497133">E</span>&nbsp;<span class="op" id="8497135">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497140">priv</span><span class="op" id="8497144">.</span><span class="ident" id="8497145">D</span><span class="op" id="8497146">.</span><span class="ident" id="8497147">Cmp</span><span class="op" id="8497150">(</span><span class="ident" id="8497151">rsaPrivateKey</span><span class="op" id="8497164">.</span><span class="ident" id="8497165">D</span><span class="op" id="8497166">)</span>&nbsp;<span class="op" id="8497168">!=</span>&nbsp;<span class="num" id="8497171">0</span>&nbsp;<span class="op" id="8497173">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497178">priv</span><span class="op" id="8497182">.</span><span class="ident" id="8497183">Primes</span><span class="op" id="8497189">[</span><span class="num" id="8497190">0</span><span class="op" id="8497191">]</span><span class="op" id="8497192">.</span><span class="ident" id="8497193">Cmp</span><span class="op" id="8497196">(</span><span class="ident" id="8497197">rsaPrivateKey</span><span class="op" id="8497210">.</span><span class="ident" id="8497211">Primes</span><span class="op" id="8497217">[</span><span class="num" id="8497218">0</span><span class="op" id="8497219">]</span><span class="op" id="8497220">)</span>&nbsp;<span class="op" id="8497222">!=</span>&nbsp;<span class="num" id="8497225">0</span>&nbsp;<span class="op" id="8497227">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497232">priv</span><span class="op" id="8497236">.</span><span class="ident" id="8497237">Primes</span><span class="op" id="8497243">[</span><span class="num" id="8497244">1</span><span class="op" id="8497245">]</span><span class="op" id="8497246">.</span><span class="ident" id="8497247">Cmp</span><span class="op" id="8497250">(</span><span class="ident" id="8497251">rsaPrivateKey</span><span class="op" id="8497264">.</span><span class="ident" id="8497265">Primes</span><span class="op" id="8497271">[</span><span class="num" id="8497272">1</span><span class="op" id="8497273">]</span><span class="op" id="8497274">)</span>&nbsp;<span class="op" id="8497276">!=</span>&nbsp;<span class="num" id="8497279">0</span>&nbsp;<span class="op" id="8497281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497285">t</span><span class="op" id="8497286">.</span><span class="ident" id="8497287">Errorf</span><span class="op" id="8497293">(</span><span class="string" id="8497294">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="8497312">,</span>&nbsp;<span class="ident" id="8497314">priv</span><span class="op" id="8497318">,</span>&nbsp;<span class="ident" id="8497320">rsaPrivateKey</span><span class="op" id="8497333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8497336">}</span><br>
<span class="lineno"></span><span class="op" id="8497338">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8497341">func</span>&nbsp;<span class="ident" id="8497346">TestParsePKIXPublicKey</span><span class="op" id="8497368">(</span><span class="ident" id="8497369">t</span>&nbsp;<span class="op" id="8497371">*</span><span class="ident" id="8497372">testing</span><span class="op" id="8497379">.</span><span class="ident" id="8497380">T</span><span class="op" id="8497381">)</span>&nbsp;<span class="op" id="8497383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497386">block</span><span class="op" id="8497391">,</span>&nbsp;<span class="ident" id="8497393">_</span>&nbsp;<span class="op" id="8497395">:=</span>&nbsp;<span class="ident" id="8497398">pem</span><span class="op" id="8497401">.</span><span class="ident" id="8497402">Decode</span><span class="op" id="8497408">(</span><span class="op" id="8497409">[</span><span class="op" id="8497410">]</span><span class="builtintype" id="8497411">byte</span><span class="op" id="8497415">(</span><span class="ident" id="8497416">pemPublicKey</span><span class="op" id="8497428">)</span><span class="op" id="8497429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497432">pub</span><span class="op" id="8497435">,</span>&nbsp;<span class="ident" id="8497437">err</span>&nbsp;<span class="op" id="8497441">:=</span>&nbsp;<span class="ident" id="8497444">ParsePKIXPublicKey</span><span class="op" id="8497462">(</span><span class="ident" id="8497463">block</span><span class="op" id="8497468">.</span><span class="ident" id="8497469">Bytes</span><span class="op" id="8497474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8497477">if</span>&nbsp;<span class="ident" id="8497480">err</span>&nbsp;<span class="op" id="8497484">!=</span>&nbsp;<span class="ident" id="8497487">nil</span>&nbsp;<span class="op" id="8497491">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497495">t</span><span class="op" id="8497496">.</span><span class="ident" id="8497497">Errorf</span><span class="op" id="8497503">(</span><span class="string" id="8497504">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8497540">,</span>&nbsp;<span class="ident" id="8497542">err</span><span class="op" id="8497545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8497549">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8497557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497560">rsaPub</span><span class="op" id="8497566">,</span>&nbsp;<span class="ident" id="8497568">ok</span>&nbsp;<span class="op" id="8497571">:=</span>&nbsp;<span class="ident" id="8497574">pub</span><span class="op" id="8497577">.</span><span class="op" id="8497578">(</span><span class="op" id="8497579">*</span><span class="ident" id="8497580">rsa</span><span class="op" id="8497583">.</span><span class="ident" id="8497584">PublicKey</span><span class="op" id="8497593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8497596">if</span>&nbsp;<span class="op" id="8497599">!</span><span class="ident" id="8497600">ok</span>&nbsp;<span class="op" id="8497603">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497607">t</span><span class="op" id="8497608">.</span><span class="ident" id="8497609">Errorf</span><span class="op" id="8497615">(</span><span class="string" id="8497616">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="8497682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8497686">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8497694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497698">pubBytes2</span><span class="op" id="8497707">,</span>&nbsp;<span class="ident" id="8497709">err</span>&nbsp;<span class="op" id="8497713">:=</span>&nbsp;<span class="ident" id="8497716">MarshalPKIXPublicKey</span><span class="op" id="8497736">(</span><span class="ident" id="8497737">rsaPub</span><span class="op" id="8497743">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8497746">if</span>&nbsp;<span class="ident" id="8497749">err</span>&nbsp;<span class="op" id="8497753">!=</span>&nbsp;<span class="ident" id="8497756">nil</span>&nbsp;<span class="op" id="8497760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497764">t</span><span class="op" id="8497765">.</span><span class="ident" id="8497766">Errorf</span><span class="op" id="8497772">(</span><span class="string" id="8497773">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="8497831">,</span>&nbsp;<span class="ident" id="8497833">err</span><span class="op" id="8497836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8497840">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8497848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8497851">if</span>&nbsp;<span class="op" id="8497854">!</span><span class="ident" id="8497855">bytes</span><span class="op" id="8497860">.</span><span class="ident" id="8497861">Equal</span><span class="op" id="8497866">(</span><span class="ident" id="8497867">pubBytes2</span><span class="op" id="8497876">,</span>&nbsp;<span class="ident" id="8497878">block</span><span class="op" id="8497883">.</span><span class="ident" id="8497884">Bytes</span><span class="op" id="8497889">)</span>&nbsp;<span class="op" id="8497891">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8497895">t</span><span class="op" id="8497896">.</span><span class="ident" id="8497897">Errorf</span><span class="op" id="8497903">(</span><span class="string" id="8497904">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8497965">,</span>&nbsp;<span class="ident" id="8497967">pubBytes2</span><span class="op" id="8497976">,</span>&nbsp;<span class="ident" id="8497978">block</span><span class="op" id="8497983">.</span><span class="ident" id="8497984">Bytes</span><span class="op" id="8497989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8497992">}</span><br>
<span class="lineno"></span><span class="op" id="8497994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8497997">var</span>&nbsp;<span class="ident" id="8498001">pemPublicKey</span>&nbsp;<span class="op" id="8498014">=</span>&nbsp;<span class="string" id="8498016">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="8498471">var</span>&nbsp;<span class="ident" id="8498475">pemPrivateKey</span>&nbsp;<span class="op" id="8498489">=</span>&nbsp;<span class="string" id="8498491">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="8498988">func</span>&nbsp;<span class="ident" id="8498993">bigFromString</span><span class="op" id="8499006">(</span><span class="ident" id="8499007">s</span>&nbsp;<span class="builtintype" id="8499009">string</span><span class="op" id="8499015">)</span>&nbsp;<span class="op" id="8499017">*</span><span class="ident" id="8499018">big</span><span class="op" id="8499021">.</span><span class="ident" id="8499022">Int</span>&nbsp;<span class="op" id="8499026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499029">ret</span>&nbsp;<span class="op" id="8499033">:=</span>&nbsp;<span class="builtinfunc" id="8499036">new</span><span class="op" id="8499039">(</span><span class="ident" id="8499040">big</span><span class="op" id="8499043">.</span><span class="ident" id="8499044">Int</span><span class="op" id="8499047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499050">ret</span><span class="op" id="8499053">.</span><span class="ident" id="8499054">SetString</span><span class="op" id="8499063">(</span><span class="ident" id="8499064">s</span><span class="op" id="8499065">,</span>&nbsp;<span class="num" id="8499067">10</span><span class="op" id="8499069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8499072">return</span>&nbsp;<span class="ident" id="8499079">ret</span><br>
<span class="lineno">95</span><span class="op" id="8499083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8499086">func</span>&nbsp;<span class="ident" id="8499091">fromBase10</span><span class="op" id="8499101">(</span><span class="ident" id="8499102">base10</span>&nbsp;<span class="builtintype" id="8499109">string</span><span class="op" id="8499115">)</span>&nbsp;<span class="op" id="8499117">*</span><span class="ident" id="8499118">big</span><span class="op" id="8499121">.</span><span class="ident" id="8499122">Int</span>&nbsp;<span class="op" id="8499126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499129">i</span>&nbsp;<span class="op" id="8499131">:=</span>&nbsp;<span class="builtinfunc" id="8499134">new</span><span class="op" id="8499137">(</span><span class="ident" id="8499138">big</span><span class="op" id="8499141">.</span><span class="ident" id="8499142">Int</span><span class="op" id="8499145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499148">i</span><span class="op" id="8499149">.</span><span class="ident" id="8499150">SetString</span><span class="op" id="8499159">(</span><span class="ident" id="8499160">base10</span><span class="op" id="8499166">,</span>&nbsp;<span class="num" id="8499168">10</span><span class="op" id="8499170">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8499173">return</span>&nbsp;<span class="ident" id="8499180">i</span><br>
<span class="lineno"></span><span class="op" id="8499182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8499185">func</span>&nbsp;<span class="ident" id="8499190">bigFromHexString</span><span class="op" id="8499206">(</span><span class="ident" id="8499207">s</span>&nbsp;<span class="builtintype" id="8499209">string</span><span class="op" id="8499215">)</span>&nbsp;<span class="op" id="8499217">*</span><span class="ident" id="8499218">big</span><span class="op" id="8499221">.</span><span class="ident" id="8499222">Int</span>&nbsp;<span class="op" id="8499226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499229">ret</span>&nbsp;<span class="op" id="8499233">:=</span>&nbsp;<span class="builtinfunc" id="8499236">new</span><span class="op" id="8499239">(</span><span class="ident" id="8499240">big</span><span class="op" id="8499243">.</span><span class="ident" id="8499244">Int</span><span class="op" id="8499247">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499250">ret</span><span class="op" id="8499253">.</span><span class="ident" id="8499254">SetString</span><span class="op" id="8499263">(</span><span class="ident" id="8499264">s</span><span class="op" id="8499265">,</span>&nbsp;<span class="num" id="8499267">16</span><span class="op" id="8499269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8499272">return</span>&nbsp;<span class="ident" id="8499279">ret</span><br>
<span class="lineno"></span><span class="op" id="8499283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8499286">var</span>&nbsp;<span class="ident" id="8499290">rsaPrivateKey</span>&nbsp;<span class="op" id="8499304">=</span>&nbsp;<span class="op" id="8499306">&amp;</span><span class="ident" id="8499307">rsa</span><span class="op" id="8499310">.</span><span class="ident" id="8499311">PrivateKey</span><span class="op" id="8499321">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499324">PublicKey</span><span class="op" id="8499333">:</span>&nbsp;<span class="ident" id="8499335">rsa</span><span class="op" id="8499338">.</span><span class="ident" id="8499339">PublicKey</span><span class="op" id="8499348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499352">N</span><span class="op" id="8499353">:</span>&nbsp;<span class="ident" id="8499355">bigFromString</span><span class="op" id="8499368">(</span><span class="string" id="8499369">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8499525">)</span><span class="op" id="8499526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499530">E</span><span class="op" id="8499531">:</span>&nbsp;<span class="num" id="8499533">65537</span><span class="op" id="8499538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8499541">}</span><span class="op" id="8499542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499545">D</span><span class="op" id="8499546">:</span>&nbsp;<span class="ident" id="8499548">bigFromString</span><span class="op" id="8499561">(</span><span class="string" id="8499562">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8499718">)</span><span class="op" id="8499719">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499722">Primes</span><span class="op" id="8499728">:</span>&nbsp;<span class="op" id="8499730">[</span><span class="op" id="8499731">]</span><span class="op" id="8499732">*</span><span class="ident" id="8499733">big</span><span class="op" id="8499736">.</span><span class="ident" id="8499737">Int</span><span class="op" id="8499740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499744">bigFromString</span><span class="op" id="8499757">(</span><span class="string" id="8499758">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8499837">)</span><span class="op" id="8499838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499842">bigFromString</span><span class="op" id="8499855">(</span><span class="string" id="8499856">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8499935">)</span><span class="op" id="8499936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8499939">}</span><span class="op" id="8499940">,</span><br>
<span class="lineno"></span><span class="op" id="8499942">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="8499945">func</span>&nbsp;<span class="ident" id="8499950">TestMarshalRSAPrivateKey</span><span class="op" id="8499974">(</span><span class="ident" id="8499975">t</span>&nbsp;<span class="op" id="8499977">*</span><span class="ident" id="8499978">testing</span><span class="op" id="8499985">.</span><span class="ident" id="8499986">T</span><span class="op" id="8499987">)</span>&nbsp;<span class="op" id="8499989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8499992">priv</span>&nbsp;<span class="op" id="8499997">:=</span>&nbsp;<span class="op" id="8500000">&amp;</span><span class="ident" id="8500001">rsa</span><span class="op" id="8500004">.</span><span class="ident" id="8500005">PrivateKey</span><span class="op" id="8500015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8500019">PublicKey</span><span class="op" id="8500028">:</span>&nbsp;<span class="ident" id="8500030">rsa</span><span class="op" id="8500033">.</span><span class="ident" id="8500034">PublicKey</span><span class="op" id="8500043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8500048">N</span><span class="op" id="8500049">:</span>&nbsp;<span class="ident" id="8500051">fromBase10</span><span class="op" id="8500061">(</span><span class="string" id="8500062">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="8500681">)</span><span class="op" id="8500682">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8500687">E</span><span class="op" id="8500688">:</span>&nbsp;<span class="num" id="8500690">3</span><span class="op" id="8500691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8500695">}</span><span class="op" id="8500696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8500700">D</span><span class="op" id="8500701">:</span>&nbsp;<span class="ident" id="8500703">fromBase10</span><span class="op" id="8500713">(</span><span class="string" id="8500714">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="8501333">)</span><span class="op" id="8501334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8501338">Primes</span><span class="op" id="8501344">:</span>&nbsp;<span class="op" id="8501346">[</span><span class="op" id="8501347">]</span><span class="op" id="8501348">*</span><span class="ident" id="8501349">big</span><span class="op" id="8501352">.</span><span class="ident" id="8501353">Int</span><span class="op" id="8501356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8501361">fromBase10</span><span class="op" id="8501371">(</span><span class="string" id="8501372">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="8501582">)</span><span class="op" id="8501583">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8501588">fromBase10</span><span class="op" id="8501598">(</span><span class="string" id="8501599">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="8501806">)</span><span class="op" id="8501807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8501812">fromBase10</span><span class="op" id="8501822">(</span><span class="string" id="8501823">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="8502030">)</span><span class="op" id="8502031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502035">}</span><span class="op" id="8502036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502043">derBytes</span>&nbsp;<span class="op" id="8502052">:=</span>&nbsp;<span class="ident" id="8502055">MarshalPKCS1PrivateKey</span><span class="op" id="8502077">(</span><span class="ident" id="8502078">priv</span><span class="op" id="8502082">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502086">priv2</span><span class="op" id="8502091">,</span>&nbsp;<span class="ident" id="8502093">err</span>&nbsp;<span class="op" id="8502097">:=</span>&nbsp;<span class="ident" id="8502100">ParsePKCS1PrivateKey</span><span class="op" id="8502120">(</span><span class="ident" id="8502121">derBytes</span><span class="op" id="8502129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8502132">if</span>&nbsp;<span class="ident" id="8502135">err</span>&nbsp;<span class="op" id="8502139">!=</span>&nbsp;<span class="ident" id="8502142">nil</span>&nbsp;<span class="op" id="8502146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502150">t</span><span class="op" id="8502151">.</span><span class="ident" id="8502152">Errorf</span><span class="op" id="8502158">(</span><span class="string" id="8502159">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8502193">,</span>&nbsp;<span class="ident" id="8502195">err</span><span class="op" id="8502198">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8502202">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8502213">if</span>&nbsp;<span class="ident" id="8502216">priv</span><span class="op" id="8502220">.</span><span class="ident" id="8502221">PublicKey</span><span class="op" id="8502230">.</span><span class="ident" id="8502231">N</span><span class="op" id="8502232">.</span><span class="ident" id="8502233">Cmp</span><span class="op" id="8502236">(</span><span class="ident" id="8502237">priv2</span><span class="op" id="8502242">.</span><span class="ident" id="8502243">PublicKey</span><span class="op" id="8502252">.</span><span class="ident" id="8502253">N</span><span class="op" id="8502254">)</span>&nbsp;<span class="op" id="8502256">!=</span>&nbsp;<span class="num" id="8502259">0</span>&nbsp;<span class="op" id="8502261">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502266">priv</span><span class="op" id="8502270">.</span><span class="ident" id="8502271">PublicKey</span><span class="op" id="8502280">.</span><span class="ident" id="8502281">E</span>&nbsp;<span class="op" id="8502283">!=</span>&nbsp;<span class="ident" id="8502286">priv2</span><span class="op" id="8502291">.</span><span class="ident" id="8502292">PublicKey</span><span class="op" id="8502301">.</span><span class="ident" id="8502302">E</span>&nbsp;<span class="op" id="8502304">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502309">priv</span><span class="op" id="8502313">.</span><span class="ident" id="8502314">D</span><span class="op" id="8502315">.</span><span class="ident" id="8502316">Cmp</span><span class="op" id="8502319">(</span><span class="ident" id="8502320">priv2</span><span class="op" id="8502325">.</span><span class="ident" id="8502326">D</span><span class="op" id="8502327">)</span>&nbsp;<span class="op" id="8502329">!=</span>&nbsp;<span class="num" id="8502332">0</span>&nbsp;<span class="op" id="8502334">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8502339">len</span><span class="op" id="8502342">(</span><span class="ident" id="8502343">priv2</span><span class="op" id="8502348">.</span><span class="ident" id="8502349">Primes</span><span class="op" id="8502355">)</span>&nbsp;<span class="op" id="8502357">!=</span>&nbsp;<span class="num" id="8502360">3</span>&nbsp;<span class="op" id="8502362">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502367">priv</span><span class="op" id="8502371">.</span><span class="ident" id="8502372">Primes</span><span class="op" id="8502378">[</span><span class="num" id="8502379">0</span><span class="op" id="8502380">]</span><span class="op" id="8502381">.</span><span class="ident" id="8502382">Cmp</span><span class="op" id="8502385">(</span><span class="ident" id="8502386">priv2</span><span class="op" id="8502391">.</span><span class="ident" id="8502392">Primes</span><span class="op" id="8502398">[</span><span class="num" id="8502399">0</span><span class="op" id="8502400">]</span><span class="op" id="8502401">)</span>&nbsp;<span class="op" id="8502403">!=</span>&nbsp;<span class="num" id="8502406">0</span>&nbsp;<span class="op" id="8502408">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502413">priv</span><span class="op" id="8502417">.</span><span class="ident" id="8502418">Primes</span><span class="op" id="8502424">[</span><span class="num" id="8502425">1</span><span class="op" id="8502426">]</span><span class="op" id="8502427">.</span><span class="ident" id="8502428">Cmp</span><span class="op" id="8502431">(</span><span class="ident" id="8502432">priv2</span><span class="op" id="8502437">.</span><span class="ident" id="8502438">Primes</span><span class="op" id="8502444">[</span><span class="num" id="8502445">1</span><span class="op" id="8502446">]</span><span class="op" id="8502447">)</span>&nbsp;<span class="op" id="8502449">!=</span>&nbsp;<span class="num" id="8502452">0</span>&nbsp;<span class="op" id="8502454">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502459">priv</span><span class="op" id="8502463">.</span><span class="ident" id="8502464">Primes</span><span class="op" id="8502470">[</span><span class="num" id="8502471">2</span><span class="op" id="8502472">]</span><span class="op" id="8502473">.</span><span class="ident" id="8502474">Cmp</span><span class="op" id="8502477">(</span><span class="ident" id="8502478">priv2</span><span class="op" id="8502483">.</span><span class="ident" id="8502484">Primes</span><span class="op" id="8502490">[</span><span class="num" id="8502491">2</span><span class="op" id="8502492">]</span><span class="op" id="8502493">)</span>&nbsp;<span class="op" id="8502495">!=</span>&nbsp;<span class="num" id="8502498">0</span>&nbsp;<span class="op" id="8502500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502504">t</span><span class="op" id="8502505">.</span><span class="ident" id="8502506">Errorf</span><span class="op" id="8502512">(</span><span class="string" id="8502513">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="8502531">,</span>&nbsp;<span class="ident" id="8502533">priv</span><span class="op" id="8502537">,</span>&nbsp;<span class="ident" id="8502539">priv2</span><span class="op" id="8502544">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502547">}</span><br>
<span class="lineno"></span><span class="op" id="8502549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8502552">type</span>&nbsp;<span class="ident" id="8502557">matchHostnamesTest</span>&nbsp;<span class="keyword" id="8502576">struct</span>&nbsp;<span class="op" id="8502583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502586">pattern</span><span class="op" id="8502593">,</span>&nbsp;<span class="ident" id="8502595">host</span>&nbsp;<span class="builtintype" id="8502600">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8502608">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8502622">bool</span><br>
<span class="lineno"></span><span class="op" id="8502627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8502630">var</span>&nbsp;<span class="ident" id="8502634">matchHostnamesTests</span>&nbsp;<span class="op" id="8502654">=</span>&nbsp;<span class="op" id="8502656">[</span><span class="op" id="8502657">]</span><span class="ident" id="8502658">matchHostnamesTest</span><span class="op" id="8502676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502679">{</span><span class="string" id="8502680">&#34;a.b.c&#34;</span><span class="op" id="8502687">,</span>&nbsp;<span class="string" id="8502689">&#34;a.b.c&#34;</span><span class="op" id="8502696">,</span>&nbsp;<span class="builtintype" id="8502698">true</span><span class="op" id="8502702">}</span><span class="op" id="8502703">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502706">{</span><span class="string" id="8502707">&#34;a.b.c&#34;</span><span class="op" id="8502714">,</span>&nbsp;<span class="string" id="8502716">&#34;b.b.c&#34;</span><span class="op" id="8502723">,</span>&nbsp;<span class="builtintype" id="8502725">false</span><span class="op" id="8502730">}</span><span class="op" id="8502731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502734">{</span><span class="string" id="8502735">&#34;&#34;</span><span class="op" id="8502737">,</span>&nbsp;<span class="string" id="8502739">&#34;b.b.c&#34;</span><span class="op" id="8502746">,</span>&nbsp;<span class="builtintype" id="8502748">false</span><span class="op" id="8502753">}</span><span class="op" id="8502754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502757">{</span><span class="string" id="8502758">&#34;a.b.c&#34;</span><span class="op" id="8502765">,</span>&nbsp;<span class="string" id="8502767">&#34;&#34;</span><span class="op" id="8502769">,</span>&nbsp;<span class="builtintype" id="8502771">false</span><span class="op" id="8502776">}</span><span class="op" id="8502777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502780">{</span><span class="string" id="8502781">&#34;example.com&#34;</span><span class="op" id="8502794">,</span>&nbsp;<span class="string" id="8502796">&#34;example.com&#34;</span><span class="op" id="8502809">,</span>&nbsp;<span class="builtintype" id="8502811">true</span><span class="op" id="8502815">}</span><span class="op" id="8502816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502819">{</span><span class="string" id="8502820">&#34;example.com&#34;</span><span class="op" id="8502833">,</span>&nbsp;<span class="string" id="8502835">&#34;www.example.com&#34;</span><span class="op" id="8502852">,</span>&nbsp;<span class="builtintype" id="8502854">false</span><span class="op" id="8502859">}</span><span class="op" id="8502860">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502863">{</span><span class="string" id="8502864">&#34;*.example.com&#34;</span><span class="op" id="8502879">,</span>&nbsp;<span class="string" id="8502881">&#34;www.example.com&#34;</span><span class="op" id="8502898">,</span>&nbsp;<span class="builtintype" id="8502900">true</span><span class="op" id="8502904">}</span><span class="op" id="8502905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502908">{</span><span class="string" id="8502909">&#34;*.example.com&#34;</span><span class="op" id="8502924">,</span>&nbsp;<span class="string" id="8502926">&#34;xyz.www.example.com&#34;</span><span class="op" id="8502947">,</span>&nbsp;<span class="builtintype" id="8502949">false</span><span class="op" id="8502954">}</span><span class="op" id="8502955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8502958">{</span><span class="string" id="8502959">&#34;*.*.example.com&#34;</span><span class="op" id="8502976">,</span>&nbsp;<span class="string" id="8502978">&#34;xyz.www.example.com&#34;</span><span class="op" id="8502999">,</span>&nbsp;<span class="builtintype" id="8503001">true</span><span class="op" id="8503005">}</span><span class="op" id="8503006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8503009">{</span><span class="string" id="8503010">&#34;*.www.*.com&#34;</span><span class="op" id="8503023">,</span>&nbsp;<span class="string" id="8503025">&#34;xyz.www.example.com&#34;</span><span class="op" id="8503046">,</span>&nbsp;<span class="builtintype" id="8503048">true</span><span class="op" id="8503052">}</span><span class="op" id="8503053">,</span><br>
<span class="lineno"></span><span class="op" id="8503055">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8503058">func</span>&nbsp;<span class="ident" id="8503063">TestMatchHostnames</span><span class="op" id="8503081">(</span><span class="ident" id="8503082">t</span>&nbsp;<span class="op" id="8503084">*</span><span class="ident" id="8503085">testing</span><span class="op" id="8503092">.</span><span class="ident" id="8503093">T</span><span class="op" id="8503094">)</span>&nbsp;<span class="op" id="8503096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8503099">for</span>&nbsp;<span class="ident" id="8503103">i</span><span class="op" id="8503104">,</span>&nbsp;<span class="ident" id="8503106">test</span>&nbsp;<span class="op" id="8503111">:=</span>&nbsp;<span class="keyword" id="8503114">range</span>&nbsp;<span class="ident" id="8503120">matchHostnamesTests</span>&nbsp;<span class="op" id="8503140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503144">r</span>&nbsp;<span class="op" id="8503146">:=</span>&nbsp;<span class="ident" id="8503149">matchHostnames</span><span class="op" id="8503163">(</span><span class="ident" id="8503164">test</span><span class="op" id="8503168">.</span><span class="ident" id="8503169">pattern</span><span class="op" id="8503176">,</span>&nbsp;<span class="ident" id="8503178">test</span><span class="op" id="8503182">.</span><span class="ident" id="8503183">host</span><span class="op" id="8503187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8503191">if</span>&nbsp;<span class="ident" id="8503194">r</span>&nbsp;<span class="op" id="8503196">!=</span>&nbsp;<span class="ident" id="8503199">test</span><span class="op" id="8503203">.</span><span class="ident" id="8503204">ok</span>&nbsp;<span class="op" id="8503207">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503212">t</span><span class="op" id="8503213">.</span><span class="ident" id="8503214">Errorf</span><span class="op" id="8503220">(</span><span class="string" id="8503221">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="8503252">,</span>&nbsp;<span class="ident" id="8503254">i</span><span class="op" id="8503255">,</span>&nbsp;<span class="ident" id="8503257">r</span><span class="op" id="8503258">,</span>&nbsp;<span class="ident" id="8503260">test</span><span class="op" id="8503264">.</span><span class="ident" id="8503265">ok</span><span class="op" id="8503267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8503271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8503274">}</span><br>
<span class="lineno"></span><span class="op" id="8503276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="8503279">func</span>&nbsp;<span class="ident" id="8503284">TestMatchIP</span><span class="op" id="8503295">(</span><span class="ident" id="8503296">t</span>&nbsp;<span class="op" id="8503298">*</span><span class="ident" id="8503299">testing</span><span class="op" id="8503306">.</span><span class="ident" id="8503307">T</span><span class="op" id="8503308">)</span>&nbsp;<span class="op" id="8503310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8503313">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503357">c</span>&nbsp;<span class="op" id="8503359">:=</span>&nbsp;<span class="op" id="8503362">&amp;</span><span class="ident" id="8503363">Certificate</span><span class="op" id="8503374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503378">DNSNames</span><span class="op" id="8503386">:</span>&nbsp;<span class="op" id="8503388">[</span><span class="op" id="8503389">]</span><span class="builtintype" id="8503390">string</span><span class="op" id="8503396">{</span><span class="string" id="8503397">&#34;*.foo.bar.baz&#34;</span><span class="op" id="8503412">}</span><span class="op" id="8503413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503417">Subject</span><span class="op" id="8503424">:</span>&nbsp;<span class="ident" id="8503426">pkix</span><span class="op" id="8503430">.</span><span class="ident" id="8503431">Name</span><span class="op" id="8503435">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503440">CommonName</span><span class="op" id="8503450">:</span>&nbsp;<span class="string" id="8503452">&#34;*.foo.bar.baz&#34;</span><span class="op" id="8503467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8503471">}</span><span class="op" id="8503472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8503475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503478">err</span>&nbsp;<span class="op" id="8503482">:=</span>&nbsp;<span class="ident" id="8503485">c</span><span class="op" id="8503486">.</span><span class="ident" id="8503487">VerifyHostname</span><span class="op" id="8503501">(</span><span class="string" id="8503502">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="8503520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8503523">if</span>&nbsp;<span class="ident" id="8503526">err</span>&nbsp;<span class="op" id="8503530">!=</span>&nbsp;<span class="ident" id="8503533">nil</span>&nbsp;<span class="op" id="8503537">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503541">t</span><span class="op" id="8503542">.</span><span class="ident" id="8503543">Fatalf</span><span class="op" id="8503549">(</span><span class="string" id="8503550">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="8503588">,</span>&nbsp;<span class="ident" id="8503590">err</span><span class="op" id="8503593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8503596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8503600">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8503673">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503693">c</span>&nbsp;<span class="op" id="8503695">=</span>&nbsp;<span class="op" id="8503697">&amp;</span><span class="ident" id="8503698">Certificate</span><span class="op" id="8503709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503713">DNSNames</span><span class="op" id="8503721">:</span>&nbsp;<span class="op" id="8503723">[</span><span class="op" id="8503724">]</span><span class="builtintype" id="8503725">string</span><span class="op" id="8503731">{</span><span class="string" id="8503732">&#34;*.2.3.4&#34;</span><span class="op" id="8503741">}</span><span class="op" id="8503742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503746">Subject</span><span class="op" id="8503753">:</span>&nbsp;<span class="ident" id="8503755">pkix</span><span class="op" id="8503759">.</span><span class="ident" id="8503760">Name</span><span class="op" id="8503764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503769">CommonName</span><span class="op" id="8503779">:</span>&nbsp;<span class="string" id="8503781">&#34;*.2.3.4&#34;</span><span class="op" id="8503790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8503794">}</span><span class="op" id="8503795">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8503798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503801">err</span>&nbsp;<span class="op" id="8503805">=</span>&nbsp;<span class="ident" id="8503807">c</span><span class="op" id="8503808">.</span><span class="ident" id="8503809">VerifyHostname</span><span class="op" id="8503823">(</span><span class="string" id="8503824">&#34;1.2.3.4&#34;</span><span class="op" id="8503833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8503836">if</span>&nbsp;<span class="ident" id="8503839">err</span>&nbsp;<span class="op" id="8503843">==</span>&nbsp;<span class="ident" id="8503846">nil</span>&nbsp;<span class="op" id="8503850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503854">t</span><span class="op" id="8503855">.</span><span class="ident" id="8503856">Fatalf</span><span class="op" id="8503862">(</span><span class="string" id="8503863">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="8503916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8503919">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503923">c</span>&nbsp;<span class="op" id="8503925">=</span>&nbsp;<span class="op" id="8503927">&amp;</span><span class="ident" id="8503928">Certificate</span><span class="op" id="8503939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8503943">IPAddresses</span><span class="op" id="8503954">:</span>&nbsp;<span class="op" id="8503956">[</span><span class="op" id="8503957">]</span><span class="ident" id="8503958">net</span><span class="op" id="8503961">.</span><span class="ident" id="8503962">IP</span><span class="op" id="8503964">{</span><span class="ident" id="8503965">net</span><span class="op" id="8503968">.</span><span class="ident" id="8503969">ParseIP</span><span class="op" id="8503976">(</span><span class="string" id="8503977">&#34;127.0.0.1&#34;</span><span class="op" id="8503988">)</span><span class="op" id="8503989">,</span>&nbsp;<span class="ident" id="8503991">net</span><span class="op" id="8503994">.</span><span class="ident" id="8503995">ParseIP</span><span class="op" id="8504002">(</span><span class="string" id="8504003">&#34;::1&#34;</span><span class="op" id="8504008">)</span><span class="op" id="8504009">}</span><span class="op" id="8504010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8504013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504016">err</span>&nbsp;<span class="op" id="8504020">=</span>&nbsp;<span class="ident" id="8504022">c</span><span class="op" id="8504023">.</span><span class="ident" id="8504024">VerifyHostname</span><span class="op" id="8504038">(</span><span class="string" id="8504039">&#34;127.0.0.1&#34;</span><span class="op" id="8504050">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504053">if</span>&nbsp;<span class="ident" id="8504056">err</span>&nbsp;<span class="op" id="8504060">!=</span>&nbsp;<span class="ident" id="8504063">nil</span>&nbsp;<span class="op" id="8504067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504071">t</span><span class="op" id="8504072">.</span><span class="ident" id="8504073">Fatalf</span><span class="op" id="8504079">(</span><span class="string" id="8504080">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="8504111">,</span>&nbsp;<span class="ident" id="8504113">err</span><span class="op" id="8504116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8504119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504122">err</span>&nbsp;<span class="op" id="8504126">=</span>&nbsp;<span class="ident" id="8504128">c</span><span class="op" id="8504129">.</span><span class="ident" id="8504130">VerifyHostname</span><span class="op" id="8504144">(</span><span class="string" id="8504145">&#34;::1&#34;</span><span class="op" id="8504150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504153">if</span>&nbsp;<span class="ident" id="8504156">err</span>&nbsp;<span class="op" id="8504160">!=</span>&nbsp;<span class="ident" id="8504163">nil</span>&nbsp;<span class="op" id="8504167">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504171">t</span><span class="op" id="8504172">.</span><span class="ident" id="8504173">Fatalf</span><span class="op" id="8504179">(</span><span class="string" id="8504180">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="8504205">,</span>&nbsp;<span class="ident" id="8504207">err</span><span class="op" id="8504210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8504213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504216">err</span>&nbsp;<span class="op" id="8504220">=</span>&nbsp;<span class="ident" id="8504222">c</span><span class="op" id="8504223">.</span><span class="ident" id="8504224">VerifyHostname</span><span class="op" id="8504238">(</span><span class="string" id="8504239">&#34;[::1]&#34;</span><span class="op" id="8504246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504249">if</span>&nbsp;<span class="ident" id="8504252">err</span>&nbsp;<span class="op" id="8504256">!=</span>&nbsp;<span class="ident" id="8504259">nil</span>&nbsp;<span class="op" id="8504263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504267">t</span><span class="op" id="8504268">.</span><span class="ident" id="8504269">Fatalf</span><span class="op" id="8504275">(</span><span class="string" id="8504276">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="8504303">,</span>&nbsp;<span class="ident" id="8504305">err</span><span class="op" id="8504308">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8504311">}</span><br>
<span class="lineno"></span><span class="op" id="8504313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8504316">func</span>&nbsp;<span class="ident" id="8504321">TestCertificateParse</span><span class="op" id="8504341">(</span><span class="ident" id="8504342">t</span>&nbsp;<span class="op" id="8504344">*</span><span class="ident" id="8504345">testing</span><span class="op" id="8504352">.</span><span class="ident" id="8504353">T</span><span class="op" id="8504354">)</span>&nbsp;<span class="op" id="8504356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504359">s</span><span class="op" id="8504360">,</span>&nbsp;<span class="ident" id="8504362">_</span>&nbsp;<span class="op" id="8504364">:=</span>&nbsp;<span class="ident" id="8504367">hex</span><span class="op" id="8504370">.</span><span class="ident" id="8504371">DecodeString</span><span class="op" id="8504383">(</span><span class="ident" id="8504384">certBytes</span><span class="op" id="8504393">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504396">certs</span><span class="op" id="8504401">,</span>&nbsp;<span class="ident" id="8504403">err</span>&nbsp;<span class="op" id="8504407">:=</span>&nbsp;<span class="ident" id="8504410">ParseCertificates</span><span class="op" id="8504427">(</span><span class="ident" id="8504428">s</span><span class="op" id="8504429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504432">if</span>&nbsp;<span class="ident" id="8504435">err</span>&nbsp;<span class="op" id="8504439">!=</span>&nbsp;<span class="ident" id="8504442">nil</span>&nbsp;<span class="op" id="8504446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504450">t</span><span class="op" id="8504451">.</span><span class="ident" id="8504452">Error</span><span class="op" id="8504457">(</span><span class="ident" id="8504458">err</span><span class="op" id="8504461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8504464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504467">if</span>&nbsp;<span class="builtinfunc" id="8504470">len</span><span class="op" id="8504473">(</span><span class="ident" id="8504474">certs</span><span class="op" id="8504479">)</span>&nbsp;<span class="op" id="8504481">!=</span>&nbsp;<span class="num" id="8504484">2</span>&nbsp;<span class="op" id="8504486">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504490">t</span><span class="op" id="8504491">.</span><span class="ident" id="8504492">Errorf</span><span class="op" id="8504498">(</span><span class="string" id="8504499">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="8504537">,</span>&nbsp;<span class="builtinfunc" id="8504539">len</span><span class="op" id="8504542">(</span><span class="ident" id="8504543">certs</span><span class="op" id="8504548">)</span><span class="op" id="8504549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504553">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8504561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504565">err</span>&nbsp;<span class="op" id="8504569">=</span>&nbsp;<span class="ident" id="8504571">certs</span><span class="op" id="8504576">[</span><span class="num" id="8504577">0</span><span class="op" id="8504578">]</span><span class="op" id="8504579">.</span><span class="ident" id="8504580">CheckSignatureFrom</span><span class="op" id="8504598">(</span><span class="ident" id="8504599">certs</span><span class="op" id="8504604">[</span><span class="num" id="8504605">1</span><span class="op" id="8504606">]</span><span class="op" id="8504607">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504610">if</span>&nbsp;<span class="ident" id="8504613">err</span>&nbsp;<span class="op" id="8504617">!=</span>&nbsp;<span class="ident" id="8504620">nil</span>&nbsp;<span class="op" id="8504624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504628">t</span><span class="op" id="8504629">.</span><span class="ident" id="8504630">Error</span><span class="op" id="8504635">(</span><span class="ident" id="8504636">err</span><span class="op" id="8504639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8504642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504646">if</span>&nbsp;<span class="ident" id="8504649">err</span>&nbsp;<span class="op" id="8504653">:=</span>&nbsp;<span class="ident" id="8504656">certs</span><span class="op" id="8504661">[</span><span class="num" id="8504662">0</span><span class="op" id="8504663">]</span><span class="op" id="8504664">.</span><span class="ident" id="8504665">VerifyHostname</span><span class="op" id="8504679">(</span><span class="string" id="8504680">&#34;mail.google.com&#34;</span><span class="op" id="8504697">)</span><span class="op" id="8504698">;</span>&nbsp;<span class="ident" id="8504700">err</span>&nbsp;<span class="op" id="8504704">!=</span>&nbsp;<span class="ident" id="8504707">nil</span>&nbsp;<span class="op" id="8504711">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504715">t</span><span class="op" id="8504716">.</span><span class="ident" id="8504717">Error</span><span class="op" id="8504722">(</span><span class="ident" id="8504723">err</span><span class="op" id="8504726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8504729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504733">const</span>&nbsp;<span class="ident" id="8504739">expectedExtensions</span>&nbsp;<span class="op" id="8504758">=</span>&nbsp;<span class="num" id="8504760">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8504763">if</span>&nbsp;<span class="ident" id="8504766">n</span>&nbsp;<span class="op" id="8504768">:=</span>&nbsp;<span class="builtinfunc" id="8504771">len</span><span class="op" id="8504774">(</span><span class="ident" id="8504775">certs</span><span class="op" id="8504780">[</span><span class="num" id="8504781">0</span><span class="op" id="8504782">]</span><span class="op" id="8504783">.</span><span class="ident" id="8504784">Extensions</span><span class="op" id="8504794">)</span><span class="op" id="8504795">;</span>&nbsp;<span class="ident" id="8504797">n</span>&nbsp;<span class="op" id="8504799">!=</span>&nbsp;<span class="ident" id="8504802">expectedExtensions</span>&nbsp;<span class="op" id="8504821">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8504825">t</span><span class="op" id="8504826">.</span><span class="ident" id="8504827">Errorf</span><span class="op" id="8504833">(</span><span class="string" id="8504834">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8504862">,</span>&nbsp;<span class="ident" id="8504864">expectedExtensions</span><span class="op" id="8504882">,</span>&nbsp;<span class="ident" id="8504884">n</span><span class="op" id="8504885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8504888">}</span><br>
<span class="lineno"></span><span class="op" id="8504890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8504893">var</span>&nbsp;<span class="ident" id="8504897">certBytes</span>&nbsp;<span class="op" id="8504907">=</span>&nbsp;<span class="string" id="8504909">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="8504990">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8504993">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="8505074">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505077">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="8505158">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505161">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="8505242">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505245">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="8505326">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505329">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="8505410">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505413">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="8505494">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505497">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="8505578">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505581">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="8505662">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505665">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="8505746">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505749">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="8505830">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505833">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="8505914">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8505917">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="8505998">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506001">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="8506082">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506085">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="8506166">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506169">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="8506250">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506253">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="8506334">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506337">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="8506418">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506421">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="8506502">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506505">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="8506586">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506589">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="8506670">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506673">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="8506754">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506757">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="8506838">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506841">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="8506922">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8506925">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="8507006">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507009">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="8507090">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507093">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="8507174">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507177">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="8507258">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507261">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="8507342">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507345">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="8507426">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507429">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="8507510">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507513">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="8507594">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507597">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="8507678">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507681">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="8507762">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507765">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="8507846">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507849">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="8507930">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8507933">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="8508014">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8508017">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="8508098">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8508101">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="8508182">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8508185">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="8508266">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8508269">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="8508350">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8508353">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8508385">func</span>&nbsp;<span class="ident" id="8508390">TestCreateSelfSignedCertificate</span><span class="op" id="8508421">(</span><span class="ident" id="8508422">t</span>&nbsp;<span class="op" id="8508424">*</span><span class="ident" id="8508425">testing</span><span class="op" id="8508432">.</span><span class="ident" id="8508433">T</span><span class="op" id="8508434">)</span>&nbsp;<span class="op" id="8508436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508439">random</span>&nbsp;<span class="op" id="8508446">:=</span>&nbsp;<span class="ident" id="8508449">rand</span><span class="op" id="8508453">.</span><span class="ident" id="8508454">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508463">block</span><span class="op" id="8508468">,</span>&nbsp;<span class="ident" id="8508470">_</span>&nbsp;<span class="op" id="8508472">:=</span>&nbsp;<span class="ident" id="8508475">pem</span><span class="op" id="8508478">.</span><span class="ident" id="8508479">Decode</span><span class="op" id="8508485">(</span><span class="op" id="8508486">[</span><span class="op" id="8508487">]</span><span class="builtintype" id="8508488">byte</span><span class="op" id="8508492">(</span><span class="ident" id="8508493">pemPrivateKey</span><span class="op" id="8508506">)</span><span class="op" id="8508507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508510">rsaPriv</span><span class="op" id="8508517">,</span>&nbsp;<span class="ident" id="8508519">err</span>&nbsp;<span class="op" id="8508523">:=</span>&nbsp;<span class="ident" id="8508526">ParsePKCS1PrivateKey</span><span class="op" id="8508546">(</span><span class="ident" id="8508547">block</span><span class="op" id="8508552">.</span><span class="ident" id="8508553">Bytes</span><span class="op" id="8508558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8508561">if</span>&nbsp;<span class="ident" id="8508564">err</span>&nbsp;<span class="op" id="8508568">!=</span>&nbsp;<span class="ident" id="8508571">nil</span>&nbsp;<span class="op" id="8508575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508579">t</span><span class="op" id="8508580">.</span><span class="ident" id="8508581">Fatalf</span><span class="op" id="8508587">(</span><span class="string" id="8508588">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8508621">,</span>&nbsp;<span class="ident" id="8508623">err</span><span class="op" id="8508626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8508629">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508633">ecdsaPriv</span><span class="op" id="8508642">,</span>&nbsp;<span class="ident" id="8508644">err</span>&nbsp;<span class="op" id="8508648">:=</span>&nbsp;<span class="ident" id="8508651">ecdsa</span><span class="op" id="8508656">.</span><span class="ident" id="8508657">GenerateKey</span><span class="op" id="8508668">(</span><span class="ident" id="8508669">elliptic</span><span class="op" id="8508677">.</span><span class="ident" id="8508678">P256</span><span class="op" id="8508682">(</span><span class="op" id="8508683">)</span><span class="op" id="8508684">,</span>&nbsp;<span class="ident" id="8508686">rand</span><span class="op" id="8508690">.</span><span class="ident" id="8508691">Reader</span><span class="op" id="8508697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8508700">if</span>&nbsp;<span class="ident" id="8508703">err</span>&nbsp;<span class="op" id="8508707">!=</span>&nbsp;<span class="ident" id="8508710">nil</span>&nbsp;<span class="op" id="8508714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508718">t</span><span class="op" id="8508719">.</span><span class="ident" id="8508720">Fatalf</span><span class="op" id="8508726">(</span><span class="string" id="8508727">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8508761">,</span>&nbsp;<span class="ident" id="8508763">err</span><span class="op" id="8508766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8508769">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508773">tests</span>&nbsp;<span class="op" id="8508779">:=</span>&nbsp;<span class="op" id="8508782">[</span><span class="op" id="8508783">]</span><span class="keyword" id="8508784">struct</span>&nbsp;<span class="op" id="8508791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508795">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8508805">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508814">pub</span><span class="op" id="8508817">,</span>&nbsp;<span class="ident" id="8508819">priv</span>&nbsp;<span class="keyword" id="8508824">interface</span><span class="op" id="8508833">{</span><span class="op" id="8508834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508838">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="8508848">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8508855">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8508865">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8508885">}</span><span class="op" id="8508886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8508890">{</span><span class="string" id="8508891">&#34;RSA/RSA&#34;</span><span class="op" id="8508900">,</span>&nbsp;<span class="op" id="8508902">&amp;</span><span class="ident" id="8508903">rsaPriv</span><span class="op" id="8508910">.</span><span class="ident" id="8508911">PublicKey</span><span class="op" id="8508920">,</span>&nbsp;<span class="ident" id="8508922">rsaPriv</span><span class="op" id="8508929">,</span>&nbsp;<span class="builtintype" id="8508931">true</span><span class="op" id="8508935">,</span>&nbsp;<span class="ident" id="8508937">SHA1WithRSA</span><span class="op" id="8508948">}</span><span class="op" id="8508949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8508953">{</span><span class="string" id="8508954">&#34;RSA/ECDSA&#34;</span><span class="op" id="8508965">,</span>&nbsp;<span class="op" id="8508967">&amp;</span><span class="ident" id="8508968">rsaPriv</span><span class="op" id="8508975">.</span><span class="ident" id="8508976">PublicKey</span><span class="op" id="8508985">,</span>&nbsp;<span class="ident" id="8508987">ecdsaPriv</span><span class="op" id="8508996">,</span>&nbsp;<span class="builtintype" id="8508998">false</span><span class="op" id="8509003">,</span>&nbsp;<span class="ident" id="8509005">ECDSAWithSHA384</span><span class="op" id="8509020">}</span><span class="op" id="8509021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8509025">{</span><span class="string" id="8509026">&#34;ECDSA/RSA&#34;</span><span class="op" id="8509037">,</span>&nbsp;<span class="op" id="8509039">&amp;</span><span class="ident" id="8509040">ecdsaPriv</span><span class="op" id="8509049">.</span><span class="ident" id="8509050">PublicKey</span><span class="op" id="8509059">,</span>&nbsp;<span class="ident" id="8509061">rsaPriv</span><span class="op" id="8509068">,</span>&nbsp;<span class="builtintype" id="8509070">false</span><span class="op" id="8509075">,</span>&nbsp;<span class="ident" id="8509077">SHA256WithRSA</span><span class="op" id="8509090">}</span><span class="op" id="8509091">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8509095">{</span><span class="string" id="8509096">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="8509109">,</span>&nbsp;<span class="op" id="8509111">&amp;</span><span class="ident" id="8509112">ecdsaPriv</span><span class="op" id="8509121">.</span><span class="ident" id="8509122">PublicKey</span><span class="op" id="8509131">,</span>&nbsp;<span class="ident" id="8509133">ecdsaPriv</span><span class="op" id="8509142">,</span>&nbsp;<span class="builtintype" id="8509144">true</span><span class="op" id="8509148">,</span>&nbsp;<span class="ident" id="8509150">ECDSAWithSHA1</span><span class="op" id="8509163">}</span><span class="op" id="8509164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8509167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509171">testExtKeyUsage</span>&nbsp;<span class="op" id="8509187">:=</span>&nbsp;<span class="op" id="8509190">[</span><span class="op" id="8509191">]</span><span class="ident" id="8509192">ExtKeyUsage</span><span class="op" id="8509203">{</span><span class="ident" id="8509204">ExtKeyUsageClientAuth</span><span class="op" id="8509225">,</span>&nbsp;<span class="ident" id="8509227">ExtKeyUsageServerAuth</span><span class="op" id="8509248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509251">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="8509274">:=</span>&nbsp;<span class="op" id="8509277">[</span><span class="op" id="8509278">]</span><span class="ident" id="8509279">asn1</span><span class="op" id="8509283">.</span><span class="ident" id="8509284">ObjectIdentifier</span><span class="op" id="8509300">{</span><span class="op" id="8509301">[</span><span class="op" id="8509302">]</span><span class="builtintype" id="8509303">int</span><span class="op" id="8509306">{</span><span class="num" id="8509307">1</span><span class="op" id="8509308">,</span>&nbsp;<span class="num" id="8509310">2</span><span class="op" id="8509311">,</span>&nbsp;<span class="num" id="8509313">3</span><span class="op" id="8509314">}</span><span class="op" id="8509315">,</span>&nbsp;<span class="op" id="8509317">[</span><span class="op" id="8509318">]</span><span class="builtintype" id="8509319">int</span><span class="op" id="8509322">{</span><span class="num" id="8509323">2</span><span class="op" id="8509324">,</span>&nbsp;<span class="num" id="8509326">59</span><span class="op" id="8509328">,</span>&nbsp;<span class="num" id="8509330">1</span><span class="op" id="8509331">}</span><span class="op" id="8509332">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509335">extraExtensionData</span>&nbsp;<span class="op" id="8509354">:=</span>&nbsp;<span class="op" id="8509357">[</span><span class="op" id="8509358">]</span><span class="builtintype" id="8509359">byte</span><span class="op" id="8509363">(</span><span class="string" id="8509364">&#34;extra&nbsp;extension&#34;</span><span class="op" id="8509381">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8509385">for</span>&nbsp;<span class="ident" id="8509389">_</span><span class="op" id="8509390">,</span>&nbsp;<span class="ident" id="8509392">test</span>&nbsp;<span class="op" id="8509397">:=</span>&nbsp;<span class="keyword" id="8509400">range</span>&nbsp;<span class="ident" id="8509406">tests</span>&nbsp;<span class="op" id="8509412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509416">commonName</span>&nbsp;<span class="op" id="8509427">:=</span>&nbsp;<span class="string" id="8509430">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509451">template</span>&nbsp;<span class="op" id="8509460">:=</span>&nbsp;<span class="ident" id="8509463">Certificate</span><span class="op" id="8509474">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509479">SerialNumber</span><span class="op" id="8509491">:</span>&nbsp;<span class="ident" id="8509493">big</span><span class="op" id="8509496">.</span><span class="ident" id="8509497">NewInt</span><span class="op" id="8509503">(</span><span class="num" id="8509504">1</span><span class="op" id="8509505">)</span><span class="op" id="8509506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509511">Subject</span><span class="op" id="8509518">:</span>&nbsp;<span class="ident" id="8509520">pkix</span><span class="op" id="8509524">.</span><span class="ident" id="8509525">Name</span><span class="op" id="8509529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509535">CommonName</span><span class="op" id="8509545">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8509549">commonName</span><span class="op" id="8509559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509565">Organization</span><span class="op" id="8509577">:</span>&nbsp;<span class="op" id="8509579">[</span><span class="op" id="8509580">]</span><span class="builtintype" id="8509581">string</span><span class="op" id="8509587">{</span><span class="string" id="8509588">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8509600">}</span><span class="op" id="8509601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8509606">}</span><span class="op" id="8509607">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509612">NotBefore</span><span class="op" id="8509621">:</span>&nbsp;<span class="ident" id="8509623">time</span><span class="op" id="8509627">.</span><span class="ident" id="8509628">Unix</span><span class="op" id="8509632">(</span><span class="num" id="8509633">1000</span><span class="op" id="8509637">,</span>&nbsp;<span class="num" id="8509639">0</span><span class="op" id="8509640">)</span><span class="op" id="8509641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509646">NotAfter</span><span class="op" id="8509654">:</span>&nbsp;&nbsp;<span class="ident" id="8509657">time</span><span class="op" id="8509661">.</span><span class="ident" id="8509662">Unix</span><span class="op" id="8509666">(</span><span class="num" id="8509667">100000</span><span class="op" id="8509673">,</span>&nbsp;<span class="num" id="8509675">0</span><span class="op" id="8509676">)</span><span class="op" id="8509677">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509683">SignatureAlgorithm</span><span class="op" id="8509701">:</span>&nbsp;<span class="ident" id="8509703">test</span><span class="op" id="8509707">.</span><span class="ident" id="8509708">sigAlgo</span><span class="op" id="8509715">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509721">SubjectKeyId</span><span class="op" id="8509733">:</span>&nbsp;<span class="op" id="8509735">[</span><span class="op" id="8509736">]</span><span class="builtintype" id="8509737">byte</span><span class="op" id="8509741">{</span><span class="num" id="8509742">1</span><span class="op" id="8509743">,</span>&nbsp;<span class="num" id="8509745">2</span><span class="op" id="8509746">,</span>&nbsp;<span class="num" id="8509748">3</span><span class="op" id="8509749">,</span>&nbsp;<span class="num" id="8509751">4</span><span class="op" id="8509752">}</span><span class="op" id="8509753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509758">KeyUsage</span><span class="op" id="8509766">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8509772">KeyUsageCertSign</span><span class="op" id="8509788">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509794">ExtKeyUsage</span><span class="op" id="8509805">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8509814">testExtKeyUsage</span><span class="op" id="8509829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509834">UnknownExtKeyUsage</span><span class="op" id="8509852">:</span>&nbsp;<span class="ident" id="8509854">testUnknownExtKeyUsage</span><span class="op" id="8509876">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509882">BasicConstraintsValid</span><span class="op" id="8509903">:</span>&nbsp;<span class="builtintype" id="8509905">true</span><span class="op" id="8509909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509914">IsCA</span><span class="op" id="8509918">:</span>&nbsp;<span class="builtintype" id="8509920">true</span><span class="op" id="8509924">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509930">OCSPServer</span><span class="op" id="8509940">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8509953">[</span><span class="op" id="8509954">]</span><span class="builtintype" id="8509955">string</span><span class="op" id="8509961">{</span><span class="string" id="8509962">&#34;http://ocsp.example.com&#34;</span><span class="op" id="8509987">}</span><span class="op" id="8509988">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8509993">IssuingCertificateURL</span><span class="op" id="8510014">:</span>&nbsp;<span class="op" id="8510016">[</span><span class="op" id="8510017">]</span><span class="builtintype" id="8510018">string</span><span class="op" id="8510024">{</span><span class="string" id="8510025">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="8510057">}</span><span class="op" id="8510058">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510064">DNSNames</span><span class="op" id="8510072">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510080">[</span><span class="op" id="8510081">]</span><span class="builtintype" id="8510082">string</span><span class="op" id="8510088">{</span><span class="string" id="8510089">&#34;test.example.com&#34;</span><span class="op" id="8510107">}</span><span class="op" id="8510108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510113">EmailAddresses</span><span class="op" id="8510127">:</span>&nbsp;<span class="op" id="8510129">[</span><span class="op" id="8510130">]</span><span class="builtintype" id="8510131">string</span><span class="op" id="8510137">{</span><span class="string" id="8510138">&#34;gopher@golang.org&#34;</span><span class="op" id="8510157">}</span><span class="op" id="8510158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510163">IPAddresses</span><span class="op" id="8510174">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510179">[</span><span class="op" id="8510180">]</span><span class="ident" id="8510181">net</span><span class="op" id="8510184">.</span><span class="ident" id="8510185">IP</span><span class="op" id="8510187">{</span><span class="ident" id="8510188">net</span><span class="op" id="8510191">.</span><span class="ident" id="8510192">IPv4</span><span class="op" id="8510196">(</span><span class="num" id="8510197">127</span><span class="op" id="8510200">,</span>&nbsp;<span class="num" id="8510202">0</span><span class="op" id="8510203">,</span>&nbsp;<span class="num" id="8510205">0</span><span class="op" id="8510206">,</span>&nbsp;<span class="num" id="8510208">1</span><span class="op" id="8510209">)</span><span class="op" id="8510210">.</span><span class="ident" id="8510211">To4</span><span class="op" id="8510214">(</span><span class="op" id="8510215">)</span><span class="op" id="8510216">,</span>&nbsp;<span class="ident" id="8510218">net</span><span class="op" id="8510221">.</span><span class="ident" id="8510222">ParseIP</span><span class="op" id="8510229">(</span><span class="string" id="8510230">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="8510252">)</span><span class="op" id="8510253">}</span><span class="op" id="8510254">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510260">PolicyIdentifiers</span><span class="op" id="8510277">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8510281">[</span><span class="op" id="8510282">]</span><span class="ident" id="8510283">asn1</span><span class="op" id="8510287">.</span><span class="ident" id="8510288">ObjectIdentifier</span><span class="op" id="8510304">{</span><span class="op" id="8510305">[</span><span class="op" id="8510306">]</span><span class="builtintype" id="8510307">int</span><span class="op" id="8510310">{</span><span class="num" id="8510311">1</span><span class="op" id="8510312">,</span>&nbsp;<span class="num" id="8510314">2</span><span class="op" id="8510315">,</span>&nbsp;<span class="num" id="8510317">3</span><span class="op" id="8510318">}</span><span class="op" id="8510319">}</span><span class="op" id="8510320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510325">PermittedDNSDomains</span><span class="op" id="8510344">:</span>&nbsp;<span class="op" id="8510346">[</span><span class="op" id="8510347">]</span><span class="builtintype" id="8510348">string</span><span class="op" id="8510354">{</span><span class="string" id="8510355">&#34;.example.com&#34;</span><span class="op" id="8510369">,</span>&nbsp;<span class="string" id="8510371">&#34;example.com&#34;</span><span class="op" id="8510384">}</span><span class="op" id="8510385">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510391">CRLDistributionPoints</span><span class="op" id="8510412">:</span>&nbsp;<span class="op" id="8510414">[</span><span class="op" id="8510415">]</span><span class="builtintype" id="8510416">string</span><span class="op" id="8510422">{</span><span class="string" id="8510423">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="8510456">,</span>&nbsp;<span class="string" id="8510458">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="8510491">}</span><span class="op" id="8510492">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510498">ExtraExtensions</span><span class="op" id="8510513">:</span>&nbsp;<span class="op" id="8510515">[</span><span class="op" id="8510516">]</span><span class="ident" id="8510517">pkix</span><span class="op" id="8510521">.</span><span class="ident" id="8510522">Extension</span><span class="op" id="8510531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510544">Id</span><span class="op" id="8510546">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510551">[</span><span class="op" id="8510552">]</span><span class="builtintype" id="8510553">int</span><span class="op" id="8510556">{</span><span class="num" id="8510557">1</span><span class="op" id="8510558">,</span>&nbsp;<span class="num" id="8510560">2</span><span class="op" id="8510561">,</span>&nbsp;<span class="num" id="8510563">3</span><span class="op" id="8510564">,</span>&nbsp;<span class="num" id="8510566">4</span><span class="op" id="8510567">}</span><span class="op" id="8510568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510575">Value</span><span class="op" id="8510580">:</span>&nbsp;<span class="ident" id="8510582">extraExtensionData</span><span class="op" id="8510600">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510606">}</span><span class="op" id="8510607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8510613">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510683">Id</span><span class="op" id="8510685">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510693">oidExtensionSubjectKeyId</span><span class="op" id="8510717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510724">Critical</span><span class="op" id="8510732">:</span>&nbsp;<span class="builtintype" id="8510734">false</span><span class="op" id="8510739">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510746">Value</span><span class="op" id="8510751">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510756">[</span><span class="op" id="8510757">]</span><span class="builtintype" id="8510758">byte</span><span class="op" id="8510762">{</span><span class="num" id="8510763">0x04</span><span class="op" id="8510767">,</span>&nbsp;<span class="num" id="8510769">0x04</span><span class="op" id="8510773">,</span>&nbsp;<span class="num" id="8510775">4</span><span class="op" id="8510776">,</span>&nbsp;<span class="num" id="8510778">3</span><span class="op" id="8510779">,</span>&nbsp;<span class="num" id="8510781">2</span><span class="op" id="8510782">,</span>&nbsp;<span class="num" id="8510784">1</span><span class="op" id="8510785">}</span><span class="op" id="8510786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510792">}</span><span class="op" id="8510793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510798">}</span><span class="op" id="8510799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510808">derBytes</span><span class="op" id="8510816">,</span>&nbsp;<span class="ident" id="8510818">err</span>&nbsp;<span class="op" id="8510822">:=</span>&nbsp;<span class="ident" id="8510825">CreateCertificate</span><span class="op" id="8510842">(</span><span class="ident" id="8510843">random</span><span class="op" id="8510849">,</span>&nbsp;<span class="op" id="8510851">&amp;</span><span class="ident" id="8510852">template</span><span class="op" id="8510860">,</span>&nbsp;<span class="op" id="8510862">&amp;</span><span class="ident" id="8510863">template</span><span class="op" id="8510871">,</span>&nbsp;<span class="ident" id="8510873">test</span><span class="op" id="8510877">.</span><span class="ident" id="8510878">pub</span><span class="op" id="8510881">,</span>&nbsp;<span class="ident" id="8510883">test</span><span class="op" id="8510887">.</span><span class="ident" id="8510888">priv</span><span class="op" id="8510892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8510896">if</span>&nbsp;<span class="ident" id="8510899">err</span>&nbsp;<span class="op" id="8510903">!=</span>&nbsp;<span class="ident" id="8510906">nil</span>&nbsp;<span class="op" id="8510910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510915">t</span><span class="op" id="8510916">.</span><span class="ident" id="8510917">Errorf</span><span class="op" id="8510923">(</span><span class="string" id="8510924">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8510962">,</span>&nbsp;<span class="ident" id="8510964">test</span><span class="op" id="8510968">.</span><span class="ident" id="8510969">name</span><span class="op" id="8510973">,</span>&nbsp;<span class="ident" id="8510975">err</span><span class="op" id="8510978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8510983">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510994">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510999">cert</span><span class="op" id="8511003">,</span>&nbsp;<span class="ident" id="8511005">err</span>&nbsp;<span class="op" id="8511009">:=</span>&nbsp;<span class="ident" id="8511012">ParseCertificate</span><span class="op" id="8511028">(</span><span class="ident" id="8511029">derBytes</span><span class="op" id="8511037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511041">if</span>&nbsp;<span class="ident" id="8511044">err</span>&nbsp;<span class="op" id="8511048">!=</span>&nbsp;<span class="ident" id="8511051">nil</span>&nbsp;<span class="op" id="8511055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511060">t</span><span class="op" id="8511061">.</span><span class="ident" id="8511062">Errorf</span><span class="op" id="8511068">(</span><span class="string" id="8511069">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8511106">,</span>&nbsp;<span class="ident" id="8511108">test</span><span class="op" id="8511112">.</span><span class="ident" id="8511113">name</span><span class="op" id="8511117">,</span>&nbsp;<span class="ident" id="8511119">err</span><span class="op" id="8511122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511127">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8511138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511143">if</span>&nbsp;<span class="builtinfunc" id="8511146">len</span><span class="op" id="8511149">(</span><span class="ident" id="8511150">cert</span><span class="op" id="8511154">.</span><span class="ident" id="8511155">PolicyIdentifiers</span><span class="op" id="8511172">)</span>&nbsp;<span class="op" id="8511174">!=</span>&nbsp;<span class="num" id="8511177">1</span>&nbsp;<span class="op" id="8511179">||</span>&nbsp;<span class="op" id="8511182">!</span><span class="ident" id="8511183">cert</span><span class="op" id="8511187">.</span><span class="ident" id="8511188">PolicyIdentifiers</span><span class="op" id="8511205">[</span><span class="num" id="8511206">0</span><span class="op" id="8511207">]</span><span class="op" id="8511208">.</span><span class="ident" id="8511209">Equal</span><span class="op" id="8511214">(</span><span class="ident" id="8511215">template</span><span class="op" id="8511223">.</span><span class="ident" id="8511224">PolicyIdentifiers</span><span class="op" id="8511241">[</span><span class="num" id="8511242">0</span><span class="op" id="8511243">]</span><span class="op" id="8511244">)</span>&nbsp;<span class="op" id="8511246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511251">t</span><span class="op" id="8511252">.</span><span class="ident" id="8511253">Errorf</span><span class="op" id="8511259">(</span><span class="string" id="8511260">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8511318">,</span>&nbsp;<span class="ident" id="8511320">test</span><span class="op" id="8511324">.</span><span class="ident" id="8511325">name</span><span class="op" id="8511329">,</span>&nbsp;<span class="ident" id="8511331">cert</span><span class="op" id="8511335">.</span><span class="ident" id="8511336">PolicyIdentifiers</span><span class="op" id="8511353">,</span>&nbsp;<span class="ident" id="8511355">template</span><span class="op" id="8511363">.</span><span class="ident" id="8511364">PolicyIdentifiers</span><span class="op" id="8511381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8511385">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511390">if</span>&nbsp;<span class="builtinfunc" id="8511393">len</span><span class="op" id="8511396">(</span><span class="ident" id="8511397">cert</span><span class="op" id="8511401">.</span><span class="ident" id="8511402">PermittedDNSDomains</span><span class="op" id="8511421">)</span>&nbsp;<span class="op" id="8511423">!=</span>&nbsp;<span class="num" id="8511426">2</span>&nbsp;<span class="op" id="8511428">||</span>&nbsp;<span class="ident" id="8511431">cert</span><span class="op" id="8511435">.</span><span class="ident" id="8511436">PermittedDNSDomains</span><span class="op" id="8511455">[</span><span class="num" id="8511456">0</span><span class="op" id="8511457">]</span>&nbsp;<span class="op" id="8511459">!=</span>&nbsp;<span class="string" id="8511462">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="8511477">||</span>&nbsp;<span class="ident" id="8511480">cert</span><span class="op" id="8511484">.</span><span class="ident" id="8511485">PermittedDNSDomains</span><span class="op" id="8511504">[</span><span class="num" id="8511505">1</span><span class="op" id="8511506">]</span>&nbsp;<span class="op" id="8511508">!=</span>&nbsp;<span class="string" id="8511511">&#34;example.com&#34;</span>&nbsp;<span class="op" id="8511525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511530">t</span><span class="op" id="8511531">.</span><span class="ident" id="8511532">Errorf</span><span class="op" id="8511538">(</span><span class="string" id="8511539">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="8511582">,</span>&nbsp;<span class="ident" id="8511584">test</span><span class="op" id="8511588">.</span><span class="ident" id="8511589">name</span><span class="op" id="8511593">,</span>&nbsp;<span class="ident" id="8511595">cert</span><span class="op" id="8511599">.</span><span class="ident" id="8511600">PermittedDNSDomains</span><span class="op" id="8511619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8511623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511628">if</span>&nbsp;<span class="ident" id="8511631">cert</span><span class="op" id="8511635">.</span><span class="ident" id="8511636">Subject</span><span class="op" id="8511643">.</span><span class="ident" id="8511644">CommonName</span>&nbsp;<span class="op" id="8511655">!=</span>&nbsp;<span class="ident" id="8511658">commonName</span>&nbsp;<span class="op" id="8511669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511674">t</span><span class="op" id="8511675">.</span><span class="ident" id="8511676">Errorf</span><span class="op" id="8511682">(</span><span class="string" id="8511683">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8511755">,</span>&nbsp;<span class="ident" id="8511757">test</span><span class="op" id="8511761">.</span><span class="ident" id="8511762">name</span><span class="op" id="8511766">,</span>&nbsp;<span class="ident" id="8511768">cert</span><span class="op" id="8511772">.</span><span class="ident" id="8511773">Subject</span><span class="op" id="8511780">.</span><span class="ident" id="8511781">CommonName</span><span class="op" id="8511791">,</span>&nbsp;<span class="ident" id="8511793">commonName</span><span class="op" id="8511803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8511807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511812">if</span>&nbsp;<span class="ident" id="8511815">cert</span><span class="op" id="8511819">.</span><span class="ident" id="8511820">Issuer</span><span class="op" id="8511826">.</span><span class="ident" id="8511827">CommonName</span>&nbsp;<span class="op" id="8511838">!=</span>&nbsp;<span class="ident" id="8511841">commonName</span>&nbsp;<span class="op" id="8511852">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511857">t</span><span class="op" id="8511858">.</span><span class="ident" id="8511859">Errorf</span><span class="op" id="8511865">(</span><span class="string" id="8511866">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8511937">,</span>&nbsp;<span class="ident" id="8511939">test</span><span class="op" id="8511943">.</span><span class="ident" id="8511944">name</span><span class="op" id="8511948">,</span>&nbsp;<span class="ident" id="8511950">cert</span><span class="op" id="8511954">.</span><span class="ident" id="8511955">Issuer</span><span class="op" id="8511961">.</span><span class="ident" id="8511962">CommonName</span><span class="op" id="8511972">,</span>&nbsp;<span class="ident" id="8511974">commonName</span><span class="op" id="8511984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8511988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511993">if</span>&nbsp;<span class="ident" id="8511996">cert</span><span class="op" id="8512000">.</span><span class="ident" id="8512001">SignatureAlgorithm</span>&nbsp;<span class="op" id="8512020">!=</span>&nbsp;<span class="ident" id="8512023">test</span><span class="op" id="8512027">.</span><span class="ident" id="8512028">sigAlgo</span>&nbsp;<span class="op" id="8512036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512041">t</span><span class="op" id="8512042">.</span><span class="ident" id="8512043">Errorf</span><span class="op" id="8512049">(</span><span class="string" id="8512050">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8512119">,</span>&nbsp;<span class="ident" id="8512121">test</span><span class="op" id="8512125">.</span><span class="ident" id="8512126">name</span><span class="op" id="8512130">,</span>&nbsp;<span class="ident" id="8512132">cert</span><span class="op" id="8512136">.</span><span class="ident" id="8512137">SignatureAlgorithm</span><span class="op" id="8512155">,</span>&nbsp;<span class="ident" id="8512157">test</span><span class="op" id="8512161">.</span><span class="ident" id="8512162">sigAlgo</span><span class="op" id="8512169">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512178">if</span>&nbsp;<span class="op" id="8512181">!</span><span class="ident" id="8512182">reflect</span><span class="op" id="8512189">.</span><span class="ident" id="8512190">DeepEqual</span><span class="op" id="8512199">(</span><span class="ident" id="8512200">cert</span><span class="op" id="8512204">.</span><span class="ident" id="8512205">ExtKeyUsage</span><span class="op" id="8512216">,</span>&nbsp;<span class="ident" id="8512218">testExtKeyUsage</span><span class="op" id="8512233">)</span>&nbsp;<span class="op" id="8512235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512240">t</span><span class="op" id="8512241">.</span><span class="ident" id="8512242">Errorf</span><span class="op" id="8512248">(</span><span class="string" id="8512249">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8512325">,</span>&nbsp;<span class="ident" id="8512327">test</span><span class="op" id="8512331">.</span><span class="ident" id="8512332">name</span><span class="op" id="8512336">,</span>&nbsp;<span class="ident" id="8512338">cert</span><span class="op" id="8512342">.</span><span class="ident" id="8512343">ExtKeyUsage</span><span class="op" id="8512354">,</span>&nbsp;<span class="ident" id="8512356">testExtKeyUsage</span><span class="op" id="8512371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512375">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512380">if</span>&nbsp;<span class="op" id="8512383">!</span><span class="ident" id="8512384">reflect</span><span class="op" id="8512391">.</span><span class="ident" id="8512392">DeepEqual</span><span class="op" id="8512401">(</span><span class="ident" id="8512402">cert</span><span class="op" id="8512406">.</span><span class="ident" id="8512407">UnknownExtKeyUsage</span><span class="op" id="8512425">,</span>&nbsp;<span class="ident" id="8512427">testUnknownExtKeyUsage</span><span class="op" id="8512449">)</span>&nbsp;<span class="op" id="8512451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512456">t</span><span class="op" id="8512457">.</span><span class="ident" id="8512458">Errorf</span><span class="op" id="8512464">(</span><span class="string" id="8512465">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8512549">,</span>&nbsp;<span class="ident" id="8512551">test</span><span class="op" id="8512555">.</span><span class="ident" id="8512556">name</span><span class="op" id="8512560">,</span>&nbsp;<span class="ident" id="8512562">cert</span><span class="op" id="8512566">.</span><span class="ident" id="8512567">UnknownExtKeyUsage</span><span class="op" id="8512585">,</span>&nbsp;<span class="ident" id="8512587">testUnknownExtKeyUsage</span><span class="op" id="8512609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512618">if</span>&nbsp;<span class="op" id="8512621">!</span><span class="ident" id="8512622">reflect</span><span class="op" id="8512629">.</span><span class="ident" id="8512630">DeepEqual</span><span class="op" id="8512639">(</span><span class="ident" id="8512640">cert</span><span class="op" id="8512644">.</span><span class="ident" id="8512645">OCSPServer</span><span class="op" id="8512655">,</span>&nbsp;<span class="ident" id="8512657">template</span><span class="op" id="8512665">.</span><span class="ident" id="8512666">OCSPServer</span><span class="op" id="8512676">)</span>&nbsp;<span class="op" id="8512678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512683">t</span><span class="op" id="8512684">.</span><span class="ident" id="8512685">Errorf</span><span class="op" id="8512691">(</span><span class="string" id="8512692">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8512748">,</span>&nbsp;<span class="ident" id="8512750">test</span><span class="op" id="8512754">.</span><span class="ident" id="8512755">name</span><span class="op" id="8512759">,</span>&nbsp;<span class="ident" id="8512761">cert</span><span class="op" id="8512765">.</span><span class="ident" id="8512766">OCSPServer</span><span class="op" id="8512776">,</span>&nbsp;<span class="ident" id="8512778">template</span><span class="op" id="8512786">.</span><span class="ident" id="8512787">OCSPServer</span><span class="op" id="8512797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512806">if</span>&nbsp;<span class="op" id="8512809">!</span><span class="ident" id="8512810">reflect</span><span class="op" id="8512817">.</span><span class="ident" id="8512818">DeepEqual</span><span class="op" id="8512827">(</span><span class="ident" id="8512828">cert</span><span class="op" id="8512832">.</span><span class="ident" id="8512833">IssuingCertificateURL</span><span class="op" id="8512854">,</span>&nbsp;<span class="ident" id="8512856">template</span><span class="op" id="8512864">.</span><span class="ident" id="8512865">IssuingCertificateURL</span><span class="op" id="8512886">)</span>&nbsp;<span class="op" id="8512888">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512893">t</span><span class="op" id="8512894">.</span><span class="ident" id="8512895">Errorf</span><span class="op" id="8512901">(</span><span class="string" id="8512902">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8512970">,</span>&nbsp;<span class="ident" id="8512972">test</span><span class="op" id="8512976">.</span><span class="ident" id="8512977">name</span><span class="op" id="8512981">,</span>&nbsp;<span class="ident" id="8512983">cert</span><span class="op" id="8512987">.</span><span class="ident" id="8512988">IssuingCertificateURL</span><span class="op" id="8513009">,</span>&nbsp;<span class="ident" id="8513011">template</span><span class="op" id="8513019">.</span><span class="ident" id="8513020">IssuingCertificateURL</span><span class="op" id="8513041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513050">if</span>&nbsp;<span class="op" id="8513053">!</span><span class="ident" id="8513054">reflect</span><span class="op" id="8513061">.</span><span class="ident" id="8513062">DeepEqual</span><span class="op" id="8513071">(</span><span class="ident" id="8513072">cert</span><span class="op" id="8513076">.</span><span class="ident" id="8513077">DNSNames</span><span class="op" id="8513085">,</span>&nbsp;<span class="ident" id="8513087">template</span><span class="op" id="8513095">.</span><span class="ident" id="8513096">DNSNames</span><span class="op" id="8513104">)</span>&nbsp;<span class="op" id="8513106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513111">t</span><span class="op" id="8513112">.</span><span class="ident" id="8513113">Errorf</span><span class="op" id="8513119">(</span><span class="string" id="8513120">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8513177">,</span>&nbsp;<span class="ident" id="8513179">test</span><span class="op" id="8513183">.</span><span class="ident" id="8513184">name</span><span class="op" id="8513188">,</span>&nbsp;<span class="ident" id="8513190">cert</span><span class="op" id="8513194">.</span><span class="ident" id="8513195">DNSNames</span><span class="op" id="8513203">,</span>&nbsp;<span class="ident" id="8513205">template</span><span class="op" id="8513213">.</span><span class="ident" id="8513214">DNSNames</span><span class="op" id="8513222">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513231">if</span>&nbsp;<span class="op" id="8513234">!</span><span class="ident" id="8513235">reflect</span><span class="op" id="8513242">.</span><span class="ident" id="8513243">DeepEqual</span><span class="op" id="8513252">(</span><span class="ident" id="8513253">cert</span><span class="op" id="8513257">.</span><span class="ident" id="8513258">EmailAddresses</span><span class="op" id="8513272">,</span>&nbsp;<span class="ident" id="8513274">template</span><span class="op" id="8513282">.</span><span class="ident" id="8513283">EmailAddresses</span><span class="op" id="8513297">)</span>&nbsp;<span class="op" id="8513299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513304">t</span><span class="op" id="8513305">.</span><span class="ident" id="8513306">Errorf</span><span class="op" id="8513312">(</span><span class="string" id="8513313">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8513367">,</span>&nbsp;<span class="ident" id="8513369">test</span><span class="op" id="8513373">.</span><span class="ident" id="8513374">name</span><span class="op" id="8513378">,</span>&nbsp;<span class="ident" id="8513380">cert</span><span class="op" id="8513384">.</span><span class="ident" id="8513385">EmailAddresses</span><span class="op" id="8513399">,</span>&nbsp;<span class="ident" id="8513401">template</span><span class="op" id="8513409">.</span><span class="ident" id="8513410">EmailAddresses</span><span class="op" id="8513424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513428">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513433">if</span>&nbsp;<span class="op" id="8513436">!</span><span class="ident" id="8513437">reflect</span><span class="op" id="8513444">.</span><span class="ident" id="8513445">DeepEqual</span><span class="op" id="8513454">(</span><span class="ident" id="8513455">cert</span><span class="op" id="8513459">.</span><span class="ident" id="8513460">IPAddresses</span><span class="op" id="8513471">,</span>&nbsp;<span class="ident" id="8513473">template</span><span class="op" id="8513481">.</span><span class="ident" id="8513482">IPAddresses</span><span class="op" id="8513493">)</span>&nbsp;<span class="op" id="8513495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513500">t</span><span class="op" id="8513501">.</span><span class="ident" id="8513502">Errorf</span><span class="op" id="8513508">(</span><span class="string" id="8513509">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8513560">,</span>&nbsp;<span class="ident" id="8513562">test</span><span class="op" id="8513566">.</span><span class="ident" id="8513567">name</span><span class="op" id="8513571">,</span>&nbsp;<span class="ident" id="8513573">cert</span><span class="op" id="8513577">.</span><span class="ident" id="8513578">IPAddresses</span><span class="op" id="8513589">,</span>&nbsp;<span class="ident" id="8513591">template</span><span class="op" id="8513599">.</span><span class="ident" id="8513600">IPAddresses</span><span class="op" id="8513611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513620">if</span>&nbsp;<span class="op" id="8513623">!</span><span class="ident" id="8513624">reflect</span><span class="op" id="8513631">.</span><span class="ident" id="8513632">DeepEqual</span><span class="op" id="8513641">(</span><span class="ident" id="8513642">cert</span><span class="op" id="8513646">.</span><span class="ident" id="8513647">CRLDistributionPoints</span><span class="op" id="8513668">,</span>&nbsp;<span class="ident" id="8513670">template</span><span class="op" id="8513678">.</span><span class="ident" id="8513679">CRLDistributionPoints</span><span class="op" id="8513700">)</span>&nbsp;<span class="op" id="8513702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513707">t</span><span class="op" id="8513708">.</span><span class="ident" id="8513709">Errorf</span><span class="op" id="8513715">(</span><span class="string" id="8513716">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8513783">,</span>&nbsp;<span class="ident" id="8513785">test</span><span class="op" id="8513789">.</span><span class="ident" id="8513790">name</span><span class="op" id="8513794">,</span>&nbsp;<span class="ident" id="8513796">cert</span><span class="op" id="8513800">.</span><span class="ident" id="8513801">CRLDistributionPoints</span><span class="op" id="8513822">,</span>&nbsp;<span class="ident" id="8513824">template</span><span class="op" id="8513832">.</span><span class="ident" id="8513833">CRLDistributionPoints</span><span class="op" id="8513854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513863">if</span>&nbsp;<span class="op" id="8513866">!</span><span class="ident" id="8513867">bytes</span><span class="op" id="8513872">.</span><span class="ident" id="8513873">Equal</span><span class="op" id="8513878">(</span><span class="ident" id="8513879">cert</span><span class="op" id="8513883">.</span><span class="ident" id="8513884">SubjectKeyId</span><span class="op" id="8513896">,</span>&nbsp;<span class="op" id="8513898">[</span><span class="op" id="8513899">]</span><span class="builtintype" id="8513900">byte</span><span class="op" id="8513904">{</span><span class="num" id="8513905">4</span><span class="op" id="8513906">,</span>&nbsp;<span class="num" id="8513908">3</span><span class="op" id="8513909">,</span>&nbsp;<span class="num" id="8513911">2</span><span class="op" id="8513912">,</span>&nbsp;<span class="num" id="8513914">1</span><span class="op" id="8513915">}</span><span class="op" id="8513916">)</span>&nbsp;<span class="op" id="8513918">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513923">t</span><span class="op" id="8513924">.</span><span class="ident" id="8513925">Errorf</span><span class="op" id="8513931">(</span><span class="string" id="8513932">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="8513982">,</span>&nbsp;<span class="ident" id="8513984">test</span><span class="op" id="8513988">.</span><span class="ident" id="8513989">name</span><span class="op" id="8513993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514002">if</span>&nbsp;<span class="ident" id="8514005">bytes</span><span class="op" id="8514010">.</span><span class="ident" id="8514011">Index</span><span class="op" id="8514016">(</span><span class="ident" id="8514017">derBytes</span><span class="op" id="8514025">,</span>&nbsp;<span class="ident" id="8514027">extraExtensionData</span><span class="op" id="8514045">)</span>&nbsp;<span class="op" id="8514047">==</span>&nbsp;<span class="op" id="8514050">-</span><span class="num" id="8514051">1</span>&nbsp;<span class="op" id="8514053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514058">t</span><span class="op" id="8514059">.</span><span class="ident" id="8514060">Errorf</span><span class="op" id="8514066">(</span><span class="string" id="8514067">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="8514114">,</span>&nbsp;<span class="ident" id="8514116">test</span><span class="op" id="8514120">.</span><span class="ident" id="8514121">name</span><span class="op" id="8514125">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514134">if</span>&nbsp;<span class="ident" id="8514137">test</span><span class="op" id="8514141">.</span><span class="ident" id="8514142">checkSig</span>&nbsp;<span class="op" id="8514151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514156">err</span>&nbsp;<span class="op" id="8514160">=</span>&nbsp;<span class="ident" id="8514162">cert</span><span class="op" id="8514166">.</span><span class="ident" id="8514167">CheckSignatureFrom</span><span class="op" id="8514185">(</span><span class="ident" id="8514186">cert</span><span class="op" id="8514190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514195">if</span>&nbsp;<span class="ident" id="8514198">err</span>&nbsp;<span class="op" id="8514202">!=</span>&nbsp;<span class="ident" id="8514205">nil</span>&nbsp;<span class="op" id="8514209">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514215">t</span><span class="op" id="8514216">.</span><span class="ident" id="8514217">Errorf</span><span class="op" id="8514223">(</span><span class="string" id="8514224">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8514263">,</span>&nbsp;<span class="ident" id="8514265">test</span><span class="op" id="8514269">.</span><span class="ident" id="8514270">name</span><span class="op" id="8514274">,</span>&nbsp;<span class="ident" id="8514276">err</span><span class="op" id="8514279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514291">}</span><br>
<span class="lineno"></span><span class="op" id="8514293">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="8514296">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="8514357">var</span>&nbsp;<span class="ident" id="8514361">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="8514378">=</span>&nbsp;<span class="string" id="8514380">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8515159">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="8515222">var</span>&nbsp;<span class="ident" id="8515226">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="8515249">=</span>&nbsp;<span class="string" id="8515251">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8516030">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="8516093">var</span>&nbsp;<span class="ident" id="8516097">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="8516120">=</span>&nbsp;<span class="string" id="8516122">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="8516982">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="8517045">var</span>&nbsp;<span class="ident" id="8517049">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="8517072">=</span>&nbsp;<span class="string" id="8517074">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="8518035">var</span>&nbsp;<span class="ident" id="8518039">ecdsaTests</span>&nbsp;<span class="op" id="8518050">=</span>&nbsp;<span class="op" id="8518052">[</span><span class="op" id="8518053">]</span><span class="keyword" id="8518054">struct</span>&nbsp;<span class="op" id="8518061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518064">sigAlgo</span>&nbsp;<span class="ident" id="8518072">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518092">pemCert</span>&nbsp;<span class="builtintype" id="8518100">string</span><br>
<span class="lineno"></span><span class="op" id="8518107">}</span><span class="op" id="8518108">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518111">{</span><span class="ident" id="8518112">ECDSAWithSHA1</span><span class="op" id="8518125">,</span>&nbsp;<span class="ident" id="8518127">ecdsaSHA1CertPem</span><span class="op" id="8518143">}</span><span class="op" id="8518144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518147">{</span><span class="ident" id="8518148">ECDSAWithSHA256</span><span class="op" id="8518163">,</span>&nbsp;<span class="ident" id="8518165">ecdsaSHA256p256CertPem</span><span class="op" id="8518187">}</span><span class="op" id="8518188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518191">{</span><span class="ident" id="8518192">ECDSAWithSHA256</span><span class="op" id="8518207">,</span>&nbsp;<span class="ident" id="8518209">ecdsaSHA256p384CertPem</span><span class="op" id="8518231">}</span><span class="op" id="8518232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518235">{</span><span class="ident" id="8518236">ECDSAWithSHA384</span><span class="op" id="8518251">,</span>&nbsp;<span class="ident" id="8518253">ecdsaSHA384p521CertPem</span><span class="op" id="8518275">}</span><span class="op" id="8518276">,</span><br>
<span class="lineno"></span><span class="op" id="8518278">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="8518281">func</span>&nbsp;<span class="ident" id="8518286">TestECDSA</span><span class="op" id="8518295">(</span><span class="ident" id="8518296">t</span>&nbsp;<span class="op" id="8518298">*</span><span class="ident" id="8518299">testing</span><span class="op" id="8518306">.</span><span class="ident" id="8518307">T</span><span class="op" id="8518308">)</span>&nbsp;<span class="op" id="8518310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518313">for</span>&nbsp;<span class="ident" id="8518317">i</span><span class="op" id="8518318">,</span>&nbsp;<span class="ident" id="8518320">test</span>&nbsp;<span class="op" id="8518325">:=</span>&nbsp;<span class="keyword" id="8518328">range</span>&nbsp;<span class="ident" id="8518334">ecdsaTests</span>&nbsp;<span class="op" id="8518345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518349">pemBlock</span><span class="op" id="8518357">,</span>&nbsp;<span class="ident" id="8518359">_</span>&nbsp;<span class="op" id="8518361">:=</span>&nbsp;<span class="ident" id="8518364">pem</span><span class="op" id="8518367">.</span><span class="ident" id="8518368">Decode</span><span class="op" id="8518374">(</span><span class="op" id="8518375">[</span><span class="op" id="8518376">]</span><span class="builtintype" id="8518377">byte</span><span class="op" id="8518381">(</span><span class="ident" id="8518382">test</span><span class="op" id="8518386">.</span><span class="ident" id="8518387">pemCert</span><span class="op" id="8518394">)</span><span class="op" id="8518395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518399">cert</span><span class="op" id="8518403">,</span>&nbsp;<span class="ident" id="8518405">err</span>&nbsp;<span class="op" id="8518409">:=</span>&nbsp;<span class="ident" id="8518412">ParseCertificate</span><span class="op" id="8518428">(</span><span class="ident" id="8518429">pemBlock</span><span class="op" id="8518437">.</span><span class="ident" id="8518438">Bytes</span><span class="op" id="8518443">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518447">if</span>&nbsp;<span class="ident" id="8518450">err</span>&nbsp;<span class="op" id="8518454">!=</span>&nbsp;<span class="ident" id="8518457">nil</span>&nbsp;<span class="op" id="8518461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518466">t</span><span class="op" id="8518467">.</span><span class="ident" id="8518468">Errorf</span><span class="op" id="8518474">(</span><span class="string" id="8518475">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8518512">,</span>&nbsp;<span class="ident" id="8518514">i</span><span class="op" id="8518515">,</span>&nbsp;<span class="ident" id="8518517">err</span><span class="op" id="8518520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518525">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518540">if</span>&nbsp;<span class="ident" id="8518543">sa</span>&nbsp;<span class="op" id="8518546">:=</span>&nbsp;<span class="ident" id="8518549">cert</span><span class="op" id="8518553">.</span><span class="ident" id="8518554">SignatureAlgorithm</span><span class="op" id="8518572">;</span>&nbsp;<span class="ident" id="8518574">sa</span>&nbsp;<span class="op" id="8518577">!=</span>&nbsp;<span class="ident" id="8518580">test</span><span class="op" id="8518584">.</span><span class="ident" id="8518585">sigAlgo</span>&nbsp;<span class="op" id="8518593">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518598">t</span><span class="op" id="8518599">.</span><span class="ident" id="8518600">Errorf</span><span class="op" id="8518606">(</span><span class="string" id="8518607">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8518647">,</span>&nbsp;<span class="ident" id="8518649">i</span><span class="op" id="8518650">,</span>&nbsp;<span class="ident" id="8518652">sa</span><span class="op" id="8518654">,</span>&nbsp;<span class="ident" id="8518656">test</span><span class="op" id="8518660">.</span><span class="ident" id="8518661">sigAlgo</span><span class="op" id="8518668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518676">if</span>&nbsp;<span class="ident" id="8518679">parsedKey</span><span class="op" id="8518688">,</span>&nbsp;<span class="ident" id="8518690">ok</span>&nbsp;<span class="op" id="8518693">:=</span>&nbsp;<span class="ident" id="8518696">cert</span><span class="op" id="8518700">.</span><span class="ident" id="8518701">PublicKey</span><span class="op" id="8518710">.</span><span class="op" id="8518711">(</span><span class="op" id="8518712">*</span><span class="ident" id="8518713">ecdsa</span><span class="op" id="8518718">.</span><span class="ident" id="8518719">PublicKey</span><span class="op" id="8518728">)</span><span class="op" id="8518729">;</span>&nbsp;<span class="op" id="8518731">!</span><span class="ident" id="8518732">ok</span>&nbsp;<span class="op" id="8518735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518740">t</span><span class="op" id="8518741">.</span><span class="ident" id="8518742">Errorf</span><span class="op" id="8518748">(</span><span class="string" id="8518749">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="8518796">,</span>&nbsp;<span class="ident" id="8518798">i</span><span class="op" id="8518799">,</span>&nbsp;<span class="ident" id="8518801">parsedKey</span><span class="op" id="8518810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518814">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518818">if</span>&nbsp;<span class="ident" id="8518821">pka</span>&nbsp;<span class="op" id="8518825">:=</span>&nbsp;<span class="ident" id="8518828">cert</span><span class="op" id="8518832">.</span><span class="ident" id="8518833">PublicKeyAlgorithm</span><span class="op" id="8518851">;</span>&nbsp;<span class="ident" id="8518853">pka</span>&nbsp;<span class="op" id="8518857">!=</span>&nbsp;<span class="ident" id="8518860">ECDSA</span>&nbsp;<span class="op" id="8518866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518871">t</span><span class="op" id="8518872">.</span><span class="ident" id="8518873">Errorf</span><span class="op" id="8518879">(</span><span class="string" id="8518880">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="8518924">,</span>&nbsp;<span class="ident" id="8518926">i</span><span class="op" id="8518927">,</span>&nbsp;<span class="ident" id="8518929">pka</span><span class="op" id="8518932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518940">if</span>&nbsp;<span class="ident" id="8518943">err</span>&nbsp;<span class="op" id="8518947">=</span>&nbsp;<span class="ident" id="8518949">cert</span><span class="op" id="8518953">.</span><span class="ident" id="8518954">CheckSignatureFrom</span><span class="op" id="8518972">(</span><span class="ident" id="8518973">cert</span><span class="op" id="8518977">)</span><span class="op" id="8518978">;</span>&nbsp;<span class="ident" id="8518980">err</span>&nbsp;<span class="op" id="8518984">!=</span>&nbsp;<span class="ident" id="8518987">nil</span>&nbsp;<span class="op" id="8518991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518996">t</span><span class="op" id="8518997">.</span><span class="ident" id="8518998">Errorf</span><span class="op" id="8519004">(</span><span class="string" id="8519005">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8519046">,</span>&nbsp;<span class="ident" id="8519048">i</span><span class="op" id="8519049">,</span>&nbsp;<span class="ident" id="8519051">err</span><span class="op" id="8519054">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519061">}</span><br>
<span class="lineno"></span><span class="op" id="8519063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8519066">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="8519113">var</span>&nbsp;<span class="ident" id="8519117">dsaCertPem</span>&nbsp;<span class="op" id="8519128">=</span>&nbsp;<span class="string" id="8519130">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="8520598">func</span>&nbsp;<span class="ident" id="8520603">TestParseCertificateWithDsaPublicKey</span><span class="op" id="8520639">(</span><span class="ident" id="8520640">t</span>&nbsp;<span class="op" id="8520642">*</span><span class="ident" id="8520643">testing</span><span class="op" id="8520650">.</span><span class="ident" id="8520651">T</span><span class="op" id="8520652">)</span>&nbsp;<span class="op" id="8520654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520657">expectedKey</span>&nbsp;<span class="op" id="8520669">:=</span>&nbsp;<span class="op" id="8520672">&amp;</span><span class="ident" id="8520673">dsa</span><span class="op" id="8520676">.</span><span class="ident" id="8520677">PublicKey</span><span class="op" id="8520686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520690">Parameters</span><span class="op" id="8520700">:</span>&nbsp;<span class="ident" id="8520702">dsa</span><span class="op" id="8520705">.</span><span class="ident" id="8520706">Parameters</span><span class="op" id="8520716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520721">P</span><span class="op" id="8520722">:</span>&nbsp;<span class="ident" id="8520724">bigFromHexString</span><span class="op" id="8520740">(</span><span class="string" id="8520741">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="8521001">)</span><span class="op" id="8521002">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521007">Q</span><span class="op" id="8521008">:</span>&nbsp;<span class="ident" id="8521010">bigFromHexString</span><span class="op" id="8521026">(</span><span class="string" id="8521027">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="8521071">)</span><span class="op" id="8521072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521077">G</span><span class="op" id="8521078">:</span>&nbsp;<span class="ident" id="8521080">bigFromHexString</span><span class="op" id="8521096">(</span><span class="string" id="8521097">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="8521357">)</span><span class="op" id="8521358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521362">}</span><span class="op" id="8521363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521367">Y</span><span class="op" id="8521368">:</span>&nbsp;<span class="ident" id="8521370">bigFromHexString</span><span class="op" id="8521386">(</span><span class="string" id="8521387">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="8521645">)</span><span class="op" id="8521646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521649">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521652">pemBlock</span><span class="op" id="8521660">,</span>&nbsp;<span class="ident" id="8521662">_</span>&nbsp;<span class="op" id="8521664">:=</span>&nbsp;<span class="ident" id="8521667">pem</span><span class="op" id="8521670">.</span><span class="ident" id="8521671">Decode</span><span class="op" id="8521677">(</span><span class="op" id="8521678">[</span><span class="op" id="8521679">]</span><span class="builtintype" id="8521680">byte</span><span class="op" id="8521684">(</span><span class="ident" id="8521685">dsaCertPem</span><span class="op" id="8521695">)</span><span class="op" id="8521696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521699">cert</span><span class="op" id="8521703">,</span>&nbsp;<span class="ident" id="8521705">err</span>&nbsp;<span class="op" id="8521709">:=</span>&nbsp;<span class="ident" id="8521712">ParseCertificate</span><span class="op" id="8521728">(</span><span class="ident" id="8521729">pemBlock</span><span class="op" id="8521737">.</span><span class="ident" id="8521738">Bytes</span><span class="op" id="8521743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521746">if</span>&nbsp;<span class="ident" id="8521749">err</span>&nbsp;<span class="op" id="8521753">!=</span>&nbsp;<span class="ident" id="8521756">nil</span>&nbsp;<span class="op" id="8521760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521764">t</span><span class="op" id="8521765">.</span><span class="ident" id="8521766">Fatalf</span><span class="op" id="8521772">(</span><span class="string" id="8521773">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8521806">,</span>&nbsp;<span class="ident" id="8521808">err</span><span class="op" id="8521811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521814">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521817">if</span>&nbsp;<span class="ident" id="8521820">cert</span><span class="op" id="8521824">.</span><span class="ident" id="8521825">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="8521844">!=</span>&nbsp;<span class="ident" id="8521847">DSA</span>&nbsp;<span class="op" id="8521851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521855">t</span><span class="op" id="8521856">.</span><span class="ident" id="8521857">Errorf</span><span class="op" id="8521863">(</span><span class="string" id="8521864">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="8521898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521904">parsedKey</span><span class="op" id="8521913">,</span>&nbsp;<span class="ident" id="8521915">ok</span>&nbsp;<span class="op" id="8521918">:=</span>&nbsp;<span class="ident" id="8521921">cert</span><span class="op" id="8521925">.</span><span class="ident" id="8521926">PublicKey</span><span class="op" id="8521935">.</span><span class="op" id="8521936">(</span><span class="op" id="8521937">*</span><span class="ident" id="8521938">dsa</span><span class="op" id="8521941">.</span><span class="ident" id="8521942">PublicKey</span><span class="op" id="8521951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521954">if</span>&nbsp;<span class="op" id="8521957">!</span><span class="ident" id="8521958">ok</span>&nbsp;<span class="op" id="8521961">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521965">t</span><span class="op" id="8521966">.</span><span class="ident" id="8521967">Fatalf</span><span class="op" id="8521973">(</span><span class="string" id="8521974">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8522008">,</span>&nbsp;<span class="ident" id="8522010">err</span><span class="op" id="8522013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522019">if</span>&nbsp;<span class="ident" id="8522022">expectedKey</span><span class="op" id="8522033">.</span><span class="ident" id="8522034">Y</span><span class="op" id="8522035">.</span><span class="ident" id="8522036">Cmp</span><span class="op" id="8522039">(</span><span class="ident" id="8522040">parsedKey</span><span class="op" id="8522049">.</span><span class="ident" id="8522050">Y</span><span class="op" id="8522051">)</span>&nbsp;<span class="op" id="8522053">!=</span>&nbsp;<span class="num" id="8522056">0</span>&nbsp;<span class="op" id="8522058">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522063">expectedKey</span><span class="op" id="8522074">.</span><span class="ident" id="8522075">P</span><span class="op" id="8522076">.</span><span class="ident" id="8522077">Cmp</span><span class="op" id="8522080">(</span><span class="ident" id="8522081">parsedKey</span><span class="op" id="8522090">.</span><span class="ident" id="8522091">P</span><span class="op" id="8522092">)</span>&nbsp;<span class="op" id="8522094">!=</span>&nbsp;<span class="num" id="8522097">0</span>&nbsp;<span class="op" id="8522099">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522104">expectedKey</span><span class="op" id="8522115">.</span><span class="ident" id="8522116">Q</span><span class="op" id="8522117">.</span><span class="ident" id="8522118">Cmp</span><span class="op" id="8522121">(</span><span class="ident" id="8522122">parsedKey</span><span class="op" id="8522131">.</span><span class="ident" id="8522132">Q</span><span class="op" id="8522133">)</span>&nbsp;<span class="op" id="8522135">!=</span>&nbsp;<span class="num" id="8522138">0</span>&nbsp;<span class="op" id="8522140">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522145">expectedKey</span><span class="op" id="8522156">.</span><span class="ident" id="8522157">G</span><span class="op" id="8522158">.</span><span class="ident" id="8522159">Cmp</span><span class="op" id="8522162">(</span><span class="ident" id="8522163">parsedKey</span><span class="op" id="8522172">.</span><span class="ident" id="8522173">G</span><span class="op" id="8522174">)</span>&nbsp;<span class="op" id="8522176">!=</span>&nbsp;<span class="num" id="8522179">0</span>&nbsp;<span class="op" id="8522181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522185">t</span><span class="op" id="8522186">.</span><span class="ident" id="8522187">Fatal</span><span class="op" id="8522192">(</span><span class="string" id="8522193">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="8522231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522234">}</span><br>
<span class="lineno"></span><span class="op" id="8522236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="8522239">func</span>&nbsp;<span class="ident" id="8522244">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="8522289">(</span><span class="ident" id="8522290">t</span>&nbsp;<span class="op" id="8522292">*</span><span class="ident" id="8522293">testing</span><span class="op" id="8522300">.</span><span class="ident" id="8522301">T</span><span class="op" id="8522302">)</span>&nbsp;<span class="op" id="8522304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522307">pemBlock</span><span class="op" id="8522315">,</span>&nbsp;<span class="ident" id="8522317">_</span>&nbsp;<span class="op" id="8522319">:=</span>&nbsp;<span class="ident" id="8522322">pem</span><span class="op" id="8522325">.</span><span class="ident" id="8522326">Decode</span><span class="op" id="8522332">(</span><span class="op" id="8522333">[</span><span class="op" id="8522334">]</span><span class="builtintype" id="8522335">byte</span><span class="op" id="8522339">(</span><span class="ident" id="8522340">dsaCertPem</span><span class="op" id="8522350">)</span><span class="op" id="8522351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522354">cert</span><span class="op" id="8522358">,</span>&nbsp;<span class="ident" id="8522360">err</span>&nbsp;<span class="op" id="8522364">:=</span>&nbsp;<span class="ident" id="8522367">ParseCertificate</span><span class="op" id="8522383">(</span><span class="ident" id="8522384">pemBlock</span><span class="op" id="8522392">.</span><span class="ident" id="8522393">Bytes</span><span class="op" id="8522398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522401">if</span>&nbsp;<span class="ident" id="8522404">err</span>&nbsp;<span class="op" id="8522408">!=</span>&nbsp;<span class="ident" id="8522411">nil</span>&nbsp;<span class="op" id="8522415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522419">t</span><span class="op" id="8522420">.</span><span class="ident" id="8522421">Fatalf</span><span class="op" id="8522427">(</span><span class="string" id="8522428">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8522461">,</span>&nbsp;<span class="ident" id="8522463">err</span><span class="op" id="8522466">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522472">if</span>&nbsp;<span class="ident" id="8522475">cert</span><span class="op" id="8522479">.</span><span class="ident" id="8522480">SignatureAlgorithm</span>&nbsp;<span class="op" id="8522499">!=</span>&nbsp;<span class="ident" id="8522502">DSAWithSHA1</span>&nbsp;<span class="op" id="8522514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522518">t</span><span class="op" id="8522519">.</span><span class="ident" id="8522520">Errorf</span><span class="op" id="8522526">(</span><span class="string" id="8522527">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="8522575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522578">}</span><br>
<span class="lineno"></span><span class="op" id="8522580">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="8522583">func</span>&nbsp;<span class="ident" id="8522588">TestVerifyCertificateWithDSASignature</span><span class="op" id="8522625">(</span><span class="ident" id="8522626">t</span>&nbsp;<span class="op" id="8522628">*</span><span class="ident" id="8522629">testing</span><span class="op" id="8522636">.</span><span class="ident" id="8522637">T</span><span class="op" id="8522638">)</span>&nbsp;<span class="op" id="8522640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522643">pemBlock</span><span class="op" id="8522651">,</span>&nbsp;<span class="ident" id="8522653">_</span>&nbsp;<span class="op" id="8522655">:=</span>&nbsp;<span class="ident" id="8522658">pem</span><span class="op" id="8522661">.</span><span class="ident" id="8522662">Decode</span><span class="op" id="8522668">(</span><span class="op" id="8522669">[</span><span class="op" id="8522670">]</span><span class="builtintype" id="8522671">byte</span><span class="op" id="8522675">(</span><span class="ident" id="8522676">dsaCertPem</span><span class="op" id="8522686">)</span><span class="op" id="8522687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522690">cert</span><span class="op" id="8522694">,</span>&nbsp;<span class="ident" id="8522696">err</span>&nbsp;<span class="op" id="8522700">:=</span>&nbsp;<span class="ident" id="8522703">ParseCertificate</span><span class="op" id="8522719">(</span><span class="ident" id="8522720">pemBlock</span><span class="op" id="8522728">.</span><span class="ident" id="8522729">Bytes</span><span class="op" id="8522734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522737">if</span>&nbsp;<span class="ident" id="8522740">err</span>&nbsp;<span class="op" id="8522744">!=</span>&nbsp;<span class="ident" id="8522747">nil</span>&nbsp;<span class="op" id="8522751">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522755">t</span><span class="op" id="8522756">.</span><span class="ident" id="8522757">Fatalf</span><span class="op" id="8522763">(</span><span class="string" id="8522764">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8522797">,</span>&nbsp;<span class="ident" id="8522799">err</span><span class="op" id="8522802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8522808">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522837">if</span>&nbsp;<span class="ident" id="8522840">err</span>&nbsp;<span class="op" id="8522844">=</span>&nbsp;<span class="ident" id="8522846">cert</span><span class="op" id="8522850">.</span><span class="ident" id="8522851">CheckSignatureFrom</span><span class="op" id="8522869">(</span><span class="ident" id="8522870">cert</span><span class="op" id="8522874">)</span><span class="op" id="8522875">;</span>&nbsp;<span class="ident" id="8522877">err</span>&nbsp;<span class="op" id="8522881">!=</span>&nbsp;<span class="ident" id="8522884">nil</span>&nbsp;<span class="op" id="8522888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522892">t</span><span class="op" id="8522893">.</span><span class="ident" id="8522894">Fatalf</span><span class="op" id="8522900">(</span><span class="string" id="8522901">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8522942">,</span>&nbsp;<span class="ident" id="8522944">err</span><span class="op" id="8522947">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522950">}</span><br>
<span class="lineno"></span><span class="op" id="8522952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8522955">const</span>&nbsp;<span class="ident" id="8522961">pemCertificate</span>&nbsp;<span class="op" id="8522976">=</span>&nbsp;<span class="string" id="8522978">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="8523696">func</span>&nbsp;<span class="ident" id="8523701">TestCRLCreation</span><span class="op" id="8523716">(</span><span class="ident" id="8523717">t</span>&nbsp;<span class="op" id="8523719">*</span><span class="ident" id="8523720">testing</span><span class="op" id="8523727">.</span><span class="ident" id="8523728">T</span><span class="op" id="8523729">)</span>&nbsp;<span class="op" id="8523731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523734">block</span><span class="op" id="8523739">,</span>&nbsp;<span class="ident" id="8523741">_</span>&nbsp;<span class="op" id="8523743">:=</span>&nbsp;<span class="ident" id="8523746">pem</span><span class="op" id="8523749">.</span><span class="ident" id="8523750">Decode</span><span class="op" id="8523756">(</span><span class="op" id="8523757">[</span><span class="op" id="8523758">]</span><span class="builtintype" id="8523759">byte</span><span class="op" id="8523763">(</span><span class="ident" id="8523764">pemPrivateKey</span><span class="op" id="8523777">)</span><span class="op" id="8523778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523781">priv</span><span class="op" id="8523785">,</span>&nbsp;<span class="ident" id="8523787">_</span>&nbsp;<span class="op" id="8523789">:=</span>&nbsp;<span class="ident" id="8523792">ParsePKCS1PrivateKey</span><span class="op" id="8523812">(</span><span class="ident" id="8523813">block</span><span class="op" id="8523818">.</span><span class="ident" id="8523819">Bytes</span><span class="op" id="8523824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523827">block</span><span class="op" id="8523832">,</span>&nbsp;<span class="ident" id="8523834">_</span>&nbsp;<span class="op" id="8523836">=</span>&nbsp;<span class="ident" id="8523838">pem</span><span class="op" id="8523841">.</span><span class="ident" id="8523842">Decode</span><span class="op" id="8523848">(</span><span class="op" id="8523849">[</span><span class="op" id="8523850">]</span><span class="builtintype" id="8523851">byte</span><span class="op" id="8523855">(</span><span class="ident" id="8523856">pemCertificate</span><span class="op" id="8523870">)</span><span class="op" id="8523871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523874">cert</span><span class="op" id="8523878">,</span>&nbsp;<span class="ident" id="8523880">_</span>&nbsp;<span class="op" id="8523882">:=</span>&nbsp;<span class="ident" id="8523885">ParseCertificate</span><span class="op" id="8523901">(</span><span class="ident" id="8523902">block</span><span class="op" id="8523907">.</span><span class="ident" id="8523908">Bytes</span><span class="op" id="8523913">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523917">now</span>&nbsp;<span class="op" id="8523921">:=</span>&nbsp;<span class="ident" id="8523924">time</span><span class="op" id="8523928">.</span><span class="ident" id="8523929">Unix</span><span class="op" id="8523933">(</span><span class="num" id="8523934">1000</span><span class="op" id="8523938">,</span>&nbsp;<span class="num" id="8523940">0</span><span class="op" id="8523941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523944">expiry</span>&nbsp;<span class="op" id="8523951">:=</span>&nbsp;<span class="ident" id="8523954">time</span><span class="op" id="8523958">.</span><span class="ident" id="8523959">Unix</span><span class="op" id="8523963">(</span><span class="num" id="8523964">10000</span><span class="op" id="8523969">,</span>&nbsp;<span class="num" id="8523971">0</span><span class="op" id="8523972">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523976">revokedCerts</span>&nbsp;<span class="op" id="8523989">:=</span>&nbsp;<span class="op" id="8523992">[</span><span class="op" id="8523993">]</span><span class="ident" id="8523994">pkix</span><span class="op" id="8523998">.</span><span class="ident" id="8523999">RevokedCertificate</span><span class="op" id="8524017">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524026">SerialNumber</span><span class="op" id="8524038">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8524042">big</span><span class="op" id="8524045">.</span><span class="ident" id="8524046">NewInt</span><span class="op" id="8524052">(</span><span class="num" id="8524053">1</span><span class="op" id="8524054">)</span><span class="op" id="8524055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524060">RevocationTime</span><span class="op" id="8524074">:</span>&nbsp;<span class="ident" id="8524076">now</span><span class="op" id="8524079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524083">}</span><span class="op" id="8524084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524088">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524093">SerialNumber</span><span class="op" id="8524105">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8524109">big</span><span class="op" id="8524112">.</span><span class="ident" id="8524113">NewInt</span><span class="op" id="8524119">(</span><span class="num" id="8524120">42</span><span class="op" id="8524122">)</span><span class="op" id="8524123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524128">RevocationTime</span><span class="op" id="8524142">:</span>&nbsp;<span class="ident" id="8524144">now</span><span class="op" id="8524147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524151">}</span><span class="op" id="8524152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524159">crlBytes</span><span class="op" id="8524167">,</span>&nbsp;<span class="ident" id="8524169">err</span>&nbsp;<span class="op" id="8524173">:=</span>&nbsp;<span class="ident" id="8524176">cert</span><span class="op" id="8524180">.</span><span class="ident" id="8524181">CreateCRL</span><span class="op" id="8524190">(</span><span class="ident" id="8524191">rand</span><span class="op" id="8524195">.</span><span class="ident" id="8524196">Reader</span><span class="op" id="8524202">,</span>&nbsp;<span class="ident" id="8524204">priv</span><span class="op" id="8524208">,</span>&nbsp;<span class="ident" id="8524210">revokedCerts</span><span class="op" id="8524222">,</span>&nbsp;<span class="ident" id="8524224">now</span><span class="op" id="8524227">,</span>&nbsp;<span class="ident" id="8524229">expiry</span><span class="op" id="8524235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524238">if</span>&nbsp;<span class="ident" id="8524241">err</span>&nbsp;<span class="op" id="8524245">!=</span>&nbsp;<span class="ident" id="8524248">nil</span>&nbsp;<span class="op" id="8524252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524256">t</span><span class="op" id="8524257">.</span><span class="ident" id="8524258">Errorf</span><span class="op" id="8524264">(</span><span class="string" id="8524265">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="8524289">,</span>&nbsp;<span class="ident" id="8524291">err</span><span class="op" id="8524294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524301">_</span><span class="op" id="8524302">,</span>&nbsp;<span class="ident" id="8524304">err</span>&nbsp;<span class="op" id="8524308">=</span>&nbsp;<span class="ident" id="8524310">ParseDERCRL</span><span class="op" id="8524321">(</span><span class="ident" id="8524322">crlBytes</span><span class="op" id="8524330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524333">if</span>&nbsp;<span class="ident" id="8524336">err</span>&nbsp;<span class="op" id="8524340">!=</span>&nbsp;<span class="ident" id="8524343">nil</span>&nbsp;<span class="op" id="8524347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524351">t</span><span class="op" id="8524352">.</span><span class="ident" id="8524353">Errorf</span><span class="op" id="8524359">(</span><span class="string" id="8524360">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="8524385">,</span>&nbsp;<span class="ident" id="8524387">err</span><span class="op" id="8524390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524393">}</span><br>
<span class="lineno"></span><span class="op" id="8524395">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="8524398">func</span>&nbsp;<span class="ident" id="8524403">fromBase64</span><span class="op" id="8524413">(</span><span class="ident" id="8524414">in</span>&nbsp;<span class="builtintype" id="8524417">string</span><span class="op" id="8524423">)</span>&nbsp;<span class="op" id="8524425">[</span><span class="op" id="8524426">]</span><span class="builtintype" id="8524427">byte</span>&nbsp;<span class="op" id="8524432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524435">out</span>&nbsp;<span class="op" id="8524439">:=</span>&nbsp;<span class="builtinfunc" id="8524442">make</span><span class="op" id="8524446">(</span><span class="op" id="8524447">[</span><span class="op" id="8524448">]</span><span class="builtintype" id="8524449">byte</span><span class="op" id="8524453">,</span>&nbsp;<span class="ident" id="8524455">base64</span><span class="op" id="8524461">.</span><span class="ident" id="8524462">StdEncoding</span><span class="op" id="8524473">.</span><span class="ident" id="8524474">DecodedLen</span><span class="op" id="8524484">(</span><span class="builtinfunc" id="8524485">len</span><span class="op" id="8524488">(</span><span class="ident" id="8524489">in</span><span class="op" id="8524491">)</span><span class="op" id="8524492">)</span><span class="op" id="8524493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524496">n</span><span class="op" id="8524497">,</span>&nbsp;<span class="ident" id="8524499">err</span>&nbsp;<span class="op" id="8524503">:=</span>&nbsp;<span class="ident" id="8524506">base64</span><span class="op" id="8524512">.</span><span class="ident" id="8524513">StdEncoding</span><span class="op" id="8524524">.</span><span class="ident" id="8524525">Decode</span><span class="op" id="8524531">(</span><span class="ident" id="8524532">out</span><span class="op" id="8524535">,</span>&nbsp;<span class="op" id="8524537">[</span><span class="op" id="8524538">]</span><span class="builtintype" id="8524539">byte</span><span class="op" id="8524543">(</span><span class="ident" id="8524544">in</span><span class="op" id="8524546">)</span><span class="op" id="8524547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524550">if</span>&nbsp;<span class="ident" id="8524553">err</span>&nbsp;<span class="op" id="8524557">!=</span>&nbsp;<span class="ident" id="8524560">nil</span>&nbsp;<span class="op" id="8524564">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8524568">panic</span><span class="op" id="8524573">(</span><span class="string" id="8524574">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="8524599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524605">return</span>&nbsp;<span class="ident" id="8524612">out</span><span class="op" id="8524615">[</span><span class="op" id="8524616">:</span><span class="ident" id="8524617">n</span><span class="op" id="8524618">]</span><br>
<span class="lineno"></span><span class="op" id="8524620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="8524623">func</span>&nbsp;<span class="ident" id="8524628">TestParseDERCRL</span><span class="op" id="8524643">(</span><span class="ident" id="8524644">t</span>&nbsp;<span class="op" id="8524646">*</span><span class="ident" id="8524647">testing</span><span class="op" id="8524654">.</span><span class="ident" id="8524655">T</span><span class="op" id="8524656">)</span>&nbsp;<span class="op" id="8524658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524661">derBytes</span>&nbsp;<span class="op" id="8524670">:=</span>&nbsp;<span class="ident" id="8524673">fromBase64</span><span class="op" id="8524683">(</span><span class="ident" id="8524684">derCRLBase64</span><span class="op" id="8524696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524699">certList</span><span class="op" id="8524707">,</span>&nbsp;<span class="ident" id="8524709">err</span>&nbsp;<span class="op" id="8524713">:=</span>&nbsp;<span class="ident" id="8524716">ParseDERCRL</span><span class="op" id="8524727">(</span><span class="ident" id="8524728">derBytes</span><span class="op" id="8524736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524739">if</span>&nbsp;<span class="ident" id="8524742">err</span>&nbsp;<span class="op" id="8524746">!=</span>&nbsp;<span class="ident" id="8524749">nil</span>&nbsp;<span class="op" id="8524753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524757">t</span><span class="op" id="8524758">.</span><span class="ident" id="8524759">Errorf</span><span class="op" id="8524765">(</span><span class="string" id="8524766">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="8524785">,</span>&nbsp;<span class="ident" id="8524787">err</span><span class="op" id="8524790">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524794">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524805">numCerts</span>&nbsp;<span class="op" id="8524814">:=</span>&nbsp;<span class="builtinfunc" id="8524817">len</span><span class="op" id="8524820">(</span><span class="ident" id="8524821">certList</span><span class="op" id="8524829">.</span><span class="ident" id="8524830">TBSCertList</span><span class="op" id="8524841">.</span><span class="ident" id="8524842">RevokedCertificates</span><span class="op" id="8524861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524864">expected</span>&nbsp;<span class="op" id="8524873">:=</span>&nbsp;<span class="num" id="8524876">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524880">if</span>&nbsp;<span class="ident" id="8524883">numCerts</span>&nbsp;<span class="op" id="8524892">!=</span>&nbsp;<span class="ident" id="8524895">expected</span>&nbsp;<span class="op" id="8524904">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524908">t</span><span class="op" id="8524909">.</span><span class="ident" id="8524910">Errorf</span><span class="op" id="8524916">(</span><span class="string" id="8524917">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="8524971">,</span>&nbsp;<span class="ident" id="8524973">numCerts</span><span class="op" id="8524981">,</span>&nbsp;<span class="ident" id="8524983">expected</span><span class="op" id="8524991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524998">if</span>&nbsp;<span class="ident" id="8525001">certList</span><span class="op" id="8525009">.</span><span class="ident" id="8525010">HasExpired</span><span class="op" id="8525020">(</span><span class="ident" id="8525021">time</span><span class="op" id="8525025">.</span><span class="ident" id="8525026">Unix</span><span class="op" id="8525030">(</span><span class="num" id="8525031">1302517272</span><span class="op" id="8525041">,</span>&nbsp;<span class="num" id="8525043">0</span><span class="op" id="8525044">)</span><span class="op" id="8525045">)</span>&nbsp;<span class="op" id="8525047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525051">t</span><span class="op" id="8525052">.</span><span class="ident" id="8525053">Errorf</span><span class="op" id="8525059">(</span><span class="string" id="8525060">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="8525098">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8525105">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="8525164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="8525167">func</span>&nbsp;<span class="ident" id="8525172">TestCRLWithoutExpiry</span><span class="op" id="8525192">(</span><span class="ident" id="8525193">t</span>&nbsp;<span class="op" id="8525195">*</span><span class="ident" id="8525196">testing</span><span class="op" id="8525203">.</span><span class="ident" id="8525204">T</span><span class="op" id="8525205">)</span>&nbsp;<span class="op" id="8525207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525210">derBytes</span>&nbsp;<span class="op" id="8525219">:=</span>&nbsp;<span class="ident" id="8525222">fromBase64</span><span class="op" id="8525232">(</span><span class="string" id="8525233">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="8525527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525530">certList</span><span class="op" id="8525538">,</span>&nbsp;<span class="ident" id="8525540">err</span>&nbsp;<span class="op" id="8525544">:=</span>&nbsp;<span class="ident" id="8525547">ParseDERCRL</span><span class="op" id="8525558">(</span><span class="ident" id="8525559">derBytes</span><span class="op" id="8525567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8525570">if</span>&nbsp;<span class="ident" id="8525573">err</span>&nbsp;<span class="op" id="8525577">!=</span>&nbsp;<span class="ident" id="8525580">nil</span>&nbsp;<span class="op" id="8525584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525588">t</span><span class="op" id="8525589">.</span><span class="ident" id="8525590">Fatal</span><span class="op" id="8525595">(</span><span class="ident" id="8525596">err</span><span class="op" id="8525599">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8525605">if</span>&nbsp;<span class="op" id="8525608">!</span><span class="ident" id="8525609">certList</span><span class="op" id="8525617">.</span><span class="ident" id="8525618">TBSCertList</span><span class="op" id="8525629">.</span><span class="ident" id="8525630">NextUpdate</span><span class="op" id="8525640">.</span><span class="ident" id="8525641">IsZero</span><span class="op" id="8525647">(</span><span class="op" id="8525648">)</span>&nbsp;<span class="op" id="8525650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525654">t</span><span class="op" id="8525655">.</span><span class="ident" id="8525656">Errorf</span><span class="op" id="8525662">(</span><span class="string" id="8525663">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="8525697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525700">}</span><br>
<span class="lineno"></span><span class="op" id="8525702">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="8525705">func</span>&nbsp;<span class="ident" id="8525710">TestParsePEMCRL</span><span class="op" id="8525725">(</span><span class="ident" id="8525726">t</span>&nbsp;<span class="op" id="8525728">*</span><span class="ident" id="8525729">testing</span><span class="op" id="8525736">.</span><span class="ident" id="8525737">T</span><span class="op" id="8525738">)</span>&nbsp;<span class="op" id="8525740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525743">pemBytes</span>&nbsp;<span class="op" id="8525752">:=</span>&nbsp;<span class="ident" id="8525755">fromBase64</span><span class="op" id="8525765">(</span><span class="ident" id="8525766">pemCRLBase64</span><span class="op" id="8525778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525781">certList</span><span class="op" id="8525789">,</span>&nbsp;<span class="ident" id="8525791">err</span>&nbsp;<span class="op" id="8525795">:=</span>&nbsp;<span class="ident" id="8525798">ParseCRL</span><span class="op" id="8525806">(</span><span class="ident" id="8525807">pemBytes</span><span class="op" id="8525815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8525818">if</span>&nbsp;<span class="ident" id="8525821">err</span>&nbsp;<span class="op" id="8525825">!=</span>&nbsp;<span class="ident" id="8525828">nil</span>&nbsp;<span class="op" id="8525832">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525836">t</span><span class="op" id="8525837">.</span><span class="ident" id="8525838">Errorf</span><span class="op" id="8525844">(</span><span class="string" id="8525845">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="8525864">,</span>&nbsp;<span class="ident" id="8525866">err</span><span class="op" id="8525869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8525873">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525884">numCerts</span>&nbsp;<span class="op" id="8525893">:=</span>&nbsp;<span class="builtinfunc" id="8525896">len</span><span class="op" id="8525899">(</span><span class="ident" id="8525900">certList</span><span class="op" id="8525908">.</span><span class="ident" id="8525909">TBSCertList</span><span class="op" id="8525920">.</span><span class="ident" id="8525921">RevokedCertificates</span><span class="op" id="8525940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525943">expected</span>&nbsp;<span class="op" id="8525952">:=</span>&nbsp;<span class="num" id="8525955">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8525958">if</span>&nbsp;<span class="ident" id="8525961">numCerts</span>&nbsp;<span class="op" id="8525970">!=</span>&nbsp;<span class="ident" id="8525973">expected</span>&nbsp;<span class="op" id="8525982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525986">t</span><span class="op" id="8525987">.</span><span class="ident" id="8525988">Errorf</span><span class="op" id="8525994">(</span><span class="string" id="8525995">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="8526049">,</span>&nbsp;<span class="ident" id="8526051">numCerts</span><span class="op" id="8526059">,</span>&nbsp;<span class="ident" id="8526061">expected</span><span class="op" id="8526069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8526076">if</span>&nbsp;<span class="ident" id="8526079">certList</span><span class="op" id="8526087">.</span><span class="ident" id="8526088">HasExpired</span><span class="op" id="8526098">(</span><span class="ident" id="8526099">time</span><span class="op" id="8526103">.</span><span class="ident" id="8526104">Unix</span><span class="op" id="8526108">(</span><span class="num" id="8526109">1302517272</span><span class="op" id="8526119">,</span>&nbsp;<span class="num" id="8526121">0</span><span class="op" id="8526122">)</span><span class="op" id="8526123">)</span>&nbsp;<span class="op" id="8526125">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526129">t</span><span class="op" id="8526130">.</span><span class="ident" id="8526131">Errorf</span><span class="op" id="8526137">(</span><span class="string" id="8526138">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="8526176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8526183">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="8526242">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="8526245">func</span>&nbsp;<span class="ident" id="8526250">TestImports</span><span class="op" id="8526261">(</span><span class="ident" id="8526262">t</span>&nbsp;<span class="op" id="8526264">*</span><span class="ident" id="8526265">testing</span><span class="op" id="8526272">.</span><span class="ident" id="8526273">T</span><span class="op" id="8526274">)</span>&nbsp;<span class="op" id="8526276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8526279">switch</span>&nbsp;<span class="ident" id="8526286">runtime</span><span class="op" id="8526293">.</span><span class="ident" id="8526294">GOOS</span>&nbsp;<span class="op" id="8526299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8526302">case</span>&nbsp;<span class="string" id="8526307">&#34;android&#34;</span><span class="op" id="8526316">,</span>&nbsp;<span class="string" id="8526318">&#34;nacl&#34;</span><span class="op" id="8526324">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526328">t</span><span class="op" id="8526329">.</span><span class="ident" id="8526330">Skipf</span><span class="op" id="8526335">(</span><span class="string" id="8526336">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="8526352">,</span>&nbsp;<span class="ident" id="8526354">runtime</span><span class="op" id="8526361">.</span><span class="ident" id="8526362">GOOS</span><span class="op" id="8526366">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8526373">if</span>&nbsp;<span class="ident" id="8526376">err</span>&nbsp;<span class="op" id="8526380">:=</span>&nbsp;<span class="ident" id="8526383">exec</span><span class="op" id="8526387">.</span><span class="ident" id="8526388">Command</span><span class="op" id="8526395">(</span><span class="string" id="8526396">&#34;go&#34;</span><span class="op" id="8526400">,</span>&nbsp;<span class="string" id="8526402">&#34;run&#34;</span><span class="op" id="8526407">,</span>&nbsp;<span class="string" id="8526409">&#34;x509_test_import.go&#34;</span><span class="op" id="8526430">)</span><span class="op" id="8526431">.</span><span class="ident" id="8526432">Run</span><span class="op" id="8526435">(</span><span class="op" id="8526436">)</span><span class="op" id="8526437">;</span>&nbsp;<span class="ident" id="8526439">err</span>&nbsp;<span class="op" id="8526443">!=</span>&nbsp;<span class="ident" id="8526446">nil</span>&nbsp;<span class="op" id="8526450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526454">t</span><span class="op" id="8526455">.</span><span class="ident" id="8526456">Errorf</span><span class="op" id="8526462">(</span><span class="string" id="8526463">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="8526502">,</span>&nbsp;<span class="ident" id="8526504">err</span><span class="op" id="8526507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526510">}</span><br>
<span class="lineno">750</span><span class="op" id="8526512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8526515">const</span>&nbsp;<span class="ident" id="8526521">derCRLBase64</span>&nbsp;<span class="op" id="8526534">=</span>&nbsp;<span class="string" id="8526536">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8531212">const</span>&nbsp;<span class="ident" id="8531218">pemCRLBase64</span>&nbsp;<span class="op" id="8531231">=</span>&nbsp;<span class="string" id="8531233">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="8532237">func</span>&nbsp;<span class="ident" id="8532242">TestCreateCertificateRequest</span><span class="op" id="8532270">(</span><span class="ident" id="8532271">t</span>&nbsp;<span class="op" id="8532273">*</span><span class="ident" id="8532274">testing</span><span class="op" id="8532281">.</span><span class="ident" id="8532282">T</span><span class="op" id="8532283">)</span>&nbsp;<span class="op" id="8532285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532288">random</span>&nbsp;<span class="op" id="8532295">:=</span>&nbsp;<span class="ident" id="8532298">rand</span><span class="op" id="8532302">.</span><span class="ident" id="8532303">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532312">block</span><span class="op" id="8532317">,</span>&nbsp;<span class="ident" id="8532319">_</span>&nbsp;<span class="op" id="8532321">:=</span>&nbsp;<span class="ident" id="8532324">pem</span><span class="op" id="8532327">.</span><span class="ident" id="8532328">Decode</span><span class="op" id="8532334">(</span><span class="op" id="8532335">[</span><span class="op" id="8532336">]</span><span class="builtintype" id="8532337">byte</span><span class="op" id="8532341">(</span><span class="ident" id="8532342">pemPrivateKey</span><span class="op" id="8532355">)</span><span class="op" id="8532356">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532359">rsaPriv</span><span class="op" id="8532366">,</span>&nbsp;<span class="ident" id="8532368">err</span>&nbsp;<span class="op" id="8532372">:=</span>&nbsp;<span class="ident" id="8532375">ParsePKCS1PrivateKey</span><span class="op" id="8532395">(</span><span class="ident" id="8532396">block</span><span class="op" id="8532401">.</span><span class="ident" id="8532402">Bytes</span><span class="op" id="8532407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532410">if</span>&nbsp;<span class="ident" id="8532413">err</span>&nbsp;<span class="op" id="8532417">!=</span>&nbsp;<span class="ident" id="8532420">nil</span>&nbsp;<span class="op" id="8532424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532428">t</span><span class="op" id="8532429">.</span><span class="ident" id="8532430">Fatalf</span><span class="op" id="8532436">(</span><span class="string" id="8532437">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8532470">,</span>&nbsp;<span class="ident" id="8532472">err</span><span class="op" id="8532475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532482">ecdsa256Priv</span><span class="op" id="8532494">,</span>&nbsp;<span class="ident" id="8532496">err</span>&nbsp;<span class="op" id="8532500">:=</span>&nbsp;<span class="ident" id="8532503">ecdsa</span><span class="op" id="8532508">.</span><span class="ident" id="8532509">GenerateKey</span><span class="op" id="8532520">(</span><span class="ident" id="8532521">elliptic</span><span class="op" id="8532529">.</span><span class="ident" id="8532530">P256</span><span class="op" id="8532534">(</span><span class="op" id="8532535">)</span><span class="op" id="8532536">,</span>&nbsp;<span class="ident" id="8532538">rand</span><span class="op" id="8532542">.</span><span class="ident" id="8532543">Reader</span><span class="op" id="8532549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532552">if</span>&nbsp;<span class="ident" id="8532555">err</span>&nbsp;<span class="op" id="8532559">!=</span>&nbsp;<span class="ident" id="8532562">nil</span>&nbsp;<span class="op" id="8532566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532570">t</span><span class="op" id="8532571">.</span><span class="ident" id="8532572">Fatalf</span><span class="op" id="8532578">(</span><span class="string" id="8532579">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8532613">,</span>&nbsp;<span class="ident" id="8532615">err</span><span class="op" id="8532618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532625">ecdsa384Priv</span><span class="op" id="8532637">,</span>&nbsp;<span class="ident" id="8532639">err</span>&nbsp;<span class="op" id="8532643">:=</span>&nbsp;<span class="ident" id="8532646">ecdsa</span><span class="op" id="8532651">.</span><span class="ident" id="8532652">GenerateKey</span><span class="op" id="8532663">(</span><span class="ident" id="8532664">elliptic</span><span class="op" id="8532672">.</span><span class="ident" id="8532673">P384</span><span class="op" id="8532677">(</span><span class="op" id="8532678">)</span><span class="op" id="8532679">,</span>&nbsp;<span class="ident" id="8532681">rand</span><span class="op" id="8532685">.</span><span class="ident" id="8532686">Reader</span><span class="op" id="8532692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532695">if</span>&nbsp;<span class="ident" id="8532698">err</span>&nbsp;<span class="op" id="8532702">!=</span>&nbsp;<span class="ident" id="8532705">nil</span>&nbsp;<span class="op" id="8532709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532713">t</span><span class="op" id="8532714">.</span><span class="ident" id="8532715">Fatalf</span><span class="op" id="8532721">(</span><span class="string" id="8532722">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8532756">,</span>&nbsp;<span class="ident" id="8532758">err</span><span class="op" id="8532761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532768">ecdsa521Priv</span><span class="op" id="8532780">,</span>&nbsp;<span class="ident" id="8532782">err</span>&nbsp;<span class="op" id="8532786">:=</span>&nbsp;<span class="ident" id="8532789">ecdsa</span><span class="op" id="8532794">.</span><span class="ident" id="8532795">GenerateKey</span><span class="op" id="8532806">(</span><span class="ident" id="8532807">elliptic</span><span class="op" id="8532815">.</span><span class="ident" id="8532816">P521</span><span class="op" id="8532820">(</span><span class="op" id="8532821">)</span><span class="op" id="8532822">,</span>&nbsp;<span class="ident" id="8532824">rand</span><span class="op" id="8532828">.</span><span class="ident" id="8532829">Reader</span><span class="op" id="8532835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532838">if</span>&nbsp;<span class="ident" id="8532841">err</span>&nbsp;<span class="op" id="8532845">!=</span>&nbsp;<span class="ident" id="8532848">nil</span>&nbsp;<span class="op" id="8532852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532856">t</span><span class="op" id="8532857">.</span><span class="ident" id="8532858">Fatalf</span><span class="op" id="8532864">(</span><span class="string" id="8532865">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8532899">,</span>&nbsp;<span class="ident" id="8532901">err</span><span class="op" id="8532904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532911">tests</span>&nbsp;<span class="op" id="8532917">:=</span>&nbsp;<span class="op" id="8532920">[</span><span class="op" id="8532921">]</span><span class="keyword" id="8532922">struct</span>&nbsp;<span class="op" id="8532929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532933">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8532941">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532950">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532958">interface</span><span class="op" id="8532967">{</span><span class="op" id="8532968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532972">sigAlgo</span>&nbsp;<span class="ident" id="8532980">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533000">}</span><span class="op" id="8533001">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533005">{</span><span class="string" id="8533006">&#34;RSA&#34;</span><span class="op" id="8533011">,</span>&nbsp;<span class="ident" id="8533013">rsaPriv</span><span class="op" id="8533020">,</span>&nbsp;<span class="ident" id="8533022">SHA1WithRSA</span><span class="op" id="8533033">}</span><span class="op" id="8533034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533038">{</span><span class="string" id="8533039">&#34;ECDSA-256&#34;</span><span class="op" id="8533050">,</span>&nbsp;<span class="ident" id="8533052">ecdsa256Priv</span><span class="op" id="8533064">,</span>&nbsp;<span class="ident" id="8533066">ECDSAWithSHA1</span><span class="op" id="8533079">}</span><span class="op" id="8533080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533084">{</span><span class="string" id="8533085">&#34;ECDSA-384&#34;</span><span class="op" id="8533096">,</span>&nbsp;<span class="ident" id="8533098">ecdsa384Priv</span><span class="op" id="8533110">,</span>&nbsp;<span class="ident" id="8533112">ECDSAWithSHA1</span><span class="op" id="8533125">}</span><span class="op" id="8533126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533130">{</span><span class="string" id="8533131">&#34;ECDSA-521&#34;</span><span class="op" id="8533142">,</span>&nbsp;<span class="ident" id="8533144">ecdsa521Priv</span><span class="op" id="8533156">,</span>&nbsp;<span class="ident" id="8533158">ECDSAWithSHA1</span><span class="op" id="8533171">}</span><span class="op" id="8533172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533175">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533179">for</span>&nbsp;<span class="ident" id="8533183">_</span><span class="op" id="8533184">,</span>&nbsp;<span class="ident" id="8533186">test</span>&nbsp;<span class="op" id="8533191">:=</span>&nbsp;<span class="keyword" id="8533194">range</span>&nbsp;<span class="ident" id="8533200">tests</span>&nbsp;<span class="op" id="8533206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533210">template</span>&nbsp;<span class="op" id="8533219">:=</span>&nbsp;<span class="ident" id="8533222">CertificateRequest</span><span class="op" id="8533240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533245">Subject</span><span class="op" id="8533252">:</span>&nbsp;<span class="ident" id="8533254">pkix</span><span class="op" id="8533258">.</span><span class="ident" id="8533259">Name</span><span class="op" id="8533263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533269">CommonName</span><span class="op" id="8533279">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8533283">&#34;test.example.com&#34;</span><span class="op" id="8533301">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533307">Organization</span><span class="op" id="8533319">:</span>&nbsp;<span class="op" id="8533321">[</span><span class="op" id="8533322">]</span><span class="builtintype" id="8533323">string</span><span class="op" id="8533329">{</span><span class="string" id="8533330">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8533342">}</span><span class="op" id="8533343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533348">}</span><span class="op" id="8533349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533354">SignatureAlgorithm</span><span class="op" id="8533372">:</span>&nbsp;<span class="ident" id="8533374">test</span><span class="op" id="8533378">.</span><span class="ident" id="8533379">sigAlgo</span><span class="op" id="8533386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533391">DNSNames</span><span class="op" id="8533399">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533411">[</span><span class="op" id="8533412">]</span><span class="builtintype" id="8533413">string</span><span class="op" id="8533419">{</span><span class="string" id="8533420">&#34;test.example.com&#34;</span><span class="op" id="8533438">}</span><span class="op" id="8533439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533444">EmailAddresses</span><span class="op" id="8533458">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533464">[</span><span class="op" id="8533465">]</span><span class="builtintype" id="8533466">string</span><span class="op" id="8533472">{</span><span class="string" id="8533473">&#34;gopher@golang.org&#34;</span><span class="op" id="8533492">}</span><span class="op" id="8533493">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533498">IPAddresses</span><span class="op" id="8533509">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533518">[</span><span class="op" id="8533519">]</span><span class="ident" id="8533520">net</span><span class="op" id="8533523">.</span><span class="ident" id="8533524">IP</span><span class="op" id="8533526">{</span><span class="ident" id="8533527">net</span><span class="op" id="8533530">.</span><span class="ident" id="8533531">IPv4</span><span class="op" id="8533535">(</span><span class="num" id="8533536">127</span><span class="op" id="8533539">,</span>&nbsp;<span class="num" id="8533541">0</span><span class="op" id="8533542">,</span>&nbsp;<span class="num" id="8533544">0</span><span class="op" id="8533545">,</span>&nbsp;<span class="num" id="8533547">1</span><span class="op" id="8533548">)</span><span class="op" id="8533549">.</span><span class="ident" id="8533550">To4</span><span class="op" id="8533553">(</span><span class="op" id="8533554">)</span><span class="op" id="8533555">,</span>&nbsp;<span class="ident" id="8533557">net</span><span class="op" id="8533560">.</span><span class="ident" id="8533561">ParseIP</span><span class="op" id="8533568">(</span><span class="string" id="8533569">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="8533591">)</span><span class="op" id="8533592">}</span><span class="op" id="8533593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533602">derBytes</span><span class="op" id="8533610">,</span>&nbsp;<span class="ident" id="8533612">err</span>&nbsp;<span class="op" id="8533616">:=</span>&nbsp;<span class="ident" id="8533619">CreateCertificateRequest</span><span class="op" id="8533643">(</span><span class="ident" id="8533644">random</span><span class="op" id="8533650">,</span>&nbsp;<span class="op" id="8533652">&amp;</span><span class="ident" id="8533653">template</span><span class="op" id="8533661">,</span>&nbsp;<span class="ident" id="8533663">test</span><span class="op" id="8533667">.</span><span class="ident" id="8533668">priv</span><span class="op" id="8533672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533676">if</span>&nbsp;<span class="ident" id="8533679">err</span>&nbsp;<span class="op" id="8533683">!=</span>&nbsp;<span class="ident" id="8533686">nil</span>&nbsp;<span class="op" id="8533690">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533695">t</span><span class="op" id="8533696">.</span><span class="ident" id="8533697">Errorf</span><span class="op" id="8533703">(</span><span class="string" id="8533704">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="8533750">,</span>&nbsp;<span class="ident" id="8533752">test</span><span class="op" id="8533756">.</span><span class="ident" id="8533757">name</span><span class="op" id="8533761">,</span>&nbsp;<span class="ident" id="8533763">err</span><span class="op" id="8533766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533771">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533787">out</span><span class="op" id="8533790">,</span>&nbsp;<span class="ident" id="8533792">err</span>&nbsp;<span class="op" id="8533796">:=</span>&nbsp;<span class="ident" id="8533799">ParseCertificateRequest</span><span class="op" id="8533822">(</span><span class="ident" id="8533823">derBytes</span><span class="op" id="8533831">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533835">if</span>&nbsp;<span class="ident" id="8533838">err</span>&nbsp;<span class="op" id="8533842">!=</span>&nbsp;<span class="ident" id="8533845">nil</span>&nbsp;<span class="op" id="8533849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533854">t</span><span class="op" id="8533855">.</span><span class="ident" id="8533856">Errorf</span><span class="op" id="8533862">(</span><span class="string" id="8533863">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="8533909">,</span>&nbsp;<span class="ident" id="8533911">test</span><span class="op" id="8533915">.</span><span class="ident" id="8533916">name</span><span class="op" id="8533920">,</span>&nbsp;<span class="ident" id="8533922">err</span><span class="op" id="8533925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533930">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533946">if</span>&nbsp;<span class="ident" id="8533949">out</span><span class="op" id="8533952">.</span><span class="ident" id="8533953">Subject</span><span class="op" id="8533960">.</span><span class="ident" id="8533961">CommonName</span>&nbsp;<span class="op" id="8533972">!=</span>&nbsp;<span class="ident" id="8533975">template</span><span class="op" id="8533983">.</span><span class="ident" id="8533984">Subject</span><span class="op" id="8533991">.</span><span class="ident" id="8533992">CommonName</span>&nbsp;<span class="op" id="8534003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534008">t</span><span class="op" id="8534009">.</span><span class="ident" id="8534010">Errorf</span><span class="op" id="8534016">(</span><span class="string" id="8534017">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8534094">,</span>&nbsp;<span class="ident" id="8534096">test</span><span class="op" id="8534100">.</span><span class="ident" id="8534101">name</span><span class="op" id="8534105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534109">}</span>&nbsp;<span class="keyword" id="8534111">else</span>&nbsp;<span class="keyword" id="8534116">if</span>&nbsp;<span class="builtinfunc" id="8534119">len</span><span class="op" id="8534122">(</span><span class="ident" id="8534123">out</span><span class="op" id="8534126">.</span><span class="ident" id="8534127">Subject</span><span class="op" id="8534134">.</span><span class="ident" id="8534135">Organization</span><span class="op" id="8534147">)</span>&nbsp;<span class="op" id="8534149">!=</span>&nbsp;<span class="builtinfunc" id="8534152">len</span><span class="op" id="8534155">(</span><span class="ident" id="8534156">template</span><span class="op" id="8534164">.</span><span class="ident" id="8534165">Subject</span><span class="op" id="8534172">.</span><span class="ident" id="8534173">Organization</span><span class="op" id="8534185">)</span>&nbsp;<span class="op" id="8534187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534192">t</span><span class="op" id="8534193">.</span><span class="ident" id="8534194">Errorf</span><span class="op" id="8534200">(</span><span class="string" id="8534201">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8534280">,</span>&nbsp;<span class="ident" id="8534282">test</span><span class="op" id="8534286">.</span><span class="ident" id="8534287">name</span><span class="op" id="8534291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534295">}</span>&nbsp;<span class="keyword" id="8534297">else</span>&nbsp;<span class="keyword" id="8534302">if</span>&nbsp;<span class="builtinfunc" id="8534305">len</span><span class="op" id="8534308">(</span><span class="ident" id="8534309">out</span><span class="op" id="8534312">.</span><span class="ident" id="8534313">DNSNames</span><span class="op" id="8534321">)</span>&nbsp;<span class="op" id="8534323">!=</span>&nbsp;<span class="builtinfunc" id="8534326">len</span><span class="op" id="8534329">(</span><span class="ident" id="8534330">template</span><span class="op" id="8534338">.</span><span class="ident" id="8534339">DNSNames</span><span class="op" id="8534347">)</span>&nbsp;<span class="op" id="8534349">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534354">t</span><span class="op" id="8534355">.</span><span class="ident" id="8534356">Errorf</span><span class="op" id="8534362">(</span><span class="string" id="8534363">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8534420">,</span>&nbsp;<span class="ident" id="8534422">test</span><span class="op" id="8534426">.</span><span class="ident" id="8534427">name</span><span class="op" id="8534431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534435">}</span>&nbsp;<span class="keyword" id="8534437">else</span>&nbsp;<span class="keyword" id="8534442">if</span>&nbsp;<span class="builtinfunc" id="8534445">len</span><span class="op" id="8534448">(</span><span class="ident" id="8534449">out</span><span class="op" id="8534452">.</span><span class="ident" id="8534453">EmailAddresses</span><span class="op" id="8534467">)</span>&nbsp;<span class="op" id="8534469">!=</span>&nbsp;<span class="builtinfunc" id="8534472">len</span><span class="op" id="8534475">(</span><span class="ident" id="8534476">template</span><span class="op" id="8534484">.</span><span class="ident" id="8534485">EmailAddresses</span><span class="op" id="8534499">)</span>&nbsp;<span class="op" id="8534501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534506">t</span><span class="op" id="8534507">.</span><span class="ident" id="8534508">Errorf</span><span class="op" id="8534514">(</span><span class="string" id="8534515">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8534584">,</span>&nbsp;<span class="ident" id="8534586">test</span><span class="op" id="8534590">.</span><span class="ident" id="8534591">name</span><span class="op" id="8534595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534599">}</span>&nbsp;<span class="keyword" id="8534601">else</span>&nbsp;<span class="keyword" id="8534606">if</span>&nbsp;<span class="builtinfunc" id="8534609">len</span><span class="op" id="8534612">(</span><span class="ident" id="8534613">out</span><span class="op" id="8534616">.</span><span class="ident" id="8534617">IPAddresses</span><span class="op" id="8534628">)</span>&nbsp;<span class="op" id="8534630">!=</span>&nbsp;<span class="builtinfunc" id="8534633">len</span><span class="op" id="8534636">(</span><span class="ident" id="8534637">template</span><span class="op" id="8534645">.</span><span class="ident" id="8534646">IPAddresses</span><span class="op" id="8534657">)</span>&nbsp;<span class="op" id="8534659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534664">t</span><span class="op" id="8534665">.</span><span class="ident" id="8534666">Errorf</span><span class="op" id="8534672">(</span><span class="string" id="8534673">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8534742">,</span>&nbsp;<span class="ident" id="8534744">test</span><span class="op" id="8534748">.</span><span class="ident" id="8534749">name</span><span class="op" id="8534753">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534760">}</span><br>
<span class="lineno"></span><span class="op" id="8534762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8534765">func</span>&nbsp;<span class="ident" id="8534770">marshalAndParseCSR</span><span class="op" id="8534788">(</span><span class="ident" id="8534789">t</span>&nbsp;<span class="op" id="8534791">*</span><span class="ident" id="8534792">testing</span><span class="op" id="8534799">.</span><span class="ident" id="8534800">T</span><span class="op" id="8534801">,</span>&nbsp;<span class="ident" id="8534803">template</span>&nbsp;<span class="op" id="8534812">*</span><span class="ident" id="8534813">CertificateRequest</span><span class="op" id="8534831">)</span>&nbsp;<span class="op" id="8534833">*</span><span class="ident" id="8534834">CertificateRequest</span>&nbsp;<span class="op" id="8534853">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534856">block</span><span class="op" id="8534861">,</span>&nbsp;<span class="ident" id="8534863">_</span>&nbsp;<span class="op" id="8534865">:=</span>&nbsp;<span class="ident" id="8534868">pem</span><span class="op" id="8534871">.</span><span class="ident" id="8534872">Decode</span><span class="op" id="8534878">(</span><span class="op" id="8534879">[</span><span class="op" id="8534880">]</span><span class="builtintype" id="8534881">byte</span><span class="op" id="8534885">(</span><span class="ident" id="8534886">pemPrivateKey</span><span class="op" id="8534899">)</span><span class="op" id="8534900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534903">rsaPriv</span><span class="op" id="8534910">,</span>&nbsp;<span class="ident" id="8534912">err</span>&nbsp;<span class="op" id="8534916">:=</span>&nbsp;<span class="ident" id="8534919">ParsePKCS1PrivateKey</span><span class="op" id="8534939">(</span><span class="ident" id="8534940">block</span><span class="op" id="8534945">.</span><span class="ident" id="8534946">Bytes</span><span class="op" id="8534951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534954">if</span>&nbsp;<span class="ident" id="8534957">err</span>&nbsp;<span class="op" id="8534961">!=</span>&nbsp;<span class="ident" id="8534964">nil</span>&nbsp;<span class="op" id="8534968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534972">t</span><span class="op" id="8534973">.</span><span class="ident" id="8534974">Fatal</span><span class="op" id="8534979">(</span><span class="ident" id="8534980">err</span><span class="op" id="8534983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534986">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534990">derBytes</span><span class="op" id="8534998">,</span>&nbsp;<span class="ident" id="8535000">err</span>&nbsp;<span class="op" id="8535004">:=</span>&nbsp;<span class="ident" id="8535007">CreateCertificateRequest</span><span class="op" id="8535031">(</span><span class="ident" id="8535032">rand</span><span class="op" id="8535036">.</span><span class="ident" id="8535037">Reader</span><span class="op" id="8535043">,</span>&nbsp;<span class="ident" id="8535045">template</span><span class="op" id="8535053">,</span>&nbsp;<span class="ident" id="8535055">rsaPriv</span><span class="op" id="8535062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535065">if</span>&nbsp;<span class="ident" id="8535068">err</span>&nbsp;<span class="op" id="8535072">!=</span>&nbsp;<span class="ident" id="8535075">nil</span>&nbsp;<span class="op" id="8535079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535083">t</span><span class="op" id="8535084">.</span><span class="ident" id="8535085">Fatal</span><span class="op" id="8535090">(</span><span class="ident" id="8535091">err</span><span class="op" id="8535094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535097">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535101">csr</span><span class="op" id="8535104">,</span>&nbsp;<span class="ident" id="8535106">err</span>&nbsp;<span class="op" id="8535110">:=</span>&nbsp;<span class="ident" id="8535113">ParseCertificateRequest</span><span class="op" id="8535136">(</span><span class="ident" id="8535137">derBytes</span><span class="op" id="8535145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535148">if</span>&nbsp;<span class="ident" id="8535151">err</span>&nbsp;<span class="op" id="8535155">!=</span>&nbsp;<span class="ident" id="8535158">nil</span>&nbsp;<span class="op" id="8535162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535166">t</span><span class="op" id="8535167">.</span><span class="ident" id="8535168">Fatal</span><span class="op" id="8535173">(</span><span class="ident" id="8535174">err</span><span class="op" id="8535177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535180">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535184">return</span>&nbsp;<span class="ident" id="8535191">csr</span><br>
<span class="lineno"></span><span class="op" id="8535195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535198">func</span>&nbsp;<span class="ident" id="8535203">TestCertificateRequestOverrides</span><span class="op" id="8535234">(</span><span class="ident" id="8535235">t</span>&nbsp;<span class="op" id="8535237">*</span><span class="ident" id="8535238">testing</span><span class="op" id="8535245">.</span><span class="ident" id="8535246">T</span><span class="op" id="8535247">)</span>&nbsp;<span class="op" id="8535249">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535252">sanContents</span><span class="op" id="8535263">,</span>&nbsp;<span class="ident" id="8535265">err</span>&nbsp;<span class="op" id="8535269">:=</span>&nbsp;<span class="ident" id="8535272">marshalSANs</span><span class="op" id="8535283">(</span><span class="op" id="8535284">[</span><span class="op" id="8535285">]</span><span class="builtintype" id="8535286">string</span><span class="op" id="8535292">{</span><span class="string" id="8535293">&#34;foo.example.com&#34;</span><span class="op" id="8535310">}</span><span class="op" id="8535311">,</span>&nbsp;<span class="ident" id="8535313">nil</span><span class="op" id="8535316">,</span>&nbsp;<span class="ident" id="8535318">nil</span><span class="op" id="8535321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535324">if</span>&nbsp;<span class="ident" id="8535327">err</span>&nbsp;<span class="op" id="8535331">!=</span>&nbsp;<span class="ident" id="8535334">nil</span>&nbsp;<span class="op" id="8535338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535342">t</span><span class="op" id="8535343">.</span><span class="ident" id="8535344">Fatal</span><span class="op" id="8535349">(</span><span class="ident" id="8535350">err</span><span class="op" id="8535353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535360">template</span>&nbsp;<span class="op" id="8535369">:=</span>&nbsp;<span class="ident" id="8535372">CertificateRequest</span><span class="op" id="8535390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535394">Subject</span><span class="op" id="8535401">:</span>&nbsp;<span class="ident" id="8535403">pkix</span><span class="op" id="8535407">.</span><span class="ident" id="8535408">Name</span><span class="op" id="8535412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535417">CommonName</span><span class="op" id="8535427">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535431">&#34;test.example.com&#34;</span><span class="op" id="8535449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535454">Organization</span><span class="op" id="8535466">:</span>&nbsp;<span class="op" id="8535468">[</span><span class="op" id="8535469">]</span><span class="builtintype" id="8535470">string</span><span class="op" id="8535476">{</span><span class="string" id="8535477">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8535489">}</span><span class="op" id="8535490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535494">}</span><span class="op" id="8535495">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535499">DNSNames</span><span class="op" id="8535507">:</span>&nbsp;<span class="op" id="8535509">[</span><span class="op" id="8535510">]</span><span class="builtintype" id="8535511">string</span><span class="op" id="8535517">{</span><span class="string" id="8535518">&#34;test.example.com&#34;</span><span class="op" id="8535536">}</span><span class="op" id="8535537">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8535542">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8535607">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535622">ExtraExtensions</span><span class="op" id="8535637">:</span>&nbsp;<span class="op" id="8535639">[</span><span class="op" id="8535640">]</span><span class="ident" id="8535641">pkix</span><span class="op" id="8535645">.</span><span class="ident" id="8535646">Extension</span><span class="op" id="8535655">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535666">Id</span><span class="op" id="8535668">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535673">oidExtensionSubjectAltName</span><span class="op" id="8535699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535705">Value</span><span class="op" id="8535710">:</span>&nbsp;<span class="ident" id="8535712">sanContents</span><span class="op" id="8535723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535728">}</span><span class="op" id="8535729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535733">}</span><span class="op" id="8535734">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535741">csr</span>&nbsp;<span class="op" id="8535745">:=</span>&nbsp;<span class="ident" id="8535748">marshalAndParseCSR</span><span class="op" id="8535766">(</span><span class="ident" id="8535767">t</span><span class="op" id="8535768">,</span>&nbsp;<span class="op" id="8535770">&amp;</span><span class="ident" id="8535771">template</span><span class="op" id="8535779">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535783">if</span>&nbsp;<span class="builtinfunc" id="8535786">len</span><span class="op" id="8535789">(</span><span class="ident" id="8535790">csr</span><span class="op" id="8535793">.</span><span class="ident" id="8535794">DNSNames</span><span class="op" id="8535802">)</span>&nbsp;<span class="op" id="8535804">!=</span>&nbsp;<span class="num" id="8535807">1</span>&nbsp;<span class="op" id="8535809">||</span>&nbsp;<span class="ident" id="8535812">csr</span><span class="op" id="8535815">.</span><span class="ident" id="8535816">DNSNames</span><span class="op" id="8535824">[</span><span class="num" id="8535825">0</span><span class="op" id="8535826">]</span>&nbsp;<span class="op" id="8535828">!=</span>&nbsp;<span class="string" id="8535831">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="8535849">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535853">t</span><span class="op" id="8535854">.</span><span class="ident" id="8535855">Errorf</span><span class="op" id="8535861">(</span><span class="string" id="8535862">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="8535909">,</span>&nbsp;<span class="ident" id="8535911">csr</span><span class="op" id="8535914">.</span><span class="ident" id="8535915">DNSNames</span><span class="op" id="8535923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8535930">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8535998">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8536068">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536104">template</span><span class="op" id="8536112">.</span><span class="ident" id="8536113">Attributes</span>&nbsp;<span class="op" id="8536124">=</span>&nbsp;<span class="op" id="8536126">[</span><span class="op" id="8536127">]</span><span class="ident" id="8536128">pkix</span><span class="op" id="8536132">.</span><span class="ident" id="8536133">AttributeTypeAndValueSET</span><span class="op" id="8536157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536166">Type</span><span class="op" id="8536170">:</span>&nbsp;<span class="ident" id="8536172">oidExtensionRequest</span><span class="op" id="8536191">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536196">Value</span><span class="op" id="8536201">:</span>&nbsp;<span class="op" id="8536203">[</span><span class="op" id="8536204">]</span><span class="op" id="8536205">[</span><span class="op" id="8536206">]</span><span class="ident" id="8536207">pkix</span><span class="op" id="8536211">.</span><span class="ident" id="8536212">AttributeTypeAndValue</span><span class="op" id="8536233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536254">Type</span><span class="op" id="8536258">:</span>&nbsp;&nbsp;<span class="ident" id="8536261">oidExtensionAuthorityInfoAccess</span><span class="op" id="8536292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536300">Value</span><span class="op" id="8536305">:</span>&nbsp;<span class="op" id="8536307">[</span><span class="op" id="8536308">]</span><span class="builtintype" id="8536309">byte</span><span class="op" id="8536313">(</span><span class="string" id="8536314">&#34;foo&#34;</span><span class="op" id="8536319">)</span><span class="op" id="8536320">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536327">}</span><span class="op" id="8536328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536334">}</span><span class="op" id="8536335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536340">}</span><span class="op" id="8536341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536345">}</span><span class="op" id="8536346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536349">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536353">csr</span>&nbsp;<span class="op" id="8536357">=</span>&nbsp;<span class="ident" id="8536359">marshalAndParseCSR</span><span class="op" id="8536377">(</span><span class="ident" id="8536378">t</span><span class="op" id="8536379">,</span>&nbsp;<span class="op" id="8536381">&amp;</span><span class="ident" id="8536382">template</span><span class="op" id="8536390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536393">if</span>&nbsp;<span class="ident" id="8536396">l</span>&nbsp;<span class="op" id="8536398">:=</span>&nbsp;<span class="builtinfunc" id="8536401">len</span><span class="op" id="8536404">(</span><span class="ident" id="8536405">csr</span><span class="op" id="8536408">.</span><span class="ident" id="8536409">Attributes</span><span class="op" id="8536419">)</span><span class="op" id="8536420">;</span>&nbsp;<span class="ident" id="8536422">l</span>&nbsp;<span class="op" id="8536424">!=</span>&nbsp;<span class="num" id="8536427">1</span>&nbsp;<span class="op" id="8536429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536433">t</span><span class="op" id="8536434">.</span><span class="ident" id="8536435">Errorf</span><span class="op" id="8536441">(</span><span class="string" id="8536442">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="8536480">,</span>&nbsp;<span class="ident" id="8536482">l</span><span class="op" id="8536483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536486">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536490">if</span>&nbsp;<span class="op" id="8536493">!</span><span class="ident" id="8536494">csr</span><span class="op" id="8536497">.</span><span class="ident" id="8536498">Attributes</span><span class="op" id="8536508">[</span><span class="num" id="8536509">0</span><span class="op" id="8536510">]</span><span class="op" id="8536511">.</span><span class="ident" id="8536512">Type</span><span class="op" id="8536516">.</span><span class="ident" id="8536517">Equal</span><span class="op" id="8536522">(</span><span class="ident" id="8536523">oidExtensionRequest</span><span class="op" id="8536542">)</span>&nbsp;<span class="op" id="8536544">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8536549">len</span><span class="op" id="8536552">(</span><span class="ident" id="8536553">csr</span><span class="op" id="8536556">.</span><span class="ident" id="8536557">Attributes</span><span class="op" id="8536567">[</span><span class="num" id="8536568">0</span><span class="op" id="8536569">]</span><span class="op" id="8536570">.</span><span class="ident" id="8536571">Value</span><span class="op" id="8536576">)</span>&nbsp;<span class="op" id="8536578">!=</span>&nbsp;<span class="num" id="8536581">1</span>&nbsp;<span class="op" id="8536583">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8536588">len</span><span class="op" id="8536591">(</span><span class="ident" id="8536592">csr</span><span class="op" id="8536595">.</span><span class="ident" id="8536596">Attributes</span><span class="op" id="8536606">[</span><span class="num" id="8536607">0</span><span class="op" id="8536608">]</span><span class="op" id="8536609">.</span><span class="ident" id="8536610">Value</span><span class="op" id="8536615">[</span><span class="num" id="8536616">0</span><span class="op" id="8536617">]</span><span class="op" id="8536618">)</span>&nbsp;<span class="op" id="8536620">!=</span>&nbsp;<span class="num" id="8536623">2</span>&nbsp;<span class="op" id="8536625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536629">t</span><span class="op" id="8536630">.</span><span class="ident" id="8536631">Errorf</span><span class="op" id="8536637">(</span><span class="string" id="8536638">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="8536661">,</span>&nbsp;<span class="ident" id="8536663">csr</span><span class="op" id="8536666">.</span><span class="ident" id="8536667">Attributes</span><span class="op" id="8536677">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536684">sanContents2</span><span class="op" id="8536696">,</span>&nbsp;<span class="ident" id="8536698">err</span>&nbsp;<span class="op" id="8536702">:=</span>&nbsp;<span class="ident" id="8536705">marshalSANs</span><span class="op" id="8536716">(</span><span class="op" id="8536717">[</span><span class="op" id="8536718">]</span><span class="builtintype" id="8536719">string</span><span class="op" id="8536725">{</span><span class="string" id="8536726">&#34;foo2.example.com&#34;</span><span class="op" id="8536744">}</span><span class="op" id="8536745">,</span>&nbsp;<span class="ident" id="8536747">nil</span><span class="op" id="8536750">,</span>&nbsp;<span class="ident" id="8536752">nil</span><span class="op" id="8536755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536758">if</span>&nbsp;<span class="ident" id="8536761">err</span>&nbsp;<span class="op" id="8536765">!=</span>&nbsp;<span class="ident" id="8536768">nil</span>&nbsp;<span class="op" id="8536772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536776">t</span><span class="op" id="8536777">.</span><span class="ident" id="8536778">Fatal</span><span class="op" id="8536783">(</span><span class="ident" id="8536784">err</span><span class="op" id="8536787">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8536794">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536865">template</span><span class="op" id="8536873">.</span><span class="ident" id="8536874">Attributes</span><span class="op" id="8536884">[</span><span class="num" id="8536885">0</span><span class="op" id="8536886">]</span><span class="op" id="8536887">.</span><span class="ident" id="8536888">Value</span><span class="op" id="8536893">[</span><span class="num" id="8536894">0</span><span class="op" id="8536895">]</span>&nbsp;<span class="op" id="8536897">=</span>&nbsp;<span class="builtinfunc" id="8536899">append</span><span class="op" id="8536905">(</span><span class="ident" id="8536906">template</span><span class="op" id="8536914">.</span><span class="ident" id="8536915">Attributes</span><span class="op" id="8536925">[</span><span class="num" id="8536926">0</span><span class="op" id="8536927">]</span><span class="op" id="8536928">.</span><span class="ident" id="8536929">Value</span><span class="op" id="8536934">[</span><span class="num" id="8536935">0</span><span class="op" id="8536936">]</span><span class="op" id="8536937">,</span>&nbsp;<span class="ident" id="8536939">pkix</span><span class="op" id="8536943">.</span><span class="ident" id="8536944">AttributeTypeAndValue</span><span class="op" id="8536965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536969">Type</span><span class="op" id="8536973">:</span>&nbsp;&nbsp;<span class="ident" id="8536976">oidExtensionSubjectAltName</span><span class="op" id="8537002">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537006">Value</span><span class="op" id="8537011">:</span>&nbsp;<span class="ident" id="8537013">sanContents2</span><span class="op" id="8537025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537028">}</span><span class="op" id="8537029">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537033">csr</span>&nbsp;<span class="op" id="8537037">=</span>&nbsp;<span class="ident" id="8537039">marshalAndParseCSR</span><span class="op" id="8537057">(</span><span class="ident" id="8537058">t</span><span class="op" id="8537059">,</span>&nbsp;<span class="op" id="8537061">&amp;</span><span class="ident" id="8537062">template</span><span class="op" id="8537070">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537074">if</span>&nbsp;<span class="builtinfunc" id="8537077">len</span><span class="op" id="8537080">(</span><span class="ident" id="8537081">csr</span><span class="op" id="8537084">.</span><span class="ident" id="8537085">DNSNames</span><span class="op" id="8537093">)</span>&nbsp;<span class="op" id="8537095">!=</span>&nbsp;<span class="num" id="8537098">1</span>&nbsp;<span class="op" id="8537100">||</span>&nbsp;<span class="ident" id="8537103">csr</span><span class="op" id="8537106">.</span><span class="ident" id="8537107">DNSNames</span><span class="op" id="8537115">[</span><span class="num" id="8537116">0</span><span class="op" id="8537117">]</span>&nbsp;<span class="op" id="8537119">!=</span>&nbsp;<span class="string" id="8537122">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="8537141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537145">t</span><span class="op" id="8537146">.</span><span class="ident" id="8537147">Errorf</span><span class="op" id="8537153">(</span><span class="string" id="8537154">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="8537209">,</span>&nbsp;<span class="ident" id="8537211">csr</span><span class="op" id="8537214">.</span><span class="ident" id="8537215">DNSNames</span><span class="op" id="8537223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537226">}</span><br>
<span class="lineno"></span><span class="op" id="8537228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="8537231">func</span>&nbsp;<span class="ident" id="8537236">TestParseCertificateRequest</span><span class="op" id="8537263">(</span><span class="ident" id="8537264">t</span>&nbsp;<span class="op" id="8537266">*</span><span class="ident" id="8537267">testing</span><span class="op" id="8537274">.</span><span class="ident" id="8537275">T</span><span class="op" id="8537276">)</span>&nbsp;<span class="op" id="8537278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537281">csrBytes</span>&nbsp;<span class="op" id="8537290">:=</span>&nbsp;<span class="ident" id="8537293">fromBase64</span><span class="op" id="8537303">(</span><span class="ident" id="8537304">csrBase64</span><span class="op" id="8537313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537316">csr</span><span class="op" id="8537319">,</span>&nbsp;<span class="ident" id="8537321">err</span>&nbsp;<span class="op" id="8537325">:=</span>&nbsp;<span class="ident" id="8537328">ParseCertificateRequest</span><span class="op" id="8537351">(</span><span class="ident" id="8537352">csrBytes</span><span class="op" id="8537360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537363">if</span>&nbsp;<span class="ident" id="8537366">err</span>&nbsp;<span class="op" id="8537370">!=</span>&nbsp;<span class="ident" id="8537373">nil</span>&nbsp;<span class="op" id="8537377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537381">t</span><span class="op" id="8537382">.</span><span class="ident" id="8537383">Fatalf</span><span class="op" id="8537389">(</span><span class="string" id="8537390">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="8537415">,</span>&nbsp;<span class="ident" id="8537417">err</span><span class="op" id="8537420">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537427">if</span>&nbsp;<span class="builtinfunc" id="8537430">len</span><span class="op" id="8537433">(</span><span class="ident" id="8537434">csr</span><span class="op" id="8537437">.</span><span class="ident" id="8537438">EmailAddresses</span><span class="op" id="8537452">)</span>&nbsp;<span class="op" id="8537454">!=</span>&nbsp;<span class="num" id="8537457">1</span>&nbsp;<span class="op" id="8537459">||</span>&nbsp;<span class="ident" id="8537462">csr</span><span class="op" id="8537465">.</span><span class="ident" id="8537466">EmailAddresses</span><span class="op" id="8537480">[</span><span class="num" id="8537481">0</span><span class="op" id="8537482">]</span>&nbsp;<span class="op" id="8537484">!=</span>&nbsp;<span class="string" id="8537487">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="8537507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537511">t</span><span class="op" id="8537512">.</span><span class="ident" id="8537513">Errorf</span><span class="op" id="8537519">(</span><span class="string" id="8537520">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="8537557">,</span>&nbsp;<span class="ident" id="8537559">csr</span><span class="op" id="8537562">.</span><span class="ident" id="8537563">EmailAddresses</span><span class="op" id="8537577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537580">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537584">if</span>&nbsp;<span class="builtinfunc" id="8537587">len</span><span class="op" id="8537590">(</span><span class="ident" id="8537591">csr</span><span class="op" id="8537594">.</span><span class="ident" id="8537595">DNSNames</span><span class="op" id="8537603">)</span>&nbsp;<span class="op" id="8537605">!=</span>&nbsp;<span class="num" id="8537608">1</span>&nbsp;<span class="op" id="8537610">||</span>&nbsp;<span class="ident" id="8537613">csr</span><span class="op" id="8537616">.</span><span class="ident" id="8537617">DNSNames</span><span class="op" id="8537625">[</span><span class="num" id="8537626">0</span><span class="op" id="8537627">]</span>&nbsp;<span class="op" id="8537629">!=</span>&nbsp;<span class="string" id="8537632">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="8537651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537655">t</span><span class="op" id="8537656">.</span><span class="ident" id="8537657">Errorf</span><span class="op" id="8537663">(</span><span class="string" id="8537664">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="8537695">,</span>&nbsp;<span class="ident" id="8537697">csr</span><span class="op" id="8537700">.</span><span class="ident" id="8537701">DNSNames</span><span class="op" id="8537709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537716">if</span>&nbsp;<span class="builtinfunc" id="8537719">len</span><span class="op" id="8537722">(</span><span class="ident" id="8537723">csr</span><span class="op" id="8537726">.</span><span class="ident" id="8537727">Subject</span><span class="op" id="8537734">.</span><span class="ident" id="8537735">Country</span><span class="op" id="8537742">)</span>&nbsp;<span class="op" id="8537744">!=</span>&nbsp;<span class="num" id="8537747">1</span>&nbsp;<span class="op" id="8537749">||</span>&nbsp;<span class="ident" id="8537752">csr</span><span class="op" id="8537755">.</span><span class="ident" id="8537756">Subject</span><span class="op" id="8537763">.</span><span class="ident" id="8537764">Country</span><span class="op" id="8537771">[</span><span class="num" id="8537772">0</span><span class="op" id="8537773">]</span>&nbsp;<span class="op" id="8537775">!=</span>&nbsp;<span class="string" id="8537778">&#34;AU&#34;</span>&nbsp;<span class="op" id="8537783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537787">t</span><span class="op" id="8537788">.</span><span class="ident" id="8537789">Errorf</span><span class="op" id="8537795">(</span><span class="string" id="8537796">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8537824">,</span>&nbsp;<span class="ident" id="8537826">csr</span><span class="op" id="8537829">.</span><span class="ident" id="8537830">Subject</span><span class="op" id="8537837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537844">found</span>&nbsp;<span class="op" id="8537850">:=</span>&nbsp;<span class="builtintype" id="8537853">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537860">for</span>&nbsp;<span class="ident" id="8537864">_</span><span class="op" id="8537865">,</span>&nbsp;<span class="ident" id="8537867">e</span>&nbsp;<span class="op" id="8537869">:=</span>&nbsp;<span class="keyword" id="8537872">range</span>&nbsp;<span class="ident" id="8537878">csr</span><span class="op" id="8537881">.</span><span class="ident" id="8537882">Extensions</span>&nbsp;<span class="op" id="8537893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537897">if</span>&nbsp;<span class="ident" id="8537900">e</span><span class="op" id="8537901">.</span><span class="ident" id="8537902">Id</span><span class="op" id="8537904">.</span><span class="ident" id="8537905">Equal</span><span class="op" id="8537910">(</span><span class="ident" id="8537911">oidExtensionBasicConstraints</span><span class="op" id="8537939">)</span>&nbsp;<span class="op" id="8537941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537946">found</span>&nbsp;<span class="op" id="8537952">=</span>&nbsp;<span class="builtintype" id="8537954">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537962">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537970">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537976">if</span>&nbsp;<span class="op" id="8537979">!</span><span class="ident" id="8537980">found</span>&nbsp;<span class="op" id="8537986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537990">t</span><span class="op" id="8537991">.</span><span class="ident" id="8537992">Errorf</span><span class="op" id="8537998">(</span><span class="string" id="8537999">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="8538045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538048">}</span><br>
<span class="lineno"></span><span class="op" id="8538050">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="8538053">func</span>&nbsp;<span class="ident" id="8538058">TestMaxPathLen</span><span class="op" id="8538072">(</span><span class="ident" id="8538073">t</span>&nbsp;<span class="op" id="8538075">*</span><span class="ident" id="8538076">testing</span><span class="op" id="8538083">.</span><span class="ident" id="8538084">T</span><span class="op" id="8538085">)</span>&nbsp;<span class="op" id="8538087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538090">block</span><span class="op" id="8538095">,</span>&nbsp;<span class="ident" id="8538097">_</span>&nbsp;<span class="op" id="8538099">:=</span>&nbsp;<span class="ident" id="8538102">pem</span><span class="op" id="8538105">.</span><span class="ident" id="8538106">Decode</span><span class="op" id="8538112">(</span><span class="op" id="8538113">[</span><span class="op" id="8538114">]</span><span class="builtintype" id="8538115">byte</span><span class="op" id="8538119">(</span><span class="ident" id="8538120">pemPrivateKey</span><span class="op" id="8538133">)</span><span class="op" id="8538134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538137">rsaPriv</span><span class="op" id="8538144">,</span>&nbsp;<span class="ident" id="8538146">err</span>&nbsp;<span class="op" id="8538150">:=</span>&nbsp;<span class="ident" id="8538153">ParsePKCS1PrivateKey</span><span class="op" id="8538173">(</span><span class="ident" id="8538174">block</span><span class="op" id="8538179">.</span><span class="ident" id="8538180">Bytes</span><span class="op" id="8538185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538188">if</span>&nbsp;<span class="ident" id="8538191">err</span>&nbsp;<span class="op" id="8538195">!=</span>&nbsp;<span class="ident" id="8538198">nil</span>&nbsp;<span class="op" id="8538202">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538206">t</span><span class="op" id="8538207">.</span><span class="ident" id="8538208">Fatalf</span><span class="op" id="8538214">(</span><span class="string" id="8538215">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8538248">,</span>&nbsp;<span class="ident" id="8538250">err</span><span class="op" id="8538253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538260">template</span>&nbsp;<span class="op" id="8538269">:=</span>&nbsp;<span class="op" id="8538272">&amp;</span><span class="ident" id="8538273">Certificate</span><span class="op" id="8538284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538288">SerialNumber</span><span class="op" id="8538300">:</span>&nbsp;<span class="ident" id="8538302">big</span><span class="op" id="8538305">.</span><span class="ident" id="8538306">NewInt</span><span class="op" id="8538312">(</span><span class="num" id="8538313">1</span><span class="op" id="8538314">)</span><span class="op" id="8538315">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538319">Subject</span><span class="op" id="8538326">:</span>&nbsp;<span class="ident" id="8538328">pkix</span><span class="op" id="8538332">.</span><span class="ident" id="8538333">Name</span><span class="op" id="8538337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538342">CommonName</span><span class="op" id="8538352">:</span>&nbsp;<span class="string" id="8538354">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8538366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538370">}</span><span class="op" id="8538371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538375">NotBefore</span><span class="op" id="8538384">:</span>&nbsp;<span class="ident" id="8538386">time</span><span class="op" id="8538390">.</span><span class="ident" id="8538391">Unix</span><span class="op" id="8538395">(</span><span class="num" id="8538396">1000</span><span class="op" id="8538400">,</span>&nbsp;<span class="num" id="8538402">0</span><span class="op" id="8538403">)</span><span class="op" id="8538404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538408">NotAfter</span><span class="op" id="8538416">:</span>&nbsp;&nbsp;<span class="ident" id="8538419">time</span><span class="op" id="8538423">.</span><span class="ident" id="8538424">Unix</span><span class="op" id="8538428">(</span><span class="num" id="8538429">100000</span><span class="op" id="8538435">,</span>&nbsp;<span class="num" id="8538437">0</span><span class="op" id="8538438">)</span><span class="op" id="8538439">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538444">BasicConstraintsValid</span><span class="op" id="8538465">:</span>&nbsp;<span class="builtintype" id="8538467">true</span><span class="op" id="8538471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538475">IsCA</span><span class="op" id="8538479">:</span>&nbsp;<span class="builtintype" id="8538481">true</span><span class="op" id="8538485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538492">serialiseAndParse</span>&nbsp;<span class="op" id="8538510">:=</span>&nbsp;<span class="keyword" id="8538513">func</span><span class="op" id="8538517">(</span><span class="ident" id="8538518">template</span>&nbsp;<span class="op" id="8538527">*</span><span class="ident" id="8538528">Certificate</span><span class="op" id="8538539">)</span>&nbsp;<span class="op" id="8538541">*</span><span class="ident" id="8538542">Certificate</span>&nbsp;<span class="op" id="8538554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538558">derBytes</span><span class="op" id="8538566">,</span>&nbsp;<span class="ident" id="8538568">err</span>&nbsp;<span class="op" id="8538572">:=</span>&nbsp;<span class="ident" id="8538575">CreateCertificate</span><span class="op" id="8538592">(</span><span class="ident" id="8538593">rand</span><span class="op" id="8538597">.</span><span class="ident" id="8538598">Reader</span><span class="op" id="8538604">,</span>&nbsp;<span class="ident" id="8538606">template</span><span class="op" id="8538614">,</span>&nbsp;<span class="ident" id="8538616">template</span><span class="op" id="8538624">,</span>&nbsp;<span class="op" id="8538626">&amp;</span><span class="ident" id="8538627">rsaPriv</span><span class="op" id="8538634">.</span><span class="ident" id="8538635">PublicKey</span><span class="op" id="8538644">,</span>&nbsp;<span class="ident" id="8538646">rsaPriv</span><span class="op" id="8538653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538657">if</span>&nbsp;<span class="ident" id="8538660">err</span>&nbsp;<span class="op" id="8538664">!=</span>&nbsp;<span class="ident" id="8538667">nil</span>&nbsp;<span class="op" id="8538671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538676">t</span><span class="op" id="8538677">.</span><span class="ident" id="8538678">Fatalf</span><span class="op" id="8538684">(</span><span class="string" id="8538685">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8538719">,</span>&nbsp;<span class="ident" id="8538721">err</span><span class="op" id="8538724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538729">return</span>&nbsp;<span class="ident" id="8538736">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538747">cert</span><span class="op" id="8538751">,</span>&nbsp;<span class="ident" id="8538753">err</span>&nbsp;<span class="op" id="8538757">:=</span>&nbsp;<span class="ident" id="8538760">ParseCertificate</span><span class="op" id="8538776">(</span><span class="ident" id="8538777">derBytes</span><span class="op" id="8538785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538789">if</span>&nbsp;<span class="ident" id="8538792">err</span>&nbsp;<span class="op" id="8538796">!=</span>&nbsp;<span class="ident" id="8538799">nil</span>&nbsp;<span class="op" id="8538803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538808">t</span><span class="op" id="8538809">.</span><span class="ident" id="8538810">Fatalf</span><span class="op" id="8538816">(</span><span class="string" id="8538817">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8538850">,</span>&nbsp;<span class="ident" id="8538852">err</span><span class="op" id="8538855">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538860">return</span>&nbsp;<span class="ident" id="8538867">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538878">return</span>&nbsp;<span class="ident" id="8538885">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538891">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538895">cert1</span>&nbsp;<span class="op" id="8538901">:=</span>&nbsp;<span class="ident" id="8538904">serialiseAndParse</span><span class="op" id="8538921">(</span><span class="ident" id="8538922">template</span><span class="op" id="8538930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538933">if</span>&nbsp;<span class="ident" id="8538936">m</span>&nbsp;<span class="op" id="8538938">:=</span>&nbsp;<span class="ident" id="8538941">cert1</span><span class="op" id="8538946">.</span><span class="ident" id="8538947">MaxPathLen</span><span class="op" id="8538957">;</span>&nbsp;<span class="ident" id="8538959">m</span>&nbsp;<span class="op" id="8538961">!=</span>&nbsp;<span class="op" id="8538964">-</span><span class="num" id="8538965">1</span>&nbsp;<span class="op" id="8538967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538971">t</span><span class="op" id="8538972">.</span><span class="ident" id="8538973">Errorf</span><span class="op" id="8538979">(</span><span class="string" id="8538980">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8539029">,</span>&nbsp;<span class="ident" id="8539031">m</span><span class="op" id="8539032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539035">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539038">if</span>&nbsp;<span class="ident" id="8539041">cert1</span><span class="op" id="8539046">.</span><span class="ident" id="8539047">MaxPathLenZero</span>&nbsp;<span class="op" id="8539062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539066">t</span><span class="op" id="8539067">.</span><span class="ident" id="8539068">Errorf</span><span class="op" id="8539074">(</span><span class="string" id="8539075">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8539123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539130">template</span><span class="op" id="8539138">.</span><span class="ident" id="8539139">MaxPathLen</span>&nbsp;<span class="op" id="8539150">=</span>&nbsp;<span class="num" id="8539152">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539155">cert2</span>&nbsp;<span class="op" id="8539161">:=</span>&nbsp;<span class="ident" id="8539164">serialiseAndParse</span><span class="op" id="8539181">(</span><span class="ident" id="8539182">template</span><span class="op" id="8539190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539193">if</span>&nbsp;<span class="ident" id="8539196">m</span>&nbsp;<span class="op" id="8539198">:=</span>&nbsp;<span class="ident" id="8539201">cert2</span><span class="op" id="8539206">.</span><span class="ident" id="8539207">MaxPathLen</span><span class="op" id="8539217">;</span>&nbsp;<span class="ident" id="8539219">m</span>&nbsp;<span class="op" id="8539221">!=</span>&nbsp;<span class="num" id="8539224">1</span>&nbsp;<span class="op" id="8539226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539230">t</span><span class="op" id="8539231">.</span><span class="ident" id="8539232">Errorf</span><span class="op" id="8539238">(</span><span class="string" id="8539239">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="8539289">,</span>&nbsp;<span class="ident" id="8539291">m</span><span class="op" id="8539292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539298">if</span>&nbsp;<span class="ident" id="8539301">cert2</span><span class="op" id="8539306">.</span><span class="ident" id="8539307">MaxPathLenZero</span>&nbsp;<span class="op" id="8539322">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539326">t</span><span class="op" id="8539327">.</span><span class="ident" id="8539328">Errorf</span><span class="op" id="8539334">(</span><span class="string" id="8539335">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8539382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539389">template</span><span class="op" id="8539397">.</span><span class="ident" id="8539398">MaxPathLen</span>&nbsp;<span class="op" id="8539409">=</span>&nbsp;<span class="num" id="8539411">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539414">template</span><span class="op" id="8539422">.</span><span class="ident" id="8539423">MaxPathLenZero</span>&nbsp;<span class="op" id="8539438">=</span>&nbsp;<span class="builtintype" id="8539440">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539446">cert3</span>&nbsp;<span class="op" id="8539452">:=</span>&nbsp;<span class="ident" id="8539455">serialiseAndParse</span><span class="op" id="8539472">(</span><span class="ident" id="8539473">template</span><span class="op" id="8539481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539484">if</span>&nbsp;<span class="ident" id="8539487">m</span>&nbsp;<span class="op" id="8539489">:=</span>&nbsp;<span class="ident" id="8539492">cert3</span><span class="op" id="8539497">.</span><span class="ident" id="8539498">MaxPathLen</span><span class="op" id="8539508">;</span>&nbsp;<span class="ident" id="8539510">m</span>&nbsp;<span class="op" id="8539512">!=</span>&nbsp;<span class="num" id="8539515">0</span>&nbsp;<span class="op" id="8539517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539521">t</span><span class="op" id="8539522">.</span><span class="ident" id="8539523">Errorf</span><span class="op" id="8539529">(</span><span class="string" id="8539530">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8539574">,</span>&nbsp;<span class="ident" id="8539576">m</span><span class="op" id="8539577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539583">if</span>&nbsp;<span class="op" id="8539586">!</span><span class="ident" id="8539587">cert3</span><span class="op" id="8539592">.</span><span class="ident" id="8539593">MaxPathLenZero</span>&nbsp;<span class="op" id="8539608">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539612">t</span><span class="op" id="8539613">.</span><span class="ident" id="8539614">Errorf</span><span class="op" id="8539620">(</span><span class="string" id="8539621">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8539681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539684">}</span><br>
<span class="lineno"></span><span class="op" id="8539686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8539689">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="8539729">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="8539830">//</span><br>
<span class="lineno"></span><span class="comment" id="8539833">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="8539883">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="8539899">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="8539932">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="8539998">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="8540065">const</span>&nbsp;<span class="ident" id="8540071">csrBase64</span>&nbsp;<span class="op" id="8540081">=</span>&nbsp;<span class="string" id="8540083">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
