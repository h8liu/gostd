<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html" class="current">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8176180">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8176236">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8176290">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8176341">package</span>&nbsp;<span class="ident" id="8176349">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8176355">import</span>&nbsp;<span class="op" id="8176362">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176365">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176374">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176391">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176398">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176405">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176411">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176422">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176433">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176444">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8176451">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8176454">var</span>&nbsp;<span class="ident" id="8176458">writeSetCookiesTests</span>&nbsp;<span class="op" id="8176479">=</span>&nbsp;<span class="op" id="8176481">[</span><span class="op" id="8176482">]</span><span class="keyword" id="8176483">struct</span>&nbsp;<span class="op" id="8176490">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176493">Cookie</span>&nbsp;<span class="op" id="8176500">*</span><span class="ident" id="8176501">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176509">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8176516">string</span><br>
<span class="lineno"></span><span class="op" id="8176523">}</span><span class="op" id="8176524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176531">&amp;</span><span class="ident" id="8176532">Cookie</span><span class="op" id="8176538">{</span><span class="ident" id="8176539">Name</span><span class="op" id="8176543">:</span>&nbsp;<span class="string" id="8176545">&#34;cookie-1&#34;</span><span class="op" id="8176555">,</span>&nbsp;<span class="ident" id="8176557">Value</span><span class="op" id="8176562">:</span>&nbsp;<span class="string" id="8176564">&#34;v$1&#34;</span><span class="op" id="8176569">}</span><span class="op" id="8176570">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176574">&#34;cookie-1=v$1&#34;</span><span class="op" id="8176588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176591">}</span><span class="op" id="8176592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176599">&amp;</span><span class="ident" id="8176600">Cookie</span><span class="op" id="8176606">{</span><span class="ident" id="8176607">Name</span><span class="op" id="8176611">:</span>&nbsp;<span class="string" id="8176613">&#34;cookie-2&#34;</span><span class="op" id="8176623">,</span>&nbsp;<span class="ident" id="8176625">Value</span><span class="op" id="8176630">:</span>&nbsp;<span class="string" id="8176632">&#34;two&#34;</span><span class="op" id="8176637">,</span>&nbsp;<span class="ident" id="8176639">MaxAge</span><span class="op" id="8176645">:</span>&nbsp;<span class="num" id="8176647">3600</span><span class="op" id="8176651">}</span><span class="op" id="8176652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176656">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="8176684">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176687">}</span><span class="op" id="8176688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176695">&amp;</span><span class="ident" id="8176696">Cookie</span><span class="op" id="8176702">{</span><span class="ident" id="8176703">Name</span><span class="op" id="8176707">:</span>&nbsp;<span class="string" id="8176709">&#34;cookie-3&#34;</span><span class="op" id="8176719">,</span>&nbsp;<span class="ident" id="8176721">Value</span><span class="op" id="8176726">:</span>&nbsp;<span class="string" id="8176728">&#34;three&#34;</span><span class="op" id="8176735">,</span>&nbsp;<span class="ident" id="8176737">Domain</span><span class="op" id="8176743">:</span>&nbsp;<span class="string" id="8176745">&#34;.example.com&#34;</span><span class="op" id="8176759">}</span><span class="op" id="8176760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176764">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="8176800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176803">}</span><span class="op" id="8176804">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176811">&amp;</span><span class="ident" id="8176812">Cookie</span><span class="op" id="8176818">{</span><span class="ident" id="8176819">Name</span><span class="op" id="8176823">:</span>&nbsp;<span class="string" id="8176825">&#34;cookie-4&#34;</span><span class="op" id="8176835">,</span>&nbsp;<span class="ident" id="8176837">Value</span><span class="op" id="8176842">:</span>&nbsp;<span class="string" id="8176844">&#34;four&#34;</span><span class="op" id="8176850">,</span>&nbsp;<span class="ident" id="8176852">Path</span><span class="op" id="8176856">:</span>&nbsp;<span class="string" id="8176858">&#34;/restricted/&#34;</span><span class="op" id="8176872">}</span><span class="op" id="8176873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176877">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="8176911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176914">}</span><span class="op" id="8176915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176918">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176922">&amp;</span><span class="ident" id="8176923">Cookie</span><span class="op" id="8176929">{</span><span class="ident" id="8176930">Name</span><span class="op" id="8176934">:</span>&nbsp;<span class="string" id="8176936">&#34;cookie-5&#34;</span><span class="op" id="8176946">,</span>&nbsp;<span class="ident" id="8176948">Value</span><span class="op" id="8176953">:</span>&nbsp;<span class="string" id="8176955">&#34;five&#34;</span><span class="op" id="8176961">,</span>&nbsp;<span class="ident" id="8176963">Domain</span><span class="op" id="8176969">:</span>&nbsp;<span class="string" id="8176971">&#34;wrong;bad.abc&#34;</span><span class="op" id="8176986">}</span><span class="op" id="8176987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176991">&#34;cookie-5=five&#34;</span><span class="op" id="8177006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177009">}</span><span class="op" id="8177010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177017">&amp;</span><span class="ident" id="8177018">Cookie</span><span class="op" id="8177024">{</span><span class="ident" id="8177025">Name</span><span class="op" id="8177029">:</span>&nbsp;<span class="string" id="8177031">&#34;cookie-6&#34;</span><span class="op" id="8177041">,</span>&nbsp;<span class="ident" id="8177043">Value</span><span class="op" id="8177048">:</span>&nbsp;<span class="string" id="8177050">&#34;six&#34;</span><span class="op" id="8177055">,</span>&nbsp;<span class="ident" id="8177057">Domain</span><span class="op" id="8177063">:</span>&nbsp;<span class="string" id="8177065">&#34;bad-.abc&#34;</span><span class="op" id="8177075">}</span><span class="op" id="8177076">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177080">&#34;cookie-6=six&#34;</span><span class="op" id="8177094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177097">}</span><span class="op" id="8177098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177105">&amp;</span><span class="ident" id="8177106">Cookie</span><span class="op" id="8177112">{</span><span class="ident" id="8177113">Name</span><span class="op" id="8177117">:</span>&nbsp;<span class="string" id="8177119">&#34;cookie-7&#34;</span><span class="op" id="8177129">,</span>&nbsp;<span class="ident" id="8177131">Value</span><span class="op" id="8177136">:</span>&nbsp;<span class="string" id="8177138">&#34;seven&#34;</span><span class="op" id="8177145">,</span>&nbsp;<span class="ident" id="8177147">Domain</span><span class="op" id="8177153">:</span>&nbsp;<span class="string" id="8177155">&#34;127.0.0.1&#34;</span><span class="op" id="8177166">}</span><span class="op" id="8177167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177171">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="8177205">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177208">}</span><span class="op" id="8177209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177216">&amp;</span><span class="ident" id="8177217">Cookie</span><span class="op" id="8177223">{</span><span class="ident" id="8177224">Name</span><span class="op" id="8177228">:</span>&nbsp;<span class="string" id="8177230">&#34;cookie-8&#34;</span><span class="op" id="8177240">,</span>&nbsp;<span class="ident" id="8177242">Value</span><span class="op" id="8177247">:</span>&nbsp;<span class="string" id="8177249">&#34;eight&#34;</span><span class="op" id="8177256">,</span>&nbsp;<span class="ident" id="8177258">Domain</span><span class="op" id="8177264">:</span>&nbsp;<span class="string" id="8177266">&#34;::1&#34;</span><span class="op" id="8177271">}</span><span class="op" id="8177272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177276">&#34;cookie-8=eight&#34;</span><span class="op" id="8177292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177295">}</span><span class="op" id="8177296">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8177299">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8177371">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177434">&amp;</span><span class="ident" id="8177435">Cookie</span><span class="op" id="8177441">{</span><span class="ident" id="8177442">Name</span><span class="op" id="8177446">:</span>&nbsp;<span class="string" id="8177448">&#34;special-1&#34;</span><span class="op" id="8177459">,</span>&nbsp;<span class="ident" id="8177461">Value</span><span class="op" id="8177466">:</span>&nbsp;<span class="string" id="8177468">&#34;a&nbsp;z&#34;</span><span class="op" id="8177473">}</span><span class="op" id="8177474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177478">`special-1=a&nbsp;z`</span><span class="op" id="8177493">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177496">}</span><span class="op" id="8177497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177504">&amp;</span><span class="ident" id="8177505">Cookie</span><span class="op" id="8177511">{</span><span class="ident" id="8177512">Name</span><span class="op" id="8177516">:</span>&nbsp;<span class="string" id="8177518">&#34;special-2&#34;</span><span class="op" id="8177529">,</span>&nbsp;<span class="ident" id="8177531">Value</span><span class="op" id="8177536">:</span>&nbsp;<span class="string" id="8177538">&#34;&nbsp;z&#34;</span><span class="op" id="8177542">}</span><span class="op" id="8177543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177547">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8177563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177566">}</span><span class="op" id="8177567">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177574">&amp;</span><span class="ident" id="8177575">Cookie</span><span class="op" id="8177581">{</span><span class="ident" id="8177582">Name</span><span class="op" id="8177586">:</span>&nbsp;<span class="string" id="8177588">&#34;special-3&#34;</span><span class="op" id="8177599">,</span>&nbsp;<span class="ident" id="8177601">Value</span><span class="op" id="8177606">:</span>&nbsp;<span class="string" id="8177608">&#34;a&nbsp;&#34;</span><span class="op" id="8177612">}</span><span class="op" id="8177613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177617">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8177633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177636">}</span><span class="op" id="8177637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177640">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177644">&amp;</span><span class="ident" id="8177645">Cookie</span><span class="op" id="8177651">{</span><span class="ident" id="8177652">Name</span><span class="op" id="8177656">:</span>&nbsp;<span class="string" id="8177658">&#34;special-4&#34;</span><span class="op" id="8177669">,</span>&nbsp;<span class="ident" id="8177671">Value</span><span class="op" id="8177676">:</span>&nbsp;<span class="string" id="8177678">&#34;&nbsp;&#34;</span><span class="op" id="8177681">}</span><span class="op" id="8177682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177686">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8177701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177704">}</span><span class="op" id="8177705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177712">&amp;</span><span class="ident" id="8177713">Cookie</span><span class="op" id="8177719">{</span><span class="ident" id="8177720">Name</span><span class="op" id="8177724">:</span>&nbsp;<span class="string" id="8177726">&#34;special-5&#34;</span><span class="op" id="8177737">,</span>&nbsp;<span class="ident" id="8177739">Value</span><span class="op" id="8177744">:</span>&nbsp;<span class="string" id="8177746">&#34;a,z&#34;</span><span class="op" id="8177751">}</span><span class="op" id="8177752">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177756">`special-5=a,z`</span><span class="op" id="8177771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177774">}</span><span class="op" id="8177775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177782">&amp;</span><span class="ident" id="8177783">Cookie</span><span class="op" id="8177789">{</span><span class="ident" id="8177790">Name</span><span class="op" id="8177794">:</span>&nbsp;<span class="string" id="8177796">&#34;special-6&#34;</span><span class="op" id="8177807">,</span>&nbsp;<span class="ident" id="8177809">Value</span><span class="op" id="8177814">:</span>&nbsp;<span class="string" id="8177816">&#34;,z&#34;</span><span class="op" id="8177820">}</span><span class="op" id="8177821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177825">`special-6=&#34;,z&#34;`</span><span class="op" id="8177841">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177844">}</span><span class="op" id="8177845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177852">&amp;</span><span class="ident" id="8177853">Cookie</span><span class="op" id="8177859">{</span><span class="ident" id="8177860">Name</span><span class="op" id="8177864">:</span>&nbsp;<span class="string" id="8177866">&#34;special-7&#34;</span><span class="op" id="8177877">,</span>&nbsp;<span class="ident" id="8177879">Value</span><span class="op" id="8177884">:</span>&nbsp;<span class="string" id="8177886">&#34;a,&#34;</span><span class="op" id="8177890">}</span><span class="op" id="8177891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177895">`special-7=&#34;a,&#34;`</span><span class="op" id="8177911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177914">}</span><span class="op" id="8177915">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177922">&amp;</span><span class="ident" id="8177923">Cookie</span><span class="op" id="8177929">{</span><span class="ident" id="8177930">Name</span><span class="op" id="8177934">:</span>&nbsp;<span class="string" id="8177936">&#34;special-8&#34;</span><span class="op" id="8177947">,</span>&nbsp;<span class="ident" id="8177949">Value</span><span class="op" id="8177954">:</span>&nbsp;<span class="string" id="8177956">&#34;,&#34;</span><span class="op" id="8177959">}</span><span class="op" id="8177960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177964">`special-8=&#34;,&#34;`</span><span class="op" id="8177979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177982">}</span><span class="op" id="8177983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177986">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177990">&amp;</span><span class="ident" id="8177991">Cookie</span><span class="op" id="8177997">{</span><span class="ident" id="8177998">Name</span><span class="op" id="8178002">:</span>&nbsp;<span class="string" id="8178004">&#34;empty-value&#34;</span><span class="op" id="8178017">,</span>&nbsp;<span class="ident" id="8178019">Value</span><span class="op" id="8178024">:</span>&nbsp;<span class="string" id="8178026">&#34;&#34;</span><span class="op" id="8178028">}</span><span class="op" id="8178029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8178033">`empty-value=`</span><span class="op" id="8178047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178050">}</span><span class="op" id="8178051">,</span><br>
<span class="lineno"></span><span class="op" id="8178053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="8178056">func</span>&nbsp;<span class="ident" id="8178061">TestWriteSetCookies</span><span class="op" id="8178080">(</span><span class="ident" id="8178081">t</span>&nbsp;<span class="op" id="8178083">*</span><span class="ident" id="8178084">testing</span><span class="op" id="8178091">.</span><span class="ident" id="8178092">T</span><span class="op" id="8178093">)</span>&nbsp;<span class="op" id="8178095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178098">defer</span>&nbsp;<span class="ident" id="8178104">log</span><span class="op" id="8178107">.</span><span class="ident" id="8178108">SetOutput</span><span class="op" id="8178117">(</span><span class="ident" id="8178118">os</span><span class="op" id="8178120">.</span><span class="ident" id="8178121">Stderr</span><span class="op" id="8178127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178130">var</span>&nbsp;<span class="ident" id="8178134">logbuf</span>&nbsp;<span class="ident" id="8178141">bytes</span><span class="op" id="8178146">.</span><span class="ident" id="8178147">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178155">log</span><span class="op" id="8178158">.</span><span class="ident" id="8178159">SetOutput</span><span class="op" id="8178168">(</span><span class="op" id="8178169">&amp;</span><span class="ident" id="8178170">logbuf</span><span class="op" id="8178176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178180">for</span>&nbsp;<span class="ident" id="8178184">i</span><span class="op" id="8178185">,</span>&nbsp;<span class="ident" id="8178187">tt</span>&nbsp;<span class="op" id="8178190">:=</span>&nbsp;<span class="keyword" id="8178193">range</span>&nbsp;<span class="ident" id="8178199">writeSetCookiesTests</span>&nbsp;<span class="op" id="8178220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178224">if</span>&nbsp;<span class="ident" id="8178227">g</span><span class="op" id="8178228">,</span>&nbsp;<span class="ident" id="8178230">e</span>&nbsp;<span class="op" id="8178232">:=</span>&nbsp;<span class="ident" id="8178235">tt</span><span class="op" id="8178237">.</span><span class="ident" id="8178238">Cookie</span><span class="op" id="8178244">.</span><span class="ident" id="8178245">String</span><span class="op" id="8178251">(</span><span class="op" id="8178252">)</span><span class="op" id="8178253">,</span>&nbsp;<span class="ident" id="8178255">tt</span><span class="op" id="8178257">.</span><span class="ident" id="8178258">Raw</span><span class="op" id="8178261">;</span>&nbsp;<span class="ident" id="8178263">g</span>&nbsp;<span class="op" id="8178265">!=</span>&nbsp;<span class="ident" id="8178268">e</span>&nbsp;<span class="op" id="8178270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178275">t</span><span class="op" id="8178276">.</span><span class="ident" id="8178277">Errorf</span><span class="op" id="8178283">(</span><span class="string" id="8178284">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8178321">,</span>&nbsp;<span class="ident" id="8178323">i</span><span class="op" id="8178324">,</span>&nbsp;<span class="ident" id="8178326">e</span><span class="op" id="8178327">,</span>&nbsp;<span class="ident" id="8178329">g</span><span class="op" id="8178330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178335">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178346">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178353">if</span>&nbsp;<span class="ident" id="8178356">got</span><span class="op" id="8178359">,</span>&nbsp;<span class="ident" id="8178361">sub</span>&nbsp;<span class="op" id="8178365">:=</span>&nbsp;<span class="ident" id="8178368">logbuf</span><span class="op" id="8178374">.</span><span class="ident" id="8178375">String</span><span class="op" id="8178381">(</span><span class="op" id="8178382">)</span><span class="op" id="8178383">,</span>&nbsp;<span class="string" id="8178385">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="8178412">;</span>&nbsp;<span class="op" id="8178414">!</span><span class="ident" id="8178415">strings</span><span class="op" id="8178422">.</span><span class="ident" id="8178423">Contains</span><span class="op" id="8178431">(</span><span class="ident" id="8178432">got</span><span class="op" id="8178435">,</span>&nbsp;<span class="ident" id="8178437">sub</span><span class="op" id="8178440">)</span>&nbsp;<span class="op" id="8178442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178446">t</span><span class="op" id="8178447">.</span><span class="ident" id="8178448">Errorf</span><span class="op" id="8178454">(</span><span class="string" id="8178455">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8178502">,</span>&nbsp;<span class="ident" id="8178504">sub</span><span class="op" id="8178507">,</span>&nbsp;<span class="ident" id="8178509">got</span><span class="op" id="8178512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178515">}</span><br>
<span class="lineno">110</span><span class="op" id="8178517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8178520">type</span>&nbsp;<span class="ident" id="8178525">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="8178550">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8178558">func</span>&nbsp;<span class="op" id="8178563">(</span><span class="ident" id="8178564">ho</span>&nbsp;<span class="ident" id="8178567">headerOnlyResponseWriter</span><span class="op" id="8178591">)</span>&nbsp;<span class="ident" id="8178593">Header</span><span class="op" id="8178599">(</span><span class="op" id="8178600">)</span>&nbsp;<span class="ident" id="8178602">Header</span>&nbsp;<span class="op" id="8178609">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178612">return</span>&nbsp;<span class="ident" id="8178619">Header</span><span class="op" id="8178625">(</span><span class="ident" id="8178626">ho</span><span class="op" id="8178628">)</span><br>
<span class="lineno"></span><span class="op" id="8178630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8178633">func</span>&nbsp;<span class="op" id="8178638">(</span><span class="ident" id="8178639">ho</span>&nbsp;<span class="ident" id="8178642">headerOnlyResponseWriter</span><span class="op" id="8178666">)</span>&nbsp;<span class="ident" id="8178668">Write</span><span class="op" id="8178673">(</span><span class="op" id="8178674">[</span><span class="op" id="8178675">]</span><span class="builtintype" id="8178676">byte</span><span class="op" id="8178680">)</span>&nbsp;<span class="op" id="8178682">(</span><span class="builtintype" id="8178683">int</span><span class="op" id="8178686">,</span>&nbsp;<span class="builtintype" id="8178688">error</span><span class="op" id="8178693">)</span>&nbsp;<span class="op" id="8178695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8178698">panic</span><span class="op" id="8178703">(</span><span class="string" id="8178704">&#34;NOIMPL&#34;</span><span class="op" id="8178712">)</span><br>
<span class="lineno">120</span><span class="op" id="8178714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8178717">func</span>&nbsp;<span class="op" id="8178722">(</span><span class="ident" id="8178723">ho</span>&nbsp;<span class="ident" id="8178726">headerOnlyResponseWriter</span><span class="op" id="8178750">)</span>&nbsp;<span class="ident" id="8178752">WriteHeader</span><span class="op" id="8178763">(</span><span class="builtintype" id="8178764">int</span><span class="op" id="8178767">)</span>&nbsp;<span class="op" id="8178769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8178772">panic</span><span class="op" id="8178777">(</span><span class="string" id="8178778">&#34;NOIMPL&#34;</span><span class="op" id="8178786">)</span><br>
<span class="lineno"></span><span class="op" id="8178788">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="8178791">func</span>&nbsp;<span class="ident" id="8178796">TestSetCookie</span><span class="op" id="8178809">(</span><span class="ident" id="8178810">t</span>&nbsp;<span class="op" id="8178812">*</span><span class="ident" id="8178813">testing</span><span class="op" id="8178820">.</span><span class="ident" id="8178821">T</span><span class="op" id="8178822">)</span>&nbsp;<span class="op" id="8178824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178827">m</span>&nbsp;<span class="op" id="8178829">:=</span>&nbsp;<span class="builtinfunc" id="8178832">make</span><span class="op" id="8178836">(</span><span class="ident" id="8178837">Header</span><span class="op" id="8178843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178846">SetCookie</span><span class="op" id="8178855">(</span><span class="ident" id="8178856">headerOnlyResponseWriter</span><span class="op" id="8178880">(</span><span class="ident" id="8178881">m</span><span class="op" id="8178882">)</span><span class="op" id="8178883">,</span>&nbsp;<span class="op" id="8178885">&amp;</span><span class="ident" id="8178886">Cookie</span><span class="op" id="8178892">{</span><span class="ident" id="8178893">Name</span><span class="op" id="8178897">:</span>&nbsp;<span class="string" id="8178899">&#34;cookie-1&#34;</span><span class="op" id="8178909">,</span>&nbsp;<span class="ident" id="8178911">Value</span><span class="op" id="8178916">:</span>&nbsp;<span class="string" id="8178918">&#34;one&#34;</span><span class="op" id="8178923">,</span>&nbsp;<span class="ident" id="8178925">Path</span><span class="op" id="8178929">:</span>&nbsp;<span class="string" id="8178931">&#34;/restricted/&#34;</span><span class="op" id="8178945">}</span><span class="op" id="8178946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178949">SetCookie</span><span class="op" id="8178958">(</span><span class="ident" id="8178959">headerOnlyResponseWriter</span><span class="op" id="8178983">(</span><span class="ident" id="8178984">m</span><span class="op" id="8178985">)</span><span class="op" id="8178986">,</span>&nbsp;<span class="op" id="8178988">&amp;</span><span class="ident" id="8178989">Cookie</span><span class="op" id="8178995">{</span><span class="ident" id="8178996">Name</span><span class="op" id="8179000">:</span>&nbsp;<span class="string" id="8179002">&#34;cookie-2&#34;</span><span class="op" id="8179012">,</span>&nbsp;<span class="ident" id="8179014">Value</span><span class="op" id="8179019">:</span>&nbsp;<span class="string" id="8179021">&#34;two&#34;</span><span class="op" id="8179026">,</span>&nbsp;<span class="ident" id="8179028">MaxAge</span><span class="op" id="8179034">:</span>&nbsp;<span class="num" id="8179036">3600</span><span class="op" id="8179040">}</span><span class="op" id="8179041">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179044">if</span>&nbsp;<span class="ident" id="8179047">l</span>&nbsp;<span class="op" id="8179049">:=</span>&nbsp;<span class="builtinfunc" id="8179052">len</span><span class="op" id="8179055">(</span><span class="ident" id="8179056">m</span><span class="op" id="8179057">[</span><span class="string" id="8179058">&#34;Set-Cookie&#34;</span><span class="op" id="8179070">]</span><span class="op" id="8179071">)</span><span class="op" id="8179072">;</span>&nbsp;<span class="ident" id="8179074">l</span>&nbsp;<span class="op" id="8179076">!=</span>&nbsp;<span class="num" id="8179079">2</span>&nbsp;<span class="op" id="8179081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179085">t</span><span class="op" id="8179086">.</span><span class="ident" id="8179087">Fatalf</span><span class="op" id="8179093">(</span><span class="string" id="8179094">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8179123">,</span>&nbsp;<span class="num" id="8179125">2</span><span class="op" id="8179126">,</span>&nbsp;<span class="ident" id="8179128">l</span><span class="op" id="8179129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179135">if</span>&nbsp;<span class="ident" id="8179138">g</span><span class="op" id="8179139">,</span>&nbsp;<span class="ident" id="8179141">e</span>&nbsp;<span class="op" id="8179143">:=</span>&nbsp;<span class="ident" id="8179146">m</span><span class="op" id="8179147">[</span><span class="string" id="8179148">&#34;Set-Cookie&#34;</span><span class="op" id="8179160">]</span><span class="op" id="8179161">[</span><span class="num" id="8179162">0</span><span class="op" id="8179163">]</span><span class="op" id="8179164">,</span>&nbsp;<span class="string" id="8179166">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="8179199">;</span>&nbsp;<span class="ident" id="8179201">g</span>&nbsp;<span class="op" id="8179203">!=</span>&nbsp;<span class="ident" id="8179206">e</span>&nbsp;<span class="op" id="8179208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179212">t</span><span class="op" id="8179213">.</span><span class="ident" id="8179214">Errorf</span><span class="op" id="8179220">(</span><span class="string" id="8179221">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8179249">,</span>&nbsp;<span class="ident" id="8179251">e</span><span class="op" id="8179252">,</span>&nbsp;<span class="ident" id="8179254">g</span><span class="op" id="8179255">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179261">if</span>&nbsp;<span class="ident" id="8179264">g</span><span class="op" id="8179265">,</span>&nbsp;<span class="ident" id="8179267">e</span>&nbsp;<span class="op" id="8179269">:=</span>&nbsp;<span class="ident" id="8179272">m</span><span class="op" id="8179273">[</span><span class="string" id="8179274">&#34;Set-Cookie&#34;</span><span class="op" id="8179286">]</span><span class="op" id="8179287">[</span><span class="num" id="8179288">1</span><span class="op" id="8179289">]</span><span class="op" id="8179290">,</span>&nbsp;<span class="string" id="8179292">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="8179320">;</span>&nbsp;<span class="ident" id="8179322">g</span>&nbsp;<span class="op" id="8179324">!=</span>&nbsp;<span class="ident" id="8179327">e</span>&nbsp;<span class="op" id="8179329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179333">t</span><span class="op" id="8179334">.</span><span class="ident" id="8179335">Errorf</span><span class="op" id="8179341">(</span><span class="string" id="8179342">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8179370">,</span>&nbsp;<span class="ident" id="8179372">e</span><span class="op" id="8179373">,</span>&nbsp;<span class="ident" id="8179375">g</span><span class="op" id="8179376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179379">}</span><br>
<span class="lineno"></span><span class="op" id="8179381">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8179384">var</span>&nbsp;<span class="ident" id="8179388">addCookieTests</span>&nbsp;<span class="op" id="8179403">=</span>&nbsp;<span class="op" id="8179405">[</span><span class="op" id="8179406">]</span><span class="keyword" id="8179407">struct</span>&nbsp;<span class="op" id="8179414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179417">Cookies</span>&nbsp;<span class="op" id="8179425">[</span><span class="op" id="8179426">]</span><span class="op" id="8179427">*</span><span class="ident" id="8179428">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179436">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8179444">string</span><br>
<span class="lineno"></span><span class="op" id="8179451">}</span><span class="op" id="8179452">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179459">[</span><span class="op" id="8179460">]</span><span class="op" id="8179461">*</span><span class="ident" id="8179462">Cookie</span><span class="op" id="8179468">{</span><span class="op" id="8179469">}</span><span class="op" id="8179470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8179474">&#34;&#34;</span><span class="op" id="8179476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179479">}</span><span class="op" id="8179480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179483">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179487">[</span><span class="op" id="8179488">]</span><span class="op" id="8179489">*</span><span class="ident" id="8179490">Cookie</span><span class="op" id="8179496">{</span><span class="op" id="8179497">{</span><span class="ident" id="8179498">Name</span><span class="op" id="8179502">:</span>&nbsp;<span class="string" id="8179504">&#34;cookie-1&#34;</span><span class="op" id="8179514">,</span>&nbsp;<span class="ident" id="8179516">Value</span><span class="op" id="8179521">:</span>&nbsp;<span class="string" id="8179523">&#34;v$1&#34;</span><span class="op" id="8179528">}</span><span class="op" id="8179529">}</span><span class="op" id="8179530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8179534">&#34;cookie-1=v$1&#34;</span><span class="op" id="8179548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179551">}</span><span class="op" id="8179552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179559">[</span><span class="op" id="8179560">]</span><span class="op" id="8179561">*</span><span class="ident" id="8179562">Cookie</span><span class="op" id="8179568">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179573">{</span><span class="ident" id="8179574">Name</span><span class="op" id="8179578">:</span>&nbsp;<span class="string" id="8179580">&#34;cookie-1&#34;</span><span class="op" id="8179590">,</span>&nbsp;<span class="ident" id="8179592">Value</span><span class="op" id="8179597">:</span>&nbsp;<span class="string" id="8179599">&#34;v$1&#34;</span><span class="op" id="8179604">}</span><span class="op" id="8179605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179610">{</span><span class="ident" id="8179611">Name</span><span class="op" id="8179615">:</span>&nbsp;<span class="string" id="8179617">&#34;cookie-2&#34;</span><span class="op" id="8179627">,</span>&nbsp;<span class="ident" id="8179629">Value</span><span class="op" id="8179634">:</span>&nbsp;<span class="string" id="8179636">&#34;v$2&#34;</span><span class="op" id="8179641">}</span><span class="op" id="8179642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179647">{</span><span class="ident" id="8179648">Name</span><span class="op" id="8179652">:</span>&nbsp;<span class="string" id="8179654">&#34;cookie-3&#34;</span><span class="op" id="8179664">,</span>&nbsp;<span class="ident" id="8179666">Value</span><span class="op" id="8179671">:</span>&nbsp;<span class="string" id="8179673">&#34;v$3&#34;</span><span class="op" id="8179678">}</span><span class="op" id="8179679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179683">}</span><span class="op" id="8179684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8179688">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="8179730">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179733">}</span><span class="op" id="8179734">,</span><br>
<span class="lineno"></span><span class="op" id="8179736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8179739">func</span>&nbsp;<span class="ident" id="8179744">TestAddCookie</span><span class="op" id="8179757">(</span><span class="ident" id="8179758">t</span>&nbsp;<span class="op" id="8179760">*</span><span class="ident" id="8179761">testing</span><span class="op" id="8179768">.</span><span class="ident" id="8179769">T</span><span class="op" id="8179770">)</span>&nbsp;<span class="op" id="8179772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179775">for</span>&nbsp;<span class="ident" id="8179779">i</span><span class="op" id="8179780">,</span>&nbsp;<span class="ident" id="8179782">tt</span>&nbsp;<span class="op" id="8179785">:=</span>&nbsp;<span class="keyword" id="8179788">range</span>&nbsp;<span class="ident" id="8179794">addCookieTests</span>&nbsp;<span class="op" id="8179809">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179813">req</span><span class="op" id="8179816">,</span>&nbsp;<span class="ident" id="8179818">_</span>&nbsp;<span class="op" id="8179820">:=</span>&nbsp;<span class="ident" id="8179823">NewRequest</span><span class="op" id="8179833">(</span><span class="string" id="8179834">&#34;GET&#34;</span><span class="op" id="8179839">,</span>&nbsp;<span class="string" id="8179841">&#34;http://example.com/&#34;</span><span class="op" id="8179862">,</span>&nbsp;<span class="ident" id="8179864">nil</span><span class="op" id="8179867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179871">for</span>&nbsp;<span class="ident" id="8179875">_</span><span class="op" id="8179876">,</span>&nbsp;<span class="ident" id="8179878">c</span>&nbsp;<span class="op" id="8179880">:=</span>&nbsp;<span class="keyword" id="8179883">range</span>&nbsp;<span class="ident" id="8179889">tt</span><span class="op" id="8179891">.</span><span class="ident" id="8179892">Cookies</span>&nbsp;<span class="op" id="8179900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179905">req</span><span class="op" id="8179908">.</span><span class="ident" id="8179909">AddCookie</span><span class="op" id="8179918">(</span><span class="ident" id="8179919">c</span><span class="op" id="8179920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179928">if</span>&nbsp;<span class="ident" id="8179931">g</span>&nbsp;<span class="op" id="8179933">:=</span>&nbsp;<span class="ident" id="8179936">req</span><span class="op" id="8179939">.</span><span class="ident" id="8179940">Header</span><span class="op" id="8179946">.</span><span class="ident" id="8179947">Get</span><span class="op" id="8179950">(</span><span class="string" id="8179951">&#34;Cookie&#34;</span><span class="op" id="8179959">)</span><span class="op" id="8179960">;</span>&nbsp;<span class="ident" id="8179962">g</span>&nbsp;<span class="op" id="8179964">!=</span>&nbsp;<span class="ident" id="8179967">tt</span><span class="op" id="8179969">.</span><span class="ident" id="8179970">Raw</span>&nbsp;<span class="op" id="8179974">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179979">t</span><span class="op" id="8179980">.</span><span class="ident" id="8179981">Errorf</span><span class="op" id="8179987">(</span><span class="string" id="8179988">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="8180020">,</span>&nbsp;<span class="ident" id="8180022">i</span><span class="op" id="8180023">,</span>&nbsp;<span class="ident" id="8180025">tt</span><span class="op" id="8180027">.</span><span class="ident" id="8180028">Raw</span><span class="op" id="8180031">,</span>&nbsp;<span class="ident" id="8180033">g</span><span class="op" id="8180034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8180039">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180053">}</span><br>
<span class="lineno"></span><span class="op" id="8180055">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="8180058">var</span>&nbsp;<span class="ident" id="8180062">readSetCookiesTests</span>&nbsp;<span class="op" id="8180082">=</span>&nbsp;<span class="op" id="8180084">[</span><span class="op" id="8180085">]</span><span class="keyword" id="8180086">struct</span>&nbsp;<span class="op" id="8180093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180096">Header</span>&nbsp;&nbsp;<span class="ident" id="8180104">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180112">Cookies</span>&nbsp;<span class="op" id="8180120">[</span><span class="op" id="8180121">]</span><span class="op" id="8180122">*</span><span class="ident" id="8180123">Cookie</span><br>
<span class="lineno"></span><span class="op" id="8180130">}</span><span class="op" id="8180131">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180138">Header</span><span class="op" id="8180144">{</span><span class="string" id="8180145">&#34;Set-Cookie&#34;</span><span class="op" id="8180157">:</span>&nbsp;<span class="op" id="8180159">{</span><span class="string" id="8180160">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8180174">}</span><span class="op" id="8180175">}</span><span class="op" id="8180176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180180">[</span><span class="op" id="8180181">]</span><span class="op" id="8180182">*</span><span class="ident" id="8180183">Cookie</span><span class="op" id="8180189">{</span><span class="op" id="8180190">{</span><span class="ident" id="8180191">Name</span><span class="op" id="8180195">:</span>&nbsp;<span class="string" id="8180197">&#34;Cookie-1&#34;</span><span class="op" id="8180207">,</span>&nbsp;<span class="ident" id="8180209">Value</span><span class="op" id="8180214">:</span>&nbsp;<span class="string" id="8180216">&#34;v$1&#34;</span><span class="op" id="8180221">,</span>&nbsp;<span class="ident" id="8180223">Raw</span><span class="op" id="8180226">:</span>&nbsp;<span class="string" id="8180228">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8180242">}</span><span class="op" id="8180243">}</span><span class="op" id="8180244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180247">}</span><span class="op" id="8180248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180251">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180255">Header</span><span class="op" id="8180261">{</span><span class="string" id="8180262">&#34;Set-Cookie&#34;</span><span class="op" id="8180274">:</span>&nbsp;<span class="op" id="8180276">{</span><span class="string" id="8180277">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="8180376">}</span><span class="op" id="8180377">}</span><span class="op" id="8180378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180382">[</span><span class="op" id="8180383">]</span><span class="op" id="8180384">*</span><span class="ident" id="8180385">Cookie</span><span class="op" id="8180391">{</span><span class="op" id="8180392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180397">Name</span><span class="op" id="8180401">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8180409">&#34;NID&#34;</span><span class="op" id="8180414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180419">Value</span><span class="op" id="8180424">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8180431">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="8180450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180455">Path</span><span class="op" id="8180459">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8180467">&#34;/&#34;</span><span class="op" id="8180470">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180475">Domain</span><span class="op" id="8180481">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8180487">&#34;.google.ch&#34;</span><span class="op" id="8180499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180504">HttpOnly</span><span class="op" id="8180512">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8180516">true</span><span class="op" id="8180520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180525">Expires</span><span class="op" id="8180532">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180537">time</span><span class="op" id="8180541">.</span><span class="ident" id="8180542">Date</span><span class="op" id="8180546">(</span><span class="num" id="8180547">2011</span><span class="op" id="8180551">,</span>&nbsp;<span class="num" id="8180553">11</span><span class="op" id="8180555">,</span>&nbsp;<span class="num" id="8180557">23</span><span class="op" id="8180559">,</span>&nbsp;<span class="num" id="8180561">1</span><span class="op" id="8180562">,</span>&nbsp;<span class="num" id="8180564">5</span><span class="op" id="8180565">,</span>&nbsp;<span class="num" id="8180567">3</span><span class="op" id="8180568">,</span>&nbsp;<span class="num" id="8180570">0</span><span class="op" id="8180571">,</span>&nbsp;<span class="ident" id="8180573">time</span><span class="op" id="8180577">.</span><span class="ident" id="8180578">UTC</span><span class="op" id="8180581">)</span><span class="op" id="8180582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180587">RawExpires</span><span class="op" id="8180597">:</span>&nbsp;<span class="string" id="8180599">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="8180630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180635">Raw</span><span class="op" id="8180638">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8180647">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="8180746">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180750">}</span><span class="op" id="8180751">}</span><span class="op" id="8180752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180755">}</span><span class="op" id="8180756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180763">Header</span><span class="op" id="8180769">{</span><span class="string" id="8180770">&#34;Set-Cookie&#34;</span><span class="op" id="8180782">:</span>&nbsp;<span class="op" id="8180784">{</span><span class="string" id="8180785">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8180859">}</span><span class="op" id="8180860">}</span><span class="op" id="8180861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180865">[</span><span class="op" id="8180866">]</span><span class="op" id="8180867">*</span><span class="ident" id="8180868">Cookie</span><span class="op" id="8180874">{</span><span class="op" id="8180875">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180880">Name</span><span class="op" id="8180884">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8180892">&#34;.ASPXAUTH&#34;</span><span class="op" id="8180903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180908">Value</span><span class="op" id="8180913">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8180920">&#34;7E3AA&#34;</span><span class="op" id="8180927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180932">Path</span><span class="op" id="8180936">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8180944">&#34;/&#34;</span><span class="op" id="8180947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180952">Expires</span><span class="op" id="8180959">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180964">time</span><span class="op" id="8180968">.</span><span class="ident" id="8180969">Date</span><span class="op" id="8180973">(</span><span class="num" id="8180974">2012</span><span class="op" id="8180978">,</span>&nbsp;<span class="num" id="8180980">3</span><span class="op" id="8180981">,</span>&nbsp;<span class="num" id="8180983">7</span><span class="op" id="8180984">,</span>&nbsp;<span class="num" id="8180986">14</span><span class="op" id="8180988">,</span>&nbsp;<span class="num" id="8180990">25</span><span class="op" id="8180992">,</span>&nbsp;<span class="num" id="8180994">6</span><span class="op" id="8180995">,</span>&nbsp;<span class="num" id="8180997">0</span><span class="op" id="8180998">,</span>&nbsp;<span class="ident" id="8181000">time</span><span class="op" id="8181004">.</span><span class="ident" id="8181005">UTC</span><span class="op" id="8181008">)</span><span class="op" id="8181009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181014">RawExpires</span><span class="op" id="8181024">:</span>&nbsp;<span class="string" id="8181026">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="8181057">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181062">HttpOnly</span><span class="op" id="8181070">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8181074">true</span><span class="op" id="8181078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181083">Raw</span><span class="op" id="8181086">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8181095">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8181169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181173">}</span><span class="op" id="8181174">}</span><span class="op" id="8181175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181178">}</span><span class="op" id="8181179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181182">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181186">Header</span><span class="op" id="8181192">{</span><span class="string" id="8181193">&#34;Set-Cookie&#34;</span><span class="op" id="8181205">:</span>&nbsp;<span class="op" id="8181207">{</span><span class="string" id="8181208">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8181249">}</span><span class="op" id="8181250">}</span><span class="op" id="8181251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181255">[</span><span class="op" id="8181256">]</span><span class="op" id="8181257">*</span><span class="ident" id="8181258">Cookie</span><span class="op" id="8181264">{</span><span class="op" id="8181265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181270">Name</span><span class="op" id="8181274">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8181280">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="8181299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181304">Value</span><span class="op" id="8181309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8181314">&#34;foo&#34;</span><span class="op" id="8181319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181324">Path</span><span class="op" id="8181328">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8181334">&#34;/&#34;</span><span class="op" id="8181337">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181342">HttpOnly</span><span class="op" id="8181350">:</span>&nbsp;<span class="builtintype" id="8181352">true</span><span class="op" id="8181356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181361">Raw</span><span class="op" id="8181364">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8181371">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8181412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181416">}</span><span class="op" id="8181417">}</span><span class="op" id="8181418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181421">}</span><span class="op" id="8181422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8181425">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8181498">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181546">Header</span><span class="op" id="8181552">{</span><span class="string" id="8181553">&#34;Set-Cookie&#34;</span><span class="op" id="8181565">:</span>&nbsp;<span class="op" id="8181567">{</span><span class="string" id="8181568">`special-1=a&nbsp;z`</span><span class="op" id="8181583">}</span><span class="op" id="8181584">}</span><span class="op" id="8181585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181589">[</span><span class="op" id="8181590">]</span><span class="op" id="8181591">*</span><span class="ident" id="8181592">Cookie</span><span class="op" id="8181598">{</span><span class="op" id="8181599">{</span><span class="ident" id="8181600">Name</span><span class="op" id="8181604">:</span>&nbsp;<span class="string" id="8181606">&#34;special-1&#34;</span><span class="op" id="8181617">,</span>&nbsp;<span class="ident" id="8181619">Value</span><span class="op" id="8181624">:</span>&nbsp;<span class="string" id="8181626">&#34;a&nbsp;z&#34;</span><span class="op" id="8181631">,</span>&nbsp;<span class="ident" id="8181633">Raw</span><span class="op" id="8181636">:</span>&nbsp;<span class="string" id="8181638">`special-1=a&nbsp;z`</span><span class="op" id="8181653">}</span><span class="op" id="8181654">}</span><span class="op" id="8181655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181658">}</span><span class="op" id="8181659">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181666">Header</span><span class="op" id="8181672">{</span><span class="string" id="8181673">&#34;Set-Cookie&#34;</span><span class="op" id="8181685">:</span>&nbsp;<span class="op" id="8181687">{</span><span class="string" id="8181688">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8181704">}</span><span class="op" id="8181705">}</span><span class="op" id="8181706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181710">[</span><span class="op" id="8181711">]</span><span class="op" id="8181712">*</span><span class="ident" id="8181713">Cookie</span><span class="op" id="8181719">{</span><span class="op" id="8181720">{</span><span class="ident" id="8181721">Name</span><span class="op" id="8181725">:</span>&nbsp;<span class="string" id="8181727">&#34;special-2&#34;</span><span class="op" id="8181738">,</span>&nbsp;<span class="ident" id="8181740">Value</span><span class="op" id="8181745">:</span>&nbsp;<span class="string" id="8181747">&#34;&nbsp;z&#34;</span><span class="op" id="8181751">,</span>&nbsp;<span class="ident" id="8181753">Raw</span><span class="op" id="8181756">:</span>&nbsp;<span class="string" id="8181758">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8181774">}</span><span class="op" id="8181775">}</span><span class="op" id="8181776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181779">}</span><span class="op" id="8181780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181783">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181787">Header</span><span class="op" id="8181793">{</span><span class="string" id="8181794">&#34;Set-Cookie&#34;</span><span class="op" id="8181806">:</span>&nbsp;<span class="op" id="8181808">{</span><span class="string" id="8181809">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8181825">}</span><span class="op" id="8181826">}</span><span class="op" id="8181827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181831">[</span><span class="op" id="8181832">]</span><span class="op" id="8181833">*</span><span class="ident" id="8181834">Cookie</span><span class="op" id="8181840">{</span><span class="op" id="8181841">{</span><span class="ident" id="8181842">Name</span><span class="op" id="8181846">:</span>&nbsp;<span class="string" id="8181848">&#34;special-3&#34;</span><span class="op" id="8181859">,</span>&nbsp;<span class="ident" id="8181861">Value</span><span class="op" id="8181866">:</span>&nbsp;<span class="string" id="8181868">&#34;a&nbsp;&#34;</span><span class="op" id="8181872">,</span>&nbsp;<span class="ident" id="8181874">Raw</span><span class="op" id="8181877">:</span>&nbsp;<span class="string" id="8181879">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8181895">}</span><span class="op" id="8181896">}</span><span class="op" id="8181897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181900">}</span><span class="op" id="8181901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181908">Header</span><span class="op" id="8181914">{</span><span class="string" id="8181915">&#34;Set-Cookie&#34;</span><span class="op" id="8181927">:</span>&nbsp;<span class="op" id="8181929">{</span><span class="string" id="8181930">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8181945">}</span><span class="op" id="8181946">}</span><span class="op" id="8181947">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181951">[</span><span class="op" id="8181952">]</span><span class="op" id="8181953">*</span><span class="ident" id="8181954">Cookie</span><span class="op" id="8181960">{</span><span class="op" id="8181961">{</span><span class="ident" id="8181962">Name</span><span class="op" id="8181966">:</span>&nbsp;<span class="string" id="8181968">&#34;special-4&#34;</span><span class="op" id="8181979">,</span>&nbsp;<span class="ident" id="8181981">Value</span><span class="op" id="8181986">:</span>&nbsp;<span class="string" id="8181988">&#34;&nbsp;&#34;</span><span class="op" id="8181991">,</span>&nbsp;<span class="ident" id="8181993">Raw</span><span class="op" id="8181996">:</span>&nbsp;<span class="string" id="8181998">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8182013">}</span><span class="op" id="8182014">}</span><span class="op" id="8182015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182018">}</span><span class="op" id="8182019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182026">Header</span><span class="op" id="8182032">{</span><span class="string" id="8182033">&#34;Set-Cookie&#34;</span><span class="op" id="8182045">:</span>&nbsp;<span class="op" id="8182047">{</span><span class="string" id="8182048">`special-5=a,z`</span><span class="op" id="8182063">}</span><span class="op" id="8182064">}</span><span class="op" id="8182065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182069">[</span><span class="op" id="8182070">]</span><span class="op" id="8182071">*</span><span class="ident" id="8182072">Cookie</span><span class="op" id="8182078">{</span><span class="op" id="8182079">{</span><span class="ident" id="8182080">Name</span><span class="op" id="8182084">:</span>&nbsp;<span class="string" id="8182086">&#34;special-5&#34;</span><span class="op" id="8182097">,</span>&nbsp;<span class="ident" id="8182099">Value</span><span class="op" id="8182104">:</span>&nbsp;<span class="string" id="8182106">&#34;a,z&#34;</span><span class="op" id="8182111">,</span>&nbsp;<span class="ident" id="8182113">Raw</span><span class="op" id="8182116">:</span>&nbsp;<span class="string" id="8182118">`special-5=a,z`</span><span class="op" id="8182133">}</span><span class="op" id="8182134">}</span><span class="op" id="8182135">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182138">}</span><span class="op" id="8182139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182146">Header</span><span class="op" id="8182152">{</span><span class="string" id="8182153">&#34;Set-Cookie&#34;</span><span class="op" id="8182165">:</span>&nbsp;<span class="op" id="8182167">{</span><span class="string" id="8182168">`special-6=&#34;,z&#34;`</span><span class="op" id="8182184">}</span><span class="op" id="8182185">}</span><span class="op" id="8182186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182190">[</span><span class="op" id="8182191">]</span><span class="op" id="8182192">*</span><span class="ident" id="8182193">Cookie</span><span class="op" id="8182199">{</span><span class="op" id="8182200">{</span><span class="ident" id="8182201">Name</span><span class="op" id="8182205">:</span>&nbsp;<span class="string" id="8182207">&#34;special-6&#34;</span><span class="op" id="8182218">,</span>&nbsp;<span class="ident" id="8182220">Value</span><span class="op" id="8182225">:</span>&nbsp;<span class="string" id="8182227">&#34;,z&#34;</span><span class="op" id="8182231">,</span>&nbsp;<span class="ident" id="8182233">Raw</span><span class="op" id="8182236">:</span>&nbsp;<span class="string" id="8182238">`special-6=&#34;,z&#34;`</span><span class="op" id="8182254">}</span><span class="op" id="8182255">}</span><span class="op" id="8182256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182259">}</span><span class="op" id="8182260">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182267">Header</span><span class="op" id="8182273">{</span><span class="string" id="8182274">&#34;Set-Cookie&#34;</span><span class="op" id="8182286">:</span>&nbsp;<span class="op" id="8182288">{</span><span class="string" id="8182289">`special-7=a,`</span><span class="op" id="8182303">}</span><span class="op" id="8182304">}</span><span class="op" id="8182305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182309">[</span><span class="op" id="8182310">]</span><span class="op" id="8182311">*</span><span class="ident" id="8182312">Cookie</span><span class="op" id="8182318">{</span><span class="op" id="8182319">{</span><span class="ident" id="8182320">Name</span><span class="op" id="8182324">:</span>&nbsp;<span class="string" id="8182326">&#34;special-7&#34;</span><span class="op" id="8182337">,</span>&nbsp;<span class="ident" id="8182339">Value</span><span class="op" id="8182344">:</span>&nbsp;<span class="string" id="8182346">&#34;a,&#34;</span><span class="op" id="8182350">,</span>&nbsp;<span class="ident" id="8182352">Raw</span><span class="op" id="8182355">:</span>&nbsp;<span class="string" id="8182357">`special-7=a,`</span><span class="op" id="8182371">}</span><span class="op" id="8182372">}</span><span class="op" id="8182373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182376">}</span><span class="op" id="8182377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182380">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182384">Header</span><span class="op" id="8182390">{</span><span class="string" id="8182391">&#34;Set-Cookie&#34;</span><span class="op" id="8182403">:</span>&nbsp;<span class="op" id="8182405">{</span><span class="string" id="8182406">`special-8=&#34;,&#34;`</span><span class="op" id="8182421">}</span><span class="op" id="8182422">}</span><span class="op" id="8182423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182427">[</span><span class="op" id="8182428">]</span><span class="op" id="8182429">*</span><span class="ident" id="8182430">Cookie</span><span class="op" id="8182436">{</span><span class="op" id="8182437">{</span><span class="ident" id="8182438">Name</span><span class="op" id="8182442">:</span>&nbsp;<span class="string" id="8182444">&#34;special-8&#34;</span><span class="op" id="8182455">,</span>&nbsp;<span class="ident" id="8182457">Value</span><span class="op" id="8182462">:</span>&nbsp;<span class="string" id="8182464">&#34;,&#34;</span><span class="op" id="8182467">,</span>&nbsp;<span class="ident" id="8182469">Raw</span><span class="op" id="8182472">:</span>&nbsp;<span class="string" id="8182474">`special-8=&#34;,&#34;`</span><span class="op" id="8182489">}</span><span class="op" id="8182490">}</span><span class="op" id="8182491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182494">}</span><span class="op" id="8182495">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8182499">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8182558">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8182621">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8182685">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8182696">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="8182840">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8182843">func</span>&nbsp;<span class="ident" id="8182848">toJSON</span><span class="op" id="8182854">(</span><span class="ident" id="8182855">v</span>&nbsp;<span class="keyword" id="8182857">interface</span><span class="op" id="8182866">{</span><span class="op" id="8182867">}</span><span class="op" id="8182868">)</span>&nbsp;<span class="builtintype" id="8182870">string</span>&nbsp;<span class="op" id="8182877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182880">b</span><span class="op" id="8182881">,</span>&nbsp;<span class="ident" id="8182883">err</span>&nbsp;<span class="op" id="8182887">:=</span>&nbsp;<span class="ident" id="8182890">json</span><span class="op" id="8182894">.</span><span class="ident" id="8182895">Marshal</span><span class="op" id="8182902">(</span><span class="ident" id="8182903">v</span><span class="op" id="8182904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8182907">if</span>&nbsp;<span class="ident" id="8182910">err</span>&nbsp;<span class="op" id="8182914">!=</span>&nbsp;<span class="ident" id="8182917">nil</span>&nbsp;<span class="op" id="8182921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8182925">return</span>&nbsp;<span class="ident" id="8182932">fmt</span><span class="op" id="8182935">.</span><span class="ident" id="8182936">Sprintf</span><span class="op" id="8182943">(</span><span class="string" id="8182944">&#34;%#v&#34;</span><span class="op" id="8182949">,</span>&nbsp;<span class="ident" id="8182951">v</span><span class="op" id="8182952">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8182958">return</span>&nbsp;<span class="builtintype" id="8182965">string</span><span class="op" id="8182971">(</span><span class="ident" id="8182972">b</span><span class="op" id="8182973">)</span><br>
<span class="lineno"></span><span class="op" id="8182975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8182978">func</span>&nbsp;<span class="ident" id="8182983">TestReadSetCookies</span><span class="op" id="8183001">(</span><span class="ident" id="8183002">t</span>&nbsp;<span class="op" id="8183004">*</span><span class="ident" id="8183005">testing</span><span class="op" id="8183012">.</span><span class="ident" id="8183013">T</span><span class="op" id="8183014">)</span>&nbsp;<span class="op" id="8183016">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183019">for</span>&nbsp;<span class="ident" id="8183023">i</span><span class="op" id="8183024">,</span>&nbsp;<span class="ident" id="8183026">tt</span>&nbsp;<span class="op" id="8183029">:=</span>&nbsp;<span class="keyword" id="8183032">range</span>&nbsp;<span class="ident" id="8183038">readSetCookiesTests</span>&nbsp;<span class="op" id="8183058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183062">for</span>&nbsp;<span class="ident" id="8183066">n</span>&nbsp;<span class="op" id="8183068">:=</span>&nbsp;<span class="num" id="8183071">0</span><span class="op" id="8183072">;</span>&nbsp;<span class="ident" id="8183074">n</span>&nbsp;<span class="op" id="8183076">&lt;</span>&nbsp;<span class="num" id="8183078">2</span><span class="op" id="8183079">;</span>&nbsp;<span class="ident" id="8183081">n</span><span class="op" id="8183082">++</span>&nbsp;<span class="op" id="8183085">{</span>&nbsp;<span class="comment" id="8183087">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183143">c</span>&nbsp;<span class="op" id="8183145">:=</span>&nbsp;<span class="ident" id="8183148">readSetCookies</span><span class="op" id="8183162">(</span><span class="ident" id="8183163">tt</span><span class="op" id="8183165">.</span><span class="ident" id="8183166">Header</span><span class="op" id="8183172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183177">if</span>&nbsp;<span class="op" id="8183180">!</span><span class="ident" id="8183181">reflect</span><span class="op" id="8183188">.</span><span class="ident" id="8183189">DeepEqual</span><span class="op" id="8183198">(</span><span class="ident" id="8183199">c</span><span class="op" id="8183200">,</span>&nbsp;<span class="ident" id="8183202">tt</span><span class="op" id="8183204">.</span><span class="ident" id="8183205">Cookies</span><span class="op" id="8183212">)</span>&nbsp;<span class="op" id="8183214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183220">t</span><span class="op" id="8183221">.</span><span class="ident" id="8183222">Errorf</span><span class="op" id="8183228">(</span><span class="string" id="8183229">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="8183271">,</span>&nbsp;<span class="ident" id="8183273">i</span><span class="op" id="8183274">,</span>&nbsp;<span class="ident" id="8183276">toJSON</span><span class="op" id="8183282">(</span><span class="ident" id="8183283">c</span><span class="op" id="8183284">)</span><span class="op" id="8183285">,</span>&nbsp;<span class="ident" id="8183287">toJSON</span><span class="op" id="8183293">(</span><span class="ident" id="8183294">tt</span><span class="op" id="8183296">.</span><span class="ident" id="8183297">Cookies</span><span class="op" id="8183304">)</span><span class="op" id="8183305">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183311">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183330">}</span><br>
<span class="lineno"></span><span class="op" id="8183332">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="8183335">var</span>&nbsp;<span class="ident" id="8183339">readCookiesTests</span>&nbsp;<span class="op" id="8183356">=</span>&nbsp;<span class="op" id="8183358">[</span><span class="op" id="8183359">]</span><span class="keyword" id="8183360">struct</span>&nbsp;<span class="op" id="8183367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183370">Header</span>&nbsp;&nbsp;<span class="ident" id="8183378">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183386">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="8183394">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183402">Cookies</span>&nbsp;<span class="op" id="8183410">[</span><span class="op" id="8183411">]</span><span class="op" id="8183412">*</span><span class="ident" id="8183413">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="8183420">}</span><span class="op" id="8183421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183428">Header</span><span class="op" id="8183434">{</span><span class="string" id="8183435">&#34;Cookie&#34;</span><span class="op" id="8183443">:</span>&nbsp;<span class="op" id="8183445">{</span><span class="string" id="8183446">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8183460">,</span>&nbsp;<span class="string" id="8183462">&#34;c2=v2&#34;</span><span class="op" id="8183469">}</span><span class="op" id="8183470">}</span><span class="op" id="8183471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183475">&#34;&#34;</span><span class="op" id="8183477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183481">[</span><span class="op" id="8183482">]</span><span class="op" id="8183483">*</span><span class="ident" id="8183484">Cookie</span><span class="op" id="8183490">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183495">{</span><span class="ident" id="8183496">Name</span><span class="op" id="8183500">:</span>&nbsp;<span class="string" id="8183502">&#34;Cookie-1&#34;</span><span class="op" id="8183512">,</span>&nbsp;<span class="ident" id="8183514">Value</span><span class="op" id="8183519">:</span>&nbsp;<span class="string" id="8183521">&#34;v$1&#34;</span><span class="op" id="8183526">}</span><span class="op" id="8183527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183532">{</span><span class="ident" id="8183533">Name</span><span class="op" id="8183537">:</span>&nbsp;<span class="string" id="8183539">&#34;c2&#34;</span><span class="op" id="8183543">,</span>&nbsp;<span class="ident" id="8183545">Value</span><span class="op" id="8183550">:</span>&nbsp;<span class="string" id="8183552">&#34;v2&#34;</span><span class="op" id="8183556">}</span><span class="op" id="8183557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183561">}</span><span class="op" id="8183562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183565">}</span><span class="op" id="8183566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183569">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183573">Header</span><span class="op" id="8183579">{</span><span class="string" id="8183580">&#34;Cookie&#34;</span><span class="op" id="8183588">:</span>&nbsp;<span class="op" id="8183590">{</span><span class="string" id="8183591">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8183605">,</span>&nbsp;<span class="string" id="8183607">&#34;c2=v2&#34;</span><span class="op" id="8183614">}</span><span class="op" id="8183615">}</span><span class="op" id="8183616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183620">&#34;c2&#34;</span><span class="op" id="8183624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183628">[</span><span class="op" id="8183629">]</span><span class="op" id="8183630">*</span><span class="ident" id="8183631">Cookie</span><span class="op" id="8183637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183642">{</span><span class="ident" id="8183643">Name</span><span class="op" id="8183647">:</span>&nbsp;<span class="string" id="8183649">&#34;c2&#34;</span><span class="op" id="8183653">,</span>&nbsp;<span class="ident" id="8183655">Value</span><span class="op" id="8183660">:</span>&nbsp;<span class="string" id="8183662">&#34;v2&#34;</span><span class="op" id="8183666">}</span><span class="op" id="8183667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183671">}</span><span class="op" id="8183672">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183675">}</span><span class="op" id="8183676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183683">Header</span><span class="op" id="8183689">{</span><span class="string" id="8183690">&#34;Cookie&#34;</span><span class="op" id="8183698">:</span>&nbsp;<span class="op" id="8183700">{</span><span class="string" id="8183701">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="8183722">}</span><span class="op" id="8183723">}</span><span class="op" id="8183724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183728">&#34;&#34;</span><span class="op" id="8183730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183734">[</span><span class="op" id="8183735">]</span><span class="op" id="8183736">*</span><span class="ident" id="8183737">Cookie</span><span class="op" id="8183743">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183748">{</span><span class="ident" id="8183749">Name</span><span class="op" id="8183753">:</span>&nbsp;<span class="string" id="8183755">&#34;Cookie-1&#34;</span><span class="op" id="8183765">,</span>&nbsp;<span class="ident" id="8183767">Value</span><span class="op" id="8183772">:</span>&nbsp;<span class="string" id="8183774">&#34;v$1&#34;</span><span class="op" id="8183779">}</span><span class="op" id="8183780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183785">{</span><span class="ident" id="8183786">Name</span><span class="op" id="8183790">:</span>&nbsp;<span class="string" id="8183792">&#34;c2&#34;</span><span class="op" id="8183796">,</span>&nbsp;<span class="ident" id="8183798">Value</span><span class="op" id="8183803">:</span>&nbsp;<span class="string" id="8183805">&#34;v2&#34;</span><span class="op" id="8183809">}</span><span class="op" id="8183810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183814">}</span><span class="op" id="8183815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183818">}</span><span class="op" id="8183819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183822">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183826">Header</span><span class="op" id="8183832">{</span><span class="string" id="8183833">&#34;Cookie&#34;</span><span class="op" id="8183841">:</span>&nbsp;<span class="op" id="8183843">{</span><span class="string" id="8183844">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="8183865">}</span><span class="op" id="8183866">}</span><span class="op" id="8183867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183871">&#34;c2&#34;</span><span class="op" id="8183875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183879">[</span><span class="op" id="8183880">]</span><span class="op" id="8183881">*</span><span class="ident" id="8183882">Cookie</span><span class="op" id="8183888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183893">{</span><span class="ident" id="8183894">Name</span><span class="op" id="8183898">:</span>&nbsp;<span class="string" id="8183900">&#34;c2&#34;</span><span class="op" id="8183904">,</span>&nbsp;<span class="ident" id="8183906">Value</span><span class="op" id="8183911">:</span>&nbsp;<span class="string" id="8183913">&#34;v2&#34;</span><span class="op" id="8183917">}</span><span class="op" id="8183918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183922">}</span><span class="op" id="8183923">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183926">}</span><span class="op" id="8183927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183934">Header</span><span class="op" id="8183940">{</span><span class="string" id="8183941">&#34;Cookie&#34;</span><span class="op" id="8183949">:</span>&nbsp;<span class="op" id="8183951">{</span><span class="string" id="8183952">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="8183977">}</span><span class="op" id="8183978">}</span><span class="op" id="8183979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183983">&#34;&#34;</span><span class="op" id="8183985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183989">[</span><span class="op" id="8183990">]</span><span class="op" id="8183991">*</span><span class="ident" id="8183992">Cookie</span><span class="op" id="8183998">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184003">{</span><span class="ident" id="8184004">Name</span><span class="op" id="8184008">:</span>&nbsp;<span class="string" id="8184010">&#34;Cookie-1&#34;</span><span class="op" id="8184020">,</span>&nbsp;<span class="ident" id="8184022">Value</span><span class="op" id="8184027">:</span>&nbsp;<span class="string" id="8184029">&#34;v$1&#34;</span><span class="op" id="8184034">}</span><span class="op" id="8184035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184040">{</span><span class="ident" id="8184041">Name</span><span class="op" id="8184045">:</span>&nbsp;<span class="string" id="8184047">&#34;c2&#34;</span><span class="op" id="8184051">,</span>&nbsp;<span class="ident" id="8184053">Value</span><span class="op" id="8184058">:</span>&nbsp;<span class="string" id="8184060">&#34;v2&#34;</span><span class="op" id="8184064">}</span><span class="op" id="8184065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184069">}</span><span class="op" id="8184070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184073">}</span><span class="op" id="8184074">,</span><br>
<span class="lineno"></span><span class="op" id="8184076">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="8184079">func</span>&nbsp;<span class="ident" id="8184084">TestReadCookies</span><span class="op" id="8184099">(</span><span class="ident" id="8184100">t</span>&nbsp;<span class="op" id="8184102">*</span><span class="ident" id="8184103">testing</span><span class="op" id="8184110">.</span><span class="ident" id="8184111">T</span><span class="op" id="8184112">)</span>&nbsp;<span class="op" id="8184114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184117">for</span>&nbsp;<span class="ident" id="8184121">i</span><span class="op" id="8184122">,</span>&nbsp;<span class="ident" id="8184124">tt</span>&nbsp;<span class="op" id="8184127">:=</span>&nbsp;<span class="keyword" id="8184130">range</span>&nbsp;<span class="ident" id="8184136">readCookiesTests</span>&nbsp;<span class="op" id="8184153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184157">for</span>&nbsp;<span class="ident" id="8184161">n</span>&nbsp;<span class="op" id="8184163">:=</span>&nbsp;<span class="num" id="8184166">0</span><span class="op" id="8184167">;</span>&nbsp;<span class="ident" id="8184169">n</span>&nbsp;<span class="op" id="8184171">&lt;</span>&nbsp;<span class="num" id="8184173">2</span><span class="op" id="8184174">;</span>&nbsp;<span class="ident" id="8184176">n</span><span class="op" id="8184177">++</span>&nbsp;<span class="op" id="8184180">{</span>&nbsp;<span class="comment" id="8184182">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184235">c</span>&nbsp;<span class="op" id="8184237">:=</span>&nbsp;<span class="ident" id="8184240">readCookies</span><span class="op" id="8184251">(</span><span class="ident" id="8184252">tt</span><span class="op" id="8184254">.</span><span class="ident" id="8184255">Header</span><span class="op" id="8184261">,</span>&nbsp;<span class="ident" id="8184263">tt</span><span class="op" id="8184265">.</span><span class="ident" id="8184266">Filter</span><span class="op" id="8184272">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184277">if</span>&nbsp;<span class="op" id="8184280">!</span><span class="ident" id="8184281">reflect</span><span class="op" id="8184288">.</span><span class="ident" id="8184289">DeepEqual</span><span class="op" id="8184298">(</span><span class="ident" id="8184299">c</span><span class="op" id="8184300">,</span>&nbsp;<span class="ident" id="8184302">tt</span><span class="op" id="8184304">.</span><span class="ident" id="8184305">Cookies</span><span class="op" id="8184312">)</span>&nbsp;<span class="op" id="8184314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184320">t</span><span class="op" id="8184321">.</span><span class="ident" id="8184322">Errorf</span><span class="op" id="8184328">(</span><span class="string" id="8184329">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="8184369">,</span>&nbsp;<span class="ident" id="8184371">i</span><span class="op" id="8184372">,</span>&nbsp;<span class="ident" id="8184374">toJSON</span><span class="op" id="8184380">(</span><span class="ident" id="8184381">c</span><span class="op" id="8184382">)</span><span class="op" id="8184383">,</span>&nbsp;<span class="ident" id="8184385">toJSON</span><span class="op" id="8184391">(</span><span class="ident" id="8184392">tt</span><span class="op" id="8184394">.</span><span class="ident" id="8184395">Cookies</span><span class="op" id="8184402">)</span><span class="op" id="8184403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184409">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184425">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184428">}</span><br>
<span class="lineno"></span><span class="op" id="8184430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8184433">func</span>&nbsp;<span class="ident" id="8184438">TestSetCookieDoubleQuotes</span><span class="op" id="8184463">(</span><span class="ident" id="8184464">t</span>&nbsp;<span class="op" id="8184466">*</span><span class="ident" id="8184467">testing</span><span class="op" id="8184474">.</span><span class="ident" id="8184475">T</span><span class="op" id="8184476">)</span>&nbsp;<span class="op" id="8184478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184481">res</span>&nbsp;<span class="op" id="8184485">:=</span>&nbsp;<span class="op" id="8184488">&amp;</span><span class="ident" id="8184489">Response</span><span class="op" id="8184497">{</span><span class="ident" id="8184498">Header</span><span class="op" id="8184504">:</span>&nbsp;<span class="ident" id="8184506">Header</span><span class="op" id="8184512">{</span><span class="op" id="8184513">}</span><span class="op" id="8184514">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184517">res</span><span class="op" id="8184520">.</span><span class="ident" id="8184521">Header</span><span class="op" id="8184527">.</span><span class="ident" id="8184528">Add</span><span class="op" id="8184531">(</span><span class="string" id="8184532">&#34;Set-Cookie&#34;</span><span class="op" id="8184544">,</span>&nbsp;<span class="string" id="8184546">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="8184572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184575">res</span><span class="op" id="8184578">.</span><span class="ident" id="8184579">Header</span><span class="op" id="8184585">.</span><span class="ident" id="8184586">Add</span><span class="op" id="8184589">(</span><span class="string" id="8184590">&#34;Set-Cookie&#34;</span><span class="op" id="8184602">,</span>&nbsp;<span class="string" id="8184604">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="8184639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184642">res</span><span class="op" id="8184645">.</span><span class="ident" id="8184646">Header</span><span class="op" id="8184652">.</span><span class="ident" id="8184653">Add</span><span class="op" id="8184656">(</span><span class="string" id="8184657">&#34;Set-Cookie&#34;</span><span class="op" id="8184669">,</span>&nbsp;<span class="string" id="8184671">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="8184703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184706">res</span><span class="op" id="8184709">.</span><span class="ident" id="8184710">Header</span><span class="op" id="8184716">.</span><span class="ident" id="8184717">Add</span><span class="op" id="8184720">(</span><span class="string" id="8184721">&#34;Set-Cookie&#34;</span><span class="op" id="8184733">,</span>&nbsp;<span class="string" id="8184735">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="8184765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184768">got</span>&nbsp;<span class="op" id="8184772">:=</span>&nbsp;<span class="ident" id="8184775">res</span><span class="op" id="8184778">.</span><span class="ident" id="8184779">Cookies</span><span class="op" id="8184786">(</span><span class="op" id="8184787">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184790">want</span>&nbsp;<span class="op" id="8184795">:=</span>&nbsp;<span class="op" id="8184798">[</span><span class="op" id="8184799">]</span><span class="op" id="8184800">*</span><span class="ident" id="8184801">Cookie</span><span class="op" id="8184807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184811">{</span><span class="ident" id="8184812">Name</span><span class="op" id="8184816">:</span>&nbsp;<span class="string" id="8184818">&#34;quoted0&#34;</span><span class="op" id="8184827">,</span>&nbsp;<span class="ident" id="8184829">Value</span><span class="op" id="8184834">:</span>&nbsp;<span class="string" id="8184836">&#34;none&#34;</span><span class="op" id="8184842">,</span>&nbsp;<span class="ident" id="8184844">MaxAge</span><span class="op" id="8184850">:</span>&nbsp;<span class="num" id="8184852">30</span><span class="op" id="8184854">}</span><span class="op" id="8184855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184859">{</span><span class="ident" id="8184860">Name</span><span class="op" id="8184864">:</span>&nbsp;<span class="string" id="8184866">&#34;quoted1&#34;</span><span class="op" id="8184875">,</span>&nbsp;<span class="ident" id="8184877">Value</span><span class="op" id="8184882">:</span>&nbsp;<span class="string" id="8184884">&#34;cookieValue&#34;</span><span class="op" id="8184897">,</span>&nbsp;<span class="ident" id="8184899">MaxAge</span><span class="op" id="8184905">:</span>&nbsp;<span class="num" id="8184907">31</span><span class="op" id="8184909">}</span><span class="op" id="8184910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184914">{</span><span class="ident" id="8184915">Name</span><span class="op" id="8184919">:</span>&nbsp;<span class="string" id="8184921">&#34;quoted2&#34;</span><span class="op" id="8184930">,</span>&nbsp;<span class="ident" id="8184932">Value</span><span class="op" id="8184937">:</span>&nbsp;<span class="string" id="8184939">&#34;cookieAV&#34;</span><span class="op" id="8184949">}</span><span class="op" id="8184950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184954">{</span><span class="ident" id="8184955">Name</span><span class="op" id="8184959">:</span>&nbsp;<span class="string" id="8184961">&#34;quoted3&#34;</span><span class="op" id="8184970">,</span>&nbsp;<span class="ident" id="8184972">Value</span><span class="op" id="8184977">:</span>&nbsp;<span class="string" id="8184979">&#34;both&#34;</span><span class="op" id="8184985">}</span><span class="op" id="8184986">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184992">if</span>&nbsp;<span class="builtinfunc" id="8184995">len</span><span class="op" id="8184998">(</span><span class="ident" id="8184999">got</span><span class="op" id="8185002">)</span>&nbsp;<span class="op" id="8185004">!=</span>&nbsp;<span class="builtinfunc" id="8185007">len</span><span class="op" id="8185010">(</span><span class="ident" id="8185011">want</span><span class="op" id="8185015">)</span>&nbsp;<span class="op" id="8185017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185021">t</span><span class="op" id="8185022">.</span><span class="ident" id="8185023">Fatal</span><span class="op" id="8185028">(</span><span class="string" id="8185029">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8185054">,</span>&nbsp;<span class="builtinfunc" id="8185056">len</span><span class="op" id="8185059">(</span><span class="ident" id="8185060">got</span><span class="op" id="8185063">)</span><span class="op" id="8185064">,</span>&nbsp;<span class="builtinfunc" id="8185066">len</span><span class="op" id="8185069">(</span><span class="ident" id="8185070">want</span><span class="op" id="8185074">)</span><span class="op" id="8185075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185081">for</span>&nbsp;<span class="ident" id="8185085">i</span><span class="op" id="8185086">,</span>&nbsp;<span class="ident" id="8185088">w</span>&nbsp;<span class="op" id="8185090">:=</span>&nbsp;<span class="keyword" id="8185093">range</span>&nbsp;<span class="ident" id="8185099">want</span>&nbsp;<span class="op" id="8185104">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185108">g</span>&nbsp;<span class="op" id="8185110">:=</span>&nbsp;<span class="ident" id="8185113">got</span><span class="op" id="8185116">[</span><span class="ident" id="8185117">i</span><span class="op" id="8185118">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185122">if</span>&nbsp;<span class="ident" id="8185125">g</span><span class="op" id="8185126">.</span><span class="ident" id="8185127">Name</span>&nbsp;<span class="op" id="8185132">!=</span>&nbsp;<span class="ident" id="8185135">w</span><span class="op" id="8185136">.</span><span class="ident" id="8185137">Name</span>&nbsp;<span class="op" id="8185142">||</span>&nbsp;<span class="ident" id="8185145">g</span><span class="op" id="8185146">.</span><span class="ident" id="8185147">Value</span>&nbsp;<span class="op" id="8185153">!=</span>&nbsp;<span class="ident" id="8185156">w</span><span class="op" id="8185157">.</span><span class="ident" id="8185158">Value</span>&nbsp;<span class="op" id="8185164">||</span>&nbsp;<span class="ident" id="8185167">g</span><span class="op" id="8185168">.</span><span class="ident" id="8185169">MaxAge</span>&nbsp;<span class="op" id="8185176">!=</span>&nbsp;<span class="ident" id="8185179">w</span><span class="op" id="8185180">.</span><span class="ident" id="8185181">MaxAge</span>&nbsp;<span class="op" id="8185188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185193">t</span><span class="op" id="8185194">.</span><span class="ident" id="8185195">Errorf</span><span class="op" id="8185201">(</span><span class="string" id="8185202">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="8185233">,</span>&nbsp;<span class="ident" id="8185235">i</span><span class="op" id="8185236">,</span>&nbsp;<span class="ident" id="8185238">g</span><span class="op" id="8185239">,</span>&nbsp;<span class="ident" id="8185241">w</span><span class="op" id="8185242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185249">}</span><br>
<span class="lineno">360</span><span class="op" id="8185251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8185254">func</span>&nbsp;<span class="ident" id="8185259">TestCookieSanitizeValue</span><span class="op" id="8185282">(</span><span class="ident" id="8185283">t</span>&nbsp;<span class="op" id="8185285">*</span><span class="ident" id="8185286">testing</span><span class="op" id="8185293">.</span><span class="ident" id="8185294">T</span><span class="op" id="8185295">)</span>&nbsp;<span class="op" id="8185297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185300">defer</span>&nbsp;<span class="ident" id="8185306">log</span><span class="op" id="8185309">.</span><span class="ident" id="8185310">SetOutput</span><span class="op" id="8185319">(</span><span class="ident" id="8185320">os</span><span class="op" id="8185322">.</span><span class="ident" id="8185323">Stderr</span><span class="op" id="8185329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185332">var</span>&nbsp;<span class="ident" id="8185336">logbuf</span>&nbsp;<span class="ident" id="8185343">bytes</span><span class="op" id="8185348">.</span><span class="ident" id="8185349">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185357">log</span><span class="op" id="8185360">.</span><span class="ident" id="8185361">SetOutput</span><span class="op" id="8185370">(</span><span class="op" id="8185371">&amp;</span><span class="ident" id="8185372">logbuf</span><span class="op" id="8185378">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185382">tests</span>&nbsp;<span class="op" id="8185388">:=</span>&nbsp;<span class="op" id="8185391">[</span><span class="op" id="8185392">]</span><span class="keyword" id="8185393">struct</span>&nbsp;<span class="op" id="8185400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185404">in</span><span class="op" id="8185406">,</span>&nbsp;<span class="ident" id="8185408">want</span>&nbsp;<span class="builtintype" id="8185413">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185421">}</span><span class="op" id="8185422">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185426">{</span><span class="string" id="8185427">&#34;foo&#34;</span><span class="op" id="8185432">,</span>&nbsp;<span class="string" id="8185434">&#34;foo&#34;</span><span class="op" id="8185439">}</span><span class="op" id="8185440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185444">{</span><span class="string" id="8185445">&#34;foo;bar&#34;</span><span class="op" id="8185454">,</span>&nbsp;<span class="string" id="8185456">&#34;foobar&#34;</span><span class="op" id="8185464">}</span><span class="op" id="8185465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185469">{</span><span class="string" id="8185470">&#34;foo\\bar&#34;</span><span class="op" id="8185480">,</span>&nbsp;<span class="string" id="8185482">&#34;foobar&#34;</span><span class="op" id="8185490">}</span><span class="op" id="8185491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185495">{</span><span class="string" id="8185496">&#34;foo\&#34;bar&#34;</span><span class="op" id="8185506">,</span>&nbsp;<span class="string" id="8185508">&#34;foobar&#34;</span><span class="op" id="8185516">}</span><span class="op" id="8185517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185521">{</span><span class="string" id="8185522">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="8185540">,</span>&nbsp;<span class="string" id="8185542">&#34;\x7e&#34;</span><span class="op" id="8185548">}</span><span class="op" id="8185549">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185553">{</span><span class="string" id="8185554">`&#34;withquotes&#34;`</span><span class="op" id="8185568">,</span>&nbsp;<span class="string" id="8185570">&#34;withquotes&#34;</span><span class="op" id="8185582">}</span><span class="op" id="8185583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185587">{</span><span class="string" id="8185588">&#34;a&nbsp;z&#34;</span><span class="op" id="8185593">,</span>&nbsp;<span class="string" id="8185595">&#34;a&nbsp;z&#34;</span><span class="op" id="8185600">}</span><span class="op" id="8185601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185605">{</span><span class="string" id="8185606">&#34;&nbsp;z&#34;</span><span class="op" id="8185610">,</span>&nbsp;<span class="string" id="8185612">`&#34;&nbsp;z&#34;`</span><span class="op" id="8185618">}</span><span class="op" id="8185619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185623">{</span><span class="string" id="8185624">&#34;a&nbsp;&#34;</span><span class="op" id="8185628">,</span>&nbsp;<span class="string" id="8185630">`&#34;a&nbsp;&#34;`</span><span class="op" id="8185636">}</span><span class="op" id="8185637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185640">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185643">for</span>&nbsp;<span class="ident" id="8185647">_</span><span class="op" id="8185648">,</span>&nbsp;<span class="ident" id="8185650">tt</span>&nbsp;<span class="op" id="8185653">:=</span>&nbsp;<span class="keyword" id="8185656">range</span>&nbsp;<span class="ident" id="8185662">tests</span>&nbsp;<span class="op" id="8185668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185672">if</span>&nbsp;<span class="ident" id="8185675">got</span>&nbsp;<span class="op" id="8185679">:=</span>&nbsp;<span class="ident" id="8185682">sanitizeCookieValue</span><span class="op" id="8185701">(</span><span class="ident" id="8185702">tt</span><span class="op" id="8185704">.</span><span class="ident" id="8185705">in</span><span class="op" id="8185707">)</span><span class="op" id="8185708">;</span>&nbsp;<span class="ident" id="8185710">got</span>&nbsp;<span class="op" id="8185714">!=</span>&nbsp;<span class="ident" id="8185717">tt</span><span class="op" id="8185719">.</span><span class="ident" id="8185720">want</span>&nbsp;<span class="op" id="8185725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185730">t</span><span class="op" id="8185731">.</span><span class="ident" id="8185732">Errorf</span><span class="op" id="8185738">(</span><span class="string" id="8185739">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8185778">,</span>&nbsp;<span class="ident" id="8185780">tt</span><span class="op" id="8185782">.</span><span class="ident" id="8185783">in</span><span class="op" id="8185785">,</span>&nbsp;<span class="ident" id="8185787">got</span><span class="op" id="8185790">,</span>&nbsp;<span class="ident" id="8185792">tt</span><span class="op" id="8185794">.</span><span class="ident" id="8185795">want</span><span class="op" id="8185799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185806">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185810">if</span>&nbsp;<span class="ident" id="8185813">got</span><span class="op" id="8185816">,</span>&nbsp;<span class="ident" id="8185818">sub</span>&nbsp;<span class="op" id="8185822">:=</span>&nbsp;<span class="ident" id="8185825">logbuf</span><span class="op" id="8185831">.</span><span class="ident" id="8185832">String</span><span class="op" id="8185838">(</span><span class="op" id="8185839">)</span><span class="op" id="8185840">,</span>&nbsp;<span class="string" id="8185842">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="8185866">;</span>&nbsp;<span class="op" id="8185868">!</span><span class="ident" id="8185869">strings</span><span class="op" id="8185876">.</span><span class="ident" id="8185877">Contains</span><span class="op" id="8185885">(</span><span class="ident" id="8185886">got</span><span class="op" id="8185889">,</span>&nbsp;<span class="ident" id="8185891">sub</span><span class="op" id="8185894">)</span>&nbsp;<span class="op" id="8185896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185900">t</span><span class="op" id="8185901">.</span><span class="ident" id="8185902">Errorf</span><span class="op" id="8185908">(</span><span class="string" id="8185909">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8185956">,</span>&nbsp;<span class="ident" id="8185958">sub</span><span class="op" id="8185961">,</span>&nbsp;<span class="ident" id="8185963">got</span><span class="op" id="8185966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185969">}</span><br>
<span class="lineno"></span><span class="op" id="8185971">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="8185974">func</span>&nbsp;<span class="ident" id="8185979">TestCookieSanitizePath</span><span class="op" id="8186001">(</span><span class="ident" id="8186002">t</span>&nbsp;<span class="op" id="8186004">*</span><span class="ident" id="8186005">testing</span><span class="op" id="8186012">.</span><span class="ident" id="8186013">T</span><span class="op" id="8186014">)</span>&nbsp;<span class="op" id="8186016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186019">defer</span>&nbsp;<span class="ident" id="8186025">log</span><span class="op" id="8186028">.</span><span class="ident" id="8186029">SetOutput</span><span class="op" id="8186038">(</span><span class="ident" id="8186039">os</span><span class="op" id="8186041">.</span><span class="ident" id="8186042">Stderr</span><span class="op" id="8186048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186051">var</span>&nbsp;<span class="ident" id="8186055">logbuf</span>&nbsp;<span class="ident" id="8186062">bytes</span><span class="op" id="8186067">.</span><span class="ident" id="8186068">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186076">log</span><span class="op" id="8186079">.</span><span class="ident" id="8186080">SetOutput</span><span class="op" id="8186089">(</span><span class="op" id="8186090">&amp;</span><span class="ident" id="8186091">logbuf</span><span class="op" id="8186097">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186101">tests</span>&nbsp;<span class="op" id="8186107">:=</span>&nbsp;<span class="op" id="8186110">[</span><span class="op" id="8186111">]</span><span class="keyword" id="8186112">struct</span>&nbsp;<span class="op" id="8186119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186123">in</span><span class="op" id="8186125">,</span>&nbsp;<span class="ident" id="8186127">want</span>&nbsp;<span class="builtintype" id="8186132">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186140">}</span><span class="op" id="8186141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186145">{</span><span class="string" id="8186146">&#34;/path&#34;</span><span class="op" id="8186153">,</span>&nbsp;<span class="string" id="8186155">&#34;/path&#34;</span><span class="op" id="8186162">}</span><span class="op" id="8186163">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186167">{</span><span class="string" id="8186168">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="8186187">,</span>&nbsp;<span class="string" id="8186189">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="8186208">}</span><span class="op" id="8186209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186213">{</span><span class="string" id="8186214">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="8186246">,</span>&nbsp;<span class="string" id="8186248">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="8186274">}</span><span class="op" id="8186275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186281">for</span>&nbsp;<span class="ident" id="8186285">_</span><span class="op" id="8186286">,</span>&nbsp;<span class="ident" id="8186288">tt</span>&nbsp;<span class="op" id="8186291">:=</span>&nbsp;<span class="keyword" id="8186294">range</span>&nbsp;<span class="ident" id="8186300">tests</span>&nbsp;<span class="op" id="8186306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186310">if</span>&nbsp;<span class="ident" id="8186313">got</span>&nbsp;<span class="op" id="8186317">:=</span>&nbsp;<span class="ident" id="8186320">sanitizeCookiePath</span><span class="op" id="8186338">(</span><span class="ident" id="8186339">tt</span><span class="op" id="8186341">.</span><span class="ident" id="8186342">in</span><span class="op" id="8186344">)</span><span class="op" id="8186345">;</span>&nbsp;<span class="ident" id="8186347">got</span>&nbsp;<span class="op" id="8186351">!=</span>&nbsp;<span class="ident" id="8186354">tt</span><span class="op" id="8186356">.</span><span class="ident" id="8186357">want</span>&nbsp;<span class="op" id="8186362">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186367">t</span><span class="op" id="8186368">.</span><span class="ident" id="8186369">Errorf</span><span class="op" id="8186375">(</span><span class="string" id="8186376">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8186414">,</span>&nbsp;<span class="ident" id="8186416">tt</span><span class="op" id="8186418">.</span><span class="ident" id="8186419">in</span><span class="op" id="8186421">,</span>&nbsp;<span class="ident" id="8186423">got</span><span class="op" id="8186426">,</span>&nbsp;<span class="ident" id="8186428">tt</span><span class="op" id="8186430">.</span><span class="ident" id="8186431">want</span><span class="op" id="8186435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186446">if</span>&nbsp;<span class="ident" id="8186449">got</span><span class="op" id="8186452">,</span>&nbsp;<span class="ident" id="8186454">sub</span>&nbsp;<span class="op" id="8186458">:=</span>&nbsp;<span class="ident" id="8186461">logbuf</span><span class="op" id="8186467">.</span><span class="ident" id="8186468">String</span><span class="op" id="8186474">(</span><span class="op" id="8186475">)</span><span class="op" id="8186476">,</span>&nbsp;<span class="string" id="8186478">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="8186502">;</span>&nbsp;<span class="op" id="8186504">!</span><span class="ident" id="8186505">strings</span><span class="op" id="8186512">.</span><span class="ident" id="8186513">Contains</span><span class="op" id="8186521">(</span><span class="ident" id="8186522">got</span><span class="op" id="8186525">,</span>&nbsp;<span class="ident" id="8186527">sub</span><span class="op" id="8186530">)</span>&nbsp;<span class="op" id="8186532">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186536">t</span><span class="op" id="8186537">.</span><span class="ident" id="8186538">Errorf</span><span class="op" id="8186544">(</span><span class="string" id="8186545">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8186592">,</span>&nbsp;<span class="ident" id="8186594">sub</span><span class="op" id="8186597">,</span>&nbsp;<span class="ident" id="8186599">got</span><span class="op" id="8186602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186605">}</span><br>
<span class="lineno"></span><span class="op" id="8186607">}</span>
</div>
</body>
</html>
