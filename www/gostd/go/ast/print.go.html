<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/ast</h2>
<ul>
<li><a href="/gostd/go/ast/ast.go.html">ast.go</a></li>
<li><a href="/gostd/go/ast/ast_test.go.html">ast_test.go</a></li>
<li><a href="/gostd/go/ast/commentmap.go.html">commentmap.go</a></li>
<li><a href="/gostd/go/ast/commentmap_test.go.html">commentmap_test.go</a></li>
<li><a href="/gostd/go/ast/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/ast/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/ast/filter_test.go.html">filter_test.go</a></li>
<li><a href="/gostd/go/ast/import.go.html">import.go</a></li>
<li><a href="/gostd/go/ast/print.go.html" class="current">print.go</a></li>
<li><a href="/gostd/go/ast/print_test.go.html">print_test.go</a></li>
<li><a href="/gostd/go/ast/resolve.go.html">resolve.go</a></li>
<li><a href="/gostd/go/ast/scope.go.html">scope.go</a></li>
<li><a href="/gostd/go/ast/walk.go.html">walk.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2851171">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2851226">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2851280">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2851331">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;printing&nbsp;support&nbsp;for&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2851381">package</span>&nbsp;<span class="ident" id="2851389">ast</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2851394">import</span>&nbsp;<span class="op" id="2851401">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2851404">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2851411">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2851423">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2851429">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2851435">&#34;reflect&#34;</span><br>
<span class="lineno">15</span><span class="op" id="2851445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2851448">//&nbsp;A&nbsp;FieldFilter&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Fprint&nbsp;to&nbsp;control&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="2851514">type</span>&nbsp;<span class="ident" id="2851519">FieldFilter</span>&nbsp;<span class="keyword" id="2851531">func</span><span class="op" id="2851535">(</span><span class="ident" id="2851536">name</span>&nbsp;<span class="builtintype" id="2851541">string</span><span class="op" id="2851547">,</span>&nbsp;<span class="ident" id="2851549">value</span>&nbsp;<span class="ident" id="2851555">reflect</span><span class="op" id="2851562">.</span><span class="ident" id="2851563">Value</span><span class="op" id="2851568">)</span>&nbsp;<span class="builtintype" id="2851570">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2851576">//&nbsp;NotNilFilter&nbsp;returns&nbsp;true&nbsp;for&nbsp;field&nbsp;values&nbsp;that&nbsp;are&nbsp;not&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="2851640">//&nbsp;it&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="2851671">func</span>&nbsp;<span class="ident" id="2851676">NotNilFilter</span><span class="op" id="2851688">(</span><span class="ident" id="2851689">_</span>&nbsp;<span class="builtintype" id="2851691">string</span><span class="op" id="2851697">,</span>&nbsp;<span class="ident" id="2851699">v</span>&nbsp;<span class="ident" id="2851701">reflect</span><span class="op" id="2851708">.</span><span class="ident" id="2851709">Value</span><span class="op" id="2851714">)</span>&nbsp;<span class="builtintype" id="2851716">bool</span>&nbsp;<span class="op" id="2851721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851724">switch</span>&nbsp;<span class="ident" id="2851731">v</span><span class="op" id="2851732">.</span><span class="ident" id="2851733">Kind</span><span class="op" id="2851737">(</span><span class="op" id="2851738">)</span>&nbsp;<span class="op" id="2851740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851743">case</span>&nbsp;<span class="ident" id="2851748">reflect</span><span class="op" id="2851755">.</span><span class="ident" id="2851756">Chan</span><span class="op" id="2851760">,</span>&nbsp;<span class="ident" id="2851762">reflect</span><span class="op" id="2851769">.</span><span class="ident" id="2851770">Func</span><span class="op" id="2851774">,</span>&nbsp;<span class="ident" id="2851776">reflect</span><span class="op" id="2851783">.</span><span class="ident" id="2851784">Interface</span><span class="op" id="2851793">,</span>&nbsp;<span class="ident" id="2851795">reflect</span><span class="op" id="2851802">.</span><span class="ident" id="2851803">Map</span><span class="op" id="2851806">,</span>&nbsp;<span class="ident" id="2851808">reflect</span><span class="op" id="2851815">.</span><span class="ident" id="2851816">Ptr</span><span class="op" id="2851819">,</span>&nbsp;<span class="ident" id="2851821">reflect</span><span class="op" id="2851828">.</span><span class="ident" id="2851829">Slice</span><span class="op" id="2851834">:</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851838">return</span>&nbsp;<span class="op" id="2851845">!</span><span class="ident" id="2851846">v</span><span class="op" id="2851847">.</span><span class="ident" id="2851848">IsNil</span><span class="op" id="2851853">(</span><span class="op" id="2851854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851860">return</span>&nbsp;<span class="builtintype" id="2851867">true</span><br>
<span class="lineno"></span><span class="op" id="2851872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="2851875">//&nbsp;Fprint&nbsp;prints&nbsp;the&nbsp;(sub-)tree&nbsp;starting&nbsp;at&nbsp;AST&nbsp;node&nbsp;x&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="2851936">//&nbsp;If&nbsp;fset&nbsp;!=&nbsp;nil,&nbsp;position&nbsp;information&nbsp;is&nbsp;interpreted&nbsp;relative</span><br>
<span class="lineno"></span><span class="comment" id="2852000">//&nbsp;to&nbsp;that&nbsp;file&nbsp;set.&nbsp;Otherwise&nbsp;positions&nbsp;are&nbsp;printed&nbsp;as&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2852064">//&nbsp;values&nbsp;(file&nbsp;set&nbsp;specific&nbsp;offsets).</span><br>
<span class="lineno"></span><span class="comment" id="2852103">//</span><br>
<span class="lineno">35</span><span class="comment" id="2852106">//&nbsp;A&nbsp;non-nil&nbsp;FieldFilter&nbsp;f&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;control&nbsp;the&nbsp;output:</span><br>
<span class="lineno"></span><span class="comment" id="2852172">//&nbsp;struct&nbsp;fields&nbsp;for&nbsp;which&nbsp;f(fieldname,&nbsp;fieldvalue)&nbsp;is&nbsp;true&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2852236">//&nbsp;printed;&nbsp;all&nbsp;others&nbsp;are&nbsp;filtered&nbsp;from&nbsp;the&nbsp;output.&nbsp;Unexported</span><br>
<span class="lineno"></span><span class="comment" id="2852300">//&nbsp;struct&nbsp;fields&nbsp;are&nbsp;never&nbsp;printed.</span><br>
<span class="lineno"></span><span class="comment" id="2852336">//</span><br>
<span class="lineno">40</span><span class="keyword" id="2852339">func</span>&nbsp;<span class="ident" id="2852344">Fprint</span><span class="op" id="2852350">(</span><span class="ident" id="2852351">w</span>&nbsp;<span class="ident" id="2852353">io</span><span class="op" id="2852355">.</span><span class="ident" id="2852356">Writer</span><span class="op" id="2852362">,</span>&nbsp;<span class="ident" id="2852364">fset</span>&nbsp;<span class="op" id="2852369">*</span><span class="ident" id="2852370">token</span><span class="op" id="2852375">.</span><span class="ident" id="2852376">FileSet</span><span class="op" id="2852383">,</span>&nbsp;<span class="ident" id="2852385">x</span>&nbsp;<span class="keyword" id="2852387">interface</span><span class="op" id="2852396">{</span><span class="op" id="2852397">}</span><span class="op" id="2852398">,</span>&nbsp;<span class="ident" id="2852400">f</span>&nbsp;<span class="ident" id="2852402">FieldFilter</span><span class="op" id="2852413">)</span>&nbsp;<span class="op" id="2852415">(</span><span class="ident" id="2852416">err</span>&nbsp;<span class="builtintype" id="2852420">error</span><span class="op" id="2852425">)</span>&nbsp;<span class="op" id="2852427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2852430">//&nbsp;setup&nbsp;printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852448">p</span>&nbsp;<span class="op" id="2852450">:=</span>&nbsp;<span class="ident" id="2852453">printer</span><span class="op" id="2852460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852464">output</span><span class="op" id="2852470">:</span>&nbsp;<span class="ident" id="2852472">w</span><span class="op" id="2852473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852477">fset</span><span class="op" id="2852481">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2852485">fset</span><span class="op" id="2852489">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852493">filter</span><span class="op" id="2852499">:</span>&nbsp;<span class="ident" id="2852501">f</span><span class="op" id="2852502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852506">ptrmap</span><span class="op" id="2852512">:</span>&nbsp;<span class="builtinfunc" id="2852514">make</span><span class="op" id="2852518">(</span><span class="keyword" id="2852519">map</span><span class="op" id="2852522">[</span><span class="keyword" id="2852523">interface</span><span class="op" id="2852532">{</span><span class="op" id="2852533">}</span><span class="op" id="2852534">]</span><span class="builtintype" id="2852535">int</span><span class="op" id="2852538">)</span><span class="op" id="2852539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852543">last</span><span class="op" id="2852547">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2852551">&#39;\n&#39;</span><span class="op" id="2852555">,</span>&nbsp;<span class="comment" id="2852557">//&nbsp;force&nbsp;printing&nbsp;of&nbsp;line&nbsp;number&nbsp;on&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2852609">//&nbsp;install&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852635">defer</span>&nbsp;<span class="keyword" id="2852641">func</span><span class="op" id="2852645">(</span><span class="op" id="2852646">)</span>&nbsp;<span class="op" id="2852648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852652">if</span>&nbsp;<span class="ident" id="2852655">e</span>&nbsp;<span class="op" id="2852657">:=</span>&nbsp;<span class="builtinfunc" id="2852660">recover</span><span class="op" id="2852667">(</span><span class="op" id="2852668">)</span><span class="op" id="2852669">;</span>&nbsp;<span class="ident" id="2852671">e</span>&nbsp;<span class="op" id="2852673">!=</span>&nbsp;<span class="ident" id="2852676">nil</span>&nbsp;<span class="op" id="2852680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852685">err</span>&nbsp;<span class="op" id="2852689">=</span>&nbsp;<span class="ident" id="2852691">e</span><span class="op" id="2852692">.</span><span class="op" id="2852693">(</span><span class="ident" id="2852694">localError</span><span class="op" id="2852704">)</span><span class="op" id="2852705">.</span><span class="ident" id="2852706">err</span>&nbsp;<span class="comment" id="2852710">//&nbsp;re-panics&nbsp;if&nbsp;it&#39;s&nbsp;not&nbsp;a&nbsp;localError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852750">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852753">}</span><span class="op" id="2852754">(</span><span class="op" id="2852755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2852759">//&nbsp;print&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852771">if</span>&nbsp;<span class="ident" id="2852774">x</span>&nbsp;<span class="op" id="2852776">==</span>&nbsp;<span class="ident" id="2852779">nil</span>&nbsp;<span class="op" id="2852783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852787">p</span><span class="op" id="2852788">.</span><span class="ident" id="2852789">printf</span><span class="op" id="2852795">(</span><span class="string" id="2852796">&#34;nil\n&#34;</span><span class="op" id="2852803">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852807">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852818">p</span><span class="op" id="2852819">.</span><span class="builtinfunc" id="2852820">print</span><span class="op" id="2852825">(</span><span class="ident" id="2852826">reflect</span><span class="op" id="2852833">.</span><span class="ident" id="2852834">ValueOf</span><span class="op" id="2852841">(</span><span class="ident" id="2852842">x</span><span class="op" id="2852843">)</span><span class="op" id="2852844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852847">p</span><span class="op" id="2852848">.</span><span class="ident" id="2852849">printf</span><span class="op" id="2852855">(</span><span class="string" id="2852856">&#34;\n&#34;</span><span class="op" id="2852860">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852864">return</span><br>
<span class="lineno"></span><span class="op" id="2852871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2852874">//&nbsp;Print&nbsp;prints&nbsp;x&nbsp;to&nbsp;standard&nbsp;output,&nbsp;skipping&nbsp;nil&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="2852933">//&nbsp;Print(fset,&nbsp;x)&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;Fprint(os.Stdout,&nbsp;fset,&nbsp;x,&nbsp;NotNilFilter).</span><br>
<span class="lineno">70</span><span class="keyword" id="2853008">func</span>&nbsp;<span class="ident" id="2853013">Print</span><span class="op" id="2853018">(</span><span class="ident" id="2853019">fset</span>&nbsp;<span class="op" id="2853024">*</span><span class="ident" id="2853025">token</span><span class="op" id="2853030">.</span><span class="ident" id="2853031">FileSet</span><span class="op" id="2853038">,</span>&nbsp;<span class="ident" id="2853040">x</span>&nbsp;<span class="keyword" id="2853042">interface</span><span class="op" id="2853051">{</span><span class="op" id="2853052">}</span><span class="op" id="2853053">)</span>&nbsp;<span class="builtintype" id="2853055">error</span>&nbsp;<span class="op" id="2853061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853064">return</span>&nbsp;<span class="ident" id="2853071">Fprint</span><span class="op" id="2853077">(</span><span class="ident" id="2853078">os</span><span class="op" id="2853080">.</span><span class="ident" id="2853081">Stdout</span><span class="op" id="2853087">,</span>&nbsp;<span class="ident" id="2853089">fset</span><span class="op" id="2853093">,</span>&nbsp;<span class="ident" id="2853095">x</span><span class="op" id="2853096">,</span>&nbsp;<span class="ident" id="2853098">NotNilFilter</span><span class="op" id="2853110">)</span><br>
<span class="lineno"></span><span class="op" id="2853112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2853115">type</span>&nbsp;<span class="ident" id="2853120">printer</span>&nbsp;<span class="keyword" id="2853128">struct</span>&nbsp;<span class="op" id="2853135">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853138">output</span>&nbsp;<span class="ident" id="2853145">io</span><span class="op" id="2853147">.</span><span class="ident" id="2853148">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853156">fset</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2853163">*</span><span class="ident" id="2853164">token</span><span class="op" id="2853169">.</span><span class="ident" id="2853170">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853179">filter</span>&nbsp;<span class="ident" id="2853186">FieldFilter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853199">ptrmap</span>&nbsp;<span class="keyword" id="2853206">map</span><span class="op" id="2853209">[</span><span class="keyword" id="2853210">interface</span><span class="op" id="2853219">{</span><span class="op" id="2853220">}</span><span class="op" id="2853221">]</span><span class="builtintype" id="2853222">int</span>&nbsp;<span class="comment" id="2853226">//&nbsp;*T&nbsp;-&gt;&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853248">indent</span>&nbsp;<span class="builtintype" id="2853255">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2853275">//&nbsp;current&nbsp;indentation&nbsp;level</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853305">last</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2853312">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2853332">//&nbsp;the&nbsp;last&nbsp;byte&nbsp;processed&nbsp;by&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853369">line</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2853376">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2853396">//&nbsp;current&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span><span class="op" id="2853419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2853422">var</span>&nbsp;<span class="ident" id="2853426">indent</span>&nbsp;<span class="op" id="2853433">=</span>&nbsp;<span class="op" id="2853435">[</span><span class="op" id="2853436">]</span><span class="builtintype" id="2853437">byte</span><span class="op" id="2853441">(</span><span class="string" id="2853442">&#34;.&nbsp;&nbsp;&#34;</span><span class="op" id="2853447">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="2853450">func</span>&nbsp;<span class="op" id="2853455">(</span><span class="ident" id="2853456">p</span>&nbsp;<span class="op" id="2853458">*</span><span class="ident" id="2853459">printer</span><span class="op" id="2853466">)</span>&nbsp;<span class="ident" id="2853468">Write</span><span class="op" id="2853473">(</span><span class="ident" id="2853474">data</span>&nbsp;<span class="op" id="2853479">[</span><span class="op" id="2853480">]</span><span class="builtintype" id="2853481">byte</span><span class="op" id="2853485">)</span>&nbsp;<span class="op" id="2853487">(</span><span class="ident" id="2853488">n</span>&nbsp;<span class="builtintype" id="2853490">int</span><span class="op" id="2853493">,</span>&nbsp;<span class="ident" id="2853495">err</span>&nbsp;<span class="builtintype" id="2853499">error</span><span class="op" id="2853504">)</span>&nbsp;<span class="op" id="2853506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853509">var</span>&nbsp;<span class="ident" id="2853513">m</span>&nbsp;<span class="builtintype" id="2853515">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853520">for</span>&nbsp;<span class="ident" id="2853524">i</span><span class="op" id="2853525">,</span>&nbsp;<span class="ident" id="2853527">b</span>&nbsp;<span class="op" id="2853529">:=</span>&nbsp;<span class="keyword" id="2853532">range</span>&nbsp;<span class="ident" id="2853538">data</span>&nbsp;<span class="op" id="2853543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2853547">//&nbsp;invariant:&nbsp;data[0:n]&nbsp;has&nbsp;been&nbsp;written</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853590">if</span>&nbsp;<span class="ident" id="2853593">b</span>&nbsp;<span class="op" id="2853595">==</span>&nbsp;<span class="string" id="2853598">&#39;\n&#39;</span>&nbsp;<span class="op" id="2853603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853608">m</span><span class="op" id="2853609">,</span>&nbsp;<span class="ident" id="2853611">err</span>&nbsp;<span class="op" id="2853615">=</span>&nbsp;<span class="ident" id="2853617">p</span><span class="op" id="2853618">.</span><span class="ident" id="2853619">output</span><span class="op" id="2853625">.</span><span class="ident" id="2853626">Write</span><span class="op" id="2853631">(</span><span class="ident" id="2853632">data</span><span class="op" id="2853636">[</span><span class="ident" id="2853637">n</span>&nbsp;<span class="op" id="2853639">:</span>&nbsp;<span class="ident" id="2853641">i</span><span class="op" id="2853642">+</span><span class="num" id="2853643">1</span><span class="op" id="2853644">]</span><span class="op" id="2853645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853650">n</span>&nbsp;<span class="op" id="2853652">+=</span>&nbsp;<span class="ident" id="2853655">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853660">if</span>&nbsp;<span class="ident" id="2853663">err</span>&nbsp;<span class="op" id="2853667">!=</span>&nbsp;<span class="ident" id="2853670">nil</span>&nbsp;<span class="op" id="2853674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853680">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853695">p</span><span class="op" id="2853696">.</span><span class="ident" id="2853697">line</span><span class="op" id="2853701">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853706">}</span>&nbsp;<span class="keyword" id="2853708">else</span>&nbsp;<span class="keyword" id="2853713">if</span>&nbsp;<span class="ident" id="2853716">p</span><span class="op" id="2853717">.</span><span class="ident" id="2853718">last</span>&nbsp;<span class="op" id="2853723">==</span>&nbsp;<span class="string" id="2853726">&#39;\n&#39;</span>&nbsp;<span class="op" id="2853731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853736">_</span><span class="op" id="2853737">,</span>&nbsp;<span class="ident" id="2853739">err</span>&nbsp;<span class="op" id="2853743">=</span>&nbsp;<span class="ident" id="2853745">fmt</span><span class="op" id="2853748">.</span><span class="ident" id="2853749">Fprintf</span><span class="op" id="2853756">(</span><span class="ident" id="2853757">p</span><span class="op" id="2853758">.</span><span class="ident" id="2853759">output</span><span class="op" id="2853765">,</span>&nbsp;<span class="string" id="2853767">&#34;%6d&nbsp;&nbsp;&#34;</span><span class="op" id="2853774">,</span>&nbsp;<span class="ident" id="2853776">p</span><span class="op" id="2853777">.</span><span class="ident" id="2853778">line</span><span class="op" id="2853782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853787">if</span>&nbsp;<span class="ident" id="2853790">err</span>&nbsp;<span class="op" id="2853794">!=</span>&nbsp;<span class="ident" id="2853797">nil</span>&nbsp;<span class="op" id="2853801">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853807">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853822">for</span>&nbsp;<span class="ident" id="2853826">j</span>&nbsp;<span class="op" id="2853828">:=</span>&nbsp;<span class="ident" id="2853831">p</span><span class="op" id="2853832">.</span><span class="ident" id="2853833">indent</span><span class="op" id="2853839">;</span>&nbsp;<span class="ident" id="2853841">j</span>&nbsp;<span class="op" id="2853843">&gt;</span>&nbsp;<span class="num" id="2853845">0</span><span class="op" id="2853846">;</span>&nbsp;<span class="ident" id="2853848">j</span><span class="op" id="2853849">--</span>&nbsp;<span class="op" id="2853852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853858">_</span><span class="op" id="2853859">,</span>&nbsp;<span class="ident" id="2853861">err</span>&nbsp;<span class="op" id="2853865">=</span>&nbsp;<span class="ident" id="2853867">p</span><span class="op" id="2853868">.</span><span class="ident" id="2853869">output</span><span class="op" id="2853875">.</span><span class="ident" id="2853876">Write</span><span class="op" id="2853881">(</span><span class="ident" id="2853882">indent</span><span class="op" id="2853888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853894">if</span>&nbsp;<span class="ident" id="2853897">err</span>&nbsp;<span class="op" id="2853901">!=</span>&nbsp;<span class="ident" id="2853904">nil</span>&nbsp;<span class="op" id="2853908">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853915">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853939">p</span><span class="op" id="2853940">.</span><span class="ident" id="2853941">last</span>&nbsp;<span class="op" id="2853946">=</span>&nbsp;<span class="ident" id="2853948">b</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853954">if</span>&nbsp;<span class="builtinfunc" id="2853957">len</span><span class="op" id="2853960">(</span><span class="ident" id="2853961">data</span><span class="op" id="2853965">)</span>&nbsp;<span class="op" id="2853967">&gt;</span>&nbsp;<span class="ident" id="2853969">n</span>&nbsp;<span class="op" id="2853971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853975">m</span><span class="op" id="2853976">,</span>&nbsp;<span class="ident" id="2853978">err</span>&nbsp;<span class="op" id="2853982">=</span>&nbsp;<span class="ident" id="2853984">p</span><span class="op" id="2853985">.</span><span class="ident" id="2853986">output</span><span class="op" id="2853992">.</span><span class="ident" id="2853993">Write</span><span class="op" id="2853998">(</span><span class="ident" id="2853999">data</span><span class="op" id="2854003">[</span><span class="ident" id="2854004">n</span><span class="op" id="2854005">:</span><span class="op" id="2854006">]</span><span class="op" id="2854007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854011">n</span>&nbsp;<span class="op" id="2854013">+=</span>&nbsp;<span class="ident" id="2854016">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854019">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854022">return</span><br>
<span class="lineno"></span><span class="op" id="2854029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2854032">//&nbsp;localError&nbsp;wraps&nbsp;locally&nbsp;caught&nbsp;errors&nbsp;so&nbsp;we&nbsp;can&nbsp;distinguish</span><br>
<span class="lineno"></span><span class="comment" id="2854096">//&nbsp;them&nbsp;from&nbsp;genuine&nbsp;panics&nbsp;which&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;return&nbsp;as&nbsp;errors.</span><br>
<span class="lineno">120</span><span class="keyword" id="2854165">type</span>&nbsp;<span class="ident" id="2854170">localError</span>&nbsp;<span class="keyword" id="2854181">struct</span>&nbsp;<span class="op" id="2854188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854191">err</span>&nbsp;<span class="builtintype" id="2854195">error</span><br>
<span class="lineno"></span><span class="op" id="2854201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2854204">//&nbsp;printf&nbsp;is&nbsp;a&nbsp;convenience&nbsp;wrapper&nbsp;that&nbsp;takes&nbsp;care&nbsp;of&nbsp;print&nbsp;errors.</span><br>
<span class="lineno">125</span><span class="keyword" id="2854272">func</span>&nbsp;<span class="op" id="2854277">(</span><span class="ident" id="2854278">p</span>&nbsp;<span class="op" id="2854280">*</span><span class="ident" id="2854281">printer</span><span class="op" id="2854288">)</span>&nbsp;<span class="ident" id="2854290">printf</span><span class="op" id="2854296">(</span><span class="ident" id="2854297">format</span>&nbsp;<span class="builtintype" id="2854304">string</span><span class="op" id="2854310">,</span>&nbsp;<span class="ident" id="2854312">args</span>&nbsp;<span class="op" id="2854317">...</span><span class="keyword" id="2854320">interface</span><span class="op" id="2854329">{</span><span class="op" id="2854330">}</span><span class="op" id="2854331">)</span>&nbsp;<span class="op" id="2854333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854336">if</span>&nbsp;<span class="ident" id="2854339">_</span><span class="op" id="2854340">,</span>&nbsp;<span class="ident" id="2854342">err</span>&nbsp;<span class="op" id="2854346">:=</span>&nbsp;<span class="ident" id="2854349">fmt</span><span class="op" id="2854352">.</span><span class="ident" id="2854353">Fprintf</span><span class="op" id="2854360">(</span><span class="ident" id="2854361">p</span><span class="op" id="2854362">,</span>&nbsp;<span class="ident" id="2854364">format</span><span class="op" id="2854370">,</span>&nbsp;<span class="ident" id="2854372">args</span><span class="op" id="2854376">...</span><span class="op" id="2854379">)</span><span class="op" id="2854380">;</span>&nbsp;<span class="ident" id="2854382">err</span>&nbsp;<span class="op" id="2854386">!=</span>&nbsp;<span class="ident" id="2854389">nil</span>&nbsp;<span class="op" id="2854393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2854397">panic</span><span class="op" id="2854402">(</span><span class="ident" id="2854403">localError</span><span class="op" id="2854413">{</span><span class="ident" id="2854414">err</span><span class="op" id="2854417">}</span><span class="op" id="2854418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854421">}</span><br>
<span class="lineno"></span><span class="op" id="2854423">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2854426">//&nbsp;Implementation&nbsp;note:&nbsp;Print&nbsp;is&nbsp;written&nbsp;for&nbsp;AST&nbsp;nodes&nbsp;but&nbsp;could&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2854494">//&nbsp;used&nbsp;to&nbsp;print&nbsp;arbitrary&nbsp;data&nbsp;structures;&nbsp;such&nbsp;a&nbsp;version&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="2854560">//&nbsp;probably&nbsp;be&nbsp;in&nbsp;a&nbsp;different&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="2854599">//</span><br>
<span class="lineno">135</span><span class="comment" id="2854602">//&nbsp;Note:&nbsp;This&nbsp;code&nbsp;detects&nbsp;(some)&nbsp;cycles&nbsp;created&nbsp;via&nbsp;pointers&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="2854668">//&nbsp;not&nbsp;cycles&nbsp;that&nbsp;are&nbsp;created&nbsp;via&nbsp;slices&nbsp;or&nbsp;maps&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2854733">//&nbsp;same&nbsp;slice&nbsp;or&nbsp;map.&nbsp;Code&nbsp;for&nbsp;general&nbsp;data&nbsp;structures&nbsp;probably</span><br>
<span class="lineno"></span><span class="comment" id="2854797">//&nbsp;should&nbsp;catch&nbsp;those&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="2854829">func</span>&nbsp;<span class="op" id="2854834">(</span><span class="ident" id="2854835">p</span>&nbsp;<span class="op" id="2854837">*</span><span class="ident" id="2854838">printer</span><span class="op" id="2854845">)</span>&nbsp;<span class="builtinfunc" id="2854847">print</span><span class="op" id="2854852">(</span><span class="ident" id="2854853">x</span>&nbsp;<span class="ident" id="2854855">reflect</span><span class="op" id="2854862">.</span><span class="ident" id="2854863">Value</span><span class="op" id="2854868">)</span>&nbsp;<span class="op" id="2854870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854873">if</span>&nbsp;<span class="op" id="2854876">!</span><span class="ident" id="2854877">NotNilFilter</span><span class="op" id="2854889">(</span><span class="string" id="2854890">&#34;&#34;</span><span class="op" id="2854892">,</span>&nbsp;<span class="ident" id="2854894">x</span><span class="op" id="2854895">)</span>&nbsp;<span class="op" id="2854897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854901">p</span><span class="op" id="2854902">.</span><span class="ident" id="2854903">printf</span><span class="op" id="2854909">(</span><span class="string" id="2854910">&#34;nil&#34;</span><span class="op" id="2854915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854919">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854927">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854931">switch</span>&nbsp;<span class="ident" id="2854938">x</span><span class="op" id="2854939">.</span><span class="ident" id="2854940">Kind</span><span class="op" id="2854944">(</span><span class="op" id="2854945">)</span>&nbsp;<span class="op" id="2854947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854950">case</span>&nbsp;<span class="ident" id="2854955">reflect</span><span class="op" id="2854962">.</span><span class="ident" id="2854963">Interface</span><span class="op" id="2854972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854976">p</span><span class="op" id="2854977">.</span><span class="builtinfunc" id="2854978">print</span><span class="op" id="2854983">(</span><span class="ident" id="2854984">x</span><span class="op" id="2854985">.</span><span class="ident" id="2854986">Elem</span><span class="op" id="2854990">(</span><span class="op" id="2854991">)</span><span class="op" id="2854992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854996">case</span>&nbsp;<span class="ident" id="2855001">reflect</span><span class="op" id="2855008">.</span><span class="ident" id="2855009">Map</span><span class="op" id="2855012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855016">p</span><span class="op" id="2855017">.</span><span class="ident" id="2855018">printf</span><span class="op" id="2855024">(</span><span class="string" id="2855025">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="2855042">,</span>&nbsp;<span class="ident" id="2855044">x</span><span class="op" id="2855045">.</span><span class="ident" id="2855046">Type</span><span class="op" id="2855050">(</span><span class="op" id="2855051">)</span><span class="op" id="2855052">,</span>&nbsp;<span class="ident" id="2855054">x</span><span class="op" id="2855055">.</span><span class="ident" id="2855056">Len</span><span class="op" id="2855059">(</span><span class="op" id="2855060">)</span><span class="op" id="2855061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855065">if</span>&nbsp;<span class="ident" id="2855068">x</span><span class="op" id="2855069">.</span><span class="ident" id="2855070">Len</span><span class="op" id="2855073">(</span><span class="op" id="2855074">)</span>&nbsp;<span class="op" id="2855076">&gt;</span>&nbsp;<span class="num" id="2855078">0</span>&nbsp;<span class="op" id="2855080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855085">p</span><span class="op" id="2855086">.</span><span class="ident" id="2855087">indent</span><span class="op" id="2855093">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855099">p</span><span class="op" id="2855100">.</span><span class="ident" id="2855101">printf</span><span class="op" id="2855107">(</span><span class="string" id="2855108">&#34;\n&#34;</span><span class="op" id="2855112">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855117">for</span>&nbsp;<span class="ident" id="2855121">_</span><span class="op" id="2855122">,</span>&nbsp;<span class="ident" id="2855124">key</span>&nbsp;<span class="op" id="2855128">:=</span>&nbsp;<span class="keyword" id="2855131">range</span>&nbsp;<span class="ident" id="2855137">x</span><span class="op" id="2855138">.</span><span class="ident" id="2855139">MapKeys</span><span class="op" id="2855146">(</span><span class="op" id="2855147">)</span>&nbsp;<span class="op" id="2855149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855155">p</span><span class="op" id="2855156">.</span><span class="builtinfunc" id="2855157">print</span><span class="op" id="2855162">(</span><span class="ident" id="2855163">key</span><span class="op" id="2855166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855172">p</span><span class="op" id="2855173">.</span><span class="ident" id="2855174">printf</span><span class="op" id="2855180">(</span><span class="string" id="2855181">&#34;:&nbsp;&#34;</span><span class="op" id="2855185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855191">p</span><span class="op" id="2855192">.</span><span class="builtinfunc" id="2855193">print</span><span class="op" id="2855198">(</span><span class="ident" id="2855199">x</span><span class="op" id="2855200">.</span><span class="ident" id="2855201">MapIndex</span><span class="op" id="2855209">(</span><span class="ident" id="2855210">key</span><span class="op" id="2855213">)</span><span class="op" id="2855214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855220">p</span><span class="op" id="2855221">.</span><span class="ident" id="2855222">printf</span><span class="op" id="2855228">(</span><span class="string" id="2855229">&#34;\n&#34;</span><span class="op" id="2855233">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855243">p</span><span class="op" id="2855244">.</span><span class="ident" id="2855245">indent</span><span class="op" id="2855251">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855260">p</span><span class="op" id="2855261">.</span><span class="ident" id="2855262">printf</span><span class="op" id="2855268">(</span><span class="string" id="2855269">&#34;}&#34;</span><span class="op" id="2855272">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855276">case</span>&nbsp;<span class="ident" id="2855281">reflect</span><span class="op" id="2855288">.</span><span class="ident" id="2855289">Ptr</span><span class="op" id="2855292">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855296">p</span><span class="op" id="2855297">.</span><span class="ident" id="2855298">printf</span><span class="op" id="2855304">(</span><span class="string" id="2855305">&#34;*&#34;</span><span class="op" id="2855308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2855312">//&nbsp;type-checked&nbsp;ASTs&nbsp;may&nbsp;contain&nbsp;cycles&nbsp;-&nbsp;use&nbsp;ptrmap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2855367">//&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;objects&nbsp;that&nbsp;have&nbsp;been&nbsp;printed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2855420">//&nbsp;already&nbsp;and&nbsp;print&nbsp;the&nbsp;respective&nbsp;line&nbsp;number&nbsp;instead</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855478">ptr</span>&nbsp;<span class="op" id="2855482">:=</span>&nbsp;<span class="ident" id="2855485">x</span><span class="op" id="2855486">.</span><span class="ident" id="2855487">Interface</span><span class="op" id="2855496">(</span><span class="op" id="2855497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855501">if</span>&nbsp;<span class="ident" id="2855504">line</span><span class="op" id="2855508">,</span>&nbsp;<span class="ident" id="2855510">exists</span>&nbsp;<span class="op" id="2855517">:=</span>&nbsp;<span class="ident" id="2855520">p</span><span class="op" id="2855521">.</span><span class="ident" id="2855522">ptrmap</span><span class="op" id="2855528">[</span><span class="ident" id="2855529">ptr</span><span class="op" id="2855532">]</span><span class="op" id="2855533">;</span>&nbsp;<span class="ident" id="2855535">exists</span>&nbsp;<span class="op" id="2855542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855547">p</span><span class="op" id="2855548">.</span><span class="ident" id="2855549">printf</span><span class="op" id="2855555">(</span><span class="string" id="2855556">&#34;(obj&nbsp;@&nbsp;%d)&#34;</span><span class="op" id="2855568">,</span>&nbsp;<span class="ident" id="2855570">line</span><span class="op" id="2855574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855578">}</span>&nbsp;<span class="keyword" id="2855580">else</span>&nbsp;<span class="op" id="2855585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855590">p</span><span class="op" id="2855591">.</span><span class="ident" id="2855592">ptrmap</span><span class="op" id="2855598">[</span><span class="ident" id="2855599">ptr</span><span class="op" id="2855602">]</span>&nbsp;<span class="op" id="2855604">=</span>&nbsp;<span class="ident" id="2855606">p</span><span class="op" id="2855607">.</span><span class="ident" id="2855608">line</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855616">p</span><span class="op" id="2855617">.</span><span class="builtinfunc" id="2855618">print</span><span class="op" id="2855623">(</span><span class="ident" id="2855624">x</span><span class="op" id="2855625">.</span><span class="ident" id="2855626">Elem</span><span class="op" id="2855630">(</span><span class="op" id="2855631">)</span><span class="op" id="2855632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855640">case</span>&nbsp;<span class="ident" id="2855645">reflect</span><span class="op" id="2855652">.</span><span class="ident" id="2855653">Array</span><span class="op" id="2855658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855662">p</span><span class="op" id="2855663">.</span><span class="ident" id="2855664">printf</span><span class="op" id="2855670">(</span><span class="string" id="2855671">&#34;%s&nbsp;{&#34;</span><span class="op" id="2855677">,</span>&nbsp;<span class="ident" id="2855679">x</span><span class="op" id="2855680">.</span><span class="ident" id="2855681">Type</span><span class="op" id="2855685">(</span><span class="op" id="2855686">)</span><span class="op" id="2855687">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855691">if</span>&nbsp;<span class="ident" id="2855694">x</span><span class="op" id="2855695">.</span><span class="ident" id="2855696">Len</span><span class="op" id="2855699">(</span><span class="op" id="2855700">)</span>&nbsp;<span class="op" id="2855702">&gt;</span>&nbsp;<span class="num" id="2855704">0</span>&nbsp;<span class="op" id="2855706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855711">p</span><span class="op" id="2855712">.</span><span class="ident" id="2855713">indent</span><span class="op" id="2855719">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855725">p</span><span class="op" id="2855726">.</span><span class="ident" id="2855727">printf</span><span class="op" id="2855733">(</span><span class="string" id="2855734">&#34;\n&#34;</span><span class="op" id="2855738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855743">for</span>&nbsp;<span class="ident" id="2855747">i</span><span class="op" id="2855748">,</span>&nbsp;<span class="ident" id="2855750">n</span>&nbsp;<span class="op" id="2855752">:=</span>&nbsp;<span class="num" id="2855755">0</span><span class="op" id="2855756">,</span>&nbsp;<span class="ident" id="2855758">x</span><span class="op" id="2855759">.</span><span class="ident" id="2855760">Len</span><span class="op" id="2855763">(</span><span class="op" id="2855764">)</span><span class="op" id="2855765">;</span>&nbsp;<span class="ident" id="2855767">i</span>&nbsp;<span class="op" id="2855769">&lt;</span>&nbsp;<span class="ident" id="2855771">n</span><span class="op" id="2855772">;</span>&nbsp;<span class="ident" id="2855774">i</span><span class="op" id="2855775">++</span>&nbsp;<span class="op" id="2855778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855784">p</span><span class="op" id="2855785">.</span><span class="ident" id="2855786">printf</span><span class="op" id="2855792">(</span><span class="string" id="2855793">&#34;%d:&nbsp;&#34;</span><span class="op" id="2855799">,</span>&nbsp;<span class="ident" id="2855801">i</span><span class="op" id="2855802">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855808">p</span><span class="op" id="2855809">.</span><span class="builtinfunc" id="2855810">print</span><span class="op" id="2855815">(</span><span class="ident" id="2855816">x</span><span class="op" id="2855817">.</span><span class="ident" id="2855818">Index</span><span class="op" id="2855823">(</span><span class="ident" id="2855824">i</span><span class="op" id="2855825">)</span><span class="op" id="2855826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855832">p</span><span class="op" id="2855833">.</span><span class="ident" id="2855834">printf</span><span class="op" id="2855840">(</span><span class="string" id="2855841">&#34;\n&#34;</span><span class="op" id="2855845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855855">p</span><span class="op" id="2855856">.</span><span class="ident" id="2855857">indent</span><span class="op" id="2855863">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855868">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855872">p</span><span class="op" id="2855873">.</span><span class="ident" id="2855874">printf</span><span class="op" id="2855880">(</span><span class="string" id="2855881">&#34;}&#34;</span><span class="op" id="2855884">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855888">case</span>&nbsp;<span class="ident" id="2855893">reflect</span><span class="op" id="2855900">.</span><span class="ident" id="2855901">Slice</span><span class="op" id="2855906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855910">if</span>&nbsp;<span class="ident" id="2855913">s</span><span class="op" id="2855914">,</span>&nbsp;<span class="ident" id="2855916">ok</span>&nbsp;<span class="op" id="2855919">:=</span>&nbsp;<span class="ident" id="2855922">x</span><span class="op" id="2855923">.</span><span class="ident" id="2855924">Interface</span><span class="op" id="2855933">(</span><span class="op" id="2855934">)</span><span class="op" id="2855935">.</span><span class="op" id="2855936">(</span><span class="op" id="2855937">[</span><span class="op" id="2855938">]</span><span class="builtintype" id="2855939">byte</span><span class="op" id="2855943">)</span><span class="op" id="2855944">;</span>&nbsp;<span class="ident" id="2855946">ok</span>&nbsp;<span class="op" id="2855949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855954">p</span><span class="op" id="2855955">.</span><span class="ident" id="2855956">printf</span><span class="op" id="2855962">(</span><span class="string" id="2855963">&#34;%#q&#34;</span><span class="op" id="2855968">,</span>&nbsp;<span class="ident" id="2855970">s</span><span class="op" id="2855971">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855976">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855989">p</span><span class="op" id="2855990">.</span><span class="ident" id="2855991">printf</span><span class="op" id="2855997">(</span><span class="string" id="2855998">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="2856015">,</span>&nbsp;<span class="ident" id="2856017">x</span><span class="op" id="2856018">.</span><span class="ident" id="2856019">Type</span><span class="op" id="2856023">(</span><span class="op" id="2856024">)</span><span class="op" id="2856025">,</span>&nbsp;<span class="ident" id="2856027">x</span><span class="op" id="2856028">.</span><span class="ident" id="2856029">Len</span><span class="op" id="2856032">(</span><span class="op" id="2856033">)</span><span class="op" id="2856034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856038">if</span>&nbsp;<span class="ident" id="2856041">x</span><span class="op" id="2856042">.</span><span class="ident" id="2856043">Len</span><span class="op" id="2856046">(</span><span class="op" id="2856047">)</span>&nbsp;<span class="op" id="2856049">&gt;</span>&nbsp;<span class="num" id="2856051">0</span>&nbsp;<span class="op" id="2856053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856058">p</span><span class="op" id="2856059">.</span><span class="ident" id="2856060">indent</span><span class="op" id="2856066">++</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856072">p</span><span class="op" id="2856073">.</span><span class="ident" id="2856074">printf</span><span class="op" id="2856080">(</span><span class="string" id="2856081">&#34;\n&#34;</span><span class="op" id="2856085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856090">for</span>&nbsp;<span class="ident" id="2856094">i</span><span class="op" id="2856095">,</span>&nbsp;<span class="ident" id="2856097">n</span>&nbsp;<span class="op" id="2856099">:=</span>&nbsp;<span class="num" id="2856102">0</span><span class="op" id="2856103">,</span>&nbsp;<span class="ident" id="2856105">x</span><span class="op" id="2856106">.</span><span class="ident" id="2856107">Len</span><span class="op" id="2856110">(</span><span class="op" id="2856111">)</span><span class="op" id="2856112">;</span>&nbsp;<span class="ident" id="2856114">i</span>&nbsp;<span class="op" id="2856116">&lt;</span>&nbsp;<span class="ident" id="2856118">n</span><span class="op" id="2856119">;</span>&nbsp;<span class="ident" id="2856121">i</span><span class="op" id="2856122">++</span>&nbsp;<span class="op" id="2856125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856131">p</span><span class="op" id="2856132">.</span><span class="ident" id="2856133">printf</span><span class="op" id="2856139">(</span><span class="string" id="2856140">&#34;%d:&nbsp;&#34;</span><span class="op" id="2856146">,</span>&nbsp;<span class="ident" id="2856148">i</span><span class="op" id="2856149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856155">p</span><span class="op" id="2856156">.</span><span class="builtinfunc" id="2856157">print</span><span class="op" id="2856162">(</span><span class="ident" id="2856163">x</span><span class="op" id="2856164">.</span><span class="ident" id="2856165">Index</span><span class="op" id="2856170">(</span><span class="ident" id="2856171">i</span><span class="op" id="2856172">)</span><span class="op" id="2856173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856179">p</span><span class="op" id="2856180">.</span><span class="ident" id="2856181">printf</span><span class="op" id="2856187">(</span><span class="string" id="2856188">&#34;\n&#34;</span><span class="op" id="2856192">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856202">p</span><span class="op" id="2856203">.</span><span class="ident" id="2856204">indent</span><span class="op" id="2856210">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856219">p</span><span class="op" id="2856220">.</span><span class="ident" id="2856221">printf</span><span class="op" id="2856227">(</span><span class="string" id="2856228">&#34;}&#34;</span><span class="op" id="2856231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856235">case</span>&nbsp;<span class="ident" id="2856240">reflect</span><span class="op" id="2856247">.</span><span class="ident" id="2856248">Struct</span><span class="op" id="2856254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856258">t</span>&nbsp;<span class="op" id="2856260">:=</span>&nbsp;<span class="ident" id="2856263">x</span><span class="op" id="2856264">.</span><span class="ident" id="2856265">Type</span><span class="op" id="2856269">(</span><span class="op" id="2856270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856274">p</span><span class="op" id="2856275">.</span><span class="ident" id="2856276">printf</span><span class="op" id="2856282">(</span><span class="string" id="2856283">&#34;%s&nbsp;{&#34;</span><span class="op" id="2856289">,</span>&nbsp;<span class="ident" id="2856291">t</span><span class="op" id="2856292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856296">p</span><span class="op" id="2856297">.</span><span class="ident" id="2856298">indent</span><span class="op" id="2856304">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856309">first</span>&nbsp;<span class="op" id="2856315">:=</span>&nbsp;<span class="builtintype" id="2856318">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856325">for</span>&nbsp;<span class="ident" id="2856329">i</span><span class="op" id="2856330">,</span>&nbsp;<span class="ident" id="2856332">n</span>&nbsp;<span class="op" id="2856334">:=</span>&nbsp;<span class="num" id="2856337">0</span><span class="op" id="2856338">,</span>&nbsp;<span class="ident" id="2856340">t</span><span class="op" id="2856341">.</span><span class="ident" id="2856342">NumField</span><span class="op" id="2856350">(</span><span class="op" id="2856351">)</span><span class="op" id="2856352">;</span>&nbsp;<span class="ident" id="2856354">i</span>&nbsp;<span class="op" id="2856356">&lt;</span>&nbsp;<span class="ident" id="2856358">n</span><span class="op" id="2856359">;</span>&nbsp;<span class="ident" id="2856361">i</span><span class="op" id="2856362">++</span>&nbsp;<span class="op" id="2856365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2856370">//&nbsp;exclude&nbsp;non-exported&nbsp;fields&nbsp;because&nbsp;their</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2856418">//&nbsp;values&nbsp;cannot&nbsp;be&nbsp;accessed&nbsp;via&nbsp;reflection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856465">if</span>&nbsp;<span class="ident" id="2856468">name</span>&nbsp;<span class="op" id="2856473">:=</span>&nbsp;<span class="ident" id="2856476">t</span><span class="op" id="2856477">.</span><span class="ident" id="2856478">Field</span><span class="op" id="2856483">(</span><span class="ident" id="2856484">i</span><span class="op" id="2856485">)</span><span class="op" id="2856486">.</span><span class="ident" id="2856487">Name</span><span class="op" id="2856491">;</span>&nbsp;<span class="ident" id="2856493">IsExported</span><span class="op" id="2856503">(</span><span class="ident" id="2856504">name</span><span class="op" id="2856508">)</span>&nbsp;<span class="op" id="2856510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856516">value</span>&nbsp;<span class="op" id="2856522">:=</span>&nbsp;<span class="ident" id="2856525">x</span><span class="op" id="2856526">.</span><span class="ident" id="2856527">Field</span><span class="op" id="2856532">(</span><span class="ident" id="2856533">i</span><span class="op" id="2856534">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856540">if</span>&nbsp;<span class="ident" id="2856543">p</span><span class="op" id="2856544">.</span><span class="ident" id="2856545">filter</span>&nbsp;<span class="op" id="2856552">==</span>&nbsp;<span class="ident" id="2856555">nil</span>&nbsp;<span class="op" id="2856559">||</span>&nbsp;<span class="ident" id="2856562">p</span><span class="op" id="2856563">.</span><span class="ident" id="2856564">filter</span><span class="op" id="2856570">(</span><span class="ident" id="2856571">name</span><span class="op" id="2856575">,</span>&nbsp;<span class="ident" id="2856577">value</span><span class="op" id="2856582">)</span>&nbsp;<span class="op" id="2856584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856591">if</span>&nbsp;<span class="ident" id="2856594">first</span>&nbsp;<span class="op" id="2856600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856608">p</span><span class="op" id="2856609">.</span><span class="ident" id="2856610">printf</span><span class="op" id="2856616">(</span><span class="string" id="2856617">&#34;\n&#34;</span><span class="op" id="2856621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856629">first</span>&nbsp;<span class="op" id="2856635">=</span>&nbsp;<span class="builtintype" id="2856637">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856648">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856655">p</span><span class="op" id="2856656">.</span><span class="ident" id="2856657">printf</span><span class="op" id="2856663">(</span><span class="string" id="2856664">&#34;%s:&nbsp;&#34;</span><span class="op" id="2856670">,</span>&nbsp;<span class="ident" id="2856672">name</span><span class="op" id="2856676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856683">p</span><span class="op" id="2856684">.</span><span class="builtinfunc" id="2856685">print</span><span class="op" id="2856690">(</span><span class="ident" id="2856691">value</span><span class="op" id="2856696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856703">p</span><span class="op" id="2856704">.</span><span class="ident" id="2856705">printf</span><span class="op" id="2856711">(</span><span class="string" id="2856712">&#34;\n&#34;</span><span class="op" id="2856716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856727">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856735">p</span><span class="op" id="2856736">.</span><span class="ident" id="2856737">indent</span><span class="op" id="2856743">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856748">p</span><span class="op" id="2856749">.</span><span class="ident" id="2856750">printf</span><span class="op" id="2856756">(</span><span class="string" id="2856757">&#34;}&#34;</span><span class="op" id="2856760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856764">default</span><span class="op" id="2856771">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856775">v</span>&nbsp;<span class="op" id="2856777">:=</span>&nbsp;<span class="ident" id="2856780">x</span><span class="op" id="2856781">.</span><span class="ident" id="2856782">Interface</span><span class="op" id="2856791">(</span><span class="op" id="2856792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856796">switch</span>&nbsp;<span class="ident" id="2856803">v</span>&nbsp;<span class="op" id="2856805">:=</span>&nbsp;<span class="ident" id="2856808">v</span><span class="op" id="2856809">.</span><span class="op" id="2856810">(</span><span class="keyword" id="2856811">type</span><span class="op" id="2856815">)</span>&nbsp;<span class="op" id="2856817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856821">case</span>&nbsp;<span class="builtintype" id="2856826">string</span><span class="op" id="2856832">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2856837">//&nbsp;print&nbsp;strings&nbsp;in&nbsp;quotes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856867">p</span><span class="op" id="2856868">.</span><span class="ident" id="2856869">printf</span><span class="op" id="2856875">(</span><span class="string" id="2856876">&#34;%q&#34;</span><span class="op" id="2856880">,</span>&nbsp;<span class="ident" id="2856882">v</span><span class="op" id="2856883">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856888">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856897">case</span>&nbsp;<span class="ident" id="2856902">token</span><span class="op" id="2856907">.</span><span class="ident" id="2856908">Pos</span><span class="op" id="2856911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2856916">//&nbsp;position&nbsp;values&nbsp;can&nbsp;be&nbsp;printed&nbsp;nicely&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856982">if</span>&nbsp;<span class="ident" id="2856985">p</span><span class="op" id="2856986">.</span><span class="ident" id="2856987">fset</span>&nbsp;<span class="op" id="2856992">!=</span>&nbsp;<span class="ident" id="2856995">nil</span>&nbsp;<span class="op" id="2856999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2857005">p</span><span class="op" id="2857006">.</span><span class="ident" id="2857007">printf</span><span class="op" id="2857013">(</span><span class="string" id="2857014">&#34;%s&#34;</span><span class="op" id="2857018">,</span>&nbsp;<span class="ident" id="2857020">p</span><span class="op" id="2857021">.</span><span class="ident" id="2857022">fset</span><span class="op" id="2857026">.</span><span class="ident" id="2857027">Position</span><span class="op" id="2857035">(</span><span class="ident" id="2857036">v</span><span class="op" id="2857037">)</span><span class="op" id="2857038">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2857044">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2857054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2857058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2857062">//&nbsp;default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2857075">p</span><span class="op" id="2857076">.</span><span class="ident" id="2857077">printf</span><span class="op" id="2857083">(</span><span class="string" id="2857084">&#34;%v&#34;</span><span class="op" id="2857088">,</span>&nbsp;<span class="ident" id="2857090">v</span><span class="op" id="2857091">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2857094">}</span><br>
<span class="lineno"></span><span class="op" id="2857096">}</span>
</div>
</body>
</html>
