<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/gob</h2>
<ul>
<li><a href="/gostd/encoding/gob/codec_test.go.html">codec_test.go</a></li>
<li><a href="/gostd/encoding/gob/dec_helpers.go.html">dec_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/gob/decoder.go.html" class="current">decoder.go</a></li>
<li><a href="/gostd/encoding/gob/doc.go.html">doc.go</a></li>
<li><a href="/gostd/encoding/gob/enc_helpers.go.html">enc_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/gob/encoder.go.html">encoder.go</a></li>
<li><a href="/gostd/encoding/gob/encoder_test.go.html">encoder_test.go</a></li>
<li><a href="/gostd/encoding/gob/error.go.html">error.go</a></li>
<li><a href="/gostd/encoding/gob/example_encdec_test.go.html">example_encdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_interface_test.go.html">example_interface_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/gob/gobencdec_test.go.html">gobencdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/timing_test.go.html">timing_test.go</a></li>
<li><a href="/gostd/encoding/gob/type.go.html">type.go</a></li>
<li><a href="/gostd/encoding/gob/type_test.go.html">type_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5871572">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5871627">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5871681">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5871732">package</span>&nbsp;<span class="ident" id="5871740">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871745">import</span>&nbsp;<span class="op" id="5871752">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5871755">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5871764">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5871774">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5871780">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5871791">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="5871798">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5871801">//&nbsp;tooBig&nbsp;provides&nbsp;a&nbsp;sanity&nbsp;check&nbsp;for&nbsp;sizes;&nbsp;used&nbsp;in&nbsp;several&nbsp;places.</span><br>
<span class="lineno"></span><span class="comment" id="5871870">//&nbsp;Upper&nbsp;limit&nbsp;of&nbsp;1GB,&nbsp;allowing&nbsp;room&nbsp;to&nbsp;grow&nbsp;a&nbsp;little&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="comment" id="5871942">//&nbsp;TODO:&nbsp;make&nbsp;this&nbsp;adjustable?</span><br>
<span class="lineno"></span><span class="keyword" id="5871973">const</span>&nbsp;<span class="ident" id="5871979">tooBig</span>&nbsp;<span class="op" id="5871986">=</span>&nbsp;<span class="num" id="5871988">1</span>&nbsp;<span class="op" id="5871990">&lt;&lt;</span>&nbsp;<span class="num" id="5871993">30</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5871997">//&nbsp;A&nbsp;Decoder&nbsp;manages&nbsp;the&nbsp;receipt&nbsp;of&nbsp;type&nbsp;and&nbsp;data&nbsp;information&nbsp;read&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5872073">//&nbsp;remote&nbsp;side&nbsp;of&nbsp;a&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="5872105">type</span>&nbsp;<span class="ident" id="5872110">Decoder</span>&nbsp;<span class="keyword" id="5872118">struct</span>&nbsp;<span class="op" id="5872125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872128">mutex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872141">sync</span><span class="op" id="5872145">.</span><span class="ident" id="5872146">Mutex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872181">//&nbsp;each&nbsp;item&nbsp;must&nbsp;be&nbsp;received&nbsp;atomically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872223">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872236">io</span><span class="op" id="5872238">.</span><span class="ident" id="5872239">Reader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872276">//&nbsp;source&nbsp;of&nbsp;the&nbsp;data</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872299">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872312">decBuffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872352">//&nbsp;buffer&nbsp;for&nbsp;more&nbsp;efficient&nbsp;i/o&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872393">wireType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5872406">map</span><span class="op" id="5872409">[</span><span class="ident" id="5872410">typeId</span><span class="op" id="5872416">]</span><span class="op" id="5872417">*</span><span class="ident" id="5872418">wireType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872446">//&nbsp;map&nbsp;from&nbsp;remote&nbsp;ID&nbsp;to&nbsp;local&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872490">decoderCache</span>&nbsp;<span class="keyword" id="5872503">map</span><span class="op" id="5872506">[</span><span class="ident" id="5872507">reflect</span><span class="op" id="5872514">.</span><span class="ident" id="5872515">Type</span><span class="op" id="5872519">]</span><span class="keyword" id="5872520">map</span><span class="op" id="5872523">[</span><span class="ident" id="5872524">typeId</span><span class="op" id="5872530">]</span><span class="op" id="5872531">*</span><span class="op" id="5872532">*</span><span class="ident" id="5872533">decEngine</span>&nbsp;<span class="comment" id="5872543">//&nbsp;cache&nbsp;of&nbsp;compiled&nbsp;engines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872573">ignorerCache</span>&nbsp;<span class="keyword" id="5872586">map</span><span class="op" id="5872589">[</span><span class="ident" id="5872590">typeId</span><span class="op" id="5872596">]</span><span class="op" id="5872597">*</span><span class="op" id="5872598">*</span><span class="ident" id="5872599">decEngine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872626">//&nbsp;ditto&nbsp;for&nbsp;ignored&nbsp;objects</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872656">freeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5872669">*</span><span class="ident" id="5872670">decoderState</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872709">//&nbsp;list&nbsp;of&nbsp;free&nbsp;decoderStates;&nbsp;avoids&nbsp;reallocation</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872761">countBuf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5872774">[</span><span class="op" id="5872775">]</span><span class="builtintype" id="5872776">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5872814">//&nbsp;used&nbsp;for&nbsp;decoding&nbsp;integers&nbsp;while&nbsp;parsing&nbsp;messages</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872868">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5872881">error</span><br>
<span class="lineno"></span><span class="op" id="5872887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5872890">//&nbsp;NewDecoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;decoder&nbsp;that&nbsp;reads&nbsp;from&nbsp;the&nbsp;io.Reader.</span><br>
<span class="lineno">35</span><span class="comment" id="5872957">//&nbsp;If&nbsp;r&nbsp;does&nbsp;not&nbsp;also&nbsp;implement&nbsp;io.ByteReader,&nbsp;it&nbsp;will&nbsp;be&nbsp;wrapped&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5873028">//&nbsp;bufio.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5873045">func</span>&nbsp;<span class="ident" id="5873050">NewDecoder</span><span class="op" id="5873060">(</span><span class="ident" id="5873061">r</span>&nbsp;<span class="ident" id="5873063">io</span><span class="op" id="5873065">.</span><span class="ident" id="5873066">Reader</span><span class="op" id="5873072">)</span>&nbsp;<span class="op" id="5873074">*</span><span class="ident" id="5873075">Decoder</span>&nbsp;<span class="op" id="5873083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873086">dec</span>&nbsp;<span class="op" id="5873090">:=</span>&nbsp;<span class="builtinfunc" id="5873093">new</span><span class="op" id="5873096">(</span><span class="ident" id="5873097">Decoder</span><span class="op" id="5873104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5873107">//&nbsp;We&nbsp;use&nbsp;the&nbsp;ability&nbsp;to&nbsp;read&nbsp;bytes&nbsp;as&nbsp;a&nbsp;plausible&nbsp;surrogate&nbsp;for&nbsp;buffering.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873184">if</span>&nbsp;<span class="ident" id="5873187">_</span><span class="op" id="5873188">,</span>&nbsp;<span class="ident" id="5873190">ok</span>&nbsp;<span class="op" id="5873193">:=</span>&nbsp;<span class="ident" id="5873196">r</span><span class="op" id="5873197">.</span><span class="op" id="5873198">(</span><span class="ident" id="5873199">io</span><span class="op" id="5873201">.</span><span class="ident" id="5873202">ByteReader</span><span class="op" id="5873212">)</span><span class="op" id="5873213">;</span>&nbsp;<span class="op" id="5873215">!</span><span class="ident" id="5873216">ok</span>&nbsp;<span class="op" id="5873219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873223">r</span>&nbsp;<span class="op" id="5873225">=</span>&nbsp;<span class="ident" id="5873227">bufio</span><span class="op" id="5873232">.</span><span class="ident" id="5873233">NewReader</span><span class="op" id="5873242">(</span><span class="ident" id="5873243">r</span><span class="op" id="5873244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873250">dec</span><span class="op" id="5873253">.</span><span class="ident" id="5873254">r</span>&nbsp;<span class="op" id="5873256">=</span>&nbsp;<span class="ident" id="5873258">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873261">dec</span><span class="op" id="5873264">.</span><span class="ident" id="5873265">wireType</span>&nbsp;<span class="op" id="5873274">=</span>&nbsp;<span class="builtinfunc" id="5873276">make</span><span class="op" id="5873280">(</span><span class="keyword" id="5873281">map</span><span class="op" id="5873284">[</span><span class="ident" id="5873285">typeId</span><span class="op" id="5873291">]</span><span class="op" id="5873292">*</span><span class="ident" id="5873293">wireType</span><span class="op" id="5873301">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873304">dec</span><span class="op" id="5873307">.</span><span class="ident" id="5873308">decoderCache</span>&nbsp;<span class="op" id="5873321">=</span>&nbsp;<span class="builtinfunc" id="5873323">make</span><span class="op" id="5873327">(</span><span class="keyword" id="5873328">map</span><span class="op" id="5873331">[</span><span class="ident" id="5873332">reflect</span><span class="op" id="5873339">.</span><span class="ident" id="5873340">Type</span><span class="op" id="5873344">]</span><span class="keyword" id="5873345">map</span><span class="op" id="5873348">[</span><span class="ident" id="5873349">typeId</span><span class="op" id="5873355">]</span><span class="op" id="5873356">*</span><span class="op" id="5873357">*</span><span class="ident" id="5873358">decEngine</span><span class="op" id="5873367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873370">dec</span><span class="op" id="5873373">.</span><span class="ident" id="5873374">ignorerCache</span>&nbsp;<span class="op" id="5873387">=</span>&nbsp;<span class="builtinfunc" id="5873389">make</span><span class="op" id="5873393">(</span><span class="keyword" id="5873394">map</span><span class="op" id="5873397">[</span><span class="ident" id="5873398">typeId</span><span class="op" id="5873404">]</span><span class="op" id="5873405">*</span><span class="op" id="5873406">*</span><span class="ident" id="5873407">decEngine</span><span class="op" id="5873416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873419">dec</span><span class="op" id="5873422">.</span><span class="ident" id="5873423">countBuf</span>&nbsp;<span class="op" id="5873432">=</span>&nbsp;<span class="builtinfunc" id="5873434">make</span><span class="op" id="5873438">(</span><span class="op" id="5873439">[</span><span class="op" id="5873440">]</span><span class="builtintype" id="5873441">byte</span><span class="op" id="5873445">,</span>&nbsp;<span class="num" id="5873447">9</span><span class="op" id="5873448">)</span>&nbsp;<span class="comment" id="5873450">//&nbsp;counts&nbsp;may&nbsp;be&nbsp;uint64s&nbsp;(unlikely!),&nbsp;require&nbsp;9&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873506">return</span>&nbsp;<span class="ident" id="5873513">dec</span><br>
<span class="lineno">50</span><span class="op" id="5873517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5873520">//&nbsp;recvType&nbsp;loads&nbsp;the&nbsp;definition&nbsp;of&nbsp;a&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5873564">func</span>&nbsp;<span class="op" id="5873569">(</span><span class="ident" id="5873570">dec</span>&nbsp;<span class="op" id="5873574">*</span><span class="ident" id="5873575">Decoder</span><span class="op" id="5873582">)</span>&nbsp;<span class="ident" id="5873584">recvType</span><span class="op" id="5873592">(</span><span class="ident" id="5873593">id</span>&nbsp;<span class="ident" id="5873596">typeId</span><span class="op" id="5873602">)</span>&nbsp;<span class="op" id="5873604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5873607">//&nbsp;Have&nbsp;we&nbsp;already&nbsp;seen&nbsp;this&nbsp;type?&nbsp;&nbsp;That&#39;s&nbsp;an&nbsp;error</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873660">if</span>&nbsp;<span class="ident" id="5873663">id</span>&nbsp;<span class="op" id="5873666">&lt;</span>&nbsp;<span class="ident" id="5873668">firstUserId</span>&nbsp;<span class="op" id="5873680">||</span>&nbsp;<span class="ident" id="5873683">dec</span><span class="op" id="5873686">.</span><span class="ident" id="5873687">wireType</span><span class="op" id="5873695">[</span><span class="ident" id="5873696">id</span><span class="op" id="5873698">]</span>&nbsp;<span class="op" id="5873700">!=</span>&nbsp;<span class="builtintype" id="5873703">nil</span>&nbsp;<span class="op" id="5873707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873711">dec</span><span class="op" id="5873714">.</span><span class="ident" id="5873715">err</span>&nbsp;<span class="op" id="5873719">=</span>&nbsp;<span class="ident" id="5873721">errors</span><span class="op" id="5873727">.</span><span class="ident" id="5873728">New</span><span class="op" id="5873731">(</span><span class="string" id="5873732">&#34;gob:&nbsp;duplicate&nbsp;type&nbsp;received&#34;</span><span class="op" id="5873762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873766">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5873778">//&nbsp;Type:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873788">wire</span>&nbsp;<span class="op" id="5873793">:=</span>&nbsp;<span class="builtinfunc" id="5873796">new</span><span class="op" id="5873799">(</span><span class="ident" id="5873800">wireType</span><span class="op" id="5873808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873811">dec</span><span class="op" id="5873814">.</span><span class="ident" id="5873815">decodeValue</span><span class="op" id="5873826">(</span><span class="ident" id="5873827">tWireType</span><span class="op" id="5873836">,</span>&nbsp;<span class="ident" id="5873838">reflect</span><span class="op" id="5873845">.</span><span class="ident" id="5873846">ValueOf</span><span class="op" id="5873853">(</span><span class="ident" id="5873854">wire</span><span class="op" id="5873858">)</span><span class="op" id="5873859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873862">if</span>&nbsp;<span class="ident" id="5873865">dec</span><span class="op" id="5873868">.</span><span class="ident" id="5873869">err</span>&nbsp;<span class="op" id="5873873">!=</span>&nbsp;<span class="builtintype" id="5873876">nil</span>&nbsp;<span class="op" id="5873880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5873884">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5873892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5873895">//&nbsp;Remember&nbsp;we&#39;ve&nbsp;seen&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5873930">dec</span><span class="op" id="5873933">.</span><span class="ident" id="5873934">wireType</span><span class="op" id="5873942">[</span><span class="ident" id="5873943">id</span><span class="op" id="5873945">]</span>&nbsp;<span class="op" id="5873947">=</span>&nbsp;<span class="ident" id="5873949">wire</span><br>
<span class="lineno"></span><span class="op" id="5873954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="5873957">var</span>&nbsp;<span class="ident" id="5873961">errBadCount</span>&nbsp;<span class="op" id="5873973">=</span>&nbsp;<span class="ident" id="5873975">errors</span><span class="op" id="5873981">.</span><span class="ident" id="5873982">New</span><span class="op" id="5873985">(</span><span class="string" id="5873986">&#34;invalid&nbsp;message&nbsp;length&#34;</span><span class="op" id="5874010">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5874013">//&nbsp;recvMessage&nbsp;reads&nbsp;the&nbsp;next&nbsp;count-delimited&nbsp;item&nbsp;from&nbsp;the&nbsp;input.&nbsp;It&nbsp;is&nbsp;the&nbsp;converse</span><br>
<span class="lineno"></span><span class="comment" id="5874099">//&nbsp;of&nbsp;Encoder.writeMessage.&nbsp;It&nbsp;returns&nbsp;false&nbsp;on&nbsp;EOF&nbsp;or&nbsp;other&nbsp;error&nbsp;reading&nbsp;the&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="5874187">func</span>&nbsp;<span class="op" id="5874192">(</span><span class="ident" id="5874193">dec</span>&nbsp;<span class="op" id="5874197">*</span><span class="ident" id="5874198">Decoder</span><span class="op" id="5874205">)</span>&nbsp;<span class="ident" id="5874207">recvMessage</span><span class="op" id="5874218">(</span><span class="op" id="5874219">)</span>&nbsp;<span class="builtintype" id="5874221">bool</span>&nbsp;<span class="op" id="5874226">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5874229">//&nbsp;Read&nbsp;a&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874247">nbytes</span><span class="op" id="5874253">,</span>&nbsp;<span class="ident" id="5874255">_</span><span class="op" id="5874256">,</span>&nbsp;<span class="ident" id="5874258">err</span>&nbsp;<span class="op" id="5874262">:=</span>&nbsp;<span class="ident" id="5874265">decodeUintReader</span><span class="op" id="5874281">(</span><span class="ident" id="5874282">dec</span><span class="op" id="5874285">.</span><span class="ident" id="5874286">r</span><span class="op" id="5874287">,</span>&nbsp;<span class="ident" id="5874289">dec</span><span class="op" id="5874292">.</span><span class="ident" id="5874293">countBuf</span><span class="op" id="5874301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874304">if</span>&nbsp;<span class="ident" id="5874307">err</span>&nbsp;<span class="op" id="5874311">!=</span>&nbsp;<span class="builtintype" id="5874314">nil</span>&nbsp;<span class="op" id="5874318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874322">dec</span><span class="op" id="5874325">.</span><span class="ident" id="5874326">err</span>&nbsp;<span class="op" id="5874330">=</span>&nbsp;<span class="ident" id="5874332">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874338">return</span>&nbsp;<span class="builtintype" id="5874345">false</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874355">if</span>&nbsp;<span class="ident" id="5874358">nbytes</span>&nbsp;<span class="op" id="5874365">&gt;=</span>&nbsp;<span class="ident" id="5874368">tooBig</span>&nbsp;<span class="op" id="5874375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874379">dec</span><span class="op" id="5874382">.</span><span class="ident" id="5874383">err</span>&nbsp;<span class="op" id="5874387">=</span>&nbsp;<span class="ident" id="5874389">errBadCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874403">return</span>&nbsp;<span class="builtintype" id="5874410">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874417">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874420">dec</span><span class="op" id="5874423">.</span><span class="ident" id="5874424">readMessage</span><span class="op" id="5874435">(</span><span class="builtintype" id="5874436">int</span><span class="op" id="5874439">(</span><span class="ident" id="5874440">nbytes</span><span class="op" id="5874446">)</span><span class="op" id="5874447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874450">return</span>&nbsp;<span class="ident" id="5874457">dec</span><span class="op" id="5874460">.</span><span class="ident" id="5874461">err</span>&nbsp;<span class="op" id="5874465">==</span>&nbsp;<span class="builtintype" id="5874468">nil</span><br>
<span class="lineno"></span><span class="op" id="5874472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5874475">//&nbsp;readMessage&nbsp;reads&nbsp;the&nbsp;next&nbsp;nbytes&nbsp;bytes&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">90</span><span class="keyword" id="5874534">func</span>&nbsp;<span class="op" id="5874539">(</span><span class="ident" id="5874540">dec</span>&nbsp;<span class="op" id="5874544">*</span><span class="ident" id="5874545">Decoder</span><span class="op" id="5874552">)</span>&nbsp;<span class="ident" id="5874554">readMessage</span><span class="op" id="5874565">(</span><span class="ident" id="5874566">nbytes</span>&nbsp;<span class="builtintype" id="5874573">int</span><span class="op" id="5874576">)</span>&nbsp;<span class="op" id="5874578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874581">if</span>&nbsp;<span class="ident" id="5874584">dec</span><span class="op" id="5874587">.</span><span class="ident" id="5874588">buf</span><span class="op" id="5874591">.</span><span class="ident" id="5874592">Len</span><span class="op" id="5874595">(</span><span class="op" id="5874596">)</span>&nbsp;<span class="op" id="5874598">!=</span>&nbsp;<span class="num" id="5874601">0</span>&nbsp;<span class="op" id="5874603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5874607">//&nbsp;The&nbsp;buffer&nbsp;should&nbsp;always&nbsp;be&nbsp;empty&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5874651">panic</span><span class="op" id="5874656">(</span><span class="string" id="5874657">&#34;non-empty&nbsp;decoder&nbsp;buffer&#34;</span><span class="op" id="5874683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874686">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5874689">//&nbsp;Read&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874707">dec</span><span class="op" id="5874710">.</span><span class="ident" id="5874711">buf</span><span class="op" id="5874714">.</span><span class="ident" id="5874715">Size</span><span class="op" id="5874719">(</span><span class="ident" id="5874720">nbytes</span><span class="op" id="5874726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874729">_</span><span class="op" id="5874730">,</span>&nbsp;<span class="ident" id="5874732">dec</span><span class="op" id="5874735">.</span><span class="ident" id="5874736">err</span>&nbsp;<span class="op" id="5874740">=</span>&nbsp;<span class="ident" id="5874742">io</span><span class="op" id="5874744">.</span><span class="ident" id="5874745">ReadFull</span><span class="op" id="5874753">(</span><span class="ident" id="5874754">dec</span><span class="op" id="5874757">.</span><span class="ident" id="5874758">r</span><span class="op" id="5874759">,</span>&nbsp;<span class="ident" id="5874761">dec</span><span class="op" id="5874764">.</span><span class="ident" id="5874765">buf</span><span class="op" id="5874768">.</span><span class="ident" id="5874769">Bytes</span><span class="op" id="5874774">(</span><span class="op" id="5874775">)</span><span class="op" id="5874776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874779">if</span>&nbsp;<span class="ident" id="5874782">dec</span><span class="op" id="5874785">.</span><span class="ident" id="5874786">err</span>&nbsp;<span class="op" id="5874790">!=</span>&nbsp;<span class="builtintype" id="5874793">nil</span>&nbsp;<span class="op" id="5874797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874801">if</span>&nbsp;<span class="ident" id="5874804">dec</span><span class="op" id="5874807">.</span><span class="ident" id="5874808">err</span>&nbsp;<span class="op" id="5874812">==</span>&nbsp;<span class="ident" id="5874815">io</span><span class="op" id="5874817">.</span><span class="ident" id="5874818">EOF</span>&nbsp;<span class="op" id="5874822">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874827">dec</span><span class="op" id="5874830">.</span><span class="ident" id="5874831">err</span>&nbsp;<span class="op" id="5874835">=</span>&nbsp;<span class="ident" id="5874837">io</span><span class="op" id="5874839">.</span><span class="ident" id="5874840">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5874862">}</span><br>
<span class="lineno"></span><span class="op" id="5874864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="5874867">//&nbsp;toInt&nbsp;turns&nbsp;an&nbsp;encoded&nbsp;uint64&nbsp;into&nbsp;an&nbsp;int,&nbsp;according&nbsp;to&nbsp;the&nbsp;marshaling&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="5874948">func</span>&nbsp;<span class="ident" id="5874953">toInt</span><span class="op" id="5874958">(</span><span class="ident" id="5874959">x</span>&nbsp;<span class="ident" id="5874961">uint64</span><span class="op" id="5874967">)</span>&nbsp;<span class="ident" id="5874969">int64</span>&nbsp;<span class="op" id="5874975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5874978">i</span>&nbsp;<span class="op" id="5874980">:=</span>&nbsp;<span class="ident" id="5874983">int64</span><span class="op" id="5874988">(</span><span class="ident" id="5874989">x</span>&nbsp;<span class="op" id="5874991">&gt;&gt;</span>&nbsp;<span class="num" id="5874994">1</span><span class="op" id="5874995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5874998">if</span>&nbsp;<span class="ident" id="5875001">x</span><span class="op" id="5875002">&amp;</span><span class="num" id="5875003">1</span>&nbsp;<span class="op" id="5875005">!=</span>&nbsp;<span class="num" id="5875008">0</span>&nbsp;<span class="op" id="5875010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5875014">i</span>&nbsp;<span class="op" id="5875016">=</span>&nbsp;<span class="op" id="5875018">^</span><span class="ident" id="5875019">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5875022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875025">return</span>&nbsp;<span class="ident" id="5875032">i</span><br>
<span class="lineno"></span><span class="op" id="5875034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5875037">func</span>&nbsp;<span class="op" id="5875042">(</span><span class="ident" id="5875043">dec</span>&nbsp;<span class="op" id="5875047">*</span><span class="ident" id="5875048">Decoder</span><span class="op" id="5875055">)</span>&nbsp;<span class="ident" id="5875057">nextInt</span><span class="op" id="5875064">(</span><span class="op" id="5875065">)</span>&nbsp;<span class="ident" id="5875067">int64</span>&nbsp;<span class="op" id="5875073">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5875076">n</span><span class="op" id="5875077">,</span>&nbsp;<span class="ident" id="5875079">_</span><span class="op" id="5875080">,</span>&nbsp;<span class="ident" id="5875082">err</span>&nbsp;<span class="op" id="5875086">:=</span>&nbsp;<span class="ident" id="5875089">decodeUintReader</span><span class="op" id="5875105">(</span><span class="op" id="5875106">&amp;</span><span class="ident" id="5875107">dec</span><span class="op" id="5875110">.</span><span class="ident" id="5875111">buf</span><span class="op" id="5875114">,</span>&nbsp;<span class="ident" id="5875116">dec</span><span class="op" id="5875119">.</span><span class="ident" id="5875120">countBuf</span><span class="op" id="5875128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875131">if</span>&nbsp;<span class="ident" id="5875134">err</span>&nbsp;<span class="op" id="5875138">!=</span>&nbsp;<span class="builtintype" id="5875141">nil</span>&nbsp;<span class="op" id="5875145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5875149">dec</span><span class="op" id="5875152">.</span><span class="ident" id="5875153">err</span>&nbsp;<span class="op" id="5875157">=</span>&nbsp;<span class="ident" id="5875159">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5875164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875167">return</span>&nbsp;<span class="ident" id="5875174">toInt</span><span class="op" id="5875179">(</span><span class="ident" id="5875180">n</span><span class="op" id="5875181">)</span><br>
<span class="lineno">120</span><span class="op" id="5875183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5875186">func</span>&nbsp;<span class="op" id="5875191">(</span><span class="ident" id="5875192">dec</span>&nbsp;<span class="op" id="5875196">*</span><span class="ident" id="5875197">Decoder</span><span class="op" id="5875204">)</span>&nbsp;<span class="ident" id="5875206">nextUint</span><span class="op" id="5875214">(</span><span class="op" id="5875215">)</span>&nbsp;<span class="ident" id="5875217">uint64</span>&nbsp;<span class="op" id="5875224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5875227">n</span><span class="op" id="5875228">,</span>&nbsp;<span class="ident" id="5875230">_</span><span class="op" id="5875231">,</span>&nbsp;<span class="ident" id="5875233">err</span>&nbsp;<span class="op" id="5875237">:=</span>&nbsp;<span class="ident" id="5875240">decodeUintReader</span><span class="op" id="5875256">(</span><span class="op" id="5875257">&amp;</span><span class="ident" id="5875258">dec</span><span class="op" id="5875261">.</span><span class="ident" id="5875262">buf</span><span class="op" id="5875265">,</span>&nbsp;<span class="ident" id="5875267">dec</span><span class="op" id="5875270">.</span><span class="ident" id="5875271">countBuf</span><span class="op" id="5875279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875282">if</span>&nbsp;<span class="ident" id="5875285">err</span>&nbsp;<span class="op" id="5875289">!=</span>&nbsp;<span class="builtintype" id="5875292">nil</span>&nbsp;<span class="op" id="5875296">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5875300">dec</span><span class="op" id="5875303">.</span><span class="ident" id="5875304">err</span>&nbsp;<span class="op" id="5875308">=</span>&nbsp;<span class="ident" id="5875310">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5875315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875318">return</span>&nbsp;<span class="ident" id="5875325">n</span><br>
<span class="lineno"></span><span class="op" id="5875327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5875330">//&nbsp;decodeTypeSequence&nbsp;parses:</span><br>
<span class="lineno"></span><span class="comment" id="5875360">//&nbsp;TypeSequence</span><br>
<span class="lineno"></span><span class="comment" id="5875376">//&nbsp;&nbsp;&nbsp;&nbsp;(TypeDefinition&nbsp;DelimitedTypeDefinition*)?</span><br>
<span class="lineno"></span><span class="comment" id="5875422">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type&nbsp;id&nbsp;of&nbsp;the&nbsp;next&nbsp;value.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5875486">//&nbsp;EOF.&nbsp;&nbsp;Upon&nbsp;return,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;dec.buf&nbsp;is&nbsp;the&nbsp;value&nbsp;to&nbsp;be</span><br>
<span class="lineno">135</span><span class="comment" id="5875552">//&nbsp;decoded.&nbsp;&nbsp;If&nbsp;this&nbsp;is&nbsp;an&nbsp;interface&nbsp;value,&nbsp;it&nbsp;can&nbsp;be&nbsp;ignored&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5875617">//&nbsp;resetting&nbsp;that&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="5875643">func</span>&nbsp;<span class="op" id="5875648">(</span><span class="ident" id="5875649">dec</span>&nbsp;<span class="op" id="5875653">*</span><span class="ident" id="5875654">Decoder</span><span class="op" id="5875661">)</span>&nbsp;<span class="ident" id="5875663">decodeTypeSequence</span><span class="op" id="5875681">(</span><span class="ident" id="5875682">isInterface</span>&nbsp;<span class="builtintype" id="5875694">bool</span><span class="op" id="5875698">)</span>&nbsp;<span class="ident" id="5875700">typeId</span>&nbsp;<span class="op" id="5875707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875710">for</span>&nbsp;<span class="ident" id="5875714">dec</span><span class="op" id="5875717">.</span><span class="ident" id="5875718">err</span>&nbsp;<span class="op" id="5875722">==</span>&nbsp;<span class="builtintype" id="5875725">nil</span>&nbsp;<span class="op" id="5875729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875733">if</span>&nbsp;<span class="ident" id="5875736">dec</span><span class="op" id="5875739">.</span><span class="ident" id="5875740">buf</span><span class="op" id="5875743">.</span><span class="ident" id="5875744">Len</span><span class="op" id="5875747">(</span><span class="op" id="5875748">)</span>&nbsp;<span class="op" id="5875750">==</span>&nbsp;<span class="num" id="5875753">0</span>&nbsp;<span class="op" id="5875755">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875760">if</span>&nbsp;<span class="op" id="5875763">!</span><span class="ident" id="5875764">dec</span><span class="op" id="5875767">.</span><span class="ident" id="5875768">recvMessage</span><span class="op" id="5875779">(</span><span class="op" id="5875780">)</span>&nbsp;<span class="op" id="5875782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875788">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5875797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5875801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5875805">//&nbsp;Receive&nbsp;a&nbsp;type&nbsp;id.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5875829">id</span>&nbsp;<span class="op" id="5875832">:=</span>&nbsp;<span class="ident" id="5875835">typeId</span><span class="op" id="5875841">(</span><span class="ident" id="5875842">dec</span><span class="op" id="5875845">.</span><span class="ident" id="5875846">nextInt</span><span class="op" id="5875853">(</span><span class="op" id="5875854">)</span><span class="op" id="5875855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875859">if</span>&nbsp;<span class="ident" id="5875862">id</span>&nbsp;<span class="op" id="5875865">&gt;=</span>&nbsp;<span class="num" id="5875868">0</span>&nbsp;<span class="op" id="5875870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5875875">//&nbsp;Value&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5875896">return</span>&nbsp;<span class="ident" id="5875903">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5875908">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5875912">//&nbsp;Type&nbsp;definition&nbsp;for&nbsp;(-id)&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5875952">dec</span><span class="op" id="5875955">.</span><span class="ident" id="5875956">recvType</span><span class="op" id="5875964">(</span><span class="op" id="5875965">-</span><span class="ident" id="5875966">id</span><span class="op" id="5875968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5875972">//&nbsp;When&nbsp;decoding&nbsp;an&nbsp;interface,&nbsp;after&nbsp;a&nbsp;type&nbsp;there&nbsp;may&nbsp;be&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5876033">//&nbsp;DelimitedValue&nbsp;still&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;&nbsp;Skip&nbsp;its&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5876091">//&nbsp;(Alternatively,&nbsp;the&nbsp;buffer&nbsp;is&nbsp;empty&nbsp;and&nbsp;the&nbsp;byte&nbsp;count</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5876151">//&nbsp;will&nbsp;be&nbsp;absorbed&nbsp;by&nbsp;recvMessage.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876190">if</span>&nbsp;<span class="ident" id="5876193">dec</span><span class="op" id="5876196">.</span><span class="ident" id="5876197">buf</span><span class="op" id="5876200">.</span><span class="ident" id="5876201">Len</span><span class="op" id="5876204">(</span><span class="op" id="5876205">)</span>&nbsp;<span class="op" id="5876207">&gt;</span>&nbsp;<span class="num" id="5876209">0</span>&nbsp;<span class="op" id="5876211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876216">if</span>&nbsp;<span class="op" id="5876219">!</span><span class="ident" id="5876220">isInterface</span>&nbsp;<span class="op" id="5876232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876238">dec</span><span class="op" id="5876241">.</span><span class="ident" id="5876242">err</span>&nbsp;<span class="op" id="5876246">=</span>&nbsp;<span class="ident" id="5876248">errors</span><span class="op" id="5876254">.</span><span class="ident" id="5876255">New</span><span class="op" id="5876258">(</span><span class="string" id="5876259">&#34;extra&nbsp;data&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="5876281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876287">break</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876301">dec</span><span class="op" id="5876304">.</span><span class="ident" id="5876305">nextUint</span><span class="op" id="5876313">(</span><span class="op" id="5876314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876324">return</span>&nbsp;<span class="op" id="5876331">-</span><span class="num" id="5876332">1</span><br>
<span class="lineno">165</span><span class="op" id="5876334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5876337">//&nbsp;Decode&nbsp;reads&nbsp;the&nbsp;next&nbsp;value&nbsp;from&nbsp;the&nbsp;input&nbsp;stream&nbsp;and&nbsp;stores</span><br>
<span class="lineno"></span><span class="comment" id="5876401">//&nbsp;it&nbsp;in&nbsp;the&nbsp;data&nbsp;represented&nbsp;by&nbsp;the&nbsp;empty&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5876461">//&nbsp;If&nbsp;e&nbsp;is&nbsp;nil,&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;discarded.&nbsp;Otherwise,</span><br>
<span class="lineno">170</span><span class="comment" id="5876517">//&nbsp;the&nbsp;value&nbsp;underlying&nbsp;e&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5876568">//&nbsp;correct&nbsp;type&nbsp;for&nbsp;the&nbsp;next&nbsp;data&nbsp;item&nbsp;received.</span><br>
<span class="lineno"></span><span class="comment" id="5876617">//&nbsp;If&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;EOF,&nbsp;Decode&nbsp;returns&nbsp;io.EOF&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5876670">//&nbsp;does&nbsp;not&nbsp;modify&nbsp;e.</span><br>
<span class="lineno"></span><span class="keyword" id="5876692">func</span>&nbsp;<span class="op" id="5876697">(</span><span class="ident" id="5876698">dec</span>&nbsp;<span class="op" id="5876702">*</span><span class="ident" id="5876703">Decoder</span><span class="op" id="5876710">)</span>&nbsp;<span class="ident" id="5876712">Decode</span><span class="op" id="5876718">(</span><span class="ident" id="5876719">e</span>&nbsp;<span class="keyword" id="5876721">interface</span><span class="op" id="5876730">{</span><span class="op" id="5876731">}</span><span class="op" id="5876732">)</span>&nbsp;<span class="builtintype" id="5876734">error</span>&nbsp;<span class="op" id="5876740">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876743">if</span>&nbsp;<span class="ident" id="5876746">e</span>&nbsp;<span class="op" id="5876748">==</span>&nbsp;<span class="builtintype" id="5876751">nil</span>&nbsp;<span class="op" id="5876755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876759">return</span>&nbsp;<span class="ident" id="5876766">dec</span><span class="op" id="5876769">.</span><span class="ident" id="5876770">DecodeValue</span><span class="op" id="5876781">(</span><span class="ident" id="5876782">reflect</span><span class="op" id="5876789">.</span><span class="ident" id="5876790">Value</span><span class="op" id="5876795">{</span><span class="op" id="5876796">}</span><span class="op" id="5876797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5876800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876803">value</span>&nbsp;<span class="op" id="5876809">:=</span>&nbsp;<span class="ident" id="5876812">reflect</span><span class="op" id="5876819">.</span><span class="ident" id="5876820">ValueOf</span><span class="op" id="5876827">(</span><span class="ident" id="5876828">e</span><span class="op" id="5876829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5876832">//&nbsp;If&nbsp;e&nbsp;represents&nbsp;a&nbsp;value&nbsp;as&nbsp;opposed&nbsp;to&nbsp;a&nbsp;pointer,&nbsp;the&nbsp;answer&nbsp;won&#39;t</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5876902">//&nbsp;get&nbsp;back&nbsp;to&nbsp;the&nbsp;caller.&nbsp;&nbsp;Make&nbsp;sure&nbsp;it&#39;s&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5876957">if</span>&nbsp;<span class="ident" id="5876960">value</span><span class="op" id="5876965">.</span><span class="ident" id="5876966">Type</span><span class="op" id="5876970">(</span><span class="op" id="5876971">)</span><span class="op" id="5876972">.</span><span class="ident" id="5876973">Kind</span><span class="op" id="5876977">(</span><span class="op" id="5876978">)</span>&nbsp;<span class="op" id="5876980">!=</span>&nbsp;<span class="ident" id="5876983">reflect</span><span class="op" id="5876990">.</span><span class="ident" id="5876991">Ptr</span>&nbsp;<span class="op" id="5876995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5876999">dec</span><span class="op" id="5877002">.</span><span class="ident" id="5877003">err</span>&nbsp;<span class="op" id="5877007">=</span>&nbsp;<span class="ident" id="5877009">errors</span><span class="op" id="5877015">.</span><span class="ident" id="5877016">New</span><span class="op" id="5877019">(</span><span class="string" id="5877020">&#34;gob:&nbsp;attempt&nbsp;to&nbsp;decode&nbsp;into&nbsp;a&nbsp;non-pointer&#34;</span><span class="op" id="5877063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877067">return</span>&nbsp;<span class="ident" id="5877074">dec</span><span class="op" id="5877077">.</span><span class="ident" id="5877078">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877083">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877086">return</span>&nbsp;<span class="ident" id="5877093">dec</span><span class="op" id="5877096">.</span><span class="ident" id="5877097">DecodeValue</span><span class="op" id="5877108">(</span><span class="ident" id="5877109">value</span><span class="op" id="5877114">)</span><br>
<span class="lineno"></span><span class="op" id="5877116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5877119">//&nbsp;DecodeValue&nbsp;reads&nbsp;the&nbsp;next&nbsp;value&nbsp;from&nbsp;the&nbsp;input&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="5877178">//&nbsp;If&nbsp;v&nbsp;is&nbsp;the&nbsp;zero&nbsp;reflect.Value&nbsp;(v.Kind()&nbsp;==&nbsp;Invalid),&nbsp;DecodeValue&nbsp;discards&nbsp;the&nbsp;value.</span><br>
<span class="lineno">190</span><span class="comment" id="5877267">//&nbsp;Otherwise,&nbsp;it&nbsp;stores&nbsp;the&nbsp;value&nbsp;into&nbsp;v.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;v&nbsp;must&nbsp;represent</span><br>
<span class="lineno"></span><span class="comment" id="5877341">//&nbsp;a&nbsp;non-nil&nbsp;pointer&nbsp;to&nbsp;data&nbsp;or&nbsp;be&nbsp;an&nbsp;assignable&nbsp;reflect.Value&nbsp;(v.CanSet())</span><br>
<span class="lineno"></span><span class="comment" id="5877417">//&nbsp;If&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;EOF,&nbsp;DecodeValue&nbsp;returns&nbsp;io.EOF&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5877475">//&nbsp;does&nbsp;not&nbsp;modify&nbsp;v.</span><br>
<span class="lineno"></span><span class="keyword" id="5877497">func</span>&nbsp;<span class="op" id="5877502">(</span><span class="ident" id="5877503">dec</span>&nbsp;<span class="op" id="5877507">*</span><span class="ident" id="5877508">Decoder</span><span class="op" id="5877515">)</span>&nbsp;<span class="ident" id="5877517">DecodeValue</span><span class="op" id="5877528">(</span><span class="ident" id="5877529">v</span>&nbsp;<span class="ident" id="5877531">reflect</span><span class="op" id="5877538">.</span><span class="ident" id="5877539">Value</span><span class="op" id="5877544">)</span>&nbsp;<span class="builtintype" id="5877546">error</span>&nbsp;<span class="op" id="5877552">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877555">if</span>&nbsp;<span class="ident" id="5877558">v</span><span class="op" id="5877559">.</span><span class="ident" id="5877560">IsValid</span><span class="op" id="5877567">(</span><span class="op" id="5877568">)</span>&nbsp;<span class="op" id="5877570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877574">if</span>&nbsp;<span class="ident" id="5877577">v</span><span class="op" id="5877578">.</span><span class="ident" id="5877579">Kind</span><span class="op" id="5877583">(</span><span class="op" id="5877584">)</span>&nbsp;<span class="op" id="5877586">==</span>&nbsp;<span class="ident" id="5877589">reflect</span><span class="op" id="5877596">.</span><span class="ident" id="5877597">Ptr</span>&nbsp;<span class="op" id="5877601">&amp;&amp;</span>&nbsp;<span class="op" id="5877604">!</span><span class="ident" id="5877605">v</span><span class="op" id="5877606">.</span><span class="ident" id="5877607">IsNil</span><span class="op" id="5877612">(</span><span class="op" id="5877613">)</span>&nbsp;<span class="op" id="5877615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5877620">//&nbsp;That&#39;s&nbsp;okay,&nbsp;we&#39;ll&nbsp;store&nbsp;through&nbsp;the&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877671">}</span>&nbsp;<span class="keyword" id="5877673">else</span>&nbsp;<span class="keyword" id="5877678">if</span>&nbsp;<span class="op" id="5877681">!</span><span class="ident" id="5877682">v</span><span class="op" id="5877683">.</span><span class="ident" id="5877684">CanSet</span><span class="op" id="5877690">(</span><span class="op" id="5877691">)</span>&nbsp;<span class="op" id="5877693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877698">return</span>&nbsp;<span class="ident" id="5877705">errors</span><span class="op" id="5877711">.</span><span class="ident" id="5877712">New</span><span class="op" id="5877715">(</span><span class="string" id="5877716">&#34;gob:&nbsp;DecodeValue&nbsp;of&nbsp;unassignable&nbsp;value&#34;</span><span class="op" id="5877756">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5877763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5877766">//&nbsp;Make&nbsp;sure&nbsp;we&#39;re&nbsp;single-threaded&nbsp;through&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877816">dec</span><span class="op" id="5877819">.</span><span class="ident" id="5877820">mutex</span><span class="op" id="5877825">.</span><span class="ident" id="5877826">Lock</span><span class="op" id="5877830">(</span><span class="op" id="5877831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877834">defer</span>&nbsp;<span class="ident" id="5877840">dec</span><span class="op" id="5877843">.</span><span class="ident" id="5877844">mutex</span><span class="op" id="5877849">.</span><span class="ident" id="5877850">Unlock</span><span class="op" id="5877856">(</span><span class="op" id="5877857">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877861">dec</span><span class="op" id="5877864">.</span><span class="ident" id="5877865">buf</span><span class="op" id="5877868">.</span><span class="ident" id="5877869">Reset</span><span class="op" id="5877874">(</span><span class="op" id="5877875">)</span>&nbsp;<span class="comment" id="5877877">//&nbsp;In&nbsp;case&nbsp;data&nbsp;lingers&nbsp;from&nbsp;previous&nbsp;invocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877928">dec</span><span class="op" id="5877931">.</span><span class="ident" id="5877932">err</span>&nbsp;<span class="op" id="5877936">=</span>&nbsp;<span class="builtintype" id="5877938">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5877943">id</span>&nbsp;<span class="op" id="5877946">:=</span>&nbsp;<span class="ident" id="5877949">dec</span><span class="op" id="5877952">.</span><span class="ident" id="5877953">decodeTypeSequence</span><span class="op" id="5877971">(</span><span class="builtintype" id="5877972">false</span><span class="op" id="5877977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5877980">if</span>&nbsp;<span class="ident" id="5877983">dec</span><span class="op" id="5877986">.</span><span class="ident" id="5877987">err</span>&nbsp;<span class="op" id="5877991">==</span>&nbsp;<span class="builtintype" id="5877994">nil</span>&nbsp;<span class="op" id="5877998">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5878002">dec</span><span class="op" id="5878005">.</span><span class="ident" id="5878006">decodeValue</span><span class="op" id="5878017">(</span><span class="ident" id="5878018">id</span><span class="op" id="5878020">,</span>&nbsp;<span class="ident" id="5878022">v</span><span class="op" id="5878023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5878026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5878029">return</span>&nbsp;<span class="ident" id="5878036">dec</span><span class="op" id="5878039">.</span><span class="ident" id="5878040">err</span><br>
<span class="lineno"></span><span class="op" id="5878044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="5878047">//&nbsp;If&nbsp;debug.go&nbsp;is&nbsp;compiled&nbsp;into&nbsp;the&nbsp;program&nbsp;,&nbsp;debugFunc&nbsp;prints&nbsp;a&nbsp;human-readable</span><br>
<span class="lineno"></span><span class="comment" id="5878127">//&nbsp;representation&nbsp;of&nbsp;the&nbsp;gob&nbsp;data&nbsp;read&nbsp;from&nbsp;r&nbsp;by&nbsp;calling&nbsp;that&nbsp;file&#39;s&nbsp;Debug&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5878212">//&nbsp;Otherwise&nbsp;it&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5878236">var</span>&nbsp;<span class="ident" id="5878240">debugFunc</span>&nbsp;<span class="keyword" id="5878250">func</span><span class="op" id="5878254">(</span><span class="ident" id="5878255">io</span><span class="op" id="5878257">.</span><span class="ident" id="5878258">Reader</span><span class="op" id="5878264">)</span>
</div>
</body>
</html>
