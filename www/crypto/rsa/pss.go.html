<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4404976">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4405031">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4405085">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4405136">package</span>&nbsp;<span class="ident" id="4405144">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4405149">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;the&nbsp;PSS&nbsp;signature&nbsp;scheme&nbsp;[1].</span><br>
<span class="lineno"></span><span class="comment" id="4405203">//</span><br>
<span class="lineno"></span><span class="comment" id="4405206">//&nbsp;[1]&nbsp;http://www.rsa.com/rsalabs/pkcs/files/h11300-wp-pkcs-1v2-2-rsa-cryptography-standard.pdf</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4405303">import</span>&nbsp;<span class="op" id="4405310">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405313">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405322">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405332">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405342">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405350">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4405356">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4405367">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="4405370">func</span>&nbsp;<span class="ident" id="4405375">emsaPSSEncode</span><span class="op" id="4405388">(</span><span class="ident" id="4405389">mHash</span>&nbsp;<span class="op" id="4405395">[</span><span class="op" id="4405396">]</span><span class="builtintype" id="4405397">byte</span><span class="op" id="4405401">,</span>&nbsp;<span class="ident" id="4405403">emBits</span>&nbsp;<span class="builtintype" id="4405410">int</span><span class="op" id="4405413">,</span>&nbsp;<span class="ident" id="4405415">salt</span>&nbsp;<span class="op" id="4405420">[</span><span class="op" id="4405421">]</span><span class="builtintype" id="4405422">byte</span><span class="op" id="4405426">,</span>&nbsp;<span class="ident" id="4405428">hash</span>&nbsp;<span class="ident" id="4405433"><a href="/crypto/rsa/pss.go.html#4405342">hash</a></span><span class="op" id="4405437">.</span><span class="ident" id="4405438">Hash</span><span class="op" id="4405442">)</span>&nbsp;<span class="op" id="4405444">(</span><span class="op" id="4405445">[</span><span class="op" id="4405446">]</span><span class="builtintype" id="4405447">byte</span><span class="op" id="4405451">,</span>&nbsp;<span class="builtintype" id="4405453">error</span><span class="op" id="4405458">)</span>&nbsp;<span class="op" id="4405460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4405463">//&nbsp;See&nbsp;[1],&nbsp;section&nbsp;9.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4405490">hLen</span>&nbsp;<span class="op" id="4405495">:=</span>&nbsp;<span class="ident" id="4405498"><a href="/crypto/rsa/pss.go.html#4405428">hash</a></span><span class="op" id="4405502">.</span><span class="ident" id="4405503">Size</span><span class="op" id="4405507">(</span><span class="op" id="4405508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4405511">sLen</span>&nbsp;<span class="op" id="4405516">:=</span>&nbsp;<span class="builtinfunc" id="4405519">len</span><span class="op" id="4405522">(</span><span class="ident" id="4405523"><a href="/crypto/rsa/pss.go.html#4405415">salt</a></span><span class="op" id="4405527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4405530">emLen</span>&nbsp;<span class="op" id="4405536">:=</span>&nbsp;<span class="op" id="4405539">(</span><span class="ident" id="4405540"><a href="/crypto/rsa/pss.go.html#4405403">emBits</a></span>&nbsp;<span class="op" id="4405547">+</span>&nbsp;<span class="num" id="4405549">7</span><span class="op" id="4405550">)</span>&nbsp;<span class="op" id="4405552">/</span>&nbsp;<span class="num" id="4405554">8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4405558">//&nbsp;1.&nbsp;&nbsp;If&nbsp;the&nbsp;length&nbsp;of&nbsp;M&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;input&nbsp;limitation&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4405630">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash&nbsp;function&nbsp;(2^61&nbsp;-&nbsp;1&nbsp;octets&nbsp;for&nbsp;SHA-1),&nbsp;output&nbsp;&#34;message&nbsp;too</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4405701">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4405725">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4405729">//&nbsp;2.&nbsp;&nbsp;Let&nbsp;mHash&nbsp;=&nbsp;Hash(M),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405791">if</span>&nbsp;<span class="builtinfunc" id="4405794">len</span><span class="op" id="4405797">(</span><span class="ident" id="4405798"><a href="/crypto/rsa/pss.go.html#4405389">mHash</a></span><span class="op" id="4405803">)</span>&nbsp;<span class="op" id="4405805">!=</span>&nbsp;<span class="ident" id="4405808"><a href="/crypto/rsa/pss.go.html#4405490">hLen</a></span>&nbsp;<span class="op" id="4405813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405817">return</span>&nbsp;<span class="ident" id="4405824">nil</span><span class="op" id="4405827">,</span>&nbsp;<span class="ident" id="4405829"><a href="/crypto/rsa/pss.go.html#4405332">errors</a></span><span class="op" id="4405835">.</span><span class="ident" id="4405836">New</span><span class="op" id="4405839">(</span><span class="string" id="4405840">&#34;crypto/rsa:&nbsp;input&nbsp;must&nbsp;be&nbsp;hashed&nbsp;message&#34;</span><span class="op" id="4405882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4405885">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4405889">//&nbsp;3.&nbsp;&nbsp;If&nbsp;emLen&nbsp;&lt;&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;+&nbsp;2,&nbsp;output&nbsp;&#34;encoding&nbsp;error&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405960">if</span>&nbsp;<span class="ident" id="4405963"><a href="/crypto/rsa/pss.go.html#4405530">emLen</a></span>&nbsp;<span class="op" id="4405969">&lt;</span>&nbsp;<span class="ident" id="4405971"><a href="/crypto/rsa/pss.go.html#4405490">hLen</a></span><span class="op" id="4405975">+</span><span class="ident" id="4405976"><a href="/crypto/rsa/pss.go.html#4405511">sLen</a></span><span class="op" id="4405980">+</span><span class="num" id="4405981">2</span>&nbsp;<span class="op" id="4405983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405987">return</span>&nbsp;<span class="ident" id="4405994">nil</span><span class="op" id="4405997">,</span>&nbsp;<span class="ident" id="4405999"><a href="/crypto/rsa/pss.go.html#4405332">errors</a></span><span class="op" id="4406005">.</span><span class="ident" id="4406006">New</span><span class="op" id="4406009">(</span><span class="string" id="4406010">&#34;crypto/rsa:&nbsp;encoding&nbsp;error&#34;</span><span class="op" id="4406038">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4406041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406045">em</span>&nbsp;<span class="op" id="4406048">:=</span>&nbsp;<span class="builtinfunc" id="4406051">make</span><span class="op" id="4406055">(</span><span class="op" id="4406056">[</span><span class="op" id="4406057">]</span><span class="builtintype" id="4406058">byte</span><span class="op" id="4406062">,</span>&nbsp;<span class="ident" id="4406064"><a href="/crypto/rsa/pss.go.html#4405530">emLen</a></span><span class="op" id="4406069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406072">db</span>&nbsp;<span class="op" id="4406075">:=</span>&nbsp;<span class="ident" id="4406078"><a href="/crypto/rsa/pss.go.html#4406045">em</a></span><span class="op" id="4406080">[</span><span class="op" id="4406081">:</span><span class="ident" id="4406082"><a href="/crypto/rsa/pss.go.html#4405530">emLen</a></span><span class="op" id="4406087">-</span><span class="ident" id="4406088"><a href="/crypto/rsa/pss.go.html#4405511">sLen</a></span><span class="op" id="4406092">-</span><span class="ident" id="4406093"><a href="/crypto/rsa/pss.go.html#4405490">hLen</a></span><span class="op" id="4406097">-</span><span class="num" id="4406098">2</span><span class="op" id="4406099">+</span><span class="num" id="4406100">1</span><span class="op" id="4406101">+</span><span class="ident" id="4406102"><a href="/crypto/rsa/pss.go.html#4405511">sLen</a></span><span class="op" id="4406106">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406109">h</span>&nbsp;<span class="op" id="4406111">:=</span>&nbsp;<span class="ident" id="4406114"><a href="/crypto/rsa/pss.go.html#4406045">em</a></span><span class="op" id="4406116">[</span><span class="ident" id="4406117"><a href="/crypto/rsa/pss.go.html#4405530">emLen</a></span><span class="op" id="4406122">-</span><span class="ident" id="4406123"><a href="/crypto/rsa/pss.go.html#4405511">sLen</a></span><span class="op" id="4406127">-</span><span class="ident" id="4406128"><a href="/crypto/rsa/pss.go.html#4405490">hLen</a></span><span class="op" id="4406132">-</span><span class="num" id="4406133">2</span><span class="op" id="4406134">+</span><span class="num" id="4406135">1</span><span class="op" id="4406136">+</span><span class="ident" id="4406137"><a href="/crypto/rsa/pss.go.html#4405511">sLen</a></span>&nbsp;<span class="op" id="4406142">:</span>&nbsp;<span class="ident" id="4406144"><a href="/crypto/rsa/pss.go.html#4405530">emLen</a></span><span class="op" id="4406149">-</span><span class="num" id="4406150">1</span><span class="op" id="4406151">]</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406155">//&nbsp;4.&nbsp;&nbsp;Generate&nbsp;a&nbsp;random&nbsp;octet&nbsp;string&nbsp;salt&nbsp;of&nbsp;length&nbsp;sLen;&nbsp;if&nbsp;sLen&nbsp;=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406228">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;salt&nbsp;is&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406267">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406271">//&nbsp;5.&nbsp;&nbsp;Let</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406283">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;=&nbsp;(0x)00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;||&nbsp;mHash&nbsp;||&nbsp;salt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406344">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406348">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;is&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;8&nbsp;+&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;with&nbsp;eight</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406415">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial&nbsp;zero&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406444">//</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406448">//&nbsp;6.&nbsp;&nbsp;Let&nbsp;H&nbsp;=&nbsp;Hash(M&#39;),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406507">var</span>&nbsp;<span class="ident" id="4406511">prefix</span>&nbsp;<span class="op" id="4406518">[</span><span class="num" id="4406519">8</span><span class="op" id="4406520">]</span><span class="builtintype" id="4406521">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406528"><a href="/crypto/rsa/pss.go.html#4405428">hash</a></span><span class="op" id="4406532">.</span><span class="ident" id="4406533">Write</span><span class="op" id="4406538">(</span><span class="ident" id="4406539"><a href="/crypto/rsa/pss.go.html#4406511">prefix</a></span><span class="op" id="4406545">[</span><span class="op" id="4406546">:</span><span class="op" id="4406547">]</span><span class="op" id="4406548">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406551"><a href="/crypto/rsa/pss.go.html#4405428">hash</a></span><span class="op" id="4406555">.</span><span class="ident" id="4406556">Write</span><span class="op" id="4406561">(</span><span class="ident" id="4406562"><a href="/crypto/rsa/pss.go.html#4405389">mHash</a></span><span class="op" id="4406567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406570"><a href="/crypto/rsa/pss.go.html#4405428">hash</a></span><span class="op" id="4406574">.</span><span class="ident" id="4406575">Write</span><span class="op" id="4406580">(</span><span class="ident" id="4406581"><a href="/crypto/rsa/pss.go.html#4405415">salt</a></span><span class="op" id="4406585">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406589"><a href="/crypto/rsa/pss.go.html#4406109">h</a></span>&nbsp;<span class="op" id="4406591">=</span>&nbsp;<span class="ident" id="4406593"><a href="/crypto/rsa/pss.go.html#4405428">hash</a></span><span class="op" id="4406597">.</span><span class="ident" id="4406598">Sum</span><span class="op" id="4406601">(</span><span class="ident" id="4406602"><a href="/crypto/rsa/pss.go.html#4406109">h</a></span><span class="op" id="4406603">[</span><span class="op" id="4406604">:</span><span class="num" id="4406605">0</span><span class="op" id="4406606">]</span><span class="op" id="4406607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406610"><a href="/crypto/rsa/pss.go.html#4405428">hash</a></span><span class="op" id="4406614">.</span><span class="ident" id="4406615">Reset</span><span class="op" id="4406620">(</span><span class="op" id="4406621">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406625">//&nbsp;7.&nbsp;&nbsp;Generate&nbsp;an&nbsp;octet&nbsp;string&nbsp;PS&nbsp;consisting&nbsp;of&nbsp;emLen&nbsp;-&nbsp;sLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406699">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;octets.&nbsp;&nbsp;The&nbsp;length&nbsp;of&nbsp;PS&nbsp;may&nbsp;be&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406748">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406752">//&nbsp;8.&nbsp;&nbsp;Let&nbsp;DB&nbsp;=&nbsp;PS&nbsp;||&nbsp;0x01&nbsp;||&nbsp;salt;&nbsp;DB&nbsp;is&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406821">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406848"><a href="/crypto/rsa/pss.go.html#4406072">db</a></span><span class="op" id="4406850">[</span><span class="ident" id="4406851"><a href="/crypto/rsa/pss.go.html#4405530">emLen</a></span><span class="op" id="4406856">-</span><span class="ident" id="4406857"><a href="/crypto/rsa/pss.go.html#4405511">sLen</a></span><span class="op" id="4406861">-</span><span class="ident" id="4406862"><a href="/crypto/rsa/pss.go.html#4405490">hLen</a></span><span class="op" id="4406866">-</span><span class="num" id="4406867">2</span><span class="op" id="4406868">]</span>&nbsp;<span class="op" id="4406870">=</span>&nbsp;<span class="num" id="4406872">0x01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4406878">copy</span><span class="op" id="4406882">(</span><span class="ident" id="4406883"><a href="/crypto/rsa/pss.go.html#4406072">db</a></span><span class="op" id="4406885">[</span><span class="ident" id="4406886"><a href="/crypto/rsa/pss.go.html#4405530">emLen</a></span><span class="op" id="4406891">-</span><span class="ident" id="4406892"><a href="/crypto/rsa/pss.go.html#4405511">sLen</a></span><span class="op" id="4406896">-</span><span class="ident" id="4406897"><a href="/crypto/rsa/pss.go.html#4405490">hLen</a></span><span class="op" id="4406901">-</span><span class="num" id="4406902">1</span><span class="op" id="4406903">:</span><span class="op" id="4406904">]</span><span class="op" id="4406905">,</span>&nbsp;<span class="ident" id="4406907"><a href="/crypto/rsa/pss.go.html#4405415">salt</a></span><span class="op" id="4406911">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406915">//&nbsp;9.&nbsp;&nbsp;Let&nbsp;dbMask&nbsp;=&nbsp;MGF(H,&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406962">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406966">//&nbsp;10.&nbsp;Let&nbsp;maskedDB&nbsp;=&nbsp;DB&nbsp;\xor&nbsp;dbMask.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407006"><a href="/crypto/rsa/rsa.go.html#4421094">mgf1XOR</a></span><span class="op" id="4407013">(</span><span class="ident" id="4407014"><a href="/crypto/rsa/pss.go.html#4406072">db</a></span><span class="op" id="4407016">,</span>&nbsp;<span class="ident" id="4407018"><a href="/crypto/rsa/pss.go.html#4405428">hash</a></span><span class="op" id="4407022">,</span>&nbsp;<span class="ident" id="4407024"><a href="/crypto/rsa/pss.go.html#4406109">h</a></span><span class="op" id="4407025">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407029">//&nbsp;11.&nbsp;Set&nbsp;the&nbsp;leftmost&nbsp;8&nbsp;*&nbsp;emLen&nbsp;-&nbsp;emBits&nbsp;bits&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;octet&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407103">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maskedDB&nbsp;to&nbsp;zero.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407130"><a href="/crypto/rsa/pss.go.html#4406072">db</a></span><span class="op" id="4407132">[</span><span class="num" id="4407133">0</span><span class="op" id="4407134">]</span>&nbsp;<span class="op" id="4407136">&amp;=</span>&nbsp;<span class="op" id="4407139">(</span><span class="num" id="4407140">0xFF</span>&nbsp;<span class="op" id="4407145">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4407148">uint</span><span class="op" id="4407152">(</span><span class="num" id="4407153">8</span><span class="op" id="4407154">*</span><span class="ident" id="4407155"><a href="/crypto/rsa/pss.go.html#4405530">emLen</a></span><span class="op" id="4407160">-</span><span class="ident" id="4407161"><a href="/crypto/rsa/pss.go.html#4405403">emBits</a></span><span class="op" id="4407167">)</span><span class="op" id="4407168">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407172">//&nbsp;12.&nbsp;Let&nbsp;EM&nbsp;=&nbsp;maskedDB&nbsp;||&nbsp;H&nbsp;||&nbsp;0xbc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407212"><a href="/crypto/rsa/pss.go.html#4406045">em</a></span><span class="op" id="4407214">[</span><span class="ident" id="4407215"><a href="/crypto/rsa/pss.go.html#4405530">emLen</a></span><span class="op" id="4407220">-</span><span class="num" id="4407221">1</span><span class="op" id="4407222">]</span>&nbsp;<span class="op" id="4407224">=</span>&nbsp;<span class="num" id="4407226">0xBC</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407233">//&nbsp;13.&nbsp;Output&nbsp;EM.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407252">return</span>&nbsp;<span class="ident" id="4407259"><a href="/crypto/rsa/pss.go.html#4406045">em</a></span><span class="op" id="4407261">,</span>&nbsp;<span class="ident" id="4407263">nil</span><br>
<span class="lineno"></span><span class="op" id="4407267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4407270">func</span>&nbsp;<span class="ident" id="4407275">emsaPSSVerify</span><span class="op" id="4407288">(</span><span class="ident" id="4407289">mHash</span><span class="op" id="4407294">,</span>&nbsp;<span class="ident" id="4407296">em</span>&nbsp;<span class="op" id="4407299">[</span><span class="op" id="4407300">]</span><span class="builtintype" id="4407301">byte</span><span class="op" id="4407305">,</span>&nbsp;<span class="ident" id="4407307">emBits</span><span class="op" id="4407313">,</span>&nbsp;<span class="ident" id="4407315">sLen</span>&nbsp;<span class="builtintype" id="4407320">int</span><span class="op" id="4407323">,</span>&nbsp;<span class="ident" id="4407325">hash</span>&nbsp;<span class="ident" id="4407330"><a href="/crypto/rsa/pss.go.html#4405342">hash</a></span><span class="op" id="4407334">.</span><span class="ident" id="4407335">Hash</span><span class="op" id="4407339">)</span>&nbsp;<span class="builtintype" id="4407341">error</span>&nbsp;<span class="op" id="4407347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407350">//&nbsp;1.&nbsp;&nbsp;If&nbsp;the&nbsp;length&nbsp;of&nbsp;M&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;input&nbsp;limitation&nbsp;for&nbsp;the</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407422">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash&nbsp;function&nbsp;(2^61&nbsp;-&nbsp;1&nbsp;octets&nbsp;for&nbsp;SHA-1),&nbsp;output&nbsp;&#34;inconsistent&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407495">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407513">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407517">//&nbsp;2.&nbsp;&nbsp;Let&nbsp;mHash&nbsp;=&nbsp;Hash(M),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407578">hLen</span>&nbsp;<span class="op" id="4407583">:=</span>&nbsp;<span class="ident" id="4407586"><a href="/crypto/rsa/pss.go.html#4407325">hash</a></span><span class="op" id="4407590">.</span><span class="ident" id="4407591">Size</span><span class="op" id="4407595">(</span><span class="op" id="4407596">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407599">if</span>&nbsp;<span class="ident" id="4407602"><a href="/crypto/rsa/pss.go.html#4407578">hLen</a></span>&nbsp;<span class="op" id="4407607">!=</span>&nbsp;<span class="builtinfunc" id="4407610">len</span><span class="op" id="4407613">(</span><span class="ident" id="4407614"><a href="/crypto/rsa/pss.go.html#4407289">mHash</a></span><span class="op" id="4407619">)</span>&nbsp;<span class="op" id="4407621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407625">return</span>&nbsp;<span class="ident" id="4407632"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4407649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407653">//&nbsp;3.&nbsp;&nbsp;If&nbsp;emLen&nbsp;&lt;&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;+&nbsp;2,&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407721">emLen</span>&nbsp;<span class="op" id="4407727">:=</span>&nbsp;<span class="op" id="4407730">(</span><span class="ident" id="4407731"><a href="/crypto/rsa/pss.go.html#4407307">emBits</a></span>&nbsp;<span class="op" id="4407738">+</span>&nbsp;<span class="num" id="4407740">7</span><span class="op" id="4407741">)</span>&nbsp;<span class="op" id="4407743">/</span>&nbsp;<span class="num" id="4407745">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407748">if</span>&nbsp;<span class="ident" id="4407751"><a href="/crypto/rsa/pss.go.html#4407721">emLen</a></span>&nbsp;<span class="op" id="4407757">&lt;</span>&nbsp;<span class="ident" id="4407759"><a href="/crypto/rsa/pss.go.html#4407578">hLen</a></span><span class="op" id="4407763">+</span><span class="ident" id="4407764"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span><span class="op" id="4407768">+</span><span class="num" id="4407769">2</span>&nbsp;<span class="op" id="4407771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407775">return</span>&nbsp;<span class="ident" id="4407782"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4407799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407803">//&nbsp;4.&nbsp;&nbsp;If&nbsp;the&nbsp;rightmost&nbsp;octet&nbsp;of&nbsp;EM&nbsp;does&nbsp;not&nbsp;have&nbsp;hexadecimal&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407872">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xbc,&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407918">if</span>&nbsp;<span class="ident" id="4407921"><a href="/crypto/rsa/pss.go.html#4407296">em</a></span><span class="op" id="4407923">[</span><span class="builtinfunc" id="4407924">len</span><span class="op" id="4407927">(</span><span class="ident" id="4407928"><a href="/crypto/rsa/pss.go.html#4407296">em</a></span><span class="op" id="4407930">)</span><span class="op" id="4407931">-</span><span class="num" id="4407932">1</span><span class="op" id="4407933">]</span>&nbsp;<span class="op" id="4407935">!=</span>&nbsp;<span class="num" id="4407938">0xBC</span>&nbsp;<span class="op" id="4407943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407947">return</span>&nbsp;<span class="ident" id="4407954"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4407971">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4407975">//&nbsp;5.&nbsp;&nbsp;Let&nbsp;maskedDB&nbsp;be&nbsp;the&nbsp;leftmost&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1&nbsp;octets&nbsp;of&nbsp;EM,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408047">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;H&nbsp;be&nbsp;the&nbsp;next&nbsp;hLen&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4408086">db</span>&nbsp;<span class="op" id="4408089">:=</span>&nbsp;<span class="ident" id="4408092"><a href="/crypto/rsa/pss.go.html#4407296">em</a></span><span class="op" id="4408094">[</span><span class="op" id="4408095">:</span><span class="ident" id="4408096"><a href="/crypto/rsa/pss.go.html#4407721">emLen</a></span><span class="op" id="4408101">-</span><span class="ident" id="4408102"><a href="/crypto/rsa/pss.go.html#4407578">hLen</a></span><span class="op" id="4408106">-</span><span class="num" id="4408107">1</span><span class="op" id="4408108">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4408111">h</span>&nbsp;<span class="op" id="4408113">:=</span>&nbsp;<span class="ident" id="4408116"><a href="/crypto/rsa/pss.go.html#4407296">em</a></span><span class="op" id="4408118">[</span><span class="ident" id="4408119"><a href="/crypto/rsa/pss.go.html#4407721">emLen</a></span><span class="op" id="4408124">-</span><span class="ident" id="4408125"><a href="/crypto/rsa/pss.go.html#4407578">hLen</a></span><span class="op" id="4408129">-</span><span class="num" id="4408130">1</span>&nbsp;<span class="op" id="4408132">:</span>&nbsp;<span class="builtinfunc" id="4408134">len</span><span class="op" id="4408137">(</span><span class="ident" id="4408138"><a href="/crypto/rsa/pss.go.html#4407296">em</a></span><span class="op" id="4408140">)</span><span class="op" id="4408141">-</span><span class="num" id="4408142">1</span><span class="op" id="4408143">]</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408147">//&nbsp;6.&nbsp;&nbsp;If&nbsp;the&nbsp;leftmost&nbsp;8&nbsp;*&nbsp;emLen&nbsp;-&nbsp;emBits&nbsp;bits&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;octet&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408220">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maskedDB&nbsp;are&nbsp;not&nbsp;all&nbsp;equal&nbsp;to&nbsp;zero,&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408290">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408304">if</span>&nbsp;<span class="ident" id="4408307"><a href="/crypto/rsa/pss.go.html#4407296">em</a></span><span class="op" id="4408309">[</span><span class="num" id="4408310">0</span><span class="op" id="4408311">]</span><span class="op" id="4408312">&amp;</span><span class="op" id="4408313">(</span><span class="num" id="4408314">0xFF</span><span class="op" id="4408318">&lt;&lt;</span><span class="builtintype" id="4408320">uint</span><span class="op" id="4408324">(</span><span class="num" id="4408325">8</span><span class="op" id="4408326">-</span><span class="op" id="4408327">(</span><span class="num" id="4408328">8</span><span class="op" id="4408329">*</span><span class="ident" id="4408330"><a href="/crypto/rsa/pss.go.html#4407721">emLen</a></span><span class="op" id="4408335">-</span><span class="ident" id="4408336"><a href="/crypto/rsa/pss.go.html#4407307">emBits</a></span><span class="op" id="4408342">)</span><span class="op" id="4408343">)</span><span class="op" id="4408344">)</span>&nbsp;<span class="op" id="4408346">!=</span>&nbsp;<span class="num" id="4408349">0</span>&nbsp;<span class="op" id="4408351">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408355">return</span>&nbsp;<span class="ident" id="4408362"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408383">//&nbsp;7.&nbsp;&nbsp;Let&nbsp;dbMask&nbsp;=&nbsp;MGF(H,&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408430">//</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408434">//&nbsp;8.&nbsp;&nbsp;Let&nbsp;DB&nbsp;=&nbsp;maskedDB&nbsp;\xor&nbsp;dbMask.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4408473"><a href="/crypto/rsa/rsa.go.html#4421094">mgf1XOR</a></span><span class="op" id="4408480">(</span><span class="ident" id="4408481"><a href="/crypto/rsa/pss.go.html#4408086">db</a></span><span class="op" id="4408483">,</span>&nbsp;<span class="ident" id="4408485"><a href="/crypto/rsa/pss.go.html#4407325">hash</a></span><span class="op" id="4408489">,</span>&nbsp;<span class="ident" id="4408491"><a href="/crypto/rsa/pss.go.html#4408111">h</a></span><span class="op" id="4408492">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408496">//&nbsp;9.&nbsp;&nbsp;Set&nbsp;the&nbsp;leftmost&nbsp;8&nbsp;*&nbsp;emLen&nbsp;-&nbsp;emBits&nbsp;bits&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;octet&nbsp;in&nbsp;DB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408573">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;zero.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4408590"><a href="/crypto/rsa/pss.go.html#4408086">db</a></span><span class="op" id="4408592">[</span><span class="num" id="4408593">0</span><span class="op" id="4408594">]</span>&nbsp;<span class="op" id="4408596">&amp;=</span>&nbsp;<span class="op" id="4408599">(</span><span class="num" id="4408600">0xFF</span>&nbsp;<span class="op" id="4408605">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4408608">uint</span><span class="op" id="4408612">(</span><span class="num" id="4408613">8</span><span class="op" id="4408614">*</span><span class="ident" id="4408615"><a href="/crypto/rsa/pss.go.html#4407721">emLen</a></span><span class="op" id="4408620">-</span><span class="ident" id="4408621"><a href="/crypto/rsa/pss.go.html#4407307">emBits</a></span><span class="op" id="4408627">)</span><span class="op" id="4408628">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408632">if</span>&nbsp;<span class="ident" id="4408635"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span>&nbsp;<span class="op" id="4408640">==</span>&nbsp;<span class="ident" id="4408643"><a href="/crypto/rsa/pss.go.html#4410764">PSSSaltLengthAuto</a></span>&nbsp;<span class="op" id="4408661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4408664">FindSaltLength</span><span class="op" id="4408678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408682">for</span>&nbsp;<span class="ident" id="4408686"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span>&nbsp;<span class="op" id="4408691">=</span>&nbsp;<span class="ident" id="4408693"><a href="/crypto/rsa/pss.go.html#4407721">emLen</a></span>&nbsp;<span class="op" id="4408699">-</span>&nbsp;<span class="op" id="4408701">(</span><span class="ident" id="4408702"><a href="/crypto/rsa/pss.go.html#4407578">hLen</a></span>&nbsp;<span class="op" id="4408707">+</span>&nbsp;<span class="num" id="4408709">2</span><span class="op" id="4408710">)</span><span class="op" id="4408711">;</span>&nbsp;<span class="ident" id="4408713"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span>&nbsp;<span class="op" id="4408718">&gt;=</span>&nbsp;<span class="num" id="4408721">0</span><span class="op" id="4408722">;</span>&nbsp;<span class="ident" id="4408724"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span><span class="op" id="4408728">--</span>&nbsp;<span class="op" id="4408731">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408736">switch</span>&nbsp;<span class="ident" id="4408743"><a href="/crypto/rsa/pss.go.html#4408086">db</a></span><span class="op" id="4408745">[</span><span class="ident" id="4408746"><a href="/crypto/rsa/pss.go.html#4407721">emLen</a></span><span class="op" id="4408751">-</span><span class="ident" id="4408752"><a href="/crypto/rsa/pss.go.html#4407578">hLen</a></span><span class="op" id="4408756">-</span><span class="ident" id="4408757"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span><span class="op" id="4408761">-</span><span class="num" id="4408762">2</span><span class="op" id="4408763">]</span>&nbsp;<span class="op" id="4408765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408770">case</span>&nbsp;<span class="num" id="4408775">1</span><span class="op" id="4408776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408782">break</span>&nbsp;<span class="ident" id="4408788">FindSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408806">case</span>&nbsp;<span class="num" id="4408811">0</span><span class="op" id="4408812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408818">continue</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408830">default</span><span class="op" id="4408837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408843">return</span>&nbsp;<span class="ident" id="4408850"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408877">if</span>&nbsp;<span class="ident" id="4408880"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span>&nbsp;<span class="op" id="4408885">&lt;</span>&nbsp;<span class="num" id="4408887">0</span>&nbsp;<span class="op" id="4408889">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408894">return</span>&nbsp;<span class="ident" id="4408901"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408922">}</span>&nbsp;<span class="keyword" id="4408924">else</span>&nbsp;<span class="op" id="4408929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408933">//&nbsp;10.&nbsp;If&nbsp;the&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;sLen&nbsp;-&nbsp;2&nbsp;leftmost&nbsp;octets&nbsp;of&nbsp;DB&nbsp;are&nbsp;not&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409008">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;if&nbsp;the&nbsp;octet&nbsp;at&nbsp;position&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;sLen&nbsp;-&nbsp;1&nbsp;(the&nbsp;leftmost</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409083">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;is&nbsp;&#34;position&nbsp;1&#34;)&nbsp;does&nbsp;not&nbsp;have&nbsp;hexadecimal&nbsp;value&nbsp;0x01,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409156">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409197">for</span>&nbsp;<span class="ident" id="4409201">_</span><span class="op" id="4409202">,</span>&nbsp;<span class="ident" id="4409204">e</span>&nbsp;<span class="op" id="4409206">:=</span>&nbsp;<span class="keyword" id="4409209">range</span>&nbsp;<span class="ident" id="4409215"><a href="/crypto/rsa/pss.go.html#4408086">db</a></span><span class="op" id="4409217">[</span><span class="op" id="4409218">:</span><span class="ident" id="4409219"><a href="/crypto/rsa/pss.go.html#4407721">emLen</a></span><span class="op" id="4409224">-</span><span class="ident" id="4409225"><a href="/crypto/rsa/pss.go.html#4407578">hLen</a></span><span class="op" id="4409229">-</span><span class="ident" id="4409230"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span><span class="op" id="4409234">-</span><span class="num" id="4409235">2</span><span class="op" id="4409236">]</span>&nbsp;<span class="op" id="4409238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409243">if</span>&nbsp;<span class="ident" id="4409246"><a href="/crypto/rsa/pss.go.html#4409204">e</a></span>&nbsp;<span class="op" id="4409248">!=</span>&nbsp;<span class="num" id="4409251">0x00</span>&nbsp;<span class="op" id="4409256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409262">return</span>&nbsp;<span class="ident" id="4409269"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409296">if</span>&nbsp;<span class="ident" id="4409299"><a href="/crypto/rsa/pss.go.html#4408086">db</a></span><span class="op" id="4409301">[</span><span class="ident" id="4409302"><a href="/crypto/rsa/pss.go.html#4407721">emLen</a></span><span class="op" id="4409307">-</span><span class="ident" id="4409308"><a href="/crypto/rsa/pss.go.html#4407578">hLen</a></span><span class="op" id="4409312">-</span><span class="ident" id="4409313"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span><span class="op" id="4409317">-</span><span class="num" id="4409318">2</span><span class="op" id="4409319">]</span>&nbsp;<span class="op" id="4409321">!=</span>&nbsp;<span class="num" id="4409324">0x01</span>&nbsp;<span class="op" id="4409329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409334">return</span>&nbsp;<span class="ident" id="4409341"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409359">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409366">//&nbsp;11.&nbsp;&nbsp;Let&nbsp;salt&nbsp;be&nbsp;the&nbsp;last&nbsp;sLen&nbsp;octets&nbsp;of&nbsp;DB.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409415">salt</span>&nbsp;<span class="op" id="4409420">:=</span>&nbsp;<span class="ident" id="4409423"><a href="/crypto/rsa/pss.go.html#4408086">db</a></span><span class="op" id="4409425">[</span><span class="builtinfunc" id="4409426">len</span><span class="op" id="4409429">(</span><span class="ident" id="4409430"><a href="/crypto/rsa/pss.go.html#4408086">db</a></span><span class="op" id="4409432">)</span><span class="op" id="4409433">-</span><span class="ident" id="4409434"><a href="/crypto/rsa/pss.go.html#4407315">sLen</a></span><span class="op" id="4409438">:</span><span class="op" id="4409439">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409443">//&nbsp;12.&nbsp;&nbsp;Let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409456">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;=&nbsp;(0x)00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;||&nbsp;mHash&nbsp;||&nbsp;salt&nbsp;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409521">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;is&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;8&nbsp;+&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;with&nbsp;eight</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409588">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial&nbsp;zero&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409617">//</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409621">//&nbsp;13.&nbsp;Let&nbsp;H&#39;&nbsp;=&nbsp;Hash(M&#39;),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409680">var</span>&nbsp;<span class="ident" id="4409684">prefix</span>&nbsp;<span class="op" id="4409691">[</span><span class="num" id="4409692">8</span><span class="op" id="4409693">]</span><span class="builtintype" id="4409694">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409700"><a href="/crypto/rsa/pss.go.html#4407325">hash</a></span><span class="op" id="4409704">.</span><span class="ident" id="4409705">Write</span><span class="op" id="4409710">(</span><span class="ident" id="4409711"><a href="/crypto/rsa/pss.go.html#4409684">prefix</a></span><span class="op" id="4409717">[</span><span class="op" id="4409718">:</span><span class="op" id="4409719">]</span><span class="op" id="4409720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409723"><a href="/crypto/rsa/pss.go.html#4407325">hash</a></span><span class="op" id="4409727">.</span><span class="ident" id="4409728">Write</span><span class="op" id="4409733">(</span><span class="ident" id="4409734"><a href="/crypto/rsa/pss.go.html#4407289">mHash</a></span><span class="op" id="4409739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409742"><a href="/crypto/rsa/pss.go.html#4407325">hash</a></span><span class="op" id="4409746">.</span><span class="ident" id="4409747">Write</span><span class="op" id="4409752">(</span><span class="ident" id="4409753"><a href="/crypto/rsa/pss.go.html#4409415">salt</a></span><span class="op" id="4409757">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409761">h0</span>&nbsp;<span class="op" id="4409764">:=</span>&nbsp;<span class="ident" id="4409767"><a href="/crypto/rsa/pss.go.html#4407325">hash</a></span><span class="op" id="4409771">.</span><span class="ident" id="4409772">Sum</span><span class="op" id="4409775">(</span><span class="ident" id="4409776">nil</span><span class="op" id="4409779">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409783">//&nbsp;14.&nbsp;If&nbsp;H&nbsp;=&nbsp;H&#39;,&nbsp;output&nbsp;&#34;consistent.&#34;&nbsp;Otherwise,&nbsp;output&nbsp;&#34;inconsistent.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409857">if</span>&nbsp;<span class="op" id="4409860">!</span><span class="ident" id="4409861"><a href="/crypto/rsa/pss.go.html#4405313">bytes</a></span><span class="op" id="4409866">.</span><span class="ident" id="4409867">Equal</span><span class="op" id="4409872">(</span><span class="ident" id="4409873"><a href="/crypto/rsa/pss.go.html#4409761">h0</a></span><span class="op" id="4409875">,</span>&nbsp;<span class="ident" id="4409877"><a href="/crypto/rsa/pss.go.html#4408111">h</a></span><span class="op" id="4409878">)</span>&nbsp;<span class="op" id="4409880">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409884">return</span>&nbsp;<span class="ident" id="4409891"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409911">return</span>&nbsp;<span class="ident" id="4409918">nil</span><br>
<span class="lineno"></span><span class="op" id="4409922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4409925">//&nbsp;signPSSWithSalt&nbsp;calculates&nbsp;the&nbsp;signature&nbsp;of&nbsp;hashed&nbsp;using&nbsp;PSS&nbsp;[1]&nbsp;with&nbsp;specified&nbsp;salt.</span><br>
<span class="lineno"></span><span class="comment" id="4410014">//&nbsp;Note&nbsp;that&nbsp;hashed&nbsp;must&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4410092">//&nbsp;given&nbsp;hash&nbsp;function.&nbsp;salt&nbsp;is&nbsp;a&nbsp;random&nbsp;sequence&nbsp;of&nbsp;bytes&nbsp;whose&nbsp;length&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4410172">//&nbsp;later&nbsp;used&nbsp;to&nbsp;verify&nbsp;the&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4410211">func</span>&nbsp;<span class="ident" id="4410216">signPSSWithSalt</span><span class="op" id="4410231">(</span><span class="ident" id="4410232">rand</span>&nbsp;<span class="ident" id="4410237"><a href="/crypto/rsa/pss.go.html#4405350">io</a></span><span class="op" id="4410239">.</span><span class="ident" id="4410240">Reader</span><span class="op" id="4410246">,</span>&nbsp;<span class="ident" id="4410248">priv</span>&nbsp;<span class="op" id="4410253">*</span><span class="ident" id="4410254"><a href="/crypto/rsa/rsa.go.html#4414783">PrivateKey</a></span><span class="op" id="4410264">,</span>&nbsp;<span class="ident" id="4410266">hash</span>&nbsp;<span class="ident" id="4410271"><a href="/crypto/rsa/pss.go.html#4405322">crypto</a></span><span class="op" id="4410277">.</span><span class="ident" id="4410278">Hash</span><span class="op" id="4410282">,</span>&nbsp;<span class="ident" id="4410284">hashed</span><span class="op" id="4410290">,</span>&nbsp;<span class="ident" id="4410292">salt</span>&nbsp;<span class="op" id="4410297">[</span><span class="op" id="4410298">]</span><span class="builtintype" id="4410299">byte</span><span class="op" id="4410303">)</span>&nbsp;<span class="op" id="4410305">(</span><span class="ident" id="4410306">s</span>&nbsp;<span class="op" id="4410308">[</span><span class="op" id="4410309">]</span><span class="builtintype" id="4410310">byte</span><span class="op" id="4410314">,</span>&nbsp;<span class="ident" id="4410316">err</span>&nbsp;<span class="builtintype" id="4410320">error</span><span class="op" id="4410325">)</span>&nbsp;<span class="op" id="4410327">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410330">nBits</span>&nbsp;<span class="op" id="4410336">:=</span>&nbsp;<span class="ident" id="4410339"><a href="/crypto/rsa/pss.go.html#4410248">priv</a></span><span class="op" id="4410343">.</span><span class="ident" id="4410344">N</span><span class="op" id="4410345">.</span><span class="ident" id="4410346">BitLen</span><span class="op" id="4410352">(</span><span class="op" id="4410353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410356">em</span><span class="op" id="4410358">,</span>&nbsp;<span class="ident" id="4410360"><a href="/crypto/rsa/pss.go.html#4410316">err</a></span>&nbsp;<span class="op" id="4410364">:=</span>&nbsp;<span class="ident" id="4410367"><a href="/crypto/rsa/pss.go.html#4405375">emsaPSSEncode</a></span><span class="op" id="4410380">(</span><span class="ident" id="4410381"><a href="/crypto/rsa/pss.go.html#4410284">hashed</a></span><span class="op" id="4410387">,</span>&nbsp;<span class="ident" id="4410389"><a href="/crypto/rsa/pss.go.html#4410330">nBits</a></span><span class="op" id="4410394">-</span><span class="num" id="4410395">1</span><span class="op" id="4410396">,</span>&nbsp;<span class="ident" id="4410398"><a href="/crypto/rsa/pss.go.html#4410292">salt</a></span><span class="op" id="4410402">,</span>&nbsp;<span class="ident" id="4410404"><a href="/crypto/rsa/pss.go.html#4410266">hash</a></span><span class="op" id="4410408">.</span><span class="ident" id="4410409">New</span><span class="op" id="4410412">(</span><span class="op" id="4410413">)</span><span class="op" id="4410414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410417">if</span>&nbsp;<span class="ident" id="4410420"><a href="/crypto/rsa/pss.go.html#4410316">err</a></span>&nbsp;<span class="op" id="4410424">!=</span>&nbsp;<span class="ident" id="4410427">nil</span>&nbsp;<span class="op" id="4410431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410435">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4410443">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410446">m</span>&nbsp;<span class="op" id="4410448">:=</span>&nbsp;<span class="builtinfunc" id="4410451">new</span><span class="op" id="4410454">(</span><span class="ident" id="4410455"><a href="/crypto/rsa/pss.go.html#4405356">big</a></span><span class="op" id="4410458">.</span><span class="ident" id="4410459">Int</span><span class="op" id="4410462">)</span><span class="op" id="4410463">.</span><span class="ident" id="4410464">SetBytes</span><span class="op" id="4410472">(</span><span class="ident" id="4410473"><a href="/crypto/rsa/pss.go.html#4410356">em</a></span><span class="op" id="4410475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410478">c</span><span class="op" id="4410479">,</span>&nbsp;<span class="ident" id="4410481"><a href="/crypto/rsa/pss.go.html#4410316">err</a></span>&nbsp;<span class="op" id="4410485">:=</span>&nbsp;<span class="ident" id="4410488"><a href="/crypto/rsa/rsa.go.html#4424963">decrypt</a></span><span class="op" id="4410495">(</span><span class="ident" id="4410496"><a href="/crypto/rsa/pss.go.html#4410232">rand</a></span><span class="op" id="4410500">,</span>&nbsp;<span class="ident" id="4410502"><a href="/crypto/rsa/pss.go.html#4410248">priv</a></span><span class="op" id="4410506">,</span>&nbsp;<span class="ident" id="4410508"><a href="/crypto/rsa/pss.go.html#4410446">m</a></span><span class="op" id="4410509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410512">if</span>&nbsp;<span class="ident" id="4410515"><a href="/crypto/rsa/pss.go.html#4410316">err</a></span>&nbsp;<span class="op" id="4410519">!=</span>&nbsp;<span class="ident" id="4410522">nil</span>&nbsp;<span class="op" id="4410526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410530">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4410538">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410541"><a href="/crypto/rsa/pss.go.html#4410306">s</a></span>&nbsp;<span class="op" id="4410543">=</span>&nbsp;<span class="builtinfunc" id="4410545">make</span><span class="op" id="4410549">(</span><span class="op" id="4410550">[</span><span class="op" id="4410551">]</span><span class="builtintype" id="4410552">byte</span><span class="op" id="4410556">,</span>&nbsp;<span class="op" id="4410558">(</span><span class="ident" id="4410559"><a href="/crypto/rsa/pss.go.html#4410330">nBits</a></span><span class="op" id="4410564">+</span><span class="num" id="4410565">7</span><span class="op" id="4410566">)</span><span class="op" id="4410567">/</span><span class="num" id="4410568">8</span><span class="op" id="4410569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410572"><a href="/crypto/rsa/pkcs1v15.go.html#4404804">copyWithLeftPad</a></span><span class="op" id="4410587">(</span><span class="ident" id="4410588"><a href="/crypto/rsa/pss.go.html#4410306">s</a></span><span class="op" id="4410589">,</span>&nbsp;<span class="ident" id="4410591"><a href="/crypto/rsa/pss.go.html#4410478">c</a></span><span class="op" id="4410592">.</span><span class="ident" id="4410593">Bytes</span><span class="op" id="4410598">(</span><span class="op" id="4410599">)</span><span class="op" id="4410600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410603">return</span><br>
<span class="lineno"></span><span class="op" id="4410610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4410613">const</span>&nbsp;<span class="op" id="4410619">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4410622">//&nbsp;PSSSaltLengthAuto&nbsp;causes&nbsp;the&nbsp;salt&nbsp;in&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;to&nbsp;be&nbsp;as&nbsp;large</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4410694">//&nbsp;as&nbsp;possible&nbsp;when&nbsp;signing,&nbsp;and&nbsp;to&nbsp;be&nbsp;auto-detected&nbsp;when&nbsp;verifying.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410764">PSSSaltLengthAuto</span>&nbsp;<span class="op" id="4410782">=</span>&nbsp;<span class="num" id="4410784">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4410787">//&nbsp;PSSSaltLengthEqualsHash&nbsp;causes&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;equal&nbsp;the&nbsp;length</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4410858">//&nbsp;of&nbsp;the&nbsp;hash&nbsp;used&nbsp;in&nbsp;the&nbsp;signature.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410897">PSSSaltLengthEqualsHash</span>&nbsp;<span class="op" id="4410921">=</span>&nbsp;<span class="op" id="4410923">-</span><span class="num" id="4410924">1</span><br>
<span class="lineno"></span><span class="op" id="4410926">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4410929">//&nbsp;PSSOptions&nbsp;contains&nbsp;options&nbsp;for&nbsp;creating&nbsp;and&nbsp;verifying&nbsp;PSS&nbsp;signatures.</span><br>
<span class="lineno">220</span><span class="keyword" id="4411003">type</span>&nbsp;<span class="ident" id="4411008">PSSOptions</span>&nbsp;<span class="keyword" id="4411019">struct</span>&nbsp;<span class="op" id="4411026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4411029">//&nbsp;SaltLength&nbsp;controls&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;salt&nbsp;used&nbsp;in&nbsp;the&nbsp;PSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4411092">//&nbsp;signature.&nbsp;It&nbsp;can&nbsp;either&nbsp;be&nbsp;a&nbsp;number&nbsp;of&nbsp;bytes,&nbsp;or&nbsp;one&nbsp;of&nbsp;the&nbsp;special</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4411165">//&nbsp;PSSSaltLength&nbsp;constants.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411194">SaltLength</span>&nbsp;<span class="builtintype" id="4411205">int</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4411211">//&nbsp;Hash,&nbsp;if&nbsp;not&nbsp;zero,&nbsp;overrides&nbsp;the&nbsp;hash&nbsp;function&nbsp;passed&nbsp;to&nbsp;SignPSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4411281">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;way&nbsp;to&nbsp;specify&nbsp;the&nbsp;hash&nbsp;function&nbsp;when&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4411350">//&nbsp;crypto.Signer&nbsp;interface.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411379">Hash</span>&nbsp;<span class="ident" id="4411384"><a href="/crypto/rsa/pss.go.html#4405322">crypto</a></span><span class="op" id="4411390">.</span><span class="ident" id="4411391">Hash</span><br>
<span class="lineno">230</span><span class="op" id="4411396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4411399">//&nbsp;HashFunc&nbsp;returns&nbsp;pssOpts.Hash&nbsp;so&nbsp;that&nbsp;PSSOptions&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="4411462">//&nbsp;crypto.SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="4411484">func</span>&nbsp;<span class="op" id="4411489">(</span><span class="ident" id="4411490">pssOpts</span>&nbsp;<span class="op" id="4411498">*</span><span class="ident" id="4411499"><a href="/crypto/rsa/pss.go.html#4411008">PSSOptions</a></span><span class="op" id="4411509">)</span>&nbsp;<span class="ident" id="4411511">HashFunc</span><span class="op" id="4411519">(</span><span class="op" id="4411520">)</span>&nbsp;<span class="ident" id="4411522"><a href="/crypto/rsa/pss.go.html#4405322">crypto</a></span><span class="op" id="4411528">.</span><span class="ident" id="4411529">Hash</span>&nbsp;<span class="op" id="4411534">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411537">return</span>&nbsp;<span class="ident" id="4411544"><a href="/crypto/rsa/pss.go.html#4411490">pssOpts</a></span><span class="op" id="4411551">.</span><span class="ident" id="4411552">Hash</span><br>
<span class="lineno"></span><span class="op" id="4411557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4411560">func</span>&nbsp;<span class="op" id="4411565">(</span><span class="ident" id="4411566">opts</span>&nbsp;<span class="op" id="4411571">*</span><span class="ident" id="4411572"><a href="/crypto/rsa/pss.go.html#4411008">PSSOptions</a></span><span class="op" id="4411582">)</span>&nbsp;<span class="ident" id="4411584">saltLength</span><span class="op" id="4411594">(</span><span class="op" id="4411595">)</span>&nbsp;<span class="builtintype" id="4411597">int</span>&nbsp;<span class="op" id="4411601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411604">if</span>&nbsp;<span class="ident" id="4411607"><a href="/crypto/rsa/pss.go.html#4411566">opts</a></span>&nbsp;<span class="op" id="4411612">==</span>&nbsp;<span class="ident" id="4411615">nil</span>&nbsp;<span class="op" id="4411619">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411623">return</span>&nbsp;<span class="ident" id="4411630"><a href="/crypto/rsa/pss.go.html#4410764">PSSSaltLengthAuto</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4411649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411652">return</span>&nbsp;<span class="ident" id="4411659"><a href="/crypto/rsa/pss.go.html#4411566">opts</a></span><span class="op" id="4411663">.</span><span class="ident" id="4411664">SaltLength</span><br>
<span class="lineno"></span><span class="op" id="4411675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="4411678">//&nbsp;SignPSS&nbsp;calculates&nbsp;the&nbsp;signature&nbsp;of&nbsp;hashed&nbsp;using&nbsp;RSASSA-PSS&nbsp;[1].</span><br>
<span class="lineno"></span><span class="comment" id="4411746">//&nbsp;Note&nbsp;that&nbsp;hashed&nbsp;must&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4411824">//&nbsp;given&nbsp;hash&nbsp;function.&nbsp;The&nbsp;opts&nbsp;argument&nbsp;may&nbsp;be&nbsp;nil,&nbsp;in&nbsp;which&nbsp;case&nbsp;sensible</span><br>
<span class="lineno"></span><span class="comment" id="4411901">//&nbsp;defaults&nbsp;are&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="4411923">func</span>&nbsp;<span class="ident" id="4411928">SignPSS</span><span class="op" id="4411935">(</span><span class="ident" id="4411936">rand</span>&nbsp;<span class="ident" id="4411941"><a href="/crypto/rsa/pss.go.html#4405350">io</a></span><span class="op" id="4411943">.</span><span class="ident" id="4411944">Reader</span><span class="op" id="4411950">,</span>&nbsp;<span class="ident" id="4411952">priv</span>&nbsp;<span class="op" id="4411957">*</span><span class="ident" id="4411958"><a href="/crypto/rsa/rsa.go.html#4414783">PrivateKey</a></span><span class="op" id="4411968">,</span>&nbsp;<span class="ident" id="4411970">hash</span>&nbsp;<span class="ident" id="4411975"><a href="/crypto/rsa/pss.go.html#4405322">crypto</a></span><span class="op" id="4411981">.</span><span class="ident" id="4411982">Hash</span><span class="op" id="4411986">,</span>&nbsp;<span class="ident" id="4411988">hashed</span>&nbsp;<span class="op" id="4411995">[</span><span class="op" id="4411996">]</span><span class="builtintype" id="4411997">byte</span><span class="op" id="4412001">,</span>&nbsp;<span class="ident" id="4412003">opts</span>&nbsp;<span class="op" id="4412008">*</span><span class="ident" id="4412009"><a href="/crypto/rsa/pss.go.html#4411008">PSSOptions</a></span><span class="op" id="4412019">)</span>&nbsp;<span class="op" id="4412021">(</span><span class="ident" id="4412022">s</span>&nbsp;<span class="op" id="4412024">[</span><span class="op" id="4412025">]</span><span class="builtintype" id="4412026">byte</span><span class="op" id="4412030">,</span>&nbsp;<span class="ident" id="4412032">err</span>&nbsp;<span class="builtintype" id="4412036">error</span><span class="op" id="4412041">)</span>&nbsp;<span class="op" id="4412043">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412046">saltLength</span>&nbsp;<span class="op" id="4412057">:=</span>&nbsp;<span class="ident" id="4412060"><a href="/crypto/rsa/pss.go.html#4412003">opts</a></span><span class="op" id="4412064">.</span><span class="ident" id="4412065">saltLength</span><span class="op" id="4412075">(</span><span class="op" id="4412076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412079">switch</span>&nbsp;<span class="ident" id="4412086"><a href="/crypto/rsa/pss.go.html#4412046">saltLength</a></span>&nbsp;<span class="op" id="4412097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412100">case</span>&nbsp;<span class="ident" id="4412105"><a href="/crypto/rsa/pss.go.html#4410764">PSSSaltLengthAuto</a></span><span class="op" id="4412122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412126"><a href="/crypto/rsa/pss.go.html#4412046">saltLength</a></span>&nbsp;<span class="op" id="4412137">=</span>&nbsp;<span class="op" id="4412139">(</span><span class="ident" id="4412140"><a href="/crypto/rsa/pss.go.html#4411952">priv</a></span><span class="op" id="4412144">.</span><span class="ident" id="4412145">N</span><span class="op" id="4412146">.</span><span class="ident" id="4412147">BitLen</span><span class="op" id="4412153">(</span><span class="op" id="4412154">)</span><span class="op" id="4412155">+</span><span class="num" id="4412156">7</span><span class="op" id="4412157">)</span><span class="op" id="4412158">/</span><span class="num" id="4412159">8</span>&nbsp;<span class="op" id="4412161">-</span>&nbsp;<span class="num" id="4412163">2</span>&nbsp;<span class="op" id="4412165">-</span>&nbsp;<span class="ident" id="4412167"><a href="/crypto/rsa/pss.go.html#4411970">hash</a></span><span class="op" id="4412171">.</span><span class="ident" id="4412172">Size</span><span class="op" id="4412176">(</span><span class="op" id="4412177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412180">case</span>&nbsp;<span class="ident" id="4412185"><a href="/crypto/rsa/pss.go.html#4410897">PSSSaltLengthEqualsHash</a></span><span class="op" id="4412208">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412212"><a href="/crypto/rsa/pss.go.html#4412046">saltLength</a></span>&nbsp;<span class="op" id="4412223">=</span>&nbsp;<span class="ident" id="4412225"><a href="/crypto/rsa/pss.go.html#4411970">hash</a></span><span class="op" id="4412229">.</span><span class="ident" id="4412230">Size</span><span class="op" id="4412234">(</span><span class="op" id="4412235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412242">if</span>&nbsp;<span class="ident" id="4412245"><a href="/crypto/rsa/pss.go.html#4412003">opts</a></span><span class="op" id="4412249">.</span><span class="ident" id="4412250">Hash</span>&nbsp;<span class="op" id="4412255">!=</span>&nbsp;<span class="num" id="4412258">0</span>&nbsp;<span class="op" id="4412260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412264"><a href="/crypto/rsa/pss.go.html#4411970">hash</a></span>&nbsp;<span class="op" id="4412269">=</span>&nbsp;<span class="ident" id="4412271"><a href="/crypto/rsa/pss.go.html#4412003">opts</a></span><span class="op" id="4412275">.</span><span class="ident" id="4412276">Hash</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412286">salt</span>&nbsp;<span class="op" id="4412291">:=</span>&nbsp;<span class="builtinfunc" id="4412294">make</span><span class="op" id="4412298">(</span><span class="op" id="4412299">[</span><span class="op" id="4412300">]</span><span class="builtintype" id="4412301">byte</span><span class="op" id="4412305">,</span>&nbsp;<span class="ident" id="4412307"><a href="/crypto/rsa/pss.go.html#4412046">saltLength</a></span><span class="op" id="4412317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412320">if</span>&nbsp;<span class="ident" id="4412323">_</span><span class="op" id="4412324">,</span>&nbsp;<span class="ident" id="4412326"><a href="/crypto/rsa/pss.go.html#4412032">err</a></span>&nbsp;<span class="op" id="4412330">=</span>&nbsp;<span class="ident" id="4412332"><a href="/crypto/rsa/pss.go.html#4405350">io</a></span><span class="op" id="4412334">.</span><span class="ident" id="4412335">ReadFull</span><span class="op" id="4412343">(</span><span class="ident" id="4412344"><a href="/crypto/rsa/pss.go.html#4411936">rand</a></span><span class="op" id="4412348">,</span>&nbsp;<span class="ident" id="4412350"><a href="/crypto/rsa/pss.go.html#4412286">salt</a></span><span class="op" id="4412354">)</span><span class="op" id="4412355">;</span>&nbsp;<span class="ident" id="4412357"><a href="/crypto/rsa/pss.go.html#4412032">err</a></span>&nbsp;<span class="op" id="4412361">!=</span>&nbsp;<span class="ident" id="4412364">nil</span>&nbsp;<span class="op" id="4412368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412372">return</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412383">return</span>&nbsp;<span class="ident" id="4412390"><a href="/crypto/rsa/pss.go.html#4410216">signPSSWithSalt</a></span><span class="op" id="4412405">(</span><span class="ident" id="4412406"><a href="/crypto/rsa/pss.go.html#4411936">rand</a></span><span class="op" id="4412410">,</span>&nbsp;<span class="ident" id="4412412"><a href="/crypto/rsa/pss.go.html#4411952">priv</a></span><span class="op" id="4412416">,</span>&nbsp;<span class="ident" id="4412418"><a href="/crypto/rsa/pss.go.html#4411970">hash</a></span><span class="op" id="4412422">,</span>&nbsp;<span class="ident" id="4412424"><a href="/crypto/rsa/pss.go.html#4411988">hashed</a></span><span class="op" id="4412430">,</span>&nbsp;<span class="ident" id="4412432"><a href="/crypto/rsa/pss.go.html#4412286">salt</a></span><span class="op" id="4412436">)</span><br>
<span class="lineno"></span><span class="op" id="4412438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4412441">//&nbsp;VerifyPSS&nbsp;verifies&nbsp;a&nbsp;PSS&nbsp;signature.</span><br>
<span class="lineno">270</span><span class="comment" id="4412480">//&nbsp;hashed&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4412554">//&nbsp;function&nbsp;and&nbsp;sig&nbsp;is&nbsp;the&nbsp;signature.&nbsp;A&nbsp;valid&nbsp;signature&nbsp;is&nbsp;indicated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4412626">//&nbsp;returning&nbsp;a&nbsp;nil&nbsp;error.&nbsp;The&nbsp;opts&nbsp;argument&nbsp;may&nbsp;be&nbsp;nil,&nbsp;in&nbsp;which&nbsp;case&nbsp;sensible</span><br>
<span class="lineno"></span><span class="comment" id="4412705">//&nbsp;defaults&nbsp;are&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="4412727">func</span>&nbsp;<span class="ident" id="4412732">VerifyPSS</span><span class="op" id="4412741">(</span><span class="ident" id="4412742">pub</span>&nbsp;<span class="op" id="4412746">*</span><span class="ident" id="4412747"><a href="/crypto/rsa/rsa.go.html#4413952">PublicKey</a></span><span class="op" id="4412756">,</span>&nbsp;<span class="ident" id="4412758">hash</span>&nbsp;<span class="ident" id="4412763"><a href="/crypto/rsa/pss.go.html#4405322">crypto</a></span><span class="op" id="4412769">.</span><span class="ident" id="4412770">Hash</span><span class="op" id="4412774">,</span>&nbsp;<span class="ident" id="4412776">hashed</span>&nbsp;<span class="op" id="4412783">[</span><span class="op" id="4412784">]</span><span class="builtintype" id="4412785">byte</span><span class="op" id="4412789">,</span>&nbsp;<span class="ident" id="4412791">sig</span>&nbsp;<span class="op" id="4412795">[</span><span class="op" id="4412796">]</span><span class="builtintype" id="4412797">byte</span><span class="op" id="4412801">,</span>&nbsp;<span class="ident" id="4412803">opts</span>&nbsp;<span class="op" id="4412808">*</span><span class="ident" id="4412809"><a href="/crypto/rsa/pss.go.html#4411008">PSSOptions</a></span><span class="op" id="4412819">)</span>&nbsp;<span class="builtintype" id="4412821">error</span>&nbsp;<span class="op" id="4412827">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412830">return</span>&nbsp;<span class="ident" id="4412837"><a href="/crypto/rsa/pss.go.html#4412964">verifyPSS</a></span><span class="op" id="4412846">(</span><span class="ident" id="4412847"><a href="/crypto/rsa/pss.go.html#4412742">pub</a></span><span class="op" id="4412850">,</span>&nbsp;<span class="ident" id="4412852"><a href="/crypto/rsa/pss.go.html#4412758">hash</a></span><span class="op" id="4412856">,</span>&nbsp;<span class="ident" id="4412858"><a href="/crypto/rsa/pss.go.html#4412776">hashed</a></span><span class="op" id="4412864">,</span>&nbsp;<span class="ident" id="4412866"><a href="/crypto/rsa/pss.go.html#4412791">sig</a></span><span class="op" id="4412869">,</span>&nbsp;<span class="ident" id="4412871"><a href="/crypto/rsa/pss.go.html#4412803">opts</a></span><span class="op" id="4412875">.</span><span class="ident" id="4412876">saltLength</span><span class="op" id="4412886">(</span><span class="op" id="4412887">)</span><span class="op" id="4412888">)</span><br>
<span class="lineno"></span><span class="op" id="4412890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4412893">//&nbsp;verifyPSS&nbsp;verifies&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;with&nbsp;the&nbsp;given&nbsp;salt&nbsp;length.</span><br>
<span class="lineno"></span><span class="keyword" id="4412959">func</span>&nbsp;<span class="ident" id="4412964">verifyPSS</span><span class="op" id="4412973">(</span><span class="ident" id="4412974">pub</span>&nbsp;<span class="op" id="4412978">*</span><span class="ident" id="4412979"><a href="/crypto/rsa/rsa.go.html#4413952">PublicKey</a></span><span class="op" id="4412988">,</span>&nbsp;<span class="ident" id="4412990">hash</span>&nbsp;<span class="ident" id="4412995"><a href="/crypto/rsa/pss.go.html#4405322">crypto</a></span><span class="op" id="4413001">.</span><span class="ident" id="4413002">Hash</span><span class="op" id="4413006">,</span>&nbsp;<span class="ident" id="4413008">hashed</span>&nbsp;<span class="op" id="4413015">[</span><span class="op" id="4413016">]</span><span class="builtintype" id="4413017">byte</span><span class="op" id="4413021">,</span>&nbsp;<span class="ident" id="4413023">sig</span>&nbsp;<span class="op" id="4413027">[</span><span class="op" id="4413028">]</span><span class="builtintype" id="4413029">byte</span><span class="op" id="4413033">,</span>&nbsp;<span class="ident" id="4413035">saltLen</span>&nbsp;<span class="builtintype" id="4413043">int</span><span class="op" id="4413046">)</span>&nbsp;<span class="builtintype" id="4413048">error</span>&nbsp;<span class="op" id="4413054">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413057">nBits</span>&nbsp;<span class="op" id="4413063">:=</span>&nbsp;<span class="ident" id="4413066"><a href="/crypto/rsa/pss.go.html#4412974">pub</a></span><span class="op" id="4413069">.</span><span class="ident" id="4413070">N</span><span class="op" id="4413071">.</span><span class="ident" id="4413072">BitLen</span><span class="op" id="4413078">(</span><span class="op" id="4413079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413082">if</span>&nbsp;<span class="builtinfunc" id="4413085">len</span><span class="op" id="4413088">(</span><span class="ident" id="4413089"><a href="/crypto/rsa/pss.go.html#4413023">sig</a></span><span class="op" id="4413092">)</span>&nbsp;<span class="op" id="4413094">!=</span>&nbsp;<span class="op" id="4413097">(</span><span class="ident" id="4413098"><a href="/crypto/rsa/pss.go.html#4413057">nBits</a></span><span class="op" id="4413103">+</span><span class="num" id="4413104">7</span><span class="op" id="4413105">)</span><span class="op" id="4413106">/</span><span class="num" id="4413107">8</span>&nbsp;<span class="op" id="4413109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413113">return</span>&nbsp;<span class="ident" id="4413120"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413140">s</span>&nbsp;<span class="op" id="4413142">:=</span>&nbsp;<span class="builtinfunc" id="4413145">new</span><span class="op" id="4413148">(</span><span class="ident" id="4413149"><a href="/crypto/rsa/pss.go.html#4405356">big</a></span><span class="op" id="4413152">.</span><span class="ident" id="4413153">Int</span><span class="op" id="4413156">)</span><span class="op" id="4413157">.</span><span class="ident" id="4413158">SetBytes</span><span class="op" id="4413166">(</span><span class="ident" id="4413167"><a href="/crypto/rsa/pss.go.html#4413023">sig</a></span><span class="op" id="4413170">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413173">m</span>&nbsp;<span class="op" id="4413175">:=</span>&nbsp;<span class="ident" id="4413178"><a href="/crypto/rsa/rsa.go.html#4421660">encrypt</a></span><span class="op" id="4413185">(</span><span class="builtinfunc" id="4413186">new</span><span class="op" id="4413189">(</span><span class="ident" id="4413190"><a href="/crypto/rsa/pss.go.html#4405356">big</a></span><span class="op" id="4413193">.</span><span class="ident" id="4413194">Int</span><span class="op" id="4413197">)</span><span class="op" id="4413198">,</span>&nbsp;<span class="ident" id="4413200"><a href="/crypto/rsa/pss.go.html#4412974">pub</a></span><span class="op" id="4413203">,</span>&nbsp;<span class="ident" id="4413205"><a href="/crypto/rsa/pss.go.html#4413140">s</a></span><span class="op" id="4413206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413209">emBits</span>&nbsp;<span class="op" id="4413216">:=</span>&nbsp;<span class="ident" id="4413219"><a href="/crypto/rsa/pss.go.html#4413057">nBits</a></span>&nbsp;<span class="op" id="4413225">-</span>&nbsp;<span class="num" id="4413227">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413230">emLen</span>&nbsp;<span class="op" id="4413236">:=</span>&nbsp;<span class="op" id="4413239">(</span><span class="ident" id="4413240"><a href="/crypto/rsa/pss.go.html#4413209">emBits</a></span>&nbsp;<span class="op" id="4413247">+</span>&nbsp;<span class="num" id="4413249">7</span><span class="op" id="4413250">)</span>&nbsp;<span class="op" id="4413252">/</span>&nbsp;<span class="num" id="4413254">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413257">if</span>&nbsp;<span class="ident" id="4413260"><a href="/crypto/rsa/pss.go.html#4413230">emLen</a></span>&nbsp;<span class="op" id="4413266">&lt;</span>&nbsp;<span class="builtinfunc" id="4413268">len</span><span class="op" id="4413271">(</span><span class="ident" id="4413272"><a href="/crypto/rsa/pss.go.html#4413173">m</a></span><span class="op" id="4413273">.</span><span class="ident" id="4413274">Bytes</span><span class="op" id="4413279">(</span><span class="op" id="4413280">)</span><span class="op" id="4413281">)</span>&nbsp;<span class="op" id="4413283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413287">return</span>&nbsp;<span class="ident" id="4413294"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413314">em</span>&nbsp;<span class="op" id="4413317">:=</span>&nbsp;<span class="builtinfunc" id="4413320">make</span><span class="op" id="4413324">(</span><span class="op" id="4413325">[</span><span class="op" id="4413326">]</span><span class="builtintype" id="4413327">byte</span><span class="op" id="4413331">,</span>&nbsp;<span class="ident" id="4413333"><a href="/crypto/rsa/pss.go.html#4413230">emLen</a></span><span class="op" id="4413338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413341"><a href="/crypto/rsa/pkcs1v15.go.html#4404804">copyWithLeftPad</a></span><span class="op" id="4413356">(</span><span class="ident" id="4413357"><a href="/crypto/rsa/pss.go.html#4413314">em</a></span><span class="op" id="4413359">,</span>&nbsp;<span class="ident" id="4413361"><a href="/crypto/rsa/pss.go.html#4413173">m</a></span><span class="op" id="4413362">.</span><span class="ident" id="4413363">Bytes</span><span class="op" id="4413368">(</span><span class="op" id="4413369">)</span><span class="op" id="4413370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413373">if</span>&nbsp;<span class="ident" id="4413376"><a href="/crypto/rsa/pss.go.html#4413035">saltLen</a></span>&nbsp;<span class="op" id="4413384">==</span>&nbsp;<span class="ident" id="4413387"><a href="/crypto/rsa/pss.go.html#4410897">PSSSaltLengthEqualsHash</a></span>&nbsp;<span class="op" id="4413411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413415"><a href="/crypto/rsa/pss.go.html#4413035">saltLen</a></span>&nbsp;<span class="op" id="4413423">=</span>&nbsp;<span class="ident" id="4413425"><a href="/crypto/rsa/pss.go.html#4412990">hash</a></span><span class="op" id="4413429">.</span><span class="ident" id="4413430">Size</span><span class="op" id="4413434">(</span><span class="op" id="4413435">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413441">return</span>&nbsp;<span class="ident" id="4413448"><a href="/crypto/rsa/pss.go.html#4407275">emsaPSSVerify</a></span><span class="op" id="4413461">(</span><span class="ident" id="4413462"><a href="/crypto/rsa/pss.go.html#4413008">hashed</a></span><span class="op" id="4413468">,</span>&nbsp;<span class="ident" id="4413470"><a href="/crypto/rsa/pss.go.html#4413314">em</a></span><span class="op" id="4413472">,</span>&nbsp;<span class="ident" id="4413474"><a href="/crypto/rsa/pss.go.html#4413209">emBits</a></span><span class="op" id="4413480">,</span>&nbsp;<span class="ident" id="4413482"><a href="/crypto/rsa/pss.go.html#4413035">saltLen</a></span><span class="op" id="4413489">,</span>&nbsp;<span class="ident" id="4413491"><a href="/crypto/rsa/pss.go.html#4412990">hash</a></span><span class="op" id="4413495">.</span><span class="ident" id="4413496">New</span><span class="op" id="4413499">(</span><span class="op" id="4413500">)</span><span class="op" id="4413501">)</span><br>
<span class="lineno"></span><span class="op" id="4413503">}</span>
</div>
</body>
</html>
