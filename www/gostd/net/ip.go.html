<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html" class="current">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4088345">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4088400">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4088454">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4088505">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="4088533">//</span><br>
<span class="lineno"></span><span class="comment" id="4088536">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="4088596">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4088654">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="4088704">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="4088765">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4088796">package</span>&nbsp;<span class="ident" id="4088804">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4088809">import</span>&nbsp;<span class="string" id="4088816">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4088826">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="4088857">const</span>&nbsp;<span class="op" id="4088863">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088866">IPv4len</span>&nbsp;<span class="op" id="4088874">=</span>&nbsp;<span class="num" id="4088876">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088879">IPv6len</span>&nbsp;<span class="op" id="4088887">=</span>&nbsp;<span class="num" id="4088889">16</span><br>
<span class="lineno"></span><span class="op" id="4088892">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4088895">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="4088946">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="4089003">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="4089041">//</span><br>
<span class="lineno"></span><span class="comment" id="4089044">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4089096">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="4089148">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="4089203">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="4089258">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4089281">type</span>&nbsp;<span class="ident" id="4089286">IP</span>&nbsp;<span class="op" id="4089289">[</span><span class="op" id="4089290">]</span><span class="builtintype" id="4089291">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089297">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="4089329">type</span>&nbsp;<span class="ident" id="4089334">IPMask</span>&nbsp;<span class="op" id="4089341">[</span><span class="op" id="4089342">]</span><span class="builtintype" id="4089343">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089349">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="4089387">type</span>&nbsp;<span class="ident" id="4089392">IPNet</span>&nbsp;<span class="keyword" id="4089398">struct</span>&nbsp;<span class="op" id="4089405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089408">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4089413">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4089420">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089439">Mask</span>&nbsp;<span class="ident" id="4089444">IPMask</span>&nbsp;<span class="comment" id="4089451">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="4089467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089470">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4089526">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="4089551">func</span>&nbsp;<span class="ident" id="4089556">IPv4</span><span class="op" id="4089560">(</span><span class="ident" id="4089561">a</span><span class="op" id="4089562">,</span>&nbsp;<span class="ident" id="4089564">b</span><span class="op" id="4089565">,</span>&nbsp;<span class="ident" id="4089567">c</span><span class="op" id="4089568">,</span>&nbsp;<span class="ident" id="4089570">d</span>&nbsp;<span class="builtintype" id="4089572">byte</span><span class="op" id="4089576">)</span>&nbsp;<span class="ident" id="4089578">IP</span>&nbsp;<span class="op" id="4089581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089584">p</span>&nbsp;<span class="op" id="4089586">:=</span>&nbsp;<span class="builtinfunc" id="4089589">make</span><span class="op" id="4089593">(</span><span class="ident" id="4089594">IP</span><span class="op" id="4089596">,</span>&nbsp;<span class="ident" id="4089598">IPv6len</span><span class="op" id="4089605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4089608">copy</span><span class="op" id="4089612">(</span><span class="ident" id="4089613">p</span><span class="op" id="4089614">,</span>&nbsp;<span class="ident" id="4089616">v4InV6Prefix</span><span class="op" id="4089628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089631">p</span><span class="op" id="4089632">[</span><span class="num" id="4089633">12</span><span class="op" id="4089635">]</span>&nbsp;<span class="op" id="4089637">=</span>&nbsp;<span class="ident" id="4089639">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089642">p</span><span class="op" id="4089643">[</span><span class="num" id="4089644">13</span><span class="op" id="4089646">]</span>&nbsp;<span class="op" id="4089648">=</span>&nbsp;<span class="ident" id="4089650">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089653">p</span><span class="op" id="4089654">[</span><span class="num" id="4089655">14</span><span class="op" id="4089657">]</span>&nbsp;<span class="op" id="4089659">=</span>&nbsp;<span class="ident" id="4089661">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089664">p</span><span class="op" id="4089665">[</span><span class="num" id="4089666">15</span><span class="op" id="4089668">]</span>&nbsp;<span class="op" id="4089670">=</span>&nbsp;<span class="ident" id="4089672">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089675">return</span>&nbsp;<span class="ident" id="4089682">p</span><br>
<span class="lineno"></span><span class="op" id="4089684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="4089687">var</span>&nbsp;<span class="ident" id="4089691">v4InV6Prefix</span>&nbsp;<span class="op" id="4089704">=</span>&nbsp;<span class="op" id="4089706">[</span><span class="op" id="4089707">]</span><span class="builtintype" id="4089708">byte</span><span class="op" id="4089712">{</span><span class="num" id="4089713">0</span><span class="op" id="4089714">,</span>&nbsp;<span class="num" id="4089716">0</span><span class="op" id="4089717">,</span>&nbsp;<span class="num" id="4089719">0</span><span class="op" id="4089720">,</span>&nbsp;<span class="num" id="4089722">0</span><span class="op" id="4089723">,</span>&nbsp;<span class="num" id="4089725">0</span><span class="op" id="4089726">,</span>&nbsp;<span class="num" id="4089728">0</span><span class="op" id="4089729">,</span>&nbsp;<span class="num" id="4089731">0</span><span class="op" id="4089732">,</span>&nbsp;<span class="num" id="4089734">0</span><span class="op" id="4089735">,</span>&nbsp;<span class="num" id="4089737">0</span><span class="op" id="4089738">,</span>&nbsp;<span class="num" id="4089740">0</span><span class="op" id="4089741">,</span>&nbsp;<span class="num" id="4089743">0xff</span><span class="op" id="4089747">,</span>&nbsp;<span class="num" id="4089749">0xff</span><span class="op" id="4089753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089756">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4089812">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="4089834">func</span>&nbsp;<span class="ident" id="4089839">IPv4Mask</span><span class="op" id="4089847">(</span><span class="ident" id="4089848">a</span><span class="op" id="4089849">,</span>&nbsp;<span class="ident" id="4089851">b</span><span class="op" id="4089852">,</span>&nbsp;<span class="ident" id="4089854">c</span><span class="op" id="4089855">,</span>&nbsp;<span class="ident" id="4089857">d</span>&nbsp;<span class="builtintype" id="4089859">byte</span><span class="op" id="4089863">)</span>&nbsp;<span class="ident" id="4089865">IPMask</span>&nbsp;<span class="op" id="4089872">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089875">p</span>&nbsp;<span class="op" id="4089877">:=</span>&nbsp;<span class="builtinfunc" id="4089880">make</span><span class="op" id="4089884">(</span><span class="ident" id="4089885">IPMask</span><span class="op" id="4089891">,</span>&nbsp;<span class="ident" id="4089893">IPv4len</span><span class="op" id="4089900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089903">p</span><span class="op" id="4089904">[</span><span class="num" id="4089905">0</span><span class="op" id="4089906">]</span>&nbsp;<span class="op" id="4089908">=</span>&nbsp;<span class="ident" id="4089910">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089913">p</span><span class="op" id="4089914">[</span><span class="num" id="4089915">1</span><span class="op" id="4089916">]</span>&nbsp;<span class="op" id="4089918">=</span>&nbsp;<span class="ident" id="4089920">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089923">p</span><span class="op" id="4089924">[</span><span class="num" id="4089925">2</span><span class="op" id="4089926">]</span>&nbsp;<span class="op" id="4089928">=</span>&nbsp;<span class="ident" id="4089930">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089933">p</span><span class="op" id="4089934">[</span><span class="num" id="4089935">3</span><span class="op" id="4089936">]</span>&nbsp;<span class="op" id="4089938">=</span>&nbsp;<span class="ident" id="4089940">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089943">return</span>&nbsp;<span class="ident" id="4089950">p</span><br>
<span class="lineno"></span><span class="op" id="4089952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089955">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="4090013">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="4090068">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="4090136">func</span>&nbsp;<span class="ident" id="4090141">CIDRMask</span><span class="op" id="4090149">(</span><span class="ident" id="4090150">ones</span><span class="op" id="4090154">,</span>&nbsp;<span class="ident" id="4090156">bits</span>&nbsp;<span class="builtintype" id="4090161">int</span><span class="op" id="4090164">)</span>&nbsp;<span class="ident" id="4090166">IPMask</span>&nbsp;<span class="op" id="4090173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090176">if</span>&nbsp;<span class="ident" id="4090179">bits</span>&nbsp;<span class="op" id="4090184">!=</span>&nbsp;<span class="num" id="4090187">8</span><span class="op" id="4090188">*</span><span class="ident" id="4090189">IPv4len</span>&nbsp;<span class="op" id="4090197">&amp;&amp;</span>&nbsp;<span class="ident" id="4090200">bits</span>&nbsp;<span class="op" id="4090205">!=</span>&nbsp;<span class="num" id="4090208">8</span><span class="op" id="4090209">*</span><span class="ident" id="4090210">IPv6len</span>&nbsp;<span class="op" id="4090218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090222">return</span>&nbsp;<span class="ident" id="4090229">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090234">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090237">if</span>&nbsp;<span class="ident" id="4090240">ones</span>&nbsp;<span class="op" id="4090245">&lt;</span>&nbsp;<span class="num" id="4090247">0</span>&nbsp;<span class="op" id="4090249">||</span>&nbsp;<span class="ident" id="4090252">ones</span>&nbsp;<span class="op" id="4090257">&gt;</span>&nbsp;<span class="ident" id="4090259">bits</span>&nbsp;<span class="op" id="4090264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090268">return</span>&nbsp;<span class="ident" id="4090275">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090283">l</span>&nbsp;<span class="op" id="4090285">:=</span>&nbsp;<span class="ident" id="4090288">bits</span>&nbsp;<span class="op" id="4090293">/</span>&nbsp;<span class="num" id="4090295">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090298">m</span>&nbsp;<span class="op" id="4090300">:=</span>&nbsp;<span class="builtinfunc" id="4090303">make</span><span class="op" id="4090307">(</span><span class="ident" id="4090308">IPMask</span><span class="op" id="4090314">,</span>&nbsp;<span class="ident" id="4090316">l</span><span class="op" id="4090317">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090320">n</span>&nbsp;<span class="op" id="4090322">:=</span>&nbsp;<span class="builtintype" id="4090325">uint</span><span class="op" id="4090329">(</span><span class="ident" id="4090330">ones</span><span class="op" id="4090334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090337">for</span>&nbsp;<span class="ident" id="4090341">i</span>&nbsp;<span class="op" id="4090343">:=</span>&nbsp;<span class="num" id="4090346">0</span><span class="op" id="4090347">;</span>&nbsp;<span class="ident" id="4090349">i</span>&nbsp;<span class="op" id="4090351">&lt;</span>&nbsp;<span class="ident" id="4090353">l</span><span class="op" id="4090354">;</span>&nbsp;<span class="ident" id="4090356">i</span><span class="op" id="4090357">++</span>&nbsp;<span class="op" id="4090360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090364">if</span>&nbsp;<span class="ident" id="4090367">n</span>&nbsp;<span class="op" id="4090369">&gt;=</span>&nbsp;<span class="num" id="4090372">8</span>&nbsp;<span class="op" id="4090374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090379">m</span><span class="op" id="4090380">[</span><span class="ident" id="4090381">i</span><span class="op" id="4090382">]</span>&nbsp;<span class="op" id="4090384">=</span>&nbsp;<span class="num" id="4090386">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090394">n</span>&nbsp;<span class="op" id="4090396">-=</span>&nbsp;<span class="num" id="4090399">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090404">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090419">m</span><span class="op" id="4090420">[</span><span class="ident" id="4090421">i</span><span class="op" id="4090422">]</span>&nbsp;<span class="op" id="4090424">=</span>&nbsp;<span class="op" id="4090426">^</span><span class="builtintype" id="4090427">byte</span><span class="op" id="4090431">(</span><span class="num" id="4090432">0xff</span>&nbsp;<span class="op" id="4090437">&gt;&gt;</span>&nbsp;<span class="ident" id="4090440">n</span><span class="op" id="4090441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090445">n</span>&nbsp;<span class="op" id="4090447">=</span>&nbsp;<span class="num" id="4090449">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090452">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090455">return</span>&nbsp;<span class="ident" id="4090462">m</span><br>
<span class="lineno"></span><span class="op" id="4090464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4090467">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="4090496">var</span>&nbsp;<span class="op" id="4090500">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090503">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090517">=</span>&nbsp;<span class="ident" id="4090519">IPv4</span><span class="op" id="4090523">(</span><span class="num" id="4090524">255</span><span class="op" id="4090527">,</span>&nbsp;<span class="num" id="4090529">255</span><span class="op" id="4090532">,</span>&nbsp;<span class="num" id="4090534">255</span><span class="op" id="4090537">,</span>&nbsp;<span class="num" id="4090539">255</span><span class="op" id="4090542">)</span>&nbsp;<span class="comment" id="4090544">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090558">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090572">=</span>&nbsp;<span class="ident" id="4090574">IPv4</span><span class="op" id="4090578">(</span><span class="num" id="4090579">224</span><span class="op" id="4090582">,</span>&nbsp;<span class="num" id="4090584">0</span><span class="op" id="4090585">,</span>&nbsp;<span class="num" id="4090587">0</span><span class="op" id="4090588">,</span>&nbsp;<span class="num" id="4090590">1</span><span class="op" id="4090591">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4090599">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090615">IPv4allrouter</span>&nbsp;<span class="op" id="4090629">=</span>&nbsp;<span class="ident" id="4090631">IPv4</span><span class="op" id="4090635">(</span><span class="num" id="4090636">224</span><span class="op" id="4090639">,</span>&nbsp;<span class="num" id="4090641">0</span><span class="op" id="4090642">,</span>&nbsp;<span class="num" id="4090644">0</span><span class="op" id="4090645">,</span>&nbsp;<span class="num" id="4090647">2</span><span class="op" id="4090648">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4090656">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090672">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090686">=</span>&nbsp;<span class="ident" id="4090688">IPv4</span><span class="op" id="4090692">(</span><span class="num" id="4090693">0</span><span class="op" id="4090694">,</span>&nbsp;<span class="num" id="4090696">0</span><span class="op" id="4090697">,</span>&nbsp;<span class="num" id="4090699">0</span><span class="op" id="4090700">,</span>&nbsp;<span class="num" id="4090702">0</span><span class="op" id="4090703">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4090713">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="4090726">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4090729">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="4090758">var</span>&nbsp;<span class="op" id="4090762">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090765">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090792">=</span>&nbsp;<span class="ident" id="4090794">IP</span><span class="op" id="4090796">{</span><span class="num" id="4090797">0</span><span class="op" id="4090798">,</span>&nbsp;<span class="num" id="4090800">0</span><span class="op" id="4090801">,</span>&nbsp;<span class="num" id="4090803">0</span><span class="op" id="4090804">,</span>&nbsp;<span class="num" id="4090806">0</span><span class="op" id="4090807">,</span>&nbsp;<span class="num" id="4090809">0</span><span class="op" id="4090810">,</span>&nbsp;<span class="num" id="4090812">0</span><span class="op" id="4090813">,</span>&nbsp;<span class="num" id="4090815">0</span><span class="op" id="4090816">,</span>&nbsp;<span class="num" id="4090818">0</span><span class="op" id="4090819">,</span>&nbsp;<span class="num" id="4090821">0</span><span class="op" id="4090822">,</span>&nbsp;<span class="num" id="4090824">0</span><span class="op" id="4090825">,</span>&nbsp;<span class="num" id="4090827">0</span><span class="op" id="4090828">,</span>&nbsp;<span class="num" id="4090830">0</span><span class="op" id="4090831">,</span>&nbsp;<span class="num" id="4090833">0</span><span class="op" id="4090834">,</span>&nbsp;<span class="num" id="4090836">0</span><span class="op" id="4090837">,</span>&nbsp;<span class="num" id="4090839">0</span><span class="op" id="4090840">,</span>&nbsp;<span class="num" id="4090842">0</span><span class="op" id="4090843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090846">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090873">=</span>&nbsp;<span class="ident" id="4090875">IP</span><span class="op" id="4090877">{</span><span class="num" id="4090878">0</span><span class="op" id="4090879">,</span>&nbsp;<span class="num" id="4090881">0</span><span class="op" id="4090882">,</span>&nbsp;<span class="num" id="4090884">0</span><span class="op" id="4090885">,</span>&nbsp;<span class="num" id="4090887">0</span><span class="op" id="4090888">,</span>&nbsp;<span class="num" id="4090890">0</span><span class="op" id="4090891">,</span>&nbsp;<span class="num" id="4090893">0</span><span class="op" id="4090894">,</span>&nbsp;<span class="num" id="4090896">0</span><span class="op" id="4090897">,</span>&nbsp;<span class="num" id="4090899">0</span><span class="op" id="4090900">,</span>&nbsp;<span class="num" id="4090902">0</span><span class="op" id="4090903">,</span>&nbsp;<span class="num" id="4090905">0</span><span class="op" id="4090906">,</span>&nbsp;<span class="num" id="4090908">0</span><span class="op" id="4090909">,</span>&nbsp;<span class="num" id="4090911">0</span><span class="op" id="4090912">,</span>&nbsp;<span class="num" id="4090914">0</span><span class="op" id="4090915">,</span>&nbsp;<span class="num" id="4090917">0</span><span class="op" id="4090918">,</span>&nbsp;<span class="num" id="4090920">0</span><span class="op" id="4090921">,</span>&nbsp;<span class="num" id="4090923">0</span><span class="op" id="4090924">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090927">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090954">=</span>&nbsp;<span class="ident" id="4090956">IP</span><span class="op" id="4090958">{</span><span class="num" id="4090959">0</span><span class="op" id="4090960">,</span>&nbsp;<span class="num" id="4090962">0</span><span class="op" id="4090963">,</span>&nbsp;<span class="num" id="4090965">0</span><span class="op" id="4090966">,</span>&nbsp;<span class="num" id="4090968">0</span><span class="op" id="4090969">,</span>&nbsp;<span class="num" id="4090971">0</span><span class="op" id="4090972">,</span>&nbsp;<span class="num" id="4090974">0</span><span class="op" id="4090975">,</span>&nbsp;<span class="num" id="4090977">0</span><span class="op" id="4090978">,</span>&nbsp;<span class="num" id="4090980">0</span><span class="op" id="4090981">,</span>&nbsp;<span class="num" id="4090983">0</span><span class="op" id="4090984">,</span>&nbsp;<span class="num" id="4090986">0</span><span class="op" id="4090987">,</span>&nbsp;<span class="num" id="4090989">0</span><span class="op" id="4090990">,</span>&nbsp;<span class="num" id="4090992">0</span><span class="op" id="4090993">,</span>&nbsp;<span class="num" id="4090995">0</span><span class="op" id="4090996">,</span>&nbsp;<span class="num" id="4090998">0</span><span class="op" id="4090999">,</span>&nbsp;<span class="num" id="4091001">0</span><span class="op" id="4091002">,</span>&nbsp;<span class="num" id="4091004">1</span><span class="op" id="4091005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091008">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="4091035">=</span>&nbsp;<span class="ident" id="4091037">IP</span><span class="op" id="4091039">{</span><span class="num" id="4091040">0xff</span><span class="op" id="4091044">,</span>&nbsp;<span class="num" id="4091046">0x01</span><span class="op" id="4091050">,</span>&nbsp;<span class="num" id="4091052">0</span><span class="op" id="4091053">,</span>&nbsp;<span class="num" id="4091055">0</span><span class="op" id="4091056">,</span>&nbsp;<span class="num" id="4091058">0</span><span class="op" id="4091059">,</span>&nbsp;<span class="num" id="4091061">0</span><span class="op" id="4091062">,</span>&nbsp;<span class="num" id="4091064">0</span><span class="op" id="4091065">,</span>&nbsp;<span class="num" id="4091067">0</span><span class="op" id="4091068">,</span>&nbsp;<span class="num" id="4091070">0</span><span class="op" id="4091071">,</span>&nbsp;<span class="num" id="4091073">0</span><span class="op" id="4091074">,</span>&nbsp;<span class="num" id="4091076">0</span><span class="op" id="4091077">,</span>&nbsp;<span class="num" id="4091079">0</span><span class="op" id="4091080">,</span>&nbsp;<span class="num" id="4091082">0</span><span class="op" id="4091083">,</span>&nbsp;<span class="num" id="4091085">0</span><span class="op" id="4091086">,</span>&nbsp;<span class="num" id="4091088">0</span><span class="op" id="4091089">,</span>&nbsp;<span class="num" id="4091091">0x01</span><span class="op" id="4091095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091098">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091125">=</span>&nbsp;<span class="ident" id="4091127">IP</span><span class="op" id="4091129">{</span><span class="num" id="4091130">0xff</span><span class="op" id="4091134">,</span>&nbsp;<span class="num" id="4091136">0x02</span><span class="op" id="4091140">,</span>&nbsp;<span class="num" id="4091142">0</span><span class="op" id="4091143">,</span>&nbsp;<span class="num" id="4091145">0</span><span class="op" id="4091146">,</span>&nbsp;<span class="num" id="4091148">0</span><span class="op" id="4091149">,</span>&nbsp;<span class="num" id="4091151">0</span><span class="op" id="4091152">,</span>&nbsp;<span class="num" id="4091154">0</span><span class="op" id="4091155">,</span>&nbsp;<span class="num" id="4091157">0</span><span class="op" id="4091158">,</span>&nbsp;<span class="num" id="4091160">0</span><span class="op" id="4091161">,</span>&nbsp;<span class="num" id="4091163">0</span><span class="op" id="4091164">,</span>&nbsp;<span class="num" id="4091166">0</span><span class="op" id="4091167">,</span>&nbsp;<span class="num" id="4091169">0</span><span class="op" id="4091170">,</span>&nbsp;<span class="num" id="4091172">0</span><span class="op" id="4091173">,</span>&nbsp;<span class="num" id="4091175">0</span><span class="op" id="4091176">,</span>&nbsp;<span class="num" id="4091178">0</span><span class="op" id="4091179">,</span>&nbsp;<span class="num" id="4091181">0x01</span><span class="op" id="4091185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091188">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091215">=</span>&nbsp;<span class="ident" id="4091217">IP</span><span class="op" id="4091219">{</span><span class="num" id="4091220">0xff</span><span class="op" id="4091224">,</span>&nbsp;<span class="num" id="4091226">0x02</span><span class="op" id="4091230">,</span>&nbsp;<span class="num" id="4091232">0</span><span class="op" id="4091233">,</span>&nbsp;<span class="num" id="4091235">0</span><span class="op" id="4091236">,</span>&nbsp;<span class="num" id="4091238">0</span><span class="op" id="4091239">,</span>&nbsp;<span class="num" id="4091241">0</span><span class="op" id="4091242">,</span>&nbsp;<span class="num" id="4091244">0</span><span class="op" id="4091245">,</span>&nbsp;<span class="num" id="4091247">0</span><span class="op" id="4091248">,</span>&nbsp;<span class="num" id="4091250">0</span><span class="op" id="4091251">,</span>&nbsp;<span class="num" id="4091253">0</span><span class="op" id="4091254">,</span>&nbsp;<span class="num" id="4091256">0</span><span class="op" id="4091257">,</span>&nbsp;<span class="num" id="4091259">0</span><span class="op" id="4091260">,</span>&nbsp;<span class="num" id="4091262">0</span><span class="op" id="4091263">,</span>&nbsp;<span class="num" id="4091265">0</span><span class="op" id="4091266">,</span>&nbsp;<span class="num" id="4091268">0</span><span class="op" id="4091269">,</span>&nbsp;<span class="num" id="4091271">0x02</span><span class="op" id="4091275">}</span><br>
<span class="lineno"></span><span class="op" id="4091277">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="4091280">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4091343">func</span>&nbsp;<span class="op" id="4091348">(</span><span class="ident" id="4091349">ip</span>&nbsp;<span class="ident" id="4091352">IP</span><span class="op" id="4091354">)</span>&nbsp;<span class="ident" id="4091356">IsUnspecified</span><span class="op" id="4091369">(</span><span class="op" id="4091370">)</span>&nbsp;<span class="builtintype" id="4091372">bool</span>&nbsp;<span class="op" id="4091377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091380">if</span>&nbsp;<span class="ident" id="4091383">ip</span><span class="op" id="4091385">.</span><span class="ident" id="4091386">Equal</span><span class="op" id="4091391">(</span><span class="ident" id="4091392">IPv4zero</span><span class="op" id="4091400">)</span>&nbsp;<span class="op" id="4091402">||</span>&nbsp;<span class="ident" id="4091405">ip</span><span class="op" id="4091407">.</span><span class="ident" id="4091408">Equal</span><span class="op" id="4091413">(</span><span class="ident" id="4091414">IPv6unspecified</span><span class="op" id="4091429">)</span>&nbsp;<span class="op" id="4091431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091435">return</span>&nbsp;<span class="builtintype" id="4091442">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091451">return</span>&nbsp;<span class="builtintype" id="4091458">false</span><br>
<span class="lineno"></span><span class="op" id="4091464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4091467">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="4091523">func</span>&nbsp;<span class="op" id="4091528">(</span><span class="ident" id="4091529">ip</span>&nbsp;<span class="ident" id="4091532">IP</span><span class="op" id="4091534">)</span>&nbsp;<span class="ident" id="4091536">IsLoopback</span><span class="op" id="4091546">(</span><span class="op" id="4091547">)</span>&nbsp;<span class="builtintype" id="4091549">bool</span>&nbsp;<span class="op" id="4091554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091557">if</span>&nbsp;<span class="ident" id="4091560">ip4</span>&nbsp;<span class="op" id="4091564">:=</span>&nbsp;<span class="ident" id="4091567">ip</span><span class="op" id="4091569">.</span><span class="ident" id="4091570">To4</span><span class="op" id="4091573">(</span><span class="op" id="4091574">)</span><span class="op" id="4091575">;</span>&nbsp;<span class="ident" id="4091577">ip4</span>&nbsp;<span class="op" id="4091581">!=</span>&nbsp;<span class="ident" id="4091584">nil</span>&nbsp;<span class="op" id="4091588">&amp;&amp;</span>&nbsp;<span class="ident" id="4091591">ip4</span><span class="op" id="4091594">[</span><span class="num" id="4091595">0</span><span class="op" id="4091596">]</span>&nbsp;<span class="op" id="4091598">==</span>&nbsp;<span class="num" id="4091601">127</span>&nbsp;<span class="op" id="4091605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091609">return</span>&nbsp;<span class="builtintype" id="4091616">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091625">return</span>&nbsp;<span class="ident" id="4091632">ip</span><span class="op" id="4091634">.</span><span class="ident" id="4091635">Equal</span><span class="op" id="4091640">(</span><span class="ident" id="4091641">IPv6loopback</span><span class="op" id="4091653">)</span><br>
<span class="lineno">125</span><span class="op" id="4091655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4091658">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4091716">func</span>&nbsp;<span class="op" id="4091721">(</span><span class="ident" id="4091722">ip</span>&nbsp;<span class="ident" id="4091725">IP</span><span class="op" id="4091727">)</span>&nbsp;<span class="ident" id="4091729">IsMulticast</span><span class="op" id="4091740">(</span><span class="op" id="4091741">)</span>&nbsp;<span class="builtintype" id="4091743">bool</span>&nbsp;<span class="op" id="4091748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091751">if</span>&nbsp;<span class="ident" id="4091754">ip4</span>&nbsp;<span class="op" id="4091758">:=</span>&nbsp;<span class="ident" id="4091761">ip</span><span class="op" id="4091763">.</span><span class="ident" id="4091764">To4</span><span class="op" id="4091767">(</span><span class="op" id="4091768">)</span><span class="op" id="4091769">;</span>&nbsp;<span class="ident" id="4091771">ip4</span>&nbsp;<span class="op" id="4091775">!=</span>&nbsp;<span class="ident" id="4091778">nil</span>&nbsp;<span class="op" id="4091782">&amp;&amp;</span>&nbsp;<span class="ident" id="4091785">ip4</span><span class="op" id="4091788">[</span><span class="num" id="4091789">0</span><span class="op" id="4091790">]</span><span class="op" id="4091791">&amp;</span><span class="num" id="4091792">0xf0</span>&nbsp;<span class="op" id="4091797">==</span>&nbsp;<span class="num" id="4091800">0xe0</span>&nbsp;<span class="op" id="4091805">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091809">return</span>&nbsp;<span class="builtintype" id="4091816">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091825">return</span>&nbsp;<span class="ident" id="4091832">ip</span><span class="op" id="4091834">[</span><span class="num" id="4091835">0</span><span class="op" id="4091836">]</span>&nbsp;<span class="op" id="4091838">==</span>&nbsp;<span class="num" id="4091841">0xff</span><br>
<span class="lineno"></span><span class="op" id="4091846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4091849">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4091904">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4091945">func</span>&nbsp;<span class="op" id="4091950">(</span><span class="ident" id="4091951">ip</span>&nbsp;<span class="ident" id="4091954">IP</span><span class="op" id="4091956">)</span>&nbsp;<span class="ident" id="4091958">IsInterfaceLocalMulticast</span><span class="op" id="4091983">(</span><span class="op" id="4091984">)</span>&nbsp;<span class="builtintype" id="4091986">bool</span>&nbsp;<span class="op" id="4091991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091994">return</span>&nbsp;<span class="builtinfunc" id="4092001">len</span><span class="op" id="4092004">(</span><span class="ident" id="4092005">ip</span><span class="op" id="4092007">)</span>&nbsp;<span class="op" id="4092009">==</span>&nbsp;<span class="ident" id="4092012">IPv6len</span>&nbsp;<span class="op" id="4092020">&amp;&amp;</span>&nbsp;<span class="ident" id="4092023">ip</span><span class="op" id="4092025">[</span><span class="num" id="4092026">0</span><span class="op" id="4092027">]</span>&nbsp;<span class="op" id="4092029">==</span>&nbsp;<span class="num" id="4092032">0xff</span>&nbsp;<span class="op" id="4092037">&amp;&amp;</span>&nbsp;<span class="ident" id="4092040">ip</span><span class="op" id="4092042">[</span><span class="num" id="4092043">1</span><span class="op" id="4092044">]</span><span class="op" id="4092045">&amp;</span><span class="num" id="4092046">0x0f</span>&nbsp;<span class="op" id="4092051">==</span>&nbsp;<span class="num" id="4092054">0x01</span><br>
<span class="lineno"></span><span class="op" id="4092059">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="4092062">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="4092121">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4092143">func</span>&nbsp;<span class="op" id="4092148">(</span><span class="ident" id="4092149">ip</span>&nbsp;<span class="ident" id="4092152">IP</span><span class="op" id="4092154">)</span>&nbsp;<span class="ident" id="4092156">IsLinkLocalMulticast</span><span class="op" id="4092176">(</span><span class="op" id="4092177">)</span>&nbsp;<span class="builtintype" id="4092179">bool</span>&nbsp;<span class="op" id="4092184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092187">if</span>&nbsp;<span class="ident" id="4092190">ip4</span>&nbsp;<span class="op" id="4092194">:=</span>&nbsp;<span class="ident" id="4092197">ip</span><span class="op" id="4092199">.</span><span class="ident" id="4092200">To4</span><span class="op" id="4092203">(</span><span class="op" id="4092204">)</span><span class="op" id="4092205">;</span>&nbsp;<span class="ident" id="4092207">ip4</span>&nbsp;<span class="op" id="4092211">!=</span>&nbsp;<span class="ident" id="4092214">nil</span>&nbsp;<span class="op" id="4092218">&amp;&amp;</span>&nbsp;<span class="ident" id="4092221">ip4</span><span class="op" id="4092224">[</span><span class="num" id="4092225">0</span><span class="op" id="4092226">]</span>&nbsp;<span class="op" id="4092228">==</span>&nbsp;<span class="num" id="4092231">224</span>&nbsp;<span class="op" id="4092235">&amp;&amp;</span>&nbsp;<span class="ident" id="4092238">ip4</span><span class="op" id="4092241">[</span><span class="num" id="4092242">1</span><span class="op" id="4092243">]</span>&nbsp;<span class="op" id="4092245">==</span>&nbsp;<span class="num" id="4092248">0</span>&nbsp;<span class="op" id="4092250">&amp;&amp;</span>&nbsp;<span class="ident" id="4092253">ip4</span><span class="op" id="4092256">[</span><span class="num" id="4092257">2</span><span class="op" id="4092258">]</span>&nbsp;<span class="op" id="4092260">==</span>&nbsp;<span class="num" id="4092263">0</span>&nbsp;<span class="op" id="4092265">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092269">return</span>&nbsp;<span class="builtintype" id="4092276">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092285">return</span>&nbsp;<span class="ident" id="4092292">ip</span><span class="op" id="4092294">[</span><span class="num" id="4092295">0</span><span class="op" id="4092296">]</span>&nbsp;<span class="op" id="4092298">==</span>&nbsp;<span class="num" id="4092301">0xff</span>&nbsp;<span class="op" id="4092306">&amp;&amp;</span>&nbsp;<span class="ident" id="4092309">ip</span><span class="op" id="4092311">[</span><span class="num" id="4092312">1</span><span class="op" id="4092313">]</span><span class="op" id="4092314">&amp;</span><span class="num" id="4092315">0x0f</span>&nbsp;<span class="op" id="4092320">==</span>&nbsp;<span class="num" id="4092323">0x02</span><br>
<span class="lineno"></span><span class="op" id="4092328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="4092331">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="4092388">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4092408">func</span>&nbsp;<span class="op" id="4092413">(</span><span class="ident" id="4092414">ip</span>&nbsp;<span class="ident" id="4092417">IP</span><span class="op" id="4092419">)</span>&nbsp;<span class="ident" id="4092421">IsLinkLocalUnicast</span><span class="op" id="4092439">(</span><span class="op" id="4092440">)</span>&nbsp;<span class="builtintype" id="4092442">bool</span>&nbsp;<span class="op" id="4092447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092450">if</span>&nbsp;<span class="ident" id="4092453">ip4</span>&nbsp;<span class="op" id="4092457">:=</span>&nbsp;<span class="ident" id="4092460">ip</span><span class="op" id="4092462">.</span><span class="ident" id="4092463">To4</span><span class="op" id="4092466">(</span><span class="op" id="4092467">)</span><span class="op" id="4092468">;</span>&nbsp;<span class="ident" id="4092470">ip4</span>&nbsp;<span class="op" id="4092474">!=</span>&nbsp;<span class="ident" id="4092477">nil</span>&nbsp;<span class="op" id="4092481">&amp;&amp;</span>&nbsp;<span class="ident" id="4092484">ip4</span><span class="op" id="4092487">[</span><span class="num" id="4092488">0</span><span class="op" id="4092489">]</span>&nbsp;<span class="op" id="4092491">==</span>&nbsp;<span class="num" id="4092494">169</span>&nbsp;<span class="op" id="4092498">&amp;&amp;</span>&nbsp;<span class="ident" id="4092501">ip4</span><span class="op" id="4092504">[</span><span class="num" id="4092505">1</span><span class="op" id="4092506">]</span>&nbsp;<span class="op" id="4092508">==</span>&nbsp;<span class="num" id="4092511">254</span>&nbsp;<span class="op" id="4092515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092519">return</span>&nbsp;<span class="builtintype" id="4092526">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092535">return</span>&nbsp;<span class="ident" id="4092542">ip</span><span class="op" id="4092544">[</span><span class="num" id="4092545">0</span><span class="op" id="4092546">]</span>&nbsp;<span class="op" id="4092548">==</span>&nbsp;<span class="num" id="4092551">0xfe</span>&nbsp;<span class="op" id="4092556">&amp;&amp;</span>&nbsp;<span class="ident" id="4092559">ip</span><span class="op" id="4092561">[</span><span class="num" id="4092562">1</span><span class="op" id="4092563">]</span><span class="op" id="4092564">&amp;</span><span class="num" id="4092565">0xc0</span>&nbsp;<span class="op" id="4092570">==</span>&nbsp;<span class="num" id="4092573">0x80</span><br>
<span class="lineno"></span><span class="op" id="4092578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092581">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="4092639">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4092651">func</span>&nbsp;<span class="op" id="4092656">(</span><span class="ident" id="4092657">ip</span>&nbsp;<span class="ident" id="4092660">IP</span><span class="op" id="4092662">)</span>&nbsp;<span class="ident" id="4092664">IsGlobalUnicast</span><span class="op" id="4092679">(</span><span class="op" id="4092680">)</span>&nbsp;<span class="builtintype" id="4092682">bool</span>&nbsp;<span class="op" id="4092687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092690">return</span>&nbsp;<span class="op" id="4092697">!</span><span class="ident" id="4092698">ip</span><span class="op" id="4092700">.</span><span class="ident" id="4092701">IsUnspecified</span><span class="op" id="4092714">(</span><span class="op" id="4092715">)</span>&nbsp;<span class="op" id="4092717">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092722">!</span><span class="ident" id="4092723">ip</span><span class="op" id="4092725">.</span><span class="ident" id="4092726">IsLoopback</span><span class="op" id="4092736">(</span><span class="op" id="4092737">)</span>&nbsp;<span class="op" id="4092739">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092744">!</span><span class="ident" id="4092745">ip</span><span class="op" id="4092747">.</span><span class="ident" id="4092748">IsMulticast</span><span class="op" id="4092759">(</span><span class="op" id="4092760">)</span>&nbsp;<span class="op" id="4092762">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092767">!</span><span class="ident" id="4092768">ip</span><span class="op" id="4092770">.</span><span class="ident" id="4092771">IsLinkLocalUnicast</span><span class="op" id="4092789">(</span><span class="op" id="4092790">)</span><br>
<span class="lineno"></span><span class="op" id="4092792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092795">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="4092814">func</span>&nbsp;<span class="ident" id="4092819">isZeros</span><span class="op" id="4092826">(</span><span class="ident" id="4092827">p</span>&nbsp;<span class="ident" id="4092829">IP</span><span class="op" id="4092831">)</span>&nbsp;<span class="builtintype" id="4092833">bool</span>&nbsp;<span class="op" id="4092838">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092841">for</span>&nbsp;<span class="ident" id="4092845">i</span>&nbsp;<span class="op" id="4092847">:=</span>&nbsp;<span class="num" id="4092850">0</span><span class="op" id="4092851">;</span>&nbsp;<span class="ident" id="4092853">i</span>&nbsp;<span class="op" id="4092855">&lt;</span>&nbsp;<span class="builtinfunc" id="4092857">len</span><span class="op" id="4092860">(</span><span class="ident" id="4092861">p</span><span class="op" id="4092862">)</span><span class="op" id="4092863">;</span>&nbsp;<span class="ident" id="4092865">i</span><span class="op" id="4092866">++</span>&nbsp;<span class="op" id="4092869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092873">if</span>&nbsp;<span class="ident" id="4092876">p</span><span class="op" id="4092877">[</span><span class="ident" id="4092878">i</span><span class="op" id="4092879">]</span>&nbsp;<span class="op" id="4092881">!=</span>&nbsp;<span class="num" id="4092884">0</span>&nbsp;<span class="op" id="4092886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092891">return</span>&nbsp;<span class="builtintype" id="4092898">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092909">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092912">return</span>&nbsp;<span class="builtintype" id="4092919">true</span><br>
<span class="lineno"></span><span class="op" id="4092924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092927">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="4092991">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="4093041">func</span>&nbsp;<span class="op" id="4093046">(</span><span class="ident" id="4093047">ip</span>&nbsp;<span class="ident" id="4093050">IP</span><span class="op" id="4093052">)</span>&nbsp;<span class="ident" id="4093054">To4</span><span class="op" id="4093057">(</span><span class="op" id="4093058">)</span>&nbsp;<span class="ident" id="4093060">IP</span>&nbsp;<span class="op" id="4093063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093066">if</span>&nbsp;<span class="builtinfunc" id="4093069">len</span><span class="op" id="4093072">(</span><span class="ident" id="4093073">ip</span><span class="op" id="4093075">)</span>&nbsp;<span class="op" id="4093077">==</span>&nbsp;<span class="ident" id="4093080">IPv4len</span>&nbsp;<span class="op" id="4093088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093092">return</span>&nbsp;<span class="ident" id="4093099">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093106">if</span>&nbsp;<span class="builtinfunc" id="4093109">len</span><span class="op" id="4093112">(</span><span class="ident" id="4093113">ip</span><span class="op" id="4093115">)</span>&nbsp;<span class="op" id="4093117">==</span>&nbsp;<span class="ident" id="4093120">IPv6len</span>&nbsp;<span class="op" id="4093128">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093133">isZeros</span><span class="op" id="4093140">(</span><span class="ident" id="4093141">ip</span><span class="op" id="4093143">[</span><span class="num" id="4093144">0</span><span class="op" id="4093145">:</span><span class="num" id="4093146">10</span><span class="op" id="4093148">]</span><span class="op" id="4093149">)</span>&nbsp;<span class="op" id="4093151">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093156">ip</span><span class="op" id="4093158">[</span><span class="num" id="4093159">10</span><span class="op" id="4093161">]</span>&nbsp;<span class="op" id="4093163">==</span>&nbsp;<span class="num" id="4093166">0xff</span>&nbsp;<span class="op" id="4093171">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093176">ip</span><span class="op" id="4093178">[</span><span class="num" id="4093179">11</span><span class="op" id="4093181">]</span>&nbsp;<span class="op" id="4093183">==</span>&nbsp;<span class="num" id="4093186">0xff</span>&nbsp;<span class="op" id="4093191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093195">return</span>&nbsp;<span class="ident" id="4093202">ip</span><span class="op" id="4093204">[</span><span class="num" id="4093205">12</span><span class="op" id="4093207">:</span><span class="num" id="4093208">16</span><span class="op" id="4093210">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093213">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093216">return</span>&nbsp;<span class="ident" id="4093223">nil</span><br>
<span class="lineno"></span><span class="op" id="4093227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093230">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="4093294">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="4093368">func</span>&nbsp;<span class="op" id="4093373">(</span><span class="ident" id="4093374">ip</span>&nbsp;<span class="ident" id="4093377">IP</span><span class="op" id="4093379">)</span>&nbsp;<span class="ident" id="4093381">To16</span><span class="op" id="4093385">(</span><span class="op" id="4093386">)</span>&nbsp;<span class="ident" id="4093388">IP</span>&nbsp;<span class="op" id="4093391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093394">if</span>&nbsp;<span class="builtinfunc" id="4093397">len</span><span class="op" id="4093400">(</span><span class="ident" id="4093401">ip</span><span class="op" id="4093403">)</span>&nbsp;<span class="op" id="4093405">==</span>&nbsp;<span class="ident" id="4093408">IPv4len</span>&nbsp;<span class="op" id="4093416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093420">return</span>&nbsp;<span class="ident" id="4093427">IPv4</span><span class="op" id="4093431">(</span><span class="ident" id="4093432">ip</span><span class="op" id="4093434">[</span><span class="num" id="4093435">0</span><span class="op" id="4093436">]</span><span class="op" id="4093437">,</span>&nbsp;<span class="ident" id="4093439">ip</span><span class="op" id="4093441">[</span><span class="num" id="4093442">1</span><span class="op" id="4093443">]</span><span class="op" id="4093444">,</span>&nbsp;<span class="ident" id="4093446">ip</span><span class="op" id="4093448">[</span><span class="num" id="4093449">2</span><span class="op" id="4093450">]</span><span class="op" id="4093451">,</span>&nbsp;<span class="ident" id="4093453">ip</span><span class="op" id="4093455">[</span><span class="num" id="4093456">3</span><span class="op" id="4093457">]</span><span class="op" id="4093458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093464">if</span>&nbsp;<span class="builtinfunc" id="4093467">len</span><span class="op" id="4093470">(</span><span class="ident" id="4093471">ip</span><span class="op" id="4093473">)</span>&nbsp;<span class="op" id="4093475">==</span>&nbsp;<span class="ident" id="4093478">IPv6len</span>&nbsp;<span class="op" id="4093486">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093490">return</span>&nbsp;<span class="ident" id="4093497">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093504">return</span>&nbsp;<span class="ident" id="4093511">nil</span><br>
<span class="lineno"></span><span class="op" id="4093515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4093518">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="4093551">var</span>&nbsp;<span class="op" id="4093555">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093558">classAMask</span>&nbsp;<span class="op" id="4093569">=</span>&nbsp;<span class="ident" id="4093571">IPv4Mask</span><span class="op" id="4093579">(</span><span class="num" id="4093580">0xff</span><span class="op" id="4093584">,</span>&nbsp;<span class="num" id="4093586">0</span><span class="op" id="4093587">,</span>&nbsp;<span class="num" id="4093589">0</span><span class="op" id="4093590">,</span>&nbsp;<span class="num" id="4093592">0</span><span class="op" id="4093593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093596">classBMask</span>&nbsp;<span class="op" id="4093607">=</span>&nbsp;<span class="ident" id="4093609">IPv4Mask</span><span class="op" id="4093617">(</span><span class="num" id="4093618">0xff</span><span class="op" id="4093622">,</span>&nbsp;<span class="num" id="4093624">0xff</span><span class="op" id="4093628">,</span>&nbsp;<span class="num" id="4093630">0</span><span class="op" id="4093631">,</span>&nbsp;<span class="num" id="4093633">0</span><span class="op" id="4093634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093637">classCMask</span>&nbsp;<span class="op" id="4093648">=</span>&nbsp;<span class="ident" id="4093650">IPv4Mask</span><span class="op" id="4093658">(</span><span class="num" id="4093659">0xff</span><span class="op" id="4093663">,</span>&nbsp;<span class="num" id="4093665">0xff</span><span class="op" id="4093669">,</span>&nbsp;<span class="num" id="4093671">0xff</span><span class="op" id="4093675">,</span>&nbsp;<span class="num" id="4093677">0</span><span class="op" id="4093678">)</span><br>
<span class="lineno">210</span><span class="op" id="4093680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093683">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="4093749">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4093812">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="4093854">func</span>&nbsp;<span class="op" id="4093859">(</span><span class="ident" id="4093860">ip</span>&nbsp;<span class="ident" id="4093863">IP</span><span class="op" id="4093865">)</span>&nbsp;<span class="ident" id="4093867">DefaultMask</span><span class="op" id="4093878">(</span><span class="op" id="4093879">)</span>&nbsp;<span class="ident" id="4093881">IPMask</span>&nbsp;<span class="op" id="4093888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093891">if</span>&nbsp;<span class="ident" id="4093894">ip</span>&nbsp;<span class="op" id="4093897">=</span>&nbsp;<span class="ident" id="4093899">ip</span><span class="op" id="4093901">.</span><span class="ident" id="4093902">To4</span><span class="op" id="4093905">(</span><span class="op" id="4093906">)</span><span class="op" id="4093907">;</span>&nbsp;<span class="ident" id="4093909">ip</span>&nbsp;<span class="op" id="4093912">==</span>&nbsp;<span class="ident" id="4093915">nil</span>&nbsp;<span class="op" id="4093919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093923">return</span>&nbsp;<span class="ident" id="4093930">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093938">switch</span>&nbsp;<span class="builtintype" id="4093945">true</span>&nbsp;<span class="op" id="4093950">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093953">case</span>&nbsp;<span class="ident" id="4093958">ip</span><span class="op" id="4093960">[</span><span class="num" id="4093961">0</span><span class="op" id="4093962">]</span>&nbsp;<span class="op" id="4093964">&lt;</span>&nbsp;<span class="num" id="4093966">0x80</span><span class="op" id="4093970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093974">return</span>&nbsp;<span class="ident" id="4093981">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093993">case</span>&nbsp;<span class="ident" id="4093998">ip</span><span class="op" id="4094000">[</span><span class="num" id="4094001">0</span><span class="op" id="4094002">]</span>&nbsp;<span class="op" id="4094004">&lt;</span>&nbsp;<span class="num" id="4094006">0xC0</span><span class="op" id="4094010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094014">return</span>&nbsp;<span class="ident" id="4094021">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094033">default</span><span class="op" id="4094040">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094044">return</span>&nbsp;<span class="ident" id="4094051">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094063">}</span><br>
<span class="lineno"></span><span class="op" id="4094065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094068">func</span>&nbsp;<span class="ident" id="4094073">allFF</span><span class="op" id="4094078">(</span><span class="ident" id="4094079">b</span>&nbsp;<span class="op" id="4094081">[</span><span class="op" id="4094082">]</span><span class="builtintype" id="4094083">byte</span><span class="op" id="4094087">)</span>&nbsp;<span class="builtintype" id="4094089">bool</span>&nbsp;<span class="op" id="4094094">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094097">for</span>&nbsp;<span class="ident" id="4094101">_</span><span class="op" id="4094102">,</span>&nbsp;<span class="ident" id="4094104">c</span>&nbsp;<span class="op" id="4094106">:=</span>&nbsp;<span class="keyword" id="4094109">range</span>&nbsp;<span class="ident" id="4094115">b</span>&nbsp;<span class="op" id="4094117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094121">if</span>&nbsp;<span class="ident" id="4094124">c</span>&nbsp;<span class="op" id="4094126">!=</span>&nbsp;<span class="num" id="4094129">0xff</span>&nbsp;<span class="op" id="4094134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094139">return</span>&nbsp;<span class="builtintype" id="4094146">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094157">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094160">return</span>&nbsp;<span class="builtintype" id="4094167">true</span><br>
<span class="lineno"></span><span class="op" id="4094172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4094175">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="4094242">func</span>&nbsp;<span class="op" id="4094247">(</span><span class="ident" id="4094248">ip</span>&nbsp;<span class="ident" id="4094251">IP</span><span class="op" id="4094253">)</span>&nbsp;<span class="ident" id="4094255">Mask</span><span class="op" id="4094259">(</span><span class="ident" id="4094260">mask</span>&nbsp;<span class="ident" id="4094265">IPMask</span><span class="op" id="4094271">)</span>&nbsp;<span class="ident" id="4094273">IP</span>&nbsp;<span class="op" id="4094276">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094279">if</span>&nbsp;<span class="builtinfunc" id="4094282">len</span><span class="op" id="4094285">(</span><span class="ident" id="4094286">mask</span><span class="op" id="4094290">)</span>&nbsp;<span class="op" id="4094292">==</span>&nbsp;<span class="ident" id="4094295">IPv6len</span>&nbsp;<span class="op" id="4094303">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4094306">len</span><span class="op" id="4094309">(</span><span class="ident" id="4094310">ip</span><span class="op" id="4094312">)</span>&nbsp;<span class="op" id="4094314">==</span>&nbsp;<span class="ident" id="4094317">IPv4len</span>&nbsp;<span class="op" id="4094325">&amp;&amp;</span>&nbsp;<span class="ident" id="4094328">allFF</span><span class="op" id="4094333">(</span><span class="ident" id="4094334">mask</span><span class="op" id="4094338">[</span><span class="op" id="4094339">:</span><span class="num" id="4094340">12</span><span class="op" id="4094342">]</span><span class="op" id="4094343">)</span>&nbsp;<span class="op" id="4094345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094349">mask</span>&nbsp;<span class="op" id="4094354">=</span>&nbsp;<span class="ident" id="4094356">mask</span><span class="op" id="4094360">[</span><span class="num" id="4094361">12</span><span class="op" id="4094363">:</span><span class="op" id="4094364">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094370">if</span>&nbsp;<span class="builtinfunc" id="4094373">len</span><span class="op" id="4094376">(</span><span class="ident" id="4094377">mask</span><span class="op" id="4094381">)</span>&nbsp;<span class="op" id="4094383">==</span>&nbsp;<span class="ident" id="4094386">IPv4len</span>&nbsp;<span class="op" id="4094394">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4094397">len</span><span class="op" id="4094400">(</span><span class="ident" id="4094401">ip</span><span class="op" id="4094403">)</span>&nbsp;<span class="op" id="4094405">==</span>&nbsp;<span class="ident" id="4094408">IPv6len</span>&nbsp;<span class="op" id="4094416">&amp;&amp;</span>&nbsp;<span class="ident" id="4094419">bytesEqual</span><span class="op" id="4094429">(</span><span class="ident" id="4094430">ip</span><span class="op" id="4094432">[</span><span class="op" id="4094433">:</span><span class="num" id="4094434">12</span><span class="op" id="4094436">]</span><span class="op" id="4094437">,</span>&nbsp;<span class="ident" id="4094439">v4InV6Prefix</span><span class="op" id="4094451">)</span>&nbsp;<span class="op" id="4094453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094457">ip</span>&nbsp;<span class="op" id="4094460">=</span>&nbsp;<span class="ident" id="4094462">ip</span><span class="op" id="4094464">[</span><span class="num" id="4094465">12</span><span class="op" id="4094467">:</span><span class="op" id="4094468">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094474">n</span>&nbsp;<span class="op" id="4094476">:=</span>&nbsp;<span class="builtinfunc" id="4094479">len</span><span class="op" id="4094482">(</span><span class="ident" id="4094483">ip</span><span class="op" id="4094485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094488">if</span>&nbsp;<span class="ident" id="4094491">n</span>&nbsp;<span class="op" id="4094493">!=</span>&nbsp;<span class="builtinfunc" id="4094496">len</span><span class="op" id="4094499">(</span><span class="ident" id="4094500">mask</span><span class="op" id="4094504">)</span>&nbsp;<span class="op" id="4094506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094510">return</span>&nbsp;<span class="ident" id="4094517">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094522">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094525">out</span>&nbsp;<span class="op" id="4094529">:=</span>&nbsp;<span class="builtinfunc" id="4094532">make</span><span class="op" id="4094536">(</span><span class="ident" id="4094537">IP</span><span class="op" id="4094539">,</span>&nbsp;<span class="ident" id="4094541">n</span><span class="op" id="4094542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094545">for</span>&nbsp;<span class="ident" id="4094549">i</span>&nbsp;<span class="op" id="4094551">:=</span>&nbsp;<span class="num" id="4094554">0</span><span class="op" id="4094555">;</span>&nbsp;<span class="ident" id="4094557">i</span>&nbsp;<span class="op" id="4094559">&lt;</span>&nbsp;<span class="ident" id="4094561">n</span><span class="op" id="4094562">;</span>&nbsp;<span class="ident" id="4094564">i</span><span class="op" id="4094565">++</span>&nbsp;<span class="op" id="4094568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094572">out</span><span class="op" id="4094575">[</span><span class="ident" id="4094576">i</span><span class="op" id="4094577">]</span>&nbsp;<span class="op" id="4094579">=</span>&nbsp;<span class="ident" id="4094581">ip</span><span class="op" id="4094583">[</span><span class="ident" id="4094584">i</span><span class="op" id="4094585">]</span>&nbsp;<span class="op" id="4094587">&amp;</span>&nbsp;<span class="ident" id="4094589">mask</span><span class="op" id="4094593">[</span><span class="ident" id="4094594">i</span><span class="op" id="4094595">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094601">return</span>&nbsp;<span class="ident" id="4094608">out</span><br>
<span class="lineno">255</span><span class="op" id="4094612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4094615">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="4094671">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="4094735">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="4094804">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="4094841">func</span>&nbsp;<span class="op" id="4094846">(</span><span class="ident" id="4094847">ip</span>&nbsp;<span class="ident" id="4094850">IP</span><span class="op" id="4094852">)</span>&nbsp;<span class="ident" id="4094854">String</span><span class="op" id="4094860">(</span><span class="op" id="4094861">)</span>&nbsp;<span class="builtintype" id="4094863">string</span>&nbsp;<span class="op" id="4094870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094873">p</span>&nbsp;<span class="op" id="4094875">:=</span>&nbsp;<span class="ident" id="4094878">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094883">if</span>&nbsp;<span class="builtinfunc" id="4094886">len</span><span class="op" id="4094889">(</span><span class="ident" id="4094890">ip</span><span class="op" id="4094892">)</span>&nbsp;<span class="op" id="4094894">==</span>&nbsp;<span class="num" id="4094897">0</span>&nbsp;<span class="op" id="4094899">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094903">return</span>&nbsp;<span class="string" id="4094910">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4094923">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094957">if</span>&nbsp;<span class="ident" id="4094960">p4</span>&nbsp;<span class="op" id="4094963">:=</span>&nbsp;<span class="ident" id="4094966">p</span><span class="op" id="4094967">.</span><span class="ident" id="4094968">To4</span><span class="op" id="4094971">(</span><span class="op" id="4094972">)</span><span class="op" id="4094973">;</span>&nbsp;<span class="builtinfunc" id="4094975">len</span><span class="op" id="4094978">(</span><span class="ident" id="4094979">p4</span><span class="op" id="4094981">)</span>&nbsp;<span class="op" id="4094983">==</span>&nbsp;<span class="ident" id="4094986">IPv4len</span>&nbsp;<span class="op" id="4094994">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094998">return</span>&nbsp;<span class="ident" id="4095005">itod</span><span class="op" id="4095009">(</span><span class="builtintype" id="4095010">uint</span><span class="op" id="4095014">(</span><span class="ident" id="4095015">p4</span><span class="op" id="4095017">[</span><span class="num" id="4095018">0</span><span class="op" id="4095019">]</span><span class="op" id="4095020">)</span><span class="op" id="4095021">)</span>&nbsp;<span class="op" id="4095023">+</span>&nbsp;<span class="string" id="4095025">&#34;.&#34;</span>&nbsp;<span class="op" id="4095029">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095034">itod</span><span class="op" id="4095038">(</span><span class="builtintype" id="4095039">uint</span><span class="op" id="4095043">(</span><span class="ident" id="4095044">p4</span><span class="op" id="4095046">[</span><span class="num" id="4095047">1</span><span class="op" id="4095048">]</span><span class="op" id="4095049">)</span><span class="op" id="4095050">)</span>&nbsp;<span class="op" id="4095052">+</span>&nbsp;<span class="string" id="4095054">&#34;.&#34;</span>&nbsp;<span class="op" id="4095058">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095063">itod</span><span class="op" id="4095067">(</span><span class="builtintype" id="4095068">uint</span><span class="op" id="4095072">(</span><span class="ident" id="4095073">p4</span><span class="op" id="4095075">[</span><span class="num" id="4095076">2</span><span class="op" id="4095077">]</span><span class="op" id="4095078">)</span><span class="op" id="4095079">)</span>&nbsp;<span class="op" id="4095081">+</span>&nbsp;<span class="string" id="4095083">&#34;.&#34;</span>&nbsp;<span class="op" id="4095087">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095092">itod</span><span class="op" id="4095096">(</span><span class="builtintype" id="4095097">uint</span><span class="op" id="4095101">(</span><span class="ident" id="4095102">p4</span><span class="op" id="4095104">[</span><span class="num" id="4095105">3</span><span class="op" id="4095106">]</span><span class="op" id="4095107">)</span><span class="op" id="4095108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095111">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095114">if</span>&nbsp;<span class="builtinfunc" id="4095117">len</span><span class="op" id="4095120">(</span><span class="ident" id="4095121">p</span><span class="op" id="4095122">)</span>&nbsp;<span class="op" id="4095124">!=</span>&nbsp;<span class="ident" id="4095127">IPv6len</span>&nbsp;<span class="op" id="4095135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095139">return</span>&nbsp;<span class="string" id="4095146">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4095155">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095186">e0</span>&nbsp;<span class="op" id="4095189">:=</span>&nbsp;<span class="op" id="4095192">-</span><span class="num" id="4095193">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095196">e1</span>&nbsp;<span class="op" id="4095199">:=</span>&nbsp;<span class="op" id="4095202">-</span><span class="num" id="4095203">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095206">for</span>&nbsp;<span class="ident" id="4095210">i</span>&nbsp;<span class="op" id="4095212">:=</span>&nbsp;<span class="num" id="4095215">0</span><span class="op" id="4095216">;</span>&nbsp;<span class="ident" id="4095218">i</span>&nbsp;<span class="op" id="4095220">&lt;</span>&nbsp;<span class="ident" id="4095222">IPv6len</span><span class="op" id="4095229">;</span>&nbsp;<span class="ident" id="4095231">i</span>&nbsp;<span class="op" id="4095233">+=</span>&nbsp;<span class="num" id="4095236">2</span>&nbsp;<span class="op" id="4095238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095242">j</span>&nbsp;<span class="op" id="4095244">:=</span>&nbsp;<span class="ident" id="4095247">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095251">for</span>&nbsp;<span class="ident" id="4095255">j</span>&nbsp;<span class="op" id="4095257">&lt;</span>&nbsp;<span class="ident" id="4095259">IPv6len</span>&nbsp;<span class="op" id="4095267">&amp;&amp;</span>&nbsp;<span class="ident" id="4095270">p</span><span class="op" id="4095271">[</span><span class="ident" id="4095272">j</span><span class="op" id="4095273">]</span>&nbsp;<span class="op" id="4095275">==</span>&nbsp;<span class="num" id="4095278">0</span>&nbsp;<span class="op" id="4095280">&amp;&amp;</span>&nbsp;<span class="ident" id="4095283">p</span><span class="op" id="4095284">[</span><span class="ident" id="4095285">j</span><span class="op" id="4095286">+</span><span class="num" id="4095287">1</span><span class="op" id="4095288">]</span>&nbsp;<span class="op" id="4095290">==</span>&nbsp;<span class="num" id="4095293">0</span>&nbsp;<span class="op" id="4095295">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095300">j</span>&nbsp;<span class="op" id="4095302">+=</span>&nbsp;<span class="num" id="4095305">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095313">if</span>&nbsp;<span class="ident" id="4095316">j</span>&nbsp;<span class="op" id="4095318">&gt;</span>&nbsp;<span class="ident" id="4095320">i</span>&nbsp;<span class="op" id="4095322">&amp;&amp;</span>&nbsp;<span class="ident" id="4095325">j</span><span class="op" id="4095326">-</span><span class="ident" id="4095327">i</span>&nbsp;<span class="op" id="4095329">&gt;</span>&nbsp;<span class="ident" id="4095331">e1</span><span class="op" id="4095333">-</span><span class="ident" id="4095334">e0</span>&nbsp;<span class="op" id="4095337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095342">e0</span>&nbsp;<span class="op" id="4095345">=</span>&nbsp;<span class="ident" id="4095347">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095352">e1</span>&nbsp;<span class="op" id="4095355">=</span>&nbsp;<span class="ident" id="4095357">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095362">i</span>&nbsp;<span class="op" id="4095364">=</span>&nbsp;<span class="ident" id="4095366">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4095376">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095449">if</span>&nbsp;<span class="ident" id="4095452">e1</span><span class="op" id="4095454">-</span><span class="ident" id="4095455">e0</span>&nbsp;<span class="op" id="4095458">&lt;=</span>&nbsp;<span class="num" id="4095461">2</span>&nbsp;<span class="op" id="4095463">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095467">e0</span>&nbsp;<span class="op" id="4095470">=</span>&nbsp;<span class="op" id="4095472">-</span><span class="num" id="4095473">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095477">e1</span>&nbsp;<span class="op" id="4095480">=</span>&nbsp;<span class="op" id="4095482">-</span><span class="num" id="4095483">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095490">const</span>&nbsp;<span class="ident" id="4095496">maxLen</span>&nbsp;<span class="op" id="4095503">=</span>&nbsp;<span class="builtinfunc" id="4095505">len</span><span class="op" id="4095508">(</span><span class="string" id="4095509">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="4095550">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095553">b</span>&nbsp;<span class="op" id="4095555">:=</span>&nbsp;<span class="builtinfunc" id="4095558">make</span><span class="op" id="4095562">(</span><span class="op" id="4095563">[</span><span class="op" id="4095564">]</span><span class="builtintype" id="4095565">byte</span><span class="op" id="4095569">,</span>&nbsp;<span class="num" id="4095571">0</span><span class="op" id="4095572">,</span>&nbsp;<span class="ident" id="4095574">maxLen</span><span class="op" id="4095580">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4095584">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095636">for</span>&nbsp;<span class="ident" id="4095640">i</span>&nbsp;<span class="op" id="4095642">:=</span>&nbsp;<span class="num" id="4095645">0</span><span class="op" id="4095646">;</span>&nbsp;<span class="ident" id="4095648">i</span>&nbsp;<span class="op" id="4095650">&lt;</span>&nbsp;<span class="ident" id="4095652">IPv6len</span><span class="op" id="4095659">;</span>&nbsp;<span class="ident" id="4095661">i</span>&nbsp;<span class="op" id="4095663">+=</span>&nbsp;<span class="num" id="4095666">2</span>&nbsp;<span class="op" id="4095668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095672">if</span>&nbsp;<span class="ident" id="4095675">i</span>&nbsp;<span class="op" id="4095677">==</span>&nbsp;<span class="ident" id="4095680">e0</span>&nbsp;<span class="op" id="4095683">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095688">b</span>&nbsp;<span class="op" id="4095690">=</span>&nbsp;<span class="builtinfunc" id="4095692">append</span><span class="op" id="4095698">(</span><span class="ident" id="4095699">b</span><span class="op" id="4095700">,</span>&nbsp;<span class="string" id="4095702">&#39;:&#39;</span><span class="op" id="4095705">,</span>&nbsp;<span class="string" id="4095707">&#39;:&#39;</span><span class="op" id="4095710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095715">i</span>&nbsp;<span class="op" id="4095717">=</span>&nbsp;<span class="ident" id="4095719">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095725">if</span>&nbsp;<span class="ident" id="4095728">i</span>&nbsp;<span class="op" id="4095730">&gt;=</span>&nbsp;<span class="ident" id="4095733">IPv6len</span>&nbsp;<span class="op" id="4095741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095747">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095756">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095760">}</span>&nbsp;<span class="keyword" id="4095762">else</span>&nbsp;<span class="keyword" id="4095767">if</span>&nbsp;<span class="ident" id="4095770">i</span>&nbsp;<span class="op" id="4095772">&gt;</span>&nbsp;<span class="num" id="4095774">0</span>&nbsp;<span class="op" id="4095776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095781">b</span>&nbsp;<span class="op" id="4095783">=</span>&nbsp;<span class="builtinfunc" id="4095785">append</span><span class="op" id="4095791">(</span><span class="ident" id="4095792">b</span><span class="op" id="4095793">,</span>&nbsp;<span class="string" id="4095795">&#39;:&#39;</span><span class="op" id="4095798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095806">b</span>&nbsp;<span class="op" id="4095808">=</span>&nbsp;<span class="ident" id="4095810">appendHex</span><span class="op" id="4095819">(</span><span class="ident" id="4095820">b</span><span class="op" id="4095821">,</span>&nbsp;<span class="op" id="4095823">(</span><span class="builtintype" id="4095824">uint32</span><span class="op" id="4095830">(</span><span class="ident" id="4095831">p</span><span class="op" id="4095832">[</span><span class="ident" id="4095833">i</span><span class="op" id="4095834">]</span><span class="op" id="4095835">)</span><span class="op" id="4095836">&lt;&lt;</span><span class="num" id="4095838">8</span><span class="op" id="4095839">)</span><span class="op" id="4095840">|</span><span class="builtintype" id="4095841">uint32</span><span class="op" id="4095847">(</span><span class="ident" id="4095848">p</span><span class="op" id="4095849">[</span><span class="ident" id="4095850">i</span><span class="op" id="4095851">+</span><span class="num" id="4095852">1</span><span class="op" id="4095853">]</span><span class="op" id="4095854">)</span><span class="op" id="4095855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095858">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095861">return</span>&nbsp;<span class="builtintype" id="4095868">string</span><span class="op" id="4095874">(</span><span class="ident" id="4095875">b</span><span class="op" id="4095876">)</span><br>
<span class="lineno"></span><span class="op" id="4095878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4095881">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4095939">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="4095976">func</span>&nbsp;<span class="ident" id="4095981">ipEmptyString</span><span class="op" id="4095994">(</span><span class="ident" id="4095995">ip</span>&nbsp;<span class="ident" id="4095998">IP</span><span class="op" id="4096000">)</span>&nbsp;<span class="builtintype" id="4096002">string</span>&nbsp;<span class="op" id="4096009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096012">if</span>&nbsp;<span class="builtinfunc" id="4096015">len</span><span class="op" id="4096018">(</span><span class="ident" id="4096019">ip</span><span class="op" id="4096021">)</span>&nbsp;<span class="op" id="4096023">==</span>&nbsp;<span class="num" id="4096026">0</span>&nbsp;<span class="op" id="4096028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096032">return</span>&nbsp;<span class="string" id="4096039">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096046">return</span>&nbsp;<span class="ident" id="4096053">ip</span><span class="op" id="4096055">.</span><span class="ident" id="4096056">String</span><span class="op" id="4096062">(</span><span class="op" id="4096063">)</span><br>
<span class="lineno">325</span><span class="op" id="4096065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4096068">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="4096132">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="4096183">func</span>&nbsp;<span class="op" id="4096188">(</span><span class="ident" id="4096189">ip</span>&nbsp;<span class="ident" id="4096192">IP</span><span class="op" id="4096194">)</span>&nbsp;<span class="ident" id="4096196">MarshalText</span><span class="op" id="4096207">(</span><span class="op" id="4096208">)</span>&nbsp;<span class="op" id="4096210">(</span><span class="op" id="4096211">[</span><span class="op" id="4096212">]</span><span class="builtintype" id="4096213">byte</span><span class="op" id="4096217">,</span>&nbsp;<span class="builtintype" id="4096219">error</span><span class="op" id="4096224">)</span>&nbsp;<span class="op" id="4096226">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096229">if</span>&nbsp;<span class="builtinfunc" id="4096232">len</span><span class="op" id="4096235">(</span><span class="ident" id="4096236">ip</span><span class="op" id="4096238">)</span>&nbsp;<span class="op" id="4096240">==</span>&nbsp;<span class="num" id="4096243">0</span>&nbsp;<span class="op" id="4096245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096249">return</span>&nbsp;<span class="op" id="4096256">[</span><span class="op" id="4096257">]</span><span class="builtintype" id="4096258">byte</span><span class="op" id="4096262">(</span><span class="string" id="4096263">&#34;&#34;</span><span class="op" id="4096265">)</span><span class="op" id="4096266">,</span>&nbsp;<span class="ident" id="4096268">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096276">if</span>&nbsp;<span class="builtinfunc" id="4096279">len</span><span class="op" id="4096282">(</span><span class="ident" id="4096283">ip</span><span class="op" id="4096285">)</span>&nbsp;<span class="op" id="4096287">!=</span>&nbsp;<span class="ident" id="4096290">IPv4len</span>&nbsp;<span class="op" id="4096298">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4096301">len</span><span class="op" id="4096304">(</span><span class="ident" id="4096305">ip</span><span class="op" id="4096307">)</span>&nbsp;<span class="op" id="4096309">!=</span>&nbsp;<span class="ident" id="4096312">IPv6len</span>&nbsp;<span class="op" id="4096320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096324">return</span>&nbsp;<span class="ident" id="4096331">nil</span><span class="op" id="4096334">,</span>&nbsp;<span class="ident" id="4096336">errors</span><span class="op" id="4096342">.</span><span class="ident" id="4096343">New</span><span class="op" id="4096346">(</span><span class="string" id="4096347">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="4096367">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096373">return</span>&nbsp;<span class="op" id="4096380">[</span><span class="op" id="4096381">]</span><span class="builtintype" id="4096382">byte</span><span class="op" id="4096386">(</span><span class="ident" id="4096387">ip</span><span class="op" id="4096389">.</span><span class="ident" id="4096390">String</span><span class="op" id="4096396">(</span><span class="op" id="4096397">)</span><span class="op" id="4096398">)</span><span class="op" id="4096399">,</span>&nbsp;<span class="ident" id="4096401">nil</span><br>
<span class="lineno"></span><span class="op" id="4096405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4096408">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="4096476">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="4096537">func</span>&nbsp;<span class="op" id="4096542">(</span><span class="ident" id="4096543">ip</span>&nbsp;<span class="op" id="4096546">*</span><span class="ident" id="4096547">IP</span><span class="op" id="4096549">)</span>&nbsp;<span class="ident" id="4096551">UnmarshalText</span><span class="op" id="4096564">(</span><span class="ident" id="4096565">text</span>&nbsp;<span class="op" id="4096570">[</span><span class="op" id="4096571">]</span><span class="builtintype" id="4096572">byte</span><span class="op" id="4096576">)</span>&nbsp;<span class="builtintype" id="4096578">error</span>&nbsp;<span class="op" id="4096584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096587">if</span>&nbsp;<span class="builtinfunc" id="4096590">len</span><span class="op" id="4096593">(</span><span class="ident" id="4096594">text</span><span class="op" id="4096598">)</span>&nbsp;<span class="op" id="4096600">==</span>&nbsp;<span class="num" id="4096603">0</span>&nbsp;<span class="op" id="4096605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096609">*</span><span class="ident" id="4096610">ip</span>&nbsp;<span class="op" id="4096613">=</span>&nbsp;<span class="ident" id="4096615">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096621">return</span>&nbsp;<span class="ident" id="4096628">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4096636">s</span>&nbsp;<span class="op" id="4096638">:=</span>&nbsp;<span class="builtintype" id="4096641">string</span><span class="op" id="4096647">(</span><span class="ident" id="4096648">text</span><span class="op" id="4096652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4096655">x</span>&nbsp;<span class="op" id="4096657">:=</span>&nbsp;<span class="ident" id="4096660">ParseIP</span><span class="op" id="4096667">(</span><span class="ident" id="4096668">s</span><span class="op" id="4096669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096672">if</span>&nbsp;<span class="ident" id="4096675">x</span>&nbsp;<span class="op" id="4096677">==</span>&nbsp;<span class="ident" id="4096680">nil</span>&nbsp;<span class="op" id="4096684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096688">return</span>&nbsp;<span class="op" id="4096695">&amp;</span><span class="ident" id="4096696">ParseError</span><span class="op" id="4096706">{</span><span class="string" id="4096707">&#34;IP&nbsp;address&#34;</span><span class="op" id="4096719">,</span>&nbsp;<span class="ident" id="4096721">s</span><span class="op" id="4096722">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096728">*</span><span class="ident" id="4096729">ip</span>&nbsp;<span class="op" id="4096732">=</span>&nbsp;<span class="ident" id="4096734">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096737">return</span>&nbsp;<span class="ident" id="4096744">nil</span><br>
<span class="lineno"></span><span class="op" id="4096748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4096751">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="4096810">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4096868">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="4096895">func</span>&nbsp;<span class="op" id="4096900">(</span><span class="ident" id="4096901">ip</span>&nbsp;<span class="ident" id="4096904">IP</span><span class="op" id="4096906">)</span>&nbsp;<span class="ident" id="4096908">Equal</span><span class="op" id="4096913">(</span><span class="ident" id="4096914">x</span>&nbsp;<span class="ident" id="4096916">IP</span><span class="op" id="4096918">)</span>&nbsp;<span class="builtintype" id="4096920">bool</span>&nbsp;<span class="op" id="4096925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096928">if</span>&nbsp;<span class="builtinfunc" id="4096931">len</span><span class="op" id="4096934">(</span><span class="ident" id="4096935">ip</span><span class="op" id="4096937">)</span>&nbsp;<span class="op" id="4096939">==</span>&nbsp;<span class="builtinfunc" id="4096942">len</span><span class="op" id="4096945">(</span><span class="ident" id="4096946">x</span><span class="op" id="4096947">)</span>&nbsp;<span class="op" id="4096949">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096953">return</span>&nbsp;<span class="ident" id="4096960">bytesEqual</span><span class="op" id="4096970">(</span><span class="ident" id="4096971">ip</span><span class="op" id="4096973">,</span>&nbsp;<span class="ident" id="4096975">x</span><span class="op" id="4096976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096982">if</span>&nbsp;<span class="builtinfunc" id="4096985">len</span><span class="op" id="4096988">(</span><span class="ident" id="4096989">ip</span><span class="op" id="4096991">)</span>&nbsp;<span class="op" id="4096993">==</span>&nbsp;<span class="ident" id="4096996">IPv4len</span>&nbsp;<span class="op" id="4097004">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4097007">len</span><span class="op" id="4097010">(</span><span class="ident" id="4097011">x</span><span class="op" id="4097012">)</span>&nbsp;<span class="op" id="4097014">==</span>&nbsp;<span class="ident" id="4097017">IPv6len</span>&nbsp;<span class="op" id="4097025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097029">return</span>&nbsp;<span class="ident" id="4097036">bytesEqual</span><span class="op" id="4097046">(</span><span class="ident" id="4097047">x</span><span class="op" id="4097048">[</span><span class="num" id="4097049">0</span><span class="op" id="4097050">:</span><span class="num" id="4097051">12</span><span class="op" id="4097053">]</span><span class="op" id="4097054">,</span>&nbsp;<span class="ident" id="4097056">v4InV6Prefix</span><span class="op" id="4097068">)</span>&nbsp;<span class="op" id="4097070">&amp;&amp;</span>&nbsp;<span class="ident" id="4097073">bytesEqual</span><span class="op" id="4097083">(</span><span class="ident" id="4097084">ip</span><span class="op" id="4097086">,</span>&nbsp;<span class="ident" id="4097088">x</span><span class="op" id="4097089">[</span><span class="num" id="4097090">12</span><span class="op" id="4097092">:</span><span class="op" id="4097093">]</span><span class="op" id="4097094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097097">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097100">if</span>&nbsp;<span class="builtinfunc" id="4097103">len</span><span class="op" id="4097106">(</span><span class="ident" id="4097107">ip</span><span class="op" id="4097109">)</span>&nbsp;<span class="op" id="4097111">==</span>&nbsp;<span class="ident" id="4097114">IPv6len</span>&nbsp;<span class="op" id="4097122">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4097125">len</span><span class="op" id="4097128">(</span><span class="ident" id="4097129">x</span><span class="op" id="4097130">)</span>&nbsp;<span class="op" id="4097132">==</span>&nbsp;<span class="ident" id="4097135">IPv4len</span>&nbsp;<span class="op" id="4097143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097147">return</span>&nbsp;<span class="ident" id="4097154">bytesEqual</span><span class="op" id="4097164">(</span><span class="ident" id="4097165">ip</span><span class="op" id="4097167">[</span><span class="num" id="4097168">0</span><span class="op" id="4097169">:</span><span class="num" id="4097170">12</span><span class="op" id="4097172">]</span><span class="op" id="4097173">,</span>&nbsp;<span class="ident" id="4097175">v4InV6Prefix</span><span class="op" id="4097187">)</span>&nbsp;<span class="op" id="4097189">&amp;&amp;</span>&nbsp;<span class="ident" id="4097192">bytesEqual</span><span class="op" id="4097202">(</span><span class="ident" id="4097203">ip</span><span class="op" id="4097205">[</span><span class="num" id="4097206">12</span><span class="op" id="4097208">:</span><span class="op" id="4097209">]</span><span class="op" id="4097210">,</span>&nbsp;<span class="ident" id="4097212">x</span><span class="op" id="4097213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097219">return</span>&nbsp;<span class="builtintype" id="4097226">false</span><br>
<span class="lineno"></span><span class="op" id="4097232">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="4097235">func</span>&nbsp;<span class="ident" id="4097240">bytesEqual</span><span class="op" id="4097250">(</span><span class="ident" id="4097251">x</span><span class="op" id="4097252">,</span>&nbsp;<span class="ident" id="4097254">y</span>&nbsp;<span class="op" id="4097256">[</span><span class="op" id="4097257">]</span><span class="builtintype" id="4097258">byte</span><span class="op" id="4097262">)</span>&nbsp;<span class="builtintype" id="4097264">bool</span>&nbsp;<span class="op" id="4097269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097272">if</span>&nbsp;<span class="builtinfunc" id="4097275">len</span><span class="op" id="4097278">(</span><span class="ident" id="4097279">x</span><span class="op" id="4097280">)</span>&nbsp;<span class="op" id="4097282">!=</span>&nbsp;<span class="builtinfunc" id="4097285">len</span><span class="op" id="4097288">(</span><span class="ident" id="4097289">y</span><span class="op" id="4097290">)</span>&nbsp;<span class="op" id="4097292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097296">return</span>&nbsp;<span class="builtintype" id="4097303">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097310">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097313">for</span>&nbsp;<span class="ident" id="4097317">i</span><span class="op" id="4097318">,</span>&nbsp;<span class="ident" id="4097320">b</span>&nbsp;<span class="op" id="4097322">:=</span>&nbsp;<span class="keyword" id="4097325">range</span>&nbsp;<span class="ident" id="4097331">x</span>&nbsp;<span class="op" id="4097333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097337">if</span>&nbsp;<span class="ident" id="4097340">y</span><span class="op" id="4097341">[</span><span class="ident" id="4097342">i</span><span class="op" id="4097343">]</span>&nbsp;<span class="op" id="4097345">!=</span>&nbsp;<span class="ident" id="4097348">b</span>&nbsp;<span class="op" id="4097350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097355">return</span>&nbsp;<span class="builtintype" id="4097362">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097373">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097376">return</span>&nbsp;<span class="builtintype" id="4097383">true</span><br>
<span class="lineno"></span><span class="op" id="4097388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4097391">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="4097446">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="4097478">func</span>&nbsp;<span class="ident" id="4097483">simpleMaskLength</span><span class="op" id="4097499">(</span><span class="ident" id="4097500">mask</span>&nbsp;<span class="ident" id="4097505">IPMask</span><span class="op" id="4097511">)</span>&nbsp;<span class="builtintype" id="4097513">int</span>&nbsp;<span class="op" id="4097517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097520">var</span>&nbsp;<span class="ident" id="4097524">n</span>&nbsp;<span class="builtintype" id="4097526">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097531">for</span>&nbsp;<span class="ident" id="4097535">i</span><span class="op" id="4097536">,</span>&nbsp;<span class="ident" id="4097538">v</span>&nbsp;<span class="op" id="4097540">:=</span>&nbsp;<span class="keyword" id="4097543">range</span>&nbsp;<span class="ident" id="4097549">mask</span>&nbsp;<span class="op" id="4097554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097558">if</span>&nbsp;<span class="ident" id="4097561">v</span>&nbsp;<span class="op" id="4097563">==</span>&nbsp;<span class="num" id="4097566">0xff</span>&nbsp;<span class="op" id="4097571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097576">n</span>&nbsp;<span class="op" id="4097578">+=</span>&nbsp;<span class="num" id="4097581">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097586">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4097601">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4097624">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097642">for</span>&nbsp;<span class="ident" id="4097646">v</span><span class="op" id="4097647">&amp;</span><span class="num" id="4097648">0x80</span>&nbsp;<span class="op" id="4097653">!=</span>&nbsp;<span class="num" id="4097656">0</span>&nbsp;<span class="op" id="4097658">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097663">n</span><span class="op" id="4097664">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097670">v</span>&nbsp;<span class="op" id="4097672">&lt;&lt;=</span>&nbsp;<span class="num" id="4097676">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4097684">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097709">if</span>&nbsp;<span class="ident" id="4097712">v</span>&nbsp;<span class="op" id="4097714">!=</span>&nbsp;<span class="num" id="4097717">0</span>&nbsp;<span class="op" id="4097719">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097724">return</span>&nbsp;<span class="op" id="4097731">-</span><span class="num" id="4097732">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097740">for</span>&nbsp;<span class="ident" id="4097744">i</span><span class="op" id="4097745">++</span><span class="op" id="4097747">;</span>&nbsp;<span class="ident" id="4097749">i</span>&nbsp;<span class="op" id="4097751">&lt;</span>&nbsp;<span class="builtinfunc" id="4097753">len</span><span class="op" id="4097756">(</span><span class="ident" id="4097757">mask</span><span class="op" id="4097761">)</span><span class="op" id="4097762">;</span>&nbsp;<span class="ident" id="4097764">i</span><span class="op" id="4097765">++</span>&nbsp;<span class="op" id="4097768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097773">if</span>&nbsp;<span class="ident" id="4097776">mask</span><span class="op" id="4097780">[</span><span class="ident" id="4097781">i</span><span class="op" id="4097782">]</span>&nbsp;<span class="op" id="4097784">!=</span>&nbsp;<span class="num" id="4097787">0</span>&nbsp;<span class="op" id="4097789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097795">return</span>&nbsp;<span class="op" id="4097802">-</span><span class="num" id="4097803">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097816">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097826">return</span>&nbsp;<span class="ident" id="4097833">n</span><br>
<span class="lineno">410</span><span class="op" id="4097835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4097838">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="4097909">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="4097983">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="4098005">func</span>&nbsp;<span class="op" id="4098010">(</span><span class="ident" id="4098011">m</span>&nbsp;<span class="ident" id="4098013">IPMask</span><span class="op" id="4098019">)</span>&nbsp;<span class="ident" id="4098021">Size</span><span class="op" id="4098025">(</span><span class="op" id="4098026">)</span>&nbsp;<span class="op" id="4098028">(</span><span class="ident" id="4098029">ones</span><span class="op" id="4098033">,</span>&nbsp;<span class="ident" id="4098035">bits</span>&nbsp;<span class="builtintype" id="4098040">int</span><span class="op" id="4098043">)</span>&nbsp;<span class="op" id="4098045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098048">ones</span><span class="op" id="4098052">,</span>&nbsp;<span class="ident" id="4098054">bits</span>&nbsp;<span class="op" id="4098059">=</span>&nbsp;<span class="ident" id="4098061">simpleMaskLength</span><span class="op" id="4098077">(</span><span class="ident" id="4098078">m</span><span class="op" id="4098079">)</span><span class="op" id="4098080">,</span>&nbsp;<span class="builtinfunc" id="4098082">len</span><span class="op" id="4098085">(</span><span class="ident" id="4098086">m</span><span class="op" id="4098087">)</span><span class="op" id="4098088">*</span><span class="num" id="4098089">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098092">if</span>&nbsp;<span class="ident" id="4098095">ones</span>&nbsp;<span class="op" id="4098100">==</span>&nbsp;<span class="op" id="4098103">-</span><span class="num" id="4098104">1</span>&nbsp;<span class="op" id="4098106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098110">return</span>&nbsp;<span class="num" id="4098117">0</span><span class="op" id="4098118">,</span>&nbsp;<span class="num" id="4098120">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098123">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098126">return</span><br>
<span class="lineno"></span><span class="op" id="4098133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4098136">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="4098202">func</span>&nbsp;<span class="op" id="4098207">(</span><span class="ident" id="4098208">m</span>&nbsp;<span class="ident" id="4098210">IPMask</span><span class="op" id="4098216">)</span>&nbsp;<span class="ident" id="4098218">String</span><span class="op" id="4098224">(</span><span class="op" id="4098225">)</span>&nbsp;<span class="builtintype" id="4098227">string</span>&nbsp;<span class="op" id="4098234">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098237">if</span>&nbsp;<span class="builtinfunc" id="4098240">len</span><span class="op" id="4098243">(</span><span class="ident" id="4098244">m</span><span class="op" id="4098245">)</span>&nbsp;<span class="op" id="4098247">==</span>&nbsp;<span class="num" id="4098250">0</span>&nbsp;<span class="op" id="4098252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098256">return</span>&nbsp;<span class="string" id="4098263">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098275">buf</span>&nbsp;<span class="op" id="4098279">:=</span>&nbsp;<span class="builtinfunc" id="4098282">make</span><span class="op" id="4098286">(</span><span class="op" id="4098287">[</span><span class="op" id="4098288">]</span><span class="builtintype" id="4098289">byte</span><span class="op" id="4098293">,</span>&nbsp;<span class="builtinfunc" id="4098295">len</span><span class="op" id="4098298">(</span><span class="ident" id="4098299">m</span><span class="op" id="4098300">)</span><span class="op" id="4098301">*</span><span class="num" id="4098302">2</span><span class="op" id="4098303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098306">for</span>&nbsp;<span class="ident" id="4098310">i</span><span class="op" id="4098311">,</span>&nbsp;<span class="ident" id="4098313">b</span>&nbsp;<span class="op" id="4098315">:=</span>&nbsp;<span class="keyword" id="4098318">range</span>&nbsp;<span class="ident" id="4098324">m</span>&nbsp;<span class="op" id="4098326">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098330">buf</span><span class="op" id="4098333">[</span><span class="ident" id="4098334">i</span><span class="op" id="4098335">*</span><span class="num" id="4098336">2</span><span class="op" id="4098337">]</span><span class="op" id="4098338">,</span>&nbsp;<span class="ident" id="4098340">buf</span><span class="op" id="4098343">[</span><span class="ident" id="4098344">i</span><span class="op" id="4098345">*</span><span class="num" id="4098346">2</span><span class="op" id="4098347">+</span><span class="num" id="4098348">1</span><span class="op" id="4098349">]</span>&nbsp;<span class="op" id="4098351">=</span>&nbsp;<span class="ident" id="4098353">hexDigit</span><span class="op" id="4098361">[</span><span class="ident" id="4098362">b</span><span class="op" id="4098363">&gt;&gt;</span><span class="num" id="4098365">4</span><span class="op" id="4098366">]</span><span class="op" id="4098367">,</span>&nbsp;<span class="ident" id="4098369">hexDigit</span><span class="op" id="4098377">[</span><span class="ident" id="4098378">b</span><span class="op" id="4098379">&amp;</span><span class="num" id="4098380">0xf</span><span class="op" id="4098383">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098389">return</span>&nbsp;<span class="builtintype" id="4098396">string</span><span class="op" id="4098402">(</span><span class="ident" id="4098403">buf</span><span class="op" id="4098406">)</span><br>
<span class="lineno"></span><span class="op" id="4098408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="4098411">func</span>&nbsp;<span class="ident" id="4098416">networkNumberAndMask</span><span class="op" id="4098436">(</span><span class="ident" id="4098437">n</span>&nbsp;<span class="op" id="4098439">*</span><span class="ident" id="4098440">IPNet</span><span class="op" id="4098445">)</span>&nbsp;<span class="op" id="4098447">(</span><span class="ident" id="4098448">ip</span>&nbsp;<span class="ident" id="4098451">IP</span><span class="op" id="4098453">,</span>&nbsp;<span class="ident" id="4098455">m</span>&nbsp;<span class="ident" id="4098457">IPMask</span><span class="op" id="4098463">)</span>&nbsp;<span class="op" id="4098465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098468">if</span>&nbsp;<span class="ident" id="4098471">ip</span>&nbsp;<span class="op" id="4098474">=</span>&nbsp;<span class="ident" id="4098476">n</span><span class="op" id="4098477">.</span><span class="ident" id="4098478">IP</span><span class="op" id="4098480">.</span><span class="ident" id="4098481">To4</span><span class="op" id="4098484">(</span><span class="op" id="4098485">)</span><span class="op" id="4098486">;</span>&nbsp;<span class="ident" id="4098488">ip</span>&nbsp;<span class="op" id="4098491">==</span>&nbsp;<span class="ident" id="4098494">nil</span>&nbsp;<span class="op" id="4098498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098502">ip</span>&nbsp;<span class="op" id="4098505">=</span>&nbsp;<span class="ident" id="4098507">n</span><span class="op" id="4098508">.</span><span class="ident" id="4098509">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098514">if</span>&nbsp;<span class="builtinfunc" id="4098517">len</span><span class="op" id="4098520">(</span><span class="ident" id="4098521">ip</span><span class="op" id="4098523">)</span>&nbsp;<span class="op" id="4098525">!=</span>&nbsp;<span class="ident" id="4098528">IPv6len</span>&nbsp;<span class="op" id="4098536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098541">return</span>&nbsp;<span class="ident" id="4098548">nil</span><span class="op" id="4098551">,</span>&nbsp;<span class="ident" id="4098553">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098565">m</span>&nbsp;<span class="op" id="4098567">=</span>&nbsp;<span class="ident" id="4098569">n</span><span class="op" id="4098570">.</span><span class="ident" id="4098571">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098577">switch</span>&nbsp;<span class="builtinfunc" id="4098584">len</span><span class="op" id="4098587">(</span><span class="ident" id="4098588">m</span><span class="op" id="4098589">)</span>&nbsp;<span class="op" id="4098591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098594">case</span>&nbsp;<span class="ident" id="4098599">IPv4len</span><span class="op" id="4098606">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098610">if</span>&nbsp;<span class="builtinfunc" id="4098613">len</span><span class="op" id="4098616">(</span><span class="ident" id="4098617">ip</span><span class="op" id="4098619">)</span>&nbsp;<span class="op" id="4098621">!=</span>&nbsp;<span class="ident" id="4098624">IPv4len</span>&nbsp;<span class="op" id="4098632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098637">return</span>&nbsp;<span class="ident" id="4098644">nil</span><span class="op" id="4098647">,</span>&nbsp;<span class="ident" id="4098649">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098658">case</span>&nbsp;<span class="ident" id="4098663">IPv6len</span><span class="op" id="4098670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098674">if</span>&nbsp;<span class="builtinfunc" id="4098677">len</span><span class="op" id="4098680">(</span><span class="ident" id="4098681">ip</span><span class="op" id="4098683">)</span>&nbsp;<span class="op" id="4098685">==</span>&nbsp;<span class="ident" id="4098688">IPv4len</span>&nbsp;<span class="op" id="4098696">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098701">m</span>&nbsp;<span class="op" id="4098703">=</span>&nbsp;<span class="ident" id="4098705">m</span><span class="op" id="4098706">[</span><span class="num" id="4098707">12</span><span class="op" id="4098709">:</span><span class="op" id="4098710">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098717">default</span><span class="op" id="4098724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098728">return</span>&nbsp;<span class="ident" id="4098735">nil</span><span class="op" id="4098738">,</span>&nbsp;<span class="ident" id="4098740">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098745">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098748">return</span><br>
<span class="lineno"></span><span class="op" id="4098755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4098758">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="4098811">func</span>&nbsp;<span class="op" id="4098816">(</span><span class="ident" id="4098817">n</span>&nbsp;<span class="op" id="4098819">*</span><span class="ident" id="4098820">IPNet</span><span class="op" id="4098825">)</span>&nbsp;<span class="ident" id="4098827">Contains</span><span class="op" id="4098835">(</span><span class="ident" id="4098836">ip</span>&nbsp;<span class="ident" id="4098839">IP</span><span class="op" id="4098841">)</span>&nbsp;<span class="builtintype" id="4098843">bool</span>&nbsp;<span class="op" id="4098848">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098851">nn</span><span class="op" id="4098853">,</span>&nbsp;<span class="ident" id="4098855">m</span>&nbsp;<span class="op" id="4098857">:=</span>&nbsp;<span class="ident" id="4098860">networkNumberAndMask</span><span class="op" id="4098880">(</span><span class="ident" id="4098881">n</span><span class="op" id="4098882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098885">if</span>&nbsp;<span class="ident" id="4098888">x</span>&nbsp;<span class="op" id="4098890">:=</span>&nbsp;<span class="ident" id="4098893">ip</span><span class="op" id="4098895">.</span><span class="ident" id="4098896">To4</span><span class="op" id="4098899">(</span><span class="op" id="4098900">)</span><span class="op" id="4098901">;</span>&nbsp;<span class="ident" id="4098903">x</span>&nbsp;<span class="op" id="4098905">!=</span>&nbsp;<span class="ident" id="4098908">nil</span>&nbsp;<span class="op" id="4098912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098916">ip</span>&nbsp;<span class="op" id="4098919">=</span>&nbsp;<span class="ident" id="4098921">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098927">l</span>&nbsp;<span class="op" id="4098929">:=</span>&nbsp;<span class="builtinfunc" id="4098932">len</span><span class="op" id="4098935">(</span><span class="ident" id="4098936">ip</span><span class="op" id="4098938">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098941">if</span>&nbsp;<span class="ident" id="4098944">l</span>&nbsp;<span class="op" id="4098946">!=</span>&nbsp;<span class="builtinfunc" id="4098949">len</span><span class="op" id="4098952">(</span><span class="ident" id="4098953">nn</span><span class="op" id="4098955">)</span>&nbsp;<span class="op" id="4098957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098961">return</span>&nbsp;<span class="builtintype" id="4098968">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098978">for</span>&nbsp;<span class="ident" id="4098982">i</span>&nbsp;<span class="op" id="4098984">:=</span>&nbsp;<span class="num" id="4098987">0</span><span class="op" id="4098988">;</span>&nbsp;<span class="ident" id="4098990">i</span>&nbsp;<span class="op" id="4098992">&lt;</span>&nbsp;<span class="ident" id="4098994">l</span><span class="op" id="4098995">;</span>&nbsp;<span class="ident" id="4098997">i</span><span class="op" id="4098998">++</span>&nbsp;<span class="op" id="4099001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099005">if</span>&nbsp;<span class="ident" id="4099008">nn</span><span class="op" id="4099010">[</span><span class="ident" id="4099011">i</span><span class="op" id="4099012">]</span><span class="op" id="4099013">&amp;</span><span class="ident" id="4099014">m</span><span class="op" id="4099015">[</span><span class="ident" id="4099016">i</span><span class="op" id="4099017">]</span>&nbsp;<span class="op" id="4099019">!=</span>&nbsp;<span class="ident" id="4099022">ip</span><span class="op" id="4099024">[</span><span class="ident" id="4099025">i</span><span class="op" id="4099026">]</span><span class="op" id="4099027">&amp;</span><span class="ident" id="4099028">m</span><span class="op" id="4099029">[</span><span class="ident" id="4099030">i</span><span class="op" id="4099031">]</span>&nbsp;<span class="op" id="4099033">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099038">return</span>&nbsp;<span class="builtintype" id="4099045">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099059">return</span>&nbsp;<span class="builtintype" id="4099066">true</span><br>
<span class="lineno"></span><span class="op" id="4099071">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="4099074">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4099131">func</span>&nbsp;<span class="op" id="4099136">(</span><span class="ident" id="4099137">n</span>&nbsp;<span class="op" id="4099139">*</span><span class="ident" id="4099140">IPNet</span><span class="op" id="4099145">)</span>&nbsp;<span class="ident" id="4099147">Network</span><span class="op" id="4099154">(</span><span class="op" id="4099155">)</span>&nbsp;<span class="builtintype" id="4099157">string</span>&nbsp;<span class="op" id="4099164">{</span>&nbsp;<span class="keyword" id="4099166">return</span>&nbsp;<span class="string" id="4099173">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="4099182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4099185">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="4099250">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="4099309">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4099369">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="4099432">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="4099494">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="4099540">func</span>&nbsp;<span class="op" id="4099545">(</span><span class="ident" id="4099546">n</span>&nbsp;<span class="op" id="4099548">*</span><span class="ident" id="4099549">IPNet</span><span class="op" id="4099554">)</span>&nbsp;<span class="ident" id="4099556">String</span><span class="op" id="4099562">(</span><span class="op" id="4099563">)</span>&nbsp;<span class="builtintype" id="4099565">string</span>&nbsp;<span class="op" id="4099572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099575">nn</span><span class="op" id="4099577">,</span>&nbsp;<span class="ident" id="4099579">m</span>&nbsp;<span class="op" id="4099581">:=</span>&nbsp;<span class="ident" id="4099584">networkNumberAndMask</span><span class="op" id="4099604">(</span><span class="ident" id="4099605">n</span><span class="op" id="4099606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099609">if</span>&nbsp;<span class="ident" id="4099612">nn</span>&nbsp;<span class="op" id="4099615">==</span>&nbsp;<span class="ident" id="4099618">nil</span>&nbsp;<span class="op" id="4099622">||</span>&nbsp;<span class="ident" id="4099625">m</span>&nbsp;<span class="op" id="4099627">==</span>&nbsp;<span class="ident" id="4099630">nil</span>&nbsp;<span class="op" id="4099634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099638">return</span>&nbsp;<span class="string" id="4099645">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099654">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099657">l</span>&nbsp;<span class="op" id="4099659">:=</span>&nbsp;<span class="ident" id="4099662">simpleMaskLength</span><span class="op" id="4099678">(</span><span class="ident" id="4099679">m</span><span class="op" id="4099680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099683">if</span>&nbsp;<span class="ident" id="4099686">l</span>&nbsp;<span class="op" id="4099688">==</span>&nbsp;<span class="op" id="4099691">-</span><span class="num" id="4099692">1</span>&nbsp;<span class="op" id="4099694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099698">return</span>&nbsp;<span class="ident" id="4099705">nn</span><span class="op" id="4099707">.</span><span class="ident" id="4099708">String</span><span class="op" id="4099714">(</span><span class="op" id="4099715">)</span>&nbsp;<span class="op" id="4099717">+</span>&nbsp;<span class="string" id="4099719">&#34;/&#34;</span>&nbsp;<span class="op" id="4099723">+</span>&nbsp;<span class="ident" id="4099725">m</span><span class="op" id="4099726">.</span><span class="ident" id="4099727">String</span><span class="op" id="4099733">(</span><span class="op" id="4099734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099740">return</span>&nbsp;<span class="ident" id="4099747">nn</span><span class="op" id="4099749">.</span><span class="ident" id="4099750">String</span><span class="op" id="4099756">(</span><span class="op" id="4099757">)</span>&nbsp;<span class="op" id="4099759">+</span>&nbsp;<span class="string" id="4099761">&#34;/&#34;</span>&nbsp;<span class="op" id="4099765">+</span>&nbsp;<span class="ident" id="4099767">itod</span><span class="op" id="4099771">(</span><span class="builtintype" id="4099772">uint</span><span class="op" id="4099776">(</span><span class="ident" id="4099777">l</span><span class="op" id="4099778">)</span><span class="op" id="4099779">)</span><br>
<span class="lineno">495</span><span class="op" id="4099781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4099784">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="4099817">func</span>&nbsp;<span class="ident" id="4099822">parseIPv4</span><span class="op" id="4099831">(</span><span class="ident" id="4099832">s</span>&nbsp;<span class="builtintype" id="4099834">string</span><span class="op" id="4099840">)</span>&nbsp;<span class="ident" id="4099842">IP</span>&nbsp;<span class="op" id="4099845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099848">var</span>&nbsp;<span class="ident" id="4099852">p</span>&nbsp;<span class="op" id="4099854">[</span><span class="ident" id="4099855">IPv4len</span><span class="op" id="4099862">]</span><span class="builtintype" id="4099863">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099869">i</span>&nbsp;<span class="op" id="4099871">:=</span>&nbsp;<span class="num" id="4099874">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099877">for</span>&nbsp;<span class="ident" id="4099881">j</span>&nbsp;<span class="op" id="4099883">:=</span>&nbsp;<span class="num" id="4099886">0</span><span class="op" id="4099887">;</span>&nbsp;<span class="ident" id="4099889">j</span>&nbsp;<span class="op" id="4099891">&lt;</span>&nbsp;<span class="ident" id="4099893">IPv4len</span><span class="op" id="4099900">;</span>&nbsp;<span class="ident" id="4099902">j</span><span class="op" id="4099903">++</span>&nbsp;<span class="op" id="4099906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099910">if</span>&nbsp;<span class="ident" id="4099913">i</span>&nbsp;<span class="op" id="4099915">&gt;=</span>&nbsp;<span class="builtinfunc" id="4099918">len</span><span class="op" id="4099921">(</span><span class="ident" id="4099922">s</span><span class="op" id="4099923">)</span>&nbsp;<span class="op" id="4099925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099930">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099952">return</span>&nbsp;<span class="ident" id="4099959">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099969">if</span>&nbsp;<span class="ident" id="4099972">j</span>&nbsp;<span class="op" id="4099974">&gt;</span>&nbsp;<span class="num" id="4099976">0</span>&nbsp;<span class="op" id="4099978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099983">if</span>&nbsp;<span class="ident" id="4099986">s</span><span class="op" id="4099987">[</span><span class="ident" id="4099988">i</span><span class="op" id="4099989">]</span>&nbsp;<span class="op" id="4099991">!=</span>&nbsp;<span class="string" id="4099994">&#39;.&#39;</span>&nbsp;<span class="op" id="4099998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100004">return</span>&nbsp;<span class="ident" id="4100011">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100018">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100023">i</span><span class="op" id="4100024">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100033">var</span>&nbsp;<span class="op" id="4100037">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100042">n</span>&nbsp;&nbsp;<span class="builtintype" id="4100045">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100052">ok</span>&nbsp;<span class="builtintype" id="4100055">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100066">n</span><span class="op" id="4100067">,</span>&nbsp;<span class="ident" id="4100069">i</span><span class="op" id="4100070">,</span>&nbsp;<span class="ident" id="4100072">ok</span>&nbsp;<span class="op" id="4100075">=</span>&nbsp;<span class="ident" id="4100077">dtoi</span><span class="op" id="4100081">(</span><span class="ident" id="4100082">s</span><span class="op" id="4100083">,</span>&nbsp;<span class="ident" id="4100085">i</span><span class="op" id="4100086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100090">if</span>&nbsp;<span class="op" id="4100093">!</span><span class="ident" id="4100094">ok</span>&nbsp;<span class="op" id="4100097">||</span>&nbsp;<span class="ident" id="4100100">n</span>&nbsp;<span class="op" id="4100102">&gt;</span>&nbsp;<span class="num" id="4100104">0xFF</span>&nbsp;<span class="op" id="4100109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100114">return</span>&nbsp;<span class="ident" id="4100121">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100127">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100131">p</span><span class="op" id="4100132">[</span><span class="ident" id="4100133">j</span><span class="op" id="4100134">]</span>&nbsp;<span class="op" id="4100136">=</span>&nbsp;<span class="builtintype" id="4100138">byte</span><span class="op" id="4100142">(</span><span class="ident" id="4100143">n</span><span class="op" id="4100144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100150">if</span>&nbsp;<span class="ident" id="4100153">i</span>&nbsp;<span class="op" id="4100155">!=</span>&nbsp;<span class="builtinfunc" id="4100158">len</span><span class="op" id="4100161">(</span><span class="ident" id="4100162">s</span><span class="op" id="4100163">)</span>&nbsp;<span class="op" id="4100165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100169">return</span>&nbsp;<span class="ident" id="4100176">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100181">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100184">return</span>&nbsp;<span class="ident" id="4100191">IPv4</span><span class="op" id="4100195">(</span><span class="ident" id="4100196">p</span><span class="op" id="4100197">[</span><span class="num" id="4100198">0</span><span class="op" id="4100199">]</span><span class="op" id="4100200">,</span>&nbsp;<span class="ident" id="4100202">p</span><span class="op" id="4100203">[</span><span class="num" id="4100204">1</span><span class="op" id="4100205">]</span><span class="op" id="4100206">,</span>&nbsp;<span class="ident" id="4100208">p</span><span class="op" id="4100209">[</span><span class="num" id="4100210">2</span><span class="op" id="4100211">]</span><span class="op" id="4100212">,</span>&nbsp;<span class="ident" id="4100214">p</span><span class="op" id="4100215">[</span><span class="num" id="4100216">3</span><span class="op" id="4100217">]</span><span class="op" id="4100218">)</span><br>
<span class="lineno"></span><span class="op" id="4100220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4100223">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="4100293">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="4100364">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4100434">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="4100443">func</span>&nbsp;<span class="ident" id="4100448">parseIPv6</span><span class="op" id="4100457">(</span><span class="ident" id="4100458">s</span>&nbsp;<span class="builtintype" id="4100460">string</span><span class="op" id="4100466">,</span>&nbsp;<span class="ident" id="4100468">zoneAllowed</span>&nbsp;<span class="builtintype" id="4100480">bool</span><span class="op" id="4100484">)</span>&nbsp;<span class="op" id="4100486">(</span><span class="ident" id="4100487">ip</span>&nbsp;<span class="ident" id="4100490">IP</span><span class="op" id="4100492">,</span>&nbsp;<span class="ident" id="4100494">zone</span>&nbsp;<span class="builtintype" id="4100499">string</span><span class="op" id="4100505">)</span>&nbsp;<span class="op" id="4100507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100510">ip</span>&nbsp;<span class="op" id="4100513">=</span>&nbsp;<span class="builtinfunc" id="4100515">make</span><span class="op" id="4100519">(</span><span class="ident" id="4100520">IP</span><span class="op" id="4100522">,</span>&nbsp;<span class="ident" id="4100524">IPv6len</span><span class="op" id="4100531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100534">ellipsis</span>&nbsp;<span class="op" id="4100543">:=</span>&nbsp;<span class="op" id="4100546">-</span><span class="num" id="4100547">1</span>&nbsp;<span class="comment" id="4100549">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100579">i</span>&nbsp;<span class="op" id="4100581">:=</span>&nbsp;<span class="num" id="4100584">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100594">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100617">if</span>&nbsp;<span class="ident" id="4100620">zoneAllowed</span>&nbsp;<span class="op" id="4100632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100636">s</span><span class="op" id="4100637">,</span>&nbsp;<span class="ident" id="4100639">zone</span>&nbsp;<span class="op" id="4100644">=</span>&nbsp;<span class="ident" id="4100646">splitHostZone</span><span class="op" id="4100659">(</span><span class="ident" id="4100660">s</span><span class="op" id="4100661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100664">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100668">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100700">if</span>&nbsp;<span class="builtinfunc" id="4100703">len</span><span class="op" id="4100706">(</span><span class="ident" id="4100707">s</span><span class="op" id="4100708">)</span>&nbsp;<span class="op" id="4100710">&gt;=</span>&nbsp;<span class="num" id="4100713">2</span>&nbsp;<span class="op" id="4100715">&amp;&amp;</span>&nbsp;<span class="ident" id="4100718">s</span><span class="op" id="4100719">[</span><span class="num" id="4100720">0</span><span class="op" id="4100721">]</span>&nbsp;<span class="op" id="4100723">==</span>&nbsp;<span class="string" id="4100726">&#39;:&#39;</span>&nbsp;<span class="op" id="4100730">&amp;&amp;</span>&nbsp;<span class="ident" id="4100733">s</span><span class="op" id="4100734">[</span><span class="num" id="4100735">1</span><span class="op" id="4100736">]</span>&nbsp;<span class="op" id="4100738">==</span>&nbsp;<span class="string" id="4100741">&#39;:&#39;</span>&nbsp;<span class="op" id="4100745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100749">ellipsis</span>&nbsp;<span class="op" id="4100758">=</span>&nbsp;<span class="num" id="4100760">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100764">i</span>&nbsp;<span class="op" id="4100766">=</span>&nbsp;<span class="num" id="4100768">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100772">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100800">if</span>&nbsp;<span class="ident" id="4100803">i</span>&nbsp;<span class="op" id="4100805">==</span>&nbsp;<span class="builtinfunc" id="4100808">len</span><span class="op" id="4100811">(</span><span class="ident" id="4100812">s</span><span class="op" id="4100813">)</span>&nbsp;<span class="op" id="4100815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100820">return</span>&nbsp;<span class="ident" id="4100827">ip</span><span class="op" id="4100829">,</span>&nbsp;<span class="ident" id="4100831">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100841">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100845">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100894">j</span>&nbsp;<span class="op" id="4100896">:=</span>&nbsp;<span class="num" id="4100899">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100902">for</span>&nbsp;<span class="ident" id="4100906">j</span>&nbsp;<span class="op" id="4100908">&lt;</span>&nbsp;<span class="ident" id="4100910">IPv6len</span>&nbsp;<span class="op" id="4100918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100922">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100939">n</span><span class="op" id="4100940">,</span>&nbsp;<span class="ident" id="4100942">i1</span><span class="op" id="4100944">,</span>&nbsp;<span class="ident" id="4100946">ok</span>&nbsp;<span class="op" id="4100949">:=</span>&nbsp;<span class="ident" id="4100952">xtoi</span><span class="op" id="4100956">(</span><span class="ident" id="4100957">s</span><span class="op" id="4100958">,</span>&nbsp;<span class="ident" id="4100960">i</span><span class="op" id="4100961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100965">if</span>&nbsp;<span class="op" id="4100968">!</span><span class="ident" id="4100969">ok</span>&nbsp;<span class="op" id="4100972">||</span>&nbsp;<span class="ident" id="4100975">n</span>&nbsp;<span class="op" id="4100977">&gt;</span>&nbsp;<span class="num" id="4100979">0xFFFF</span>&nbsp;<span class="op" id="4100986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100991">return</span>&nbsp;<span class="ident" id="4100998">nil</span><span class="op" id="4101001">,</span>&nbsp;<span class="ident" id="4101003">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101015">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101067">if</span>&nbsp;<span class="ident" id="4101070">i1</span>&nbsp;<span class="op" id="4101073">&lt;</span>&nbsp;<span class="builtinfunc" id="4101075">len</span><span class="op" id="4101078">(</span><span class="ident" id="4101079">s</span><span class="op" id="4101080">)</span>&nbsp;<span class="op" id="4101082">&amp;&amp;</span>&nbsp;<span class="ident" id="4101085">s</span><span class="op" id="4101086">[</span><span class="ident" id="4101087">i1</span><span class="op" id="4101089">]</span>&nbsp;<span class="op" id="4101091">==</span>&nbsp;<span class="string" id="4101094">&#39;.&#39;</span>&nbsp;<span class="op" id="4101098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101103">if</span>&nbsp;<span class="ident" id="4101106">ellipsis</span>&nbsp;<span class="op" id="4101115">&lt;</span>&nbsp;<span class="num" id="4101117">0</span>&nbsp;<span class="op" id="4101119">&amp;&amp;</span>&nbsp;<span class="ident" id="4101122">j</span>&nbsp;<span class="op" id="4101124">!=</span>&nbsp;<span class="ident" id="4101127">IPv6len</span><span class="op" id="4101134">-</span><span class="ident" id="4101135">IPv4len</span>&nbsp;<span class="op" id="4101143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101149">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101177">return</span>&nbsp;<span class="ident" id="4101184">nil</span><span class="op" id="4101187">,</span>&nbsp;<span class="ident" id="4101189">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101202">if</span>&nbsp;<span class="ident" id="4101205">j</span><span class="op" id="4101206">+</span><span class="ident" id="4101207">IPv4len</span>&nbsp;<span class="op" id="4101215">&gt;</span>&nbsp;<span class="ident" id="4101217">IPv6len</span>&nbsp;<span class="op" id="4101225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101231">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101255">return</span>&nbsp;<span class="ident" id="4101262">nil</span><span class="op" id="4101265">,</span>&nbsp;<span class="ident" id="4101267">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101275">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101280">ip4</span>&nbsp;<span class="op" id="4101284">:=</span>&nbsp;<span class="ident" id="4101287">parseIPv4</span><span class="op" id="4101296">(</span><span class="ident" id="4101297">s</span><span class="op" id="4101298">[</span><span class="ident" id="4101299">i</span><span class="op" id="4101300">:</span><span class="op" id="4101301">]</span><span class="op" id="4101302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101307">if</span>&nbsp;<span class="ident" id="4101310">ip4</span>&nbsp;<span class="op" id="4101314">==</span>&nbsp;<span class="ident" id="4101317">nil</span>&nbsp;<span class="op" id="4101321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101327">return</span>&nbsp;<span class="ident" id="4101334">nil</span><span class="op" id="4101337">,</span>&nbsp;<span class="ident" id="4101339">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101352">ip</span><span class="op" id="4101354">[</span><span class="ident" id="4101355">j</span><span class="op" id="4101356">]</span>&nbsp;<span class="op" id="4101358">=</span>&nbsp;<span class="ident" id="4101360">ip4</span><span class="op" id="4101363">[</span><span class="num" id="4101364">12</span><span class="op" id="4101366">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101371">ip</span><span class="op" id="4101373">[</span><span class="ident" id="4101374">j</span><span class="op" id="4101375">+</span><span class="num" id="4101376">1</span><span class="op" id="4101377">]</span>&nbsp;<span class="op" id="4101379">=</span>&nbsp;<span class="ident" id="4101381">ip4</span><span class="op" id="4101384">[</span><span class="num" id="4101385">13</span><span class="op" id="4101387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101392">ip</span><span class="op" id="4101394">[</span><span class="ident" id="4101395">j</span><span class="op" id="4101396">+</span><span class="num" id="4101397">2</span><span class="op" id="4101398">]</span>&nbsp;<span class="op" id="4101400">=</span>&nbsp;<span class="ident" id="4101402">ip4</span><span class="op" id="4101405">[</span><span class="num" id="4101406">14</span><span class="op" id="4101408">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101413">ip</span><span class="op" id="4101415">[</span><span class="ident" id="4101416">j</span><span class="op" id="4101417">+</span><span class="num" id="4101418">3</span><span class="op" id="4101419">]</span>&nbsp;<span class="op" id="4101421">=</span>&nbsp;<span class="ident" id="4101423">ip4</span><span class="op" id="4101426">[</span><span class="num" id="4101427">15</span><span class="op" id="4101429">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101434">i</span>&nbsp;<span class="op" id="4101436">=</span>&nbsp;<span class="builtinfunc" id="4101438">len</span><span class="op" id="4101441">(</span><span class="ident" id="4101442">s</span><span class="op" id="4101443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101448">j</span>&nbsp;<span class="op" id="4101450">+=</span>&nbsp;<span class="ident" id="4101453">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101464">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101477">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101506">ip</span><span class="op" id="4101508">[</span><span class="ident" id="4101509">j</span><span class="op" id="4101510">]</span>&nbsp;<span class="op" id="4101512">=</span>&nbsp;<span class="builtintype" id="4101514">byte</span><span class="op" id="4101518">(</span><span class="ident" id="4101519">n</span>&nbsp;<span class="op" id="4101521">&gt;&gt;</span>&nbsp;<span class="num" id="4101524">8</span><span class="op" id="4101525">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101529">ip</span><span class="op" id="4101531">[</span><span class="ident" id="4101532">j</span><span class="op" id="4101533">+</span><span class="num" id="4101534">1</span><span class="op" id="4101535">]</span>&nbsp;<span class="op" id="4101537">=</span>&nbsp;<span class="builtintype" id="4101539">byte</span><span class="op" id="4101543">(</span><span class="ident" id="4101544">n</span><span class="op" id="4101545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101549">j</span>&nbsp;<span class="op" id="4101551">+=</span>&nbsp;<span class="num" id="4101554">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101559">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101587">i</span>&nbsp;<span class="op" id="4101589">=</span>&nbsp;<span class="ident" id="4101591">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101596">if</span>&nbsp;<span class="ident" id="4101599">i</span>&nbsp;<span class="op" id="4101601">==</span>&nbsp;<span class="builtinfunc" id="4101604">len</span><span class="op" id="4101607">(</span><span class="ident" id="4101608">s</span><span class="op" id="4101609">)</span>&nbsp;<span class="op" id="4101611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101616">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101629">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101680">if</span>&nbsp;<span class="ident" id="4101683">s</span><span class="op" id="4101684">[</span><span class="ident" id="4101685">i</span><span class="op" id="4101686">]</span>&nbsp;<span class="op" id="4101688">!=</span>&nbsp;<span class="string" id="4101691">&#39;:&#39;</span>&nbsp;<span class="op" id="4101695">||</span>&nbsp;<span class="ident" id="4101698">i</span><span class="op" id="4101699">+</span><span class="num" id="4101700">1</span>&nbsp;<span class="op" id="4101702">==</span>&nbsp;<span class="builtinfunc" id="4101705">len</span><span class="op" id="4101708">(</span><span class="ident" id="4101709">s</span><span class="op" id="4101710">)</span>&nbsp;<span class="op" id="4101712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101717">return</span>&nbsp;<span class="ident" id="4101724">nil</span><span class="op" id="4101727">,</span>&nbsp;<span class="ident" id="4101729">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101740">i</span><span class="op" id="4101741">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101747">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101771">if</span>&nbsp;<span class="ident" id="4101774">s</span><span class="op" id="4101775">[</span><span class="ident" id="4101776">i</span><span class="op" id="4101777">]</span>&nbsp;<span class="op" id="4101779">==</span>&nbsp;<span class="string" id="4101782">&#39;:&#39;</span>&nbsp;<span class="op" id="4101786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101791">if</span>&nbsp;<span class="ident" id="4101794">ellipsis</span>&nbsp;<span class="op" id="4101803">&gt;=</span>&nbsp;<span class="num" id="4101806">0</span>&nbsp;<span class="op" id="4101808">{</span>&nbsp;<span class="comment" id="4101810">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101834">return</span>&nbsp;<span class="ident" id="4101841">nil</span><span class="op" id="4101844">,</span>&nbsp;<span class="ident" id="4101846">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101854">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101859">ellipsis</span>&nbsp;<span class="op" id="4101868">=</span>&nbsp;<span class="ident" id="4101870">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101875">if</span>&nbsp;<span class="ident" id="4101878">i</span><span class="op" id="4101879">++</span><span class="op" id="4101881">;</span>&nbsp;<span class="ident" id="4101883">i</span>&nbsp;<span class="op" id="4101885">==</span>&nbsp;<span class="builtinfunc" id="4101888">len</span><span class="op" id="4101891">(</span><span class="ident" id="4101892">s</span><span class="op" id="4101893">)</span>&nbsp;<span class="op" id="4101895">{</span>&nbsp;<span class="comment" id="4101897">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101918">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101931">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101938">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101972">if</span>&nbsp;<span class="ident" id="4101975">i</span>&nbsp;<span class="op" id="4101977">!=</span>&nbsp;<span class="builtinfunc" id="4101980">len</span><span class="op" id="4101983">(</span><span class="ident" id="4101984">s</span><span class="op" id="4101985">)</span>&nbsp;<span class="op" id="4101987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101991">return</span>&nbsp;<span class="ident" id="4101998">nil</span><span class="op" id="4102001">,</span>&nbsp;<span class="ident" id="4102003">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4102013">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102058">if</span>&nbsp;<span class="ident" id="4102061">j</span>&nbsp;<span class="op" id="4102063">&lt;</span>&nbsp;<span class="ident" id="4102065">IPv6len</span>&nbsp;<span class="op" id="4102073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102077">if</span>&nbsp;<span class="ident" id="4102080">ellipsis</span>&nbsp;<span class="op" id="4102089">&lt;</span>&nbsp;<span class="num" id="4102091">0</span>&nbsp;<span class="op" id="4102093">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102098">return</span>&nbsp;<span class="ident" id="4102105">nil</span><span class="op" id="4102108">,</span>&nbsp;<span class="ident" id="4102110">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102121">n</span>&nbsp;<span class="op" id="4102123">:=</span>&nbsp;<span class="ident" id="4102126">IPv6len</span>&nbsp;<span class="op" id="4102134">-</span>&nbsp;<span class="ident" id="4102136">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102140">for</span>&nbsp;<span class="ident" id="4102144">k</span>&nbsp;<span class="op" id="4102146">:=</span>&nbsp;<span class="ident" id="4102149">j</span>&nbsp;<span class="op" id="4102151">-</span>&nbsp;<span class="num" id="4102153">1</span><span class="op" id="4102154">;</span>&nbsp;<span class="ident" id="4102156">k</span>&nbsp;<span class="op" id="4102158">&gt;=</span>&nbsp;<span class="ident" id="4102161">ellipsis</span><span class="op" id="4102169">;</span>&nbsp;<span class="ident" id="4102171">k</span><span class="op" id="4102172">--</span>&nbsp;<span class="op" id="4102175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102180">ip</span><span class="op" id="4102182">[</span><span class="ident" id="4102183">k</span><span class="op" id="4102184">+</span><span class="ident" id="4102185">n</span><span class="op" id="4102186">]</span>&nbsp;<span class="op" id="4102188">=</span>&nbsp;<span class="ident" id="4102190">ip</span><span class="op" id="4102192">[</span><span class="ident" id="4102193">k</span><span class="op" id="4102194">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102202">for</span>&nbsp;<span class="ident" id="4102206">k</span>&nbsp;<span class="op" id="4102208">:=</span>&nbsp;<span class="ident" id="4102211">ellipsis</span>&nbsp;<span class="op" id="4102220">+</span>&nbsp;<span class="ident" id="4102222">n</span>&nbsp;<span class="op" id="4102224">-</span>&nbsp;<span class="num" id="4102226">1</span><span class="op" id="4102227">;</span>&nbsp;<span class="ident" id="4102229">k</span>&nbsp;<span class="op" id="4102231">&gt;=</span>&nbsp;<span class="ident" id="4102234">ellipsis</span><span class="op" id="4102242">;</span>&nbsp;<span class="ident" id="4102244">k</span><span class="op" id="4102245">--</span>&nbsp;<span class="op" id="4102248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102253">ip</span><span class="op" id="4102255">[</span><span class="ident" id="4102256">k</span><span class="op" id="4102257">]</span>&nbsp;<span class="op" id="4102259">=</span>&nbsp;<span class="num" id="4102261">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102268">}</span>&nbsp;<span class="keyword" id="4102270">else</span>&nbsp;<span class="keyword" id="4102275">if</span>&nbsp;<span class="ident" id="4102278">ellipsis</span>&nbsp;<span class="op" id="4102287">&gt;=</span>&nbsp;<span class="num" id="4102290">0</span>&nbsp;<span class="op" id="4102292">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4102296">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102347">return</span>&nbsp;<span class="ident" id="4102354">nil</span><span class="op" id="4102357">,</span>&nbsp;<span class="ident" id="4102359">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102368">return</span>&nbsp;<span class="ident" id="4102375">ip</span><span class="op" id="4102377">,</span>&nbsp;<span class="ident" id="4102379">zone</span><br>
<span class="lineno"></span><span class="op" id="4102384">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="4102387">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="4102480">type</span>&nbsp;<span class="ident" id="4102485">ParseError</span>&nbsp;<span class="keyword" id="4102496">struct</span>&nbsp;<span class="op" id="4102503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102506">Type</span>&nbsp;<span class="builtintype" id="4102511">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102519">Text</span>&nbsp;<span class="builtintype" id="4102524">string</span><br>
<span class="lineno">640</span><span class="op" id="4102531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4102534">func</span>&nbsp;<span class="op" id="4102539">(</span><span class="ident" id="4102540">e</span>&nbsp;<span class="op" id="4102542">*</span><span class="ident" id="4102543">ParseError</span><span class="op" id="4102553">)</span>&nbsp;<span class="ident" id="4102555">Error</span><span class="op" id="4102560">(</span><span class="op" id="4102561">)</span>&nbsp;<span class="builtintype" id="4102563">string</span>&nbsp;<span class="op" id="4102570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102573">return</span>&nbsp;<span class="string" id="4102580">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="4102591">+</span>&nbsp;<span class="ident" id="4102593">e</span><span class="op" id="4102594">.</span><span class="ident" id="4102595">Type</span>&nbsp;<span class="op" id="4102600">+</span>&nbsp;<span class="string" id="4102602">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4102607">+</span>&nbsp;<span class="ident" id="4102609">e</span><span class="op" id="4102610">.</span><span class="ident" id="4102611">Text</span><br>
<span class="lineno"></span><span class="op" id="4102616">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="4102619">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="4102679">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="4102737">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="4102779">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="4102843">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4102867">func</span>&nbsp;<span class="ident" id="4102872">ParseIP</span><span class="op" id="4102879">(</span><span class="ident" id="4102880">s</span>&nbsp;<span class="builtintype" id="4102882">string</span><span class="op" id="4102888">)</span>&nbsp;<span class="ident" id="4102890">IP</span>&nbsp;<span class="op" id="4102893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102896">for</span>&nbsp;<span class="ident" id="4102900">i</span>&nbsp;<span class="op" id="4102902">:=</span>&nbsp;<span class="num" id="4102905">0</span><span class="op" id="4102906">;</span>&nbsp;<span class="ident" id="4102908">i</span>&nbsp;<span class="op" id="4102910">&lt;</span>&nbsp;<span class="builtinfunc" id="4102912">len</span><span class="op" id="4102915">(</span><span class="ident" id="4102916">s</span><span class="op" id="4102917">)</span><span class="op" id="4102918">;</span>&nbsp;<span class="ident" id="4102920">i</span><span class="op" id="4102921">++</span>&nbsp;<span class="op" id="4102924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102928">switch</span>&nbsp;<span class="ident" id="4102935">s</span><span class="op" id="4102936">[</span><span class="ident" id="4102937">i</span><span class="op" id="4102938">]</span>&nbsp;<span class="op" id="4102940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102944">case</span>&nbsp;<span class="string" id="4102949">&#39;.&#39;</span><span class="op" id="4102952">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102957">return</span>&nbsp;<span class="ident" id="4102964">parseIPv4</span><span class="op" id="4102973">(</span><span class="ident" id="4102974">s</span><span class="op" id="4102975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102979">case</span>&nbsp;<span class="string" id="4102984">&#39;:&#39;</span><span class="op" id="4102987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102992">ip</span><span class="op" id="4102994">,</span>&nbsp;<span class="ident" id="4102996">_</span>&nbsp;<span class="op" id="4102998">:=</span>&nbsp;<span class="ident" id="4103001">parseIPv6</span><span class="op" id="4103010">(</span><span class="ident" id="4103011">s</span><span class="op" id="4103012">,</span>&nbsp;<span class="builtintype" id="4103014">false</span><span class="op" id="4103019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103024">return</span>&nbsp;<span class="ident" id="4103031">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103036">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103042">return</span>&nbsp;<span class="ident" id="4103049">nil</span><br>
<span class="lineno"></span><span class="op" id="4103053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4103056">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="4103118">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4103179">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="4103205">//</span><br>
<span class="lineno"></span><span class="comment" id="4103208">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="4103271">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="4103336">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="4103400">func</span>&nbsp;<span class="ident" id="4103405">ParseCIDR</span><span class="op" id="4103414">(</span><span class="ident" id="4103415">s</span>&nbsp;<span class="builtintype" id="4103417">string</span><span class="op" id="4103423">)</span>&nbsp;<span class="op" id="4103425">(</span><span class="ident" id="4103426">IP</span><span class="op" id="4103428">,</span>&nbsp;<span class="op" id="4103430">*</span><span class="ident" id="4103431">IPNet</span><span class="op" id="4103436">,</span>&nbsp;<span class="builtintype" id="4103438">error</span><span class="op" id="4103443">)</span>&nbsp;<span class="op" id="4103445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103448">i</span>&nbsp;<span class="op" id="4103450">:=</span>&nbsp;<span class="ident" id="4103453">byteIndex</span><span class="op" id="4103462">(</span><span class="ident" id="4103463">s</span><span class="op" id="4103464">,</span>&nbsp;<span class="string" id="4103466">&#39;/&#39;</span><span class="op" id="4103469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103472">if</span>&nbsp;<span class="ident" id="4103475">i</span>&nbsp;<span class="op" id="4103477">&lt;</span>&nbsp;<span class="num" id="4103479">0</span>&nbsp;<span class="op" id="4103481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103485">return</span>&nbsp;<span class="ident" id="4103492">nil</span><span class="op" id="4103495">,</span>&nbsp;<span class="ident" id="4103497">nil</span><span class="op" id="4103500">,</span>&nbsp;<span class="op" id="4103502">&amp;</span><span class="ident" id="4103503">ParseError</span><span class="op" id="4103513">{</span><span class="string" id="4103514">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="4103528">,</span>&nbsp;<span class="ident" id="4103530">s</span><span class="op" id="4103531">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103537">addr</span><span class="op" id="4103541">,</span>&nbsp;<span class="ident" id="4103543">mask</span>&nbsp;<span class="op" id="4103548">:=</span>&nbsp;<span class="ident" id="4103551">s</span><span class="op" id="4103552">[</span><span class="op" id="4103553">:</span><span class="ident" id="4103554">i</span><span class="op" id="4103555">]</span><span class="op" id="4103556">,</span>&nbsp;<span class="ident" id="4103558">s</span><span class="op" id="4103559">[</span><span class="ident" id="4103560">i</span><span class="op" id="4103561">+</span><span class="num" id="4103562">1</span><span class="op" id="4103563">:</span><span class="op" id="4103564">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103567">iplen</span>&nbsp;<span class="op" id="4103573">:=</span>&nbsp;<span class="ident" id="4103576">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103585">ip</span>&nbsp;<span class="op" id="4103588">:=</span>&nbsp;<span class="ident" id="4103591">parseIPv4</span><span class="op" id="4103600">(</span><span class="ident" id="4103601">addr</span><span class="op" id="4103605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103608">if</span>&nbsp;<span class="ident" id="4103611">ip</span>&nbsp;<span class="op" id="4103614">==</span>&nbsp;<span class="ident" id="4103617">nil</span>&nbsp;<span class="op" id="4103621">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103625">iplen</span>&nbsp;<span class="op" id="4103631">=</span>&nbsp;<span class="ident" id="4103633">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103643">ip</span><span class="op" id="4103645">,</span>&nbsp;<span class="ident" id="4103647">_</span>&nbsp;<span class="op" id="4103649">=</span>&nbsp;<span class="ident" id="4103651">parseIPv6</span><span class="op" id="4103660">(</span><span class="ident" id="4103661">addr</span><span class="op" id="4103665">,</span>&nbsp;<span class="builtintype" id="4103667">false</span><span class="op" id="4103672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103678">n</span><span class="op" id="4103679">,</span>&nbsp;<span class="ident" id="4103681">i</span><span class="op" id="4103682">,</span>&nbsp;<span class="ident" id="4103684">ok</span>&nbsp;<span class="op" id="4103687">:=</span>&nbsp;<span class="ident" id="4103690">dtoi</span><span class="op" id="4103694">(</span><span class="ident" id="4103695">mask</span><span class="op" id="4103699">,</span>&nbsp;<span class="num" id="4103701">0</span><span class="op" id="4103702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103705">if</span>&nbsp;<span class="ident" id="4103708">ip</span>&nbsp;<span class="op" id="4103711">==</span>&nbsp;<span class="ident" id="4103714">nil</span>&nbsp;<span class="op" id="4103718">||</span>&nbsp;<span class="op" id="4103721">!</span><span class="ident" id="4103722">ok</span>&nbsp;<span class="op" id="4103725">||</span>&nbsp;<span class="ident" id="4103728">i</span>&nbsp;<span class="op" id="4103730">!=</span>&nbsp;<span class="builtinfunc" id="4103733">len</span><span class="op" id="4103736">(</span><span class="ident" id="4103737">mask</span><span class="op" id="4103741">)</span>&nbsp;<span class="op" id="4103743">||</span>&nbsp;<span class="ident" id="4103746">n</span>&nbsp;<span class="op" id="4103748">&lt;</span>&nbsp;<span class="num" id="4103750">0</span>&nbsp;<span class="op" id="4103752">||</span>&nbsp;<span class="ident" id="4103755">n</span>&nbsp;<span class="op" id="4103757">&gt;</span>&nbsp;<span class="num" id="4103759">8</span><span class="op" id="4103760">*</span><span class="ident" id="4103761">iplen</span>&nbsp;<span class="op" id="4103767">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103771">return</span>&nbsp;<span class="ident" id="4103778">nil</span><span class="op" id="4103781">,</span>&nbsp;<span class="ident" id="4103783">nil</span><span class="op" id="4103786">,</span>&nbsp;<span class="op" id="4103788">&amp;</span><span class="ident" id="4103789">ParseError</span><span class="op" id="4103799">{</span><span class="string" id="4103800">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="4103814">,</span>&nbsp;<span class="ident" id="4103816">s</span><span class="op" id="4103817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103823">m</span>&nbsp;<span class="op" id="4103825">:=</span>&nbsp;<span class="ident" id="4103828">CIDRMask</span><span class="op" id="4103836">(</span><span class="ident" id="4103837">n</span><span class="op" id="4103838">,</span>&nbsp;<span class="num" id="4103840">8</span><span class="op" id="4103841">*</span><span class="ident" id="4103842">iplen</span><span class="op" id="4103847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103850">return</span>&nbsp;<span class="ident" id="4103857">ip</span><span class="op" id="4103859">,</span>&nbsp;<span class="op" id="4103861">&amp;</span><span class="ident" id="4103862">IPNet</span><span class="op" id="4103867">{</span><span class="ident" id="4103868">IP</span><span class="op" id="4103870">:</span>&nbsp;<span class="ident" id="4103872">ip</span><span class="op" id="4103874">.</span><span class="ident" id="4103875">Mask</span><span class="op" id="4103879">(</span><span class="ident" id="4103880">m</span><span class="op" id="4103881">)</span><span class="op" id="4103882">,</span>&nbsp;<span class="ident" id="4103884">Mask</span><span class="op" id="4103888">:</span>&nbsp;<span class="ident" id="4103890">m</span><span class="op" id="4103891">}</span><span class="op" id="4103892">,</span>&nbsp;<span class="ident" id="4103894">nil</span><br>
<span class="lineno"></span><span class="op" id="4103898">}</span>
</div>
</body>
</html>
