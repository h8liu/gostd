<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html" class="current">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4511906">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4511961">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4512015">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4512066">package</span>&nbsp;<span class="ident" id="4512074">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4512080">import</span>&nbsp;<span class="op" id="4512087">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4512090">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4512106">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4512125">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4512142">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4512152">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4512159">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4512170">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4512173">const</span>&nbsp;<span class="ident" id="4512179">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4512196">=</span>&nbsp;<span class="num" id="4512198">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4512201">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4512273">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4512288">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4512301">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4512362">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4512435">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4512460">type</span>&nbsp;<span class="ident" id="4512465">ecPrivateKey</span>&nbsp;<span class="keyword" id="4512478">struct</span>&nbsp;<span class="op" id="4512485">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512488">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4512502">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512507">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512521">[</span><span class="op" id="4512522">]</span><span class="builtintype" id="4512523">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512529">NamedCurveOID</span>&nbsp;<span class="ident" id="4512543">asn1</span><span class="op" id="4512547">.</span><span class="ident" id="4512548">ObjectIdentifier</span>&nbsp;<span class="string" id="4512565">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512599">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512613">asn1</span><span class="op" id="4512617">.</span><span class="ident" id="4512618">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4512635">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4512668">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4512671">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4512746">func</span>&nbsp;<span class="ident" id="4512751">ParseECPrivateKey</span><span class="op" id="4512768">(</span><span class="ident" id="4512769">der</span>&nbsp;<span class="op" id="4512773">[</span><span class="op" id="4512774">]</span><span class="builtintype" id="4512775">byte</span><span class="op" id="4512779">)</span>&nbsp;<span class="op" id="4512781">(</span><span class="ident" id="4512782">key</span>&nbsp;<span class="op" id="4512786">*</span><span class="ident" id="4512787">ecdsa</span><span class="op" id="4512792">.</span><span class="ident" id="4512793">PrivateKey</span><span class="op" id="4512803">,</span>&nbsp;<span class="ident" id="4512805">err</span>&nbsp;<span class="builtintype" id="4512809">error</span><span class="op" id="4512814">)</span>&nbsp;<span class="op" id="4512816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512819">return</span>&nbsp;<span class="ident" id="4512826">parseECPrivateKey</span><span class="op" id="4512843">(</span><span class="builtintype" id="4512844">nil</span><span class="op" id="4512847">,</span>&nbsp;<span class="ident" id="4512849">der</span><span class="op" id="4512852">)</span><br>
<span class="lineno"></span><span class="op" id="4512854">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4512857">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4512931">func</span>&nbsp;<span class="ident" id="4512936">MarshalECPrivateKey</span><span class="op" id="4512955">(</span><span class="ident" id="4512956">key</span>&nbsp;<span class="op" id="4512960">*</span><span class="ident" id="4512961">ecdsa</span><span class="op" id="4512966">.</span><span class="ident" id="4512967">PrivateKey</span><span class="op" id="4512977">)</span>&nbsp;<span class="op" id="4512979">(</span><span class="op" id="4512980">[</span><span class="op" id="4512981">]</span><span class="builtintype" id="4512982">byte</span><span class="op" id="4512986">,</span>&nbsp;<span class="builtintype" id="4512988">error</span><span class="op" id="4512993">)</span>&nbsp;<span class="op" id="4512995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512998">oid</span><span class="op" id="4513001">,</span>&nbsp;<span class="ident" id="4513003">ok</span>&nbsp;<span class="op" id="4513006">:=</span>&nbsp;<span class="ident" id="4513009">oidFromNamedCurve</span><span class="op" id="4513026">(</span><span class="ident" id="4513027">key</span><span class="op" id="4513030">.</span><span class="ident" id="4513031">Curve</span><span class="op" id="4513036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513039">if</span>&nbsp;<span class="op" id="4513042">!</span><span class="ident" id="4513043">ok</span>&nbsp;<span class="op" id="4513046">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513050">return</span>&nbsp;<span class="builtintype" id="4513057">nil</span><span class="op" id="4513060">,</span>&nbsp;<span class="ident" id="4513062">errors</span><span class="op" id="4513068">.</span><span class="ident" id="4513069">New</span><span class="op" id="4513072">(</span><span class="string" id="4513073">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4513103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513109">return</span>&nbsp;<span class="ident" id="4513116">asn1</span><span class="op" id="4513120">.</span><span class="ident" id="4513121">Marshal</span><span class="op" id="4513128">(</span><span class="ident" id="4513129">ecPrivateKey</span><span class="op" id="4513141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513145">Version</span><span class="op" id="4513152">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4513160">1</span><span class="op" id="4513161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513165">PrivateKey</span><span class="op" id="4513175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513180">key</span><span class="op" id="4513183">.</span><span class="ident" id="4513184">D</span><span class="op" id="4513185">.</span><span class="ident" id="4513186">Bytes</span><span class="op" id="4513191">(</span><span class="op" id="4513192">)</span><span class="op" id="4513193">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513197">NamedCurveOID</span><span class="op" id="4513210">:</span>&nbsp;<span class="ident" id="4513212">oid</span><span class="op" id="4513215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513219">PublicKey</span><span class="op" id="4513228">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513234">asn1</span><span class="op" id="4513238">.</span><span class="ident" id="4513239">BitString</span><span class="op" id="4513248">{</span><span class="ident" id="4513249">Bytes</span><span class="op" id="4513254">:</span>&nbsp;<span class="ident" id="4513256">elliptic</span><span class="op" id="4513264">.</span><span class="ident" id="4513265">Marshal</span><span class="op" id="4513272">(</span><span class="ident" id="4513273">key</span><span class="op" id="4513276">.</span><span class="ident" id="4513277">Curve</span><span class="op" id="4513282">,</span>&nbsp;<span class="ident" id="4513284">key</span><span class="op" id="4513287">.</span><span class="ident" id="4513288">X</span><span class="op" id="4513289">,</span>&nbsp;<span class="ident" id="4513291">key</span><span class="op" id="4513294">.</span><span class="ident" id="4513295">Y</span><span class="op" id="4513296">)</span><span class="op" id="4513297">}</span><span class="op" id="4513298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513301">}</span><span class="op" id="4513302">)</span><br>
<span class="lineno"></span><span class="op" id="4513304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4513307">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4513382">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4513458">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4513535">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4513586">func</span>&nbsp;<span class="ident" id="4513591">parseECPrivateKey</span><span class="op" id="4513608">(</span><span class="ident" id="4513609">namedCurveOID</span>&nbsp;<span class="op" id="4513623">*</span><span class="ident" id="4513624">asn1</span><span class="op" id="4513628">.</span><span class="ident" id="4513629">ObjectIdentifier</span><span class="op" id="4513645">,</span>&nbsp;<span class="ident" id="4513647">der</span>&nbsp;<span class="op" id="4513651">[</span><span class="op" id="4513652">]</span><span class="builtintype" id="4513653">byte</span><span class="op" id="4513657">)</span>&nbsp;<span class="op" id="4513659">(</span><span class="ident" id="4513660">key</span>&nbsp;<span class="op" id="4513664">*</span><span class="ident" id="4513665">ecdsa</span><span class="op" id="4513670">.</span><span class="ident" id="4513671">PrivateKey</span><span class="op" id="4513681">,</span>&nbsp;<span class="ident" id="4513683">err</span>&nbsp;<span class="builtintype" id="4513687">error</span><span class="op" id="4513692">)</span>&nbsp;<span class="op" id="4513694">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513697">var</span>&nbsp;<span class="ident" id="4513701">privKey</span>&nbsp;<span class="ident" id="4513709">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513723">if</span>&nbsp;<span class="ident" id="4513726">_</span><span class="op" id="4513727">,</span>&nbsp;<span class="ident" id="4513729">err</span>&nbsp;<span class="op" id="4513733">:=</span>&nbsp;<span class="ident" id="4513736">asn1</span><span class="op" id="4513740">.</span><span class="ident" id="4513741">Unmarshal</span><span class="op" id="4513750">(</span><span class="ident" id="4513751">der</span><span class="op" id="4513754">,</span>&nbsp;<span class="op" id="4513756">&amp;</span><span class="ident" id="4513757">privKey</span><span class="op" id="4513764">)</span><span class="op" id="4513765">;</span>&nbsp;<span class="ident" id="4513767">err</span>&nbsp;<span class="op" id="4513771">!=</span>&nbsp;<span class="builtintype" id="4513774">nil</span>&nbsp;<span class="op" id="4513778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513782">return</span>&nbsp;<span class="builtintype" id="4513789">nil</span><span class="op" id="4513792">,</span>&nbsp;<span class="ident" id="4513794">errors</span><span class="op" id="4513800">.</span><span class="ident" id="4513801">New</span><span class="op" id="4513804">(</span><span class="string" id="4513805">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4513846">+</span>&nbsp;<span class="ident" id="4513848">err</span><span class="op" id="4513851">.</span><span class="ident" id="4513852">Error</span><span class="op" id="4513857">(</span><span class="op" id="4513858">)</span><span class="op" id="4513859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513865">if</span>&nbsp;<span class="ident" id="4513868">privKey</span><span class="op" id="4513875">.</span><span class="ident" id="4513876">Version</span>&nbsp;<span class="op" id="4513884">!=</span>&nbsp;<span class="ident" id="4513887">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4513904">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513908">return</span>&nbsp;<span class="builtintype" id="4513915">nil</span><span class="op" id="4513918">,</span>&nbsp;<span class="ident" id="4513920">fmt</span><span class="op" id="4513923">.</span><span class="ident" id="4513924">Errorf</span><span class="op" id="4513930">(</span><span class="string" id="4513931">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4513972">,</span>&nbsp;<span class="ident" id="4513974">privKey</span><span class="op" id="4513981">.</span><span class="ident" id="4513982">Version</span><span class="op" id="4513989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513996">var</span>&nbsp;<span class="ident" id="4514000">curve</span>&nbsp;<span class="ident" id="4514006">elliptic</span><span class="op" id="4514014">.</span><span class="ident" id="4514015">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514022">if</span>&nbsp;<span class="ident" id="4514025">namedCurveOID</span>&nbsp;<span class="op" id="4514039">!=</span>&nbsp;<span class="builtintype" id="4514042">nil</span>&nbsp;<span class="op" id="4514046">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514050">curve</span>&nbsp;<span class="op" id="4514056">=</span>&nbsp;<span class="ident" id="4514058">namedCurveFromOID</span><span class="op" id="4514075">(</span><span class="op" id="4514076">*</span><span class="ident" id="4514077">namedCurveOID</span><span class="op" id="4514090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514093">}</span>&nbsp;<span class="keyword" id="4514095">else</span>&nbsp;<span class="op" id="4514100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514104">curve</span>&nbsp;<span class="op" id="4514110">=</span>&nbsp;<span class="ident" id="4514112">namedCurveFromOID</span><span class="op" id="4514129">(</span><span class="ident" id="4514130">privKey</span><span class="op" id="4514137">.</span><span class="ident" id="4514138">NamedCurveOID</span><span class="op" id="4514151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514157">if</span>&nbsp;<span class="ident" id="4514160">curve</span>&nbsp;<span class="op" id="4514166">==</span>&nbsp;<span class="builtintype" id="4514169">nil</span>&nbsp;<span class="op" id="4514173">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514177">return</span>&nbsp;<span class="builtintype" id="4514184">nil</span><span class="op" id="4514187">,</span>&nbsp;<span class="ident" id="4514189">errors</span><span class="op" id="4514195">.</span><span class="ident" id="4514196">New</span><span class="op" id="4514199">(</span><span class="string" id="4514200">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4514230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514237">k</span>&nbsp;<span class="op" id="4514239">:=</span>&nbsp;<span class="builtinfunc" id="4514242">new</span><span class="op" id="4514245">(</span><span class="ident" id="4514246">big</span><span class="op" id="4514249">.</span><span class="ident" id="4514250">Int</span><span class="op" id="4514253">)</span><span class="op" id="4514254">.</span><span class="ident" id="4514255">SetBytes</span><span class="op" id="4514263">(</span><span class="ident" id="4514264">privKey</span><span class="op" id="4514271">.</span><span class="ident" id="4514272">PrivateKey</span><span class="op" id="4514282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514285">if</span>&nbsp;<span class="ident" id="4514288">k</span><span class="op" id="4514289">.</span><span class="ident" id="4514290">Cmp</span><span class="op" id="4514293">(</span><span class="ident" id="4514294">curve</span><span class="op" id="4514299">.</span><span class="ident" id="4514300">Params</span><span class="op" id="4514306">(</span><span class="op" id="4514307">)</span><span class="op" id="4514308">.</span><span class="ident" id="4514309">N</span><span class="op" id="4514310">)</span>&nbsp;<span class="op" id="4514312">&gt;=</span>&nbsp;<span class="num" id="4514315">0</span>&nbsp;<span class="op" id="4514317">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514321">return</span>&nbsp;<span class="builtintype" id="4514328">nil</span><span class="op" id="4514331">,</span>&nbsp;<span class="ident" id="4514333">errors</span><span class="op" id="4514339">.</span><span class="ident" id="4514340">New</span><span class="op" id="4514343">(</span><span class="string" id="4514344">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4514392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514398">priv</span>&nbsp;<span class="op" id="4514403">:=</span>&nbsp;<span class="builtinfunc" id="4514406">new</span><span class="op" id="4514409">(</span><span class="ident" id="4514410">ecdsa</span><span class="op" id="4514415">.</span><span class="ident" id="4514416">PrivateKey</span><span class="op" id="4514426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514429">priv</span><span class="op" id="4514433">.</span><span class="ident" id="4514434">Curve</span>&nbsp;<span class="op" id="4514440">=</span>&nbsp;<span class="ident" id="4514442">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514449">priv</span><span class="op" id="4514453">.</span><span class="ident" id="4514454">D</span>&nbsp;<span class="op" id="4514456">=</span>&nbsp;<span class="ident" id="4514458">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514461">priv</span><span class="op" id="4514465">.</span><span class="ident" id="4514466">X</span><span class="op" id="4514467">,</span>&nbsp;<span class="ident" id="4514469">priv</span><span class="op" id="4514473">.</span><span class="ident" id="4514474">Y</span>&nbsp;<span class="op" id="4514476">=</span>&nbsp;<span class="ident" id="4514478">curve</span><span class="op" id="4514483">.</span><span class="ident" id="4514484">ScalarBaseMult</span><span class="op" id="4514498">(</span><span class="ident" id="4514499">privKey</span><span class="op" id="4514506">.</span><span class="ident" id="4514507">PrivateKey</span><span class="op" id="4514517">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514521">return</span>&nbsp;<span class="ident" id="4514528">priv</span><span class="op" id="4514532">,</span>&nbsp;<span class="builtintype" id="4514534">nil</span><br>
<span class="lineno"></span><span class="op" id="4514538">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
