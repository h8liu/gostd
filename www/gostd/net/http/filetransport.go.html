<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3371549">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3371604">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3371658">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3371709">package</span>&nbsp;<span class="ident" id="3371717">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3371723">import</span>&nbsp;<span class="op" id="3371730">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3371733">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3371740">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3371745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3371748">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="3371814">type</span>&nbsp;<span class="ident" id="3371819">fileTransport</span>&nbsp;<span class="keyword" id="3371833">struct</span>&nbsp;<span class="op" id="3371840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3371843">fh</span>&nbsp;<span class="ident" id="3371846">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="3371858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3371861">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="3371930">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="3371999">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="3372061">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="3372073">//</span><br>
<span class="lineno"></span><span class="comment" id="3372076">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3372147">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="3372184">//</span><br>
<span class="lineno">25</span><span class="comment" id="3372187">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="3372215">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="3372285">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="3372322">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3372367">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="3372376">func</span>&nbsp;<span class="ident" id="3372381">NewFileTransport</span><span class="op" id="3372397">(</span><span class="ident" id="3372398">fs</span>&nbsp;<span class="ident" id="3372401">FileSystem</span><span class="op" id="3372411">)</span>&nbsp;<span class="ident" id="3372413">RoundTripper</span>&nbsp;<span class="op" id="3372426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372429">return</span>&nbsp;<span class="ident" id="3372436">fileTransport</span><span class="op" id="3372449">{</span><span class="ident" id="3372450">fileHandler</span><span class="op" id="3372461">{</span><span class="ident" id="3372462">fs</span><span class="op" id="3372464">}</span><span class="op" id="3372465">}</span><br>
<span class="lineno"></span><span class="op" id="3372467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3372470">func</span>&nbsp;<span class="op" id="3372475">(</span><span class="ident" id="3372476">t</span>&nbsp;<span class="ident" id="3372478">fileTransport</span><span class="op" id="3372491">)</span>&nbsp;<span class="ident" id="3372493">RoundTrip</span><span class="op" id="3372502">(</span><span class="ident" id="3372503">req</span>&nbsp;<span class="op" id="3372507">*</span><span class="ident" id="3372508">Request</span><span class="op" id="3372515">)</span>&nbsp;<span class="op" id="3372517">(</span><span class="ident" id="3372518">resp</span>&nbsp;<span class="op" id="3372523">*</span><span class="ident" id="3372524">Response</span><span class="op" id="3372532">,</span>&nbsp;<span class="ident" id="3372534">err</span>&nbsp;<span class="builtintype" id="3372538">error</span><span class="op" id="3372543">)</span>&nbsp;<span class="op" id="3372545">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372548">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372609">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372671">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372733">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372796">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372850">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3372887">rw</span><span class="op" id="3372889">,</span>&nbsp;<span class="ident" id="3372891">resc</span>&nbsp;<span class="op" id="3372896">:=</span>&nbsp;<span class="ident" id="3372899">newPopulateResponseWriter</span><span class="op" id="3372924">(</span><span class="op" id="3372925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372928">go</span>&nbsp;<span class="keyword" id="3372931">func</span><span class="op" id="3372935">(</span><span class="op" id="3372936">)</span>&nbsp;<span class="op" id="3372938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3372942">t</span><span class="op" id="3372943">.</span><span class="ident" id="3372944">fh</span><span class="op" id="3372946">.</span><span class="ident" id="3372947">ServeHTTP</span><span class="op" id="3372956">(</span><span class="ident" id="3372957">rw</span><span class="op" id="3372959">,</span>&nbsp;<span class="ident" id="3372961">req</span><span class="op" id="3372964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3372968">rw</span><span class="op" id="3372970">.</span><span class="ident" id="3372971">finish</span><span class="op" id="3372977">(</span><span class="op" id="3372978">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3372981">}</span><span class="op" id="3372982">(</span><span class="op" id="3372983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372986">return</span>&nbsp;<span class="op" id="3372993">&lt;-</span><span class="ident" id="3372995">resc</span><span class="op" id="3372999">,</span>&nbsp;<span class="ident" id="3373001">nil</span><br>
<span class="lineno"></span><span class="op" id="3373005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3373008">func</span>&nbsp;<span class="ident" id="3373013">newPopulateResponseWriter</span><span class="op" id="3373038">(</span><span class="op" id="3373039">)</span>&nbsp;<span class="op" id="3373041">(</span><span class="op" id="3373042">*</span><span class="ident" id="3373043">populateResponse</span><span class="op" id="3373059">,</span>&nbsp;<span class="op" id="3373061">&lt;-</span><span class="keyword" id="3373063">chan</span>&nbsp;<span class="op" id="3373068">*</span><span class="ident" id="3373069">Response</span><span class="op" id="3373077">)</span>&nbsp;<span class="op" id="3373079">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373082">pr</span><span class="op" id="3373084">,</span>&nbsp;<span class="ident" id="3373086">pw</span>&nbsp;<span class="op" id="3373089">:=</span>&nbsp;<span class="ident" id="3373092">io</span><span class="op" id="3373094">.</span><span class="ident" id="3373095">Pipe</span><span class="op" id="3373099">(</span><span class="op" id="3373100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373103">rw</span>&nbsp;<span class="op" id="3373106">:=</span>&nbsp;<span class="op" id="3373109">&amp;</span><span class="ident" id="3373110">populateResponse</span><span class="op" id="3373126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373130">ch</span><span class="op" id="3373132">:</span>&nbsp;<span class="builtinfunc" id="3373134">make</span><span class="op" id="3373138">(</span><span class="keyword" id="3373139">chan</span>&nbsp;<span class="op" id="3373144">*</span><span class="ident" id="3373145">Response</span><span class="op" id="3373153">)</span><span class="op" id="3373154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373158">pw</span><span class="op" id="3373160">:</span>&nbsp;<span class="ident" id="3373162">pw</span><span class="op" id="3373164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373168">res</span><span class="op" id="3373171">:</span>&nbsp;<span class="op" id="3373173">&amp;</span><span class="ident" id="3373174">Response</span><span class="op" id="3373182">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373187">Proto</span><span class="op" id="3373192">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3373199">&#34;HTTP/1.0&#34;</span><span class="op" id="3373209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373214">ProtoMajor</span><span class="op" id="3373224">:</span>&nbsp;<span class="num" id="3373226">1</span><span class="op" id="3373227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373232">Header</span><span class="op" id="3373238">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3373244">make</span><span class="op" id="3373248">(</span><span class="ident" id="3373249">Header</span><span class="op" id="3373255">)</span><span class="op" id="3373256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373261">Close</span><span class="op" id="3373266">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3373273">true</span><span class="op" id="3373277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373282">Body</span><span class="op" id="3373286">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373294">pr</span><span class="op" id="3373296">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373300">}</span><span class="op" id="3373301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373307">return</span>&nbsp;<span class="ident" id="3373314">rw</span><span class="op" id="3373316">,</span>&nbsp;<span class="ident" id="3373318">rw</span><span class="op" id="3373320">.</span><span class="ident" id="3373321">ch</span><br>
<span class="lineno"></span><span class="op" id="3373324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3373327">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="3373396">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="3373463">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="3373534">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="3373544">type</span>&nbsp;<span class="ident" id="3373549">populateResponse</span>&nbsp;<span class="keyword" id="3373566">struct</span>&nbsp;<span class="op" id="3373573">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373576">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373589">*</span><span class="ident" id="3373590">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373600">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373613">chan</span>&nbsp;<span class="op" id="3373618">*</span><span class="ident" id="3373619">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373629">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="3373642">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373648">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3373661">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373667">sentResponse</span>&nbsp;<span class="builtintype" id="3373680">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373686">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373699">*</span><span class="ident" id="3373700">io</span><span class="op" id="3373702">.</span><span class="ident" id="3373703">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="3373714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3373717">func</span>&nbsp;<span class="op" id="3373722">(</span><span class="ident" id="3373723">pr</span>&nbsp;<span class="op" id="3373726">*</span><span class="ident" id="3373727">populateResponse</span><span class="op" id="3373743">)</span>&nbsp;<span class="ident" id="3373745">finish</span><span class="op" id="3373751">(</span><span class="op" id="3373752">)</span>&nbsp;<span class="op" id="3373754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373757">if</span>&nbsp;<span class="op" id="3373760">!</span><span class="ident" id="3373761">pr</span><span class="op" id="3373763">.</span><span class="ident" id="3373764">wroteHeader</span>&nbsp;<span class="op" id="3373776">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373780">pr</span><span class="op" id="3373782">.</span><span class="ident" id="3373783">WriteHeader</span><span class="op" id="3373794">(</span><span class="num" id="3373795">500</span><span class="op" id="3373798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373804">if</span>&nbsp;<span class="op" id="3373807">!</span><span class="ident" id="3373808">pr</span><span class="op" id="3373810">.</span><span class="ident" id="3373811">sentResponse</span>&nbsp;<span class="op" id="3373824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373828">pr</span><span class="op" id="3373830">.</span><span class="ident" id="3373831">sendResponse</span><span class="op" id="3373843">(</span><span class="op" id="3373844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373847">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373850">pr</span><span class="op" id="3373852">.</span><span class="ident" id="3373853">pw</span><span class="op" id="3373855">.</span><span class="ident" id="3373856">Close</span><span class="op" id="3373861">(</span><span class="op" id="3373862">)</span><br>
<span class="lineno"></span><span class="op" id="3373864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3373867">func</span>&nbsp;<span class="op" id="3373872">(</span><span class="ident" id="3373873">pr</span>&nbsp;<span class="op" id="3373876">*</span><span class="ident" id="3373877">populateResponse</span><span class="op" id="3373893">)</span>&nbsp;<span class="ident" id="3373895">sendResponse</span><span class="op" id="3373907">(</span><span class="op" id="3373908">)</span>&nbsp;<span class="op" id="3373910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373913">if</span>&nbsp;<span class="ident" id="3373916">pr</span><span class="op" id="3373918">.</span><span class="ident" id="3373919">sentResponse</span>&nbsp;<span class="op" id="3373932">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373936">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373947">pr</span><span class="op" id="3373949">.</span><span class="ident" id="3373950">sentResponse</span>&nbsp;<span class="op" id="3373963">=</span>&nbsp;<span class="builtintype" id="3373965">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373972">if</span>&nbsp;<span class="ident" id="3373975">pr</span><span class="op" id="3373977">.</span><span class="ident" id="3373978">hasContent</span>&nbsp;<span class="op" id="3373989">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373993">pr</span><span class="op" id="3373995">.</span><span class="ident" id="3373996">res</span><span class="op" id="3373999">.</span><span class="ident" id="3374000">ContentLength</span>&nbsp;<span class="op" id="3374014">=</span>&nbsp;<span class="op" id="3374016">-</span><span class="num" id="3374017">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3374020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374023">pr</span><span class="op" id="3374025">.</span><span class="ident" id="3374026">ch</span>&nbsp;<span class="op" id="3374029">&lt;-</span>&nbsp;<span class="ident" id="3374032">pr</span><span class="op" id="3374034">.</span><span class="ident" id="3374035">res</span><br>
<span class="lineno"></span><span class="op" id="3374039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3374042">func</span>&nbsp;<span class="op" id="3374047">(</span><span class="ident" id="3374048">pr</span>&nbsp;<span class="op" id="3374051">*</span><span class="ident" id="3374052">populateResponse</span><span class="op" id="3374068">)</span>&nbsp;<span class="ident" id="3374070">Header</span><span class="op" id="3374076">(</span><span class="op" id="3374077">)</span>&nbsp;<span class="ident" id="3374079">Header</span>&nbsp;<span class="op" id="3374086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374089">return</span>&nbsp;<span class="ident" id="3374096">pr</span><span class="op" id="3374098">.</span><span class="ident" id="3374099">res</span><span class="op" id="3374102">.</span><span class="ident" id="3374103">Header</span><br>
<span class="lineno"></span><span class="op" id="3374110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3374113">func</span>&nbsp;<span class="op" id="3374118">(</span><span class="ident" id="3374119">pr</span>&nbsp;<span class="op" id="3374122">*</span><span class="ident" id="3374123">populateResponse</span><span class="op" id="3374139">)</span>&nbsp;<span class="ident" id="3374141">WriteHeader</span><span class="op" id="3374152">(</span><span class="ident" id="3374153">code</span>&nbsp;<span class="builtintype" id="3374158">int</span><span class="op" id="3374161">)</span>&nbsp;<span class="op" id="3374163">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374166">if</span>&nbsp;<span class="ident" id="3374169">pr</span><span class="op" id="3374171">.</span><span class="ident" id="3374172">wroteHeader</span>&nbsp;<span class="op" id="3374184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374188">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3374196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374199">pr</span><span class="op" id="3374201">.</span><span class="ident" id="3374202">wroteHeader</span>&nbsp;<span class="op" id="3374214">=</span>&nbsp;<span class="builtintype" id="3374216">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374223">pr</span><span class="op" id="3374225">.</span><span class="ident" id="3374226">res</span><span class="op" id="3374229">.</span><span class="ident" id="3374230">StatusCode</span>&nbsp;<span class="op" id="3374241">=</span>&nbsp;<span class="ident" id="3374243">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374249">pr</span><span class="op" id="3374251">.</span><span class="ident" id="3374252">res</span><span class="op" id="3374255">.</span><span class="ident" id="3374256">Status</span>&nbsp;<span class="op" id="3374263">=</span>&nbsp;<span class="ident" id="3374265">fmt</span><span class="op" id="3374268">.</span><span class="ident" id="3374269">Sprintf</span><span class="op" id="3374276">(</span><span class="string" id="3374277">&#34;%d&nbsp;%s&#34;</span><span class="op" id="3374284">,</span>&nbsp;<span class="ident" id="3374286">code</span><span class="op" id="3374290">,</span>&nbsp;<span class="ident" id="3374292">StatusText</span><span class="op" id="3374302">(</span><span class="ident" id="3374303">code</span><span class="op" id="3374307">)</span><span class="op" id="3374308">)</span><br>
<span class="lineno"></span><span class="op" id="3374310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3374313">func</span>&nbsp;<span class="op" id="3374318">(</span><span class="ident" id="3374319">pr</span>&nbsp;<span class="op" id="3374322">*</span><span class="ident" id="3374323">populateResponse</span><span class="op" id="3374339">)</span>&nbsp;<span class="ident" id="3374341">Write</span><span class="op" id="3374346">(</span><span class="ident" id="3374347">p</span>&nbsp;<span class="op" id="3374349">[</span><span class="op" id="3374350">]</span><span class="builtintype" id="3374351">byte</span><span class="op" id="3374355">)</span>&nbsp;<span class="op" id="3374357">(</span><span class="ident" id="3374358">n</span>&nbsp;<span class="builtintype" id="3374360">int</span><span class="op" id="3374363">,</span>&nbsp;<span class="ident" id="3374365">err</span>&nbsp;<span class="builtintype" id="3374369">error</span><span class="op" id="3374374">)</span>&nbsp;<span class="op" id="3374376">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374379">if</span>&nbsp;<span class="op" id="3374382">!</span><span class="ident" id="3374383">pr</span><span class="op" id="3374385">.</span><span class="ident" id="3374386">wroteHeader</span>&nbsp;<span class="op" id="3374398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374402">pr</span><span class="op" id="3374404">.</span><span class="ident" id="3374405">WriteHeader</span><span class="op" id="3374416">(</span><span class="ident" id="3374417">StatusOK</span><span class="op" id="3374425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3374428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374431">pr</span><span class="op" id="3374433">.</span><span class="ident" id="3374434">hasContent</span>&nbsp;<span class="op" id="3374445">=</span>&nbsp;<span class="builtintype" id="3374447">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374453">if</span>&nbsp;<span class="op" id="3374456">!</span><span class="ident" id="3374457">pr</span><span class="op" id="3374459">.</span><span class="ident" id="3374460">sentResponse</span>&nbsp;<span class="op" id="3374473">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3374477">pr</span><span class="op" id="3374479">.</span><span class="ident" id="3374480">sendResponse</span><span class="op" id="3374492">(</span><span class="op" id="3374493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3374496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374499">return</span>&nbsp;<span class="ident" id="3374506">pr</span><span class="op" id="3374508">.</span><span class="ident" id="3374509">pw</span><span class="op" id="3374511">.</span><span class="ident" id="3374512">Write</span><span class="op" id="3374517">(</span><span class="ident" id="3374518">p</span><span class="op" id="3374519">)</span><br>
<span class="lineno"></span><span class="op" id="3374521">}</span>
</div>
</body>
</html>
