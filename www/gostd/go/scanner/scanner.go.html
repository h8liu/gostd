<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/scanner</h2>
<ul>
<li><a href="/gostd/go/scanner/errors.go.html">errors.go</a></li>
<li><a href="/gostd/go/scanner/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/scanner/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/go/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3293434">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3293489">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3293543">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3293594">//&nbsp;Package&nbsp;scanner&nbsp;implements&nbsp;a&nbsp;scanner&nbsp;for&nbsp;Go&nbsp;source&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="3293654">//&nbsp;It&nbsp;takes&nbsp;a&nbsp;[]byte&nbsp;as&nbsp;source&nbsp;which&nbsp;can&nbsp;then&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="3293713">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="3293759">//</span><br>
<span class="lineno"></span><span class="keyword" id="3293762">package</span>&nbsp;<span class="ident" id="3293770">scanner</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3293779">import</span>&nbsp;<span class="op" id="3293786">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3293789">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3293798">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3293805">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3293817">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3293834">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3293845">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3293856">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3293871">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3293874">//&nbsp;An&nbsp;ErrorHandler&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Scanner.Init.&nbsp;If&nbsp;a&nbsp;syntax&nbsp;error&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3293947">//&nbsp;encountered&nbsp;and&nbsp;a&nbsp;handler&nbsp;was&nbsp;installed,&nbsp;the&nbsp;handler&nbsp;is&nbsp;called&nbsp;with&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3294020">//&nbsp;position&nbsp;and&nbsp;an&nbsp;error&nbsp;message.&nbsp;The&nbsp;position&nbsp;points&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3294094">//&nbsp;the&nbsp;offending&nbsp;token.</span><br>
<span class="lineno">25</span><span class="comment" id="3294118">//</span><br>
<span class="lineno"></span><span class="keyword" id="3294121">type</span>&nbsp;<span class="ident" id="3294126">ErrorHandler</span>&nbsp;<span class="keyword" id="3294139">func</span><span class="op" id="3294143">(</span><span class="ident" id="3294144">pos</span>&nbsp;<span class="ident" id="3294148">token</span><span class="op" id="3294153">.</span><span class="ident" id="3294154">Position</span><span class="op" id="3294162">,</span>&nbsp;<span class="ident" id="3294164">msg</span>&nbsp;<span class="builtintype" id="3294168">string</span><span class="op" id="3294174">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3294177">//&nbsp;A&nbsp;Scanner&nbsp;holds&nbsp;the&nbsp;scanner&#39;s&nbsp;internal&nbsp;state&nbsp;while&nbsp;processing</span><br>
<span class="lineno"></span><span class="comment" id="3294242">//&nbsp;a&nbsp;given&nbsp;text.&nbsp;&nbsp;It&nbsp;can&nbsp;be&nbsp;allocated&nbsp;as&nbsp;part&nbsp;of&nbsp;another&nbsp;data</span><br>
<span class="lineno">30</span><span class="comment" id="3294304">//&nbsp;structure&nbsp;but&nbsp;must&nbsp;be&nbsp;initialized&nbsp;via&nbsp;Init&nbsp;before&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="3294362">//</span><br>
<span class="lineno"></span><span class="keyword" id="3294365">type</span>&nbsp;<span class="ident" id="3294370">Scanner</span>&nbsp;<span class="keyword" id="3294378">struct</span>&nbsp;<span class="op" id="3294385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3294388">//&nbsp;immutable&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294408">file</span>&nbsp;<span class="op" id="3294413">*</span><span class="ident" id="3294414">token</span><span class="op" id="3294419">.</span><span class="ident" id="3294420">File</span>&nbsp;&nbsp;<span class="comment" id="3294426">//&nbsp;source&nbsp;file&nbsp;handle</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294449">dir</span>&nbsp;&nbsp;<span class="builtintype" id="3294454">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3294467">//&nbsp;directory&nbsp;portion&nbsp;of&nbsp;file.Name()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294504">src</span>&nbsp;&nbsp;<span class="op" id="3294509">[</span><span class="op" id="3294510">]</span><span class="builtintype" id="3294511">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3294522">//&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294533">err</span>&nbsp;&nbsp;<span class="ident" id="3294538">ErrorHandler</span>&nbsp;<span class="comment" id="3294551">//&nbsp;error&nbsp;reporting;&nbsp;or&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294579">mode</span>&nbsp;<span class="ident" id="3294584">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3294597">//&nbsp;scanning&nbsp;mode</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3294616">//&nbsp;scanning&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294635">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3294646">rune</span>&nbsp;<span class="comment" id="3294651">//&nbsp;current&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294673">offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3294684">int</span>&nbsp;&nbsp;<span class="comment" id="3294689">//&nbsp;character&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294710">rdOffset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3294721">int</span>&nbsp;&nbsp;<span class="comment" id="3294726">//&nbsp;reading&nbsp;offset&nbsp;(position&nbsp;after&nbsp;current&nbsp;character)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294780">lineOffset</span>&nbsp;<span class="builtintype" id="3294791">int</span>&nbsp;&nbsp;<span class="comment" id="3294796">//&nbsp;current&nbsp;line&nbsp;offset</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294820">insertSemi</span>&nbsp;<span class="builtintype" id="3294831">bool</span>&nbsp;<span class="comment" id="3294836">//&nbsp;insert&nbsp;a&nbsp;semicolon&nbsp;before&nbsp;next&nbsp;newline</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3294880">//&nbsp;public&nbsp;state&nbsp;-&nbsp;ok&nbsp;to&nbsp;modify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3294912">ErrorCount</span>&nbsp;<span class="builtintype" id="3294923">int</span>&nbsp;<span class="comment" id="3294927">//&nbsp;number&nbsp;of&nbsp;errors&nbsp;encountered</span><br>
<span class="lineno"></span><span class="op" id="3294959">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3294962">const</span>&nbsp;<span class="ident" id="3294968">bom</span>&nbsp;<span class="op" id="3294972">=</span>&nbsp;<span class="num" id="3294974">0xFEFF</span>&nbsp;<span class="comment" id="3294981">//&nbsp;byte&nbsp;order&nbsp;mark,&nbsp;only&nbsp;permitted&nbsp;as&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3295041">//&nbsp;Read&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;char&nbsp;into&nbsp;s.ch.</span><br>
<span class="lineno"></span><span class="comment" id="3295082">//&nbsp;s.ch&nbsp;&lt;&nbsp;0&nbsp;means&nbsp;end-of-file.</span><br>
<span class="lineno">55</span><span class="comment" id="3295113">//</span><br>
<span class="lineno"></span><span class="keyword" id="3295116">func</span>&nbsp;<span class="op" id="3295121">(</span><span class="ident" id="3295122">s</span>&nbsp;<span class="op" id="3295124">*</span><span class="ident" id="3295125">Scanner</span><span class="op" id="3295132">)</span>&nbsp;<span class="ident" id="3295134">next</span><span class="op" id="3295138">(</span><span class="op" id="3295139">)</span>&nbsp;<span class="op" id="3295141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3295144">if</span>&nbsp;<span class="ident" id="3295147">s</span><span class="op" id="3295148">.</span><span class="ident" id="3295149">rdOffset</span>&nbsp;<span class="op" id="3295158">&lt;</span>&nbsp;<span class="builtinfunc" id="3295160">len</span><span class="op" id="3295163">(</span><span class="ident" id="3295164">s</span><span class="op" id="3295165">.</span><span class="ident" id="3295166">src</span><span class="op" id="3295169">)</span>&nbsp;<span class="op" id="3295171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295175">s</span><span class="op" id="3295176">.</span><span class="ident" id="3295177">offset</span>&nbsp;<span class="op" id="3295184">=</span>&nbsp;<span class="ident" id="3295186">s</span><span class="op" id="3295187">.</span><span class="ident" id="3295188">rdOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3295199">if</span>&nbsp;<span class="ident" id="3295202">s</span><span class="op" id="3295203">.</span><span class="ident" id="3295204">ch</span>&nbsp;<span class="op" id="3295207">==</span>&nbsp;<span class="string" id="3295210">&#39;\n&#39;</span>&nbsp;<span class="op" id="3295215">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295220">s</span><span class="op" id="3295221">.</span><span class="ident" id="3295222">lineOffset</span>&nbsp;<span class="op" id="3295233">=</span>&nbsp;<span class="ident" id="3295235">s</span><span class="op" id="3295236">.</span><span class="ident" id="3295237">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295247">s</span><span class="op" id="3295248">.</span><span class="ident" id="3295249">file</span><span class="op" id="3295253">.</span><span class="ident" id="3295254">AddLine</span><span class="op" id="3295261">(</span><span class="ident" id="3295262">s</span><span class="op" id="3295263">.</span><span class="ident" id="3295264">offset</span><span class="op" id="3295270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3295274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295278">r</span><span class="op" id="3295279">,</span>&nbsp;<span class="ident" id="3295281">w</span>&nbsp;<span class="op" id="3295283">:=</span>&nbsp;<span class="builtintype" id="3295286">rune</span><span class="op" id="3295290">(</span><span class="ident" id="3295291">s</span><span class="op" id="3295292">.</span><span class="ident" id="3295293">src</span><span class="op" id="3295296">[</span><span class="ident" id="3295297">s</span><span class="op" id="3295298">.</span><span class="ident" id="3295299">rdOffset</span><span class="op" id="3295307">]</span><span class="op" id="3295308">)</span><span class="op" id="3295309">,</span>&nbsp;<span class="num" id="3295311">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3295315">switch</span>&nbsp;<span class="op" id="3295322">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3295326">case</span>&nbsp;<span class="ident" id="3295331">r</span>&nbsp;<span class="op" id="3295333">==</span>&nbsp;<span class="num" id="3295336">0</span><span class="op" id="3295337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295342">s</span><span class="op" id="3295343">.</span><span class="builtintype" id="3295344">error</span><span class="op" id="3295349">(</span><span class="ident" id="3295350">s</span><span class="op" id="3295351">.</span><span class="ident" id="3295352">offset</span><span class="op" id="3295358">,</span>&nbsp;<span class="string" id="3295360">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="3295383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3295387">case</span>&nbsp;<span class="ident" id="3295392">r</span>&nbsp;<span class="op" id="3295394">&gt;=</span>&nbsp;<span class="num" id="3295397">0x80</span><span class="op" id="3295401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3295406">//&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295422">r</span><span class="op" id="3295423">,</span>&nbsp;<span class="ident" id="3295425">w</span>&nbsp;<span class="op" id="3295427">=</span>&nbsp;<span class="ident" id="3295429">utf8</span><span class="op" id="3295433">.</span><span class="ident" id="3295434">DecodeRune</span><span class="op" id="3295444">(</span><span class="ident" id="3295445">s</span><span class="op" id="3295446">.</span><span class="ident" id="3295447">src</span><span class="op" id="3295450">[</span><span class="ident" id="3295451">s</span><span class="op" id="3295452">.</span><span class="ident" id="3295453">rdOffset</span><span class="op" id="3295461">:</span><span class="op" id="3295462">]</span><span class="op" id="3295463">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3295468">if</span>&nbsp;<span class="ident" id="3295471">r</span>&nbsp;<span class="op" id="3295473">==</span>&nbsp;<span class="ident" id="3295476">utf8</span><span class="op" id="3295480">.</span><span class="ident" id="3295481">RuneError</span>&nbsp;<span class="op" id="3295491">&amp;&amp;</span>&nbsp;<span class="ident" id="3295494">w</span>&nbsp;<span class="op" id="3295496">==</span>&nbsp;<span class="num" id="3295499">1</span>&nbsp;<span class="op" id="3295501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295507">s</span><span class="op" id="3295508">.</span><span class="builtintype" id="3295509">error</span><span class="op" id="3295514">(</span><span class="ident" id="3295515">s</span><span class="op" id="3295516">.</span><span class="ident" id="3295517">offset</span><span class="op" id="3295523">,</span>&nbsp;<span class="string" id="3295525">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="3295549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3295554">}</span>&nbsp;<span class="keyword" id="3295556">else</span>&nbsp;<span class="keyword" id="3295561">if</span>&nbsp;<span class="ident" id="3295564">r</span>&nbsp;<span class="op" id="3295566">==</span>&nbsp;<span class="ident" id="3295569">bom</span>&nbsp;<span class="op" id="3295573">&amp;&amp;</span>&nbsp;<span class="ident" id="3295576">s</span><span class="op" id="3295577">.</span><span class="ident" id="3295578">offset</span>&nbsp;<span class="op" id="3295585">&gt;</span>&nbsp;<span class="num" id="3295587">0</span>&nbsp;<span class="op" id="3295589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295595">s</span><span class="op" id="3295596">.</span><span class="builtintype" id="3295597">error</span><span class="op" id="3295602">(</span><span class="ident" id="3295603">s</span><span class="op" id="3295604">.</span><span class="ident" id="3295605">offset</span><span class="op" id="3295611">,</span>&nbsp;<span class="string" id="3295613">&#34;illegal&nbsp;byte&nbsp;order&nbsp;mark&#34;</span><span class="op" id="3295638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3295643">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3295647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295651">s</span><span class="op" id="3295652">.</span><span class="ident" id="3295653">rdOffset</span>&nbsp;<span class="op" id="3295662">+=</span>&nbsp;<span class="ident" id="3295665">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295669">s</span><span class="op" id="3295670">.</span><span class="ident" id="3295671">ch</span>&nbsp;<span class="op" id="3295674">=</span>&nbsp;<span class="ident" id="3295676">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3295679">}</span>&nbsp;<span class="keyword" id="3295681">else</span>&nbsp;<span class="op" id="3295686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295690">s</span><span class="op" id="3295691">.</span><span class="ident" id="3295692">offset</span>&nbsp;<span class="op" id="3295699">=</span>&nbsp;<span class="builtinfunc" id="3295701">len</span><span class="op" id="3295704">(</span><span class="ident" id="3295705">s</span><span class="op" id="3295706">.</span><span class="ident" id="3295707">src</span><span class="op" id="3295710">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3295714">if</span>&nbsp;<span class="ident" id="3295717">s</span><span class="op" id="3295718">.</span><span class="ident" id="3295719">ch</span>&nbsp;<span class="op" id="3295722">==</span>&nbsp;<span class="string" id="3295725">&#39;\n&#39;</span>&nbsp;<span class="op" id="3295730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295735">s</span><span class="op" id="3295736">.</span><span class="ident" id="3295737">lineOffset</span>&nbsp;<span class="op" id="3295748">=</span>&nbsp;<span class="ident" id="3295750">s</span><span class="op" id="3295751">.</span><span class="ident" id="3295752">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295762">s</span><span class="op" id="3295763">.</span><span class="ident" id="3295764">file</span><span class="op" id="3295768">.</span><span class="ident" id="3295769">AddLine</span><span class="op" id="3295776">(</span><span class="ident" id="3295777">s</span><span class="op" id="3295778">.</span><span class="ident" id="3295779">offset</span><span class="op" id="3295785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3295789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295793">s</span><span class="op" id="3295794">.</span><span class="ident" id="3295795">ch</span>&nbsp;<span class="op" id="3295798">=</span>&nbsp;<span class="op" id="3295800">-</span><span class="num" id="3295801">1</span>&nbsp;<span class="comment" id="3295803">//&nbsp;eof</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3295811">}</span><br>
<span class="lineno"></span><span class="op" id="3295813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3295816">//&nbsp;A&nbsp;mode&nbsp;value&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;flags&nbsp;(or&nbsp;0).</span><br>
<span class="lineno"></span><span class="comment" id="3295858">//&nbsp;They&nbsp;control&nbsp;scanner&nbsp;behavior.</span><br>
<span class="lineno">90</span><span class="comment" id="3295892">//</span><br>
<span class="lineno"></span><span class="keyword" id="3295895">type</span>&nbsp;<span class="ident" id="3295900">Mode</span>&nbsp;<span class="builtintype" id="3295905">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3295911">const</span>&nbsp;<span class="op" id="3295917">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295920">ScanComments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295936">Mode</span>&nbsp;<span class="op" id="3295941">=</span>&nbsp;<span class="num" id="3295943">1</span>&nbsp;<span class="op" id="3295945">&lt;&lt;</span>&nbsp;<span class="ident" id="3295948">iota</span>&nbsp;<span class="comment" id="3295953">//&nbsp;return&nbsp;comments&nbsp;as&nbsp;COMMENT&nbsp;tokens</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295991">dontInsertSemis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3296024">//&nbsp;do&nbsp;not&nbsp;automatically&nbsp;insert&nbsp;semicolons&nbsp;-&nbsp;for&nbsp;testing&nbsp;only</span><br>
<span class="lineno"></span><span class="op" id="3296085">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3296088">//&nbsp;Init&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;s&nbsp;to&nbsp;tokenize&nbsp;the&nbsp;text&nbsp;src&nbsp;by&nbsp;setting&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3296159">//&nbsp;scanner&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;src.&nbsp;The&nbsp;scanner&nbsp;uses&nbsp;the&nbsp;file&nbsp;set&nbsp;file</span><br>
<span class="lineno">100</span><span class="comment" id="3296230">//&nbsp;for&nbsp;position&nbsp;information&nbsp;and&nbsp;it&nbsp;adds&nbsp;line&nbsp;information&nbsp;for&nbsp;each&nbsp;line.</span><br>
<span class="lineno"></span><span class="comment" id="3296302">//&nbsp;It&nbsp;is&nbsp;ok&nbsp;to&nbsp;re-use&nbsp;the&nbsp;same&nbsp;file&nbsp;when&nbsp;re-scanning&nbsp;the&nbsp;same&nbsp;file&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3296372">//&nbsp;line&nbsp;information&nbsp;which&nbsp;is&nbsp;already&nbsp;present&nbsp;is&nbsp;ignored.&nbsp;Init&nbsp;causes&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3296443">//&nbsp;panic&nbsp;if&nbsp;the&nbsp;file&nbsp;size&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;src&nbsp;size.</span><br>
<span class="lineno"></span><span class="comment" id="3296498">//</span><br>
<span class="lineno">105</span><span class="comment" id="3296501">//&nbsp;Calls&nbsp;to&nbsp;Scan&nbsp;will&nbsp;invoke&nbsp;the&nbsp;error&nbsp;handler&nbsp;err&nbsp;if&nbsp;they&nbsp;encounter&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3296572">//&nbsp;syntax&nbsp;error&nbsp;and&nbsp;err&nbsp;is&nbsp;not&nbsp;nil.&nbsp;Also,&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered,</span><br>
<span class="lineno"></span><span class="comment" id="3296642">//&nbsp;the&nbsp;Scanner&nbsp;field&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one.&nbsp;The&nbsp;mode&nbsp;parameter</span><br>
<span class="lineno"></span><span class="comment" id="3296716">//&nbsp;determines&nbsp;how&nbsp;comments&nbsp;are&nbsp;handled.</span><br>
<span class="lineno"></span><span class="comment" id="3296756">//</span><br>
<span class="lineno">110</span><span class="comment" id="3296759">//&nbsp;Note&nbsp;that&nbsp;Init&nbsp;may&nbsp;call&nbsp;err&nbsp;if&nbsp;there&nbsp;is&nbsp;an&nbsp;error&nbsp;in&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="3296834">//&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="3296850">//</span><br>
<span class="lineno"></span><span class="keyword" id="3296853">func</span>&nbsp;<span class="op" id="3296858">(</span><span class="ident" id="3296859">s</span>&nbsp;<span class="op" id="3296861">*</span><span class="ident" id="3296862">Scanner</span><span class="op" id="3296869">)</span>&nbsp;<span class="ident" id="3296871">Init</span><span class="op" id="3296875">(</span><span class="ident" id="3296876">file</span>&nbsp;<span class="op" id="3296881">*</span><span class="ident" id="3296882">token</span><span class="op" id="3296887">.</span><span class="ident" id="3296888">File</span><span class="op" id="3296892">,</span>&nbsp;<span class="ident" id="3296894">src</span>&nbsp;<span class="op" id="3296898">[</span><span class="op" id="3296899">]</span><span class="builtintype" id="3296900">byte</span><span class="op" id="3296904">,</span>&nbsp;<span class="ident" id="3296906">err</span>&nbsp;<span class="ident" id="3296910">ErrorHandler</span><span class="op" id="3296922">,</span>&nbsp;<span class="ident" id="3296924">mode</span>&nbsp;<span class="ident" id="3296929">Mode</span><span class="op" id="3296933">)</span>&nbsp;<span class="op" id="3296935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3296938">//&nbsp;Explicitly&nbsp;initialize&nbsp;all&nbsp;fields&nbsp;since&nbsp;a&nbsp;scanner&nbsp;may&nbsp;be&nbsp;reused.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3297006">if</span>&nbsp;<span class="ident" id="3297009">file</span><span class="op" id="3297013">.</span><span class="ident" id="3297014">Size</span><span class="op" id="3297018">(</span><span class="op" id="3297019">)</span>&nbsp;<span class="op" id="3297021">!=</span>&nbsp;<span class="builtinfunc" id="3297024">len</span><span class="op" id="3297027">(</span><span class="ident" id="3297028">src</span><span class="op" id="3297031">)</span>&nbsp;<span class="op" id="3297033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3297037">panic</span><span class="op" id="3297042">(</span><span class="ident" id="3297043">fmt</span><span class="op" id="3297046">.</span><span class="ident" id="3297047">Sprintf</span><span class="op" id="3297054">(</span><span class="string" id="3297055">&#34;file&nbsp;size&nbsp;(%d)&nbsp;does&nbsp;not&nbsp;match&nbsp;src&nbsp;len&nbsp;(%d)&#34;</span><span class="op" id="3297099">,</span>&nbsp;<span class="ident" id="3297101">file</span><span class="op" id="3297105">.</span><span class="ident" id="3297106">Size</span><span class="op" id="3297110">(</span><span class="op" id="3297111">)</span><span class="op" id="3297112">,</span>&nbsp;<span class="builtinfunc" id="3297114">len</span><span class="op" id="3297117">(</span><span class="ident" id="3297118">src</span><span class="op" id="3297121">)</span><span class="op" id="3297122">)</span><span class="op" id="3297123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3297126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297129">s</span><span class="op" id="3297130">.</span><span class="ident" id="3297131">file</span>&nbsp;<span class="op" id="3297136">=</span>&nbsp;<span class="ident" id="3297138">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297144">s</span><span class="op" id="3297145">.</span><span class="ident" id="3297146">dir</span><span class="op" id="3297149">,</span>&nbsp;<span class="ident" id="3297151">_</span>&nbsp;<span class="op" id="3297153">=</span>&nbsp;<span class="ident" id="3297155">filepath</span><span class="op" id="3297163">.</span><span class="ident" id="3297164">Split</span><span class="op" id="3297169">(</span><span class="ident" id="3297170">file</span><span class="op" id="3297174">.</span><span class="ident" id="3297175">Name</span><span class="op" id="3297179">(</span><span class="op" id="3297180">)</span><span class="op" id="3297181">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297184">s</span><span class="op" id="3297185">.</span><span class="ident" id="3297186">src</span>&nbsp;<span class="op" id="3297190">=</span>&nbsp;<span class="ident" id="3297192">src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297197">s</span><span class="op" id="3297198">.</span><span class="ident" id="3297199">err</span>&nbsp;<span class="op" id="3297203">=</span>&nbsp;<span class="ident" id="3297205">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297210">s</span><span class="op" id="3297211">.</span><span class="ident" id="3297212">mode</span>&nbsp;<span class="op" id="3297217">=</span>&nbsp;<span class="ident" id="3297219">mode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297226">s</span><span class="op" id="3297227">.</span><span class="ident" id="3297228">ch</span>&nbsp;<span class="op" id="3297231">=</span>&nbsp;<span class="string" id="3297233">&#39;&nbsp;&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297238">s</span><span class="op" id="3297239">.</span><span class="ident" id="3297240">offset</span>&nbsp;<span class="op" id="3297247">=</span>&nbsp;<span class="num" id="3297249">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297252">s</span><span class="op" id="3297253">.</span><span class="ident" id="3297254">rdOffset</span>&nbsp;<span class="op" id="3297263">=</span>&nbsp;<span class="num" id="3297265">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297268">s</span><span class="op" id="3297269">.</span><span class="ident" id="3297270">lineOffset</span>&nbsp;<span class="op" id="3297281">=</span>&nbsp;<span class="num" id="3297283">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297286">s</span><span class="op" id="3297287">.</span><span class="ident" id="3297288">insertSemi</span>&nbsp;<span class="op" id="3297299">=</span>&nbsp;<span class="builtintype" id="3297301">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297308">s</span><span class="op" id="3297309">.</span><span class="ident" id="3297310">ErrorCount</span>&nbsp;<span class="op" id="3297321">=</span>&nbsp;<span class="num" id="3297323">0</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297327">s</span><span class="op" id="3297328">.</span><span class="ident" id="3297329">next</span><span class="op" id="3297333">(</span><span class="op" id="3297334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3297337">if</span>&nbsp;<span class="ident" id="3297340">s</span><span class="op" id="3297341">.</span><span class="ident" id="3297342">ch</span>&nbsp;<span class="op" id="3297345">==</span>&nbsp;<span class="ident" id="3297348">bom</span>&nbsp;<span class="op" id="3297352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297356">s</span><span class="op" id="3297357">.</span><span class="ident" id="3297358">next</span><span class="op" id="3297362">(</span><span class="op" id="3297363">)</span>&nbsp;<span class="comment" id="3297365">//&nbsp;ignore&nbsp;BOM&nbsp;at&nbsp;file&nbsp;beginning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3297398">}</span><br>
<span class="lineno">135</span><span class="op" id="3297400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3297403">func</span>&nbsp;<span class="op" id="3297408">(</span><span class="ident" id="3297409">s</span>&nbsp;<span class="op" id="3297411">*</span><span class="ident" id="3297412">Scanner</span><span class="op" id="3297419">)</span>&nbsp;<span class="builtintype" id="3297421">error</span><span class="op" id="3297426">(</span><span class="ident" id="3297427">offs</span>&nbsp;<span class="builtintype" id="3297432">int</span><span class="op" id="3297435">,</span>&nbsp;<span class="ident" id="3297437">msg</span>&nbsp;<span class="builtintype" id="3297441">string</span><span class="op" id="3297447">)</span>&nbsp;<span class="op" id="3297449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3297452">if</span>&nbsp;<span class="ident" id="3297455">s</span><span class="op" id="3297456">.</span><span class="ident" id="3297457">err</span>&nbsp;<span class="op" id="3297461">!=</span>&nbsp;<span class="builtintype" id="3297464">nil</span>&nbsp;<span class="op" id="3297468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297472">s</span><span class="op" id="3297473">.</span><span class="ident" id="3297474">err</span><span class="op" id="3297477">(</span><span class="ident" id="3297478">s</span><span class="op" id="3297479">.</span><span class="ident" id="3297480">file</span><span class="op" id="3297484">.</span><span class="ident" id="3297485">Position</span><span class="op" id="3297493">(</span><span class="ident" id="3297494">s</span><span class="op" id="3297495">.</span><span class="ident" id="3297496">file</span><span class="op" id="3297500">.</span><span class="ident" id="3297501">Pos</span><span class="op" id="3297504">(</span><span class="ident" id="3297505">offs</span><span class="op" id="3297509">)</span><span class="op" id="3297510">)</span><span class="op" id="3297511">,</span>&nbsp;<span class="ident" id="3297513">msg</span><span class="op" id="3297516">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3297519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297522">s</span><span class="op" id="3297523">.</span><span class="ident" id="3297524">ErrorCount</span><span class="op" id="3297534">++</span><br>
<span class="lineno"></span><span class="op" id="3297537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3297540">var</span>&nbsp;<span class="ident" id="3297544">prefix</span>&nbsp;<span class="op" id="3297551">=</span>&nbsp;<span class="op" id="3297553">[</span><span class="op" id="3297554">]</span><span class="builtintype" id="3297555">byte</span><span class="op" id="3297559">(</span><span class="string" id="3297560">&#34;//line&nbsp;&#34;</span><span class="op" id="3297569">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3297572">func</span>&nbsp;<span class="op" id="3297577">(</span><span class="ident" id="3297578">s</span>&nbsp;<span class="op" id="3297580">*</span><span class="ident" id="3297581">Scanner</span><span class="op" id="3297588">)</span>&nbsp;<span class="ident" id="3297590">interpretLineComment</span><span class="op" id="3297610">(</span><span class="ident" id="3297611">text</span>&nbsp;<span class="op" id="3297616">[</span><span class="op" id="3297617">]</span><span class="builtintype" id="3297618">byte</span><span class="op" id="3297622">)</span>&nbsp;<span class="op" id="3297624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3297627">if</span>&nbsp;<span class="ident" id="3297630">bytes</span><span class="op" id="3297635">.</span><span class="ident" id="3297636">HasPrefix</span><span class="op" id="3297645">(</span><span class="ident" id="3297646">text</span><span class="op" id="3297650">,</span>&nbsp;<span class="ident" id="3297652">prefix</span><span class="op" id="3297658">)</span>&nbsp;<span class="op" id="3297660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3297664">//&nbsp;get&nbsp;filename&nbsp;and&nbsp;line&nbsp;number,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3297706">if</span>&nbsp;<span class="ident" id="3297709">i</span>&nbsp;<span class="op" id="3297711">:=</span>&nbsp;<span class="ident" id="3297714">bytes</span><span class="op" id="3297719">.</span><span class="ident" id="3297720">LastIndex</span><span class="op" id="3297729">(</span><span class="ident" id="3297730">text</span><span class="op" id="3297734">,</span>&nbsp;<span class="op" id="3297736">[</span><span class="op" id="3297737">]</span><span class="builtintype" id="3297738">byte</span><span class="op" id="3297742">{</span><span class="string" id="3297743">&#39;:&#39;</span><span class="op" id="3297746">}</span><span class="op" id="3297747">)</span><span class="op" id="3297748">;</span>&nbsp;<span class="ident" id="3297750">i</span>&nbsp;<span class="op" id="3297752">&gt;</span>&nbsp;<span class="num" id="3297754">0</span>&nbsp;<span class="op" id="3297756">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3297761">if</span>&nbsp;<span class="ident" id="3297764">line</span><span class="op" id="3297768">,</span>&nbsp;<span class="ident" id="3297770">err</span>&nbsp;<span class="op" id="3297774">:=</span>&nbsp;<span class="ident" id="3297777">strconv</span><span class="op" id="3297784">.</span><span class="ident" id="3297785">Atoi</span><span class="op" id="3297789">(</span><span class="builtintype" id="3297790">string</span><span class="op" id="3297796">(</span><span class="ident" id="3297797">text</span><span class="op" id="3297801">[</span><span class="ident" id="3297802">i</span><span class="op" id="3297803">+</span><span class="num" id="3297804">1</span><span class="op" id="3297805">:</span><span class="op" id="3297806">]</span><span class="op" id="3297807">)</span><span class="op" id="3297808">)</span><span class="op" id="3297809">;</span>&nbsp;<span class="ident" id="3297811">err</span>&nbsp;<span class="op" id="3297815">==</span>&nbsp;<span class="builtintype" id="3297818">nil</span>&nbsp;<span class="op" id="3297822">&amp;&amp;</span>&nbsp;<span class="ident" id="3297825">line</span>&nbsp;<span class="op" id="3297830">&gt;</span>&nbsp;<span class="num" id="3297832">0</span>&nbsp;<span class="op" id="3297834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3297840">//&nbsp;valid&nbsp;//line&nbsp;filename:line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297882">filename</span>&nbsp;<span class="op" id="3297891">:=</span>&nbsp;<span class="builtintype" id="3297894">string</span><span class="op" id="3297900">(</span><span class="ident" id="3297901">bytes</span><span class="op" id="3297906">.</span><span class="ident" id="3297907">TrimSpace</span><span class="op" id="3297916">(</span><span class="ident" id="3297917">text</span><span class="op" id="3297921">[</span><span class="builtinfunc" id="3297922">len</span><span class="op" id="3297925">(</span><span class="ident" id="3297926">prefix</span><span class="op" id="3297932">)</span><span class="op" id="3297933">:</span><span class="ident" id="3297934">i</span><span class="op" id="3297935">]</span><span class="op" id="3297936">)</span><span class="op" id="3297937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3297943">if</span>&nbsp;<span class="ident" id="3297946">filename</span>&nbsp;<span class="op" id="3297955">!=</span>&nbsp;<span class="string" id="3297958">&#34;&#34;</span>&nbsp;<span class="op" id="3297961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3297968">filename</span>&nbsp;<span class="op" id="3297977">=</span>&nbsp;<span class="ident" id="3297979">filepath</span><span class="op" id="3297987">.</span><span class="ident" id="3297988">Clean</span><span class="op" id="3297993">(</span><span class="ident" id="3297994">filename</span><span class="op" id="3298002">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298009">if</span>&nbsp;<span class="op" id="3298012">!</span><span class="ident" id="3298013">filepath</span><span class="op" id="3298021">.</span><span class="ident" id="3298022">IsAbs</span><span class="op" id="3298027">(</span><span class="ident" id="3298028">filename</span><span class="op" id="3298036">)</span>&nbsp;<span class="op" id="3298038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3298046">//&nbsp;make&nbsp;filename&nbsp;relative&nbsp;to&nbsp;current&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298099">filename</span>&nbsp;<span class="op" id="3298108">=</span>&nbsp;<span class="ident" id="3298110">filepath</span><span class="op" id="3298118">.</span><span class="ident" id="3298119">Join</span><span class="op" id="3298123">(</span><span class="ident" id="3298124">s</span><span class="op" id="3298125">.</span><span class="ident" id="3298126">dir</span><span class="op" id="3298129">,</span>&nbsp;<span class="ident" id="3298131">filename</span><span class="op" id="3298139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298152">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3298158">//&nbsp;update&nbsp;scanner&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298189">s</span><span class="op" id="3298190">.</span><span class="ident" id="3298191">file</span><span class="op" id="3298195">.</span><span class="ident" id="3298196">AddLineInfo</span><span class="op" id="3298207">(</span><span class="ident" id="3298208">s</span><span class="op" id="3298209">.</span><span class="ident" id="3298210">lineOffset</span><span class="op" id="3298220">+</span><span class="builtinfunc" id="3298221">len</span><span class="op" id="3298224">(</span><span class="ident" id="3298225">text</span><span class="op" id="3298229">)</span><span class="op" id="3298230">+</span><span class="num" id="3298231">1</span><span class="op" id="3298232">,</span>&nbsp;<span class="ident" id="3298234">filename</span><span class="op" id="3298242">,</span>&nbsp;<span class="ident" id="3298244">line</span><span class="op" id="3298248">)</span>&nbsp;<span class="comment" id="3298250">//&nbsp;+len(text)+1&nbsp;since&nbsp;comment&nbsp;applies&nbsp;to&nbsp;next&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298311">}</span><br>
<span class="lineno">165</span><span class="op" id="3298313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3298316">func</span>&nbsp;<span class="op" id="3298321">(</span><span class="ident" id="3298322">s</span>&nbsp;<span class="op" id="3298324">*</span><span class="ident" id="3298325">Scanner</span><span class="op" id="3298332">)</span>&nbsp;<span class="ident" id="3298334">scanComment</span><span class="op" id="3298345">(</span><span class="op" id="3298346">)</span>&nbsp;<span class="builtintype" id="3298348">string</span>&nbsp;<span class="op" id="3298355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3298358">//&nbsp;initial&nbsp;&#39;/&#39;&nbsp;already&nbsp;consumed;&nbsp;s.ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;s.ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298419">offs</span>&nbsp;<span class="op" id="3298424">:=</span>&nbsp;<span class="ident" id="3298427">s</span><span class="op" id="3298428">.</span><span class="ident" id="3298429">offset</span>&nbsp;<span class="op" id="3298436">-</span>&nbsp;<span class="num" id="3298438">1</span>&nbsp;<span class="comment" id="3298440">//&nbsp;position&nbsp;of&nbsp;initial&nbsp;&#39;/&#39;</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298468">hasCR</span>&nbsp;<span class="op" id="3298474">:=</span>&nbsp;<span class="builtintype" id="3298477">false</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298485">if</span>&nbsp;<span class="ident" id="3298488">s</span><span class="op" id="3298489">.</span><span class="ident" id="3298490">ch</span>&nbsp;<span class="op" id="3298493">==</span>&nbsp;<span class="string" id="3298496">&#39;/&#39;</span>&nbsp;<span class="op" id="3298500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3298504">//-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298523">s</span><span class="op" id="3298524">.</span><span class="ident" id="3298525">next</span><span class="op" id="3298529">(</span><span class="op" id="3298530">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298534">for</span>&nbsp;<span class="ident" id="3298538">s</span><span class="op" id="3298539">.</span><span class="ident" id="3298540">ch</span>&nbsp;<span class="op" id="3298543">!=</span>&nbsp;<span class="string" id="3298546">&#39;\n&#39;</span>&nbsp;<span class="op" id="3298551">&amp;&amp;</span>&nbsp;<span class="ident" id="3298554">s</span><span class="op" id="3298555">.</span><span class="ident" id="3298556">ch</span>&nbsp;<span class="op" id="3298559">&gt;=</span>&nbsp;<span class="num" id="3298562">0</span>&nbsp;<span class="op" id="3298564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298569">if</span>&nbsp;<span class="ident" id="3298572">s</span><span class="op" id="3298573">.</span><span class="ident" id="3298574">ch</span>&nbsp;<span class="op" id="3298577">==</span>&nbsp;<span class="string" id="3298580">&#39;\r&#39;</span>&nbsp;<span class="op" id="3298585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298591">hasCR</span>&nbsp;<span class="op" id="3298597">=</span>&nbsp;<span class="builtintype" id="3298599">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298612">s</span><span class="op" id="3298613">.</span><span class="ident" id="3298614">next</span><span class="op" id="3298618">(</span><span class="op" id="3298619">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298627">if</span>&nbsp;<span class="ident" id="3298630">offs</span>&nbsp;<span class="op" id="3298635">==</span>&nbsp;<span class="ident" id="3298638">s</span><span class="op" id="3298639">.</span><span class="ident" id="3298640">lineOffset</span>&nbsp;<span class="op" id="3298651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3298656">//&nbsp;comment&nbsp;starts&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;current&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298714">s</span><span class="op" id="3298715">.</span><span class="ident" id="3298716">interpretLineComment</span><span class="op" id="3298736">(</span><span class="ident" id="3298737">s</span><span class="op" id="3298738">.</span><span class="ident" id="3298739">src</span><span class="op" id="3298742">[</span><span class="ident" id="3298743">offs</span><span class="op" id="3298747">:</span><span class="ident" id="3298748">s</span><span class="op" id="3298749">.</span><span class="ident" id="3298750">offset</span><span class="op" id="3298756">]</span><span class="op" id="3298757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298761">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298765">goto</span>&nbsp;<span class="ident" id="3298770">exit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3298780">/*-style&nbsp;comment&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298801">s</span><span class="op" id="3298802">.</span><span class="ident" id="3298803">next</span><span class="op" id="3298807">(</span><span class="op" id="3298808">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298811">for</span>&nbsp;<span class="ident" id="3298815">s</span><span class="op" id="3298816">.</span><span class="ident" id="3298817">ch</span>&nbsp;<span class="op" id="3298820">&gt;=</span>&nbsp;<span class="num" id="3298823">0</span>&nbsp;<span class="op" id="3298825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298829">ch</span>&nbsp;<span class="op" id="3298832">:=</span>&nbsp;<span class="ident" id="3298835">s</span><span class="op" id="3298836">.</span><span class="ident" id="3298837">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298842">if</span>&nbsp;<span class="ident" id="3298845">ch</span>&nbsp;<span class="op" id="3298848">==</span>&nbsp;<span class="string" id="3298851">&#39;\r&#39;</span>&nbsp;<span class="op" id="3298856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298861">hasCR</span>&nbsp;<span class="op" id="3298867">=</span>&nbsp;<span class="builtintype" id="3298869">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298876">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298880">s</span><span class="op" id="3298881">.</span><span class="ident" id="3298882">next</span><span class="op" id="3298886">(</span><span class="op" id="3298887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298891">if</span>&nbsp;<span class="ident" id="3298894">ch</span>&nbsp;<span class="op" id="3298897">==</span>&nbsp;<span class="string" id="3298900">&#39;*&#39;</span>&nbsp;<span class="op" id="3298904">&amp;&amp;</span>&nbsp;<span class="ident" id="3298907">s</span><span class="op" id="3298908">.</span><span class="ident" id="3298909">ch</span>&nbsp;<span class="op" id="3298912">==</span>&nbsp;<span class="string" id="3298915">&#39;/&#39;</span>&nbsp;<span class="op" id="3298919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298924">s</span><span class="op" id="3298925">.</span><span class="ident" id="3298926">next</span><span class="op" id="3298930">(</span><span class="op" id="3298931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3298936">goto</span>&nbsp;<span class="ident" id="3298941">exit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298948">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3298951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3298955">s</span><span class="op" id="3298956">.</span><span class="builtintype" id="3298957">error</span><span class="op" id="3298962">(</span><span class="ident" id="3298963">offs</span><span class="op" id="3298967">,</span>&nbsp;<span class="string" id="3298969">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="3298993">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="3298996">exit</span><span class="op" id="3299000">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299003">lit</span>&nbsp;<span class="op" id="3299007">:=</span>&nbsp;<span class="ident" id="3299010">s</span><span class="op" id="3299011">.</span><span class="ident" id="3299012">src</span><span class="op" id="3299015">[</span><span class="ident" id="3299016">offs</span><span class="op" id="3299020">:</span><span class="ident" id="3299021">s</span><span class="op" id="3299022">.</span><span class="ident" id="3299023">offset</span><span class="op" id="3299029">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299032">if</span>&nbsp;<span class="ident" id="3299035">hasCR</span>&nbsp;<span class="op" id="3299041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299045">lit</span>&nbsp;<span class="op" id="3299049">=</span>&nbsp;<span class="ident" id="3299051">stripCR</span><span class="op" id="3299058">(</span><span class="ident" id="3299059">lit</span><span class="op" id="3299062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3299065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299069">return</span>&nbsp;<span class="builtintype" id="3299076">string</span><span class="op" id="3299082">(</span><span class="ident" id="3299083">lit</span><span class="op" id="3299086">)</span><br>
<span class="lineno"></span><span class="op" id="3299088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3299091">func</span>&nbsp;<span class="op" id="3299096">(</span><span class="ident" id="3299097">s</span>&nbsp;<span class="op" id="3299099">*</span><span class="ident" id="3299100">Scanner</span><span class="op" id="3299107">)</span>&nbsp;<span class="ident" id="3299109">findLineEnd</span><span class="op" id="3299120">(</span><span class="op" id="3299121">)</span>&nbsp;<span class="builtintype" id="3299123">bool</span>&nbsp;<span class="op" id="3299128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3299131">//&nbsp;initial&nbsp;&#39;/&#39;&nbsp;already&nbsp;consumed</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299165">defer</span>&nbsp;<span class="keyword" id="3299171">func</span><span class="op" id="3299175">(</span><span class="ident" id="3299176">offs</span>&nbsp;<span class="builtintype" id="3299181">int</span><span class="op" id="3299184">)</span>&nbsp;<span class="op" id="3299186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3299190">//&nbsp;reset&nbsp;scanner&nbsp;state&nbsp;to&nbsp;where&nbsp;it&nbsp;was&nbsp;upon&nbsp;calling&nbsp;findLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299256">s</span><span class="op" id="3299257">.</span><span class="ident" id="3299258">ch</span>&nbsp;<span class="op" id="3299261">=</span>&nbsp;<span class="string" id="3299263">&#39;/&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299269">s</span><span class="op" id="3299270">.</span><span class="ident" id="3299271">offset</span>&nbsp;<span class="op" id="3299278">=</span>&nbsp;<span class="ident" id="3299280">offs</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299287">s</span><span class="op" id="3299288">.</span><span class="ident" id="3299289">rdOffset</span>&nbsp;<span class="op" id="3299298">=</span>&nbsp;<span class="ident" id="3299300">offs</span>&nbsp;<span class="op" id="3299305">+</span>&nbsp;<span class="num" id="3299307">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299311">s</span><span class="op" id="3299312">.</span><span class="ident" id="3299313">next</span><span class="op" id="3299317">(</span><span class="op" id="3299318">)</span>&nbsp;<span class="comment" id="3299320">//&nbsp;consume&nbsp;initial&nbsp;&#39;/&#39;&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3299350">}</span><span class="op" id="3299351">(</span><span class="ident" id="3299352">s</span><span class="op" id="3299353">.</span><span class="ident" id="3299354">offset</span>&nbsp;<span class="op" id="3299361">-</span>&nbsp;<span class="num" id="3299363">1</span><span class="op" id="3299364">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3299368">//&nbsp;read&nbsp;ahead&nbsp;until&nbsp;a&nbsp;newline,&nbsp;EOF,&nbsp;or&nbsp;non-comment&nbsp;token&nbsp;is&nbsp;found</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299435">for</span>&nbsp;<span class="ident" id="3299439">s</span><span class="op" id="3299440">.</span><span class="ident" id="3299441">ch</span>&nbsp;<span class="op" id="3299444">==</span>&nbsp;<span class="string" id="3299447">&#39;/&#39;</span>&nbsp;<span class="op" id="3299451">||</span>&nbsp;<span class="ident" id="3299454">s</span><span class="op" id="3299455">.</span><span class="ident" id="3299456">ch</span>&nbsp;<span class="op" id="3299459">==</span>&nbsp;<span class="string" id="3299462">&#39;*&#39;</span>&nbsp;<span class="op" id="3299466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299470">if</span>&nbsp;<span class="ident" id="3299473">s</span><span class="op" id="3299474">.</span><span class="ident" id="3299475">ch</span>&nbsp;<span class="op" id="3299478">==</span>&nbsp;<span class="string" id="3299481">&#39;/&#39;</span>&nbsp;<span class="op" id="3299485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3299490">//-style&nbsp;comment&nbsp;always&nbsp;contains&nbsp;a&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299536">return</span>&nbsp;<span class="builtintype" id="3299543">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3299550">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3299554">/*-style&nbsp;comment:&nbsp;look&nbsp;for&nbsp;newline&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299594">s</span><span class="op" id="3299595">.</span><span class="ident" id="3299596">next</span><span class="op" id="3299600">(</span><span class="op" id="3299601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299605">for</span>&nbsp;<span class="ident" id="3299609">s</span><span class="op" id="3299610">.</span><span class="ident" id="3299611">ch</span>&nbsp;<span class="op" id="3299614">&gt;=</span>&nbsp;<span class="num" id="3299617">0</span>&nbsp;<span class="op" id="3299619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299624">ch</span>&nbsp;<span class="op" id="3299627">:=</span>&nbsp;<span class="ident" id="3299630">s</span><span class="op" id="3299631">.</span><span class="ident" id="3299632">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299638">if</span>&nbsp;<span class="ident" id="3299641">ch</span>&nbsp;<span class="op" id="3299644">==</span>&nbsp;<span class="string" id="3299647">&#39;\n&#39;</span>&nbsp;<span class="op" id="3299652">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299658">return</span>&nbsp;<span class="builtintype" id="3299665">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3299673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299678">s</span><span class="op" id="3299679">.</span><span class="ident" id="3299680">next</span><span class="op" id="3299684">(</span><span class="op" id="3299685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299690">if</span>&nbsp;<span class="ident" id="3299693">ch</span>&nbsp;<span class="op" id="3299696">==</span>&nbsp;<span class="string" id="3299699">&#39;*&#39;</span>&nbsp;<span class="op" id="3299703">&amp;&amp;</span>&nbsp;<span class="ident" id="3299706">s</span><span class="op" id="3299707">.</span><span class="ident" id="3299708">ch</span>&nbsp;<span class="op" id="3299711">==</span>&nbsp;<span class="string" id="3299714">&#39;/&#39;</span>&nbsp;<span class="op" id="3299718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299724">s</span><span class="op" id="3299725">.</span><span class="ident" id="3299726">next</span><span class="op" id="3299730">(</span><span class="op" id="3299731">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299737">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3299746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3299750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299754">s</span><span class="op" id="3299755">.</span><span class="ident" id="3299756">skipWhitespace</span><span class="op" id="3299770">(</span><span class="op" id="3299771">)</span>&nbsp;<span class="comment" id="3299773">//&nbsp;s.insertSemi&nbsp;is&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299798">if</span>&nbsp;<span class="ident" id="3299801">s</span><span class="op" id="3299802">.</span><span class="ident" id="3299803">ch</span>&nbsp;<span class="op" id="3299806">&lt;</span>&nbsp;<span class="num" id="3299808">0</span>&nbsp;<span class="op" id="3299810">||</span>&nbsp;<span class="ident" id="3299813">s</span><span class="op" id="3299814">.</span><span class="ident" id="3299815">ch</span>&nbsp;<span class="op" id="3299818">==</span>&nbsp;<span class="string" id="3299821">&#39;\n&#39;</span>&nbsp;<span class="op" id="3299826">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299831">return</span>&nbsp;<span class="builtintype" id="3299838">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3299845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299849">if</span>&nbsp;<span class="ident" id="3299852">s</span><span class="op" id="3299853">.</span><span class="ident" id="3299854">ch</span>&nbsp;<span class="op" id="3299857">!=</span>&nbsp;<span class="string" id="3299860">&#39;/&#39;</span>&nbsp;<span class="op" id="3299864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3299869">//&nbsp;non-comment&nbsp;token</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299893">return</span>&nbsp;<span class="builtintype" id="3299900">false</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3299908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3299912">s</span><span class="op" id="3299913">.</span><span class="ident" id="3299914">next</span><span class="op" id="3299918">(</span><span class="op" id="3299919">)</span>&nbsp;<span class="comment" id="3299921">//&nbsp;consume&nbsp;&#39;/&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3299937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299941">return</span>&nbsp;<span class="builtintype" id="3299948">false</span><br>
<span class="lineno">255</span><span class="op" id="3299954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3299957">func</span>&nbsp;<span class="ident" id="3299962">isLetter</span><span class="op" id="3299970">(</span><span class="ident" id="3299971">ch</span>&nbsp;<span class="builtintype" id="3299974">rune</span><span class="op" id="3299978">)</span>&nbsp;<span class="builtintype" id="3299980">bool</span>&nbsp;<span class="op" id="3299985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3299988">return</span>&nbsp;<span class="string" id="3299995">&#39;a&#39;</span>&nbsp;<span class="op" id="3299999">&lt;=</span>&nbsp;<span class="ident" id="3300002">ch</span>&nbsp;<span class="op" id="3300005">&amp;&amp;</span>&nbsp;<span class="ident" id="3300008">ch</span>&nbsp;<span class="op" id="3300011">&lt;=</span>&nbsp;<span class="string" id="3300014">&#39;z&#39;</span>&nbsp;<span class="op" id="3300018">||</span>&nbsp;<span class="string" id="3300021">&#39;A&#39;</span>&nbsp;<span class="op" id="3300025">&lt;=</span>&nbsp;<span class="ident" id="3300028">ch</span>&nbsp;<span class="op" id="3300031">&amp;&amp;</span>&nbsp;<span class="ident" id="3300034">ch</span>&nbsp;<span class="op" id="3300037">&lt;=</span>&nbsp;<span class="string" id="3300040">&#39;Z&#39;</span>&nbsp;<span class="op" id="3300044">||</span>&nbsp;<span class="ident" id="3300047">ch</span>&nbsp;<span class="op" id="3300050">==</span>&nbsp;<span class="string" id="3300053">&#39;_&#39;</span>&nbsp;<span class="op" id="3300057">||</span>&nbsp;<span class="ident" id="3300060">ch</span>&nbsp;<span class="op" id="3300063">&gt;=</span>&nbsp;<span class="num" id="3300066">0x80</span>&nbsp;<span class="op" id="3300071">&amp;&amp;</span>&nbsp;<span class="ident" id="3300074">unicode</span><span class="op" id="3300081">.</span><span class="ident" id="3300082">IsLetter</span><span class="op" id="3300090">(</span><span class="ident" id="3300091">ch</span><span class="op" id="3300093">)</span><br>
<span class="lineno"></span><span class="op" id="3300095">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="3300098">func</span>&nbsp;<span class="ident" id="3300103">isDigit</span><span class="op" id="3300110">(</span><span class="ident" id="3300111">ch</span>&nbsp;<span class="builtintype" id="3300114">rune</span><span class="op" id="3300118">)</span>&nbsp;<span class="builtintype" id="3300120">bool</span>&nbsp;<span class="op" id="3300125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300128">return</span>&nbsp;<span class="string" id="3300135">&#39;0&#39;</span>&nbsp;<span class="op" id="3300139">&lt;=</span>&nbsp;<span class="ident" id="3300142">ch</span>&nbsp;<span class="op" id="3300145">&amp;&amp;</span>&nbsp;<span class="ident" id="3300148">ch</span>&nbsp;<span class="op" id="3300151">&lt;=</span>&nbsp;<span class="string" id="3300154">&#39;9&#39;</span>&nbsp;<span class="op" id="3300158">||</span>&nbsp;<span class="ident" id="3300161">ch</span>&nbsp;<span class="op" id="3300164">&gt;=</span>&nbsp;<span class="num" id="3300167">0x80</span>&nbsp;<span class="op" id="3300172">&amp;&amp;</span>&nbsp;<span class="ident" id="3300175">unicode</span><span class="op" id="3300182">.</span><span class="ident" id="3300183">IsDigit</span><span class="op" id="3300190">(</span><span class="ident" id="3300191">ch</span><span class="op" id="3300193">)</span><br>
<span class="lineno"></span><span class="op" id="3300195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3300198">func</span>&nbsp;<span class="op" id="3300203">(</span><span class="ident" id="3300204">s</span>&nbsp;<span class="op" id="3300206">*</span><span class="ident" id="3300207">Scanner</span><span class="op" id="3300214">)</span>&nbsp;<span class="ident" id="3300216">scanIdentifier</span><span class="op" id="3300230">(</span><span class="op" id="3300231">)</span>&nbsp;<span class="builtintype" id="3300233">string</span>&nbsp;<span class="op" id="3300240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300243">offs</span>&nbsp;<span class="op" id="3300248">:=</span>&nbsp;<span class="ident" id="3300251">s</span><span class="op" id="3300252">.</span><span class="ident" id="3300253">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300261">for</span>&nbsp;<span class="ident" id="3300265">isLetter</span><span class="op" id="3300273">(</span><span class="ident" id="3300274">s</span><span class="op" id="3300275">.</span><span class="ident" id="3300276">ch</span><span class="op" id="3300278">)</span>&nbsp;<span class="op" id="3300280">||</span>&nbsp;<span class="ident" id="3300283">isDigit</span><span class="op" id="3300290">(</span><span class="ident" id="3300291">s</span><span class="op" id="3300292">.</span><span class="ident" id="3300293">ch</span><span class="op" id="3300295">)</span>&nbsp;<span class="op" id="3300297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300301">s</span><span class="op" id="3300302">.</span><span class="ident" id="3300303">next</span><span class="op" id="3300307">(</span><span class="op" id="3300308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3300311">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300314">return</span>&nbsp;<span class="builtintype" id="3300321">string</span><span class="op" id="3300327">(</span><span class="ident" id="3300328">s</span><span class="op" id="3300329">.</span><span class="ident" id="3300330">src</span><span class="op" id="3300333">[</span><span class="ident" id="3300334">offs</span><span class="op" id="3300338">:</span><span class="ident" id="3300339">s</span><span class="op" id="3300340">.</span><span class="ident" id="3300341">offset</span><span class="op" id="3300347">]</span><span class="op" id="3300348">)</span><br>
<span class="lineno"></span><span class="op" id="3300350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3300353">func</span>&nbsp;<span class="ident" id="3300358">digitVal</span><span class="op" id="3300366">(</span><span class="ident" id="3300367">ch</span>&nbsp;<span class="builtintype" id="3300370">rune</span><span class="op" id="3300374">)</span>&nbsp;<span class="builtintype" id="3300376">int</span>&nbsp;<span class="op" id="3300380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300383">switch</span>&nbsp;<span class="op" id="3300390">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300393">case</span>&nbsp;<span class="string" id="3300398">&#39;0&#39;</span>&nbsp;<span class="op" id="3300402">&lt;=</span>&nbsp;<span class="ident" id="3300405">ch</span>&nbsp;<span class="op" id="3300408">&amp;&amp;</span>&nbsp;<span class="ident" id="3300411">ch</span>&nbsp;<span class="op" id="3300414">&lt;=</span>&nbsp;<span class="string" id="3300417">&#39;9&#39;</span><span class="op" id="3300420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300424">return</span>&nbsp;<span class="builtintype" id="3300431">int</span><span class="op" id="3300434">(</span><span class="ident" id="3300435">ch</span>&nbsp;<span class="op" id="3300438">-</span>&nbsp;<span class="string" id="3300440">&#39;0&#39;</span><span class="op" id="3300443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300446">case</span>&nbsp;<span class="string" id="3300451">&#39;a&#39;</span>&nbsp;<span class="op" id="3300455">&lt;=</span>&nbsp;<span class="ident" id="3300458">ch</span>&nbsp;<span class="op" id="3300461">&amp;&amp;</span>&nbsp;<span class="ident" id="3300464">ch</span>&nbsp;<span class="op" id="3300467">&lt;=</span>&nbsp;<span class="string" id="3300470">&#39;f&#39;</span><span class="op" id="3300473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300477">return</span>&nbsp;<span class="builtintype" id="3300484">int</span><span class="op" id="3300487">(</span><span class="ident" id="3300488">ch</span>&nbsp;<span class="op" id="3300491">-</span>&nbsp;<span class="string" id="3300493">&#39;a&#39;</span>&nbsp;<span class="op" id="3300497">+</span>&nbsp;<span class="num" id="3300499">10</span><span class="op" id="3300501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300504">case</span>&nbsp;<span class="string" id="3300509">&#39;A&#39;</span>&nbsp;<span class="op" id="3300513">&lt;=</span>&nbsp;<span class="ident" id="3300516">ch</span>&nbsp;<span class="op" id="3300519">&amp;&amp;</span>&nbsp;<span class="ident" id="3300522">ch</span>&nbsp;<span class="op" id="3300525">&lt;=</span>&nbsp;<span class="string" id="3300528">&#39;F&#39;</span><span class="op" id="3300531">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300535">return</span>&nbsp;<span class="builtintype" id="3300542">int</span><span class="op" id="3300545">(</span><span class="ident" id="3300546">ch</span>&nbsp;<span class="op" id="3300549">-</span>&nbsp;<span class="string" id="3300551">&#39;A&#39;</span>&nbsp;<span class="op" id="3300555">+</span>&nbsp;<span class="num" id="3300557">10</span><span class="op" id="3300559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3300562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300565">return</span>&nbsp;<span class="num" id="3300572">16</span>&nbsp;<span class="comment" id="3300575">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="3300610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="3300613">func</span>&nbsp;<span class="op" id="3300618">(</span><span class="ident" id="3300619">s</span>&nbsp;<span class="op" id="3300621">*</span><span class="ident" id="3300622">Scanner</span><span class="op" id="3300629">)</span>&nbsp;<span class="ident" id="3300631">scanMantissa</span><span class="op" id="3300643">(</span><span class="ident" id="3300644">base</span>&nbsp;<span class="builtintype" id="3300649">int</span><span class="op" id="3300652">)</span>&nbsp;<span class="op" id="3300654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300657">for</span>&nbsp;<span class="ident" id="3300661">digitVal</span><span class="op" id="3300669">(</span><span class="ident" id="3300670">s</span><span class="op" id="3300671">.</span><span class="ident" id="3300672">ch</span><span class="op" id="3300674">)</span>&nbsp;<span class="op" id="3300676">&lt;</span>&nbsp;<span class="ident" id="3300678">base</span>&nbsp;<span class="op" id="3300683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300687">s</span><span class="op" id="3300688">.</span><span class="ident" id="3300689">next</span><span class="op" id="3300693">(</span><span class="op" id="3300694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3300697">}</span><br>
<span class="lineno"></span><span class="op" id="3300699">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="keyword" id="3300702">func</span>&nbsp;<span class="op" id="3300707">(</span><span class="ident" id="3300708">s</span>&nbsp;<span class="op" id="3300710">*</span><span class="ident" id="3300711">Scanner</span><span class="op" id="3300718">)</span>&nbsp;<span class="ident" id="3300720">scanNumber</span><span class="op" id="3300730">(</span><span class="ident" id="3300731">seenDecimalPoint</span>&nbsp;<span class="builtintype" id="3300748">bool</span><span class="op" id="3300752">)</span>&nbsp;<span class="op" id="3300754">(</span><span class="ident" id="3300755">token</span><span class="op" id="3300760">.</span><span class="ident" id="3300761">Token</span><span class="op" id="3300766">,</span>&nbsp;<span class="builtintype" id="3300768">string</span><span class="op" id="3300774">)</span>&nbsp;<span class="op" id="3300776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3300779">//&nbsp;digitVal(s.ch)&nbsp;&lt;&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300803">offs</span>&nbsp;<span class="op" id="3300808">:=</span>&nbsp;<span class="ident" id="3300811">s</span><span class="op" id="3300812">.</span><span class="ident" id="3300813">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300821">tok</span>&nbsp;<span class="op" id="3300825">:=</span>&nbsp;<span class="ident" id="3300828">token</span><span class="op" id="3300833">.</span><span class="ident" id="3300834">INT</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300840">if</span>&nbsp;<span class="ident" id="3300843">seenDecimalPoint</span>&nbsp;<span class="op" id="3300860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300864">offs</span><span class="op" id="3300868">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300873">tok</span>&nbsp;<span class="op" id="3300877">=</span>&nbsp;<span class="ident" id="3300879">token</span><span class="op" id="3300884">.</span><span class="ident" id="3300885">FLOAT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300893">s</span><span class="op" id="3300894">.</span><span class="ident" id="3300895">scanMantissa</span><span class="op" id="3300907">(</span><span class="num" id="3300908">10</span><span class="op" id="3300910">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300914">goto</span>&nbsp;<span class="ident" id="3300919">exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3300929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3300933">if</span>&nbsp;<span class="ident" id="3300936">s</span><span class="op" id="3300937">.</span><span class="ident" id="3300938">ch</span>&nbsp;<span class="op" id="3300941">==</span>&nbsp;<span class="string" id="3300944">&#39;0&#39;</span>&nbsp;<span class="op" id="3300948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3300952">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300970">offs</span>&nbsp;<span class="op" id="3300975">:=</span>&nbsp;<span class="ident" id="3300978">s</span><span class="op" id="3300979">.</span><span class="ident" id="3300980">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3300989">s</span><span class="op" id="3300990">.</span><span class="ident" id="3300991">next</span><span class="op" id="3300995">(</span><span class="op" id="3300996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301000">if</span>&nbsp;<span class="ident" id="3301003">s</span><span class="op" id="3301004">.</span><span class="ident" id="3301005">ch</span>&nbsp;<span class="op" id="3301008">==</span>&nbsp;<span class="string" id="3301011">&#39;x&#39;</span>&nbsp;<span class="op" id="3301015">||</span>&nbsp;<span class="ident" id="3301018">s</span><span class="op" id="3301019">.</span><span class="ident" id="3301020">ch</span>&nbsp;<span class="op" id="3301023">==</span>&nbsp;<span class="string" id="3301026">&#39;X&#39;</span>&nbsp;<span class="op" id="3301030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301035">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301057">s</span><span class="op" id="3301058">.</span><span class="ident" id="3301059">next</span><span class="op" id="3301063">(</span><span class="op" id="3301064">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301069">s</span><span class="op" id="3301070">.</span><span class="ident" id="3301071">scanMantissa</span><span class="op" id="3301083">(</span><span class="num" id="3301084">16</span><span class="op" id="3301086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301091">if</span>&nbsp;<span class="ident" id="3301094">s</span><span class="op" id="3301095">.</span><span class="ident" id="3301096">offset</span><span class="op" id="3301102">-</span><span class="ident" id="3301103">offs</span>&nbsp;<span class="op" id="3301108">&lt;=</span>&nbsp;<span class="num" id="3301111">2</span>&nbsp;<span class="op" id="3301113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301119">//&nbsp;only&nbsp;scanned&nbsp;&#34;0x&#34;&nbsp;or&nbsp;&#34;0X&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301152">s</span><span class="op" id="3301153">.</span><span class="builtintype" id="3301154">error</span><span class="op" id="3301159">(</span><span class="ident" id="3301160">offs</span><span class="op" id="3301164">,</span>&nbsp;<span class="string" id="3301166">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="3301194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301199">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301203">}</span>&nbsp;<span class="keyword" id="3301205">else</span>&nbsp;<span class="op" id="3301210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301215">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301240">seenDecimalDigit</span>&nbsp;<span class="op" id="3301257">:=</span>&nbsp;<span class="builtintype" id="3301260">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301269">s</span><span class="op" id="3301270">.</span><span class="ident" id="3301271">scanMantissa</span><span class="op" id="3301283">(</span><span class="num" id="3301284">8</span><span class="op" id="3301285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301290">if</span>&nbsp;<span class="ident" id="3301293">s</span><span class="op" id="3301294">.</span><span class="ident" id="3301295">ch</span>&nbsp;<span class="op" id="3301298">==</span>&nbsp;<span class="string" id="3301301">&#39;8&#39;</span>&nbsp;<span class="op" id="3301305">||</span>&nbsp;<span class="ident" id="3301308">s</span><span class="op" id="3301309">.</span><span class="ident" id="3301310">ch</span>&nbsp;<span class="op" id="3301313">==</span>&nbsp;<span class="string" id="3301316">&#39;9&#39;</span>&nbsp;<span class="op" id="3301320">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301326">//&nbsp;illegal&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301360">seenDecimalDigit</span>&nbsp;<span class="op" id="3301377">=</span>&nbsp;<span class="builtintype" id="3301379">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301388">s</span><span class="op" id="3301389">.</span><span class="ident" id="3301390">scanMantissa</span><span class="op" id="3301402">(</span><span class="num" id="3301403">10</span><span class="op" id="3301405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301415">if</span>&nbsp;<span class="ident" id="3301418">s</span><span class="op" id="3301419">.</span><span class="ident" id="3301420">ch</span>&nbsp;<span class="op" id="3301423">==</span>&nbsp;<span class="string" id="3301426">&#39;.&#39;</span>&nbsp;<span class="op" id="3301430">||</span>&nbsp;<span class="ident" id="3301433">s</span><span class="op" id="3301434">.</span><span class="ident" id="3301435">ch</span>&nbsp;<span class="op" id="3301438">==</span>&nbsp;<span class="string" id="3301441">&#39;e&#39;</span>&nbsp;<span class="op" id="3301445">||</span>&nbsp;<span class="ident" id="3301448">s</span><span class="op" id="3301449">.</span><span class="ident" id="3301450">ch</span>&nbsp;<span class="op" id="3301453">==</span>&nbsp;<span class="string" id="3301456">&#39;E&#39;</span>&nbsp;<span class="op" id="3301460">||</span>&nbsp;<span class="ident" id="3301463">s</span><span class="op" id="3301464">.</span><span class="ident" id="3301465">ch</span>&nbsp;<span class="op" id="3301468">==</span>&nbsp;<span class="string" id="3301471">&#39;i&#39;</span>&nbsp;<span class="op" id="3301475">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301481">goto</span>&nbsp;<span class="ident" id="3301486">fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301503">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301519">if</span>&nbsp;<span class="ident" id="3301522">seenDecimalDigit</span>&nbsp;<span class="op" id="3301539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301545">s</span><span class="op" id="3301546">.</span><span class="builtintype" id="3301547">error</span><span class="op" id="3301552">(</span><span class="ident" id="3301553">offs</span><span class="op" id="3301557">,</span>&nbsp;<span class="string" id="3301559">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="3301581">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301594">goto</span>&nbsp;<span class="ident" id="3301599">exit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301609">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301634">s</span><span class="op" id="3301635">.</span><span class="ident" id="3301636">scanMantissa</span><span class="op" id="3301648">(</span><span class="num" id="3301649">10</span><span class="op" id="3301651">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="3301654">fraction</span><span class="op" id="3301662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301665">if</span>&nbsp;<span class="ident" id="3301668">s</span><span class="op" id="3301669">.</span><span class="ident" id="3301670">ch</span>&nbsp;<span class="op" id="3301673">==</span>&nbsp;<span class="string" id="3301676">&#39;.&#39;</span>&nbsp;<span class="op" id="3301680">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301684">tok</span>&nbsp;<span class="op" id="3301688">=</span>&nbsp;<span class="ident" id="3301690">token</span><span class="op" id="3301695">.</span><span class="ident" id="3301696">FLOAT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301704">s</span><span class="op" id="3301705">.</span><span class="ident" id="3301706">next</span><span class="op" id="3301710">(</span><span class="op" id="3301711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301715">s</span><span class="op" id="3301716">.</span><span class="ident" id="3301717">scanMantissa</span><span class="op" id="3301729">(</span><span class="num" id="3301730">10</span><span class="op" id="3301732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="ident" id="3301738">exponent</span><span class="op" id="3301746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301749">if</span>&nbsp;<span class="ident" id="3301752">s</span><span class="op" id="3301753">.</span><span class="ident" id="3301754">ch</span>&nbsp;<span class="op" id="3301757">==</span>&nbsp;<span class="string" id="3301760">&#39;e&#39;</span>&nbsp;<span class="op" id="3301764">||</span>&nbsp;<span class="ident" id="3301767">s</span><span class="op" id="3301768">.</span><span class="ident" id="3301769">ch</span>&nbsp;<span class="op" id="3301772">==</span>&nbsp;<span class="string" id="3301775">&#39;E&#39;</span>&nbsp;<span class="op" id="3301779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301783">tok</span>&nbsp;<span class="op" id="3301787">=</span>&nbsp;<span class="ident" id="3301789">token</span><span class="op" id="3301794">.</span><span class="ident" id="3301795">FLOAT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301803">s</span><span class="op" id="3301804">.</span><span class="ident" id="3301805">next</span><span class="op" id="3301809">(</span><span class="op" id="3301810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301814">if</span>&nbsp;<span class="ident" id="3301817">s</span><span class="op" id="3301818">.</span><span class="ident" id="3301819">ch</span>&nbsp;<span class="op" id="3301822">==</span>&nbsp;<span class="string" id="3301825">&#39;-&#39;</span>&nbsp;<span class="op" id="3301829">||</span>&nbsp;<span class="ident" id="3301832">s</span><span class="op" id="3301833">.</span><span class="ident" id="3301834">ch</span>&nbsp;<span class="op" id="3301837">==</span>&nbsp;<span class="string" id="3301840">&#39;+&#39;</span>&nbsp;<span class="op" id="3301844">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301849">s</span><span class="op" id="3301850">.</span><span class="ident" id="3301851">next</span><span class="op" id="3301855">(</span><span class="op" id="3301856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301864">s</span><span class="op" id="3301865">.</span><span class="ident" id="3301866">scanMantissa</span><span class="op" id="3301878">(</span><span class="num" id="3301879">10</span><span class="op" id="3301881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301888">if</span>&nbsp;<span class="ident" id="3301891">s</span><span class="op" id="3301892">.</span><span class="ident" id="3301893">ch</span>&nbsp;<span class="op" id="3301896">==</span>&nbsp;<span class="string" id="3301899">&#39;i&#39;</span>&nbsp;<span class="op" id="3301903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301907">tok</span>&nbsp;<span class="op" id="3301911">=</span>&nbsp;<span class="ident" id="3301913">token</span><span class="op" id="3301918">.</span><span class="ident" id="3301919">IMAG</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3301926">s</span><span class="op" id="3301927">.</span><span class="ident" id="3301928">next</span><span class="op" id="3301932">(</span><span class="op" id="3301933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3301936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="ident" id="3301939">exit</span><span class="op" id="3301943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3301946">return</span>&nbsp;<span class="ident" id="3301953">tok</span><span class="op" id="3301956">,</span>&nbsp;<span class="builtintype" id="3301958">string</span><span class="op" id="3301964">(</span><span class="ident" id="3301965">s</span><span class="op" id="3301966">.</span><span class="ident" id="3301967">src</span><span class="op" id="3301970">[</span><span class="ident" id="3301971">offs</span><span class="op" id="3301975">:</span><span class="ident" id="3301976">s</span><span class="op" id="3301977">.</span><span class="ident" id="3301978">offset</span><span class="op" id="3301984">]</span><span class="op" id="3301985">)</span><br>
<span class="lineno"></span><span class="op" id="3301987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3301990">//&nbsp;scanEscape&nbsp;parses&nbsp;an&nbsp;escape&nbsp;sequence&nbsp;where&nbsp;rune&nbsp;is&nbsp;the&nbsp;accepted</span><br>
<span class="lineno">365</span><span class="comment" id="3302057">//&nbsp;escaped&nbsp;quote.&nbsp;In&nbsp;case&nbsp;of&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;it&nbsp;stops&nbsp;at&nbsp;the&nbsp;offending</span><br>
<span class="lineno"></span><span class="comment" id="3302128">//&nbsp;character&nbsp;(without&nbsp;consuming&nbsp;it)&nbsp;and&nbsp;returns&nbsp;false.&nbsp;Otherwise</span><br>
<span class="lineno"></span><span class="comment" id="3302193">//&nbsp;it&nbsp;returns&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3302213">func</span>&nbsp;<span class="op" id="3302218">(</span><span class="ident" id="3302219">s</span>&nbsp;<span class="op" id="3302221">*</span><span class="ident" id="3302222">Scanner</span><span class="op" id="3302229">)</span>&nbsp;<span class="ident" id="3302231">scanEscape</span><span class="op" id="3302241">(</span><span class="ident" id="3302242">quote</span>&nbsp;<span class="builtintype" id="3302248">rune</span><span class="op" id="3302252">)</span>&nbsp;<span class="builtintype" id="3302254">bool</span>&nbsp;<span class="op" id="3302259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302262">offs</span>&nbsp;<span class="op" id="3302267">:=</span>&nbsp;<span class="ident" id="3302270">s</span><span class="op" id="3302271">.</span><span class="ident" id="3302272">offset</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302281">var</span>&nbsp;<span class="ident" id="3302285">n</span>&nbsp;<span class="builtintype" id="3302287">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302292">var</span>&nbsp;<span class="ident" id="3302296">base</span><span class="op" id="3302300">,</span>&nbsp;<span class="ident" id="3302302">max</span>&nbsp;<span class="builtintype" id="3302306">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302314">switch</span>&nbsp;<span class="ident" id="3302321">s</span><span class="op" id="3302322">.</span><span class="ident" id="3302323">ch</span>&nbsp;<span class="op" id="3302326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302329">case</span>&nbsp;<span class="string" id="3302334">&#39;a&#39;</span><span class="op" id="3302337">,</span>&nbsp;<span class="string" id="3302339">&#39;b&#39;</span><span class="op" id="3302342">,</span>&nbsp;<span class="string" id="3302344">&#39;f&#39;</span><span class="op" id="3302347">,</span>&nbsp;<span class="string" id="3302349">&#39;n&#39;</span><span class="op" id="3302352">,</span>&nbsp;<span class="string" id="3302354">&#39;r&#39;</span><span class="op" id="3302357">,</span>&nbsp;<span class="string" id="3302359">&#39;t&#39;</span><span class="op" id="3302362">,</span>&nbsp;<span class="string" id="3302364">&#39;v&#39;</span><span class="op" id="3302367">,</span>&nbsp;<span class="string" id="3302369">&#39;\\&#39;</span><span class="op" id="3302373">,</span>&nbsp;<span class="ident" id="3302375">quote</span><span class="op" id="3302380">:</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302384">s</span><span class="op" id="3302385">.</span><span class="ident" id="3302386">next</span><span class="op" id="3302390">(</span><span class="op" id="3302391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302395">return</span>&nbsp;<span class="builtintype" id="3302402">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302408">case</span>&nbsp;<span class="string" id="3302413">&#39;0&#39;</span><span class="op" id="3302416">,</span>&nbsp;<span class="string" id="3302418">&#39;1&#39;</span><span class="op" id="3302421">,</span>&nbsp;<span class="string" id="3302423">&#39;2&#39;</span><span class="op" id="3302426">,</span>&nbsp;<span class="string" id="3302428">&#39;3&#39;</span><span class="op" id="3302431">,</span>&nbsp;<span class="string" id="3302433">&#39;4&#39;</span><span class="op" id="3302436">,</span>&nbsp;<span class="string" id="3302438">&#39;5&#39;</span><span class="op" id="3302441">,</span>&nbsp;<span class="string" id="3302443">&#39;6&#39;</span><span class="op" id="3302446">,</span>&nbsp;<span class="string" id="3302448">&#39;7&#39;</span><span class="op" id="3302451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302455">n</span><span class="op" id="3302456">,</span>&nbsp;<span class="ident" id="3302458">base</span><span class="op" id="3302462">,</span>&nbsp;<span class="ident" id="3302464">max</span>&nbsp;<span class="op" id="3302468">=</span>&nbsp;<span class="num" id="3302470">3</span><span class="op" id="3302471">,</span>&nbsp;<span class="num" id="3302473">8</span><span class="op" id="3302474">,</span>&nbsp;<span class="num" id="3302476">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302481">case</span>&nbsp;<span class="string" id="3302486">&#39;x&#39;</span><span class="op" id="3302489">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302493">s</span><span class="op" id="3302494">.</span><span class="ident" id="3302495">next</span><span class="op" id="3302499">(</span><span class="op" id="3302500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302504">n</span><span class="op" id="3302505">,</span>&nbsp;<span class="ident" id="3302507">base</span><span class="op" id="3302511">,</span>&nbsp;<span class="ident" id="3302513">max</span>&nbsp;<span class="op" id="3302517">=</span>&nbsp;<span class="num" id="3302519">2</span><span class="op" id="3302520">,</span>&nbsp;<span class="num" id="3302522">16</span><span class="op" id="3302524">,</span>&nbsp;<span class="num" id="3302526">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302531">case</span>&nbsp;<span class="string" id="3302536">&#39;u&#39;</span><span class="op" id="3302539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302543">s</span><span class="op" id="3302544">.</span><span class="ident" id="3302545">next</span><span class="op" id="3302549">(</span><span class="op" id="3302550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302554">n</span><span class="op" id="3302555">,</span>&nbsp;<span class="ident" id="3302557">base</span><span class="op" id="3302561">,</span>&nbsp;<span class="ident" id="3302563">max</span>&nbsp;<span class="op" id="3302567">=</span>&nbsp;<span class="num" id="3302569">4</span><span class="op" id="3302570">,</span>&nbsp;<span class="num" id="3302572">16</span><span class="op" id="3302574">,</span>&nbsp;<span class="ident" id="3302576">unicode</span><span class="op" id="3302583">.</span><span class="ident" id="3302584">MaxRune</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302593">case</span>&nbsp;<span class="string" id="3302598">&#39;U&#39;</span><span class="op" id="3302601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302605">s</span><span class="op" id="3302606">.</span><span class="ident" id="3302607">next</span><span class="op" id="3302611">(</span><span class="op" id="3302612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302616">n</span><span class="op" id="3302617">,</span>&nbsp;<span class="ident" id="3302619">base</span><span class="op" id="3302623">,</span>&nbsp;<span class="ident" id="3302625">max</span>&nbsp;<span class="op" id="3302629">=</span>&nbsp;<span class="num" id="3302631">8</span><span class="op" id="3302632">,</span>&nbsp;<span class="num" id="3302634">16</span><span class="op" id="3302636">,</span>&nbsp;<span class="ident" id="3302638">unicode</span><span class="op" id="3302645">.</span><span class="ident" id="3302646">MaxRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302655">default</span><span class="op" id="3302662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302666">msg</span>&nbsp;<span class="op" id="3302670">:=</span>&nbsp;<span class="string" id="3302673">&#34;unknown&nbsp;escape&nbsp;sequence&#34;</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302701">if</span>&nbsp;<span class="ident" id="3302704">s</span><span class="op" id="3302705">.</span><span class="ident" id="3302706">ch</span>&nbsp;<span class="op" id="3302709">&lt;</span>&nbsp;<span class="num" id="3302711">0</span>&nbsp;<span class="op" id="3302713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302718">msg</span>&nbsp;<span class="op" id="3302722">=</span>&nbsp;<span class="string" id="3302724">&#34;escape&nbsp;sequence&nbsp;not&nbsp;terminated&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3302759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302763">s</span><span class="op" id="3302764">.</span><span class="builtintype" id="3302765">error</span><span class="op" id="3302770">(</span><span class="ident" id="3302771">offs</span><span class="op" id="3302775">,</span>&nbsp;<span class="ident" id="3302777">msg</span><span class="op" id="3302780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302784">return</span>&nbsp;<span class="builtintype" id="3302791">false</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3302798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302802">var</span>&nbsp;<span class="ident" id="3302806">x</span>&nbsp;<span class="builtintype" id="3302808">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302816">for</span>&nbsp;<span class="ident" id="3302820">n</span>&nbsp;<span class="op" id="3302822">&gt;</span>&nbsp;<span class="num" id="3302824">0</span>&nbsp;<span class="op" id="3302826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302830">d</span>&nbsp;<span class="op" id="3302832">:=</span>&nbsp;<span class="builtintype" id="3302835">uint32</span><span class="op" id="3302841">(</span><span class="ident" id="3302842">digitVal</span><span class="op" id="3302850">(</span><span class="ident" id="3302851">s</span><span class="op" id="3302852">.</span><span class="ident" id="3302853">ch</span><span class="op" id="3302855">)</span><span class="op" id="3302856">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302860">if</span>&nbsp;<span class="ident" id="3302863">d</span>&nbsp;<span class="op" id="3302865">&gt;=</span>&nbsp;<span class="ident" id="3302868">base</span>&nbsp;<span class="op" id="3302873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302878">msg</span>&nbsp;<span class="op" id="3302882">:=</span>&nbsp;<span class="ident" id="3302885">fmt</span><span class="op" id="3302888">.</span><span class="ident" id="3302889">Sprintf</span><span class="op" id="3302896">(</span><span class="string" id="3302897">&#34;illegal&nbsp;character&nbsp;%#U&nbsp;in&nbsp;escape&nbsp;sequence&#34;</span><span class="op" id="3302939">,</span>&nbsp;<span class="ident" id="3302941">s</span><span class="op" id="3302942">.</span><span class="ident" id="3302943">ch</span><span class="op" id="3302945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3302950">if</span>&nbsp;<span class="ident" id="3302953">s</span><span class="op" id="3302954">.</span><span class="ident" id="3302955">ch</span>&nbsp;<span class="op" id="3302958">&lt;</span>&nbsp;<span class="num" id="3302960">0</span>&nbsp;<span class="op" id="3302962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3302968">msg</span>&nbsp;<span class="op" id="3302972">=</span>&nbsp;<span class="string" id="3302974">&#34;escape&nbsp;sequence&nbsp;not&nbsp;terminated&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303010">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303015">s</span><span class="op" id="3303016">.</span><span class="builtintype" id="3303017">error</span><span class="op" id="3303022">(</span><span class="ident" id="3303023">s</span><span class="op" id="3303024">.</span><span class="ident" id="3303025">offset</span><span class="op" id="3303031">,</span>&nbsp;<span class="ident" id="3303033">msg</span><span class="op" id="3303036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303041">return</span>&nbsp;<span class="builtintype" id="3303048">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303060">x</span>&nbsp;<span class="op" id="3303062">=</span>&nbsp;<span class="ident" id="3303064">x</span><span class="op" id="3303065">*</span><span class="ident" id="3303066">base</span>&nbsp;<span class="op" id="3303071">+</span>&nbsp;<span class="ident" id="3303073">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303077">s</span><span class="op" id="3303078">.</span><span class="ident" id="3303079">next</span><span class="op" id="3303083">(</span><span class="op" id="3303084">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303088">n</span><span class="op" id="3303089">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303097">if</span>&nbsp;<span class="ident" id="3303100">x</span>&nbsp;<span class="op" id="3303102">&gt;</span>&nbsp;<span class="ident" id="3303104">max</span>&nbsp;<span class="op" id="3303108">||</span>&nbsp;<span class="num" id="3303111">0xD800</span>&nbsp;<span class="op" id="3303118">&lt;=</span>&nbsp;<span class="ident" id="3303121">x</span>&nbsp;<span class="op" id="3303123">&amp;&amp;</span>&nbsp;<span class="ident" id="3303126">x</span>&nbsp;<span class="op" id="3303128">&lt;</span>&nbsp;<span class="num" id="3303130">0xE000</span>&nbsp;<span class="op" id="3303137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303141">s</span><span class="op" id="3303142">.</span><span class="builtintype" id="3303143">error</span><span class="op" id="3303148">(</span><span class="ident" id="3303149">offs</span><span class="op" id="3303153">,</span>&nbsp;<span class="string" id="3303155">&#34;escape&nbsp;sequence&nbsp;is&nbsp;invalid&nbsp;Unicode&nbsp;code&nbsp;point&#34;</span><span class="op" id="3303202">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303206">return</span>&nbsp;<span class="builtintype" id="3303213">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303224">return</span>&nbsp;<span class="builtintype" id="3303231">true</span><br>
<span class="lineno"></span><span class="op" id="3303236">}</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="keyword" id="3303239">func</span>&nbsp;<span class="op" id="3303244">(</span><span class="ident" id="3303245">s</span>&nbsp;<span class="op" id="3303247">*</span><span class="ident" id="3303248">Scanner</span><span class="op" id="3303255">)</span>&nbsp;<span class="ident" id="3303257">scanRune</span><span class="op" id="3303265">(</span><span class="op" id="3303266">)</span>&nbsp;<span class="builtintype" id="3303268">string</span>&nbsp;<span class="op" id="3303275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3303278">//&nbsp;&#39;\&#39;&#39;&nbsp;opening&nbsp;already&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303312">offs</span>&nbsp;<span class="op" id="3303317">:=</span>&nbsp;<span class="ident" id="3303320">s</span><span class="op" id="3303321">.</span><span class="ident" id="3303322">offset</span>&nbsp;<span class="op" id="3303329">-</span>&nbsp;<span class="num" id="3303331">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303335">valid</span>&nbsp;<span class="op" id="3303341">:=</span>&nbsp;<span class="builtintype" id="3303344">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303350">n</span>&nbsp;<span class="op" id="3303352">:=</span>&nbsp;<span class="num" id="3303355">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303358">for</span>&nbsp;<span class="op" id="3303362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303366">ch</span>&nbsp;<span class="op" id="3303369">:=</span>&nbsp;<span class="ident" id="3303372">s</span><span class="op" id="3303373">.</span><span class="ident" id="3303374">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303379">if</span>&nbsp;<span class="ident" id="3303382">ch</span>&nbsp;<span class="op" id="3303385">==</span>&nbsp;<span class="string" id="3303388">&#39;\n&#39;</span>&nbsp;<span class="op" id="3303393">||</span>&nbsp;<span class="ident" id="3303396">ch</span>&nbsp;<span class="op" id="3303399">&lt;</span>&nbsp;<span class="num" id="3303401">0</span>&nbsp;<span class="op" id="3303403">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3303408">//&nbsp;only&nbsp;report&nbsp;error&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;one&nbsp;already</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303461">if</span>&nbsp;<span class="ident" id="3303464">valid</span>&nbsp;<span class="op" id="3303470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303476">s</span><span class="op" id="3303477">.</span><span class="builtintype" id="3303478">error</span><span class="op" id="3303483">(</span><span class="ident" id="3303484">offs</span><span class="op" id="3303488">,</span>&nbsp;<span class="string" id="3303490">&#34;rune&nbsp;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="3303519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303525">valid</span>&nbsp;<span class="op" id="3303531">=</span>&nbsp;<span class="builtintype" id="3303533">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303542">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303547">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303559">s</span><span class="op" id="3303560">.</span><span class="ident" id="3303561">next</span><span class="op" id="3303565">(</span><span class="op" id="3303566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303570">if</span>&nbsp;<span class="ident" id="3303573">ch</span>&nbsp;<span class="op" id="3303576">==</span>&nbsp;<span class="string" id="3303579">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="3303584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303589">break</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303601">n</span><span class="op" id="3303602">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303607">if</span>&nbsp;<span class="ident" id="3303610">ch</span>&nbsp;<span class="op" id="3303613">==</span>&nbsp;<span class="string" id="3303616">&#39;\\&#39;</span>&nbsp;<span class="op" id="3303621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303626">if</span>&nbsp;<span class="op" id="3303629">!</span><span class="ident" id="3303630">s</span><span class="op" id="3303631">.</span><span class="ident" id="3303632">scanEscape</span><span class="op" id="3303642">(</span><span class="string" id="3303643">&#39;\&#39;&#39;</span><span class="op" id="3303647">)</span>&nbsp;<span class="op" id="3303649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303655">valid</span>&nbsp;<span class="op" id="3303661">=</span>&nbsp;<span class="builtintype" id="3303663">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3303677">//&nbsp;continue&nbsp;to&nbsp;read&nbsp;to&nbsp;closing&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303723">if</span>&nbsp;<span class="ident" id="3303726">valid</span>&nbsp;<span class="op" id="3303732">&amp;&amp;</span>&nbsp;<span class="ident" id="3303735">n</span>&nbsp;<span class="op" id="3303737">!=</span>&nbsp;<span class="num" id="3303740">1</span>&nbsp;<span class="op" id="3303742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303746">s</span><span class="op" id="3303747">.</span><span class="builtintype" id="3303748">error</span><span class="op" id="3303753">(</span><span class="ident" id="3303754">offs</span><span class="op" id="3303758">,</span>&nbsp;<span class="string" id="3303760">&#34;illegal&nbsp;rune&nbsp;literal&#34;</span><span class="op" id="3303782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303789">return</span>&nbsp;<span class="builtintype" id="3303796">string</span><span class="op" id="3303802">(</span><span class="ident" id="3303803">s</span><span class="op" id="3303804">.</span><span class="ident" id="3303805">src</span><span class="op" id="3303808">[</span><span class="ident" id="3303809">offs</span><span class="op" id="3303813">:</span><span class="ident" id="3303814">s</span><span class="op" id="3303815">.</span><span class="ident" id="3303816">offset</span><span class="op" id="3303822">]</span><span class="op" id="3303823">)</span><br>
<span class="lineno">455</span><span class="op" id="3303825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3303828">func</span>&nbsp;<span class="op" id="3303833">(</span><span class="ident" id="3303834">s</span>&nbsp;<span class="op" id="3303836">*</span><span class="ident" id="3303837">Scanner</span><span class="op" id="3303844">)</span>&nbsp;<span class="ident" id="3303846">scanString</span><span class="op" id="3303856">(</span><span class="op" id="3303857">)</span>&nbsp;<span class="builtintype" id="3303859">string</span>&nbsp;<span class="op" id="3303866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3303869">//&nbsp;&#39;&#34;&#39;&nbsp;opening&nbsp;already&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303902">offs</span>&nbsp;<span class="op" id="3303907">:=</span>&nbsp;<span class="ident" id="3303910">s</span><span class="op" id="3303911">.</span><span class="ident" id="3303912">offset</span>&nbsp;<span class="op" id="3303919">-</span>&nbsp;<span class="num" id="3303921">1</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303925">for</span>&nbsp;<span class="op" id="3303929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303933">ch</span>&nbsp;<span class="op" id="3303936">:=</span>&nbsp;<span class="ident" id="3303939">s</span><span class="op" id="3303940">.</span><span class="ident" id="3303941">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303946">if</span>&nbsp;<span class="ident" id="3303949">ch</span>&nbsp;<span class="op" id="3303952">==</span>&nbsp;<span class="string" id="3303955">&#39;\n&#39;</span>&nbsp;<span class="op" id="3303960">||</span>&nbsp;<span class="ident" id="3303963">ch</span>&nbsp;<span class="op" id="3303966">&lt;</span>&nbsp;<span class="num" id="3303968">0</span>&nbsp;<span class="op" id="3303970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303975">s</span><span class="op" id="3303976">.</span><span class="builtintype" id="3303977">error</span><span class="op" id="3303982">(</span><span class="ident" id="3303983">offs</span><span class="op" id="3303987">,</span>&nbsp;<span class="string" id="3303989">&#34;string&nbsp;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="3304020">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304025">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304037">s</span><span class="op" id="3304038">.</span><span class="ident" id="3304039">next</span><span class="op" id="3304043">(</span><span class="op" id="3304044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304048">if</span>&nbsp;<span class="ident" id="3304051">ch</span>&nbsp;<span class="op" id="3304054">==</span>&nbsp;<span class="string" id="3304057">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3304061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304066">break</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304078">if</span>&nbsp;<span class="ident" id="3304081">ch</span>&nbsp;<span class="op" id="3304084">==</span>&nbsp;<span class="string" id="3304087">&#39;\\&#39;</span>&nbsp;<span class="op" id="3304092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304097">s</span><span class="op" id="3304098">.</span><span class="ident" id="3304099">scanEscape</span><span class="op" id="3304109">(</span><span class="string" id="3304110">&#39;&#34;&#39;</span><span class="op" id="3304113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304120">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304124">return</span>&nbsp;<span class="builtintype" id="3304131">string</span><span class="op" id="3304137">(</span><span class="ident" id="3304138">s</span><span class="op" id="3304139">.</span><span class="ident" id="3304140">src</span><span class="op" id="3304143">[</span><span class="ident" id="3304144">offs</span><span class="op" id="3304148">:</span><span class="ident" id="3304149">s</span><span class="op" id="3304150">.</span><span class="ident" id="3304151">offset</span><span class="op" id="3304157">]</span><span class="op" id="3304158">)</span><br>
<span class="lineno"></span><span class="op" id="3304160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3304163">func</span>&nbsp;<span class="ident" id="3304168">stripCR</span><span class="op" id="3304175">(</span><span class="ident" id="3304176">b</span>&nbsp;<span class="op" id="3304178">[</span><span class="op" id="3304179">]</span><span class="builtintype" id="3304180">byte</span><span class="op" id="3304184">)</span>&nbsp;<span class="op" id="3304186">[</span><span class="op" id="3304187">]</span><span class="builtintype" id="3304188">byte</span>&nbsp;<span class="op" id="3304193">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304196">c</span>&nbsp;<span class="op" id="3304198">:=</span>&nbsp;<span class="builtinfunc" id="3304201">make</span><span class="op" id="3304205">(</span><span class="op" id="3304206">[</span><span class="op" id="3304207">]</span><span class="builtintype" id="3304208">byte</span><span class="op" id="3304212">,</span>&nbsp;<span class="builtinfunc" id="3304214">len</span><span class="op" id="3304217">(</span><span class="ident" id="3304218">b</span><span class="op" id="3304219">)</span><span class="op" id="3304220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304223">i</span>&nbsp;<span class="op" id="3304225">:=</span>&nbsp;<span class="num" id="3304228">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304231">for</span>&nbsp;<span class="ident" id="3304235">_</span><span class="op" id="3304236">,</span>&nbsp;<span class="ident" id="3304238">ch</span>&nbsp;<span class="op" id="3304241">:=</span>&nbsp;<span class="keyword" id="3304244">range</span>&nbsp;<span class="ident" id="3304250">b</span>&nbsp;<span class="op" id="3304252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304256">if</span>&nbsp;<span class="ident" id="3304259">ch</span>&nbsp;<span class="op" id="3304262">!=</span>&nbsp;<span class="string" id="3304265">&#39;\r&#39;</span>&nbsp;<span class="op" id="3304270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304275">c</span><span class="op" id="3304276">[</span><span class="ident" id="3304277">i</span><span class="op" id="3304278">]</span>&nbsp;<span class="op" id="3304280">=</span>&nbsp;<span class="ident" id="3304282">ch</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304288">i</span><span class="op" id="3304289">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304300">return</span>&nbsp;<span class="ident" id="3304307">c</span><span class="op" id="3304308">[</span><span class="op" id="3304309">:</span><span class="ident" id="3304310">i</span><span class="op" id="3304311">]</span><br>
<span class="lineno"></span><span class="op" id="3304313">}</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span><span class="keyword" id="3304316">func</span>&nbsp;<span class="op" id="3304321">(</span><span class="ident" id="3304322">s</span>&nbsp;<span class="op" id="3304324">*</span><span class="ident" id="3304325">Scanner</span><span class="op" id="3304332">)</span>&nbsp;<span class="ident" id="3304334">scanRawString</span><span class="op" id="3304347">(</span><span class="op" id="3304348">)</span>&nbsp;<span class="builtintype" id="3304350">string</span>&nbsp;<span class="op" id="3304357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3304360">//&nbsp;&#39;`&#39;&nbsp;opening&nbsp;already&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304393">offs</span>&nbsp;<span class="op" id="3304398">:=</span>&nbsp;<span class="ident" id="3304401">s</span><span class="op" id="3304402">.</span><span class="ident" id="3304403">offset</span>&nbsp;<span class="op" id="3304410">-</span>&nbsp;<span class="num" id="3304412">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304416">hasCR</span>&nbsp;<span class="op" id="3304422">:=</span>&nbsp;<span class="builtintype" id="3304425">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304432">for</span>&nbsp;<span class="op" id="3304436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304440">ch</span>&nbsp;<span class="op" id="3304443">:=</span>&nbsp;<span class="ident" id="3304446">s</span><span class="op" id="3304447">.</span><span class="ident" id="3304448">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304453">if</span>&nbsp;<span class="ident" id="3304456">ch</span>&nbsp;<span class="op" id="3304459">&lt;</span>&nbsp;<span class="num" id="3304461">0</span>&nbsp;<span class="op" id="3304463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304468">s</span><span class="op" id="3304469">.</span><span class="builtintype" id="3304470">error</span><span class="op" id="3304475">(</span><span class="ident" id="3304476">offs</span><span class="op" id="3304480">,</span>&nbsp;<span class="string" id="3304482">&#34;raw&nbsp;string&nbsp;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="3304517">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304522">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304534">s</span><span class="op" id="3304535">.</span><span class="ident" id="3304536">next</span><span class="op" id="3304540">(</span><span class="op" id="3304541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304545">if</span>&nbsp;<span class="ident" id="3304548">ch</span>&nbsp;<span class="op" id="3304551">==</span>&nbsp;<span class="string" id="3304554">&#39;`&#39;</span>&nbsp;<span class="op" id="3304558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304563">break</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304575">if</span>&nbsp;<span class="ident" id="3304578">ch</span>&nbsp;<span class="op" id="3304581">==</span>&nbsp;<span class="string" id="3304584">&#39;\r&#39;</span>&nbsp;<span class="op" id="3304589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304594">hasCR</span>&nbsp;<span class="op" id="3304600">=</span>&nbsp;<span class="builtintype" id="3304602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304612">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304616">lit</span>&nbsp;<span class="op" id="3304620">:=</span>&nbsp;<span class="ident" id="3304623">s</span><span class="op" id="3304624">.</span><span class="ident" id="3304625">src</span><span class="op" id="3304628">[</span><span class="ident" id="3304629">offs</span><span class="op" id="3304633">:</span><span class="ident" id="3304634">s</span><span class="op" id="3304635">.</span><span class="ident" id="3304636">offset</span><span class="op" id="3304642">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304645">if</span>&nbsp;<span class="ident" id="3304648">hasCR</span>&nbsp;<span class="op" id="3304654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304658">lit</span>&nbsp;<span class="op" id="3304662">=</span>&nbsp;<span class="ident" id="3304664">stripCR</span><span class="op" id="3304671">(</span><span class="ident" id="3304672">lit</span><span class="op" id="3304675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304678">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304682">return</span>&nbsp;<span class="builtintype" id="3304689">string</span><span class="op" id="3304695">(</span><span class="ident" id="3304696">lit</span><span class="op" id="3304699">)</span><br>
<span class="lineno"></span><span class="op" id="3304701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3304704">func</span>&nbsp;<span class="op" id="3304709">(</span><span class="ident" id="3304710">s</span>&nbsp;<span class="op" id="3304712">*</span><span class="ident" id="3304713">Scanner</span><span class="op" id="3304720">)</span>&nbsp;<span class="ident" id="3304722">skipWhitespace</span><span class="op" id="3304736">(</span><span class="op" id="3304737">)</span>&nbsp;<span class="op" id="3304739">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304742">for</span>&nbsp;<span class="ident" id="3304746">s</span><span class="op" id="3304747">.</span><span class="ident" id="3304748">ch</span>&nbsp;<span class="op" id="3304751">==</span>&nbsp;<span class="string" id="3304754">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3304758">||</span>&nbsp;<span class="ident" id="3304761">s</span><span class="op" id="3304762">.</span><span class="ident" id="3304763">ch</span>&nbsp;<span class="op" id="3304766">==</span>&nbsp;<span class="string" id="3304769">&#39;\t&#39;</span>&nbsp;<span class="op" id="3304774">||</span>&nbsp;<span class="ident" id="3304777">s</span><span class="op" id="3304778">.</span><span class="ident" id="3304779">ch</span>&nbsp;<span class="op" id="3304782">==</span>&nbsp;<span class="string" id="3304785">&#39;\n&#39;</span>&nbsp;<span class="op" id="3304790">&amp;&amp;</span>&nbsp;<span class="op" id="3304793">!</span><span class="ident" id="3304794">s</span><span class="op" id="3304795">.</span><span class="ident" id="3304796">insertSemi</span>&nbsp;<span class="op" id="3304807">||</span>&nbsp;<span class="ident" id="3304810">s</span><span class="op" id="3304811">.</span><span class="ident" id="3304812">ch</span>&nbsp;<span class="op" id="3304815">==</span>&nbsp;<span class="string" id="3304818">&#39;\r&#39;</span>&nbsp;<span class="op" id="3304823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304827">s</span><span class="op" id="3304828">.</span><span class="ident" id="3304829">next</span><span class="op" id="3304833">(</span><span class="op" id="3304834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304837">}</span><br>
<span class="lineno"></span><span class="op" id="3304839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="3304842">//&nbsp;Helper&nbsp;functions&nbsp;for&nbsp;scanning&nbsp;multi-byte&nbsp;tokens&nbsp;such&nbsp;as&nbsp;&gt;&gt;&nbsp;+=&nbsp;&gt;&gt;=&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="3304913">//&nbsp;Different&nbsp;routines&nbsp;recognize&nbsp;different&nbsp;length&nbsp;tok_i&nbsp;based&nbsp;on&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="3304985">//&nbsp;of&nbsp;ch_i.&nbsp;If&nbsp;a&nbsp;token&nbsp;ends&nbsp;in&nbsp;&#39;=&#39;,&nbsp;the&nbsp;result&nbsp;is&nbsp;tok1&nbsp;or&nbsp;tok3</span><br>
<span class="lineno"></span><span class="comment" id="3305048">//&nbsp;respectively.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;tok0&nbsp;if&nbsp;there&nbsp;was&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="3305117">//&nbsp;matching&nbsp;character,&nbsp;or&nbsp;tok2&nbsp;if&nbsp;the&nbsp;matching&nbsp;character&nbsp;was&nbsp;ch2.</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="3305184">func</span>&nbsp;<span class="op" id="3305189">(</span><span class="ident" id="3305190">s</span>&nbsp;<span class="op" id="3305192">*</span><span class="ident" id="3305193">Scanner</span><span class="op" id="3305200">)</span>&nbsp;<span class="ident" id="3305202">switch2</span><span class="op" id="3305209">(</span><span class="ident" id="3305210">tok0</span><span class="op" id="3305214">,</span>&nbsp;<span class="ident" id="3305216">tok1</span>&nbsp;<span class="ident" id="3305221">token</span><span class="op" id="3305226">.</span><span class="ident" id="3305227">Token</span><span class="op" id="3305232">)</span>&nbsp;<span class="ident" id="3305234">token</span><span class="op" id="3305239">.</span><span class="ident" id="3305240">Token</span>&nbsp;<span class="op" id="3305246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305249">if</span>&nbsp;<span class="ident" id="3305252">s</span><span class="op" id="3305253">.</span><span class="ident" id="3305254">ch</span>&nbsp;<span class="op" id="3305257">==</span>&nbsp;<span class="string" id="3305260">&#39;=&#39;</span>&nbsp;<span class="op" id="3305264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3305268">s</span><span class="op" id="3305269">.</span><span class="ident" id="3305270">next</span><span class="op" id="3305274">(</span><span class="op" id="3305275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305279">return</span>&nbsp;<span class="ident" id="3305286">tok1</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305295">return</span>&nbsp;<span class="ident" id="3305302">tok0</span><br>
<span class="lineno"></span><span class="op" id="3305307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3305310">func</span>&nbsp;<span class="op" id="3305315">(</span><span class="ident" id="3305316">s</span>&nbsp;<span class="op" id="3305318">*</span><span class="ident" id="3305319">Scanner</span><span class="op" id="3305326">)</span>&nbsp;<span class="ident" id="3305328">switch3</span><span class="op" id="3305335">(</span><span class="ident" id="3305336">tok0</span><span class="op" id="3305340">,</span>&nbsp;<span class="ident" id="3305342">tok1</span>&nbsp;<span class="ident" id="3305347">token</span><span class="op" id="3305352">.</span><span class="ident" id="3305353">Token</span><span class="op" id="3305358">,</span>&nbsp;<span class="ident" id="3305360">ch2</span>&nbsp;<span class="builtintype" id="3305364">rune</span><span class="op" id="3305368">,</span>&nbsp;<span class="ident" id="3305370">tok2</span>&nbsp;<span class="ident" id="3305375">token</span><span class="op" id="3305380">.</span><span class="ident" id="3305381">Token</span><span class="op" id="3305386">)</span>&nbsp;<span class="ident" id="3305388">token</span><span class="op" id="3305393">.</span><span class="ident" id="3305394">Token</span>&nbsp;<span class="op" id="3305400">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305403">if</span>&nbsp;<span class="ident" id="3305406">s</span><span class="op" id="3305407">.</span><span class="ident" id="3305408">ch</span>&nbsp;<span class="op" id="3305411">==</span>&nbsp;<span class="string" id="3305414">&#39;=&#39;</span>&nbsp;<span class="op" id="3305418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3305422">s</span><span class="op" id="3305423">.</span><span class="ident" id="3305424">next</span><span class="op" id="3305428">(</span><span class="op" id="3305429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305433">return</span>&nbsp;<span class="ident" id="3305440">tok1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305449">if</span>&nbsp;<span class="ident" id="3305452">s</span><span class="op" id="3305453">.</span><span class="ident" id="3305454">ch</span>&nbsp;<span class="op" id="3305457">==</span>&nbsp;<span class="ident" id="3305460">ch2</span>&nbsp;<span class="op" id="3305464">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3305468">s</span><span class="op" id="3305469">.</span><span class="ident" id="3305470">next</span><span class="op" id="3305474">(</span><span class="op" id="3305475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305479">return</span>&nbsp;<span class="ident" id="3305486">tok2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305495">return</span>&nbsp;<span class="ident" id="3305502">tok0</span><br>
<span class="lineno"></span><span class="op" id="3305507">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="keyword" id="3305510">func</span>&nbsp;<span class="op" id="3305515">(</span><span class="ident" id="3305516">s</span>&nbsp;<span class="op" id="3305518">*</span><span class="ident" id="3305519">Scanner</span><span class="op" id="3305526">)</span>&nbsp;<span class="ident" id="3305528">switch4</span><span class="op" id="3305535">(</span><span class="ident" id="3305536">tok0</span><span class="op" id="3305540">,</span>&nbsp;<span class="ident" id="3305542">tok1</span>&nbsp;<span class="ident" id="3305547">token</span><span class="op" id="3305552">.</span><span class="ident" id="3305553">Token</span><span class="op" id="3305558">,</span>&nbsp;<span class="ident" id="3305560">ch2</span>&nbsp;<span class="builtintype" id="3305564">rune</span><span class="op" id="3305568">,</span>&nbsp;<span class="ident" id="3305570">tok2</span><span class="op" id="3305574">,</span>&nbsp;<span class="ident" id="3305576">tok3</span>&nbsp;<span class="ident" id="3305581">token</span><span class="op" id="3305586">.</span><span class="ident" id="3305587">Token</span><span class="op" id="3305592">)</span>&nbsp;<span class="ident" id="3305594">token</span><span class="op" id="3305599">.</span><span class="ident" id="3305600">Token</span>&nbsp;<span class="op" id="3305606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305609">if</span>&nbsp;<span class="ident" id="3305612">s</span><span class="op" id="3305613">.</span><span class="ident" id="3305614">ch</span>&nbsp;<span class="op" id="3305617">==</span>&nbsp;<span class="string" id="3305620">&#39;=&#39;</span>&nbsp;<span class="op" id="3305624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3305628">s</span><span class="op" id="3305629">.</span><span class="ident" id="3305630">next</span><span class="op" id="3305634">(</span><span class="op" id="3305635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305639">return</span>&nbsp;<span class="ident" id="3305646">tok1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305655">if</span>&nbsp;<span class="ident" id="3305658">s</span><span class="op" id="3305659">.</span><span class="ident" id="3305660">ch</span>&nbsp;<span class="op" id="3305663">==</span>&nbsp;<span class="ident" id="3305666">ch2</span>&nbsp;<span class="op" id="3305670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3305674">s</span><span class="op" id="3305675">.</span><span class="ident" id="3305676">next</span><span class="op" id="3305680">(</span><span class="op" id="3305681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305685">if</span>&nbsp;<span class="ident" id="3305688">s</span><span class="op" id="3305689">.</span><span class="ident" id="3305690">ch</span>&nbsp;<span class="op" id="3305693">==</span>&nbsp;<span class="string" id="3305696">&#39;=&#39;</span>&nbsp;<span class="op" id="3305700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3305705">s</span><span class="op" id="3305706">.</span><span class="ident" id="3305707">next</span><span class="op" id="3305711">(</span><span class="op" id="3305712">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305717">return</span>&nbsp;<span class="ident" id="3305724">tok3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305735">return</span>&nbsp;<span class="ident" id="3305742">tok2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305751">return</span>&nbsp;<span class="ident" id="3305758">tok0</span><br>
<span class="lineno">565</span><span class="op" id="3305763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3305766">//&nbsp;Scan&nbsp;scans&nbsp;the&nbsp;next&nbsp;token&nbsp;and&nbsp;returns&nbsp;the&nbsp;token&nbsp;position,&nbsp;the&nbsp;token,</span><br>
<span class="lineno"></span><span class="comment" id="3305838">//&nbsp;and&nbsp;its&nbsp;literal&nbsp;string&nbsp;if&nbsp;applicable.&nbsp;The&nbsp;source&nbsp;end&nbsp;is&nbsp;indicated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3305910">//&nbsp;token.EOF.</span><br>
<span class="lineno">570</span><span class="comment" id="3305924">//</span><br>
<span class="lineno"></span><span class="comment" id="3305927">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;a&nbsp;literal&nbsp;(token.IDENT,&nbsp;token.INT,&nbsp;token.FLOAT,</span><br>
<span class="lineno"></span><span class="comment" id="3306003">//&nbsp;token.IMAG,&nbsp;token.CHAR,&nbsp;token.STRING)&nbsp;or&nbsp;token.COMMENT,&nbsp;the&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="3306081">//&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3306113">//</span><br>
<span class="lineno">575</span><span class="comment" id="3306116">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;a&nbsp;keyword,&nbsp;the&nbsp;literal&nbsp;string&nbsp;is&nbsp;the&nbsp;keyword.</span><br>
<span class="lineno"></span><span class="comment" id="3306190">//</span><br>
<span class="lineno"></span><span class="comment" id="3306193">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;token.SEMICOLON,&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3306256">//&nbsp;literal&nbsp;string&nbsp;is&nbsp;&#34;;&#34;&nbsp;if&nbsp;the&nbsp;semicolon&nbsp;was&nbsp;present&nbsp;in&nbsp;the&nbsp;source,</span><br>
<span class="lineno"></span><span class="comment" id="3306325">//&nbsp;and&nbsp;&#34;\n&#34;&nbsp;if&nbsp;the&nbsp;semicolon&nbsp;was&nbsp;inserted&nbsp;because&nbsp;of&nbsp;a&nbsp;newline&nbsp;or</span><br>
<span class="lineno">580</span><span class="comment" id="3306391">//&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="3306402">//</span><br>
<span class="lineno"></span><span class="comment" id="3306405">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;token.ILLEGAL,&nbsp;the&nbsp;literal&nbsp;string&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3306474">//&nbsp;offending&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3306498">//</span><br>
<span class="lineno">585</span><span class="comment" id="3306501">//&nbsp;In&nbsp;all&nbsp;other&nbsp;cases,&nbsp;Scan&nbsp;returns&nbsp;an&nbsp;empty&nbsp;literal&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="3306562">//</span><br>
<span class="lineno"></span><span class="comment" id="3306565">//&nbsp;For&nbsp;more&nbsp;tolerant&nbsp;parsing,&nbsp;Scan&nbsp;will&nbsp;return&nbsp;a&nbsp;valid&nbsp;token&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3306629">//&nbsp;possible&nbsp;even&nbsp;if&nbsp;a&nbsp;syntax&nbsp;error&nbsp;was&nbsp;encountered.&nbsp;Thus,&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="3306692">//&nbsp;if&nbsp;the&nbsp;resulting&nbsp;token&nbsp;sequence&nbsp;contains&nbsp;no&nbsp;illegal&nbsp;tokens,</span><br>
<span class="lineno">590</span><span class="comment" id="3306755">//&nbsp;a&nbsp;client&nbsp;may&nbsp;not&nbsp;assume&nbsp;that&nbsp;no&nbsp;error&nbsp;occurred.&nbsp;Instead&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3306817">//&nbsp;must&nbsp;check&nbsp;the&nbsp;scanner&#39;s&nbsp;ErrorCount&nbsp;or&nbsp;the&nbsp;number&nbsp;of&nbsp;calls</span><br>
<span class="lineno"></span><span class="comment" id="3306879">//&nbsp;of&nbsp;the&nbsp;error&nbsp;handler,&nbsp;if&nbsp;there&nbsp;was&nbsp;one&nbsp;installed.</span><br>
<span class="lineno"></span><span class="comment" id="3306932">//</span><br>
<span class="lineno"></span><span class="comment" id="3306935">//&nbsp;Scan&nbsp;adds&nbsp;line&nbsp;information&nbsp;to&nbsp;the&nbsp;file&nbsp;added&nbsp;to&nbsp;the&nbsp;file</span><br>
<span class="lineno">595</span><span class="comment" id="3306995">//&nbsp;set&nbsp;with&nbsp;Init.&nbsp;Token&nbsp;positions&nbsp;are&nbsp;relative&nbsp;to&nbsp;that&nbsp;file</span><br>
<span class="lineno"></span><span class="comment" id="3307055">//&nbsp;and&nbsp;thus&nbsp;relative&nbsp;to&nbsp;the&nbsp;file&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="3307093">//</span><br>
<span class="lineno"></span><span class="keyword" id="3307096">func</span>&nbsp;<span class="op" id="3307101">(</span><span class="ident" id="3307102">s</span>&nbsp;<span class="op" id="3307104">*</span><span class="ident" id="3307105">Scanner</span><span class="op" id="3307112">)</span>&nbsp;<span class="ident" id="3307114">Scan</span><span class="op" id="3307118">(</span><span class="op" id="3307119">)</span>&nbsp;<span class="op" id="3307121">(</span><span class="ident" id="3307122">pos</span>&nbsp;<span class="ident" id="3307126">token</span><span class="op" id="3307131">.</span><span class="ident" id="3307132">Pos</span><span class="op" id="3307135">,</span>&nbsp;<span class="ident" id="3307137">tok</span>&nbsp;<span class="ident" id="3307141">token</span><span class="op" id="3307146">.</span><span class="ident" id="3307147">Token</span><span class="op" id="3307152">,</span>&nbsp;<span class="ident" id="3307154">lit</span>&nbsp;<span class="builtintype" id="3307158">string</span><span class="op" id="3307164">)</span>&nbsp;<span class="op" id="3307166">{</span><br>
<span class="lineno"></span><span class="ident" id="3307168">scanAgain</span><span class="op" id="3307177">:</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307180">s</span><span class="op" id="3307181">.</span><span class="ident" id="3307182">skipWhitespace</span><span class="op" id="3307196">(</span><span class="op" id="3307197">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3307201">//&nbsp;current&nbsp;token&nbsp;start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307225">pos</span>&nbsp;<span class="op" id="3307229">=</span>&nbsp;<span class="ident" id="3307231">s</span><span class="op" id="3307232">.</span><span class="ident" id="3307233">file</span><span class="op" id="3307237">.</span><span class="ident" id="3307238">Pos</span><span class="op" id="3307241">(</span><span class="ident" id="3307242">s</span><span class="op" id="3307243">.</span><span class="ident" id="3307244">offset</span><span class="op" id="3307250">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3307254">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307280">insertSemi</span>&nbsp;<span class="op" id="3307291">:=</span>&nbsp;<span class="builtintype" id="3307294">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307301">switch</span>&nbsp;<span class="ident" id="3307308">ch</span>&nbsp;<span class="op" id="3307311">:=</span>&nbsp;<span class="ident" id="3307314">s</span><span class="op" id="3307315">.</span><span class="ident" id="3307316">ch</span><span class="op" id="3307318">;</span>&nbsp;<span class="op" id="3307320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307323">case</span>&nbsp;<span class="ident" id="3307328">isLetter</span><span class="op" id="3307336">(</span><span class="ident" id="3307337">ch</span><span class="op" id="3307339">)</span><span class="op" id="3307340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307344">lit</span>&nbsp;<span class="op" id="3307348">=</span>&nbsp;<span class="ident" id="3307350">s</span><span class="op" id="3307351">.</span><span class="ident" id="3307352">scanIdentifier</span><span class="op" id="3307366">(</span><span class="op" id="3307367">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307371">if</span>&nbsp;<span class="builtinfunc" id="3307374">len</span><span class="op" id="3307377">(</span><span class="ident" id="3307378">lit</span><span class="op" id="3307381">)</span>&nbsp;<span class="op" id="3307383">&gt;</span>&nbsp;<span class="num" id="3307385">1</span>&nbsp;<span class="op" id="3307387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3307392">//&nbsp;keywords&nbsp;are&nbsp;longer&nbsp;than&nbsp;one&nbsp;letter&nbsp;-&nbsp;avoid&nbsp;lookup&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307459">tok</span>&nbsp;<span class="op" id="3307463">=</span>&nbsp;<span class="ident" id="3307465">token</span><span class="op" id="3307470">.</span><span class="ident" id="3307471">Lookup</span><span class="op" id="3307477">(</span><span class="ident" id="3307478">lit</span><span class="op" id="3307481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307486">switch</span>&nbsp;<span class="ident" id="3307493">tok</span>&nbsp;<span class="op" id="3307497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307502">case</span>&nbsp;<span class="ident" id="3307507">token</span><span class="op" id="3307512">.</span><span class="ident" id="3307513">IDENT</span><span class="op" id="3307518">,</span>&nbsp;<span class="ident" id="3307520">token</span><span class="op" id="3307525">.</span><span class="ident" id="3307526">BREAK</span><span class="op" id="3307531">,</span>&nbsp;<span class="ident" id="3307533">token</span><span class="op" id="3307538">.</span><span class="ident" id="3307539">CONTINUE</span><span class="op" id="3307547">,</span>&nbsp;<span class="ident" id="3307549">token</span><span class="op" id="3307554">.</span><span class="ident" id="3307555">FALLTHROUGH</span><span class="op" id="3307566">,</span>&nbsp;<span class="ident" id="3307568">token</span><span class="op" id="3307573">.</span><span class="ident" id="3307574">RETURN</span><span class="op" id="3307580">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307586">insertSemi</span>&nbsp;<span class="op" id="3307597">=</span>&nbsp;<span class="builtintype" id="3307599">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3307607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3307611">}</span>&nbsp;<span class="keyword" id="3307613">else</span>&nbsp;<span class="op" id="3307618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307623">insertSemi</span>&nbsp;<span class="op" id="3307634">=</span>&nbsp;<span class="builtintype" id="3307636">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307644">tok</span>&nbsp;<span class="op" id="3307648">=</span>&nbsp;<span class="ident" id="3307650">token</span><span class="op" id="3307655">.</span><span class="ident" id="3307656">IDENT</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3307664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307667">case</span>&nbsp;<span class="string" id="3307672">&#39;0&#39;</span>&nbsp;<span class="op" id="3307676">&lt;=</span>&nbsp;<span class="ident" id="3307679">ch</span>&nbsp;<span class="op" id="3307682">&amp;&amp;</span>&nbsp;<span class="ident" id="3307685">ch</span>&nbsp;<span class="op" id="3307688">&lt;=</span>&nbsp;<span class="string" id="3307691">&#39;9&#39;</span><span class="op" id="3307694">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307698">insertSemi</span>&nbsp;<span class="op" id="3307709">=</span>&nbsp;<span class="builtintype" id="3307711">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307718">tok</span><span class="op" id="3307721">,</span>&nbsp;<span class="ident" id="3307723">lit</span>&nbsp;<span class="op" id="3307727">=</span>&nbsp;<span class="ident" id="3307729">s</span><span class="op" id="3307730">.</span><span class="ident" id="3307731">scanNumber</span><span class="op" id="3307741">(</span><span class="builtintype" id="3307742">false</span><span class="op" id="3307747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307750">default</span><span class="op" id="3307757">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307761">s</span><span class="op" id="3307762">.</span><span class="ident" id="3307763">next</span><span class="op" id="3307767">(</span><span class="op" id="3307768">)</span>&nbsp;<span class="comment" id="3307770">//&nbsp;always&nbsp;make&nbsp;progress</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307796">switch</span>&nbsp;<span class="ident" id="3307803">ch</span>&nbsp;<span class="op" id="3307806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307810">case</span>&nbsp;<span class="op" id="3307815">-</span><span class="num" id="3307816">1</span><span class="op" id="3307817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307822">if</span>&nbsp;<span class="ident" id="3307825">s</span><span class="op" id="3307826">.</span><span class="ident" id="3307827">insertSemi</span>&nbsp;<span class="op" id="3307838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307844">s</span><span class="op" id="3307845">.</span><span class="ident" id="3307846">insertSemi</span>&nbsp;<span class="op" id="3307857">=</span>&nbsp;<span class="builtintype" id="3307859">false</span>&nbsp;<span class="comment" id="3307865">//&nbsp;EOF&nbsp;consumed</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307885">return</span>&nbsp;<span class="ident" id="3307892">pos</span><span class="op" id="3307895">,</span>&nbsp;<span class="ident" id="3307897">token</span><span class="op" id="3307902">.</span><span class="ident" id="3307903">SEMICOLON</span><span class="op" id="3307912">,</span>&nbsp;<span class="string" id="3307914">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3307922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307927">tok</span>&nbsp;<span class="op" id="3307931">=</span>&nbsp;<span class="ident" id="3307933">token</span><span class="op" id="3307938">.</span><span class="ident" id="3307939">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307945">case</span>&nbsp;<span class="string" id="3307950">&#39;\n&#39;</span><span class="op" id="3307954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3307959">//&nbsp;we&nbsp;only&nbsp;reach&nbsp;here&nbsp;if&nbsp;s.insertSemi&nbsp;was</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3308004">//&nbsp;set&nbsp;in&nbsp;the&nbsp;first&nbsp;place&nbsp;and&nbsp;exited&nbsp;early</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3308050">//&nbsp;from&nbsp;s.skipWhitespace()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308080">s</span><span class="op" id="3308081">.</span><span class="ident" id="3308082">insertSemi</span>&nbsp;<span class="op" id="3308093">=</span>&nbsp;<span class="builtintype" id="3308095">false</span>&nbsp;<span class="comment" id="3308101">//&nbsp;newline&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308124">return</span>&nbsp;<span class="ident" id="3308131">pos</span><span class="op" id="3308134">,</span>&nbsp;<span class="ident" id="3308136">token</span><span class="op" id="3308141">.</span><span class="ident" id="3308142">SEMICOLON</span><span class="op" id="3308151">,</span>&nbsp;<span class="string" id="3308153">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308160">case</span>&nbsp;<span class="string" id="3308165">&#39;&#34;&#39;</span><span class="op" id="3308168">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308173">insertSemi</span>&nbsp;<span class="op" id="3308184">=</span>&nbsp;<span class="builtintype" id="3308186">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308194">tok</span>&nbsp;<span class="op" id="3308198">=</span>&nbsp;<span class="ident" id="3308200">token</span><span class="op" id="3308205">.</span><span class="ident" id="3308206">STRING</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308216">lit</span>&nbsp;<span class="op" id="3308220">=</span>&nbsp;<span class="ident" id="3308222">s</span><span class="op" id="3308223">.</span><span class="ident" id="3308224">scanString</span><span class="op" id="3308234">(</span><span class="op" id="3308235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308239">case</span>&nbsp;<span class="string" id="3308244">&#39;\&#39;&#39;</span><span class="op" id="3308248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308253">insertSemi</span>&nbsp;<span class="op" id="3308264">=</span>&nbsp;<span class="builtintype" id="3308266">true</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308274">tok</span>&nbsp;<span class="op" id="3308278">=</span>&nbsp;<span class="ident" id="3308280">token</span><span class="op" id="3308285">.</span><span class="ident" id="3308286">CHAR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308294">lit</span>&nbsp;<span class="op" id="3308298">=</span>&nbsp;<span class="ident" id="3308300">s</span><span class="op" id="3308301">.</span><span class="ident" id="3308302">scanRune</span><span class="op" id="3308310">(</span><span class="op" id="3308311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308315">case</span>&nbsp;<span class="string" id="3308320">&#39;`&#39;</span><span class="op" id="3308323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308328">insertSemi</span>&nbsp;<span class="op" id="3308339">=</span>&nbsp;<span class="builtintype" id="3308341">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308349">tok</span>&nbsp;<span class="op" id="3308353">=</span>&nbsp;<span class="ident" id="3308355">token</span><span class="op" id="3308360">.</span><span class="ident" id="3308361">STRING</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308371">lit</span>&nbsp;<span class="op" id="3308375">=</span>&nbsp;<span class="ident" id="3308377">s</span><span class="op" id="3308378">.</span><span class="ident" id="3308379">scanRawString</span><span class="op" id="3308392">(</span><span class="op" id="3308393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308397">case</span>&nbsp;<span class="string" id="3308402">&#39;:&#39;</span><span class="op" id="3308405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308410">tok</span>&nbsp;<span class="op" id="3308414">=</span>&nbsp;<span class="ident" id="3308416">s</span><span class="op" id="3308417">.</span><span class="ident" id="3308418">switch2</span><span class="op" id="3308425">(</span><span class="ident" id="3308426">token</span><span class="op" id="3308431">.</span><span class="ident" id="3308432">COLON</span><span class="op" id="3308437">,</span>&nbsp;<span class="ident" id="3308439">token</span><span class="op" id="3308444">.</span><span class="ident" id="3308445">DEFINE</span><span class="op" id="3308451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308455">case</span>&nbsp;<span class="string" id="3308460">&#39;.&#39;</span><span class="op" id="3308463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308468">if</span>&nbsp;<span class="string" id="3308471">&#39;0&#39;</span>&nbsp;<span class="op" id="3308475">&lt;=</span>&nbsp;<span class="ident" id="3308478">s</span><span class="op" id="3308479">.</span><span class="ident" id="3308480">ch</span>&nbsp;<span class="op" id="3308483">&amp;&amp;</span>&nbsp;<span class="ident" id="3308486">s</span><span class="op" id="3308487">.</span><span class="ident" id="3308488">ch</span>&nbsp;<span class="op" id="3308491">&lt;=</span>&nbsp;<span class="string" id="3308494">&#39;9&#39;</span>&nbsp;<span class="op" id="3308498">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308504">insertSemi</span>&nbsp;<span class="op" id="3308515">=</span>&nbsp;<span class="builtintype" id="3308517">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308526">tok</span><span class="op" id="3308529">,</span>&nbsp;<span class="ident" id="3308531">lit</span>&nbsp;<span class="op" id="3308535">=</span>&nbsp;<span class="ident" id="3308537">s</span><span class="op" id="3308538">.</span><span class="ident" id="3308539">scanNumber</span><span class="op" id="3308549">(</span><span class="builtintype" id="3308550">true</span><span class="op" id="3308554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3308559">}</span>&nbsp;<span class="keyword" id="3308561">else</span>&nbsp;<span class="keyword" id="3308566">if</span>&nbsp;<span class="ident" id="3308569">s</span><span class="op" id="3308570">.</span><span class="ident" id="3308571">ch</span>&nbsp;<span class="op" id="3308574">==</span>&nbsp;<span class="string" id="3308577">&#39;.&#39;</span>&nbsp;<span class="op" id="3308581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308587">s</span><span class="op" id="3308588">.</span><span class="ident" id="3308589">next</span><span class="op" id="3308593">(</span><span class="op" id="3308594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308600">if</span>&nbsp;<span class="ident" id="3308603">s</span><span class="op" id="3308604">.</span><span class="ident" id="3308605">ch</span>&nbsp;<span class="op" id="3308608">==</span>&nbsp;<span class="string" id="3308611">&#39;.&#39;</span>&nbsp;<span class="op" id="3308615">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308622">s</span><span class="op" id="3308623">.</span><span class="ident" id="3308624">next</span><span class="op" id="3308628">(</span><span class="op" id="3308629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308636">tok</span>&nbsp;<span class="op" id="3308640">=</span>&nbsp;<span class="ident" id="3308642">token</span><span class="op" id="3308647">.</span><span class="ident" id="3308648">ELLIPSIS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3308661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3308666">}</span>&nbsp;<span class="keyword" id="3308668">else</span>&nbsp;<span class="op" id="3308673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308679">tok</span>&nbsp;<span class="op" id="3308683">=</span>&nbsp;<span class="ident" id="3308685">token</span><span class="op" id="3308690">.</span><span class="ident" id="3308691">PERIOD</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3308701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308705">case</span>&nbsp;<span class="string" id="3308710">&#39;,&#39;</span><span class="op" id="3308713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308718">tok</span>&nbsp;<span class="op" id="3308722">=</span>&nbsp;<span class="ident" id="3308724">token</span><span class="op" id="3308729">.</span><span class="ident" id="3308730">COMMA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308738">case</span>&nbsp;<span class="string" id="3308743">&#39;;&#39;</span><span class="op" id="3308746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308751">tok</span>&nbsp;<span class="op" id="3308755">=</span>&nbsp;<span class="ident" id="3308757">token</span><span class="op" id="3308762">.</span><span class="ident" id="3308763">SEMICOLON</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308776">lit</span>&nbsp;<span class="op" id="3308780">=</span>&nbsp;<span class="string" id="3308782">&#34;;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308788">case</span>&nbsp;<span class="string" id="3308793">&#39;(&#39;</span><span class="op" id="3308796">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308801">tok</span>&nbsp;<span class="op" id="3308805">=</span>&nbsp;<span class="ident" id="3308807">token</span><span class="op" id="3308812">.</span><span class="ident" id="3308813">LPAREN</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308822">case</span>&nbsp;<span class="string" id="3308827">&#39;)&#39;</span><span class="op" id="3308830">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308835">insertSemi</span>&nbsp;<span class="op" id="3308846">=</span>&nbsp;<span class="builtintype" id="3308848">true</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308856">tok</span>&nbsp;<span class="op" id="3308860">=</span>&nbsp;<span class="ident" id="3308862">token</span><span class="op" id="3308867">.</span><span class="ident" id="3308868">RPAREN</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308877">case</span>&nbsp;<span class="string" id="3308882">&#39;[&#39;</span><span class="op" id="3308885">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308890">tok</span>&nbsp;<span class="op" id="3308894">=</span>&nbsp;<span class="ident" id="3308896">token</span><span class="op" id="3308901">.</span><span class="ident" id="3308902">LBRACK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308911">case</span>&nbsp;<span class="string" id="3308916">&#39;]&#39;</span><span class="op" id="3308919">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308924">insertSemi</span>&nbsp;<span class="op" id="3308935">=</span>&nbsp;<span class="builtintype" id="3308937">true</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308945">tok</span>&nbsp;<span class="op" id="3308949">=</span>&nbsp;<span class="ident" id="3308951">token</span><span class="op" id="3308956">.</span><span class="ident" id="3308957">RBRACK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308966">case</span>&nbsp;<span class="string" id="3308971">&#39;{&#39;</span><span class="op" id="3308974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308979">tok</span>&nbsp;<span class="op" id="3308983">=</span>&nbsp;<span class="ident" id="3308985">token</span><span class="op" id="3308990">.</span><span class="ident" id="3308991">LBRACE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309000">case</span>&nbsp;<span class="string" id="3309005">&#39;}&#39;</span><span class="op" id="3309008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309013">insertSemi</span>&nbsp;<span class="op" id="3309024">=</span>&nbsp;<span class="builtintype" id="3309026">true</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309034">tok</span>&nbsp;<span class="op" id="3309038">=</span>&nbsp;<span class="ident" id="3309040">token</span><span class="op" id="3309045">.</span><span class="ident" id="3309046">RBRACE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309055">case</span>&nbsp;<span class="string" id="3309060">&#39;+&#39;</span><span class="op" id="3309063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309068">tok</span>&nbsp;<span class="op" id="3309072">=</span>&nbsp;<span class="ident" id="3309074">s</span><span class="op" id="3309075">.</span><span class="ident" id="3309076">switch3</span><span class="op" id="3309083">(</span><span class="ident" id="3309084">token</span><span class="op" id="3309089">.</span><span class="ident" id="3309090">ADD</span><span class="op" id="3309093">,</span>&nbsp;<span class="ident" id="3309095">token</span><span class="op" id="3309100">.</span><span class="ident" id="3309101">ADD_ASSIGN</span><span class="op" id="3309111">,</span>&nbsp;<span class="string" id="3309113">&#39;+&#39;</span><span class="op" id="3309116">,</span>&nbsp;<span class="ident" id="3309118">token</span><span class="op" id="3309123">.</span><span class="ident" id="3309124">INC</span><span class="op" id="3309127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309132">if</span>&nbsp;<span class="ident" id="3309135">tok</span>&nbsp;<span class="op" id="3309139">==</span>&nbsp;<span class="ident" id="3309142">token</span><span class="op" id="3309147">.</span><span class="ident" id="3309148">INC</span>&nbsp;<span class="op" id="3309152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309158">insertSemi</span>&nbsp;<span class="op" id="3309169">=</span>&nbsp;<span class="builtintype" id="3309171">true</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3309179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309183">case</span>&nbsp;<span class="string" id="3309188">&#39;-&#39;</span><span class="op" id="3309191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309196">tok</span>&nbsp;<span class="op" id="3309200">=</span>&nbsp;<span class="ident" id="3309202">s</span><span class="op" id="3309203">.</span><span class="ident" id="3309204">switch3</span><span class="op" id="3309211">(</span><span class="ident" id="3309212">token</span><span class="op" id="3309217">.</span><span class="ident" id="3309218">SUB</span><span class="op" id="3309221">,</span>&nbsp;<span class="ident" id="3309223">token</span><span class="op" id="3309228">.</span><span class="ident" id="3309229">SUB_ASSIGN</span><span class="op" id="3309239">,</span>&nbsp;<span class="string" id="3309241">&#39;-&#39;</span><span class="op" id="3309244">,</span>&nbsp;<span class="ident" id="3309246">token</span><span class="op" id="3309251">.</span><span class="ident" id="3309252">DEC</span><span class="op" id="3309255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309260">if</span>&nbsp;<span class="ident" id="3309263">tok</span>&nbsp;<span class="op" id="3309267">==</span>&nbsp;<span class="ident" id="3309270">token</span><span class="op" id="3309275">.</span><span class="ident" id="3309276">DEC</span>&nbsp;<span class="op" id="3309280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309286">insertSemi</span>&nbsp;<span class="op" id="3309297">=</span>&nbsp;<span class="builtintype" id="3309299">true</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3309307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309311">case</span>&nbsp;<span class="string" id="3309316">&#39;*&#39;</span><span class="op" id="3309319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309324">tok</span>&nbsp;<span class="op" id="3309328">=</span>&nbsp;<span class="ident" id="3309330">s</span><span class="op" id="3309331">.</span><span class="ident" id="3309332">switch2</span><span class="op" id="3309339">(</span><span class="ident" id="3309340">token</span><span class="op" id="3309345">.</span><span class="ident" id="3309346">MUL</span><span class="op" id="3309349">,</span>&nbsp;<span class="ident" id="3309351">token</span><span class="op" id="3309356">.</span><span class="ident" id="3309357">MUL_ASSIGN</span><span class="op" id="3309367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309371">case</span>&nbsp;<span class="string" id="3309376">&#39;/&#39;</span><span class="op" id="3309379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309384">if</span>&nbsp;<span class="ident" id="3309387">s</span><span class="op" id="3309388">.</span><span class="ident" id="3309389">ch</span>&nbsp;<span class="op" id="3309392">==</span>&nbsp;<span class="string" id="3309395">&#39;/&#39;</span>&nbsp;<span class="op" id="3309399">||</span>&nbsp;<span class="ident" id="3309402">s</span><span class="op" id="3309403">.</span><span class="ident" id="3309404">ch</span>&nbsp;<span class="op" id="3309407">==</span>&nbsp;<span class="string" id="3309410">&#39;*&#39;</span>&nbsp;<span class="op" id="3309414">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3309420">//&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309435">if</span>&nbsp;<span class="ident" id="3309438">s</span><span class="op" id="3309439">.</span><span class="ident" id="3309440">insertSemi</span>&nbsp;<span class="op" id="3309451">&amp;&amp;</span>&nbsp;<span class="ident" id="3309454">s</span><span class="op" id="3309455">.</span><span class="ident" id="3309456">findLineEnd</span><span class="op" id="3309467">(</span><span class="op" id="3309468">)</span>&nbsp;<span class="op" id="3309470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3309477">//&nbsp;reset&nbsp;position&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309532">s</span><span class="op" id="3309533">.</span><span class="ident" id="3309534">ch</span>&nbsp;<span class="op" id="3309537">=</span>&nbsp;<span class="string" id="3309539">&#39;/&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309548">s</span><span class="op" id="3309549">.</span><span class="ident" id="3309550">offset</span>&nbsp;<span class="op" id="3309557">=</span>&nbsp;<span class="ident" id="3309559">s</span><span class="op" id="3309560">.</span><span class="ident" id="3309561">file</span><span class="op" id="3309565">.</span><span class="ident" id="3309566">Offset</span><span class="op" id="3309572">(</span><span class="ident" id="3309573">pos</span><span class="op" id="3309576">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309583">s</span><span class="op" id="3309584">.</span><span class="ident" id="3309585">rdOffset</span>&nbsp;<span class="op" id="3309594">=</span>&nbsp;<span class="ident" id="3309596">s</span><span class="op" id="3309597">.</span><span class="ident" id="3309598">offset</span>&nbsp;<span class="op" id="3309605">+</span>&nbsp;<span class="num" id="3309607">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309614">s</span><span class="op" id="3309615">.</span><span class="ident" id="3309616">insertSemi</span>&nbsp;<span class="op" id="3309627">=</span>&nbsp;<span class="builtintype" id="3309629">false</span>&nbsp;<span class="comment" id="3309635">//&nbsp;newline&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309660">return</span>&nbsp;<span class="ident" id="3309667">pos</span><span class="op" id="3309670">,</span>&nbsp;<span class="ident" id="3309672">token</span><span class="op" id="3309677">.</span><span class="ident" id="3309678">SEMICOLON</span><span class="op" id="3309687">,</span>&nbsp;<span class="string" id="3309689">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3309698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309704">lit</span>&nbsp;<span class="op" id="3309708">=</span>&nbsp;<span class="ident" id="3309710">s</span><span class="op" id="3309711">.</span><span class="ident" id="3309712">scanComment</span><span class="op" id="3309723">(</span><span class="op" id="3309724">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309730">if</span>&nbsp;<span class="ident" id="3309733">s</span><span class="op" id="3309734">.</span><span class="ident" id="3309735">mode</span><span class="op" id="3309739">&amp;</span><span class="ident" id="3309740">ScanComments</span>&nbsp;<span class="op" id="3309753">==</span>&nbsp;<span class="num" id="3309756">0</span>&nbsp;<span class="op" id="3309758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3309765">//&nbsp;skip&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309786">s</span><span class="op" id="3309787">.</span><span class="ident" id="3309788">insertSemi</span>&nbsp;<span class="op" id="3309799">=</span>&nbsp;<span class="builtintype" id="3309801">false</span>&nbsp;<span class="comment" id="3309807">//&nbsp;newline&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309832">goto</span>&nbsp;<span class="ident" id="3309837">scanAgain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3309851">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309857">tok</span>&nbsp;<span class="op" id="3309861">=</span>&nbsp;<span class="ident" id="3309863">token</span><span class="op" id="3309868">.</span><span class="ident" id="3309869">COMMENT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3309880">}</span>&nbsp;<span class="keyword" id="3309882">else</span>&nbsp;<span class="op" id="3309887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309893">tok</span>&nbsp;<span class="op" id="3309897">=</span>&nbsp;<span class="ident" id="3309899">s</span><span class="op" id="3309900">.</span><span class="ident" id="3309901">switch2</span><span class="op" id="3309908">(</span><span class="ident" id="3309909">token</span><span class="op" id="3309914">.</span><span class="ident" id="3309915">QUO</span><span class="op" id="3309918">,</span>&nbsp;<span class="ident" id="3309920">token</span><span class="op" id="3309925">.</span><span class="ident" id="3309926">QUO_ASSIGN</span><span class="op" id="3309936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3309941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309945">case</span>&nbsp;<span class="string" id="3309950">&#39;%&#39;</span><span class="op" id="3309953">:</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309958">tok</span>&nbsp;<span class="op" id="3309962">=</span>&nbsp;<span class="ident" id="3309964">s</span><span class="op" id="3309965">.</span><span class="ident" id="3309966">switch2</span><span class="op" id="3309973">(</span><span class="ident" id="3309974">token</span><span class="op" id="3309979">.</span><span class="ident" id="3309980">REM</span><span class="op" id="3309983">,</span>&nbsp;<span class="ident" id="3309985">token</span><span class="op" id="3309990">.</span><span class="ident" id="3309991">REM_ASSIGN</span><span class="op" id="3310001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310005">case</span>&nbsp;<span class="string" id="3310010">&#39;^&#39;</span><span class="op" id="3310013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310018">tok</span>&nbsp;<span class="op" id="3310022">=</span>&nbsp;<span class="ident" id="3310024">s</span><span class="op" id="3310025">.</span><span class="ident" id="3310026">switch2</span><span class="op" id="3310033">(</span><span class="ident" id="3310034">token</span><span class="op" id="3310039">.</span><span class="ident" id="3310040">XOR</span><span class="op" id="3310043">,</span>&nbsp;<span class="ident" id="3310045">token</span><span class="op" id="3310050">.</span><span class="ident" id="3310051">XOR_ASSIGN</span><span class="op" id="3310061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310065">case</span>&nbsp;<span class="string" id="3310070">&#39;&lt;&#39;</span><span class="op" id="3310073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310078">if</span>&nbsp;<span class="ident" id="3310081">s</span><span class="op" id="3310082">.</span><span class="ident" id="3310083">ch</span>&nbsp;<span class="op" id="3310086">==</span>&nbsp;<span class="string" id="3310089">&#39;-&#39;</span>&nbsp;<span class="op" id="3310093">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310099">s</span><span class="op" id="3310100">.</span><span class="ident" id="3310101">next</span><span class="op" id="3310105">(</span><span class="op" id="3310106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310112">tok</span>&nbsp;<span class="op" id="3310116">=</span>&nbsp;<span class="ident" id="3310118">token</span><span class="op" id="3310123">.</span><span class="ident" id="3310124">ARROW</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3310133">}</span>&nbsp;<span class="keyword" id="3310135">else</span>&nbsp;<span class="op" id="3310140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310146">tok</span>&nbsp;<span class="op" id="3310150">=</span>&nbsp;<span class="ident" id="3310152">s</span><span class="op" id="3310153">.</span><span class="ident" id="3310154">switch4</span><span class="op" id="3310161">(</span><span class="ident" id="3310162">token</span><span class="op" id="3310167">.</span><span class="ident" id="3310168">LSS</span><span class="op" id="3310171">,</span>&nbsp;<span class="ident" id="3310173">token</span><span class="op" id="3310178">.</span><span class="ident" id="3310179">LEQ</span><span class="op" id="3310182">,</span>&nbsp;<span class="string" id="3310184">&#39;&lt;&#39;</span><span class="op" id="3310187">,</span>&nbsp;<span class="ident" id="3310189">token</span><span class="op" id="3310194">.</span><span class="ident" id="3310195">SHL</span><span class="op" id="3310198">,</span>&nbsp;<span class="ident" id="3310200">token</span><span class="op" id="3310205">.</span><span class="ident" id="3310206">SHL_ASSIGN</span><span class="op" id="3310216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3310221">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310225">case</span>&nbsp;<span class="string" id="3310230">&#39;&gt;&#39;</span><span class="op" id="3310233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310238">tok</span>&nbsp;<span class="op" id="3310242">=</span>&nbsp;<span class="ident" id="3310244">s</span><span class="op" id="3310245">.</span><span class="ident" id="3310246">switch4</span><span class="op" id="3310253">(</span><span class="ident" id="3310254">token</span><span class="op" id="3310259">.</span><span class="ident" id="3310260">GTR</span><span class="op" id="3310263">,</span>&nbsp;<span class="ident" id="3310265">token</span><span class="op" id="3310270">.</span><span class="ident" id="3310271">GEQ</span><span class="op" id="3310274">,</span>&nbsp;<span class="string" id="3310276">&#39;&gt;&#39;</span><span class="op" id="3310279">,</span>&nbsp;<span class="ident" id="3310281">token</span><span class="op" id="3310286">.</span><span class="ident" id="3310287">SHR</span><span class="op" id="3310290">,</span>&nbsp;<span class="ident" id="3310292">token</span><span class="op" id="3310297">.</span><span class="ident" id="3310298">SHR_ASSIGN</span><span class="op" id="3310308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310312">case</span>&nbsp;<span class="string" id="3310317">&#39;=&#39;</span><span class="op" id="3310320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310325">tok</span>&nbsp;<span class="op" id="3310329">=</span>&nbsp;<span class="ident" id="3310331">s</span><span class="op" id="3310332">.</span><span class="ident" id="3310333">switch2</span><span class="op" id="3310340">(</span><span class="ident" id="3310341">token</span><span class="op" id="3310346">.</span><span class="ident" id="3310347">ASSIGN</span><span class="op" id="3310353">,</span>&nbsp;<span class="ident" id="3310355">token</span><span class="op" id="3310360">.</span><span class="ident" id="3310361">EQL</span><span class="op" id="3310364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310368">case</span>&nbsp;<span class="string" id="3310373">&#39;!&#39;</span><span class="op" id="3310376">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310381">tok</span>&nbsp;<span class="op" id="3310385">=</span>&nbsp;<span class="ident" id="3310387">s</span><span class="op" id="3310388">.</span><span class="ident" id="3310389">switch2</span><span class="op" id="3310396">(</span><span class="ident" id="3310397">token</span><span class="op" id="3310402">.</span><span class="ident" id="3310403">NOT</span><span class="op" id="3310406">,</span>&nbsp;<span class="ident" id="3310408">token</span><span class="op" id="3310413">.</span><span class="ident" id="3310414">NEQ</span><span class="op" id="3310417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310421">case</span>&nbsp;<span class="string" id="3310426">&#39;&amp;&#39;</span><span class="op" id="3310429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310434">if</span>&nbsp;<span class="ident" id="3310437">s</span><span class="op" id="3310438">.</span><span class="ident" id="3310439">ch</span>&nbsp;<span class="op" id="3310442">==</span>&nbsp;<span class="string" id="3310445">&#39;^&#39;</span>&nbsp;<span class="op" id="3310449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310455">s</span><span class="op" id="3310456">.</span><span class="ident" id="3310457">next</span><span class="op" id="3310461">(</span><span class="op" id="3310462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310468">tok</span>&nbsp;<span class="op" id="3310472">=</span>&nbsp;<span class="ident" id="3310474">s</span><span class="op" id="3310475">.</span><span class="ident" id="3310476">switch2</span><span class="op" id="3310483">(</span><span class="ident" id="3310484">token</span><span class="op" id="3310489">.</span><span class="ident" id="3310490">AND_NOT</span><span class="op" id="3310497">,</span>&nbsp;<span class="ident" id="3310499">token</span><span class="op" id="3310504">.</span><span class="ident" id="3310505">AND_NOT_ASSIGN</span><span class="op" id="3310519">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3310524">}</span>&nbsp;<span class="keyword" id="3310526">else</span>&nbsp;<span class="op" id="3310531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310537">tok</span>&nbsp;<span class="op" id="3310541">=</span>&nbsp;<span class="ident" id="3310543">s</span><span class="op" id="3310544">.</span><span class="ident" id="3310545">switch3</span><span class="op" id="3310552">(</span><span class="ident" id="3310553">token</span><span class="op" id="3310558">.</span><span class="ident" id="3310559">AND</span><span class="op" id="3310562">,</span>&nbsp;<span class="ident" id="3310564">token</span><span class="op" id="3310569">.</span><span class="ident" id="3310570">AND_ASSIGN</span><span class="op" id="3310580">,</span>&nbsp;<span class="string" id="3310582">&#39;&amp;&#39;</span><span class="op" id="3310585">,</span>&nbsp;<span class="ident" id="3310587">token</span><span class="op" id="3310592">.</span><span class="ident" id="3310593">LAND</span><span class="op" id="3310597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3310602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310606">case</span>&nbsp;<span class="string" id="3310611">&#39;|&#39;</span><span class="op" id="3310614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310619">tok</span>&nbsp;<span class="op" id="3310623">=</span>&nbsp;<span class="ident" id="3310625">s</span><span class="op" id="3310626">.</span><span class="ident" id="3310627">switch3</span><span class="op" id="3310634">(</span><span class="ident" id="3310635">token</span><span class="op" id="3310640">.</span><span class="ident" id="3310641">OR</span><span class="op" id="3310643">,</span>&nbsp;<span class="ident" id="3310645">token</span><span class="op" id="3310650">.</span><span class="ident" id="3310651">OR_ASSIGN</span><span class="op" id="3310660">,</span>&nbsp;<span class="string" id="3310662">&#39;|&#39;</span><span class="op" id="3310665">,</span>&nbsp;<span class="ident" id="3310667">token</span><span class="op" id="3310672">.</span><span class="ident" id="3310673">LOR</span><span class="op" id="3310676">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310680">default</span><span class="op" id="3310687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3310692">//&nbsp;next&nbsp;reports&nbsp;unexpected&nbsp;BOMs&nbsp;-&nbsp;don&#39;t&nbsp;repeat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310742">if</span>&nbsp;<span class="ident" id="3310745">ch</span>&nbsp;<span class="op" id="3310748">!=</span>&nbsp;<span class="ident" id="3310751">bom</span>&nbsp;<span class="op" id="3310755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310761">s</span><span class="op" id="3310762">.</span><span class="builtintype" id="3310763">error</span><span class="op" id="3310768">(</span><span class="ident" id="3310769">s</span><span class="op" id="3310770">.</span><span class="ident" id="3310771">file</span><span class="op" id="3310775">.</span><span class="ident" id="3310776">Offset</span><span class="op" id="3310782">(</span><span class="ident" id="3310783">pos</span><span class="op" id="3310786">)</span><span class="op" id="3310787">,</span>&nbsp;<span class="ident" id="3310789">fmt</span><span class="op" id="3310792">.</span><span class="ident" id="3310793">Sprintf</span><span class="op" id="3310800">(</span><span class="string" id="3310801">&#34;illegal&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="3310824">,</span>&nbsp;<span class="ident" id="3310826">ch</span><span class="op" id="3310828">)</span><span class="op" id="3310829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3310834">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310839">insertSemi</span>&nbsp;<span class="op" id="3310850">=</span>&nbsp;<span class="ident" id="3310852">s</span><span class="op" id="3310853">.</span><span class="ident" id="3310854">insertSemi</span>&nbsp;<span class="comment" id="3310865">//&nbsp;preserve&nbsp;insertSemi&nbsp;info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310896">tok</span>&nbsp;<span class="op" id="3310900">=</span>&nbsp;<span class="ident" id="3310902">token</span><span class="op" id="3310907">.</span><span class="ident" id="3310908">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310919">lit</span>&nbsp;<span class="op" id="3310923">=</span>&nbsp;<span class="builtintype" id="3310925">string</span><span class="op" id="3310931">(</span><span class="ident" id="3310932">ch</span><span class="op" id="3310934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3310938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3310941">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3310944">if</span>&nbsp;<span class="ident" id="3310947">s</span><span class="op" id="3310948">.</span><span class="ident" id="3310949">mode</span><span class="op" id="3310953">&amp;</span><span class="ident" id="3310954">dontInsertSemis</span>&nbsp;<span class="op" id="3310970">==</span>&nbsp;<span class="num" id="3310973">0</span>&nbsp;<span class="op" id="3310975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310979">s</span><span class="op" id="3310980">.</span><span class="ident" id="3310981">insertSemi</span>&nbsp;<span class="op" id="3310992">=</span>&nbsp;<span class="ident" id="3310994">insertSemi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3311006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3311010">return</span><br>
<span class="lineno">760</span><span class="op" id="3311017">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
