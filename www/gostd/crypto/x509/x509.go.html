<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html" class="current">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4528184">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4528239">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4528293">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4528344">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4528404">package</span>&nbsp;<span class="ident" id="4528412">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4528418">import</span>&nbsp;<span class="op" id="4528425">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528428">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528437">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528447">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528461">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528477">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528496">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528510">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4528525">_</span>&nbsp;<span class="string" id="4528527">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4528544">_</span>&nbsp;<span class="string" id="4528546">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528563">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528583">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528600">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528616">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528626">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528632">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528644">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528651">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4528662">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4528669">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4528672">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4528752">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4528768">type</span>&nbsp;<span class="ident" id="4528773">pkixPublicKey</span>&nbsp;<span class="keyword" id="4528787">struct</span>&nbsp;<span class="op" id="4528794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4528797">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4528807">pkix</span><span class="op" id="4528811">.</span><span class="ident" id="4528812">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4528833">BitString</span>&nbsp;<span class="ident" id="4528843">asn1</span><span class="op" id="4528847">.</span><span class="ident" id="4528848">BitString</span><br>
<span class="lineno"></span><span class="op" id="4528858">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4528861">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4528933">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4528991">func</span>&nbsp;<span class="ident" id="4528996">ParsePKIXPublicKey</span><span class="op" id="4529014">(</span><span class="ident" id="4529015">derBytes</span>&nbsp;<span class="op" id="4529024">[</span><span class="op" id="4529025">]</span><span class="builtintype" id="4529026">byte</span><span class="op" id="4529030">)</span>&nbsp;<span class="op" id="4529032">(</span><span class="ident" id="4529033">pub</span>&nbsp;<span class="keyword" id="4529037">interface</span><span class="op" id="4529046">{</span><span class="op" id="4529047">}</span><span class="op" id="4529048">,</span>&nbsp;<span class="ident" id="4529050">err</span>&nbsp;<span class="builtintype" id="4529054">error</span><span class="op" id="4529059">)</span>&nbsp;<span class="op" id="4529061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4529064">var</span>&nbsp;<span class="ident" id="4529068">pki</span>&nbsp;<span class="ident" id="4529072">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4529087">if</span>&nbsp;<span class="ident" id="4529090">_</span><span class="op" id="4529091">,</span>&nbsp;<span class="ident" id="4529093">err</span>&nbsp;<span class="op" id="4529097">=</span>&nbsp;<span class="ident" id="4529099">asn1</span><span class="op" id="4529103">.</span><span class="ident" id="4529104">Unmarshal</span><span class="op" id="4529113">(</span><span class="ident" id="4529114">derBytes</span><span class="op" id="4529122">,</span>&nbsp;<span class="op" id="4529124">&amp;</span><span class="ident" id="4529125">pki</span><span class="op" id="4529128">)</span><span class="op" id="4529129">;</span>&nbsp;<span class="ident" id="4529131">err</span>&nbsp;<span class="op" id="4529135">!=</span>&nbsp;<span class="builtintype" id="4529138">nil</span>&nbsp;<span class="op" id="4529142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4529146">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4529154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4529157">algo</span>&nbsp;<span class="op" id="4529162">:=</span>&nbsp;<span class="ident" id="4529165">getPublicKeyAlgorithmFromOID</span><span class="op" id="4529193">(</span><span class="ident" id="4529194">pki</span><span class="op" id="4529197">.</span><span class="ident" id="4529198">Algorithm</span><span class="op" id="4529207">.</span><span class="ident" id="4529208">Algorithm</span><span class="op" id="4529217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4529220">if</span>&nbsp;<span class="ident" id="4529223">algo</span>&nbsp;<span class="op" id="4529228">==</span>&nbsp;<span class="ident" id="4529231">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4529257">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4529261">return</span>&nbsp;<span class="builtintype" id="4529268">nil</span><span class="op" id="4529271">,</span>&nbsp;<span class="ident" id="4529273">errors</span><span class="op" id="4529279">.</span><span class="ident" id="4529280">New</span><span class="op" id="4529283">(</span><span class="string" id="4529284">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4529320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4529323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4529326">return</span>&nbsp;<span class="ident" id="4529333">parsePublicKey</span><span class="op" id="4529347">(</span><span class="ident" id="4529348">algo</span><span class="op" id="4529352">,</span>&nbsp;<span class="op" id="4529354">&amp;</span><span class="ident" id="4529355">pki</span><span class="op" id="4529358">)</span><br>
<span class="lineno"></span><span class="op" id="4529360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4529363">func</span>&nbsp;<span class="ident" id="4529368">marshalPublicKey</span><span class="op" id="4529384">(</span><span class="ident" id="4529385">pub</span>&nbsp;<span class="keyword" id="4529389">interface</span><span class="op" id="4529398">{</span><span class="op" id="4529399">}</span><span class="op" id="4529400">)</span>&nbsp;<span class="op" id="4529402">(</span><span class="ident" id="4529403">publicKeyBytes</span>&nbsp;<span class="op" id="4529418">[</span><span class="op" id="4529419">]</span><span class="builtintype" id="4529420">byte</span><span class="op" id="4529424">,</span>&nbsp;<span class="ident" id="4529426">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4529445">pkix</span><span class="op" id="4529449">.</span><span class="ident" id="4529450">AlgorithmIdentifier</span><span class="op" id="4529469">,</span>&nbsp;<span class="ident" id="4529471">err</span>&nbsp;<span class="builtintype" id="4529475">error</span><span class="op" id="4529480">)</span>&nbsp;<span class="op" id="4529482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4529485">switch</span>&nbsp;<span class="ident" id="4529492">pub</span>&nbsp;<span class="op" id="4529496">:=</span>&nbsp;<span class="ident" id="4529499">pub</span><span class="op" id="4529502">.</span><span class="op" id="4529503">(</span><span class="keyword" id="4529504">type</span><span class="op" id="4529508">)</span>&nbsp;<span class="op" id="4529510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4529513">case</span>&nbsp;<span class="op" id="4529518">*</span><span class="ident" id="4529519">rsa</span><span class="op" id="4529522">.</span><span class="ident" id="4529523">PublicKey</span><span class="op" id="4529532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4529536">publicKeyBytes</span><span class="op" id="4529550">,</span>&nbsp;<span class="ident" id="4529552">err</span>&nbsp;<span class="op" id="4529556">=</span>&nbsp;<span class="ident" id="4529558">asn1</span><span class="op" id="4529562">.</span><span class="ident" id="4529563">Marshal</span><span class="op" id="4529570">(</span><span class="ident" id="4529571">rsaPublicKey</span><span class="op" id="4529583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4529588">N</span><span class="op" id="4529589">:</span>&nbsp;<span class="ident" id="4529591">pub</span><span class="op" id="4529594">.</span><span class="ident" id="4529595">N</span><span class="op" id="4529596">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4529601">E</span><span class="op" id="4529602">:</span>&nbsp;<span class="ident" id="4529604">pub</span><span class="op" id="4529607">.</span><span class="ident" id="4529608">E</span><span class="op" id="4529609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4529613">}</span><span class="op" id="4529614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4529618">publicKeyAlgorithm</span><span class="op" id="4529636">.</span><span class="ident" id="4529637">Algorithm</span>&nbsp;<span class="op" id="4529647">=</span>&nbsp;<span class="ident" id="4529649">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4529667">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4529725">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4529783">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4529834">publicKeyAlgorithm</span><span class="op" id="4529852">.</span><span class="ident" id="4529853">Parameters</span>&nbsp;<span class="op" id="4529864">=</span>&nbsp;<span class="ident" id="4529866">asn1</span><span class="op" id="4529870">.</span><span class="ident" id="4529871">RawValue</span><span class="op" id="4529879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4529884">Tag</span><span class="op" id="4529887">:</span>&nbsp;<span class="num" id="4529889">5</span><span class="op" id="4529890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4529894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4529897">case</span>&nbsp;<span class="op" id="4529902">*</span><span class="ident" id="4529903">ecdsa</span><span class="op" id="4529908">.</span><span class="ident" id="4529909">PublicKey</span><span class="op" id="4529918">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4529922">publicKeyBytes</span>&nbsp;<span class="op" id="4529937">=</span>&nbsp;<span class="ident" id="4529939">elliptic</span><span class="op" id="4529947">.</span><span class="ident" id="4529948">Marshal</span><span class="op" id="4529955">(</span><span class="ident" id="4529956">pub</span><span class="op" id="4529959">.</span><span class="ident" id="4529960">Curve</span><span class="op" id="4529965">,</span>&nbsp;<span class="ident" id="4529967">pub</span><span class="op" id="4529970">.</span><span class="ident" id="4529971">X</span><span class="op" id="4529972">,</span>&nbsp;<span class="ident" id="4529974">pub</span><span class="op" id="4529977">.</span><span class="ident" id="4529978">Y</span><span class="op" id="4529979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4529983">oid</span><span class="op" id="4529986">,</span>&nbsp;<span class="ident" id="4529988">ok</span>&nbsp;<span class="op" id="4529991">:=</span>&nbsp;<span class="ident" id="4529994">oidFromNamedCurve</span><span class="op" id="4530011">(</span><span class="ident" id="4530012">pub</span><span class="op" id="4530015">.</span><span class="ident" id="4530016">Curve</span><span class="op" id="4530021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530025">if</span>&nbsp;<span class="op" id="4530028">!</span><span class="ident" id="4530029">ok</span>&nbsp;<span class="op" id="4530032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530037">return</span>&nbsp;<span class="builtintype" id="4530044">nil</span><span class="op" id="4530047">,</span>&nbsp;<span class="ident" id="4530049">pkix</span><span class="op" id="4530053">.</span><span class="ident" id="4530054">AlgorithmIdentifier</span><span class="op" id="4530073">{</span><span class="op" id="4530074">}</span><span class="op" id="4530075">,</span>&nbsp;<span class="ident" id="4530077">errors</span><span class="op" id="4530083">.</span><span class="ident" id="4530084">New</span><span class="op" id="4530087">(</span><span class="string" id="4530088">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4530122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4530126">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530130">publicKeyAlgorithm</span><span class="op" id="4530148">.</span><span class="ident" id="4530149">Algorithm</span>&nbsp;<span class="op" id="4530159">=</span>&nbsp;<span class="ident" id="4530161">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530181">var</span>&nbsp;<span class="ident" id="4530185">paramBytes</span>&nbsp;<span class="op" id="4530196">[</span><span class="op" id="4530197">]</span><span class="builtintype" id="4530198">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530205">paramBytes</span><span class="op" id="4530215">,</span>&nbsp;<span class="ident" id="4530217">err</span>&nbsp;<span class="op" id="4530221">=</span>&nbsp;<span class="ident" id="4530223">asn1</span><span class="op" id="4530227">.</span><span class="ident" id="4530228">Marshal</span><span class="op" id="4530235">(</span><span class="ident" id="4530236">oid</span><span class="op" id="4530239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530243">if</span>&nbsp;<span class="ident" id="4530246">err</span>&nbsp;<span class="op" id="4530250">!=</span>&nbsp;<span class="builtintype" id="4530253">nil</span>&nbsp;<span class="op" id="4530257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530262">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4530271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530275">publicKeyAlgorithm</span><span class="op" id="4530293">.</span><span class="ident" id="4530294">Parameters</span><span class="op" id="4530304">.</span><span class="ident" id="4530305">FullBytes</span>&nbsp;<span class="op" id="4530315">=</span>&nbsp;<span class="ident" id="4530317">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530329">default</span><span class="op" id="4530336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530340">return</span>&nbsp;<span class="builtintype" id="4530347">nil</span><span class="op" id="4530350">,</span>&nbsp;<span class="ident" id="4530352">pkix</span><span class="op" id="4530356">.</span><span class="ident" id="4530357">AlgorithmIdentifier</span><span class="op" id="4530376">{</span><span class="op" id="4530377">}</span><span class="op" id="4530378">,</span>&nbsp;<span class="ident" id="4530380">errors</span><span class="op" id="4530386">.</span><span class="ident" id="4530387">New</span><span class="op" id="4530390">(</span><span class="string" id="4530391">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4530439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4530442">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530446">return</span>&nbsp;<span class="ident" id="4530453">publicKeyBytes</span><span class="op" id="4530467">,</span>&nbsp;<span class="ident" id="4530469">publicKeyAlgorithm</span><span class="op" id="4530487">,</span>&nbsp;<span class="builtintype" id="4530489">nil</span><br>
<span class="lineno"></span><span class="op" id="4530493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4530496">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4530572">func</span>&nbsp;<span class="ident" id="4530577">MarshalPKIXPublicKey</span><span class="op" id="4530597">(</span><span class="ident" id="4530598">pub</span>&nbsp;<span class="keyword" id="4530602">interface</span><span class="op" id="4530611">{</span><span class="op" id="4530612">}</span><span class="op" id="4530613">)</span>&nbsp;<span class="op" id="4530615">(</span><span class="op" id="4530616">[</span><span class="op" id="4530617">]</span><span class="builtintype" id="4530618">byte</span><span class="op" id="4530622">,</span>&nbsp;<span class="builtintype" id="4530624">error</span><span class="op" id="4530629">)</span>&nbsp;<span class="op" id="4530631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530634">var</span>&nbsp;<span class="ident" id="4530638">publicKeyBytes</span>&nbsp;<span class="op" id="4530653">[</span><span class="op" id="4530654">]</span><span class="builtintype" id="4530655">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530661">var</span>&nbsp;<span class="ident" id="4530665">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4530684">pkix</span><span class="op" id="4530688">.</span><span class="ident" id="4530689">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530710">var</span>&nbsp;<span class="ident" id="4530714">err</span>&nbsp;<span class="builtintype" id="4530718">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530726">if</span>&nbsp;<span class="ident" id="4530729">publicKeyBytes</span><span class="op" id="4530743">,</span>&nbsp;<span class="ident" id="4530745">publicKeyAlgorithm</span><span class="op" id="4530763">,</span>&nbsp;<span class="ident" id="4530765">err</span>&nbsp;<span class="op" id="4530769">=</span>&nbsp;<span class="ident" id="4530771">marshalPublicKey</span><span class="op" id="4530787">(</span><span class="ident" id="4530788">pub</span><span class="op" id="4530791">)</span><span class="op" id="4530792">;</span>&nbsp;<span class="ident" id="4530794">err</span>&nbsp;<span class="op" id="4530798">!=</span>&nbsp;<span class="builtintype" id="4530801">nil</span>&nbsp;<span class="op" id="4530805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4530809">return</span>&nbsp;<span class="builtintype" id="4530816">nil</span><span class="op" id="4530819">,</span>&nbsp;<span class="ident" id="4530821">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4530826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530830">pkix</span>&nbsp;<span class="op" id="4530835">:=</span>&nbsp;<span class="ident" id="4530838">pkixPublicKey</span><span class="op" id="4530851">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530855">Algo</span><span class="op" id="4530859">:</span>&nbsp;<span class="ident" id="4530861">publicKeyAlgorithm</span><span class="op" id="4530879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530883">BitString</span><span class="op" id="4530892">:</span>&nbsp;<span class="ident" id="4530894">asn1</span><span class="op" id="4530898">.</span><span class="ident" id="4530899">BitString</span><span class="op" id="4530908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530913">Bytes</span><span class="op" id="4530918">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530924">publicKeyBytes</span><span class="op" id="4530938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530943">BitLength</span><span class="op" id="4530952">:</span>&nbsp;<span class="num" id="4530954">8</span>&nbsp;<span class="op" id="4530956">*</span>&nbsp;<span class="builtinfunc" id="4530958">len</span><span class="op" id="4530961">(</span><span class="ident" id="4530962">publicKeyBytes</span><span class="op" id="4530976">)</span><span class="op" id="4530977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4530981">}</span><span class="op" id="4530982">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4530985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4530989">ret</span><span class="op" id="4530992">,</span>&nbsp;<span class="ident" id="4530994">_</span>&nbsp;<span class="op" id="4530996">:=</span>&nbsp;<span class="ident" id="4530999">asn1</span><span class="op" id="4531003">.</span><span class="ident" id="4531004">Marshal</span><span class="op" id="4531011">(</span><span class="ident" id="4531012">pkix</span><span class="op" id="4531016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4531019">return</span>&nbsp;<span class="ident" id="4531026">ret</span><span class="op" id="4531029">,</span>&nbsp;<span class="builtintype" id="4531031">nil</span><br>
<span class="lineno"></span><span class="op" id="4531035">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4531038">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4531111">type</span>&nbsp;<span class="ident" id="4531116">certificate</span>&nbsp;<span class="keyword" id="4531128">struct</span>&nbsp;<span class="op" id="4531135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531138">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531157">asn1</span><span class="op" id="4531161">.</span><span class="ident" id="4531162">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531174">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531193">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531209">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4531228">pkix</span><span class="op" id="4531232">.</span><span class="ident" id="4531233">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531254">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531273">asn1</span><span class="op" id="4531277">.</span><span class="ident" id="4531278">BitString</span><br>
<span class="lineno"></span><span class="op" id="4531288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4531291">type</span>&nbsp;<span class="ident" id="4531296">tbsCertificate</span>&nbsp;<span class="keyword" id="4531311">struct</span>&nbsp;<span class="op" id="4531318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531321">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531340">asn1</span><span class="op" id="4531344">.</span><span class="ident" id="4531345">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531357">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4531376">int</span>&nbsp;<span class="string" id="4531380">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531424">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4531443">*</span><span class="ident" id="4531444">big</span><span class="op" id="4531447">.</span><span class="ident" id="4531448">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531453">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4531472">pkix</span><span class="op" id="4531476">.</span><span class="ident" id="4531477">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531498">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531517">asn1</span><span class="op" id="4531521">.</span><span class="ident" id="4531522">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531532">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531551">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531561">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531580">asn1</span><span class="op" id="4531584">.</span><span class="ident" id="4531585">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531595">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531614">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531629">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531648">asn1</span><span class="op" id="4531652">.</span><span class="ident" id="4531653">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4531665">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531690">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531709">asn1</span><span class="op" id="4531713">.</span><span class="ident" id="4531714">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4531726">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531751">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4531770">[</span><span class="op" id="4531771">]</span><span class="ident" id="4531772">pkix</span><span class="op" id="4531776">.</span><span class="ident" id="4531777">Extension</span>&nbsp;<span class="string" id="4531787">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4531820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4531823">type</span>&nbsp;<span class="ident" id="4531828">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4531851">struct</span>&nbsp;<span class="op" id="4531858">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531861">P</span><span class="op" id="4531862">,</span>&nbsp;<span class="ident" id="4531864">Q</span><span class="op" id="4531865">,</span>&nbsp;<span class="ident" id="4531867">G</span>&nbsp;<span class="op" id="4531869">*</span><span class="ident" id="4531870">big</span><span class="op" id="4531873">.</span><span class="ident" id="4531874">Int</span><br>
<span class="lineno"></span><span class="op" id="4531878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4531881">type</span>&nbsp;<span class="ident" id="4531886">dsaSignature</span>&nbsp;<span class="keyword" id="4531899">struct</span>&nbsp;<span class="op" id="4531906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531909">R</span><span class="op" id="4531910">,</span>&nbsp;<span class="ident" id="4531912">S</span>&nbsp;<span class="op" id="4531914">*</span><span class="ident" id="4531915">big</span><span class="op" id="4531918">.</span><span class="ident" id="4531919">Int</span><br>
<span class="lineno">135</span><span class="op" id="4531923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4531926">type</span>&nbsp;<span class="ident" id="4531931">ecdsaSignature</span>&nbsp;<span class="ident" id="4531946">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4531960">type</span>&nbsp;<span class="ident" id="4531965">validity</span>&nbsp;<span class="keyword" id="4531974">struct</span>&nbsp;<span class="op" id="4531981">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531984">NotBefore</span><span class="op" id="4531993">,</span>&nbsp;<span class="ident" id="4531995">NotAfter</span>&nbsp;<span class="ident" id="4532004">time</span><span class="op" id="4532008">.</span><span class="ident" id="4532009">Time</span><br>
<span class="lineno"></span><span class="op" id="4532014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4532017">type</span>&nbsp;<span class="ident" id="4532022">publicKeyInfo</span>&nbsp;<span class="keyword" id="4532036">struct</span>&nbsp;<span class="op" id="4532043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532046">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532056">asn1</span><span class="op" id="4532060">.</span><span class="ident" id="4532061">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532073">Algorithm</span>&nbsp;<span class="ident" id="4532083">pkix</span><span class="op" id="4532087">.</span><span class="ident" id="4532088">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532109">PublicKey</span>&nbsp;<span class="ident" id="4532119">asn1</span><span class="op" id="4532123">.</span><span class="ident" id="4532124">BitString</span><br>
<span class="lineno"></span><span class="op" id="4532134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4532137">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4532159">type</span>&nbsp;<span class="ident" id="4532164">authKeyId</span>&nbsp;<span class="keyword" id="4532174">struct</span>&nbsp;<span class="op" id="4532181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532184">Id</span>&nbsp;<span class="op" id="4532187">[</span><span class="op" id="4532188">]</span><span class="builtintype" id="4532189">byte</span>&nbsp;<span class="string" id="4532194">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4532218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4532221">type</span>&nbsp;<span class="ident" id="4532226">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4532245">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4532250">const</span>&nbsp;<span class="op" id="4532256">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532259">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4532285">SignatureAlgorithm</span>&nbsp;<span class="op" id="4532304">=</span>&nbsp;<span class="ident" id="4532306">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532312">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532324">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532336">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532349">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532364">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532379">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532394">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532407">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532422">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532437">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532454">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532471">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4532487">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4532490">type</span>&nbsp;<span class="ident" id="4532495">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4532514">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4532519">const</span>&nbsp;<span class="op" id="4532525">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532528">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4532554">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4532573">=</span>&nbsp;<span class="ident" id="4532575">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532581">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532586">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4532591">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4532597">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4532600">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4532633">//</span><br>
<span class="lineno"></span><span class="comment" id="4532636">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4532670">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4532733">//</span><br>
<span class="lineno"></span><span class="comment" id="4532736">//</span><br>
<span class="lineno"></span><span class="comment" id="4532739">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4532782">//</span><br>
<span class="lineno"></span><span class="comment" id="4532785">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4532844">//</span><br>
<span class="lineno"></span><span class="comment" id="4532847">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4532906">//</span><br>
<span class="lineno"></span><span class="comment" id="4532909">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4532970">//</span><br>
<span class="lineno">195</span><span class="comment" id="4532973">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4533012">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4533073">//</span><br>
<span class="lineno"></span><span class="comment" id="4533076">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4533120">//</span><br>
<span class="lineno">200</span><span class="comment" id="4533123">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4533166">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4533219">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4533259">//</span><br>
<span class="lineno"></span><span class="comment" id="4533262">//</span><br>
<span class="lineno">205</span><span class="comment" id="4533265">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4533299">//</span><br>
<span class="lineno"></span><span class="comment" id="4533302">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4533365">//</span><br>
<span class="lineno"></span><span class="comment" id="4533368">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4533431">//</span><br>
<span class="lineno"></span><span class="comment" id="4533434">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4533497">//</span><br>
<span class="lineno"></span><span class="comment" id="4533500">//</span><br>
<span class="lineno"></span><span class="comment" id="4533503">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4533544">//</span><br>
<span class="lineno"></span><span class="comment" id="4533547">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4533588">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4533658">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4533709">//</span><br>
<span class="lineno">220</span><span class="comment" id="4533712">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4533754">//</span><br>
<span class="lineno"></span><span class="comment" id="4533757">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4533824">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4533893">//</span><br>
<span class="lineno">225</span><span class="comment" id="4533896">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4533963">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4534032">//</span><br>
<span class="lineno"></span><span class="comment" id="4534035">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4534102">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4534172">var</span>&nbsp;<span class="op" id="4534176">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534179">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4534207">=</span>&nbsp;<span class="ident" id="4534209">asn1</span><span class="op" id="4534213">.</span><span class="ident" id="4534214">ObjectIdentifier</span><span class="op" id="4534230">{</span><span class="num" id="4534231">1</span><span class="op" id="4534232">,</span>&nbsp;<span class="num" id="4534234">2</span><span class="op" id="4534235">,</span>&nbsp;<span class="num" id="4534237">840</span><span class="op" id="4534240">,</span>&nbsp;<span class="num" id="4534242">113549</span><span class="op" id="4534248">,</span>&nbsp;<span class="num" id="4534250">1</span><span class="op" id="4534251">,</span>&nbsp;<span class="num" id="4534253">1</span><span class="op" id="4534254">,</span>&nbsp;<span class="num" id="4534256">2</span><span class="op" id="4534257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534260">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4534288">=</span>&nbsp;<span class="ident" id="4534290">asn1</span><span class="op" id="4534294">.</span><span class="ident" id="4534295">ObjectIdentifier</span><span class="op" id="4534311">{</span><span class="num" id="4534312">1</span><span class="op" id="4534313">,</span>&nbsp;<span class="num" id="4534315">2</span><span class="op" id="4534316">,</span>&nbsp;<span class="num" id="4534318">840</span><span class="op" id="4534321">,</span>&nbsp;<span class="num" id="4534323">113549</span><span class="op" id="4534329">,</span>&nbsp;<span class="num" id="4534331">1</span><span class="op" id="4534332">,</span>&nbsp;<span class="num" id="4534334">1</span><span class="op" id="4534335">,</span>&nbsp;<span class="num" id="4534337">4</span><span class="op" id="4534338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534341">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4534369">=</span>&nbsp;<span class="ident" id="4534371">asn1</span><span class="op" id="4534375">.</span><span class="ident" id="4534376">ObjectIdentifier</span><span class="op" id="4534392">{</span><span class="num" id="4534393">1</span><span class="op" id="4534394">,</span>&nbsp;<span class="num" id="4534396">2</span><span class="op" id="4534397">,</span>&nbsp;<span class="num" id="4534399">840</span><span class="op" id="4534402">,</span>&nbsp;<span class="num" id="4534404">113549</span><span class="op" id="4534410">,</span>&nbsp;<span class="num" id="4534412">1</span><span class="op" id="4534413">,</span>&nbsp;<span class="num" id="4534415">1</span><span class="op" id="4534416">,</span>&nbsp;<span class="num" id="4534418">5</span><span class="op" id="4534419">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534422">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4534450">=</span>&nbsp;<span class="ident" id="4534452">asn1</span><span class="op" id="4534456">.</span><span class="ident" id="4534457">ObjectIdentifier</span><span class="op" id="4534473">{</span><span class="num" id="4534474">1</span><span class="op" id="4534475">,</span>&nbsp;<span class="num" id="4534477">2</span><span class="op" id="4534478">,</span>&nbsp;<span class="num" id="4534480">840</span><span class="op" id="4534483">,</span>&nbsp;<span class="num" id="4534485">113549</span><span class="op" id="4534491">,</span>&nbsp;<span class="num" id="4534493">1</span><span class="op" id="4534494">,</span>&nbsp;<span class="num" id="4534496">1</span><span class="op" id="4534497">,</span>&nbsp;<span class="num" id="4534499">11</span><span class="op" id="4534501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534504">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4534532">=</span>&nbsp;<span class="ident" id="4534534">asn1</span><span class="op" id="4534538">.</span><span class="ident" id="4534539">ObjectIdentifier</span><span class="op" id="4534555">{</span><span class="num" id="4534556">1</span><span class="op" id="4534557">,</span>&nbsp;<span class="num" id="4534559">2</span><span class="op" id="4534560">,</span>&nbsp;<span class="num" id="4534562">840</span><span class="op" id="4534565">,</span>&nbsp;<span class="num" id="4534567">113549</span><span class="op" id="4534573">,</span>&nbsp;<span class="num" id="4534575">1</span><span class="op" id="4534576">,</span>&nbsp;<span class="num" id="4534578">1</span><span class="op" id="4534579">,</span>&nbsp;<span class="num" id="4534581">12</span><span class="op" id="4534583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534586">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4534614">=</span>&nbsp;<span class="ident" id="4534616">asn1</span><span class="op" id="4534620">.</span><span class="ident" id="4534621">ObjectIdentifier</span><span class="op" id="4534637">{</span><span class="num" id="4534638">1</span><span class="op" id="4534639">,</span>&nbsp;<span class="num" id="4534641">2</span><span class="op" id="4534642">,</span>&nbsp;<span class="num" id="4534644">840</span><span class="op" id="4534647">,</span>&nbsp;<span class="num" id="4534649">113549</span><span class="op" id="4534655">,</span>&nbsp;<span class="num" id="4534657">1</span><span class="op" id="4534658">,</span>&nbsp;<span class="num" id="4534660">1</span><span class="op" id="4534661">,</span>&nbsp;<span class="num" id="4534663">13</span><span class="op" id="4534665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534668">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4534696">=</span>&nbsp;<span class="ident" id="4534698">asn1</span><span class="op" id="4534702">.</span><span class="ident" id="4534703">ObjectIdentifier</span><span class="op" id="4534719">{</span><span class="num" id="4534720">1</span><span class="op" id="4534721">,</span>&nbsp;<span class="num" id="4534723">2</span><span class="op" id="4534724">,</span>&nbsp;<span class="num" id="4534726">840</span><span class="op" id="4534729">,</span>&nbsp;<span class="num" id="4534731">10040</span><span class="op" id="4534736">,</span>&nbsp;<span class="num" id="4534738">4</span><span class="op" id="4534739">,</span>&nbsp;<span class="num" id="4534741">3</span><span class="op" id="4534742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534745">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4534773">=</span>&nbsp;<span class="ident" id="4534775">asn1</span><span class="op" id="4534779">.</span><span class="ident" id="4534780">ObjectIdentifier</span><span class="op" id="4534796">{</span><span class="num" id="4534797">2</span><span class="op" id="4534798">,</span>&nbsp;<span class="num" id="4534800">16</span><span class="op" id="4534802">,</span>&nbsp;<span class="num" id="4534804">840</span><span class="op" id="4534807">,</span>&nbsp;<span class="num" id="4534809">1</span><span class="op" id="4534810">,</span>&nbsp;<span class="num" id="4534812">101</span><span class="op" id="4534815">,</span>&nbsp;<span class="num" id="4534817">4</span><span class="op" id="4534818">,</span>&nbsp;<span class="num" id="4534820">3</span><span class="op" id="4534821">,</span>&nbsp;<span class="num" id="4534823">2</span><span class="op" id="4534824">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534827">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4534855">=</span>&nbsp;<span class="ident" id="4534857">asn1</span><span class="op" id="4534861">.</span><span class="ident" id="4534862">ObjectIdentifier</span><span class="op" id="4534878">{</span><span class="num" id="4534879">1</span><span class="op" id="4534880">,</span>&nbsp;<span class="num" id="4534882">2</span><span class="op" id="4534883">,</span>&nbsp;<span class="num" id="4534885">840</span><span class="op" id="4534888">,</span>&nbsp;<span class="num" id="4534890">10045</span><span class="op" id="4534895">,</span>&nbsp;<span class="num" id="4534897">4</span><span class="op" id="4534898">,</span>&nbsp;<span class="num" id="4534900">1</span><span class="op" id="4534901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534904">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4534932">=</span>&nbsp;<span class="ident" id="4534934">asn1</span><span class="op" id="4534938">.</span><span class="ident" id="4534939">ObjectIdentifier</span><span class="op" id="4534955">{</span><span class="num" id="4534956">1</span><span class="op" id="4534957">,</span>&nbsp;<span class="num" id="4534959">2</span><span class="op" id="4534960">,</span>&nbsp;<span class="num" id="4534962">840</span><span class="op" id="4534965">,</span>&nbsp;<span class="num" id="4534967">10045</span><span class="op" id="4534972">,</span>&nbsp;<span class="num" id="4534974">4</span><span class="op" id="4534975">,</span>&nbsp;<span class="num" id="4534977">3</span><span class="op" id="4534978">,</span>&nbsp;<span class="num" id="4534980">2</span><span class="op" id="4534981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4534984">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4535012">=</span>&nbsp;<span class="ident" id="4535014">asn1</span><span class="op" id="4535018">.</span><span class="ident" id="4535019">ObjectIdentifier</span><span class="op" id="4535035">{</span><span class="num" id="4535036">1</span><span class="op" id="4535037">,</span>&nbsp;<span class="num" id="4535039">2</span><span class="op" id="4535040">,</span>&nbsp;<span class="num" id="4535042">840</span><span class="op" id="4535045">,</span>&nbsp;<span class="num" id="4535047">10045</span><span class="op" id="4535052">,</span>&nbsp;<span class="num" id="4535054">4</span><span class="op" id="4535055">,</span>&nbsp;<span class="num" id="4535057">3</span><span class="op" id="4535058">,</span>&nbsp;<span class="num" id="4535060">3</span><span class="op" id="4535061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4535064">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4535092">=</span>&nbsp;<span class="ident" id="4535094">asn1</span><span class="op" id="4535098">.</span><span class="ident" id="4535099">ObjectIdentifier</span><span class="op" id="4535115">{</span><span class="num" id="4535116">1</span><span class="op" id="4535117">,</span>&nbsp;<span class="num" id="4535119">2</span><span class="op" id="4535120">,</span>&nbsp;<span class="num" id="4535122">840</span><span class="op" id="4535125">,</span>&nbsp;<span class="num" id="4535127">10045</span><span class="op" id="4535132">,</span>&nbsp;<span class="num" id="4535134">4</span><span class="op" id="4535135">,</span>&nbsp;<span class="num" id="4535137">3</span><span class="op" id="4535138">,</span>&nbsp;<span class="num" id="4535140">4</span><span class="op" id="4535141">}</span><br>
<span class="lineno"></span><span class="op" id="4535143">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4535146">var</span>&nbsp;<span class="ident" id="4535150">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4535176">=</span>&nbsp;<span class="op" id="4535178">[</span><span class="op" id="4535179">]</span><span class="keyword" id="4535180">struct</span>&nbsp;<span class="op" id="4535187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4535190">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4535201">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4535221">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4535232">asn1</span><span class="op" id="4535236">.</span><span class="ident" id="4535237">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4535255">pubKeyAlgo</span>&nbsp;<span class="ident" id="4535266">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4535286">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4535297">crypto</span><span class="op" id="4535303">.</span><span class="ident" id="4535304">Hash</span><br>
<span class="lineno"></span><span class="op" id="4535309">}</span><span class="op" id="4535310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535313">{</span><span class="ident" id="4535314">MD2WithRSA</span><span class="op" id="4535324">,</span>&nbsp;<span class="ident" id="4535326">oidSignatureMD2WithRSA</span><span class="op" id="4535348">,</span>&nbsp;<span class="ident" id="4535350">RSA</span><span class="op" id="4535353">,</span>&nbsp;<span class="ident" id="4535355">crypto</span><span class="op" id="4535361">.</span><span class="ident" id="4535362">Hash</span><span class="op" id="4535366">(</span><span class="num" id="4535367">0</span><span class="op" id="4535368">)</span>&nbsp;<span class="comment" id="4535370">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4535392">}</span><span class="op" id="4535393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535396">{</span><span class="ident" id="4535397">MD5WithRSA</span><span class="op" id="4535407">,</span>&nbsp;<span class="ident" id="4535409">oidSignatureMD5WithRSA</span><span class="op" id="4535431">,</span>&nbsp;<span class="ident" id="4535433">RSA</span><span class="op" id="4535436">,</span>&nbsp;<span class="ident" id="4535438">crypto</span><span class="op" id="4535444">.</span><span class="ident" id="4535445">MD5</span><span class="op" id="4535448">}</span><span class="op" id="4535449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535452">{</span><span class="ident" id="4535453">SHA1WithRSA</span><span class="op" id="4535464">,</span>&nbsp;<span class="ident" id="4535466">oidSignatureSHA1WithRSA</span><span class="op" id="4535489">,</span>&nbsp;<span class="ident" id="4535491">RSA</span><span class="op" id="4535494">,</span>&nbsp;<span class="ident" id="4535496">crypto</span><span class="op" id="4535502">.</span><span class="ident" id="4535503">SHA1</span><span class="op" id="4535507">}</span><span class="op" id="4535508">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535511">{</span><span class="ident" id="4535512">SHA256WithRSA</span><span class="op" id="4535525">,</span>&nbsp;<span class="ident" id="4535527">oidSignatureSHA256WithRSA</span><span class="op" id="4535552">,</span>&nbsp;<span class="ident" id="4535554">RSA</span><span class="op" id="4535557">,</span>&nbsp;<span class="ident" id="4535559">crypto</span><span class="op" id="4535565">.</span><span class="ident" id="4535566">SHA256</span><span class="op" id="4535572">}</span><span class="op" id="4535573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535576">{</span><span class="ident" id="4535577">SHA384WithRSA</span><span class="op" id="4535590">,</span>&nbsp;<span class="ident" id="4535592">oidSignatureSHA384WithRSA</span><span class="op" id="4535617">,</span>&nbsp;<span class="ident" id="4535619">RSA</span><span class="op" id="4535622">,</span>&nbsp;<span class="ident" id="4535624">crypto</span><span class="op" id="4535630">.</span><span class="ident" id="4535631">SHA384</span><span class="op" id="4535637">}</span><span class="op" id="4535638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535641">{</span><span class="ident" id="4535642">SHA512WithRSA</span><span class="op" id="4535655">,</span>&nbsp;<span class="ident" id="4535657">oidSignatureSHA512WithRSA</span><span class="op" id="4535682">,</span>&nbsp;<span class="ident" id="4535684">RSA</span><span class="op" id="4535687">,</span>&nbsp;<span class="ident" id="4535689">crypto</span><span class="op" id="4535695">.</span><span class="ident" id="4535696">SHA512</span><span class="op" id="4535702">}</span><span class="op" id="4535703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535706">{</span><span class="ident" id="4535707">DSAWithSHA1</span><span class="op" id="4535718">,</span>&nbsp;<span class="ident" id="4535720">oidSignatureDSAWithSHA1</span><span class="op" id="4535743">,</span>&nbsp;<span class="ident" id="4535745">DSA</span><span class="op" id="4535748">,</span>&nbsp;<span class="ident" id="4535750">crypto</span><span class="op" id="4535756">.</span><span class="ident" id="4535757">SHA1</span><span class="op" id="4535761">}</span><span class="op" id="4535762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535765">{</span><span class="ident" id="4535766">DSAWithSHA256</span><span class="op" id="4535779">,</span>&nbsp;<span class="ident" id="4535781">oidSignatureDSAWithSHA256</span><span class="op" id="4535806">,</span>&nbsp;<span class="ident" id="4535808">DSA</span><span class="op" id="4535811">,</span>&nbsp;<span class="ident" id="4535813">crypto</span><span class="op" id="4535819">.</span><span class="ident" id="4535820">SHA256</span><span class="op" id="4535826">}</span><span class="op" id="4535827">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535830">{</span><span class="ident" id="4535831">ECDSAWithSHA1</span><span class="op" id="4535844">,</span>&nbsp;<span class="ident" id="4535846">oidSignatureECDSAWithSHA1</span><span class="op" id="4535871">,</span>&nbsp;<span class="ident" id="4535873">ECDSA</span><span class="op" id="4535878">,</span>&nbsp;<span class="ident" id="4535880">crypto</span><span class="op" id="4535886">.</span><span class="ident" id="4535887">SHA1</span><span class="op" id="4535891">}</span><span class="op" id="4535892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535895">{</span><span class="ident" id="4535896">ECDSAWithSHA256</span><span class="op" id="4535911">,</span>&nbsp;<span class="ident" id="4535913">oidSignatureECDSAWithSHA256</span><span class="op" id="4535940">,</span>&nbsp;<span class="ident" id="4535942">ECDSA</span><span class="op" id="4535947">,</span>&nbsp;<span class="ident" id="4535949">crypto</span><span class="op" id="4535955">.</span><span class="ident" id="4535956">SHA256</span><span class="op" id="4535962">}</span><span class="op" id="4535963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4535966">{</span><span class="ident" id="4535967">ECDSAWithSHA384</span><span class="op" id="4535982">,</span>&nbsp;<span class="ident" id="4535984">oidSignatureECDSAWithSHA384</span><span class="op" id="4536011">,</span>&nbsp;<span class="ident" id="4536013">ECDSA</span><span class="op" id="4536018">,</span>&nbsp;<span class="ident" id="4536020">crypto</span><span class="op" id="4536026">.</span><span class="ident" id="4536027">SHA384</span><span class="op" id="4536033">}</span><span class="op" id="4536034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4536037">{</span><span class="ident" id="4536038">ECDSAWithSHA512</span><span class="op" id="4536053">,</span>&nbsp;<span class="ident" id="4536055">oidSignatureECDSAWithSHA512</span><span class="op" id="4536082">,</span>&nbsp;<span class="ident" id="4536084">ECDSA</span><span class="op" id="4536089">,</span>&nbsp;<span class="ident" id="4536091">crypto</span><span class="op" id="4536097">.</span><span class="ident" id="4536098">SHA512</span><span class="op" id="4536104">}</span><span class="op" id="4536105">,</span><br>
<span class="lineno"></span><span class="op" id="4536107">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4536110">func</span>&nbsp;<span class="ident" id="4536115">getSignatureAlgorithmFromOID</span><span class="op" id="4536143">(</span><span class="ident" id="4536144">oid</span>&nbsp;<span class="ident" id="4536148">asn1</span><span class="op" id="4536152">.</span><span class="ident" id="4536153">ObjectIdentifier</span><span class="op" id="4536169">)</span>&nbsp;<span class="ident" id="4536171">SignatureAlgorithm</span>&nbsp;<span class="op" id="4536190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4536193">for</span>&nbsp;<span class="ident" id="4536197">_</span><span class="op" id="4536198">,</span>&nbsp;<span class="ident" id="4536200">details</span>&nbsp;<span class="op" id="4536208">:=</span>&nbsp;<span class="keyword" id="4536211">range</span>&nbsp;<span class="ident" id="4536217">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4536243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4536247">if</span>&nbsp;<span class="ident" id="4536250">oid</span><span class="op" id="4536253">.</span><span class="ident" id="4536254">Equal</span><span class="op" id="4536259">(</span><span class="ident" id="4536260">details</span><span class="op" id="4536267">.</span><span class="ident" id="4536268">oid</span><span class="op" id="4536271">)</span>&nbsp;<span class="op" id="4536273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4536278">return</span>&nbsp;<span class="ident" id="4536285">details</span><span class="op" id="4536292">.</span><span class="ident" id="4536293">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4536300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4536303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4536306">return</span>&nbsp;<span class="ident" id="4536313">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4536339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4536342">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4536381">//</span><br>
<span class="lineno"></span><span class="comment" id="4536384">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4536449">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4536482">//</span><br>
<span class="lineno">280</span><span class="comment" id="4536485">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4536539">//</span><br>
<span class="lineno"></span><span class="comment" id="4536542">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4536607">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4536638">//</span><br>
<span class="lineno">285</span><span class="comment" id="4536641">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4536709">//</span><br>
<span class="lineno"></span><span class="comment" id="4536712">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4536754">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4536826">var</span>&nbsp;<span class="op" id="4536830">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4536833">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4536851">=</span>&nbsp;<span class="ident" id="4536853">asn1</span><span class="op" id="4536857">.</span><span class="ident" id="4536858">ObjectIdentifier</span><span class="op" id="4536874">{</span><span class="num" id="4536875">1</span><span class="op" id="4536876">,</span>&nbsp;<span class="num" id="4536878">2</span><span class="op" id="4536879">,</span>&nbsp;<span class="num" id="4536881">840</span><span class="op" id="4536884">,</span>&nbsp;<span class="num" id="4536886">113549</span><span class="op" id="4536892">,</span>&nbsp;<span class="num" id="4536894">1</span><span class="op" id="4536895">,</span>&nbsp;<span class="num" id="4536897">1</span><span class="op" id="4536898">,</span>&nbsp;<span class="num" id="4536900">1</span><span class="op" id="4536901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4536904">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4536922">=</span>&nbsp;<span class="ident" id="4536924">asn1</span><span class="op" id="4536928">.</span><span class="ident" id="4536929">ObjectIdentifier</span><span class="op" id="4536945">{</span><span class="num" id="4536946">1</span><span class="op" id="4536947">,</span>&nbsp;<span class="num" id="4536949">2</span><span class="op" id="4536950">,</span>&nbsp;<span class="num" id="4536952">840</span><span class="op" id="4536955">,</span>&nbsp;<span class="num" id="4536957">10040</span><span class="op" id="4536962">,</span>&nbsp;<span class="num" id="4536964">4</span><span class="op" id="4536965">,</span>&nbsp;<span class="num" id="4536967">1</span><span class="op" id="4536968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4536971">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4536989">=</span>&nbsp;<span class="ident" id="4536991">asn1</span><span class="op" id="4536995">.</span><span class="ident" id="4536996">ObjectIdentifier</span><span class="op" id="4537012">{</span><span class="num" id="4537013">1</span><span class="op" id="4537014">,</span>&nbsp;<span class="num" id="4537016">2</span><span class="op" id="4537017">,</span>&nbsp;<span class="num" id="4537019">840</span><span class="op" id="4537022">,</span>&nbsp;<span class="num" id="4537024">10045</span><span class="op" id="4537029">,</span>&nbsp;<span class="num" id="4537031">2</span><span class="op" id="4537032">,</span>&nbsp;<span class="num" id="4537034">1</span><span class="op" id="4537035">}</span><br>
<span class="lineno"></span><span class="op" id="4537037">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4537040">func</span>&nbsp;<span class="ident" id="4537045">getPublicKeyAlgorithmFromOID</span><span class="op" id="4537073">(</span><span class="ident" id="4537074">oid</span>&nbsp;<span class="ident" id="4537078">asn1</span><span class="op" id="4537082">.</span><span class="ident" id="4537083">ObjectIdentifier</span><span class="op" id="4537099">)</span>&nbsp;<span class="ident" id="4537101">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4537120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4537123">switch</span>&nbsp;<span class="op" id="4537130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4537133">case</span>&nbsp;<span class="ident" id="4537138">oid</span><span class="op" id="4537141">.</span><span class="ident" id="4537142">Equal</span><span class="op" id="4537147">(</span><span class="ident" id="4537148">oidPublicKeyRSA</span><span class="op" id="4537163">)</span><span class="op" id="4537164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4537168">return</span>&nbsp;<span class="ident" id="4537175">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4537180">case</span>&nbsp;<span class="ident" id="4537185">oid</span><span class="op" id="4537188">.</span><span class="ident" id="4537189">Equal</span><span class="op" id="4537194">(</span><span class="ident" id="4537195">oidPublicKeyDSA</span><span class="op" id="4537210">)</span><span class="op" id="4537211">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4537215">return</span>&nbsp;<span class="ident" id="4537222">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4537227">case</span>&nbsp;<span class="ident" id="4537232">oid</span><span class="op" id="4537235">.</span><span class="ident" id="4537236">Equal</span><span class="op" id="4537241">(</span><span class="ident" id="4537242">oidPublicKeyECDSA</span><span class="op" id="4537259">)</span><span class="op" id="4537260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4537264">return</span>&nbsp;<span class="ident" id="4537271">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4537281">return</span>&nbsp;<span class="ident" id="4537288">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="4537314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4537317">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4537351">//</span><br>
<span class="lineno"></span><span class="comment" id="4537354">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4537391">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4537458">//</span><br>
<span class="lineno"></span><span class="comment" id="4537461">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4537498">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4537561">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4537579">//</span><br>
<span class="lineno"></span><span class="comment" id="4537582">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4537619">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4537686">//</span><br>
<span class="lineno"></span><span class="comment" id="4537689">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4537726">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4537793">//</span><br>
<span class="lineno"></span><span class="comment" id="4537796">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4537841">var</span>&nbsp;<span class="op" id="4537845">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4537848">oidNamedCurveP224</span>&nbsp;<span class="op" id="4537866">=</span>&nbsp;<span class="ident" id="4537868">asn1</span><span class="op" id="4537872">.</span><span class="ident" id="4537873">ObjectIdentifier</span><span class="op" id="4537889">{</span><span class="num" id="4537890">1</span><span class="op" id="4537891">,</span>&nbsp;<span class="num" id="4537893">3</span><span class="op" id="4537894">,</span>&nbsp;<span class="num" id="4537896">132</span><span class="op" id="4537899">,</span>&nbsp;<span class="num" id="4537901">0</span><span class="op" id="4537902">,</span>&nbsp;<span class="num" id="4537904">33</span><span class="op" id="4537906">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4537909">oidNamedCurveP256</span>&nbsp;<span class="op" id="4537927">=</span>&nbsp;<span class="ident" id="4537929">asn1</span><span class="op" id="4537933">.</span><span class="ident" id="4537934">ObjectIdentifier</span><span class="op" id="4537950">{</span><span class="num" id="4537951">1</span><span class="op" id="4537952">,</span>&nbsp;<span class="num" id="4537954">2</span><span class="op" id="4537955">,</span>&nbsp;<span class="num" id="4537957">840</span><span class="op" id="4537960">,</span>&nbsp;<span class="num" id="4537962">10045</span><span class="op" id="4537967">,</span>&nbsp;<span class="num" id="4537969">3</span><span class="op" id="4537970">,</span>&nbsp;<span class="num" id="4537972">1</span><span class="op" id="4537973">,</span>&nbsp;<span class="num" id="4537975">7</span><span class="op" id="4537976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4537979">oidNamedCurveP384</span>&nbsp;<span class="op" id="4537997">=</span>&nbsp;<span class="ident" id="4537999">asn1</span><span class="op" id="4538003">.</span><span class="ident" id="4538004">ObjectIdentifier</span><span class="op" id="4538020">{</span><span class="num" id="4538021">1</span><span class="op" id="4538022">,</span>&nbsp;<span class="num" id="4538024">3</span><span class="op" id="4538025">,</span>&nbsp;<span class="num" id="4538027">132</span><span class="op" id="4538030">,</span>&nbsp;<span class="num" id="4538032">0</span><span class="op" id="4538033">,</span>&nbsp;<span class="num" id="4538035">34</span><span class="op" id="4538037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538040">oidNamedCurveP521</span>&nbsp;<span class="op" id="4538058">=</span>&nbsp;<span class="ident" id="4538060">asn1</span><span class="op" id="4538064">.</span><span class="ident" id="4538065">ObjectIdentifier</span><span class="op" id="4538081">{</span><span class="num" id="4538082">1</span><span class="op" id="4538083">,</span>&nbsp;<span class="num" id="4538085">3</span><span class="op" id="4538086">,</span>&nbsp;<span class="num" id="4538088">132</span><span class="op" id="4538091">,</span>&nbsp;<span class="num" id="4538093">0</span><span class="op" id="4538094">,</span>&nbsp;<span class="num" id="4538096">35</span><span class="op" id="4538098">}</span><br>
<span class="lineno"></span><span class="op" id="4538100">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4538103">func</span>&nbsp;<span class="ident" id="4538108">namedCurveFromOID</span><span class="op" id="4538125">(</span><span class="ident" id="4538126">oid</span>&nbsp;<span class="ident" id="4538130">asn1</span><span class="op" id="4538134">.</span><span class="ident" id="4538135">ObjectIdentifier</span><span class="op" id="4538151">)</span>&nbsp;<span class="ident" id="4538153">elliptic</span><span class="op" id="4538161">.</span><span class="ident" id="4538162">Curve</span>&nbsp;<span class="op" id="4538168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538171">switch</span>&nbsp;<span class="op" id="4538178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538181">case</span>&nbsp;<span class="ident" id="4538186">oid</span><span class="op" id="4538189">.</span><span class="ident" id="4538190">Equal</span><span class="op" id="4538195">(</span><span class="ident" id="4538196">oidNamedCurveP224</span><span class="op" id="4538213">)</span><span class="op" id="4538214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538218">return</span>&nbsp;<span class="ident" id="4538225">elliptic</span><span class="op" id="4538233">.</span><span class="ident" id="4538234">P224</span><span class="op" id="4538238">(</span><span class="op" id="4538239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538242">case</span>&nbsp;<span class="ident" id="4538247">oid</span><span class="op" id="4538250">.</span><span class="ident" id="4538251">Equal</span><span class="op" id="4538256">(</span><span class="ident" id="4538257">oidNamedCurveP256</span><span class="op" id="4538274">)</span><span class="op" id="4538275">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538279">return</span>&nbsp;<span class="ident" id="4538286">elliptic</span><span class="op" id="4538294">.</span><span class="ident" id="4538295">P256</span><span class="op" id="4538299">(</span><span class="op" id="4538300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538303">case</span>&nbsp;<span class="ident" id="4538308">oid</span><span class="op" id="4538311">.</span><span class="ident" id="4538312">Equal</span><span class="op" id="4538317">(</span><span class="ident" id="4538318">oidNamedCurveP384</span><span class="op" id="4538335">)</span><span class="op" id="4538336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538340">return</span>&nbsp;<span class="ident" id="4538347">elliptic</span><span class="op" id="4538355">.</span><span class="ident" id="4538356">P384</span><span class="op" id="4538360">(</span><span class="op" id="4538361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538364">case</span>&nbsp;<span class="ident" id="4538369">oid</span><span class="op" id="4538372">.</span><span class="ident" id="4538373">Equal</span><span class="op" id="4538378">(</span><span class="ident" id="4538379">oidNamedCurveP521</span><span class="op" id="4538396">)</span><span class="op" id="4538397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538401">return</span>&nbsp;<span class="ident" id="4538408">elliptic</span><span class="op" id="4538416">.</span><span class="ident" id="4538417">P521</span><span class="op" id="4538421">(</span><span class="op" id="4538422">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4538425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538428">return</span>&nbsp;<span class="builtintype" id="4538435">nil</span><br>
<span class="lineno"></span><span class="op" id="4538439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4538442">func</span>&nbsp;<span class="ident" id="4538447">oidFromNamedCurve</span><span class="op" id="4538464">(</span><span class="ident" id="4538465">curve</span>&nbsp;<span class="ident" id="4538471">elliptic</span><span class="op" id="4538479">.</span><span class="ident" id="4538480">Curve</span><span class="op" id="4538485">)</span>&nbsp;<span class="op" id="4538487">(</span><span class="ident" id="4538488">asn1</span><span class="op" id="4538492">.</span><span class="ident" id="4538493">ObjectIdentifier</span><span class="op" id="4538509">,</span>&nbsp;<span class="builtintype" id="4538511">bool</span><span class="op" id="4538515">)</span>&nbsp;<span class="op" id="4538517">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538520">switch</span>&nbsp;<span class="ident" id="4538527">curve</span>&nbsp;<span class="op" id="4538533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538536">case</span>&nbsp;<span class="ident" id="4538541">elliptic</span><span class="op" id="4538549">.</span><span class="ident" id="4538550">P224</span><span class="op" id="4538554">(</span><span class="op" id="4538555">)</span><span class="op" id="4538556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538560">return</span>&nbsp;<span class="ident" id="4538567">oidNamedCurveP224</span><span class="op" id="4538584">,</span>&nbsp;<span class="builtintype" id="4538586">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538592">case</span>&nbsp;<span class="ident" id="4538597">elliptic</span><span class="op" id="4538605">.</span><span class="ident" id="4538606">P256</span><span class="op" id="4538610">(</span><span class="op" id="4538611">)</span><span class="op" id="4538612">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538616">return</span>&nbsp;<span class="ident" id="4538623">oidNamedCurveP256</span><span class="op" id="4538640">,</span>&nbsp;<span class="builtintype" id="4538642">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538648">case</span>&nbsp;<span class="ident" id="4538653">elliptic</span><span class="op" id="4538661">.</span><span class="ident" id="4538662">P384</span><span class="op" id="4538666">(</span><span class="op" id="4538667">)</span><span class="op" id="4538668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538672">return</span>&nbsp;<span class="ident" id="4538679">oidNamedCurveP384</span><span class="op" id="4538696">,</span>&nbsp;<span class="builtintype" id="4538698">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538704">case</span>&nbsp;<span class="ident" id="4538709">elliptic</span><span class="op" id="4538717">.</span><span class="ident" id="4538718">P521</span><span class="op" id="4538722">(</span><span class="op" id="4538723">)</span><span class="op" id="4538724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538728">return</span>&nbsp;<span class="ident" id="4538735">oidNamedCurveP521</span><span class="op" id="4538752">,</span>&nbsp;<span class="builtintype" id="4538754">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4538760">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4538764">return</span>&nbsp;<span class="builtintype" id="4538771">nil</span><span class="op" id="4538774">,</span>&nbsp;<span class="builtintype" id="4538776">false</span><br>
<span class="lineno"></span><span class="op" id="4538782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4538785">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4538864">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4538904">type</span>&nbsp;<span class="ident" id="4538909">KeyUsage</span>&nbsp;<span class="builtintype" id="4538918">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4538923">const</span>&nbsp;<span class="op" id="4538929">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538932">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4538957">KeyUsage</span>&nbsp;<span class="op" id="4538966">=</span>&nbsp;<span class="num" id="4538968">1</span>&nbsp;<span class="op" id="4538970">&lt;&lt;</span>&nbsp;<span class="ident" id="4538973">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4538979">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539006">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539031">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539057">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539079">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539097">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539114">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539136">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4539157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4539160">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4539202">//</span><br>
<span class="lineno"></span><span class="comment" id="4539205">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4539274">//</span><br>
<span class="lineno"></span><span class="comment" id="4539277">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4539322">//</span><br>
<span class="lineno"></span><span class="comment" id="4539325">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4539391">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4539457">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4539523">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4539589">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4539655">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4539721">var</span>&nbsp;<span class="op" id="4539725">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539728">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539769">=</span>&nbsp;<span class="ident" id="4539771">asn1</span><span class="op" id="4539775">.</span><span class="ident" id="4539776">ObjectIdentifier</span><span class="op" id="4539792">{</span><span class="num" id="4539793">2</span><span class="op" id="4539794">,</span>&nbsp;<span class="num" id="4539796">5</span><span class="op" id="4539797">,</span>&nbsp;<span class="num" id="4539799">29</span><span class="op" id="4539801">,</span>&nbsp;<span class="num" id="4539803">37</span><span class="op" id="4539805">,</span>&nbsp;<span class="num" id="4539807">0</span><span class="op" id="4539808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539811">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539852">=</span>&nbsp;<span class="ident" id="4539854">asn1</span><span class="op" id="4539858">.</span><span class="ident" id="4539859">ObjectIdentifier</span><span class="op" id="4539875">{</span><span class="num" id="4539876">1</span><span class="op" id="4539877">,</span>&nbsp;<span class="num" id="4539879">3</span><span class="op" id="4539880">,</span>&nbsp;<span class="num" id="4539882">6</span><span class="op" id="4539883">,</span>&nbsp;<span class="num" id="4539885">1</span><span class="op" id="4539886">,</span>&nbsp;<span class="num" id="4539888">5</span><span class="op" id="4539889">,</span>&nbsp;<span class="num" id="4539891">5</span><span class="op" id="4539892">,</span>&nbsp;<span class="num" id="4539894">7</span><span class="op" id="4539895">,</span>&nbsp;<span class="num" id="4539897">3</span><span class="op" id="4539898">,</span>&nbsp;<span class="num" id="4539900">1</span><span class="op" id="4539901">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539904">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4539945">=</span>&nbsp;<span class="ident" id="4539947">asn1</span><span class="op" id="4539951">.</span><span class="ident" id="4539952">ObjectIdentifier</span><span class="op" id="4539968">{</span><span class="num" id="4539969">1</span><span class="op" id="4539970">,</span>&nbsp;<span class="num" id="4539972">3</span><span class="op" id="4539973">,</span>&nbsp;<span class="num" id="4539975">6</span><span class="op" id="4539976">,</span>&nbsp;<span class="num" id="4539978">1</span><span class="op" id="4539979">,</span>&nbsp;<span class="num" id="4539981">5</span><span class="op" id="4539982">,</span>&nbsp;<span class="num" id="4539984">5</span><span class="op" id="4539985">,</span>&nbsp;<span class="num" id="4539987">7</span><span class="op" id="4539988">,</span>&nbsp;<span class="num" id="4539990">3</span><span class="op" id="4539991">,</span>&nbsp;<span class="num" id="4539993">2</span><span class="op" id="4539994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4539997">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540038">=</span>&nbsp;<span class="ident" id="4540040">asn1</span><span class="op" id="4540044">.</span><span class="ident" id="4540045">ObjectIdentifier</span><span class="op" id="4540061">{</span><span class="num" id="4540062">1</span><span class="op" id="4540063">,</span>&nbsp;<span class="num" id="4540065">3</span><span class="op" id="4540066">,</span>&nbsp;<span class="num" id="4540068">6</span><span class="op" id="4540069">,</span>&nbsp;<span class="num" id="4540071">1</span><span class="op" id="4540072">,</span>&nbsp;<span class="num" id="4540074">5</span><span class="op" id="4540075">,</span>&nbsp;<span class="num" id="4540077">5</span><span class="op" id="4540078">,</span>&nbsp;<span class="num" id="4540080">7</span><span class="op" id="4540081">,</span>&nbsp;<span class="num" id="4540083">3</span><span class="op" id="4540084">,</span>&nbsp;<span class="num" id="4540086">3</span><span class="op" id="4540087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540090">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540131">=</span>&nbsp;<span class="ident" id="4540133">asn1</span><span class="op" id="4540137">.</span><span class="ident" id="4540138">ObjectIdentifier</span><span class="op" id="4540154">{</span><span class="num" id="4540155">1</span><span class="op" id="4540156">,</span>&nbsp;<span class="num" id="4540158">3</span><span class="op" id="4540159">,</span>&nbsp;<span class="num" id="4540161">6</span><span class="op" id="4540162">,</span>&nbsp;<span class="num" id="4540164">1</span><span class="op" id="4540165">,</span>&nbsp;<span class="num" id="4540167">5</span><span class="op" id="4540168">,</span>&nbsp;<span class="num" id="4540170">5</span><span class="op" id="4540171">,</span>&nbsp;<span class="num" id="4540173">7</span><span class="op" id="4540174">,</span>&nbsp;<span class="num" id="4540176">3</span><span class="op" id="4540177">,</span>&nbsp;<span class="num" id="4540179">4</span><span class="op" id="4540180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540183">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540224">=</span>&nbsp;<span class="ident" id="4540226">asn1</span><span class="op" id="4540230">.</span><span class="ident" id="4540231">ObjectIdentifier</span><span class="op" id="4540247">{</span><span class="num" id="4540248">1</span><span class="op" id="4540249">,</span>&nbsp;<span class="num" id="4540251">3</span><span class="op" id="4540252">,</span>&nbsp;<span class="num" id="4540254">6</span><span class="op" id="4540255">,</span>&nbsp;<span class="num" id="4540257">1</span><span class="op" id="4540258">,</span>&nbsp;<span class="num" id="4540260">5</span><span class="op" id="4540261">,</span>&nbsp;<span class="num" id="4540263">5</span><span class="op" id="4540264">,</span>&nbsp;<span class="num" id="4540266">7</span><span class="op" id="4540267">,</span>&nbsp;<span class="num" id="4540269">3</span><span class="op" id="4540270">,</span>&nbsp;<span class="num" id="4540272">5</span><span class="op" id="4540273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540276">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540317">=</span>&nbsp;<span class="ident" id="4540319">asn1</span><span class="op" id="4540323">.</span><span class="ident" id="4540324">ObjectIdentifier</span><span class="op" id="4540340">{</span><span class="num" id="4540341">1</span><span class="op" id="4540342">,</span>&nbsp;<span class="num" id="4540344">3</span><span class="op" id="4540345">,</span>&nbsp;<span class="num" id="4540347">6</span><span class="op" id="4540348">,</span>&nbsp;<span class="num" id="4540350">1</span><span class="op" id="4540351">,</span>&nbsp;<span class="num" id="4540353">5</span><span class="op" id="4540354">,</span>&nbsp;<span class="num" id="4540356">5</span><span class="op" id="4540357">,</span>&nbsp;<span class="num" id="4540359">7</span><span class="op" id="4540360">,</span>&nbsp;<span class="num" id="4540362">3</span><span class="op" id="4540363">,</span>&nbsp;<span class="num" id="4540365">6</span><span class="op" id="4540366">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540369">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540410">=</span>&nbsp;<span class="ident" id="4540412">asn1</span><span class="op" id="4540416">.</span><span class="ident" id="4540417">ObjectIdentifier</span><span class="op" id="4540433">{</span><span class="num" id="4540434">1</span><span class="op" id="4540435">,</span>&nbsp;<span class="num" id="4540437">3</span><span class="op" id="4540438">,</span>&nbsp;<span class="num" id="4540440">6</span><span class="op" id="4540441">,</span>&nbsp;<span class="num" id="4540443">1</span><span class="op" id="4540444">,</span>&nbsp;<span class="num" id="4540446">5</span><span class="op" id="4540447">,</span>&nbsp;<span class="num" id="4540449">5</span><span class="op" id="4540450">,</span>&nbsp;<span class="num" id="4540452">7</span><span class="op" id="4540453">,</span>&nbsp;<span class="num" id="4540455">3</span><span class="op" id="4540456">,</span>&nbsp;<span class="num" id="4540458">7</span><span class="op" id="4540459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540462">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540503">=</span>&nbsp;<span class="ident" id="4540505">asn1</span><span class="op" id="4540509">.</span><span class="ident" id="4540510">ObjectIdentifier</span><span class="op" id="4540526">{</span><span class="num" id="4540527">1</span><span class="op" id="4540528">,</span>&nbsp;<span class="num" id="4540530">3</span><span class="op" id="4540531">,</span>&nbsp;<span class="num" id="4540533">6</span><span class="op" id="4540534">,</span>&nbsp;<span class="num" id="4540536">1</span><span class="op" id="4540537">,</span>&nbsp;<span class="num" id="4540539">5</span><span class="op" id="4540540">,</span>&nbsp;<span class="num" id="4540542">5</span><span class="op" id="4540543">,</span>&nbsp;<span class="num" id="4540545">7</span><span class="op" id="4540546">,</span>&nbsp;<span class="num" id="4540548">3</span><span class="op" id="4540549">,</span>&nbsp;<span class="num" id="4540551">8</span><span class="op" id="4540552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540555">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540596">=</span>&nbsp;<span class="ident" id="4540598">asn1</span><span class="op" id="4540602">.</span><span class="ident" id="4540603">ObjectIdentifier</span><span class="op" id="4540619">{</span><span class="num" id="4540620">1</span><span class="op" id="4540621">,</span>&nbsp;<span class="num" id="4540623">3</span><span class="op" id="4540624">,</span>&nbsp;<span class="num" id="4540626">6</span><span class="op" id="4540627">,</span>&nbsp;<span class="num" id="4540629">1</span><span class="op" id="4540630">,</span>&nbsp;<span class="num" id="4540632">5</span><span class="op" id="4540633">,</span>&nbsp;<span class="num" id="4540635">5</span><span class="op" id="4540636">,</span>&nbsp;<span class="num" id="4540638">7</span><span class="op" id="4540639">,</span>&nbsp;<span class="num" id="4540641">3</span><span class="op" id="4540642">,</span>&nbsp;<span class="num" id="4540644">9</span><span class="op" id="4540645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540648">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4540689">=</span>&nbsp;<span class="ident" id="4540691">asn1</span><span class="op" id="4540695">.</span><span class="ident" id="4540696">ObjectIdentifier</span><span class="op" id="4540712">{</span><span class="num" id="4540713">1</span><span class="op" id="4540714">,</span>&nbsp;<span class="num" id="4540716">3</span><span class="op" id="4540717">,</span>&nbsp;<span class="num" id="4540719">6</span><span class="op" id="4540720">,</span>&nbsp;<span class="num" id="4540722">1</span><span class="op" id="4540723">,</span>&nbsp;<span class="num" id="4540725">4</span><span class="op" id="4540726">,</span>&nbsp;<span class="num" id="4540728">1</span><span class="op" id="4540729">,</span>&nbsp;<span class="num" id="4540731">311</span><span class="op" id="4540734">,</span>&nbsp;<span class="num" id="4540736">10</span><span class="op" id="4540738">,</span>&nbsp;<span class="num" id="4540740">3</span><span class="op" id="4540741">,</span>&nbsp;<span class="num" id="4540743">3</span><span class="op" id="4540744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540747">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4540788">=</span>&nbsp;<span class="ident" id="4540790">asn1</span><span class="op" id="4540794">.</span><span class="ident" id="4540795">ObjectIdentifier</span><span class="op" id="4540811">{</span><span class="num" id="4540812">2</span><span class="op" id="4540813">,</span>&nbsp;<span class="num" id="4540815">16</span><span class="op" id="4540817">,</span>&nbsp;<span class="num" id="4540819">840</span><span class="op" id="4540822">,</span>&nbsp;<span class="num" id="4540824">1</span><span class="op" id="4540825">,</span>&nbsp;<span class="num" id="4540827">113730</span><span class="op" id="4540833">,</span>&nbsp;<span class="num" id="4540835">4</span><span class="op" id="4540836">,</span>&nbsp;<span class="num" id="4540838">1</span><span class="op" id="4540839">}</span><br>
<span class="lineno">400</span><span class="op" id="4540841">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4540844">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4540929">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4540991">type</span>&nbsp;<span class="ident" id="4540996">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4541008">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4541013">const</span>&nbsp;<span class="op" id="4541019">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541022">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4541037">ExtKeyUsage</span>&nbsp;<span class="op" id="4541049">=</span>&nbsp;<span class="ident" id="4541051">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541057">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541080">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541103">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541127">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541155">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541182">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541206">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541228">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541253">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541277">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541316">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4541353">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4541356">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4541432">var</span>&nbsp;<span class="ident" id="4541436">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4541452">=</span>&nbsp;<span class="op" id="4541454">[</span><span class="op" id="4541455">]</span><span class="keyword" id="4541456">struct</span>&nbsp;<span class="op" id="4541463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541466">extKeyUsage</span>&nbsp;<span class="ident" id="4541478">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541491">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4541503">asn1</span><span class="op" id="4541507">.</span><span class="ident" id="4541508">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4541525">}</span><span class="op" id="4541526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541529">{</span><span class="ident" id="4541530">ExtKeyUsageAny</span><span class="op" id="4541544">,</span>&nbsp;<span class="ident" id="4541546">oidExtKeyUsageAny</span><span class="op" id="4541563">}</span><span class="op" id="4541564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541567">{</span><span class="ident" id="4541568">ExtKeyUsageServerAuth</span><span class="op" id="4541589">,</span>&nbsp;<span class="ident" id="4541591">oidExtKeyUsageServerAuth</span><span class="op" id="4541615">}</span><span class="op" id="4541616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541619">{</span><span class="ident" id="4541620">ExtKeyUsageClientAuth</span><span class="op" id="4541641">,</span>&nbsp;<span class="ident" id="4541643">oidExtKeyUsageClientAuth</span><span class="op" id="4541667">}</span><span class="op" id="4541668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541671">{</span><span class="ident" id="4541672">ExtKeyUsageCodeSigning</span><span class="op" id="4541694">,</span>&nbsp;<span class="ident" id="4541696">oidExtKeyUsageCodeSigning</span><span class="op" id="4541721">}</span><span class="op" id="4541722">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541725">{</span><span class="ident" id="4541726">ExtKeyUsageEmailProtection</span><span class="op" id="4541752">,</span>&nbsp;<span class="ident" id="4541754">oidExtKeyUsageEmailProtection</span><span class="op" id="4541783">}</span><span class="op" id="4541784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541787">{</span><span class="ident" id="4541788">ExtKeyUsageIPSECEndSystem</span><span class="op" id="4541813">,</span>&nbsp;<span class="ident" id="4541815">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="4541843">}</span><span class="op" id="4541844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541847">{</span><span class="ident" id="4541848">ExtKeyUsageIPSECTunnel</span><span class="op" id="4541870">,</span>&nbsp;<span class="ident" id="4541872">oidExtKeyUsageIPSECTunnel</span><span class="op" id="4541897">}</span><span class="op" id="4541898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541901">{</span><span class="ident" id="4541902">ExtKeyUsageIPSECUser</span><span class="op" id="4541922">,</span>&nbsp;<span class="ident" id="4541924">oidExtKeyUsageIPSECUser</span><span class="op" id="4541947">}</span><span class="op" id="4541948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4541951">{</span><span class="ident" id="4541952">ExtKeyUsageTimeStamping</span><span class="op" id="4541975">,</span>&nbsp;<span class="ident" id="4541977">oidExtKeyUsageTimeStamping</span><span class="op" id="4542003">}</span><span class="op" id="4542004">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542007">{</span><span class="ident" id="4542008">ExtKeyUsageOCSPSigning</span><span class="op" id="4542030">,</span>&nbsp;<span class="ident" id="4542032">oidExtKeyUsageOCSPSigning</span><span class="op" id="4542057">}</span><span class="op" id="4542058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542061">{</span><span class="ident" id="4542062">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4542099">,</span>&nbsp;<span class="ident" id="4542101">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4542141">}</span><span class="op" id="4542142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542145">{</span><span class="ident" id="4542146">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4542182">,</span>&nbsp;<span class="ident" id="4542184">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4542223">}</span><span class="op" id="4542224">,</span><br>
<span class="lineno"></span><span class="op" id="4542226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4542229">func</span>&nbsp;<span class="ident" id="4542234">extKeyUsageFromOID</span><span class="op" id="4542252">(</span><span class="ident" id="4542253">oid</span>&nbsp;<span class="ident" id="4542257">asn1</span><span class="op" id="4542261">.</span><span class="ident" id="4542262">ObjectIdentifier</span><span class="op" id="4542278">)</span>&nbsp;<span class="op" id="4542280">(</span><span class="ident" id="4542281">eku</span>&nbsp;<span class="ident" id="4542285">ExtKeyUsage</span><span class="op" id="4542296">,</span>&nbsp;<span class="ident" id="4542298">ok</span>&nbsp;<span class="builtintype" id="4542301">bool</span><span class="op" id="4542305">)</span>&nbsp;<span class="op" id="4542307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4542310">for</span>&nbsp;<span class="ident" id="4542314">_</span><span class="op" id="4542315">,</span>&nbsp;<span class="ident" id="4542317">pair</span>&nbsp;<span class="op" id="4542322">:=</span>&nbsp;<span class="keyword" id="4542325">range</span>&nbsp;<span class="ident" id="4542331">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4542347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4542351">if</span>&nbsp;<span class="ident" id="4542354">oid</span><span class="op" id="4542357">.</span><span class="ident" id="4542358">Equal</span><span class="op" id="4542363">(</span><span class="ident" id="4542364">pair</span><span class="op" id="4542368">.</span><span class="ident" id="4542369">oid</span><span class="op" id="4542372">)</span>&nbsp;<span class="op" id="4542374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4542379">return</span>&nbsp;<span class="ident" id="4542386">pair</span><span class="op" id="4542390">.</span><span class="ident" id="4542391">extKeyUsage</span><span class="op" id="4542402">,</span>&nbsp;<span class="builtintype" id="4542404">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542411">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4542417">return</span><br>
<span class="lineno"></span><span class="op" id="4542424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4542427">func</span>&nbsp;<span class="ident" id="4542432">oidFromExtKeyUsage</span><span class="op" id="4542450">(</span><span class="ident" id="4542451">eku</span>&nbsp;<span class="ident" id="4542455">ExtKeyUsage</span><span class="op" id="4542466">)</span>&nbsp;<span class="op" id="4542468">(</span><span class="ident" id="4542469">oid</span>&nbsp;<span class="ident" id="4542473">asn1</span><span class="op" id="4542477">.</span><span class="ident" id="4542478">ObjectIdentifier</span><span class="op" id="4542494">,</span>&nbsp;<span class="ident" id="4542496">ok</span>&nbsp;<span class="builtintype" id="4542499">bool</span><span class="op" id="4542503">)</span>&nbsp;<span class="op" id="4542505">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4542508">for</span>&nbsp;<span class="ident" id="4542512">_</span><span class="op" id="4542513">,</span>&nbsp;<span class="ident" id="4542515">pair</span>&nbsp;<span class="op" id="4542520">:=</span>&nbsp;<span class="keyword" id="4542523">range</span>&nbsp;<span class="ident" id="4542529">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4542545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4542549">if</span>&nbsp;<span class="ident" id="4542552">eku</span>&nbsp;<span class="op" id="4542556">==</span>&nbsp;<span class="ident" id="4542559">pair</span><span class="op" id="4542563">.</span><span class="ident" id="4542564">extKeyUsage</span>&nbsp;<span class="op" id="4542576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4542581">return</span>&nbsp;<span class="ident" id="4542588">pair</span><span class="op" id="4542592">.</span><span class="ident" id="4542593">oid</span><span class="op" id="4542596">,</span>&nbsp;<span class="builtintype" id="4542598">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542608">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4542611">return</span><br>
<span class="lineno"></span><span class="op" id="4542618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4542621">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4542671">type</span>&nbsp;<span class="ident" id="4542676">Certificate</span>&nbsp;<span class="keyword" id="4542688">struct</span>&nbsp;<span class="op" id="4542695">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4542698">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542722">[</span><span class="op" id="4542723">]</span><span class="builtintype" id="4542724">byte</span>&nbsp;<span class="comment" id="4542729">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4542810">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542834">[</span><span class="op" id="4542835">]</span><span class="builtintype" id="4542836">byte</span>&nbsp;<span class="comment" id="4542841">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4542888">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4542912">[</span><span class="op" id="4542913">]</span><span class="builtintype" id="4542914">byte</span>&nbsp;<span class="comment" id="4542919">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4542957">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4542981">[</span><span class="op" id="4542982">]</span><span class="builtintype" id="4542983">byte</span>&nbsp;<span class="comment" id="4542988">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543012">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4543036">[</span><span class="op" id="4543037">]</span><span class="builtintype" id="4543038">byte</span>&nbsp;<span class="comment" id="4543043">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543067">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4543086">[</span><span class="op" id="4543087">]</span><span class="builtintype" id="4543088">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543094">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4543113">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543134">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4543153">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543173">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4543192">interface</span><span class="op" id="4543201">{</span><span class="op" id="4543202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543206">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4543226">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543231">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4543251">*</span><span class="ident" id="4543252">big</span><span class="op" id="4543255">.</span><span class="ident" id="4543256">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543261">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543281">pkix</span><span class="op" id="4543285">.</span><span class="ident" id="4543286">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543292">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543312">pkix</span><span class="op" id="4543316">.</span><span class="ident" id="4543317">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543323">NotBefore</span><span class="op" id="4543332">,</span>&nbsp;<span class="ident" id="4543334">NotAfter</span>&nbsp;<span class="ident" id="4543343">time</span><span class="op" id="4543347">.</span><span class="ident" id="4543348">Time</span>&nbsp;<span class="comment" id="4543353">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543374">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543394">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4543405">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4543478">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4543547">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4543620">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543663">Extensions</span>&nbsp;<span class="op" id="4543674">[</span><span class="op" id="4543675">]</span><span class="ident" id="4543676">pkix</span><span class="op" id="4543680">.</span><span class="ident" id="4543681">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4543693">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4543761">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4543831">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4543904">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4543974">ExtraExtensions</span>&nbsp;<span class="op" id="4543990">[</span><span class="op" id="4543991">]</span><span class="ident" id="4543992">pkix</span><span class="op" id="4543996">.</span><span class="ident" id="4543997">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544009">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4544028">[</span><span class="op" id="4544029">]</span><span class="ident" id="4544030">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4544052">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544089">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4544108">[</span><span class="op" id="4544109">]</span><span class="ident" id="4544110">asn1</span><span class="op" id="4544114">.</span><span class="ident" id="4544115">ObjectIdentifier</span>&nbsp;<span class="comment" id="4544132">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544194">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4544216">bool</span>&nbsp;<span class="comment" id="4544221">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544269">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4544291">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544297">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4544319">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4544324">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4544390">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4544463">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4544533">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544552">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4544567">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544574">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4544589">[</span><span class="op" id="4544590">]</span><span class="builtintype" id="4544591">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544597">AuthorityKeyId</span>&nbsp;<span class="op" id="4544612">[</span><span class="op" id="4544613">]</span><span class="builtintype" id="4544614">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4544621">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544674">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4544696">[</span><span class="op" id="4544697">]</span><span class="builtintype" id="4544698">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544706">IssuingCertificateURL</span>&nbsp;<span class="op" id="4544728">[</span><span class="op" id="4544729">]</span><span class="builtintype" id="4544730">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4544739">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544773">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4544788">[</span><span class="op" id="4544789">]</span><span class="builtintype" id="4544790">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544798">EmailAddresses</span>&nbsp;<span class="op" id="4544813">[</span><span class="op" id="4544814">]</span><span class="builtintype" id="4544815">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544823">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4544838">[</span><span class="op" id="4544839">]</span><span class="ident" id="4544840">net</span><span class="op" id="4544843">.</span><span class="ident" id="4544844">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4544849">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544870">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4544898">bool</span>&nbsp;<span class="comment" id="4544903">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4544962">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4544990">[</span><span class="op" id="4544991">]</span><span class="builtintype" id="4544992">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4545001">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4545029">CRLDistributionPoints</span>&nbsp;<span class="op" id="4545051">[</span><span class="op" id="4545052">]</span><span class="builtintype" id="4545053">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4545062">PolicyIdentifiers</span>&nbsp;<span class="op" id="4545080">[</span><span class="op" id="4545081">]</span><span class="ident" id="4545082">asn1</span><span class="op" id="4545086">.</span><span class="ident" id="4545087">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4545104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4545107">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4545187">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4545246">var</span>&nbsp;<span class="ident" id="4545250">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4545274">=</span>&nbsp;<span class="ident" id="4545276">errors</span><span class="op" id="4545282">.</span><span class="ident" id="4545283">New</span><span class="op" id="4545286">(</span><span class="string" id="4545287">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4545343">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4545346">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4545425">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4545505">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4545533">type</span>&nbsp;<span class="ident" id="4545538">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4545563">struct</span><span class="op" id="4545569">{</span><span class="op" id="4545570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4545573">func</span>&nbsp;<span class="op" id="4545578">(</span><span class="ident" id="4545579">ConstraintViolationError</span><span class="op" id="4545603">)</span>&nbsp;<span class="ident" id="4545605">Error</span><span class="op" id="4545610">(</span><span class="op" id="4545611">)</span>&nbsp;<span class="builtintype" id="4545613">string</span>&nbsp;<span class="op" id="4545620">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4545623">return</span>&nbsp;<span class="string" id="4545630">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4545713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4545716">func</span>&nbsp;<span class="op" id="4545721">(</span><span class="ident" id="4545722">c</span>&nbsp;<span class="op" id="4545724">*</span><span class="ident" id="4545725">Certificate</span><span class="op" id="4545736">)</span>&nbsp;<span class="ident" id="4545738">Equal</span><span class="op" id="4545743">(</span><span class="ident" id="4545744">other</span>&nbsp;<span class="op" id="4545750">*</span><span class="ident" id="4545751">Certificate</span><span class="op" id="4545762">)</span>&nbsp;<span class="builtintype" id="4545764">bool</span>&nbsp;<span class="op" id="4545769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4545772">return</span>&nbsp;<span class="ident" id="4545779">bytes</span><span class="op" id="4545784">.</span><span class="ident" id="4545785">Equal</span><span class="op" id="4545790">(</span><span class="ident" id="4545791">c</span><span class="op" id="4545792">.</span><span class="ident" id="4545793">Raw</span><span class="op" id="4545796">,</span>&nbsp;<span class="ident" id="4545798">other</span><span class="op" id="4545803">.</span><span class="ident" id="4545804">Raw</span><span class="op" id="4545807">)</span><br>
<span class="lineno">540</span><span class="op" id="4545809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4545812">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4545884">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4545964">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4545986">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4546061">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4546104">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4546170">//</span><br>
<span class="lineno"></span><span class="comment" id="4546173">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4546245">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4546260">var</span>&nbsp;<span class="ident" id="4546264">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4546282">=</span>&nbsp;<span class="op" id="4546284">[</span><span class="op" id="4546285">]</span><span class="builtintype" id="4546286">byte</span><span class="op" id="4546290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546293">0x30</span><span class="op" id="4546297">,</span>&nbsp;<span class="num" id="4546299">0x82</span><span class="op" id="4546303">,</span>&nbsp;<span class="num" id="4546305">0x01</span><span class="op" id="4546309">,</span>&nbsp;<span class="num" id="4546311">0x22</span><span class="op" id="4546315">,</span>&nbsp;<span class="num" id="4546317">0x30</span><span class="op" id="4546321">,</span>&nbsp;<span class="num" id="4546323">0x0d</span><span class="op" id="4546327">,</span>&nbsp;<span class="num" id="4546329">0x06</span><span class="op" id="4546333">,</span>&nbsp;<span class="num" id="4546335">0x09</span><span class="op" id="4546339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546342">0x2a</span><span class="op" id="4546346">,</span>&nbsp;<span class="num" id="4546348">0x86</span><span class="op" id="4546352">,</span>&nbsp;<span class="num" id="4546354">0x48</span><span class="op" id="4546358">,</span>&nbsp;<span class="num" id="4546360">0x86</span><span class="op" id="4546364">,</span>&nbsp;<span class="num" id="4546366">0xf7</span><span class="op" id="4546370">,</span>&nbsp;<span class="num" id="4546372">0x0d</span><span class="op" id="4546376">,</span>&nbsp;<span class="num" id="4546378">0x01</span><span class="op" id="4546382">,</span>&nbsp;<span class="num" id="4546384">0x01</span><span class="op" id="4546388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546391">0x01</span><span class="op" id="4546395">,</span>&nbsp;<span class="num" id="4546397">0x05</span><span class="op" id="4546401">,</span>&nbsp;<span class="num" id="4546403">0x00</span><span class="op" id="4546407">,</span>&nbsp;<span class="num" id="4546409">0x03</span><span class="op" id="4546413">,</span>&nbsp;<span class="num" id="4546415">0x82</span><span class="op" id="4546419">,</span>&nbsp;<span class="num" id="4546421">0x01</span><span class="op" id="4546425">,</span>&nbsp;<span class="num" id="4546427">0x0f</span><span class="op" id="4546431">,</span>&nbsp;<span class="num" id="4546433">0x00</span><span class="op" id="4546437">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546440">0x30</span><span class="op" id="4546444">,</span>&nbsp;<span class="num" id="4546446">0x82</span><span class="op" id="4546450">,</span>&nbsp;<span class="num" id="4546452">0x01</span><span class="op" id="4546456">,</span>&nbsp;<span class="num" id="4546458">0x0a</span><span class="op" id="4546462">,</span>&nbsp;<span class="num" id="4546464">0x02</span><span class="op" id="4546468">,</span>&nbsp;<span class="num" id="4546470">0x82</span><span class="op" id="4546474">,</span>&nbsp;<span class="num" id="4546476">0x01</span><span class="op" id="4546480">,</span>&nbsp;<span class="num" id="4546482">0x01</span><span class="op" id="4546486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546489">0x00</span><span class="op" id="4546493">,</span>&nbsp;<span class="num" id="4546495">0x97</span><span class="op" id="4546499">,</span>&nbsp;<span class="num" id="4546501">0xa3</span><span class="op" id="4546505">,</span>&nbsp;<span class="num" id="4546507">0x2d</span><span class="op" id="4546511">,</span>&nbsp;<span class="num" id="4546513">0x3c</span><span class="op" id="4546517">,</span>&nbsp;<span class="num" id="4546519">0x9e</span><span class="op" id="4546523">,</span>&nbsp;<span class="num" id="4546525">0xde</span><span class="op" id="4546529">,</span>&nbsp;<span class="num" id="4546531">0x05</span><span class="op" id="4546535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546538">0xda</span><span class="op" id="4546542">,</span>&nbsp;<span class="num" id="4546544">0x13</span><span class="op" id="4546548">,</span>&nbsp;<span class="num" id="4546550">0xc2</span><span class="op" id="4546554">,</span>&nbsp;<span class="num" id="4546556">0x11</span><span class="op" id="4546560">,</span>&nbsp;<span class="num" id="4546562">0x8d</span><span class="op" id="4546566">,</span>&nbsp;<span class="num" id="4546568">0x9d</span><span class="op" id="4546572">,</span>&nbsp;<span class="num" id="4546574">0x8e</span><span class="op" id="4546578">,</span>&nbsp;<span class="num" id="4546580">0xe3</span><span class="op" id="4546584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546587">0x7f</span><span class="op" id="4546591">,</span>&nbsp;<span class="num" id="4546593">0xc7</span><span class="op" id="4546597">,</span>&nbsp;<span class="num" id="4546599">0x4b</span><span class="op" id="4546603">,</span>&nbsp;<span class="num" id="4546605">0x7e</span><span class="op" id="4546609">,</span>&nbsp;<span class="num" id="4546611">0x5a</span><span class="op" id="4546615">,</span>&nbsp;<span class="num" id="4546617">0x9f</span><span class="op" id="4546621">,</span>&nbsp;<span class="num" id="4546623">0xb3</span><span class="op" id="4546627">,</span>&nbsp;<span class="num" id="4546629">0xff</span><span class="op" id="4546633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546636">0x62</span><span class="op" id="4546640">,</span>&nbsp;<span class="num" id="4546642">0xab</span><span class="op" id="4546646">,</span>&nbsp;<span class="num" id="4546648">0x73</span><span class="op" id="4546652">,</span>&nbsp;<span class="num" id="4546654">0xc8</span><span class="op" id="4546658">,</span>&nbsp;<span class="num" id="4546660">0x28</span><span class="op" id="4546664">,</span>&nbsp;<span class="num" id="4546666">0x6b</span><span class="op" id="4546670">,</span>&nbsp;<span class="num" id="4546672">0xba</span><span class="op" id="4546676">,</span>&nbsp;<span class="num" id="4546678">0x10</span><span class="op" id="4546682">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546685">0x64</span><span class="op" id="4546689">,</span>&nbsp;<span class="num" id="4546691">0x82</span><span class="op" id="4546695">,</span>&nbsp;<span class="num" id="4546697">0x87</span><span class="op" id="4546701">,</span>&nbsp;<span class="num" id="4546703">0x13</span><span class="op" id="4546707">,</span>&nbsp;<span class="num" id="4546709">0xcd</span><span class="op" id="4546713">,</span>&nbsp;<span class="num" id="4546715">0x57</span><span class="op" id="4546719">,</span>&nbsp;<span class="num" id="4546721">0x18</span><span class="op" id="4546725">,</span>&nbsp;<span class="num" id="4546727">0xff</span><span class="op" id="4546731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546734">0x28</span><span class="op" id="4546738">,</span>&nbsp;<span class="num" id="4546740">0xce</span><span class="op" id="4546744">,</span>&nbsp;<span class="num" id="4546746">0xc0</span><span class="op" id="4546750">,</span>&nbsp;<span class="num" id="4546752">0xe6</span><span class="op" id="4546756">,</span>&nbsp;<span class="num" id="4546758">0x0e</span><span class="op" id="4546762">,</span>&nbsp;<span class="num" id="4546764">0x06</span><span class="op" id="4546768">,</span>&nbsp;<span class="num" id="4546770">0x91</span><span class="op" id="4546774">,</span>&nbsp;<span class="num" id="4546776">0x50</span><span class="op" id="4546780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546783">0x29</span><span class="op" id="4546787">,</span>&nbsp;<span class="num" id="4546789">0x83</span><span class="op" id="4546793">,</span>&nbsp;<span class="num" id="4546795">0xd1</span><span class="op" id="4546799">,</span>&nbsp;<span class="num" id="4546801">0xf2</span><span class="op" id="4546805">,</span>&nbsp;<span class="num" id="4546807">0xc3</span><span class="op" id="4546811">,</span>&nbsp;<span class="num" id="4546813">0x2a</span><span class="op" id="4546817">,</span>&nbsp;<span class="num" id="4546819">0xdb</span><span class="op" id="4546823">,</span>&nbsp;<span class="num" id="4546825">0xd8</span><span class="op" id="4546829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546832">0xdb</span><span class="op" id="4546836">,</span>&nbsp;<span class="num" id="4546838">0x4e</span><span class="op" id="4546842">,</span>&nbsp;<span class="num" id="4546844">0x04</span><span class="op" id="4546848">,</span>&nbsp;<span class="num" id="4546850">0xcc</span><span class="op" id="4546854">,</span>&nbsp;<span class="num" id="4546856">0x00</span><span class="op" id="4546860">,</span>&nbsp;<span class="num" id="4546862">0xeb</span><span class="op" id="4546866">,</span>&nbsp;<span class="num" id="4546868">0x8b</span><span class="op" id="4546872">,</span>&nbsp;<span class="num" id="4546874">0xb6</span><span class="op" id="4546878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546881">0x96</span><span class="op" id="4546885">,</span>&nbsp;<span class="num" id="4546887">0xdc</span><span class="op" id="4546891">,</span>&nbsp;<span class="num" id="4546893">0xbc</span><span class="op" id="4546897">,</span>&nbsp;<span class="num" id="4546899">0xaa</span><span class="op" id="4546903">,</span>&nbsp;<span class="num" id="4546905">0xfa</span><span class="op" id="4546909">,</span>&nbsp;<span class="num" id="4546911">0x52</span><span class="op" id="4546915">,</span>&nbsp;<span class="num" id="4546917">0x77</span><span class="op" id="4546921">,</span>&nbsp;<span class="num" id="4546923">0x04</span><span class="op" id="4546927">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546930">0xc1</span><span class="op" id="4546934">,</span>&nbsp;<span class="num" id="4546936">0xdb</span><span class="op" id="4546940">,</span>&nbsp;<span class="num" id="4546942">0x19</span><span class="op" id="4546946">,</span>&nbsp;<span class="num" id="4546948">0xe4</span><span class="op" id="4546952">,</span>&nbsp;<span class="num" id="4546954">0xae</span><span class="op" id="4546958">,</span>&nbsp;<span class="num" id="4546960">0x9c</span><span class="op" id="4546964">,</span>&nbsp;<span class="num" id="4546966">0xfd</span><span class="op" id="4546970">,</span>&nbsp;<span class="num" id="4546972">0x3c</span><span class="op" id="4546976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4546979">0x8b</span><span class="op" id="4546983">,</span>&nbsp;<span class="num" id="4546985">0x03</span><span class="op" id="4546989">,</span>&nbsp;<span class="num" id="4546991">0xef</span><span class="op" id="4546995">,</span>&nbsp;<span class="num" id="4546997">0x4d</span><span class="op" id="4547001">,</span>&nbsp;<span class="num" id="4547003">0xbc</span><span class="op" id="4547007">,</span>&nbsp;<span class="num" id="4547009">0x1a</span><span class="op" id="4547013">,</span>&nbsp;<span class="num" id="4547015">0x03</span><span class="op" id="4547019">,</span>&nbsp;<span class="num" id="4547021">0x65</span><span class="op" id="4547025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547028">0xf9</span><span class="op" id="4547032">,</span>&nbsp;<span class="num" id="4547034">0xc1</span><span class="op" id="4547038">,</span>&nbsp;<span class="num" id="4547040">0xb1</span><span class="op" id="4547044">,</span>&nbsp;<span class="num" id="4547046">0x3f</span><span class="op" id="4547050">,</span>&nbsp;<span class="num" id="4547052">0x72</span><span class="op" id="4547056">,</span>&nbsp;<span class="num" id="4547058">0x86</span><span class="op" id="4547062">,</span>&nbsp;<span class="num" id="4547064">0xf2</span><span class="op" id="4547068">,</span>&nbsp;<span class="num" id="4547070">0x38</span><span class="op" id="4547074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547077">0xaa</span><span class="op" id="4547081">,</span>&nbsp;<span class="num" id="4547083">0x19</span><span class="op" id="4547087">,</span>&nbsp;<span class="num" id="4547089">0xae</span><span class="op" id="4547093">,</span>&nbsp;<span class="num" id="4547095">0x10</span><span class="op" id="4547099">,</span>&nbsp;<span class="num" id="4547101">0x88</span><span class="op" id="4547105">,</span>&nbsp;<span class="num" id="4547107">0x78</span><span class="op" id="4547111">,</span>&nbsp;<span class="num" id="4547113">0x28</span><span class="op" id="4547117">,</span>&nbsp;<span class="num" id="4547119">0xda</span><span class="op" id="4547123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547126">0x75</span><span class="op" id="4547130">,</span>&nbsp;<span class="num" id="4547132">0xc3</span><span class="op" id="4547136">,</span>&nbsp;<span class="num" id="4547138">0x3d</span><span class="op" id="4547142">,</span>&nbsp;<span class="num" id="4547144">0x02</span><span class="op" id="4547148">,</span>&nbsp;<span class="num" id="4547150">0x82</span><span class="op" id="4547154">,</span>&nbsp;<span class="num" id="4547156">0x02</span><span class="op" id="4547160">,</span>&nbsp;<span class="num" id="4547162">0x9c</span><span class="op" id="4547166">,</span>&nbsp;<span class="num" id="4547168">0xb9</span><span class="op" id="4547172">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547175">0xc1</span><span class="op" id="4547179">,</span>&nbsp;<span class="num" id="4547181">0x65</span><span class="op" id="4547185">,</span>&nbsp;<span class="num" id="4547187">0x77</span><span class="op" id="4547191">,</span>&nbsp;<span class="num" id="4547193">0x76</span><span class="op" id="4547197">,</span>&nbsp;<span class="num" id="4547199">0x24</span><span class="op" id="4547203">,</span>&nbsp;<span class="num" id="4547205">0x4c</span><span class="op" id="4547209">,</span>&nbsp;<span class="num" id="4547211">0x98</span><span class="op" id="4547215">,</span>&nbsp;<span class="num" id="4547217">0xf7</span><span class="op" id="4547221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547224">0x6d</span><span class="op" id="4547228">,</span>&nbsp;<span class="num" id="4547230">0x31</span><span class="op" id="4547234">,</span>&nbsp;<span class="num" id="4547236">0x38</span><span class="op" id="4547240">,</span>&nbsp;<span class="num" id="4547242">0xfb</span><span class="op" id="4547246">,</span>&nbsp;<span class="num" id="4547248">0xdb</span><span class="op" id="4547252">,</span>&nbsp;<span class="num" id="4547254">0xfe</span><span class="op" id="4547258">,</span>&nbsp;<span class="num" id="4547260">0xdb</span><span class="op" id="4547264">,</span>&nbsp;<span class="num" id="4547266">0x37</span><span class="op" id="4547270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547273">0x02</span><span class="op" id="4547277">,</span>&nbsp;<span class="num" id="4547279">0x76</span><span class="op" id="4547283">,</span>&nbsp;<span class="num" id="4547285">0xa1</span><span class="op" id="4547289">,</span>&nbsp;<span class="num" id="4547291">0x18</span><span class="op" id="4547295">,</span>&nbsp;<span class="num" id="4547297">0x97</span><span class="op" id="4547301">,</span>&nbsp;<span class="num" id="4547303">0xa6</span><span class="op" id="4547307">,</span>&nbsp;<span class="num" id="4547309">0xcc</span><span class="op" id="4547313">,</span>&nbsp;<span class="num" id="4547315">0xde</span><span class="op" id="4547319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547322">0x20</span><span class="op" id="4547326">,</span>&nbsp;<span class="num" id="4547328">0x09</span><span class="op" id="4547332">,</span>&nbsp;<span class="num" id="4547334">0x49</span><span class="op" id="4547338">,</span>&nbsp;<span class="num" id="4547340">0x36</span><span class="op" id="4547344">,</span>&nbsp;<span class="num" id="4547346">0x24</span><span class="op" id="4547350">,</span>&nbsp;<span class="num" id="4547352">0x69</span><span class="op" id="4547356">,</span>&nbsp;<span class="num" id="4547358">0x42</span><span class="op" id="4547362">,</span>&nbsp;<span class="num" id="4547364">0xf6</span><span class="op" id="4547368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547371">0xe4</span><span class="op" id="4547375">,</span>&nbsp;<span class="num" id="4547377">0x37</span><span class="op" id="4547381">,</span>&nbsp;<span class="num" id="4547383">0x62</span><span class="op" id="4547387">,</span>&nbsp;<span class="num" id="4547389">0xf1</span><span class="op" id="4547393">,</span>&nbsp;<span class="num" id="4547395">0x59</span><span class="op" id="4547399">,</span>&nbsp;<span class="num" id="4547401">0x6d</span><span class="op" id="4547405">,</span>&nbsp;<span class="num" id="4547407">0xa9</span><span class="op" id="4547411">,</span>&nbsp;<span class="num" id="4547413">0x3c</span><span class="op" id="4547417">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547420">0xed</span><span class="op" id="4547424">,</span>&nbsp;<span class="num" id="4547426">0x34</span><span class="op" id="4547430">,</span>&nbsp;<span class="num" id="4547432">0x9c</span><span class="op" id="4547436">,</span>&nbsp;<span class="num" id="4547438">0xa3</span><span class="op" id="4547442">,</span>&nbsp;<span class="num" id="4547444">0x8e</span><span class="op" id="4547448">,</span>&nbsp;<span class="num" id="4547450">0xdb</span><span class="op" id="4547454">,</span>&nbsp;<span class="num" id="4547456">0xdc</span><span class="op" id="4547460">,</span>&nbsp;<span class="num" id="4547462">0x3a</span><span class="op" id="4547466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547469">0xd7</span><span class="op" id="4547473">,</span>&nbsp;<span class="num" id="4547475">0xf7</span><span class="op" id="4547479">,</span>&nbsp;<span class="num" id="4547481">0x0a</span><span class="op" id="4547485">,</span>&nbsp;<span class="num" id="4547487">0x6f</span><span class="op" id="4547491">,</span>&nbsp;<span class="num" id="4547493">0xef</span><span class="op" id="4547497">,</span>&nbsp;<span class="num" id="4547499">0x2e</span><span class="op" id="4547503">,</span>&nbsp;<span class="num" id="4547505">0xd8</span><span class="op" id="4547509">,</span>&nbsp;<span class="num" id="4547511">0xd5</span><span class="op" id="4547515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547518">0x93</span><span class="op" id="4547522">,</span>&nbsp;<span class="num" id="4547524">0x5a</span><span class="op" id="4547528">,</span>&nbsp;<span class="num" id="4547530">0x7a</span><span class="op" id="4547534">,</span>&nbsp;<span class="num" id="4547536">0xed</span><span class="op" id="4547540">,</span>&nbsp;<span class="num" id="4547542">0x08</span><span class="op" id="4547546">,</span>&nbsp;<span class="num" id="4547548">0x49</span><span class="op" id="4547552">,</span>&nbsp;<span class="num" id="4547554">0x68</span><span class="op" id="4547558">,</span>&nbsp;<span class="num" id="4547560">0xe2</span><span class="op" id="4547564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547567">0x41</span><span class="op" id="4547571">,</span>&nbsp;<span class="num" id="4547573">0xe3</span><span class="op" id="4547577">,</span>&nbsp;<span class="num" id="4547579">0x5a</span><span class="op" id="4547583">,</span>&nbsp;<span class="num" id="4547585">0x90</span><span class="op" id="4547589">,</span>&nbsp;<span class="num" id="4547591">0xc1</span><span class="op" id="4547595">,</span>&nbsp;<span class="num" id="4547597">0x86</span><span class="op" id="4547601">,</span>&nbsp;<span class="num" id="4547603">0x55</span><span class="op" id="4547607">,</span>&nbsp;<span class="num" id="4547609">0xfc</span><span class="op" id="4547613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547616">0x51</span><span class="op" id="4547620">,</span>&nbsp;<span class="num" id="4547622">0x43</span><span class="op" id="4547626">,</span>&nbsp;<span class="num" id="4547628">0x9d</span><span class="op" id="4547632">,</span>&nbsp;<span class="num" id="4547634">0xe0</span><span class="op" id="4547638">,</span>&nbsp;<span class="num" id="4547640">0xb2</span><span class="op" id="4547644">,</span>&nbsp;<span class="num" id="4547646">0xc4</span><span class="op" id="4547650">,</span>&nbsp;<span class="num" id="4547652">0x67</span><span class="op" id="4547656">,</span>&nbsp;<span class="num" id="4547658">0xb4</span><span class="op" id="4547662">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547665">0xcb</span><span class="op" id="4547669">,</span>&nbsp;<span class="num" id="4547671">0x32</span><span class="op" id="4547675">,</span>&nbsp;<span class="num" id="4547677">0x31</span><span class="op" id="4547681">,</span>&nbsp;<span class="num" id="4547683">0x25</span><span class="op" id="4547687">,</span>&nbsp;<span class="num" id="4547689">0xf0</span><span class="op" id="4547693">,</span>&nbsp;<span class="num" id="4547695">0x54</span><span class="op" id="4547699">,</span>&nbsp;<span class="num" id="4547701">0x9f</span><span class="op" id="4547705">,</span>&nbsp;<span class="num" id="4547707">0x4b</span><span class="op" id="4547711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547714">0xd1</span><span class="op" id="4547718">,</span>&nbsp;<span class="num" id="4547720">0x6f</span><span class="op" id="4547724">,</span>&nbsp;<span class="num" id="4547726">0xdb</span><span class="op" id="4547730">,</span>&nbsp;<span class="num" id="4547732">0xd4</span><span class="op" id="4547736">,</span>&nbsp;<span class="num" id="4547738">0xdd</span><span class="op" id="4547742">,</span>&nbsp;<span class="num" id="4547744">0xfc</span><span class="op" id="4547748">,</span>&nbsp;<span class="num" id="4547750">0xaf</span><span class="op" id="4547754">,</span>&nbsp;<span class="num" id="4547756">0x5e</span><span class="op" id="4547760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547763">0x6c</span><span class="op" id="4547767">,</span>&nbsp;<span class="num" id="4547769">0x78</span><span class="op" id="4547773">,</span>&nbsp;<span class="num" id="4547775">0x90</span><span class="op" id="4547779">,</span>&nbsp;<span class="num" id="4547781">0x95</span><span class="op" id="4547785">,</span>&nbsp;<span class="num" id="4547787">0xde</span><span class="op" id="4547791">,</span>&nbsp;<span class="num" id="4547793">0xca</span><span class="op" id="4547797">,</span>&nbsp;<span class="num" id="4547799">0x3a</span><span class="op" id="4547803">,</span>&nbsp;<span class="num" id="4547805">0x48</span><span class="op" id="4547809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547812">0xb9</span><span class="op" id="4547816">,</span>&nbsp;<span class="num" id="4547818">0x79</span><span class="op" id="4547822">,</span>&nbsp;<span class="num" id="4547824">0x3c</span><span class="op" id="4547828">,</span>&nbsp;<span class="num" id="4547830">0x9b</span><span class="op" id="4547834">,</span>&nbsp;<span class="num" id="4547836">0x19</span><span class="op" id="4547840">,</span>&nbsp;<span class="num" id="4547842">0xd6</span><span class="op" id="4547846">,</span>&nbsp;<span class="num" id="4547848">0x75</span><span class="op" id="4547852">,</span>&nbsp;<span class="num" id="4547854">0x05</span><span class="op" id="4547858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547861">0xa0</span><span class="op" id="4547865">,</span>&nbsp;<span class="num" id="4547867">0xf9</span><span class="op" id="4547871">,</span>&nbsp;<span class="num" id="4547873">0x88</span><span class="op" id="4547877">,</span>&nbsp;<span class="num" id="4547879">0xd7</span><span class="op" id="4547883">,</span>&nbsp;<span class="num" id="4547885">0xc1</span><span class="op" id="4547889">,</span>&nbsp;<span class="num" id="4547891">0xe8</span><span class="op" id="4547895">,</span>&nbsp;<span class="num" id="4547897">0xa5</span><span class="op" id="4547901">,</span>&nbsp;<span class="num" id="4547903">0x09</span><span class="op" id="4547907">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547910">0xe4</span><span class="op" id="4547914">,</span>&nbsp;<span class="num" id="4547916">0x1a</span><span class="op" id="4547920">,</span>&nbsp;<span class="num" id="4547922">0x15</span><span class="op" id="4547926">,</span>&nbsp;<span class="num" id="4547928">0xdc</span><span class="op" id="4547932">,</span>&nbsp;<span class="num" id="4547934">0x87</span><span class="op" id="4547938">,</span>&nbsp;<span class="num" id="4547940">0x23</span><span class="op" id="4547944">,</span>&nbsp;<span class="num" id="4547946">0xaa</span><span class="op" id="4547950">,</span>&nbsp;<span class="num" id="4547952">0xb2</span><span class="op" id="4547956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4547959">0x75</span><span class="op" id="4547963">,</span>&nbsp;<span class="num" id="4547965">0x8c</span><span class="op" id="4547969">,</span>&nbsp;<span class="num" id="4547971">0x63</span><span class="op" id="4547975">,</span>&nbsp;<span class="num" id="4547977">0x25</span><span class="op" id="4547981">,</span>&nbsp;<span class="num" id="4547983">0x87</span><span class="op" id="4547987">,</span>&nbsp;<span class="num" id="4547989">0xd8</span><span class="op" id="4547993">,</span>&nbsp;<span class="num" id="4547995">0xf8</span><span class="op" id="4547999">,</span>&nbsp;<span class="num" id="4548001">0x3d</span><span class="op" id="4548005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4548008">0xa6</span><span class="op" id="4548012">,</span>&nbsp;<span class="num" id="4548014">0xc2</span><span class="op" id="4548018">,</span>&nbsp;<span class="num" id="4548020">0xcc</span><span class="op" id="4548024">,</span>&nbsp;<span class="num" id="4548026">0x66</span><span class="op" id="4548030">,</span>&nbsp;<span class="num" id="4548032">0xff</span><span class="op" id="4548036">,</span>&nbsp;<span class="num" id="4548038">0xa5</span><span class="op" id="4548042">,</span>&nbsp;<span class="num" id="4548044">0x66</span><span class="op" id="4548048">,</span>&nbsp;<span class="num" id="4548050">0x68</span><span class="op" id="4548054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4548057">0x55</span><span class="op" id="4548061">,</span>&nbsp;<span class="num" id="4548063">0x02</span><span class="op" id="4548067">,</span>&nbsp;<span class="num" id="4548069">0x03</span><span class="op" id="4548073">,</span>&nbsp;<span class="num" id="4548075">0x01</span><span class="op" id="4548079">,</span>&nbsp;<span class="num" id="4548081">0x00</span><span class="op" id="4548085">,</span>&nbsp;<span class="num" id="4548087">0x01</span><span class="op" id="4548091">,</span><br>
<span class="lineno"></span><span class="op" id="4548093">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4548096">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4548172">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4548188">func</span>&nbsp;<span class="op" id="4548193">(</span><span class="ident" id="4548194">c</span>&nbsp;<span class="op" id="4548196">*</span><span class="ident" id="4548197">Certificate</span><span class="op" id="4548208">)</span>&nbsp;<span class="ident" id="4548210">CheckSignatureFrom</span><span class="op" id="4548228">(</span><span class="ident" id="4548229">parent</span>&nbsp;<span class="op" id="4548236">*</span><span class="ident" id="4548237">Certificate</span><span class="op" id="4548248">)</span>&nbsp;<span class="op" id="4548250">(</span><span class="ident" id="4548251">err</span>&nbsp;<span class="builtintype" id="4548255">error</span><span class="op" id="4548260">)</span>&nbsp;<span class="op" id="4548262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548265">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548288">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548358">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548429">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548500">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548529">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4548591">if</span>&nbsp;<span class="op" id="4548594">(</span><span class="ident" id="4548595">parent</span><span class="op" id="4548601">.</span><span class="ident" id="4548602">Version</span>&nbsp;<span class="op" id="4548610">==</span>&nbsp;<span class="num" id="4548613">3</span>&nbsp;<span class="op" id="4548615">&amp;&amp;</span>&nbsp;<span class="op" id="4548618">!</span><span class="ident" id="4548619">parent</span><span class="op" id="4548625">.</span><span class="ident" id="4548626">BasicConstraintsValid</span>&nbsp;<span class="op" id="4548648">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548653">parent</span><span class="op" id="4548659">.</span><span class="ident" id="4548660">BasicConstraintsValid</span>&nbsp;<span class="op" id="4548682">&amp;&amp;</span>&nbsp;<span class="op" id="4548685">!</span><span class="ident" id="4548686">parent</span><span class="op" id="4548692">.</span><span class="ident" id="4548693">IsCA</span><span class="op" id="4548697">)</span>&nbsp;<span class="op" id="4548699">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4548704">!</span><span class="ident" id="4548705">bytes</span><span class="op" id="4548710">.</span><span class="ident" id="4548711">Equal</span><span class="op" id="4548716">(</span><span class="ident" id="4548717">c</span><span class="op" id="4548718">.</span><span class="ident" id="4548719">RawSubjectPublicKeyInfo</span><span class="op" id="4548742">,</span>&nbsp;<span class="ident" id="4548744">entrustBrokenSPKI</span><span class="op" id="4548761">)</span>&nbsp;<span class="op" id="4548763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4548767">return</span>&nbsp;<span class="ident" id="4548774">ConstraintViolationError</span><span class="op" id="4548798">{</span><span class="op" id="4548799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4548802">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4548806">if</span>&nbsp;<span class="ident" id="4548809">parent</span><span class="op" id="4548815">.</span><span class="ident" id="4548816">KeyUsage</span>&nbsp;<span class="op" id="4548825">!=</span>&nbsp;<span class="num" id="4548828">0</span>&nbsp;<span class="op" id="4548830">&amp;&amp;</span>&nbsp;<span class="ident" id="4548833">parent</span><span class="op" id="4548839">.</span><span class="ident" id="4548840">KeyUsage</span><span class="op" id="4548848">&amp;</span><span class="ident" id="4548849">KeyUsageCertSign</span>&nbsp;<span class="op" id="4548866">==</span>&nbsp;<span class="num" id="4548869">0</span>&nbsp;<span class="op" id="4548871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4548875">return</span>&nbsp;<span class="ident" id="4548882">ConstraintViolationError</span><span class="op" id="4548906">{</span><span class="op" id="4548907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4548910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4548914">if</span>&nbsp;<span class="ident" id="4548917">parent</span><span class="op" id="4548923">.</span><span class="ident" id="4548924">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4548943">==</span>&nbsp;<span class="ident" id="4548946">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4548972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4548976">return</span>&nbsp;<span class="ident" id="4548983">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4549008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4549012">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549069">return</span>&nbsp;<span class="ident" id="4549076">parent</span><span class="op" id="4549082">.</span><span class="ident" id="4549083">CheckSignature</span><span class="op" id="4549097">(</span><span class="ident" id="4549098">c</span><span class="op" id="4549099">.</span><span class="ident" id="4549100">SignatureAlgorithm</span><span class="op" id="4549118">,</span>&nbsp;<span class="ident" id="4549120">c</span><span class="op" id="4549121">.</span><span class="ident" id="4549122">RawTBSCertificate</span><span class="op" id="4549139">,</span>&nbsp;<span class="ident" id="4549141">c</span><span class="op" id="4549142">.</span><span class="ident" id="4549143">Signature</span><span class="op" id="4549152">)</span><br>
<span class="lineno"></span><span class="op" id="4549154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4549157">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4549237">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4549256">func</span>&nbsp;<span class="op" id="4549261">(</span><span class="ident" id="4549262">c</span>&nbsp;<span class="op" id="4549264">*</span><span class="ident" id="4549265">Certificate</span><span class="op" id="4549276">)</span>&nbsp;<span class="ident" id="4549278">CheckSignature</span><span class="op" id="4549292">(</span><span class="ident" id="4549293">algo</span>&nbsp;<span class="ident" id="4549298">SignatureAlgorithm</span><span class="op" id="4549316">,</span>&nbsp;<span class="ident" id="4549318">signed</span><span class="op" id="4549324">,</span>&nbsp;<span class="ident" id="4549326">signature</span>&nbsp;<span class="op" id="4549336">[</span><span class="op" id="4549337">]</span><span class="builtintype" id="4549338">byte</span><span class="op" id="4549342">)</span>&nbsp;<span class="op" id="4549344">(</span><span class="ident" id="4549345">err</span>&nbsp;<span class="builtintype" id="4549349">error</span><span class="op" id="4549354">)</span>&nbsp;<span class="op" id="4549356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549359">var</span>&nbsp;<span class="ident" id="4549363">hashType</span>&nbsp;<span class="ident" id="4549372">crypto</span><span class="op" id="4549378">.</span><span class="ident" id="4549379">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549386">switch</span>&nbsp;<span class="ident" id="4549393">algo</span>&nbsp;<span class="op" id="4549398">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549401">case</span>&nbsp;<span class="ident" id="4549406">SHA1WithRSA</span><span class="op" id="4549417">,</span>&nbsp;<span class="ident" id="4549419">DSAWithSHA1</span><span class="op" id="4549430">,</span>&nbsp;<span class="ident" id="4549432">ECDSAWithSHA1</span><span class="op" id="4549445">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549449">hashType</span>&nbsp;<span class="op" id="4549458">=</span>&nbsp;<span class="ident" id="4549460">crypto</span><span class="op" id="4549466">.</span><span class="ident" id="4549467">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549473">case</span>&nbsp;<span class="ident" id="4549478">SHA256WithRSA</span><span class="op" id="4549491">,</span>&nbsp;<span class="ident" id="4549493">DSAWithSHA256</span><span class="op" id="4549506">,</span>&nbsp;<span class="ident" id="4549508">ECDSAWithSHA256</span><span class="op" id="4549523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549527">hashType</span>&nbsp;<span class="op" id="4549536">=</span>&nbsp;<span class="ident" id="4549538">crypto</span><span class="op" id="4549544">.</span><span class="ident" id="4549545">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549553">case</span>&nbsp;<span class="ident" id="4549558">SHA384WithRSA</span><span class="op" id="4549571">,</span>&nbsp;<span class="ident" id="4549573">ECDSAWithSHA384</span><span class="op" id="4549588">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549592">hashType</span>&nbsp;<span class="op" id="4549601">=</span>&nbsp;<span class="ident" id="4549603">crypto</span><span class="op" id="4549609">.</span><span class="ident" id="4549610">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549618">case</span>&nbsp;<span class="ident" id="4549623">SHA512WithRSA</span><span class="op" id="4549636">,</span>&nbsp;<span class="ident" id="4549638">ECDSAWithSHA512</span><span class="op" id="4549653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549657">hashType</span>&nbsp;<span class="op" id="4549666">=</span>&nbsp;<span class="ident" id="4549668">crypto</span><span class="op" id="4549674">.</span><span class="ident" id="4549675">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549683">default</span><span class="op" id="4549690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549694">return</span>&nbsp;<span class="ident" id="4549701">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4549726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549730">if</span>&nbsp;<span class="op" id="4549733">!</span><span class="ident" id="4549734">hashType</span><span class="op" id="4549742">.</span><span class="ident" id="4549743">Available</span><span class="op" id="4549752">(</span><span class="op" id="4549753">)</span>&nbsp;<span class="op" id="4549755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549759">return</span>&nbsp;<span class="ident" id="4549766">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4549791">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549794">h</span>&nbsp;<span class="op" id="4549796">:=</span>&nbsp;<span class="ident" id="4549799">hashType</span><span class="op" id="4549807">.</span><span class="ident" id="4549808">New</span><span class="op" id="4549811">(</span><span class="op" id="4549812">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549816">h</span><span class="op" id="4549817">.</span><span class="ident" id="4549818">Write</span><span class="op" id="4549823">(</span><span class="ident" id="4549824">signed</span><span class="op" id="4549830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549833">digest</span>&nbsp;<span class="op" id="4549840">:=</span>&nbsp;<span class="ident" id="4549843">h</span><span class="op" id="4549844">.</span><span class="ident" id="4549845">Sum</span><span class="op" id="4549848">(</span><span class="builtintype" id="4549849">nil</span><span class="op" id="4549852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549856">switch</span>&nbsp;<span class="ident" id="4549863">pub</span>&nbsp;<span class="op" id="4549867">:=</span>&nbsp;<span class="ident" id="4549870">c</span><span class="op" id="4549871">.</span><span class="ident" id="4549872">PublicKey</span><span class="op" id="4549881">.</span><span class="op" id="4549882">(</span><span class="keyword" id="4549883">type</span><span class="op" id="4549887">)</span>&nbsp;<span class="op" id="4549889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549892">case</span>&nbsp;<span class="op" id="4549897">*</span><span class="ident" id="4549898">rsa</span><span class="op" id="4549901">.</span><span class="ident" id="4549902">PublicKey</span><span class="op" id="4549911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549915">return</span>&nbsp;<span class="ident" id="4549922">rsa</span><span class="op" id="4549925">.</span><span class="ident" id="4549926">VerifyPKCS1v15</span><span class="op" id="4549940">(</span><span class="ident" id="4549941">pub</span><span class="op" id="4549944">,</span>&nbsp;<span class="ident" id="4549946">hashType</span><span class="op" id="4549954">,</span>&nbsp;<span class="ident" id="4549956">digest</span><span class="op" id="4549962">,</span>&nbsp;<span class="ident" id="4549964">signature</span><span class="op" id="4549973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549976">case</span>&nbsp;<span class="op" id="4549981">*</span><span class="ident" id="4549982">dsa</span><span class="op" id="4549985">.</span><span class="ident" id="4549986">PublicKey</span><span class="op" id="4549995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549999">dsaSig</span>&nbsp;<span class="op" id="4550006">:=</span>&nbsp;<span class="builtinfunc" id="4550009">new</span><span class="op" id="4550012">(</span><span class="ident" id="4550013">dsaSignature</span><span class="op" id="4550025">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550029">if</span>&nbsp;<span class="ident" id="4550032">_</span><span class="op" id="4550033">,</span>&nbsp;<span class="ident" id="4550035">err</span>&nbsp;<span class="op" id="4550039">:=</span>&nbsp;<span class="ident" id="4550042">asn1</span><span class="op" id="4550046">.</span><span class="ident" id="4550047">Unmarshal</span><span class="op" id="4550056">(</span><span class="ident" id="4550057">signature</span><span class="op" id="4550066">,</span>&nbsp;<span class="ident" id="4550068">dsaSig</span><span class="op" id="4550074">)</span><span class="op" id="4550075">;</span>&nbsp;<span class="ident" id="4550077">err</span>&nbsp;<span class="op" id="4550081">!=</span>&nbsp;<span class="builtintype" id="4550084">nil</span>&nbsp;<span class="op" id="4550088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550093">return</span>&nbsp;<span class="ident" id="4550100">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4550106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550110">if</span>&nbsp;<span class="ident" id="4550113">dsaSig</span><span class="op" id="4550119">.</span><span class="ident" id="4550120">R</span><span class="op" id="4550121">.</span><span class="ident" id="4550122">Sign</span><span class="op" id="4550126">(</span><span class="op" id="4550127">)</span>&nbsp;<span class="op" id="4550129">&lt;=</span>&nbsp;<span class="num" id="4550132">0</span>&nbsp;<span class="op" id="4550134">||</span>&nbsp;<span class="ident" id="4550137">dsaSig</span><span class="op" id="4550143">.</span><span class="ident" id="4550144">S</span><span class="op" id="4550145">.</span><span class="ident" id="4550146">Sign</span><span class="op" id="4550150">(</span><span class="op" id="4550151">)</span>&nbsp;<span class="op" id="4550153">&lt;=</span>&nbsp;<span class="num" id="4550156">0</span>&nbsp;<span class="op" id="4550158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550163">return</span>&nbsp;<span class="ident" id="4550170">errors</span><span class="op" id="4550176">.</span><span class="ident" id="4550177">New</span><span class="op" id="4550180">(</span><span class="string" id="4550181">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4550236">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4550240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550244">if</span>&nbsp;<span class="op" id="4550247">!</span><span class="ident" id="4550248">dsa</span><span class="op" id="4550251">.</span><span class="ident" id="4550252">Verify</span><span class="op" id="4550258">(</span><span class="ident" id="4550259">pub</span><span class="op" id="4550262">,</span>&nbsp;<span class="ident" id="4550264">digest</span><span class="op" id="4550270">,</span>&nbsp;<span class="ident" id="4550272">dsaSig</span><span class="op" id="4550278">.</span><span class="ident" id="4550279">R</span><span class="op" id="4550280">,</span>&nbsp;<span class="ident" id="4550282">dsaSig</span><span class="op" id="4550288">.</span><span class="ident" id="4550289">S</span><span class="op" id="4550290">)</span>&nbsp;<span class="op" id="4550292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550297">return</span>&nbsp;<span class="ident" id="4550304">errors</span><span class="op" id="4550310">.</span><span class="ident" id="4550311">New</span><span class="op" id="4550314">(</span><span class="string" id="4550315">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4550347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4550351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550355">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550363">case</span>&nbsp;<span class="op" id="4550368">*</span><span class="ident" id="4550369">ecdsa</span><span class="op" id="4550374">.</span><span class="ident" id="4550375">PublicKey</span><span class="op" id="4550384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550388">ecdsaSig</span>&nbsp;<span class="op" id="4550397">:=</span>&nbsp;<span class="builtinfunc" id="4550400">new</span><span class="op" id="4550403">(</span><span class="ident" id="4550404">ecdsaSignature</span><span class="op" id="4550418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550422">if</span>&nbsp;<span class="ident" id="4550425">_</span><span class="op" id="4550426">,</span>&nbsp;<span class="ident" id="4550428">err</span>&nbsp;<span class="op" id="4550432">:=</span>&nbsp;<span class="ident" id="4550435">asn1</span><span class="op" id="4550439">.</span><span class="ident" id="4550440">Unmarshal</span><span class="op" id="4550449">(</span><span class="ident" id="4550450">signature</span><span class="op" id="4550459">,</span>&nbsp;<span class="ident" id="4550461">ecdsaSig</span><span class="op" id="4550469">)</span><span class="op" id="4550470">;</span>&nbsp;<span class="ident" id="4550472">err</span>&nbsp;<span class="op" id="4550476">!=</span>&nbsp;<span class="builtintype" id="4550479">nil</span>&nbsp;<span class="op" id="4550483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550488">return</span>&nbsp;<span class="ident" id="4550495">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4550501">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550505">if</span>&nbsp;<span class="ident" id="4550508">ecdsaSig</span><span class="op" id="4550516">.</span><span class="ident" id="4550517">R</span><span class="op" id="4550518">.</span><span class="ident" id="4550519">Sign</span><span class="op" id="4550523">(</span><span class="op" id="4550524">)</span>&nbsp;<span class="op" id="4550526">&lt;=</span>&nbsp;<span class="num" id="4550529">0</span>&nbsp;<span class="op" id="4550531">||</span>&nbsp;<span class="ident" id="4550534">ecdsaSig</span><span class="op" id="4550542">.</span><span class="ident" id="4550543">S</span><span class="op" id="4550544">.</span><span class="ident" id="4550545">Sign</span><span class="op" id="4550549">(</span><span class="op" id="4550550">)</span>&nbsp;<span class="op" id="4550552">&lt;=</span>&nbsp;<span class="num" id="4550555">0</span>&nbsp;<span class="op" id="4550557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550562">return</span>&nbsp;<span class="ident" id="4550569">errors</span><span class="op" id="4550575">.</span><span class="ident" id="4550576">New</span><span class="op" id="4550579">(</span><span class="string" id="4550580">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4550637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4550641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550645">if</span>&nbsp;<span class="op" id="4550648">!</span><span class="ident" id="4550649">ecdsa</span><span class="op" id="4550654">.</span><span class="ident" id="4550655">Verify</span><span class="op" id="4550661">(</span><span class="ident" id="4550662">pub</span><span class="op" id="4550665">,</span>&nbsp;<span class="ident" id="4550667">digest</span><span class="op" id="4550673">,</span>&nbsp;<span class="ident" id="4550675">ecdsaSig</span><span class="op" id="4550683">.</span><span class="ident" id="4550684">R</span><span class="op" id="4550685">,</span>&nbsp;<span class="ident" id="4550687">ecdsaSig</span><span class="op" id="4550695">.</span><span class="ident" id="4550696">S</span><span class="op" id="4550697">)</span>&nbsp;<span class="op" id="4550699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550704">return</span>&nbsp;<span class="ident" id="4550711">errors</span><span class="op" id="4550717">.</span><span class="ident" id="4550718">New</span><span class="op" id="4550721">(</span><span class="string" id="4550722">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4550756">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4550760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550764">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4550772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550775">return</span>&nbsp;<span class="ident" id="4550782">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4550806">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4550809">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4550874">func</span>&nbsp;<span class="op" id="4550879">(</span><span class="ident" id="4550880">c</span>&nbsp;<span class="op" id="4550882">*</span><span class="ident" id="4550883">Certificate</span><span class="op" id="4550894">)</span>&nbsp;<span class="ident" id="4550896">CheckCRLSignature</span><span class="op" id="4550913">(</span><span class="ident" id="4550914">crl</span>&nbsp;<span class="op" id="4550918">*</span><span class="ident" id="4550919">pkix</span><span class="op" id="4550923">.</span><span class="ident" id="4550924">CertificateList</span><span class="op" id="4550939">)</span>&nbsp;<span class="op" id="4550941">(</span><span class="ident" id="4550942">err</span>&nbsp;<span class="builtintype" id="4550946">error</span><span class="op" id="4550951">)</span>&nbsp;<span class="op" id="4550953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550956">algo</span>&nbsp;<span class="op" id="4550961">:=</span>&nbsp;<span class="ident" id="4550964">getSignatureAlgorithmFromOID</span><span class="op" id="4550992">(</span><span class="ident" id="4550993">crl</span><span class="op" id="4550996">.</span><span class="ident" id="4550997">SignatureAlgorithm</span><span class="op" id="4551015">.</span><span class="ident" id="4551016">Algorithm</span><span class="op" id="4551025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4551028">return</span>&nbsp;<span class="ident" id="4551035">c</span><span class="op" id="4551036">.</span><span class="ident" id="4551037">CheckSignature</span><span class="op" id="4551051">(</span><span class="ident" id="4551052">algo</span><span class="op" id="4551056">,</span>&nbsp;<span class="ident" id="4551058">crl</span><span class="op" id="4551061">.</span><span class="ident" id="4551062">TBSCertList</span><span class="op" id="4551073">.</span><span class="ident" id="4551074">Raw</span><span class="op" id="4551077">,</span>&nbsp;<span class="ident" id="4551079">crl</span><span class="op" id="4551082">.</span><span class="ident" id="4551083">SignatureValue</span><span class="op" id="4551097">.</span><span class="ident" id="4551098">RightAlign</span><span class="op" id="4551108">(</span><span class="op" id="4551109">)</span><span class="op" id="4551110">)</span><br>
<span class="lineno">680</span><span class="op" id="4551112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4551115">type</span>&nbsp;<span class="ident" id="4551120">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4551147">struct</span><span class="op" id="4551153">{</span><span class="op" id="4551154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4551157">func</span>&nbsp;<span class="op" id="4551162">(</span><span class="ident" id="4551163">h</span>&nbsp;<span class="ident" id="4551165">UnhandledCriticalExtension</span><span class="op" id="4551191">)</span>&nbsp;<span class="ident" id="4551193">Error</span><span class="op" id="4551198">(</span><span class="op" id="4551199">)</span>&nbsp;<span class="builtintype" id="4551201">string</span>&nbsp;<span class="op" id="4551208">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4551211">return</span>&nbsp;<span class="string" id="4551218">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4551255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4551258">type</span>&nbsp;<span class="ident" id="4551263">basicConstraints</span>&nbsp;<span class="keyword" id="4551280">struct</span>&nbsp;<span class="op" id="4551287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551290">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4551301">bool</span>&nbsp;<span class="string" id="4551306">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551325">MaxPathLen</span>&nbsp;<span class="builtintype" id="4551336">int</span>&nbsp;&nbsp;<span class="string" id="4551341">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4551370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4551373">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4551393">type</span>&nbsp;<span class="ident" id="4551398">policyInformation</span>&nbsp;<span class="keyword" id="4551416">struct</span>&nbsp;<span class="op" id="4551423">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551426">Policy</span>&nbsp;<span class="ident" id="4551433">asn1</span><span class="op" id="4551437">.</span><span class="ident" id="4551438">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4551456">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4551484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4551487">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4551509">type</span>&nbsp;<span class="ident" id="4551514">nameConstraints</span>&nbsp;<span class="keyword" id="4551530">struct</span>&nbsp;<span class="op" id="4551537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551540">Permitted</span>&nbsp;<span class="op" id="4551550">[</span><span class="op" id="4551551">]</span><span class="ident" id="4551552">generalSubtree</span>&nbsp;<span class="string" id="4551567">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551592">Excluded</span>&nbsp;&nbsp;<span class="op" id="4551602">[</span><span class="op" id="4551603">]</span><span class="ident" id="4551604">generalSubtree</span>&nbsp;<span class="string" id="4551619">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4551643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4551646">type</span>&nbsp;<span class="ident" id="4551651">generalSubtree</span>&nbsp;<span class="keyword" id="4551666">struct</span>&nbsp;<span class="op" id="4551673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551676">Name</span>&nbsp;<span class="builtintype" id="4551681">string</span>&nbsp;<span class="string" id="4551688">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4551716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4551719">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4551740">type</span>&nbsp;<span class="ident" id="4551745">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4551765">struct</span>&nbsp;<span class="op" id="4551772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551775">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4551784">asn1</span><span class="op" id="4551788">.</span><span class="ident" id="4551789">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551807">Location</span>&nbsp;<span class="ident" id="4551816">asn1</span><span class="op" id="4551820">.</span><span class="ident" id="4551821">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4551830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4551833">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4551855">type</span>&nbsp;<span class="ident" id="4551860">distributionPoint</span>&nbsp;<span class="keyword" id="4551878">struct</span>&nbsp;<span class="op" id="4551885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551888">DistributionPoint</span>&nbsp;<span class="ident" id="4551906">distributionPointName</span>&nbsp;<span class="string" id="4551928">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551953">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551971">asn1</span><span class="op" id="4551975">.</span><span class="ident" id="4551976">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4551993">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552018">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552036">asn1</span><span class="op" id="4552040">.</span><span class="ident" id="4552041">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4552058">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4552082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4552085">type</span>&nbsp;<span class="ident" id="4552090">distributionPointName</span>&nbsp;<span class="keyword" id="4552112">struct</span>&nbsp;<span class="op" id="4552119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552122">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552135">asn1</span><span class="op" id="4552139">.</span><span class="ident" id="4552140">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4552152">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552177">RelativeName</span>&nbsp;<span class="ident" id="4552190">pkix</span><span class="op" id="4552194">.</span><span class="ident" id="4552195">RDNSequence</span>&nbsp;<span class="string" id="4552207">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4552231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4552234">func</span>&nbsp;<span class="ident" id="4552239">parsePublicKey</span><span class="op" id="4552253">(</span><span class="ident" id="4552254">algo</span>&nbsp;<span class="ident" id="4552259">PublicKeyAlgorithm</span><span class="op" id="4552277">,</span>&nbsp;<span class="ident" id="4552279">keyData</span>&nbsp;<span class="op" id="4552287">*</span><span class="ident" id="4552288">publicKeyInfo</span><span class="op" id="4552301">)</span>&nbsp;<span class="op" id="4552303">(</span><span class="keyword" id="4552304">interface</span><span class="op" id="4552313">{</span><span class="op" id="4552314">}</span><span class="op" id="4552315">,</span>&nbsp;<span class="builtintype" id="4552317">error</span><span class="op" id="4552322">)</span>&nbsp;<span class="op" id="4552324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552327">asn1Data</span>&nbsp;<span class="op" id="4552336">:=</span>&nbsp;<span class="ident" id="4552339">keyData</span><span class="op" id="4552346">.</span><span class="ident" id="4552347">PublicKey</span><span class="op" id="4552356">.</span><span class="ident" id="4552357">RightAlign</span><span class="op" id="4552367">(</span><span class="op" id="4552368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552371">switch</span>&nbsp;<span class="ident" id="4552378">algo</span>&nbsp;<span class="op" id="4552383">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552386">case</span>&nbsp;<span class="ident" id="4552391">RSA</span><span class="op" id="4552394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552398">p</span>&nbsp;<span class="op" id="4552400">:=</span>&nbsp;<span class="builtinfunc" id="4552403">new</span><span class="op" id="4552406">(</span><span class="ident" id="4552407">rsaPublicKey</span><span class="op" id="4552419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552423">_</span><span class="op" id="4552424">,</span>&nbsp;<span class="ident" id="4552426">err</span>&nbsp;<span class="op" id="4552430">:=</span>&nbsp;<span class="ident" id="4552433">asn1</span><span class="op" id="4552437">.</span><span class="ident" id="4552438">Unmarshal</span><span class="op" id="4552447">(</span><span class="ident" id="4552448">asn1Data</span><span class="op" id="4552456">,</span>&nbsp;<span class="ident" id="4552458">p</span><span class="op" id="4552459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552463">if</span>&nbsp;<span class="ident" id="4552466">err</span>&nbsp;<span class="op" id="4552470">!=</span>&nbsp;<span class="builtintype" id="4552473">nil</span>&nbsp;<span class="op" id="4552477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552482">return</span>&nbsp;<span class="builtintype" id="4552489">nil</span><span class="op" id="4552492">,</span>&nbsp;<span class="ident" id="4552494">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4552500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552505">if</span>&nbsp;<span class="ident" id="4552508">p</span><span class="op" id="4552509">.</span><span class="ident" id="4552510">N</span><span class="op" id="4552511">.</span><span class="ident" id="4552512">Sign</span><span class="op" id="4552516">(</span><span class="op" id="4552517">)</span>&nbsp;<span class="op" id="4552519">&lt;=</span>&nbsp;<span class="num" id="4552522">0</span>&nbsp;<span class="op" id="4552524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552529">return</span>&nbsp;<span class="builtintype" id="4552536">nil</span><span class="op" id="4552539">,</span>&nbsp;<span class="ident" id="4552541">errors</span><span class="op" id="4552547">.</span><span class="ident" id="4552548">New</span><span class="op" id="4552551">(</span><span class="string" id="4552552">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4552596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4552600">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552604">if</span>&nbsp;<span class="ident" id="4552607">p</span><span class="op" id="4552608">.</span><span class="ident" id="4552609">E</span>&nbsp;<span class="op" id="4552611">&lt;=</span>&nbsp;<span class="num" id="4552614">0</span>&nbsp;<span class="op" id="4552616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552621">return</span>&nbsp;<span class="builtintype" id="4552628">nil</span><span class="op" id="4552631">,</span>&nbsp;<span class="ident" id="4552633">errors</span><span class="op" id="4552639">.</span><span class="ident" id="4552640">New</span><span class="op" id="4552643">(</span><span class="string" id="4552644">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4552696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4552700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552705">pub</span>&nbsp;<span class="op" id="4552709">:=</span>&nbsp;<span class="op" id="4552712">&amp;</span><span class="ident" id="4552713">rsa</span><span class="op" id="4552716">.</span><span class="ident" id="4552717">PublicKey</span><span class="op" id="4552726">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552731">E</span><span class="op" id="4552732">:</span>&nbsp;<span class="ident" id="4552734">p</span><span class="op" id="4552735">.</span><span class="ident" id="4552736">E</span><span class="op" id="4552737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552742">N</span><span class="op" id="4552743">:</span>&nbsp;<span class="ident" id="4552745">p</span><span class="op" id="4552746">.</span><span class="ident" id="4552747">N</span><span class="op" id="4552748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4552752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552756">return</span>&nbsp;<span class="ident" id="4552763">pub</span><span class="op" id="4552766">,</span>&nbsp;<span class="builtintype" id="4552768">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552773">case</span>&nbsp;<span class="ident" id="4552778">DSA</span><span class="op" id="4552781">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552785">var</span>&nbsp;<span class="ident" id="4552789">p</span>&nbsp;<span class="op" id="4552791">*</span><span class="ident" id="4552792">big</span><span class="op" id="4552795">.</span><span class="ident" id="4552796">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552802">_</span><span class="op" id="4552803">,</span>&nbsp;<span class="ident" id="4552805">err</span>&nbsp;<span class="op" id="4552809">:=</span>&nbsp;<span class="ident" id="4552812">asn1</span><span class="op" id="4552816">.</span><span class="ident" id="4552817">Unmarshal</span><span class="op" id="4552826">(</span><span class="ident" id="4552827">asn1Data</span><span class="op" id="4552835">,</span>&nbsp;<span class="op" id="4552837">&amp;</span><span class="ident" id="4552838">p</span><span class="op" id="4552839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552843">if</span>&nbsp;<span class="ident" id="4552846">err</span>&nbsp;<span class="op" id="4552850">!=</span>&nbsp;<span class="builtintype" id="4552853">nil</span>&nbsp;<span class="op" id="4552857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552862">return</span>&nbsp;<span class="builtintype" id="4552869">nil</span><span class="op" id="4552872">,</span>&nbsp;<span class="ident" id="4552874">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4552880">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552884">paramsData</span>&nbsp;<span class="op" id="4552895">:=</span>&nbsp;<span class="ident" id="4552898">keyData</span><span class="op" id="4552905">.</span><span class="ident" id="4552906">Algorithm</span><span class="op" id="4552915">.</span><span class="ident" id="4552916">Parameters</span><span class="op" id="4552926">.</span><span class="ident" id="4552927">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552939">params</span>&nbsp;<span class="op" id="4552946">:=</span>&nbsp;<span class="builtinfunc" id="4552949">new</span><span class="op" id="4552952">(</span><span class="ident" id="4552953">dsaAlgorithmParameters</span><span class="op" id="4552975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552979">_</span><span class="op" id="4552980">,</span>&nbsp;<span class="ident" id="4552982">err</span>&nbsp;<span class="op" id="4552986">=</span>&nbsp;<span class="ident" id="4552988">asn1</span><span class="op" id="4552992">.</span><span class="ident" id="4552993">Unmarshal</span><span class="op" id="4553002">(</span><span class="ident" id="4553003">paramsData</span><span class="op" id="4553013">,</span>&nbsp;<span class="ident" id="4553015">params</span><span class="op" id="4553021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553025">if</span>&nbsp;<span class="ident" id="4553028">err</span>&nbsp;<span class="op" id="4553032">!=</span>&nbsp;<span class="builtintype" id="4553035">nil</span>&nbsp;<span class="op" id="4553039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553044">return</span>&nbsp;<span class="builtintype" id="4553051">nil</span><span class="op" id="4553054">,</span>&nbsp;<span class="ident" id="4553056">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553066">if</span>&nbsp;<span class="ident" id="4553069">p</span><span class="op" id="4553070">.</span><span class="ident" id="4553071">Sign</span><span class="op" id="4553075">(</span><span class="op" id="4553076">)</span>&nbsp;<span class="op" id="4553078">&lt;=</span>&nbsp;<span class="num" id="4553081">0</span>&nbsp;<span class="op" id="4553083">||</span>&nbsp;<span class="ident" id="4553086">params</span><span class="op" id="4553092">.</span><span class="ident" id="4553093">P</span><span class="op" id="4553094">.</span><span class="ident" id="4553095">Sign</span><span class="op" id="4553099">(</span><span class="op" id="4553100">)</span>&nbsp;<span class="op" id="4553102">&lt;=</span>&nbsp;<span class="num" id="4553105">0</span>&nbsp;<span class="op" id="4553107">||</span>&nbsp;<span class="ident" id="4553110">params</span><span class="op" id="4553116">.</span><span class="ident" id="4553117">Q</span><span class="op" id="4553118">.</span><span class="ident" id="4553119">Sign</span><span class="op" id="4553123">(</span><span class="op" id="4553124">)</span>&nbsp;<span class="op" id="4553126">&lt;=</span>&nbsp;<span class="num" id="4553129">0</span>&nbsp;<span class="op" id="4553131">||</span>&nbsp;<span class="ident" id="4553134">params</span><span class="op" id="4553140">.</span><span class="ident" id="4553141">G</span><span class="op" id="4553142">.</span><span class="ident" id="4553143">Sign</span><span class="op" id="4553147">(</span><span class="op" id="4553148">)</span>&nbsp;<span class="op" id="4553150">&lt;=</span>&nbsp;<span class="num" id="4553153">0</span>&nbsp;<span class="op" id="4553155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553160">return</span>&nbsp;<span class="builtintype" id="4553167">nil</span><span class="op" id="4553170">,</span>&nbsp;<span class="ident" id="4553172">errors</span><span class="op" id="4553178">.</span><span class="ident" id="4553179">New</span><span class="op" id="4553182">(</span><span class="string" id="4553183">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4553221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553229">pub</span>&nbsp;<span class="op" id="4553233">:=</span>&nbsp;<span class="op" id="4553236">&amp;</span><span class="ident" id="4553237">dsa</span><span class="op" id="4553240">.</span><span class="ident" id="4553241">PublicKey</span><span class="op" id="4553250">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553255">Parameters</span><span class="op" id="4553265">:</span>&nbsp;<span class="ident" id="4553267">dsa</span><span class="op" id="4553270">.</span><span class="ident" id="4553271">Parameters</span><span class="op" id="4553281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553287">P</span><span class="op" id="4553288">:</span>&nbsp;<span class="ident" id="4553290">params</span><span class="op" id="4553296">.</span><span class="ident" id="4553297">P</span><span class="op" id="4553298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553304">Q</span><span class="op" id="4553305">:</span>&nbsp;<span class="ident" id="4553307">params</span><span class="op" id="4553313">.</span><span class="ident" id="4553314">Q</span><span class="op" id="4553315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553321">G</span><span class="op" id="4553322">:</span>&nbsp;<span class="ident" id="4553324">params</span><span class="op" id="4553330">.</span><span class="ident" id="4553331">G</span><span class="op" id="4553332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553337">}</span><span class="op" id="4553338">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553343">Y</span><span class="op" id="4553344">:</span>&nbsp;<span class="ident" id="4553346">p</span><span class="op" id="4553347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553355">return</span>&nbsp;<span class="ident" id="4553362">pub</span><span class="op" id="4553365">,</span>&nbsp;<span class="builtintype" id="4553367">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553372">case</span>&nbsp;<span class="ident" id="4553377">ECDSA</span><span class="op" id="4553382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553386">paramsData</span>&nbsp;<span class="op" id="4553397">:=</span>&nbsp;<span class="ident" id="4553400">keyData</span><span class="op" id="4553407">.</span><span class="ident" id="4553408">Algorithm</span><span class="op" id="4553417">.</span><span class="ident" id="4553418">Parameters</span><span class="op" id="4553428">.</span><span class="ident" id="4553429">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553441">namedCurveOID</span>&nbsp;<span class="op" id="4553455">:=</span>&nbsp;<span class="builtinfunc" id="4553458">new</span><span class="op" id="4553461">(</span><span class="ident" id="4553462">asn1</span><span class="op" id="4553466">.</span><span class="ident" id="4553467">ObjectIdentifier</span><span class="op" id="4553483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553487">_</span><span class="op" id="4553488">,</span>&nbsp;<span class="ident" id="4553490">err</span>&nbsp;<span class="op" id="4553494">:=</span>&nbsp;<span class="ident" id="4553497">asn1</span><span class="op" id="4553501">.</span><span class="ident" id="4553502">Unmarshal</span><span class="op" id="4553511">(</span><span class="ident" id="4553512">paramsData</span><span class="op" id="4553522">,</span>&nbsp;<span class="ident" id="4553524">namedCurveOID</span><span class="op" id="4553537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553541">if</span>&nbsp;<span class="ident" id="4553544">err</span>&nbsp;<span class="op" id="4553548">!=</span>&nbsp;<span class="builtintype" id="4553551">nil</span>&nbsp;<span class="op" id="4553555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553560">return</span>&nbsp;<span class="builtintype" id="4553567">nil</span><span class="op" id="4553570">,</span>&nbsp;<span class="ident" id="4553572">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553578">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553582">namedCurve</span>&nbsp;<span class="op" id="4553593">:=</span>&nbsp;<span class="ident" id="4553596">namedCurveFromOID</span><span class="op" id="4553613">(</span><span class="op" id="4553614">*</span><span class="ident" id="4553615">namedCurveOID</span><span class="op" id="4553628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553632">if</span>&nbsp;<span class="ident" id="4553635">namedCurve</span>&nbsp;<span class="op" id="4553646">==</span>&nbsp;<span class="builtintype" id="4553649">nil</span>&nbsp;<span class="op" id="4553653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553658">return</span>&nbsp;<span class="builtintype" id="4553665">nil</span><span class="op" id="4553668">,</span>&nbsp;<span class="ident" id="4553670">errors</span><span class="op" id="4553676">.</span><span class="ident" id="4553677">New</span><span class="op" id="4553680">(</span><span class="string" id="4553681">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4553715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553723">x</span><span class="op" id="4553724">,</span>&nbsp;<span class="ident" id="4553726">y</span>&nbsp;<span class="op" id="4553728">:=</span>&nbsp;<span class="ident" id="4553731">elliptic</span><span class="op" id="4553739">.</span><span class="ident" id="4553740">Unmarshal</span><span class="op" id="4553749">(</span><span class="ident" id="4553750">namedCurve</span><span class="op" id="4553760">,</span>&nbsp;<span class="ident" id="4553762">asn1Data</span><span class="op" id="4553770">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553774">if</span>&nbsp;<span class="ident" id="4553777">x</span>&nbsp;<span class="op" id="4553779">==</span>&nbsp;<span class="builtintype" id="4553782">nil</span>&nbsp;<span class="op" id="4553786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553791">return</span>&nbsp;<span class="builtintype" id="4553798">nil</span><span class="op" id="4553801">,</span>&nbsp;<span class="ident" id="4553803">errors</span><span class="op" id="4553809">.</span><span class="ident" id="4553810">New</span><span class="op" id="4553813">(</span><span class="string" id="4553814">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4553862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553870">pub</span>&nbsp;<span class="op" id="4553874">:=</span>&nbsp;<span class="op" id="4553877">&amp;</span><span class="ident" id="4553878">ecdsa</span><span class="op" id="4553883">.</span><span class="ident" id="4553884">PublicKey</span><span class="op" id="4553893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553898">Curve</span><span class="op" id="4553903">:</span>&nbsp;<span class="ident" id="4553905">namedCurve</span><span class="op" id="4553915">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553920">X</span><span class="op" id="4553921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553927">x</span><span class="op" id="4553928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553933">Y</span><span class="op" id="4553934">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553940">y</span><span class="op" id="4553941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553949">return</span>&nbsp;<span class="ident" id="4553956">pub</span><span class="op" id="4553959">,</span>&nbsp;<span class="builtintype" id="4553961">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553966">default</span><span class="op" id="4553973">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553977">return</span>&nbsp;<span class="builtintype" id="4553984">nil</span><span class="op" id="4553987">,</span>&nbsp;<span class="builtintype" id="4553989">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553994">}</span><br>
<span class="lineno"></span><span class="op" id="4553996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4553999">func</span>&nbsp;<span class="ident" id="4554004">parseSANExtension</span><span class="op" id="4554021">(</span><span class="ident" id="4554022">value</span>&nbsp;<span class="op" id="4554028">[</span><span class="op" id="4554029">]</span><span class="builtintype" id="4554030">byte</span><span class="op" id="4554034">)</span>&nbsp;<span class="op" id="4554036">(</span><span class="ident" id="4554037">dnsNames</span><span class="op" id="4554045">,</span>&nbsp;<span class="ident" id="4554047">emailAddresses</span>&nbsp;<span class="op" id="4554062">[</span><span class="op" id="4554063">]</span><span class="builtintype" id="4554064">string</span><span class="op" id="4554070">,</span>&nbsp;<span class="ident" id="4554072">ipAddresses</span>&nbsp;<span class="op" id="4554084">[</span><span class="op" id="4554085">]</span><span class="ident" id="4554086">net</span><span class="op" id="4554089">.</span><span class="ident" id="4554090">IP</span><span class="op" id="4554092">,</span>&nbsp;<span class="ident" id="4554094">err</span>&nbsp;<span class="builtintype" id="4554098">error</span><span class="op" id="4554103">)</span>&nbsp;<span class="op" id="4554105">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554108">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554131">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554167">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554171">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554230">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554234">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554263">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554323">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554383">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554443">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554503">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554558">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554621">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554681">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554744">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4554813">var</span>&nbsp;<span class="ident" id="4554817">seq</span>&nbsp;<span class="ident" id="4554821">asn1</span><span class="op" id="4554825">.</span><span class="ident" id="4554826">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4554836">if</span>&nbsp;<span class="ident" id="4554839">_</span><span class="op" id="4554840">,</span>&nbsp;<span class="ident" id="4554842">err</span>&nbsp;<span class="op" id="4554846">=</span>&nbsp;<span class="ident" id="4554848">asn1</span><span class="op" id="4554852">.</span><span class="ident" id="4554853">Unmarshal</span><span class="op" id="4554862">(</span><span class="ident" id="4554863">value</span><span class="op" id="4554868">,</span>&nbsp;<span class="op" id="4554870">&amp;</span><span class="ident" id="4554871">seq</span><span class="op" id="4554874">)</span><span class="op" id="4554875">;</span>&nbsp;<span class="ident" id="4554877">err</span>&nbsp;<span class="op" id="4554881">!=</span>&nbsp;<span class="builtintype" id="4554884">nil</span>&nbsp;<span class="op" id="4554888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4554892">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4554900">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4554903">if</span>&nbsp;<span class="op" id="4554906">!</span><span class="ident" id="4554907">seq</span><span class="op" id="4554910">.</span><span class="ident" id="4554911">IsCompound</span>&nbsp;<span class="op" id="4554922">||</span>&nbsp;<span class="ident" id="4554925">seq</span><span class="op" id="4554928">.</span><span class="ident" id="4554929">Tag</span>&nbsp;<span class="op" id="4554933">!=</span>&nbsp;<span class="num" id="4554936">16</span>&nbsp;<span class="op" id="4554939">||</span>&nbsp;<span class="ident" id="4554942">seq</span><span class="op" id="4554945">.</span><span class="ident" id="4554946">Class</span>&nbsp;<span class="op" id="4554952">!=</span>&nbsp;<span class="num" id="4554955">0</span>&nbsp;<span class="op" id="4554957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4554961">err</span>&nbsp;<span class="op" id="4554965">=</span>&nbsp;<span class="ident" id="4554967">asn1</span><span class="op" id="4554971">.</span><span class="ident" id="4554972">StructuralError</span><span class="op" id="4554987">{</span><span class="ident" id="4554988">Msg</span><span class="op" id="4554991">:</span>&nbsp;<span class="string" id="4554993">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4555011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555015">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4555023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555027">rest</span>&nbsp;<span class="op" id="4555032">:=</span>&nbsp;<span class="ident" id="4555035">seq</span><span class="op" id="4555038">.</span><span class="ident" id="4555039">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555046">for</span>&nbsp;<span class="builtinfunc" id="4555050">len</span><span class="op" id="4555053">(</span><span class="ident" id="4555054">rest</span><span class="op" id="4555058">)</span>&nbsp;<span class="op" id="4555060">&gt;</span>&nbsp;<span class="num" id="4555062">0</span>&nbsp;<span class="op" id="4555064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555068">var</span>&nbsp;<span class="ident" id="4555072">v</span>&nbsp;<span class="ident" id="4555074">asn1</span><span class="op" id="4555078">.</span><span class="ident" id="4555079">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555090">rest</span><span class="op" id="4555094">,</span>&nbsp;<span class="ident" id="4555096">err</span>&nbsp;<span class="op" id="4555100">=</span>&nbsp;<span class="ident" id="4555102">asn1</span><span class="op" id="4555106">.</span><span class="ident" id="4555107">Unmarshal</span><span class="op" id="4555116">(</span><span class="ident" id="4555117">rest</span><span class="op" id="4555121">,</span>&nbsp;<span class="op" id="4555123">&amp;</span><span class="ident" id="4555124">v</span><span class="op" id="4555125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555129">if</span>&nbsp;<span class="ident" id="4555132">err</span>&nbsp;<span class="op" id="4555136">!=</span>&nbsp;<span class="builtintype" id="4555139">nil</span>&nbsp;<span class="op" id="4555143">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555148">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4555157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555161">switch</span>&nbsp;<span class="ident" id="4555168">v</span><span class="op" id="4555169">.</span><span class="ident" id="4555170">Tag</span>&nbsp;<span class="op" id="4555174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555178">case</span>&nbsp;<span class="num" id="4555183">1</span><span class="op" id="4555184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555189">emailAddresses</span>&nbsp;<span class="op" id="4555204">=</span>&nbsp;<span class="builtinfunc" id="4555206">append</span><span class="op" id="4555212">(</span><span class="ident" id="4555213">emailAddresses</span><span class="op" id="4555227">,</span>&nbsp;<span class="builtintype" id="4555229">string</span><span class="op" id="4555235">(</span><span class="ident" id="4555236">v</span><span class="op" id="4555237">.</span><span class="ident" id="4555238">Bytes</span><span class="op" id="4555243">)</span><span class="op" id="4555244">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555248">case</span>&nbsp;<span class="num" id="4555253">2</span><span class="op" id="4555254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555259">dnsNames</span>&nbsp;<span class="op" id="4555268">=</span>&nbsp;<span class="builtinfunc" id="4555270">append</span><span class="op" id="4555276">(</span><span class="ident" id="4555277">dnsNames</span><span class="op" id="4555285">,</span>&nbsp;<span class="builtintype" id="4555287">string</span><span class="op" id="4555293">(</span><span class="ident" id="4555294">v</span><span class="op" id="4555295">.</span><span class="ident" id="4555296">Bytes</span><span class="op" id="4555301">)</span><span class="op" id="4555302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555306">case</span>&nbsp;<span class="num" id="4555311">7</span><span class="op" id="4555312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555317">switch</span>&nbsp;<span class="builtinfunc" id="4555324">len</span><span class="op" id="4555327">(</span><span class="ident" id="4555328">v</span><span class="op" id="4555329">.</span><span class="ident" id="4555330">Bytes</span><span class="op" id="4555335">)</span>&nbsp;<span class="op" id="4555337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555342">case</span>&nbsp;<span class="ident" id="4555347">net</span><span class="op" id="4555350">.</span><span class="ident" id="4555351">IPv4len</span><span class="op" id="4555358">,</span>&nbsp;<span class="ident" id="4555360">net</span><span class="op" id="4555363">.</span><span class="ident" id="4555364">IPv6len</span><span class="op" id="4555371">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555377">ipAddresses</span>&nbsp;<span class="op" id="4555389">=</span>&nbsp;<span class="builtinfunc" id="4555391">append</span><span class="op" id="4555397">(</span><span class="ident" id="4555398">ipAddresses</span><span class="op" id="4555409">,</span>&nbsp;<span class="ident" id="4555411">v</span><span class="op" id="4555412">.</span><span class="ident" id="4555413">Bytes</span><span class="op" id="4555418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555423">default</span><span class="op" id="4555430">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555436">err</span>&nbsp;<span class="op" id="4555440">=</span>&nbsp;<span class="ident" id="4555442">errors</span><span class="op" id="4555448">.</span><span class="ident" id="4555449">New</span><span class="op" id="4555452">(</span><span class="string" id="4555453">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4555505">+</span>&nbsp;<span class="ident" id="4555507">strconv</span><span class="op" id="4555514">.</span><span class="ident" id="4555515">Itoa</span><span class="op" id="4555519">(</span><span class="builtinfunc" id="4555520">len</span><span class="op" id="4555523">(</span><span class="ident" id="4555524">v</span><span class="op" id="4555525">.</span><span class="ident" id="4555526">Bytes</span><span class="op" id="4555531">)</span><span class="op" id="4555532">)</span><span class="op" id="4555533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555539">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4555549">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4555553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4555556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555560">return</span><br>
<span class="lineno"></span><span class="op" id="4555567">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4555570">func</span>&nbsp;<span class="ident" id="4555575">parseCertificate</span><span class="op" id="4555591">(</span><span class="ident" id="4555592">in</span>&nbsp;<span class="op" id="4555595">*</span><span class="ident" id="4555596">certificate</span><span class="op" id="4555607">)</span>&nbsp;<span class="op" id="4555609">(</span><span class="op" id="4555610">*</span><span class="ident" id="4555611">Certificate</span><span class="op" id="4555622">,</span>&nbsp;<span class="builtintype" id="4555624">error</span><span class="op" id="4555629">)</span>&nbsp;<span class="op" id="4555631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555634">out</span>&nbsp;<span class="op" id="4555638">:=</span>&nbsp;<span class="builtinfunc" id="4555641">new</span><span class="op" id="4555644">(</span><span class="ident" id="4555645">Certificate</span><span class="op" id="4555656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555659">out</span><span class="op" id="4555662">.</span><span class="ident" id="4555663">Raw</span>&nbsp;<span class="op" id="4555667">=</span>&nbsp;<span class="ident" id="4555669">in</span><span class="op" id="4555671">.</span><span class="ident" id="4555672">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555677">out</span><span class="op" id="4555680">.</span><span class="ident" id="4555681">RawTBSCertificate</span>&nbsp;<span class="op" id="4555699">=</span>&nbsp;<span class="ident" id="4555701">in</span><span class="op" id="4555703">.</span><span class="ident" id="4555704">TBSCertificate</span><span class="op" id="4555718">.</span><span class="ident" id="4555719">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555724">out</span><span class="op" id="4555727">.</span><span class="ident" id="4555728">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4555752">=</span>&nbsp;<span class="ident" id="4555754">in</span><span class="op" id="4555756">.</span><span class="ident" id="4555757">TBSCertificate</span><span class="op" id="4555771">.</span><span class="ident" id="4555772">PublicKey</span><span class="op" id="4555781">.</span><span class="ident" id="4555782">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555787">out</span><span class="op" id="4555790">.</span><span class="ident" id="4555791">RawSubject</span>&nbsp;<span class="op" id="4555802">=</span>&nbsp;<span class="ident" id="4555804">in</span><span class="op" id="4555806">.</span><span class="ident" id="4555807">TBSCertificate</span><span class="op" id="4555821">.</span><span class="ident" id="4555822">Subject</span><span class="op" id="4555829">.</span><span class="ident" id="4555830">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555841">out</span><span class="op" id="4555844">.</span><span class="ident" id="4555845">RawIssuer</span>&nbsp;<span class="op" id="4555855">=</span>&nbsp;<span class="ident" id="4555857">in</span><span class="op" id="4555859">.</span><span class="ident" id="4555860">TBSCertificate</span><span class="op" id="4555874">.</span><span class="ident" id="4555875">Issuer</span><span class="op" id="4555881">.</span><span class="ident" id="4555882">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555894">out</span><span class="op" id="4555897">.</span><span class="ident" id="4555898">Signature</span>&nbsp;<span class="op" id="4555908">=</span>&nbsp;<span class="ident" id="4555910">in</span><span class="op" id="4555912">.</span><span class="ident" id="4555913">SignatureValue</span><span class="op" id="4555927">.</span><span class="ident" id="4555928">RightAlign</span><span class="op" id="4555938">(</span><span class="op" id="4555939">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555942">out</span><span class="op" id="4555945">.</span><span class="ident" id="4555946">SignatureAlgorithm</span>&nbsp;<span class="op" id="4555965">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555969">getSignatureAlgorithmFromOID</span><span class="op" id="4555997">(</span><span class="ident" id="4555998">in</span><span class="op" id="4556000">.</span><span class="ident" id="4556001">TBSCertificate</span><span class="op" id="4556015">.</span><span class="ident" id="4556016">SignatureAlgorithm</span><span class="op" id="4556034">.</span><span class="ident" id="4556035">Algorithm</span><span class="op" id="4556044">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556048">out</span><span class="op" id="4556051">.</span><span class="ident" id="4556052">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4556071">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556075">getPublicKeyAlgorithmFromOID</span><span class="op" id="4556103">(</span><span class="ident" id="4556104">in</span><span class="op" id="4556106">.</span><span class="ident" id="4556107">TBSCertificate</span><span class="op" id="4556121">.</span><span class="ident" id="4556122">PublicKey</span><span class="op" id="4556131">.</span><span class="ident" id="4556132">Algorithm</span><span class="op" id="4556141">.</span><span class="ident" id="4556142">Algorithm</span><span class="op" id="4556151">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556154">var</span>&nbsp;<span class="ident" id="4556158">err</span>&nbsp;<span class="builtintype" id="4556162">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556169">out</span><span class="op" id="4556172">.</span><span class="ident" id="4556173">PublicKey</span><span class="op" id="4556182">,</span>&nbsp;<span class="ident" id="4556184">err</span>&nbsp;<span class="op" id="4556188">=</span>&nbsp;<span class="ident" id="4556190">parsePublicKey</span><span class="op" id="4556204">(</span><span class="ident" id="4556205">out</span><span class="op" id="4556208">.</span><span class="ident" id="4556209">PublicKeyAlgorithm</span><span class="op" id="4556227">,</span>&nbsp;<span class="op" id="4556229">&amp;</span><span class="ident" id="4556230">in</span><span class="op" id="4556232">.</span><span class="ident" id="4556233">TBSCertificate</span><span class="op" id="4556247">.</span><span class="ident" id="4556248">PublicKey</span><span class="op" id="4556257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556260">if</span>&nbsp;<span class="ident" id="4556263">err</span>&nbsp;<span class="op" id="4556267">!=</span>&nbsp;<span class="builtintype" id="4556270">nil</span>&nbsp;<span class="op" id="4556274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556278">return</span>&nbsp;<span class="builtintype" id="4556285">nil</span><span class="op" id="4556288">,</span>&nbsp;<span class="ident" id="4556290">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4556295">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556299">if</span>&nbsp;<span class="ident" id="4556302">in</span><span class="op" id="4556304">.</span><span class="ident" id="4556305">TBSCertificate</span><span class="op" id="4556319">.</span><span class="ident" id="4556320">SerialNumber</span><span class="op" id="4556332">.</span><span class="ident" id="4556333">Sign</span><span class="op" id="4556337">(</span><span class="op" id="4556338">)</span>&nbsp;<span class="op" id="4556340">&lt;</span>&nbsp;<span class="num" id="4556342">0</span>&nbsp;<span class="op" id="4556344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556348">return</span>&nbsp;<span class="builtintype" id="4556355">nil</span><span class="op" id="4556358">,</span>&nbsp;<span class="ident" id="4556360">errors</span><span class="op" id="4556366">.</span><span class="ident" id="4556367">New</span><span class="op" id="4556370">(</span><span class="string" id="4556371">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4556401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4556404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556408">out</span><span class="op" id="4556411">.</span><span class="ident" id="4556412">Version</span>&nbsp;<span class="op" id="4556420">=</span>&nbsp;<span class="ident" id="4556422">in</span><span class="op" id="4556424">.</span><span class="ident" id="4556425">TBSCertificate</span><span class="op" id="4556439">.</span><span class="ident" id="4556440">Version</span>&nbsp;<span class="op" id="4556448">+</span>&nbsp;<span class="num" id="4556450">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556453">out</span><span class="op" id="4556456">.</span><span class="ident" id="4556457">SerialNumber</span>&nbsp;<span class="op" id="4556470">=</span>&nbsp;<span class="ident" id="4556472">in</span><span class="op" id="4556474">.</span><span class="ident" id="4556475">TBSCertificate</span><span class="op" id="4556489">.</span><span class="ident" id="4556490">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556505">var</span>&nbsp;<span class="ident" id="4556509">issuer</span><span class="op" id="4556515">,</span>&nbsp;<span class="ident" id="4556517">subject</span>&nbsp;<span class="ident" id="4556525">pkix</span><span class="op" id="4556529">.</span><span class="ident" id="4556530">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556543">if</span>&nbsp;<span class="ident" id="4556546">_</span><span class="op" id="4556547">,</span>&nbsp;<span class="ident" id="4556549">err</span>&nbsp;<span class="op" id="4556553">:=</span>&nbsp;<span class="ident" id="4556556">asn1</span><span class="op" id="4556560">.</span><span class="ident" id="4556561">Unmarshal</span><span class="op" id="4556570">(</span><span class="ident" id="4556571">in</span><span class="op" id="4556573">.</span><span class="ident" id="4556574">TBSCertificate</span><span class="op" id="4556588">.</span><span class="ident" id="4556589">Subject</span><span class="op" id="4556596">.</span><span class="ident" id="4556597">FullBytes</span><span class="op" id="4556606">,</span>&nbsp;<span class="op" id="4556608">&amp;</span><span class="ident" id="4556609">subject</span><span class="op" id="4556616">)</span><span class="op" id="4556617">;</span>&nbsp;<span class="ident" id="4556619">err</span>&nbsp;<span class="op" id="4556623">!=</span>&nbsp;<span class="builtintype" id="4556626">nil</span>&nbsp;<span class="op" id="4556630">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556634">return</span>&nbsp;<span class="builtintype" id="4556641">nil</span><span class="op" id="4556644">,</span>&nbsp;<span class="ident" id="4556646">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4556651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556654">if</span>&nbsp;<span class="ident" id="4556657">_</span><span class="op" id="4556658">,</span>&nbsp;<span class="ident" id="4556660">err</span>&nbsp;<span class="op" id="4556664">:=</span>&nbsp;<span class="ident" id="4556667">asn1</span><span class="op" id="4556671">.</span><span class="ident" id="4556672">Unmarshal</span><span class="op" id="4556681">(</span><span class="ident" id="4556682">in</span><span class="op" id="4556684">.</span><span class="ident" id="4556685">TBSCertificate</span><span class="op" id="4556699">.</span><span class="ident" id="4556700">Issuer</span><span class="op" id="4556706">.</span><span class="ident" id="4556707">FullBytes</span><span class="op" id="4556716">,</span>&nbsp;<span class="op" id="4556718">&amp;</span><span class="ident" id="4556719">issuer</span><span class="op" id="4556725">)</span><span class="op" id="4556726">;</span>&nbsp;<span class="ident" id="4556728">err</span>&nbsp;<span class="op" id="4556732">!=</span>&nbsp;<span class="builtintype" id="4556735">nil</span>&nbsp;<span class="op" id="4556739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556743">return</span>&nbsp;<span class="builtintype" id="4556750">nil</span><span class="op" id="4556753">,</span>&nbsp;<span class="ident" id="4556755">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4556760">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556764">out</span><span class="op" id="4556767">.</span><span class="ident" id="4556768">Issuer</span><span class="op" id="4556774">.</span><span class="ident" id="4556775">FillFromRDNSequence</span><span class="op" id="4556794">(</span><span class="op" id="4556795">&amp;</span><span class="ident" id="4556796">issuer</span><span class="op" id="4556802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556805">out</span><span class="op" id="4556808">.</span><span class="ident" id="4556809">Subject</span><span class="op" id="4556816">.</span><span class="ident" id="4556817">FillFromRDNSequence</span><span class="op" id="4556836">(</span><span class="op" id="4556837">&amp;</span><span class="ident" id="4556838">subject</span><span class="op" id="4556845">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556849">out</span><span class="op" id="4556852">.</span><span class="ident" id="4556853">NotBefore</span>&nbsp;<span class="op" id="4556863">=</span>&nbsp;<span class="ident" id="4556865">in</span><span class="op" id="4556867">.</span><span class="ident" id="4556868">TBSCertificate</span><span class="op" id="4556882">.</span><span class="ident" id="4556883">Validity</span><span class="op" id="4556891">.</span><span class="ident" id="4556892">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556903">out</span><span class="op" id="4556906">.</span><span class="ident" id="4556907">NotAfter</span>&nbsp;<span class="op" id="4556916">=</span>&nbsp;<span class="ident" id="4556918">in</span><span class="op" id="4556920">.</span><span class="ident" id="4556921">TBSCertificate</span><span class="op" id="4556935">.</span><span class="ident" id="4556936">Validity</span><span class="op" id="4556944">.</span><span class="ident" id="4556945">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4556956">for</span>&nbsp;<span class="ident" id="4556960">_</span><span class="op" id="4556961">,</span>&nbsp;<span class="ident" id="4556963">e</span>&nbsp;<span class="op" id="4556965">:=</span>&nbsp;<span class="keyword" id="4556968">range</span>&nbsp;<span class="ident" id="4556974">in</span><span class="op" id="4556976">.</span><span class="ident" id="4556977">TBSCertificate</span><span class="op" id="4556991">.</span><span class="ident" id="4556992">Extensions</span>&nbsp;<span class="op" id="4557003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557007">out</span><span class="op" id="4557010">.</span><span class="ident" id="4557011">Extensions</span>&nbsp;<span class="op" id="4557022">=</span>&nbsp;<span class="builtinfunc" id="4557024">append</span><span class="op" id="4557030">(</span><span class="ident" id="4557031">out</span><span class="op" id="4557034">.</span><span class="ident" id="4557035">Extensions</span><span class="op" id="4557045">,</span>&nbsp;<span class="ident" id="4557047">e</span><span class="op" id="4557048">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557053">if</span>&nbsp;<span class="builtinfunc" id="4557056">len</span><span class="op" id="4557059">(</span><span class="ident" id="4557060">e</span><span class="op" id="4557061">.</span><span class="ident" id="4557062">Id</span><span class="op" id="4557064">)</span>&nbsp;<span class="op" id="4557066">==</span>&nbsp;<span class="num" id="4557069">4</span>&nbsp;<span class="op" id="4557071">&amp;&amp;</span>&nbsp;<span class="ident" id="4557074">e</span><span class="op" id="4557075">.</span><span class="ident" id="4557076">Id</span><span class="op" id="4557078">[</span><span class="num" id="4557079">0</span><span class="op" id="4557080">]</span>&nbsp;<span class="op" id="4557082">==</span>&nbsp;<span class="num" id="4557085">2</span>&nbsp;<span class="op" id="4557087">&amp;&amp;</span>&nbsp;<span class="ident" id="4557090">e</span><span class="op" id="4557091">.</span><span class="ident" id="4557092">Id</span><span class="op" id="4557094">[</span><span class="num" id="4557095">1</span><span class="op" id="4557096">]</span>&nbsp;<span class="op" id="4557098">==</span>&nbsp;<span class="num" id="4557101">5</span>&nbsp;<span class="op" id="4557103">&amp;&amp;</span>&nbsp;<span class="ident" id="4557106">e</span><span class="op" id="4557107">.</span><span class="ident" id="4557108">Id</span><span class="op" id="4557110">[</span><span class="num" id="4557111">2</span><span class="op" id="4557112">]</span>&nbsp;<span class="op" id="4557114">==</span>&nbsp;<span class="num" id="4557117">29</span>&nbsp;<span class="op" id="4557120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557125">switch</span>&nbsp;<span class="ident" id="4557132">e</span><span class="op" id="4557133">.</span><span class="ident" id="4557134">Id</span><span class="op" id="4557136">[</span><span class="num" id="4557137">3</span><span class="op" id="4557138">]</span>&nbsp;<span class="op" id="4557140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557145">case</span>&nbsp;<span class="num" id="4557150">15</span><span class="op" id="4557152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4557158">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557183">var</span>&nbsp;<span class="ident" id="4557187">usageBits</span>&nbsp;<span class="ident" id="4557197">asn1</span><span class="op" id="4557201">.</span><span class="ident" id="4557202">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557216">_</span><span class="op" id="4557217">,</span>&nbsp;<span class="ident" id="4557219">err</span>&nbsp;<span class="op" id="4557223">:=</span>&nbsp;<span class="ident" id="4557226">asn1</span><span class="op" id="4557230">.</span><span class="ident" id="4557231">Unmarshal</span><span class="op" id="4557240">(</span><span class="ident" id="4557241">e</span><span class="op" id="4557242">.</span><span class="ident" id="4557243">Value</span><span class="op" id="4557248">,</span>&nbsp;<span class="op" id="4557250">&amp;</span><span class="ident" id="4557251">usageBits</span><span class="op" id="4557260">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557267">if</span>&nbsp;<span class="ident" id="4557270">err</span>&nbsp;<span class="op" id="4557274">==</span>&nbsp;<span class="builtintype" id="4557277">nil</span>&nbsp;<span class="op" id="4557281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557288">var</span>&nbsp;<span class="ident" id="4557292">usage</span>&nbsp;<span class="builtintype" id="4557298">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557307">for</span>&nbsp;<span class="ident" id="4557311">i</span>&nbsp;<span class="op" id="4557313">:=</span>&nbsp;<span class="num" id="4557316">0</span><span class="op" id="4557317">;</span>&nbsp;<span class="ident" id="4557319">i</span>&nbsp;<span class="op" id="4557321">&lt;</span>&nbsp;<span class="num" id="4557323">9</span><span class="op" id="4557324">;</span>&nbsp;<span class="ident" id="4557326">i</span><span class="op" id="4557327">++</span>&nbsp;<span class="op" id="4557330">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557338">if</span>&nbsp;<span class="ident" id="4557341">usageBits</span><span class="op" id="4557350">.</span><span class="ident" id="4557351">At</span><span class="op" id="4557353">(</span><span class="ident" id="4557354">i</span><span class="op" id="4557355">)</span>&nbsp;<span class="op" id="4557357">!=</span>&nbsp;<span class="num" id="4557360">0</span>&nbsp;<span class="op" id="4557362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557371">usage</span>&nbsp;<span class="op" id="4557377">|=</span>&nbsp;<span class="num" id="4557380">1</span>&nbsp;<span class="op" id="4557382">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4557385">uint</span><span class="op" id="4557389">(</span><span class="ident" id="4557390">i</span><span class="op" id="4557391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4557399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4557406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557413">out</span><span class="op" id="4557416">.</span><span class="ident" id="4557417">KeyUsage</span>&nbsp;<span class="op" id="4557426">=</span>&nbsp;<span class="ident" id="4557428">KeyUsage</span><span class="op" id="4557436">(</span><span class="ident" id="4557437">usage</span><span class="op" id="4557442">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557449">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4557462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557467">case</span>&nbsp;<span class="num" id="4557472">19</span><span class="op" id="4557474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4557480">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557505">var</span>&nbsp;<span class="ident" id="4557509">constraints</span>&nbsp;<span class="ident" id="4557521">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557542">_</span><span class="op" id="4557543">,</span>&nbsp;<span class="ident" id="4557545">err</span>&nbsp;<span class="op" id="4557549">:=</span>&nbsp;<span class="ident" id="4557552">asn1</span><span class="op" id="4557556">.</span><span class="ident" id="4557557">Unmarshal</span><span class="op" id="4557566">(</span><span class="ident" id="4557567">e</span><span class="op" id="4557568">.</span><span class="ident" id="4557569">Value</span><span class="op" id="4557574">,</span>&nbsp;<span class="op" id="4557576">&amp;</span><span class="ident" id="4557577">constraints</span><span class="op" id="4557588">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557595">if</span>&nbsp;<span class="ident" id="4557598">err</span>&nbsp;<span class="op" id="4557602">==</span>&nbsp;<span class="builtintype" id="4557605">nil</span>&nbsp;<span class="op" id="4557609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557616">out</span><span class="op" id="4557619">.</span><span class="ident" id="4557620">BasicConstraintsValid</span>&nbsp;<span class="op" id="4557642">=</span>&nbsp;<span class="builtintype" id="4557644">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557654">out</span><span class="op" id="4557657">.</span><span class="ident" id="4557658">IsCA</span>&nbsp;<span class="op" id="4557663">=</span>&nbsp;<span class="ident" id="4557665">constraints</span><span class="op" id="4557676">.</span><span class="ident" id="4557677">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557687">out</span><span class="op" id="4557690">.</span><span class="ident" id="4557691">MaxPathLen</span>&nbsp;<span class="op" id="4557702">=</span>&nbsp;<span class="ident" id="4557704">constraints</span><span class="op" id="4557715">.</span><span class="ident" id="4557716">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557732">out</span><span class="op" id="4557735">.</span><span class="ident" id="4557736">MaxPathLenZero</span>&nbsp;<span class="op" id="4557751">=</span>&nbsp;<span class="ident" id="4557753">out</span><span class="op" id="4557756">.</span><span class="ident" id="4557757">MaxPathLen</span>&nbsp;<span class="op" id="4557768">==</span>&nbsp;<span class="num" id="4557771">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557778">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4557791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557796">case</span>&nbsp;<span class="num" id="4557801">17</span><span class="op" id="4557803">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557809">out</span><span class="op" id="4557812">.</span><span class="ident" id="4557813">DNSNames</span><span class="op" id="4557821">,</span>&nbsp;<span class="ident" id="4557823">out</span><span class="op" id="4557826">.</span><span class="ident" id="4557827">EmailAddresses</span><span class="op" id="4557841">,</span>&nbsp;<span class="ident" id="4557843">out</span><span class="op" id="4557846">.</span><span class="ident" id="4557847">IPAddresses</span><span class="op" id="4557858">,</span>&nbsp;<span class="ident" id="4557860">err</span>&nbsp;<span class="op" id="4557864">=</span>&nbsp;<span class="ident" id="4557866">parseSANExtension</span><span class="op" id="4557883">(</span><span class="ident" id="4557884">e</span><span class="op" id="4557885">.</span><span class="ident" id="4557886">Value</span><span class="op" id="4557891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557897">if</span>&nbsp;<span class="ident" id="4557900">err</span>&nbsp;<span class="op" id="4557904">!=</span>&nbsp;<span class="builtintype" id="4557907">nil</span>&nbsp;<span class="op" id="4557911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557918">return</span>&nbsp;<span class="builtintype" id="4557925">nil</span><span class="op" id="4557928">,</span>&nbsp;<span class="ident" id="4557930">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4557938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557945">if</span>&nbsp;<span class="builtinfunc" id="4557948">len</span><span class="op" id="4557951">(</span><span class="ident" id="4557952">out</span><span class="op" id="4557955">.</span><span class="ident" id="4557956">DNSNames</span><span class="op" id="4557964">)</span>&nbsp;<span class="op" id="4557966">&gt;</span>&nbsp;<span class="num" id="4557968">0</span>&nbsp;<span class="op" id="4557970">||</span>&nbsp;<span class="builtinfunc" id="4557973">len</span><span class="op" id="4557976">(</span><span class="ident" id="4557977">out</span><span class="op" id="4557980">.</span><span class="ident" id="4557981">EmailAddresses</span><span class="op" id="4557995">)</span>&nbsp;<span class="op" id="4557997">&gt;</span>&nbsp;<span class="num" id="4557999">0</span>&nbsp;<span class="op" id="4558001">||</span>&nbsp;<span class="builtinfunc" id="4558004">len</span><span class="op" id="4558007">(</span><span class="ident" id="4558008">out</span><span class="op" id="4558011">.</span><span class="ident" id="4558012">IPAddresses</span><span class="op" id="4558023">)</span>&nbsp;<span class="op" id="4558025">&gt;</span>&nbsp;<span class="num" id="4558027">0</span>&nbsp;<span class="op" id="4558029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558036">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4558049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558055">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558106">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558155">case</span>&nbsp;<span class="num" id="4558160">30</span><span class="op" id="4558162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558168">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558195">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558233">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558303">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558374">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558381">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558449">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558456">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558493">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558542">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558602">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558662">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558669">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558711">var</span>&nbsp;<span class="ident" id="4558715">constraints</span>&nbsp;<span class="ident" id="4558727">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4558747">_</span><span class="op" id="4558748">,</span>&nbsp;<span class="ident" id="4558750">err</span>&nbsp;<span class="op" id="4558754">:=</span>&nbsp;<span class="ident" id="4558757">asn1</span><span class="op" id="4558761">.</span><span class="ident" id="4558762">Unmarshal</span><span class="op" id="4558771">(</span><span class="ident" id="4558772">e</span><span class="op" id="4558773">.</span><span class="ident" id="4558774">Value</span><span class="op" id="4558779">,</span>&nbsp;<span class="op" id="4558781">&amp;</span><span class="ident" id="4558782">constraints</span><span class="op" id="4558793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558799">if</span>&nbsp;<span class="ident" id="4558802">err</span>&nbsp;<span class="op" id="4558806">!=</span>&nbsp;<span class="builtintype" id="4558809">nil</span>&nbsp;<span class="op" id="4558813">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558820">return</span>&nbsp;<span class="builtintype" id="4558827">nil</span><span class="op" id="4558830">,</span>&nbsp;<span class="ident" id="4558832">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4558840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558847">if</span>&nbsp;<span class="builtinfunc" id="4558850">len</span><span class="op" id="4558853">(</span><span class="ident" id="4558854">constraints</span><span class="op" id="4558865">.</span><span class="ident" id="4558866">Excluded</span><span class="op" id="4558874">)</span>&nbsp;<span class="op" id="4558876">&gt;</span>&nbsp;<span class="num" id="4558878">0</span>&nbsp;<span class="op" id="4558880">&amp;&amp;</span>&nbsp;<span class="ident" id="4558883">e</span><span class="op" id="4558884">.</span><span class="ident" id="4558885">Critical</span>&nbsp;<span class="op" id="4558894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558901">return</span>&nbsp;<span class="ident" id="4558908">out</span><span class="op" id="4558911">,</span>&nbsp;<span class="ident" id="4558913">UnhandledCriticalExtension</span><span class="op" id="4558939">{</span><span class="op" id="4558940">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4558946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558953">for</span>&nbsp;<span class="ident" id="4558957">_</span><span class="op" id="4558958">,</span>&nbsp;<span class="ident" id="4558960">subtree</span>&nbsp;<span class="op" id="4558968">:=</span>&nbsp;<span class="keyword" id="4558971">range</span>&nbsp;<span class="ident" id="4558977">constraints</span><span class="op" id="4558988">.</span><span class="ident" id="4558989">Permitted</span>&nbsp;<span class="op" id="4558999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559006">if</span>&nbsp;<span class="builtinfunc" id="4559009">len</span><span class="op" id="4559012">(</span><span class="ident" id="4559013">subtree</span><span class="op" id="4559020">.</span><span class="ident" id="4559021">Name</span><span class="op" id="4559025">)</span>&nbsp;<span class="op" id="4559027">==</span>&nbsp;<span class="num" id="4559030">0</span>&nbsp;<span class="op" id="4559032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559040">if</span>&nbsp;<span class="ident" id="4559043">e</span><span class="op" id="4559044">.</span><span class="ident" id="4559045">Critical</span>&nbsp;<span class="op" id="4559054">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559063">return</span>&nbsp;<span class="ident" id="4559070">out</span><span class="op" id="4559073">,</span>&nbsp;<span class="ident" id="4559075">UnhandledCriticalExtension</span><span class="op" id="4559101">{</span><span class="op" id="4559102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4559110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559118">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4559132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559139">out</span><span class="op" id="4559142">.</span><span class="ident" id="4559143">PermittedDNSDomains</span>&nbsp;<span class="op" id="4559163">=</span>&nbsp;<span class="builtinfunc" id="4559165">append</span><span class="op" id="4559171">(</span><span class="ident" id="4559172">out</span><span class="op" id="4559175">.</span><span class="ident" id="4559176">PermittedDNSDomains</span><span class="op" id="4559195">,</span>&nbsp;<span class="ident" id="4559197">subtree</span><span class="op" id="4559204">.</span><span class="ident" id="4559205">Name</span><span class="op" id="4559209">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4559215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559221">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559234">case</span>&nbsp;<span class="num" id="4559239">31</span><span class="op" id="4559241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559247">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559274">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559351">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559358">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559398">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559538">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559605">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559612">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559711">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559783">var</span>&nbsp;<span class="ident" id="4559787">cdp</span>&nbsp;<span class="op" id="4559791">[</span><span class="op" id="4559792">]</span><span class="ident" id="4559793">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559815">_</span><span class="op" id="4559816">,</span>&nbsp;<span class="ident" id="4559818">err</span>&nbsp;<span class="op" id="4559822">:=</span>&nbsp;<span class="ident" id="4559825">asn1</span><span class="op" id="4559829">.</span><span class="ident" id="4559830">Unmarshal</span><span class="op" id="4559839">(</span><span class="ident" id="4559840">e</span><span class="op" id="4559841">.</span><span class="ident" id="4559842">Value</span><span class="op" id="4559847">,</span>&nbsp;<span class="op" id="4559849">&amp;</span><span class="ident" id="4559850">cdp</span><span class="op" id="4559853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559859">if</span>&nbsp;<span class="ident" id="4559862">err</span>&nbsp;<span class="op" id="4559866">!=</span>&nbsp;<span class="builtintype" id="4559869">nil</span>&nbsp;<span class="op" id="4559873">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559880">return</span>&nbsp;<span class="builtintype" id="4559887">nil</span><span class="op" id="4559890">,</span>&nbsp;<span class="ident" id="4559892">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4559900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559907">for</span>&nbsp;<span class="ident" id="4559911">_</span><span class="op" id="4559912">,</span>&nbsp;<span class="ident" id="4559914">dp</span>&nbsp;<span class="op" id="4559917">:=</span>&nbsp;<span class="keyword" id="4559920">range</span>&nbsp;<span class="ident" id="4559926">cdp</span>&nbsp;<span class="op" id="4559930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559937">var</span>&nbsp;<span class="ident" id="4559941">n</span>&nbsp;<span class="ident" id="4559943">asn1</span><span class="op" id="4559947">.</span><span class="ident" id="4559948">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559962">_</span><span class="op" id="4559963">,</span>&nbsp;<span class="ident" id="4559965">err</span>&nbsp;<span class="op" id="4559969">=</span>&nbsp;<span class="ident" id="4559971">asn1</span><span class="op" id="4559975">.</span><span class="ident" id="4559976">Unmarshal</span><span class="op" id="4559985">(</span><span class="ident" id="4559986">dp</span><span class="op" id="4559988">.</span><span class="ident" id="4559989">DistributionPoint</span><span class="op" id="4560006">.</span><span class="ident" id="4560007">FullName</span><span class="op" id="4560015">.</span><span class="ident" id="4560016">Bytes</span><span class="op" id="4560021">,</span>&nbsp;<span class="op" id="4560023">&amp;</span><span class="ident" id="4560024">n</span><span class="op" id="4560025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560032">if</span>&nbsp;<span class="ident" id="4560035">err</span>&nbsp;<span class="op" id="4560039">!=</span>&nbsp;<span class="builtintype" id="4560042">nil</span>&nbsp;<span class="op" id="4560046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560054">return</span>&nbsp;<span class="builtintype" id="4560061">nil</span><span class="op" id="4560064">,</span>&nbsp;<span class="ident" id="4560066">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560083">if</span>&nbsp;<span class="ident" id="4560086">n</span><span class="op" id="4560087">.</span><span class="ident" id="4560088">Tag</span>&nbsp;<span class="op" id="4560092">==</span>&nbsp;<span class="num" id="4560095">6</span>&nbsp;<span class="op" id="4560097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560105">out</span><span class="op" id="4560108">.</span><span class="ident" id="4560109">CRLDistributionPoints</span>&nbsp;<span class="op" id="4560131">=</span>&nbsp;<span class="builtinfunc" id="4560133">append</span><span class="op" id="4560139">(</span><span class="ident" id="4560140">out</span><span class="op" id="4560143">.</span><span class="ident" id="4560144">CRLDistributionPoints</span><span class="op" id="4560165">,</span>&nbsp;<span class="builtintype" id="4560167">string</span><span class="op" id="4560173">(</span><span class="ident" id="4560174">n</span><span class="op" id="4560175">.</span><span class="ident" id="4560176">Bytes</span><span class="op" id="4560181">)</span><span class="op" id="4560182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560201">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560214">case</span>&nbsp;<span class="num" id="4560219">35</span><span class="op" id="4560221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4560227">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560252">var</span>&nbsp;<span class="ident" id="4560256">a</span>&nbsp;<span class="ident" id="4560258">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560272">_</span><span class="op" id="4560273">,</span>&nbsp;<span class="ident" id="4560275">err</span>&nbsp;<span class="op" id="4560279">=</span>&nbsp;<span class="ident" id="4560281">asn1</span><span class="op" id="4560285">.</span><span class="ident" id="4560286">Unmarshal</span><span class="op" id="4560295">(</span><span class="ident" id="4560296">e</span><span class="op" id="4560297">.</span><span class="ident" id="4560298">Value</span><span class="op" id="4560303">,</span>&nbsp;<span class="op" id="4560305">&amp;</span><span class="ident" id="4560306">a</span><span class="op" id="4560307">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560313">if</span>&nbsp;<span class="ident" id="4560316">err</span>&nbsp;<span class="op" id="4560320">!=</span>&nbsp;<span class="builtintype" id="4560323">nil</span>&nbsp;<span class="op" id="4560327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560334">return</span>&nbsp;<span class="builtintype" id="4560341">nil</span><span class="op" id="4560344">,</span>&nbsp;<span class="ident" id="4560346">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560360">out</span><span class="op" id="4560363">.</span><span class="ident" id="4560364">AuthorityKeyId</span>&nbsp;<span class="op" id="4560379">=</span>&nbsp;<span class="ident" id="4560381">a</span><span class="op" id="4560382">.</span><span class="ident" id="4560383">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560390">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560403">case</span>&nbsp;<span class="num" id="4560408">37</span><span class="op" id="4560410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4560416">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4560464">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4560524">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4560531">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4560599">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4560606">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560649">var</span>&nbsp;<span class="ident" id="4560653">keyUsage</span>&nbsp;<span class="op" id="4560662">[</span><span class="op" id="4560663">]</span><span class="ident" id="4560664">asn1</span><span class="op" id="4560668">.</span><span class="ident" id="4560669">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560690">_</span><span class="op" id="4560691">,</span>&nbsp;<span class="ident" id="4560693">err</span>&nbsp;<span class="op" id="4560697">=</span>&nbsp;<span class="ident" id="4560699">asn1</span><span class="op" id="4560703">.</span><span class="ident" id="4560704">Unmarshal</span><span class="op" id="4560713">(</span><span class="ident" id="4560714">e</span><span class="op" id="4560715">.</span><span class="ident" id="4560716">Value</span><span class="op" id="4560721">,</span>&nbsp;<span class="op" id="4560723">&amp;</span><span class="ident" id="4560724">keyUsage</span><span class="op" id="4560732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560738">if</span>&nbsp;<span class="ident" id="4560741">err</span>&nbsp;<span class="op" id="4560745">!=</span>&nbsp;<span class="builtintype" id="4560748">nil</span>&nbsp;<span class="op" id="4560752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560759">return</span>&nbsp;<span class="builtintype" id="4560766">nil</span><span class="op" id="4560769">,</span>&nbsp;<span class="ident" id="4560771">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560779">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560786">for</span>&nbsp;<span class="ident" id="4560790">_</span><span class="op" id="4560791">,</span>&nbsp;<span class="ident" id="4560793">u</span>&nbsp;<span class="op" id="4560795">:=</span>&nbsp;<span class="keyword" id="4560798">range</span>&nbsp;<span class="ident" id="4560804">keyUsage</span>&nbsp;<span class="op" id="4560813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560820">if</span>&nbsp;<span class="ident" id="4560823">extKeyUsage</span><span class="op" id="4560834">,</span>&nbsp;<span class="ident" id="4560836">ok</span>&nbsp;<span class="op" id="4560839">:=</span>&nbsp;<span class="ident" id="4560842">extKeyUsageFromOID</span><span class="op" id="4560860">(</span><span class="ident" id="4560861">u</span><span class="op" id="4560862">)</span><span class="op" id="4560863">;</span>&nbsp;<span class="ident" id="4560865">ok</span>&nbsp;<span class="op" id="4560868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560876">out</span><span class="op" id="4560879">.</span><span class="ident" id="4560880">ExtKeyUsage</span>&nbsp;<span class="op" id="4560892">=</span>&nbsp;<span class="builtinfunc" id="4560894">append</span><span class="op" id="4560900">(</span><span class="ident" id="4560901">out</span><span class="op" id="4560904">.</span><span class="ident" id="4560905">ExtKeyUsage</span><span class="op" id="4560916">,</span>&nbsp;<span class="ident" id="4560918">extKeyUsage</span><span class="op" id="4560929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560936">}</span>&nbsp;<span class="keyword" id="4560938">else</span>&nbsp;<span class="op" id="4560943">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560951">out</span><span class="op" id="4560954">.</span><span class="ident" id="4560955">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4560974">=</span>&nbsp;<span class="builtinfunc" id="4560976">append</span><span class="op" id="4560982">(</span><span class="ident" id="4560983">out</span><span class="op" id="4560986">.</span><span class="ident" id="4560987">UnknownExtKeyUsage</span><span class="op" id="4561005">,</span>&nbsp;<span class="ident" id="4561007">u</span><span class="op" id="4561008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4561015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4561021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561028">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561041">case</span>&nbsp;<span class="num" id="4561046">14</span><span class="op" id="4561048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4561054">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561079">var</span>&nbsp;<span class="ident" id="4561083">keyid</span>&nbsp;<span class="op" id="4561089">[</span><span class="op" id="4561090">]</span><span class="builtintype" id="4561091">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561100">_</span><span class="op" id="4561101">,</span>&nbsp;<span class="ident" id="4561103">err</span>&nbsp;<span class="op" id="4561107">=</span>&nbsp;<span class="ident" id="4561109">asn1</span><span class="op" id="4561113">.</span><span class="ident" id="4561114">Unmarshal</span><span class="op" id="4561123">(</span><span class="ident" id="4561124">e</span><span class="op" id="4561125">.</span><span class="ident" id="4561126">Value</span><span class="op" id="4561131">,</span>&nbsp;<span class="op" id="4561133">&amp;</span><span class="ident" id="4561134">keyid</span><span class="op" id="4561139">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561145">if</span>&nbsp;<span class="ident" id="4561148">err</span>&nbsp;<span class="op" id="4561152">!=</span>&nbsp;<span class="builtintype" id="4561155">nil</span>&nbsp;<span class="op" id="4561159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561166">return</span>&nbsp;<span class="builtintype" id="4561173">nil</span><span class="op" id="4561176">,</span>&nbsp;<span class="ident" id="4561178">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4561186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561192">out</span><span class="op" id="4561195">.</span><span class="ident" id="4561196">SubjectKeyId</span>&nbsp;<span class="op" id="4561209">=</span>&nbsp;<span class="ident" id="4561211">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561221">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561234">case</span>&nbsp;<span class="num" id="4561239">32</span><span class="op" id="4561241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4561247">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561293">var</span>&nbsp;<span class="ident" id="4561297">policies</span>&nbsp;<span class="op" id="4561306">[</span><span class="op" id="4561307">]</span><span class="ident" id="4561308">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561330">if</span>&nbsp;<span class="ident" id="4561333">_</span><span class="op" id="4561334">,</span>&nbsp;<span class="ident" id="4561336">err</span>&nbsp;<span class="op" id="4561340">=</span>&nbsp;<span class="ident" id="4561342">asn1</span><span class="op" id="4561346">.</span><span class="ident" id="4561347">Unmarshal</span><span class="op" id="4561356">(</span><span class="ident" id="4561357">e</span><span class="op" id="4561358">.</span><span class="ident" id="4561359">Value</span><span class="op" id="4561364">,</span>&nbsp;<span class="op" id="4561366">&amp;</span><span class="ident" id="4561367">policies</span><span class="op" id="4561375">)</span><span class="op" id="4561376">;</span>&nbsp;<span class="ident" id="4561378">err</span>&nbsp;<span class="op" id="4561382">!=</span>&nbsp;<span class="builtintype" id="4561385">nil</span>&nbsp;<span class="op" id="4561389">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561396">return</span>&nbsp;<span class="builtintype" id="4561403">nil</span><span class="op" id="4561406">,</span>&nbsp;<span class="ident" id="4561408">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4561416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561422">out</span><span class="op" id="4561425">.</span><span class="ident" id="4561426">PolicyIdentifiers</span>&nbsp;<span class="op" id="4561444">=</span>&nbsp;<span class="builtinfunc" id="4561446">make</span><span class="op" id="4561450">(</span><span class="op" id="4561451">[</span><span class="op" id="4561452">]</span><span class="ident" id="4561453">asn1</span><span class="op" id="4561457">.</span><span class="ident" id="4561458">ObjectIdentifier</span><span class="op" id="4561474">,</span>&nbsp;<span class="builtinfunc" id="4561476">len</span><span class="op" id="4561479">(</span><span class="ident" id="4561480">policies</span><span class="op" id="4561488">)</span><span class="op" id="4561489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561495">for</span>&nbsp;<span class="ident" id="4561499">i</span><span class="op" id="4561500">,</span>&nbsp;<span class="ident" id="4561502">policy</span>&nbsp;<span class="op" id="4561509">:=</span>&nbsp;<span class="keyword" id="4561512">range</span>&nbsp;<span class="ident" id="4561518">policies</span>&nbsp;<span class="op" id="4561527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561534">out</span><span class="op" id="4561537">.</span><span class="ident" id="4561538">PolicyIdentifiers</span><span class="op" id="4561555">[</span><span class="ident" id="4561556">i</span><span class="op" id="4561557">]</span>&nbsp;<span class="op" id="4561559">=</span>&nbsp;<span class="ident" id="4561561">policy</span><span class="op" id="4561567">.</span><span class="ident" id="4561568">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4561579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4561584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4561588">}</span>&nbsp;<span class="keyword" id="4561590">else</span>&nbsp;<span class="keyword" id="4561595">if</span>&nbsp;<span class="ident" id="4561598">e</span><span class="op" id="4561599">.</span><span class="ident" id="4561600">Id</span><span class="op" id="4561602">.</span><span class="ident" id="4561603">Equal</span><span class="op" id="4561608">(</span><span class="ident" id="4561609">oidExtensionAuthorityInfoAccess</span><span class="op" id="4561640">)</span>&nbsp;<span class="op" id="4561642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4561647">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561700">var</span>&nbsp;<span class="ident" id="4561704">aia</span>&nbsp;<span class="op" id="4561708">[</span><span class="op" id="4561709">]</span><span class="ident" id="4561710">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561733">if</span>&nbsp;<span class="ident" id="4561736">_</span><span class="op" id="4561737">,</span>&nbsp;<span class="ident" id="4561739">err</span>&nbsp;<span class="op" id="4561743">=</span>&nbsp;<span class="ident" id="4561745">asn1</span><span class="op" id="4561749">.</span><span class="ident" id="4561750">Unmarshal</span><span class="op" id="4561759">(</span><span class="ident" id="4561760">e</span><span class="op" id="4561761">.</span><span class="ident" id="4561762">Value</span><span class="op" id="4561767">,</span>&nbsp;<span class="op" id="4561769">&amp;</span><span class="ident" id="4561770">aia</span><span class="op" id="4561773">)</span><span class="op" id="4561774">;</span>&nbsp;<span class="ident" id="4561776">err</span>&nbsp;<span class="op" id="4561780">!=</span>&nbsp;<span class="builtintype" id="4561783">nil</span>&nbsp;<span class="op" id="4561787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561793">return</span>&nbsp;<span class="builtintype" id="4561800">nil</span><span class="op" id="4561803">,</span>&nbsp;<span class="ident" id="4561805">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4561812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561818">for</span>&nbsp;<span class="ident" id="4561822">_</span><span class="op" id="4561823">,</span>&nbsp;<span class="ident" id="4561825">v</span>&nbsp;<span class="op" id="4561827">:=</span>&nbsp;<span class="keyword" id="4561830">range</span>&nbsp;<span class="ident" id="4561836">aia</span>&nbsp;<span class="op" id="4561840">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4561846">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561906">if</span>&nbsp;<span class="ident" id="4561909">v</span><span class="op" id="4561910">.</span><span class="ident" id="4561911">Location</span><span class="op" id="4561919">.</span><span class="ident" id="4561920">Tag</span>&nbsp;<span class="op" id="4561924">!=</span>&nbsp;<span class="num" id="4561927">6</span>&nbsp;<span class="op" id="4561929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561936">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4561949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561955">if</span>&nbsp;<span class="ident" id="4561958">v</span><span class="op" id="4561959">.</span><span class="ident" id="4561960">Method</span><span class="op" id="4561966">.</span><span class="ident" id="4561967">Equal</span><span class="op" id="4561972">(</span><span class="ident" id="4561973">oidAuthorityInfoAccessOcsp</span><span class="op" id="4561999">)</span>&nbsp;<span class="op" id="4562001">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562008">out</span><span class="op" id="4562011">.</span><span class="ident" id="4562012">OCSPServer</span>&nbsp;<span class="op" id="4562023">=</span>&nbsp;<span class="builtinfunc" id="4562025">append</span><span class="op" id="4562031">(</span><span class="ident" id="4562032">out</span><span class="op" id="4562035">.</span><span class="ident" id="4562036">OCSPServer</span><span class="op" id="4562046">,</span>&nbsp;<span class="builtintype" id="4562048">string</span><span class="op" id="4562054">(</span><span class="ident" id="4562055">v</span><span class="op" id="4562056">.</span><span class="ident" id="4562057">Location</span><span class="op" id="4562065">.</span><span class="ident" id="4562066">Bytes</span><span class="op" id="4562071">)</span><span class="op" id="4562072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4562078">}</span>&nbsp;<span class="keyword" id="4562080">else</span>&nbsp;<span class="keyword" id="4562085">if</span>&nbsp;<span class="ident" id="4562088">v</span><span class="op" id="4562089">.</span><span class="ident" id="4562090">Method</span><span class="op" id="4562096">.</span><span class="ident" id="4562097">Equal</span><span class="op" id="4562102">(</span><span class="ident" id="4562103">oidAuthorityInfoAccessIssuers</span><span class="op" id="4562132">)</span>&nbsp;<span class="op" id="4562134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562141">out</span><span class="op" id="4562144">.</span><span class="ident" id="4562145">IssuingCertificateURL</span>&nbsp;<span class="op" id="4562167">=</span>&nbsp;<span class="builtinfunc" id="4562169">append</span><span class="op" id="4562175">(</span><span class="ident" id="4562176">out</span><span class="op" id="4562179">.</span><span class="ident" id="4562180">IssuingCertificateURL</span><span class="op" id="4562201">,</span>&nbsp;<span class="builtintype" id="4562203">string</span><span class="op" id="4562209">(</span><span class="ident" id="4562210">v</span><span class="op" id="4562211">.</span><span class="ident" id="4562212">Location</span><span class="op" id="4562220">.</span><span class="ident" id="4562221">Bytes</span><span class="op" id="4562226">)</span><span class="op" id="4562227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4562233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4562238">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4562242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562247">if</span>&nbsp;<span class="ident" id="4562250">e</span><span class="op" id="4562251">.</span><span class="ident" id="4562252">Critical</span>&nbsp;<span class="op" id="4562261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562266">return</span>&nbsp;<span class="ident" id="4562273">out</span><span class="op" id="4562276">,</span>&nbsp;<span class="ident" id="4562278">UnhandledCriticalExtension</span><span class="op" id="4562304">{</span><span class="op" id="4562305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4562309">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4562312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562316">return</span>&nbsp;<span class="ident" id="4562323">out</span><span class="op" id="4562326">,</span>&nbsp;<span class="builtintype" id="4562328">nil</span><br>
<span class="lineno"></span><span class="op" id="4562332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4562335">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4562414">func</span>&nbsp;<span class="ident" id="4562419">ParseCertificate</span><span class="op" id="4562435">(</span><span class="ident" id="4562436">asn1Data</span>&nbsp;<span class="op" id="4562445">[</span><span class="op" id="4562446">]</span><span class="builtintype" id="4562447">byte</span><span class="op" id="4562451">)</span>&nbsp;<span class="op" id="4562453">(</span><span class="op" id="4562454">*</span><span class="ident" id="4562455">Certificate</span><span class="op" id="4562466">,</span>&nbsp;<span class="builtintype" id="4562468">error</span><span class="op" id="4562473">)</span>&nbsp;<span class="op" id="4562475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562478">var</span>&nbsp;<span class="ident" id="4562482">cert</span>&nbsp;<span class="ident" id="4562487">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562500">rest</span><span class="op" id="4562504">,</span>&nbsp;<span class="ident" id="4562506">err</span>&nbsp;<span class="op" id="4562510">:=</span>&nbsp;<span class="ident" id="4562513">asn1</span><span class="op" id="4562517">.</span><span class="ident" id="4562518">Unmarshal</span><span class="op" id="4562527">(</span><span class="ident" id="4562528">asn1Data</span><span class="op" id="4562536">,</span>&nbsp;<span class="op" id="4562538">&amp;</span><span class="ident" id="4562539">cert</span><span class="op" id="4562543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562546">if</span>&nbsp;<span class="ident" id="4562549">err</span>&nbsp;<span class="op" id="4562553">!=</span>&nbsp;<span class="builtintype" id="4562556">nil</span>&nbsp;<span class="op" id="4562560">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562564">return</span>&nbsp;<span class="builtintype" id="4562571">nil</span><span class="op" id="4562574">,</span>&nbsp;<span class="ident" id="4562576">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4562581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562584">if</span>&nbsp;<span class="builtinfunc" id="4562587">len</span><span class="op" id="4562590">(</span><span class="ident" id="4562591">rest</span><span class="op" id="4562595">)</span>&nbsp;<span class="op" id="4562597">&gt;</span>&nbsp;<span class="num" id="4562599">0</span>&nbsp;<span class="op" id="4562601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562605">return</span>&nbsp;<span class="builtintype" id="4562612">nil</span><span class="op" id="4562615">,</span>&nbsp;<span class="ident" id="4562617">asn1</span><span class="op" id="4562621">.</span><span class="ident" id="4562622">SyntaxError</span><span class="op" id="4562633">{</span><span class="ident" id="4562634">Msg</span><span class="op" id="4562637">:</span>&nbsp;<span class="string" id="4562639">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4562654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4562657">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562661">return</span>&nbsp;<span class="ident" id="4562668">parseCertificate</span><span class="op" id="4562684">(</span><span class="op" id="4562685">&amp;</span><span class="ident" id="4562686">cert</span><span class="op" id="4562690">)</span><br>
<span class="lineno"></span><span class="op" id="4562692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4562695">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4562773">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4562850">func</span>&nbsp;<span class="ident" id="4562855">ParseCertificates</span><span class="op" id="4562872">(</span><span class="ident" id="4562873">asn1Data</span>&nbsp;<span class="op" id="4562882">[</span><span class="op" id="4562883">]</span><span class="builtintype" id="4562884">byte</span><span class="op" id="4562888">)</span>&nbsp;<span class="op" id="4562890">(</span><span class="op" id="4562891">[</span><span class="op" id="4562892">]</span><span class="op" id="4562893">*</span><span class="ident" id="4562894">Certificate</span><span class="op" id="4562905">,</span>&nbsp;<span class="builtintype" id="4562907">error</span><span class="op" id="4562912">)</span>&nbsp;<span class="op" id="4562914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562917">var</span>&nbsp;<span class="ident" id="4562921">v</span>&nbsp;<span class="op" id="4562923">[</span><span class="op" id="4562924">]</span><span class="op" id="4562925">*</span><span class="ident" id="4562926">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562940">for</span>&nbsp;<span class="builtinfunc" id="4562944">len</span><span class="op" id="4562947">(</span><span class="ident" id="4562948">asn1Data</span><span class="op" id="4562956">)</span>&nbsp;<span class="op" id="4562958">&gt;</span>&nbsp;<span class="num" id="4562960">0</span>&nbsp;<span class="op" id="4562962">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562966">cert</span>&nbsp;<span class="op" id="4562971">:=</span>&nbsp;<span class="builtinfunc" id="4562974">new</span><span class="op" id="4562977">(</span><span class="ident" id="4562978">certificate</span><span class="op" id="4562989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562993">var</span>&nbsp;<span class="ident" id="4562997">err</span>&nbsp;<span class="builtintype" id="4563001">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563009">asn1Data</span><span class="op" id="4563017">,</span>&nbsp;<span class="ident" id="4563019">err</span>&nbsp;<span class="op" id="4563023">=</span>&nbsp;<span class="ident" id="4563025">asn1</span><span class="op" id="4563029">.</span><span class="ident" id="4563030">Unmarshal</span><span class="op" id="4563039">(</span><span class="ident" id="4563040">asn1Data</span><span class="op" id="4563048">,</span>&nbsp;<span class="ident" id="4563050">cert</span><span class="op" id="4563054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4563058">if</span>&nbsp;<span class="ident" id="4563061">err</span>&nbsp;<span class="op" id="4563065">!=</span>&nbsp;<span class="builtintype" id="4563068">nil</span>&nbsp;<span class="op" id="4563072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4563077">return</span>&nbsp;<span class="builtintype" id="4563084">nil</span><span class="op" id="4563087">,</span>&nbsp;<span class="ident" id="4563089">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563099">v</span>&nbsp;<span class="op" id="4563101">=</span>&nbsp;<span class="builtinfunc" id="4563103">append</span><span class="op" id="4563109">(</span><span class="ident" id="4563110">v</span><span class="op" id="4563111">,</span>&nbsp;<span class="ident" id="4563113">cert</span><span class="op" id="4563117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563124">ret</span>&nbsp;<span class="op" id="4563128">:=</span>&nbsp;<span class="builtinfunc" id="4563131">make</span><span class="op" id="4563135">(</span><span class="op" id="4563136">[</span><span class="op" id="4563137">]</span><span class="op" id="4563138">*</span><span class="ident" id="4563139">Certificate</span><span class="op" id="4563150">,</span>&nbsp;<span class="builtinfunc" id="4563152">len</span><span class="op" id="4563155">(</span><span class="ident" id="4563156">v</span><span class="op" id="4563157">)</span><span class="op" id="4563158">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4563161">for</span>&nbsp;<span class="ident" id="4563165">i</span><span class="op" id="4563166">,</span>&nbsp;<span class="ident" id="4563168">ci</span>&nbsp;<span class="op" id="4563171">:=</span>&nbsp;<span class="keyword" id="4563174">range</span>&nbsp;<span class="ident" id="4563180">v</span>&nbsp;<span class="op" id="4563182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563186">cert</span><span class="op" id="4563190">,</span>&nbsp;<span class="ident" id="4563192">err</span>&nbsp;<span class="op" id="4563196">:=</span>&nbsp;<span class="ident" id="4563199">parseCertificate</span><span class="op" id="4563215">(</span><span class="ident" id="4563216">ci</span><span class="op" id="4563218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4563222">if</span>&nbsp;<span class="ident" id="4563225">err</span>&nbsp;<span class="op" id="4563229">!=</span>&nbsp;<span class="builtintype" id="4563232">nil</span>&nbsp;<span class="op" id="4563236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4563241">return</span>&nbsp;<span class="builtintype" id="4563248">nil</span><span class="op" id="4563251">,</span>&nbsp;<span class="ident" id="4563253">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563259">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563263">ret</span><span class="op" id="4563266">[</span><span class="ident" id="4563267">i</span><span class="op" id="4563268">]</span>&nbsp;<span class="op" id="4563270">=</span>&nbsp;<span class="ident" id="4563272">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4563282">return</span>&nbsp;<span class="ident" id="4563289">ret</span><span class="op" id="4563292">,</span>&nbsp;<span class="builtintype" id="4563294">nil</span><br>
<span class="lineno"></span><span class="op" id="4563298">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4563301">func</span>&nbsp;<span class="ident" id="4563306">reverseBitsInAByte</span><span class="op" id="4563324">(</span><span class="ident" id="4563325">in</span>&nbsp;<span class="builtintype" id="4563328">byte</span><span class="op" id="4563332">)</span>&nbsp;<span class="builtintype" id="4563334">byte</span>&nbsp;<span class="op" id="4563339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563342">b1</span>&nbsp;<span class="op" id="4563345">:=</span>&nbsp;<span class="ident" id="4563348">in</span><span class="op" id="4563350">&gt;&gt;</span><span class="num" id="4563352">4</span>&nbsp;<span class="op" id="4563354">|</span>&nbsp;<span class="ident" id="4563356">in</span><span class="op" id="4563358">&lt;&lt;</span><span class="num" id="4563360">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563363">b2</span>&nbsp;<span class="op" id="4563366">:=</span>&nbsp;<span class="ident" id="4563369">b1</span><span class="op" id="4563371">&gt;&gt;</span><span class="num" id="4563373">2</span><span class="op" id="4563374">&amp;</span><span class="num" id="4563375">0x33</span>&nbsp;<span class="op" id="4563380">|</span>&nbsp;<span class="ident" id="4563382">b1</span><span class="op" id="4563384">&lt;&lt;</span><span class="num" id="4563386">2</span><span class="op" id="4563387">&amp;</span><span class="num" id="4563388">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563394">b3</span>&nbsp;<span class="op" id="4563397">:=</span>&nbsp;<span class="ident" id="4563400">b2</span><span class="op" id="4563402">&gt;&gt;</span><span class="num" id="4563404">1</span><span class="op" id="4563405">&amp;</span><span class="num" id="4563406">0x55</span>&nbsp;<span class="op" id="4563411">|</span>&nbsp;<span class="ident" id="4563413">b2</span><span class="op" id="4563415">&lt;&lt;</span><span class="num" id="4563417">1</span><span class="op" id="4563418">&amp;</span><span class="num" id="4563419">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4563425">return</span>&nbsp;<span class="ident" id="4563432">b3</span><br>
<span class="lineno"></span><span class="op" id="4563435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4563438">var</span>&nbsp;<span class="op" id="4563442">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563445">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563479">=</span>&nbsp;<span class="op" id="4563481">[</span><span class="op" id="4563482">]</span><span class="builtintype" id="4563483">int</span><span class="op" id="4563486">{</span><span class="num" id="4563487">2</span><span class="op" id="4563488">,</span>&nbsp;<span class="num" id="4563490">5</span><span class="op" id="4563491">,</span>&nbsp;<span class="num" id="4563493">29</span><span class="op" id="4563495">,</span>&nbsp;<span class="num" id="4563497">14</span><span class="op" id="4563499">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563502">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563536">=</span>&nbsp;<span class="op" id="4563538">[</span><span class="op" id="4563539">]</span><span class="builtintype" id="4563540">int</span><span class="op" id="4563543">{</span><span class="num" id="4563544">2</span><span class="op" id="4563545">,</span>&nbsp;<span class="num" id="4563547">5</span><span class="op" id="4563548">,</span>&nbsp;<span class="num" id="4563550">29</span><span class="op" id="4563552">,</span>&nbsp;<span class="num" id="4563554">15</span><span class="op" id="4563556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563559">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563593">=</span>&nbsp;<span class="op" id="4563595">[</span><span class="op" id="4563596">]</span><span class="builtintype" id="4563597">int</span><span class="op" id="4563600">{</span><span class="num" id="4563601">2</span><span class="op" id="4563602">,</span>&nbsp;<span class="num" id="4563604">5</span><span class="op" id="4563605">,</span>&nbsp;<span class="num" id="4563607">29</span><span class="op" id="4563609">,</span>&nbsp;<span class="num" id="4563611">37</span><span class="op" id="4563613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563616">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563650">=</span>&nbsp;<span class="op" id="4563652">[</span><span class="op" id="4563653">]</span><span class="builtintype" id="4563654">int</span><span class="op" id="4563657">{</span><span class="num" id="4563658">2</span><span class="op" id="4563659">,</span>&nbsp;<span class="num" id="4563661">5</span><span class="op" id="4563662">,</span>&nbsp;<span class="num" id="4563664">29</span><span class="op" id="4563666">,</span>&nbsp;<span class="num" id="4563668">35</span><span class="op" id="4563670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563673">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563707">=</span>&nbsp;<span class="op" id="4563709">[</span><span class="op" id="4563710">]</span><span class="builtintype" id="4563711">int</span><span class="op" id="4563714">{</span><span class="num" id="4563715">2</span><span class="op" id="4563716">,</span>&nbsp;<span class="num" id="4563718">5</span><span class="op" id="4563719">,</span>&nbsp;<span class="num" id="4563721">29</span><span class="op" id="4563723">,</span>&nbsp;<span class="num" id="4563725">19</span><span class="op" id="4563727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563730">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563764">=</span>&nbsp;<span class="op" id="4563766">[</span><span class="op" id="4563767">]</span><span class="builtintype" id="4563768">int</span><span class="op" id="4563771">{</span><span class="num" id="4563772">2</span><span class="op" id="4563773">,</span>&nbsp;<span class="num" id="4563775">5</span><span class="op" id="4563776">,</span>&nbsp;<span class="num" id="4563778">29</span><span class="op" id="4563780">,</span>&nbsp;<span class="num" id="4563782">17</span><span class="op" id="4563784">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563787">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4563821">=</span>&nbsp;<span class="op" id="4563823">[</span><span class="op" id="4563824">]</span><span class="builtintype" id="4563825">int</span><span class="op" id="4563828">{</span><span class="num" id="4563829">2</span><span class="op" id="4563830">,</span>&nbsp;<span class="num" id="4563832">5</span><span class="op" id="4563833">,</span>&nbsp;<span class="num" id="4563835">29</span><span class="op" id="4563837">,</span>&nbsp;<span class="num" id="4563839">32</span><span class="op" id="4563841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563844">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563878">=</span>&nbsp;<span class="op" id="4563880">[</span><span class="op" id="4563881">]</span><span class="builtintype" id="4563882">int</span><span class="op" id="4563885">{</span><span class="num" id="4563886">2</span><span class="op" id="4563887">,</span>&nbsp;<span class="num" id="4563889">5</span><span class="op" id="4563890">,</span>&nbsp;<span class="num" id="4563892">29</span><span class="op" id="4563894">,</span>&nbsp;<span class="num" id="4563896">30</span><span class="op" id="4563898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563901">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4563935">=</span>&nbsp;<span class="op" id="4563937">[</span><span class="op" id="4563938">]</span><span class="builtintype" id="4563939">int</span><span class="op" id="4563942">{</span><span class="num" id="4563943">2</span><span class="op" id="4563944">,</span>&nbsp;<span class="num" id="4563946">5</span><span class="op" id="4563947">,</span>&nbsp;<span class="num" id="4563949">29</span><span class="op" id="4563951">,</span>&nbsp;<span class="num" id="4563953">31</span><span class="op" id="4563955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563958">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4563992">=</span>&nbsp;<span class="op" id="4563994">[</span><span class="op" id="4563995">]</span><span class="builtintype" id="4563996">int</span><span class="op" id="4563999">{</span><span class="num" id="4564000">1</span><span class="op" id="4564001">,</span>&nbsp;<span class="num" id="4564003">3</span><span class="op" id="4564004">,</span>&nbsp;<span class="num" id="4564006">6</span><span class="op" id="4564007">,</span>&nbsp;<span class="num" id="4564009">1</span><span class="op" id="4564010">,</span>&nbsp;<span class="num" id="4564012">5</span><span class="op" id="4564013">,</span>&nbsp;<span class="num" id="4564015">5</span><span class="op" id="4564016">,</span>&nbsp;<span class="num" id="4564018">7</span><span class="op" id="4564019">,</span>&nbsp;<span class="num" id="4564021">1</span><span class="op" id="4564022">,</span>&nbsp;<span class="num" id="4564024">1</span><span class="op" id="4564025">}</span><br>
<span class="lineno"></span><span class="op" id="4564027">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4564030">var</span>&nbsp;<span class="op" id="4564034">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564037">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564067">=</span>&nbsp;<span class="ident" id="4564069">asn1</span><span class="op" id="4564073">.</span><span class="ident" id="4564074">ObjectIdentifier</span><span class="op" id="4564090">{</span><span class="num" id="4564091">1</span><span class="op" id="4564092">,</span>&nbsp;<span class="num" id="4564094">3</span><span class="op" id="4564095">,</span>&nbsp;<span class="num" id="4564097">6</span><span class="op" id="4564098">,</span>&nbsp;<span class="num" id="4564100">1</span><span class="op" id="4564101">,</span>&nbsp;<span class="num" id="4564103">5</span><span class="op" id="4564104">,</span>&nbsp;<span class="num" id="4564106">5</span><span class="op" id="4564107">,</span>&nbsp;<span class="num" id="4564109">7</span><span class="op" id="4564110">,</span>&nbsp;<span class="num" id="4564112">48</span><span class="op" id="4564114">,</span>&nbsp;<span class="num" id="4564116">1</span><span class="op" id="4564117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564120">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4564150">=</span>&nbsp;<span class="ident" id="4564152">asn1</span><span class="op" id="4564156">.</span><span class="ident" id="4564157">ObjectIdentifier</span><span class="op" id="4564173">{</span><span class="num" id="4564174">1</span><span class="op" id="4564175">,</span>&nbsp;<span class="num" id="4564177">3</span><span class="op" id="4564178">,</span>&nbsp;<span class="num" id="4564180">6</span><span class="op" id="4564181">,</span>&nbsp;<span class="num" id="4564183">1</span><span class="op" id="4564184">,</span>&nbsp;<span class="num" id="4564186">5</span><span class="op" id="4564187">,</span>&nbsp;<span class="num" id="4564189">5</span><span class="op" id="4564190">,</span>&nbsp;<span class="num" id="4564192">7</span><span class="op" id="4564193">,</span>&nbsp;<span class="num" id="4564195">48</span><span class="op" id="4564197">,</span>&nbsp;<span class="num" id="4564199">2</span><span class="op" id="4564200">}</span><br>
<span class="lineno"></span><span class="op" id="4564202">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4564205">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4564285">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4564300">func</span>&nbsp;<span class="ident" id="4564305">oidInExtensions</span><span class="op" id="4564320">(</span><span class="ident" id="4564321">oid</span>&nbsp;<span class="ident" id="4564325">asn1</span><span class="op" id="4564329">.</span><span class="ident" id="4564330">ObjectIdentifier</span><span class="op" id="4564346">,</span>&nbsp;<span class="ident" id="4564348">extensions</span>&nbsp;<span class="op" id="4564359">[</span><span class="op" id="4564360">]</span><span class="ident" id="4564361">pkix</span><span class="op" id="4564365">.</span><span class="ident" id="4564366">Extension</span><span class="op" id="4564375">)</span>&nbsp;<span class="builtintype" id="4564377">bool</span>&nbsp;<span class="op" id="4564382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564385">for</span>&nbsp;<span class="ident" id="4564389">_</span><span class="op" id="4564390">,</span>&nbsp;<span class="ident" id="4564392">e</span>&nbsp;<span class="op" id="4564394">:=</span>&nbsp;<span class="keyword" id="4564397">range</span>&nbsp;<span class="ident" id="4564403">extensions</span>&nbsp;<span class="op" id="4564414">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564418">if</span>&nbsp;<span class="ident" id="4564421">e</span><span class="op" id="4564422">.</span><span class="ident" id="4564423">Id</span><span class="op" id="4564425">.</span><span class="ident" id="4564426">Equal</span><span class="op" id="4564431">(</span><span class="ident" id="4564432">oid</span><span class="op" id="4564435">)</span>&nbsp;<span class="op" id="4564437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564442">return</span>&nbsp;<span class="builtintype" id="4564449">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564462">return</span>&nbsp;<span class="builtintype" id="4564469">false</span><br>
<span class="lineno">1165</span><span class="op" id="4564475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4564478">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4564554">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4564591">func</span>&nbsp;<span class="ident" id="4564596">marshalSANs</span><span class="op" id="4564607">(</span><span class="ident" id="4564608">dnsNames</span><span class="op" id="4564616">,</span>&nbsp;<span class="ident" id="4564618">emailAddresses</span>&nbsp;<span class="op" id="4564633">[</span><span class="op" id="4564634">]</span><span class="builtintype" id="4564635">string</span><span class="op" id="4564641">,</span>&nbsp;<span class="ident" id="4564643">ipAddresses</span>&nbsp;<span class="op" id="4564655">[</span><span class="op" id="4564656">]</span><span class="ident" id="4564657">net</span><span class="op" id="4564660">.</span><span class="ident" id="4564661">IP</span><span class="op" id="4564663">)</span>&nbsp;<span class="op" id="4564665">(</span><span class="ident" id="4564666">derBytes</span>&nbsp;<span class="op" id="4564675">[</span><span class="op" id="4564676">]</span><span class="builtintype" id="4564677">byte</span><span class="op" id="4564681">,</span>&nbsp;<span class="ident" id="4564683">err</span>&nbsp;<span class="builtintype" id="4564687">error</span><span class="op" id="4564692">)</span>&nbsp;<span class="op" id="4564694">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564697">var</span>&nbsp;<span class="ident" id="4564701">rawValues</span>&nbsp;<span class="op" id="4564711">[</span><span class="op" id="4564712">]</span><span class="ident" id="4564713">asn1</span><span class="op" id="4564717">.</span><span class="ident" id="4564718">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564728">for</span>&nbsp;<span class="ident" id="4564732">_</span><span class="op" id="4564733">,</span>&nbsp;<span class="ident" id="4564735">name</span>&nbsp;<span class="op" id="4564740">:=</span>&nbsp;<span class="keyword" id="4564743">range</span>&nbsp;<span class="ident" id="4564749">dnsNames</span>&nbsp;<span class="op" id="4564758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564762">rawValues</span>&nbsp;<span class="op" id="4564772">=</span>&nbsp;<span class="builtinfunc" id="4564774">append</span><span class="op" id="4564780">(</span><span class="ident" id="4564781">rawValues</span><span class="op" id="4564790">,</span>&nbsp;<span class="ident" id="4564792">asn1</span><span class="op" id="4564796">.</span><span class="ident" id="4564797">RawValue</span><span class="op" id="4564805">{</span><span class="ident" id="4564806">Tag</span><span class="op" id="4564809">:</span>&nbsp;<span class="num" id="4564811">2</span><span class="op" id="4564812">,</span>&nbsp;<span class="ident" id="4564814">Class</span><span class="op" id="4564819">:</span>&nbsp;<span class="num" id="4564821">2</span><span class="op" id="4564822">,</span>&nbsp;<span class="ident" id="4564824">Bytes</span><span class="op" id="4564829">:</span>&nbsp;<span class="op" id="4564831">[</span><span class="op" id="4564832">]</span><span class="builtintype" id="4564833">byte</span><span class="op" id="4564837">(</span><span class="ident" id="4564838">name</span><span class="op" id="4564842">)</span><span class="op" id="4564843">}</span><span class="op" id="4564844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564850">for</span>&nbsp;<span class="ident" id="4564854">_</span><span class="op" id="4564855">,</span>&nbsp;<span class="ident" id="4564857">email</span>&nbsp;<span class="op" id="4564863">:=</span>&nbsp;<span class="keyword" id="4564866">range</span>&nbsp;<span class="ident" id="4564872">emailAddresses</span>&nbsp;<span class="op" id="4564887">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564891">rawValues</span>&nbsp;<span class="op" id="4564901">=</span>&nbsp;<span class="builtinfunc" id="4564903">append</span><span class="op" id="4564909">(</span><span class="ident" id="4564910">rawValues</span><span class="op" id="4564919">,</span>&nbsp;<span class="ident" id="4564921">asn1</span><span class="op" id="4564925">.</span><span class="ident" id="4564926">RawValue</span><span class="op" id="4564934">{</span><span class="ident" id="4564935">Tag</span><span class="op" id="4564938">:</span>&nbsp;<span class="num" id="4564940">1</span><span class="op" id="4564941">,</span>&nbsp;<span class="ident" id="4564943">Class</span><span class="op" id="4564948">:</span>&nbsp;<span class="num" id="4564950">2</span><span class="op" id="4564951">,</span>&nbsp;<span class="ident" id="4564953">Bytes</span><span class="op" id="4564958">:</span>&nbsp;<span class="op" id="4564960">[</span><span class="op" id="4564961">]</span><span class="builtintype" id="4564962">byte</span><span class="op" id="4564966">(</span><span class="ident" id="4564967">email</span><span class="op" id="4564972">)</span><span class="op" id="4564973">}</span><span class="op" id="4564974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564980">for</span>&nbsp;<span class="ident" id="4564984">_</span><span class="op" id="4564985">,</span>&nbsp;<span class="ident" id="4564987">rawIP</span>&nbsp;<span class="op" id="4564993">:=</span>&nbsp;<span class="keyword" id="4564996">range</span>&nbsp;<span class="ident" id="4565002">ipAddresses</span>&nbsp;<span class="op" id="4565014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565018">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565088">ip</span>&nbsp;<span class="op" id="4565091">:=</span>&nbsp;<span class="ident" id="4565094">rawIP</span><span class="op" id="4565099">.</span><span class="ident" id="4565100">To4</span><span class="op" id="4565103">(</span><span class="op" id="4565104">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565108">if</span>&nbsp;<span class="ident" id="4565111">ip</span>&nbsp;<span class="op" id="4565114">==</span>&nbsp;<span class="builtintype" id="4565117">nil</span>&nbsp;<span class="op" id="4565121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565126">ip</span>&nbsp;<span class="op" id="4565129">=</span>&nbsp;<span class="ident" id="4565131">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565143">rawValues</span>&nbsp;<span class="op" id="4565153">=</span>&nbsp;<span class="builtinfunc" id="4565155">append</span><span class="op" id="4565161">(</span><span class="ident" id="4565162">rawValues</span><span class="op" id="4565171">,</span>&nbsp;<span class="ident" id="4565173">asn1</span><span class="op" id="4565177">.</span><span class="ident" id="4565178">RawValue</span><span class="op" id="4565186">{</span><span class="ident" id="4565187">Tag</span><span class="op" id="4565190">:</span>&nbsp;<span class="num" id="4565192">7</span><span class="op" id="4565193">,</span>&nbsp;<span class="ident" id="4565195">Class</span><span class="op" id="4565200">:</span>&nbsp;<span class="num" id="4565202">2</span><span class="op" id="4565203">,</span>&nbsp;<span class="ident" id="4565205">Bytes</span><span class="op" id="4565210">:</span>&nbsp;<span class="ident" id="4565212">ip</span><span class="op" id="4565214">}</span><span class="op" id="4565215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565218">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565221">return</span>&nbsp;<span class="ident" id="4565228">asn1</span><span class="op" id="4565232">.</span><span class="ident" id="4565233">Marshal</span><span class="op" id="4565240">(</span><span class="ident" id="4565241">rawValues</span><span class="op" id="4565250">)</span><br>
<span class="lineno"></span><span class="op" id="4565252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4565255">func</span>&nbsp;<span class="ident" id="4565260">buildExtensions</span><span class="op" id="4565275">(</span><span class="ident" id="4565276">template</span>&nbsp;<span class="op" id="4565285">*</span><span class="ident" id="4565286">Certificate</span><span class="op" id="4565297">)</span>&nbsp;<span class="op" id="4565299">(</span><span class="ident" id="4565300">ret</span>&nbsp;<span class="op" id="4565304">[</span><span class="op" id="4565305">]</span><span class="ident" id="4565306">pkix</span><span class="op" id="4565310">.</span><span class="ident" id="4565311">Extension</span><span class="op" id="4565320">,</span>&nbsp;<span class="ident" id="4565322">err</span>&nbsp;<span class="builtintype" id="4565326">error</span><span class="op" id="4565331">)</span>&nbsp;<span class="op" id="4565333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565336">ret</span>&nbsp;<span class="op" id="4565340">=</span>&nbsp;<span class="builtinfunc" id="4565342">make</span><span class="op" id="4565346">(</span><span class="op" id="4565347">[</span><span class="op" id="4565348">]</span><span class="ident" id="4565349">pkix</span><span class="op" id="4565353">.</span><span class="ident" id="4565354">Extension</span><span class="op" id="4565363">,</span>&nbsp;<span class="num" id="4565365">10</span>&nbsp;<span class="comment" id="4565368">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4565401">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565404">n</span>&nbsp;<span class="op" id="4565406">:=</span>&nbsp;<span class="num" id="4565409">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565413">if</span>&nbsp;<span class="ident" id="4565416">template</span><span class="op" id="4565424">.</span><span class="ident" id="4565425">KeyUsage</span>&nbsp;<span class="op" id="4565434">!=</span>&nbsp;<span class="num" id="4565437">0</span>&nbsp;<span class="op" id="4565439">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565444">!</span><span class="ident" id="4565445">oidInExtensions</span><span class="op" id="4565460">(</span><span class="ident" id="4565461">oidExtensionKeyUsage</span><span class="op" id="4565481">,</span>&nbsp;<span class="ident" id="4565483">template</span><span class="op" id="4565491">.</span><span class="ident" id="4565492">ExtraExtensions</span><span class="op" id="4565507">)</span>&nbsp;<span class="op" id="4565509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565513">ret</span><span class="op" id="4565516">[</span><span class="ident" id="4565517">n</span><span class="op" id="4565518">]</span><span class="op" id="4565519">.</span><span class="ident" id="4565520">Id</span>&nbsp;<span class="op" id="4565523">=</span>&nbsp;<span class="ident" id="4565525">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565548">ret</span><span class="op" id="4565551">[</span><span class="ident" id="4565552">n</span><span class="op" id="4565553">]</span><span class="op" id="4565554">.</span><span class="ident" id="4565555">Critical</span>&nbsp;<span class="op" id="4565564">=</span>&nbsp;<span class="builtintype" id="4565566">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565574">var</span>&nbsp;<span class="ident" id="4565578">a</span>&nbsp;<span class="op" id="4565580">[</span><span class="num" id="4565581">2</span><span class="op" id="4565582">]</span><span class="builtintype" id="4565583">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565590">a</span><span class="op" id="4565591">[</span><span class="num" id="4565592">0</span><span class="op" id="4565593">]</span>&nbsp;<span class="op" id="4565595">=</span>&nbsp;<span class="ident" id="4565597">reverseBitsInAByte</span><span class="op" id="4565615">(</span><span class="builtintype" id="4565616">byte</span><span class="op" id="4565620">(</span><span class="ident" id="4565621">template</span><span class="op" id="4565629">.</span><span class="ident" id="4565630">KeyUsage</span><span class="op" id="4565638">)</span><span class="op" id="4565639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565643">a</span><span class="op" id="4565644">[</span><span class="num" id="4565645">1</span><span class="op" id="4565646">]</span>&nbsp;<span class="op" id="4565648">=</span>&nbsp;<span class="ident" id="4565650">reverseBitsInAByte</span><span class="op" id="4565668">(</span><span class="builtintype" id="4565669">byte</span><span class="op" id="4565673">(</span><span class="ident" id="4565674">template</span><span class="op" id="4565682">.</span><span class="ident" id="4565683">KeyUsage</span>&nbsp;<span class="op" id="4565692">&gt;&gt;</span>&nbsp;<span class="num" id="4565695">8</span><span class="op" id="4565696">)</span><span class="op" id="4565697">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565702">l</span>&nbsp;<span class="op" id="4565704">:=</span>&nbsp;<span class="num" id="4565707">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565711">if</span>&nbsp;<span class="ident" id="4565714">a</span><span class="op" id="4565715">[</span><span class="num" id="4565716">1</span><span class="op" id="4565717">]</span>&nbsp;<span class="op" id="4565719">!=</span>&nbsp;<span class="num" id="4565722">0</span>&nbsp;<span class="op" id="4565724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565729">l</span>&nbsp;<span class="op" id="4565731">=</span>&nbsp;<span class="num" id="4565733">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565737">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565742">ret</span><span class="op" id="4565745">[</span><span class="ident" id="4565746">n</span><span class="op" id="4565747">]</span><span class="op" id="4565748">.</span><span class="ident" id="4565749">Value</span><span class="op" id="4565754">,</span>&nbsp;<span class="ident" id="4565756">err</span>&nbsp;<span class="op" id="4565760">=</span>&nbsp;<span class="ident" id="4565762">asn1</span><span class="op" id="4565766">.</span><span class="ident" id="4565767">Marshal</span><span class="op" id="4565774">(</span><span class="ident" id="4565775">asn1</span><span class="op" id="4565779">.</span><span class="ident" id="4565780">BitString</span><span class="op" id="4565789">{</span><span class="ident" id="4565790">Bytes</span><span class="op" id="4565795">:</span>&nbsp;<span class="ident" id="4565797">a</span><span class="op" id="4565798">[</span><span class="num" id="4565799">0</span><span class="op" id="4565800">:</span><span class="ident" id="4565801">l</span><span class="op" id="4565802">]</span><span class="op" id="4565803">,</span>&nbsp;<span class="ident" id="4565805">BitLength</span><span class="op" id="4565814">:</span>&nbsp;<span class="ident" id="4565816">l</span>&nbsp;<span class="op" id="4565818">*</span>&nbsp;<span class="num" id="4565820">8</span><span class="op" id="4565821">}</span><span class="op" id="4565822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565826">if</span>&nbsp;<span class="ident" id="4565829">err</span>&nbsp;<span class="op" id="4565833">!=</span>&nbsp;<span class="builtintype" id="4565836">nil</span>&nbsp;<span class="op" id="4565840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565845">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565854">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565858">n</span><span class="op" id="4565859">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565867">if</span>&nbsp;<span class="op" id="4565870">(</span><span class="builtinfunc" id="4565871">len</span><span class="op" id="4565874">(</span><span class="ident" id="4565875">template</span><span class="op" id="4565883">.</span><span class="ident" id="4565884">ExtKeyUsage</span><span class="op" id="4565895">)</span>&nbsp;<span class="op" id="4565897">&gt;</span>&nbsp;<span class="num" id="4565899">0</span>&nbsp;<span class="op" id="4565901">||</span>&nbsp;<span class="builtinfunc" id="4565904">len</span><span class="op" id="4565907">(</span><span class="ident" id="4565908">template</span><span class="op" id="4565916">.</span><span class="ident" id="4565917">UnknownExtKeyUsage</span><span class="op" id="4565935">)</span>&nbsp;<span class="op" id="4565937">&gt;</span>&nbsp;<span class="num" id="4565939">0</span><span class="op" id="4565940">)</span>&nbsp;<span class="op" id="4565942">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565947">!</span><span class="ident" id="4565948">oidInExtensions</span><span class="op" id="4565963">(</span><span class="ident" id="4565964">oidExtensionExtendedKeyUsage</span><span class="op" id="4565992">,</span>&nbsp;<span class="ident" id="4565994">template</span><span class="op" id="4566002">.</span><span class="ident" id="4566003">ExtraExtensions</span><span class="op" id="4566018">)</span>&nbsp;<span class="op" id="4566020">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566024">ret</span><span class="op" id="4566027">[</span><span class="ident" id="4566028">n</span><span class="op" id="4566029">]</span><span class="op" id="4566030">.</span><span class="ident" id="4566031">Id</span>&nbsp;<span class="op" id="4566034">=</span>&nbsp;<span class="ident" id="4566036">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566068">var</span>&nbsp;<span class="ident" id="4566072">oids</span>&nbsp;<span class="op" id="4566077">[</span><span class="op" id="4566078">]</span><span class="ident" id="4566079">asn1</span><span class="op" id="4566083">.</span><span class="ident" id="4566084">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566103">for</span>&nbsp;<span class="ident" id="4566107">_</span><span class="op" id="4566108">,</span>&nbsp;<span class="ident" id="4566110">u</span>&nbsp;<span class="op" id="4566112">:=</span>&nbsp;<span class="keyword" id="4566115">range</span>&nbsp;<span class="ident" id="4566121">template</span><span class="op" id="4566129">.</span><span class="ident" id="4566130">ExtKeyUsage</span>&nbsp;<span class="op" id="4566142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566147">if</span>&nbsp;<span class="ident" id="4566150">oid</span><span class="op" id="4566153">,</span>&nbsp;<span class="ident" id="4566155">ok</span>&nbsp;<span class="op" id="4566158">:=</span>&nbsp;<span class="ident" id="4566161">oidFromExtKeyUsage</span><span class="op" id="4566179">(</span><span class="ident" id="4566180">u</span><span class="op" id="4566181">)</span><span class="op" id="4566182">;</span>&nbsp;<span class="ident" id="4566184">ok</span>&nbsp;<span class="op" id="4566187">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566193">oids</span>&nbsp;<span class="op" id="4566198">=</span>&nbsp;<span class="builtinfunc" id="4566200">append</span><span class="op" id="4566206">(</span><span class="ident" id="4566207">oids</span><span class="op" id="4566211">,</span>&nbsp;<span class="ident" id="4566213">oid</span><span class="op" id="4566216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4566221">}</span>&nbsp;<span class="keyword" id="4566223">else</span>&nbsp;<span class="op" id="4566228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4566234">panic</span><span class="op" id="4566239">(</span><span class="string" id="4566240">&#34;internal&nbsp;error&#34;</span><span class="op" id="4566256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4566261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4566265">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566270">oids</span>&nbsp;<span class="op" id="4566275">=</span>&nbsp;<span class="builtinfunc" id="4566277">append</span><span class="op" id="4566283">(</span><span class="ident" id="4566284">oids</span><span class="op" id="4566288">,</span>&nbsp;<span class="ident" id="4566290">template</span><span class="op" id="4566298">.</span><span class="ident" id="4566299">UnknownExtKeyUsage</span><span class="op" id="4566317">...</span><span class="op" id="4566320">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566325">ret</span><span class="op" id="4566328">[</span><span class="ident" id="4566329">n</span><span class="op" id="4566330">]</span><span class="op" id="4566331">.</span><span class="ident" id="4566332">Value</span><span class="op" id="4566337">,</span>&nbsp;<span class="ident" id="4566339">err</span>&nbsp;<span class="op" id="4566343">=</span>&nbsp;<span class="ident" id="4566345">asn1</span><span class="op" id="4566349">.</span><span class="ident" id="4566350">Marshal</span><span class="op" id="4566357">(</span><span class="ident" id="4566358">oids</span><span class="op" id="4566362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566366">if</span>&nbsp;<span class="ident" id="4566369">err</span>&nbsp;<span class="op" id="4566373">!=</span>&nbsp;<span class="builtintype" id="4566376">nil</span>&nbsp;<span class="op" id="4566380">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566385">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4566394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566398">n</span><span class="op" id="4566399">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4566403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566407">if</span>&nbsp;<span class="ident" id="4566410">template</span><span class="op" id="4566418">.</span><span class="ident" id="4566419">BasicConstraintsValid</span>&nbsp;<span class="op" id="4566441">&amp;&amp;</span>&nbsp;<span class="op" id="4566444">!</span><span class="ident" id="4566445">oidInExtensions</span><span class="op" id="4566460">(</span><span class="ident" id="4566461">oidExtensionBasicConstraints</span><span class="op" id="4566489">,</span>&nbsp;<span class="ident" id="4566491">template</span><span class="op" id="4566499">.</span><span class="ident" id="4566500">ExtraExtensions</span><span class="op" id="4566515">)</span>&nbsp;<span class="op" id="4566517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4566521">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4566584">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4566649">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566708">maxPathLen</span>&nbsp;<span class="op" id="4566719">:=</span>&nbsp;<span class="ident" id="4566722">template</span><span class="op" id="4566730">.</span><span class="ident" id="4566731">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566744">if</span>&nbsp;<span class="ident" id="4566747">maxPathLen</span>&nbsp;<span class="op" id="4566758">==</span>&nbsp;<span class="num" id="4566761">0</span>&nbsp;<span class="op" id="4566763">&amp;&amp;</span>&nbsp;<span class="op" id="4566766">!</span><span class="ident" id="4566767">template</span><span class="op" id="4566775">.</span><span class="ident" id="4566776">MaxPathLenZero</span>&nbsp;<span class="op" id="4566791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566796">maxPathLen</span>&nbsp;<span class="op" id="4566807">=</span>&nbsp;<span class="op" id="4566809">-</span><span class="num" id="4566810">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4566814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566818">ret</span><span class="op" id="4566821">[</span><span class="ident" id="4566822">n</span><span class="op" id="4566823">]</span><span class="op" id="4566824">.</span><span class="ident" id="4566825">Id</span>&nbsp;<span class="op" id="4566828">=</span>&nbsp;<span class="ident" id="4566830">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566861">ret</span><span class="op" id="4566864">[</span><span class="ident" id="4566865">n</span><span class="op" id="4566866">]</span><span class="op" id="4566867">.</span><span class="ident" id="4566868">Value</span><span class="op" id="4566873">,</span>&nbsp;<span class="ident" id="4566875">err</span>&nbsp;<span class="op" id="4566879">=</span>&nbsp;<span class="ident" id="4566881">asn1</span><span class="op" id="4566885">.</span><span class="ident" id="4566886">Marshal</span><span class="op" id="4566893">(</span><span class="ident" id="4566894">basicConstraints</span><span class="op" id="4566910">{</span><span class="ident" id="4566911">template</span><span class="op" id="4566919">.</span><span class="ident" id="4566920">IsCA</span><span class="op" id="4566924">,</span>&nbsp;<span class="ident" id="4566926">maxPathLen</span><span class="op" id="4566936">}</span><span class="op" id="4566937">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566941">ret</span><span class="op" id="4566944">[</span><span class="ident" id="4566945">n</span><span class="op" id="4566946">]</span><span class="op" id="4566947">.</span><span class="ident" id="4566948">Critical</span>&nbsp;<span class="op" id="4566957">=</span>&nbsp;<span class="builtintype" id="4566959">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566966">if</span>&nbsp;<span class="ident" id="4566969">err</span>&nbsp;<span class="op" id="4566973">!=</span>&nbsp;<span class="builtintype" id="4566976">nil</span>&nbsp;<span class="op" id="4566980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566985">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4566994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566998">n</span><span class="op" id="4566999">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567007">if</span>&nbsp;<span class="builtinfunc" id="4567010">len</span><span class="op" id="4567013">(</span><span class="ident" id="4567014">template</span><span class="op" id="4567022">.</span><span class="ident" id="4567023">SubjectKeyId</span><span class="op" id="4567035">)</span>&nbsp;<span class="op" id="4567037">&gt;</span>&nbsp;<span class="num" id="4567039">0</span>&nbsp;<span class="op" id="4567041">&amp;&amp;</span>&nbsp;<span class="op" id="4567044">!</span><span class="ident" id="4567045">oidInExtensions</span><span class="op" id="4567060">(</span><span class="ident" id="4567061">oidExtensionSubjectKeyId</span><span class="op" id="4567085">,</span>&nbsp;<span class="ident" id="4567087">template</span><span class="op" id="4567095">.</span><span class="ident" id="4567096">ExtraExtensions</span><span class="op" id="4567111">)</span>&nbsp;<span class="op" id="4567113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567117">ret</span><span class="op" id="4567120">[</span><span class="ident" id="4567121">n</span><span class="op" id="4567122">]</span><span class="op" id="4567123">.</span><span class="ident" id="4567124">Id</span>&nbsp;<span class="op" id="4567127">=</span>&nbsp;<span class="ident" id="4567129">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567156">ret</span><span class="op" id="4567159">[</span><span class="ident" id="4567160">n</span><span class="op" id="4567161">]</span><span class="op" id="4567162">.</span><span class="ident" id="4567163">Value</span><span class="op" id="4567168">,</span>&nbsp;<span class="ident" id="4567170">err</span>&nbsp;<span class="op" id="4567174">=</span>&nbsp;<span class="ident" id="4567176">asn1</span><span class="op" id="4567180">.</span><span class="ident" id="4567181">Marshal</span><span class="op" id="4567188">(</span><span class="ident" id="4567189">template</span><span class="op" id="4567197">.</span><span class="ident" id="4567198">SubjectKeyId</span><span class="op" id="4567210">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567214">if</span>&nbsp;<span class="ident" id="4567217">err</span>&nbsp;<span class="op" id="4567221">!=</span>&nbsp;<span class="builtintype" id="4567224">nil</span>&nbsp;<span class="op" id="4567228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567233">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567246">n</span><span class="op" id="4567247">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567251">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567255">if</span>&nbsp;<span class="builtinfunc" id="4567258">len</span><span class="op" id="4567261">(</span><span class="ident" id="4567262">template</span><span class="op" id="4567270">.</span><span class="ident" id="4567271">AuthorityKeyId</span><span class="op" id="4567285">)</span>&nbsp;<span class="op" id="4567287">&gt;</span>&nbsp;<span class="num" id="4567289">0</span>&nbsp;<span class="op" id="4567291">&amp;&amp;</span>&nbsp;<span class="op" id="4567294">!</span><span class="ident" id="4567295">oidInExtensions</span><span class="op" id="4567310">(</span><span class="ident" id="4567311">oidExtensionAuthorityKeyId</span><span class="op" id="4567337">,</span>&nbsp;<span class="ident" id="4567339">template</span><span class="op" id="4567347">.</span><span class="ident" id="4567348">ExtraExtensions</span><span class="op" id="4567363">)</span>&nbsp;<span class="op" id="4567365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567369">ret</span><span class="op" id="4567372">[</span><span class="ident" id="4567373">n</span><span class="op" id="4567374">]</span><span class="op" id="4567375">.</span><span class="ident" id="4567376">Id</span>&nbsp;<span class="op" id="4567379">=</span>&nbsp;<span class="ident" id="4567381">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567410">ret</span><span class="op" id="4567413">[</span><span class="ident" id="4567414">n</span><span class="op" id="4567415">]</span><span class="op" id="4567416">.</span><span class="ident" id="4567417">Value</span><span class="op" id="4567422">,</span>&nbsp;<span class="ident" id="4567424">err</span>&nbsp;<span class="op" id="4567428">=</span>&nbsp;<span class="ident" id="4567430">asn1</span><span class="op" id="4567434">.</span><span class="ident" id="4567435">Marshal</span><span class="op" id="4567442">(</span><span class="ident" id="4567443">authKeyId</span><span class="op" id="4567452">{</span><span class="ident" id="4567453">template</span><span class="op" id="4567461">.</span><span class="ident" id="4567462">AuthorityKeyId</span><span class="op" id="4567476">}</span><span class="op" id="4567477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567481">if</span>&nbsp;<span class="ident" id="4567484">err</span>&nbsp;<span class="op" id="4567488">!=</span>&nbsp;<span class="builtintype" id="4567491">nil</span>&nbsp;<span class="op" id="4567495">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567500">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567513">n</span><span class="op" id="4567514">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567522">if</span>&nbsp;<span class="op" id="4567525">(</span><span class="builtinfunc" id="4567526">len</span><span class="op" id="4567529">(</span><span class="ident" id="4567530">template</span><span class="op" id="4567538">.</span><span class="ident" id="4567539">OCSPServer</span><span class="op" id="4567549">)</span>&nbsp;<span class="op" id="4567551">&gt;</span>&nbsp;<span class="num" id="4567553">0</span>&nbsp;<span class="op" id="4567555">||</span>&nbsp;<span class="builtinfunc" id="4567558">len</span><span class="op" id="4567561">(</span><span class="ident" id="4567562">template</span><span class="op" id="4567570">.</span><span class="ident" id="4567571">IssuingCertificateURL</span><span class="op" id="4567592">)</span>&nbsp;<span class="op" id="4567594">&gt;</span>&nbsp;<span class="num" id="4567596">0</span><span class="op" id="4567597">)</span>&nbsp;<span class="op" id="4567599">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567604">!</span><span class="ident" id="4567605">oidInExtensions</span><span class="op" id="4567620">(</span><span class="ident" id="4567621">oidExtensionAuthorityInfoAccess</span><span class="op" id="4567652">,</span>&nbsp;<span class="ident" id="4567654">template</span><span class="op" id="4567662">.</span><span class="ident" id="4567663">ExtraExtensions</span><span class="op" id="4567678">)</span>&nbsp;<span class="op" id="4567680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567684">ret</span><span class="op" id="4567687">[</span><span class="ident" id="4567688">n</span><span class="op" id="4567689">]</span><span class="op" id="4567690">.</span><span class="ident" id="4567691">Id</span>&nbsp;<span class="op" id="4567694">=</span>&nbsp;<span class="ident" id="4567696">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567730">var</span>&nbsp;<span class="ident" id="4567734">aiaValues</span>&nbsp;<span class="op" id="4567744">[</span><span class="op" id="4567745">]</span><span class="ident" id="4567746">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567768">for</span>&nbsp;<span class="ident" id="4567772">_</span><span class="op" id="4567773">,</span>&nbsp;<span class="ident" id="4567775">name</span>&nbsp;<span class="op" id="4567780">:=</span>&nbsp;<span class="keyword" id="4567783">range</span>&nbsp;<span class="ident" id="4567789">template</span><span class="op" id="4567797">.</span><span class="ident" id="4567798">OCSPServer</span>&nbsp;<span class="op" id="4567809">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567814">aiaValues</span>&nbsp;<span class="op" id="4567824">=</span>&nbsp;<span class="builtinfunc" id="4567826">append</span><span class="op" id="4567832">(</span><span class="ident" id="4567833">aiaValues</span><span class="op" id="4567842">,</span>&nbsp;<span class="ident" id="4567844">authorityInfoAccess</span><span class="op" id="4567863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567869">Method</span><span class="op" id="4567875">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4567879">oidAuthorityInfoAccessOcsp</span><span class="op" id="4567905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567911">Location</span><span class="op" id="4567919">:</span>&nbsp;<span class="ident" id="4567921">asn1</span><span class="op" id="4567925">.</span><span class="ident" id="4567926">RawValue</span><span class="op" id="4567934">{</span><span class="ident" id="4567935">Tag</span><span class="op" id="4567938">:</span>&nbsp;<span class="num" id="4567940">6</span><span class="op" id="4567941">,</span>&nbsp;<span class="ident" id="4567943">Class</span><span class="op" id="4567948">:</span>&nbsp;<span class="num" id="4567950">2</span><span class="op" id="4567951">,</span>&nbsp;<span class="ident" id="4567953">Bytes</span><span class="op" id="4567958">:</span>&nbsp;<span class="op" id="4567960">[</span><span class="op" id="4567961">]</span><span class="builtintype" id="4567962">byte</span><span class="op" id="4567966">(</span><span class="ident" id="4567967">name</span><span class="op" id="4567971">)</span><span class="op" id="4567972">}</span><span class="op" id="4567973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567978">}</span><span class="op" id="4567979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567983">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567987">for</span>&nbsp;<span class="ident" id="4567991">_</span><span class="op" id="4567992">,</span>&nbsp;<span class="ident" id="4567994">name</span>&nbsp;<span class="op" id="4567999">:=</span>&nbsp;<span class="keyword" id="4568002">range</span>&nbsp;<span class="ident" id="4568008">template</span><span class="op" id="4568016">.</span><span class="ident" id="4568017">IssuingCertificateURL</span>&nbsp;<span class="op" id="4568039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568044">aiaValues</span>&nbsp;<span class="op" id="4568054">=</span>&nbsp;<span class="builtinfunc" id="4568056">append</span><span class="op" id="4568062">(</span><span class="ident" id="4568063">aiaValues</span><span class="op" id="4568072">,</span>&nbsp;<span class="ident" id="4568074">authorityInfoAccess</span><span class="op" id="4568093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568099">Method</span><span class="op" id="4568105">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4568109">oidAuthorityInfoAccessIssuers</span><span class="op" id="4568138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568144">Location</span><span class="op" id="4568152">:</span>&nbsp;<span class="ident" id="4568154">asn1</span><span class="op" id="4568158">.</span><span class="ident" id="4568159">RawValue</span><span class="op" id="4568167">{</span><span class="ident" id="4568168">Tag</span><span class="op" id="4568171">:</span>&nbsp;<span class="num" id="4568173">6</span><span class="op" id="4568174">,</span>&nbsp;<span class="ident" id="4568176">Class</span><span class="op" id="4568181">:</span>&nbsp;<span class="num" id="4568183">2</span><span class="op" id="4568184">,</span>&nbsp;<span class="ident" id="4568186">Bytes</span><span class="op" id="4568191">:</span>&nbsp;<span class="op" id="4568193">[</span><span class="op" id="4568194">]</span><span class="builtintype" id="4568195">byte</span><span class="op" id="4568199">(</span><span class="ident" id="4568200">name</span><span class="op" id="4568204">)</span><span class="op" id="4568205">}</span><span class="op" id="4568206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568211">}</span><span class="op" id="4568212">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568220">ret</span><span class="op" id="4568223">[</span><span class="ident" id="4568224">n</span><span class="op" id="4568225">]</span><span class="op" id="4568226">.</span><span class="ident" id="4568227">Value</span><span class="op" id="4568232">,</span>&nbsp;<span class="ident" id="4568234">err</span>&nbsp;<span class="op" id="4568238">=</span>&nbsp;<span class="ident" id="4568240">asn1</span><span class="op" id="4568244">.</span><span class="ident" id="4568245">Marshal</span><span class="op" id="4568252">(</span><span class="ident" id="4568253">aiaValues</span><span class="op" id="4568262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568266">if</span>&nbsp;<span class="ident" id="4568269">err</span>&nbsp;<span class="op" id="4568273">!=</span>&nbsp;<span class="builtintype" id="4568276">nil</span>&nbsp;<span class="op" id="4568280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568285">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568294">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568298">n</span><span class="op" id="4568299">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568307">if</span>&nbsp;<span class="op" id="4568310">(</span><span class="builtinfunc" id="4568311">len</span><span class="op" id="4568314">(</span><span class="ident" id="4568315">template</span><span class="op" id="4568323">.</span><span class="ident" id="4568324">DNSNames</span><span class="op" id="4568332">)</span>&nbsp;<span class="op" id="4568334">&gt;</span>&nbsp;<span class="num" id="4568336">0</span>&nbsp;<span class="op" id="4568338">||</span>&nbsp;<span class="builtinfunc" id="4568341">len</span><span class="op" id="4568344">(</span><span class="ident" id="4568345">template</span><span class="op" id="4568353">.</span><span class="ident" id="4568354">EmailAddresses</span><span class="op" id="4568368">)</span>&nbsp;<span class="op" id="4568370">&gt;</span>&nbsp;<span class="num" id="4568372">0</span>&nbsp;<span class="op" id="4568374">||</span>&nbsp;<span class="builtinfunc" id="4568377">len</span><span class="op" id="4568380">(</span><span class="ident" id="4568381">template</span><span class="op" id="4568389">.</span><span class="ident" id="4568390">IPAddresses</span><span class="op" id="4568401">)</span>&nbsp;<span class="op" id="4568403">&gt;</span>&nbsp;<span class="num" id="4568405">0</span><span class="op" id="4568406">)</span>&nbsp;<span class="op" id="4568408">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568413">!</span><span class="ident" id="4568414">oidInExtensions</span><span class="op" id="4568429">(</span><span class="ident" id="4568430">oidExtensionSubjectAltName</span><span class="op" id="4568456">,</span>&nbsp;<span class="ident" id="4568458">template</span><span class="op" id="4568466">.</span><span class="ident" id="4568467">ExtraExtensions</span><span class="op" id="4568482">)</span>&nbsp;<span class="op" id="4568484">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568488">ret</span><span class="op" id="4568491">[</span><span class="ident" id="4568492">n</span><span class="op" id="4568493">]</span><span class="op" id="4568494">.</span><span class="ident" id="4568495">Id</span>&nbsp;<span class="op" id="4568498">=</span>&nbsp;<span class="ident" id="4568500">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568529">ret</span><span class="op" id="4568532">[</span><span class="ident" id="4568533">n</span><span class="op" id="4568534">]</span><span class="op" id="4568535">.</span><span class="ident" id="4568536">Value</span><span class="op" id="4568541">,</span>&nbsp;<span class="ident" id="4568543">err</span>&nbsp;<span class="op" id="4568547">=</span>&nbsp;<span class="ident" id="4568549">marshalSANs</span><span class="op" id="4568560">(</span><span class="ident" id="4568561">template</span><span class="op" id="4568569">.</span><span class="ident" id="4568570">DNSNames</span><span class="op" id="4568578">,</span>&nbsp;<span class="ident" id="4568580">template</span><span class="op" id="4568588">.</span><span class="ident" id="4568589">EmailAddresses</span><span class="op" id="4568603">,</span>&nbsp;<span class="ident" id="4568605">template</span><span class="op" id="4568613">.</span><span class="ident" id="4568614">IPAddresses</span><span class="op" id="4568625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568629">if</span>&nbsp;<span class="ident" id="4568632">err</span>&nbsp;<span class="op" id="4568636">!=</span>&nbsp;<span class="builtintype" id="4568639">nil</span>&nbsp;<span class="op" id="4568643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568648">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568657">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568661">n</span><span class="op" id="4568662">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568670">if</span>&nbsp;<span class="builtinfunc" id="4568673">len</span><span class="op" id="4568676">(</span><span class="ident" id="4568677">template</span><span class="op" id="4568685">.</span><span class="ident" id="4568686">PolicyIdentifiers</span><span class="op" id="4568703">)</span>&nbsp;<span class="op" id="4568705">&gt;</span>&nbsp;<span class="num" id="4568707">0</span>&nbsp;<span class="op" id="4568709">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568714">!</span><span class="ident" id="4568715">oidInExtensions</span><span class="op" id="4568730">(</span><span class="ident" id="4568731">oidExtensionCertificatePolicies</span><span class="op" id="4568762">,</span>&nbsp;<span class="ident" id="4568764">template</span><span class="op" id="4568772">.</span><span class="ident" id="4568773">ExtraExtensions</span><span class="op" id="4568788">)</span>&nbsp;<span class="op" id="4568790">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568794">ret</span><span class="op" id="4568797">[</span><span class="ident" id="4568798">n</span><span class="op" id="4568799">]</span><span class="op" id="4568800">.</span><span class="ident" id="4568801">Id</span>&nbsp;<span class="op" id="4568804">=</span>&nbsp;<span class="ident" id="4568806">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568840">policies</span>&nbsp;<span class="op" id="4568849">:=</span>&nbsp;<span class="builtinfunc" id="4568852">make</span><span class="op" id="4568856">(</span><span class="op" id="4568857">[</span><span class="op" id="4568858">]</span><span class="ident" id="4568859">policyInformation</span><span class="op" id="4568876">,</span>&nbsp;<span class="builtinfunc" id="4568878">len</span><span class="op" id="4568881">(</span><span class="ident" id="4568882">template</span><span class="op" id="4568890">.</span><span class="ident" id="4568891">PolicyIdentifiers</span><span class="op" id="4568908">)</span><span class="op" id="4568909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568913">for</span>&nbsp;<span class="ident" id="4568917">i</span><span class="op" id="4568918">,</span>&nbsp;<span class="ident" id="4568920">policy</span>&nbsp;<span class="op" id="4568927">:=</span>&nbsp;<span class="keyword" id="4568930">range</span>&nbsp;<span class="ident" id="4568936">template</span><span class="op" id="4568944">.</span><span class="ident" id="4568945">PolicyIdentifiers</span>&nbsp;<span class="op" id="4568963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568968">policies</span><span class="op" id="4568976">[</span><span class="ident" id="4568977">i</span><span class="op" id="4568978">]</span><span class="op" id="4568979">.</span><span class="ident" id="4568980">Policy</span>&nbsp;<span class="op" id="4568987">=</span>&nbsp;<span class="ident" id="4568989">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568998">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569002">ret</span><span class="op" id="4569005">[</span><span class="ident" id="4569006">n</span><span class="op" id="4569007">]</span><span class="op" id="4569008">.</span><span class="ident" id="4569009">Value</span><span class="op" id="4569014">,</span>&nbsp;<span class="ident" id="4569016">err</span>&nbsp;<span class="op" id="4569020">=</span>&nbsp;<span class="ident" id="4569022">asn1</span><span class="op" id="4569026">.</span><span class="ident" id="4569027">Marshal</span><span class="op" id="4569034">(</span><span class="ident" id="4569035">policies</span><span class="op" id="4569043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569047">if</span>&nbsp;<span class="ident" id="4569050">err</span>&nbsp;<span class="op" id="4569054">!=</span>&nbsp;<span class="builtintype" id="4569057">nil</span>&nbsp;<span class="op" id="4569061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569066">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4569075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569079">n</span><span class="op" id="4569080">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4569084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569088">if</span>&nbsp;<span class="builtinfunc" id="4569091">len</span><span class="op" id="4569094">(</span><span class="ident" id="4569095">template</span><span class="op" id="4569103">.</span><span class="ident" id="4569104">PermittedDNSDomains</span><span class="op" id="4569123">)</span>&nbsp;<span class="op" id="4569125">&gt;</span>&nbsp;<span class="num" id="4569127">0</span>&nbsp;<span class="op" id="4569129">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4569134">!</span><span class="ident" id="4569135">oidInExtensions</span><span class="op" id="4569150">(</span><span class="ident" id="4569151">oidExtensionNameConstraints</span><span class="op" id="4569178">,</span>&nbsp;<span class="ident" id="4569180">template</span><span class="op" id="4569188">.</span><span class="ident" id="4569189">ExtraExtensions</span><span class="op" id="4569204">)</span>&nbsp;<span class="op" id="4569206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569210">ret</span><span class="op" id="4569213">[</span><span class="ident" id="4569214">n</span><span class="op" id="4569215">]</span><span class="op" id="4569216">.</span><span class="ident" id="4569217">Id</span>&nbsp;<span class="op" id="4569220">=</span>&nbsp;<span class="ident" id="4569222">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569252">ret</span><span class="op" id="4569255">[</span><span class="ident" id="4569256">n</span><span class="op" id="4569257">]</span><span class="op" id="4569258">.</span><span class="ident" id="4569259">Critical</span>&nbsp;<span class="op" id="4569268">=</span>&nbsp;<span class="ident" id="4569270">template</span><span class="op" id="4569278">.</span><span class="ident" id="4569279">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569310">var</span>&nbsp;<span class="ident" id="4569314">out</span>&nbsp;<span class="ident" id="4569318">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569336">out</span><span class="op" id="4569339">.</span><span class="ident" id="4569340">Permitted</span>&nbsp;<span class="op" id="4569350">=</span>&nbsp;<span class="builtinfunc" id="4569352">make</span><span class="op" id="4569356">(</span><span class="op" id="4569357">[</span><span class="op" id="4569358">]</span><span class="ident" id="4569359">generalSubtree</span><span class="op" id="4569373">,</span>&nbsp;<span class="builtinfunc" id="4569375">len</span><span class="op" id="4569378">(</span><span class="ident" id="4569379">template</span><span class="op" id="4569387">.</span><span class="ident" id="4569388">PermittedDNSDomains</span><span class="op" id="4569407">)</span><span class="op" id="4569408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569412">for</span>&nbsp;<span class="ident" id="4569416">i</span><span class="op" id="4569417">,</span>&nbsp;<span class="ident" id="4569419">permitted</span>&nbsp;<span class="op" id="4569429">:=</span>&nbsp;<span class="keyword" id="4569432">range</span>&nbsp;<span class="ident" id="4569438">template</span><span class="op" id="4569446">.</span><span class="ident" id="4569447">PermittedDNSDomains</span>&nbsp;<span class="op" id="4569467">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569472">out</span><span class="op" id="4569475">.</span><span class="ident" id="4569476">Permitted</span><span class="op" id="4569485">[</span><span class="ident" id="4569486">i</span><span class="op" id="4569487">]</span>&nbsp;<span class="op" id="4569489">=</span>&nbsp;<span class="ident" id="4569491">generalSubtree</span><span class="op" id="4569505">{</span><span class="ident" id="4569506">Name</span><span class="op" id="4569510">:</span>&nbsp;<span class="ident" id="4569512">permitted</span><span class="op" id="4569521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4569525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569529">ret</span><span class="op" id="4569532">[</span><span class="ident" id="4569533">n</span><span class="op" id="4569534">]</span><span class="op" id="4569535">.</span><span class="ident" id="4569536">Value</span><span class="op" id="4569541">,</span>&nbsp;<span class="ident" id="4569543">err</span>&nbsp;<span class="op" id="4569547">=</span>&nbsp;<span class="ident" id="4569549">asn1</span><span class="op" id="4569553">.</span><span class="ident" id="4569554">Marshal</span><span class="op" id="4569561">(</span><span class="ident" id="4569562">out</span><span class="op" id="4569565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569569">if</span>&nbsp;<span class="ident" id="4569572">err</span>&nbsp;<span class="op" id="4569576">!=</span>&nbsp;<span class="builtintype" id="4569579">nil</span>&nbsp;<span class="op" id="4569583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569588">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4569597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569601">n</span><span class="op" id="4569602">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4569606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569610">if</span>&nbsp;<span class="builtinfunc" id="4569613">len</span><span class="op" id="4569616">(</span><span class="ident" id="4569617">template</span><span class="op" id="4569625">.</span><span class="ident" id="4569626">CRLDistributionPoints</span><span class="op" id="4569647">)</span>&nbsp;<span class="op" id="4569649">&gt;</span>&nbsp;<span class="num" id="4569651">0</span>&nbsp;<span class="op" id="4569653">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4569658">!</span><span class="ident" id="4569659">oidInExtensions</span><span class="op" id="4569674">(</span><span class="ident" id="4569675">oidExtensionCRLDistributionPoints</span><span class="op" id="4569708">,</span>&nbsp;<span class="ident" id="4569710">template</span><span class="op" id="4569718">.</span><span class="ident" id="4569719">ExtraExtensions</span><span class="op" id="4569734">)</span>&nbsp;<span class="op" id="4569736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569740">ret</span><span class="op" id="4569743">[</span><span class="ident" id="4569744">n</span><span class="op" id="4569745">]</span><span class="op" id="4569746">.</span><span class="ident" id="4569747">Id</span>&nbsp;<span class="op" id="4569750">=</span>&nbsp;<span class="ident" id="4569752">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569789">var</span>&nbsp;<span class="ident" id="4569793">crlDp</span>&nbsp;<span class="op" id="4569799">[</span><span class="op" id="4569800">]</span><span class="ident" id="4569801">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569821">for</span>&nbsp;<span class="ident" id="4569825">_</span><span class="op" id="4569826">,</span>&nbsp;<span class="ident" id="4569828">name</span>&nbsp;<span class="op" id="4569833">:=</span>&nbsp;<span class="keyword" id="4569836">range</span>&nbsp;<span class="ident" id="4569842">template</span><span class="op" id="4569850">.</span><span class="ident" id="4569851">CRLDistributionPoints</span>&nbsp;<span class="op" id="4569873">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569878">rawFullName</span><span class="op" id="4569889">,</span>&nbsp;<span class="ident" id="4569891">_</span>&nbsp;<span class="op" id="4569893">:=</span>&nbsp;<span class="ident" id="4569896">asn1</span><span class="op" id="4569900">.</span><span class="ident" id="4569901">Marshal</span><span class="op" id="4569908">(</span><span class="ident" id="4569909">asn1</span><span class="op" id="4569913">.</span><span class="ident" id="4569914">RawValue</span><span class="op" id="4569922">{</span><span class="ident" id="4569923">Tag</span><span class="op" id="4569926">:</span>&nbsp;<span class="num" id="4569928">6</span><span class="op" id="4569929">,</span>&nbsp;<span class="ident" id="4569931">Class</span><span class="op" id="4569936">:</span>&nbsp;<span class="num" id="4569938">2</span><span class="op" id="4569939">,</span>&nbsp;<span class="ident" id="4569941">Bytes</span><span class="op" id="4569946">:</span>&nbsp;<span class="op" id="4569948">[</span><span class="op" id="4569949">]</span><span class="builtintype" id="4569950">byte</span><span class="op" id="4569954">(</span><span class="ident" id="4569955">name</span><span class="op" id="4569959">)</span><span class="op" id="4569960">}</span><span class="op" id="4569961">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569967">dp</span>&nbsp;<span class="op" id="4569970">:=</span>&nbsp;<span class="ident" id="4569973">distributionPoint</span><span class="op" id="4569990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569996">DistributionPoint</span><span class="op" id="4570013">:</span>&nbsp;<span class="ident" id="4570015">distributionPointName</span><span class="op" id="4570036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570043">FullName</span><span class="op" id="4570051">:</span>&nbsp;<span class="ident" id="4570053">asn1</span><span class="op" id="4570057">.</span><span class="ident" id="4570058">RawValue</span><span class="op" id="4570066">{</span><span class="ident" id="4570067">Tag</span><span class="op" id="4570070">:</span>&nbsp;<span class="num" id="4570072">0</span><span class="op" id="4570073">,</span>&nbsp;<span class="ident" id="4570075">Class</span><span class="op" id="4570080">:</span>&nbsp;<span class="num" id="4570082">2</span><span class="op" id="4570083">,</span>&nbsp;<span class="ident" id="4570085">IsCompound</span><span class="op" id="4570095">:</span>&nbsp;<span class="builtintype" id="4570097">true</span><span class="op" id="4570101">,</span>&nbsp;<span class="ident" id="4570103">Bytes</span><span class="op" id="4570108">:</span>&nbsp;<span class="ident" id="4570110">rawFullName</span><span class="op" id="4570121">}</span><span class="op" id="4570122">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4570128">}</span><span class="op" id="4570129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4570134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570139">crlDp</span>&nbsp;<span class="op" id="4570145">=</span>&nbsp;<span class="builtinfunc" id="4570147">append</span><span class="op" id="4570153">(</span><span class="ident" id="4570154">crlDp</span><span class="op" id="4570159">,</span>&nbsp;<span class="ident" id="4570161">dp</span><span class="op" id="4570163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4570167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570172">ret</span><span class="op" id="4570175">[</span><span class="ident" id="4570176">n</span><span class="op" id="4570177">]</span><span class="op" id="4570178">.</span><span class="ident" id="4570179">Value</span><span class="op" id="4570184">,</span>&nbsp;<span class="ident" id="4570186">err</span>&nbsp;<span class="op" id="4570190">=</span>&nbsp;<span class="ident" id="4570192">asn1</span><span class="op" id="4570196">.</span><span class="ident" id="4570197">Marshal</span><span class="op" id="4570204">(</span><span class="ident" id="4570205">crlDp</span><span class="op" id="4570210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570214">if</span>&nbsp;<span class="ident" id="4570217">err</span>&nbsp;<span class="op" id="4570221">!=</span>&nbsp;<span class="builtintype" id="4570224">nil</span>&nbsp;<span class="op" id="4570228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570233">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4570242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570246">n</span><span class="op" id="4570247">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4570251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570255">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570328">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570387">return</span>&nbsp;<span class="builtinfunc" id="4570394">append</span><span class="op" id="4570400">(</span><span class="ident" id="4570401">ret</span><span class="op" id="4570404">[</span><span class="op" id="4570405">:</span><span class="ident" id="4570406">n</span><span class="op" id="4570407">]</span><span class="op" id="4570408">,</span>&nbsp;<span class="ident" id="4570410">template</span><span class="op" id="4570418">.</span><span class="ident" id="4570419">ExtraExtensions</span><span class="op" id="4570434">...</span><span class="op" id="4570437">)</span><span class="op" id="4570438">,</span>&nbsp;<span class="builtintype" id="4570440">nil</span><br>
<span class="lineno"></span><span class="op" id="4570444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4570447">func</span>&nbsp;<span class="ident" id="4570452">subjectBytes</span><span class="op" id="4570464">(</span><span class="ident" id="4570465">cert</span>&nbsp;<span class="op" id="4570470">*</span><span class="ident" id="4570471">Certificate</span><span class="op" id="4570482">)</span>&nbsp;<span class="op" id="4570484">(</span><span class="op" id="4570485">[</span><span class="op" id="4570486">]</span><span class="builtintype" id="4570487">byte</span><span class="op" id="4570491">,</span>&nbsp;<span class="builtintype" id="4570493">error</span><span class="op" id="4570498">)</span>&nbsp;<span class="op" id="4570500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570503">if</span>&nbsp;<span class="builtinfunc" id="4570506">len</span><span class="op" id="4570509">(</span><span class="ident" id="4570510">cert</span><span class="op" id="4570514">.</span><span class="ident" id="4570515">RawSubject</span><span class="op" id="4570525">)</span>&nbsp;<span class="op" id="4570527">&gt;</span>&nbsp;<span class="num" id="4570529">0</span>&nbsp;<span class="op" id="4570531">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570535">return</span>&nbsp;<span class="ident" id="4570542">cert</span><span class="op" id="4570546">.</span><span class="ident" id="4570547">RawSubject</span><span class="op" id="4570557">,</span>&nbsp;<span class="builtintype" id="4570559">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4570564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570568">return</span>&nbsp;<span class="ident" id="4570575">asn1</span><span class="op" id="4570579">.</span><span class="ident" id="4570580">Marshal</span><span class="op" id="4570587">(</span><span class="ident" id="4570588">cert</span><span class="op" id="4570592">.</span><span class="ident" id="4570593">Subject</span><span class="op" id="4570600">.</span><span class="ident" id="4570601">ToRDNSequence</span><span class="op" id="4570614">(</span><span class="op" id="4570615">)</span><span class="op" id="4570616">)</span><br>
<span class="lineno"></span><span class="op" id="4570618">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4570621">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4570698">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4570769">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4570793">func</span>&nbsp;<span class="ident" id="4570798">signingParamsForPrivateKey</span><span class="op" id="4570824">(</span><span class="ident" id="4570825">priv</span>&nbsp;<span class="keyword" id="4570830">interface</span><span class="op" id="4570839">{</span><span class="op" id="4570840">}</span><span class="op" id="4570841">,</span>&nbsp;<span class="ident" id="4570843">requestedSigAlgo</span>&nbsp;<span class="ident" id="4570860">SignatureAlgorithm</span><span class="op" id="4570878">)</span>&nbsp;<span class="op" id="4570880">(</span><span class="ident" id="4570881">hashFunc</span>&nbsp;<span class="ident" id="4570890">crypto</span><span class="op" id="4570896">.</span><span class="ident" id="4570897">Hash</span><span class="op" id="4570901">,</span>&nbsp;<span class="ident" id="4570903">sigAlgo</span>&nbsp;<span class="ident" id="4570911">pkix</span><span class="op" id="4570915">.</span><span class="ident" id="4570916">AlgorithmIdentifier</span><span class="op" id="4570935">,</span>&nbsp;<span class="ident" id="4570937">err</span>&nbsp;<span class="builtintype" id="4570941">error</span><span class="op" id="4570946">)</span>&nbsp;<span class="op" id="4570948">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570951">var</span>&nbsp;<span class="ident" id="4570955">pubType</span>&nbsp;<span class="ident" id="4570963">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570984">switch</span>&nbsp;<span class="ident" id="4570991">priv</span>&nbsp;<span class="op" id="4570996">:=</span>&nbsp;<span class="ident" id="4570999">priv</span><span class="op" id="4571003">.</span><span class="op" id="4571004">(</span><span class="keyword" id="4571005">type</span><span class="op" id="4571009">)</span>&nbsp;<span class="op" id="4571011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571014">case</span>&nbsp;<span class="op" id="4571019">*</span><span class="ident" id="4571020">rsa</span><span class="op" id="4571023">.</span><span class="ident" id="4571024">PrivateKey</span><span class="op" id="4571034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571038">pubType</span>&nbsp;<span class="op" id="4571046">=</span>&nbsp;<span class="ident" id="4571048">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571054">sigAlgo</span><span class="op" id="4571061">.</span><span class="ident" id="4571062">Algorithm</span>&nbsp;<span class="op" id="4571072">=</span>&nbsp;<span class="ident" id="4571074">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571102">hashFunc</span>&nbsp;<span class="op" id="4571111">=</span>&nbsp;<span class="ident" id="4571113">crypto</span><span class="op" id="4571119">.</span><span class="ident" id="4571120">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571129">case</span>&nbsp;<span class="op" id="4571134">*</span><span class="ident" id="4571135">ecdsa</span><span class="op" id="4571140">.</span><span class="ident" id="4571141">PrivateKey</span><span class="op" id="4571151">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571155">pubType</span>&nbsp;<span class="op" id="4571163">=</span>&nbsp;<span class="ident" id="4571165">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571174">switch</span>&nbsp;<span class="ident" id="4571181">priv</span><span class="op" id="4571185">.</span><span class="ident" id="4571186">Curve</span>&nbsp;<span class="op" id="4571192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571196">case</span>&nbsp;<span class="ident" id="4571201">elliptic</span><span class="op" id="4571209">.</span><span class="ident" id="4571210">P224</span><span class="op" id="4571214">(</span><span class="op" id="4571215">)</span><span class="op" id="4571216">,</span>&nbsp;<span class="ident" id="4571218">elliptic</span><span class="op" id="4571226">.</span><span class="ident" id="4571227">P256</span><span class="op" id="4571231">(</span><span class="op" id="4571232">)</span><span class="op" id="4571233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571238">hashFunc</span>&nbsp;<span class="op" id="4571247">=</span>&nbsp;<span class="ident" id="4571249">crypto</span><span class="op" id="4571255">.</span><span class="ident" id="4571256">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571266">sigAlgo</span><span class="op" id="4571273">.</span><span class="ident" id="4571274">Algorithm</span>&nbsp;<span class="op" id="4571284">=</span>&nbsp;<span class="ident" id="4571286">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571316">case</span>&nbsp;<span class="ident" id="4571321">elliptic</span><span class="op" id="4571329">.</span><span class="ident" id="4571330">P384</span><span class="op" id="4571334">(</span><span class="op" id="4571335">)</span><span class="op" id="4571336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571341">hashFunc</span>&nbsp;<span class="op" id="4571350">=</span>&nbsp;<span class="ident" id="4571352">crypto</span><span class="op" id="4571358">.</span><span class="ident" id="4571359">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571369">sigAlgo</span><span class="op" id="4571376">.</span><span class="ident" id="4571377">Algorithm</span>&nbsp;<span class="op" id="4571387">=</span>&nbsp;<span class="ident" id="4571389">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571419">case</span>&nbsp;<span class="ident" id="4571424">elliptic</span><span class="op" id="4571432">.</span><span class="ident" id="4571433">P521</span><span class="op" id="4571437">(</span><span class="op" id="4571438">)</span><span class="op" id="4571439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571444">hashFunc</span>&nbsp;<span class="op" id="4571453">=</span>&nbsp;<span class="ident" id="4571455">crypto</span><span class="op" id="4571461">.</span><span class="ident" id="4571462">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571472">sigAlgo</span><span class="op" id="4571479">.</span><span class="ident" id="4571480">Algorithm</span>&nbsp;<span class="op" id="4571490">=</span>&nbsp;<span class="ident" id="4571492">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571522">default</span><span class="op" id="4571529">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571534">err</span>&nbsp;<span class="op" id="4571538">=</span>&nbsp;<span class="ident" id="4571540">errors</span><span class="op" id="4571546">.</span><span class="ident" id="4571547">New</span><span class="op" id="4571550">(</span><span class="string" id="4571551">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4571581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4571585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571589">default</span><span class="op" id="4571596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571600">err</span>&nbsp;<span class="op" id="4571604">=</span>&nbsp;<span class="ident" id="4571606">errors</span><span class="op" id="4571612">.</span><span class="ident" id="4571613">New</span><span class="op" id="4571616">(</span><span class="string" id="4571617">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4571666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4571669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571673">if</span>&nbsp;<span class="ident" id="4571676">err</span>&nbsp;<span class="op" id="4571680">!=</span>&nbsp;<span class="builtintype" id="4571683">nil</span>&nbsp;<span class="op" id="4571687">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571691">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4571699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571703">if</span>&nbsp;<span class="ident" id="4571706">requestedSigAlgo</span>&nbsp;<span class="op" id="4571723">==</span>&nbsp;<span class="num" id="4571726">0</span>&nbsp;<span class="op" id="4571728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571732">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4571740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571744">found</span>&nbsp;<span class="op" id="4571750">:=</span>&nbsp;<span class="builtintype" id="4571753">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571760">for</span>&nbsp;<span class="ident" id="4571764">_</span><span class="op" id="4571765">,</span>&nbsp;<span class="ident" id="4571767">details</span>&nbsp;<span class="op" id="4571775">:=</span>&nbsp;<span class="keyword" id="4571778">range</span>&nbsp;<span class="ident" id="4571784">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4571810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571814">if</span>&nbsp;<span class="ident" id="4571817">details</span><span class="op" id="4571824">.</span><span class="ident" id="4571825">algo</span>&nbsp;<span class="op" id="4571830">==</span>&nbsp;<span class="ident" id="4571833">requestedSigAlgo</span>&nbsp;<span class="op" id="4571850">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571855">if</span>&nbsp;<span class="ident" id="4571858">details</span><span class="op" id="4571865">.</span><span class="ident" id="4571866">pubKeyAlgo</span>&nbsp;<span class="op" id="4571877">!=</span>&nbsp;<span class="ident" id="4571880">pubType</span>&nbsp;<span class="op" id="4571888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571894">err</span>&nbsp;<span class="op" id="4571898">=</span>&nbsp;<span class="ident" id="4571900">errors</span><span class="op" id="4571906">.</span><span class="ident" id="4571907">New</span><span class="op" id="4571910">(</span><span class="string" id="4571911">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4571979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571985">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4571995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572000">sigAlgo</span><span class="op" id="4572007">.</span><span class="ident" id="4572008">Algorithm</span><span class="op" id="4572017">,</span>&nbsp;<span class="ident" id="4572019">hashFunc</span>&nbsp;<span class="op" id="4572028">=</span>&nbsp;<span class="ident" id="4572030">details</span><span class="op" id="4572037">.</span><span class="ident" id="4572038">oid</span><span class="op" id="4572041">,</span>&nbsp;<span class="ident" id="4572043">details</span><span class="op" id="4572050">.</span><span class="ident" id="4572051">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572059">if</span>&nbsp;<span class="ident" id="4572062">hashFunc</span>&nbsp;<span class="op" id="4572071">==</span>&nbsp;<span class="num" id="4572074">0</span>&nbsp;<span class="op" id="4572076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572082">err</span>&nbsp;<span class="op" id="4572086">=</span>&nbsp;<span class="ident" id="4572088">errors</span><span class="op" id="4572094">.</span><span class="ident" id="4572095">New</span><span class="op" id="4572098">(</span><span class="string" id="4572099">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4572147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572153">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4572163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572168">found</span>&nbsp;<span class="op" id="4572174">=</span>&nbsp;<span class="builtintype" id="4572176">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572184">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4572192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4572195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572199">if</span>&nbsp;<span class="op" id="4572202">!</span><span class="ident" id="4572203">found</span>&nbsp;<span class="op" id="4572209">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572213">err</span>&nbsp;<span class="op" id="4572217">=</span>&nbsp;<span class="ident" id="4572219">errors</span><span class="op" id="4572225">.</span><span class="ident" id="4572226">New</span><span class="op" id="4572229">(</span><span class="string" id="4572230">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4572264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4572267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572271">return</span><br>
<span class="lineno"></span><span class="op" id="4572278">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4572281">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4572353">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4572430">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4572509">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4572583">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4572627">//</span><br>
<span class="lineno"></span><span class="comment" id="4572630">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4572710">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4572784">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4572837">//</span><br>
<span class="lineno"></span><span class="comment" id="4572840">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4572898">//</span><br>
<span class="lineno"></span><span class="comment" id="4572901">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4572970">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4573047">func</span>&nbsp;<span class="ident" id="4573052">CreateCertificate</span><span class="op" id="4573069">(</span><span class="ident" id="4573070">rand</span>&nbsp;<span class="ident" id="4573075">io</span><span class="op" id="4573077">.</span><span class="ident" id="4573078">Reader</span><span class="op" id="4573084">,</span>&nbsp;<span class="ident" id="4573086">template</span><span class="op" id="4573094">,</span>&nbsp;<span class="ident" id="4573096">parent</span>&nbsp;<span class="op" id="4573103">*</span><span class="ident" id="4573104">Certificate</span><span class="op" id="4573115">,</span>&nbsp;<span class="ident" id="4573117">pub</span>&nbsp;<span class="keyword" id="4573121">interface</span><span class="op" id="4573130">{</span><span class="op" id="4573131">}</span><span class="op" id="4573132">,</span>&nbsp;<span class="ident" id="4573134">priv</span>&nbsp;<span class="keyword" id="4573139">interface</span><span class="op" id="4573148">{</span><span class="op" id="4573149">}</span><span class="op" id="4573150">)</span>&nbsp;<span class="op" id="4573152">(</span><span class="ident" id="4573153">cert</span>&nbsp;<span class="op" id="4573158">[</span><span class="op" id="4573159">]</span><span class="builtintype" id="4573160">byte</span><span class="op" id="4573164">,</span>&nbsp;<span class="ident" id="4573166">err</span>&nbsp;<span class="builtintype" id="4573170">error</span><span class="op" id="4573175">)</span>&nbsp;<span class="op" id="4573177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573180">hashFunc</span><span class="op" id="4573188">,</span>&nbsp;<span class="ident" id="4573190">signatureAlgorithm</span><span class="op" id="4573208">,</span>&nbsp;<span class="ident" id="4573210">err</span>&nbsp;<span class="op" id="4573214">:=</span>&nbsp;<span class="ident" id="4573217">signingParamsForPrivateKey</span><span class="op" id="4573243">(</span><span class="ident" id="4573244">priv</span><span class="op" id="4573248">,</span>&nbsp;<span class="ident" id="4573250">template</span><span class="op" id="4573258">.</span><span class="ident" id="4573259">SignatureAlgorithm</span><span class="op" id="4573277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573280">if</span>&nbsp;<span class="ident" id="4573283">err</span>&nbsp;<span class="op" id="4573287">!=</span>&nbsp;<span class="builtintype" id="4573290">nil</span>&nbsp;<span class="op" id="4573294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573298">return</span>&nbsp;<span class="builtintype" id="4573305">nil</span><span class="op" id="4573308">,</span>&nbsp;<span class="ident" id="4573310">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573315">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573319">publicKeyBytes</span><span class="op" id="4573333">,</span>&nbsp;<span class="ident" id="4573335">publicKeyAlgorithm</span><span class="op" id="4573353">,</span>&nbsp;<span class="ident" id="4573355">err</span>&nbsp;<span class="op" id="4573359">:=</span>&nbsp;<span class="ident" id="4573362">marshalPublicKey</span><span class="op" id="4573378">(</span><span class="ident" id="4573379">pub</span><span class="op" id="4573382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573385">if</span>&nbsp;<span class="ident" id="4573388">err</span>&nbsp;<span class="op" id="4573392">!=</span>&nbsp;<span class="builtintype" id="4573395">nil</span>&nbsp;<span class="op" id="4573399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573403">return</span>&nbsp;<span class="builtintype" id="4573410">nil</span><span class="op" id="4573413">,</span>&nbsp;<span class="ident" id="4573415">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573420">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573424">if</span>&nbsp;<span class="ident" id="4573427">err</span>&nbsp;<span class="op" id="4573431">!=</span>&nbsp;<span class="builtintype" id="4573434">nil</span>&nbsp;<span class="op" id="4573438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573442">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573454">if</span>&nbsp;<span class="builtinfunc" id="4573457">len</span><span class="op" id="4573460">(</span><span class="ident" id="4573461">parent</span><span class="op" id="4573467">.</span><span class="ident" id="4573468">SubjectKeyId</span><span class="op" id="4573480">)</span>&nbsp;<span class="op" id="4573482">&gt;</span>&nbsp;<span class="num" id="4573484">0</span>&nbsp;<span class="op" id="4573486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573490">template</span><span class="op" id="4573498">.</span><span class="ident" id="4573499">AuthorityKeyId</span>&nbsp;<span class="op" id="4573514">=</span>&nbsp;<span class="ident" id="4573516">parent</span><span class="op" id="4573522">.</span><span class="ident" id="4573523">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573541">extensions</span><span class="op" id="4573551">,</span>&nbsp;<span class="ident" id="4573553">err</span>&nbsp;<span class="op" id="4573557">:=</span>&nbsp;<span class="ident" id="4573560">buildExtensions</span><span class="op" id="4573575">(</span><span class="ident" id="4573576">template</span><span class="op" id="4573584">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573587">if</span>&nbsp;<span class="ident" id="4573590">err</span>&nbsp;<span class="op" id="4573594">!=</span>&nbsp;<span class="builtintype" id="4573597">nil</span>&nbsp;<span class="op" id="4573601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573605">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573617">asn1Issuer</span><span class="op" id="4573627">,</span>&nbsp;<span class="ident" id="4573629">err</span>&nbsp;<span class="op" id="4573633">:=</span>&nbsp;<span class="ident" id="4573636">subjectBytes</span><span class="op" id="4573648">(</span><span class="ident" id="4573649">parent</span><span class="op" id="4573655">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573658">if</span>&nbsp;<span class="ident" id="4573661">err</span>&nbsp;<span class="op" id="4573665">!=</span>&nbsp;<span class="builtintype" id="4573668">nil</span>&nbsp;<span class="op" id="4573672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573676">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573688">asn1Subject</span><span class="op" id="4573699">,</span>&nbsp;<span class="ident" id="4573701">err</span>&nbsp;<span class="op" id="4573705">:=</span>&nbsp;<span class="ident" id="4573708">subjectBytes</span><span class="op" id="4573720">(</span><span class="ident" id="4573721">template</span><span class="op" id="4573729">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573732">if</span>&nbsp;<span class="ident" id="4573735">err</span>&nbsp;<span class="op" id="4573739">!=</span>&nbsp;<span class="builtintype" id="4573742">nil</span>&nbsp;<span class="op" id="4573746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573750">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573762">encodedPublicKey</span>&nbsp;<span class="op" id="4573779">:=</span>&nbsp;<span class="ident" id="4573782">asn1</span><span class="op" id="4573786">.</span><span class="ident" id="4573787">BitString</span><span class="op" id="4573796">{</span><span class="ident" id="4573797">BitLength</span><span class="op" id="4573806">:</span>&nbsp;<span class="builtinfunc" id="4573808">len</span><span class="op" id="4573811">(</span><span class="ident" id="4573812">publicKeyBytes</span><span class="op" id="4573826">)</span>&nbsp;<span class="op" id="4573828">*</span>&nbsp;<span class="num" id="4573830">8</span><span class="op" id="4573831">,</span>&nbsp;<span class="ident" id="4573833">Bytes</span><span class="op" id="4573838">:</span>&nbsp;<span class="ident" id="4573840">publicKeyBytes</span><span class="op" id="4573854">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573857">c</span>&nbsp;<span class="op" id="4573859">:=</span>&nbsp;<span class="ident" id="4573862">tbsCertificate</span><span class="op" id="4573876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573880">Version</span><span class="op" id="4573887">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4573900">2</span><span class="op" id="4573901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573905">SerialNumber</span><span class="op" id="4573917">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573925">template</span><span class="op" id="4573933">.</span><span class="ident" id="4573934">SerialNumber</span><span class="op" id="4573946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573950">SignatureAlgorithm</span><span class="op" id="4573968">:</span>&nbsp;<span class="ident" id="4573970">signatureAlgorithm</span><span class="op" id="4573988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573992">Issuer</span><span class="op" id="4573998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574012">asn1</span><span class="op" id="4574016">.</span><span class="ident" id="4574017">RawValue</span><span class="op" id="4574025">{</span><span class="ident" id="4574026">FullBytes</span><span class="op" id="4574035">:</span>&nbsp;<span class="ident" id="4574037">asn1Issuer</span><span class="op" id="4574047">}</span><span class="op" id="4574048">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574052">Validity</span><span class="op" id="4574060">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574072">validity</span><span class="op" id="4574080">{</span><span class="ident" id="4574081">template</span><span class="op" id="4574089">.</span><span class="ident" id="4574090">NotBefore</span><span class="op" id="4574099">.</span><span class="ident" id="4574100">UTC</span><span class="op" id="4574103">(</span><span class="op" id="4574104">)</span><span class="op" id="4574105">,</span>&nbsp;<span class="ident" id="4574107">template</span><span class="op" id="4574115">.</span><span class="ident" id="4574116">NotAfter</span><span class="op" id="4574124">.</span><span class="ident" id="4574125">UTC</span><span class="op" id="4574128">(</span><span class="op" id="4574129">)</span><span class="op" id="4574130">}</span><span class="op" id="4574131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574135">Subject</span><span class="op" id="4574142">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574155">asn1</span><span class="op" id="4574159">.</span><span class="ident" id="4574160">RawValue</span><span class="op" id="4574168">{</span><span class="ident" id="4574169">FullBytes</span><span class="op" id="4574178">:</span>&nbsp;<span class="ident" id="4574180">asn1Subject</span><span class="op" id="4574191">}</span><span class="op" id="4574192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574196">PublicKey</span><span class="op" id="4574205">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574216">publicKeyInfo</span><span class="op" id="4574229">{</span><span class="builtintype" id="4574230">nil</span><span class="op" id="4574233">,</span>&nbsp;<span class="ident" id="4574235">publicKeyAlgorithm</span><span class="op" id="4574253">,</span>&nbsp;<span class="ident" id="4574255">encodedPublicKey</span><span class="op" id="4574271">}</span><span class="op" id="4574272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574276">Extensions</span><span class="op" id="4574286">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574296">extensions</span><span class="op" id="4574306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574309">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574313">tbsCertContents</span><span class="op" id="4574328">,</span>&nbsp;<span class="ident" id="4574330">err</span>&nbsp;<span class="op" id="4574334">:=</span>&nbsp;<span class="ident" id="4574337">asn1</span><span class="op" id="4574341">.</span><span class="ident" id="4574342">Marshal</span><span class="op" id="4574349">(</span><span class="ident" id="4574350">c</span><span class="op" id="4574351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574354">if</span>&nbsp;<span class="ident" id="4574357">err</span>&nbsp;<span class="op" id="4574361">!=</span>&nbsp;<span class="builtintype" id="4574364">nil</span>&nbsp;<span class="op" id="4574368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574372">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574380">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574384">c</span><span class="op" id="4574385">.</span><span class="ident" id="4574386">Raw</span>&nbsp;<span class="op" id="4574390">=</span>&nbsp;<span class="ident" id="4574392">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574410">h</span>&nbsp;<span class="op" id="4574412">:=</span>&nbsp;<span class="ident" id="4574415">hashFunc</span><span class="op" id="4574423">.</span><span class="ident" id="4574424">New</span><span class="op" id="4574427">(</span><span class="op" id="4574428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574431">h</span><span class="op" id="4574432">.</span><span class="ident" id="4574433">Write</span><span class="op" id="4574438">(</span><span class="ident" id="4574439">tbsCertContents</span><span class="op" id="4574454">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574457">digest</span>&nbsp;<span class="op" id="4574464">:=</span>&nbsp;<span class="ident" id="4574467">h</span><span class="op" id="4574468">.</span><span class="ident" id="4574469">Sum</span><span class="op" id="4574472">(</span><span class="builtintype" id="4574473">nil</span><span class="op" id="4574476">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574480">var</span>&nbsp;<span class="ident" id="4574484">signature</span>&nbsp;<span class="op" id="4574494">[</span><span class="op" id="4574495">]</span><span class="builtintype" id="4574496">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574503">switch</span>&nbsp;<span class="ident" id="4574510">priv</span>&nbsp;<span class="op" id="4574515">:=</span>&nbsp;<span class="ident" id="4574518">priv</span><span class="op" id="4574522">.</span><span class="op" id="4574523">(</span><span class="keyword" id="4574524">type</span><span class="op" id="4574528">)</span>&nbsp;<span class="op" id="4574530">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574533">case</span>&nbsp;<span class="op" id="4574538">*</span><span class="ident" id="4574539">rsa</span><span class="op" id="4574542">.</span><span class="ident" id="4574543">PrivateKey</span><span class="op" id="4574553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574557">signature</span><span class="op" id="4574566">,</span>&nbsp;<span class="ident" id="4574568">err</span>&nbsp;<span class="op" id="4574572">=</span>&nbsp;<span class="ident" id="4574574">rsa</span><span class="op" id="4574577">.</span><span class="ident" id="4574578">SignPKCS1v15</span><span class="op" id="4574590">(</span><span class="ident" id="4574591">rand</span><span class="op" id="4574595">,</span>&nbsp;<span class="ident" id="4574597">priv</span><span class="op" id="4574601">,</span>&nbsp;<span class="ident" id="4574603">hashFunc</span><span class="op" id="4574611">,</span>&nbsp;<span class="ident" id="4574613">digest</span><span class="op" id="4574619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574622">case</span>&nbsp;<span class="op" id="4574627">*</span><span class="ident" id="4574628">ecdsa</span><span class="op" id="4574633">.</span><span class="ident" id="4574634">PrivateKey</span><span class="op" id="4574644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574648">var</span>&nbsp;<span class="ident" id="4574652">r</span><span class="op" id="4574653">,</span>&nbsp;<span class="ident" id="4574655">s</span>&nbsp;<span class="op" id="4574657">*</span><span class="ident" id="4574658">big</span><span class="op" id="4574661">.</span><span class="ident" id="4574662">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574668">if</span>&nbsp;<span class="ident" id="4574671">r</span><span class="op" id="4574672">,</span>&nbsp;<span class="ident" id="4574674">s</span><span class="op" id="4574675">,</span>&nbsp;<span class="ident" id="4574677">err</span>&nbsp;<span class="op" id="4574681">=</span>&nbsp;<span class="ident" id="4574683">ecdsa</span><span class="op" id="4574688">.</span><span class="ident" id="4574689">Sign</span><span class="op" id="4574693">(</span><span class="ident" id="4574694">rand</span><span class="op" id="4574698">,</span>&nbsp;<span class="ident" id="4574700">priv</span><span class="op" id="4574704">,</span>&nbsp;<span class="ident" id="4574706">digest</span><span class="op" id="4574712">)</span><span class="op" id="4574713">;</span>&nbsp;<span class="ident" id="4574715">err</span>&nbsp;<span class="op" id="4574719">==</span>&nbsp;<span class="builtintype" id="4574722">nil</span>&nbsp;<span class="op" id="4574726">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574731">signature</span><span class="op" id="4574740">,</span>&nbsp;<span class="ident" id="4574742">err</span>&nbsp;<span class="op" id="4574746">=</span>&nbsp;<span class="ident" id="4574748">asn1</span><span class="op" id="4574752">.</span><span class="ident" id="4574753">Marshal</span><span class="op" id="4574760">(</span><span class="ident" id="4574761">ecdsaSignature</span><span class="op" id="4574775">{</span><span class="ident" id="4574776">r</span><span class="op" id="4574777">,</span>&nbsp;<span class="ident" id="4574779">s</span><span class="op" id="4574780">}</span><span class="op" id="4574781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574788">default</span><span class="op" id="4574795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4574799">panic</span><span class="op" id="4574804">(</span><span class="string" id="4574805">&#34;internal&nbsp;error&#34;</span><span class="op" id="4574821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574824">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574828">if</span>&nbsp;<span class="ident" id="4574831">err</span>&nbsp;<span class="op" id="4574835">!=</span>&nbsp;<span class="builtintype" id="4574838">nil</span>&nbsp;<span class="op" id="4574842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574846">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574858">cert</span><span class="op" id="4574862">,</span>&nbsp;<span class="ident" id="4574864">err</span>&nbsp;<span class="op" id="4574868">=</span>&nbsp;<span class="ident" id="4574870">asn1</span><span class="op" id="4574874">.</span><span class="ident" id="4574875">Marshal</span><span class="op" id="4574882">(</span><span class="ident" id="4574883">certificate</span><span class="op" id="4574894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4574898">nil</span><span class="op" id="4574901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574905">c</span><span class="op" id="4574906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574910">signatureAlgorithm</span><span class="op" id="4574928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574932">asn1</span><span class="op" id="4574936">.</span><span class="ident" id="4574937">BitString</span><span class="op" id="4574946">{</span><span class="ident" id="4574947">Bytes</span><span class="op" id="4574952">:</span>&nbsp;<span class="ident" id="4574954">signature</span><span class="op" id="4574963">,</span>&nbsp;<span class="ident" id="4574965">BitLength</span><span class="op" id="4574974">:</span>&nbsp;<span class="builtinfunc" id="4574976">len</span><span class="op" id="4574979">(</span><span class="ident" id="4574980">signature</span><span class="op" id="4574989">)</span>&nbsp;<span class="op" id="4574991">*</span>&nbsp;<span class="num" id="4574993">8</span><span class="op" id="4574994">}</span><span class="op" id="4574995">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574998">}</span><span class="op" id="4574999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575002">return</span><br>
<span class="lineno"></span><span class="op" id="4575009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4575012">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4575090">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4575098">var</span>&nbsp;<span class="ident" id="4575102">pemCRLPrefix</span>&nbsp;<span class="op" id="4575115">=</span>&nbsp;<span class="op" id="4575117">[</span><span class="op" id="4575118">]</span><span class="builtintype" id="4575119">byte</span><span class="op" id="4575123">(</span><span class="string" id="4575124">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4575145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4575148">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4575193">var</span>&nbsp;<span class="ident" id="4575197">pemType</span>&nbsp;<span class="op" id="4575205">=</span>&nbsp;<span class="string" id="4575207">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4575219">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4575295">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4575374">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4575451">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4575463">func</span>&nbsp;<span class="ident" id="4575468">ParseCRL</span><span class="op" id="4575476">(</span><span class="ident" id="4575477">crlBytes</span>&nbsp;<span class="op" id="4575486">[</span><span class="op" id="4575487">]</span><span class="builtintype" id="4575488">byte</span><span class="op" id="4575492">)</span>&nbsp;<span class="op" id="4575494">(</span><span class="ident" id="4575495">certList</span>&nbsp;<span class="op" id="4575504">*</span><span class="ident" id="4575505">pkix</span><span class="op" id="4575509">.</span><span class="ident" id="4575510">CertificateList</span><span class="op" id="4575525">,</span>&nbsp;<span class="ident" id="4575527">err</span>&nbsp;<span class="builtintype" id="4575531">error</span><span class="op" id="4575536">)</span>&nbsp;<span class="op" id="4575538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575541">if</span>&nbsp;<span class="ident" id="4575544">bytes</span><span class="op" id="4575549">.</span><span class="ident" id="4575550">HasPrefix</span><span class="op" id="4575559">(</span><span class="ident" id="4575560">crlBytes</span><span class="op" id="4575568">,</span>&nbsp;<span class="ident" id="4575570">pemCRLPrefix</span><span class="op" id="4575582">)</span>&nbsp;<span class="op" id="4575584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575588">block</span><span class="op" id="4575593">,</span>&nbsp;<span class="ident" id="4575595">_</span>&nbsp;<span class="op" id="4575597">:=</span>&nbsp;<span class="ident" id="4575600">pem</span><span class="op" id="4575603">.</span><span class="ident" id="4575604">Decode</span><span class="op" id="4575610">(</span><span class="ident" id="4575611">crlBytes</span><span class="op" id="4575619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575623">if</span>&nbsp;<span class="ident" id="4575626">block</span>&nbsp;<span class="op" id="4575632">!=</span>&nbsp;<span class="builtintype" id="4575635">nil</span>&nbsp;<span class="op" id="4575639">&amp;&amp;</span>&nbsp;<span class="ident" id="4575642">block</span><span class="op" id="4575647">.</span><span class="ident" id="4575648">Type</span>&nbsp;<span class="op" id="4575653">==</span>&nbsp;<span class="ident" id="4575656">pemType</span>&nbsp;<span class="op" id="4575664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575669">crlBytes</span>&nbsp;<span class="op" id="4575678">=</span>&nbsp;<span class="ident" id="4575680">block</span><span class="op" id="4575685">.</span><span class="ident" id="4575686">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575700">return</span>&nbsp;<span class="ident" id="4575707">ParseDERCRL</span><span class="op" id="4575718">(</span><span class="ident" id="4575719">crlBytes</span><span class="op" id="4575727">)</span><br>
<span class="lineno"></span><span class="op" id="4575729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4575732">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4575794">func</span>&nbsp;<span class="ident" id="4575799">ParseDERCRL</span><span class="op" id="4575810">(</span><span class="ident" id="4575811">derBytes</span>&nbsp;<span class="op" id="4575820">[</span><span class="op" id="4575821">]</span><span class="builtintype" id="4575822">byte</span><span class="op" id="4575826">)</span>&nbsp;<span class="op" id="4575828">(</span><span class="ident" id="4575829">certList</span>&nbsp;<span class="op" id="4575838">*</span><span class="ident" id="4575839">pkix</span><span class="op" id="4575843">.</span><span class="ident" id="4575844">CertificateList</span><span class="op" id="4575859">,</span>&nbsp;<span class="ident" id="4575861">err</span>&nbsp;<span class="builtintype" id="4575865">error</span><span class="op" id="4575870">)</span>&nbsp;<span class="op" id="4575872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575875">certList</span>&nbsp;<span class="op" id="4575884">=</span>&nbsp;<span class="builtinfunc" id="4575886">new</span><span class="op" id="4575889">(</span><span class="ident" id="4575890">pkix</span><span class="op" id="4575894">.</span><span class="ident" id="4575895">CertificateList</span><span class="op" id="4575910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575913">_</span><span class="op" id="4575914">,</span>&nbsp;<span class="ident" id="4575916">err</span>&nbsp;<span class="op" id="4575920">=</span>&nbsp;<span class="ident" id="4575922">asn1</span><span class="op" id="4575926">.</span><span class="ident" id="4575927">Unmarshal</span><span class="op" id="4575936">(</span><span class="ident" id="4575937">derBytes</span><span class="op" id="4575945">,</span>&nbsp;<span class="ident" id="4575947">certList</span><span class="op" id="4575955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575958">if</span>&nbsp;<span class="ident" id="4575961">err</span>&nbsp;<span class="op" id="4575965">!=</span>&nbsp;<span class="builtintype" id="4575968">nil</span>&nbsp;<span class="op" id="4575972">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575976">certList</span>&nbsp;<span class="op" id="4575985">=</span>&nbsp;<span class="builtintype" id="4575987">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575995">return</span><br>
<span class="lineno"></span><span class="op" id="4576002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4576005">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4576078">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4576130">//</span><br>
<span class="lineno"></span><span class="comment" id="4576133">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4576199">func</span>&nbsp;<span class="op" id="4576204">(</span><span class="ident" id="4576205">c</span>&nbsp;<span class="op" id="4576207">*</span><span class="ident" id="4576208">Certificate</span><span class="op" id="4576219">)</span>&nbsp;<span class="ident" id="4576221">CreateCRL</span><span class="op" id="4576230">(</span><span class="ident" id="4576231">rand</span>&nbsp;<span class="ident" id="4576236">io</span><span class="op" id="4576238">.</span><span class="ident" id="4576239">Reader</span><span class="op" id="4576245">,</span>&nbsp;<span class="ident" id="4576247">priv</span>&nbsp;<span class="keyword" id="4576252">interface</span><span class="op" id="4576261">{</span><span class="op" id="4576262">}</span><span class="op" id="4576263">,</span>&nbsp;<span class="ident" id="4576265">revokedCerts</span>&nbsp;<span class="op" id="4576278">[</span><span class="op" id="4576279">]</span><span class="ident" id="4576280">pkix</span><span class="op" id="4576284">.</span><span class="ident" id="4576285">RevokedCertificate</span><span class="op" id="4576303">,</span>&nbsp;<span class="ident" id="4576305">now</span><span class="op" id="4576308">,</span>&nbsp;<span class="ident" id="4576310">expiry</span>&nbsp;<span class="ident" id="4576317">time</span><span class="op" id="4576321">.</span><span class="ident" id="4576322">Time</span><span class="op" id="4576326">)</span>&nbsp;<span class="op" id="4576328">(</span><span class="ident" id="4576329">crlBytes</span>&nbsp;<span class="op" id="4576338">[</span><span class="op" id="4576339">]</span><span class="builtintype" id="4576340">byte</span><span class="op" id="4576344">,</span>&nbsp;<span class="ident" id="4576346">err</span>&nbsp;<span class="builtintype" id="4576350">error</span><span class="op" id="4576355">)</span>&nbsp;<span class="op" id="4576357">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576360">rsaPriv</span><span class="op" id="4576367">,</span>&nbsp;<span class="ident" id="4576369">ok</span>&nbsp;<span class="op" id="4576372">:=</span>&nbsp;<span class="ident" id="4576375">priv</span><span class="op" id="4576379">.</span><span class="op" id="4576380">(</span><span class="op" id="4576381">*</span><span class="ident" id="4576382">rsa</span><span class="op" id="4576385">.</span><span class="ident" id="4576386">PrivateKey</span><span class="op" id="4576396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576399">if</span>&nbsp;<span class="op" id="4576402">!</span><span class="ident" id="4576403">ok</span>&nbsp;<span class="op" id="4576406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576410">return</span>&nbsp;<span class="builtintype" id="4576417">nil</span><span class="op" id="4576420">,</span>&nbsp;<span class="ident" id="4576422">errors</span><span class="op" id="4576428">.</span><span class="ident" id="4576429">New</span><span class="op" id="4576432">(</span><span class="string" id="4576433">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4576475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576481">tbsCertList</span>&nbsp;<span class="op" id="4576493">:=</span>&nbsp;<span class="ident" id="4576496">pkix</span><span class="op" id="4576500">.</span><span class="ident" id="4576501">TBSCertificateList</span><span class="op" id="4576519">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576523">Version</span><span class="op" id="4576530">:</span>&nbsp;<span class="num" id="4576532">2</span><span class="op" id="4576533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576537">Signature</span><span class="op" id="4576546">:</span>&nbsp;<span class="ident" id="4576548">pkix</span><span class="op" id="4576552">.</span><span class="ident" id="4576553">AlgorithmIdentifier</span><span class="op" id="4576572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576577">Algorithm</span><span class="op" id="4576586">:</span>&nbsp;<span class="ident" id="4576588">oidSignatureSHA1WithRSA</span><span class="op" id="4576611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576615">}</span><span class="op" id="4576616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576620">Issuer</span><span class="op" id="4576626">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576641">c</span><span class="op" id="4576642">.</span><span class="ident" id="4576643">Subject</span><span class="op" id="4576650">.</span><span class="ident" id="4576651">ToRDNSequence</span><span class="op" id="4576664">(</span><span class="op" id="4576665">)</span><span class="op" id="4576666">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576670">ThisUpdate</span><span class="op" id="4576680">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576691">now</span><span class="op" id="4576694">.</span><span class="ident" id="4576695">UTC</span><span class="op" id="4576698">(</span><span class="op" id="4576699">)</span><span class="op" id="4576700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576704">NextUpdate</span><span class="op" id="4576714">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576725">expiry</span><span class="op" id="4576731">.</span><span class="ident" id="4576732">UTC</span><span class="op" id="4576735">(</span><span class="op" id="4576736">)</span><span class="op" id="4576737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576741">RevokedCertificates</span><span class="op" id="4576760">:</span>&nbsp;<span class="ident" id="4576762">revokedCerts</span><span class="op" id="4576774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576781">tbsCertListContents</span><span class="op" id="4576800">,</span>&nbsp;<span class="ident" id="4576802">err</span>&nbsp;<span class="op" id="4576806">:=</span>&nbsp;<span class="ident" id="4576809">asn1</span><span class="op" id="4576813">.</span><span class="ident" id="4576814">Marshal</span><span class="op" id="4576821">(</span><span class="ident" id="4576822">tbsCertList</span><span class="op" id="4576833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576836">if</span>&nbsp;<span class="ident" id="4576839">err</span>&nbsp;<span class="op" id="4576843">!=</span>&nbsp;<span class="builtintype" id="4576846">nil</span>&nbsp;<span class="op" id="4576850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576854">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576866">h</span>&nbsp;<span class="op" id="4576868">:=</span>&nbsp;<span class="ident" id="4576871">sha1</span><span class="op" id="4576875">.</span><span class="ident" id="4576876">New</span><span class="op" id="4576879">(</span><span class="op" id="4576880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576883">h</span><span class="op" id="4576884">.</span><span class="ident" id="4576885">Write</span><span class="op" id="4576890">(</span><span class="ident" id="4576891">tbsCertListContents</span><span class="op" id="4576910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576913">digest</span>&nbsp;<span class="op" id="4576920">:=</span>&nbsp;<span class="ident" id="4576923">h</span><span class="op" id="4576924">.</span><span class="ident" id="4576925">Sum</span><span class="op" id="4576928">(</span><span class="builtintype" id="4576929">nil</span><span class="op" id="4576932">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576936">signature</span><span class="op" id="4576945">,</span>&nbsp;<span class="ident" id="4576947">err</span>&nbsp;<span class="op" id="4576951">:=</span>&nbsp;<span class="ident" id="4576954">rsa</span><span class="op" id="4576957">.</span><span class="ident" id="4576958">SignPKCS1v15</span><span class="op" id="4576970">(</span><span class="ident" id="4576971">rand</span><span class="op" id="4576975">,</span>&nbsp;<span class="ident" id="4576977">rsaPriv</span><span class="op" id="4576984">,</span>&nbsp;<span class="ident" id="4576986">crypto</span><span class="op" id="4576992">.</span><span class="ident" id="4576993">SHA1</span><span class="op" id="4576997">,</span>&nbsp;<span class="ident" id="4576999">digest</span><span class="op" id="4577005">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577008">if</span>&nbsp;<span class="ident" id="4577011">err</span>&nbsp;<span class="op" id="4577015">!=</span>&nbsp;<span class="builtintype" id="4577018">nil</span>&nbsp;<span class="op" id="4577022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577026">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577038">return</span>&nbsp;<span class="ident" id="4577045">asn1</span><span class="op" id="4577049">.</span><span class="ident" id="4577050">Marshal</span><span class="op" id="4577057">(</span><span class="ident" id="4577058">pkix</span><span class="op" id="4577062">.</span><span class="ident" id="4577063">CertificateList</span><span class="op" id="4577078">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577082">TBSCertList</span><span class="op" id="4577093">:</span>&nbsp;<span class="ident" id="4577095">tbsCertList</span><span class="op" id="4577106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577110">SignatureAlgorithm</span><span class="op" id="4577128">:</span>&nbsp;<span class="ident" id="4577130">pkix</span><span class="op" id="4577134">.</span><span class="ident" id="4577135">AlgorithmIdentifier</span><span class="op" id="4577154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577159">Algorithm</span><span class="op" id="4577168">:</span>&nbsp;<span class="ident" id="4577170">oidSignatureSHA1WithRSA</span><span class="op" id="4577193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577197">}</span><span class="op" id="4577198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577202">SignatureValue</span><span class="op" id="4577216">:</span>&nbsp;<span class="ident" id="4577218">asn1</span><span class="op" id="4577222">.</span><span class="ident" id="4577223">BitString</span><span class="op" id="4577232">{</span><span class="ident" id="4577233">Bytes</span><span class="op" id="4577238">:</span>&nbsp;<span class="ident" id="4577240">signature</span><span class="op" id="4577249">,</span>&nbsp;<span class="ident" id="4577251">BitLength</span><span class="op" id="4577260">:</span>&nbsp;<span class="builtinfunc" id="4577262">len</span><span class="op" id="4577265">(</span><span class="ident" id="4577266">signature</span><span class="op" id="4577275">)</span>&nbsp;<span class="op" id="4577277">*</span>&nbsp;<span class="num" id="4577279">8</span><span class="op" id="4577280">}</span><span class="op" id="4577281">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577284">}</span><span class="op" id="4577285">)</span><br>
<span class="lineno"></span><span class="op" id="4577287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4577290">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4577366">type</span>&nbsp;<span class="ident" id="4577371">CertificateRequest</span>&nbsp;<span class="keyword" id="4577390">struct</span>&nbsp;<span class="op" id="4577397">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577400">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577425">[</span><span class="op" id="4577426">]</span><span class="builtintype" id="4577427">byte</span>&nbsp;<span class="comment" id="4577432">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577505">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4577530">[</span><span class="op" id="4577531">]</span><span class="builtintype" id="4577532">byte</span>&nbsp;<span class="comment" id="4577537">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577597">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4577622">[</span><span class="op" id="4577623">]</span><span class="builtintype" id="4577624">byte</span>&nbsp;<span class="comment" id="4577629">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577667">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577692">[</span><span class="op" id="4577693">]</span><span class="builtintype" id="4577694">byte</span>&nbsp;<span class="comment" id="4577699">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577725">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4577744">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577749">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577768">[</span><span class="op" id="4577769">]</span><span class="builtintype" id="4577770">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577776">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4577795">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577816">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4577835">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577855">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577874">interface</span><span class="op" id="4577883">{</span><span class="op" id="4577884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577888">Subject</span>&nbsp;<span class="ident" id="4577896">pkix</span><span class="op" id="4577900">.</span><span class="ident" id="4577901">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4577908">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4577963">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578028">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578058">Attributes</span>&nbsp;<span class="op" id="4578069">[</span><span class="op" id="4578070">]</span><span class="ident" id="4578071">pkix</span><span class="op" id="4578075">.</span><span class="ident" id="4578076">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578103">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578173">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578239">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578252">Extensions</span>&nbsp;<span class="op" id="4578263">[</span><span class="op" id="4578264">]</span><span class="ident" id="4578265">pkix</span><span class="op" id="4578269">.</span><span class="ident" id="4578270">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578282">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578350">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578421">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578489">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578529">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578533">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578603">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578619">ExtraExtensions</span>&nbsp;<span class="op" id="4578635">[</span><span class="op" id="4578636">]</span><span class="ident" id="4578637">pkix</span><span class="op" id="4578641">.</span><span class="ident" id="4578642">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578654">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578689">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578704">[</span><span class="op" id="4578705">]</span><span class="builtintype" id="4578706">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578714">EmailAddresses</span>&nbsp;<span class="op" id="4578729">[</span><span class="op" id="4578730">]</span><span class="builtintype" id="4578731">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578739">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578754">[</span><span class="op" id="4578755">]</span><span class="ident" id="4578756">net</span><span class="op" id="4578759">.</span><span class="ident" id="4578760">IP</span><br>
<span class="lineno"></span><span class="op" id="4578763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4578766">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4578835">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4578874">type</span>&nbsp;<span class="ident" id="4578879">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4578901">struct</span>&nbsp;<span class="op" id="4578908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578911">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578922">asn1</span><span class="op" id="4578926">.</span><span class="ident" id="4578927">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578939">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4578950">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578955">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578966">asn1</span><span class="op" id="4578970">.</span><span class="ident" id="4578971">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578981">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4578992">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579007">Attributes</span>&nbsp;<span class="op" id="4579018">[</span><span class="op" id="4579019">]</span><span class="ident" id="4579020">pkix</span><span class="op" id="4579024">.</span><span class="ident" id="4579025">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4579050">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4579065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4579068">type</span>&nbsp;<span class="ident" id="4579073">certificateRequest</span>&nbsp;<span class="keyword" id="4579092">struct</span>&nbsp;<span class="op" id="4579099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579102">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579121">asn1</span><span class="op" id="4579125">.</span><span class="ident" id="4579126">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579138">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579157">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579180">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4579199">pkix</span><span class="op" id="4579203">.</span><span class="ident" id="4579204">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579225">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579244">asn1</span><span class="op" id="4579248">.</span><span class="ident" id="4579249">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4579259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4579262">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4579340">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4579364">var</span>&nbsp;<span class="ident" id="4579368">oidExtensionRequest</span>&nbsp;<span class="op" id="4579388">=</span>&nbsp;<span class="ident" id="4579390">asn1</span><span class="op" id="4579394">.</span><span class="ident" id="4579395">ObjectIdentifier</span><span class="op" id="4579411">{</span><span class="num" id="4579412">1</span><span class="op" id="4579413">,</span>&nbsp;<span class="num" id="4579415">2</span><span class="op" id="4579416">,</span>&nbsp;<span class="num" id="4579418">840</span><span class="op" id="4579421">,</span>&nbsp;<span class="num" id="4579423">113549</span><span class="op" id="4579429">,</span>&nbsp;<span class="num" id="4579431">1</span><span class="op" id="4579432">,</span>&nbsp;<span class="num" id="4579434">9</span><span class="op" id="4579435">,</span>&nbsp;<span class="num" id="4579437">14</span><span class="op" id="4579439">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4579442">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4579521">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4579585">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4579663">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4579716">//</span><br>
<span class="lineno"></span><span class="comment" id="4579719">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4579785">//</span><br>
<span class="lineno"></span><span class="comment" id="4579788">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4579856">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4579880">func</span>&nbsp;<span class="ident" id="4579885">CreateCertificateRequest</span><span class="op" id="4579909">(</span><span class="ident" id="4579910">rand</span>&nbsp;<span class="ident" id="4579915">io</span><span class="op" id="4579917">.</span><span class="ident" id="4579918">Reader</span><span class="op" id="4579924">,</span>&nbsp;<span class="ident" id="4579926">template</span>&nbsp;<span class="op" id="4579935">*</span><span class="ident" id="4579936">CertificateRequest</span><span class="op" id="4579954">,</span>&nbsp;<span class="ident" id="4579956">priv</span>&nbsp;<span class="keyword" id="4579961">interface</span><span class="op" id="4579970">{</span><span class="op" id="4579971">}</span><span class="op" id="4579972">)</span>&nbsp;<span class="op" id="4579974">(</span><span class="ident" id="4579975">csr</span>&nbsp;<span class="op" id="4579979">[</span><span class="op" id="4579980">]</span><span class="builtintype" id="4579981">byte</span><span class="op" id="4579985">,</span>&nbsp;<span class="ident" id="4579987">err</span>&nbsp;<span class="builtintype" id="4579991">error</span><span class="op" id="4579996">)</span>&nbsp;<span class="op" id="4579998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580001">hashFunc</span><span class="op" id="4580009">,</span>&nbsp;<span class="ident" id="4580011">sigAlgo</span><span class="op" id="4580018">,</span>&nbsp;<span class="ident" id="4580020">err</span>&nbsp;<span class="op" id="4580024">:=</span>&nbsp;<span class="ident" id="4580027">signingParamsForPrivateKey</span><span class="op" id="4580053">(</span><span class="ident" id="4580054">priv</span><span class="op" id="4580058">,</span>&nbsp;<span class="ident" id="4580060">template</span><span class="op" id="4580068">.</span><span class="ident" id="4580069">SignatureAlgorithm</span><span class="op" id="4580087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580090">if</span>&nbsp;<span class="ident" id="4580093">err</span>&nbsp;<span class="op" id="4580097">!=</span>&nbsp;<span class="builtintype" id="4580100">nil</span>&nbsp;<span class="op" id="4580104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580108">return</span>&nbsp;<span class="builtintype" id="4580115">nil</span><span class="op" id="4580118">,</span>&nbsp;<span class="ident" id="4580120">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580125">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580129">var</span>&nbsp;<span class="ident" id="4580133">publicKeyBytes</span>&nbsp;<span class="op" id="4580148">[</span><span class="op" id="4580149">]</span><span class="builtintype" id="4580150">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580156">var</span>&nbsp;<span class="ident" id="4580160">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4580179">pkix</span><span class="op" id="4580183">.</span><span class="ident" id="4580184">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580206">switch</span>&nbsp;<span class="ident" id="4580213">priv</span>&nbsp;<span class="op" id="4580218">:=</span>&nbsp;<span class="ident" id="4580221">priv</span><span class="op" id="4580225">.</span><span class="op" id="4580226">(</span><span class="keyword" id="4580227">type</span><span class="op" id="4580231">)</span>&nbsp;<span class="op" id="4580233">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580236">case</span>&nbsp;<span class="op" id="4580241">*</span><span class="ident" id="4580242">rsa</span><span class="op" id="4580245">.</span><span class="ident" id="4580246">PrivateKey</span><span class="op" id="4580256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580260">publicKeyBytes</span><span class="op" id="4580274">,</span>&nbsp;<span class="ident" id="4580276">publicKeyAlgorithm</span><span class="op" id="4580294">,</span>&nbsp;<span class="ident" id="4580296">err</span>&nbsp;<span class="op" id="4580300">=</span>&nbsp;<span class="ident" id="4580302">marshalPublicKey</span><span class="op" id="4580318">(</span><span class="op" id="4580319">&amp;</span><span class="ident" id="4580320">priv</span><span class="op" id="4580324">.</span><span class="ident" id="4580325">PublicKey</span><span class="op" id="4580334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580337">case</span>&nbsp;<span class="op" id="4580342">*</span><span class="ident" id="4580343">ecdsa</span><span class="op" id="4580348">.</span><span class="ident" id="4580349">PrivateKey</span><span class="op" id="4580359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580363">publicKeyBytes</span><span class="op" id="4580377">,</span>&nbsp;<span class="ident" id="4580379">publicKeyAlgorithm</span><span class="op" id="4580397">,</span>&nbsp;<span class="ident" id="4580399">err</span>&nbsp;<span class="op" id="4580403">=</span>&nbsp;<span class="ident" id="4580405">marshalPublicKey</span><span class="op" id="4580421">(</span><span class="op" id="4580422">&amp;</span><span class="ident" id="4580423">priv</span><span class="op" id="4580427">.</span><span class="ident" id="4580428">PublicKey</span><span class="op" id="4580437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580440">default</span><span class="op" id="4580447">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4580451">panic</span><span class="op" id="4580456">(</span><span class="string" id="4580457">&#34;internal&nbsp;error&#34;</span><span class="op" id="4580473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580480">if</span>&nbsp;<span class="ident" id="4580483">err</span>&nbsp;<span class="op" id="4580487">!=</span>&nbsp;<span class="builtintype" id="4580490">nil</span>&nbsp;<span class="op" id="4580494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580498">return</span>&nbsp;<span class="builtintype" id="4580505">nil</span><span class="op" id="4580508">,</span>&nbsp;<span class="ident" id="4580510">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580519">var</span>&nbsp;<span class="ident" id="4580523">extensions</span>&nbsp;<span class="op" id="4580534">[</span><span class="op" id="4580535">]</span><span class="ident" id="4580536">pkix</span><span class="op" id="4580540">.</span><span class="ident" id="4580541">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580553">if</span>&nbsp;<span class="op" id="4580556">(</span><span class="builtinfunc" id="4580557">len</span><span class="op" id="4580560">(</span><span class="ident" id="4580561">template</span><span class="op" id="4580569">.</span><span class="ident" id="4580570">DNSNames</span><span class="op" id="4580578">)</span>&nbsp;<span class="op" id="4580580">&gt;</span>&nbsp;<span class="num" id="4580582">0</span>&nbsp;<span class="op" id="4580584">||</span>&nbsp;<span class="builtinfunc" id="4580587">len</span><span class="op" id="4580590">(</span><span class="ident" id="4580591">template</span><span class="op" id="4580599">.</span><span class="ident" id="4580600">EmailAddresses</span><span class="op" id="4580614">)</span>&nbsp;<span class="op" id="4580616">&gt;</span>&nbsp;<span class="num" id="4580618">0</span>&nbsp;<span class="op" id="4580620">||</span>&nbsp;<span class="builtinfunc" id="4580623">len</span><span class="op" id="4580626">(</span><span class="ident" id="4580627">template</span><span class="op" id="4580635">.</span><span class="ident" id="4580636">IPAddresses</span><span class="op" id="4580647">)</span>&nbsp;<span class="op" id="4580649">&gt;</span>&nbsp;<span class="num" id="4580651">0</span><span class="op" id="4580652">)</span>&nbsp;<span class="op" id="4580654">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580659">!</span><span class="ident" id="4580660">oidInExtensions</span><span class="op" id="4580675">(</span><span class="ident" id="4580676">oidExtensionSubjectAltName</span><span class="op" id="4580702">,</span>&nbsp;<span class="ident" id="4580704">template</span><span class="op" id="4580712">.</span><span class="ident" id="4580713">ExtraExtensions</span><span class="op" id="4580728">)</span>&nbsp;<span class="op" id="4580730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580734">sanBytes</span><span class="op" id="4580742">,</span>&nbsp;<span class="ident" id="4580744">err</span>&nbsp;<span class="op" id="4580748">:=</span>&nbsp;<span class="ident" id="4580751">marshalSANs</span><span class="op" id="4580762">(</span><span class="ident" id="4580763">template</span><span class="op" id="4580771">.</span><span class="ident" id="4580772">DNSNames</span><span class="op" id="4580780">,</span>&nbsp;<span class="ident" id="4580782">template</span><span class="op" id="4580790">.</span><span class="ident" id="4580791">EmailAddresses</span><span class="op" id="4580805">,</span>&nbsp;<span class="ident" id="4580807">template</span><span class="op" id="4580815">.</span><span class="ident" id="4580816">IPAddresses</span><span class="op" id="4580827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580831">if</span>&nbsp;<span class="ident" id="4580834">err</span>&nbsp;<span class="op" id="4580838">!=</span>&nbsp;<span class="builtintype" id="4580841">nil</span>&nbsp;<span class="op" id="4580845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580850">return</span>&nbsp;<span class="builtintype" id="4580857">nil</span><span class="op" id="4580860">,</span>&nbsp;<span class="ident" id="4580862">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580868">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580873">extensions</span>&nbsp;<span class="op" id="4580884">=</span>&nbsp;<span class="builtinfunc" id="4580886">append</span><span class="op" id="4580892">(</span><span class="ident" id="4580893">extensions</span><span class="op" id="4580903">,</span>&nbsp;<span class="ident" id="4580905">pkix</span><span class="op" id="4580909">.</span><span class="ident" id="4580910">Extension</span><span class="op" id="4580919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580924">Id</span><span class="op" id="4580926">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580931">oidExtensionSubjectAltName</span><span class="op" id="4580957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580962">Value</span><span class="op" id="4580967">:</span>&nbsp;<span class="ident" id="4580969">sanBytes</span><span class="op" id="4580977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580981">}</span><span class="op" id="4580982">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580989">extensions</span>&nbsp;<span class="op" id="4581000">=</span>&nbsp;<span class="builtinfunc" id="4581002">append</span><span class="op" id="4581008">(</span><span class="ident" id="4581009">extensions</span><span class="op" id="4581019">,</span>&nbsp;<span class="ident" id="4581021">template</span><span class="op" id="4581029">.</span><span class="ident" id="4581030">ExtraExtensions</span><span class="op" id="4581045">...</span><span class="op" id="4581048">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581052">var</span>&nbsp;<span class="ident" id="4581056">attributes</span>&nbsp;<span class="op" id="4581067">[</span><span class="op" id="4581068">]</span><span class="ident" id="4581069">pkix</span><span class="op" id="4581073">.</span><span class="ident" id="4581074">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581100">attributes</span>&nbsp;<span class="op" id="4581111">=</span>&nbsp;<span class="builtinfunc" id="4581113">append</span><span class="op" id="4581119">(</span><span class="ident" id="4581120">attributes</span><span class="op" id="4581130">,</span>&nbsp;<span class="ident" id="4581132">template</span><span class="op" id="4581140">.</span><span class="ident" id="4581141">Attributes</span><span class="op" id="4581151">...</span><span class="op" id="4581154">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581158">if</span>&nbsp;<span class="builtinfunc" id="4581161">len</span><span class="op" id="4581164">(</span><span class="ident" id="4581165">extensions</span><span class="op" id="4581175">)</span>&nbsp;<span class="op" id="4581177">&gt;</span>&nbsp;<span class="num" id="4581179">0</span>&nbsp;<span class="op" id="4581181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4581185">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4581246">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581292">specifiedExtensions</span>&nbsp;<span class="op" id="4581312">:=</span>&nbsp;<span class="builtinfunc" id="4581315">make</span><span class="op" id="4581319">(</span><span class="keyword" id="4581320">map</span><span class="op" id="4581323">[</span><span class="builtintype" id="4581324">string</span><span class="op" id="4581330">]</span><span class="builtintype" id="4581331">bool</span><span class="op" id="4581335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581340">for</span>&nbsp;<span class="ident" id="4581344">_</span><span class="op" id="4581345">,</span>&nbsp;<span class="ident" id="4581347">atvSet</span>&nbsp;<span class="op" id="4581354">:=</span>&nbsp;<span class="keyword" id="4581357">range</span>&nbsp;<span class="ident" id="4581363">template</span><span class="op" id="4581371">.</span><span class="ident" id="4581372">Attributes</span>&nbsp;<span class="op" id="4581383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581388">if</span>&nbsp;<span class="op" id="4581391">!</span><span class="ident" id="4581392">atvSet</span><span class="op" id="4581398">.</span><span class="ident" id="4581399">Type</span><span class="op" id="4581403">.</span><span class="ident" id="4581404">Equal</span><span class="op" id="4581409">(</span><span class="ident" id="4581410">oidExtensionRequest</span><span class="op" id="4581429">)</span>&nbsp;<span class="op" id="4581431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581437">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581455">for</span>&nbsp;<span class="ident" id="4581459">_</span><span class="op" id="4581460">,</span>&nbsp;<span class="ident" id="4581462">atvs</span>&nbsp;<span class="op" id="4581467">:=</span>&nbsp;<span class="keyword" id="4581470">range</span>&nbsp;<span class="ident" id="4581476">atvSet</span><span class="op" id="4581482">.</span><span class="ident" id="4581483">Value</span>&nbsp;<span class="op" id="4581489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581495">for</span>&nbsp;<span class="ident" id="4581499">_</span><span class="op" id="4581500">,</span>&nbsp;<span class="ident" id="4581502">atv</span>&nbsp;<span class="op" id="4581506">:=</span>&nbsp;<span class="keyword" id="4581509">range</span>&nbsp;<span class="ident" id="4581515">atvs</span>&nbsp;<span class="op" id="4581520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581527">specifiedExtensions</span><span class="op" id="4581546">[</span><span class="ident" id="4581547">atv</span><span class="op" id="4581550">.</span><span class="ident" id="4581551">Type</span><span class="op" id="4581555">.</span><span class="ident" id="4581556">String</span><span class="op" id="4581562">(</span><span class="op" id="4581563">)</span><span class="op" id="4581564">]</span>&nbsp;<span class="op" id="4581566">=</span>&nbsp;<span class="builtintype" id="4581568">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581591">atvs</span>&nbsp;<span class="op" id="4581596">:=</span>&nbsp;<span class="builtinfunc" id="4581599">make</span><span class="op" id="4581603">(</span><span class="op" id="4581604">[</span><span class="op" id="4581605">]</span><span class="ident" id="4581606">pkix</span><span class="op" id="4581610">.</span><span class="ident" id="4581611">AttributeTypeAndValue</span><span class="op" id="4581632">,</span>&nbsp;<span class="num" id="4581634">0</span><span class="op" id="4581635">,</span>&nbsp;<span class="builtinfunc" id="4581637">len</span><span class="op" id="4581640">(</span><span class="ident" id="4581641">extensions</span><span class="op" id="4581651">)</span><span class="op" id="4581652">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581656">for</span>&nbsp;<span class="ident" id="4581660">_</span><span class="op" id="4581661">,</span>&nbsp;<span class="ident" id="4581663">e</span>&nbsp;<span class="op" id="4581665">:=</span>&nbsp;<span class="keyword" id="4581668">range</span>&nbsp;<span class="ident" id="4581674">extensions</span>&nbsp;<span class="op" id="4581685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581690">if</span>&nbsp;<span class="ident" id="4581693">specifiedExtensions</span><span class="op" id="4581712">[</span><span class="ident" id="4581713">e</span><span class="op" id="4581714">.</span><span class="ident" id="4581715">Id</span><span class="op" id="4581717">.</span><span class="ident" id="4581718">String</span><span class="op" id="4581724">(</span><span class="op" id="4581725">)</span><span class="op" id="4581726">]</span>&nbsp;<span class="op" id="4581728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4581734">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4581782">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581827">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581845">atvs</span>&nbsp;<span class="op" id="4581850">=</span>&nbsp;<span class="builtinfunc" id="4581852">append</span><span class="op" id="4581858">(</span><span class="ident" id="4581859">atvs</span><span class="op" id="4581863">,</span>&nbsp;<span class="ident" id="4581865">pkix</span><span class="op" id="4581869">.</span><span class="ident" id="4581870">AttributeTypeAndValue</span><span class="op" id="4581891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4581897">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581954">Type</span><span class="op" id="4581958">:</span>&nbsp;&nbsp;<span class="ident" id="4581961">e</span><span class="op" id="4581962">.</span><span class="ident" id="4581963">Id</span><span class="op" id="4581965">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581971">Value</span><span class="op" id="4581976">:</span>&nbsp;<span class="ident" id="4581978">e</span><span class="op" id="4581979">.</span><span class="ident" id="4581980">Value</span><span class="op" id="4581985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581990">}</span><span class="op" id="4581991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4582000">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582065">appended</span>&nbsp;<span class="op" id="4582074">:=</span>&nbsp;<span class="builtintype" id="4582077">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582085">for</span>&nbsp;<span class="ident" id="4582089">_</span><span class="op" id="4582090">,</span>&nbsp;<span class="ident" id="4582092">atvSet</span>&nbsp;<span class="op" id="4582099">:=</span>&nbsp;<span class="keyword" id="4582102">range</span>&nbsp;<span class="ident" id="4582108">attributes</span>&nbsp;<span class="op" id="4582119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582124">if</span>&nbsp;<span class="op" id="4582127">!</span><span class="ident" id="4582128">atvSet</span><span class="op" id="4582134">.</span><span class="ident" id="4582135">Type</span><span class="op" id="4582139">.</span><span class="ident" id="4582140">Equal</span><span class="op" id="4582145">(</span><span class="ident" id="4582146">oidExtensionRequest</span><span class="op" id="4582165">)</span>&nbsp;<span class="op" id="4582167">||</span>&nbsp;<span class="builtinfunc" id="4582170">len</span><span class="op" id="4582173">(</span><span class="ident" id="4582174">atvSet</span><span class="op" id="4582180">.</span><span class="ident" id="4582181">Value</span><span class="op" id="4582186">)</span>&nbsp;<span class="op" id="4582188">==</span>&nbsp;<span class="num" id="4582191">0</span>&nbsp;<span class="op" id="4582193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582199">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582211">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582217">atvSet</span><span class="op" id="4582223">.</span><span class="ident" id="4582224">Value</span><span class="op" id="4582229">[</span><span class="num" id="4582230">0</span><span class="op" id="4582231">]</span>&nbsp;<span class="op" id="4582233">=</span>&nbsp;<span class="builtinfunc" id="4582235">append</span><span class="op" id="4582241">(</span><span class="ident" id="4582242">atvSet</span><span class="op" id="4582248">.</span><span class="ident" id="4582249">Value</span><span class="op" id="4582254">[</span><span class="num" id="4582255">0</span><span class="op" id="4582256">]</span><span class="op" id="4582257">,</span>&nbsp;<span class="ident" id="4582259">atvs</span><span class="op" id="4582263">...</span><span class="op" id="4582266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582271">appended</span>&nbsp;<span class="op" id="4582280">=</span>&nbsp;<span class="builtintype" id="4582282">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582290">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582298">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4582303">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582359">if</span>&nbsp;<span class="op" id="4582362">!</span><span class="ident" id="4582363">appended</span>&nbsp;<span class="op" id="4582372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582377">attributes</span>&nbsp;<span class="op" id="4582388">=</span>&nbsp;<span class="builtinfunc" id="4582390">append</span><span class="op" id="4582396">(</span><span class="ident" id="4582397">attributes</span><span class="op" id="4582407">,</span>&nbsp;<span class="ident" id="4582409">pkix</span><span class="op" id="4582413">.</span><span class="ident" id="4582414">AttributeTypeAndValueSET</span><span class="op" id="4582438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582444">Type</span><span class="op" id="4582448">:</span>&nbsp;<span class="ident" id="4582450">oidExtensionRequest</span><span class="op" id="4582469">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582475">Value</span><span class="op" id="4582480">:</span>&nbsp;<span class="op" id="4582482">[</span><span class="op" id="4582483">]</span><span class="op" id="4582484">[</span><span class="op" id="4582485">]</span><span class="ident" id="4582486">pkix</span><span class="op" id="4582490">.</span><span class="ident" id="4582491">AttributeTypeAndValue</span><span class="op" id="4582512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582519">atvs</span><span class="op" id="4582523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582529">}</span><span class="op" id="4582530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582535">}</span><span class="op" id="4582536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582540">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582547">asn1Subject</span>&nbsp;<span class="op" id="4582559">:=</span>&nbsp;<span class="ident" id="4582562">template</span><span class="op" id="4582570">.</span><span class="ident" id="4582571">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582583">if</span>&nbsp;<span class="builtinfunc" id="4582586">len</span><span class="op" id="4582589">(</span><span class="ident" id="4582590">asn1Subject</span><span class="op" id="4582601">)</span>&nbsp;<span class="op" id="4582603">==</span>&nbsp;<span class="num" id="4582606">0</span>&nbsp;<span class="op" id="4582608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582612">asn1Subject</span><span class="op" id="4582623">,</span>&nbsp;<span class="ident" id="4582625">err</span>&nbsp;<span class="op" id="4582629">=</span>&nbsp;<span class="ident" id="4582631">asn1</span><span class="op" id="4582635">.</span><span class="ident" id="4582636">Marshal</span><span class="op" id="4582643">(</span><span class="ident" id="4582644">template</span><span class="op" id="4582652">.</span><span class="ident" id="4582653">Subject</span><span class="op" id="4582660">.</span><span class="ident" id="4582661">ToRDNSequence</span><span class="op" id="4582674">(</span><span class="op" id="4582675">)</span><span class="op" id="4582676">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582680">if</span>&nbsp;<span class="ident" id="4582683">err</span>&nbsp;<span class="op" id="4582687">!=</span>&nbsp;<span class="builtintype" id="4582690">nil</span>&nbsp;<span class="op" id="4582694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582699">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582715">tbsCSR</span>&nbsp;<span class="op" id="4582722">:=</span>&nbsp;<span class="ident" id="4582725">tbsCertificateRequest</span><span class="op" id="4582746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582750">Version</span><span class="op" id="4582757">:</span>&nbsp;<span class="num" id="4582759">0</span><span class="op" id="4582760">,</span>&nbsp;<span class="comment" id="4582762">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582786">Subject</span><span class="op" id="4582793">:</span>&nbsp;<span class="ident" id="4582795">asn1</span><span class="op" id="4582799">.</span><span class="ident" id="4582800">RawValue</span><span class="op" id="4582808">{</span><span class="ident" id="4582809">FullBytes</span><span class="op" id="4582818">:</span>&nbsp;<span class="ident" id="4582820">asn1Subject</span><span class="op" id="4582831">}</span><span class="op" id="4582832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582836">PublicKey</span><span class="op" id="4582845">:</span>&nbsp;<span class="ident" id="4582847">publicKeyInfo</span><span class="op" id="4582860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582865">Algorithm</span><span class="op" id="4582874">:</span>&nbsp;<span class="ident" id="4582876">publicKeyAlgorithm</span><span class="op" id="4582894">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582899">PublicKey</span><span class="op" id="4582908">:</span>&nbsp;<span class="ident" id="4582910">asn1</span><span class="op" id="4582914">.</span><span class="ident" id="4582915">BitString</span><span class="op" id="4582924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582930">Bytes</span><span class="op" id="4582935">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582941">publicKeyBytes</span><span class="op" id="4582955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582961">BitLength</span><span class="op" id="4582970">:</span>&nbsp;<span class="builtinfunc" id="4582972">len</span><span class="op" id="4582975">(</span><span class="ident" id="4582976">publicKeyBytes</span><span class="op" id="4582990">)</span>&nbsp;<span class="op" id="4582992">*</span>&nbsp;<span class="num" id="4582994">8</span><span class="op" id="4582995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583000">}</span><span class="op" id="4583001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583005">}</span><span class="op" id="4583006">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583010">Attributes</span><span class="op" id="4583020">:</span>&nbsp;<span class="ident" id="4583022">attributes</span><span class="op" id="4583032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583039">tbsCSRContents</span><span class="op" id="4583053">,</span>&nbsp;<span class="ident" id="4583055">err</span>&nbsp;<span class="op" id="4583059">:=</span>&nbsp;<span class="ident" id="4583062">asn1</span><span class="op" id="4583066">.</span><span class="ident" id="4583067">Marshal</span><span class="op" id="4583074">(</span><span class="ident" id="4583075">tbsCSR</span><span class="op" id="4583081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583084">if</span>&nbsp;<span class="ident" id="4583087">err</span>&nbsp;<span class="op" id="4583091">!=</span>&nbsp;<span class="builtintype" id="4583094">nil</span>&nbsp;<span class="op" id="4583098">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583102">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583113">tbsCSR</span><span class="op" id="4583119">.</span><span class="ident" id="4583120">Raw</span>&nbsp;<span class="op" id="4583124">=</span>&nbsp;<span class="ident" id="4583126">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583143">h</span>&nbsp;<span class="op" id="4583145">:=</span>&nbsp;<span class="ident" id="4583148">hashFunc</span><span class="op" id="4583156">.</span><span class="ident" id="4583157">New</span><span class="op" id="4583160">(</span><span class="op" id="4583161">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583164">h</span><span class="op" id="4583165">.</span><span class="ident" id="4583166">Write</span><span class="op" id="4583171">(</span><span class="ident" id="4583172">tbsCSRContents</span><span class="op" id="4583186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583189">digest</span>&nbsp;<span class="op" id="4583196">:=</span>&nbsp;<span class="ident" id="4583199">h</span><span class="op" id="4583200">.</span><span class="ident" id="4583201">Sum</span><span class="op" id="4583204">(</span><span class="builtintype" id="4583205">nil</span><span class="op" id="4583208">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583212">var</span>&nbsp;<span class="ident" id="4583216">signature</span>&nbsp;<span class="op" id="4583226">[</span><span class="op" id="4583227">]</span><span class="builtintype" id="4583228">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583234">switch</span>&nbsp;<span class="ident" id="4583241">priv</span>&nbsp;<span class="op" id="4583246">:=</span>&nbsp;<span class="ident" id="4583249">priv</span><span class="op" id="4583253">.</span><span class="op" id="4583254">(</span><span class="keyword" id="4583255">type</span><span class="op" id="4583259">)</span>&nbsp;<span class="op" id="4583261">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583264">case</span>&nbsp;<span class="op" id="4583269">*</span><span class="ident" id="4583270">rsa</span><span class="op" id="4583273">.</span><span class="ident" id="4583274">PrivateKey</span><span class="op" id="4583284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583288">signature</span><span class="op" id="4583297">,</span>&nbsp;<span class="ident" id="4583299">err</span>&nbsp;<span class="op" id="4583303">=</span>&nbsp;<span class="ident" id="4583305">rsa</span><span class="op" id="4583308">.</span><span class="ident" id="4583309">SignPKCS1v15</span><span class="op" id="4583321">(</span><span class="ident" id="4583322">rand</span><span class="op" id="4583326">,</span>&nbsp;<span class="ident" id="4583328">priv</span><span class="op" id="4583332">,</span>&nbsp;<span class="ident" id="4583334">hashFunc</span><span class="op" id="4583342">,</span>&nbsp;<span class="ident" id="4583344">digest</span><span class="op" id="4583350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583353">case</span>&nbsp;<span class="op" id="4583358">*</span><span class="ident" id="4583359">ecdsa</span><span class="op" id="4583364">.</span><span class="ident" id="4583365">PrivateKey</span><span class="op" id="4583375">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583379">var</span>&nbsp;<span class="ident" id="4583383">r</span><span class="op" id="4583384">,</span>&nbsp;<span class="ident" id="4583386">s</span>&nbsp;<span class="op" id="4583388">*</span><span class="ident" id="4583389">big</span><span class="op" id="4583392">.</span><span class="ident" id="4583393">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583399">if</span>&nbsp;<span class="ident" id="4583402">r</span><span class="op" id="4583403">,</span>&nbsp;<span class="ident" id="4583405">s</span><span class="op" id="4583406">,</span>&nbsp;<span class="ident" id="4583408">err</span>&nbsp;<span class="op" id="4583412">=</span>&nbsp;<span class="ident" id="4583414">ecdsa</span><span class="op" id="4583419">.</span><span class="ident" id="4583420">Sign</span><span class="op" id="4583424">(</span><span class="ident" id="4583425">rand</span><span class="op" id="4583429">,</span>&nbsp;<span class="ident" id="4583431">priv</span><span class="op" id="4583435">,</span>&nbsp;<span class="ident" id="4583437">digest</span><span class="op" id="4583443">)</span><span class="op" id="4583444">;</span>&nbsp;<span class="ident" id="4583446">err</span>&nbsp;<span class="op" id="4583450">==</span>&nbsp;<span class="builtintype" id="4583453">nil</span>&nbsp;<span class="op" id="4583457">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583462">signature</span><span class="op" id="4583471">,</span>&nbsp;<span class="ident" id="4583473">err</span>&nbsp;<span class="op" id="4583477">=</span>&nbsp;<span class="ident" id="4583479">asn1</span><span class="op" id="4583483">.</span><span class="ident" id="4583484">Marshal</span><span class="op" id="4583491">(</span><span class="ident" id="4583492">ecdsaSignature</span><span class="op" id="4583506">{</span><span class="ident" id="4583507">r</span><span class="op" id="4583508">,</span>&nbsp;<span class="ident" id="4583510">s</span><span class="op" id="4583511">}</span><span class="op" id="4583512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583519">default</span><span class="op" id="4583526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4583530">panic</span><span class="op" id="4583535">(</span><span class="string" id="4583536">&#34;internal&nbsp;error&#34;</span><span class="op" id="4583552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583555">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583559">if</span>&nbsp;<span class="ident" id="4583562">err</span>&nbsp;<span class="op" id="4583566">!=</span>&nbsp;<span class="builtintype" id="4583569">nil</span>&nbsp;<span class="op" id="4583573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583577">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583589">return</span>&nbsp;<span class="ident" id="4583596">asn1</span><span class="op" id="4583600">.</span><span class="ident" id="4583601">Marshal</span><span class="op" id="4583608">(</span><span class="ident" id="4583609">certificateRequest</span><span class="op" id="4583627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583631">TBSCSR</span><span class="op" id="4583637">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583651">tbsCSR</span><span class="op" id="4583657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583661">SignatureAlgorithm</span><span class="op" id="4583679">:</span>&nbsp;<span class="ident" id="4583681">sigAlgo</span><span class="op" id="4583688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583692">SignatureValue</span><span class="op" id="4583706">:</span>&nbsp;<span class="ident" id="4583708">asn1</span><span class="op" id="4583712">.</span><span class="ident" id="4583713">BitString</span><span class="op" id="4583722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583727">Bytes</span><span class="op" id="4583732">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583738">signature</span><span class="op" id="4583747">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583752">BitLength</span><span class="op" id="4583761">:</span>&nbsp;<span class="builtinfunc" id="4583763">len</span><span class="op" id="4583766">(</span><span class="ident" id="4583767">signature</span><span class="op" id="4583776">)</span>&nbsp;<span class="op" id="4583778">*</span>&nbsp;<span class="num" id="4583780">8</span><span class="op" id="4583781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583785">}</span><span class="op" id="4583786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583789">}</span><span class="op" id="4583790">)</span><br>
<span class="lineno"></span><span class="op" id="4583792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4583795">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4583867">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4583892">func</span>&nbsp;<span class="ident" id="4583897">ParseCertificateRequest</span><span class="op" id="4583920">(</span><span class="ident" id="4583921">asn1Data</span>&nbsp;<span class="op" id="4583930">[</span><span class="op" id="4583931">]</span><span class="builtintype" id="4583932">byte</span><span class="op" id="4583936">)</span>&nbsp;<span class="op" id="4583938">(</span><span class="op" id="4583939">*</span><span class="ident" id="4583940">CertificateRequest</span><span class="op" id="4583958">,</span>&nbsp;<span class="builtintype" id="4583960">error</span><span class="op" id="4583965">)</span>&nbsp;<span class="op" id="4583967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583970">var</span>&nbsp;<span class="ident" id="4583974">csr</span>&nbsp;<span class="ident" id="4583978">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583999">rest</span><span class="op" id="4584003">,</span>&nbsp;<span class="ident" id="4584005">err</span>&nbsp;<span class="op" id="4584009">:=</span>&nbsp;<span class="ident" id="4584012">asn1</span><span class="op" id="4584016">.</span><span class="ident" id="4584017">Unmarshal</span><span class="op" id="4584026">(</span><span class="ident" id="4584027">asn1Data</span><span class="op" id="4584035">,</span>&nbsp;<span class="op" id="4584037">&amp;</span><span class="ident" id="4584038">csr</span><span class="op" id="4584041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584044">if</span>&nbsp;<span class="ident" id="4584047">err</span>&nbsp;<span class="op" id="4584051">!=</span>&nbsp;<span class="builtintype" id="4584054">nil</span>&nbsp;<span class="op" id="4584058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584062">return</span>&nbsp;<span class="builtintype" id="4584069">nil</span><span class="op" id="4584072">,</span>&nbsp;<span class="ident" id="4584074">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4584079">}</span>&nbsp;<span class="keyword" id="4584081">else</span>&nbsp;<span class="keyword" id="4584086">if</span>&nbsp;<span class="builtinfunc" id="4584089">len</span><span class="op" id="4584092">(</span><span class="ident" id="4584093">rest</span><span class="op" id="4584097">)</span>&nbsp;<span class="op" id="4584099">!=</span>&nbsp;<span class="num" id="4584102">0</span>&nbsp;<span class="op" id="4584104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584108">return</span>&nbsp;<span class="builtintype" id="4584115">nil</span><span class="op" id="4584118">,</span>&nbsp;<span class="ident" id="4584120">asn1</span><span class="op" id="4584124">.</span><span class="ident" id="4584125">SyntaxError</span><span class="op" id="4584136">{</span><span class="ident" id="4584137">Msg</span><span class="op" id="4584140">:</span>&nbsp;<span class="string" id="4584142">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4584157">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4584160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584164">return</span>&nbsp;<span class="ident" id="4584171">parseCertificateRequest</span><span class="op" id="4584194">(</span><span class="op" id="4584195">&amp;</span><span class="ident" id="4584196">csr</span><span class="op" id="4584199">)</span><br>
<span class="lineno"></span><span class="op" id="4584201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4584204">func</span>&nbsp;<span class="ident" id="4584209">parseCertificateRequest</span><span class="op" id="4584232">(</span><span class="ident" id="4584233">in</span>&nbsp;<span class="op" id="4584236">*</span><span class="ident" id="4584237">certificateRequest</span><span class="op" id="4584255">)</span>&nbsp;<span class="op" id="4584257">(</span><span class="op" id="4584258">*</span><span class="ident" id="4584259">CertificateRequest</span><span class="op" id="4584277">,</span>&nbsp;<span class="builtintype" id="4584279">error</span><span class="op" id="4584284">)</span>&nbsp;<span class="op" id="4584286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584289">out</span>&nbsp;<span class="op" id="4584293">:=</span>&nbsp;<span class="op" id="4584296">&amp;</span><span class="ident" id="4584297">CertificateRequest</span><span class="op" id="4584315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584319">Raw</span><span class="op" id="4584322">:</span>&nbsp;<span class="ident" id="4584324">in</span><span class="op" id="4584326">.</span><span class="ident" id="4584327">Raw</span><span class="op" id="4584330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584334">RawTBSCertificateRequest</span><span class="op" id="4584358">:</span>&nbsp;<span class="ident" id="4584360">in</span><span class="op" id="4584362">.</span><span class="ident" id="4584363">TBSCSR</span><span class="op" id="4584369">.</span><span class="ident" id="4584370">Raw</span><span class="op" id="4584373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584377">RawSubjectPublicKeyInfo</span><span class="op" id="4584400">:</span>&nbsp;&nbsp;<span class="ident" id="4584403">in</span><span class="op" id="4584405">.</span><span class="ident" id="4584406">TBSCSR</span><span class="op" id="4584412">.</span><span class="ident" id="4584413">PublicKey</span><span class="op" id="4584422">.</span><span class="ident" id="4584423">Raw</span><span class="op" id="4584426">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584430">RawSubject</span><span class="op" id="4584440">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584456">in</span><span class="op" id="4584458">.</span><span class="ident" id="4584459">TBSCSR</span><span class="op" id="4584465">.</span><span class="ident" id="4584466">Subject</span><span class="op" id="4584473">.</span><span class="ident" id="4584474">FullBytes</span><span class="op" id="4584483">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584488">Signature</span><span class="op" id="4584497">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584508">in</span><span class="op" id="4584510">.</span><span class="ident" id="4584511">SignatureValue</span><span class="op" id="4584525">.</span><span class="ident" id="4584526">RightAlign</span><span class="op" id="4584536">(</span><span class="op" id="4584537">)</span><span class="op" id="4584538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584542">SignatureAlgorithm</span><span class="op" id="4584560">:</span>&nbsp;<span class="ident" id="4584562">getSignatureAlgorithmFromOID</span><span class="op" id="4584590">(</span><span class="ident" id="4584591">in</span><span class="op" id="4584593">.</span><span class="ident" id="4584594">SignatureAlgorithm</span><span class="op" id="4584612">.</span><span class="ident" id="4584613">Algorithm</span><span class="op" id="4584622">)</span><span class="op" id="4584623">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584628">PublicKeyAlgorithm</span><span class="op" id="4584646">:</span>&nbsp;<span class="ident" id="4584648">getPublicKeyAlgorithmFromOID</span><span class="op" id="4584676">(</span><span class="ident" id="4584677">in</span><span class="op" id="4584679">.</span><span class="ident" id="4584680">TBSCSR</span><span class="op" id="4584686">.</span><span class="ident" id="4584687">PublicKey</span><span class="op" id="4584696">.</span><span class="ident" id="4584697">Algorithm</span><span class="op" id="4584706">.</span><span class="ident" id="4584707">Algorithm</span><span class="op" id="4584716">)</span><span class="op" id="4584717">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584722">Version</span><span class="op" id="4584729">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584734">in</span><span class="op" id="4584736">.</span><span class="ident" id="4584737">TBSCSR</span><span class="op" id="4584743">.</span><span class="ident" id="4584744">Version</span><span class="op" id="4584751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584755">Attributes</span><span class="op" id="4584765">:</span>&nbsp;<span class="ident" id="4584767">in</span><span class="op" id="4584769">.</span><span class="ident" id="4584770">TBSCSR</span><span class="op" id="4584776">.</span><span class="ident" id="4584777">Attributes</span><span class="op" id="4584787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4584790">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584794">var</span>&nbsp;<span class="ident" id="4584798">err</span>&nbsp;<span class="builtintype" id="4584802">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584809">out</span><span class="op" id="4584812">.</span><span class="ident" id="4584813">PublicKey</span><span class="op" id="4584822">,</span>&nbsp;<span class="ident" id="4584824">err</span>&nbsp;<span class="op" id="4584828">=</span>&nbsp;<span class="ident" id="4584830">parsePublicKey</span><span class="op" id="4584844">(</span><span class="ident" id="4584845">out</span><span class="op" id="4584848">.</span><span class="ident" id="4584849">PublicKeyAlgorithm</span><span class="op" id="4584867">,</span>&nbsp;<span class="op" id="4584869">&amp;</span><span class="ident" id="4584870">in</span><span class="op" id="4584872">.</span><span class="ident" id="4584873">TBSCSR</span><span class="op" id="4584879">.</span><span class="ident" id="4584880">PublicKey</span><span class="op" id="4584889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584892">if</span>&nbsp;<span class="ident" id="4584895">err</span>&nbsp;<span class="op" id="4584899">!=</span>&nbsp;<span class="builtintype" id="4584902">nil</span>&nbsp;<span class="op" id="4584906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584910">return</span>&nbsp;<span class="builtintype" id="4584917">nil</span><span class="op" id="4584920">,</span>&nbsp;<span class="ident" id="4584922">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4584927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584931">var</span>&nbsp;<span class="ident" id="4584935">subject</span>&nbsp;<span class="ident" id="4584943">pkix</span><span class="op" id="4584947">.</span><span class="ident" id="4584948">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584961">if</span>&nbsp;<span class="ident" id="4584964">_</span><span class="op" id="4584965">,</span>&nbsp;<span class="ident" id="4584967">err</span>&nbsp;<span class="op" id="4584971">:=</span>&nbsp;<span class="ident" id="4584974">asn1</span><span class="op" id="4584978">.</span><span class="ident" id="4584979">Unmarshal</span><span class="op" id="4584988">(</span><span class="ident" id="4584989">in</span><span class="op" id="4584991">.</span><span class="ident" id="4584992">TBSCSR</span><span class="op" id="4584998">.</span><span class="ident" id="4584999">Subject</span><span class="op" id="4585006">.</span><span class="ident" id="4585007">FullBytes</span><span class="op" id="4585016">,</span>&nbsp;<span class="op" id="4585018">&amp;</span><span class="ident" id="4585019">subject</span><span class="op" id="4585026">)</span><span class="op" id="4585027">;</span>&nbsp;<span class="ident" id="4585029">err</span>&nbsp;<span class="op" id="4585033">!=</span>&nbsp;<span class="builtintype" id="4585036">nil</span>&nbsp;<span class="op" id="4585040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585044">return</span>&nbsp;<span class="builtintype" id="4585051">nil</span><span class="op" id="4585054">,</span>&nbsp;<span class="ident" id="4585056">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585065">out</span><span class="op" id="4585068">.</span><span class="ident" id="4585069">Subject</span><span class="op" id="4585076">.</span><span class="ident" id="4585077">FillFromRDNSequence</span><span class="op" id="4585096">(</span><span class="op" id="4585097">&amp;</span><span class="ident" id="4585098">subject</span><span class="op" id="4585105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585109">var</span>&nbsp;<span class="ident" id="4585113">extensions</span>&nbsp;<span class="op" id="4585124">[</span><span class="op" id="4585125">]</span><span class="ident" id="4585126">pkix</span><span class="op" id="4585130">.</span><span class="ident" id="4585131">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585155">for</span>&nbsp;<span class="ident" id="4585159">_</span><span class="op" id="4585160">,</span>&nbsp;<span class="ident" id="4585162">atvSet</span>&nbsp;<span class="op" id="4585169">:=</span>&nbsp;<span class="keyword" id="4585172">range</span>&nbsp;<span class="ident" id="4585178">in</span><span class="op" id="4585180">.</span><span class="ident" id="4585181">TBSCSR</span><span class="op" id="4585187">.</span><span class="ident" id="4585188">Attributes</span>&nbsp;<span class="op" id="4585199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585203">if</span>&nbsp;<span class="op" id="4585206">!</span><span class="ident" id="4585207">atvSet</span><span class="op" id="4585213">.</span><span class="ident" id="4585214">Type</span><span class="op" id="4585218">.</span><span class="ident" id="4585219">Equal</span><span class="op" id="4585224">(</span><span class="ident" id="4585225">oidExtensionRequest</span><span class="op" id="4585244">)</span>&nbsp;<span class="op" id="4585246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585251">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585262">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585267">for</span>&nbsp;<span class="ident" id="4585271">_</span><span class="op" id="4585272">,</span>&nbsp;<span class="ident" id="4585274">atvs</span>&nbsp;<span class="op" id="4585279">:=</span>&nbsp;<span class="keyword" id="4585282">range</span>&nbsp;<span class="ident" id="4585288">atvSet</span><span class="op" id="4585294">.</span><span class="ident" id="4585295">Value</span>&nbsp;<span class="op" id="4585301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585306">extensions</span>&nbsp;<span class="op" id="4585317">=</span>&nbsp;<span class="builtinfunc" id="4585319">append</span><span class="op" id="4585325">(</span><span class="ident" id="4585326">extensions</span><span class="op" id="4585336">,</span>&nbsp;<span class="ident" id="4585338">atvs</span><span class="op" id="4585342">...</span><span class="op" id="4585345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585352">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585356">out</span><span class="op" id="4585359">.</span><span class="ident" id="4585360">Extensions</span>&nbsp;<span class="op" id="4585371">=</span>&nbsp;<span class="builtinfunc" id="4585373">make</span><span class="op" id="4585377">(</span><span class="op" id="4585378">[</span><span class="op" id="4585379">]</span><span class="ident" id="4585380">pkix</span><span class="op" id="4585384">.</span><span class="ident" id="4585385">Extension</span><span class="op" id="4585394">,</span>&nbsp;<span class="num" id="4585396">0</span><span class="op" id="4585397">,</span>&nbsp;<span class="builtinfunc" id="4585399">len</span><span class="op" id="4585402">(</span><span class="ident" id="4585403">extensions</span><span class="op" id="4585413">)</span><span class="op" id="4585414">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585418">for</span>&nbsp;<span class="ident" id="4585422">_</span><span class="op" id="4585423">,</span>&nbsp;<span class="ident" id="4585425">e</span>&nbsp;<span class="op" id="4585427">:=</span>&nbsp;<span class="keyword" id="4585430">range</span>&nbsp;<span class="ident" id="4585436">extensions</span>&nbsp;<span class="op" id="4585447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585451">value</span><span class="op" id="4585456">,</span>&nbsp;<span class="ident" id="4585458">ok</span>&nbsp;<span class="op" id="4585461">:=</span>&nbsp;<span class="ident" id="4585464">e</span><span class="op" id="4585465">.</span><span class="ident" id="4585466">Value</span><span class="op" id="4585471">.</span><span class="op" id="4585472">(</span><span class="op" id="4585473">[</span><span class="op" id="4585474">]</span><span class="builtintype" id="4585475">byte</span><span class="op" id="4585479">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585483">if</span>&nbsp;<span class="op" id="4585486">!</span><span class="ident" id="4585487">ok</span>&nbsp;<span class="op" id="4585490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585495">return</span>&nbsp;<span class="builtintype" id="4585502">nil</span><span class="op" id="4585505">,</span>&nbsp;<span class="ident" id="4585507">errors</span><span class="op" id="4585513">.</span><span class="ident" id="4585514">New</span><span class="op" id="4585517">(</span><span class="string" id="4585518">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4585577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585586">out</span><span class="op" id="4585589">.</span><span class="ident" id="4585590">Extensions</span>&nbsp;<span class="op" id="4585601">=</span>&nbsp;<span class="builtinfunc" id="4585603">append</span><span class="op" id="4585609">(</span><span class="ident" id="4585610">out</span><span class="op" id="4585613">.</span><span class="ident" id="4585614">Extensions</span><span class="op" id="4585624">,</span>&nbsp;<span class="ident" id="4585626">pkix</span><span class="op" id="4585630">.</span><span class="ident" id="4585631">Extension</span><span class="op" id="4585640">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585645">Id</span><span class="op" id="4585647">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585652">e</span><span class="op" id="4585653">.</span><span class="ident" id="4585654">Type</span><span class="op" id="4585658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585663">Value</span><span class="op" id="4585668">:</span>&nbsp;<span class="ident" id="4585670">value</span><span class="op" id="4585675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585679">}</span><span class="op" id="4585680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585685">if</span>&nbsp;<span class="builtinfunc" id="4585688">len</span><span class="op" id="4585691">(</span><span class="ident" id="4585692">e</span><span class="op" id="4585693">.</span><span class="ident" id="4585694">Type</span><span class="op" id="4585698">)</span>&nbsp;<span class="op" id="4585700">==</span>&nbsp;<span class="num" id="4585703">4</span>&nbsp;<span class="op" id="4585705">&amp;&amp;</span>&nbsp;<span class="ident" id="4585708">e</span><span class="op" id="4585709">.</span><span class="ident" id="4585710">Type</span><span class="op" id="4585714">[</span><span class="num" id="4585715">0</span><span class="op" id="4585716">]</span>&nbsp;<span class="op" id="4585718">==</span>&nbsp;<span class="num" id="4585721">2</span>&nbsp;<span class="op" id="4585723">&amp;&amp;</span>&nbsp;<span class="ident" id="4585726">e</span><span class="op" id="4585727">.</span><span class="ident" id="4585728">Type</span><span class="op" id="4585732">[</span><span class="num" id="4585733">1</span><span class="op" id="4585734">]</span>&nbsp;<span class="op" id="4585736">==</span>&nbsp;<span class="num" id="4585739">5</span>&nbsp;<span class="op" id="4585741">&amp;&amp;</span>&nbsp;<span class="ident" id="4585744">e</span><span class="op" id="4585745">.</span><span class="ident" id="4585746">Type</span><span class="op" id="4585750">[</span><span class="num" id="4585751">2</span><span class="op" id="4585752">]</span>&nbsp;<span class="op" id="4585754">==</span>&nbsp;<span class="num" id="4585757">29</span>&nbsp;<span class="op" id="4585760">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585765">switch</span>&nbsp;<span class="ident" id="4585772">e</span><span class="op" id="4585773">.</span><span class="ident" id="4585774">Type</span><span class="op" id="4585778">[</span><span class="num" id="4585779">3</span><span class="op" id="4585780">]</span>&nbsp;<span class="op" id="4585782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585787">case</span>&nbsp;<span class="num" id="4585792">17</span><span class="op" id="4585794">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585800">out</span><span class="op" id="4585803">.</span><span class="ident" id="4585804">DNSNames</span><span class="op" id="4585812">,</span>&nbsp;<span class="ident" id="4585814">out</span><span class="op" id="4585817">.</span><span class="ident" id="4585818">EmailAddresses</span><span class="op" id="4585832">,</span>&nbsp;<span class="ident" id="4585834">out</span><span class="op" id="4585837">.</span><span class="ident" id="4585838">IPAddresses</span><span class="op" id="4585849">,</span>&nbsp;<span class="ident" id="4585851">err</span>&nbsp;<span class="op" id="4585855">=</span>&nbsp;<span class="ident" id="4585857">parseSANExtension</span><span class="op" id="4585874">(</span><span class="ident" id="4585875">value</span><span class="op" id="4585880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585886">if</span>&nbsp;<span class="ident" id="4585889">err</span>&nbsp;<span class="op" id="4585893">!=</span>&nbsp;<span class="builtintype" id="4585896">nil</span>&nbsp;<span class="op" id="4585900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585907">return</span>&nbsp;<span class="builtintype" id="4585914">nil</span><span class="op" id="4585917">,</span>&nbsp;<span class="ident" id="4585919">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585943">return</span>&nbsp;<span class="ident" id="4585950">out</span><span class="op" id="4585953">,</span>&nbsp;<span class="builtintype" id="4585955">nil</span><br>
<span class="lineno"></span><span class="op" id="4585959">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
