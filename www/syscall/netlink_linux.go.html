<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1654235">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1654291">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1654345">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1654396">//&nbsp;Netlink&nbsp;sockets&nbsp;and&nbsp;messages</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1654429">package</span>&nbsp;<span class="ident" id="1654437">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1654446">import</span>&nbsp;<span class="string" id="1654453">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1654463">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;message&nbsp;up&nbsp;to&nbsp;align&nbsp;it&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="1654529">func</span>&nbsp;<span class="ident" id="1654534">nlmAlignOf</span><span class="op" id="1654544">(</span><span class="ident" id="1654545">msglen</span>&nbsp;<span class="builtintype" id="1654552">int</span><span class="op" id="1654555">)</span>&nbsp;<span class="builtintype" id="1654557">int</span>&nbsp;<span class="op" id="1654561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1654564">return</span>&nbsp;<span class="op" id="1654571">(</span><span class="ident" id="1654572"><a href="/syscall/netlink_linux.go.html#1654545">msglen</a></span>&nbsp;<span class="op" id="1654579">+</span>&nbsp;<span class="ident" id="1654581"><a href="/syscall/zerrors_linux_amd64.go.html#1731438">NLMSG_ALIGNTO</a></span>&nbsp;<span class="op" id="1654595">-</span>&nbsp;<span class="num" id="1654597">1</span><span class="op" id="1654598">)</span>&nbsp;<span class="op" id="1654600">&amp;</span>&nbsp;<span class="op" id="1654602">^</span><span class="op" id="1654603">(</span><span class="ident" id="1654604"><a href="/syscall/zerrors_linux_amd64.go.html#1731438">NLMSG_ALIGNTO</a></span>&nbsp;<span class="op" id="1654618">-</span>&nbsp;<span class="num" id="1654620">1</span><span class="op" id="1654621">)</span><br>
<span class="lineno"></span><span class="op" id="1654623">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="1654626">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute&nbsp;up&nbsp;to&nbsp;align&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1654690">//&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="1654703">func</span>&nbsp;<span class="ident" id="1654708">rtaAlignOf</span><span class="op" id="1654718">(</span><span class="ident" id="1654719">attrlen</span>&nbsp;<span class="builtintype" id="1654727">int</span><span class="op" id="1654730">)</span>&nbsp;<span class="builtintype" id="1654732">int</span>&nbsp;<span class="op" id="1654736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1654739">return</span>&nbsp;<span class="op" id="1654746">(</span><span class="ident" id="1654747"><a href="/syscall/netlink_linux.go.html#1654719">attrlen</a></span>&nbsp;<span class="op" id="1654755">+</span>&nbsp;<span class="ident" id="1654757"><a href="/syscall/zerrors_linux_amd64.go.html#1739521">RTA_ALIGNTO</a></span>&nbsp;<span class="op" id="1654769">-</span>&nbsp;<span class="num" id="1654771">1</span><span class="op" id="1654772">)</span>&nbsp;<span class="op" id="1654774">&amp;</span>&nbsp;<span class="op" id="1654776">^</span><span class="op" id="1654777">(</span><span class="ident" id="1654778"><a href="/syscall/zerrors_linux_amd64.go.html#1739521">RTA_ALIGNTO</a></span>&nbsp;<span class="op" id="1654790">-</span>&nbsp;<span class="num" id="1654792">1</span><span class="op" id="1654793">)</span><br>
<span class="lineno">20</span><span class="op" id="1654795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1654798">//&nbsp;NetlinkRouteRequest&nbsp;represents&nbsp;a&nbsp;request&nbsp;message&nbsp;to&nbsp;receive&nbsp;routing</span><br>
<span class="lineno"></span><span class="comment" id="1654869">//&nbsp;and&nbsp;link&nbsp;states&nbsp;from&nbsp;the&nbsp;kernel.</span><br>
<span class="lineno"></span><span class="keyword" id="1654905">type</span>&nbsp;<span class="ident" id="1654910">NetlinkRouteRequest</span>&nbsp;<span class="keyword" id="1654930">struct</span>&nbsp;<span class="op" id="1654937">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1654940">Header</span>&nbsp;<span class="ident" id="1654947"><a href="/syscall/ztypes_linux_amd64.go.html#1829293">NlMsghdr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1654957">Data</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1654964"><a href="/syscall/ztypes_linux_amd64.go.html#1829444">RtGenmsg</a></span><br>
<span class="lineno"></span><span class="op" id="1654973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1654976">func</span>&nbsp;<span class="op" id="1654981">(</span><span class="ident" id="1654982">rr</span>&nbsp;<span class="op" id="1654985">*</span><span class="ident" id="1654986"><a href="/syscall/netlink_linux.go.html#1654910">NetlinkRouteRequest</a></span><span class="op" id="1655005">)</span>&nbsp;<span class="ident" id="1655007">toWireFormat</span><span class="op" id="1655019">(</span><span class="op" id="1655020">)</span>&nbsp;<span class="op" id="1655022">[</span><span class="op" id="1655023">]</span><span class="builtintype" id="1655024">byte</span>&nbsp;<span class="op" id="1655029">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1655032">b</span>&nbsp;<span class="op" id="1655034">:=</span>&nbsp;<span class="builtinfunc" id="1655037">make</span><span class="op" id="1655041">(</span><span class="op" id="1655042">[</span><span class="op" id="1655043">]</span><span class="builtintype" id="1655044">byte</span><span class="op" id="1655048">,</span>&nbsp;<span class="ident" id="1655050"><a href="/syscall/netlink_linux.go.html#1654982">rr</a></span><span class="op" id="1655052">.</span><span class="ident" id="1655053">Header</span><span class="op" id="1655059">.</span><span class="ident" id="1655060">Len</span><span class="op" id="1655063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1655066">*</span><span class="op" id="1655067">(</span><span class="op" id="1655068">*</span><span class="builtintype" id="1655069">uint32</span><span class="op" id="1655075">)</span><span class="op" id="1655076">(</span><span class="ident" id="1655077"><a href="/syscall/netlink_linux.go.html#1654453">unsafe</a></span><span class="op" id="1655083">.</span><span class="ident" id="1655084">Pointer</span><span class="op" id="1655091">(</span><span class="op" id="1655092">&amp;</span><span class="ident" id="1655093"><a href="/syscall/netlink_linux.go.html#1655032">b</a></span><span class="op" id="1655094">[</span><span class="num" id="1655095">0</span><span class="op" id="1655096">:</span><span class="num" id="1655097">4</span><span class="op" id="1655098">]</span><span class="op" id="1655099">[</span><span class="num" id="1655100">0</span><span class="op" id="1655101">]</span><span class="op" id="1655102">)</span><span class="op" id="1655103">)</span>&nbsp;<span class="op" id="1655105">=</span>&nbsp;<span class="ident" id="1655107"><a href="/syscall/netlink_linux.go.html#1654982">rr</a></span><span class="op" id="1655109">.</span><span class="ident" id="1655110">Header</span><span class="op" id="1655116">.</span><span class="ident" id="1655117">Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1655122">*</span><span class="op" id="1655123">(</span><span class="op" id="1655124">*</span><span class="builtintype" id="1655125">uint16</span><span class="op" id="1655131">)</span><span class="op" id="1655132">(</span><span class="ident" id="1655133"><a href="/syscall/netlink_linux.go.html#1654453">unsafe</a></span><span class="op" id="1655139">.</span><span class="ident" id="1655140">Pointer</span><span class="op" id="1655147">(</span><span class="op" id="1655148">&amp;</span><span class="ident" id="1655149"><a href="/syscall/netlink_linux.go.html#1655032">b</a></span><span class="op" id="1655150">[</span><span class="num" id="1655151">4</span><span class="op" id="1655152">:</span><span class="num" id="1655153">6</span><span class="op" id="1655154">]</span><span class="op" id="1655155">[</span><span class="num" id="1655156">0</span><span class="op" id="1655157">]</span><span class="op" id="1655158">)</span><span class="op" id="1655159">)</span>&nbsp;<span class="op" id="1655161">=</span>&nbsp;<span class="ident" id="1655163"><a href="/syscall/netlink_linux.go.html#1654982">rr</a></span><span class="op" id="1655165">.</span><span class="ident" id="1655166">Header</span><span class="op" id="1655172">.</span><span class="ident" id="1655173">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1655179">*</span><span class="op" id="1655180">(</span><span class="op" id="1655181">*</span><span class="builtintype" id="1655182">uint16</span><span class="op" id="1655188">)</span><span class="op" id="1655189">(</span><span class="ident" id="1655190"><a href="/syscall/netlink_linux.go.html#1654453">unsafe</a></span><span class="op" id="1655196">.</span><span class="ident" id="1655197">Pointer</span><span class="op" id="1655204">(</span><span class="op" id="1655205">&amp;</span><span class="ident" id="1655206"><a href="/syscall/netlink_linux.go.html#1655032">b</a></span><span class="op" id="1655207">[</span><span class="num" id="1655208">6</span><span class="op" id="1655209">:</span><span class="num" id="1655210">8</span><span class="op" id="1655211">]</span><span class="op" id="1655212">[</span><span class="num" id="1655213">0</span><span class="op" id="1655214">]</span><span class="op" id="1655215">)</span><span class="op" id="1655216">)</span>&nbsp;<span class="op" id="1655218">=</span>&nbsp;<span class="ident" id="1655220"><a href="/syscall/netlink_linux.go.html#1654982">rr</a></span><span class="op" id="1655222">.</span><span class="ident" id="1655223">Header</span><span class="op" id="1655229">.</span><span class="ident" id="1655230">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1655237">*</span><span class="op" id="1655238">(</span><span class="op" id="1655239">*</span><span class="builtintype" id="1655240">uint32</span><span class="op" id="1655246">)</span><span class="op" id="1655247">(</span><span class="ident" id="1655248"><a href="/syscall/netlink_linux.go.html#1654453">unsafe</a></span><span class="op" id="1655254">.</span><span class="ident" id="1655255">Pointer</span><span class="op" id="1655262">(</span><span class="op" id="1655263">&amp;</span><span class="ident" id="1655264"><a href="/syscall/netlink_linux.go.html#1655032">b</a></span><span class="op" id="1655265">[</span><span class="num" id="1655266">8</span><span class="op" id="1655267">:</span><span class="num" id="1655268">12</span><span class="op" id="1655270">]</span><span class="op" id="1655271">[</span><span class="num" id="1655272">0</span><span class="op" id="1655273">]</span><span class="op" id="1655274">)</span><span class="op" id="1655275">)</span>&nbsp;<span class="op" id="1655277">=</span>&nbsp;<span class="ident" id="1655279"><a href="/syscall/netlink_linux.go.html#1654982">rr</a></span><span class="op" id="1655281">.</span><span class="ident" id="1655282">Header</span><span class="op" id="1655288">.</span><span class="ident" id="1655289">Seq</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1655294">*</span><span class="op" id="1655295">(</span><span class="op" id="1655296">*</span><span class="builtintype" id="1655297">uint32</span><span class="op" id="1655303">)</span><span class="op" id="1655304">(</span><span class="ident" id="1655305"><a href="/syscall/netlink_linux.go.html#1654453">unsafe</a></span><span class="op" id="1655311">.</span><span class="ident" id="1655312">Pointer</span><span class="op" id="1655319">(</span><span class="op" id="1655320">&amp;</span><span class="ident" id="1655321"><a href="/syscall/netlink_linux.go.html#1655032">b</a></span><span class="op" id="1655322">[</span><span class="num" id="1655323">12</span><span class="op" id="1655325">:</span><span class="num" id="1655326">16</span><span class="op" id="1655328">]</span><span class="op" id="1655329">[</span><span class="num" id="1655330">0</span><span class="op" id="1655331">]</span><span class="op" id="1655332">)</span><span class="op" id="1655333">)</span>&nbsp;<span class="op" id="1655335">=</span>&nbsp;<span class="ident" id="1655337"><a href="/syscall/netlink_linux.go.html#1654982">rr</a></span><span class="op" id="1655339">.</span><span class="ident" id="1655340">Header</span><span class="op" id="1655346">.</span><span class="ident" id="1655347">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1655352"><a href="/syscall/netlink_linux.go.html#1655032">b</a></span><span class="op" id="1655353">[</span><span class="num" id="1655354">16</span><span class="op" id="1655356">]</span>&nbsp;<span class="op" id="1655358">=</span>&nbsp;<span class="builtintype" id="1655360">byte</span><span class="op" id="1655364">(</span><span class="ident" id="1655365"><a href="/syscall/netlink_linux.go.html#1654982">rr</a></span><span class="op" id="1655367">.</span><span class="ident" id="1655368">Data</span><span class="op" id="1655372">.</span><span class="ident" id="1655373">Family</span><span class="op" id="1655379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1655382">return</span>&nbsp;<span class="ident" id="1655389"><a href="/syscall/netlink_linux.go.html#1655032">b</a></span><br>
<span class="lineno"></span><span class="op" id="1655391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="1655394">func</span>&nbsp;<span class="ident" id="1655399">newNetlinkRouteRequest</span><span class="op" id="1655421">(</span><span class="ident" id="1655422">proto</span><span class="op" id="1655427">,</span>&nbsp;<span class="ident" id="1655429">seq</span><span class="op" id="1655432">,</span>&nbsp;<span class="ident" id="1655434">family</span>&nbsp;<span class="builtintype" id="1655441">int</span><span class="op" id="1655444">)</span>&nbsp;<span class="op" id="1655446">[</span><span class="op" id="1655447">]</span><span class="builtintype" id="1655448">byte</span>&nbsp;<span class="op" id="1655453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1655456">rr</span>&nbsp;<span class="op" id="1655459">:=</span>&nbsp;<span class="op" id="1655462">&amp;</span><span class="ident" id="1655463"><a href="/syscall/netlink_linux.go.html#1654910">NetlinkRouteRequest</a></span><span class="op" id="1655482">{</span><span class="op" id="1655483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1655486"><a href="/syscall/netlink_linux.go.html#1655456">rr</a></span><span class="op" id="1655488">.</span><span class="ident" id="1655489">Header</span><span class="op" id="1655495">.</span><span class="ident" id="1655496">Len</span>&nbsp;<span class="op" id="1655500">=</span>&nbsp;<span class="builtintype" id="1655502">uint32</span><span class="op" id="1655508">(</span><span class="ident" id="1655509"><a href="/syscall/zerrors_linux_amd64.go.html#1731558">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="1655522">+</span>&nbsp;<span class="ident" id="1655524"><a href="/syscall/ztypes_linux_amd64.go.html#1829096">SizeofRtGenmsg</a></span><span class="op" id="1655538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1655541"><a href="/syscall/netlink_linux.go.html#1655456">rr</a></span><span class="op" id="1655543">.</span><span class="ident" id="1655544">Header</span><span class="op" id="1655550">.</span><span class="ident" id="1655551">Type</span>&nbsp;<span class="op" id="1655556">=</span>&nbsp;<span class="builtintype" id="1655558">uint16</span><span class="op" id="1655564">(</span><span class="ident" id="1655565"><a href="/syscall/netlink_linux.go.html#1655422">proto</a></span><span class="op" id="1655570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1655573"><a href="/syscall/netlink_linux.go.html#1655456">rr</a></span><span class="op" id="1655575">.</span><span class="ident" id="1655576">Header</span><span class="op" id="1655582">.</span><span class="ident" id="1655583">Flags</span>&nbsp;<span class="op" id="1655589">=</span>&nbsp;<span class="ident" id="1655591"><a href="/syscall/zerrors_linux_amd64.go.html#1731886">NLM_F_DUMP</a></span>&nbsp;<span class="op" id="1655602">|</span>&nbsp;<span class="ident" id="1655604"><a href="/syscall/zerrors_linux_amd64.go.html#1732134">NLM_F_REQUEST</a></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1655619"><a href="/syscall/netlink_linux.go.html#1655456">rr</a></span><span class="op" id="1655621">.</span><span class="ident" id="1655622">Header</span><span class="op" id="1655628">.</span><span class="ident" id="1655629">Seq</span>&nbsp;<span class="op" id="1655633">=</span>&nbsp;<span class="builtintype" id="1655635">uint32</span><span class="op" id="1655641">(</span><span class="ident" id="1655642"><a href="/syscall/netlink_linux.go.html#1655429">seq</a></span><span class="op" id="1655645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1655648"><a href="/syscall/netlink_linux.go.html#1655456">rr</a></span><span class="op" id="1655650">.</span><span class="ident" id="1655651">Data</span><span class="op" id="1655655">.</span><span class="ident" id="1655656">Family</span>&nbsp;<span class="op" id="1655663">=</span>&nbsp;<span class="builtintype" id="1655665">uint8</span><span class="op" id="1655670">(</span><span class="ident" id="1655671"><a href="/syscall/netlink_linux.go.html#1655434">family</a></span><span class="op" id="1655677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1655680">return</span>&nbsp;<span class="ident" id="1655687"><a href="/syscall/netlink_linux.go.html#1655456">rr</a></span><span class="op" id="1655689">.</span><span class="ident" id="1655690">toWireFormat</span><span class="op" id="1655702">(</span><span class="op" id="1655703">)</span><br>
<span class="lineno"></span><span class="op" id="1655705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="1655708">//&nbsp;NetlinkRIB&nbsp;returns&nbsp;routing&nbsp;information&nbsp;base,&nbsp;as&nbsp;known&nbsp;as&nbsp;RIB,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="1655779">//&nbsp;consists&nbsp;of&nbsp;network&nbsp;facility&nbsp;information,&nbsp;states&nbsp;and&nbsp;parameters.</span><br>
<span class="lineno"></span><span class="keyword" id="1655847">func</span>&nbsp;<span class="ident" id="1655852">NetlinkRIB</span><span class="op" id="1655862">(</span><span class="ident" id="1655863">proto</span><span class="op" id="1655868">,</span>&nbsp;<span class="ident" id="1655870">family</span>&nbsp;<span class="builtintype" id="1655877">int</span><span class="op" id="1655880">)</span>&nbsp;<span class="op" id="1655882">(</span><span class="op" id="1655883">[</span><span class="op" id="1655884">]</span><span class="builtintype" id="1655885">byte</span><span class="op" id="1655889">,</span>&nbsp;<span class="builtintype" id="1655891">error</span><span class="op" id="1655896">)</span>&nbsp;<span class="op" id="1655898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1655901">s</span><span class="op" id="1655902">,</span>&nbsp;<span class="ident" id="1655904">err</span>&nbsp;<span class="op" id="1655908">:=</span>&nbsp;<span class="ident" id="1655911"><a href="/syscall/syscall_unix.go.html#1705251">Socket</a></span><span class="op" id="1655917">(</span><span class="ident" id="1655918"><a href="/syscall/zerrors_linux_amd64.go.html#1707038">AF_NETLINK</a></span><span class="op" id="1655928">,</span>&nbsp;<span class="ident" id="1655930"><a href="/syscall/zerrors_linux_amd64.go.html#1747259">SOCK_RAW</a></span><span class="op" id="1655938">,</span>&nbsp;<span class="ident" id="1655940"><a href="/syscall/zerrors_linux_amd64.go.html#1731031">NETLINK_ROUTE</a></span><span class="op" id="1655953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1655956">if</span>&nbsp;<span class="ident" id="1655959"><a href="/syscall/netlink_linux.go.html#1655904">err</a></span>&nbsp;<span class="op" id="1655963">!=</span>&nbsp;<span class="ident" id="1655966">nil</span>&nbsp;<span class="op" id="1655970">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1655974">return</span>&nbsp;<span class="ident" id="1655981">nil</span><span class="op" id="1655984">,</span>&nbsp;<span class="ident" id="1655986"><a href="/syscall/netlink_linux.go.html#1655904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1655991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1655994">defer</span>&nbsp;<span class="ident" id="1656000"><a href="/syscall/zsyscall_linux_amd64.go.html#1772074">Close</a></span><span class="op" id="1656005">(</span><span class="ident" id="1656006"><a href="/syscall/netlink_linux.go.html#1655901">s</a></span><span class="op" id="1656007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1656010">lsa</span>&nbsp;<span class="op" id="1656014">:=</span>&nbsp;<span class="op" id="1656017">&amp;</span><span class="ident" id="1656018"><a href="/syscall/syscall_linux.go.html#1674711">SockaddrNetlink</a></span><span class="op" id="1656033">{</span><span class="ident" id="1656034">Family</span><span class="op" id="1656040">:</span>&nbsp;<span class="ident" id="1656042"><a href="/syscall/zerrors_linux_amd64.go.html#1707038">AF_NETLINK</a></span><span class="op" id="1656052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656055">if</span>&nbsp;<span class="ident" id="1656058">err</span>&nbsp;<span class="op" id="1656062">:=</span>&nbsp;<span class="ident" id="1656065"><a href="/syscall/syscall_unix.go.html#1702797">Bind</a></span><span class="op" id="1656069">(</span><span class="ident" id="1656070"><a href="/syscall/netlink_linux.go.html#1655901">s</a></span><span class="op" id="1656071">,</span>&nbsp;<span class="ident" id="1656073"><a href="/syscall/netlink_linux.go.html#1656010">lsa</a></span><span class="op" id="1656076">)</span><span class="op" id="1656077">;</span>&nbsp;<span class="ident" id="1656079"><a href="/syscall/netlink_linux.go.html#1656058">err</a></span>&nbsp;<span class="op" id="1656083">!=</span>&nbsp;<span class="ident" id="1656086">nil</span>&nbsp;<span class="op" id="1656090">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656094">return</span>&nbsp;<span class="ident" id="1656101">nil</span><span class="op" id="1656104">,</span>&nbsp;<span class="ident" id="1656106"><a href="/syscall/netlink_linux.go.html#1656058">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1656114">wb</span>&nbsp;<span class="op" id="1656117">:=</span>&nbsp;<span class="ident" id="1656120"><a href="/syscall/netlink_linux.go.html#1655399">newNetlinkRouteRequest</a></span><span class="op" id="1656142">(</span><span class="ident" id="1656143"><a href="/syscall/netlink_linux.go.html#1655863">proto</a></span><span class="op" id="1656148">,</span>&nbsp;<span class="num" id="1656150">1</span><span class="op" id="1656151">,</span>&nbsp;<span class="ident" id="1656153"><a href="/syscall/netlink_linux.go.html#1655870">family</a></span><span class="op" id="1656159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656162">if</span>&nbsp;<span class="ident" id="1656165">err</span>&nbsp;<span class="op" id="1656169">:=</span>&nbsp;<span class="ident" id="1656172"><a href="/syscall/syscall_unix.go.html#1703768">Sendto</a></span><span class="op" id="1656178">(</span><span class="ident" id="1656179"><a href="/syscall/netlink_linux.go.html#1655901">s</a></span><span class="op" id="1656180">,</span>&nbsp;<span class="ident" id="1656182"><a href="/syscall/netlink_linux.go.html#1656114">wb</a></span><span class="op" id="1656184">,</span>&nbsp;<span class="num" id="1656186">0</span><span class="op" id="1656187">,</span>&nbsp;<span class="ident" id="1656189"><a href="/syscall/netlink_linux.go.html#1656010">lsa</a></span><span class="op" id="1656192">)</span><span class="op" id="1656193">;</span>&nbsp;<span class="ident" id="1656195"><a href="/syscall/netlink_linux.go.html#1656165">err</a></span>&nbsp;<span class="op" id="1656199">!=</span>&nbsp;<span class="ident" id="1656202">nil</span>&nbsp;<span class="op" id="1656206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656210">return</span>&nbsp;<span class="ident" id="1656217">nil</span><span class="op" id="1656220">,</span>&nbsp;<span class="ident" id="1656222"><a href="/syscall/netlink_linux.go.html#1656165">err</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656230">var</span>&nbsp;<span class="ident" id="1656234">tab</span>&nbsp;<span class="op" id="1656238">[</span><span class="op" id="1656239">]</span><span class="builtintype" id="1656240">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1656246">rbNew</span>&nbsp;<span class="op" id="1656252">:=</span>&nbsp;<span class="builtinfunc" id="1656255">make</span><span class="op" id="1656259">(</span><span class="op" id="1656260">[</span><span class="op" id="1656261">]</span><span class="builtintype" id="1656262">byte</span><span class="op" id="1656266">,</span>&nbsp;<span class="ident" id="1656268"><a href="/syscall/syscall_linux_amd64.go.html#1697511">Getpagesize</a></span><span class="op" id="1656279">(</span><span class="op" id="1656280">)</span><span class="op" id="1656281">)</span><br>
<span class="lineno"></span><span class="ident" id="1656283">done</span><span class="op" id="1656287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656290">for</span>&nbsp;<span class="op" id="1656294">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1656298">rb</span>&nbsp;<span class="op" id="1656301">:=</span>&nbsp;<span class="ident" id="1656304"><a href="/syscall/netlink_linux.go.html#1656246">rbNew</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1656312">nr</span><span class="op" id="1656314">,</span>&nbsp;<span class="ident" id="1656316">_</span><span class="op" id="1656317">,</span>&nbsp;<span class="ident" id="1656319">err</span>&nbsp;<span class="op" id="1656323">:=</span>&nbsp;<span class="ident" id="1656326"><a href="/syscall/syscall_unix.go.html#1703470">Recvfrom</a></span><span class="op" id="1656334">(</span><span class="ident" id="1656335"><a href="/syscall/netlink_linux.go.html#1655901">s</a></span><span class="op" id="1656336">,</span>&nbsp;<span class="ident" id="1656338"><a href="/syscall/netlink_linux.go.html#1656298">rb</a></span><span class="op" id="1656340">,</span>&nbsp;<span class="num" id="1656342">0</span><span class="op" id="1656343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656347">if</span>&nbsp;<span class="ident" id="1656350"><a href="/syscall/netlink_linux.go.html#1656319">err</a></span>&nbsp;<span class="op" id="1656354">!=</span>&nbsp;<span class="ident" id="1656357">nil</span>&nbsp;<span class="op" id="1656361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656366">return</span>&nbsp;<span class="ident" id="1656373">nil</span><span class="op" id="1656376">,</span>&nbsp;<span class="ident" id="1656378"><a href="/syscall/netlink_linux.go.html#1656319">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656384">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656388">if</span>&nbsp;<span class="ident" id="1656391"><a href="/syscall/netlink_linux.go.html#1656312">nr</a></span>&nbsp;<span class="op" id="1656394">&lt;</span>&nbsp;<span class="ident" id="1656396"><a href="/syscall/zerrors_linux_amd64.go.html#1731558">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="1656409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656414">return</span>&nbsp;<span class="ident" id="1656421">nil</span><span class="op" id="1656424">,</span>&nbsp;<span class="ident" id="1656426"><a href="/syscall/zerrors_linux_amd64.go.html#1756680">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1656439"><a href="/syscall/netlink_linux.go.html#1656298">rb</a></span>&nbsp;<span class="op" id="1656442">=</span>&nbsp;<span class="ident" id="1656444"><a href="/syscall/netlink_linux.go.html#1656298">rb</a></span><span class="op" id="1656446">[</span><span class="op" id="1656447">:</span><span class="ident" id="1656448"><a href="/syscall/netlink_linux.go.html#1656312">nr</a></span><span class="op" id="1656450">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1656454"><a href="/syscall/netlink_linux.go.html#1656234">tab</a></span>&nbsp;<span class="op" id="1656458">=</span>&nbsp;<span class="builtinfunc" id="1656460">append</span><span class="op" id="1656466">(</span><span class="ident" id="1656467"><a href="/syscall/netlink_linux.go.html#1656234">tab</a></span><span class="op" id="1656470">,</span>&nbsp;<span class="ident" id="1656472"><a href="/syscall/netlink_linux.go.html#1656298">rb</a></span><span class="op" id="1656474">...</span><span class="op" id="1656477">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1656481">msgs</span><span class="op" id="1656485">,</span>&nbsp;<span class="ident" id="1656487"><a href="/syscall/netlink_linux.go.html#1656319">err</a></span>&nbsp;<span class="op" id="1656491">:=</span>&nbsp;<span class="ident" id="1656494"><a href="/syscall/netlink_linux.go.html#1657232">ParseNetlinkMessage</a></span><span class="op" id="1656513">(</span><span class="ident" id="1656514"><a href="/syscall/netlink_linux.go.html#1656298">rb</a></span><span class="op" id="1656516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656520">if</span>&nbsp;<span class="ident" id="1656523"><a href="/syscall/netlink_linux.go.html#1656319">err</a></span>&nbsp;<span class="op" id="1656527">!=</span>&nbsp;<span class="ident" id="1656530">nil</span>&nbsp;<span class="op" id="1656534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656539">return</span>&nbsp;<span class="ident" id="1656546">nil</span><span class="op" id="1656549">,</span>&nbsp;<span class="ident" id="1656551"><a href="/syscall/netlink_linux.go.html#1656319">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656561">for</span>&nbsp;<span class="ident" id="1656565">_</span><span class="op" id="1656566">,</span>&nbsp;<span class="ident" id="1656568">m</span>&nbsp;<span class="op" id="1656570">:=</span>&nbsp;<span class="keyword" id="1656573">range</span>&nbsp;<span class="ident" id="1656579"><a href="/syscall/netlink_linux.go.html#1656481">msgs</a></span>&nbsp;<span class="op" id="1656584">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1656589">lsa</span><span class="op" id="1656592">,</span>&nbsp;<span class="ident" id="1656594">err</span>&nbsp;<span class="op" id="1656598">:=</span>&nbsp;<span class="ident" id="1656601"><a href="/syscall/syscall_linux.go.html#1677612">Getsockname</a></span><span class="op" id="1656612">(</span><span class="ident" id="1656613"><a href="/syscall/netlink_linux.go.html#1655901">s</a></span><span class="op" id="1656614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656619">if</span>&nbsp;<span class="ident" id="1656622"><a href="/syscall/netlink_linux.go.html#1656594">err</a></span>&nbsp;<span class="op" id="1656626">!=</span>&nbsp;<span class="ident" id="1656629">nil</span>&nbsp;<span class="op" id="1656633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656639">return</span>&nbsp;<span class="ident" id="1656646">nil</span><span class="op" id="1656649">,</span>&nbsp;<span class="ident" id="1656651"><a href="/syscall/netlink_linux.go.html#1656594">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656663">switch</span>&nbsp;<span class="ident" id="1656670">v</span>&nbsp;<span class="op" id="1656672">:=</span>&nbsp;<span class="ident" id="1656675"><a href="/syscall/netlink_linux.go.html#1656589">lsa</a></span><span class="op" id="1656678">.</span><span class="op" id="1656679">(</span><span class="keyword" id="1656680">type</span><span class="op" id="1656684">)</span>&nbsp;<span class="op" id="1656686">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656691">case</span>&nbsp;<span class="op" id="1656696">*</span><span class="ident" id="1656697"><a href="/syscall/syscall_linux.go.html#1674711">SockaddrNetlink</a></span><span class="op" id="1656712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656718">if</span>&nbsp;<span class="ident" id="1656721"><a href="/syscall/netlink_linux.go.html#1656568">m</a></span><span class="op" id="1656722">.</span><span class="ident" id="1656723">Header</span><span class="op" id="1656729">.</span><span class="ident" id="1656730">Seq</span>&nbsp;<span class="op" id="1656734">!=</span>&nbsp;<span class="num" id="1656737">1</span>&nbsp;<span class="op" id="1656739">||</span>&nbsp;<span class="ident" id="1656742"><a href="/syscall/netlink_linux.go.html#1656568">m</a></span><span class="op" id="1656743">.</span><span class="ident" id="1656744">Header</span><span class="op" id="1656750">.</span><span class="ident" id="1656751">Pid</span>&nbsp;<span class="op" id="1656755">!=</span>&nbsp;<span class="ident" id="1656758"><a href="/syscall/netlink_linux.go.html#1656670">v</a></span><span class="op" id="1656759">.</span><span class="ident" id="1656760">Pid</span>&nbsp;<span class="op" id="1656764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656771">return</span>&nbsp;<span class="ident" id="1656778">nil</span><span class="op" id="1656781">,</span>&nbsp;<span class="ident" id="1656783"><a href="/syscall/zerrors_linux_amd64.go.html#1756680">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656799">default</span><span class="op" id="1656806">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656812">return</span>&nbsp;<span class="ident" id="1656819">nil</span><span class="op" id="1656822">,</span>&nbsp;<span class="ident" id="1656824"><a href="/syscall/zerrors_linux_amd64.go.html#1756680">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656839">if</span>&nbsp;<span class="ident" id="1656842"><a href="/syscall/netlink_linux.go.html#1656568">m</a></span><span class="op" id="1656843">.</span><span class="ident" id="1656844">Header</span><span class="op" id="1656850">.</span><span class="ident" id="1656851">Type</span>&nbsp;<span class="op" id="1656856">==</span>&nbsp;<span class="ident" id="1656859"><a href="/syscall/zerrors_linux_amd64.go.html#1731478">NLMSG_DONE</a></span>&nbsp;<span class="op" id="1656870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656876">break</span>&nbsp;<span class="ident" id="1656882">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656890">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656895">if</span>&nbsp;<span class="ident" id="1656898"><a href="/syscall/netlink_linux.go.html#1656568">m</a></span><span class="op" id="1656899">.</span><span class="ident" id="1656900">Header</span><span class="op" id="1656906">.</span><span class="ident" id="1656907">Type</span>&nbsp;<span class="op" id="1656912">==</span>&nbsp;<span class="ident" id="1656915"><a href="/syscall/zerrors_linux_amd64.go.html#1731518">NLMSG_ERROR</a></span>&nbsp;<span class="op" id="1656927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656933">return</span>&nbsp;<span class="ident" id="1656940">nil</span><span class="op" id="1656943">,</span>&nbsp;<span class="ident" id="1656945"><a href="/syscall/zerrors_linux_amd64.go.html#1756680">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1656962">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1656965">return</span>&nbsp;<span class="ident" id="1656972"><a href="/syscall/netlink_linux.go.html#1656234">tab</a></span><span class="op" id="1656975">,</span>&nbsp;<span class="ident" id="1656977">nil</span><br>
<span class="lineno"></span><span class="op" id="1656981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1656984">//&nbsp;NetlinkMessage&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="1657032">type</span>&nbsp;<span class="ident" id="1657037">NetlinkMessage</span>&nbsp;<span class="keyword" id="1657052">struct</span>&nbsp;<span class="op" id="1657059">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1657062">Header</span>&nbsp;<span class="ident" id="1657069"><a href="/syscall/ztypes_linux_amd64.go.html#1829293">NlMsghdr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1657079">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1657086">[</span><span class="op" id="1657087">]</span><span class="builtintype" id="1657088">byte</span><br>
<span class="lineno"></span><span class="op" id="1657093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1657096">//&nbsp;ParseNetlinkMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink&nbsp;messages&nbsp;and</span><br>
<span class="lineno">115</span><span class="comment" id="1657164">//&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the&nbsp;NetlinkMessage&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="1657227">func</span>&nbsp;<span class="ident" id="1657232">ParseNetlinkMessage</span><span class="op" id="1657251">(</span><span class="ident" id="1657252">b</span>&nbsp;<span class="op" id="1657254">[</span><span class="op" id="1657255">]</span><span class="builtintype" id="1657256">byte</span><span class="op" id="1657260">)</span>&nbsp;<span class="op" id="1657262">(</span><span class="op" id="1657263">[</span><span class="op" id="1657264">]</span><span class="ident" id="1657265"><a href="/syscall/netlink_linux.go.html#1657037">NetlinkMessage</a></span><span class="op" id="1657279">,</span>&nbsp;<span class="builtintype" id="1657281">error</span><span class="op" id="1657286">)</span>&nbsp;<span class="op" id="1657288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1657291">var</span>&nbsp;<span class="ident" id="1657295">msgs</span>&nbsp;<span class="op" id="1657300">[</span><span class="op" id="1657301">]</span><span class="ident" id="1657302"><a href="/syscall/netlink_linux.go.html#1657037">NetlinkMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1657318">for</span>&nbsp;<span class="builtinfunc" id="1657322">len</span><span class="op" id="1657325">(</span><span class="ident" id="1657326"><a href="/syscall/netlink_linux.go.html#1657252">b</a></span><span class="op" id="1657327">)</span>&nbsp;<span class="op" id="1657329">&gt;=</span>&nbsp;<span class="ident" id="1657332"><a href="/syscall/zerrors_linux_amd64.go.html#1731558">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="1657345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1657349">h</span><span class="op" id="1657350">,</span>&nbsp;<span class="ident" id="1657352">dbuf</span><span class="op" id="1657356">,</span>&nbsp;<span class="ident" id="1657358">dlen</span><span class="op" id="1657362">,</span>&nbsp;<span class="ident" id="1657364">err</span>&nbsp;<span class="op" id="1657368">:=</span>&nbsp;<span class="ident" id="1657371"><a href="/syscall/netlink_linux.go.html#1657584">netlinkMessageHeaderAndData</a></span><span class="op" id="1657398">(</span><span class="ident" id="1657399"><a href="/syscall/netlink_linux.go.html#1657252">b</a></span><span class="op" id="1657400">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1657404">if</span>&nbsp;<span class="ident" id="1657407"><a href="/syscall/netlink_linux.go.html#1657364">err</a></span>&nbsp;<span class="op" id="1657411">!=</span>&nbsp;<span class="ident" id="1657414">nil</span>&nbsp;<span class="op" id="1657418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1657423">return</span>&nbsp;<span class="ident" id="1657430">nil</span><span class="op" id="1657433">,</span>&nbsp;<span class="ident" id="1657435"><a href="/syscall/netlink_linux.go.html#1657364">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1657441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1657445">m</span>&nbsp;<span class="op" id="1657447">:=</span>&nbsp;<span class="ident" id="1657450"><a href="/syscall/netlink_linux.go.html#1657037">NetlinkMessage</a></span><span class="op" id="1657464">{</span><span class="ident" id="1657465">Header</span><span class="op" id="1657471">:</span>&nbsp;<span class="op" id="1657473">*</span><span class="ident" id="1657474"><a href="/syscall/netlink_linux.go.html#1657349">h</a></span><span class="op" id="1657475">,</span>&nbsp;<span class="ident" id="1657477">Data</span><span class="op" id="1657481">:</span>&nbsp;<span class="ident" id="1657483"><a href="/syscall/netlink_linux.go.html#1657352">dbuf</a></span><span class="op" id="1657487">[</span><span class="op" id="1657488">:</span><span class="builtintype" id="1657489">int</span><span class="op" id="1657492">(</span><span class="ident" id="1657493"><a href="/syscall/netlink_linux.go.html#1657349">h</a></span><span class="op" id="1657494">.</span><span class="ident" id="1657495">Len</span><span class="op" id="1657498">)</span><span class="op" id="1657499">-</span><span class="ident" id="1657500"><a href="/syscall/zerrors_linux_amd64.go.html#1731558">NLMSG_HDRLEN</a></span><span class="op" id="1657512">]</span><span class="op" id="1657513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1657517"><a href="/syscall/netlink_linux.go.html#1657295">msgs</a></span>&nbsp;<span class="op" id="1657522">=</span>&nbsp;<span class="builtinfunc" id="1657524">append</span><span class="op" id="1657530">(</span><span class="ident" id="1657531"><a href="/syscall/netlink_linux.go.html#1657295">msgs</a></span><span class="op" id="1657535">,</span>&nbsp;<span class="ident" id="1657537"><a href="/syscall/netlink_linux.go.html#1657445">m</a></span><span class="op" id="1657538">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1657542"><a href="/syscall/netlink_linux.go.html#1657252">b</a></span>&nbsp;<span class="op" id="1657544">=</span>&nbsp;<span class="ident" id="1657546"><a href="/syscall/netlink_linux.go.html#1657252">b</a></span><span class="op" id="1657547">[</span><span class="ident" id="1657548"><a href="/syscall/netlink_linux.go.html#1657358">dlen</a></span><span class="op" id="1657552">:</span><span class="op" id="1657553">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1657556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1657559">return</span>&nbsp;<span class="ident" id="1657566"><a href="/syscall/netlink_linux.go.html#1657295">msgs</a></span><span class="op" id="1657570">,</span>&nbsp;<span class="ident" id="1657572">nil</span><br>
<span class="lineno"></span><span class="op" id="1657576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="1657579">func</span>&nbsp;<span class="ident" id="1657584">netlinkMessageHeaderAndData</span><span class="op" id="1657611">(</span><span class="ident" id="1657612">b</span>&nbsp;<span class="op" id="1657614">[</span><span class="op" id="1657615">]</span><span class="builtintype" id="1657616">byte</span><span class="op" id="1657620">)</span>&nbsp;<span class="op" id="1657622">(</span><span class="op" id="1657623">*</span><span class="ident" id="1657624"><a href="/syscall/ztypes_linux_amd64.go.html#1829293">NlMsghdr</a></span><span class="op" id="1657632">,</span>&nbsp;<span class="op" id="1657634">[</span><span class="op" id="1657635">]</span><span class="builtintype" id="1657636">byte</span><span class="op" id="1657640">,</span>&nbsp;<span class="builtintype" id="1657642">int</span><span class="op" id="1657645">,</span>&nbsp;<span class="builtintype" id="1657647">error</span><span class="op" id="1657652">)</span>&nbsp;<span class="op" id="1657654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1657657">h</span>&nbsp;<span class="op" id="1657659">:=</span>&nbsp;<span class="op" id="1657662">(</span><span class="op" id="1657663">*</span><span class="ident" id="1657664"><a href="/syscall/ztypes_linux_amd64.go.html#1829293">NlMsghdr</a></span><span class="op" id="1657672">)</span><span class="op" id="1657673">(</span><span class="ident" id="1657674"><a href="/syscall/netlink_linux.go.html#1654453">unsafe</a></span><span class="op" id="1657680">.</span><span class="ident" id="1657681">Pointer</span><span class="op" id="1657688">(</span><span class="op" id="1657689">&amp;</span><span class="ident" id="1657690"><a href="/syscall/netlink_linux.go.html#1657612">b</a></span><span class="op" id="1657691">[</span><span class="num" id="1657692">0</span><span class="op" id="1657693">]</span><span class="op" id="1657694">)</span><span class="op" id="1657695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1657698">if</span>&nbsp;<span class="builtintype" id="1657701">int</span><span class="op" id="1657704">(</span><span class="ident" id="1657705"><a href="/syscall/netlink_linux.go.html#1657657">h</a></span><span class="op" id="1657706">.</span><span class="ident" id="1657707">Len</span><span class="op" id="1657710">)</span>&nbsp;<span class="op" id="1657712">&lt;</span>&nbsp;<span class="ident" id="1657714"><a href="/syscall/zerrors_linux_amd64.go.html#1731558">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="1657727">||</span>&nbsp;<span class="builtintype" id="1657730">int</span><span class="op" id="1657733">(</span><span class="ident" id="1657734"><a href="/syscall/netlink_linux.go.html#1657657">h</a></span><span class="op" id="1657735">.</span><span class="ident" id="1657736">Len</span><span class="op" id="1657739">)</span>&nbsp;<span class="op" id="1657741">&gt;</span>&nbsp;<span class="builtinfunc" id="1657743">len</span><span class="op" id="1657746">(</span><span class="ident" id="1657747"><a href="/syscall/netlink_linux.go.html#1657612">b</a></span><span class="op" id="1657748">)</span>&nbsp;<span class="op" id="1657750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1657754">return</span>&nbsp;<span class="ident" id="1657761">nil</span><span class="op" id="1657764">,</span>&nbsp;<span class="ident" id="1657766">nil</span><span class="op" id="1657769">,</span>&nbsp;<span class="num" id="1657771">0</span><span class="op" id="1657772">,</span>&nbsp;<span class="ident" id="1657774"><a href="/syscall/zerrors_linux_amd64.go.html#1756680">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1657782">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1657785">return</span>&nbsp;<span class="ident" id="1657792"><a href="/syscall/netlink_linux.go.html#1657657">h</a></span><span class="op" id="1657793">,</span>&nbsp;<span class="ident" id="1657795"><a href="/syscall/netlink_linux.go.html#1657612">b</a></span><span class="op" id="1657796">[</span><span class="ident" id="1657797"><a href="/syscall/zerrors_linux_amd64.go.html#1731558">NLMSG_HDRLEN</a></span><span class="op" id="1657809">:</span><span class="op" id="1657810">]</span><span class="op" id="1657811">,</span>&nbsp;<span class="ident" id="1657813"><a href="/syscall/netlink_linux.go.html#1654534">nlmAlignOf</a></span><span class="op" id="1657823">(</span><span class="builtintype" id="1657824">int</span><span class="op" id="1657827">(</span><span class="ident" id="1657828"><a href="/syscall/netlink_linux.go.html#1657657">h</a></span><span class="op" id="1657829">.</span><span class="ident" id="1657830">Len</span><span class="op" id="1657833">)</span><span class="op" id="1657834">)</span><span class="op" id="1657835">,</span>&nbsp;<span class="ident" id="1657837">nil</span><br>
<span class="lineno"></span><span class="op" id="1657841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1657844">//&nbsp;NetlinkRouteAttr&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="1657902">type</span>&nbsp;<span class="ident" id="1657907">NetlinkRouteAttr</span>&nbsp;<span class="keyword" id="1657924">struct</span>&nbsp;<span class="op" id="1657931">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1657934">Attr</span>&nbsp;&nbsp;<span class="ident" id="1657940"><a href="/syscall/ztypes_linux_amd64.go.html#1829534">RtAttr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1657948">Value</span>&nbsp;<span class="op" id="1657954">[</span><span class="op" id="1657955">]</span><span class="builtintype" id="1657956">byte</span><br>
<span class="lineno"></span><span class="op" id="1657961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1657964">//&nbsp;ParseNetlinkRouteAttr&nbsp;parses&nbsp;m&#39;s&nbsp;payload&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink</span><br>
<span class="lineno">145</span><span class="comment" id="1658031">//&nbsp;route&nbsp;attributes&nbsp;and&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1658088">//&nbsp;NetlinkRouteAttr&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="1658120">func</span>&nbsp;<span class="ident" id="1658125">ParseNetlinkRouteAttr</span><span class="op" id="1658146">(</span><span class="ident" id="1658147">m</span>&nbsp;<span class="op" id="1658149">*</span><span class="ident" id="1658150"><a href="/syscall/netlink_linux.go.html#1657037">NetlinkMessage</a></span><span class="op" id="1658164">)</span>&nbsp;<span class="op" id="1658166">(</span><span class="op" id="1658167">[</span><span class="op" id="1658168">]</span><span class="ident" id="1658169"><a href="/syscall/netlink_linux.go.html#1657907">NetlinkRouteAttr</a></span><span class="op" id="1658185">,</span>&nbsp;<span class="builtintype" id="1658187">error</span><span class="op" id="1658192">)</span>&nbsp;<span class="op" id="1658194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658197">var</span>&nbsp;<span class="ident" id="1658201">b</span>&nbsp;<span class="op" id="1658203">[</span><span class="op" id="1658204">]</span><span class="builtintype" id="1658205">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658211">switch</span>&nbsp;<span class="ident" id="1658218"><a href="/syscall/netlink_linux.go.html#1658147">m</a></span><span class="op" id="1658219">.</span><span class="ident" id="1658220">Header</span><span class="op" id="1658226">.</span><span class="ident" id="1658227">Type</span>&nbsp;<span class="op" id="1658232">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658235">case</span>&nbsp;<span class="ident" id="1658240"><a href="/syscall/zerrors_linux_amd64.go.html#1742535">RTM_NEWLINK</a></span><span class="op" id="1658251">,</span>&nbsp;<span class="ident" id="1658253"><a href="/syscall/zerrors_linux_amd64.go.html#1741342">RTM_DELLINK</a></span><span class="op" id="1658264">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1658268"><a href="/syscall/netlink_linux.go.html#1658201">b</a></span>&nbsp;<span class="op" id="1658270">=</span>&nbsp;<span class="ident" id="1658272"><a href="/syscall/netlink_linux.go.html#1658147">m</a></span><span class="op" id="1658273">.</span><span class="ident" id="1658274">Data</span><span class="op" id="1658278">[</span><span class="ident" id="1658279"><a href="/syscall/ztypes_linux_amd64.go.html#1829177">SizeofIfInfomsg</a></span><span class="op" id="1658294">:</span><span class="op" id="1658295">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658298">case</span>&nbsp;<span class="ident" id="1658303"><a href="/syscall/zerrors_linux_amd64.go.html#1742453">RTM_NEWADDR</a></span><span class="op" id="1658314">,</span>&nbsp;<span class="ident" id="1658316"><a href="/syscall/zerrors_linux_amd64.go.html#1741260">RTM_DELADDR</a></span><span class="op" id="1658327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1658331"><a href="/syscall/netlink_linux.go.html#1658201">b</a></span>&nbsp;<span class="op" id="1658333">=</span>&nbsp;<span class="ident" id="1658335"><a href="/syscall/netlink_linux.go.html#1658147">m</a></span><span class="op" id="1658336">.</span><span class="ident" id="1658337">Data</span><span class="op" id="1658341">[</span><span class="ident" id="1658342"><a href="/syscall/ztypes_linux_amd64.go.html#1829205">SizeofIfAddrmsg</a></span><span class="op" id="1658357">:</span><span class="op" id="1658358">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658361">case</span>&nbsp;<span class="ident" id="1658366"><a href="/syscall/zerrors_linux_amd64.go.html#1742781">RTM_NEWROUTE</a></span><span class="op" id="1658378">,</span>&nbsp;<span class="ident" id="1658380"><a href="/syscall/zerrors_linux_amd64.go.html#1741465">RTM_DELROUTE</a></span><span class="op" id="1658392">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1658396"><a href="/syscall/netlink_linux.go.html#1658201">b</a></span>&nbsp;<span class="op" id="1658398">=</span>&nbsp;<span class="ident" id="1658400"><a href="/syscall/netlink_linux.go.html#1658147">m</a></span><span class="op" id="1658401">.</span><span class="ident" id="1658402">Data</span><span class="op" id="1658406">[</span><span class="ident" id="1658407"><a href="/syscall/ztypes_linux_amd64.go.html#1829232">SizeofRtMsg</a></span><span class="op" id="1658418">:</span><span class="op" id="1658419">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658422">default</span><span class="op" id="1658429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658433">return</span>&nbsp;<span class="ident" id="1658440">nil</span><span class="op" id="1658443">,</span>&nbsp;<span class="ident" id="1658445"><a href="/syscall/zerrors_linux_amd64.go.html#1756680">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1658453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658456">var</span>&nbsp;<span class="ident" id="1658460">attrs</span>&nbsp;<span class="op" id="1658466">[</span><span class="op" id="1658467">]</span><span class="ident" id="1658468"><a href="/syscall/netlink_linux.go.html#1657907">NetlinkRouteAttr</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658486">for</span>&nbsp;<span class="builtinfunc" id="1658490">len</span><span class="op" id="1658493">(</span><span class="ident" id="1658494"><a href="/syscall/netlink_linux.go.html#1658201">b</a></span><span class="op" id="1658495">)</span>&nbsp;<span class="op" id="1658497">&gt;=</span>&nbsp;<span class="ident" id="1658500"><a href="/syscall/ztypes_linux_amd64.go.html#1829150">SizeofRtAttr</a></span>&nbsp;<span class="op" id="1658513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1658517">a</span><span class="op" id="1658518">,</span>&nbsp;<span class="ident" id="1658520">vbuf</span><span class="op" id="1658524">,</span>&nbsp;<span class="ident" id="1658526">alen</span><span class="op" id="1658530">,</span>&nbsp;<span class="ident" id="1658532">err</span>&nbsp;<span class="op" id="1658536">:=</span>&nbsp;<span class="ident" id="1658539"><a href="/syscall/netlink_linux.go.html#1658755">netlinkRouteAttrAndValue</a></span><span class="op" id="1658563">(</span><span class="ident" id="1658564"><a href="/syscall/netlink_linux.go.html#1658201">b</a></span><span class="op" id="1658565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658569">if</span>&nbsp;<span class="ident" id="1658572"><a href="/syscall/netlink_linux.go.html#1658532">err</a></span>&nbsp;<span class="op" id="1658576">!=</span>&nbsp;<span class="ident" id="1658579">nil</span>&nbsp;<span class="op" id="1658583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658588">return</span>&nbsp;<span class="ident" id="1658595">nil</span><span class="op" id="1658598">,</span>&nbsp;<span class="ident" id="1658600"><a href="/syscall/netlink_linux.go.html#1658532">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1658606">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1658610">ra</span>&nbsp;<span class="op" id="1658613">:=</span>&nbsp;<span class="ident" id="1658616"><a href="/syscall/netlink_linux.go.html#1657907">NetlinkRouteAttr</a></span><span class="op" id="1658632">{</span><span class="ident" id="1658633">Attr</span><span class="op" id="1658637">:</span>&nbsp;<span class="op" id="1658639">*</span><span class="ident" id="1658640"><a href="/syscall/netlink_linux.go.html#1658517">a</a></span><span class="op" id="1658641">,</span>&nbsp;<span class="ident" id="1658643">Value</span><span class="op" id="1658648">:</span>&nbsp;<span class="ident" id="1658650"><a href="/syscall/netlink_linux.go.html#1658520">vbuf</a></span><span class="op" id="1658654">[</span><span class="op" id="1658655">:</span><span class="builtintype" id="1658656">int</span><span class="op" id="1658659">(</span><span class="ident" id="1658660"><a href="/syscall/netlink_linux.go.html#1658517">a</a></span><span class="op" id="1658661">.</span><span class="ident" id="1658662">Len</span><span class="op" id="1658665">)</span><span class="op" id="1658666">-</span><span class="ident" id="1658667"><a href="/syscall/ztypes_linux_amd64.go.html#1829150">SizeofRtAttr</a></span><span class="op" id="1658679">]</span><span class="op" id="1658680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1658684"><a href="/syscall/netlink_linux.go.html#1658460">attrs</a></span>&nbsp;<span class="op" id="1658690">=</span>&nbsp;<span class="builtinfunc" id="1658692">append</span><span class="op" id="1658698">(</span><span class="ident" id="1658699"><a href="/syscall/netlink_linux.go.html#1658460">attrs</a></span><span class="op" id="1658704">,</span>&nbsp;<span class="ident" id="1658706"><a href="/syscall/netlink_linux.go.html#1658610">ra</a></span><span class="op" id="1658708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1658712"><a href="/syscall/netlink_linux.go.html#1658201">b</a></span>&nbsp;<span class="op" id="1658714">=</span>&nbsp;<span class="ident" id="1658716"><a href="/syscall/netlink_linux.go.html#1658201">b</a></span><span class="op" id="1658717">[</span><span class="ident" id="1658718"><a href="/syscall/netlink_linux.go.html#1658526">alen</a></span><span class="op" id="1658722">:</span><span class="op" id="1658723">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1658726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658729">return</span>&nbsp;<span class="ident" id="1658736"><a href="/syscall/netlink_linux.go.html#1658460">attrs</a></span><span class="op" id="1658741">,</span>&nbsp;<span class="ident" id="1658743">nil</span><br>
<span class="lineno">170</span><span class="op" id="1658747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1658750">func</span>&nbsp;<span class="ident" id="1658755">netlinkRouteAttrAndValue</span><span class="op" id="1658779">(</span><span class="ident" id="1658780">b</span>&nbsp;<span class="op" id="1658782">[</span><span class="op" id="1658783">]</span><span class="builtintype" id="1658784">byte</span><span class="op" id="1658788">)</span>&nbsp;<span class="op" id="1658790">(</span><span class="op" id="1658791">*</span><span class="ident" id="1658792"><a href="/syscall/ztypes_linux_amd64.go.html#1829534">RtAttr</a></span><span class="op" id="1658798">,</span>&nbsp;<span class="op" id="1658800">[</span><span class="op" id="1658801">]</span><span class="builtintype" id="1658802">byte</span><span class="op" id="1658806">,</span>&nbsp;<span class="builtintype" id="1658808">int</span><span class="op" id="1658811">,</span>&nbsp;<span class="builtintype" id="1658813">error</span><span class="op" id="1658818">)</span>&nbsp;<span class="op" id="1658820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1658823">a</span>&nbsp;<span class="op" id="1658825">:=</span>&nbsp;<span class="op" id="1658828">(</span><span class="op" id="1658829">*</span><span class="ident" id="1658830"><a href="/syscall/ztypes_linux_amd64.go.html#1829534">RtAttr</a></span><span class="op" id="1658836">)</span><span class="op" id="1658837">(</span><span class="ident" id="1658838"><a href="/syscall/netlink_linux.go.html#1654453">unsafe</a></span><span class="op" id="1658844">.</span><span class="ident" id="1658845">Pointer</span><span class="op" id="1658852">(</span><span class="op" id="1658853">&amp;</span><span class="ident" id="1658854"><a href="/syscall/netlink_linux.go.html#1658780">b</a></span><span class="op" id="1658855">[</span><span class="num" id="1658856">0</span><span class="op" id="1658857">]</span><span class="op" id="1658858">)</span><span class="op" id="1658859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658862">if</span>&nbsp;<span class="builtintype" id="1658865">int</span><span class="op" id="1658868">(</span><span class="ident" id="1658869"><a href="/syscall/netlink_linux.go.html#1658823">a</a></span><span class="op" id="1658870">.</span><span class="ident" id="1658871">Len</span><span class="op" id="1658874">)</span>&nbsp;<span class="op" id="1658876">&lt;</span>&nbsp;<span class="ident" id="1658878"><a href="/syscall/ztypes_linux_amd64.go.html#1829150">SizeofRtAttr</a></span>&nbsp;<span class="op" id="1658891">||</span>&nbsp;<span class="builtintype" id="1658894">int</span><span class="op" id="1658897">(</span><span class="ident" id="1658898"><a href="/syscall/netlink_linux.go.html#1658823">a</a></span><span class="op" id="1658899">.</span><span class="ident" id="1658900">Len</span><span class="op" id="1658903">)</span>&nbsp;<span class="op" id="1658905">&gt;</span>&nbsp;<span class="builtinfunc" id="1658907">len</span><span class="op" id="1658910">(</span><span class="ident" id="1658911"><a href="/syscall/netlink_linux.go.html#1658780">b</a></span><span class="op" id="1658912">)</span>&nbsp;<span class="op" id="1658914">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658918">return</span>&nbsp;<span class="ident" id="1658925">nil</span><span class="op" id="1658928">,</span>&nbsp;<span class="ident" id="1658930">nil</span><span class="op" id="1658933">,</span>&nbsp;<span class="num" id="1658935">0</span><span class="op" id="1658936">,</span>&nbsp;<span class="ident" id="1658938"><a href="/syscall/zerrors_linux_amd64.go.html#1756680">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1658946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1658949">return</span>&nbsp;<span class="ident" id="1658956"><a href="/syscall/netlink_linux.go.html#1658823">a</a></span><span class="op" id="1658957">,</span>&nbsp;<span class="ident" id="1658959"><a href="/syscall/netlink_linux.go.html#1658780">b</a></span><span class="op" id="1658960">[</span><span class="ident" id="1658961"><a href="/syscall/ztypes_linux_amd64.go.html#1829150">SizeofRtAttr</a></span><span class="op" id="1658973">:</span><span class="op" id="1658974">]</span><span class="op" id="1658975">,</span>&nbsp;<span class="ident" id="1658977"><a href="/syscall/netlink_linux.go.html#1654708">rtaAlignOf</a></span><span class="op" id="1658987">(</span><span class="builtintype" id="1658988">int</span><span class="op" id="1658991">(</span><span class="ident" id="1658992"><a href="/syscall/netlink_linux.go.html#1658823">a</a></span><span class="op" id="1658993">.</span><span class="ident" id="1658994">Len</span><span class="op" id="1658997">)</span><span class="op" id="1658998">)</span><span class="op" id="1658999">,</span>&nbsp;<span class="ident" id="1659001">nil</span><br>
<span class="lineno"></span><span class="op" id="1659005">}</span>
</div>
</body>
</html>
