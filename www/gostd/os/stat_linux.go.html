<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html" class="current">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2526949">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2527004">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2527058">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2527109">package</span>&nbsp;<span class="ident" id="2527117">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2527121">import</span>&nbsp;<span class="op" id="2527128">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2527131">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2527142">&#34;time&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2527149">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2527152">func</span>&nbsp;<span class="ident" id="2527157">sameFile</span><span class="op" id="2527165">(</span><span class="ident" id="2527166">fs1</span><span class="op" id="2527169">,</span>&nbsp;<span class="ident" id="2527171">fs2</span>&nbsp;<span class="op" id="2527175">*</span><span class="ident" id="2527176">fileStat</span><span class="op" id="2527184">)</span>&nbsp;<span class="builtintype" id="2527186">bool</span>&nbsp;<span class="op" id="2527191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527194">stat1</span>&nbsp;<span class="op" id="2527200">:=</span>&nbsp;<span class="ident" id="2527203">fs1</span><span class="op" id="2527206">.</span><span class="ident" id="2527207">sys</span><span class="op" id="2527210">.</span><span class="op" id="2527211">(</span><span class="op" id="2527212">*</span><span class="ident" id="2527213">syscall</span><span class="op" id="2527220">.</span><span class="ident" id="2527221">Stat_t</span><span class="op" id="2527227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527230">stat2</span>&nbsp;<span class="op" id="2527236">:=</span>&nbsp;<span class="ident" id="2527239">fs2</span><span class="op" id="2527242">.</span><span class="ident" id="2527243">sys</span><span class="op" id="2527246">.</span><span class="op" id="2527247">(</span><span class="op" id="2527248">*</span><span class="ident" id="2527249">syscall</span><span class="op" id="2527256">.</span><span class="ident" id="2527257">Stat_t</span><span class="op" id="2527263">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527266">return</span>&nbsp;<span class="ident" id="2527273">stat1</span><span class="op" id="2527278">.</span><span class="ident" id="2527279">Dev</span>&nbsp;<span class="op" id="2527283">==</span>&nbsp;<span class="ident" id="2527286">stat2</span><span class="op" id="2527291">.</span><span class="ident" id="2527292">Dev</span>&nbsp;<span class="op" id="2527296">&amp;&amp;</span>&nbsp;<span class="ident" id="2527299">stat1</span><span class="op" id="2527304">.</span><span class="ident" id="2527305">Ino</span>&nbsp;<span class="op" id="2527309">==</span>&nbsp;<span class="ident" id="2527312">stat2</span><span class="op" id="2527317">.</span><span class="ident" id="2527318">Ino</span><br>
<span class="lineno"></span><span class="op" id="2527322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2527325">func</span>&nbsp;<span class="ident" id="2527330">fileInfoFromStat</span><span class="op" id="2527346">(</span><span class="ident" id="2527347">st</span>&nbsp;<span class="op" id="2527350">*</span><span class="ident" id="2527351">syscall</span><span class="op" id="2527358">.</span><span class="ident" id="2527359">Stat_t</span><span class="op" id="2527365">,</span>&nbsp;<span class="ident" id="2527367">name</span>&nbsp;<span class="builtintype" id="2527372">string</span><span class="op" id="2527378">)</span>&nbsp;<span class="ident" id="2527380">FileInfo</span>&nbsp;<span class="op" id="2527389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527392">fs</span>&nbsp;<span class="op" id="2527395">:=</span>&nbsp;<span class="op" id="2527398">&amp;</span><span class="ident" id="2527399">fileStat</span><span class="op" id="2527407">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527411">name</span><span class="op" id="2527415">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527420">basename</span><span class="op" id="2527428">(</span><span class="ident" id="2527429">name</span><span class="op" id="2527433">)</span><span class="op" id="2527434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527438">size</span><span class="op" id="2527442">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527447">int64</span><span class="op" id="2527452">(</span><span class="ident" id="2527453">st</span><span class="op" id="2527455">.</span><span class="ident" id="2527456">Size</span><span class="op" id="2527460">)</span><span class="op" id="2527461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527465">modTime</span><span class="op" id="2527472">:</span>&nbsp;<span class="ident" id="2527474">timespecToTime</span><span class="op" id="2527488">(</span><span class="ident" id="2527489">st</span><span class="op" id="2527491">.</span><span class="ident" id="2527492">Mtim</span><span class="op" id="2527496">)</span><span class="op" id="2527497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527501">sys</span><span class="op" id="2527504">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527510">st</span><span class="op" id="2527512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2527515">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527518">fs</span><span class="op" id="2527520">.</span><span class="ident" id="2527521">mode</span>&nbsp;<span class="op" id="2527526">=</span>&nbsp;<span class="ident" id="2527528">FileMode</span><span class="op" id="2527536">(</span><span class="ident" id="2527537">st</span><span class="op" id="2527539">.</span><span class="ident" id="2527540">Mode</span>&nbsp;<span class="op" id="2527545">&amp;</span>&nbsp;<span class="num" id="2527547">0777</span><span class="op" id="2527551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527554">switch</span>&nbsp;<span class="ident" id="2527561">st</span><span class="op" id="2527563">.</span><span class="ident" id="2527564">Mode</span>&nbsp;<span class="op" id="2527569">&amp;</span>&nbsp;<span class="ident" id="2527571">syscall</span><span class="op" id="2527578">.</span><span class="ident" id="2527579">S_IFMT</span>&nbsp;<span class="op" id="2527586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527589">case</span>&nbsp;<span class="ident" id="2527594">syscall</span><span class="op" id="2527601">.</span><span class="ident" id="2527602">S_IFBLK</span><span class="op" id="2527609">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527613">fs</span><span class="op" id="2527615">.</span><span class="ident" id="2527616">mode</span>&nbsp;<span class="op" id="2527621">|=</span>&nbsp;<span class="ident" id="2527624">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527636">case</span>&nbsp;<span class="ident" id="2527641">syscall</span><span class="op" id="2527648">.</span><span class="ident" id="2527649">S_IFCHR</span><span class="op" id="2527656">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527660">fs</span><span class="op" id="2527662">.</span><span class="ident" id="2527663">mode</span>&nbsp;<span class="op" id="2527668">|=</span>&nbsp;<span class="ident" id="2527671">ModeDevice</span>&nbsp;<span class="op" id="2527682">|</span>&nbsp;<span class="ident" id="2527684">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527700">case</span>&nbsp;<span class="ident" id="2527705">syscall</span><span class="op" id="2527712">.</span><span class="ident" id="2527713">S_IFDIR</span><span class="op" id="2527720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527724">fs</span><span class="op" id="2527726">.</span><span class="ident" id="2527727">mode</span>&nbsp;<span class="op" id="2527732">|=</span>&nbsp;<span class="ident" id="2527735">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527744">case</span>&nbsp;<span class="ident" id="2527749">syscall</span><span class="op" id="2527756">.</span><span class="ident" id="2527757">S_IFIFO</span><span class="op" id="2527764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527768">fs</span><span class="op" id="2527770">.</span><span class="ident" id="2527771">mode</span>&nbsp;<span class="op" id="2527776">|=</span>&nbsp;<span class="ident" id="2527779">ModeNamedPipe</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527794">case</span>&nbsp;<span class="ident" id="2527799">syscall</span><span class="op" id="2527806">.</span><span class="ident" id="2527807">S_IFLNK</span><span class="op" id="2527814">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527818">fs</span><span class="op" id="2527820">.</span><span class="ident" id="2527821">mode</span>&nbsp;<span class="op" id="2527826">|=</span>&nbsp;<span class="ident" id="2527829">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527842">case</span>&nbsp;<span class="ident" id="2527847">syscall</span><span class="op" id="2527854">.</span><span class="ident" id="2527855">S_IFREG</span><span class="op" id="2527862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2527866">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527884">case</span>&nbsp;<span class="ident" id="2527889">syscall</span><span class="op" id="2527896">.</span><span class="ident" id="2527897">S_IFSOCK</span><span class="op" id="2527905">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527909">fs</span><span class="op" id="2527911">.</span><span class="ident" id="2527912">mode</span>&nbsp;<span class="op" id="2527917">|=</span>&nbsp;<span class="ident" id="2527920">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2527932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527935">if</span>&nbsp;<span class="ident" id="2527938">st</span><span class="op" id="2527940">.</span><span class="ident" id="2527941">Mode</span><span class="op" id="2527945">&amp;</span><span class="ident" id="2527946">syscall</span><span class="op" id="2527953">.</span><span class="ident" id="2527954">S_ISGID</span>&nbsp;<span class="op" id="2527962">!=</span>&nbsp;<span class="num" id="2527965">0</span>&nbsp;<span class="op" id="2527967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527971">fs</span><span class="op" id="2527973">.</span><span class="ident" id="2527974">mode</span>&nbsp;<span class="op" id="2527979">|=</span>&nbsp;<span class="ident" id="2527982">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2527994">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527997">if</span>&nbsp;<span class="ident" id="2528000">st</span><span class="op" id="2528002">.</span><span class="ident" id="2528003">Mode</span><span class="op" id="2528007">&amp;</span><span class="ident" id="2528008">syscall</span><span class="op" id="2528015">.</span><span class="ident" id="2528016">S_ISUID</span>&nbsp;<span class="op" id="2528024">!=</span>&nbsp;<span class="num" id="2528027">0</span>&nbsp;<span class="op" id="2528029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2528033">fs</span><span class="op" id="2528035">.</span><span class="ident" id="2528036">mode</span>&nbsp;<span class="op" id="2528041">|=</span>&nbsp;<span class="ident" id="2528044">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2528056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2528059">if</span>&nbsp;<span class="ident" id="2528062">st</span><span class="op" id="2528064">.</span><span class="ident" id="2528065">Mode</span><span class="op" id="2528069">&amp;</span><span class="ident" id="2528070">syscall</span><span class="op" id="2528077">.</span><span class="ident" id="2528078">S_ISVTX</span>&nbsp;<span class="op" id="2528086">!=</span>&nbsp;<span class="num" id="2528089">0</span>&nbsp;<span class="op" id="2528091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2528095">fs</span><span class="op" id="2528097">.</span><span class="ident" id="2528098">mode</span>&nbsp;<span class="op" id="2528103">|=</span>&nbsp;<span class="ident" id="2528106">ModeSticky</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2528118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2528121">return</span>&nbsp;<span class="ident" id="2528128">fs</span><br>
<span class="lineno"></span><span class="op" id="2528131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2528134">func</span>&nbsp;<span class="ident" id="2528139">timespecToTime</span><span class="op" id="2528153">(</span><span class="ident" id="2528154">ts</span>&nbsp;<span class="ident" id="2528157">syscall</span><span class="op" id="2528164">.</span><span class="ident" id="2528165">Timespec</span><span class="op" id="2528173">)</span>&nbsp;<span class="ident" id="2528175">time</span><span class="op" id="2528179">.</span><span class="ident" id="2528180">Time</span>&nbsp;<span class="op" id="2528185">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2528188">return</span>&nbsp;<span class="ident" id="2528195">time</span><span class="op" id="2528199">.</span><span class="ident" id="2528200">Unix</span><span class="op" id="2528204">(</span><span class="ident" id="2528205">int64</span><span class="op" id="2528210">(</span><span class="ident" id="2528211">ts</span><span class="op" id="2528213">.</span><span class="ident" id="2528214">Sec</span><span class="op" id="2528217">)</span><span class="op" id="2528218">,</span>&nbsp;<span class="ident" id="2528220">int64</span><span class="op" id="2528225">(</span><span class="ident" id="2528226">ts</span><span class="op" id="2528228">.</span><span class="ident" id="2528229">Nsec</span><span class="op" id="2528233">)</span><span class="op" id="2528234">)</span><br>
<span class="lineno"></span><span class="op" id="2528236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2528239">//&nbsp;For&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="2528255">func</span>&nbsp;<span class="ident" id="2528260">atime</span><span class="op" id="2528265">(</span><span class="ident" id="2528266">fi</span>&nbsp;<span class="ident" id="2528269">FileInfo</span><span class="op" id="2528277">)</span>&nbsp;<span class="ident" id="2528279">time</span><span class="op" id="2528283">.</span><span class="ident" id="2528284">Time</span>&nbsp;<span class="op" id="2528289">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2528292">return</span>&nbsp;<span class="ident" id="2528299">timespecToTime</span><span class="op" id="2528313">(</span><span class="ident" id="2528314">fi</span><span class="op" id="2528316">.</span><span class="ident" id="2528317">Sys</span><span class="op" id="2528320">(</span><span class="op" id="2528321">)</span><span class="op" id="2528322">.</span><span class="op" id="2528323">(</span><span class="op" id="2528324">*</span><span class="ident" id="2528325">syscall</span><span class="op" id="2528332">.</span><span class="ident" id="2528333">Stat_t</span><span class="op" id="2528339">)</span><span class="op" id="2528340">.</span><span class="ident" id="2528341">Atim</span><span class="op" id="2528345">)</span><br>
<span class="lineno"></span><span class="op" id="2528347">}</span>
</div>
</body>
</html>
