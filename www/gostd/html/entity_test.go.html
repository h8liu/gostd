<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html</h2>
<ul>
<li><a href="/gostd/html/entity.go.html">entity.go</a></li>
<li><a href="/gostd/html/entity_test.go.html" class="current">entity_test.go</a></li>
<li><a href="/gostd/html/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/escape_test.go.html">escape_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6643463">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6643518">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6643572">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6643623">package</span>&nbsp;<span class="ident" id="6643631">html</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6643637">import</span>&nbsp;<span class="op" id="6643644">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6643647">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6643658">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6643673">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6643676">func</span>&nbsp;<span class="ident" id="6643681">TestEntityLength</span><span class="op" id="6643697">(</span><span class="ident" id="6643698">t</span>&nbsp;<span class="op" id="6643700">*</span><span class="ident" id="6643701">testing</span><span class="op" id="6643708">.</span><span class="ident" id="6643709">T</span><span class="op" id="6643710">)</span>&nbsp;<span class="op" id="6643712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6643715">//&nbsp;We&nbsp;verify&nbsp;that&nbsp;the&nbsp;length&nbsp;of&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;each&nbsp;value&nbsp;is&nbsp;&lt;=&nbsp;1&nbsp;+&nbsp;len(key).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6643797">//&nbsp;The&nbsp;+1&nbsp;comes&nbsp;from&nbsp;the&nbsp;leading&nbsp;&#34;&amp;&#34;.&nbsp;This&nbsp;property&nbsp;implies&nbsp;that&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6643877">//&nbsp;unescaped&nbsp;text&nbsp;is&nbsp;&lt;=&nbsp;the&nbsp;length&nbsp;of&nbsp;escaped&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643930">for</span>&nbsp;<span class="ident" id="6643934">k</span><span class="op" id="6643935">,</span>&nbsp;<span class="ident" id="6643937">v</span>&nbsp;<span class="op" id="6643939">:=</span>&nbsp;<span class="keyword" id="6643942">range</span>&nbsp;<span class="ident" id="6643948">entity</span>&nbsp;<span class="op" id="6643955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643959">if</span>&nbsp;<span class="num" id="6643962">1</span><span class="op" id="6643963">+</span><span class="builtinfunc" id="6643964">len</span><span class="op" id="6643967">(</span><span class="ident" id="6643968">k</span><span class="op" id="6643969">)</span>&nbsp;<span class="op" id="6643971">&lt;</span>&nbsp;<span class="ident" id="6643973">utf8</span><span class="op" id="6643977">.</span><span class="ident" id="6643978">RuneLen</span><span class="op" id="6643985">(</span><span class="ident" id="6643986">v</span><span class="op" id="6643987">)</span>&nbsp;<span class="op" id="6643989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643994">t</span><span class="op" id="6643995">.</span><span class="ident" id="6643996">Error</span><span class="op" id="6644001">(</span><span class="string" id="6644002">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="6644021">+</span>&nbsp;<span class="ident" id="6644023">k</span>&nbsp;<span class="op" id="6644025">+</span>&nbsp;<span class="string" id="6644027">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="6644066">+</span>&nbsp;<span class="builtintype" id="6644068">string</span><span class="op" id="6644074">(</span><span class="ident" id="6644075">v</span><span class="op" id="6644076">)</span><span class="op" id="6644077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644081">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644085">if</span>&nbsp;<span class="builtinfunc" id="6644088">len</span><span class="op" id="6644091">(</span><span class="ident" id="6644092">k</span><span class="op" id="6644093">)</span>&nbsp;<span class="op" id="6644095">&gt;</span>&nbsp;<span class="ident" id="6644097">longestEntityWithoutSemicolon</span>&nbsp;<span class="op" id="6644127">&amp;&amp;</span>&nbsp;<span class="ident" id="6644130">k</span><span class="op" id="6644131">[</span><span class="builtinfunc" id="6644132">len</span><span class="op" id="6644135">(</span><span class="ident" id="6644136">k</span><span class="op" id="6644137">)</span><span class="op" id="6644138">-</span><span class="num" id="6644139">1</span><span class="op" id="6644140">]</span>&nbsp;<span class="op" id="6644142">!=</span>&nbsp;<span class="string" id="6644145">&#39;;&#39;</span>&nbsp;<span class="op" id="6644149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644154">t</span><span class="op" id="6644155">.</span><span class="ident" id="6644156">Errorf</span><span class="op" id="6644162">(</span><span class="string" id="6644163">&#34;entity&nbsp;name&nbsp;%s&nbsp;is&nbsp;%d&nbsp;characters,&nbsp;but&nbsp;longestEntityWithoutSemicolon=%d&#34;</span><span class="op" id="6644234">,</span>&nbsp;<span class="ident" id="6644236">k</span><span class="op" id="6644237">,</span>&nbsp;<span class="builtinfunc" id="6644239">len</span><span class="op" id="6644242">(</span><span class="ident" id="6644243">k</span><span class="op" id="6644244">)</span><span class="op" id="6644245">,</span>&nbsp;<span class="ident" id="6644247">longestEntityWithoutSemicolon</span><span class="op" id="6644276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644286">for</span>&nbsp;<span class="ident" id="6644290">k</span><span class="op" id="6644291">,</span>&nbsp;<span class="ident" id="6644293">v</span>&nbsp;<span class="op" id="6644295">:=</span>&nbsp;<span class="keyword" id="6644298">range</span>&nbsp;<span class="ident" id="6644304">entity2</span>&nbsp;<span class="op" id="6644312">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644316">if</span>&nbsp;<span class="num" id="6644319">1</span><span class="op" id="6644320">+</span><span class="builtinfunc" id="6644321">len</span><span class="op" id="6644324">(</span><span class="ident" id="6644325">k</span><span class="op" id="6644326">)</span>&nbsp;<span class="op" id="6644328">&lt;</span>&nbsp;<span class="ident" id="6644330">utf8</span><span class="op" id="6644334">.</span><span class="ident" id="6644335">RuneLen</span><span class="op" id="6644342">(</span><span class="ident" id="6644343">v</span><span class="op" id="6644344">[</span><span class="num" id="6644345">0</span><span class="op" id="6644346">]</span><span class="op" id="6644347">)</span><span class="op" id="6644348">+</span><span class="ident" id="6644349">utf8</span><span class="op" id="6644353">.</span><span class="ident" id="6644354">RuneLen</span><span class="op" id="6644361">(</span><span class="ident" id="6644362">v</span><span class="op" id="6644363">[</span><span class="num" id="6644364">1</span><span class="op" id="6644365">]</span><span class="op" id="6644366">)</span>&nbsp;<span class="op" id="6644368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644373">t</span><span class="op" id="6644374">.</span><span class="ident" id="6644375">Error</span><span class="op" id="6644380">(</span><span class="string" id="6644381">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="6644400">+</span>&nbsp;<span class="ident" id="6644402">k</span>&nbsp;<span class="op" id="6644404">+</span>&nbsp;<span class="string" id="6644406">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="6644445">+</span>&nbsp;<span class="builtintype" id="6644447">string</span><span class="op" id="6644453">(</span><span class="ident" id="6644454">v</span><span class="op" id="6644455">[</span><span class="num" id="6644456">0</span><span class="op" id="6644457">]</span><span class="op" id="6644458">)</span>&nbsp;<span class="op" id="6644460">+</span>&nbsp;<span class="builtintype" id="6644462">string</span><span class="op" id="6644468">(</span><span class="ident" id="6644469">v</span><span class="op" id="6644470">[</span><span class="num" id="6644471">1</span><span class="op" id="6644472">]</span><span class="op" id="6644473">)</span><span class="op" id="6644474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644481">}</span><br>
<span class="lineno"></span><span class="op" id="6644483">}</span>
</div>
</body>
</html>
