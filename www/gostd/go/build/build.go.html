<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html" class="current">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3139368">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3139424">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3139478">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3139529">package</span>&nbsp;<span class="ident" id="3139537">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139544">import</span>&nbsp;<span class="op" id="3139551">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139554">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139563">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139573">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139580">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139590">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139600">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139613">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139625">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139631">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139644">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139651">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3139657">pathpkg</span>&nbsp;<span class="string" id="3139665">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139673">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139690">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139701">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139709">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139720">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139731">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3139742">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3139757">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3139760">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="3139819">type</span>&nbsp;<span class="ident" id="3139824">Context</span>&nbsp;<span class="keyword" id="3139832">struct</span>&nbsp;<span class="op" id="3139839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3139842">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3139854">string</span>&nbsp;<span class="comment" id="3139861">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3139885">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3139897">string</span>&nbsp;<span class="comment" id="3139904">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3139932">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3139944">string</span>&nbsp;<span class="comment" id="3139951">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3139963">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3139975">string</span>&nbsp;<span class="comment" id="3139982">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3139994">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="3140006">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3140013">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3140041">UseAllFiles</span>&nbsp;<span class="builtintype" id="3140053">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3140060">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3140113">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3140125">string</span>&nbsp;<span class="comment" id="3140132">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140184">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140241">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140311">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140377">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140453">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140539">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140607">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3140669">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3140681">[</span><span class="op" id="3140682">]</span><span class="builtintype" id="3140683">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3140691">ReleaseTags</span>&nbsp;<span class="op" id="3140703">[</span><span class="op" id="3140704">]</span><span class="builtintype" id="3140705">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140714">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140795">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140870">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140947">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141023">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141097">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3141152">InstallSuffix</span>&nbsp;<span class="builtintype" id="3141166">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141175">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141244">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141308">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141376">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141447">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141503">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141573">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3141624">JoinPath</span>&nbsp;<span class="keyword" id="3141633">func</span><span class="op" id="3141637">(</span><span class="ident" id="3141638">elem</span>&nbsp;<span class="op" id="3141643">...</span><span class="builtintype" id="3141646">string</span><span class="op" id="3141652">)</span>&nbsp;<span class="builtintype" id="3141654">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141663">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141736">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3141797">SplitPathList</span>&nbsp;<span class="keyword" id="3141811">func</span><span class="op" id="3141815">(</span><span class="ident" id="3141816">list</span>&nbsp;<span class="builtintype" id="3141821">string</span><span class="op" id="3141827">)</span>&nbsp;<span class="op" id="3141829">[</span><span class="op" id="3141830">]</span><span class="builtintype" id="3141831">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141840">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141896">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3141949">IsAbsPath</span>&nbsp;<span class="keyword" id="3141959">func</span><span class="op" id="3141963">(</span><span class="ident" id="3141964">path</span>&nbsp;<span class="builtintype" id="3141969">string</span><span class="op" id="3141975">)</span>&nbsp;<span class="builtintype" id="3141977">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141984">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142038">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3142116">IsDir</span>&nbsp;<span class="keyword" id="3142122">func</span><span class="op" id="3142126">(</span><span class="ident" id="3142127">path</span>&nbsp;<span class="builtintype" id="3142132">string</span><span class="op" id="3142138">)</span>&nbsp;<span class="builtintype" id="3142140">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142147">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142202">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142244">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142305">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142368">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142432">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3142459">HasSubdir</span>&nbsp;<span class="keyword" id="3142469">func</span><span class="op" id="3142473">(</span><span class="ident" id="3142474">root</span><span class="op" id="3142478">,</span>&nbsp;<span class="ident" id="3142480">dir</span>&nbsp;<span class="builtintype" id="3142484">string</span><span class="op" id="3142490">)</span>&nbsp;<span class="op" id="3142492">(</span><span class="ident" id="3142493">rel</span>&nbsp;<span class="builtintype" id="3142497">string</span><span class="op" id="3142503">,</span>&nbsp;<span class="ident" id="3142505">ok</span>&nbsp;<span class="builtintype" id="3142508">bool</span><span class="op" id="3142512">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142516">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142576">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142627">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3142678">ReadDir</span>&nbsp;<span class="keyword" id="3142686">func</span><span class="op" id="3142690">(</span><span class="ident" id="3142691">dir</span>&nbsp;<span class="builtintype" id="3142695">string</span><span class="op" id="3142701">)</span>&nbsp;<span class="op" id="3142703">(</span><span class="ident" id="3142704">fi</span>&nbsp;<span class="op" id="3142707">[</span><span class="op" id="3142708">]</span><span class="ident" id="3142709">os</span><span class="op" id="3142711">.</span><span class="ident" id="3142712">FileInfo</span><span class="op" id="3142720">,</span>&nbsp;<span class="ident" id="3142722">err</span>&nbsp;<span class="builtintype" id="3142726">error</span><span class="op" id="3142731">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142735">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142792">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3142837">OpenFile</span>&nbsp;<span class="keyword" id="3142846">func</span><span class="op" id="3142850">(</span><span class="ident" id="3142851">path</span>&nbsp;<span class="builtintype" id="3142856">string</span><span class="op" id="3142862">)</span>&nbsp;<span class="op" id="3142864">(</span><span class="ident" id="3142865">r</span>&nbsp;<span class="ident" id="3142867">io</span><span class="op" id="3142869">.</span><span class="ident" id="3142870">ReadCloser</span><span class="op" id="3142880">,</span>&nbsp;<span class="ident" id="3142882">err</span>&nbsp;<span class="builtintype" id="3142886">error</span><span class="op" id="3142891">)</span><br>
<span class="lineno">95</span><span class="op" id="3142893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3142896">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="3142964">func</span>&nbsp;<span class="op" id="3142969">(</span><span class="ident" id="3142970">ctxt</span>&nbsp;<span class="op" id="3142975">*</span><span class="ident" id="3142976">Context</span><span class="op" id="3142983">)</span>&nbsp;<span class="ident" id="3142985">joinPath</span><span class="op" id="3142993">(</span><span class="ident" id="3142994">elem</span>&nbsp;<span class="op" id="3142999">...</span><span class="builtintype" id="3143002">string</span><span class="op" id="3143008">)</span>&nbsp;<span class="builtintype" id="3143010">string</span>&nbsp;<span class="op" id="3143017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143020">if</span>&nbsp;<span class="ident" id="3143023">f</span>&nbsp;<span class="op" id="3143025">:=</span>&nbsp;<span class="ident" id="3143028">ctxt</span><span class="op" id="3143032">.</span><span class="ident" id="3143033">JoinPath</span><span class="op" id="3143041">;</span>&nbsp;<span class="ident" id="3143043">f</span>&nbsp;<span class="op" id="3143045">!=</span>&nbsp;<span class="builtintype" id="3143048">nil</span>&nbsp;<span class="op" id="3143052">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143056">return</span>&nbsp;<span class="ident" id="3143063">f</span><span class="op" id="3143064">(</span><span class="ident" id="3143065">elem</span><span class="op" id="3143069">...</span><span class="op" id="3143072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143078">return</span>&nbsp;<span class="ident" id="3143085">filepath</span><span class="op" id="3143093">.</span><span class="ident" id="3143094">Join</span><span class="op" id="3143098">(</span><span class="ident" id="3143099">elem</span><span class="op" id="3143103">...</span><span class="op" id="3143106">)</span><br>
<span class="lineno"></span><span class="op" id="3143108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="3143111">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="3143194">func</span>&nbsp;<span class="op" id="3143199">(</span><span class="ident" id="3143200">ctxt</span>&nbsp;<span class="op" id="3143205">*</span><span class="ident" id="3143206">Context</span><span class="op" id="3143213">)</span>&nbsp;<span class="ident" id="3143215">splitPathList</span><span class="op" id="3143228">(</span><span class="ident" id="3143229">s</span>&nbsp;<span class="builtintype" id="3143231">string</span><span class="op" id="3143237">)</span>&nbsp;<span class="op" id="3143239">[</span><span class="op" id="3143240">]</span><span class="builtintype" id="3143241">string</span>&nbsp;<span class="op" id="3143248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143251">if</span>&nbsp;<span class="ident" id="3143254">f</span>&nbsp;<span class="op" id="3143256">:=</span>&nbsp;<span class="ident" id="3143259">ctxt</span><span class="op" id="3143263">.</span><span class="ident" id="3143264">SplitPathList</span><span class="op" id="3143277">;</span>&nbsp;<span class="ident" id="3143279">f</span>&nbsp;<span class="op" id="3143281">!=</span>&nbsp;<span class="builtintype" id="3143284">nil</span>&nbsp;<span class="op" id="3143288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143292">return</span>&nbsp;<span class="ident" id="3143299">f</span><span class="op" id="3143300">(</span><span class="ident" id="3143301">s</span><span class="op" id="3143302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143305">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143308">return</span>&nbsp;<span class="ident" id="3143315">filepath</span><span class="op" id="3143323">.</span><span class="ident" id="3143324">SplitList</span><span class="op" id="3143333">(</span><span class="ident" id="3143334">s</span><span class="op" id="3143335">)</span><br>
<span class="lineno"></span><span class="op" id="3143337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3143340">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="3143412">func</span>&nbsp;<span class="op" id="3143417">(</span><span class="ident" id="3143418">ctxt</span>&nbsp;<span class="op" id="3143423">*</span><span class="ident" id="3143424">Context</span><span class="op" id="3143431">)</span>&nbsp;<span class="ident" id="3143433">isAbsPath</span><span class="op" id="3143442">(</span><span class="ident" id="3143443">path</span>&nbsp;<span class="builtintype" id="3143448">string</span><span class="op" id="3143454">)</span>&nbsp;<span class="builtintype" id="3143456">bool</span>&nbsp;<span class="op" id="3143461">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143464">if</span>&nbsp;<span class="ident" id="3143467">f</span>&nbsp;<span class="op" id="3143469">:=</span>&nbsp;<span class="ident" id="3143472">ctxt</span><span class="op" id="3143476">.</span><span class="ident" id="3143477">IsAbsPath</span><span class="op" id="3143486">;</span>&nbsp;<span class="ident" id="3143488">f</span>&nbsp;<span class="op" id="3143490">!=</span>&nbsp;<span class="builtintype" id="3143493">nil</span>&nbsp;<span class="op" id="3143497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143501">return</span>&nbsp;<span class="ident" id="3143508">f</span><span class="op" id="3143509">(</span><span class="ident" id="3143510">path</span><span class="op" id="3143514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143520">return</span>&nbsp;<span class="ident" id="3143527">filepath</span><span class="op" id="3143535">.</span><span class="ident" id="3143536">IsAbs</span><span class="op" id="3143541">(</span><span class="ident" id="3143542">path</span><span class="op" id="3143546">)</span><br>
<span class="lineno"></span><span class="op" id="3143548">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="3143551">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="3143612">func</span>&nbsp;<span class="op" id="3143617">(</span><span class="ident" id="3143618">ctxt</span>&nbsp;<span class="op" id="3143623">*</span><span class="ident" id="3143624">Context</span><span class="op" id="3143631">)</span>&nbsp;<span class="ident" id="3143633">isDir</span><span class="op" id="3143638">(</span><span class="ident" id="3143639">path</span>&nbsp;<span class="builtintype" id="3143644">string</span><span class="op" id="3143650">)</span>&nbsp;<span class="builtintype" id="3143652">bool</span>&nbsp;<span class="op" id="3143657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143660">if</span>&nbsp;<span class="ident" id="3143663">f</span>&nbsp;<span class="op" id="3143665">:=</span>&nbsp;<span class="ident" id="3143668">ctxt</span><span class="op" id="3143672">.</span><span class="ident" id="3143673">IsDir</span><span class="op" id="3143678">;</span>&nbsp;<span class="ident" id="3143680">f</span>&nbsp;<span class="op" id="3143682">!=</span>&nbsp;<span class="builtintype" id="3143685">nil</span>&nbsp;<span class="op" id="3143689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143693">return</span>&nbsp;<span class="ident" id="3143700">f</span><span class="op" id="3143701">(</span><span class="ident" id="3143702">path</span><span class="op" id="3143706">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3143712">fi</span><span class="op" id="3143714">,</span>&nbsp;<span class="ident" id="3143716">err</span>&nbsp;<span class="op" id="3143720">:=</span>&nbsp;<span class="ident" id="3143723">os</span><span class="op" id="3143725">.</span><span class="ident" id="3143726">Stat</span><span class="op" id="3143730">(</span><span class="ident" id="3143731">path</span><span class="op" id="3143735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143738">return</span>&nbsp;<span class="ident" id="3143745">err</span>&nbsp;<span class="op" id="3143749">==</span>&nbsp;<span class="builtintype" id="3143752">nil</span>&nbsp;<span class="op" id="3143756">&amp;&amp;</span>&nbsp;<span class="ident" id="3143759">fi</span><span class="op" id="3143761">.</span><span class="ident" id="3143762">IsDir</span><span class="op" id="3143767">(</span><span class="op" id="3143768">)</span><br>
<span class="lineno"></span><span class="op" id="3143770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="3143773">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="3143833">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="3143882">func</span>&nbsp;<span class="op" id="3143887">(</span><span class="ident" id="3143888">ctxt</span>&nbsp;<span class="op" id="3143893">*</span><span class="ident" id="3143894">Context</span><span class="op" id="3143901">)</span>&nbsp;<span class="ident" id="3143903">hasSubdir</span><span class="op" id="3143912">(</span><span class="ident" id="3143913">root</span><span class="op" id="3143917">,</span>&nbsp;<span class="ident" id="3143919">dir</span>&nbsp;<span class="builtintype" id="3143923">string</span><span class="op" id="3143929">)</span>&nbsp;<span class="op" id="3143931">(</span><span class="ident" id="3143932">rel</span>&nbsp;<span class="builtintype" id="3143936">string</span><span class="op" id="3143942">,</span>&nbsp;<span class="ident" id="3143944">ok</span>&nbsp;<span class="builtintype" id="3143947">bool</span><span class="op" id="3143951">)</span>&nbsp;<span class="op" id="3143953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143956">if</span>&nbsp;<span class="ident" id="3143959">f</span>&nbsp;<span class="op" id="3143961">:=</span>&nbsp;<span class="ident" id="3143964">ctxt</span><span class="op" id="3143968">.</span><span class="ident" id="3143969">HasSubdir</span><span class="op" id="3143978">;</span>&nbsp;<span class="ident" id="3143980">f</span>&nbsp;<span class="op" id="3143982">!=</span>&nbsp;<span class="builtintype" id="3143985">nil</span>&nbsp;<span class="op" id="3143989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143993">return</span>&nbsp;<span class="ident" id="3144000">f</span><span class="op" id="3144001">(</span><span class="ident" id="3144002">root</span><span class="op" id="3144006">,</span>&nbsp;<span class="ident" id="3144008">dir</span><span class="op" id="3144011">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3144014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3144018">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144051">if</span>&nbsp;<span class="ident" id="3144054">rel</span><span class="op" id="3144057">,</span>&nbsp;<span class="ident" id="3144059">ok</span>&nbsp;<span class="op" id="3144062">=</span>&nbsp;<span class="ident" id="3144064">hasSubdir</span><span class="op" id="3144073">(</span><span class="ident" id="3144074">root</span><span class="op" id="3144078">,</span>&nbsp;<span class="ident" id="3144080">dir</span><span class="op" id="3144083">)</span><span class="op" id="3144084">;</span>&nbsp;<span class="ident" id="3144086">ok</span>&nbsp;<span class="op" id="3144089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144093">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3144101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3144105">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3144146">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3144182">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144213">rootSym</span><span class="op" id="3144220">,</span>&nbsp;<span class="ident" id="3144222">_</span>&nbsp;<span class="op" id="3144224">:=</span>&nbsp;<span class="ident" id="3144227">filepath</span><span class="op" id="3144235">.</span><span class="ident" id="3144236">EvalSymlinks</span><span class="op" id="3144248">(</span><span class="ident" id="3144249">root</span><span class="op" id="3144253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144256">dirSym</span><span class="op" id="3144262">,</span>&nbsp;<span class="ident" id="3144264">_</span>&nbsp;<span class="op" id="3144266">:=</span>&nbsp;<span class="ident" id="3144269">filepath</span><span class="op" id="3144277">.</span><span class="ident" id="3144278">EvalSymlinks</span><span class="op" id="3144290">(</span><span class="ident" id="3144291">dir</span><span class="op" id="3144294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144298">if</span>&nbsp;<span class="ident" id="3144301">rel</span><span class="op" id="3144304">,</span>&nbsp;<span class="ident" id="3144306">ok</span>&nbsp;<span class="op" id="3144309">=</span>&nbsp;<span class="ident" id="3144311">hasSubdir</span><span class="op" id="3144320">(</span><span class="ident" id="3144321">rootSym</span><span class="op" id="3144328">,</span>&nbsp;<span class="ident" id="3144330">dir</span><span class="op" id="3144333">)</span><span class="op" id="3144334">;</span>&nbsp;<span class="ident" id="3144336">ok</span>&nbsp;<span class="op" id="3144339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144343">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3144351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144354">if</span>&nbsp;<span class="ident" id="3144357">rel</span><span class="op" id="3144360">,</span>&nbsp;<span class="ident" id="3144362">ok</span>&nbsp;<span class="op" id="3144365">=</span>&nbsp;<span class="ident" id="3144367">hasSubdir</span><span class="op" id="3144376">(</span><span class="ident" id="3144377">root</span><span class="op" id="3144381">,</span>&nbsp;<span class="ident" id="3144383">dirSym</span><span class="op" id="3144389">)</span><span class="op" id="3144390">;</span>&nbsp;<span class="ident" id="3144392">ok</span>&nbsp;<span class="op" id="3144395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144399">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3144407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144410">return</span>&nbsp;<span class="ident" id="3144417">hasSubdir</span><span class="op" id="3144426">(</span><span class="ident" id="3144427">rootSym</span><span class="op" id="3144434">,</span>&nbsp;<span class="ident" id="3144436">dirSym</span><span class="op" id="3144442">)</span><br>
<span class="lineno">155</span><span class="op" id="3144444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3144447">func</span>&nbsp;<span class="ident" id="3144452">hasSubdir</span><span class="op" id="3144461">(</span><span class="ident" id="3144462">root</span><span class="op" id="3144466">,</span>&nbsp;<span class="ident" id="3144468">dir</span>&nbsp;<span class="builtintype" id="3144472">string</span><span class="op" id="3144478">)</span>&nbsp;<span class="op" id="3144480">(</span><span class="ident" id="3144481">rel</span>&nbsp;<span class="builtintype" id="3144485">string</span><span class="op" id="3144491">,</span>&nbsp;<span class="ident" id="3144493">ok</span>&nbsp;<span class="builtintype" id="3144496">bool</span><span class="op" id="3144500">)</span>&nbsp;<span class="op" id="3144502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144505">const</span>&nbsp;<span class="ident" id="3144511">sep</span>&nbsp;<span class="op" id="3144515">=</span>&nbsp;<span class="builtintype" id="3144517">string</span><span class="op" id="3144523">(</span><span class="ident" id="3144524">filepath</span><span class="op" id="3144532">.</span><span class="ident" id="3144533">Separator</span><span class="op" id="3144542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144545">root</span>&nbsp;<span class="op" id="3144550">=</span>&nbsp;<span class="ident" id="3144552">filepath</span><span class="op" id="3144560">.</span><span class="ident" id="3144561">Clean</span><span class="op" id="3144566">(</span><span class="ident" id="3144567">root</span><span class="op" id="3144571">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144574">if</span>&nbsp;<span class="op" id="3144577">!</span><span class="ident" id="3144578">strings</span><span class="op" id="3144585">.</span><span class="ident" id="3144586">HasSuffix</span><span class="op" id="3144595">(</span><span class="ident" id="3144596">root</span><span class="op" id="3144600">,</span>&nbsp;<span class="ident" id="3144602">sep</span><span class="op" id="3144605">)</span>&nbsp;<span class="op" id="3144607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144611">root</span>&nbsp;<span class="op" id="3144616">+=</span>&nbsp;<span class="ident" id="3144619">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3144624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144627">dir</span>&nbsp;<span class="op" id="3144631">=</span>&nbsp;<span class="ident" id="3144633">filepath</span><span class="op" id="3144641">.</span><span class="ident" id="3144642">Clean</span><span class="op" id="3144647">(</span><span class="ident" id="3144648">dir</span><span class="op" id="3144651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144654">if</span>&nbsp;<span class="op" id="3144657">!</span><span class="ident" id="3144658">strings</span><span class="op" id="3144665">.</span><span class="ident" id="3144666">HasPrefix</span><span class="op" id="3144675">(</span><span class="ident" id="3144676">dir</span><span class="op" id="3144679">,</span>&nbsp;<span class="ident" id="3144681">root</span><span class="op" id="3144685">)</span>&nbsp;<span class="op" id="3144687">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144691">return</span>&nbsp;<span class="string" id="3144698">&#34;&#34;</span><span class="op" id="3144700">,</span>&nbsp;<span class="builtintype" id="3144702">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3144709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144712">return</span>&nbsp;<span class="ident" id="3144719">filepath</span><span class="op" id="3144727">.</span><span class="ident" id="3144728">ToSlash</span><span class="op" id="3144735">(</span><span class="ident" id="3144736">dir</span><span class="op" id="3144739">[</span><span class="builtinfunc" id="3144740">len</span><span class="op" id="3144743">(</span><span class="ident" id="3144744">root</span><span class="op" id="3144748">)</span><span class="op" id="3144749">:</span><span class="op" id="3144750">]</span><span class="op" id="3144751">)</span><span class="op" id="3144752">,</span>&nbsp;<span class="builtintype" id="3144754">true</span><br>
<span class="lineno"></span><span class="op" id="3144759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="3144762">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="3144829">func</span>&nbsp;<span class="op" id="3144834">(</span><span class="ident" id="3144835">ctxt</span>&nbsp;<span class="op" id="3144840">*</span><span class="ident" id="3144841">Context</span><span class="op" id="3144848">)</span>&nbsp;<span class="ident" id="3144850">readDir</span><span class="op" id="3144857">(</span><span class="ident" id="3144858">path</span>&nbsp;<span class="builtintype" id="3144863">string</span><span class="op" id="3144869">)</span>&nbsp;<span class="op" id="3144871">(</span><span class="op" id="3144872">[</span><span class="op" id="3144873">]</span><span class="ident" id="3144874">os</span><span class="op" id="3144876">.</span><span class="ident" id="3144877">FileInfo</span><span class="op" id="3144885">,</span>&nbsp;<span class="builtintype" id="3144887">error</span><span class="op" id="3144892">)</span>&nbsp;<span class="op" id="3144894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144897">if</span>&nbsp;<span class="ident" id="3144900">f</span>&nbsp;<span class="op" id="3144902">:=</span>&nbsp;<span class="ident" id="3144905">ctxt</span><span class="op" id="3144909">.</span><span class="ident" id="3144910">ReadDir</span><span class="op" id="3144917">;</span>&nbsp;<span class="ident" id="3144919">f</span>&nbsp;<span class="op" id="3144921">!=</span>&nbsp;<span class="builtintype" id="3144924">nil</span>&nbsp;<span class="op" id="3144928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144932">return</span>&nbsp;<span class="ident" id="3144939">f</span><span class="op" id="3144940">(</span><span class="ident" id="3144941">path</span><span class="op" id="3144945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3144948">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144951">return</span>&nbsp;<span class="ident" id="3144958">ioutil</span><span class="op" id="3144964">.</span><span class="ident" id="3144965">ReadDir</span><span class="op" id="3144972">(</span><span class="ident" id="3144973">path</span><span class="op" id="3144977">)</span><br>
<span class="lineno"></span><span class="op" id="3144979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3144982">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="3145044">func</span>&nbsp;<span class="op" id="3145049">(</span><span class="ident" id="3145050">ctxt</span>&nbsp;<span class="op" id="3145055">*</span><span class="ident" id="3145056">Context</span><span class="op" id="3145063">)</span>&nbsp;<span class="ident" id="3145065">openFile</span><span class="op" id="3145073">(</span><span class="ident" id="3145074">path</span>&nbsp;<span class="builtintype" id="3145079">string</span><span class="op" id="3145085">)</span>&nbsp;<span class="op" id="3145087">(</span><span class="ident" id="3145088">io</span><span class="op" id="3145090">.</span><span class="ident" id="3145091">ReadCloser</span><span class="op" id="3145101">,</span>&nbsp;<span class="builtintype" id="3145103">error</span><span class="op" id="3145108">)</span>&nbsp;<span class="op" id="3145110">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145113">if</span>&nbsp;<span class="ident" id="3145116">fn</span>&nbsp;<span class="op" id="3145119">:=</span>&nbsp;<span class="ident" id="3145122">ctxt</span><span class="op" id="3145126">.</span><span class="ident" id="3145127">OpenFile</span><span class="op" id="3145135">;</span>&nbsp;<span class="ident" id="3145137">fn</span>&nbsp;<span class="op" id="3145140">!=</span>&nbsp;<span class="builtintype" id="3145143">nil</span>&nbsp;<span class="op" id="3145147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145151">return</span>&nbsp;<span class="ident" id="3145158">fn</span><span class="op" id="3145160">(</span><span class="ident" id="3145161">path</span><span class="op" id="3145165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3145172">f</span><span class="op" id="3145173">,</span>&nbsp;<span class="ident" id="3145175">err</span>&nbsp;<span class="op" id="3145179">:=</span>&nbsp;<span class="ident" id="3145182">os</span><span class="op" id="3145184">.</span><span class="ident" id="3145185">Open</span><span class="op" id="3145189">(</span><span class="ident" id="3145190">path</span><span class="op" id="3145194">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145197">if</span>&nbsp;<span class="ident" id="3145200">err</span>&nbsp;<span class="op" id="3145204">!=</span>&nbsp;<span class="builtintype" id="3145207">nil</span>&nbsp;<span class="op" id="3145211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145215">return</span>&nbsp;<span class="builtintype" id="3145222">nil</span><span class="op" id="3145225">,</span>&nbsp;<span class="ident" id="3145227">err</span>&nbsp;<span class="comment" id="3145231">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145252">return</span>&nbsp;<span class="ident" id="3145259">f</span><span class="op" id="3145260">,</span>&nbsp;<span class="builtintype" id="3145262">nil</span><br>
<span class="lineno"></span><span class="op" id="3145266">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3145269">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3145335">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3145399">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="3145419">func</span>&nbsp;<span class="op" id="3145424">(</span><span class="ident" id="3145425">ctxt</span>&nbsp;<span class="op" id="3145430">*</span><span class="ident" id="3145431">Context</span><span class="op" id="3145438">)</span>&nbsp;<span class="ident" id="3145440">isFile</span><span class="op" id="3145446">(</span><span class="ident" id="3145447">path</span>&nbsp;<span class="builtintype" id="3145452">string</span><span class="op" id="3145458">)</span>&nbsp;<span class="builtintype" id="3145460">bool</span>&nbsp;<span class="op" id="3145465">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3145468">f</span><span class="op" id="3145469">,</span>&nbsp;<span class="ident" id="3145471">err</span>&nbsp;<span class="op" id="3145475">:=</span>&nbsp;<span class="ident" id="3145478">ctxt</span><span class="op" id="3145482">.</span><span class="ident" id="3145483">openFile</span><span class="op" id="3145491">(</span><span class="ident" id="3145492">path</span><span class="op" id="3145496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145499">if</span>&nbsp;<span class="ident" id="3145502">err</span>&nbsp;<span class="op" id="3145506">!=</span>&nbsp;<span class="builtintype" id="3145509">nil</span>&nbsp;<span class="op" id="3145513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145517">return</span>&nbsp;<span class="builtintype" id="3145524">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3145534">f</span><span class="op" id="3145535">.</span><span class="ident" id="3145536">Close</span><span class="op" id="3145541">(</span><span class="op" id="3145542">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145545">return</span>&nbsp;<span class="builtintype" id="3145552">true</span><br>
<span class="lineno"></span><span class="op" id="3145557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3145560">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="3145611">func</span>&nbsp;<span class="op" id="3145616">(</span><span class="ident" id="3145617">ctxt</span>&nbsp;<span class="op" id="3145622">*</span><span class="ident" id="3145623">Context</span><span class="op" id="3145630">)</span>&nbsp;<span class="ident" id="3145632">gopath</span><span class="op" id="3145638">(</span><span class="op" id="3145639">)</span>&nbsp;<span class="op" id="3145641">[</span><span class="op" id="3145642">]</span><span class="builtintype" id="3145643">string</span>&nbsp;<span class="op" id="3145650">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145653">var</span>&nbsp;<span class="ident" id="3145657">all</span>&nbsp;<span class="op" id="3145661">[</span><span class="op" id="3145662">]</span><span class="builtintype" id="3145663">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145671">for</span>&nbsp;<span class="ident" id="3145675">_</span><span class="op" id="3145676">,</span>&nbsp;<span class="ident" id="3145678">p</span>&nbsp;<span class="op" id="3145680">:=</span>&nbsp;<span class="keyword" id="3145683">range</span>&nbsp;<span class="ident" id="3145689">ctxt</span><span class="op" id="3145693">.</span><span class="ident" id="3145694">splitPathList</span><span class="op" id="3145707">(</span><span class="ident" id="3145708">ctxt</span><span class="op" id="3145712">.</span><span class="ident" id="3145713">GOPATH</span><span class="op" id="3145719">)</span>&nbsp;<span class="op" id="3145721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145725">if</span>&nbsp;<span class="ident" id="3145728">p</span>&nbsp;<span class="op" id="3145730">==</span>&nbsp;<span class="string" id="3145733">&#34;&#34;</span>&nbsp;<span class="op" id="3145736">||</span>&nbsp;<span class="ident" id="3145739">p</span>&nbsp;<span class="op" id="3145741">==</span>&nbsp;<span class="ident" id="3145744">ctxt</span><span class="op" id="3145748">.</span><span class="ident" id="3145749">GOROOT</span>&nbsp;<span class="op" id="3145756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145761">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145798">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145842">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145885">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145935">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3145950">if</span>&nbsp;<span class="ident" id="3145953">strings</span><span class="op" id="3145960">.</span><span class="ident" id="3145961">HasPrefix</span><span class="op" id="3145970">(</span><span class="ident" id="3145971">p</span><span class="op" id="3145972">,</span>&nbsp;<span class="string" id="3145974">&#34;~&#34;</span><span class="op" id="3145977">)</span>&nbsp;<span class="op" id="3145979">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145984">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146046">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146110">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146155">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146215">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146273">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146340">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146403">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146469">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146528">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146548">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146612">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3146640">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3146651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3146655">all</span>&nbsp;<span class="op" id="3146659">=</span>&nbsp;<span class="builtinfunc" id="3146661">append</span><span class="op" id="3146667">(</span><span class="ident" id="3146668">all</span><span class="op" id="3146671">,</span>&nbsp;<span class="ident" id="3146673">p</span><span class="op" id="3146674">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3146677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3146680">return</span>&nbsp;<span class="ident" id="3146687">all</span><br>
<span class="lineno"></span><span class="op" id="3146691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3146694">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="3146756">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="3146827">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="3146849">func</span>&nbsp;<span class="op" id="3146854">(</span><span class="ident" id="3146855">ctxt</span>&nbsp;<span class="op" id="3146860">*</span><span class="ident" id="3146861">Context</span><span class="op" id="3146868">)</span>&nbsp;<span class="ident" id="3146870">SrcDirs</span><span class="op" id="3146877">(</span><span class="op" id="3146878">)</span>&nbsp;<span class="op" id="3146880">[</span><span class="op" id="3146881">]</span><span class="builtintype" id="3146882">string</span>&nbsp;<span class="op" id="3146889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3146892">var</span>&nbsp;<span class="ident" id="3146896">all</span>&nbsp;<span class="op" id="3146900">[</span><span class="op" id="3146901">]</span><span class="builtintype" id="3146902">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3146910">if</span>&nbsp;<span class="ident" id="3146913">ctxt</span><span class="op" id="3146917">.</span><span class="ident" id="3146918">GOROOT</span>&nbsp;<span class="op" id="3146925">!=</span>&nbsp;<span class="string" id="3146928">&#34;&#34;</span>&nbsp;<span class="op" id="3146931">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3146935">dir</span>&nbsp;<span class="op" id="3146939">:=</span>&nbsp;<span class="ident" id="3146942">ctxt</span><span class="op" id="3146946">.</span><span class="ident" id="3146947">joinPath</span><span class="op" id="3146955">(</span><span class="ident" id="3146956">ctxt</span><span class="op" id="3146960">.</span><span class="ident" id="3146961">GOROOT</span><span class="op" id="3146967">,</span>&nbsp;<span class="string" id="3146969">&#34;src&#34;</span><span class="op" id="3146974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3146978">if</span>&nbsp;<span class="ident" id="3146981">ctxt</span><span class="op" id="3146985">.</span><span class="ident" id="3146986">isDir</span><span class="op" id="3146991">(</span><span class="ident" id="3146992">dir</span><span class="op" id="3146995">)</span>&nbsp;<span class="op" id="3146997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147002">all</span>&nbsp;<span class="op" id="3147006">=</span>&nbsp;<span class="builtinfunc" id="3147008">append</span><span class="op" id="3147014">(</span><span class="ident" id="3147015">all</span><span class="op" id="3147018">,</span>&nbsp;<span class="ident" id="3147020">dir</span><span class="op" id="3147023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3147027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3147030">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3147033">for</span>&nbsp;<span class="ident" id="3147037">_</span><span class="op" id="3147038">,</span>&nbsp;<span class="ident" id="3147040">p</span>&nbsp;<span class="op" id="3147042">:=</span>&nbsp;<span class="keyword" id="3147045">range</span>&nbsp;<span class="ident" id="3147051">ctxt</span><span class="op" id="3147055">.</span><span class="ident" id="3147056">gopath</span><span class="op" id="3147062">(</span><span class="op" id="3147063">)</span>&nbsp;<span class="op" id="3147065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147069">dir</span>&nbsp;<span class="op" id="3147073">:=</span>&nbsp;<span class="ident" id="3147076">ctxt</span><span class="op" id="3147080">.</span><span class="ident" id="3147081">joinPath</span><span class="op" id="3147089">(</span><span class="ident" id="3147090">p</span><span class="op" id="3147091">,</span>&nbsp;<span class="string" id="3147093">&#34;src&#34;</span><span class="op" id="3147098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3147102">if</span>&nbsp;<span class="ident" id="3147105">ctxt</span><span class="op" id="3147109">.</span><span class="ident" id="3147110">isDir</span><span class="op" id="3147115">(</span><span class="ident" id="3147116">dir</span><span class="op" id="3147119">)</span>&nbsp;<span class="op" id="3147121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147126">all</span>&nbsp;<span class="op" id="3147130">=</span>&nbsp;<span class="builtinfunc" id="3147132">append</span><span class="op" id="3147138">(</span><span class="ident" id="3147139">all</span><span class="op" id="3147142">,</span>&nbsp;<span class="ident" id="3147144">dir</span><span class="op" id="3147147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3147151">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3147154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3147157">return</span>&nbsp;<span class="ident" id="3147164">all</span><br>
<span class="lineno"></span><span class="op" id="3147168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3147171">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="3147217">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="3147287">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="3147352">var</span>&nbsp;<span class="ident" id="3147356">Default</span>&nbsp;<span class="ident" id="3147364">Context</span>&nbsp;<span class="op" id="3147372">=</span>&nbsp;<span class="ident" id="3147374">defaultContext</span><span class="op" id="3147388">(</span><span class="op" id="3147389">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3147392">var</span>&nbsp;<span class="ident" id="3147396">cgoEnabled</span>&nbsp;<span class="op" id="3147407">=</span>&nbsp;<span class="keyword" id="3147409">map</span><span class="op" id="3147412">[</span><span class="builtintype" id="3147413">string</span><span class="op" id="3147419">]</span><span class="builtintype" id="3147420">bool</span><span class="op" id="3147424">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147427">&#34;darwin/386&#34;</span><span class="op" id="3147439">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147446">true</span><span class="op" id="3147450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147453">&#34;darwin/amd64&#34;</span><span class="op" id="3147467">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147472">true</span><span class="op" id="3147476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147479">&#34;dragonfly/386&#34;</span><span class="op" id="3147494">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147498">true</span><span class="op" id="3147502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147505">&#34;dragonfly/amd64&#34;</span><span class="op" id="3147522">:</span>&nbsp;<span class="builtintype" id="3147524">true</span><span class="op" id="3147528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147531">&#34;freebsd/386&#34;</span><span class="op" id="3147544">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147550">true</span><span class="op" id="3147554">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147557">&#34;freebsd/amd64&#34;</span><span class="op" id="3147572">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147576">true</span><span class="op" id="3147580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147583">&#34;freebsd/arm&#34;</span><span class="op" id="3147596">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147602">true</span><span class="op" id="3147606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147609">&#34;linux/386&#34;</span><span class="op" id="3147620">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147628">true</span><span class="op" id="3147632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147635">&#34;linux/amd64&#34;</span><span class="op" id="3147648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147654">true</span><span class="op" id="3147658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147661">&#34;linux/arm&#34;</span><span class="op" id="3147672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147680">true</span><span class="op" id="3147684">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147687">&#34;android/386&#34;</span><span class="op" id="3147700">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147706">true</span><span class="op" id="3147710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147713">&#34;android/amd64&#34;</span><span class="op" id="3147728">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147732">true</span><span class="op" id="3147736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147739">&#34;android/arm&#34;</span><span class="op" id="3147752">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147758">true</span><span class="op" id="3147762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147765">&#34;netbsd/386&#34;</span><span class="op" id="3147777">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147784">true</span><span class="op" id="3147788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147791">&#34;netbsd/amd64&#34;</span><span class="op" id="3147805">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147810">true</span><span class="op" id="3147814">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147817">&#34;netbsd/arm&#34;</span><span class="op" id="3147829">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147836">true</span><span class="op" id="3147840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147843">&#34;openbsd/386&#34;</span><span class="op" id="3147856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147862">true</span><span class="op" id="3147866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147869">&#34;openbsd/amd64&#34;</span><span class="op" id="3147884">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147888">true</span><span class="op" id="3147892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147895">&#34;windows/386&#34;</span><span class="op" id="3147908">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147914">true</span><span class="op" id="3147918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3147921">&#34;windows/amd64&#34;</span><span class="op" id="3147936">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147940">true</span><span class="op" id="3147944">,</span><br>
<span class="lineno">280</span><span class="op" id="3147946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3147949">func</span>&nbsp;<span class="ident" id="3147954">defaultContext</span><span class="op" id="3147968">(</span><span class="op" id="3147969">)</span>&nbsp;<span class="ident" id="3147971">Context</span>&nbsp;<span class="op" id="3147979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3147982">var</span>&nbsp;<span class="ident" id="3147986">c</span>&nbsp;<span class="ident" id="3147988">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147998">c</span><span class="op" id="3147999">.</span><span class="ident" id="3148000">GOARCH</span>&nbsp;<span class="op" id="3148007">=</span>&nbsp;<span class="ident" id="3148009">envOr</span><span class="op" id="3148014">(</span><span class="string" id="3148015">&#34;GOARCH&#34;</span><span class="op" id="3148023">,</span>&nbsp;<span class="ident" id="3148025">runtime</span><span class="op" id="3148032">.</span><span class="ident" id="3148033">GOARCH</span><span class="op" id="3148039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148042">c</span><span class="op" id="3148043">.</span><span class="ident" id="3148044">GOOS</span>&nbsp;<span class="op" id="3148049">=</span>&nbsp;<span class="ident" id="3148051">envOr</span><span class="op" id="3148056">(</span><span class="string" id="3148057">&#34;GOOS&#34;</span><span class="op" id="3148063">,</span>&nbsp;<span class="ident" id="3148065">runtime</span><span class="op" id="3148072">.</span><span class="ident" id="3148073">GOOS</span><span class="op" id="3148077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148080">c</span><span class="op" id="3148081">.</span><span class="ident" id="3148082">GOROOT</span>&nbsp;<span class="op" id="3148089">=</span>&nbsp;<span class="ident" id="3148091">runtime</span><span class="op" id="3148098">.</span><span class="ident" id="3148099">GOROOT</span><span class="op" id="3148105">(</span><span class="op" id="3148106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148109">c</span><span class="op" id="3148110">.</span><span class="ident" id="3148111">GOPATH</span>&nbsp;<span class="op" id="3148118">=</span>&nbsp;<span class="ident" id="3148120">envOr</span><span class="op" id="3148125">(</span><span class="string" id="3148126">&#34;GOPATH&#34;</span><span class="op" id="3148134">,</span>&nbsp;<span class="string" id="3148136">&#34;&#34;</span><span class="op" id="3148138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148141">c</span><span class="op" id="3148142">.</span><span class="ident" id="3148143">Compiler</span>&nbsp;<span class="op" id="3148152">=</span>&nbsp;<span class="ident" id="3148154">runtime</span><span class="op" id="3148161">.</span><span class="ident" id="3148162">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148173">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148243">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148313">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148386">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148459">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148536">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148540">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148584">//&nbsp;&nbsp;&nbsp;&nbsp;c.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148658">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148673">c</span><span class="op" id="3148674">.</span><span class="ident" id="3148675">ReleaseTags</span>&nbsp;<span class="op" id="3148687">=</span>&nbsp;<span class="op" id="3148689">[</span><span class="op" id="3148690">]</span><span class="builtintype" id="3148691">string</span><span class="op" id="3148697">{</span><span class="string" id="3148698">&#34;go1.1&#34;</span><span class="op" id="3148705">,</span>&nbsp;<span class="string" id="3148707">&#34;go1.2&#34;</span><span class="op" id="3148714">,</span>&nbsp;<span class="string" id="3148716">&#34;go1.3&#34;</span><span class="op" id="3148723">,</span>&nbsp;<span class="string" id="3148725">&#34;go1.4&#34;</span><span class="op" id="3148732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148736">switch</span>&nbsp;<span class="ident" id="3148743">os</span><span class="op" id="3148745">.</span><span class="ident" id="3148746">Getenv</span><span class="op" id="3148752">(</span><span class="string" id="3148753">&#34;CGO_ENABLED&#34;</span><span class="op" id="3148766">)</span>&nbsp;<span class="op" id="3148768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148771">case</span>&nbsp;<span class="string" id="3148776">&#34;1&#34;</span><span class="op" id="3148779">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148783">c</span><span class="op" id="3148784">.</span><span class="ident" id="3148785">CgoEnabled</span>&nbsp;<span class="op" id="3148796">=</span>&nbsp;<span class="builtintype" id="3148798">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148804">case</span>&nbsp;<span class="string" id="3148809">&#34;0&#34;</span><span class="op" id="3148812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148816">c</span><span class="op" id="3148817">.</span><span class="ident" id="3148818">CgoEnabled</span>&nbsp;<span class="op" id="3148829">=</span>&nbsp;<span class="builtintype" id="3148831">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148838">default</span><span class="op" id="3148845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3148849">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148914">if</span>&nbsp;<span class="ident" id="3148917">runtime</span><span class="op" id="3148924">.</span><span class="ident" id="3148925">GOARCH</span>&nbsp;<span class="op" id="3148932">==</span>&nbsp;<span class="ident" id="3148935">c</span><span class="op" id="3148936">.</span><span class="ident" id="3148937">GOARCH</span>&nbsp;<span class="op" id="3148944">&amp;&amp;</span>&nbsp;<span class="ident" id="3148947">runtime</span><span class="op" id="3148954">.</span><span class="ident" id="3148955">GOOS</span>&nbsp;<span class="op" id="3148960">==</span>&nbsp;<span class="ident" id="3148963">c</span><span class="op" id="3148964">.</span><span class="ident" id="3148965">GOOS</span>&nbsp;<span class="op" id="3148970">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148975">c</span><span class="op" id="3148976">.</span><span class="ident" id="3148977">CgoEnabled</span>&nbsp;<span class="op" id="3148988">=</span>&nbsp;<span class="ident" id="3148990">cgoEnabled</span><span class="op" id="3149000">[</span><span class="ident" id="3149001">c</span><span class="op" id="3149002">.</span><span class="ident" id="3149003">GOOS</span><span class="op" id="3149007">+</span><span class="string" id="3149008">&#34;/&#34;</span><span class="op" id="3149011">+</span><span class="ident" id="3149012">c</span><span class="op" id="3149013">.</span><span class="ident" id="3149014">GOARCH</span><span class="op" id="3149020">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3149025">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3149033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3149037">c</span><span class="op" id="3149038">.</span><span class="ident" id="3149039">CgoEnabled</span>&nbsp;<span class="op" id="3149050">=</span>&nbsp;<span class="builtintype" id="3149052">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3149059">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3149063">return</span>&nbsp;<span class="ident" id="3149070">c</span><br>
<span class="lineno"></span><span class="op" id="3149072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149075">func</span>&nbsp;<span class="ident" id="3149080">envOr</span><span class="op" id="3149085">(</span><span class="ident" id="3149086">name</span><span class="op" id="3149090">,</span>&nbsp;<span class="ident" id="3149092">def</span>&nbsp;<span class="builtintype" id="3149096">string</span><span class="op" id="3149102">)</span>&nbsp;<span class="builtintype" id="3149104">string</span>&nbsp;<span class="op" id="3149111">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3149114">s</span>&nbsp;<span class="op" id="3149116">:=</span>&nbsp;<span class="ident" id="3149119">os</span><span class="op" id="3149121">.</span><span class="ident" id="3149122">Getenv</span><span class="op" id="3149128">(</span><span class="ident" id="3149129">name</span><span class="op" id="3149133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3149136">if</span>&nbsp;<span class="ident" id="3149139">s</span>&nbsp;<span class="op" id="3149141">==</span>&nbsp;<span class="string" id="3149144">&#34;&#34;</span>&nbsp;<span class="op" id="3149147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3149151">return</span>&nbsp;<span class="ident" id="3149158">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3149163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3149166">return</span>&nbsp;<span class="ident" id="3149173">s</span><br>
<span class="lineno">325</span><span class="op" id="3149175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3149178">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3149239">type</span>&nbsp;<span class="ident" id="3149244">ImportMode</span>&nbsp;<span class="builtintype" id="3149255">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="3149261">const</span>&nbsp;<span class="op" id="3149267">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3149270">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3149336">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3149400">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3149437">FindOnly</span>&nbsp;<span class="ident" id="3149446">ImportMode</span>&nbsp;<span class="op" id="3149457">=</span>&nbsp;<span class="num" id="3149459">1</span>&nbsp;<span class="op" id="3149461">&lt;&lt;</span>&nbsp;<span class="ident" id="3149464">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3149471">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3149536">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3149586">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3149600">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3149674">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3149745">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3149805">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3149865">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="3149879">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3149882">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="3149942">type</span>&nbsp;<span class="ident" id="3149947">Package</span>&nbsp;<span class="keyword" id="3149955">struct</span>&nbsp;<span class="op" id="3149962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3149965">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3149979">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3149988">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150029">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150043">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150052">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150069">ImportComment</span>&nbsp;<span class="builtintype" id="3150083">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150092">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150140">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150154">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150163">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150190">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150204">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150213">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150256">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150270">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150279">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150324">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150338">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150347">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150397">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150411">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150420">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150471">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150485">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150494">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150540">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150554">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3150563">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150592">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150606">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150615">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150637">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3150651">[</span><span class="op" id="3150652">]</span><span class="builtintype" id="3150653">string</span>&nbsp;<span class="comment" id="3150660">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150721">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150735">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3150744">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3150787">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150804">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3150819">[</span><span class="op" id="3150820">]</span><span class="builtintype" id="3150821">string</span>&nbsp;<span class="comment" id="3150828">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150897">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3150912">[</span><span class="op" id="3150913">]</span><span class="builtintype" id="3150914">string</span>&nbsp;<span class="comment" id="3150921">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150958">IgnoredGoFiles</span>&nbsp;<span class="op" id="3150973">[</span><span class="op" id="3150974">]</span><span class="builtintype" id="3150975">string</span>&nbsp;<span class="comment" id="3150982">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151026">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3151041">[</span><span class="op" id="3151042">]</span><span class="builtintype" id="3151043">string</span>&nbsp;<span class="comment" id="3151050">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151070">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3151085">[</span><span class="op" id="3151086">]</span><span class="builtintype" id="3151087">string</span>&nbsp;<span class="comment" id="3151094">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151130">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3151145">[</span><span class="op" id="3151146">]</span><span class="builtintype" id="3151147">string</span>&nbsp;<span class="comment" id="3151154">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151188">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3151203">[</span><span class="op" id="3151204">]</span><span class="builtintype" id="3151205">string</span>&nbsp;<span class="comment" id="3151212">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151252">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3151267">[</span><span class="op" id="3151268">]</span><span class="builtintype" id="3151269">string</span>&nbsp;<span class="comment" id="3151276">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151296">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3151311">[</span><span class="op" id="3151312">]</span><span class="builtintype" id="3151313">string</span>&nbsp;<span class="comment" id="3151320">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151336">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3151351">[</span><span class="op" id="3151352">]</span><span class="builtintype" id="3151353">string</span>&nbsp;<span class="comment" id="3151360">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151379">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3151394">[</span><span class="op" id="3151395">]</span><span class="builtintype" id="3151396">string</span>&nbsp;<span class="comment" id="3151403">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3151452">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151471">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3151484">[</span><span class="op" id="3151485">]</span><span class="builtintype" id="3151486">string</span>&nbsp;<span class="comment" id="3151493">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151519">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="3151532">[</span><span class="op" id="3151533">]</span><span class="builtintype" id="3151534">string</span>&nbsp;<span class="comment" id="3151541">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151569">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="3151582">[</span><span class="op" id="3151583">]</span><span class="builtintype" id="3151584">string</span>&nbsp;<span class="comment" id="3151591">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151619">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3151632">[</span><span class="op" id="3151633">]</span><span class="builtintype" id="3151634">string</span>&nbsp;<span class="comment" id="3151641">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151668">CgoPkgConfig</span>&nbsp;<span class="op" id="3151681">[</span><span class="op" id="3151682">]</span><span class="builtintype" id="3151683">string</span>&nbsp;<span class="comment" id="3151690">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3151721">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151748">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3151758">[</span><span class="op" id="3151759">]</span><span class="builtintype" id="3151760">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3151786">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151821">ImportPos</span>&nbsp;<span class="keyword" id="3151831">map</span><span class="op" id="3151834">[</span><span class="builtintype" id="3151835">string</span><span class="op" id="3151841">]</span><span class="op" id="3151842">[</span><span class="op" id="3151843">]</span><span class="ident" id="3151844">token</span><span class="op" id="3151849">.</span><span class="ident" id="3151850">Position</span>&nbsp;<span class="comment" id="3151859">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3151893">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151914">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3151929">[</span><span class="op" id="3151930">]</span><span class="builtintype" id="3151931">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3151957">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151987">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3152002">[</span><span class="op" id="3152003">]</span><span class="builtintype" id="3152004">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3152030">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3152059">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="3152074">map</span><span class="op" id="3152077">[</span><span class="builtintype" id="3152078">string</span><span class="op" id="3152084">]</span><span class="op" id="3152085">[</span><span class="op" id="3152086">]</span><span class="ident" id="3152087">token</span><span class="op" id="3152092">.</span><span class="ident" id="3152093">Position</span>&nbsp;<span class="comment" id="3152102">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3152139">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3152154">[</span><span class="op" id="3152155">]</span><span class="builtintype" id="3152156">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3152182">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3152217">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3152232">[</span><span class="op" id="3152233">]</span><span class="builtintype" id="3152234">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3152260">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3152290">XTestImportPos</span>&nbsp;<span class="keyword" id="3152305">map</span><span class="op" id="3152308">[</span><span class="builtintype" id="3152309">string</span><span class="op" id="3152315">]</span><span class="op" id="3152316">[</span><span class="op" id="3152317">]</span><span class="ident" id="3152318">token</span><span class="op" id="3152323">.</span><span class="ident" id="3152324">Position</span>&nbsp;<span class="comment" id="3152333">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="3152370">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="3152373">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3152430">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="3152479">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3152529">func</span>&nbsp;<span class="op" id="3152534">(</span><span class="ident" id="3152535">p</span>&nbsp;<span class="op" id="3152537">*</span><span class="ident" id="3152538">Package</span><span class="op" id="3152545">)</span>&nbsp;<span class="ident" id="3152547">IsCommand</span><span class="op" id="3152556">(</span><span class="op" id="3152557">)</span>&nbsp;<span class="builtintype" id="3152559">bool</span>&nbsp;<span class="op" id="3152564">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3152567">return</span>&nbsp;<span class="ident" id="3152574">p</span><span class="op" id="3152575">.</span><span class="ident" id="3152576">Name</span>&nbsp;<span class="op" id="3152581">==</span>&nbsp;<span class="string" id="3152584">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="3152591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3152594">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3152660">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="3152684">func</span>&nbsp;<span class="op" id="3152689">(</span><span class="ident" id="3152690">ctxt</span>&nbsp;<span class="op" id="3152695">*</span><span class="ident" id="3152696">Context</span><span class="op" id="3152703">)</span>&nbsp;<span class="ident" id="3152705">ImportDir</span><span class="op" id="3152714">(</span><span class="ident" id="3152715">dir</span>&nbsp;<span class="builtintype" id="3152719">string</span><span class="op" id="3152725">,</span>&nbsp;<span class="ident" id="3152727">mode</span>&nbsp;<span class="ident" id="3152732">ImportMode</span><span class="op" id="3152742">)</span>&nbsp;<span class="op" id="3152744">(</span><span class="op" id="3152745">*</span><span class="ident" id="3152746">Package</span><span class="op" id="3152753">,</span>&nbsp;<span class="builtintype" id="3152755">error</span><span class="op" id="3152760">)</span>&nbsp;<span class="op" id="3152762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3152765">return</span>&nbsp;<span class="ident" id="3152772">ctxt</span><span class="op" id="3152776">.</span><span class="ident" id="3152777">Import</span><span class="op" id="3152783">(</span><span class="string" id="3152784">&#34;.&#34;</span><span class="op" id="3152787">,</span>&nbsp;<span class="ident" id="3152789">dir</span><span class="op" id="3152792">,</span>&nbsp;<span class="ident" id="3152794">mode</span><span class="op" id="3152798">)</span><br>
<span class="lineno"></span><span class="op" id="3152800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3152803">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="3152868">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="3152934">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="3152989">type</span>&nbsp;<span class="ident" id="3152994">NoGoError</span>&nbsp;<span class="keyword" id="3153004">struct</span>&nbsp;<span class="op" id="3153011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3153014">Dir</span>&nbsp;<span class="builtintype" id="3153018">string</span><br>
<span class="lineno"></span><span class="op" id="3153025">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="3153028">func</span>&nbsp;<span class="op" id="3153033">(</span><span class="ident" id="3153034">e</span>&nbsp;<span class="op" id="3153036">*</span><span class="ident" id="3153037">NoGoError</span><span class="op" id="3153046">)</span>&nbsp;<span class="ident" id="3153048">Error</span><span class="op" id="3153053">(</span><span class="op" id="3153054">)</span>&nbsp;<span class="builtintype" id="3153056">string</span>&nbsp;<span class="op" id="3153063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153066">return</span>&nbsp;<span class="string" id="3153073">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="3153108">+</span>&nbsp;<span class="ident" id="3153110">e</span><span class="op" id="3153111">.</span><span class="ident" id="3153112">Dir</span><br>
<span class="lineno"></span><span class="op" id="3153116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="3153119">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="3153176">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="3153237">type</span>&nbsp;<span class="ident" id="3153242">MultiplePackageError</span>&nbsp;<span class="keyword" id="3153263">struct</span>&nbsp;<span class="op" id="3153270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3153273">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3153282">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3153291">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3153322">Packages</span>&nbsp;<span class="op" id="3153331">[</span><span class="op" id="3153332">]</span><span class="builtintype" id="3153333">string</span>&nbsp;<span class="comment" id="3153340">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3153364">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3153373">[</span><span class="op" id="3153374">]</span><span class="builtintype" id="3153375">string</span>&nbsp;<span class="comment" id="3153382">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="3153444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3153447">func</span>&nbsp;<span class="op" id="3153452">(</span><span class="ident" id="3153453">e</span>&nbsp;<span class="op" id="3153455">*</span><span class="ident" id="3153456">MultiplePackageError</span><span class="op" id="3153476">)</span>&nbsp;<span class="ident" id="3153478">Error</span><span class="op" id="3153483">(</span><span class="op" id="3153484">)</span>&nbsp;<span class="builtintype" id="3153486">string</span>&nbsp;<span class="op" id="3153493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3153496">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153555">return</span>&nbsp;<span class="ident" id="3153562">fmt</span><span class="op" id="3153565">.</span><span class="ident" id="3153566">Sprintf</span><span class="op" id="3153573">(</span><span class="string" id="3153574">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="3153616">,</span>&nbsp;<span class="ident" id="3153618">e</span><span class="op" id="3153619">.</span><span class="ident" id="3153620">Packages</span><span class="op" id="3153628">[</span><span class="num" id="3153629">0</span><span class="op" id="3153630">]</span><span class="op" id="3153631">,</span>&nbsp;<span class="ident" id="3153633">e</span><span class="op" id="3153634">.</span><span class="ident" id="3153635">Files</span><span class="op" id="3153640">[</span><span class="num" id="3153641">0</span><span class="op" id="3153642">]</span><span class="op" id="3153643">,</span>&nbsp;<span class="ident" id="3153645">e</span><span class="op" id="3153646">.</span><span class="ident" id="3153647">Packages</span><span class="op" id="3153655">[</span><span class="num" id="3153656">1</span><span class="op" id="3153657">]</span><span class="op" id="3153658">,</span>&nbsp;<span class="ident" id="3153660">e</span><span class="op" id="3153661">.</span><span class="ident" id="3153662">Files</span><span class="op" id="3153667">[</span><span class="num" id="3153668">1</span><span class="op" id="3153669">]</span><span class="op" id="3153670">,</span>&nbsp;<span class="ident" id="3153672">e</span><span class="op" id="3153673">.</span><span class="ident" id="3153674">Dir</span><span class="op" id="3153677">)</span><br>
<span class="lineno"></span><span class="op" id="3153679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3153682">func</span>&nbsp;<span class="ident" id="3153687">nameExt</span><span class="op" id="3153694">(</span><span class="ident" id="3153695">name</span>&nbsp;<span class="builtintype" id="3153700">string</span><span class="op" id="3153706">)</span>&nbsp;<span class="builtintype" id="3153708">string</span>&nbsp;<span class="op" id="3153715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3153718">i</span>&nbsp;<span class="op" id="3153720">:=</span>&nbsp;<span class="ident" id="3153723">strings</span><span class="op" id="3153730">.</span><span class="ident" id="3153731">LastIndex</span><span class="op" id="3153740">(</span><span class="ident" id="3153741">name</span><span class="op" id="3153745">,</span>&nbsp;<span class="string" id="3153747">&#34;.&#34;</span><span class="op" id="3153750">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153753">if</span>&nbsp;<span class="ident" id="3153756">i</span>&nbsp;<span class="op" id="3153758">&lt;</span>&nbsp;<span class="num" id="3153760">0</span>&nbsp;<span class="op" id="3153762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153766">return</span>&nbsp;<span class="string" id="3153773">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3153777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153780">return</span>&nbsp;<span class="ident" id="3153787">name</span><span class="op" id="3153791">[</span><span class="ident" id="3153792">i</span><span class="op" id="3153793">:</span><span class="op" id="3153794">]</span><br>
<span class="lineno"></span><span class="op" id="3153796">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="3153799">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="3153872">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="3153941">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="3154017">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="3154093">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3154110">//</span><br>
<span class="lineno"></span><span class="comment" id="3154113">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3154187">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="3154233">//</span><br>
<span class="lineno">450</span><span class="comment" id="3154236">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="3154276">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="3154340">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="3154403">//</span><br>
<span class="lineno"></span><span class="comment" id="3154406">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="3154474">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="3154518">//</span><br>
<span class="lineno"></span><span class="keyword" id="3154521">func</span>&nbsp;<span class="op" id="3154526">(</span><span class="ident" id="3154527">ctxt</span>&nbsp;<span class="op" id="3154532">*</span><span class="ident" id="3154533">Context</span><span class="op" id="3154540">)</span>&nbsp;<span class="ident" id="3154542">Import</span><span class="op" id="3154548">(</span><span class="ident" id="3154549">path</span>&nbsp;<span class="builtintype" id="3154554">string</span><span class="op" id="3154560">,</span>&nbsp;<span class="ident" id="3154562">srcDir</span>&nbsp;<span class="builtintype" id="3154569">string</span><span class="op" id="3154575">,</span>&nbsp;<span class="ident" id="3154577">mode</span>&nbsp;<span class="ident" id="3154582">ImportMode</span><span class="op" id="3154592">)</span>&nbsp;<span class="op" id="3154594">(</span><span class="op" id="3154595">*</span><span class="ident" id="3154596">Package</span><span class="op" id="3154603">,</span>&nbsp;<span class="builtintype" id="3154605">error</span><span class="op" id="3154610">)</span>&nbsp;<span class="op" id="3154612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3154615">p</span>&nbsp;<span class="op" id="3154617">:=</span>&nbsp;<span class="op" id="3154620">&amp;</span><span class="ident" id="3154621">Package</span><span class="op" id="3154628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3154632">ImportPath</span><span class="op" id="3154642">:</span>&nbsp;<span class="ident" id="3154644">path</span><span class="op" id="3154648">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3154651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3154654">if</span>&nbsp;<span class="ident" id="3154657">path</span>&nbsp;<span class="op" id="3154662">==</span>&nbsp;<span class="string" id="3154665">&#34;&#34;</span>&nbsp;<span class="op" id="3154668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3154672">return</span>&nbsp;<span class="ident" id="3154679">p</span><span class="op" id="3154680">,</span>&nbsp;<span class="ident" id="3154682">fmt</span><span class="op" id="3154685">.</span><span class="ident" id="3154686">Errorf</span><span class="op" id="3154692">(</span><span class="string" id="3154693">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="3154725">,</span>&nbsp;<span class="ident" id="3154727">path</span><span class="op" id="3154731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3154734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3154738">var</span>&nbsp;<span class="ident" id="3154742">pkga</span>&nbsp;<span class="builtintype" id="3154747">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3154755">var</span>&nbsp;<span class="ident" id="3154759">pkgerr</span>&nbsp;<span class="builtintype" id="3154766">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3154773">switch</span>&nbsp;<span class="ident" id="3154780">ctxt</span><span class="op" id="3154784">.</span><span class="ident" id="3154785">Compiler</span>&nbsp;<span class="op" id="3154794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3154797">case</span>&nbsp;<span class="string" id="3154802">&#34;gccgo&#34;</span><span class="op" id="3154809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3154813">dir</span><span class="op" id="3154816">,</span>&nbsp;<span class="ident" id="3154818">elem</span>&nbsp;<span class="op" id="3154823">:=</span>&nbsp;<span class="ident" id="3154826">pathpkg</span><span class="op" id="3154833">.</span><span class="ident" id="3154834">Split</span><span class="op" id="3154839">(</span><span class="ident" id="3154840">p</span><span class="op" id="3154841">.</span><span class="ident" id="3154842">ImportPath</span><span class="op" id="3154852">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3154856">pkga</span>&nbsp;<span class="op" id="3154861">=</span>&nbsp;<span class="string" id="3154863">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="3154876">+</span>&nbsp;<span class="ident" id="3154878">ctxt</span><span class="op" id="3154882">.</span><span class="ident" id="3154883">GOOS</span>&nbsp;<span class="op" id="3154888">+</span>&nbsp;<span class="string" id="3154890">&#34;_&#34;</span>&nbsp;<span class="op" id="3154894">+</span>&nbsp;<span class="ident" id="3154896">ctxt</span><span class="op" id="3154900">.</span><span class="ident" id="3154901">GOARCH</span>&nbsp;<span class="op" id="3154908">+</span>&nbsp;<span class="string" id="3154910">&#34;/&#34;</span>&nbsp;<span class="op" id="3154914">+</span>&nbsp;<span class="ident" id="3154916">dir</span>&nbsp;<span class="op" id="3154920">+</span>&nbsp;<span class="string" id="3154922">&#34;lib&#34;</span>&nbsp;<span class="op" id="3154928">+</span>&nbsp;<span class="ident" id="3154930">elem</span>&nbsp;<span class="op" id="3154935">+</span>&nbsp;<span class="string" id="3154937">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3154943">case</span>&nbsp;<span class="string" id="3154948">&#34;gc&#34;</span><span class="op" id="3154952">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3154956">suffix</span>&nbsp;<span class="op" id="3154963">:=</span>&nbsp;<span class="string" id="3154966">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3154971">if</span>&nbsp;<span class="ident" id="3154974">ctxt</span><span class="op" id="3154978">.</span><span class="ident" id="3154979">InstallSuffix</span>&nbsp;<span class="op" id="3154993">!=</span>&nbsp;<span class="string" id="3154996">&#34;&#34;</span>&nbsp;<span class="op" id="3154999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155004">suffix</span>&nbsp;<span class="op" id="3155011">=</span>&nbsp;<span class="string" id="3155013">&#34;_&#34;</span>&nbsp;<span class="op" id="3155017">+</span>&nbsp;<span class="ident" id="3155019">ctxt</span><span class="op" id="3155023">.</span><span class="ident" id="3155024">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3155040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155044">pkga</span>&nbsp;<span class="op" id="3155049">=</span>&nbsp;<span class="string" id="3155051">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="3155058">+</span>&nbsp;<span class="ident" id="3155060">ctxt</span><span class="op" id="3155064">.</span><span class="ident" id="3155065">GOOS</span>&nbsp;<span class="op" id="3155070">+</span>&nbsp;<span class="string" id="3155072">&#34;_&#34;</span>&nbsp;<span class="op" id="3155076">+</span>&nbsp;<span class="ident" id="3155078">ctxt</span><span class="op" id="3155082">.</span><span class="ident" id="3155083">GOARCH</span>&nbsp;<span class="op" id="3155090">+</span>&nbsp;<span class="ident" id="3155092">suffix</span>&nbsp;<span class="op" id="3155099">+</span>&nbsp;<span class="string" id="3155101">&#34;/&#34;</span>&nbsp;<span class="op" id="3155105">+</span>&nbsp;<span class="ident" id="3155107">p</span><span class="op" id="3155108">.</span><span class="ident" id="3155109">ImportPath</span>&nbsp;<span class="op" id="3155120">+</span>&nbsp;<span class="string" id="3155122">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155128">default</span><span class="op" id="3155135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3155139">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155176">pkgerr</span>&nbsp;<span class="op" id="3155183">=</span>&nbsp;<span class="ident" id="3155185">fmt</span><span class="op" id="3155188">.</span><span class="ident" id="3155189">Errorf</span><span class="op" id="3155195">(</span><span class="string" id="3155196">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="3155228">,</span>&nbsp;<span class="ident" id="3155230">path</span><span class="op" id="3155234">,</span>&nbsp;<span class="ident" id="3155236">ctxt</span><span class="op" id="3155240">.</span><span class="ident" id="3155241">Compiler</span><span class="op" id="3155249">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3155252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155256">binaryOnly</span>&nbsp;<span class="op" id="3155267">:=</span>&nbsp;<span class="builtintype" id="3155270">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155277">if</span>&nbsp;<span class="ident" id="3155280">IsLocalImport</span><span class="op" id="3155293">(</span><span class="ident" id="3155294">path</span><span class="op" id="3155298">)</span>&nbsp;<span class="op" id="3155300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155304">pkga</span>&nbsp;<span class="op" id="3155309">=</span>&nbsp;<span class="string" id="3155311">&#34;&#34;</span>&nbsp;<span class="comment" id="3155314">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155356">if</span>&nbsp;<span class="ident" id="3155359">srcDir</span>&nbsp;<span class="op" id="3155366">==</span>&nbsp;<span class="string" id="3155369">&#34;&#34;</span>&nbsp;<span class="op" id="3155372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155377">return</span>&nbsp;<span class="ident" id="3155384">p</span><span class="op" id="3155385">,</span>&nbsp;<span class="ident" id="3155387">fmt</span><span class="op" id="3155390">.</span><span class="ident" id="3155391">Errorf</span><span class="op" id="3155397">(</span><span class="string" id="3155398">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="3155447">,</span>&nbsp;<span class="ident" id="3155449">path</span><span class="op" id="3155453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3155457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155461">if</span>&nbsp;<span class="op" id="3155464">!</span><span class="ident" id="3155465">ctxt</span><span class="op" id="3155469">.</span><span class="ident" id="3155470">isAbsPath</span><span class="op" id="3155479">(</span><span class="ident" id="3155480">path</span><span class="op" id="3155484">)</span>&nbsp;<span class="op" id="3155486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155491">p</span><span class="op" id="3155492">.</span><span class="ident" id="3155493">Dir</span>&nbsp;<span class="op" id="3155497">=</span>&nbsp;<span class="ident" id="3155499">ctxt</span><span class="op" id="3155503">.</span><span class="ident" id="3155504">joinPath</span><span class="op" id="3155512">(</span><span class="ident" id="3155513">srcDir</span><span class="op" id="3155519">,</span>&nbsp;<span class="ident" id="3155521">path</span><span class="op" id="3155525">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3155529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3155533">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155579">if</span>&nbsp;<span class="ident" id="3155582">ctxt</span><span class="op" id="3155586">.</span><span class="ident" id="3155587">GOROOT</span>&nbsp;<span class="op" id="3155594">!=</span>&nbsp;<span class="string" id="3155597">&#34;&#34;</span>&nbsp;<span class="op" id="3155600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155605">root</span>&nbsp;<span class="op" id="3155610">:=</span>&nbsp;<span class="ident" id="3155613">ctxt</span><span class="op" id="3155617">.</span><span class="ident" id="3155618">joinPath</span><span class="op" id="3155626">(</span><span class="ident" id="3155627">ctxt</span><span class="op" id="3155631">.</span><span class="ident" id="3155632">GOROOT</span><span class="op" id="3155638">,</span>&nbsp;<span class="string" id="3155640">&#34;src&#34;</span><span class="op" id="3155645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155650">if</span>&nbsp;<span class="ident" id="3155653">sub</span><span class="op" id="3155656">,</span>&nbsp;<span class="ident" id="3155658">ok</span>&nbsp;<span class="op" id="3155661">:=</span>&nbsp;<span class="ident" id="3155664">ctxt</span><span class="op" id="3155668">.</span><span class="ident" id="3155669">hasSubdir</span><span class="op" id="3155678">(</span><span class="ident" id="3155679">root</span><span class="op" id="3155683">,</span>&nbsp;<span class="ident" id="3155685">p</span><span class="op" id="3155686">.</span><span class="ident" id="3155687">Dir</span><span class="op" id="3155690">)</span><span class="op" id="3155691">;</span>&nbsp;<span class="ident" id="3155693">ok</span>&nbsp;<span class="op" id="3155696">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155702">p</span><span class="op" id="3155703">.</span><span class="ident" id="3155704">Goroot</span>&nbsp;<span class="op" id="3155711">=</span>&nbsp;<span class="builtintype" id="3155713">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155722">p</span><span class="op" id="3155723">.</span><span class="ident" id="3155724">ImportPath</span>&nbsp;<span class="op" id="3155735">=</span>&nbsp;<span class="ident" id="3155737">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155745">p</span><span class="op" id="3155746">.</span><span class="ident" id="3155747">Root</span>&nbsp;<span class="op" id="3155752">=</span>&nbsp;<span class="ident" id="3155754">ctxt</span><span class="op" id="3155758">.</span><span class="ident" id="3155759">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155770">goto</span>&nbsp;<span class="ident" id="3155775">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3155784">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3155788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155792">all</span>&nbsp;<span class="op" id="3155796">:=</span>&nbsp;<span class="ident" id="3155799">ctxt</span><span class="op" id="3155803">.</span><span class="ident" id="3155804">gopath</span><span class="op" id="3155810">(</span><span class="op" id="3155811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155815">for</span>&nbsp;<span class="ident" id="3155819">i</span><span class="op" id="3155820">,</span>&nbsp;<span class="ident" id="3155822">root</span>&nbsp;<span class="op" id="3155827">:=</span>&nbsp;<span class="keyword" id="3155830">range</span>&nbsp;<span class="ident" id="3155836">all</span>&nbsp;<span class="op" id="3155840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3155845">rootsrc</span>&nbsp;<span class="op" id="3155853">:=</span>&nbsp;<span class="ident" id="3155856">ctxt</span><span class="op" id="3155860">.</span><span class="ident" id="3155861">joinPath</span><span class="op" id="3155869">(</span><span class="ident" id="3155870">root</span><span class="op" id="3155874">,</span>&nbsp;<span class="string" id="3155876">&#34;src&#34;</span><span class="op" id="3155881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3155886">if</span>&nbsp;<span class="ident" id="3155889">sub</span><span class="op" id="3155892">,</span>&nbsp;<span class="ident" id="3155894">ok</span>&nbsp;<span class="op" id="3155897">:=</span>&nbsp;<span class="ident" id="3155900">ctxt</span><span class="op" id="3155904">.</span><span class="ident" id="3155905">hasSubdir</span><span class="op" id="3155914">(</span><span class="ident" id="3155915">rootsrc</span><span class="op" id="3155922">,</span>&nbsp;<span class="ident" id="3155924">p</span><span class="op" id="3155925">.</span><span class="ident" id="3155926">Dir</span><span class="op" id="3155929">)</span><span class="op" id="3155930">;</span>&nbsp;<span class="ident" id="3155932">ok</span>&nbsp;<span class="op" id="3155935">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3155941">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3155990">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3156045">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156064">if</span>&nbsp;<span class="ident" id="3156067">ctxt</span><span class="op" id="3156071">.</span><span class="ident" id="3156072">GOROOT</span>&nbsp;<span class="op" id="3156079">!=</span>&nbsp;<span class="string" id="3156082">&#34;&#34;</span>&nbsp;<span class="op" id="3156085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156092">if</span>&nbsp;<span class="ident" id="3156095">dir</span>&nbsp;<span class="op" id="3156099">:=</span>&nbsp;<span class="ident" id="3156102">ctxt</span><span class="op" id="3156106">.</span><span class="ident" id="3156107">joinPath</span><span class="op" id="3156115">(</span><span class="ident" id="3156116">ctxt</span><span class="op" id="3156120">.</span><span class="ident" id="3156121">GOROOT</span><span class="op" id="3156127">,</span>&nbsp;<span class="string" id="3156129">&#34;src&#34;</span><span class="op" id="3156134">,</span>&nbsp;<span class="ident" id="3156136">sub</span><span class="op" id="3156139">)</span><span class="op" id="3156140">;</span>&nbsp;<span class="ident" id="3156142">ctxt</span><span class="op" id="3156146">.</span><span class="ident" id="3156147">isDir</span><span class="op" id="3156152">(</span><span class="ident" id="3156153">dir</span><span class="op" id="3156156">)</span>&nbsp;<span class="op" id="3156158">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3156166">p</span><span class="op" id="3156167">.</span><span class="ident" id="3156168">ConflictDir</span>&nbsp;<span class="op" id="3156180">=</span>&nbsp;<span class="ident" id="3156182">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156192">goto</span>&nbsp;<span class="ident" id="3156197">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156220">for</span>&nbsp;<span class="ident" id="3156224">_</span><span class="op" id="3156225">,</span>&nbsp;<span class="ident" id="3156227">earlyRoot</span>&nbsp;<span class="op" id="3156237">:=</span>&nbsp;<span class="keyword" id="3156240">range</span>&nbsp;<span class="ident" id="3156246">all</span><span class="op" id="3156249">[</span><span class="op" id="3156250">:</span><span class="ident" id="3156251">i</span><span class="op" id="3156252">]</span>&nbsp;<span class="op" id="3156254">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156261">if</span>&nbsp;<span class="ident" id="3156264">dir</span>&nbsp;<span class="op" id="3156268">:=</span>&nbsp;<span class="ident" id="3156271">ctxt</span><span class="op" id="3156275">.</span><span class="ident" id="3156276">joinPath</span><span class="op" id="3156284">(</span><span class="ident" id="3156285">earlyRoot</span><span class="op" id="3156294">,</span>&nbsp;<span class="string" id="3156296">&#34;src&#34;</span><span class="op" id="3156301">,</span>&nbsp;<span class="ident" id="3156303">sub</span><span class="op" id="3156306">)</span><span class="op" id="3156307">;</span>&nbsp;<span class="ident" id="3156309">ctxt</span><span class="op" id="3156313">.</span><span class="ident" id="3156314">isDir</span><span class="op" id="3156319">(</span><span class="ident" id="3156320">dir</span><span class="op" id="3156323">)</span>&nbsp;<span class="op" id="3156325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3156333">p</span><span class="op" id="3156334">.</span><span class="ident" id="3156335">ConflictDir</span>&nbsp;<span class="op" id="3156347">=</span>&nbsp;<span class="ident" id="3156349">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156359">goto</span>&nbsp;<span class="ident" id="3156364">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156381">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3156388">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3156456">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3156474">p</span><span class="op" id="3156475">.</span><span class="ident" id="3156476">ImportPath</span>&nbsp;<span class="op" id="3156487">=</span>&nbsp;<span class="ident" id="3156489">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3156497">p</span><span class="op" id="3156498">.</span><span class="ident" id="3156499">Root</span>&nbsp;<span class="op" id="3156504">=</span>&nbsp;<span class="ident" id="3156506">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156515">goto</span>&nbsp;<span class="ident" id="3156520">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3156537">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3156595">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156640">}</span>&nbsp;<span class="keyword" id="3156642">else</span>&nbsp;<span class="op" id="3156647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156651">if</span>&nbsp;<span class="ident" id="3156654">strings</span><span class="op" id="3156661">.</span><span class="ident" id="3156662">HasPrefix</span><span class="op" id="3156671">(</span><span class="ident" id="3156672">path</span><span class="op" id="3156676">,</span>&nbsp;<span class="string" id="3156678">&#34;/&#34;</span><span class="op" id="3156681">)</span>&nbsp;<span class="op" id="3156683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156688">return</span>&nbsp;<span class="ident" id="3156695">p</span><span class="op" id="3156696">,</span>&nbsp;<span class="ident" id="3156698">fmt</span><span class="op" id="3156701">.</span><span class="ident" id="3156702">Errorf</span><span class="op" id="3156708">(</span><span class="string" id="3156709">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="3156749">,</span>&nbsp;<span class="ident" id="3156751">path</span><span class="op" id="3156755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3156764">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156828">var</span>&nbsp;<span class="ident" id="3156832">tried</span>&nbsp;<span class="keyword" id="3156838">struct</span>&nbsp;<span class="op" id="3156845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3156850">goroot</span>&nbsp;<span class="builtintype" id="3156857">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3156867">gopath</span>&nbsp;<span class="op" id="3156874">[</span><span class="op" id="3156875">]</span><span class="builtintype" id="3156876">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156885">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3156890">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3156933">if</span>&nbsp;<span class="ident" id="3156936">ctxt</span><span class="op" id="3156940">.</span><span class="ident" id="3156941">GOROOT</span>&nbsp;<span class="op" id="3156948">!=</span>&nbsp;<span class="string" id="3156951">&#34;&#34;</span>&nbsp;<span class="op" id="3156954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3156959">dir</span>&nbsp;<span class="op" id="3156963">:=</span>&nbsp;<span class="ident" id="3156966">ctxt</span><span class="op" id="3156970">.</span><span class="ident" id="3156971">joinPath</span><span class="op" id="3156979">(</span><span class="ident" id="3156980">ctxt</span><span class="op" id="3156984">.</span><span class="ident" id="3156985">GOROOT</span><span class="op" id="3156991">,</span>&nbsp;<span class="string" id="3156993">&#34;src&#34;</span><span class="op" id="3156998">,</span>&nbsp;<span class="ident" id="3157000">path</span><span class="op" id="3157004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157009">isDir</span>&nbsp;<span class="op" id="3157015">:=</span>&nbsp;<span class="ident" id="3157018">ctxt</span><span class="op" id="3157022">.</span><span class="ident" id="3157023">isDir</span><span class="op" id="3157028">(</span><span class="ident" id="3157029">dir</span><span class="op" id="3157032">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157037">binaryOnly</span>&nbsp;<span class="op" id="3157048">=</span>&nbsp;<span class="op" id="3157050">!</span><span class="ident" id="3157051">isDir</span>&nbsp;<span class="op" id="3157057">&amp;&amp;</span>&nbsp;<span class="ident" id="3157060">mode</span><span class="op" id="3157064">&amp;</span><span class="ident" id="3157065">AllowBinary</span>&nbsp;<span class="op" id="3157077">!=</span>&nbsp;<span class="num" id="3157080">0</span>&nbsp;<span class="op" id="3157082">&amp;&amp;</span>&nbsp;<span class="ident" id="3157085">pkga</span>&nbsp;<span class="op" id="3157090">!=</span>&nbsp;<span class="string" id="3157093">&#34;&#34;</span>&nbsp;<span class="op" id="3157096">&amp;&amp;</span>&nbsp;<span class="ident" id="3157099">ctxt</span><span class="op" id="3157103">.</span><span class="ident" id="3157104">isFile</span><span class="op" id="3157110">(</span><span class="ident" id="3157111">ctxt</span><span class="op" id="3157115">.</span><span class="ident" id="3157116">joinPath</span><span class="op" id="3157124">(</span><span class="ident" id="3157125">ctxt</span><span class="op" id="3157129">.</span><span class="ident" id="3157130">GOROOT</span><span class="op" id="3157136">,</span>&nbsp;<span class="ident" id="3157138">pkga</span><span class="op" id="3157142">)</span><span class="op" id="3157143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157148">if</span>&nbsp;<span class="ident" id="3157151">isDir</span>&nbsp;<span class="op" id="3157157">||</span>&nbsp;<span class="ident" id="3157160">binaryOnly</span>&nbsp;<span class="op" id="3157171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157177">p</span><span class="op" id="3157178">.</span><span class="ident" id="3157179">Dir</span>&nbsp;<span class="op" id="3157183">=</span>&nbsp;<span class="ident" id="3157185">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157193">p</span><span class="op" id="3157194">.</span><span class="ident" id="3157195">Goroot</span>&nbsp;<span class="op" id="3157202">=</span>&nbsp;<span class="builtintype" id="3157204">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157213">p</span><span class="op" id="3157214">.</span><span class="ident" id="3157215">Root</span>&nbsp;<span class="op" id="3157220">=</span>&nbsp;<span class="ident" id="3157222">ctxt</span><span class="op" id="3157226">.</span><span class="ident" id="3157227">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157238">goto</span>&nbsp;<span class="ident" id="3157243">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3157252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157257">tried</span><span class="op" id="3157262">.</span><span class="ident" id="3157263">goroot</span>&nbsp;<span class="op" id="3157270">=</span>&nbsp;<span class="ident" id="3157272">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3157278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157282">for</span>&nbsp;<span class="ident" id="3157286">_</span><span class="op" id="3157287">,</span>&nbsp;<span class="ident" id="3157289">root</span>&nbsp;<span class="op" id="3157294">:=</span>&nbsp;<span class="keyword" id="3157297">range</span>&nbsp;<span class="ident" id="3157303">ctxt</span><span class="op" id="3157307">.</span><span class="ident" id="3157308">gopath</span><span class="op" id="3157314">(</span><span class="op" id="3157315">)</span>&nbsp;<span class="op" id="3157317">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157322">dir</span>&nbsp;<span class="op" id="3157326">:=</span>&nbsp;<span class="ident" id="3157329">ctxt</span><span class="op" id="3157333">.</span><span class="ident" id="3157334">joinPath</span><span class="op" id="3157342">(</span><span class="ident" id="3157343">root</span><span class="op" id="3157347">,</span>&nbsp;<span class="string" id="3157349">&#34;src&#34;</span><span class="op" id="3157354">,</span>&nbsp;<span class="ident" id="3157356">path</span><span class="op" id="3157360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157365">isDir</span>&nbsp;<span class="op" id="3157371">:=</span>&nbsp;<span class="ident" id="3157374">ctxt</span><span class="op" id="3157378">.</span><span class="ident" id="3157379">isDir</span><span class="op" id="3157384">(</span><span class="ident" id="3157385">dir</span><span class="op" id="3157388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157393">binaryOnly</span>&nbsp;<span class="op" id="3157404">=</span>&nbsp;<span class="op" id="3157406">!</span><span class="ident" id="3157407">isDir</span>&nbsp;<span class="op" id="3157413">&amp;&amp;</span>&nbsp;<span class="ident" id="3157416">mode</span><span class="op" id="3157420">&amp;</span><span class="ident" id="3157421">AllowBinary</span>&nbsp;<span class="op" id="3157433">!=</span>&nbsp;<span class="num" id="3157436">0</span>&nbsp;<span class="op" id="3157438">&amp;&amp;</span>&nbsp;<span class="ident" id="3157441">pkga</span>&nbsp;<span class="op" id="3157446">!=</span>&nbsp;<span class="string" id="3157449">&#34;&#34;</span>&nbsp;<span class="op" id="3157452">&amp;&amp;</span>&nbsp;<span class="ident" id="3157455">ctxt</span><span class="op" id="3157459">.</span><span class="ident" id="3157460">isFile</span><span class="op" id="3157466">(</span><span class="ident" id="3157467">ctxt</span><span class="op" id="3157471">.</span><span class="ident" id="3157472">joinPath</span><span class="op" id="3157480">(</span><span class="ident" id="3157481">root</span><span class="op" id="3157485">,</span>&nbsp;<span class="ident" id="3157487">pkga</span><span class="op" id="3157491">)</span><span class="op" id="3157492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157497">if</span>&nbsp;<span class="ident" id="3157500">isDir</span>&nbsp;<span class="op" id="3157506">||</span>&nbsp;<span class="ident" id="3157509">binaryOnly</span>&nbsp;<span class="op" id="3157520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157526">p</span><span class="op" id="3157527">.</span><span class="ident" id="3157528">Dir</span>&nbsp;<span class="op" id="3157532">=</span>&nbsp;<span class="ident" id="3157534">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157542">p</span><span class="op" id="3157543">.</span><span class="ident" id="3157544">Root</span>&nbsp;<span class="op" id="3157549">=</span>&nbsp;<span class="ident" id="3157551">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157560">goto</span>&nbsp;<span class="ident" id="3157565">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3157574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157579">tried</span><span class="op" id="3157584">.</span><span class="ident" id="3157585">gopath</span>&nbsp;<span class="op" id="3157592">=</span>&nbsp;<span class="builtinfunc" id="3157594">append</span><span class="op" id="3157600">(</span><span class="ident" id="3157601">tried</span><span class="op" id="3157606">.</span><span class="ident" id="3157607">gopath</span><span class="op" id="3157613">,</span>&nbsp;<span class="ident" id="3157615">dir</span><span class="op" id="3157618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3157622">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3157627">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157654">var</span>&nbsp;<span class="ident" id="3157658">paths</span>&nbsp;<span class="op" id="3157664">[</span><span class="op" id="3157665">]</span><span class="builtintype" id="3157666">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157675">if</span>&nbsp;<span class="ident" id="3157678">tried</span><span class="op" id="3157683">.</span><span class="ident" id="3157684">goroot</span>&nbsp;<span class="op" id="3157691">!=</span>&nbsp;<span class="string" id="3157694">&#34;&#34;</span>&nbsp;<span class="op" id="3157697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157702">paths</span>&nbsp;<span class="op" id="3157708">=</span>&nbsp;<span class="builtinfunc" id="3157710">append</span><span class="op" id="3157716">(</span><span class="ident" id="3157717">paths</span><span class="op" id="3157722">,</span>&nbsp;<span class="ident" id="3157724">fmt</span><span class="op" id="3157727">.</span><span class="ident" id="3157728">Sprintf</span><span class="op" id="3157735">(</span><span class="string" id="3157736">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="3157757">,</span>&nbsp;<span class="ident" id="3157759">tried</span><span class="op" id="3157764">.</span><span class="ident" id="3157765">goroot</span><span class="op" id="3157771">)</span><span class="op" id="3157772">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3157776">}</span>&nbsp;<span class="keyword" id="3157778">else</span>&nbsp;<span class="op" id="3157783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157788">paths</span>&nbsp;<span class="op" id="3157794">=</span>&nbsp;<span class="builtinfunc" id="3157796">append</span><span class="op" id="3157802">(</span><span class="ident" id="3157803">paths</span><span class="op" id="3157808">,</span>&nbsp;<span class="string" id="3157810">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="3157831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3157835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157839">var</span>&nbsp;<span class="ident" id="3157843">i</span>&nbsp;<span class="builtintype" id="3157845">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157851">var</span>&nbsp;<span class="ident" id="3157855">format</span>&nbsp;<span class="op" id="3157862">=</span>&nbsp;<span class="string" id="3157864">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157888">for</span>&nbsp;<span class="op" id="3157892">;</span>&nbsp;<span class="ident" id="3157894">i</span>&nbsp;<span class="op" id="3157896">&lt;</span>&nbsp;<span class="builtinfunc" id="3157898">len</span><span class="op" id="3157901">(</span><span class="ident" id="3157902">tried</span><span class="op" id="3157907">.</span><span class="ident" id="3157908">gopath</span><span class="op" id="3157914">)</span><span class="op" id="3157915">;</span>&nbsp;<span class="ident" id="3157917">i</span><span class="op" id="3157918">++</span>&nbsp;<span class="op" id="3157921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3157926">if</span>&nbsp;<span class="ident" id="3157929">i</span>&nbsp;<span class="op" id="3157931">&gt;</span>&nbsp;<span class="num" id="3157933">0</span>&nbsp;<span class="op" id="3157935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157941">format</span>&nbsp;<span class="op" id="3157948">=</span>&nbsp;<span class="string" id="3157950">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3157960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3157965">paths</span>&nbsp;<span class="op" id="3157971">=</span>&nbsp;<span class="builtinfunc" id="3157973">append</span><span class="op" id="3157979">(</span><span class="ident" id="3157980">paths</span><span class="op" id="3157985">,</span>&nbsp;<span class="ident" id="3157987">fmt</span><span class="op" id="3157990">.</span><span class="ident" id="3157991">Sprintf</span><span class="op" id="3157998">(</span><span class="ident" id="3157999">format</span><span class="op" id="3158005">,</span>&nbsp;<span class="ident" id="3158007">tried</span><span class="op" id="3158012">.</span><span class="ident" id="3158013">gopath</span><span class="op" id="3158019">[</span><span class="ident" id="3158020">i</span><span class="op" id="3158021">]</span><span class="op" id="3158022">)</span><span class="op" id="3158023">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3158027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158031">if</span>&nbsp;<span class="ident" id="3158034">i</span>&nbsp;<span class="op" id="3158036">==</span>&nbsp;<span class="num" id="3158039">0</span>&nbsp;<span class="op" id="3158041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158046">paths</span>&nbsp;<span class="op" id="3158052">=</span>&nbsp;<span class="builtinfunc" id="3158054">append</span><span class="op" id="3158060">(</span><span class="ident" id="3158061">paths</span><span class="op" id="3158066">,</span>&nbsp;<span class="string" id="3158068">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="3158089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3158093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158097">return</span>&nbsp;<span class="ident" id="3158104">p</span><span class="op" id="3158105">,</span>&nbsp;<span class="ident" id="3158107">fmt</span><span class="op" id="3158110">.</span><span class="ident" id="3158111">Errorf</span><span class="op" id="3158117">(</span><span class="string" id="3158118">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="3158157">,</span>&nbsp;<span class="ident" id="3158159">path</span><span class="op" id="3158163">,</span>&nbsp;<span class="ident" id="3158165">strings</span><span class="op" id="3158172">.</span><span class="ident" id="3158173">Join</span><span class="op" id="3158177">(</span><span class="ident" id="3158178">paths</span><span class="op" id="3158183">,</span>&nbsp;<span class="string" id="3158185">&#34;\n&#34;</span><span class="op" id="3158189">)</span><span class="op" id="3158190">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3158193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="3158196">Found</span><span class="op" id="3158201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158204">if</span>&nbsp;<span class="ident" id="3158207">p</span><span class="op" id="3158208">.</span><span class="ident" id="3158209">Root</span>&nbsp;<span class="op" id="3158214">!=</span>&nbsp;<span class="string" id="3158217">&#34;&#34;</span>&nbsp;<span class="op" id="3158220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158224">p</span><span class="op" id="3158225">.</span><span class="ident" id="3158226">SrcRoot</span>&nbsp;<span class="op" id="3158234">=</span>&nbsp;<span class="ident" id="3158236">ctxt</span><span class="op" id="3158240">.</span><span class="ident" id="3158241">joinPath</span><span class="op" id="3158249">(</span><span class="ident" id="3158250">p</span><span class="op" id="3158251">.</span><span class="ident" id="3158252">Root</span><span class="op" id="3158256">,</span>&nbsp;<span class="string" id="3158258">&#34;src&#34;</span><span class="op" id="3158263">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158267">p</span><span class="op" id="3158268">.</span><span class="ident" id="3158269">PkgRoot</span>&nbsp;<span class="op" id="3158277">=</span>&nbsp;<span class="ident" id="3158279">ctxt</span><span class="op" id="3158283">.</span><span class="ident" id="3158284">joinPath</span><span class="op" id="3158292">(</span><span class="ident" id="3158293">p</span><span class="op" id="3158294">.</span><span class="ident" id="3158295">Root</span><span class="op" id="3158299">,</span>&nbsp;<span class="string" id="3158301">&#34;pkg&#34;</span><span class="op" id="3158306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158310">p</span><span class="op" id="3158311">.</span><span class="ident" id="3158312">BinDir</span>&nbsp;<span class="op" id="3158319">=</span>&nbsp;<span class="ident" id="3158321">ctxt</span><span class="op" id="3158325">.</span><span class="ident" id="3158326">joinPath</span><span class="op" id="3158334">(</span><span class="ident" id="3158335">p</span><span class="op" id="3158336">.</span><span class="ident" id="3158337">Root</span><span class="op" id="3158341">,</span>&nbsp;<span class="string" id="3158343">&#34;bin&#34;</span><span class="op" id="3158348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158352">if</span>&nbsp;<span class="ident" id="3158355">pkga</span>&nbsp;<span class="op" id="3158360">!=</span>&nbsp;<span class="string" id="3158363">&#34;&#34;</span>&nbsp;<span class="op" id="3158366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158371">p</span><span class="op" id="3158372">.</span><span class="ident" id="3158373">PkgObj</span>&nbsp;<span class="op" id="3158380">=</span>&nbsp;<span class="ident" id="3158382">ctxt</span><span class="op" id="3158386">.</span><span class="ident" id="3158387">joinPath</span><span class="op" id="3158395">(</span><span class="ident" id="3158396">p</span><span class="op" id="3158397">.</span><span class="ident" id="3158398">Root</span><span class="op" id="3158402">,</span>&nbsp;<span class="ident" id="3158404">pkga</span><span class="op" id="3158408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3158412">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3158415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158419">if</span>&nbsp;<span class="ident" id="3158422">mode</span><span class="op" id="3158426">&amp;</span><span class="ident" id="3158427">FindOnly</span>&nbsp;<span class="op" id="3158436">!=</span>&nbsp;<span class="num" id="3158439">0</span>&nbsp;<span class="op" id="3158441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158445">return</span>&nbsp;<span class="ident" id="3158452">p</span><span class="op" id="3158453">,</span>&nbsp;<span class="ident" id="3158455">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3158463">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158466">if</span>&nbsp;<span class="ident" id="3158469">binaryOnly</span>&nbsp;<span class="op" id="3158480">&amp;&amp;</span>&nbsp;<span class="op" id="3158483">(</span><span class="ident" id="3158484">mode</span><span class="op" id="3158488">&amp;</span><span class="ident" id="3158489">AllowBinary</span><span class="op" id="3158500">)</span>&nbsp;<span class="op" id="3158502">!=</span>&nbsp;<span class="num" id="3158505">0</span>&nbsp;<span class="op" id="3158507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158511">return</span>&nbsp;<span class="ident" id="3158518">p</span><span class="op" id="3158519">,</span>&nbsp;<span class="ident" id="3158521">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3158529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158533">dirs</span><span class="op" id="3158537">,</span>&nbsp;<span class="ident" id="3158539">err</span>&nbsp;<span class="op" id="3158543">:=</span>&nbsp;<span class="ident" id="3158546">ctxt</span><span class="op" id="3158550">.</span><span class="ident" id="3158551">readDir</span><span class="op" id="3158558">(</span><span class="ident" id="3158559">p</span><span class="op" id="3158560">.</span><span class="ident" id="3158561">Dir</span><span class="op" id="3158564">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158567">if</span>&nbsp;<span class="ident" id="3158570">err</span>&nbsp;<span class="op" id="3158574">!=</span>&nbsp;<span class="builtintype" id="3158577">nil</span>&nbsp;<span class="op" id="3158581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158585">return</span>&nbsp;<span class="ident" id="3158592">p</span><span class="op" id="3158593">,</span>&nbsp;<span class="ident" id="3158595">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3158600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158604">var</span>&nbsp;<span class="ident" id="3158608">Sfiles</span>&nbsp;<span class="op" id="3158615">[</span><span class="op" id="3158616">]</span><span class="builtintype" id="3158617">string</span>&nbsp;<span class="comment" id="3158624">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158656">var</span>&nbsp;<span class="ident" id="3158660">firstFile</span><span class="op" id="3158669">,</span>&nbsp;<span class="ident" id="3158671">firstCommentFile</span>&nbsp;<span class="builtintype" id="3158688">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158696">imported</span>&nbsp;<span class="op" id="3158705">:=</span>&nbsp;<span class="builtinfunc" id="3158708">make</span><span class="op" id="3158712">(</span><span class="keyword" id="3158713">map</span><span class="op" id="3158716">[</span><span class="builtintype" id="3158717">string</span><span class="op" id="3158723">]</span><span class="op" id="3158724">[</span><span class="op" id="3158725">]</span><span class="ident" id="3158726">token</span><span class="op" id="3158731">.</span><span class="ident" id="3158732">Position</span><span class="op" id="3158740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158743">testImported</span>&nbsp;<span class="op" id="3158756">:=</span>&nbsp;<span class="builtinfunc" id="3158759">make</span><span class="op" id="3158763">(</span><span class="keyword" id="3158764">map</span><span class="op" id="3158767">[</span><span class="builtintype" id="3158768">string</span><span class="op" id="3158774">]</span><span class="op" id="3158775">[</span><span class="op" id="3158776">]</span><span class="ident" id="3158777">token</span><span class="op" id="3158782">.</span><span class="ident" id="3158783">Position</span><span class="op" id="3158791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158794">xTestImported</span>&nbsp;<span class="op" id="3158808">:=</span>&nbsp;<span class="builtinfunc" id="3158811">make</span><span class="op" id="3158815">(</span><span class="keyword" id="3158816">map</span><span class="op" id="3158819">[</span><span class="builtintype" id="3158820">string</span><span class="op" id="3158826">]</span><span class="op" id="3158827">[</span><span class="op" id="3158828">]</span><span class="ident" id="3158829">token</span><span class="op" id="3158834">.</span><span class="ident" id="3158835">Position</span><span class="op" id="3158843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158846">allTags</span>&nbsp;<span class="op" id="3158854">:=</span>&nbsp;<span class="builtinfunc" id="3158857">make</span><span class="op" id="3158861">(</span><span class="keyword" id="3158862">map</span><span class="op" id="3158865">[</span><span class="builtintype" id="3158866">string</span><span class="op" id="3158872">]</span><span class="builtintype" id="3158873">bool</span><span class="op" id="3158877">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158880">fset</span>&nbsp;<span class="op" id="3158885">:=</span>&nbsp;<span class="ident" id="3158888">token</span><span class="op" id="3158893">.</span><span class="ident" id="3158894">NewFileSet</span><span class="op" id="3158904">(</span><span class="op" id="3158905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158908">for</span>&nbsp;<span class="ident" id="3158912">_</span><span class="op" id="3158913">,</span>&nbsp;<span class="ident" id="3158915">d</span>&nbsp;<span class="op" id="3158917">:=</span>&nbsp;<span class="keyword" id="3158920">range</span>&nbsp;<span class="ident" id="3158926">dirs</span>&nbsp;<span class="op" id="3158931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158935">if</span>&nbsp;<span class="ident" id="3158938">d</span><span class="op" id="3158939">.</span><span class="ident" id="3158940">IsDir</span><span class="op" id="3158945">(</span><span class="op" id="3158946">)</span>&nbsp;<span class="op" id="3158948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3158953">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3158964">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158969">name</span>&nbsp;<span class="op" id="3158974">:=</span>&nbsp;<span class="ident" id="3158977">d</span><span class="op" id="3158978">.</span><span class="ident" id="3158979">Name</span><span class="op" id="3158983">(</span><span class="op" id="3158984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3158988">ext</span>&nbsp;<span class="op" id="3158992">:=</span>&nbsp;<span class="ident" id="3158995">nameExt</span><span class="op" id="3159002">(</span><span class="ident" id="3159003">name</span><span class="op" id="3159007">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159012">match</span><span class="op" id="3159017">,</span>&nbsp;<span class="ident" id="3159019">data</span><span class="op" id="3159023">,</span>&nbsp;<span class="ident" id="3159025">filename</span><span class="op" id="3159033">,</span>&nbsp;<span class="ident" id="3159035">err</span>&nbsp;<span class="op" id="3159039">:=</span>&nbsp;<span class="ident" id="3159042">ctxt</span><span class="op" id="3159046">.</span><span class="ident" id="3159047">matchFile</span><span class="op" id="3159056">(</span><span class="ident" id="3159057">p</span><span class="op" id="3159058">.</span><span class="ident" id="3159059">Dir</span><span class="op" id="3159062">,</span>&nbsp;<span class="ident" id="3159064">name</span><span class="op" id="3159068">,</span>&nbsp;<span class="builtintype" id="3159070">true</span><span class="op" id="3159074">,</span>&nbsp;<span class="ident" id="3159076">allTags</span><span class="op" id="3159083">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159087">if</span>&nbsp;<span class="ident" id="3159090">err</span>&nbsp;<span class="op" id="3159094">!=</span>&nbsp;<span class="builtintype" id="3159097">nil</span>&nbsp;<span class="op" id="3159101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159106">return</span>&nbsp;<span class="ident" id="3159113">p</span><span class="op" id="3159114">,</span>&nbsp;<span class="ident" id="3159116">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3159122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159126">if</span>&nbsp;<span class="op" id="3159129">!</span><span class="ident" id="3159130">match</span>&nbsp;<span class="op" id="3159136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159141">if</span>&nbsp;<span class="ident" id="3159144">ext</span>&nbsp;<span class="op" id="3159148">==</span>&nbsp;<span class="string" id="3159151">&#34;.go&#34;</span>&nbsp;<span class="op" id="3159157">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159163">p</span><span class="op" id="3159164">.</span><span class="ident" id="3159165">IgnoredGoFiles</span>&nbsp;<span class="op" id="3159180">=</span>&nbsp;<span class="builtinfunc" id="3159182">append</span><span class="op" id="3159188">(</span><span class="ident" id="3159189">p</span><span class="op" id="3159190">.</span><span class="ident" id="3159191">IgnoredGoFiles</span><span class="op" id="3159205">,</span>&nbsp;<span class="ident" id="3159207">name</span><span class="op" id="3159211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3159216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159221">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3159232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3159237">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159300">switch</span>&nbsp;<span class="ident" id="3159307">ext</span>&nbsp;<span class="op" id="3159311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159315">case</span>&nbsp;<span class="string" id="3159320">&#34;.c&#34;</span><span class="op" id="3159324">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159329">p</span><span class="op" id="3159330">.</span><span class="ident" id="3159331">CFiles</span>&nbsp;<span class="op" id="3159338">=</span>&nbsp;<span class="builtinfunc" id="3159340">append</span><span class="op" id="3159346">(</span><span class="ident" id="3159347">p</span><span class="op" id="3159348">.</span><span class="ident" id="3159349">CFiles</span><span class="op" id="3159355">,</span>&nbsp;<span class="ident" id="3159357">name</span><span class="op" id="3159361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159366">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159377">case</span>&nbsp;<span class="string" id="3159382">&#34;.cc&#34;</span><span class="op" id="3159387">,</span>&nbsp;<span class="string" id="3159389">&#34;.cpp&#34;</span><span class="op" id="3159395">,</span>&nbsp;<span class="string" id="3159397">&#34;.cxx&#34;</span><span class="op" id="3159403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159408">p</span><span class="op" id="3159409">.</span><span class="ident" id="3159410">CXXFiles</span>&nbsp;<span class="op" id="3159419">=</span>&nbsp;<span class="builtinfunc" id="3159421">append</span><span class="op" id="3159427">(</span><span class="ident" id="3159428">p</span><span class="op" id="3159429">.</span><span class="ident" id="3159430">CXXFiles</span><span class="op" id="3159438">,</span>&nbsp;<span class="ident" id="3159440">name</span><span class="op" id="3159444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159449">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159460">case</span>&nbsp;<span class="string" id="3159465">&#34;.m&#34;</span><span class="op" id="3159469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159474">p</span><span class="op" id="3159475">.</span><span class="ident" id="3159476">MFiles</span>&nbsp;<span class="op" id="3159483">=</span>&nbsp;<span class="builtinfunc" id="3159485">append</span><span class="op" id="3159491">(</span><span class="ident" id="3159492">p</span><span class="op" id="3159493">.</span><span class="ident" id="3159494">MFiles</span><span class="op" id="3159500">,</span>&nbsp;<span class="ident" id="3159502">name</span><span class="op" id="3159506">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159511">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159522">case</span>&nbsp;<span class="string" id="3159527">&#34;.h&#34;</span><span class="op" id="3159531">,</span>&nbsp;<span class="string" id="3159533">&#34;.hh&#34;</span><span class="op" id="3159538">,</span>&nbsp;<span class="string" id="3159540">&#34;.hpp&#34;</span><span class="op" id="3159546">,</span>&nbsp;<span class="string" id="3159548">&#34;.hxx&#34;</span><span class="op" id="3159554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159559">p</span><span class="op" id="3159560">.</span><span class="ident" id="3159561">HFiles</span>&nbsp;<span class="op" id="3159568">=</span>&nbsp;<span class="builtinfunc" id="3159570">append</span><span class="op" id="3159576">(</span><span class="ident" id="3159577">p</span><span class="op" id="3159578">.</span><span class="ident" id="3159579">HFiles</span><span class="op" id="3159585">,</span>&nbsp;<span class="ident" id="3159587">name</span><span class="op" id="3159591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159596">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159607">case</span>&nbsp;<span class="string" id="3159612">&#34;.s&#34;</span><span class="op" id="3159616">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159621">p</span><span class="op" id="3159622">.</span><span class="ident" id="3159623">SFiles</span>&nbsp;<span class="op" id="3159630">=</span>&nbsp;<span class="builtinfunc" id="3159632">append</span><span class="op" id="3159638">(</span><span class="ident" id="3159639">p</span><span class="op" id="3159640">.</span><span class="ident" id="3159641">SFiles</span><span class="op" id="3159647">,</span>&nbsp;<span class="ident" id="3159649">name</span><span class="op" id="3159653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159658">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159669">case</span>&nbsp;<span class="string" id="3159674">&#34;.S&#34;</span><span class="op" id="3159678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159683">Sfiles</span>&nbsp;<span class="op" id="3159690">=</span>&nbsp;<span class="builtinfunc" id="3159692">append</span><span class="op" id="3159698">(</span><span class="ident" id="3159699">Sfiles</span><span class="op" id="3159705">,</span>&nbsp;<span class="ident" id="3159707">name</span><span class="op" id="3159711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159716">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159727">case</span>&nbsp;<span class="string" id="3159732">&#34;.swig&#34;</span><span class="op" id="3159739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159744">p</span><span class="op" id="3159745">.</span><span class="ident" id="3159746">SwigFiles</span>&nbsp;<span class="op" id="3159756">=</span>&nbsp;<span class="builtinfunc" id="3159758">append</span><span class="op" id="3159764">(</span><span class="ident" id="3159765">p</span><span class="op" id="3159766">.</span><span class="ident" id="3159767">SwigFiles</span><span class="op" id="3159776">,</span>&nbsp;<span class="ident" id="3159778">name</span><span class="op" id="3159782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159787">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159798">case</span>&nbsp;<span class="string" id="3159803">&#34;.swigcxx&#34;</span><span class="op" id="3159813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3159818">p</span><span class="op" id="3159819">.</span><span class="ident" id="3159820">SwigCXXFiles</span>&nbsp;<span class="op" id="3159833">=</span>&nbsp;<span class="builtinfunc" id="3159835">append</span><span class="op" id="3159841">(</span><span class="ident" id="3159842">p</span><span class="op" id="3159843">.</span><span class="ident" id="3159844">SwigCXXFiles</span><span class="op" id="3159856">,</span>&nbsp;<span class="ident" id="3159858">name</span><span class="op" id="3159862">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159867">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3159878">case</span>&nbsp;<span class="string" id="3159883">&#34;.syso&#34;</span><span class="op" id="3159890">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3159895">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3159942">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3159989">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160042">p</span><span class="op" id="3160043">.</span><span class="ident" id="3160044">SysoFiles</span>&nbsp;<span class="op" id="3160054">=</span>&nbsp;<span class="builtinfunc" id="3160056">append</span><span class="op" id="3160062">(</span><span class="ident" id="3160063">p</span><span class="op" id="3160064">.</span><span class="ident" id="3160065">SysoFiles</span><span class="op" id="3160074">,</span>&nbsp;<span class="ident" id="3160076">name</span><span class="op" id="3160080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160085">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3160096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160101">pf</span><span class="op" id="3160103">,</span>&nbsp;<span class="ident" id="3160105">err</span>&nbsp;<span class="op" id="3160109">:=</span>&nbsp;<span class="ident" id="3160112">parser</span><span class="op" id="3160118">.</span><span class="ident" id="3160119">ParseFile</span><span class="op" id="3160128">(</span><span class="ident" id="3160129">fset</span><span class="op" id="3160133">,</span>&nbsp;<span class="ident" id="3160135">filename</span><span class="op" id="3160143">,</span>&nbsp;<span class="ident" id="3160145">data</span><span class="op" id="3160149">,</span>&nbsp;<span class="ident" id="3160151">parser</span><span class="op" id="3160157">.</span><span class="ident" id="3160158">ImportsOnly</span><span class="op" id="3160169">|</span><span class="ident" id="3160170">parser</span><span class="op" id="3160176">.</span><span class="ident" id="3160177">ParseComments</span><span class="op" id="3160190">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160194">if</span>&nbsp;<span class="ident" id="3160197">err</span>&nbsp;<span class="op" id="3160201">!=</span>&nbsp;<span class="builtintype" id="3160204">nil</span>&nbsp;<span class="op" id="3160208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160213">return</span>&nbsp;<span class="ident" id="3160220">p</span><span class="op" id="3160221">,</span>&nbsp;<span class="ident" id="3160223">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3160229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160234">pkg</span>&nbsp;<span class="op" id="3160238">:=</span>&nbsp;<span class="ident" id="3160241">pf</span><span class="op" id="3160243">.</span><span class="ident" id="3160244">Name</span><span class="op" id="3160248">.</span><span class="ident" id="3160249">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160256">if</span>&nbsp;<span class="ident" id="3160259">pkg</span>&nbsp;<span class="op" id="3160263">==</span>&nbsp;<span class="string" id="3160266">&#34;documentation&#34;</span>&nbsp;<span class="op" id="3160282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160287">p</span><span class="op" id="3160288">.</span><span class="ident" id="3160289">IgnoredGoFiles</span>&nbsp;<span class="op" id="3160304">=</span>&nbsp;<span class="builtinfunc" id="3160306">append</span><span class="op" id="3160312">(</span><span class="ident" id="3160313">p</span><span class="op" id="3160314">.</span><span class="ident" id="3160315">IgnoredGoFiles</span><span class="op" id="3160329">,</span>&nbsp;<span class="ident" id="3160331">name</span><span class="op" id="3160335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160340">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3160351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160356">isTest</span>&nbsp;<span class="op" id="3160363">:=</span>&nbsp;<span class="ident" id="3160366">strings</span><span class="op" id="3160373">.</span><span class="ident" id="3160374">HasSuffix</span><span class="op" id="3160383">(</span><span class="ident" id="3160384">name</span><span class="op" id="3160388">,</span>&nbsp;<span class="string" id="3160390">&#34;_test.go&#34;</span><span class="op" id="3160400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160404">isXTest</span>&nbsp;<span class="op" id="3160412">:=</span>&nbsp;<span class="builtintype" id="3160415">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160423">if</span>&nbsp;<span class="ident" id="3160426">isTest</span>&nbsp;<span class="op" id="3160433">&amp;&amp;</span>&nbsp;<span class="ident" id="3160436">strings</span><span class="op" id="3160443">.</span><span class="ident" id="3160444">HasSuffix</span><span class="op" id="3160453">(</span><span class="ident" id="3160454">pkg</span><span class="op" id="3160457">,</span>&nbsp;<span class="string" id="3160459">&#34;_test&#34;</span><span class="op" id="3160466">)</span>&nbsp;<span class="op" id="3160468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160473">isXTest</span>&nbsp;<span class="op" id="3160481">=</span>&nbsp;<span class="builtintype" id="3160483">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160491">pkg</span>&nbsp;<span class="op" id="3160495">=</span>&nbsp;<span class="ident" id="3160497">pkg</span><span class="op" id="3160500">[</span><span class="op" id="3160501">:</span><span class="builtinfunc" id="3160502">len</span><span class="op" id="3160505">(</span><span class="ident" id="3160506">pkg</span><span class="op" id="3160509">)</span><span class="op" id="3160510">-</span><span class="builtinfunc" id="3160511">len</span><span class="op" id="3160514">(</span><span class="string" id="3160515">&#34;_test&#34;</span><span class="op" id="3160522">)</span><span class="op" id="3160523">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3160527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160532">if</span>&nbsp;<span class="ident" id="3160535">p</span><span class="op" id="3160536">.</span><span class="ident" id="3160537">Name</span>&nbsp;<span class="op" id="3160542">==</span>&nbsp;<span class="string" id="3160545">&#34;&#34;</span>&nbsp;<span class="op" id="3160548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160553">p</span><span class="op" id="3160554">.</span><span class="ident" id="3160555">Name</span>&nbsp;<span class="op" id="3160560">=</span>&nbsp;<span class="ident" id="3160562">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160569">firstFile</span>&nbsp;<span class="op" id="3160579">=</span>&nbsp;<span class="ident" id="3160581">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3160588">}</span>&nbsp;<span class="keyword" id="3160590">else</span>&nbsp;<span class="keyword" id="3160595">if</span>&nbsp;<span class="ident" id="3160598">pkg</span>&nbsp;<span class="op" id="3160602">!=</span>&nbsp;<span class="ident" id="3160605">p</span><span class="op" id="3160606">.</span><span class="ident" id="3160607">Name</span>&nbsp;<span class="op" id="3160612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160617">return</span>&nbsp;<span class="ident" id="3160624">p</span><span class="op" id="3160625">,</span>&nbsp;<span class="op" id="3160627">&amp;</span><span class="ident" id="3160628">MultiplePackageError</span><span class="op" id="3160648">{</span><span class="ident" id="3160649">p</span><span class="op" id="3160650">.</span><span class="ident" id="3160651">Dir</span><span class="op" id="3160654">,</span>&nbsp;<span class="op" id="3160656">[</span><span class="op" id="3160657">]</span><span class="builtintype" id="3160658">string</span><span class="op" id="3160664">{</span><span class="ident" id="3160665">firstFile</span><span class="op" id="3160674">,</span>&nbsp;<span class="ident" id="3160676">name</span><span class="op" id="3160680">}</span><span class="op" id="3160681">,</span>&nbsp;<span class="op" id="3160683">[</span><span class="op" id="3160684">]</span><span class="builtintype" id="3160685">string</span><span class="op" id="3160691">{</span><span class="ident" id="3160692">p</span><span class="op" id="3160693">.</span><span class="ident" id="3160694">Name</span><span class="op" id="3160698">,</span>&nbsp;<span class="ident" id="3160700">pkg</span><span class="op" id="3160703">}</span><span class="op" id="3160704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3160708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160712">if</span>&nbsp;<span class="ident" id="3160715">pf</span><span class="op" id="3160717">.</span><span class="ident" id="3160718">Doc</span>&nbsp;<span class="op" id="3160722">!=</span>&nbsp;<span class="builtintype" id="3160725">nil</span>&nbsp;<span class="op" id="3160729">&amp;&amp;</span>&nbsp;<span class="ident" id="3160732">p</span><span class="op" id="3160733">.</span><span class="ident" id="3160734">Doc</span>&nbsp;<span class="op" id="3160738">==</span>&nbsp;<span class="string" id="3160741">&#34;&#34;</span>&nbsp;<span class="op" id="3160744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160749">p</span><span class="op" id="3160750">.</span><span class="ident" id="3160751">Doc</span>&nbsp;<span class="op" id="3160755">=</span>&nbsp;<span class="ident" id="3160757">doc</span><span class="op" id="3160760">.</span><span class="ident" id="3160761">Synopsis</span><span class="op" id="3160769">(</span><span class="ident" id="3160770">pf</span><span class="op" id="3160772">.</span><span class="ident" id="3160773">Doc</span><span class="op" id="3160776">.</span><span class="ident" id="3160777">Text</span><span class="op" id="3160781">(</span><span class="op" id="3160782">)</span><span class="op" id="3160783">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3160787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160792">if</span>&nbsp;<span class="ident" id="3160795">mode</span><span class="op" id="3160799">&amp;</span><span class="ident" id="3160800">ImportComment</span>&nbsp;<span class="op" id="3160814">!=</span>&nbsp;<span class="num" id="3160817">0</span>&nbsp;<span class="op" id="3160819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160824">qcom</span><span class="op" id="3160828">,</span>&nbsp;<span class="ident" id="3160830">line</span>&nbsp;<span class="op" id="3160835">:=</span>&nbsp;<span class="ident" id="3160838">findImportComment</span><span class="op" id="3160855">(</span><span class="ident" id="3160856">data</span><span class="op" id="3160860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160865">if</span>&nbsp;<span class="ident" id="3160868">line</span>&nbsp;<span class="op" id="3160873">!=</span>&nbsp;<span class="num" id="3160876">0</span>&nbsp;<span class="op" id="3160878">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3160884">com</span><span class="op" id="3160887">,</span>&nbsp;<span class="ident" id="3160889">err</span>&nbsp;<span class="op" id="3160893">:=</span>&nbsp;<span class="ident" id="3160896">strconv</span><span class="op" id="3160903">.</span><span class="ident" id="3160904">Unquote</span><span class="op" id="3160911">(</span><span class="ident" id="3160912">qcom</span><span class="op" id="3160916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160922">if</span>&nbsp;<span class="ident" id="3160925">err</span>&nbsp;<span class="op" id="3160929">!=</span>&nbsp;<span class="builtintype" id="3160932">nil</span>&nbsp;<span class="op" id="3160936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3160943">return</span>&nbsp;<span class="ident" id="3160950">p</span><span class="op" id="3160951">,</span>&nbsp;<span class="ident" id="3160953">fmt</span><span class="op" id="3160956">.</span><span class="ident" id="3160957">Errorf</span><span class="op" id="3160963">(</span><span class="string" id="3160964">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="3161000">,</span>&nbsp;<span class="ident" id="3161002">filename</span><span class="op" id="3161010">,</span>&nbsp;<span class="ident" id="3161012">line</span><span class="op" id="3161016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161028">if</span>&nbsp;<span class="ident" id="3161031">p</span><span class="op" id="3161032">.</span><span class="ident" id="3161033">ImportComment</span>&nbsp;<span class="op" id="3161047">==</span>&nbsp;<span class="string" id="3161050">&#34;&#34;</span>&nbsp;<span class="op" id="3161053">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161060">p</span><span class="op" id="3161061">.</span><span class="ident" id="3161062">ImportComment</span>&nbsp;<span class="op" id="3161076">=</span>&nbsp;<span class="ident" id="3161078">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161087">firstCommentFile</span>&nbsp;<span class="op" id="3161104">=</span>&nbsp;<span class="ident" id="3161106">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161115">}</span>&nbsp;<span class="keyword" id="3161117">else</span>&nbsp;<span class="keyword" id="3161122">if</span>&nbsp;<span class="ident" id="3161125">p</span><span class="op" id="3161126">.</span><span class="ident" id="3161127">ImportComment</span>&nbsp;<span class="op" id="3161141">!=</span>&nbsp;<span class="ident" id="3161144">com</span>&nbsp;<span class="op" id="3161148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161155">return</span>&nbsp;<span class="ident" id="3161162">p</span><span class="op" id="3161163">,</span>&nbsp;<span class="ident" id="3161165">fmt</span><span class="op" id="3161168">.</span><span class="ident" id="3161169">Errorf</span><span class="op" id="3161175">(</span><span class="string" id="3161176">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="3161225">,</span>&nbsp;<span class="ident" id="3161227">p</span><span class="op" id="3161228">.</span><span class="ident" id="3161229">ImportComment</span><span class="op" id="3161242">,</span>&nbsp;<span class="ident" id="3161244">firstCommentFile</span><span class="op" id="3161260">,</span>&nbsp;<span class="ident" id="3161262">com</span><span class="op" id="3161265">,</span>&nbsp;<span class="ident" id="3161267">name</span><span class="op" id="3161271">,</span>&nbsp;<span class="ident" id="3161273">p</span><span class="op" id="3161274">.</span><span class="ident" id="3161275">Dir</span><span class="op" id="3161278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161284">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3161298">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161345">isCgo</span>&nbsp;<span class="op" id="3161351">:=</span>&nbsp;<span class="builtintype" id="3161354">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161362">for</span>&nbsp;<span class="ident" id="3161366">_</span><span class="op" id="3161367">,</span>&nbsp;<span class="ident" id="3161369">decl</span>&nbsp;<span class="op" id="3161374">:=</span>&nbsp;<span class="keyword" id="3161377">range</span>&nbsp;<span class="ident" id="3161383">pf</span><span class="op" id="3161385">.</span><span class="ident" id="3161386">Decls</span>&nbsp;<span class="op" id="3161392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161397">d</span><span class="op" id="3161398">,</span>&nbsp;<span class="ident" id="3161400">ok</span>&nbsp;<span class="op" id="3161403">:=</span>&nbsp;<span class="ident" id="3161406">decl</span><span class="op" id="3161410">.</span><span class="op" id="3161411">(</span><span class="op" id="3161412">*</span><span class="ident" id="3161413">ast</span><span class="op" id="3161416">.</span><span class="ident" id="3161417">GenDecl</span><span class="op" id="3161424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161429">if</span>&nbsp;<span class="op" id="3161432">!</span><span class="ident" id="3161433">ok</span>&nbsp;<span class="op" id="3161436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161442">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161454">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161459">for</span>&nbsp;<span class="ident" id="3161463">_</span><span class="op" id="3161464">,</span>&nbsp;<span class="ident" id="3161466">dspec</span>&nbsp;<span class="op" id="3161472">:=</span>&nbsp;<span class="keyword" id="3161475">range</span>&nbsp;<span class="ident" id="3161481">d</span><span class="op" id="3161482">.</span><span class="ident" id="3161483">Specs</span>&nbsp;<span class="op" id="3161489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161495">spec</span><span class="op" id="3161499">,</span>&nbsp;<span class="ident" id="3161501">ok</span>&nbsp;<span class="op" id="3161504">:=</span>&nbsp;<span class="ident" id="3161507">dspec</span><span class="op" id="3161512">.</span><span class="op" id="3161513">(</span><span class="op" id="3161514">*</span><span class="ident" id="3161515">ast</span><span class="op" id="3161518">.</span><span class="ident" id="3161519">ImportSpec</span><span class="op" id="3161529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161535">if</span>&nbsp;<span class="op" id="3161538">!</span><span class="ident" id="3161539">ok</span>&nbsp;<span class="op" id="3161542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161549">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161562">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161568">quoted</span>&nbsp;<span class="op" id="3161575">:=</span>&nbsp;<span class="ident" id="3161578">spec</span><span class="op" id="3161582">.</span><span class="ident" id="3161583">Path</span><span class="op" id="3161587">.</span><span class="ident" id="3161588">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161598">path</span><span class="op" id="3161602">,</span>&nbsp;<span class="ident" id="3161604">err</span>&nbsp;<span class="op" id="3161608">:=</span>&nbsp;<span class="ident" id="3161611">strconv</span><span class="op" id="3161618">.</span><span class="ident" id="3161619">Unquote</span><span class="op" id="3161626">(</span><span class="ident" id="3161627">quoted</span><span class="op" id="3161633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161639">if</span>&nbsp;<span class="ident" id="3161642">err</span>&nbsp;<span class="op" id="3161646">!=</span>&nbsp;<span class="builtintype" id="3161649">nil</span>&nbsp;<span class="op" id="3161653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161660">log</span><span class="op" id="3161663">.</span><span class="ident" id="3161664">Panicf</span><span class="op" id="3161670">(</span><span class="string" id="3161671">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="3161720">,</span>&nbsp;<span class="ident" id="3161722">filename</span><span class="op" id="3161730">,</span>&nbsp;<span class="ident" id="3161732">quoted</span><span class="op" id="3161738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161744">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3161750">if</span>&nbsp;<span class="ident" id="3161753">isXTest</span>&nbsp;<span class="op" id="3161761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161768">xTestImported</span><span class="op" id="3161781">[</span><span class="ident" id="3161782">path</span><span class="op" id="3161786">]</span>&nbsp;<span class="op" id="3161788">=</span>&nbsp;<span class="builtinfunc" id="3161790">append</span><span class="op" id="3161796">(</span><span class="ident" id="3161797">xTestImported</span><span class="op" id="3161810">[</span><span class="ident" id="3161811">path</span><span class="op" id="3161815">]</span><span class="op" id="3161816">,</span>&nbsp;<span class="ident" id="3161818">fset</span><span class="op" id="3161822">.</span><span class="ident" id="3161823">Position</span><span class="op" id="3161831">(</span><span class="ident" id="3161832">spec</span><span class="op" id="3161836">.</span><span class="ident" id="3161837">Pos</span><span class="op" id="3161840">(</span><span class="op" id="3161841">)</span><span class="op" id="3161842">)</span><span class="op" id="3161843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161849">}</span>&nbsp;<span class="keyword" id="3161851">else</span>&nbsp;<span class="keyword" id="3161856">if</span>&nbsp;<span class="ident" id="3161859">isTest</span>&nbsp;<span class="op" id="3161866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161873">testImported</span><span class="op" id="3161885">[</span><span class="ident" id="3161886">path</span><span class="op" id="3161890">]</span>&nbsp;<span class="op" id="3161892">=</span>&nbsp;<span class="builtinfunc" id="3161894">append</span><span class="op" id="3161900">(</span><span class="ident" id="3161901">testImported</span><span class="op" id="3161913">[</span><span class="ident" id="3161914">path</span><span class="op" id="3161918">]</span><span class="op" id="3161919">,</span>&nbsp;<span class="ident" id="3161921">fset</span><span class="op" id="3161925">.</span><span class="ident" id="3161926">Position</span><span class="op" id="3161934">(</span><span class="ident" id="3161935">spec</span><span class="op" id="3161939">.</span><span class="ident" id="3161940">Pos</span><span class="op" id="3161943">(</span><span class="op" id="3161944">)</span><span class="op" id="3161945">)</span><span class="op" id="3161946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3161952">}</span>&nbsp;<span class="keyword" id="3161954">else</span>&nbsp;<span class="op" id="3161959">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3161966">imported</span><span class="op" id="3161974">[</span><span class="ident" id="3161975">path</span><span class="op" id="3161979">]</span>&nbsp;<span class="op" id="3161981">=</span>&nbsp;<span class="builtinfunc" id="3161983">append</span><span class="op" id="3161989">(</span><span class="ident" id="3161990">imported</span><span class="op" id="3161998">[</span><span class="ident" id="3161999">path</span><span class="op" id="3162003">]</span><span class="op" id="3162004">,</span>&nbsp;<span class="ident" id="3162006">fset</span><span class="op" id="3162010">.</span><span class="ident" id="3162011">Position</span><span class="op" id="3162019">(</span><span class="ident" id="3162020">spec</span><span class="op" id="3162024">.</span><span class="ident" id="3162025">Pos</span><span class="op" id="3162028">(</span><span class="op" id="3162029">)</span><span class="op" id="3162030">)</span><span class="op" id="3162031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162043">if</span>&nbsp;<span class="ident" id="3162046">path</span>&nbsp;<span class="op" id="3162051">==</span>&nbsp;<span class="string" id="3162054">&#34;C&#34;</span>&nbsp;<span class="op" id="3162058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162065">if</span>&nbsp;<span class="ident" id="3162068">isTest</span>&nbsp;<span class="op" id="3162075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162083">return</span>&nbsp;<span class="ident" id="3162090">p</span><span class="op" id="3162091">,</span>&nbsp;<span class="ident" id="3162093">fmt</span><span class="op" id="3162096">.</span><span class="ident" id="3162097">Errorf</span><span class="op" id="3162103">(</span><span class="string" id="3162104">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="3162141">,</span>&nbsp;<span class="ident" id="3162143">filename</span><span class="op" id="3162151">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162165">cg</span>&nbsp;<span class="op" id="3162168">:=</span>&nbsp;<span class="ident" id="3162171">spec</span><span class="op" id="3162175">.</span><span class="ident" id="3162176">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162185">if</span>&nbsp;<span class="ident" id="3162188">cg</span>&nbsp;<span class="op" id="3162191">==</span>&nbsp;<span class="builtintype" id="3162194">nil</span>&nbsp;<span class="op" id="3162198">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3162201">len</span><span class="op" id="3162204">(</span><span class="ident" id="3162205">d</span><span class="op" id="3162206">.</span><span class="ident" id="3162207">Specs</span><span class="op" id="3162212">)</span>&nbsp;<span class="op" id="3162214">==</span>&nbsp;<span class="num" id="3162217">1</span>&nbsp;<span class="op" id="3162219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162227">cg</span>&nbsp;<span class="op" id="3162230">=</span>&nbsp;<span class="ident" id="3162232">d</span><span class="op" id="3162233">.</span><span class="ident" id="3162234">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162243">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162250">if</span>&nbsp;<span class="ident" id="3162253">cg</span>&nbsp;<span class="op" id="3162256">!=</span>&nbsp;<span class="builtintype" id="3162259">nil</span>&nbsp;<span class="op" id="3162263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162271">if</span>&nbsp;<span class="ident" id="3162274">err</span>&nbsp;<span class="op" id="3162278">:=</span>&nbsp;<span class="ident" id="3162281">ctxt</span><span class="op" id="3162285">.</span><span class="ident" id="3162286">saveCgo</span><span class="op" id="3162293">(</span><span class="ident" id="3162294">filename</span><span class="op" id="3162302">,</span>&nbsp;<span class="ident" id="3162304">p</span><span class="op" id="3162305">,</span>&nbsp;<span class="ident" id="3162307">cg</span><span class="op" id="3162309">)</span><span class="op" id="3162310">;</span>&nbsp;<span class="ident" id="3162312">err</span>&nbsp;<span class="op" id="3162316">!=</span>&nbsp;<span class="builtintype" id="3162319">nil</span>&nbsp;<span class="op" id="3162323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162332">return</span>&nbsp;<span class="ident" id="3162339">p</span><span class="op" id="3162340">,</span>&nbsp;<span class="ident" id="3162342">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162359">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162366">isCgo</span>&nbsp;<span class="op" id="3162372">=</span>&nbsp;<span class="builtintype" id="3162374">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162396">if</span>&nbsp;<span class="ident" id="3162399">isCgo</span>&nbsp;<span class="op" id="3162405">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162410">allTags</span><span class="op" id="3162417">[</span><span class="string" id="3162418">&#34;cgo&#34;</span><span class="op" id="3162423">]</span>&nbsp;<span class="op" id="3162425">=</span>&nbsp;<span class="builtintype" id="3162427">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162435">if</span>&nbsp;<span class="ident" id="3162438">ctxt</span><span class="op" id="3162442">.</span><span class="ident" id="3162443">CgoEnabled</span>&nbsp;<span class="op" id="3162454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162460">p</span><span class="op" id="3162461">.</span><span class="ident" id="3162462">CgoFiles</span>&nbsp;<span class="op" id="3162471">=</span>&nbsp;<span class="builtinfunc" id="3162473">append</span><span class="op" id="3162479">(</span><span class="ident" id="3162480">p</span><span class="op" id="3162481">.</span><span class="ident" id="3162482">CgoFiles</span><span class="op" id="3162490">,</span>&nbsp;<span class="ident" id="3162492">name</span><span class="op" id="3162496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162501">}</span>&nbsp;<span class="keyword" id="3162503">else</span>&nbsp;<span class="op" id="3162508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162514">p</span><span class="op" id="3162515">.</span><span class="ident" id="3162516">IgnoredGoFiles</span>&nbsp;<span class="op" id="3162531">=</span>&nbsp;<span class="builtinfunc" id="3162533">append</span><span class="op" id="3162539">(</span><span class="ident" id="3162540">p</span><span class="op" id="3162541">.</span><span class="ident" id="3162542">IgnoredGoFiles</span><span class="op" id="3162556">,</span>&nbsp;<span class="ident" id="3162558">name</span><span class="op" id="3162562">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162571">}</span>&nbsp;<span class="keyword" id="3162573">else</span>&nbsp;<span class="keyword" id="3162578">if</span>&nbsp;<span class="ident" id="3162581">isXTest</span>&nbsp;<span class="op" id="3162589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162594">p</span><span class="op" id="3162595">.</span><span class="ident" id="3162596">XTestGoFiles</span>&nbsp;<span class="op" id="3162609">=</span>&nbsp;<span class="builtinfunc" id="3162611">append</span><span class="op" id="3162617">(</span><span class="ident" id="3162618">p</span><span class="op" id="3162619">.</span><span class="ident" id="3162620">XTestGoFiles</span><span class="op" id="3162632">,</span>&nbsp;<span class="ident" id="3162634">name</span><span class="op" id="3162638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162642">}</span>&nbsp;<span class="keyword" id="3162644">else</span>&nbsp;<span class="keyword" id="3162649">if</span>&nbsp;<span class="ident" id="3162652">isTest</span>&nbsp;<span class="op" id="3162659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162664">p</span><span class="op" id="3162665">.</span><span class="ident" id="3162666">TestGoFiles</span>&nbsp;<span class="op" id="3162678">=</span>&nbsp;<span class="builtinfunc" id="3162680">append</span><span class="op" id="3162686">(</span><span class="ident" id="3162687">p</span><span class="op" id="3162688">.</span><span class="ident" id="3162689">TestGoFiles</span><span class="op" id="3162700">,</span>&nbsp;<span class="ident" id="3162702">name</span><span class="op" id="3162706">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162710">}</span>&nbsp;<span class="keyword" id="3162712">else</span>&nbsp;<span class="op" id="3162717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162722">p</span><span class="op" id="3162723">.</span><span class="ident" id="3162724">GoFiles</span>&nbsp;<span class="op" id="3162732">=</span>&nbsp;<span class="builtinfunc" id="3162734">append</span><span class="op" id="3162740">(</span><span class="ident" id="3162741">p</span><span class="op" id="3162742">.</span><span class="ident" id="3162743">GoFiles</span><span class="op" id="3162750">,</span>&nbsp;<span class="ident" id="3162752">name</span><span class="op" id="3162756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162766">if</span>&nbsp;<span class="builtinfunc" id="3162769">len</span><span class="op" id="3162772">(</span><span class="ident" id="3162773">p</span><span class="op" id="3162774">.</span><span class="ident" id="3162775">GoFiles</span><span class="op" id="3162782">)</span><span class="op" id="3162783">+</span><span class="builtinfunc" id="3162784">len</span><span class="op" id="3162787">(</span><span class="ident" id="3162788">p</span><span class="op" id="3162789">.</span><span class="ident" id="3162790">CgoFiles</span><span class="op" id="3162798">)</span><span class="op" id="3162799">+</span><span class="builtinfunc" id="3162800">len</span><span class="op" id="3162803">(</span><span class="ident" id="3162804">p</span><span class="op" id="3162805">.</span><span class="ident" id="3162806">TestGoFiles</span><span class="op" id="3162817">)</span><span class="op" id="3162818">+</span><span class="builtinfunc" id="3162819">len</span><span class="op" id="3162822">(</span><span class="ident" id="3162823">p</span><span class="op" id="3162824">.</span><span class="ident" id="3162825">XTestGoFiles</span><span class="op" id="3162837">)</span>&nbsp;<span class="op" id="3162839">==</span>&nbsp;<span class="num" id="3162842">0</span>&nbsp;<span class="op" id="3162844">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162848">return</span>&nbsp;<span class="ident" id="3162855">p</span><span class="op" id="3162856">,</span>&nbsp;<span class="op" id="3162858">&amp;</span><span class="ident" id="3162859">NoGoError</span><span class="op" id="3162868">{</span><span class="ident" id="3162869">p</span><span class="op" id="3162870">.</span><span class="ident" id="3162871">Dir</span><span class="op" id="3162874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3162881">for</span>&nbsp;<span class="ident" id="3162885">tag</span>&nbsp;<span class="op" id="3162889">:=</span>&nbsp;<span class="keyword" id="3162892">range</span>&nbsp;<span class="ident" id="3162898">allTags</span>&nbsp;<span class="op" id="3162906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162910">p</span><span class="op" id="3162911">.</span><span class="ident" id="3162912">AllTags</span>&nbsp;<span class="op" id="3162920">=</span>&nbsp;<span class="builtinfunc" id="3162922">append</span><span class="op" id="3162928">(</span><span class="ident" id="3162929">p</span><span class="op" id="3162930">.</span><span class="ident" id="3162931">AllTags</span><span class="op" id="3162938">,</span>&nbsp;<span class="ident" id="3162940">tag</span><span class="op" id="3162943">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162949">sort</span><span class="op" id="3162953">.</span><span class="ident" id="3162954">Strings</span><span class="op" id="3162961">(</span><span class="ident" id="3162962">p</span><span class="op" id="3162963">.</span><span class="ident" id="3162964">AllTags</span><span class="op" id="3162971">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3162975">p</span><span class="op" id="3162976">.</span><span class="ident" id="3162977">Imports</span><span class="op" id="3162984">,</span>&nbsp;<span class="ident" id="3162986">p</span><span class="op" id="3162987">.</span><span class="ident" id="3162988">ImportPos</span>&nbsp;<span class="op" id="3162998">=</span>&nbsp;<span class="ident" id="3163000">cleanImports</span><span class="op" id="3163012">(</span><span class="ident" id="3163013">imported</span><span class="op" id="3163021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163024">p</span><span class="op" id="3163025">.</span><span class="ident" id="3163026">TestImports</span><span class="op" id="3163037">,</span>&nbsp;<span class="ident" id="3163039">p</span><span class="op" id="3163040">.</span><span class="ident" id="3163041">TestImportPos</span>&nbsp;<span class="op" id="3163055">=</span>&nbsp;<span class="ident" id="3163057">cleanImports</span><span class="op" id="3163069">(</span><span class="ident" id="3163070">testImported</span><span class="op" id="3163082">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163085">p</span><span class="op" id="3163086">.</span><span class="ident" id="3163087">XTestImports</span><span class="op" id="3163099">,</span>&nbsp;<span class="ident" id="3163101">p</span><span class="op" id="3163102">.</span><span class="ident" id="3163103">XTestImportPos</span>&nbsp;<span class="op" id="3163118">=</span>&nbsp;<span class="ident" id="3163120">cleanImports</span><span class="op" id="3163132">(</span><span class="ident" id="3163133">xTestImported</span><span class="op" id="3163146">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3163150">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3163196">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3163237">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163282">if</span>&nbsp;<span class="builtinfunc" id="3163285">len</span><span class="op" id="3163288">(</span><span class="ident" id="3163289">p</span><span class="op" id="3163290">.</span><span class="ident" id="3163291">CgoFiles</span><span class="op" id="3163299">)</span>&nbsp;<span class="op" id="3163301">&gt;</span>&nbsp;<span class="num" id="3163303">0</span>&nbsp;<span class="op" id="3163305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163309">p</span><span class="op" id="3163310">.</span><span class="ident" id="3163311">SFiles</span>&nbsp;<span class="op" id="3163318">=</span>&nbsp;<span class="builtinfunc" id="3163320">append</span><span class="op" id="3163326">(</span><span class="ident" id="3163327">p</span><span class="op" id="3163328">.</span><span class="ident" id="3163329">SFiles</span><span class="op" id="3163335">,</span>&nbsp;<span class="ident" id="3163337">Sfiles</span><span class="op" id="3163343">...</span><span class="op" id="3163346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163350">sort</span><span class="op" id="3163354">.</span><span class="ident" id="3163355">Strings</span><span class="op" id="3163362">(</span><span class="ident" id="3163363">p</span><span class="op" id="3163364">.</span><span class="ident" id="3163365">SFiles</span><span class="op" id="3163371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3163374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163378">return</span>&nbsp;<span class="ident" id="3163385">p</span><span class="op" id="3163386">,</span>&nbsp;<span class="ident" id="3163388">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="3163395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3163398">func</span>&nbsp;<span class="ident" id="3163403">findImportComment</span><span class="op" id="3163420">(</span><span class="ident" id="3163421">data</span>&nbsp;<span class="op" id="3163426">[</span><span class="op" id="3163427">]</span><span class="builtintype" id="3163428">byte</span><span class="op" id="3163432">)</span>&nbsp;<span class="op" id="3163434">(</span><span class="ident" id="3163435">s</span>&nbsp;<span class="builtintype" id="3163437">string</span><span class="op" id="3163443">,</span>&nbsp;<span class="ident" id="3163445">line</span>&nbsp;<span class="builtintype" id="3163450">int</span><span class="op" id="3163453">)</span>&nbsp;<span class="op" id="3163455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3163458">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163485">word</span><span class="op" id="3163489">,</span>&nbsp;<span class="ident" id="3163491">data</span>&nbsp;<span class="op" id="3163496">:=</span>&nbsp;<span class="ident" id="3163499">parseWord</span><span class="op" id="3163508">(</span><span class="ident" id="3163509">data</span><span class="op" id="3163513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163516">if</span>&nbsp;<span class="builtintype" id="3163519">string</span><span class="op" id="3163525">(</span><span class="ident" id="3163526">word</span><span class="op" id="3163530">)</span>&nbsp;<span class="op" id="3163532">!=</span>&nbsp;<span class="string" id="3163535">&#34;package&#34;</span>&nbsp;<span class="op" id="3163545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163549">return</span>&nbsp;<span class="string" id="3163556">&#34;&#34;</span><span class="op" id="3163558">,</span>&nbsp;<span class="num" id="3163560">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3163563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3163567">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163591">_</span><span class="op" id="3163592">,</span>&nbsp;<span class="ident" id="3163594">data</span>&nbsp;<span class="op" id="3163599">=</span>&nbsp;<span class="ident" id="3163601">parseWord</span><span class="op" id="3163610">(</span><span class="ident" id="3163611">data</span><span class="op" id="3163615">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3163619">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3163675">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163721">for</span>&nbsp;<span class="builtinfunc" id="3163725">len</span><span class="op" id="3163728">(</span><span class="ident" id="3163729">data</span><span class="op" id="3163733">)</span>&nbsp;<span class="op" id="3163735">&gt;</span>&nbsp;<span class="num" id="3163737">0</span>&nbsp;<span class="op" id="3163739">&amp;&amp;</span>&nbsp;<span class="op" id="3163742">(</span><span class="ident" id="3163743">data</span><span class="op" id="3163747">[</span><span class="num" id="3163748">0</span><span class="op" id="3163749">]</span>&nbsp;<span class="op" id="3163751">==</span>&nbsp;<span class="string" id="3163754">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3163758">||</span>&nbsp;<span class="ident" id="3163761">data</span><span class="op" id="3163765">[</span><span class="num" id="3163766">0</span><span class="op" id="3163767">]</span>&nbsp;<span class="op" id="3163769">==</span>&nbsp;<span class="string" id="3163772">&#39;\t&#39;</span>&nbsp;<span class="op" id="3163777">||</span>&nbsp;<span class="ident" id="3163780">data</span><span class="op" id="3163784">[</span><span class="num" id="3163785">0</span><span class="op" id="3163786">]</span>&nbsp;<span class="op" id="3163788">==</span>&nbsp;<span class="string" id="3163791">&#39;\r&#39;</span><span class="op" id="3163795">)</span>&nbsp;<span class="op" id="3163797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163801">data</span>&nbsp;<span class="op" id="3163806">=</span>&nbsp;<span class="ident" id="3163808">data</span><span class="op" id="3163812">[</span><span class="num" id="3163813">1</span><span class="op" id="3163814">:</span><span class="op" id="3163815">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3163818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163822">var</span>&nbsp;<span class="ident" id="3163826">comment</span>&nbsp;<span class="op" id="3163834">[</span><span class="op" id="3163835">]</span><span class="builtintype" id="3163836">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163842">switch</span>&nbsp;<span class="op" id="3163849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163852">case</span>&nbsp;<span class="ident" id="3163857">bytes</span><span class="op" id="3163862">.</span><span class="ident" id="3163863">HasPrefix</span><span class="op" id="3163872">(</span><span class="ident" id="3163873">data</span><span class="op" id="3163877">,</span>&nbsp;<span class="ident" id="3163879">slashSlash</span><span class="op" id="3163889">)</span><span class="op" id="3163890">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163894">i</span>&nbsp;<span class="op" id="3163896">:=</span>&nbsp;<span class="ident" id="3163899">bytes</span><span class="op" id="3163904">.</span><span class="ident" id="3163905">Index</span><span class="op" id="3163910">(</span><span class="ident" id="3163911">data</span><span class="op" id="3163915">,</span>&nbsp;<span class="ident" id="3163917">newline</span><span class="op" id="3163924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163928">if</span>&nbsp;<span class="ident" id="3163931">i</span>&nbsp;<span class="op" id="3163933">&lt;</span>&nbsp;<span class="num" id="3163935">0</span>&nbsp;<span class="op" id="3163937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163942">i</span>&nbsp;<span class="op" id="3163944">=</span>&nbsp;<span class="builtinfunc" id="3163946">len</span><span class="op" id="3163949">(</span><span class="ident" id="3163950">data</span><span class="op" id="3163954">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3163958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3163962">comment</span>&nbsp;<span class="op" id="3163970">=</span>&nbsp;<span class="ident" id="3163972">data</span><span class="op" id="3163976">[</span><span class="num" id="3163977">2</span><span class="op" id="3163978">:</span><span class="ident" id="3163979">i</span><span class="op" id="3163980">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3163983">case</span>&nbsp;<span class="ident" id="3163988">bytes</span><span class="op" id="3163993">.</span><span class="ident" id="3163994">HasPrefix</span><span class="op" id="3164003">(</span><span class="ident" id="3164004">data</span><span class="op" id="3164008">,</span>&nbsp;<span class="ident" id="3164010">slashStar</span><span class="op" id="3164019">)</span><span class="op" id="3164020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164024">data</span>&nbsp;<span class="op" id="3164029">=</span>&nbsp;<span class="ident" id="3164031">data</span><span class="op" id="3164035">[</span><span class="num" id="3164036">2</span><span class="op" id="3164037">:</span><span class="op" id="3164038">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164042">i</span>&nbsp;<span class="op" id="3164044">:=</span>&nbsp;<span class="ident" id="3164047">bytes</span><span class="op" id="3164052">.</span><span class="ident" id="3164053">Index</span><span class="op" id="3164058">(</span><span class="ident" id="3164059">data</span><span class="op" id="3164063">,</span>&nbsp;<span class="ident" id="3164065">starSlash</span><span class="op" id="3164074">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164078">if</span>&nbsp;<span class="ident" id="3164081">i</span>&nbsp;<span class="op" id="3164083">&lt;</span>&nbsp;<span class="num" id="3164085">0</span>&nbsp;<span class="op" id="3164087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3164092">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164116">return</span>&nbsp;<span class="string" id="3164123">&#34;&#34;</span><span class="op" id="3164125">,</span>&nbsp;<span class="num" id="3164127">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3164131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164135">comment</span>&nbsp;<span class="op" id="3164143">=</span>&nbsp;<span class="ident" id="3164145">data</span><span class="op" id="3164149">[</span><span class="op" id="3164150">:</span><span class="ident" id="3164151">i</span><span class="op" id="3164152">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164156">if</span>&nbsp;<span class="ident" id="3164159">bytes</span><span class="op" id="3164164">.</span><span class="ident" id="3164165">Contains</span><span class="op" id="3164173">(</span><span class="ident" id="3164174">comment</span><span class="op" id="3164181">,</span>&nbsp;<span class="ident" id="3164183">newline</span><span class="op" id="3164190">)</span>&nbsp;<span class="op" id="3164192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164197">return</span>&nbsp;<span class="string" id="3164204">&#34;&#34;</span><span class="op" id="3164206">,</span>&nbsp;<span class="num" id="3164208">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3164212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3164215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164218">comment</span>&nbsp;<span class="op" id="3164226">=</span>&nbsp;<span class="ident" id="3164228">bytes</span><span class="op" id="3164233">.</span><span class="ident" id="3164234">TrimSpace</span><span class="op" id="3164243">(</span><span class="ident" id="3164244">comment</span><span class="op" id="3164251">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3164255">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164296">word</span><span class="op" id="3164300">,</span>&nbsp;<span class="ident" id="3164302">arg</span>&nbsp;<span class="op" id="3164306">:=</span>&nbsp;<span class="ident" id="3164309">parseWord</span><span class="op" id="3164318">(</span><span class="ident" id="3164319">comment</span><span class="op" id="3164326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164329">if</span>&nbsp;<span class="builtintype" id="3164332">string</span><span class="op" id="3164338">(</span><span class="ident" id="3164339">word</span><span class="op" id="3164343">)</span>&nbsp;<span class="op" id="3164345">!=</span>&nbsp;<span class="string" id="3164348">&#34;import&#34;</span>&nbsp;<span class="op" id="3164357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164361">return</span>&nbsp;<span class="string" id="3164368">&#34;&#34;</span><span class="op" id="3164370">,</span>&nbsp;<span class="num" id="3164372">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3164375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164379">line</span>&nbsp;<span class="op" id="3164384">=</span>&nbsp;<span class="num" id="3164386">1</span>&nbsp;<span class="op" id="3164388">+</span>&nbsp;<span class="ident" id="3164390">bytes</span><span class="op" id="3164395">.</span><span class="ident" id="3164396">Count</span><span class="op" id="3164401">(</span><span class="ident" id="3164402">data</span><span class="op" id="3164406">[</span><span class="op" id="3164407">:</span><span class="builtinfunc" id="3164408">cap</span><span class="op" id="3164411">(</span><span class="ident" id="3164412">data</span><span class="op" id="3164416">)</span><span class="op" id="3164417">-</span><span class="builtinfunc" id="3164418">cap</span><span class="op" id="3164421">(</span><span class="ident" id="3164422">arg</span><span class="op" id="3164425">)</span><span class="op" id="3164426">]</span><span class="op" id="3164427">,</span>&nbsp;<span class="ident" id="3164429">newline</span><span class="op" id="3164436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164439">return</span>&nbsp;<span class="ident" id="3164446">strings</span><span class="op" id="3164453">.</span><span class="ident" id="3164454">TrimSpace</span><span class="op" id="3164463">(</span><span class="builtintype" id="3164464">string</span><span class="op" id="3164470">(</span><span class="ident" id="3164471">arg</span><span class="op" id="3164474">)</span><span class="op" id="3164475">)</span><span class="op" id="3164476">,</span>&nbsp;<span class="ident" id="3164478">line</span><br>
<span class="lineno"></span><span class="op" id="3164483">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="3164486">var</span>&nbsp;<span class="op" id="3164490">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164493">slashSlash</span>&nbsp;<span class="op" id="3164504">=</span>&nbsp;<span class="op" id="3164506">[</span><span class="op" id="3164507">]</span><span class="builtintype" id="3164508">byte</span><span class="op" id="3164512">(</span><span class="string" id="3164513">&#34;//&#34;</span><span class="op" id="3164517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164520">slashStar</span>&nbsp;&nbsp;<span class="op" id="3164531">=</span>&nbsp;<span class="op" id="3164533">[</span><span class="op" id="3164534">]</span><span class="builtintype" id="3164535">byte</span><span class="op" id="3164539">(</span><span class="string" id="3164540">&#34;/*&#34;</span><span class="op" id="3164544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164547">starSlash</span>&nbsp;&nbsp;<span class="op" id="3164558">=</span>&nbsp;<span class="op" id="3164560">[</span><span class="op" id="3164561">]</span><span class="builtintype" id="3164562">byte</span><span class="op" id="3164566">(</span><span class="string" id="3164567">&#34;*/&#34;</span><span class="op" id="3164571">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164574">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3164585">=</span>&nbsp;<span class="op" id="3164587">[</span><span class="op" id="3164588">]</span><span class="builtintype" id="3164589">byte</span><span class="op" id="3164593">(</span><span class="string" id="3164594">&#34;\n&#34;</span><span class="op" id="3164598">)</span><br>
<span class="lineno"></span><span class="op" id="3164600">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3164603">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="3164683">func</span>&nbsp;<span class="ident" id="3164688">skipSpaceOrComment</span><span class="op" id="3164706">(</span><span class="ident" id="3164707">data</span>&nbsp;<span class="op" id="3164712">[</span><span class="op" id="3164713">]</span><span class="builtintype" id="3164714">byte</span><span class="op" id="3164718">)</span>&nbsp;<span class="op" id="3164720">[</span><span class="op" id="3164721">]</span><span class="builtintype" id="3164722">byte</span>&nbsp;<span class="op" id="3164727">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164730">for</span>&nbsp;<span class="builtinfunc" id="3164734">len</span><span class="op" id="3164737">(</span><span class="ident" id="3164738">data</span><span class="op" id="3164742">)</span>&nbsp;<span class="op" id="3164744">&gt;</span>&nbsp;<span class="num" id="3164746">0</span>&nbsp;<span class="op" id="3164748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164752">switch</span>&nbsp;<span class="ident" id="3164759">data</span><span class="op" id="3164763">[</span><span class="num" id="3164764">0</span><span class="op" id="3164765">]</span>&nbsp;<span class="op" id="3164767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164771">case</span>&nbsp;<span class="string" id="3164776">&#39;&nbsp;&#39;</span><span class="op" id="3164779">,</span>&nbsp;<span class="string" id="3164781">&#39;\t&#39;</span><span class="op" id="3164785">,</span>&nbsp;<span class="string" id="3164787">&#39;\r&#39;</span><span class="op" id="3164791">,</span>&nbsp;<span class="string" id="3164793">&#39;\n&#39;</span><span class="op" id="3164797">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164802">data</span>&nbsp;<span class="op" id="3164807">=</span>&nbsp;<span class="ident" id="3164809">data</span><span class="op" id="3164813">[</span><span class="num" id="3164814">1</span><span class="op" id="3164815">:</span><span class="op" id="3164816">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164821">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164832">case</span>&nbsp;<span class="string" id="3164837">&#39;/&#39;</span><span class="op" id="3164840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164845">if</span>&nbsp;<span class="ident" id="3164848">bytes</span><span class="op" id="3164853">.</span><span class="ident" id="3164854">HasPrefix</span><span class="op" id="3164863">(</span><span class="ident" id="3164864">data</span><span class="op" id="3164868">,</span>&nbsp;<span class="ident" id="3164870">slashSlash</span><span class="op" id="3164880">)</span>&nbsp;<span class="op" id="3164882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164888">i</span>&nbsp;<span class="op" id="3164890">:=</span>&nbsp;<span class="ident" id="3164893">bytes</span><span class="op" id="3164898">.</span><span class="ident" id="3164899">Index</span><span class="op" id="3164904">(</span><span class="ident" id="3164905">data</span><span class="op" id="3164909">,</span>&nbsp;<span class="ident" id="3164911">newline</span><span class="op" id="3164918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164924">if</span>&nbsp;<span class="ident" id="3164927">i</span>&nbsp;<span class="op" id="3164929">&lt;</span>&nbsp;<span class="num" id="3164931">0</span>&nbsp;<span class="op" id="3164933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164940">return</span>&nbsp;<span class="builtintype" id="3164947">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3164955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3164961">data</span>&nbsp;<span class="op" id="3164966">=</span>&nbsp;<span class="ident" id="3164968">data</span><span class="op" id="3164972">[</span><span class="ident" id="3164973">i</span><span class="op" id="3164974">+</span><span class="num" id="3164975">1</span><span class="op" id="3164976">:</span><span class="op" id="3164977">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3164983">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3164995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165000">if</span>&nbsp;<span class="ident" id="3165003">bytes</span><span class="op" id="3165008">.</span><span class="ident" id="3165009">HasPrefix</span><span class="op" id="3165018">(</span><span class="ident" id="3165019">data</span><span class="op" id="3165023">,</span>&nbsp;<span class="ident" id="3165025">slashStar</span><span class="op" id="3165034">)</span>&nbsp;<span class="op" id="3165036">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3165042">data</span>&nbsp;<span class="op" id="3165047">=</span>&nbsp;<span class="ident" id="3165049">data</span><span class="op" id="3165053">[</span><span class="num" id="3165054">2</span><span class="op" id="3165055">:</span><span class="op" id="3165056">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3165062">i</span>&nbsp;<span class="op" id="3165064">:=</span>&nbsp;<span class="ident" id="3165067">bytes</span><span class="op" id="3165072">.</span><span class="ident" id="3165073">Index</span><span class="op" id="3165078">(</span><span class="ident" id="3165079">data</span><span class="op" id="3165083">,</span>&nbsp;<span class="ident" id="3165085">starSlash</span><span class="op" id="3165094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165100">if</span>&nbsp;<span class="ident" id="3165103">i</span>&nbsp;<span class="op" id="3165105">&lt;</span>&nbsp;<span class="num" id="3165107">0</span>&nbsp;<span class="op" id="3165109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165116">return</span>&nbsp;<span class="builtintype" id="3165123">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3165131">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3165137">data</span>&nbsp;<span class="op" id="3165142">=</span>&nbsp;<span class="ident" id="3165144">data</span><span class="op" id="3165148">[</span><span class="ident" id="3165149">i</span><span class="op" id="3165150">+</span><span class="num" id="3165151">2</span><span class="op" id="3165152">:</span><span class="op" id="3165153">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165159">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3165171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3165175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165179">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3165186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165189">return</span>&nbsp;<span class="ident" id="3165196">data</span><br>
<span class="lineno"></span><span class="op" id="3165201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3165204">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="3165262">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="3165332">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="3165388">func</span>&nbsp;<span class="ident" id="3165393">parseWord</span><span class="op" id="3165402">(</span><span class="ident" id="3165403">data</span>&nbsp;<span class="op" id="3165408">[</span><span class="op" id="3165409">]</span><span class="builtintype" id="3165410">byte</span><span class="op" id="3165414">)</span>&nbsp;<span class="op" id="3165416">(</span><span class="ident" id="3165417">word</span><span class="op" id="3165421">,</span>&nbsp;<span class="ident" id="3165423">rest</span>&nbsp;<span class="op" id="3165428">[</span><span class="op" id="3165429">]</span><span class="builtintype" id="3165430">byte</span><span class="op" id="3165434">)</span>&nbsp;<span class="op" id="3165436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3165439">data</span>&nbsp;<span class="op" id="3165444">=</span>&nbsp;<span class="ident" id="3165446">skipSpaceOrComment</span><span class="op" id="3165464">(</span><span class="ident" id="3165465">data</span><span class="op" id="3165469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3165473">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3165513">rest</span>&nbsp;<span class="op" id="3165518">=</span>&nbsp;<span class="ident" id="3165520">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165526">for</span>&nbsp;<span class="op" id="3165530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3165534">r</span><span class="op" id="3165535">,</span>&nbsp;<span class="ident" id="3165537">size</span>&nbsp;<span class="op" id="3165542">:=</span>&nbsp;<span class="ident" id="3165545">utf8</span><span class="op" id="3165549">.</span><span class="ident" id="3165550">DecodeRune</span><span class="op" id="3165560">(</span><span class="ident" id="3165561">rest</span><span class="op" id="3165565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165569">if</span>&nbsp;<span class="ident" id="3165572">unicode</span><span class="op" id="3165579">.</span><span class="ident" id="3165580">IsLetter</span><span class="op" id="3165588">(</span><span class="ident" id="3165589">r</span><span class="op" id="3165590">)</span>&nbsp;<span class="op" id="3165592">||</span>&nbsp;<span class="string" id="3165595">&#39;0&#39;</span>&nbsp;<span class="op" id="3165599">&lt;=</span>&nbsp;<span class="ident" id="3165602">r</span>&nbsp;<span class="op" id="3165604">&amp;&amp;</span>&nbsp;<span class="ident" id="3165607">r</span>&nbsp;<span class="op" id="3165609">&lt;=</span>&nbsp;<span class="string" id="3165612">&#39;9&#39;</span>&nbsp;<span class="op" id="3165616">||</span>&nbsp;<span class="ident" id="3165619">r</span>&nbsp;<span class="op" id="3165621">==</span>&nbsp;<span class="string" id="3165624">&#39;_&#39;</span>&nbsp;<span class="op" id="3165628">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3165633">rest</span>&nbsp;<span class="op" id="3165638">=</span>&nbsp;<span class="ident" id="3165640">rest</span><span class="op" id="3165644">[</span><span class="ident" id="3165645">size</span><span class="op" id="3165649">:</span><span class="op" id="3165650">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165655">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3165666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165670">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3165677">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3165681">word</span>&nbsp;<span class="op" id="3165686">=</span>&nbsp;<span class="ident" id="3165688">data</span><span class="op" id="3165692">[</span><span class="op" id="3165693">:</span><span class="builtinfunc" id="3165694">len</span><span class="op" id="3165697">(</span><span class="ident" id="3165698">data</span><span class="op" id="3165702">)</span><span class="op" id="3165703">-</span><span class="builtinfunc" id="3165704">len</span><span class="op" id="3165707">(</span><span class="ident" id="3165708">rest</span><span class="op" id="3165712">)</span><span class="op" id="3165713">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165716">if</span>&nbsp;<span class="builtinfunc" id="3165719">len</span><span class="op" id="3165722">(</span><span class="ident" id="3165723">word</span><span class="op" id="3165727">)</span>&nbsp;<span class="op" id="3165729">==</span>&nbsp;<span class="num" id="3165732">0</span>&nbsp;<span class="op" id="3165734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165738">return</span>&nbsp;<span class="builtintype" id="3165745">nil</span><span class="op" id="3165748">,</span>&nbsp;<span class="builtintype" id="3165750">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3165755">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3165759">return</span>&nbsp;<span class="ident" id="3165766">word</span><span class="op" id="3165770">,</span>&nbsp;<span class="ident" id="3165772">rest</span><br>
<span class="lineno"></span><span class="op" id="3165777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3165780">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="3165861">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="3165940">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="3165962">//</span><br>
<span class="lineno"></span><span class="comment" id="3165965">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3166038">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="3166081">func</span>&nbsp;<span class="op" id="3166086">(</span><span class="ident" id="3166087">ctxt</span>&nbsp;<span class="op" id="3166092">*</span><span class="ident" id="3166093">Context</span><span class="op" id="3166100">)</span>&nbsp;<span class="ident" id="3166102">MatchFile</span><span class="op" id="3166111">(</span><span class="ident" id="3166112">dir</span><span class="op" id="3166115">,</span>&nbsp;<span class="ident" id="3166117">name</span>&nbsp;<span class="builtintype" id="3166122">string</span><span class="op" id="3166128">)</span>&nbsp;<span class="op" id="3166130">(</span><span class="ident" id="3166131">match</span>&nbsp;<span class="builtintype" id="3166137">bool</span><span class="op" id="3166141">,</span>&nbsp;<span class="ident" id="3166143">err</span>&nbsp;<span class="builtintype" id="3166147">error</span><span class="op" id="3166152">)</span>&nbsp;<span class="op" id="3166154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3166157">match</span><span class="op" id="3166162">,</span>&nbsp;<span class="ident" id="3166164">_</span><span class="op" id="3166165">,</span>&nbsp;<span class="ident" id="3166167">_</span><span class="op" id="3166168">,</span>&nbsp;<span class="ident" id="3166170">err</span>&nbsp;<span class="op" id="3166174">=</span>&nbsp;<span class="ident" id="3166176">ctxt</span><span class="op" id="3166180">.</span><span class="ident" id="3166181">matchFile</span><span class="op" id="3166190">(</span><span class="ident" id="3166191">dir</span><span class="op" id="3166194">,</span>&nbsp;<span class="ident" id="3166196">name</span><span class="op" id="3166200">,</span>&nbsp;<span class="builtintype" id="3166202">false</span><span class="op" id="3166207">,</span>&nbsp;<span class="builtintype" id="3166209">nil</span><span class="op" id="3166212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3166215">return</span><br>
<span class="lineno"></span><span class="op" id="3166222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="3166225">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="3166309">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="3166365">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="3166408">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="3166483">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="3166559">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="3166606">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="3166676">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3166711">func</span>&nbsp;<span class="op" id="3166716">(</span><span class="ident" id="3166717">ctxt</span>&nbsp;<span class="op" id="3166722">*</span><span class="ident" id="3166723">Context</span><span class="op" id="3166730">)</span>&nbsp;<span class="ident" id="3166732">matchFile</span><span class="op" id="3166741">(</span><span class="ident" id="3166742">dir</span><span class="op" id="3166745">,</span>&nbsp;<span class="ident" id="3166747">name</span>&nbsp;<span class="builtintype" id="3166752">string</span><span class="op" id="3166758">,</span>&nbsp;<span class="ident" id="3166760">returnImports</span>&nbsp;<span class="builtintype" id="3166774">bool</span><span class="op" id="3166778">,</span>&nbsp;<span class="ident" id="3166780">allTags</span>&nbsp;<span class="keyword" id="3166788">map</span><span class="op" id="3166791">[</span><span class="builtintype" id="3166792">string</span><span class="op" id="3166798">]</span><span class="builtintype" id="3166799">bool</span><span class="op" id="3166803">)</span>&nbsp;<span class="op" id="3166805">(</span><span class="ident" id="3166806">match</span>&nbsp;<span class="builtintype" id="3166812">bool</span><span class="op" id="3166816">,</span>&nbsp;<span class="ident" id="3166818">data</span>&nbsp;<span class="op" id="3166823">[</span><span class="op" id="3166824">]</span><span class="builtintype" id="3166825">byte</span><span class="op" id="3166829">,</span>&nbsp;<span class="ident" id="3166831">filename</span>&nbsp;<span class="builtintype" id="3166840">string</span><span class="op" id="3166846">,</span>&nbsp;<span class="ident" id="3166848">err</span>&nbsp;<span class="builtintype" id="3166852">error</span><span class="op" id="3166857">)</span>&nbsp;<span class="op" id="3166859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3166862">if</span>&nbsp;<span class="ident" id="3166865">strings</span><span class="op" id="3166872">.</span><span class="ident" id="3166873">HasPrefix</span><span class="op" id="3166882">(</span><span class="ident" id="3166883">name</span><span class="op" id="3166887">,</span>&nbsp;<span class="string" id="3166889">&#34;_&#34;</span><span class="op" id="3166892">)</span>&nbsp;<span class="op" id="3166894">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3166899">strings</span><span class="op" id="3166906">.</span><span class="ident" id="3166907">HasPrefix</span><span class="op" id="3166916">(</span><span class="ident" id="3166917">name</span><span class="op" id="3166921">,</span>&nbsp;<span class="string" id="3166923">&#34;.&#34;</span><span class="op" id="3166926">)</span>&nbsp;<span class="op" id="3166928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3166932">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3166940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3166944">i</span>&nbsp;<span class="op" id="3166946">:=</span>&nbsp;<span class="ident" id="3166949">strings</span><span class="op" id="3166956">.</span><span class="ident" id="3166957">LastIndex</span><span class="op" id="3166966">(</span><span class="ident" id="3166967">name</span><span class="op" id="3166971">,</span>&nbsp;<span class="string" id="3166973">&#34;.&#34;</span><span class="op" id="3166976">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3166979">if</span>&nbsp;<span class="ident" id="3166982">i</span>&nbsp;<span class="op" id="3166984">&lt;</span>&nbsp;<span class="num" id="3166986">0</span>&nbsp;<span class="op" id="3166988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3166992">i</span>&nbsp;<span class="op" id="3166994">=</span>&nbsp;<span class="builtinfunc" id="3166996">len</span><span class="op" id="3166999">(</span><span class="ident" id="3167000">name</span><span class="op" id="3167004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3167007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167010">ext</span>&nbsp;<span class="op" id="3167014">:=</span>&nbsp;<span class="ident" id="3167017">name</span><span class="op" id="3167021">[</span><span class="ident" id="3167022">i</span><span class="op" id="3167023">:</span><span class="op" id="3167024">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167028">if</span>&nbsp;<span class="op" id="3167031">!</span><span class="ident" id="3167032">ctxt</span><span class="op" id="3167036">.</span><span class="ident" id="3167037">goodOSArchFile</span><span class="op" id="3167051">(</span><span class="ident" id="3167052">name</span><span class="op" id="3167056">,</span>&nbsp;<span class="ident" id="3167058">allTags</span><span class="op" id="3167065">)</span>&nbsp;<span class="op" id="3167067">&amp;&amp;</span>&nbsp;<span class="op" id="3167070">!</span><span class="ident" id="3167071">ctxt</span><span class="op" id="3167075">.</span><span class="ident" id="3167076">UseAllFiles</span>&nbsp;<span class="op" id="3167088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167092">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3167100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167104">switch</span>&nbsp;<span class="ident" id="3167111">ext</span>&nbsp;<span class="op" id="3167115">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167118">case</span>&nbsp;<span class="string" id="3167123">&#34;.go&#34;</span><span class="op" id="3167128">,</span>&nbsp;<span class="string" id="3167130">&#34;.c&#34;</span><span class="op" id="3167134">,</span>&nbsp;<span class="string" id="3167136">&#34;.cc&#34;</span><span class="op" id="3167141">,</span>&nbsp;<span class="string" id="3167143">&#34;.cxx&#34;</span><span class="op" id="3167149">,</span>&nbsp;<span class="string" id="3167151">&#34;.cpp&#34;</span><span class="op" id="3167157">,</span>&nbsp;<span class="string" id="3167159">&#34;.m&#34;</span><span class="op" id="3167163">,</span>&nbsp;<span class="string" id="3167165">&#34;.s&#34;</span><span class="op" id="3167169">,</span>&nbsp;<span class="string" id="3167171">&#34;.h&#34;</span><span class="op" id="3167175">,</span>&nbsp;<span class="string" id="3167177">&#34;.hh&#34;</span><span class="op" id="3167182">,</span>&nbsp;<span class="string" id="3167184">&#34;.hpp&#34;</span><span class="op" id="3167190">,</span>&nbsp;<span class="string" id="3167192">&#34;.hxx&#34;</span><span class="op" id="3167198">,</span>&nbsp;<span class="string" id="3167200">&#34;.S&#34;</span><span class="op" id="3167204">,</span>&nbsp;<span class="string" id="3167206">&#34;.swig&#34;</span><span class="op" id="3167213">,</span>&nbsp;<span class="string" id="3167215">&#34;.swigcxx&#34;</span><span class="op" id="3167225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3167229">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167270">case</span>&nbsp;<span class="string" id="3167275">&#34;.syso&#34;</span><span class="op" id="3167282">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3167286">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167310">match</span>&nbsp;<span class="op" id="3167316">=</span>&nbsp;<span class="builtintype" id="3167318">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167325">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167333">default</span><span class="op" id="3167340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3167344">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167354">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3167362">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167366">filename</span>&nbsp;<span class="op" id="3167375">=</span>&nbsp;<span class="ident" id="3167377">ctxt</span><span class="op" id="3167381">.</span><span class="ident" id="3167382">joinPath</span><span class="op" id="3167390">(</span><span class="ident" id="3167391">dir</span><span class="op" id="3167394">,</span>&nbsp;<span class="ident" id="3167396">name</span><span class="op" id="3167400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167403">f</span><span class="op" id="3167404">,</span>&nbsp;<span class="ident" id="3167406">err</span>&nbsp;<span class="op" id="3167410">:=</span>&nbsp;<span class="ident" id="3167413">ctxt</span><span class="op" id="3167417">.</span><span class="ident" id="3167418">openFile</span><span class="op" id="3167426">(</span><span class="ident" id="3167427">filename</span><span class="op" id="3167435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167438">if</span>&nbsp;<span class="ident" id="3167441">err</span>&nbsp;<span class="op" id="3167445">!=</span>&nbsp;<span class="builtintype" id="3167448">nil</span>&nbsp;<span class="op" id="3167452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167456">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3167464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167468">if</span>&nbsp;<span class="ident" id="3167471">strings</span><span class="op" id="3167478">.</span><span class="ident" id="3167479">HasSuffix</span><span class="op" id="3167488">(</span><span class="ident" id="3167489">filename</span><span class="op" id="3167497">,</span>&nbsp;<span class="string" id="3167499">&#34;.go&#34;</span><span class="op" id="3167504">)</span>&nbsp;<span class="op" id="3167506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167510">data</span><span class="op" id="3167514">,</span>&nbsp;<span class="ident" id="3167516">err</span>&nbsp;<span class="op" id="3167520">=</span>&nbsp;<span class="ident" id="3167522">readImports</span><span class="op" id="3167533">(</span><span class="ident" id="3167534">f</span><span class="op" id="3167535">,</span>&nbsp;<span class="builtintype" id="3167537">false</span><span class="op" id="3167542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3167545">}</span>&nbsp;<span class="keyword" id="3167547">else</span>&nbsp;<span class="op" id="3167552">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167556">data</span><span class="op" id="3167560">,</span>&nbsp;<span class="ident" id="3167562">err</span>&nbsp;<span class="op" id="3167566">=</span>&nbsp;<span class="ident" id="3167568">readComments</span><span class="op" id="3167580">(</span><span class="ident" id="3167581">f</span><span class="op" id="3167582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3167585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167588">f</span><span class="op" id="3167589">.</span><span class="ident" id="3167590">Close</span><span class="op" id="3167595">(</span><span class="op" id="3167596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167599">if</span>&nbsp;<span class="ident" id="3167602">err</span>&nbsp;<span class="op" id="3167606">!=</span>&nbsp;<span class="builtintype" id="3167609">nil</span>&nbsp;<span class="op" id="3167613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167617">err</span>&nbsp;<span class="op" id="3167621">=</span>&nbsp;<span class="ident" id="3167623">fmt</span><span class="op" id="3167626">.</span><span class="ident" id="3167627">Errorf</span><span class="op" id="3167633">(</span><span class="string" id="3167634">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="3167647">,</span>&nbsp;<span class="ident" id="3167649">filename</span><span class="op" id="3167657">,</span>&nbsp;<span class="ident" id="3167659">err</span><span class="op" id="3167662">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167666">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3167674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3167678">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167737">if</span>&nbsp;<span class="op" id="3167740">!</span><span class="ident" id="3167741">ctxt</span><span class="op" id="3167745">.</span><span class="ident" id="3167746">shouldBuild</span><span class="op" id="3167757">(</span><span class="ident" id="3167758">data</span><span class="op" id="3167762">,</span>&nbsp;<span class="ident" id="3167764">allTags</span><span class="op" id="3167771">)</span>&nbsp;<span class="op" id="3167773">&amp;&amp;</span>&nbsp;<span class="op" id="3167776">!</span><span class="ident" id="3167777">ctxt</span><span class="op" id="3167781">.</span><span class="ident" id="3167782">UseAllFiles</span>&nbsp;<span class="op" id="3167794">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167798">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3167806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167810">match</span>&nbsp;<span class="op" id="3167816">=</span>&nbsp;<span class="builtintype" id="3167818">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167824">return</span><br>
<span class="lineno">975</span><span class="op" id="3167831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3167834">func</span>&nbsp;<span class="ident" id="3167839">cleanImports</span><span class="op" id="3167851">(</span><span class="ident" id="3167852">m</span>&nbsp;<span class="keyword" id="3167854">map</span><span class="op" id="3167857">[</span><span class="builtintype" id="3167858">string</span><span class="op" id="3167864">]</span><span class="op" id="3167865">[</span><span class="op" id="3167866">]</span><span class="ident" id="3167867">token</span><span class="op" id="3167872">.</span><span class="ident" id="3167873">Position</span><span class="op" id="3167881">)</span>&nbsp;<span class="op" id="3167883">(</span><span class="op" id="3167884">[</span><span class="op" id="3167885">]</span><span class="builtintype" id="3167886">string</span><span class="op" id="3167892">,</span>&nbsp;<span class="keyword" id="3167894">map</span><span class="op" id="3167897">[</span><span class="builtintype" id="3167898">string</span><span class="op" id="3167904">]</span><span class="op" id="3167905">[</span><span class="op" id="3167906">]</span><span class="ident" id="3167907">token</span><span class="op" id="3167912">.</span><span class="ident" id="3167913">Position</span><span class="op" id="3167921">)</span>&nbsp;<span class="op" id="3167923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167926">all</span>&nbsp;<span class="op" id="3167930">:=</span>&nbsp;<span class="builtinfunc" id="3167933">make</span><span class="op" id="3167937">(</span><span class="op" id="3167938">[</span><span class="op" id="3167939">]</span><span class="builtintype" id="3167940">string</span><span class="op" id="3167946">,</span>&nbsp;<span class="num" id="3167948">0</span><span class="op" id="3167949">,</span>&nbsp;<span class="builtinfunc" id="3167951">len</span><span class="op" id="3167954">(</span><span class="ident" id="3167955">m</span><span class="op" id="3167956">)</span><span class="op" id="3167957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3167960">for</span>&nbsp;<span class="ident" id="3167964">path</span>&nbsp;<span class="op" id="3167969">:=</span>&nbsp;<span class="keyword" id="3167972">range</span>&nbsp;<span class="ident" id="3167978">m</span>&nbsp;<span class="op" id="3167980">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3167984">all</span>&nbsp;<span class="op" id="3167988">=</span>&nbsp;<span class="builtinfunc" id="3167990">append</span><span class="op" id="3167996">(</span><span class="ident" id="3167997">all</span><span class="op" id="3168000">,</span>&nbsp;<span class="ident" id="3168002">path</span><span class="op" id="3168006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3168009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3168012">sort</span><span class="op" id="3168016">.</span><span class="ident" id="3168017">Strings</span><span class="op" id="3168024">(</span><span class="ident" id="3168025">all</span><span class="op" id="3168028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3168031">return</span>&nbsp;<span class="ident" id="3168038">all</span><span class="op" id="3168041">,</span>&nbsp;<span class="ident" id="3168043">m</span><br>
<span class="lineno"></span><span class="op" id="3168045">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="3168048">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="3168091">func</span>&nbsp;<span class="ident" id="3168096">Import</span><span class="op" id="3168102">(</span><span class="ident" id="3168103">path</span><span class="op" id="3168107">,</span>&nbsp;<span class="ident" id="3168109">srcDir</span>&nbsp;<span class="builtintype" id="3168116">string</span><span class="op" id="3168122">,</span>&nbsp;<span class="ident" id="3168124">mode</span>&nbsp;<span class="ident" id="3168129">ImportMode</span><span class="op" id="3168139">)</span>&nbsp;<span class="op" id="3168141">(</span><span class="op" id="3168142">*</span><span class="ident" id="3168143">Package</span><span class="op" id="3168150">,</span>&nbsp;<span class="builtintype" id="3168152">error</span><span class="op" id="3168157">)</span>&nbsp;<span class="op" id="3168159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3168162">return</span>&nbsp;<span class="ident" id="3168169">Default</span><span class="op" id="3168176">.</span><span class="ident" id="3168177">Import</span><span class="op" id="3168183">(</span><span class="ident" id="3168184">path</span><span class="op" id="3168188">,</span>&nbsp;<span class="ident" id="3168190">srcDir</span><span class="op" id="3168196">,</span>&nbsp;<span class="ident" id="3168198">mode</span><span class="op" id="3168202">)</span><br>
<span class="lineno"></span><span class="op" id="3168204">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="3168207">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="3168256">func</span>&nbsp;<span class="ident" id="3168261">ImportDir</span><span class="op" id="3168270">(</span><span class="ident" id="3168271">dir</span>&nbsp;<span class="builtintype" id="3168275">string</span><span class="op" id="3168281">,</span>&nbsp;<span class="ident" id="3168283">mode</span>&nbsp;<span class="ident" id="3168288">ImportMode</span><span class="op" id="3168298">)</span>&nbsp;<span class="op" id="3168300">(</span><span class="op" id="3168301">*</span><span class="ident" id="3168302">Package</span><span class="op" id="3168309">,</span>&nbsp;<span class="builtintype" id="3168311">error</span><span class="op" id="3168316">)</span>&nbsp;<span class="op" id="3168318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3168321">return</span>&nbsp;<span class="ident" id="3168328">Default</span><span class="op" id="3168335">.</span><span class="ident" id="3168336">ImportDir</span><span class="op" id="3168345">(</span><span class="ident" id="3168346">dir</span><span class="op" id="3168349">,</span>&nbsp;<span class="ident" id="3168351">mode</span><span class="op" id="3168355">)</span><br>
<span class="lineno"></span><span class="op" id="3168357">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="3168360">var</span>&nbsp;<span class="ident" id="3168364">slashslash</span>&nbsp;<span class="op" id="3168375">=</span>&nbsp;<span class="op" id="3168377">[</span><span class="op" id="3168378">]</span><span class="builtintype" id="3168379">byte</span><span class="op" id="3168383">(</span><span class="string" id="3168384">&#34;//&#34;</span><span class="op" id="3168388">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3168391">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="3168451">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="3168512">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="3168571">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="3168628">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="3168695">//</span><br>
<span class="lineno"></span><span class="comment" id="3168698">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="3168761">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="3168797">//</span><br>
<span class="lineno"></span><span class="comment" id="3168800">//&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="3168827">//</span><br>
<span class="lineno"></span><span class="comment" id="3168830">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="3168889">//</span><br>
<span class="lineno"></span><span class="keyword" id="3168892">func</span>&nbsp;<span class="op" id="3168897">(</span><span class="ident" id="3168898">ctxt</span>&nbsp;<span class="op" id="3168903">*</span><span class="ident" id="3168904">Context</span><span class="op" id="3168911">)</span>&nbsp;<span class="ident" id="3168913">shouldBuild</span><span class="op" id="3168924">(</span><span class="ident" id="3168925">content</span>&nbsp;<span class="op" id="3168933">[</span><span class="op" id="3168934">]</span><span class="builtintype" id="3168935">byte</span><span class="op" id="3168939">,</span>&nbsp;<span class="ident" id="3168941">allTags</span>&nbsp;<span class="keyword" id="3168949">map</span><span class="op" id="3168952">[</span><span class="builtintype" id="3168953">string</span><span class="op" id="3168959">]</span><span class="builtintype" id="3168960">bool</span><span class="op" id="3168964">)</span>&nbsp;<span class="builtintype" id="3168966">bool</span>&nbsp;<span class="op" id="3168971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3168974">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3169039">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169083">end</span>&nbsp;<span class="op" id="3169087">:=</span>&nbsp;<span class="num" id="3169090">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169093">p</span>&nbsp;<span class="op" id="3169095">:=</span>&nbsp;<span class="ident" id="3169098">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169107">for</span>&nbsp;<span class="builtinfunc" id="3169111">len</span><span class="op" id="3169114">(</span><span class="ident" id="3169115">p</span><span class="op" id="3169116">)</span>&nbsp;<span class="op" id="3169118">&gt;</span>&nbsp;<span class="num" id="3169120">0</span>&nbsp;<span class="op" id="3169122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169126">line</span>&nbsp;<span class="op" id="3169131">:=</span>&nbsp;<span class="ident" id="3169134">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169138">if</span>&nbsp;<span class="ident" id="3169141">i</span>&nbsp;<span class="op" id="3169143">:=</span>&nbsp;<span class="ident" id="3169146">bytes</span><span class="op" id="3169151">.</span><span class="ident" id="3169152">IndexByte</span><span class="op" id="3169161">(</span><span class="ident" id="3169162">line</span><span class="op" id="3169166">,</span>&nbsp;<span class="string" id="3169168">&#39;\n&#39;</span><span class="op" id="3169172">)</span><span class="op" id="3169173">;</span>&nbsp;<span class="ident" id="3169175">i</span>&nbsp;<span class="op" id="3169177">&gt;=</span>&nbsp;<span class="num" id="3169180">0</span>&nbsp;<span class="op" id="3169182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169187">line</span><span class="op" id="3169191">,</span>&nbsp;<span class="ident" id="3169193">p</span>&nbsp;<span class="op" id="3169195">=</span>&nbsp;<span class="ident" id="3169197">line</span><span class="op" id="3169201">[</span><span class="op" id="3169202">:</span><span class="ident" id="3169203">i</span><span class="op" id="3169204">]</span><span class="op" id="3169205">,</span>&nbsp;<span class="ident" id="3169207">p</span><span class="op" id="3169208">[</span><span class="ident" id="3169209">i</span><span class="op" id="3169210">+</span><span class="num" id="3169211">1</span><span class="op" id="3169212">:</span><span class="op" id="3169213">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3169217">}</span>&nbsp;<span class="keyword" id="3169219">else</span>&nbsp;<span class="op" id="3169224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169229">p</span>&nbsp;<span class="op" id="3169231">=</span>&nbsp;<span class="ident" id="3169233">p</span><span class="op" id="3169234">[</span><span class="builtinfunc" id="3169235">len</span><span class="op" id="3169238">(</span><span class="ident" id="3169239">p</span><span class="op" id="3169240">)</span><span class="op" id="3169241">:</span><span class="op" id="3169242">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3169246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169250">line</span>&nbsp;<span class="op" id="3169255">=</span>&nbsp;<span class="ident" id="3169257">bytes</span><span class="op" id="3169262">.</span><span class="ident" id="3169263">TrimSpace</span><span class="op" id="3169272">(</span><span class="ident" id="3169273">line</span><span class="op" id="3169277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169281">if</span>&nbsp;<span class="builtinfunc" id="3169284">len</span><span class="op" id="3169287">(</span><span class="ident" id="3169288">line</span><span class="op" id="3169292">)</span>&nbsp;<span class="op" id="3169294">==</span>&nbsp;<span class="num" id="3169297">0</span>&nbsp;<span class="op" id="3169299">{</span>&nbsp;<span class="comment" id="3169301">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169318">end</span>&nbsp;<span class="op" id="3169322">=</span>&nbsp;<span class="builtinfunc" id="3169324">len</span><span class="op" id="3169327">(</span><span class="ident" id="3169328">content</span><span class="op" id="3169335">)</span>&nbsp;<span class="op" id="3169337">-</span>&nbsp;<span class="builtinfunc" id="3169339">len</span><span class="op" id="3169342">(</span><span class="ident" id="3169343">p</span><span class="op" id="3169344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169349">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3169360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169364">if</span>&nbsp;<span class="op" id="3169367">!</span><span class="ident" id="3169368">bytes</span><span class="op" id="3169373">.</span><span class="ident" id="3169374">HasPrefix</span><span class="op" id="3169383">(</span><span class="ident" id="3169384">line</span><span class="op" id="3169388">,</span>&nbsp;<span class="ident" id="3169390">slashslash</span><span class="op" id="3169400">)</span>&nbsp;<span class="op" id="3169402">{</span>&nbsp;<span class="comment" id="3169404">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169427">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3169435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3169438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169441">content</span>&nbsp;<span class="op" id="3169449">=</span>&nbsp;<span class="ident" id="3169451">content</span><span class="op" id="3169458">[</span><span class="op" id="3169459">:</span><span class="ident" id="3169460">end</span><span class="op" id="3169463">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3169467">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169510">p</span>&nbsp;<span class="op" id="3169512">=</span>&nbsp;<span class="ident" id="3169514">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169523">allok</span>&nbsp;<span class="op" id="3169529">:=</span>&nbsp;<span class="builtintype" id="3169532">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169538">for</span>&nbsp;<span class="builtinfunc" id="3169542">len</span><span class="op" id="3169545">(</span><span class="ident" id="3169546">p</span><span class="op" id="3169547">)</span>&nbsp;<span class="op" id="3169549">&gt;</span>&nbsp;<span class="num" id="3169551">0</span>&nbsp;<span class="op" id="3169553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169557">line</span>&nbsp;<span class="op" id="3169562">:=</span>&nbsp;<span class="ident" id="3169565">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169569">if</span>&nbsp;<span class="ident" id="3169572">i</span>&nbsp;<span class="op" id="3169574">:=</span>&nbsp;<span class="ident" id="3169577">bytes</span><span class="op" id="3169582">.</span><span class="ident" id="3169583">IndexByte</span><span class="op" id="3169592">(</span><span class="ident" id="3169593">line</span><span class="op" id="3169597">,</span>&nbsp;<span class="string" id="3169599">&#39;\n&#39;</span><span class="op" id="3169603">)</span><span class="op" id="3169604">;</span>&nbsp;<span class="ident" id="3169606">i</span>&nbsp;<span class="op" id="3169608">&gt;=</span>&nbsp;<span class="num" id="3169611">0</span>&nbsp;<span class="op" id="3169613">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169618">line</span><span class="op" id="3169622">,</span>&nbsp;<span class="ident" id="3169624">p</span>&nbsp;<span class="op" id="3169626">=</span>&nbsp;<span class="ident" id="3169628">line</span><span class="op" id="3169632">[</span><span class="op" id="3169633">:</span><span class="ident" id="3169634">i</span><span class="op" id="3169635">]</span><span class="op" id="3169636">,</span>&nbsp;<span class="ident" id="3169638">p</span><span class="op" id="3169639">[</span><span class="ident" id="3169640">i</span><span class="op" id="3169641">+</span><span class="num" id="3169642">1</span><span class="op" id="3169643">:</span><span class="op" id="3169644">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3169648">}</span>&nbsp;<span class="keyword" id="3169650">else</span>&nbsp;<span class="op" id="3169655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169660">p</span>&nbsp;<span class="op" id="3169662">=</span>&nbsp;<span class="ident" id="3169664">p</span><span class="op" id="3169665">[</span><span class="builtinfunc" id="3169666">len</span><span class="op" id="3169669">(</span><span class="ident" id="3169670">p</span><span class="op" id="3169671">)</span><span class="op" id="3169672">:</span><span class="op" id="3169673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3169677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169681">line</span>&nbsp;<span class="op" id="3169686">=</span>&nbsp;<span class="ident" id="3169688">bytes</span><span class="op" id="3169693">.</span><span class="ident" id="3169694">TrimSpace</span><span class="op" id="3169703">(</span><span class="ident" id="3169704">line</span><span class="op" id="3169708">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169712">if</span>&nbsp;<span class="ident" id="3169715">bytes</span><span class="op" id="3169720">.</span><span class="ident" id="3169721">HasPrefix</span><span class="op" id="3169730">(</span><span class="ident" id="3169731">line</span><span class="op" id="3169735">,</span>&nbsp;<span class="ident" id="3169737">slashslash</span><span class="op" id="3169747">)</span>&nbsp;<span class="op" id="3169749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169754">line</span>&nbsp;<span class="op" id="3169759">=</span>&nbsp;<span class="ident" id="3169761">bytes</span><span class="op" id="3169766">.</span><span class="ident" id="3169767">TrimSpace</span><span class="op" id="3169776">(</span><span class="ident" id="3169777">line</span><span class="op" id="3169781">[</span><span class="builtinfunc" id="3169782">len</span><span class="op" id="3169785">(</span><span class="ident" id="3169786">slashslash</span><span class="op" id="3169796">)</span><span class="op" id="3169797">:</span><span class="op" id="3169798">]</span><span class="op" id="3169799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169804">if</span>&nbsp;<span class="builtinfunc" id="3169807">len</span><span class="op" id="3169810">(</span><span class="ident" id="3169811">line</span><span class="op" id="3169815">)</span>&nbsp;<span class="op" id="3169817">&gt;</span>&nbsp;<span class="num" id="3169819">0</span>&nbsp;<span class="op" id="3169821">&amp;&amp;</span>&nbsp;<span class="ident" id="3169824">line</span><span class="op" id="3169828">[</span><span class="num" id="3169829">0</span><span class="op" id="3169830">]</span>&nbsp;<span class="op" id="3169832">==</span>&nbsp;<span class="string" id="3169835">&#39;+&#39;</span>&nbsp;<span class="op" id="3169839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3169845">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169880">f</span>&nbsp;<span class="op" id="3169882">:=</span>&nbsp;<span class="ident" id="3169885">strings</span><span class="op" id="3169892">.</span><span class="ident" id="3169893">Fields</span><span class="op" id="3169899">(</span><span class="builtintype" id="3169900">string</span><span class="op" id="3169906">(</span><span class="ident" id="3169907">line</span><span class="op" id="3169911">)</span><span class="op" id="3169912">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169918">if</span>&nbsp;<span class="ident" id="3169921">f</span><span class="op" id="3169922">[</span><span class="num" id="3169923">0</span><span class="op" id="3169924">]</span>&nbsp;<span class="op" id="3169926">==</span>&nbsp;<span class="string" id="3169929">&#34;+build&#34;</span>&nbsp;<span class="op" id="3169938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3169945">ok</span>&nbsp;<span class="op" id="3169948">:=</span>&nbsp;<span class="builtintype" id="3169951">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169962">for</span>&nbsp;<span class="ident" id="3169966">_</span><span class="op" id="3169967">,</span>&nbsp;<span class="ident" id="3169969">tok</span>&nbsp;<span class="op" id="3169973">:=</span>&nbsp;<span class="keyword" id="3169976">range</span>&nbsp;<span class="ident" id="3169982">f</span><span class="op" id="3169983">[</span><span class="num" id="3169984">1</span><span class="op" id="3169985">:</span><span class="op" id="3169986">]</span>&nbsp;<span class="op" id="3169988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3169996">if</span>&nbsp;<span class="ident" id="3169999">ctxt</span><span class="op" id="3170003">.</span><span class="ident" id="3170004">match</span><span class="op" id="3170009">(</span><span class="ident" id="3170010">tok</span><span class="op" id="3170013">,</span>&nbsp;<span class="ident" id="3170015">allTags</span><span class="op" id="3170022">)</span>&nbsp;<span class="op" id="3170024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3170033">ok</span>&nbsp;<span class="op" id="3170036">=</span>&nbsp;<span class="builtintype" id="3170038">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3170063">if</span>&nbsp;<span class="op" id="3170066">!</span><span class="ident" id="3170067">ok</span>&nbsp;<span class="op" id="3170070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3170078">allok</span>&nbsp;<span class="op" id="3170084">=</span>&nbsp;<span class="builtintype" id="3170086">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170097">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3170119">return</span>&nbsp;<span class="ident" id="3170126">allok</span><br>
<span class="lineno"></span><span class="op" id="3170132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3170135">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="3170215">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="3170299">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="3170345">//</span><br>
<span class="lineno"></span><span class="comment" id="3170348">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="3170391">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="3170444">func</span>&nbsp;<span class="op" id="3170449">(</span><span class="ident" id="3170450">ctxt</span>&nbsp;<span class="op" id="3170455">*</span><span class="ident" id="3170456">Context</span><span class="op" id="3170463">)</span>&nbsp;<span class="ident" id="3170465">saveCgo</span><span class="op" id="3170472">(</span><span class="ident" id="3170473">filename</span>&nbsp;<span class="builtintype" id="3170482">string</span><span class="op" id="3170488">,</span>&nbsp;<span class="ident" id="3170490">di</span>&nbsp;<span class="op" id="3170493">*</span><span class="ident" id="3170494">Package</span><span class="op" id="3170501">,</span>&nbsp;<span class="ident" id="3170503">cg</span>&nbsp;<span class="op" id="3170506">*</span><span class="ident" id="3170507">ast</span><span class="op" id="3170510">.</span><span class="ident" id="3170511">CommentGroup</span><span class="op" id="3170523">)</span>&nbsp;<span class="builtintype" id="3170525">error</span>&nbsp;<span class="op" id="3170531">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3170534">text</span>&nbsp;<span class="op" id="3170539">:=</span>&nbsp;<span class="ident" id="3170542">cg</span><span class="op" id="3170544">.</span><span class="ident" id="3170545">Text</span><span class="op" id="3170549">(</span><span class="op" id="3170550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3170553">for</span>&nbsp;<span class="ident" id="3170557">_</span><span class="op" id="3170558">,</span>&nbsp;<span class="ident" id="3170560">line</span>&nbsp;<span class="op" id="3170565">:=</span>&nbsp;<span class="keyword" id="3170568">range</span>&nbsp;<span class="ident" id="3170574">strings</span><span class="op" id="3170581">.</span><span class="ident" id="3170582">Split</span><span class="op" id="3170587">(</span><span class="ident" id="3170588">text</span><span class="op" id="3170592">,</span>&nbsp;<span class="string" id="3170594">&#34;\n&#34;</span><span class="op" id="3170598">)</span>&nbsp;<span class="op" id="3170600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3170604">orig</span>&nbsp;<span class="op" id="3170609">:=</span>&nbsp;<span class="ident" id="3170612">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3170620">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3170633">//&nbsp;&nbsp;&nbsp;&nbsp;#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3170675">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3170680">line</span>&nbsp;<span class="op" id="3170685">=</span>&nbsp;<span class="ident" id="3170687">strings</span><span class="op" id="3170694">.</span><span class="ident" id="3170695">TrimSpace</span><span class="op" id="3170704">(</span><span class="ident" id="3170705">line</span><span class="op" id="3170709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3170713">if</span>&nbsp;<span class="builtinfunc" id="3170716">len</span><span class="op" id="3170719">(</span><span class="ident" id="3170720">line</span><span class="op" id="3170724">)</span>&nbsp;<span class="op" id="3170726">&lt;</span>&nbsp;<span class="num" id="3170728">5</span>&nbsp;<span class="op" id="3170730">||</span>&nbsp;<span class="ident" id="3170733">line</span><span class="op" id="3170737">[</span><span class="op" id="3170738">:</span><span class="num" id="3170739">4</span><span class="op" id="3170740">]</span>&nbsp;<span class="op" id="3170742">!=</span>&nbsp;<span class="string" id="3170745">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="3170752">||</span>&nbsp;<span class="op" id="3170755">(</span><span class="ident" id="3170756">line</span><span class="op" id="3170760">[</span><span class="num" id="3170761">4</span><span class="op" id="3170762">]</span>&nbsp;<span class="op" id="3170764">!=</span>&nbsp;<span class="string" id="3170767">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3170771">&amp;&amp;</span>&nbsp;<span class="ident" id="3170774">line</span><span class="op" id="3170778">[</span><span class="num" id="3170779">4</span><span class="op" id="3170780">]</span>&nbsp;<span class="op" id="3170782">!=</span>&nbsp;<span class="string" id="3170785">&#39;\t&#39;</span><span class="op" id="3170789">)</span>&nbsp;<span class="op" id="3170791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3170796">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3170812">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3170833">line</span>&nbsp;<span class="op" id="3170838">=</span>&nbsp;<span class="ident" id="3170840">strings</span><span class="op" id="3170847">.</span><span class="ident" id="3170848">TrimSpace</span><span class="op" id="3170857">(</span><span class="ident" id="3170858">line</span><span class="op" id="3170862">[</span><span class="num" id="3170863">4</span><span class="op" id="3170864">:</span><span class="op" id="3170865">]</span><span class="op" id="3170866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3170870">i</span>&nbsp;<span class="op" id="3170872">:=</span>&nbsp;<span class="ident" id="3170875">strings</span><span class="op" id="3170882">.</span><span class="ident" id="3170883">Index</span><span class="op" id="3170888">(</span><span class="ident" id="3170889">line</span><span class="op" id="3170893">,</span>&nbsp;<span class="string" id="3170895">&#34;:&#34;</span><span class="op" id="3170898">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3170902">if</span>&nbsp;<span class="ident" id="3170905">i</span>&nbsp;<span class="op" id="3170907">&lt;</span>&nbsp;<span class="num" id="3170909">0</span>&nbsp;<span class="op" id="3170911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3170916">return</span>&nbsp;<span class="ident" id="3170923">fmt</span><span class="op" id="3170926">.</span><span class="ident" id="3170927">Errorf</span><span class="op" id="3170933">(</span><span class="string" id="3170934">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="3170961">,</span>&nbsp;<span class="ident" id="3170963">filename</span><span class="op" id="3170971">,</span>&nbsp;<span class="ident" id="3170973">orig</span><span class="op" id="3170977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3170985">line</span><span class="op" id="3170989">,</span>&nbsp;<span class="ident" id="3170991">argstr</span>&nbsp;<span class="op" id="3170998">:=</span>&nbsp;<span class="ident" id="3171001">line</span><span class="op" id="3171005">[</span><span class="op" id="3171006">:</span><span class="ident" id="3171007">i</span><span class="op" id="3171008">]</span><span class="op" id="3171009">,</span>&nbsp;<span class="ident" id="3171011">line</span><span class="op" id="3171015">[</span><span class="ident" id="3171016">i</span><span class="op" id="3171017">+</span><span class="num" id="3171018">1</span><span class="op" id="3171019">:</span><span class="op" id="3171020">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3171025">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171055">f</span>&nbsp;<span class="op" id="3171057">:=</span>&nbsp;<span class="ident" id="3171060">strings</span><span class="op" id="3171067">.</span><span class="ident" id="3171068">Fields</span><span class="op" id="3171074">(</span><span class="ident" id="3171075">line</span><span class="op" id="3171079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171083">if</span>&nbsp;<span class="builtinfunc" id="3171086">len</span><span class="op" id="3171089">(</span><span class="ident" id="3171090">f</span><span class="op" id="3171091">)</span>&nbsp;<span class="op" id="3171093">&lt;</span>&nbsp;<span class="num" id="3171095">1</span>&nbsp;<span class="op" id="3171097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171102">return</span>&nbsp;<span class="ident" id="3171109">fmt</span><span class="op" id="3171112">.</span><span class="ident" id="3171113">Errorf</span><span class="op" id="3171119">(</span><span class="string" id="3171120">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="3171147">,</span>&nbsp;<span class="ident" id="3171149">filename</span><span class="op" id="3171157">,</span>&nbsp;<span class="ident" id="3171159">orig</span><span class="op" id="3171163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171167">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171172">cond</span><span class="op" id="3171176">,</span>&nbsp;<span class="ident" id="3171178">verb</span>&nbsp;<span class="op" id="3171183">:=</span>&nbsp;<span class="ident" id="3171186">f</span><span class="op" id="3171187">[</span><span class="op" id="3171188">:</span><span class="builtinfunc" id="3171189">len</span><span class="op" id="3171192">(</span><span class="ident" id="3171193">f</span><span class="op" id="3171194">)</span><span class="op" id="3171195">-</span><span class="num" id="3171196">1</span><span class="op" id="3171197">]</span><span class="op" id="3171198">,</span>&nbsp;<span class="ident" id="3171200">f</span><span class="op" id="3171201">[</span><span class="builtinfunc" id="3171202">len</span><span class="op" id="3171205">(</span><span class="ident" id="3171206">f</span><span class="op" id="3171207">)</span><span class="op" id="3171208">-</span><span class="num" id="3171209">1</span><span class="op" id="3171210">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171214">if</span>&nbsp;<span class="builtinfunc" id="3171217">len</span><span class="op" id="3171220">(</span><span class="ident" id="3171221">cond</span><span class="op" id="3171225">)</span>&nbsp;<span class="op" id="3171227">&gt;</span>&nbsp;<span class="num" id="3171229">0</span>&nbsp;<span class="op" id="3171231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171236">ok</span>&nbsp;<span class="op" id="3171239">:=</span>&nbsp;<span class="builtintype" id="3171242">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171251">for</span>&nbsp;<span class="ident" id="3171255">_</span><span class="op" id="3171256">,</span>&nbsp;<span class="ident" id="3171258">c</span>&nbsp;<span class="op" id="3171260">:=</span>&nbsp;<span class="keyword" id="3171263">range</span>&nbsp;<span class="ident" id="3171269">cond</span>&nbsp;<span class="op" id="3171274">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171280">if</span>&nbsp;<span class="ident" id="3171283">ctxt</span><span class="op" id="3171287">.</span><span class="ident" id="3171288">match</span><span class="op" id="3171293">(</span><span class="ident" id="3171294">c</span><span class="op" id="3171295">,</span>&nbsp;<span class="builtintype" id="3171297">nil</span><span class="op" id="3171300">)</span>&nbsp;<span class="op" id="3171302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171309">ok</span>&nbsp;<span class="op" id="3171312">=</span>&nbsp;<span class="builtintype" id="3171314">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171324">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171339">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171344">if</span>&nbsp;<span class="op" id="3171347">!</span><span class="ident" id="3171348">ok</span>&nbsp;<span class="op" id="3171351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171357">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171378">args</span><span class="op" id="3171382">,</span>&nbsp;<span class="ident" id="3171384">err</span>&nbsp;<span class="op" id="3171388">:=</span>&nbsp;<span class="ident" id="3171391">splitQuoted</span><span class="op" id="3171402">(</span><span class="ident" id="3171403">argstr</span><span class="op" id="3171409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171413">if</span>&nbsp;<span class="ident" id="3171416">err</span>&nbsp;<span class="op" id="3171420">!=</span>&nbsp;<span class="builtintype" id="3171423">nil</span>&nbsp;<span class="op" id="3171427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171432">return</span>&nbsp;<span class="ident" id="3171439">fmt</span><span class="op" id="3171442">.</span><span class="ident" id="3171443">Errorf</span><span class="op" id="3171449">(</span><span class="string" id="3171450">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="3171477">,</span>&nbsp;<span class="ident" id="3171479">filename</span><span class="op" id="3171487">,</span>&nbsp;<span class="ident" id="3171489">orig</span><span class="op" id="3171493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171501">for</span>&nbsp;<span class="ident" id="3171505">_</span><span class="op" id="3171506">,</span>&nbsp;<span class="ident" id="3171508">arg</span>&nbsp;<span class="op" id="3171512">:=</span>&nbsp;<span class="keyword" id="3171515">range</span>&nbsp;<span class="ident" id="3171521">args</span>&nbsp;<span class="op" id="3171526">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171531">if</span>&nbsp;<span class="op" id="3171534">!</span><span class="ident" id="3171535">safeCgoName</span><span class="op" id="3171546">(</span><span class="ident" id="3171547">arg</span><span class="op" id="3171550">)</span>&nbsp;<span class="op" id="3171552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171558">return</span>&nbsp;<span class="ident" id="3171565">fmt</span><span class="op" id="3171568">.</span><span class="ident" id="3171569">Errorf</span><span class="op" id="3171575">(</span><span class="string" id="3171576">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="3171609">,</span>&nbsp;<span class="ident" id="3171611">filename</span><span class="op" id="3171619">,</span>&nbsp;<span class="ident" id="3171621">arg</span><span class="op" id="3171624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171638">switch</span>&nbsp;<span class="ident" id="3171645">verb</span>&nbsp;<span class="op" id="3171650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171654">case</span>&nbsp;<span class="string" id="3171659">&#34;CFLAGS&#34;</span><span class="op" id="3171667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171672">di</span><span class="op" id="3171674">.</span><span class="ident" id="3171675">CgoCFLAGS</span>&nbsp;<span class="op" id="3171685">=</span>&nbsp;<span class="builtinfunc" id="3171687">append</span><span class="op" id="3171693">(</span><span class="ident" id="3171694">di</span><span class="op" id="3171696">.</span><span class="ident" id="3171697">CgoCFLAGS</span><span class="op" id="3171706">,</span>&nbsp;<span class="ident" id="3171708">args</span><span class="op" id="3171712">...</span><span class="op" id="3171715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171719">case</span>&nbsp;<span class="string" id="3171724">&#34;CPPFLAGS&#34;</span><span class="op" id="3171734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171739">di</span><span class="op" id="3171741">.</span><span class="ident" id="3171742">CgoCPPFLAGS</span>&nbsp;<span class="op" id="3171754">=</span>&nbsp;<span class="builtinfunc" id="3171756">append</span><span class="op" id="3171762">(</span><span class="ident" id="3171763">di</span><span class="op" id="3171765">.</span><span class="ident" id="3171766">CgoCPPFLAGS</span><span class="op" id="3171777">,</span>&nbsp;<span class="ident" id="3171779">args</span><span class="op" id="3171783">...</span><span class="op" id="3171786">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171790">case</span>&nbsp;<span class="string" id="3171795">&#34;CXXFLAGS&#34;</span><span class="op" id="3171805">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171810">di</span><span class="op" id="3171812">.</span><span class="ident" id="3171813">CgoCXXFLAGS</span>&nbsp;<span class="op" id="3171825">=</span>&nbsp;<span class="builtinfunc" id="3171827">append</span><span class="op" id="3171833">(</span><span class="ident" id="3171834">di</span><span class="op" id="3171836">.</span><span class="ident" id="3171837">CgoCXXFLAGS</span><span class="op" id="3171848">,</span>&nbsp;<span class="ident" id="3171850">args</span><span class="op" id="3171854">...</span><span class="op" id="3171857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171861">case</span>&nbsp;<span class="string" id="3171866">&#34;LDFLAGS&#34;</span><span class="op" id="3171875">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171880">di</span><span class="op" id="3171882">.</span><span class="ident" id="3171883">CgoLDFLAGS</span>&nbsp;<span class="op" id="3171894">=</span>&nbsp;<span class="builtinfunc" id="3171896">append</span><span class="op" id="3171902">(</span><span class="ident" id="3171903">di</span><span class="op" id="3171905">.</span><span class="ident" id="3171906">CgoLDFLAGS</span><span class="op" id="3171916">,</span>&nbsp;<span class="ident" id="3171918">args</span><span class="op" id="3171922">...</span><span class="op" id="3171925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3171929">case</span>&nbsp;<span class="string" id="3171934">&#34;pkg-config&#34;</span><span class="op" id="3171946">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3171951">di</span><span class="op" id="3171953">.</span><span class="ident" id="3171954">CgoPkgConfig</span>&nbsp;<span class="op" id="3171967">=</span>&nbsp;<span class="builtinfunc" id="3171969">append</span><span class="op" id="3171975">(</span><span class="ident" id="3171976">di</span><span class="op" id="3171978">.</span><span class="ident" id="3171979">CgoPkgConfig</span><span class="op" id="3171991">,</span>&nbsp;<span class="ident" id="3171993">args</span><span class="op" id="3171997">...</span><span class="op" id="3172000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3172004">default</span><span class="op" id="3172011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3172016">return</span>&nbsp;<span class="ident" id="3172023">fmt</span><span class="op" id="3172026">.</span><span class="ident" id="3172027">Errorf</span><span class="op" id="3172033">(</span><span class="string" id="3172034">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="3172061">,</span>&nbsp;<span class="ident" id="3172063">filename</span><span class="op" id="3172071">,</span>&nbsp;<span class="ident" id="3172073">orig</span><span class="op" id="3172077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3172081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3172084">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3172087">return</span>&nbsp;<span class="builtintype" id="3172094">nil</span><br>
<span class="lineno"></span><span class="op" id="3172098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3172101">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="3172206">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="3172316">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="3172346">var</span>&nbsp;<span class="ident" id="3172350">safeBytes</span>&nbsp;<span class="op" id="3172360">=</span>&nbsp;<span class="op" id="3172362">[</span><span class="op" id="3172363">]</span><span class="builtintype" id="3172364">byte</span><span class="op" id="3172368">(</span><span class="string" id="3172369">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="3172442">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3172445">func</span>&nbsp;<span class="ident" id="3172450">safeCgoName</span><span class="op" id="3172461">(</span><span class="ident" id="3172462">s</span>&nbsp;<span class="builtintype" id="3172464">string</span><span class="op" id="3172470">)</span>&nbsp;<span class="builtintype" id="3172472">bool</span>&nbsp;<span class="op" id="3172477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3172480">if</span>&nbsp;<span class="ident" id="3172483">s</span>&nbsp;<span class="op" id="3172485">==</span>&nbsp;<span class="string" id="3172488">&#34;&#34;</span>&nbsp;<span class="op" id="3172491">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3172495">return</span>&nbsp;<span class="builtintype" id="3172502">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3172509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3172512">for</span>&nbsp;<span class="ident" id="3172516">i</span>&nbsp;<span class="op" id="3172518">:=</span>&nbsp;<span class="num" id="3172521">0</span><span class="op" id="3172522">;</span>&nbsp;<span class="ident" id="3172524">i</span>&nbsp;<span class="op" id="3172526">&lt;</span>&nbsp;<span class="builtinfunc" id="3172528">len</span><span class="op" id="3172531">(</span><span class="ident" id="3172532">s</span><span class="op" id="3172533">)</span><span class="op" id="3172534">;</span>&nbsp;<span class="ident" id="3172536">i</span><span class="op" id="3172537">++</span>&nbsp;<span class="op" id="3172540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3172544">if</span>&nbsp;<span class="ident" id="3172547">c</span>&nbsp;<span class="op" id="3172549">:=</span>&nbsp;<span class="ident" id="3172552">s</span><span class="op" id="3172553">[</span><span class="ident" id="3172554">i</span><span class="op" id="3172555">]</span><span class="op" id="3172556">;</span>&nbsp;<span class="ident" id="3172558">c</span>&nbsp;<span class="op" id="3172560">&lt;</span>&nbsp;<span class="num" id="3172562">0x80</span>&nbsp;<span class="op" id="3172567">&amp;&amp;</span>&nbsp;<span class="ident" id="3172570">bytes</span><span class="op" id="3172575">.</span><span class="ident" id="3172576">IndexByte</span><span class="op" id="3172585">(</span><span class="ident" id="3172586">safeBytes</span><span class="op" id="3172595">,</span>&nbsp;<span class="ident" id="3172597">c</span><span class="op" id="3172598">)</span>&nbsp;<span class="op" id="3172600">&lt;</span>&nbsp;<span class="num" id="3172602">0</span>&nbsp;<span class="op" id="3172604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3172609">return</span>&nbsp;<span class="builtintype" id="3172616">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3172624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3172627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3172630">return</span>&nbsp;<span class="builtintype" id="3172637">true</span><br>
<span class="lineno"></span><span class="op" id="3172642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="3172645">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="3172728">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3172805">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="3172893">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3172975">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="3173056">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3173133">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="3173187">//</span><br>
<span class="lineno"></span><span class="comment" id="3173190">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="3173228">//</span><br>
<span class="lineno">1170</span><span class="comment" id="3173231">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3173262">//</span><br>
<span class="lineno"></span><span class="comment" id="3173265">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="3173288">//</span><br>
<span class="lineno"></span><span class="comment" id="3173291">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="3173333">//</span><br>
<span class="lineno"></span><span class="keyword" id="3173336">func</span>&nbsp;<span class="ident" id="3173341">splitQuoted</span><span class="op" id="3173352">(</span><span class="ident" id="3173353">s</span>&nbsp;<span class="builtintype" id="3173355">string</span><span class="op" id="3173361">)</span>&nbsp;<span class="op" id="3173363">(</span><span class="ident" id="3173364">r</span>&nbsp;<span class="op" id="3173366">[</span><span class="op" id="3173367">]</span><span class="builtintype" id="3173368">string</span><span class="op" id="3173374">,</span>&nbsp;<span class="ident" id="3173376">err</span>&nbsp;<span class="builtintype" id="3173380">error</span><span class="op" id="3173385">)</span>&nbsp;<span class="op" id="3173387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173390">var</span>&nbsp;<span class="ident" id="3173394">args</span>&nbsp;<span class="op" id="3173399">[</span><span class="op" id="3173400">]</span><span class="builtintype" id="3173401">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173409">arg</span>&nbsp;<span class="op" id="3173413">:=</span>&nbsp;<span class="builtinfunc" id="3173416">make</span><span class="op" id="3173420">(</span><span class="op" id="3173421">[</span><span class="op" id="3173422">]</span><span class="builtintype" id="3173423">rune</span><span class="op" id="3173427">,</span>&nbsp;<span class="builtinfunc" id="3173429">len</span><span class="op" id="3173432">(</span><span class="ident" id="3173433">s</span><span class="op" id="3173434">)</span><span class="op" id="3173435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173438">escaped</span>&nbsp;<span class="op" id="3173446">:=</span>&nbsp;<span class="builtintype" id="3173449">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173456">quoted</span>&nbsp;<span class="op" id="3173463">:=</span>&nbsp;<span class="builtintype" id="3173466">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173473">quote</span>&nbsp;<span class="op" id="3173479">:=</span>&nbsp;<span class="string" id="3173482">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173490">i</span>&nbsp;<span class="op" id="3173492">:=</span>&nbsp;<span class="num" id="3173495">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173498">for</span>&nbsp;<span class="ident" id="3173502">_</span><span class="op" id="3173503">,</span>&nbsp;<span class="builtintype" id="3173505">rune</span>&nbsp;<span class="op" id="3173510">:=</span>&nbsp;<span class="keyword" id="3173513">range</span>&nbsp;<span class="ident" id="3173519">s</span>&nbsp;<span class="op" id="3173521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173525">switch</span>&nbsp;<span class="op" id="3173532">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173536">case</span>&nbsp;<span class="ident" id="3173541">escaped</span><span class="op" id="3173548">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173553">escaped</span>&nbsp;<span class="op" id="3173561">=</span>&nbsp;<span class="builtintype" id="3173563">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173571">case</span>&nbsp;<span class="builtintype" id="3173576">rune</span>&nbsp;<span class="op" id="3173581">==</span>&nbsp;<span class="string" id="3173584">&#39;\\&#39;</span><span class="op" id="3173588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173593">escaped</span>&nbsp;<span class="op" id="3173601">=</span>&nbsp;<span class="builtintype" id="3173603">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173611">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173622">case</span>&nbsp;<span class="ident" id="3173627">quote</span>&nbsp;<span class="op" id="3173633">!=</span>&nbsp;<span class="string" id="3173636">&#39;\x00&#39;</span><span class="op" id="3173642">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173647">if</span>&nbsp;<span class="builtintype" id="3173650">rune</span>&nbsp;<span class="op" id="3173655">==</span>&nbsp;<span class="ident" id="3173658">quote</span>&nbsp;<span class="op" id="3173664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173670">quote</span>&nbsp;<span class="op" id="3173676">=</span>&nbsp;<span class="string" id="3173678">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173689">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3173701">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173705">case</span>&nbsp;<span class="builtintype" id="3173710">rune</span>&nbsp;<span class="op" id="3173715">==</span>&nbsp;<span class="string" id="3173718">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3173722">||</span>&nbsp;<span class="builtintype" id="3173725">rune</span>&nbsp;<span class="op" id="3173730">==</span>&nbsp;<span class="string" id="3173733">&#39;\&#39;&#39;</span><span class="op" id="3173737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173742">quoted</span>&nbsp;<span class="op" id="3173749">=</span>&nbsp;<span class="builtintype" id="3173751">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173759">quote</span>&nbsp;<span class="op" id="3173765">=</span>&nbsp;<span class="builtintype" id="3173767">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173775">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173786">case</span>&nbsp;<span class="ident" id="3173791">unicode</span><span class="op" id="3173798">.</span><span class="ident" id="3173799">IsSpace</span><span class="op" id="3173806">(</span><span class="builtintype" id="3173807">rune</span><span class="op" id="3173811">)</span><span class="op" id="3173812">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173817">if</span>&nbsp;<span class="ident" id="3173820">quoted</span>&nbsp;<span class="op" id="3173827">||</span>&nbsp;<span class="ident" id="3173830">i</span>&nbsp;<span class="op" id="3173832">&gt;</span>&nbsp;<span class="num" id="3173834">0</span>&nbsp;<span class="op" id="3173836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173842">quoted</span>&nbsp;<span class="op" id="3173849">=</span>&nbsp;<span class="builtintype" id="3173851">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173861">args</span>&nbsp;<span class="op" id="3173866">=</span>&nbsp;<span class="builtinfunc" id="3173868">append</span><span class="op" id="3173874">(</span><span class="ident" id="3173875">args</span><span class="op" id="3173879">,</span>&nbsp;<span class="builtintype" id="3173881">string</span><span class="op" id="3173887">(</span><span class="ident" id="3173888">arg</span><span class="op" id="3173891">[</span><span class="op" id="3173892">:</span><span class="ident" id="3173893">i</span><span class="op" id="3173894">]</span><span class="op" id="3173895">)</span><span class="op" id="3173896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173902">i</span>&nbsp;<span class="op" id="3173904">=</span>&nbsp;<span class="num" id="3173906">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3173911">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173916">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3173927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173931">arg</span><span class="op" id="3173934">[</span><span class="ident" id="3173935">i</span><span class="op" id="3173936">]</span>&nbsp;<span class="op" id="3173938">=</span>&nbsp;<span class="builtintype" id="3173940">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173947">i</span><span class="op" id="3173948">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3173952">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3173955">if</span>&nbsp;<span class="ident" id="3173958">quoted</span>&nbsp;<span class="op" id="3173965">||</span>&nbsp;<span class="ident" id="3173968">i</span>&nbsp;<span class="op" id="3173970">&gt;</span>&nbsp;<span class="num" id="3173972">0</span>&nbsp;<span class="op" id="3173974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3173978">args</span>&nbsp;<span class="op" id="3173983">=</span>&nbsp;<span class="builtinfunc" id="3173985">append</span><span class="op" id="3173991">(</span><span class="ident" id="3173992">args</span><span class="op" id="3173996">,</span>&nbsp;<span class="builtintype" id="3173998">string</span><span class="op" id="3174004">(</span><span class="ident" id="3174005">arg</span><span class="op" id="3174008">[</span><span class="op" id="3174009">:</span><span class="ident" id="3174010">i</span><span class="op" id="3174011">]</span><span class="op" id="3174012">)</span><span class="op" id="3174013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3174016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174019">if</span>&nbsp;<span class="ident" id="3174022">quote</span>&nbsp;<span class="op" id="3174028">!=</span>&nbsp;<span class="num" id="3174031">0</span>&nbsp;<span class="op" id="3174033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3174037">err</span>&nbsp;<span class="op" id="3174041">=</span>&nbsp;<span class="ident" id="3174043">errors</span><span class="op" id="3174049">.</span><span class="ident" id="3174050">New</span><span class="op" id="3174053">(</span><span class="string" id="3174054">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="3174070">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3174073">}</span>&nbsp;<span class="keyword" id="3174075">else</span>&nbsp;<span class="keyword" id="3174080">if</span>&nbsp;<span class="ident" id="3174083">escaped</span>&nbsp;<span class="op" id="3174091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3174095">err</span>&nbsp;<span class="op" id="3174099">=</span>&nbsp;<span class="ident" id="3174101">errors</span><span class="op" id="3174107">.</span><span class="ident" id="3174108">New</span><span class="op" id="3174111">(</span><span class="string" id="3174112">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="3174133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3174136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174139">return</span>&nbsp;<span class="ident" id="3174146">args</span><span class="op" id="3174150">,</span>&nbsp;<span class="ident" id="3174152">err</span><br>
<span class="lineno"></span><span class="op" id="3174156">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="3174159">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="3174204">//</span><br>
<span class="lineno"></span><span class="comment" id="3174207">//&nbsp;&nbsp;&nbsp;&nbsp;$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="3174216">//&nbsp;&nbsp;&nbsp;&nbsp;$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="3174227">//&nbsp;&nbsp;&nbsp;&nbsp;cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="3174254">//&nbsp;&nbsp;&nbsp;&nbsp;!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="3174283">//&nbsp;&nbsp;&nbsp;&nbsp;ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="3174300">//&nbsp;&nbsp;&nbsp;&nbsp;!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="3174318">//&nbsp;&nbsp;&nbsp;&nbsp;tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="3174382">//&nbsp;&nbsp;&nbsp;&nbsp;!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="3174451">//&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="3174493">//</span><br>
<span class="lineno"></span><span class="keyword" id="3174496">func</span>&nbsp;<span class="op" id="3174501">(</span><span class="ident" id="3174502">ctxt</span>&nbsp;<span class="op" id="3174507">*</span><span class="ident" id="3174508">Context</span><span class="op" id="3174515">)</span>&nbsp;<span class="ident" id="3174517">match</span><span class="op" id="3174522">(</span><span class="ident" id="3174523">name</span>&nbsp;<span class="builtintype" id="3174528">string</span><span class="op" id="3174534">,</span>&nbsp;<span class="ident" id="3174536">allTags</span>&nbsp;<span class="keyword" id="3174544">map</span><span class="op" id="3174547">[</span><span class="builtintype" id="3174548">string</span><span class="op" id="3174554">]</span><span class="builtintype" id="3174555">bool</span><span class="op" id="3174559">)</span>&nbsp;<span class="builtintype" id="3174561">bool</span>&nbsp;<span class="op" id="3174566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174569">if</span>&nbsp;<span class="ident" id="3174572">name</span>&nbsp;<span class="op" id="3174577">==</span>&nbsp;<span class="string" id="3174580">&#34;&#34;</span>&nbsp;<span class="op" id="3174583">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174587">if</span>&nbsp;<span class="ident" id="3174590">allTags</span>&nbsp;<span class="op" id="3174598">!=</span>&nbsp;<span class="builtintype" id="3174601">nil</span>&nbsp;<span class="op" id="3174605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3174610">allTags</span><span class="op" id="3174617">[</span><span class="ident" id="3174618">name</span><span class="op" id="3174622">]</span>&nbsp;<span class="op" id="3174624">=</span>&nbsp;<span class="builtintype" id="3174626">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3174633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174637">return</span>&nbsp;<span class="builtintype" id="3174644">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3174651">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174654">if</span>&nbsp;<span class="ident" id="3174657">i</span>&nbsp;<span class="op" id="3174659">:=</span>&nbsp;<span class="ident" id="3174662">strings</span><span class="op" id="3174669">.</span><span class="ident" id="3174670">Index</span><span class="op" id="3174675">(</span><span class="ident" id="3174676">name</span><span class="op" id="3174680">,</span>&nbsp;<span class="string" id="3174682">&#34;,&#34;</span><span class="op" id="3174685">)</span><span class="op" id="3174686">;</span>&nbsp;<span class="ident" id="3174688">i</span>&nbsp;<span class="op" id="3174690">&gt;=</span>&nbsp;<span class="num" id="3174693">0</span>&nbsp;<span class="op" id="3174695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3174699">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3174725">ok1</span>&nbsp;<span class="op" id="3174729">:=</span>&nbsp;<span class="ident" id="3174732">ctxt</span><span class="op" id="3174736">.</span><span class="ident" id="3174737">match</span><span class="op" id="3174742">(</span><span class="ident" id="3174743">name</span><span class="op" id="3174747">[</span><span class="op" id="3174748">:</span><span class="ident" id="3174749">i</span><span class="op" id="3174750">]</span><span class="op" id="3174751">,</span>&nbsp;<span class="ident" id="3174753">allTags</span><span class="op" id="3174760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3174764">ok2</span>&nbsp;<span class="op" id="3174768">:=</span>&nbsp;<span class="ident" id="3174771">ctxt</span><span class="op" id="3174775">.</span><span class="ident" id="3174776">match</span><span class="op" id="3174781">(</span><span class="ident" id="3174782">name</span><span class="op" id="3174786">[</span><span class="ident" id="3174787">i</span><span class="op" id="3174788">+</span><span class="num" id="3174789">1</span><span class="op" id="3174790">:</span><span class="op" id="3174791">]</span><span class="op" id="3174792">,</span>&nbsp;<span class="ident" id="3174794">allTags</span><span class="op" id="3174801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174805">return</span>&nbsp;<span class="ident" id="3174812">ok1</span>&nbsp;<span class="op" id="3174816">&amp;&amp;</span>&nbsp;<span class="ident" id="3174819">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3174824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174827">if</span>&nbsp;<span class="ident" id="3174830">strings</span><span class="op" id="3174837">.</span><span class="ident" id="3174838">HasPrefix</span><span class="op" id="3174847">(</span><span class="ident" id="3174848">name</span><span class="op" id="3174852">,</span>&nbsp;<span class="string" id="3174854">&#34;!!&#34;</span><span class="op" id="3174858">)</span>&nbsp;<span class="op" id="3174860">{</span>&nbsp;<span class="comment" id="3174862">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174893">return</span>&nbsp;<span class="builtintype" id="3174900">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3174907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174910">if</span>&nbsp;<span class="ident" id="3174913">strings</span><span class="op" id="3174920">.</span><span class="ident" id="3174921">HasPrefix</span><span class="op" id="3174930">(</span><span class="ident" id="3174931">name</span><span class="op" id="3174935">,</span>&nbsp;<span class="string" id="3174937">&#34;!&#34;</span><span class="op" id="3174940">)</span>&nbsp;<span class="op" id="3174942">{</span>&nbsp;<span class="comment" id="3174944">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3174958">return</span>&nbsp;<span class="builtinfunc" id="3174965">len</span><span class="op" id="3174968">(</span><span class="ident" id="3174969">name</span><span class="op" id="3174973">)</span>&nbsp;<span class="op" id="3174975">&gt;</span>&nbsp;<span class="num" id="3174977">1</span>&nbsp;<span class="op" id="3174979">&amp;&amp;</span>&nbsp;<span class="op" id="3174982">!</span><span class="ident" id="3174983">ctxt</span><span class="op" id="3174987">.</span><span class="ident" id="3174988">match</span><span class="op" id="3174993">(</span><span class="ident" id="3174994">name</span><span class="op" id="3174998">[</span><span class="num" id="3174999">1</span><span class="op" id="3175000">:</span><span class="op" id="3175001">]</span><span class="op" id="3175002">,</span>&nbsp;<span class="ident" id="3175004">allTags</span><span class="op" id="3175011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175018">if</span>&nbsp;<span class="ident" id="3175021">allTags</span>&nbsp;<span class="op" id="3175029">!=</span>&nbsp;<span class="builtintype" id="3175032">nil</span>&nbsp;<span class="op" id="3175036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3175040">allTags</span><span class="op" id="3175047">[</span><span class="ident" id="3175048">name</span><span class="op" id="3175052">]</span>&nbsp;<span class="op" id="3175054">=</span>&nbsp;<span class="builtintype" id="3175056">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3175066">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3175121">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175186">for</span>&nbsp;<span class="ident" id="3175190">_</span><span class="op" id="3175191">,</span>&nbsp;<span class="ident" id="3175193">c</span>&nbsp;<span class="op" id="3175195">:=</span>&nbsp;<span class="keyword" id="3175198">range</span>&nbsp;<span class="ident" id="3175204">name</span>&nbsp;<span class="op" id="3175209">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175213">if</span>&nbsp;<span class="op" id="3175216">!</span><span class="ident" id="3175217">unicode</span><span class="op" id="3175224">.</span><span class="ident" id="3175225">IsLetter</span><span class="op" id="3175233">(</span><span class="ident" id="3175234">c</span><span class="op" id="3175235">)</span>&nbsp;<span class="op" id="3175237">&amp;&amp;</span>&nbsp;<span class="op" id="3175240">!</span><span class="ident" id="3175241">unicode</span><span class="op" id="3175248">.</span><span class="ident" id="3175249">IsDigit</span><span class="op" id="3175256">(</span><span class="ident" id="3175257">c</span><span class="op" id="3175258">)</span>&nbsp;<span class="op" id="3175260">&amp;&amp;</span>&nbsp;<span class="ident" id="3175263">c</span>&nbsp;<span class="op" id="3175265">!=</span>&nbsp;<span class="string" id="3175268">&#39;_&#39;</span>&nbsp;<span class="op" id="3175272">&amp;&amp;</span>&nbsp;<span class="ident" id="3175275">c</span>&nbsp;<span class="op" id="3175277">!=</span>&nbsp;<span class="string" id="3175280">&#39;.&#39;</span>&nbsp;<span class="op" id="3175284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175289">return</span>&nbsp;<span class="builtintype" id="3175296">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3175311">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175328">if</span>&nbsp;<span class="ident" id="3175331">ctxt</span><span class="op" id="3175335">.</span><span class="ident" id="3175336">CgoEnabled</span>&nbsp;<span class="op" id="3175347">&amp;&amp;</span>&nbsp;<span class="ident" id="3175350">name</span>&nbsp;<span class="op" id="3175355">==</span>&nbsp;<span class="string" id="3175358">&#34;cgo&#34;</span>&nbsp;<span class="op" id="3175364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175368">return</span>&nbsp;<span class="builtintype" id="3175375">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175384">if</span>&nbsp;<span class="ident" id="3175387">name</span>&nbsp;<span class="op" id="3175392">==</span>&nbsp;<span class="ident" id="3175395">ctxt</span><span class="op" id="3175399">.</span><span class="ident" id="3175400">GOOS</span>&nbsp;<span class="op" id="3175405">||</span>&nbsp;<span class="ident" id="3175408">name</span>&nbsp;<span class="op" id="3175413">==</span>&nbsp;<span class="ident" id="3175416">ctxt</span><span class="op" id="3175420">.</span><span class="ident" id="3175421">GOARCH</span>&nbsp;<span class="op" id="3175428">||</span>&nbsp;<span class="ident" id="3175431">name</span>&nbsp;<span class="op" id="3175436">==</span>&nbsp;<span class="ident" id="3175439">ctxt</span><span class="op" id="3175443">.</span><span class="ident" id="3175444">Compiler</span>&nbsp;<span class="op" id="3175453">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175457">return</span>&nbsp;<span class="builtintype" id="3175464">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175473">if</span>&nbsp;<span class="ident" id="3175476">ctxt</span><span class="op" id="3175480">.</span><span class="ident" id="3175481">GOOS</span>&nbsp;<span class="op" id="3175486">==</span>&nbsp;<span class="string" id="3175489">&#34;android&#34;</span>&nbsp;<span class="op" id="3175499">&amp;&amp;</span>&nbsp;<span class="ident" id="3175502">name</span>&nbsp;<span class="op" id="3175507">==</span>&nbsp;<span class="string" id="3175510">&#34;linux&#34;</span>&nbsp;<span class="op" id="3175518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175522">return</span>&nbsp;<span class="builtintype" id="3175529">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175535">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3175539">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175554">for</span>&nbsp;<span class="ident" id="3175558">_</span><span class="op" id="3175559">,</span>&nbsp;<span class="ident" id="3175561">tag</span>&nbsp;<span class="op" id="3175565">:=</span>&nbsp;<span class="keyword" id="3175568">range</span>&nbsp;<span class="ident" id="3175574">ctxt</span><span class="op" id="3175578">.</span><span class="ident" id="3175579">BuildTags</span>&nbsp;<span class="op" id="3175589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175593">if</span>&nbsp;<span class="ident" id="3175596">tag</span>&nbsp;<span class="op" id="3175600">==</span>&nbsp;<span class="ident" id="3175603">name</span>&nbsp;<span class="op" id="3175608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175613">return</span>&nbsp;<span class="builtintype" id="3175620">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175633">for</span>&nbsp;<span class="ident" id="3175637">_</span><span class="op" id="3175638">,</span>&nbsp;<span class="ident" id="3175640">tag</span>&nbsp;<span class="op" id="3175644">:=</span>&nbsp;<span class="keyword" id="3175647">range</span>&nbsp;<span class="ident" id="3175653">ctxt</span><span class="op" id="3175657">.</span><span class="ident" id="3175658">ReleaseTags</span>&nbsp;<span class="op" id="3175670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175674">if</span>&nbsp;<span class="ident" id="3175677">tag</span>&nbsp;<span class="op" id="3175681">==</span>&nbsp;<span class="ident" id="3175684">name</span>&nbsp;<span class="op" id="3175689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175694">return</span>&nbsp;<span class="builtintype" id="3175701">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3175711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3175715">return</span>&nbsp;<span class="builtintype" id="3175722">false</span><br>
<span class="lineno"></span><span class="op" id="3175728">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="3175731">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="3175803">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="3175854">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="3175890">//</span><br>
<span class="lineno">1295</span><span class="comment" id="3175893">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="3175915">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="3175939">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="3175971">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="3175998">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="3176027">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="3176064">//</span><br>
<span class="lineno"></span><span class="comment" id="3176067">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="3176146">func</span>&nbsp;<span class="op" id="3176151">(</span><span class="ident" id="3176152">ctxt</span>&nbsp;<span class="op" id="3176157">*</span><span class="ident" id="3176158">Context</span><span class="op" id="3176165">)</span>&nbsp;<span class="ident" id="3176167">goodOSArchFile</span><span class="op" id="3176181">(</span><span class="ident" id="3176182">name</span>&nbsp;<span class="builtintype" id="3176187">string</span><span class="op" id="3176193">,</span>&nbsp;<span class="ident" id="3176195">allTags</span>&nbsp;<span class="keyword" id="3176203">map</span><span class="op" id="3176206">[</span><span class="builtintype" id="3176207">string</span><span class="op" id="3176213">]</span><span class="builtintype" id="3176214">bool</span><span class="op" id="3176218">)</span>&nbsp;<span class="builtintype" id="3176220">bool</span>&nbsp;<span class="op" id="3176225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3176228">if</span>&nbsp;<span class="ident" id="3176231">dot</span>&nbsp;<span class="op" id="3176235">:=</span>&nbsp;<span class="ident" id="3176238">strings</span><span class="op" id="3176245">.</span><span class="ident" id="3176246">Index</span><span class="op" id="3176251">(</span><span class="ident" id="3176252">name</span><span class="op" id="3176256">,</span>&nbsp;<span class="string" id="3176258">&#34;.&#34;</span><span class="op" id="3176261">)</span><span class="op" id="3176262">;</span>&nbsp;<span class="ident" id="3176264">dot</span>&nbsp;<span class="op" id="3176268">!=</span>&nbsp;<span class="op" id="3176271">-</span><span class="num" id="3176272">1</span>&nbsp;<span class="op" id="3176274">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3176278">name</span>&nbsp;<span class="op" id="3176283">=</span>&nbsp;<span class="ident" id="3176285">name</span><span class="op" id="3176289">[</span><span class="op" id="3176290">:</span><span class="ident" id="3176291">dot</span><span class="op" id="3176294">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3176297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3176301">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3176377">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3176452">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3176520">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3176598">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3176673">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3176748">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3176786">i</span>&nbsp;<span class="op" id="3176788">:=</span>&nbsp;<span class="ident" id="3176791">strings</span><span class="op" id="3176798">.</span><span class="ident" id="3176799">Index</span><span class="op" id="3176804">(</span><span class="ident" id="3176805">name</span><span class="op" id="3176809">,</span>&nbsp;<span class="string" id="3176811">&#34;_&#34;</span><span class="op" id="3176814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3176817">if</span>&nbsp;<span class="ident" id="3176820">i</span>&nbsp;<span class="op" id="3176822">&lt;</span>&nbsp;<span class="num" id="3176824">0</span>&nbsp;<span class="op" id="3176826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3176830">return</span>&nbsp;<span class="builtintype" id="3176837">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3176843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3176846">name</span>&nbsp;<span class="op" id="3176851">=</span>&nbsp;<span class="ident" id="3176853">name</span><span class="op" id="3176857">[</span><span class="ident" id="3176858">i</span><span class="op" id="3176859">:</span><span class="op" id="3176860">]</span>&nbsp;<span class="comment" id="3176862">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3176900">l</span>&nbsp;<span class="op" id="3176902">:=</span>&nbsp;<span class="ident" id="3176905">strings</span><span class="op" id="3176912">.</span><span class="ident" id="3176913">Split</span><span class="op" id="3176918">(</span><span class="ident" id="3176919">name</span><span class="op" id="3176923">,</span>&nbsp;<span class="string" id="3176925">&#34;_&#34;</span><span class="op" id="3176928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3176931">if</span>&nbsp;<span class="ident" id="3176934">n</span>&nbsp;<span class="op" id="3176936">:=</span>&nbsp;<span class="builtinfunc" id="3176939">len</span><span class="op" id="3176942">(</span><span class="ident" id="3176943">l</span><span class="op" id="3176944">)</span><span class="op" id="3176945">;</span>&nbsp;<span class="ident" id="3176947">n</span>&nbsp;<span class="op" id="3176949">&gt;</span>&nbsp;<span class="num" id="3176951">0</span>&nbsp;<span class="op" id="3176953">&amp;&amp;</span>&nbsp;<span class="ident" id="3176956">l</span><span class="op" id="3176957">[</span><span class="ident" id="3176958">n</span><span class="op" id="3176959">-</span><span class="num" id="3176960">1</span><span class="op" id="3176961">]</span>&nbsp;<span class="op" id="3176963">==</span>&nbsp;<span class="string" id="3176966">&#34;test&#34;</span>&nbsp;<span class="op" id="3176973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3176977">l</span>&nbsp;<span class="op" id="3176979">=</span>&nbsp;<span class="ident" id="3176981">l</span><span class="op" id="3176982">[</span><span class="op" id="3176983">:</span><span class="ident" id="3176984">n</span><span class="op" id="3176985">-</span><span class="num" id="3176986">1</span><span class="op" id="3176987">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3176990">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3176993">n</span>&nbsp;<span class="op" id="3176995">:=</span>&nbsp;<span class="builtinfunc" id="3176998">len</span><span class="op" id="3177001">(</span><span class="ident" id="3177002">l</span><span class="op" id="3177003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177006">if</span>&nbsp;<span class="ident" id="3177009">n</span>&nbsp;<span class="op" id="3177011">&gt;=</span>&nbsp;<span class="num" id="3177014">2</span>&nbsp;<span class="op" id="3177016">&amp;&amp;</span>&nbsp;<span class="ident" id="3177019">knownOS</span><span class="op" id="3177026">[</span><span class="ident" id="3177027">l</span><span class="op" id="3177028">[</span><span class="ident" id="3177029">n</span><span class="op" id="3177030">-</span><span class="num" id="3177031">2</span><span class="op" id="3177032">]</span><span class="op" id="3177033">]</span>&nbsp;<span class="op" id="3177035">&amp;&amp;</span>&nbsp;<span class="ident" id="3177038">knownArch</span><span class="op" id="3177047">[</span><span class="ident" id="3177048">l</span><span class="op" id="3177049">[</span><span class="ident" id="3177050">n</span><span class="op" id="3177051">-</span><span class="num" id="3177052">1</span><span class="op" id="3177053">]</span><span class="op" id="3177054">]</span>&nbsp;<span class="op" id="3177056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177060">if</span>&nbsp;<span class="ident" id="3177063">allTags</span>&nbsp;<span class="op" id="3177071">!=</span>&nbsp;<span class="builtintype" id="3177074">nil</span>&nbsp;<span class="op" id="3177078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3177083">allTags</span><span class="op" id="3177090">[</span><span class="ident" id="3177091">l</span><span class="op" id="3177092">[</span><span class="ident" id="3177093">n</span><span class="op" id="3177094">-</span><span class="num" id="3177095">2</span><span class="op" id="3177096">]</span><span class="op" id="3177097">]</span>&nbsp;<span class="op" id="3177099">=</span>&nbsp;<span class="builtintype" id="3177101">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3177109">allTags</span><span class="op" id="3177116">[</span><span class="ident" id="3177117">l</span><span class="op" id="3177118">[</span><span class="ident" id="3177119">n</span><span class="op" id="3177120">-</span><span class="num" id="3177121">1</span><span class="op" id="3177122">]</span><span class="op" id="3177123">]</span>&nbsp;<span class="op" id="3177125">=</span>&nbsp;<span class="builtintype" id="3177127">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177138">if</span>&nbsp;<span class="ident" id="3177141">l</span><span class="op" id="3177142">[</span><span class="ident" id="3177143">n</span><span class="op" id="3177144">-</span><span class="num" id="3177145">1</span><span class="op" id="3177146">]</span>&nbsp;<span class="op" id="3177148">!=</span>&nbsp;<span class="ident" id="3177151">ctxt</span><span class="op" id="3177155">.</span><span class="ident" id="3177156">GOARCH</span>&nbsp;<span class="op" id="3177163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177168">return</span>&nbsp;<span class="builtintype" id="3177175">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177187">if</span>&nbsp;<span class="ident" id="3177190">ctxt</span><span class="op" id="3177194">.</span><span class="ident" id="3177195">GOOS</span>&nbsp;<span class="op" id="3177200">==</span>&nbsp;<span class="string" id="3177203">&#34;android&#34;</span>&nbsp;<span class="op" id="3177213">&amp;&amp;</span>&nbsp;<span class="ident" id="3177216">l</span><span class="op" id="3177217">[</span><span class="ident" id="3177218">n</span><span class="op" id="3177219">-</span><span class="num" id="3177220">2</span><span class="op" id="3177221">]</span>&nbsp;<span class="op" id="3177223">==</span>&nbsp;<span class="string" id="3177226">&#34;linux&#34;</span>&nbsp;<span class="op" id="3177234">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177239">return</span>&nbsp;<span class="builtintype" id="3177246">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177257">return</span>&nbsp;<span class="ident" id="3177264">l</span><span class="op" id="3177265">[</span><span class="ident" id="3177266">n</span><span class="op" id="3177267">-</span><span class="num" id="3177268">2</span><span class="op" id="3177269">]</span>&nbsp;<span class="op" id="3177271">==</span>&nbsp;<span class="ident" id="3177274">ctxt</span><span class="op" id="3177278">.</span><span class="ident" id="3177279">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177288">if</span>&nbsp;<span class="ident" id="3177291">n</span>&nbsp;<span class="op" id="3177293">&gt;=</span>&nbsp;<span class="num" id="3177296">1</span>&nbsp;<span class="op" id="3177298">&amp;&amp;</span>&nbsp;<span class="ident" id="3177301">knownOS</span><span class="op" id="3177308">[</span><span class="ident" id="3177309">l</span><span class="op" id="3177310">[</span><span class="ident" id="3177311">n</span><span class="op" id="3177312">-</span><span class="num" id="3177313">1</span><span class="op" id="3177314">]</span><span class="op" id="3177315">]</span>&nbsp;<span class="op" id="3177317">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177321">if</span>&nbsp;<span class="ident" id="3177324">allTags</span>&nbsp;<span class="op" id="3177332">!=</span>&nbsp;<span class="builtintype" id="3177335">nil</span>&nbsp;<span class="op" id="3177339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3177344">allTags</span><span class="op" id="3177351">[</span><span class="ident" id="3177352">l</span><span class="op" id="3177353">[</span><span class="ident" id="3177354">n</span><span class="op" id="3177355">-</span><span class="num" id="3177356">1</span><span class="op" id="3177357">]</span><span class="op" id="3177358">]</span>&nbsp;<span class="op" id="3177360">=</span>&nbsp;<span class="builtintype" id="3177362">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177373">if</span>&nbsp;<span class="ident" id="3177376">ctxt</span><span class="op" id="3177380">.</span><span class="ident" id="3177381">GOOS</span>&nbsp;<span class="op" id="3177386">==</span>&nbsp;<span class="string" id="3177389">&#34;android&#34;</span>&nbsp;<span class="op" id="3177399">&amp;&amp;</span>&nbsp;<span class="ident" id="3177402">l</span><span class="op" id="3177403">[</span><span class="ident" id="3177404">n</span><span class="op" id="3177405">-</span><span class="num" id="3177406">1</span><span class="op" id="3177407">]</span>&nbsp;<span class="op" id="3177409">==</span>&nbsp;<span class="string" id="3177412">&#34;linux&#34;</span>&nbsp;<span class="op" id="3177420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177425">return</span>&nbsp;<span class="builtintype" id="3177432">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177443">return</span>&nbsp;<span class="ident" id="3177450">l</span><span class="op" id="3177451">[</span><span class="ident" id="3177452">n</span><span class="op" id="3177453">-</span><span class="num" id="3177454">1</span><span class="op" id="3177455">]</span>&nbsp;<span class="op" id="3177457">==</span>&nbsp;<span class="ident" id="3177460">ctxt</span><span class="op" id="3177464">.</span><span class="ident" id="3177465">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177474">if</span>&nbsp;<span class="ident" id="3177477">n</span>&nbsp;<span class="op" id="3177479">&gt;=</span>&nbsp;<span class="num" id="3177482">1</span>&nbsp;<span class="op" id="3177484">&amp;&amp;</span>&nbsp;<span class="ident" id="3177487">knownArch</span><span class="op" id="3177496">[</span><span class="ident" id="3177497">l</span><span class="op" id="3177498">[</span><span class="ident" id="3177499">n</span><span class="op" id="3177500">-</span><span class="num" id="3177501">1</span><span class="op" id="3177502">]</span><span class="op" id="3177503">]</span>&nbsp;<span class="op" id="3177505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177509">if</span>&nbsp;<span class="ident" id="3177512">allTags</span>&nbsp;<span class="op" id="3177520">!=</span>&nbsp;<span class="builtintype" id="3177523">nil</span>&nbsp;<span class="op" id="3177527">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3177532">allTags</span><span class="op" id="3177539">[</span><span class="ident" id="3177540">l</span><span class="op" id="3177541">[</span><span class="ident" id="3177542">n</span><span class="op" id="3177543">-</span><span class="num" id="3177544">1</span><span class="op" id="3177545">]</span><span class="op" id="3177546">]</span>&nbsp;<span class="op" id="3177548">=</span>&nbsp;<span class="builtintype" id="3177550">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177561">return</span>&nbsp;<span class="ident" id="3177568">l</span><span class="op" id="3177569">[</span><span class="ident" id="3177570">n</span><span class="op" id="3177571">-</span><span class="num" id="3177572">1</span><span class="op" id="3177573">]</span>&nbsp;<span class="op" id="3177575">==</span>&nbsp;<span class="ident" id="3177578">ctxt</span><span class="op" id="3177582">.</span><span class="ident" id="3177583">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177594">return</span>&nbsp;<span class="builtintype" id="3177601">true</span><br>
<span class="lineno">1355</span><span class="op" id="3177606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3177609">var</span>&nbsp;<span class="ident" id="3177613">knownOS</span>&nbsp;<span class="op" id="3177621">=</span>&nbsp;<span class="builtinfunc" id="3177623">make</span><span class="op" id="3177627">(</span><span class="keyword" id="3177628">map</span><span class="op" id="3177631">[</span><span class="builtintype" id="3177632">string</span><span class="op" id="3177638">]</span><span class="builtintype" id="3177639">bool</span><span class="op" id="3177643">)</span><br>
<span class="lineno"></span><span class="keyword" id="3177645">var</span>&nbsp;<span class="ident" id="3177649">knownArch</span>&nbsp;<span class="op" id="3177659">=</span>&nbsp;<span class="builtinfunc" id="3177661">make</span><span class="op" id="3177665">(</span><span class="keyword" id="3177666">map</span><span class="op" id="3177669">[</span><span class="builtintype" id="3177670">string</span><span class="op" id="3177676">]</span><span class="builtintype" id="3177677">bool</span><span class="op" id="3177681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="3177684">func</span>&nbsp;<span class="ident" id="3177689">init</span><span class="op" id="3177693">(</span><span class="op" id="3177694">)</span>&nbsp;<span class="op" id="3177696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177699">for</span>&nbsp;<span class="ident" id="3177703">_</span><span class="op" id="3177704">,</span>&nbsp;<span class="ident" id="3177706">v</span>&nbsp;<span class="op" id="3177708">:=</span>&nbsp;<span class="keyword" id="3177711">range</span>&nbsp;<span class="ident" id="3177717">strings</span><span class="op" id="3177724">.</span><span class="ident" id="3177725">Fields</span><span class="op" id="3177731">(</span><span class="ident" id="3177732">goosList</span><span class="op" id="3177740">)</span>&nbsp;<span class="op" id="3177742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3177746">knownOS</span><span class="op" id="3177753">[</span><span class="ident" id="3177754">v</span><span class="op" id="3177755">]</span>&nbsp;<span class="op" id="3177757">=</span>&nbsp;<span class="builtintype" id="3177759">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3177768">for</span>&nbsp;<span class="ident" id="3177772">_</span><span class="op" id="3177773">,</span>&nbsp;<span class="ident" id="3177775">v</span>&nbsp;<span class="op" id="3177777">:=</span>&nbsp;<span class="keyword" id="3177780">range</span>&nbsp;<span class="ident" id="3177786">strings</span><span class="op" id="3177793">.</span><span class="ident" id="3177794">Fields</span><span class="op" id="3177800">(</span><span class="ident" id="3177801">goarchList</span><span class="op" id="3177811">)</span>&nbsp;<span class="op" id="3177813">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3177817">knownArch</span><span class="op" id="3177826">[</span><span class="ident" id="3177827">v</span><span class="op" id="3177828">]</span>&nbsp;<span class="op" id="3177830">=</span>&nbsp;<span class="builtintype" id="3177832">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3177838">}</span><br>
<span class="lineno"></span><span class="op" id="3177840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3177843">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="3177895">var</span>&nbsp;<span class="ident" id="3177899">ToolDir</span>&nbsp;<span class="op" id="3177907">=</span>&nbsp;<span class="ident" id="3177909">filepath</span><span class="op" id="3177917">.</span><span class="ident" id="3177918">Join</span><span class="op" id="3177922">(</span><span class="ident" id="3177923">runtime</span><span class="op" id="3177930">.</span><span class="ident" id="3177931">GOROOT</span><span class="op" id="3177937">(</span><span class="op" id="3177938">)</span><span class="op" id="3177939">,</span>&nbsp;<span class="string" id="3177941">&#34;pkg/tool/&#34;</span><span class="op" id="3177952">+</span><span class="ident" id="3177953">runtime</span><span class="op" id="3177960">.</span><span class="ident" id="3177961">GOOS</span><span class="op" id="3177965">+</span><span class="string" id="3177966">&#34;_&#34;</span><span class="op" id="3177969">+</span><span class="ident" id="3177970">runtime</span><span class="op" id="3177977">.</span><span class="ident" id="3177978">GOARCH</span><span class="op" id="3177984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3177987">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3178039">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3178101">func</span>&nbsp;<span class="ident" id="3178106">IsLocalImport</span><span class="op" id="3178119">(</span><span class="ident" id="3178120">path</span>&nbsp;<span class="builtintype" id="3178125">string</span><span class="op" id="3178131">)</span>&nbsp;<span class="builtintype" id="3178133">bool</span>&nbsp;<span class="op" id="3178138">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178141">return</span>&nbsp;<span class="ident" id="3178148">path</span>&nbsp;<span class="op" id="3178153">==</span>&nbsp;<span class="string" id="3178156">&#34;.&#34;</span>&nbsp;<span class="op" id="3178160">||</span>&nbsp;<span class="ident" id="3178163">path</span>&nbsp;<span class="op" id="3178168">==</span>&nbsp;<span class="string" id="3178171">&#34;..&#34;</span>&nbsp;<span class="op" id="3178176">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3178181">strings</span><span class="op" id="3178188">.</span><span class="ident" id="3178189">HasPrefix</span><span class="op" id="3178198">(</span><span class="ident" id="3178199">path</span><span class="op" id="3178203">,</span>&nbsp;<span class="string" id="3178205">&#34;./&#34;</span><span class="op" id="3178209">)</span>&nbsp;<span class="op" id="3178211">||</span>&nbsp;<span class="ident" id="3178214">strings</span><span class="op" id="3178221">.</span><span class="ident" id="3178222">HasPrefix</span><span class="op" id="3178231">(</span><span class="ident" id="3178232">path</span><span class="op" id="3178236">,</span>&nbsp;<span class="string" id="3178238">&#34;../&#34;</span><span class="op" id="3178243">)</span><br>
<span class="lineno"></span><span class="op" id="3178245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3178248">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="3178317">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3178364">func</span>&nbsp;<span class="ident" id="3178369">ArchChar</span><span class="op" id="3178377">(</span><span class="ident" id="3178378">goarch</span>&nbsp;<span class="builtintype" id="3178385">string</span><span class="op" id="3178391">)</span>&nbsp;<span class="op" id="3178393">(</span><span class="builtintype" id="3178394">string</span><span class="op" id="3178400">,</span>&nbsp;<span class="builtintype" id="3178402">error</span><span class="op" id="3178407">)</span>&nbsp;<span class="op" id="3178409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178412">switch</span>&nbsp;<span class="ident" id="3178419">goarch</span>&nbsp;<span class="op" id="3178426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178429">case</span>&nbsp;<span class="string" id="3178434">&#34;386&#34;</span><span class="op" id="3178439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178443">return</span>&nbsp;<span class="string" id="3178450">&#34;8&#34;</span><span class="op" id="3178453">,</span>&nbsp;<span class="builtintype" id="3178455">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178460">case</span>&nbsp;<span class="string" id="3178465">&#34;amd64&#34;</span><span class="op" id="3178472">,</span>&nbsp;<span class="string" id="3178474">&#34;amd64p32&#34;</span><span class="op" id="3178484">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178488">return</span>&nbsp;<span class="string" id="3178495">&#34;6&#34;</span><span class="op" id="3178498">,</span>&nbsp;<span class="builtintype" id="3178500">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178505">case</span>&nbsp;<span class="string" id="3178510">&#34;arm&#34;</span><span class="op" id="3178515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178519">return</span>&nbsp;<span class="string" id="3178526">&#34;5&#34;</span><span class="op" id="3178529">,</span>&nbsp;<span class="builtintype" id="3178531">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3178536">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178539">return</span>&nbsp;<span class="string" id="3178546">&#34;&#34;</span><span class="op" id="3178548">,</span>&nbsp;<span class="ident" id="3178550">errors</span><span class="op" id="3178556">.</span><span class="ident" id="3178557">New</span><span class="op" id="3178560">(</span><span class="string" id="3178561">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="3178583">+</span>&nbsp;<span class="ident" id="3178585">goarch</span><span class="op" id="3178591">)</span><br>
<span class="lineno"></span><span class="op" id="3178593">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
