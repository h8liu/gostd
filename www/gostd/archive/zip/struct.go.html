<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html" class="current">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5423056">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5423111">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5423165">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5423216">/*<br>
<span class="lineno"></span>Package&nbsp;zip&nbsp;provides&nbsp;support&nbsp;for&nbsp;reading&nbsp;and&nbsp;writing&nbsp;ZIP&nbsp;archives.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>See:&nbsp;http://www.pkware.com/documents/casestudies/APPNOTE.TXT<br>
<span class="lineno"></span><br>
<span class="lineno">10</span>This&nbsp;package&nbsp;does&nbsp;not&nbsp;support&nbsp;disk&nbsp;spanning.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>A&nbsp;note&nbsp;about&nbsp;ZIP64:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>To&nbsp;be&nbsp;backwards&nbsp;compatible&nbsp;the&nbsp;FileHeader&nbsp;has&nbsp;both&nbsp;32&nbsp;and&nbsp;64&nbsp;bit&nbsp;Size<br>
<span class="lineno">15</span>fields.&nbsp;The&nbsp;64&nbsp;bit&nbsp;fields&nbsp;will&nbsp;always&nbsp;contain&nbsp;the&nbsp;correct&nbsp;value&nbsp;and<br>
<span class="lineno"></span>for&nbsp;normal&nbsp;archives&nbsp;both&nbsp;fields&nbsp;will&nbsp;be&nbsp;the&nbsp;same.&nbsp;For&nbsp;files&nbsp;requiring<br>
<span class="lineno"></span>the&nbsp;ZIP64&nbsp;format&nbsp;the&nbsp;32&nbsp;bit&nbsp;fields&nbsp;will&nbsp;be&nbsp;0xffffffff&nbsp;and&nbsp;the&nbsp;64&nbsp;bit<br>
<span class="lineno"></span>fields&nbsp;must&nbsp;be&nbsp;used&nbsp;instead.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">20</span><span class="keyword" id="5423725">package</span>&nbsp;<span class="ident" id="5423733">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5423738">import</span>&nbsp;<span class="op" id="5423745">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5423748">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5423754">&#34;path&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5423762">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5423769">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5423772">//&nbsp;Compression&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="5423796">const</span>&nbsp;<span class="op" id="5423802">(</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423805">Store</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5423813">uint16</span>&nbsp;<span class="op" id="5423820">=</span>&nbsp;<span class="num" id="5423822">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423825">Deflate</span>&nbsp;<span class="builtintype" id="5423833">uint16</span>&nbsp;<span class="op" id="5423840">=</span>&nbsp;<span class="num" id="5423842">8</span><br>
<span class="lineno"></span><span class="op" id="5423844">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5423847">const</span>&nbsp;<span class="op" id="5423853">(</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423856">fileHeaderSignature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5423881">=</span>&nbsp;<span class="num" id="5423883">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423895">directoryHeaderSignature</span>&nbsp;<span class="op" id="5423920">=</span>&nbsp;<span class="num" id="5423922">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423934">directoryEndSignature</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5423959">=</span>&nbsp;<span class="num" id="5423961">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423973">directory64LocSignature</span>&nbsp;&nbsp;<span class="op" id="5423998">=</span>&nbsp;<span class="num" id="5424000">0x07064b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424012">directory64EndSignature</span>&nbsp;&nbsp;<span class="op" id="5424037">=</span>&nbsp;<span class="num" id="5424039">0x06064b50</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424051">dataDescriptorSignature</span>&nbsp;&nbsp;<span class="op" id="5424076">=</span>&nbsp;<span class="num" id="5424078">0x08074b50</span>&nbsp;<span class="comment" id="5424089">//&nbsp;de-facto&nbsp;standard;&nbsp;required&nbsp;by&nbsp;OS&nbsp;X&nbsp;Finder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424136">fileHeaderLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5424161">=</span>&nbsp;<span class="num" id="5424163">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424174">//&nbsp;+&nbsp;filename&nbsp;+&nbsp;extra</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424197">directoryHeaderLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5424222">=</span>&nbsp;<span class="num" id="5424224">46</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424235">//&nbsp;+&nbsp;filename&nbsp;+&nbsp;extra&nbsp;+&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424268">directoryEndLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5424293">=</span>&nbsp;<span class="num" id="5424295">22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424306">//&nbsp;+&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424320">dataDescriptorLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5424345">=</span>&nbsp;<span class="num" id="5424347">16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424358">//&nbsp;four&nbsp;uint32:&nbsp;descriptor&nbsp;signature,&nbsp;crc32,&nbsp;compressed&nbsp;size,&nbsp;size</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424426">dataDescriptor64Len</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5424451">=</span>&nbsp;<span class="num" id="5424453">24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424464">//&nbsp;descriptor&nbsp;with&nbsp;8&nbsp;byte&nbsp;sizes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424497">directory64LocLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5424522">=</span>&nbsp;<span class="num" id="5424524">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424535">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424539">directory64EndLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5424564">=</span>&nbsp;<span class="num" id="5424566">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424577">//&nbsp;+&nbsp;extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424590">//&nbsp;Constants&nbsp;for&nbsp;the&nbsp;first&nbsp;byte&nbsp;in&nbsp;CreatorVersion</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424641">creatorFAT</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5424655">=</span>&nbsp;<span class="num" id="5424657">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424660">creatorUnix</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5424674">=</span>&nbsp;<span class="num" id="5424676">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424679">creatorNTFS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5424693">=</span>&nbsp;<span class="num" id="5424695">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424699">creatorVFAT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5424713">=</span>&nbsp;<span class="num" id="5424715">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424719">creatorMacOSX</span>&nbsp;<span class="op" id="5424733">=</span>&nbsp;<span class="num" id="5424735">19</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424740">//&nbsp;version&nbsp;numbers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424760">zipVersion20</span>&nbsp;<span class="op" id="5424773">=</span>&nbsp;<span class="num" id="5424775">20</span>&nbsp;<span class="comment" id="5424778">//&nbsp;2.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424786">zipVersion45</span>&nbsp;<span class="op" id="5424799">=</span>&nbsp;<span class="num" id="5424801">45</span>&nbsp;<span class="comment" id="5424804">//&nbsp;4.5&nbsp;(reads&nbsp;and&nbsp;writes&nbsp;zip64&nbsp;archives)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424847">//&nbsp;limits&nbsp;for&nbsp;non&nbsp;zip64&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424878">uint16max</span>&nbsp;<span class="op" id="5424888">=</span>&nbsp;<span class="op" id="5424890">(</span><span class="num" id="5424891">1</span>&nbsp;<span class="op" id="5424893">&lt;&lt;</span>&nbsp;<span class="num" id="5424896">16</span><span class="op" id="5424898">)</span>&nbsp;<span class="op" id="5424900">-</span>&nbsp;<span class="num" id="5424902">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424905">uint32max</span>&nbsp;<span class="op" id="5424915">=</span>&nbsp;<span class="op" id="5424917">(</span><span class="num" id="5424918">1</span>&nbsp;<span class="op" id="5424920">&lt;&lt;</span>&nbsp;<span class="num" id="5424923">32</span><span class="op" id="5424925">)</span>&nbsp;<span class="op" id="5424927">-</span>&nbsp;<span class="num" id="5424929">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5424933">//&nbsp;extra&nbsp;header&nbsp;id&#39;s</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424955">zip64ExtraId</span>&nbsp;<span class="op" id="5424968">=</span>&nbsp;<span class="num" id="5424970">0x0001</span>&nbsp;<span class="comment" id="5424977">//&nbsp;zip64&nbsp;Extended&nbsp;Information&nbsp;Extra&nbsp;Field</span><br>
<span class="lineno"></span><span class="op" id="5425019">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5425022">//&nbsp;FileHeader&nbsp;describes&nbsp;a&nbsp;file&nbsp;within&nbsp;a&nbsp;zip&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5425072">//&nbsp;See&nbsp;the&nbsp;zip&nbsp;spec&nbsp;for&nbsp;details.</span><br>
<span class="lineno">70</span><span class="keyword" id="5425105">type</span>&nbsp;<span class="ident" id="5425110">FileHeader</span>&nbsp;<span class="keyword" id="5425121">struct</span>&nbsp;<span class="op" id="5425128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5425131">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5425165">//&nbsp;It&nbsp;must&nbsp;be&nbsp;a&nbsp;relative&nbsp;path:&nbsp;it&nbsp;must&nbsp;not&nbsp;start&nbsp;with&nbsp;a&nbsp;drive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5425228">//&nbsp;letter&nbsp;(e.g.&nbsp;C:)&nbsp;or&nbsp;leading&nbsp;slash,&nbsp;and&nbsp;only&nbsp;forward&nbsp;slashes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5425292">//&nbsp;are&nbsp;allowed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425309">Name</span>&nbsp;<span class="builtintype" id="5425314">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425323">CreatorVersion</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425342">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425350">ReaderVersion</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425369">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425377">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425396">uint16</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425404">Method</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425423">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425431">ModifiedTime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425450">uint16</span>&nbsp;<span class="comment" id="5425457">//&nbsp;MS-DOS&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425473">ModifiedDate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425492">uint16</span>&nbsp;<span class="comment" id="5425499">//&nbsp;MS-DOS&nbsp;date</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425515">CRC32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425534">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425542">CompressedSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425561">uint32</span>&nbsp;<span class="comment" id="5425568">//&nbsp;deprecated;&nbsp;use&nbsp;CompressedSize64</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425605">UncompressedSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425624">uint32</span>&nbsp;<span class="comment" id="5425631">//&nbsp;deprecated;&nbsp;use&nbsp;UncompressedSize64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425670">CompressedSize64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425689">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425697">UncompressedSize64</span>&nbsp;<span class="builtintype" id="5425716">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425724">Extra</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5425743">[</span><span class="op" id="5425744">]</span><span class="builtintype" id="5425745">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425751">ExternalAttrs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425770">uint32</span>&nbsp;<span class="comment" id="5425777">//&nbsp;Meaning&nbsp;depends&nbsp;on&nbsp;CreatorVersion</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425815">Comment</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5425834">string</span><br>
<span class="lineno"></span><span class="op" id="5425841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5425844">//&nbsp;FileInfo&nbsp;returns&nbsp;an&nbsp;os.FileInfo&nbsp;for&nbsp;the&nbsp;FileHeader.</span><br>
<span class="lineno"></span><span class="keyword" id="5425899">func</span>&nbsp;<span class="op" id="5425904">(</span><span class="ident" id="5425905">h</span>&nbsp;<span class="op" id="5425907">*</span><span class="ident" id="5425908">FileHeader</span><span class="op" id="5425918">)</span>&nbsp;<span class="ident" id="5425920">FileInfo</span><span class="op" id="5425928">(</span><span class="op" id="5425929">)</span>&nbsp;<span class="ident" id="5425931">os</span><span class="op" id="5425933">.</span><span class="ident" id="5425934">FileInfo</span>&nbsp;<span class="op" id="5425943">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5425946">return</span>&nbsp;<span class="ident" id="5425953">headerFileInfo</span><span class="op" id="5425967">{</span><span class="ident" id="5425968">h</span><span class="op" id="5425969">}</span><br>
<span class="lineno"></span><span class="op" id="5425971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5425974">//&nbsp;headerFileInfo&nbsp;implements&nbsp;os.FileInfo.</span><br>
<span class="lineno"></span><span class="keyword" id="5426016">type</span>&nbsp;<span class="ident" id="5426021">headerFileInfo</span>&nbsp;<span class="keyword" id="5426036">struct</span>&nbsp;<span class="op" id="5426043">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426046">fh</span>&nbsp;<span class="op" id="5426049">*</span><span class="ident" id="5426050">FileHeader</span><br>
<span class="lineno"></span><span class="op" id="5426061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5426064">func</span>&nbsp;<span class="op" id="5426069">(</span><span class="ident" id="5426070">fi</span>&nbsp;<span class="ident" id="5426073">headerFileInfo</span><span class="op" id="5426087">)</span>&nbsp;<span class="ident" id="5426089">Name</span><span class="op" id="5426093">(</span><span class="op" id="5426094">)</span>&nbsp;<span class="builtintype" id="5426096">string</span>&nbsp;<span class="op" id="5426103">{</span>&nbsp;<span class="keyword" id="5426105">return</span>&nbsp;<span class="ident" id="5426112">path</span><span class="op" id="5426116">.</span><span class="ident" id="5426117">Base</span><span class="op" id="5426121">(</span><span class="ident" id="5426122">fi</span><span class="op" id="5426124">.</span><span class="ident" id="5426125">fh</span><span class="op" id="5426127">.</span><span class="ident" id="5426128">Name</span><span class="op" id="5426132">)</span>&nbsp;<span class="op" id="5426134">}</span><br>
<span class="lineno"></span><span class="keyword" id="5426136">func</span>&nbsp;<span class="op" id="5426141">(</span><span class="ident" id="5426142">fi</span>&nbsp;<span class="ident" id="5426145">headerFileInfo</span><span class="op" id="5426159">)</span>&nbsp;<span class="ident" id="5426161">Size</span><span class="op" id="5426165">(</span><span class="op" id="5426166">)</span>&nbsp;<span class="builtintype" id="5426168">int64</span>&nbsp;<span class="op" id="5426174">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5426177">if</span>&nbsp;<span class="ident" id="5426180">fi</span><span class="op" id="5426182">.</span><span class="ident" id="5426183">fh</span><span class="op" id="5426185">.</span><span class="ident" id="5426186">UncompressedSize64</span>&nbsp;<span class="op" id="5426205">&gt;</span>&nbsp;<span class="num" id="5426207">0</span>&nbsp;<span class="op" id="5426209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5426213">return</span>&nbsp;<span class="builtintype" id="5426220">int64</span><span class="op" id="5426225">(</span><span class="ident" id="5426226">fi</span><span class="op" id="5426228">.</span><span class="ident" id="5426229">fh</span><span class="op" id="5426231">.</span><span class="ident" id="5426232">UncompressedSize64</span><span class="op" id="5426250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5426253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5426256">return</span>&nbsp;<span class="builtintype" id="5426263">int64</span><span class="op" id="5426268">(</span><span class="ident" id="5426269">fi</span><span class="op" id="5426271">.</span><span class="ident" id="5426272">fh</span><span class="op" id="5426274">.</span><span class="ident" id="5426275">UncompressedSize</span><span class="op" id="5426291">)</span><br>
<span class="lineno"></span><span class="op" id="5426293">}</span><br>
<span class="lineno">110</span><span class="keyword" id="5426295">func</span>&nbsp;<span class="op" id="5426300">(</span><span class="ident" id="5426301">fi</span>&nbsp;<span class="ident" id="5426304">headerFileInfo</span><span class="op" id="5426318">)</span>&nbsp;<span class="ident" id="5426320">IsDir</span><span class="op" id="5426325">(</span><span class="op" id="5426326">)</span>&nbsp;<span class="builtintype" id="5426328">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5426340">{</span>&nbsp;<span class="keyword" id="5426342">return</span>&nbsp;<span class="ident" id="5426349">fi</span><span class="op" id="5426351">.</span><span class="ident" id="5426352">Mode</span><span class="op" id="5426356">(</span><span class="op" id="5426357">)</span><span class="op" id="5426358">.</span><span class="ident" id="5426359">IsDir</span><span class="op" id="5426364">(</span><span class="op" id="5426365">)</span>&nbsp;<span class="op" id="5426367">}</span><br>
<span class="lineno"></span><span class="keyword" id="5426369">func</span>&nbsp;<span class="op" id="5426374">(</span><span class="ident" id="5426375">fi</span>&nbsp;<span class="ident" id="5426378">headerFileInfo</span><span class="op" id="5426392">)</span>&nbsp;<span class="ident" id="5426394">ModTime</span><span class="op" id="5426401">(</span><span class="op" id="5426402">)</span>&nbsp;<span class="ident" id="5426404">time</span><span class="op" id="5426408">.</span><span class="ident" id="5426409">Time</span>&nbsp;<span class="op" id="5426414">{</span>&nbsp;<span class="keyword" id="5426416">return</span>&nbsp;<span class="ident" id="5426423">fi</span><span class="op" id="5426425">.</span><span class="ident" id="5426426">fh</span><span class="op" id="5426428">.</span><span class="ident" id="5426429">ModTime</span><span class="op" id="5426436">(</span><span class="op" id="5426437">)</span>&nbsp;<span class="op" id="5426439">}</span><br>
<span class="lineno"></span><span class="keyword" id="5426441">func</span>&nbsp;<span class="op" id="5426446">(</span><span class="ident" id="5426447">fi</span>&nbsp;<span class="ident" id="5426450">headerFileInfo</span><span class="op" id="5426464">)</span>&nbsp;<span class="ident" id="5426466">Mode</span><span class="op" id="5426470">(</span><span class="op" id="5426471">)</span>&nbsp;<span class="ident" id="5426473">os</span><span class="op" id="5426475">.</span><span class="ident" id="5426476">FileMode</span>&nbsp;&nbsp;<span class="op" id="5426486">{</span>&nbsp;<span class="keyword" id="5426488">return</span>&nbsp;<span class="ident" id="5426495">fi</span><span class="op" id="5426497">.</span><span class="ident" id="5426498">fh</span><span class="op" id="5426500">.</span><span class="ident" id="5426501">Mode</span><span class="op" id="5426505">(</span><span class="op" id="5426506">)</span>&nbsp;<span class="op" id="5426508">}</span><br>
<span class="lineno"></span><span class="keyword" id="5426510">func</span>&nbsp;<span class="op" id="5426515">(</span><span class="ident" id="5426516">fi</span>&nbsp;<span class="ident" id="5426519">headerFileInfo</span><span class="op" id="5426533">)</span>&nbsp;<span class="ident" id="5426535">Sys</span><span class="op" id="5426538">(</span><span class="op" id="5426539">)</span>&nbsp;<span class="keyword" id="5426541">interface</span><span class="op" id="5426550">{</span><span class="op" id="5426551">}</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5426555">{</span>&nbsp;<span class="keyword" id="5426557">return</span>&nbsp;<span class="ident" id="5426564">fi</span><span class="op" id="5426566">.</span><span class="ident" id="5426567">fh</span>&nbsp;<span class="op" id="5426570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="5426573">//&nbsp;FileInfoHeader&nbsp;creates&nbsp;a&nbsp;partially-populated&nbsp;FileHeader&nbsp;from&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5426640">//&nbsp;os.FileInfo.</span><br>
<span class="lineno"></span><span class="comment" id="5426656">//&nbsp;Because&nbsp;os.FileInfo&#39;s&nbsp;Name&nbsp;method&nbsp;returns&nbsp;only&nbsp;the&nbsp;base&nbsp;name&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5426723">//&nbsp;the&nbsp;file&nbsp;it&nbsp;describes,&nbsp;it&nbsp;may&nbsp;be&nbsp;necessary&nbsp;to&nbsp;modify&nbsp;the&nbsp;Name&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="5426794">//&nbsp;of&nbsp;the&nbsp;returned&nbsp;header&nbsp;to&nbsp;provide&nbsp;the&nbsp;full&nbsp;path&nbsp;name&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno">120</span><span class="keyword" id="5426863">func</span>&nbsp;<span class="ident" id="5426868">FileInfoHeader</span><span class="op" id="5426882">(</span><span class="ident" id="5426883">fi</span>&nbsp;<span class="ident" id="5426886">os</span><span class="op" id="5426888">.</span><span class="ident" id="5426889">FileInfo</span><span class="op" id="5426897">)</span>&nbsp;<span class="op" id="5426899">(</span><span class="op" id="5426900">*</span><span class="ident" id="5426901">FileHeader</span><span class="op" id="5426911">,</span>&nbsp;<span class="builtintype" id="5426913">error</span><span class="op" id="5426918">)</span>&nbsp;<span class="op" id="5426920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426923">size</span>&nbsp;<span class="op" id="5426928">:=</span>&nbsp;<span class="ident" id="5426931">fi</span><span class="op" id="5426933">.</span><span class="ident" id="5426934">Size</span><span class="op" id="5426938">(</span><span class="op" id="5426939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426942">fh</span>&nbsp;<span class="op" id="5426945">:=</span>&nbsp;<span class="op" id="5426948">&amp;</span><span class="ident" id="5426949">FileHeader</span><span class="op" id="5426959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426963">Name</span><span class="op" id="5426967">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426983">fi</span><span class="op" id="5426985">.</span><span class="ident" id="5426986">Name</span><span class="op" id="5426990">(</span><span class="op" id="5426991">)</span><span class="op" id="5426992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426996">UncompressedSize64</span><span class="op" id="5427014">:</span>&nbsp;<span class="builtintype" id="5427016">uint64</span><span class="op" id="5427022">(</span><span class="ident" id="5427023">size</span><span class="op" id="5427027">)</span><span class="op" id="5427028">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5427031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427034">fh</span><span class="op" id="5427036">.</span><span class="ident" id="5427037">SetModTime</span><span class="op" id="5427047">(</span><span class="ident" id="5427048">fi</span><span class="op" id="5427050">.</span><span class="ident" id="5427051">ModTime</span><span class="op" id="5427058">(</span><span class="op" id="5427059">)</span><span class="op" id="5427060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427063">fh</span><span class="op" id="5427065">.</span><span class="ident" id="5427066">SetMode</span><span class="op" id="5427073">(</span><span class="ident" id="5427074">fi</span><span class="op" id="5427076">.</span><span class="ident" id="5427077">Mode</span><span class="op" id="5427081">(</span><span class="op" id="5427082">)</span><span class="op" id="5427083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5427086">if</span>&nbsp;<span class="ident" id="5427089">fh</span><span class="op" id="5427091">.</span><span class="ident" id="5427092">UncompressedSize64</span>&nbsp;<span class="op" id="5427111">&gt;</span>&nbsp;<span class="ident" id="5427113">uint32max</span>&nbsp;<span class="op" id="5427123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427127">fh</span><span class="op" id="5427129">.</span><span class="ident" id="5427130">UncompressedSize</span>&nbsp;<span class="op" id="5427147">=</span>&nbsp;<span class="ident" id="5427149">uint32max</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5427160">}</span>&nbsp;<span class="keyword" id="5427162">else</span>&nbsp;<span class="op" id="5427167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427171">fh</span><span class="op" id="5427173">.</span><span class="ident" id="5427174">UncompressedSize</span>&nbsp;<span class="op" id="5427191">=</span>&nbsp;<span class="builtintype" id="5427193">uint32</span><span class="op" id="5427199">(</span><span class="ident" id="5427200">fh</span><span class="op" id="5427202">.</span><span class="ident" id="5427203">UncompressedSize64</span><span class="op" id="5427221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5427224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5427227">return</span>&nbsp;<span class="ident" id="5427234">fh</span><span class="op" id="5427236">,</span>&nbsp;<span class="builtintype" id="5427238">nil</span><br>
<span class="lineno"></span><span class="op" id="5427242">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="5427245">type</span>&nbsp;<span class="ident" id="5427250">directoryEnd</span>&nbsp;<span class="keyword" id="5427263">struct</span>&nbsp;<span class="op" id="5427270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427273">diskNbr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427292">uint32</span>&nbsp;<span class="comment" id="5427299">//&nbsp;unused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427310">dirDiskNbr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427329">uint32</span>&nbsp;<span class="comment" id="5427336">//&nbsp;unused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427347">dirRecordsThisDisk</span>&nbsp;<span class="builtintype" id="5427366">uint64</span>&nbsp;<span class="comment" id="5427373">//&nbsp;unused</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427384">directoryRecords</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427403">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427411">directorySize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427430">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427438">directoryOffset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427457">uint64</span>&nbsp;<span class="comment" id="5427464">//&nbsp;relative&nbsp;to&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427485">commentLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427504">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427512">comment</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427531">string</span><br>
<span class="lineno">145</span><span class="op" id="5427538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5427541">//&nbsp;msDosTimeToTime&nbsp;converts&nbsp;an&nbsp;MS-DOS&nbsp;date&nbsp;and&nbsp;time&nbsp;into&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="5427611">//&nbsp;The&nbsp;resolution&nbsp;is&nbsp;2s.</span><br>
<span class="lineno"></span><span class="comment" id="5427636">//&nbsp;See:&nbsp;http://msdn.microsoft.com/en-us/library/ms724247(v=VS.85).aspx</span><br>
<span class="lineno">150</span><span class="keyword" id="5427707">func</span>&nbsp;<span class="ident" id="5427712">msDosTimeToTime</span><span class="op" id="5427727">(</span><span class="ident" id="5427728">dosDate</span><span class="op" id="5427735">,</span>&nbsp;<span class="ident" id="5427737">dosTime</span>&nbsp;<span class="builtintype" id="5427745">uint16</span><span class="op" id="5427751">)</span>&nbsp;<span class="ident" id="5427753">time</span><span class="op" id="5427757">.</span><span class="ident" id="5427758">Time</span>&nbsp;<span class="op" id="5427763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5427766">return</span>&nbsp;<span class="ident" id="5427773">time</span><span class="op" id="5427777">.</span><span class="ident" id="5427778">Date</span><span class="op" id="5427782">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5427786">//&nbsp;date&nbsp;bits&nbsp;0-4:&nbsp;day&nbsp;of&nbsp;month;&nbsp;5-8:&nbsp;month;&nbsp;9-15:&nbsp;years&nbsp;since&nbsp;1980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427855">int</span><span class="op" id="5427858">(</span><span class="ident" id="5427859">dosDate</span><span class="op" id="5427866">&gt;&gt;</span><span class="num" id="5427868">9</span><span class="op" id="5427869">+</span><span class="num" id="5427870">1980</span><span class="op" id="5427874">)</span><span class="op" id="5427875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5427879">time</span><span class="op" id="5427883">.</span><span class="ident" id="5427884">Month</span><span class="op" id="5427889">(</span><span class="ident" id="5427890">dosDate</span><span class="op" id="5427897">&gt;&gt;</span><span class="num" id="5427899">5</span><span class="op" id="5427900">&amp;</span><span class="num" id="5427901">0xf</span><span class="op" id="5427904">)</span><span class="op" id="5427905">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427909">int</span><span class="op" id="5427912">(</span><span class="ident" id="5427913">dosDate</span><span class="op" id="5427920">&amp;</span><span class="num" id="5427921">0x1f</span><span class="op" id="5427925">)</span><span class="op" id="5427926">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5427931">//&nbsp;time&nbsp;bits&nbsp;0-4:&nbsp;second/2;&nbsp;5-10:&nbsp;minute;&nbsp;11-15:&nbsp;hour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5427987">int</span><span class="op" id="5427990">(</span><span class="ident" id="5427991">dosTime</span><span class="op" id="5427998">&gt;&gt;</span><span class="num" id="5428000">11</span><span class="op" id="5428002">)</span><span class="op" id="5428003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5428007">int</span><span class="op" id="5428010">(</span><span class="ident" id="5428011">dosTime</span><span class="op" id="5428018">&gt;&gt;</span><span class="num" id="5428020">5</span><span class="op" id="5428021">&amp;</span><span class="num" id="5428022">0x3f</span><span class="op" id="5428026">)</span><span class="op" id="5428027">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5428031">int</span><span class="op" id="5428034">(</span><span class="ident" id="5428035">dosTime</span><span class="op" id="5428042">&amp;</span><span class="num" id="5428043">0x1f</span><span class="op" id="5428047">*</span><span class="num" id="5428048">2</span><span class="op" id="5428049">)</span><span class="op" id="5428050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5428054">0</span><span class="op" id="5428055">,</span>&nbsp;<span class="comment" id="5428057">//&nbsp;nanoseconds</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5428075">time</span><span class="op" id="5428079">.</span><span class="ident" id="5428080">UTC</span><span class="op" id="5428083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5428086">)</span><br>
<span class="lineno">165</span><span class="op" id="5428088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5428091">//&nbsp;timeToMsDosTime&nbsp;converts&nbsp;a&nbsp;time.Time&nbsp;to&nbsp;an&nbsp;MS-DOS&nbsp;date&nbsp;and&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5428159">//&nbsp;The&nbsp;resolution&nbsp;is&nbsp;2s.</span><br>
<span class="lineno"></span><span class="comment" id="5428184">//&nbsp;See:&nbsp;http://msdn.microsoft.com/en-us/library/ms724274(v=VS.85).aspx</span><br>
<span class="lineno">170</span><span class="keyword" id="5428255">func</span>&nbsp;<span class="ident" id="5428260">timeToMsDosTime</span><span class="op" id="5428275">(</span><span class="ident" id="5428276">t</span>&nbsp;<span class="ident" id="5428278">time</span><span class="op" id="5428282">.</span><span class="ident" id="5428283">Time</span><span class="op" id="5428287">)</span>&nbsp;<span class="op" id="5428289">(</span><span class="ident" id="5428290">fDate</span>&nbsp;<span class="builtintype" id="5428296">uint16</span><span class="op" id="5428302">,</span>&nbsp;<span class="ident" id="5428304">fTime</span>&nbsp;<span class="builtintype" id="5428310">uint16</span><span class="op" id="5428316">)</span>&nbsp;<span class="op" id="5428318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5428321">t</span>&nbsp;<span class="op" id="5428323">=</span>&nbsp;<span class="ident" id="5428325">t</span><span class="op" id="5428326">.</span><span class="ident" id="5428327">In</span><span class="op" id="5428329">(</span><span class="ident" id="5428330">time</span><span class="op" id="5428334">.</span><span class="ident" id="5428335">UTC</span><span class="op" id="5428338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5428341">fDate</span>&nbsp;<span class="op" id="5428347">=</span>&nbsp;<span class="builtintype" id="5428349">uint16</span><span class="op" id="5428355">(</span><span class="ident" id="5428356">t</span><span class="op" id="5428357">.</span><span class="ident" id="5428358">Day</span><span class="op" id="5428361">(</span><span class="op" id="5428362">)</span>&nbsp;<span class="op" id="5428364">+</span>&nbsp;<span class="builtintype" id="5428366">int</span><span class="op" id="5428369">(</span><span class="ident" id="5428370">t</span><span class="op" id="5428371">.</span><span class="ident" id="5428372">Month</span><span class="op" id="5428377">(</span><span class="op" id="5428378">)</span><span class="op" id="5428379">)</span><span class="op" id="5428380">&lt;&lt;</span><span class="num" id="5428382">5</span>&nbsp;<span class="op" id="5428384">+</span>&nbsp;<span class="op" id="5428386">(</span><span class="ident" id="5428387">t</span><span class="op" id="5428388">.</span><span class="ident" id="5428389">Year</span><span class="op" id="5428393">(</span><span class="op" id="5428394">)</span><span class="op" id="5428395">-</span><span class="num" id="5428396">1980</span><span class="op" id="5428400">)</span><span class="op" id="5428401">&lt;&lt;</span><span class="num" id="5428403">9</span><span class="op" id="5428404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5428407">fTime</span>&nbsp;<span class="op" id="5428413">=</span>&nbsp;<span class="builtintype" id="5428415">uint16</span><span class="op" id="5428421">(</span><span class="ident" id="5428422">t</span><span class="op" id="5428423">.</span><span class="ident" id="5428424">Second</span><span class="op" id="5428430">(</span><span class="op" id="5428431">)</span><span class="op" id="5428432">/</span><span class="num" id="5428433">2</span>&nbsp;<span class="op" id="5428435">+</span>&nbsp;<span class="ident" id="5428437">t</span><span class="op" id="5428438">.</span><span class="ident" id="5428439">Minute</span><span class="op" id="5428445">(</span><span class="op" id="5428446">)</span><span class="op" id="5428447">&lt;&lt;</span><span class="num" id="5428449">5</span>&nbsp;<span class="op" id="5428451">+</span>&nbsp;<span class="ident" id="5428453">t</span><span class="op" id="5428454">.</span><span class="ident" id="5428455">Hour</span><span class="op" id="5428459">(</span><span class="op" id="5428460">)</span><span class="op" id="5428461">&lt;&lt;</span><span class="num" id="5428463">11</span><span class="op" id="5428465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5428468">return</span><br>
<span class="lineno">175</span><span class="op" id="5428475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5428478">//&nbsp;ModTime&nbsp;returns&nbsp;the&nbsp;modification&nbsp;time&nbsp;in&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="5428527">//&nbsp;The&nbsp;resolution&nbsp;is&nbsp;2s.</span><br>
<span class="lineno"></span><span class="keyword" id="5428552">func</span>&nbsp;<span class="op" id="5428557">(</span><span class="ident" id="5428558">h</span>&nbsp;<span class="op" id="5428560">*</span><span class="ident" id="5428561">FileHeader</span><span class="op" id="5428571">)</span>&nbsp;<span class="ident" id="5428573">ModTime</span><span class="op" id="5428580">(</span><span class="op" id="5428581">)</span>&nbsp;<span class="ident" id="5428583">time</span><span class="op" id="5428587">.</span><span class="ident" id="5428588">Time</span>&nbsp;<span class="op" id="5428593">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5428596">return</span>&nbsp;<span class="ident" id="5428603">msDosTimeToTime</span><span class="op" id="5428618">(</span><span class="ident" id="5428619">h</span><span class="op" id="5428620">.</span><span class="ident" id="5428621">ModifiedDate</span><span class="op" id="5428633">,</span>&nbsp;<span class="ident" id="5428635">h</span><span class="op" id="5428636">.</span><span class="ident" id="5428637">ModifiedTime</span><span class="op" id="5428649">)</span><br>
<span class="lineno"></span><span class="op" id="5428651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5428654">//&nbsp;SetModTime&nbsp;sets&nbsp;the&nbsp;ModifiedTime&nbsp;and&nbsp;ModifiedDate&nbsp;fields&nbsp;to&nbsp;the&nbsp;given&nbsp;time&nbsp;in&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="5428740">//&nbsp;The&nbsp;resolution&nbsp;is&nbsp;2s.</span><br>
<span class="lineno">185</span><span class="keyword" id="5428765">func</span>&nbsp;<span class="op" id="5428770">(</span><span class="ident" id="5428771">h</span>&nbsp;<span class="op" id="5428773">*</span><span class="ident" id="5428774">FileHeader</span><span class="op" id="5428784">)</span>&nbsp;<span class="ident" id="5428786">SetModTime</span><span class="op" id="5428796">(</span><span class="ident" id="5428797">t</span>&nbsp;<span class="ident" id="5428799">time</span><span class="op" id="5428803">.</span><span class="ident" id="5428804">Time</span><span class="op" id="5428808">)</span>&nbsp;<span class="op" id="5428810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5428813">h</span><span class="op" id="5428814">.</span><span class="ident" id="5428815">ModifiedDate</span><span class="op" id="5428827">,</span>&nbsp;<span class="ident" id="5428829">h</span><span class="op" id="5428830">.</span><span class="ident" id="5428831">ModifiedTime</span>&nbsp;<span class="op" id="5428844">=</span>&nbsp;<span class="ident" id="5428846">timeToMsDosTime</span><span class="op" id="5428861">(</span><span class="ident" id="5428862">t</span><span class="op" id="5428863">)</span><br>
<span class="lineno"></span><span class="op" id="5428865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5428868">const</span>&nbsp;<span class="op" id="5428874">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5428877">//&nbsp;Unix&nbsp;constants.&nbsp;The&nbsp;specification&nbsp;doesn&#39;t&nbsp;mention&nbsp;them,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5428937">//&nbsp;but&nbsp;these&nbsp;seem&nbsp;to&nbsp;be&nbsp;the&nbsp;values&nbsp;agreed&nbsp;on&nbsp;by&nbsp;tools.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5428993">s_IFMT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5429002">=</span>&nbsp;<span class="num" id="5429004">0xf000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429012">s_IFSOCK</span>&nbsp;<span class="op" id="5429021">=</span>&nbsp;<span class="num" id="5429023">0xc000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429031">s_IFLNK</span>&nbsp;&nbsp;<span class="op" id="5429040">=</span>&nbsp;<span class="num" id="5429042">0xa000</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429050">s_IFREG</span>&nbsp;&nbsp;<span class="op" id="5429059">=</span>&nbsp;<span class="num" id="5429061">0x8000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429069">s_IFBLK</span>&nbsp;&nbsp;<span class="op" id="5429078">=</span>&nbsp;<span class="num" id="5429080">0x6000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429088">s_IFDIR</span>&nbsp;&nbsp;<span class="op" id="5429097">=</span>&nbsp;<span class="num" id="5429099">0x4000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429107">s_IFCHR</span>&nbsp;&nbsp;<span class="op" id="5429116">=</span>&nbsp;<span class="num" id="5429118">0x2000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429126">s_IFIFO</span>&nbsp;&nbsp;<span class="op" id="5429135">=</span>&nbsp;<span class="num" id="5429137">0x1000</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429145">s_ISUID</span>&nbsp;&nbsp;<span class="op" id="5429154">=</span>&nbsp;<span class="num" id="5429156">0x800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429163">s_ISGID</span>&nbsp;&nbsp;<span class="op" id="5429172">=</span>&nbsp;<span class="num" id="5429174">0x400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429181">s_ISVTX</span>&nbsp;&nbsp;<span class="op" id="5429190">=</span>&nbsp;<span class="num" id="5429192">0x200</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429200">msdosDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5429214">=</span>&nbsp;<span class="num" id="5429216">0x10</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429222">msdosReadOnly</span>&nbsp;<span class="op" id="5429236">=</span>&nbsp;<span class="num" id="5429238">0x01</span><br>
<span class="lineno"></span><span class="op" id="5429243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5429246">//&nbsp;Mode&nbsp;returns&nbsp;the&nbsp;permission&nbsp;and&nbsp;mode&nbsp;bits&nbsp;for&nbsp;the&nbsp;FileHeader.</span><br>
<span class="lineno"></span><span class="keyword" id="5429311">func</span>&nbsp;<span class="op" id="5429316">(</span><span class="ident" id="5429317">h</span>&nbsp;<span class="op" id="5429319">*</span><span class="ident" id="5429320">FileHeader</span><span class="op" id="5429330">)</span>&nbsp;<span class="ident" id="5429332">Mode</span><span class="op" id="5429336">(</span><span class="op" id="5429337">)</span>&nbsp;<span class="op" id="5429339">(</span><span class="ident" id="5429340">mode</span>&nbsp;<span class="ident" id="5429345">os</span><span class="op" id="5429347">.</span><span class="ident" id="5429348">FileMode</span><span class="op" id="5429356">)</span>&nbsp;<span class="op" id="5429358">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5429361">switch</span>&nbsp;<span class="ident" id="5429368">h</span><span class="op" id="5429369">.</span><span class="ident" id="5429370">CreatorVersion</span>&nbsp;<span class="op" id="5429385">&gt;&gt;</span>&nbsp;<span class="num" id="5429388">8</span>&nbsp;<span class="op" id="5429390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5429393">case</span>&nbsp;<span class="ident" id="5429398">creatorUnix</span><span class="op" id="5429409">,</span>&nbsp;<span class="ident" id="5429411">creatorMacOSX</span><span class="op" id="5429424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429428">mode</span>&nbsp;<span class="op" id="5429433">=</span>&nbsp;<span class="ident" id="5429435">unixModeToFileMode</span><span class="op" id="5429453">(</span><span class="ident" id="5429454">h</span><span class="op" id="5429455">.</span><span class="ident" id="5429456">ExternalAttrs</span>&nbsp;<span class="op" id="5429470">&gt;&gt;</span>&nbsp;<span class="num" id="5429473">16</span><span class="op" id="5429475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5429478">case</span>&nbsp;<span class="ident" id="5429483">creatorNTFS</span><span class="op" id="5429494">,</span>&nbsp;<span class="ident" id="5429496">creatorVFAT</span><span class="op" id="5429507">,</span>&nbsp;<span class="ident" id="5429509">creatorFAT</span><span class="op" id="5429519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429523">mode</span>&nbsp;<span class="op" id="5429528">=</span>&nbsp;<span class="ident" id="5429530">msdosModeToFileMode</span><span class="op" id="5429549">(</span><span class="ident" id="5429550">h</span><span class="op" id="5429551">.</span><span class="ident" id="5429552">ExternalAttrs</span><span class="op" id="5429565">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5429568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5429571">if</span>&nbsp;<span class="builtinfunc" id="5429574">len</span><span class="op" id="5429577">(</span><span class="ident" id="5429578">h</span><span class="op" id="5429579">.</span><span class="ident" id="5429580">Name</span><span class="op" id="5429584">)</span>&nbsp;<span class="op" id="5429586">&gt;</span>&nbsp;<span class="num" id="5429588">0</span>&nbsp;<span class="op" id="5429590">&amp;&amp;</span>&nbsp;<span class="ident" id="5429593">h</span><span class="op" id="5429594">.</span><span class="ident" id="5429595">Name</span><span class="op" id="5429599">[</span><span class="builtinfunc" id="5429600">len</span><span class="op" id="5429603">(</span><span class="ident" id="5429604">h</span><span class="op" id="5429605">.</span><span class="ident" id="5429606">Name</span><span class="op" id="5429610">)</span><span class="op" id="5429611">-</span><span class="num" id="5429612">1</span><span class="op" id="5429613">]</span>&nbsp;<span class="op" id="5429615">==</span>&nbsp;<span class="string" id="5429618">&#39;/&#39;</span>&nbsp;<span class="op" id="5429622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429626">mode</span>&nbsp;<span class="op" id="5429631">|=</span>&nbsp;<span class="ident" id="5429634">os</span><span class="op" id="5429636">.</span><span class="ident" id="5429637">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5429646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5429649">return</span>&nbsp;<span class="ident" id="5429656">mode</span><br>
<span class="lineno">220</span><span class="op" id="5429661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5429664">//&nbsp;SetMode&nbsp;changes&nbsp;the&nbsp;permission&nbsp;and&nbsp;mode&nbsp;bits&nbsp;for&nbsp;the&nbsp;FileHeader.</span><br>
<span class="lineno"></span><span class="keyword" id="5429732">func</span>&nbsp;<span class="op" id="5429737">(</span><span class="ident" id="5429738">h</span>&nbsp;<span class="op" id="5429740">*</span><span class="ident" id="5429741">FileHeader</span><span class="op" id="5429751">)</span>&nbsp;<span class="ident" id="5429753">SetMode</span><span class="op" id="5429760">(</span><span class="ident" id="5429761">mode</span>&nbsp;<span class="ident" id="5429766">os</span><span class="op" id="5429768">.</span><span class="ident" id="5429769">FileMode</span><span class="op" id="5429777">)</span>&nbsp;<span class="op" id="5429779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429782">h</span><span class="op" id="5429783">.</span><span class="ident" id="5429784">CreatorVersion</span>&nbsp;<span class="op" id="5429799">=</span>&nbsp;<span class="ident" id="5429801">h</span><span class="op" id="5429802">.</span><span class="ident" id="5429803">CreatorVersion</span><span class="op" id="5429817">&amp;</span><span class="num" id="5429818">0xff</span>&nbsp;<span class="op" id="5429823">|</span>&nbsp;<span class="ident" id="5429825">creatorUnix</span><span class="op" id="5429836">&lt;&lt;</span><span class="num" id="5429838">8</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429841">h</span><span class="op" id="5429842">.</span><span class="ident" id="5429843">ExternalAttrs</span>&nbsp;<span class="op" id="5429857">=</span>&nbsp;<span class="ident" id="5429859">fileModeToUnixMode</span><span class="op" id="5429877">(</span><span class="ident" id="5429878">mode</span><span class="op" id="5429882">)</span>&nbsp;<span class="op" id="5429884">&lt;&lt;</span>&nbsp;<span class="num" id="5429887">16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5429892">//&nbsp;set&nbsp;MSDOS&nbsp;attributes&nbsp;too,&nbsp;as&nbsp;the&nbsp;original&nbsp;zip&nbsp;does.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5429948">if</span>&nbsp;<span class="ident" id="5429951">mode</span><span class="op" id="5429955">&amp;</span><span class="ident" id="5429956">os</span><span class="op" id="5429958">.</span><span class="ident" id="5429959">ModeDir</span>&nbsp;<span class="op" id="5429967">!=</span>&nbsp;<span class="num" id="5429970">0</span>&nbsp;<span class="op" id="5429972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5429976">h</span><span class="op" id="5429977">.</span><span class="ident" id="5429978">ExternalAttrs</span>&nbsp;<span class="op" id="5429992">|=</span>&nbsp;<span class="ident" id="5429995">msdosDir</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430008">if</span>&nbsp;<span class="ident" id="5430011">mode</span><span class="op" id="5430015">&amp;</span><span class="num" id="5430016">0200</span>&nbsp;<span class="op" id="5430021">==</span>&nbsp;<span class="num" id="5430024">0</span>&nbsp;<span class="op" id="5430026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430030">h</span><span class="op" id="5430031">.</span><span class="ident" id="5430032">ExternalAttrs</span>&nbsp;<span class="op" id="5430046">|=</span>&nbsp;<span class="ident" id="5430049">msdosReadOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430064">}</span><br>
<span class="lineno"></span><span class="op" id="5430066">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="5430069">//&nbsp;isZip64&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;file&nbsp;size&nbsp;exceeds&nbsp;the&nbsp;32&nbsp;bit&nbsp;limit</span><br>
<span class="lineno"></span><span class="keyword" id="5430135">func</span>&nbsp;<span class="op" id="5430140">(</span><span class="ident" id="5430141">fh</span>&nbsp;<span class="op" id="5430144">*</span><span class="ident" id="5430145">FileHeader</span><span class="op" id="5430155">)</span>&nbsp;<span class="ident" id="5430157">isZip64</span><span class="op" id="5430164">(</span><span class="op" id="5430165">)</span>&nbsp;<span class="builtintype" id="5430167">bool</span>&nbsp;<span class="op" id="5430172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430175">return</span>&nbsp;<span class="ident" id="5430182">fh</span><span class="op" id="5430184">.</span><span class="ident" id="5430185">CompressedSize64</span>&nbsp;<span class="op" id="5430202">&gt;</span>&nbsp;<span class="ident" id="5430204">uint32max</span>&nbsp;<span class="op" id="5430214">||</span>&nbsp;<span class="ident" id="5430217">fh</span><span class="op" id="5430219">.</span><span class="ident" id="5430220">UncompressedSize64</span>&nbsp;<span class="op" id="5430239">&gt;</span>&nbsp;<span class="ident" id="5430241">uint32max</span><br>
<span class="lineno"></span><span class="op" id="5430251">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="5430254">func</span>&nbsp;<span class="ident" id="5430259">msdosModeToFileMode</span><span class="op" id="5430278">(</span><span class="ident" id="5430279">m</span>&nbsp;<span class="builtintype" id="5430281">uint32</span><span class="op" id="5430287">)</span>&nbsp;<span class="op" id="5430289">(</span><span class="ident" id="5430290">mode</span>&nbsp;<span class="ident" id="5430295">os</span><span class="op" id="5430297">.</span><span class="ident" id="5430298">FileMode</span><span class="op" id="5430306">)</span>&nbsp;<span class="op" id="5430308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430311">if</span>&nbsp;<span class="ident" id="5430314">m</span><span class="op" id="5430315">&amp;</span><span class="ident" id="5430316">msdosDir</span>&nbsp;<span class="op" id="5430325">!=</span>&nbsp;<span class="num" id="5430328">0</span>&nbsp;<span class="op" id="5430330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430334">mode</span>&nbsp;<span class="op" id="5430339">=</span>&nbsp;<span class="ident" id="5430341">os</span><span class="op" id="5430343">.</span><span class="ident" id="5430344">ModeDir</span>&nbsp;<span class="op" id="5430352">|</span>&nbsp;<span class="num" id="5430354">0777</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430360">}</span>&nbsp;<span class="keyword" id="5430362">else</span>&nbsp;<span class="op" id="5430367">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430371">mode</span>&nbsp;<span class="op" id="5430376">=</span>&nbsp;<span class="num" id="5430378">0666</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430387">if</span>&nbsp;<span class="ident" id="5430390">m</span><span class="op" id="5430391">&amp;</span><span class="ident" id="5430392">msdosReadOnly</span>&nbsp;<span class="op" id="5430406">!=</span>&nbsp;<span class="num" id="5430409">0</span>&nbsp;<span class="op" id="5430411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430415">mode</span>&nbsp;<span class="op" id="5430420">&amp;^=</span>&nbsp;<span class="num" id="5430424">0222</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430430">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430433">return</span>&nbsp;<span class="ident" id="5430440">mode</span><br>
<span class="lineno"></span><span class="op" id="5430445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5430448">func</span>&nbsp;<span class="ident" id="5430453">fileModeToUnixMode</span><span class="op" id="5430471">(</span><span class="ident" id="5430472">mode</span>&nbsp;<span class="ident" id="5430477">os</span><span class="op" id="5430479">.</span><span class="ident" id="5430480">FileMode</span><span class="op" id="5430488">)</span>&nbsp;<span class="builtintype" id="5430490">uint32</span>&nbsp;<span class="op" id="5430497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430500">var</span>&nbsp;<span class="ident" id="5430504">m</span>&nbsp;<span class="builtintype" id="5430506">uint32</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430514">switch</span>&nbsp;<span class="ident" id="5430521">mode</span>&nbsp;<span class="op" id="5430526">&amp;</span>&nbsp;<span class="ident" id="5430528">os</span><span class="op" id="5430530">.</span><span class="ident" id="5430531">ModeType</span>&nbsp;<span class="op" id="5430540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430543">default</span><span class="op" id="5430550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430554">m</span>&nbsp;<span class="op" id="5430556">=</span>&nbsp;<span class="ident" id="5430558">s_IFREG</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430567">case</span>&nbsp;<span class="ident" id="5430572">os</span><span class="op" id="5430574">.</span><span class="ident" id="5430575">ModeDir</span><span class="op" id="5430582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430586">m</span>&nbsp;<span class="op" id="5430588">=</span>&nbsp;<span class="ident" id="5430590">s_IFDIR</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430599">case</span>&nbsp;<span class="ident" id="5430604">os</span><span class="op" id="5430606">.</span><span class="ident" id="5430607">ModeSymlink</span><span class="op" id="5430618">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430622">m</span>&nbsp;<span class="op" id="5430624">=</span>&nbsp;<span class="ident" id="5430626">s_IFLNK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430635">case</span>&nbsp;<span class="ident" id="5430640">os</span><span class="op" id="5430642">.</span><span class="ident" id="5430643">ModeNamedPipe</span><span class="op" id="5430656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430660">m</span>&nbsp;<span class="op" id="5430662">=</span>&nbsp;<span class="ident" id="5430664">s_IFIFO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430673">case</span>&nbsp;<span class="ident" id="5430678">os</span><span class="op" id="5430680">.</span><span class="ident" id="5430681">ModeSocket</span><span class="op" id="5430691">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430695">m</span>&nbsp;<span class="op" id="5430697">=</span>&nbsp;<span class="ident" id="5430699">s_IFSOCK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430709">case</span>&nbsp;<span class="ident" id="5430714">os</span><span class="op" id="5430716">.</span><span class="ident" id="5430717">ModeDevice</span><span class="op" id="5430727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430731">if</span>&nbsp;<span class="ident" id="5430734">mode</span><span class="op" id="5430738">&amp;</span><span class="ident" id="5430739">os</span><span class="op" id="5430741">.</span><span class="ident" id="5430742">ModeCharDevice</span>&nbsp;<span class="op" id="5430757">!=</span>&nbsp;<span class="num" id="5430760">0</span>&nbsp;<span class="op" id="5430762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430767">m</span>&nbsp;<span class="op" id="5430769">=</span>&nbsp;<span class="ident" id="5430771">s_IFCHR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430781">}</span>&nbsp;<span class="keyword" id="5430783">else</span>&nbsp;<span class="op" id="5430788">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430793">m</span>&nbsp;<span class="op" id="5430795">=</span>&nbsp;<span class="ident" id="5430797">s_IFBLK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430813">if</span>&nbsp;<span class="ident" id="5430816">mode</span><span class="op" id="5430820">&amp;</span><span class="ident" id="5430821">os</span><span class="op" id="5430823">.</span><span class="ident" id="5430824">ModeSetuid</span>&nbsp;<span class="op" id="5430835">!=</span>&nbsp;<span class="num" id="5430838">0</span>&nbsp;<span class="op" id="5430840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430844">m</span>&nbsp;<span class="op" id="5430846">|=</span>&nbsp;<span class="ident" id="5430849">s_ISUID</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430861">if</span>&nbsp;<span class="ident" id="5430864">mode</span><span class="op" id="5430868">&amp;</span><span class="ident" id="5430869">os</span><span class="op" id="5430871">.</span><span class="ident" id="5430872">ModeSetgid</span>&nbsp;<span class="op" id="5430883">!=</span>&nbsp;<span class="num" id="5430886">0</span>&nbsp;<span class="op" id="5430888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430892">m</span>&nbsp;<span class="op" id="5430894">|=</span>&nbsp;<span class="ident" id="5430897">s_ISGID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430909">if</span>&nbsp;<span class="ident" id="5430912">mode</span><span class="op" id="5430916">&amp;</span><span class="ident" id="5430917">os</span><span class="op" id="5430919">.</span><span class="ident" id="5430920">ModeSticky</span>&nbsp;<span class="op" id="5430931">!=</span>&nbsp;<span class="num" id="5430934">0</span>&nbsp;<span class="op" id="5430936">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5430940">m</span>&nbsp;<span class="op" id="5430942">|=</span>&nbsp;<span class="ident" id="5430945">s_ISVTX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5430954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5430957">return</span>&nbsp;<span class="ident" id="5430964">m</span>&nbsp;<span class="op" id="5430966">|</span>&nbsp;<span class="builtintype" id="5430968">uint32</span><span class="op" id="5430974">(</span><span class="ident" id="5430975">mode</span><span class="op" id="5430979">&amp;</span><span class="num" id="5430980">0777</span><span class="op" id="5430984">)</span><br>
<span class="lineno"></span><span class="op" id="5430986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5430989">func</span>&nbsp;<span class="ident" id="5430994">unixModeToFileMode</span><span class="op" id="5431012">(</span><span class="ident" id="5431013">m</span>&nbsp;<span class="builtintype" id="5431015">uint32</span><span class="op" id="5431021">)</span>&nbsp;<span class="ident" id="5431023">os</span><span class="op" id="5431025">.</span><span class="ident" id="5431026">FileMode</span>&nbsp;<span class="op" id="5431035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431038">mode</span>&nbsp;<span class="op" id="5431043">:=</span>&nbsp;<span class="ident" id="5431046">os</span><span class="op" id="5431048">.</span><span class="ident" id="5431049">FileMode</span><span class="op" id="5431057">(</span><span class="ident" id="5431058">m</span>&nbsp;<span class="op" id="5431060">&amp;</span>&nbsp;<span class="num" id="5431062">0777</span><span class="op" id="5431066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431069">switch</span>&nbsp;<span class="ident" id="5431076">m</span>&nbsp;<span class="op" id="5431078">&amp;</span>&nbsp;<span class="ident" id="5431080">s_IFMT</span>&nbsp;<span class="op" id="5431087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431090">case</span>&nbsp;<span class="ident" id="5431095">s_IFBLK</span><span class="op" id="5431102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431106">mode</span>&nbsp;<span class="op" id="5431111">|=</span>&nbsp;<span class="ident" id="5431114">os</span><span class="op" id="5431116">.</span><span class="ident" id="5431117">ModeDevice</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431129">case</span>&nbsp;<span class="ident" id="5431134">s_IFCHR</span><span class="op" id="5431141">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431145">mode</span>&nbsp;<span class="op" id="5431150">|=</span>&nbsp;<span class="ident" id="5431153">os</span><span class="op" id="5431155">.</span><span class="ident" id="5431156">ModeDevice</span>&nbsp;<span class="op" id="5431167">|</span>&nbsp;<span class="ident" id="5431169">os</span><span class="op" id="5431171">.</span><span class="ident" id="5431172">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431188">case</span>&nbsp;<span class="ident" id="5431193">s_IFDIR</span><span class="op" id="5431200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431204">mode</span>&nbsp;<span class="op" id="5431209">|=</span>&nbsp;<span class="ident" id="5431212">os</span><span class="op" id="5431214">.</span><span class="ident" id="5431215">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431224">case</span>&nbsp;<span class="ident" id="5431229">s_IFIFO</span><span class="op" id="5431236">:</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431240">mode</span>&nbsp;<span class="op" id="5431245">|=</span>&nbsp;<span class="ident" id="5431248">os</span><span class="op" id="5431250">.</span><span class="ident" id="5431251">ModeNamedPipe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431266">case</span>&nbsp;<span class="ident" id="5431271">s_IFLNK</span><span class="op" id="5431278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431282">mode</span>&nbsp;<span class="op" id="5431287">|=</span>&nbsp;<span class="ident" id="5431290">os</span><span class="op" id="5431292">.</span><span class="ident" id="5431293">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431306">case</span>&nbsp;<span class="ident" id="5431311">s_IFREG</span><span class="op" id="5431318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5431322">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431340">case</span>&nbsp;<span class="ident" id="5431345">s_IFSOCK</span><span class="op" id="5431353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431357">mode</span>&nbsp;<span class="op" id="5431362">|=</span>&nbsp;<span class="ident" id="5431365">os</span><span class="op" id="5431367">.</span><span class="ident" id="5431368">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5431380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431383">if</span>&nbsp;<span class="ident" id="5431386">m</span><span class="op" id="5431387">&amp;</span><span class="ident" id="5431388">s_ISGID</span>&nbsp;<span class="op" id="5431396">!=</span>&nbsp;<span class="num" id="5431399">0</span>&nbsp;<span class="op" id="5431401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431405">mode</span>&nbsp;<span class="op" id="5431410">|=</span>&nbsp;<span class="ident" id="5431413">os</span><span class="op" id="5431415">.</span><span class="ident" id="5431416">ModeSetgid</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5431428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431431">if</span>&nbsp;<span class="ident" id="5431434">m</span><span class="op" id="5431435">&amp;</span><span class="ident" id="5431436">s_ISUID</span>&nbsp;<span class="op" id="5431444">!=</span>&nbsp;<span class="num" id="5431447">0</span>&nbsp;<span class="op" id="5431449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431453">mode</span>&nbsp;<span class="op" id="5431458">|=</span>&nbsp;<span class="ident" id="5431461">os</span><span class="op" id="5431463">.</span><span class="ident" id="5431464">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5431476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431479">if</span>&nbsp;<span class="ident" id="5431482">m</span><span class="op" id="5431483">&amp;</span><span class="ident" id="5431484">s_ISVTX</span>&nbsp;<span class="op" id="5431492">!=</span>&nbsp;<span class="num" id="5431495">0</span>&nbsp;<span class="op" id="5431497">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5431501">mode</span>&nbsp;<span class="op" id="5431506">|=</span>&nbsp;<span class="ident" id="5431509">os</span><span class="op" id="5431511">.</span><span class="ident" id="5431512">ModeSticky</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5431524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5431527">return</span>&nbsp;<span class="ident" id="5431534">mode</span><br>
<span class="lineno"></span><span class="op" id="5431539">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
