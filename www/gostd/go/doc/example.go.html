<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html" class="current">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4350373">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4350428">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4350482">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4350533">//&nbsp;Extract&nbsp;example&nbsp;functions&nbsp;from&nbsp;file&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4350579">package</span>&nbsp;<span class="ident" id="4350587">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4350592">import</span>&nbsp;<span class="op" id="4350599">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4350602">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4350612">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4350624">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4350632">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4350642">&#34;sort&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4350650">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4350661">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4350672">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4350683">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4350698">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4350701">//&nbsp;An&nbsp;Example&nbsp;represents&nbsp;an&nbsp;example&nbsp;function&nbsp;found&nbsp;in&nbsp;a&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="4350771">type</span>&nbsp;<span class="ident" id="4350776">Example</span>&nbsp;<span class="keyword" id="4350784">struct</span>&nbsp;<span class="op" id="4350791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350794">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4350806">string</span>&nbsp;<span class="comment" id="4350813">//&nbsp;name&nbsp;of&nbsp;the&nbsp;item&nbsp;being&nbsp;exemplified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350852">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4350864">string</span>&nbsp;<span class="comment" id="4350871">//&nbsp;example&nbsp;function&nbsp;doc&nbsp;string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350903">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4350915">ast</span><span class="op" id="4350918">.</span><span class="ident" id="4350919">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350925">Play</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4350937">*</span><span class="ident" id="4350938">ast</span><span class="op" id="4350941">.</span><span class="ident" id="4350942">File</span>&nbsp;<span class="comment" id="4350947">//&nbsp;a&nbsp;whole&nbsp;program&nbsp;version&nbsp;of&nbsp;the&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350990">Comments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4351002">[</span><span class="op" id="4351003">]</span><span class="op" id="4351004">*</span><span class="ident" id="4351005">ast</span><span class="op" id="4351008">.</span><span class="ident" id="4351009">CommentGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351023">Output</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4351035">string</span>&nbsp;<span class="comment" id="4351042">//&nbsp;expected&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351062">EmptyOutput</span>&nbsp;<span class="builtintype" id="4351074">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4351081">//&nbsp;expect&nbsp;empty&nbsp;output</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351105">Order</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4351117">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4351124">//&nbsp;original&nbsp;source&nbsp;code&nbsp;order</span><br>
<span class="lineno"></span><span class="op" id="4351154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4351157">//&nbsp;Examples&nbsp;returns&nbsp;the&nbsp;examples&nbsp;found&nbsp;in&nbsp;the&nbsp;files,&nbsp;sorted&nbsp;by&nbsp;Name&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="4351232">//&nbsp;The&nbsp;Order&nbsp;fields&nbsp;record&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;the&nbsp;examples&nbsp;were&nbsp;encountered.</span><br>
<span class="lineno">35</span><span class="comment" id="4351309">//</span><br>
<span class="lineno"></span><span class="comment" id="4351312">//&nbsp;Playable&nbsp;Examples&nbsp;must&nbsp;be&nbsp;in&nbsp;a&nbsp;package&nbsp;whose&nbsp;name&nbsp;ends&nbsp;in&nbsp;&#34;_test&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="4351382">//&nbsp;An&nbsp;Example&nbsp;is&nbsp;&#34;playable&#34;&nbsp;(the&nbsp;Play&nbsp;field&nbsp;is&nbsp;non-nil)&nbsp;in&nbsp;either&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="4351457">//&nbsp;circumstances:</span><br>
<span class="lineno"></span><span class="comment" id="4351475">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;example&nbsp;function&nbsp;is&nbsp;self-contained:&nbsp;the&nbsp;function&nbsp;references&nbsp;only</span><br>
<span class="lineno">40</span><span class="comment" id="4351551">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifiers&nbsp;from&nbsp;other&nbsp;packages&nbsp;(or&nbsp;predeclared&nbsp;identifiers,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4351627">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;int&#34;)&nbsp;and&nbsp;the&nbsp;test&nbsp;file&nbsp;does&nbsp;not&nbsp;include&nbsp;a&nbsp;dot&nbsp;import.</span><br>
<span class="lineno"></span><span class="comment" id="4351690">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;the&nbsp;example:&nbsp;the&nbsp;file&nbsp;contains&nbsp;exactly&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4351764">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;example&nbsp;function,&nbsp;zero&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions,&nbsp;and&nbsp;at&nbsp;least&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4351840">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top-level&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant&nbsp;declaration&nbsp;other</span><br>
<span class="lineno">45</span><span class="comment" id="4351913">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;the&nbsp;example&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="4351947">func</span>&nbsp;<span class="ident" id="4351952">Examples</span><span class="op" id="4351960">(</span><span class="ident" id="4351961">files</span>&nbsp;<span class="op" id="4351967">...</span><span class="op" id="4351970">*</span><span class="ident" id="4351971">ast</span><span class="op" id="4351974">.</span><span class="ident" id="4351975">File</span><span class="op" id="4351979">)</span>&nbsp;<span class="op" id="4351981">[</span><span class="op" id="4351982">]</span><span class="op" id="4351983">*</span><span class="ident" id="4351984">Example</span>&nbsp;<span class="op" id="4351992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351995">var</span>&nbsp;<span class="ident" id="4351999">list</span>&nbsp;<span class="op" id="4352004">[</span><span class="op" id="4352005">]</span><span class="op" id="4352006">*</span><span class="ident" id="4352007">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352016">for</span>&nbsp;<span class="ident" id="4352020">_</span><span class="op" id="4352021">,</span>&nbsp;<span class="ident" id="4352023">file</span>&nbsp;<span class="op" id="4352028">:=</span>&nbsp;<span class="keyword" id="4352031">range</span>&nbsp;<span class="ident" id="4352037">files</span>&nbsp;<span class="op" id="4352043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352047">hasTests</span>&nbsp;<span class="op" id="4352056">:=</span>&nbsp;<span class="builtintype" id="4352059">false</span>&nbsp;<span class="comment" id="4352065">//&nbsp;file&nbsp;contains&nbsp;tests&nbsp;or&nbsp;benchmarks</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352104">numDecl</span>&nbsp;<span class="op" id="4352112">:=</span>&nbsp;<span class="num" id="4352115">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4352122">//&nbsp;number&nbsp;of&nbsp;non-import&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352173">var</span>&nbsp;<span class="ident" id="4352177">flist</span>&nbsp;<span class="op" id="4352183">[</span><span class="op" id="4352184">]</span><span class="op" id="4352185">*</span><span class="ident" id="4352186">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352196">for</span>&nbsp;<span class="ident" id="4352200">_</span><span class="op" id="4352201">,</span>&nbsp;<span class="ident" id="4352203">decl</span>&nbsp;<span class="op" id="4352208">:=</span>&nbsp;<span class="keyword" id="4352211">range</span>&nbsp;<span class="ident" id="4352217">file</span><span class="op" id="4352221">.</span><span class="ident" id="4352222">Decls</span>&nbsp;<span class="op" id="4352228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352233">if</span>&nbsp;<span class="ident" id="4352236">g</span><span class="op" id="4352237">,</span>&nbsp;<span class="ident" id="4352239">ok</span>&nbsp;<span class="op" id="4352242">:=</span>&nbsp;<span class="ident" id="4352245">decl</span><span class="op" id="4352249">.</span><span class="op" id="4352250">(</span><span class="op" id="4352251">*</span><span class="ident" id="4352252">ast</span><span class="op" id="4352255">.</span><span class="ident" id="4352256">GenDecl</span><span class="op" id="4352263">)</span><span class="op" id="4352264">;</span>&nbsp;<span class="ident" id="4352266">ok</span>&nbsp;<span class="op" id="4352269">&amp;&amp;</span>&nbsp;<span class="ident" id="4352272">g</span><span class="op" id="4352273">.</span><span class="ident" id="4352274">Tok</span>&nbsp;<span class="op" id="4352278">!=</span>&nbsp;<span class="ident" id="4352281">token</span><span class="op" id="4352286">.</span><span class="ident" id="4352287">IMPORT</span>&nbsp;<span class="op" id="4352294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352300">numDecl</span><span class="op" id="4352307">++</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352314">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352331">f</span><span class="op" id="4352332">,</span>&nbsp;<span class="ident" id="4352334">ok</span>&nbsp;<span class="op" id="4352337">:=</span>&nbsp;<span class="ident" id="4352340">decl</span><span class="op" id="4352344">.</span><span class="op" id="4352345">(</span><span class="op" id="4352346">*</span><span class="ident" id="4352347">ast</span><span class="op" id="4352350">.</span><span class="ident" id="4352351">FuncDecl</span><span class="op" id="4352359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352364">if</span>&nbsp;<span class="op" id="4352367">!</span><span class="ident" id="4352368">ok</span>&nbsp;<span class="op" id="4352371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352377">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352394">numDecl</span><span class="op" id="4352401">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352407">name</span>&nbsp;<span class="op" id="4352412">:=</span>&nbsp;<span class="ident" id="4352415">f</span><span class="op" id="4352416">.</span><span class="ident" id="4352417">Name</span><span class="op" id="4352421">.</span><span class="ident" id="4352422">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352430">if</span>&nbsp;<span class="ident" id="4352433">isTest</span><span class="op" id="4352439">(</span><span class="ident" id="4352440">name</span><span class="op" id="4352444">,</span>&nbsp;<span class="string" id="4352446">&#34;Test&#34;</span><span class="op" id="4352452">)</span>&nbsp;<span class="op" id="4352454">||</span>&nbsp;<span class="ident" id="4352457">isTest</span><span class="op" id="4352463">(</span><span class="ident" id="4352464">name</span><span class="op" id="4352468">,</span>&nbsp;<span class="string" id="4352470">&#34;Benchmark&#34;</span><span class="op" id="4352481">)</span>&nbsp;<span class="op" id="4352483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352489">hasTests</span>&nbsp;<span class="op" id="4352498">=</span>&nbsp;<span class="builtintype" id="4352500">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352509">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352526">if</span>&nbsp;<span class="op" id="4352529">!</span><span class="ident" id="4352530">isTest</span><span class="op" id="4352536">(</span><span class="ident" id="4352537">name</span><span class="op" id="4352541">,</span>&nbsp;<span class="string" id="4352543">&#34;Example&#34;</span><span class="op" id="4352552">)</span>&nbsp;<span class="op" id="4352554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352560">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352572">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352577">var</span>&nbsp;<span class="ident" id="4352581">doc</span>&nbsp;<span class="builtintype" id="4352585">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352595">if</span>&nbsp;<span class="ident" id="4352598">f</span><span class="op" id="4352599">.</span><span class="ident" id="4352600">Doc</span>&nbsp;<span class="op" id="4352604">!=</span>&nbsp;<span class="ident" id="4352607">nil</span>&nbsp;<span class="op" id="4352611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352617">doc</span>&nbsp;<span class="op" id="4352621">=</span>&nbsp;<span class="ident" id="4352623">f</span><span class="op" id="4352624">.</span><span class="ident" id="4352625">Doc</span><span class="op" id="4352628">.</span><span class="ident" id="4352629">Text</span><span class="op" id="4352633">(</span><span class="op" id="4352634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352644">output</span><span class="op" id="4352650">,</span>&nbsp;<span class="ident" id="4352652">hasOutput</span>&nbsp;<span class="op" id="4352662">:=</span>&nbsp;<span class="ident" id="4352665">exampleOutput</span><span class="op" id="4352678">(</span><span class="ident" id="4352679">f</span><span class="op" id="4352680">.</span><span class="ident" id="4352681">Body</span><span class="op" id="4352685">,</span>&nbsp;<span class="ident" id="4352687">file</span><span class="op" id="4352691">.</span><span class="ident" id="4352692">Comments</span><span class="op" id="4352700">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352705">flist</span>&nbsp;<span class="op" id="4352711">=</span>&nbsp;<span class="builtinfunc" id="4352713">append</span><span class="op" id="4352719">(</span><span class="ident" id="4352720">flist</span><span class="op" id="4352725">,</span>&nbsp;<span class="op" id="4352727">&amp;</span><span class="ident" id="4352728">Example</span><span class="op" id="4352735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352741">Name</span><span class="op" id="4352745">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4352754">name</span><span class="op" id="4352758">[</span><span class="builtinfunc" id="4352759">len</span><span class="op" id="4352762">(</span><span class="string" id="4352763">&#34;Example&#34;</span><span class="op" id="4352772">)</span><span class="op" id="4352773">:</span><span class="op" id="4352774">]</span><span class="op" id="4352775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352781">Doc</span><span class="op" id="4352784">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4352794">doc</span><span class="op" id="4352797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352803">Code</span><span class="op" id="4352807">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4352816">f</span><span class="op" id="4352817">.</span><span class="ident" id="4352818">Body</span><span class="op" id="4352822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352828">Play</span><span class="op" id="4352832">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4352841">playExample</span><span class="op" id="4352852">(</span><span class="ident" id="4352853">file</span><span class="op" id="4352857">,</span>&nbsp;<span class="ident" id="4352859">f</span><span class="op" id="4352860">.</span><span class="ident" id="4352861">Body</span><span class="op" id="4352865">)</span><span class="op" id="4352866">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352872">Comments</span><span class="op" id="4352880">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4352885">file</span><span class="op" id="4352889">.</span><span class="ident" id="4352890">Comments</span><span class="op" id="4352898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352904">Output</span><span class="op" id="4352910">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4352917">output</span><span class="op" id="4352923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352929">EmptyOutput</span><span class="op" id="4352940">:</span>&nbsp;<span class="ident" id="4352942">output</span>&nbsp;<span class="op" id="4352949">==</span>&nbsp;<span class="string" id="4352952">&#34;&#34;</span>&nbsp;<span class="op" id="4352955">&amp;&amp;</span>&nbsp;<span class="ident" id="4352958">hasOutput</span><span class="op" id="4352967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352973">Order</span><span class="op" id="4352978">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4352986">len</span><span class="op" id="4352989">(</span><span class="ident" id="4352990">flist</span><span class="op" id="4352995">)</span><span class="op" id="4352996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353001">}</span><span class="op" id="4353002">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353010">if</span>&nbsp;<span class="op" id="4353013">!</span><span class="ident" id="4353014">hasTests</span>&nbsp;<span class="op" id="4353023">&amp;&amp;</span>&nbsp;<span class="ident" id="4353026">numDecl</span>&nbsp;<span class="op" id="4353034">&gt;</span>&nbsp;<span class="num" id="4353036">1</span>&nbsp;<span class="op" id="4353038">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4353041">len</span><span class="op" id="4353044">(</span><span class="ident" id="4353045">flist</span><span class="op" id="4353050">)</span>&nbsp;<span class="op" id="4353052">==</span>&nbsp;<span class="num" id="4353055">1</span>&nbsp;<span class="op" id="4353057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353062">//&nbsp;If&nbsp;this&nbsp;file&nbsp;only&nbsp;has&nbsp;one&nbsp;example&nbsp;function,&nbsp;some</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353117">//&nbsp;other&nbsp;top-level&nbsp;declarations,&nbsp;and&nbsp;no&nbsp;tests&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353169">//&nbsp;benchmarks,&nbsp;use&nbsp;the&nbsp;whole&nbsp;file&nbsp;as&nbsp;the&nbsp;example.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353222">flist</span><span class="op" id="4353227">[</span><span class="num" id="4353228">0</span><span class="op" id="4353229">]</span><span class="op" id="4353230">.</span><span class="ident" id="4353231">Code</span>&nbsp;<span class="op" id="4353236">=</span>&nbsp;<span class="ident" id="4353238">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353246">flist</span><span class="op" id="4353251">[</span><span class="num" id="4353252">0</span><span class="op" id="4353253">]</span><span class="op" id="4353254">.</span><span class="ident" id="4353255">Play</span>&nbsp;<span class="op" id="4353260">=</span>&nbsp;<span class="ident" id="4353262">playExampleFile</span><span class="op" id="4353277">(</span><span class="ident" id="4353278">file</span><span class="op" id="4353282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353290">list</span>&nbsp;<span class="op" id="4353295">=</span>&nbsp;<span class="builtinfunc" id="4353297">append</span><span class="op" id="4353303">(</span><span class="ident" id="4353304">list</span><span class="op" id="4353308">,</span>&nbsp;<span class="ident" id="4353310">flist</span><span class="op" id="4353315">...</span><span class="op" id="4353318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353321">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353324">sort</span><span class="op" id="4353328">.</span><span class="ident" id="4353329">Sort</span><span class="op" id="4353333">(</span><span class="ident" id="4353334">exampleByName</span><span class="op" id="4353347">(</span><span class="ident" id="4353348">list</span><span class="op" id="4353352">)</span><span class="op" id="4353353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353356">return</span>&nbsp;<span class="ident" id="4353363">list</span><br>
<span class="lineno"></span><span class="op" id="4353368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4353371">var</span>&nbsp;<span class="ident" id="4353375">outputPrefix</span>&nbsp;<span class="op" id="4353388">=</span>&nbsp;<span class="ident" id="4353390">regexp</span><span class="op" id="4353396">.</span><span class="ident" id="4353397">MustCompile</span><span class="op" id="4353408">(</span><span class="string" id="4353409">`(?i)^[[:space:]]*output:`</span><span class="op" id="4353435">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4353438">//&nbsp;Extracts&nbsp;the&nbsp;expected&nbsp;output&nbsp;and&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;valid&nbsp;output&nbsp;comment</span><br>
<span class="lineno"></span><span class="keyword" id="4353515">func</span>&nbsp;<span class="ident" id="4353520">exampleOutput</span><span class="op" id="4353533">(</span><span class="ident" id="4353534">b</span>&nbsp;<span class="op" id="4353536">*</span><span class="ident" id="4353537">ast</span><span class="op" id="4353540">.</span><span class="ident" id="4353541">BlockStmt</span><span class="op" id="4353550">,</span>&nbsp;<span class="ident" id="4353552">comments</span>&nbsp;<span class="op" id="4353561">[</span><span class="op" id="4353562">]</span><span class="op" id="4353563">*</span><span class="ident" id="4353564">ast</span><span class="op" id="4353567">.</span><span class="ident" id="4353568">CommentGroup</span><span class="op" id="4353580">)</span>&nbsp;<span class="op" id="4353582">(</span><span class="ident" id="4353583">output</span>&nbsp;<span class="builtintype" id="4353590">string</span><span class="op" id="4353596">,</span>&nbsp;<span class="ident" id="4353598">ok</span>&nbsp;<span class="builtintype" id="4353601">bool</span><span class="op" id="4353605">)</span>&nbsp;<span class="op" id="4353607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353610">if</span>&nbsp;<span class="ident" id="4353613">_</span><span class="op" id="4353614">,</span>&nbsp;<span class="ident" id="4353616">last</span>&nbsp;<span class="op" id="4353621">:=</span>&nbsp;<span class="ident" id="4353624">lastComment</span><span class="op" id="4353635">(</span><span class="ident" id="4353636">b</span><span class="op" id="4353637">,</span>&nbsp;<span class="ident" id="4353639">comments</span><span class="op" id="4353647">)</span><span class="op" id="4353648">;</span>&nbsp;<span class="ident" id="4353650">last</span>&nbsp;<span class="op" id="4353655">!=</span>&nbsp;<span class="ident" id="4353658">nil</span>&nbsp;<span class="op" id="4353662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353666">//&nbsp;test&nbsp;that&nbsp;it&nbsp;begins&nbsp;with&nbsp;the&nbsp;correct&nbsp;prefix</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353715">text</span>&nbsp;<span class="op" id="4353720">:=</span>&nbsp;<span class="ident" id="4353723">last</span><span class="op" id="4353727">.</span><span class="ident" id="4353728">Text</span><span class="op" id="4353732">(</span><span class="op" id="4353733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353737">if</span>&nbsp;<span class="ident" id="4353740">loc</span>&nbsp;<span class="op" id="4353744">:=</span>&nbsp;<span class="ident" id="4353747">outputPrefix</span><span class="op" id="4353759">.</span><span class="ident" id="4353760">FindStringIndex</span><span class="op" id="4353775">(</span><span class="ident" id="4353776">text</span><span class="op" id="4353780">)</span><span class="op" id="4353781">;</span>&nbsp;<span class="ident" id="4353783">loc</span>&nbsp;<span class="op" id="4353787">!=</span>&nbsp;<span class="ident" id="4353790">nil</span>&nbsp;<span class="op" id="4353794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353799">text</span>&nbsp;<span class="op" id="4353804">=</span>&nbsp;<span class="ident" id="4353806">text</span><span class="op" id="4353810">[</span><span class="ident" id="4353811">loc</span><span class="op" id="4353814">[</span><span class="num" id="4353815">1</span><span class="op" id="4353816">]</span><span class="op" id="4353817">:</span><span class="op" id="4353818">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353823">//&nbsp;Strip&nbsp;zero&nbsp;or&nbsp;more&nbsp;spaces&nbsp;followed&nbsp;by&nbsp;\n&nbsp;or&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353889">text</span>&nbsp;<span class="op" id="4353894">=</span>&nbsp;<span class="ident" id="4353896">strings</span><span class="op" id="4353903">.</span><span class="ident" id="4353904">TrimLeft</span><span class="op" id="4353912">(</span><span class="ident" id="4353913">text</span><span class="op" id="4353917">,</span>&nbsp;<span class="string" id="4353919">&#34;&nbsp;&#34;</span><span class="op" id="4353922">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353927">if</span>&nbsp;<span class="builtinfunc" id="4353930">len</span><span class="op" id="4353933">(</span><span class="ident" id="4353934">text</span><span class="op" id="4353938">)</span>&nbsp;<span class="op" id="4353940">&gt;</span>&nbsp;<span class="num" id="4353942">0</span>&nbsp;<span class="op" id="4353944">&amp;&amp;</span>&nbsp;<span class="ident" id="4353947">text</span><span class="op" id="4353951">[</span><span class="num" id="4353952">0</span><span class="op" id="4353953">]</span>&nbsp;<span class="op" id="4353955">==</span>&nbsp;<span class="string" id="4353958">&#39;\n&#39;</span>&nbsp;<span class="op" id="4353963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353969">text</span>&nbsp;<span class="op" id="4353974">=</span>&nbsp;<span class="ident" id="4353976">text</span><span class="op" id="4353980">[</span><span class="num" id="4353981">1</span><span class="op" id="4353982">:</span><span class="op" id="4353983">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353993">return</span>&nbsp;<span class="ident" id="4354000">text</span><span class="op" id="4354004">,</span>&nbsp;<span class="builtintype" id="4354006">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354013">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354019">return</span>&nbsp;<span class="string" id="4354026">&#34;&#34;</span><span class="op" id="4354028">,</span>&nbsp;<span class="builtintype" id="4354030">false</span>&nbsp;<span class="comment" id="4354036">//&nbsp;no&nbsp;suitable&nbsp;comment&nbsp;found</span><br>
<span class="lineno"></span><span class="op" id="4354065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4354068">//&nbsp;isTest&nbsp;tells&nbsp;whether&nbsp;name&nbsp;looks&nbsp;like&nbsp;a&nbsp;test,&nbsp;example,&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno">120</span><span class="comment" id="4354139">//&nbsp;It&nbsp;is&nbsp;a&nbsp;Test&nbsp;(say)&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;character&nbsp;after&nbsp;Test&nbsp;that&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4354210">//&nbsp;lower-case&nbsp;letter.&nbsp;(We&nbsp;don&#39;t&nbsp;want&nbsp;Testiness.)</span><br>
<span class="lineno"></span><span class="keyword" id="4354259">func</span>&nbsp;<span class="ident" id="4354264">isTest</span><span class="op" id="4354270">(</span><span class="ident" id="4354271">name</span><span class="op" id="4354275">,</span>&nbsp;<span class="ident" id="4354277">prefix</span>&nbsp;<span class="builtintype" id="4354284">string</span><span class="op" id="4354290">)</span>&nbsp;<span class="builtintype" id="4354292">bool</span>&nbsp;<span class="op" id="4354297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354300">if</span>&nbsp;<span class="op" id="4354303">!</span><span class="ident" id="4354304">strings</span><span class="op" id="4354311">.</span><span class="ident" id="4354312">HasPrefix</span><span class="op" id="4354321">(</span><span class="ident" id="4354322">name</span><span class="op" id="4354326">,</span>&nbsp;<span class="ident" id="4354328">prefix</span><span class="op" id="4354334">)</span>&nbsp;<span class="op" id="4354336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354340">return</span>&nbsp;<span class="builtintype" id="4354347">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354357">if</span>&nbsp;<span class="builtinfunc" id="4354360">len</span><span class="op" id="4354363">(</span><span class="ident" id="4354364">name</span><span class="op" id="4354368">)</span>&nbsp;<span class="op" id="4354370">==</span>&nbsp;<span class="builtinfunc" id="4354373">len</span><span class="op" id="4354376">(</span><span class="ident" id="4354377">prefix</span><span class="op" id="4354383">)</span>&nbsp;<span class="op" id="4354385">{</span>&nbsp;<span class="comment" id="4354387">//&nbsp;&#34;Test&#34;&nbsp;is&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354405">return</span>&nbsp;<span class="builtintype" id="4354412">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4354421">rune</span><span class="op" id="4354425">,</span>&nbsp;<span class="ident" id="4354427">_</span>&nbsp;<span class="op" id="4354429">:=</span>&nbsp;<span class="ident" id="4354432">utf8</span><span class="op" id="4354436">.</span><span class="ident" id="4354437">DecodeRuneInString</span><span class="op" id="4354455">(</span><span class="ident" id="4354456">name</span><span class="op" id="4354460">[</span><span class="builtinfunc" id="4354461">len</span><span class="op" id="4354464">(</span><span class="ident" id="4354465">prefix</span><span class="op" id="4354471">)</span><span class="op" id="4354472">:</span><span class="op" id="4354473">]</span><span class="op" id="4354474">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354477">return</span>&nbsp;<span class="op" id="4354484">!</span><span class="ident" id="4354485">unicode</span><span class="op" id="4354492">.</span><span class="ident" id="4354493">IsLower</span><span class="op" id="4354500">(</span><span class="builtintype" id="4354501">rune</span><span class="op" id="4354505">)</span><br>
<span class="lineno"></span><span class="op" id="4354507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4354510">type</span>&nbsp;<span class="ident" id="4354515">exampleByName</span>&nbsp;<span class="op" id="4354529">[</span><span class="op" id="4354530">]</span><span class="op" id="4354531">*</span><span class="ident" id="4354532">Example</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="4354541">func</span>&nbsp;<span class="op" id="4354546">(</span><span class="ident" id="4354547">s</span>&nbsp;<span class="ident" id="4354549">exampleByName</span><span class="op" id="4354562">)</span>&nbsp;<span class="ident" id="4354564">Len</span><span class="op" id="4354567">(</span><span class="op" id="4354568">)</span>&nbsp;<span class="builtintype" id="4354570">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354584">{</span>&nbsp;<span class="keyword" id="4354586">return</span>&nbsp;<span class="builtinfunc" id="4354593">len</span><span class="op" id="4354596">(</span><span class="ident" id="4354597">s</span><span class="op" id="4354598">)</span>&nbsp;<span class="op" id="4354600">}</span><br>
<span class="lineno"></span><span class="keyword" id="4354602">func</span>&nbsp;<span class="op" id="4354607">(</span><span class="ident" id="4354608">s</span>&nbsp;<span class="ident" id="4354610">exampleByName</span><span class="op" id="4354623">)</span>&nbsp;<span class="ident" id="4354625">Swap</span><span class="op" id="4354629">(</span><span class="ident" id="4354630">i</span><span class="op" id="4354631">,</span>&nbsp;<span class="ident" id="4354633">j</span>&nbsp;<span class="builtintype" id="4354635">int</span><span class="op" id="4354638">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354645">{</span>&nbsp;<span class="ident" id="4354647">s</span><span class="op" id="4354648">[</span><span class="ident" id="4354649">i</span><span class="op" id="4354650">]</span><span class="op" id="4354651">,</span>&nbsp;<span class="ident" id="4354653">s</span><span class="op" id="4354654">[</span><span class="ident" id="4354655">j</span><span class="op" id="4354656">]</span>&nbsp;<span class="op" id="4354658">=</span>&nbsp;<span class="ident" id="4354660">s</span><span class="op" id="4354661">[</span><span class="ident" id="4354662">j</span><span class="op" id="4354663">]</span><span class="op" id="4354664">,</span>&nbsp;<span class="ident" id="4354666">s</span><span class="op" id="4354667">[</span><span class="ident" id="4354668">i</span><span class="op" id="4354669">]</span>&nbsp;<span class="op" id="4354671">}</span><br>
<span class="lineno"></span><span class="keyword" id="4354673">func</span>&nbsp;<span class="op" id="4354678">(</span><span class="ident" id="4354679">s</span>&nbsp;<span class="ident" id="4354681">exampleByName</span><span class="op" id="4354694">)</span>&nbsp;<span class="ident" id="4354696">Less</span><span class="op" id="4354700">(</span><span class="ident" id="4354701">i</span><span class="op" id="4354702">,</span>&nbsp;<span class="ident" id="4354704">j</span>&nbsp;<span class="builtintype" id="4354706">int</span><span class="op" id="4354709">)</span>&nbsp;<span class="builtintype" id="4354711">bool</span>&nbsp;<span class="op" id="4354716">{</span>&nbsp;<span class="keyword" id="4354718">return</span>&nbsp;<span class="ident" id="4354725">s</span><span class="op" id="4354726">[</span><span class="ident" id="4354727">i</span><span class="op" id="4354728">]</span><span class="op" id="4354729">.</span><span class="ident" id="4354730">Name</span>&nbsp;<span class="op" id="4354735">&lt;</span>&nbsp;<span class="ident" id="4354737">s</span><span class="op" id="4354738">[</span><span class="ident" id="4354739">j</span><span class="op" id="4354740">]</span><span class="op" id="4354741">.</span><span class="ident" id="4354742">Name</span>&nbsp;<span class="op" id="4354747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4354750">//&nbsp;playExample&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File&nbsp;based&nbsp;on&nbsp;the&nbsp;provided</span><br>
<span class="lineno">140</span><span class="comment" id="4354815">//&nbsp;file&nbsp;with&nbsp;the&nbsp;provided&nbsp;function&nbsp;body&nbsp;as&nbsp;the&nbsp;body&nbsp;of&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="4354876">func</span>&nbsp;<span class="ident" id="4354881">playExample</span><span class="op" id="4354892">(</span><span class="ident" id="4354893">file</span>&nbsp;<span class="op" id="4354898">*</span><span class="ident" id="4354899">ast</span><span class="op" id="4354902">.</span><span class="ident" id="4354903">File</span><span class="op" id="4354907">,</span>&nbsp;<span class="ident" id="4354909">body</span>&nbsp;<span class="op" id="4354914">*</span><span class="ident" id="4354915">ast</span><span class="op" id="4354918">.</span><span class="ident" id="4354919">BlockStmt</span><span class="op" id="4354928">)</span>&nbsp;<span class="op" id="4354930">*</span><span class="ident" id="4354931">ast</span><span class="op" id="4354934">.</span><span class="ident" id="4354935">File</span>&nbsp;<span class="op" id="4354940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354943">if</span>&nbsp;<span class="op" id="4354946">!</span><span class="ident" id="4354947">strings</span><span class="op" id="4354954">.</span><span class="ident" id="4354955">HasSuffix</span><span class="op" id="4354964">(</span><span class="ident" id="4354965">file</span><span class="op" id="4354969">.</span><span class="ident" id="4354970">Name</span><span class="op" id="4354974">.</span><span class="ident" id="4354975">Name</span><span class="op" id="4354979">,</span>&nbsp;<span class="string" id="4354981">&#34;_test&#34;</span><span class="op" id="4354988">)</span>&nbsp;<span class="op" id="4354990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4354994">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4355046">//&nbsp;greater&nbsp;package&nbsp;(yet).</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355074">return</span>&nbsp;<span class="ident" id="4355081">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4355090">//&nbsp;Find&nbsp;top-level&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355135">topDecls</span>&nbsp;<span class="op" id="4355144">:=</span>&nbsp;<span class="builtinfunc" id="4355147">make</span><span class="op" id="4355151">(</span><span class="keyword" id="4355152">map</span><span class="op" id="4355155">[</span><span class="op" id="4355156">*</span><span class="ident" id="4355157">ast</span><span class="op" id="4355160">.</span><span class="ident" id="4355161">Object</span><span class="op" id="4355167">]</span><span class="builtintype" id="4355168">bool</span><span class="op" id="4355172">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355175">for</span>&nbsp;<span class="ident" id="4355179">_</span><span class="op" id="4355180">,</span>&nbsp;<span class="ident" id="4355182">decl</span>&nbsp;<span class="op" id="4355187">:=</span>&nbsp;<span class="keyword" id="4355190">range</span>&nbsp;<span class="ident" id="4355196">file</span><span class="op" id="4355200">.</span><span class="ident" id="4355201">Decls</span>&nbsp;<span class="op" id="4355207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355211">switch</span>&nbsp;<span class="ident" id="4355218">d</span>&nbsp;<span class="op" id="4355220">:=</span>&nbsp;<span class="ident" id="4355223">decl</span><span class="op" id="4355227">.</span><span class="op" id="4355228">(</span><span class="keyword" id="4355229">type</span><span class="op" id="4355233">)</span>&nbsp;<span class="op" id="4355235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355239">case</span>&nbsp;<span class="op" id="4355244">*</span><span class="ident" id="4355245">ast</span><span class="op" id="4355248">.</span><span class="ident" id="4355249">FuncDecl</span><span class="op" id="4355257">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355262">topDecls</span><span class="op" id="4355270">[</span><span class="ident" id="4355271">d</span><span class="op" id="4355272">.</span><span class="ident" id="4355273">Name</span><span class="op" id="4355277">.</span><span class="ident" id="4355278">Obj</span><span class="op" id="4355281">]</span>&nbsp;<span class="op" id="4355283">=</span>&nbsp;<span class="builtintype" id="4355285">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355292">case</span>&nbsp;<span class="op" id="4355297">*</span><span class="ident" id="4355298">ast</span><span class="op" id="4355301">.</span><span class="ident" id="4355302">GenDecl</span><span class="op" id="4355309">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355314">for</span>&nbsp;<span class="ident" id="4355318">_</span><span class="op" id="4355319">,</span>&nbsp;<span class="ident" id="4355321">spec</span>&nbsp;<span class="op" id="4355326">:=</span>&nbsp;<span class="keyword" id="4355329">range</span>&nbsp;<span class="ident" id="4355335">d</span><span class="op" id="4355336">.</span><span class="ident" id="4355337">Specs</span>&nbsp;<span class="op" id="4355343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355349">switch</span>&nbsp;<span class="ident" id="4355356">s</span>&nbsp;<span class="op" id="4355358">:=</span>&nbsp;<span class="ident" id="4355361">spec</span><span class="op" id="4355365">.</span><span class="op" id="4355366">(</span><span class="keyword" id="4355367">type</span><span class="op" id="4355371">)</span>&nbsp;<span class="op" id="4355373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355379">case</span>&nbsp;<span class="op" id="4355384">*</span><span class="ident" id="4355385">ast</span><span class="op" id="4355388">.</span><span class="ident" id="4355389">TypeSpec</span><span class="op" id="4355397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355404">topDecls</span><span class="op" id="4355412">[</span><span class="ident" id="4355413">s</span><span class="op" id="4355414">.</span><span class="ident" id="4355415">Name</span><span class="op" id="4355419">.</span><span class="ident" id="4355420">Obj</span><span class="op" id="4355423">]</span>&nbsp;<span class="op" id="4355425">=</span>&nbsp;<span class="builtintype" id="4355427">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355436">case</span>&nbsp;<span class="op" id="4355441">*</span><span class="ident" id="4355442">ast</span><span class="op" id="4355445">.</span><span class="ident" id="4355446">ValueSpec</span><span class="op" id="4355455">:</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355462">for</span>&nbsp;<span class="ident" id="4355466">_</span><span class="op" id="4355467">,</span>&nbsp;<span class="ident" id="4355469">id</span>&nbsp;<span class="op" id="4355472">:=</span>&nbsp;<span class="keyword" id="4355475">range</span>&nbsp;<span class="ident" id="4355481">s</span><span class="op" id="4355482">.</span><span class="ident" id="4355483">Names</span>&nbsp;<span class="op" id="4355489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355497">topDecls</span><span class="op" id="4355505">[</span><span class="ident" id="4355506">id</span><span class="op" id="4355508">.</span><span class="ident" id="4355509">Obj</span><span class="op" id="4355512">]</span>&nbsp;<span class="op" id="4355514">=</span>&nbsp;<span class="builtintype" id="4355516">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355537">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4355548">//&nbsp;Find&nbsp;unresolved&nbsp;identifiers&nbsp;and&nbsp;uses&nbsp;of&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355616">unresolved</span>&nbsp;<span class="op" id="4355627">:=</span>&nbsp;<span class="builtinfunc" id="4355630">make</span><span class="op" id="4355634">(</span><span class="keyword" id="4355635">map</span><span class="op" id="4355638">[</span><span class="builtintype" id="4355639">string</span><span class="op" id="4355645">]</span><span class="builtintype" id="4355646">bool</span><span class="op" id="4355650">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355653">usesTopDecl</span>&nbsp;<span class="op" id="4355665">:=</span>&nbsp;<span class="builtintype" id="4355668">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355675">var</span>&nbsp;<span class="ident" id="4355679">inspectFunc</span>&nbsp;<span class="keyword" id="4355691">func</span><span class="op" id="4355695">(</span><span class="ident" id="4355696">ast</span><span class="op" id="4355699">.</span><span class="ident" id="4355700">Node</span><span class="op" id="4355704">)</span>&nbsp;<span class="builtintype" id="4355706">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355712">inspectFunc</span>&nbsp;<span class="op" id="4355724">=</span>&nbsp;<span class="keyword" id="4355726">func</span><span class="op" id="4355730">(</span><span class="ident" id="4355731">n</span>&nbsp;<span class="ident" id="4355733">ast</span><span class="op" id="4355736">.</span><span class="ident" id="4355737">Node</span><span class="op" id="4355741">)</span>&nbsp;<span class="builtintype" id="4355743">bool</span>&nbsp;<span class="op" id="4355748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4355752">//&nbsp;For&nbsp;selector&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;left&nbsp;hand&nbsp;side.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4355816">//&nbsp;(For&nbsp;an&nbsp;expression&nbsp;like&nbsp;fmt.Println,&nbsp;only&nbsp;add&nbsp;&#34;fmt&#34;&nbsp;to&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4355880">//&nbsp;set&nbsp;of&nbsp;unresolved&nbsp;names,&nbsp;not&nbsp;&#34;Println&#34;.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355926">if</span>&nbsp;<span class="ident" id="4355929">e</span><span class="op" id="4355930">,</span>&nbsp;<span class="ident" id="4355932">ok</span>&nbsp;<span class="op" id="4355935">:=</span>&nbsp;<span class="ident" id="4355938">n</span><span class="op" id="4355939">.</span><span class="op" id="4355940">(</span><span class="op" id="4355941">*</span><span class="ident" id="4355942">ast</span><span class="op" id="4355945">.</span><span class="ident" id="4355946">SelectorExpr</span><span class="op" id="4355958">)</span><span class="op" id="4355959">;</span>&nbsp;<span class="ident" id="4355961">ok</span>&nbsp;<span class="op" id="4355964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355969">ast</span><span class="op" id="4355972">.</span><span class="ident" id="4355973">Inspect</span><span class="op" id="4355980">(</span><span class="ident" id="4355981">e</span><span class="op" id="4355982">.</span><span class="ident" id="4355983">X</span><span class="op" id="4355984">,</span>&nbsp;<span class="ident" id="4355986">inspectFunc</span><span class="op" id="4355997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356002">return</span>&nbsp;<span class="builtintype" id="4356009">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356017">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4356021">//&nbsp;For&nbsp;key&nbsp;value&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4356076">//&nbsp;as&nbsp;the&nbsp;key&nbsp;should&nbsp;be&nbsp;resolved&nbsp;by&nbsp;the&nbsp;type&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4356130">//&nbsp;composite&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356154">if</span>&nbsp;<span class="ident" id="4356157">e</span><span class="op" id="4356158">,</span>&nbsp;<span class="ident" id="4356160">ok</span>&nbsp;<span class="op" id="4356163">:=</span>&nbsp;<span class="ident" id="4356166">n</span><span class="op" id="4356167">.</span><span class="op" id="4356168">(</span><span class="op" id="4356169">*</span><span class="ident" id="4356170">ast</span><span class="op" id="4356173">.</span><span class="ident" id="4356174">KeyValueExpr</span><span class="op" id="4356186">)</span><span class="op" id="4356187">;</span>&nbsp;<span class="ident" id="4356189">ok</span>&nbsp;<span class="op" id="4356192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356197">ast</span><span class="op" id="4356200">.</span><span class="ident" id="4356201">Inspect</span><span class="op" id="4356208">(</span><span class="ident" id="4356209">e</span><span class="op" id="4356210">.</span><span class="ident" id="4356211">Value</span><span class="op" id="4356216">,</span>&nbsp;<span class="ident" id="4356218">inspectFunc</span><span class="op" id="4356229">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356234">return</span>&nbsp;<span class="builtintype" id="4356241">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356253">if</span>&nbsp;<span class="ident" id="4356256">id</span><span class="op" id="4356258">,</span>&nbsp;<span class="ident" id="4356260">ok</span>&nbsp;<span class="op" id="4356263">:=</span>&nbsp;<span class="ident" id="4356266">n</span><span class="op" id="4356267">.</span><span class="op" id="4356268">(</span><span class="op" id="4356269">*</span><span class="ident" id="4356270">ast</span><span class="op" id="4356273">.</span><span class="ident" id="4356274">Ident</span><span class="op" id="4356279">)</span><span class="op" id="4356280">;</span>&nbsp;<span class="ident" id="4356282">ok</span>&nbsp;<span class="op" id="4356285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356290">if</span>&nbsp;<span class="ident" id="4356293">id</span><span class="op" id="4356295">.</span><span class="ident" id="4356296">Obj</span>&nbsp;<span class="op" id="4356300">==</span>&nbsp;<span class="ident" id="4356303">nil</span>&nbsp;<span class="op" id="4356307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356313">unresolved</span><span class="op" id="4356323">[</span><span class="ident" id="4356324">id</span><span class="op" id="4356326">.</span><span class="ident" id="4356327">Name</span><span class="op" id="4356331">]</span>&nbsp;<span class="op" id="4356333">=</span>&nbsp;<span class="builtintype" id="4356335">true</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356343">}</span>&nbsp;<span class="keyword" id="4356345">else</span>&nbsp;<span class="keyword" id="4356350">if</span>&nbsp;<span class="ident" id="4356353">topDecls</span><span class="op" id="4356361">[</span><span class="ident" id="4356362">id</span><span class="op" id="4356364">.</span><span class="ident" id="4356365">Obj</span><span class="op" id="4356368">]</span>&nbsp;<span class="op" id="4356370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356376">usesTopDecl</span>&nbsp;<span class="op" id="4356388">=</span>&nbsp;<span class="builtintype" id="4356390">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356406">return</span>&nbsp;<span class="builtintype" id="4356413">true</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356422">ast</span><span class="op" id="4356425">.</span><span class="ident" id="4356426">Inspect</span><span class="op" id="4356433">(</span><span class="ident" id="4356434">body</span><span class="op" id="4356438">,</span>&nbsp;<span class="ident" id="4356440">inspectFunc</span><span class="op" id="4356451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356454">if</span>&nbsp;<span class="ident" id="4356457">usesTopDecl</span>&nbsp;<span class="op" id="4356469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4356473">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;not&nbsp;self-contained&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356539">return</span>&nbsp;<span class="ident" id="4356546">nil</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4356555">//&nbsp;Remove&nbsp;predeclared&nbsp;identifiers&nbsp;from&nbsp;unresolved&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356612">for</span>&nbsp;<span class="ident" id="4356616">n</span>&nbsp;<span class="op" id="4356618">:=</span>&nbsp;<span class="keyword" id="4356621">range</span>&nbsp;<span class="ident" id="4356627">unresolved</span>&nbsp;<span class="op" id="4356638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356642">if</span>&nbsp;<span class="ident" id="4356645">predeclaredTypes</span><span class="op" id="4356661">[</span><span class="ident" id="4356662">n</span><span class="op" id="4356663">]</span>&nbsp;<span class="op" id="4356665">||</span>&nbsp;<span class="ident" id="4356668">predeclaredConstants</span><span class="op" id="4356688">[</span><span class="ident" id="4356689">n</span><span class="op" id="4356690">]</span>&nbsp;<span class="op" id="4356692">||</span>&nbsp;<span class="ident" id="4356695">predeclaredFuncs</span><span class="op" id="4356711">[</span><span class="ident" id="4356712">n</span><span class="op" id="4356713">]</span>&nbsp;<span class="op" id="4356715">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4356720">delete</span><span class="op" id="4356726">(</span><span class="ident" id="4356727">unresolved</span><span class="op" id="4356737">,</span>&nbsp;<span class="ident" id="4356739">n</span><span class="op" id="4356740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4356747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4356751">//&nbsp;Use&nbsp;unresolved&nbsp;identifiers&nbsp;to&nbsp;determine&nbsp;the&nbsp;imports&nbsp;used&nbsp;by&nbsp;this</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4356820">//&nbsp;example.&nbsp;The&nbsp;heuristic&nbsp;assumes&nbsp;package&nbsp;names&nbsp;match&nbsp;base&nbsp;import</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4356887">//&nbsp;paths&nbsp;for&nbsp;imports&nbsp;w/o&nbsp;renames&nbsp;(should&nbsp;be&nbsp;good&nbsp;enough&nbsp;most&nbsp;of&nbsp;the&nbsp;time).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356963">namedImports</span>&nbsp;<span class="op" id="4356976">:=</span>&nbsp;<span class="builtinfunc" id="4356979">make</span><span class="op" id="4356983">(</span><span class="keyword" id="4356984">map</span><span class="op" id="4356987">[</span><span class="builtintype" id="4356988">string</span><span class="op" id="4356994">]</span><span class="builtintype" id="4356995">string</span><span class="op" id="4357001">)</span>&nbsp;<span class="comment" id="4357003">//&nbsp;[name]path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357018">var</span>&nbsp;<span class="ident" id="4357022">blankImports</span>&nbsp;<span class="op" id="4357035">[</span><span class="op" id="4357036">]</span><span class="ident" id="4357037">ast</span><span class="op" id="4357040">.</span><span class="ident" id="4357041">Spec</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4357058">//&nbsp;_&nbsp;imports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357072">for</span>&nbsp;<span class="ident" id="4357076">_</span><span class="op" id="4357077">,</span>&nbsp;<span class="ident" id="4357079">s</span>&nbsp;<span class="op" id="4357081">:=</span>&nbsp;<span class="keyword" id="4357084">range</span>&nbsp;<span class="ident" id="4357090">file</span><span class="op" id="4357094">.</span><span class="ident" id="4357095">Imports</span>&nbsp;<span class="op" id="4357103">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357107">p</span><span class="op" id="4357108">,</span>&nbsp;<span class="ident" id="4357110">err</span>&nbsp;<span class="op" id="4357114">:=</span>&nbsp;<span class="ident" id="4357117">strconv</span><span class="op" id="4357124">.</span><span class="ident" id="4357125">Unquote</span><span class="op" id="4357132">(</span><span class="ident" id="4357133">s</span><span class="op" id="4357134">.</span><span class="ident" id="4357135">Path</span><span class="op" id="4357139">.</span><span class="ident" id="4357140">Value</span><span class="op" id="4357145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357149">if</span>&nbsp;<span class="ident" id="4357152">err</span>&nbsp;<span class="op" id="4357156">!=</span>&nbsp;<span class="ident" id="4357159">nil</span>&nbsp;<span class="op" id="4357163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357168">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357183">n</span>&nbsp;<span class="op" id="4357185">:=</span>&nbsp;<span class="ident" id="4357188">path</span><span class="op" id="4357192">.</span><span class="ident" id="4357193">Base</span><span class="op" id="4357197">(</span><span class="ident" id="4357198">p</span><span class="op" id="4357199">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357203">if</span>&nbsp;<span class="ident" id="4357206">s</span><span class="op" id="4357207">.</span><span class="ident" id="4357208">Name</span>&nbsp;<span class="op" id="4357213">!=</span>&nbsp;<span class="ident" id="4357216">nil</span>&nbsp;<span class="op" id="4357220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357225">n</span>&nbsp;<span class="op" id="4357227">=</span>&nbsp;<span class="ident" id="4357229">s</span><span class="op" id="4357230">.</span><span class="ident" id="4357231">Name</span><span class="op" id="4357235">.</span><span class="ident" id="4357236">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357244">switch</span>&nbsp;<span class="ident" id="4357251">n</span>&nbsp;<span class="op" id="4357253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357258">case</span>&nbsp;<span class="string" id="4357263">&#34;_&#34;</span><span class="op" id="4357266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357272">blankImports</span>&nbsp;<span class="op" id="4357285">=</span>&nbsp;<span class="builtinfunc" id="4357287">append</span><span class="op" id="4357293">(</span><span class="ident" id="4357294">blankImports</span><span class="op" id="4357306">,</span>&nbsp;<span class="ident" id="4357308">s</span><span class="op" id="4357309">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357315">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357327">case</span>&nbsp;<span class="string" id="4357332">&#34;.&#34;</span><span class="op" id="4357335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4357341">//&nbsp;We&nbsp;can&#39;t&nbsp;resolve&nbsp;dot&nbsp;imports&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357384">return</span>&nbsp;<span class="ident" id="4357391">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357398">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357406">if</span>&nbsp;<span class="ident" id="4357409">unresolved</span><span class="op" id="4357419">[</span><span class="ident" id="4357420">n</span><span class="op" id="4357421">]</span>&nbsp;<span class="op" id="4357423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357428">namedImports</span><span class="op" id="4357440">[</span><span class="ident" id="4357441">n</span><span class="op" id="4357442">]</span>&nbsp;<span class="op" id="4357444">=</span>&nbsp;<span class="ident" id="4357446">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4357451">delete</span><span class="op" id="4357457">(</span><span class="ident" id="4357458">unresolved</span><span class="op" id="4357468">,</span>&nbsp;<span class="ident" id="4357470">n</span><span class="op" id="4357471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357475">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4357482">//&nbsp;If&nbsp;there&nbsp;are&nbsp;other&nbsp;unresolved&nbsp;identifiers,&nbsp;give&nbsp;up&nbsp;because&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4357550">//&nbsp;synthesized&nbsp;file&nbsp;is&nbsp;not&nbsp;going&nbsp;to&nbsp;build.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357594">if</span>&nbsp;<span class="builtinfunc" id="4357597">len</span><span class="op" id="4357600">(</span><span class="ident" id="4357601">unresolved</span><span class="op" id="4357611">)</span>&nbsp;<span class="op" id="4357613">&gt;</span>&nbsp;<span class="num" id="4357615">0</span>&nbsp;<span class="op" id="4357617">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357621">return</span>&nbsp;<span class="ident" id="4357628">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4357637">//&nbsp;Include&nbsp;documentation&nbsp;belonging&nbsp;to&nbsp;blank&nbsp;imports.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357691">var</span>&nbsp;<span class="ident" id="4357695">comments</span>&nbsp;<span class="op" id="4357704">[</span><span class="op" id="4357705">]</span><span class="op" id="4357706">*</span><span class="ident" id="4357707">ast</span><span class="op" id="4357710">.</span><span class="ident" id="4357711">CommentGroup</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357725">for</span>&nbsp;<span class="ident" id="4357729">_</span><span class="op" id="4357730">,</span>&nbsp;<span class="ident" id="4357732">s</span>&nbsp;<span class="op" id="4357734">:=</span>&nbsp;<span class="keyword" id="4357737">range</span>&nbsp;<span class="ident" id="4357743">blankImports</span>&nbsp;<span class="op" id="4357756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357760">if</span>&nbsp;<span class="ident" id="4357763">c</span>&nbsp;<span class="op" id="4357765">:=</span>&nbsp;<span class="ident" id="4357768">s</span><span class="op" id="4357769">.</span><span class="op" id="4357770">(</span><span class="op" id="4357771">*</span><span class="ident" id="4357772">ast</span><span class="op" id="4357775">.</span><span class="ident" id="4357776">ImportSpec</span><span class="op" id="4357786">)</span><span class="op" id="4357787">.</span><span class="ident" id="4357788">Doc</span><span class="op" id="4357791">;</span>&nbsp;<span class="ident" id="4357793">c</span>&nbsp;<span class="op" id="4357795">!=</span>&nbsp;<span class="ident" id="4357798">nil</span>&nbsp;<span class="op" id="4357802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357807">comments</span>&nbsp;<span class="op" id="4357816">=</span>&nbsp;<span class="builtinfunc" id="4357818">append</span><span class="op" id="4357824">(</span><span class="ident" id="4357825">comments</span><span class="op" id="4357833">,</span>&nbsp;<span class="ident" id="4357835">c</span><span class="op" id="4357836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357843">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4357847">//&nbsp;Include&nbsp;comments&nbsp;that&nbsp;are&nbsp;inside&nbsp;the&nbsp;function&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357903">for</span>&nbsp;<span class="ident" id="4357907">_</span><span class="op" id="4357908">,</span>&nbsp;<span class="ident" id="4357910">c</span>&nbsp;<span class="op" id="4357912">:=</span>&nbsp;<span class="keyword" id="4357915">range</span>&nbsp;<span class="ident" id="4357921">file</span><span class="op" id="4357925">.</span><span class="ident" id="4357926">Comments</span>&nbsp;<span class="op" id="4357935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357939">if</span>&nbsp;<span class="ident" id="4357942">body</span><span class="op" id="4357946">.</span><span class="ident" id="4357947">Pos</span><span class="op" id="4357950">(</span><span class="op" id="4357951">)</span>&nbsp;<span class="op" id="4357953">&lt;=</span>&nbsp;<span class="ident" id="4357956">c</span><span class="op" id="4357957">.</span><span class="ident" id="4357958">Pos</span><span class="op" id="4357961">(</span><span class="op" id="4357962">)</span>&nbsp;<span class="op" id="4357964">&amp;&amp;</span>&nbsp;<span class="ident" id="4357967">c</span><span class="op" id="4357968">.</span><span class="ident" id="4357969">End</span><span class="op" id="4357972">(</span><span class="op" id="4357973">)</span>&nbsp;<span class="op" id="4357975">&lt;=</span>&nbsp;<span class="ident" id="4357978">body</span><span class="op" id="4357982">.</span><span class="ident" id="4357983">End</span><span class="op" id="4357986">(</span><span class="op" id="4357987">)</span>&nbsp;<span class="op" id="4357989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357994">comments</span>&nbsp;<span class="op" id="4358003">=</span>&nbsp;<span class="builtinfunc" id="4358005">append</span><span class="op" id="4358011">(</span><span class="ident" id="4358012">comments</span><span class="op" id="4358020">,</span>&nbsp;<span class="ident" id="4358022">c</span><span class="op" id="4358023">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4358034">//&nbsp;Strip&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;and&nbsp;adjust&nbsp;body&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358092">body</span><span class="op" id="4358096">,</span>&nbsp;<span class="ident" id="4358098">comments</span>&nbsp;<span class="op" id="4358107">=</span>&nbsp;<span class="ident" id="4358109">stripOutputComment</span><span class="op" id="4358127">(</span><span class="ident" id="4358128">body</span><span class="op" id="4358132">,</span>&nbsp;<span class="ident" id="4358134">comments</span><span class="op" id="4358142">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4358146">//&nbsp;Synthesize&nbsp;import&nbsp;declaration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358181">importDecl</span>&nbsp;<span class="op" id="4358192">:=</span>&nbsp;<span class="op" id="4358195">&amp;</span><span class="ident" id="4358196">ast</span><span class="op" id="4358199">.</span><span class="ident" id="4358200">GenDecl</span><span class="op" id="4358207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358211">Tok</span><span class="op" id="4358214">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358219">token</span><span class="op" id="4358224">.</span><span class="ident" id="4358225">IMPORT</span><span class="op" id="4358231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358235">Lparen</span><span class="op" id="4358241">:</span>&nbsp;<span class="num" id="4358243">1</span><span class="op" id="4358244">,</span>&nbsp;<span class="comment" id="4358246">//&nbsp;Need&nbsp;non-zero&nbsp;Lparen&nbsp;and&nbsp;Rparen&nbsp;so&nbsp;that&nbsp;printer</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358299">Rparen</span><span class="op" id="4358305">:</span>&nbsp;<span class="num" id="4358307">1</span><span class="op" id="4358308">,</span>&nbsp;<span class="comment" id="4358310">//&nbsp;treats&nbsp;this&nbsp;as&nbsp;a&nbsp;factored&nbsp;import.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358351">for</span>&nbsp;<span class="ident" id="4358355">n</span><span class="op" id="4358356">,</span>&nbsp;<span class="ident" id="4358358">p</span>&nbsp;<span class="op" id="4358360">:=</span>&nbsp;<span class="keyword" id="4358363">range</span>&nbsp;<span class="ident" id="4358369">namedImports</span>&nbsp;<span class="op" id="4358382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358386">s</span>&nbsp;<span class="op" id="4358388">:=</span>&nbsp;<span class="op" id="4358391">&amp;</span><span class="ident" id="4358392">ast</span><span class="op" id="4358395">.</span><span class="ident" id="4358396">ImportSpec</span><span class="op" id="4358406">{</span><span class="ident" id="4358407">Path</span><span class="op" id="4358411">:</span>&nbsp;<span class="op" id="4358413">&amp;</span><span class="ident" id="4358414">ast</span><span class="op" id="4358417">.</span><span class="ident" id="4358418">BasicLit</span><span class="op" id="4358426">{</span><span class="ident" id="4358427">Value</span><span class="op" id="4358432">:</span>&nbsp;<span class="ident" id="4358434">strconv</span><span class="op" id="4358441">.</span><span class="ident" id="4358442">Quote</span><span class="op" id="4358447">(</span><span class="ident" id="4358448">p</span><span class="op" id="4358449">)</span><span class="op" id="4358450">}</span><span class="op" id="4358451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358455">if</span>&nbsp;<span class="ident" id="4358458">path</span><span class="op" id="4358462">.</span><span class="ident" id="4358463">Base</span><span class="op" id="4358467">(</span><span class="ident" id="4358468">p</span><span class="op" id="4358469">)</span>&nbsp;<span class="op" id="4358471">!=</span>&nbsp;<span class="ident" id="4358474">n</span>&nbsp;<span class="op" id="4358476">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358481">s</span><span class="op" id="4358482">.</span><span class="ident" id="4358483">Name</span>&nbsp;<span class="op" id="4358488">=</span>&nbsp;<span class="ident" id="4358490">ast</span><span class="op" id="4358493">.</span><span class="ident" id="4358494">NewIdent</span><span class="op" id="4358502">(</span><span class="ident" id="4358503">n</span><span class="op" id="4358504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358512">importDecl</span><span class="op" id="4358522">.</span><span class="ident" id="4358523">Specs</span>&nbsp;<span class="op" id="4358529">=</span>&nbsp;<span class="builtinfunc" id="4358531">append</span><span class="op" id="4358537">(</span><span class="ident" id="4358538">importDecl</span><span class="op" id="4358548">.</span><span class="ident" id="4358549">Specs</span><span class="op" id="4358554">,</span>&nbsp;<span class="ident" id="4358556">s</span><span class="op" id="4358557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358563">importDecl</span><span class="op" id="4358573">.</span><span class="ident" id="4358574">Specs</span>&nbsp;<span class="op" id="4358580">=</span>&nbsp;<span class="builtinfunc" id="4358582">append</span><span class="op" id="4358588">(</span><span class="ident" id="4358589">importDecl</span><span class="op" id="4358599">.</span><span class="ident" id="4358600">Specs</span><span class="op" id="4358605">,</span>&nbsp;<span class="ident" id="4358607">blankImports</span><span class="op" id="4358619">...</span><span class="op" id="4358622">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4358626">//&nbsp;Synthesize&nbsp;main&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358656">funcDecl</span>&nbsp;<span class="op" id="4358665">:=</span>&nbsp;<span class="op" id="4358668">&amp;</span><span class="ident" id="4358669">ast</span><span class="op" id="4358672">.</span><span class="ident" id="4358673">FuncDecl</span><span class="op" id="4358681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358685">Name</span><span class="op" id="4358689">:</span>&nbsp;<span class="ident" id="4358691">ast</span><span class="op" id="4358694">.</span><span class="ident" id="4358695">NewIdent</span><span class="op" id="4358703">(</span><span class="string" id="4358704">&#34;main&#34;</span><span class="op" id="4358710">)</span><span class="op" id="4358711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358715">Type</span><span class="op" id="4358719">:</span>&nbsp;<span class="op" id="4358721">&amp;</span><span class="ident" id="4358722">ast</span><span class="op" id="4358725">.</span><span class="ident" id="4358726">FuncType</span><span class="op" id="4358734">{</span><span class="ident" id="4358735">Params</span><span class="op" id="4358741">:</span>&nbsp;<span class="op" id="4358743">&amp;</span><span class="ident" id="4358744">ast</span><span class="op" id="4358747">.</span><span class="ident" id="4358748">FieldList</span><span class="op" id="4358757">{</span><span class="op" id="4358758">}</span><span class="op" id="4358759">}</span><span class="op" id="4358760">,</span>&nbsp;<span class="comment" id="4358762">//&nbsp;FuncType.Params&nbsp;must&nbsp;be&nbsp;non-nil</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358799">Body</span><span class="op" id="4358803">:</span>&nbsp;<span class="ident" id="4358805">body</span><span class="op" id="4358809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4358816">//&nbsp;Synthesize&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358837">return</span>&nbsp;<span class="op" id="4358844">&amp;</span><span class="ident" id="4358845">ast</span><span class="op" id="4358848">.</span><span class="ident" id="4358849">File</span><span class="op" id="4358853">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358857">Name</span><span class="op" id="4358861">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358867">ast</span><span class="op" id="4358870">.</span><span class="ident" id="4358871">NewIdent</span><span class="op" id="4358879">(</span><span class="string" id="4358880">&#34;main&#34;</span><span class="op" id="4358886">)</span><span class="op" id="4358887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358891">Decls</span><span class="op" id="4358896">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358901">[</span><span class="op" id="4358902">]</span><span class="ident" id="4358903">ast</span><span class="op" id="4358906">.</span><span class="ident" id="4358907">Decl</span><span class="op" id="4358911">{</span><span class="ident" id="4358912">importDecl</span><span class="op" id="4358922">,</span>&nbsp;<span class="ident" id="4358924">funcDecl</span><span class="op" id="4358932">}</span><span class="op" id="4358933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358937">Comments</span><span class="op" id="4358945">:</span>&nbsp;<span class="ident" id="4358947">comments</span><span class="op" id="4358955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358958">}</span><br>
<span class="lineno"></span><span class="op" id="4358960">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="4358963">//&nbsp;playExampleFile&nbsp;takes&nbsp;a&nbsp;whole&nbsp;file&nbsp;example&nbsp;and&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File</span><br>
<span class="lineno"></span><span class="comment" id="4359041">//&nbsp;such&nbsp;that&nbsp;the&nbsp;example&nbsp;is&nbsp;function&nbsp;main&nbsp;in&nbsp;package&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="4359100">func</span>&nbsp;<span class="ident" id="4359105">playExampleFile</span><span class="op" id="4359120">(</span><span class="ident" id="4359121">file</span>&nbsp;<span class="op" id="4359126">*</span><span class="ident" id="4359127">ast</span><span class="op" id="4359130">.</span><span class="ident" id="4359131">File</span><span class="op" id="4359135">)</span>&nbsp;<span class="op" id="4359137">*</span><span class="ident" id="4359138">ast</span><span class="op" id="4359141">.</span><span class="ident" id="4359142">File</span>&nbsp;<span class="op" id="4359147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359150">//&nbsp;Strip&nbsp;copyright&nbsp;comment&nbsp;if&nbsp;present.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359190">comments</span>&nbsp;<span class="op" id="4359199">:=</span>&nbsp;<span class="ident" id="4359202">file</span><span class="op" id="4359206">.</span><span class="ident" id="4359207">Comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359217">if</span>&nbsp;<span class="builtinfunc" id="4359220">len</span><span class="op" id="4359223">(</span><span class="ident" id="4359224">comments</span><span class="op" id="4359232">)</span>&nbsp;<span class="op" id="4359234">&gt;</span>&nbsp;<span class="num" id="4359236">0</span>&nbsp;<span class="op" id="4359238">&amp;&amp;</span>&nbsp;<span class="ident" id="4359241">strings</span><span class="op" id="4359248">.</span><span class="ident" id="4359249">HasPrefix</span><span class="op" id="4359258">(</span><span class="ident" id="4359259">comments</span><span class="op" id="4359267">[</span><span class="num" id="4359268">0</span><span class="op" id="4359269">]</span><span class="op" id="4359270">.</span><span class="ident" id="4359271">Text</span><span class="op" id="4359275">(</span><span class="op" id="4359276">)</span><span class="op" id="4359277">,</span>&nbsp;<span class="string" id="4359279">&#34;Copyright&#34;</span><span class="op" id="4359290">)</span>&nbsp;<span class="op" id="4359292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359296">comments</span>&nbsp;<span class="op" id="4359305">=</span>&nbsp;<span class="ident" id="4359307">comments</span><span class="op" id="4359315">[</span><span class="num" id="4359316">1</span><span class="op" id="4359317">:</span><span class="op" id="4359318">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359325">//&nbsp;Copy&nbsp;declaration&nbsp;slice,&nbsp;rewriting&nbsp;the&nbsp;ExampleX&nbsp;function&nbsp;to&nbsp;main.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359394">var</span>&nbsp;<span class="ident" id="4359398">decls</span>&nbsp;<span class="op" id="4359404">[</span><span class="op" id="4359405">]</span><span class="ident" id="4359406">ast</span><span class="op" id="4359409">.</span><span class="ident" id="4359410">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359416">for</span>&nbsp;<span class="ident" id="4359420">_</span><span class="op" id="4359421">,</span>&nbsp;<span class="ident" id="4359423">d</span>&nbsp;<span class="op" id="4359425">:=</span>&nbsp;<span class="keyword" id="4359428">range</span>&nbsp;<span class="ident" id="4359434">file</span><span class="op" id="4359438">.</span><span class="ident" id="4359439">Decls</span>&nbsp;<span class="op" id="4359445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359449">if</span>&nbsp;<span class="ident" id="4359452">f</span><span class="op" id="4359453">,</span>&nbsp;<span class="ident" id="4359455">ok</span>&nbsp;<span class="op" id="4359458">:=</span>&nbsp;<span class="ident" id="4359461">d</span><span class="op" id="4359462">.</span><span class="op" id="4359463">(</span><span class="op" id="4359464">*</span><span class="ident" id="4359465">ast</span><span class="op" id="4359468">.</span><span class="ident" id="4359469">FuncDecl</span><span class="op" id="4359477">)</span><span class="op" id="4359478">;</span>&nbsp;<span class="ident" id="4359480">ok</span>&nbsp;<span class="op" id="4359483">&amp;&amp;</span>&nbsp;<span class="ident" id="4359486">isTest</span><span class="op" id="4359492">(</span><span class="ident" id="4359493">f</span><span class="op" id="4359494">.</span><span class="ident" id="4359495">Name</span><span class="op" id="4359499">.</span><span class="ident" id="4359500">Name</span><span class="op" id="4359504">,</span>&nbsp;<span class="string" id="4359506">&#34;Example&#34;</span><span class="op" id="4359515">)</span>&nbsp;<span class="op" id="4359517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359522">//&nbsp;Copy&nbsp;the&nbsp;FuncDecl,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359576">newF</span>&nbsp;<span class="op" id="4359581">:=</span>&nbsp;<span class="op" id="4359584">*</span><span class="ident" id="4359585">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359590">newF</span><span class="op" id="4359594">.</span><span class="ident" id="4359595">Name</span>&nbsp;<span class="op" id="4359600">=</span>&nbsp;<span class="ident" id="4359602">ast</span><span class="op" id="4359605">.</span><span class="ident" id="4359606">NewIdent</span><span class="op" id="4359614">(</span><span class="string" id="4359615">&#34;main&#34;</span><span class="op" id="4359621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359626">newF</span><span class="op" id="4359630">.</span><span class="ident" id="4359631">Body</span><span class="op" id="4359635">,</span>&nbsp;<span class="ident" id="4359637">comments</span>&nbsp;<span class="op" id="4359646">=</span>&nbsp;<span class="ident" id="4359648">stripOutputComment</span><span class="op" id="4359666">(</span><span class="ident" id="4359667">f</span><span class="op" id="4359668">.</span><span class="ident" id="4359669">Body</span><span class="op" id="4359673">,</span>&nbsp;<span class="ident" id="4359675">comments</span><span class="op" id="4359683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359688">d</span>&nbsp;<span class="op" id="4359690">=</span>&nbsp;<span class="op" id="4359692">&amp;</span><span class="ident" id="4359693">newF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359700">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359704">decls</span>&nbsp;<span class="op" id="4359710">=</span>&nbsp;<span class="builtinfunc" id="4359712">append</span><span class="op" id="4359718">(</span><span class="ident" id="4359719">decls</span><span class="op" id="4359724">,</span>&nbsp;<span class="ident" id="4359726">d</span><span class="op" id="4359727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359734">//&nbsp;Copy&nbsp;the&nbsp;File,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359782">f</span>&nbsp;<span class="op" id="4359784">:=</span>&nbsp;<span class="op" id="4359787">*</span><span class="ident" id="4359788">file</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359794">f</span><span class="op" id="4359795">.</span><span class="ident" id="4359796">Name</span>&nbsp;<span class="op" id="4359801">=</span>&nbsp;<span class="ident" id="4359803">ast</span><span class="op" id="4359806">.</span><span class="ident" id="4359807">NewIdent</span><span class="op" id="4359815">(</span><span class="string" id="4359816">&#34;main&#34;</span><span class="op" id="4359822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359825">f</span><span class="op" id="4359826">.</span><span class="ident" id="4359827">Decls</span>&nbsp;<span class="op" id="4359833">=</span>&nbsp;<span class="ident" id="4359835">decls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359842">f</span><span class="op" id="4359843">.</span><span class="ident" id="4359844">Comments</span>&nbsp;<span class="op" id="4359853">=</span>&nbsp;<span class="ident" id="4359855">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359865">return</span>&nbsp;<span class="op" id="4359872">&amp;</span><span class="ident" id="4359873">f</span><br>
<span class="lineno"></span><span class="op" id="4359875">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="4359878">//&nbsp;stripOutputComment&nbsp;finds&nbsp;and&nbsp;removes&nbsp;an&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;from&nbsp;body</span><br>
<span class="lineno"></span><span class="comment" id="4359949">//&nbsp;and&nbsp;comments,&nbsp;and&nbsp;adjusts&nbsp;the&nbsp;body&nbsp;block&#39;s&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="4360009">func</span>&nbsp;<span class="ident" id="4360014">stripOutputComment</span><span class="op" id="4360032">(</span><span class="ident" id="4360033">body</span>&nbsp;<span class="op" id="4360038">*</span><span class="ident" id="4360039">ast</span><span class="op" id="4360042">.</span><span class="ident" id="4360043">BlockStmt</span><span class="op" id="4360052">,</span>&nbsp;<span class="ident" id="4360054">comments</span>&nbsp;<span class="op" id="4360063">[</span><span class="op" id="4360064">]</span><span class="op" id="4360065">*</span><span class="ident" id="4360066">ast</span><span class="op" id="4360069">.</span><span class="ident" id="4360070">CommentGroup</span><span class="op" id="4360082">)</span>&nbsp;<span class="op" id="4360084">(</span><span class="op" id="4360085">*</span><span class="ident" id="4360086">ast</span><span class="op" id="4360089">.</span><span class="ident" id="4360090">BlockStmt</span><span class="op" id="4360099">,</span>&nbsp;<span class="op" id="4360101">[</span><span class="op" id="4360102">]</span><span class="op" id="4360103">*</span><span class="ident" id="4360104">ast</span><span class="op" id="4360107">.</span><span class="ident" id="4360108">CommentGroup</span><span class="op" id="4360120">)</span>&nbsp;<span class="op" id="4360122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4360125">//&nbsp;Do&nbsp;nothing&nbsp;if&nbsp;no&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;found.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360171">i</span><span class="op" id="4360172">,</span>&nbsp;<span class="ident" id="4360174">last</span>&nbsp;<span class="op" id="4360179">:=</span>&nbsp;<span class="ident" id="4360182">lastComment</span><span class="op" id="4360193">(</span><span class="ident" id="4360194">body</span><span class="op" id="4360198">,</span>&nbsp;<span class="ident" id="4360200">comments</span><span class="op" id="4360208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360211">if</span>&nbsp;<span class="ident" id="4360214">last</span>&nbsp;<span class="op" id="4360219">==</span>&nbsp;<span class="ident" id="4360222">nil</span>&nbsp;<span class="op" id="4360226">||</span>&nbsp;<span class="op" id="4360229">!</span><span class="ident" id="4360230">outputPrefix</span><span class="op" id="4360242">.</span><span class="ident" id="4360243">MatchString</span><span class="op" id="4360254">(</span><span class="ident" id="4360255">last</span><span class="op" id="4360259">.</span><span class="ident" id="4360260">Text</span><span class="op" id="4360264">(</span><span class="op" id="4360265">)</span><span class="op" id="4360266">)</span>&nbsp;<span class="op" id="4360268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360272">return</span>&nbsp;<span class="ident" id="4360279">body</span><span class="op" id="4360283">,</span>&nbsp;<span class="ident" id="4360285">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4360299">//&nbsp;Copy&nbsp;body&nbsp;and&nbsp;comments,&nbsp;as&nbsp;the&nbsp;originals&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360367">newBody</span>&nbsp;<span class="op" id="4360375">:=</span>&nbsp;<span class="op" id="4360378">&amp;</span><span class="ident" id="4360379">ast</span><span class="op" id="4360382">.</span><span class="ident" id="4360383">BlockStmt</span><span class="op" id="4360392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360396">Lbrace</span><span class="op" id="4360402">:</span>&nbsp;<span class="ident" id="4360404">body</span><span class="op" id="4360408">.</span><span class="ident" id="4360409">Lbrace</span><span class="op" id="4360415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360419">List</span><span class="op" id="4360423">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4360427">body</span><span class="op" id="4360431">.</span><span class="ident" id="4360432">List</span><span class="op" id="4360436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360440">Rbrace</span><span class="op" id="4360446">:</span>&nbsp;<span class="ident" id="4360448">last</span><span class="op" id="4360452">.</span><span class="ident" id="4360453">Pos</span><span class="op" id="4360456">(</span><span class="op" id="4360457">)</span><span class="op" id="4360458">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360464">newComments</span>&nbsp;<span class="op" id="4360476">:=</span>&nbsp;<span class="builtinfunc" id="4360479">make</span><span class="op" id="4360483">(</span><span class="op" id="4360484">[</span><span class="op" id="4360485">]</span><span class="op" id="4360486">*</span><span class="ident" id="4360487">ast</span><span class="op" id="4360490">.</span><span class="ident" id="4360491">CommentGroup</span><span class="op" id="4360503">,</span>&nbsp;<span class="builtinfunc" id="4360505">len</span><span class="op" id="4360508">(</span><span class="ident" id="4360509">comments</span><span class="op" id="4360517">)</span><span class="op" id="4360518">-</span><span class="num" id="4360519">1</span><span class="op" id="4360520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4360523">copy</span><span class="op" id="4360527">(</span><span class="ident" id="4360528">newComments</span><span class="op" id="4360539">,</span>&nbsp;<span class="ident" id="4360541">comments</span><span class="op" id="4360549">[</span><span class="op" id="4360550">:</span><span class="ident" id="4360551">i</span><span class="op" id="4360552">]</span><span class="op" id="4360553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4360556">copy</span><span class="op" id="4360560">(</span><span class="ident" id="4360561">newComments</span><span class="op" id="4360572">[</span><span class="ident" id="4360573">i</span><span class="op" id="4360574">:</span><span class="op" id="4360575">]</span><span class="op" id="4360576">,</span>&nbsp;<span class="ident" id="4360578">comments</span><span class="op" id="4360586">[</span><span class="ident" id="4360587">i</span><span class="op" id="4360588">+</span><span class="num" id="4360589">1</span><span class="op" id="4360590">:</span><span class="op" id="4360591">]</span><span class="op" id="4360592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360595">return</span>&nbsp;<span class="ident" id="4360602">newBody</span><span class="op" id="4360609">,</span>&nbsp;<span class="ident" id="4360611">newComments</span><br>
<span class="lineno">340</span><span class="op" id="4360623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4360626">//&nbsp;lastComment&nbsp;returns&nbsp;the&nbsp;last&nbsp;comment&nbsp;inside&nbsp;the&nbsp;provided&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="4360693">func</span>&nbsp;<span class="ident" id="4360698">lastComment</span><span class="op" id="4360709">(</span><span class="ident" id="4360710">b</span>&nbsp;<span class="op" id="4360712">*</span><span class="ident" id="4360713">ast</span><span class="op" id="4360716">.</span><span class="ident" id="4360717">BlockStmt</span><span class="op" id="4360726">,</span>&nbsp;<span class="ident" id="4360728">c</span>&nbsp;<span class="op" id="4360730">[</span><span class="op" id="4360731">]</span><span class="op" id="4360732">*</span><span class="ident" id="4360733">ast</span><span class="op" id="4360736">.</span><span class="ident" id="4360737">CommentGroup</span><span class="op" id="4360749">)</span>&nbsp;<span class="op" id="4360751">(</span><span class="ident" id="4360752">i</span>&nbsp;<span class="builtintype" id="4360754">int</span><span class="op" id="4360757">,</span>&nbsp;<span class="ident" id="4360759">last</span>&nbsp;<span class="op" id="4360764">*</span><span class="ident" id="4360765">ast</span><span class="op" id="4360768">.</span><span class="ident" id="4360769">CommentGroup</span><span class="op" id="4360781">)</span>&nbsp;<span class="op" id="4360783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360786">pos</span><span class="op" id="4360789">,</span>&nbsp;<span class="ident" id="4360791">end</span>&nbsp;<span class="op" id="4360795">:=</span>&nbsp;<span class="ident" id="4360798">b</span><span class="op" id="4360799">.</span><span class="ident" id="4360800">Pos</span><span class="op" id="4360803">(</span><span class="op" id="4360804">)</span><span class="op" id="4360805">,</span>&nbsp;<span class="ident" id="4360807">b</span><span class="op" id="4360808">.</span><span class="ident" id="4360809">End</span><span class="op" id="4360812">(</span><span class="op" id="4360813">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360816">for</span>&nbsp;<span class="ident" id="4360820">j</span><span class="op" id="4360821">,</span>&nbsp;<span class="ident" id="4360823">cg</span>&nbsp;<span class="op" id="4360826">:=</span>&nbsp;<span class="keyword" id="4360829">range</span>&nbsp;<span class="ident" id="4360835">c</span>&nbsp;<span class="op" id="4360837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360841">if</span>&nbsp;<span class="ident" id="4360844">cg</span><span class="op" id="4360846">.</span><span class="ident" id="4360847">Pos</span><span class="op" id="4360850">(</span><span class="op" id="4360851">)</span>&nbsp;<span class="op" id="4360853">&lt;</span>&nbsp;<span class="ident" id="4360855">pos</span>&nbsp;<span class="op" id="4360859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360864">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360879">if</span>&nbsp;<span class="ident" id="4360882">cg</span><span class="op" id="4360884">.</span><span class="ident" id="4360885">End</span><span class="op" id="4360888">(</span><span class="op" id="4360889">)</span>&nbsp;<span class="op" id="4360891">&gt;</span>&nbsp;<span class="ident" id="4360893">end</span>&nbsp;<span class="op" id="4360897">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360902">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360914">i</span><span class="op" id="4360915">,</span>&nbsp;<span class="ident" id="4360917">last</span>&nbsp;<span class="op" id="4360922">=</span>&nbsp;<span class="ident" id="4360924">j</span><span class="op" id="4360925">,</span>&nbsp;<span class="ident" id="4360927">cg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360934">return</span><br>
<span class="lineno">355</span><span class="op" id="4360941">}</span>
</div>
</body>
</html>
