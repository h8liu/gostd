<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1343930">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1343986">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1344040">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1344091">package</span>&nbsp;<span class="ident" id="1344099">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1344109">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="1344184">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="1344202">//</span><br>
<span class="lineno">10</span><span class="comment" id="1344205">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1344285">import</span>&nbsp;<span class="op" id="1344292">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1344295">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="1344306">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="1344309">var</span>&nbsp;<span class="ident" id="1344313">p224</span>&nbsp;<span class="ident" id="1344318">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1344329">type</span>&nbsp;<span class="ident" id="1344334">p224Curve</span>&nbsp;<span class="keyword" id="1344344">struct</span>&nbsp;<span class="op" id="1344351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1344354">*</span><span class="ident" id="1344355">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344368">gx</span><span class="op" id="1344370">,</span>&nbsp;<span class="ident" id="1344372">gy</span><span class="op" id="1344374">,</span>&nbsp;<span class="ident" id="1344376">b</span>&nbsp;<span class="ident" id="1344378">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="1344395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1344398">func</span>&nbsp;<span class="ident" id="1344403">initP224</span><span class="op" id="1344411">(</span><span class="op" id="1344412">)</span>&nbsp;<span class="op" id="1344414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1344417">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344451">p224</span><span class="op" id="1344455">.</span><span class="ident" id="1344456">CurveParams</span>&nbsp;<span class="op" id="1344468">=</span>&nbsp;<span class="builtinfunc" id="1344470">new</span><span class="op" id="1344473">(</span><span class="ident" id="1344474">CurveParams</span><span class="op" id="1344485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344488">p224</span><span class="op" id="1344492">.</span><span class="ident" id="1344493">P</span><span class="op" id="1344494">,</span>&nbsp;<span class="ident" id="1344496">_</span>&nbsp;<span class="op" id="1344498">=</span>&nbsp;<span class="builtinfunc" id="1344500">new</span><span class="op" id="1344503">(</span><span class="ident" id="1344504">big</span><span class="op" id="1344507">.</span><span class="ident" id="1344508">Int</span><span class="op" id="1344511">)</span><span class="op" id="1344512">.</span><span class="ident" id="1344513">SetString</span><span class="op" id="1344522">(</span><span class="string" id="1344523">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="1344593">,</span>&nbsp;<span class="num" id="1344595">10</span><span class="op" id="1344597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344600">p224</span><span class="op" id="1344604">.</span><span class="ident" id="1344605">N</span><span class="op" id="1344606">,</span>&nbsp;<span class="ident" id="1344608">_</span>&nbsp;<span class="op" id="1344610">=</span>&nbsp;<span class="builtinfunc" id="1344612">new</span><span class="op" id="1344615">(</span><span class="ident" id="1344616">big</span><span class="op" id="1344619">.</span><span class="ident" id="1344620">Int</span><span class="op" id="1344623">)</span><span class="op" id="1344624">.</span><span class="ident" id="1344625">SetString</span><span class="op" id="1344634">(</span><span class="string" id="1344635">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="1344705">,</span>&nbsp;<span class="num" id="1344707">10</span><span class="op" id="1344709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344712">p224</span><span class="op" id="1344716">.</span><span class="ident" id="1344717">B</span><span class="op" id="1344718">,</span>&nbsp;<span class="ident" id="1344720">_</span>&nbsp;<span class="op" id="1344722">=</span>&nbsp;<span class="builtinfunc" id="1344724">new</span><span class="op" id="1344727">(</span><span class="ident" id="1344728">big</span><span class="op" id="1344731">.</span><span class="ident" id="1344732">Int</span><span class="op" id="1344735">)</span><span class="op" id="1344736">.</span><span class="ident" id="1344737">SetString</span><span class="op" id="1344746">(</span><span class="string" id="1344747">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="1344805">,</span>&nbsp;<span class="num" id="1344807">16</span><span class="op" id="1344809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344812">p224</span><span class="op" id="1344816">.</span><span class="ident" id="1344817">Gx</span><span class="op" id="1344819">,</span>&nbsp;<span class="ident" id="1344821">_</span>&nbsp;<span class="op" id="1344823">=</span>&nbsp;<span class="builtinfunc" id="1344825">new</span><span class="op" id="1344828">(</span><span class="ident" id="1344829">big</span><span class="op" id="1344832">.</span><span class="ident" id="1344833">Int</span><span class="op" id="1344836">)</span><span class="op" id="1344837">.</span><span class="ident" id="1344838">SetString</span><span class="op" id="1344847">(</span><span class="string" id="1344848">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="1344906">,</span>&nbsp;<span class="num" id="1344908">16</span><span class="op" id="1344910">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344913">p224</span><span class="op" id="1344917">.</span><span class="ident" id="1344918">Gy</span><span class="op" id="1344920">,</span>&nbsp;<span class="ident" id="1344922">_</span>&nbsp;<span class="op" id="1344924">=</span>&nbsp;<span class="builtinfunc" id="1344926">new</span><span class="op" id="1344929">(</span><span class="ident" id="1344930">big</span><span class="op" id="1344933">.</span><span class="ident" id="1344934">Int</span><span class="op" id="1344937">)</span><span class="op" id="1344938">.</span><span class="ident" id="1344939">SetString</span><span class="op" id="1344948">(</span><span class="string" id="1344949">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="1345007">,</span>&nbsp;<span class="num" id="1345009">16</span><span class="op" id="1345011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345014">p224</span><span class="op" id="1345018">.</span><span class="ident" id="1345019">BitSize</span>&nbsp;<span class="op" id="1345027">=</span>&nbsp;<span class="num" id="1345029">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345035">p224FromBig</span><span class="op" id="1345046">(</span><span class="op" id="1345047">&amp;</span><span class="ident" id="1345048">p224</span><span class="op" id="1345052">.</span><span class="ident" id="1345053">gx</span><span class="op" id="1345055">,</span>&nbsp;<span class="ident" id="1345057">p224</span><span class="op" id="1345061">.</span><span class="ident" id="1345062">Gx</span><span class="op" id="1345064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345067">p224FromBig</span><span class="op" id="1345078">(</span><span class="op" id="1345079">&amp;</span><span class="ident" id="1345080">p224</span><span class="op" id="1345084">.</span><span class="ident" id="1345085">gy</span><span class="op" id="1345087">,</span>&nbsp;<span class="ident" id="1345089">p224</span><span class="op" id="1345093">.</span><span class="ident" id="1345094">Gy</span><span class="op" id="1345096">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345099">p224FromBig</span><span class="op" id="1345110">(</span><span class="op" id="1345111">&amp;</span><span class="ident" id="1345112">p224</span><span class="op" id="1345116">.</span><span class="ident" id="1345117">b</span><span class="op" id="1345118">,</span>&nbsp;<span class="ident" id="1345120">p224</span><span class="op" id="1345124">.</span><span class="ident" id="1345125">B</span><span class="op" id="1345126">)</span><br>
<span class="lineno"></span><span class="op" id="1345128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1345131">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="1345210">func</span>&nbsp;<span class="ident" id="1345215">P224</span><span class="op" id="1345219">(</span><span class="op" id="1345220">)</span>&nbsp;<span class="ident" id="1345222">Curve</span>&nbsp;<span class="op" id="1345228">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345231">initonce</span><span class="op" id="1345239">.</span><span class="ident" id="1345240">Do</span><span class="op" id="1345242">(</span><span class="ident" id="1345243">initAll</span><span class="op" id="1345250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345253">return</span>&nbsp;<span class="ident" id="1345260">p224</span><br>
<span class="lineno"></span><span class="op" id="1345265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1345268">func</span>&nbsp;<span class="op" id="1345273">(</span><span class="ident" id="1345274">curve</span>&nbsp;<span class="ident" id="1345280">p224Curve</span><span class="op" id="1345289">)</span>&nbsp;<span class="ident" id="1345291">Params</span><span class="op" id="1345297">(</span><span class="op" id="1345298">)</span>&nbsp;<span class="op" id="1345300">*</span><span class="ident" id="1345301">CurveParams</span>&nbsp;<span class="op" id="1345313">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345316">return</span>&nbsp;<span class="ident" id="1345323">curve</span><span class="op" id="1345328">.</span><span class="ident" id="1345329">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="1345341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1345344">func</span>&nbsp;<span class="op" id="1345349">(</span><span class="ident" id="1345350">curve</span>&nbsp;<span class="ident" id="1345356">p224Curve</span><span class="op" id="1345365">)</span>&nbsp;<span class="ident" id="1345367">IsOnCurve</span><span class="op" id="1345376">(</span><span class="ident" id="1345377">bigX</span><span class="op" id="1345381">,</span>&nbsp;<span class="ident" id="1345383">bigY</span>&nbsp;<span class="op" id="1345388">*</span><span class="ident" id="1345389">big</span><span class="op" id="1345392">.</span><span class="ident" id="1345393">Int</span><span class="op" id="1345396">)</span>&nbsp;<span class="builtintype" id="1345398">bool</span>&nbsp;<span class="op" id="1345403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345406">var</span>&nbsp;<span class="ident" id="1345410">x</span><span class="op" id="1345411">,</span>&nbsp;<span class="ident" id="1345413">y</span>&nbsp;<span class="ident" id="1345415">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345433">p224FromBig</span><span class="op" id="1345444">(</span><span class="op" id="1345445">&amp;</span><span class="ident" id="1345446">x</span><span class="op" id="1345447">,</span>&nbsp;<span class="ident" id="1345449">bigX</span><span class="op" id="1345453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345456">p224FromBig</span><span class="op" id="1345467">(</span><span class="op" id="1345468">&amp;</span><span class="ident" id="1345469">y</span><span class="op" id="1345470">,</span>&nbsp;<span class="ident" id="1345472">bigY</span><span class="op" id="1345476">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1345480">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345503">var</span>&nbsp;<span class="ident" id="1345507">tmp</span>&nbsp;<span class="ident" id="1345511">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345534">var</span>&nbsp;<span class="ident" id="1345538">x3</span>&nbsp;<span class="ident" id="1345541">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345559">p224Square</span><span class="op" id="1345569">(</span><span class="op" id="1345570">&amp;</span><span class="ident" id="1345571">x3</span><span class="op" id="1345573">,</span>&nbsp;<span class="op" id="1345575">&amp;</span><span class="ident" id="1345576">x</span><span class="op" id="1345577">,</span>&nbsp;<span class="op" id="1345579">&amp;</span><span class="ident" id="1345580">tmp</span><span class="op" id="1345583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345586">p224Mul</span><span class="op" id="1345593">(</span><span class="op" id="1345594">&amp;</span><span class="ident" id="1345595">x3</span><span class="op" id="1345597">,</span>&nbsp;<span class="op" id="1345599">&amp;</span><span class="ident" id="1345600">x3</span><span class="op" id="1345602">,</span>&nbsp;<span class="op" id="1345604">&amp;</span><span class="ident" id="1345605">x</span><span class="op" id="1345606">,</span>&nbsp;<span class="op" id="1345608">&amp;</span><span class="ident" id="1345609">tmp</span><span class="op" id="1345612">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345616">for</span>&nbsp;<span class="ident" id="1345620">i</span>&nbsp;<span class="op" id="1345622">:=</span>&nbsp;<span class="num" id="1345625">0</span><span class="op" id="1345626">;</span>&nbsp;<span class="ident" id="1345628">i</span>&nbsp;<span class="op" id="1345630">&lt;</span>&nbsp;<span class="num" id="1345632">8</span><span class="op" id="1345633">;</span>&nbsp;<span class="ident" id="1345635">i</span><span class="op" id="1345636">++</span>&nbsp;<span class="op" id="1345639">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345643">x</span><span class="op" id="1345644">[</span><span class="ident" id="1345645">i</span><span class="op" id="1345646">]</span>&nbsp;<span class="op" id="1345648">*=</span>&nbsp;<span class="num" id="1345651">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1345654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345657">p224Sub</span><span class="op" id="1345664">(</span><span class="op" id="1345665">&amp;</span><span class="ident" id="1345666">x3</span><span class="op" id="1345668">,</span>&nbsp;<span class="op" id="1345670">&amp;</span><span class="ident" id="1345671">x3</span><span class="op" id="1345673">,</span>&nbsp;<span class="op" id="1345675">&amp;</span><span class="ident" id="1345676">x</span><span class="op" id="1345677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345680">p224Reduce</span><span class="op" id="1345690">(</span><span class="op" id="1345691">&amp;</span><span class="ident" id="1345692">x3</span><span class="op" id="1345694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345697">p224Add</span><span class="op" id="1345704">(</span><span class="op" id="1345705">&amp;</span><span class="ident" id="1345706">x3</span><span class="op" id="1345708">,</span>&nbsp;<span class="op" id="1345710">&amp;</span><span class="ident" id="1345711">x3</span><span class="op" id="1345713">,</span>&nbsp;<span class="op" id="1345715">&amp;</span><span class="ident" id="1345716">curve</span><span class="op" id="1345721">.</span><span class="ident" id="1345722">b</span><span class="op" id="1345723">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345726">p224Contract</span><span class="op" id="1345738">(</span><span class="op" id="1345739">&amp;</span><span class="ident" id="1345740">x3</span><span class="op" id="1345742">,</span>&nbsp;<span class="op" id="1345744">&amp;</span><span class="ident" id="1345745">x3</span><span class="op" id="1345747">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345751">p224Square</span><span class="op" id="1345761">(</span><span class="op" id="1345762">&amp;</span><span class="ident" id="1345763">y</span><span class="op" id="1345764">,</span>&nbsp;<span class="op" id="1345766">&amp;</span><span class="ident" id="1345767">y</span><span class="op" id="1345768">,</span>&nbsp;<span class="op" id="1345770">&amp;</span><span class="ident" id="1345771">tmp</span><span class="op" id="1345774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345777">p224Contract</span><span class="op" id="1345789">(</span><span class="op" id="1345790">&amp;</span><span class="ident" id="1345791">y</span><span class="op" id="1345792">,</span>&nbsp;<span class="op" id="1345794">&amp;</span><span class="ident" id="1345795">y</span><span class="op" id="1345796">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345800">for</span>&nbsp;<span class="ident" id="1345804">i</span>&nbsp;<span class="op" id="1345806">:=</span>&nbsp;<span class="num" id="1345809">0</span><span class="op" id="1345810">;</span>&nbsp;<span class="ident" id="1345812">i</span>&nbsp;<span class="op" id="1345814">&lt;</span>&nbsp;<span class="num" id="1345816">8</span><span class="op" id="1345817">;</span>&nbsp;<span class="ident" id="1345819">i</span><span class="op" id="1345820">++</span>&nbsp;<span class="op" id="1345823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345827">if</span>&nbsp;<span class="ident" id="1345830">y</span><span class="op" id="1345831">[</span><span class="ident" id="1345832">i</span><span class="op" id="1345833">]</span>&nbsp;<span class="op" id="1345835">!=</span>&nbsp;<span class="ident" id="1345838">x3</span><span class="op" id="1345840">[</span><span class="ident" id="1345841">i</span><span class="op" id="1345842">]</span>&nbsp;<span class="op" id="1345844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345849">return</span>&nbsp;<span class="ident" id="1345856">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1345864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1345867">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345870">return</span>&nbsp;<span class="ident" id="1345877">true</span><br>
<span class="lineno"></span><span class="op" id="1345882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1345885">func</span>&nbsp;<span class="op" id="1345890">(</span><span class="ident" id="1345891">p224Curve</span><span class="op" id="1345900">)</span>&nbsp;<span class="ident" id="1345902">Add</span><span class="op" id="1345905">(</span><span class="ident" id="1345906">bigX1</span><span class="op" id="1345911">,</span>&nbsp;<span class="ident" id="1345913">bigY1</span><span class="op" id="1345918">,</span>&nbsp;<span class="ident" id="1345920">bigX2</span><span class="op" id="1345925">,</span>&nbsp;<span class="ident" id="1345927">bigY2</span>&nbsp;<span class="op" id="1345933">*</span><span class="ident" id="1345934">big</span><span class="op" id="1345937">.</span><span class="ident" id="1345938">Int</span><span class="op" id="1345941">)</span>&nbsp;<span class="op" id="1345943">(</span><span class="ident" id="1345944">x</span><span class="op" id="1345945">,</span>&nbsp;<span class="ident" id="1345947">y</span>&nbsp;<span class="op" id="1345949">*</span><span class="ident" id="1345950">big</span><span class="op" id="1345953">.</span><span class="ident" id="1345954">Int</span><span class="op" id="1345957">)</span>&nbsp;<span class="op" id="1345959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345962">var</span>&nbsp;<span class="ident" id="1345966">x1</span><span class="op" id="1345968">,</span>&nbsp;<span class="ident" id="1345970">y1</span><span class="op" id="1345972">,</span>&nbsp;<span class="ident" id="1345974">z1</span><span class="op" id="1345976">,</span>&nbsp;<span class="ident" id="1345978">x2</span><span class="op" id="1345980">,</span>&nbsp;<span class="ident" id="1345982">y2</span><span class="op" id="1345984">,</span>&nbsp;<span class="ident" id="1345986">z2</span><span class="op" id="1345988">,</span>&nbsp;<span class="ident" id="1345990">x3</span><span class="op" id="1345992">,</span>&nbsp;<span class="ident" id="1345994">y3</span><span class="op" id="1345996">,</span>&nbsp;<span class="ident" id="1345998">z3</span>&nbsp;<span class="ident" id="1346001">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346020">p224FromBig</span><span class="op" id="1346031">(</span><span class="op" id="1346032">&amp;</span><span class="ident" id="1346033">x1</span><span class="op" id="1346035">,</span>&nbsp;<span class="ident" id="1346037">bigX1</span><span class="op" id="1346042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346045">p224FromBig</span><span class="op" id="1346056">(</span><span class="op" id="1346057">&amp;</span><span class="ident" id="1346058">y1</span><span class="op" id="1346060">,</span>&nbsp;<span class="ident" id="1346062">bigY1</span><span class="op" id="1346067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346070">if</span>&nbsp;<span class="ident" id="1346073">bigX1</span><span class="op" id="1346078">.</span><span class="ident" id="1346079">Sign</span><span class="op" id="1346083">(</span><span class="op" id="1346084">)</span>&nbsp;<span class="op" id="1346086">!=</span>&nbsp;<span class="num" id="1346089">0</span>&nbsp;<span class="op" id="1346091">||</span>&nbsp;<span class="ident" id="1346094">bigY1</span><span class="op" id="1346099">.</span><span class="ident" id="1346100">Sign</span><span class="op" id="1346104">(</span><span class="op" id="1346105">)</span>&nbsp;<span class="op" id="1346107">!=</span>&nbsp;<span class="num" id="1346110">0</span>&nbsp;<span class="op" id="1346112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346116">z1</span><span class="op" id="1346118">[</span><span class="num" id="1346119">0</span><span class="op" id="1346120">]</span>&nbsp;<span class="op" id="1346122">=</span>&nbsp;<span class="num" id="1346124">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1346127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346130">p224FromBig</span><span class="op" id="1346141">(</span><span class="op" id="1346142">&amp;</span><span class="ident" id="1346143">x2</span><span class="op" id="1346145">,</span>&nbsp;<span class="ident" id="1346147">bigX2</span><span class="op" id="1346152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346155">p224FromBig</span><span class="op" id="1346166">(</span><span class="op" id="1346167">&amp;</span><span class="ident" id="1346168">y2</span><span class="op" id="1346170">,</span>&nbsp;<span class="ident" id="1346172">bigY2</span><span class="op" id="1346177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346180">if</span>&nbsp;<span class="ident" id="1346183">bigX2</span><span class="op" id="1346188">.</span><span class="ident" id="1346189">Sign</span><span class="op" id="1346193">(</span><span class="op" id="1346194">)</span>&nbsp;<span class="op" id="1346196">!=</span>&nbsp;<span class="num" id="1346199">0</span>&nbsp;<span class="op" id="1346201">||</span>&nbsp;<span class="ident" id="1346204">bigY2</span><span class="op" id="1346209">.</span><span class="ident" id="1346210">Sign</span><span class="op" id="1346214">(</span><span class="op" id="1346215">)</span>&nbsp;<span class="op" id="1346217">!=</span>&nbsp;<span class="num" id="1346220">0</span>&nbsp;<span class="op" id="1346222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346226">z2</span><span class="op" id="1346228">[</span><span class="num" id="1346229">0</span><span class="op" id="1346230">]</span>&nbsp;<span class="op" id="1346232">=</span>&nbsp;<span class="num" id="1346234">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1346237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346241">p224AddJacobian</span><span class="op" id="1346256">(</span><span class="op" id="1346257">&amp;</span><span class="ident" id="1346258">x3</span><span class="op" id="1346260">,</span>&nbsp;<span class="op" id="1346262">&amp;</span><span class="ident" id="1346263">y3</span><span class="op" id="1346265">,</span>&nbsp;<span class="op" id="1346267">&amp;</span><span class="ident" id="1346268">z3</span><span class="op" id="1346270">,</span>&nbsp;<span class="op" id="1346272">&amp;</span><span class="ident" id="1346273">x1</span><span class="op" id="1346275">,</span>&nbsp;<span class="op" id="1346277">&amp;</span><span class="ident" id="1346278">y1</span><span class="op" id="1346280">,</span>&nbsp;<span class="op" id="1346282">&amp;</span><span class="ident" id="1346283">z1</span><span class="op" id="1346285">,</span>&nbsp;<span class="op" id="1346287">&amp;</span><span class="ident" id="1346288">x2</span><span class="op" id="1346290">,</span>&nbsp;<span class="op" id="1346292">&amp;</span><span class="ident" id="1346293">y2</span><span class="op" id="1346295">,</span>&nbsp;<span class="op" id="1346297">&amp;</span><span class="ident" id="1346298">z2</span><span class="op" id="1346300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346303">return</span>&nbsp;<span class="ident" id="1346310">p224ToAffine</span><span class="op" id="1346322">(</span><span class="op" id="1346323">&amp;</span><span class="ident" id="1346324">x3</span><span class="op" id="1346326">,</span>&nbsp;<span class="op" id="1346328">&amp;</span><span class="ident" id="1346329">y3</span><span class="op" id="1346331">,</span>&nbsp;<span class="op" id="1346333">&amp;</span><span class="ident" id="1346334">z3</span><span class="op" id="1346336">)</span><br>
<span class="lineno"></span><span class="op" id="1346338">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="1346341">func</span>&nbsp;<span class="op" id="1346346">(</span><span class="ident" id="1346347">p224Curve</span><span class="op" id="1346356">)</span>&nbsp;<span class="ident" id="1346358">Double</span><span class="op" id="1346364">(</span><span class="ident" id="1346365">bigX1</span><span class="op" id="1346370">,</span>&nbsp;<span class="ident" id="1346372">bigY1</span>&nbsp;<span class="op" id="1346378">*</span><span class="ident" id="1346379">big</span><span class="op" id="1346382">.</span><span class="ident" id="1346383">Int</span><span class="op" id="1346386">)</span>&nbsp;<span class="op" id="1346388">(</span><span class="ident" id="1346389">x</span><span class="op" id="1346390">,</span>&nbsp;<span class="ident" id="1346392">y</span>&nbsp;<span class="op" id="1346394">*</span><span class="ident" id="1346395">big</span><span class="op" id="1346398">.</span><span class="ident" id="1346399">Int</span><span class="op" id="1346402">)</span>&nbsp;<span class="op" id="1346404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346407">var</span>&nbsp;<span class="ident" id="1346411">x1</span><span class="op" id="1346413">,</span>&nbsp;<span class="ident" id="1346415">y1</span><span class="op" id="1346417">,</span>&nbsp;<span class="ident" id="1346419">z1</span><span class="op" id="1346421">,</span>&nbsp;<span class="ident" id="1346423">x2</span><span class="op" id="1346425">,</span>&nbsp;<span class="ident" id="1346427">y2</span><span class="op" id="1346429">,</span>&nbsp;<span class="ident" id="1346431">z2</span>&nbsp;<span class="ident" id="1346434">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346453">p224FromBig</span><span class="op" id="1346464">(</span><span class="op" id="1346465">&amp;</span><span class="ident" id="1346466">x1</span><span class="op" id="1346468">,</span>&nbsp;<span class="ident" id="1346470">bigX1</span><span class="op" id="1346475">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346478">p224FromBig</span><span class="op" id="1346489">(</span><span class="op" id="1346490">&amp;</span><span class="ident" id="1346491">y1</span><span class="op" id="1346493">,</span>&nbsp;<span class="ident" id="1346495">bigY1</span><span class="op" id="1346500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346503">z1</span><span class="op" id="1346505">[</span><span class="num" id="1346506">0</span><span class="op" id="1346507">]</span>&nbsp;<span class="op" id="1346509">=</span>&nbsp;<span class="num" id="1346511">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346515">p224DoubleJacobian</span><span class="op" id="1346533">(</span><span class="op" id="1346534">&amp;</span><span class="ident" id="1346535">x2</span><span class="op" id="1346537">,</span>&nbsp;<span class="op" id="1346539">&amp;</span><span class="ident" id="1346540">y2</span><span class="op" id="1346542">,</span>&nbsp;<span class="op" id="1346544">&amp;</span><span class="ident" id="1346545">z2</span><span class="op" id="1346547">,</span>&nbsp;<span class="op" id="1346549">&amp;</span><span class="ident" id="1346550">x1</span><span class="op" id="1346552">,</span>&nbsp;<span class="op" id="1346554">&amp;</span><span class="ident" id="1346555">y1</span><span class="op" id="1346557">,</span>&nbsp;<span class="op" id="1346559">&amp;</span><span class="ident" id="1346560">z1</span><span class="op" id="1346562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346565">return</span>&nbsp;<span class="ident" id="1346572">p224ToAffine</span><span class="op" id="1346584">(</span><span class="op" id="1346585">&amp;</span><span class="ident" id="1346586">x2</span><span class="op" id="1346588">,</span>&nbsp;<span class="op" id="1346590">&amp;</span><span class="ident" id="1346591">y2</span><span class="op" id="1346593">,</span>&nbsp;<span class="op" id="1346595">&amp;</span><span class="ident" id="1346596">z2</span><span class="op" id="1346598">)</span><br>
<span class="lineno">105</span><span class="op" id="1346600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1346603">func</span>&nbsp;<span class="op" id="1346608">(</span><span class="ident" id="1346609">p224Curve</span><span class="op" id="1346618">)</span>&nbsp;<span class="ident" id="1346620">ScalarMult</span><span class="op" id="1346630">(</span><span class="ident" id="1346631">bigX1</span><span class="op" id="1346636">,</span>&nbsp;<span class="ident" id="1346638">bigY1</span>&nbsp;<span class="op" id="1346644">*</span><span class="ident" id="1346645">big</span><span class="op" id="1346648">.</span><span class="ident" id="1346649">Int</span><span class="op" id="1346652">,</span>&nbsp;<span class="ident" id="1346654">scalar</span>&nbsp;<span class="op" id="1346661">[</span><span class="op" id="1346662">]</span><span class="builtintype" id="1346663">byte</span><span class="op" id="1346667">)</span>&nbsp;<span class="op" id="1346669">(</span><span class="ident" id="1346670">x</span><span class="op" id="1346671">,</span>&nbsp;<span class="ident" id="1346673">y</span>&nbsp;<span class="op" id="1346675">*</span><span class="ident" id="1346676">big</span><span class="op" id="1346679">.</span><span class="ident" id="1346680">Int</span><span class="op" id="1346683">)</span>&nbsp;<span class="op" id="1346685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346688">var</span>&nbsp;<span class="ident" id="1346692">x1</span><span class="op" id="1346694">,</span>&nbsp;<span class="ident" id="1346696">y1</span><span class="op" id="1346698">,</span>&nbsp;<span class="ident" id="1346700">z1</span><span class="op" id="1346702">,</span>&nbsp;<span class="ident" id="1346704">x2</span><span class="op" id="1346706">,</span>&nbsp;<span class="ident" id="1346708">y2</span><span class="op" id="1346710">,</span>&nbsp;<span class="ident" id="1346712">z2</span>&nbsp;<span class="ident" id="1346715">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346734">p224FromBig</span><span class="op" id="1346745">(</span><span class="op" id="1346746">&amp;</span><span class="ident" id="1346747">x1</span><span class="op" id="1346749">,</span>&nbsp;<span class="ident" id="1346751">bigX1</span><span class="op" id="1346756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346759">p224FromBig</span><span class="op" id="1346770">(</span><span class="op" id="1346771">&amp;</span><span class="ident" id="1346772">y1</span><span class="op" id="1346774">,</span>&nbsp;<span class="ident" id="1346776">bigY1</span><span class="op" id="1346781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346784">z1</span><span class="op" id="1346786">[</span><span class="num" id="1346787">0</span><span class="op" id="1346788">]</span>&nbsp;<span class="op" id="1346790">=</span>&nbsp;<span class="num" id="1346792">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346796">p224ScalarMult</span><span class="op" id="1346810">(</span><span class="op" id="1346811">&amp;</span><span class="ident" id="1346812">x2</span><span class="op" id="1346814">,</span>&nbsp;<span class="op" id="1346816">&amp;</span><span class="ident" id="1346817">y2</span><span class="op" id="1346819">,</span>&nbsp;<span class="op" id="1346821">&amp;</span><span class="ident" id="1346822">z2</span><span class="op" id="1346824">,</span>&nbsp;<span class="op" id="1346826">&amp;</span><span class="ident" id="1346827">x1</span><span class="op" id="1346829">,</span>&nbsp;<span class="op" id="1346831">&amp;</span><span class="ident" id="1346832">y1</span><span class="op" id="1346834">,</span>&nbsp;<span class="op" id="1346836">&amp;</span><span class="ident" id="1346837">z1</span><span class="op" id="1346839">,</span>&nbsp;<span class="ident" id="1346841">scalar</span><span class="op" id="1346847">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346850">return</span>&nbsp;<span class="ident" id="1346857">p224ToAffine</span><span class="op" id="1346869">(</span><span class="op" id="1346870">&amp;</span><span class="ident" id="1346871">x2</span><span class="op" id="1346873">,</span>&nbsp;<span class="op" id="1346875">&amp;</span><span class="ident" id="1346876">y2</span><span class="op" id="1346878">,</span>&nbsp;<span class="op" id="1346880">&amp;</span><span class="ident" id="1346881">z2</span><span class="op" id="1346883">)</span><br>
<span class="lineno"></span><span class="op" id="1346885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1346888">func</span>&nbsp;<span class="op" id="1346893">(</span><span class="ident" id="1346894">curve</span>&nbsp;<span class="ident" id="1346900">p224Curve</span><span class="op" id="1346909">)</span>&nbsp;<span class="ident" id="1346911">ScalarBaseMult</span><span class="op" id="1346925">(</span><span class="ident" id="1346926">scalar</span>&nbsp;<span class="op" id="1346933">[</span><span class="op" id="1346934">]</span><span class="builtintype" id="1346935">byte</span><span class="op" id="1346939">)</span>&nbsp;<span class="op" id="1346941">(</span><span class="ident" id="1346942">x</span><span class="op" id="1346943">,</span>&nbsp;<span class="ident" id="1346945">y</span>&nbsp;<span class="op" id="1346947">*</span><span class="ident" id="1346948">big</span><span class="op" id="1346951">.</span><span class="ident" id="1346952">Int</span><span class="op" id="1346955">)</span>&nbsp;<span class="op" id="1346957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346960">var</span>&nbsp;<span class="ident" id="1346964">z1</span><span class="op" id="1346966">,</span>&nbsp;<span class="ident" id="1346968">x2</span><span class="op" id="1346970">,</span>&nbsp;<span class="ident" id="1346972">y2</span><span class="op" id="1346974">,</span>&nbsp;<span class="ident" id="1346976">z2</span>&nbsp;<span class="ident" id="1346979">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346998">z1</span><span class="op" id="1347000">[</span><span class="num" id="1347001">0</span><span class="op" id="1347002">]</span>&nbsp;<span class="op" id="1347004">=</span>&nbsp;<span class="num" id="1347006">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347009">p224ScalarMult</span><span class="op" id="1347023">(</span><span class="op" id="1347024">&amp;</span><span class="ident" id="1347025">x2</span><span class="op" id="1347027">,</span>&nbsp;<span class="op" id="1347029">&amp;</span><span class="ident" id="1347030">y2</span><span class="op" id="1347032">,</span>&nbsp;<span class="op" id="1347034">&amp;</span><span class="ident" id="1347035">z2</span><span class="op" id="1347037">,</span>&nbsp;<span class="op" id="1347039">&amp;</span><span class="ident" id="1347040">curve</span><span class="op" id="1347045">.</span><span class="ident" id="1347046">gx</span><span class="op" id="1347048">,</span>&nbsp;<span class="op" id="1347050">&amp;</span><span class="ident" id="1347051">curve</span><span class="op" id="1347056">.</span><span class="ident" id="1347057">gy</span><span class="op" id="1347059">,</span>&nbsp;<span class="op" id="1347061">&amp;</span><span class="ident" id="1347062">z1</span><span class="op" id="1347064">,</span>&nbsp;<span class="ident" id="1347066">scalar</span><span class="op" id="1347072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347075">return</span>&nbsp;<span class="ident" id="1347082">p224ToAffine</span><span class="op" id="1347094">(</span><span class="op" id="1347095">&amp;</span><span class="ident" id="1347096">x2</span><span class="op" id="1347098">,</span>&nbsp;<span class="op" id="1347100">&amp;</span><span class="ident" id="1347101">y2</span><span class="op" id="1347103">,</span>&nbsp;<span class="op" id="1347105">&amp;</span><span class="ident" id="1347106">z2</span><span class="op" id="1347108">)</span><br>
<span class="lineno"></span><span class="op" id="1347110">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="1347113">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="1347141">//</span><br>
<span class="lineno"></span><span class="comment" id="1347144">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="1347223">//</span><br>
<span class="lineno">130</span><span class="comment" id="1347226">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="1347304">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="1347364">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="1347423">//</span><br>
<span class="lineno"></span><span class="comment" id="1347426">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="1347506">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="1347585">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="1347648">type</span>&nbsp;<span class="ident" id="1347653">p224FieldElement</span>&nbsp;<span class="op" id="1347670">[</span><span class="num" id="1347671">8</span><span class="op" id="1347672">]</span><span class="builtintype" id="1347673">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1347681">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="1347752">var</span>&nbsp;<span class="ident" id="1347756">p224P</span>&nbsp;<span class="op" id="1347762">=</span>&nbsp;<span class="op" id="1347764">[</span><span class="num" id="1347765">8</span><span class="op" id="1347766">]</span><span class="builtintype" id="1347767">uint32</span><span class="op" id="1347773">{</span><span class="num" id="1347774">1</span><span class="op" id="1347775">,</span>&nbsp;<span class="num" id="1347777">0</span><span class="op" id="1347778">,</span>&nbsp;<span class="num" id="1347780">0</span><span class="op" id="1347781">,</span>&nbsp;<span class="num" id="1347783">0xffff000</span><span class="op" id="1347792">,</span>&nbsp;<span class="num" id="1347794">0xfffffff</span><span class="op" id="1347803">,</span>&nbsp;<span class="num" id="1347805">0xfffffff</span><span class="op" id="1347814">,</span>&nbsp;<span class="num" id="1347816">0xfffffff</span><span class="op" id="1347825">,</span>&nbsp;<span class="num" id="1347827">0xfffffff</span><span class="op" id="1347836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1347839">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="1347896">//</span><br>
<span class="lineno"></span><span class="comment" id="1347899">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="1347915">func</span>&nbsp;<span class="ident" id="1347920">p224IsZero</span><span class="op" id="1347930">(</span><span class="ident" id="1347931">a</span>&nbsp;<span class="op" id="1347933">*</span><span class="ident" id="1347934">p224FieldElement</span><span class="op" id="1347950">)</span>&nbsp;<span class="builtintype" id="1347952">uint32</span>&nbsp;<span class="op" id="1347959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1347962">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1348032">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348067">var</span>&nbsp;<span class="ident" id="1348071">minimal</span>&nbsp;<span class="ident" id="1348079">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348097">p224Contract</span><span class="op" id="1348109">(</span><span class="op" id="1348110">&amp;</span><span class="ident" id="1348111">minimal</span><span class="op" id="1348118">,</span>&nbsp;<span class="ident" id="1348120">a</span><span class="op" id="1348121">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348125">var</span>&nbsp;<span class="ident" id="1348129">isZero</span><span class="op" id="1348135">,</span>&nbsp;<span class="ident" id="1348137">isP</span>&nbsp;<span class="builtintype" id="1348141">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348149">for</span>&nbsp;<span class="ident" id="1348153">i</span><span class="op" id="1348154">,</span>&nbsp;<span class="ident" id="1348156">v</span>&nbsp;<span class="op" id="1348158">:=</span>&nbsp;<span class="keyword" id="1348161">range</span>&nbsp;<span class="ident" id="1348167">minimal</span>&nbsp;<span class="op" id="1348175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348179">isZero</span>&nbsp;<span class="op" id="1348186">|=</span>&nbsp;<span class="ident" id="1348189">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348193">isP</span>&nbsp;<span class="op" id="1348197">|=</span>&nbsp;<span class="ident" id="1348200">v</span>&nbsp;<span class="op" id="1348202">-</span>&nbsp;<span class="ident" id="1348204">p224P</span><span class="op" id="1348209">[</span><span class="ident" id="1348210">i</span><span class="op" id="1348211">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1348214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1348218">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348277">isZero</span>&nbsp;<span class="op" id="1348284">|=</span>&nbsp;<span class="ident" id="1348287">isZero</span>&nbsp;<span class="op" id="1348294">&gt;&gt;</span>&nbsp;<span class="num" id="1348297">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348301">isZero</span>&nbsp;<span class="op" id="1348308">|=</span>&nbsp;<span class="ident" id="1348311">isZero</span>&nbsp;<span class="op" id="1348318">&gt;&gt;</span>&nbsp;<span class="num" id="1348321">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348324">isZero</span>&nbsp;<span class="op" id="1348331">|=</span>&nbsp;<span class="ident" id="1348334">isZero</span>&nbsp;<span class="op" id="1348341">&gt;&gt;</span>&nbsp;<span class="num" id="1348344">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348347">isZero</span>&nbsp;<span class="op" id="1348354">|=</span>&nbsp;<span class="ident" id="1348357">isZero</span>&nbsp;<span class="op" id="1348364">&gt;&gt;</span>&nbsp;<span class="num" id="1348367">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348370">isZero</span>&nbsp;<span class="op" id="1348377">|=</span>&nbsp;<span class="ident" id="1348380">isZero</span>&nbsp;<span class="op" id="1348387">&gt;&gt;</span>&nbsp;<span class="num" id="1348390">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348394">isP</span>&nbsp;<span class="op" id="1348398">|=</span>&nbsp;<span class="ident" id="1348401">isP</span>&nbsp;<span class="op" id="1348405">&gt;&gt;</span>&nbsp;<span class="num" id="1348408">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348412">isP</span>&nbsp;<span class="op" id="1348416">|=</span>&nbsp;<span class="ident" id="1348419">isP</span>&nbsp;<span class="op" id="1348423">&gt;&gt;</span>&nbsp;<span class="num" id="1348426">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348429">isP</span>&nbsp;<span class="op" id="1348433">|=</span>&nbsp;<span class="ident" id="1348436">isP</span>&nbsp;<span class="op" id="1348440">&gt;&gt;</span>&nbsp;<span class="num" id="1348443">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348446">isP</span>&nbsp;<span class="op" id="1348450">|=</span>&nbsp;<span class="ident" id="1348453">isP</span>&nbsp;<span class="op" id="1348457">&gt;&gt;</span>&nbsp;<span class="num" id="1348460">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348463">isP</span>&nbsp;<span class="op" id="1348467">|=</span>&nbsp;<span class="ident" id="1348470">isP</span>&nbsp;<span class="op" id="1348474">&gt;&gt;</span>&nbsp;<span class="num" id="1348477">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1348481">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348545">result</span>&nbsp;<span class="op" id="1348552">:=</span>&nbsp;<span class="ident" id="1348555">isZero</span>&nbsp;<span class="op" id="1348562">&amp;</span>&nbsp;<span class="ident" id="1348564">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348569">result</span>&nbsp;<span class="op" id="1348576">=</span>&nbsp;<span class="op" id="1348578">(</span><span class="op" id="1348579">^</span><span class="ident" id="1348580">result</span><span class="op" id="1348586">)</span>&nbsp;<span class="op" id="1348588">&amp;</span>&nbsp;<span class="num" id="1348590">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348594">return</span>&nbsp;<span class="ident" id="1348601">result</span><br>
<span class="lineno">175</span><span class="op" id="1348608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1348611">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="1348642">//</span><br>
<span class="lineno"></span><span class="comment" id="1348645">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="1348668">func</span>&nbsp;<span class="ident" id="1348673">p224Add</span><span class="op" id="1348680">(</span><span class="ident" id="1348681">out</span><span class="op" id="1348684">,</span>&nbsp;<span class="ident" id="1348686">a</span><span class="op" id="1348687">,</span>&nbsp;<span class="ident" id="1348689">b</span>&nbsp;<span class="op" id="1348691">*</span><span class="ident" id="1348692">p224FieldElement</span><span class="op" id="1348708">)</span>&nbsp;<span class="op" id="1348710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348713">for</span>&nbsp;<span class="ident" id="1348717">i</span>&nbsp;<span class="op" id="1348719">:=</span>&nbsp;<span class="num" id="1348722">0</span><span class="op" id="1348723">;</span>&nbsp;<span class="ident" id="1348725">i</span>&nbsp;<span class="op" id="1348727">&lt;</span>&nbsp;<span class="num" id="1348729">8</span><span class="op" id="1348730">;</span>&nbsp;<span class="ident" id="1348732">i</span><span class="op" id="1348733">++</span>&nbsp;<span class="op" id="1348736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348740">out</span><span class="op" id="1348743">[</span><span class="ident" id="1348744">i</span><span class="op" id="1348745">]</span>&nbsp;<span class="op" id="1348747">=</span>&nbsp;<span class="ident" id="1348749">a</span><span class="op" id="1348750">[</span><span class="ident" id="1348751">i</span><span class="op" id="1348752">]</span>&nbsp;<span class="op" id="1348754">+</span>&nbsp;<span class="ident" id="1348756">b</span><span class="op" id="1348757">[</span><span class="ident" id="1348758">i</span><span class="op" id="1348759">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1348762">}</span><br>
<span class="lineno"></span><span class="op" id="1348764">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="1348767">const</span>&nbsp;<span class="ident" id="1348773">two31p3</span>&nbsp;<span class="op" id="1348781">=</span>&nbsp;<span class="num" id="1348783">1</span><span class="op" id="1348784">&lt;&lt;</span><span class="num" id="1348786">31</span>&nbsp;<span class="op" id="1348789">+</span>&nbsp;<span class="num" id="1348791">1</span><span class="op" id="1348792">&lt;&lt;</span><span class="num" id="1348794">3</span><br>
<span class="lineno"></span><span class="keyword" id="1348796">const</span>&nbsp;<span class="ident" id="1348802">two31m3</span>&nbsp;<span class="op" id="1348810">=</span>&nbsp;<span class="num" id="1348812">1</span><span class="op" id="1348813">&lt;&lt;</span><span class="num" id="1348815">31</span>&nbsp;<span class="op" id="1348818">-</span>&nbsp;<span class="num" id="1348820">1</span><span class="op" id="1348821">&lt;&lt;</span><span class="num" id="1348823">3</span><br>
<span class="lineno"></span><span class="keyword" id="1348825">const</span>&nbsp;<span class="ident" id="1348831">two31m15m3</span>&nbsp;<span class="op" id="1348842">=</span>&nbsp;<span class="num" id="1348844">1</span><span class="op" id="1348845">&lt;&lt;</span><span class="num" id="1348847">31</span>&nbsp;<span class="op" id="1348850">-</span>&nbsp;<span class="num" id="1348852">1</span><span class="op" id="1348853">&lt;&lt;</span><span class="num" id="1348855">15</span>&nbsp;<span class="op" id="1348858">-</span>&nbsp;<span class="num" id="1348860">1</span><span class="op" id="1348861">&lt;&lt;</span><span class="num" id="1348863">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="1348866">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="1348943">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1349023">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="1349045">var</span>&nbsp;<span class="ident" id="1349049">p224ZeroModP31</span>&nbsp;<span class="op" id="1349064">=</span>&nbsp;<span class="op" id="1349066">[</span><span class="op" id="1349067">]</span><span class="builtintype" id="1349068">uint32</span><span class="op" id="1349074">{</span><span class="ident" id="1349075">two31p3</span><span class="op" id="1349082">,</span>&nbsp;<span class="ident" id="1349084">two31m3</span><span class="op" id="1349091">,</span>&nbsp;<span class="ident" id="1349093">two31m3</span><span class="op" id="1349100">,</span>&nbsp;<span class="ident" id="1349102">two31m15m3</span><span class="op" id="1349112">,</span>&nbsp;<span class="ident" id="1349114">two31m3</span><span class="op" id="1349121">,</span>&nbsp;<span class="ident" id="1349123">two31m3</span><span class="op" id="1349130">,</span>&nbsp;<span class="ident" id="1349132">two31m3</span><span class="op" id="1349139">,</span>&nbsp;<span class="ident" id="1349141">two31m3</span><span class="op" id="1349148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="1349151">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="1349182">//</span><br>
<span class="lineno"></span><span class="comment" id="1349185">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="1349207">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="1349225">func</span>&nbsp;<span class="ident" id="1349230">p224Sub</span><span class="op" id="1349237">(</span><span class="ident" id="1349238">out</span><span class="op" id="1349241">,</span>&nbsp;<span class="ident" id="1349243">a</span><span class="op" id="1349244">,</span>&nbsp;<span class="ident" id="1349246">b</span>&nbsp;<span class="op" id="1349248">*</span><span class="ident" id="1349249">p224FieldElement</span><span class="op" id="1349265">)</span>&nbsp;<span class="op" id="1349267">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349270">for</span>&nbsp;<span class="ident" id="1349274">i</span>&nbsp;<span class="op" id="1349276">:=</span>&nbsp;<span class="num" id="1349279">0</span><span class="op" id="1349280">;</span>&nbsp;<span class="ident" id="1349282">i</span>&nbsp;<span class="op" id="1349284">&lt;</span>&nbsp;<span class="num" id="1349286">8</span><span class="op" id="1349287">;</span>&nbsp;<span class="ident" id="1349289">i</span><span class="op" id="1349290">++</span>&nbsp;<span class="op" id="1349293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349297">out</span><span class="op" id="1349300">[</span><span class="ident" id="1349301">i</span><span class="op" id="1349302">]</span>&nbsp;<span class="op" id="1349304">=</span>&nbsp;<span class="ident" id="1349306">a</span><span class="op" id="1349307">[</span><span class="ident" id="1349308">i</span><span class="op" id="1349309">]</span>&nbsp;<span class="op" id="1349311">+</span>&nbsp;<span class="ident" id="1349313">p224ZeroModP31</span><span class="op" id="1349327">[</span><span class="ident" id="1349328">i</span><span class="op" id="1349329">]</span>&nbsp;<span class="op" id="1349331">-</span>&nbsp;<span class="ident" id="1349333">b</span><span class="op" id="1349334">[</span><span class="ident" id="1349335">i</span><span class="op" id="1349336">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349339">}</span><br>
<span class="lineno"></span><span class="op" id="1349341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="1349344">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1349420">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="1349498">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="1349546">type</span>&nbsp;<span class="ident" id="1349551">p224LargeFieldElement</span>&nbsp;<span class="op" id="1349573">[</span><span class="num" id="1349574">15</span><span class="op" id="1349576">]</span><span class="ident" id="1349577">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="1349585">const</span>&nbsp;<span class="ident" id="1349591">two63p35</span>&nbsp;<span class="op" id="1349600">=</span>&nbsp;<span class="num" id="1349602">1</span><span class="op" id="1349603">&lt;&lt;</span><span class="num" id="1349605">63</span>&nbsp;<span class="op" id="1349608">+</span>&nbsp;<span class="num" id="1349610">1</span><span class="op" id="1349611">&lt;&lt;</span><span class="num" id="1349613">35</span><br>
<span class="lineno"></span><span class="keyword" id="1349616">const</span>&nbsp;<span class="ident" id="1349622">two63m35</span>&nbsp;<span class="op" id="1349631">=</span>&nbsp;<span class="num" id="1349633">1</span><span class="op" id="1349634">&lt;&lt;</span><span class="num" id="1349636">63</span>&nbsp;<span class="op" id="1349639">-</span>&nbsp;<span class="num" id="1349641">1</span><span class="op" id="1349642">&lt;&lt;</span><span class="num" id="1349644">35</span><br>
<span class="lineno"></span><span class="keyword" id="1349647">const</span>&nbsp;<span class="ident" id="1349653">two63m35m19</span>&nbsp;<span class="op" id="1349665">=</span>&nbsp;<span class="num" id="1349667">1</span><span class="op" id="1349668">&lt;&lt;</span><span class="num" id="1349670">63</span>&nbsp;<span class="op" id="1349673">-</span>&nbsp;<span class="num" id="1349675">1</span><span class="op" id="1349676">&lt;&lt;</span><span class="num" id="1349678">35</span>&nbsp;<span class="op" id="1349681">-</span>&nbsp;<span class="num" id="1349683">1</span><span class="op" id="1349684">&lt;&lt;</span><span class="num" id="1349686">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1349690">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="1349769">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="1349802">var</span>&nbsp;<span class="ident" id="1349806">p224ZeroModP63</span>&nbsp;<span class="op" id="1349821">=</span>&nbsp;<span class="op" id="1349823">[</span><span class="num" id="1349824">8</span><span class="op" id="1349825">]</span><span class="ident" id="1349826">uint64</span><span class="op" id="1349832">{</span><span class="ident" id="1349833">two63p35</span><span class="op" id="1349841">,</span>&nbsp;<span class="ident" id="1349843">two63m35</span><span class="op" id="1349851">,</span>&nbsp;<span class="ident" id="1349853">two63m35</span><span class="op" id="1349861">,</span>&nbsp;<span class="ident" id="1349863">two63m35</span><span class="op" id="1349871">,</span>&nbsp;<span class="ident" id="1349873">two63m35m19</span><span class="op" id="1349884">,</span>&nbsp;<span class="ident" id="1349886">two63m35</span><span class="op" id="1349894">,</span>&nbsp;<span class="ident" id="1349896">two63m35</span><span class="op" id="1349904">,</span>&nbsp;<span class="ident" id="1349906">two63m35</span><span class="op" id="1349914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1349917">const</span>&nbsp;<span class="ident" id="1349923">bottom12Bits</span>&nbsp;<span class="op" id="1349936">=</span>&nbsp;<span class="num" id="1349938">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="1349944">const</span>&nbsp;<span class="ident" id="1349950">bottom28Bits</span>&nbsp;<span class="op" id="1349963">=</span>&nbsp;<span class="num" id="1349965">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="1349976">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="1350007">//</span><br>
<span class="lineno"></span><span class="comment" id="1350010">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="1350056">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="1350074">func</span>&nbsp;<span class="ident" id="1350079">p224Mul</span><span class="op" id="1350086">(</span><span class="ident" id="1350087">out</span><span class="op" id="1350090">,</span>&nbsp;<span class="ident" id="1350092">a</span><span class="op" id="1350093">,</span>&nbsp;<span class="ident" id="1350095">b</span>&nbsp;<span class="op" id="1350097">*</span><span class="ident" id="1350098">p224FieldElement</span><span class="op" id="1350114">,</span>&nbsp;<span class="ident" id="1350116">tmp</span>&nbsp;<span class="op" id="1350120">*</span><span class="ident" id="1350121">p224LargeFieldElement</span><span class="op" id="1350142">)</span>&nbsp;<span class="op" id="1350144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350147">for</span>&nbsp;<span class="ident" id="1350151">i</span>&nbsp;<span class="op" id="1350153">:=</span>&nbsp;<span class="num" id="1350156">0</span><span class="op" id="1350157">;</span>&nbsp;<span class="ident" id="1350159">i</span>&nbsp;<span class="op" id="1350161">&lt;</span>&nbsp;<span class="num" id="1350163">15</span><span class="op" id="1350165">;</span>&nbsp;<span class="ident" id="1350167">i</span><span class="op" id="1350168">++</span>&nbsp;<span class="op" id="1350171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350175">tmp</span><span class="op" id="1350178">[</span><span class="ident" id="1350179">i</span><span class="op" id="1350180">]</span>&nbsp;<span class="op" id="1350182">=</span>&nbsp;<span class="num" id="1350184">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350191">for</span>&nbsp;<span class="ident" id="1350195">i</span>&nbsp;<span class="op" id="1350197">:=</span>&nbsp;<span class="num" id="1350200">0</span><span class="op" id="1350201">;</span>&nbsp;<span class="ident" id="1350203">i</span>&nbsp;<span class="op" id="1350205">&lt;</span>&nbsp;<span class="num" id="1350207">8</span><span class="op" id="1350208">;</span>&nbsp;<span class="ident" id="1350210">i</span><span class="op" id="1350211">++</span>&nbsp;<span class="op" id="1350214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350218">for</span>&nbsp;<span class="ident" id="1350222">j</span>&nbsp;<span class="op" id="1350224">:=</span>&nbsp;<span class="num" id="1350227">0</span><span class="op" id="1350228">;</span>&nbsp;<span class="ident" id="1350230">j</span>&nbsp;<span class="op" id="1350232">&lt;</span>&nbsp;<span class="num" id="1350234">8</span><span class="op" id="1350235">;</span>&nbsp;<span class="ident" id="1350237">j</span><span class="op" id="1350238">++</span>&nbsp;<span class="op" id="1350241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350246">tmp</span><span class="op" id="1350249">[</span><span class="ident" id="1350250">i</span><span class="op" id="1350251">+</span><span class="ident" id="1350252">j</span><span class="op" id="1350253">]</span>&nbsp;<span class="op" id="1350255">+=</span>&nbsp;<span class="ident" id="1350258">uint64</span><span class="op" id="1350264">(</span><span class="ident" id="1350265">a</span><span class="op" id="1350266">[</span><span class="ident" id="1350267">i</span><span class="op" id="1350268">]</span><span class="op" id="1350269">)</span>&nbsp;<span class="op" id="1350271">*</span>&nbsp;<span class="ident" id="1350273">uint64</span><span class="op" id="1350279">(</span><span class="ident" id="1350280">b</span><span class="op" id="1350281">[</span><span class="ident" id="1350282">j</span><span class="op" id="1350283">]</span><span class="op" id="1350284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350291">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350295">p224ReduceLarge</span><span class="op" id="1350310">(</span><span class="ident" id="1350311">out</span><span class="op" id="1350314">,</span>&nbsp;<span class="ident" id="1350316">tmp</span><span class="op" id="1350319">)</span><br>
<span class="lineno"></span><span class="op" id="1350321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1350324">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="1350354">//</span><br>
<span class="lineno"></span><span class="comment" id="1350357">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="1350373">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="1350391">func</span>&nbsp;<span class="ident" id="1350396">p224Square</span><span class="op" id="1350406">(</span><span class="ident" id="1350407">out</span><span class="op" id="1350410">,</span>&nbsp;<span class="ident" id="1350412">a</span>&nbsp;<span class="op" id="1350414">*</span><span class="ident" id="1350415">p224FieldElement</span><span class="op" id="1350431">,</span>&nbsp;<span class="ident" id="1350433">tmp</span>&nbsp;<span class="op" id="1350437">*</span><span class="ident" id="1350438">p224LargeFieldElement</span><span class="op" id="1350459">)</span>&nbsp;<span class="op" id="1350461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350464">for</span>&nbsp;<span class="ident" id="1350468">i</span>&nbsp;<span class="op" id="1350470">:=</span>&nbsp;<span class="num" id="1350473">0</span><span class="op" id="1350474">;</span>&nbsp;<span class="ident" id="1350476">i</span>&nbsp;<span class="op" id="1350478">&lt;</span>&nbsp;<span class="num" id="1350480">15</span><span class="op" id="1350482">;</span>&nbsp;<span class="ident" id="1350484">i</span><span class="op" id="1350485">++</span>&nbsp;<span class="op" id="1350488">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350492">tmp</span><span class="op" id="1350495">[</span><span class="ident" id="1350496">i</span><span class="op" id="1350497">]</span>&nbsp;<span class="op" id="1350499">=</span>&nbsp;<span class="num" id="1350501">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350508">for</span>&nbsp;<span class="ident" id="1350512">i</span>&nbsp;<span class="op" id="1350514">:=</span>&nbsp;<span class="num" id="1350517">0</span><span class="op" id="1350518">;</span>&nbsp;<span class="ident" id="1350520">i</span>&nbsp;<span class="op" id="1350522">&lt;</span>&nbsp;<span class="num" id="1350524">8</span><span class="op" id="1350525">;</span>&nbsp;<span class="ident" id="1350527">i</span><span class="op" id="1350528">++</span>&nbsp;<span class="op" id="1350531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350535">for</span>&nbsp;<span class="ident" id="1350539">j</span>&nbsp;<span class="op" id="1350541">:=</span>&nbsp;<span class="num" id="1350544">0</span><span class="op" id="1350545">;</span>&nbsp;<span class="ident" id="1350547">j</span>&nbsp;<span class="op" id="1350549">&lt;=</span>&nbsp;<span class="ident" id="1350552">i</span><span class="op" id="1350553">;</span>&nbsp;<span class="ident" id="1350555">j</span><span class="op" id="1350556">++</span>&nbsp;<span class="op" id="1350559">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350564">r</span>&nbsp;<span class="op" id="1350566">:=</span>&nbsp;<span class="ident" id="1350569">uint64</span><span class="op" id="1350575">(</span><span class="ident" id="1350576">a</span><span class="op" id="1350577">[</span><span class="ident" id="1350578">i</span><span class="op" id="1350579">]</span><span class="op" id="1350580">)</span>&nbsp;<span class="op" id="1350582">*</span>&nbsp;<span class="ident" id="1350584">uint64</span><span class="op" id="1350590">(</span><span class="ident" id="1350591">a</span><span class="op" id="1350592">[</span><span class="ident" id="1350593">j</span><span class="op" id="1350594">]</span><span class="op" id="1350595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350600">if</span>&nbsp;<span class="ident" id="1350603">i</span>&nbsp;<span class="op" id="1350605">==</span>&nbsp;<span class="ident" id="1350608">j</span>&nbsp;<span class="op" id="1350610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350616">tmp</span><span class="op" id="1350619">[</span><span class="ident" id="1350620">i</span><span class="op" id="1350621">+</span><span class="ident" id="1350622">j</span><span class="op" id="1350623">]</span>&nbsp;<span class="op" id="1350625">+=</span>&nbsp;<span class="ident" id="1350628">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350633">}</span>&nbsp;<span class="keyword" id="1350635">else</span>&nbsp;<span class="op" id="1350640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350646">tmp</span><span class="op" id="1350649">[</span><span class="ident" id="1350650">i</span><span class="op" id="1350651">+</span><span class="ident" id="1350652">j</span><span class="op" id="1350653">]</span>&nbsp;<span class="op" id="1350655">+=</span>&nbsp;<span class="ident" id="1350658">r</span>&nbsp;<span class="op" id="1350660">&lt;&lt;</span>&nbsp;<span class="num" id="1350663">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350679">p224ReduceLarge</span><span class="op" id="1350694">(</span><span class="ident" id="1350695">out</span><span class="op" id="1350698">,</span>&nbsp;<span class="ident" id="1350700">tmp</span><span class="op" id="1350703">)</span><br>
<span class="lineno">260</span><span class="op" id="1350705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1350708">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="1350779">//</span><br>
<span class="lineno"></span><span class="comment" id="1350782">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="1350799">func</span>&nbsp;<span class="ident" id="1350804">p224ReduceLarge</span><span class="op" id="1350819">(</span><span class="ident" id="1350820">out</span>&nbsp;<span class="op" id="1350824">*</span><span class="ident" id="1350825">p224FieldElement</span><span class="op" id="1350841">,</span>&nbsp;<span class="ident" id="1350843">in</span>&nbsp;<span class="op" id="1350846">*</span><span class="ident" id="1350847">p224LargeFieldElement</span><span class="op" id="1350868">)</span>&nbsp;<span class="op" id="1350870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350873">for</span>&nbsp;<span class="ident" id="1350877">i</span>&nbsp;<span class="op" id="1350879">:=</span>&nbsp;<span class="num" id="1350882">0</span><span class="op" id="1350883">;</span>&nbsp;<span class="ident" id="1350885">i</span>&nbsp;<span class="op" id="1350887">&lt;</span>&nbsp;<span class="num" id="1350889">8</span><span class="op" id="1350890">;</span>&nbsp;<span class="ident" id="1350892">i</span><span class="op" id="1350893">++</span>&nbsp;<span class="op" id="1350896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350900">in</span><span class="op" id="1350902">[</span><span class="ident" id="1350903">i</span><span class="op" id="1350904">]</span>&nbsp;<span class="op" id="1350906">+=</span>&nbsp;<span class="ident" id="1350909">p224ZeroModP63</span><span class="op" id="1350923">[</span><span class="ident" id="1350924">i</span><span class="op" id="1350925">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1350932">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350986">for</span>&nbsp;<span class="ident" id="1350990">i</span>&nbsp;<span class="op" id="1350992">:=</span>&nbsp;<span class="num" id="1350995">14</span><span class="op" id="1350997">;</span>&nbsp;<span class="ident" id="1350999">i</span>&nbsp;<span class="op" id="1351001">&gt;=</span>&nbsp;<span class="num" id="1351004">8</span><span class="op" id="1351005">;</span>&nbsp;<span class="ident" id="1351007">i</span><span class="op" id="1351008">--</span>&nbsp;<span class="op" id="1351011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351015">in</span><span class="op" id="1351017">[</span><span class="ident" id="1351018">i</span><span class="op" id="1351019">-</span><span class="num" id="1351020">8</span><span class="op" id="1351021">]</span>&nbsp;<span class="op" id="1351023">-=</span>&nbsp;<span class="ident" id="1351026">in</span><span class="op" id="1351028">[</span><span class="ident" id="1351029">i</span><span class="op" id="1351030">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351034">in</span><span class="op" id="1351036">[</span><span class="ident" id="1351037">i</span><span class="op" id="1351038">-</span><span class="num" id="1351039">5</span><span class="op" id="1351040">]</span>&nbsp;<span class="op" id="1351042">+=</span>&nbsp;<span class="op" id="1351045">(</span><span class="ident" id="1351046">in</span><span class="op" id="1351048">[</span><span class="ident" id="1351049">i</span><span class="op" id="1351050">]</span>&nbsp;<span class="op" id="1351052">&amp;</span>&nbsp;<span class="num" id="1351054">0xffff</span><span class="op" id="1351060">)</span>&nbsp;<span class="op" id="1351062">&lt;&lt;</span>&nbsp;<span class="num" id="1351065">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351070">in</span><span class="op" id="1351072">[</span><span class="ident" id="1351073">i</span><span class="op" id="1351074">-</span><span class="num" id="1351075">4</span><span class="op" id="1351076">]</span>&nbsp;<span class="op" id="1351078">+=</span>&nbsp;<span class="ident" id="1351081">in</span><span class="op" id="1351083">[</span><span class="ident" id="1351084">i</span><span class="op" id="1351085">]</span>&nbsp;<span class="op" id="1351087">&gt;&gt;</span>&nbsp;<span class="num" id="1351090">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351097">in</span><span class="op" id="1351099">[</span><span class="num" id="1351100">8</span><span class="op" id="1351101">]</span>&nbsp;<span class="op" id="1351103">=</span>&nbsp;<span class="num" id="1351105">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351108">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351130">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351201">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351232">for</span>&nbsp;<span class="ident" id="1351236">i</span>&nbsp;<span class="op" id="1351238">:=</span>&nbsp;<span class="num" id="1351241">1</span><span class="op" id="1351242">;</span>&nbsp;<span class="ident" id="1351244">i</span>&nbsp;<span class="op" id="1351246">&lt;</span>&nbsp;<span class="num" id="1351248">8</span><span class="op" id="1351249">;</span>&nbsp;<span class="ident" id="1351251">i</span><span class="op" id="1351252">++</span>&nbsp;<span class="op" id="1351255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351259">in</span><span class="op" id="1351261">[</span><span class="ident" id="1351262">i</span><span class="op" id="1351263">+</span><span class="num" id="1351264">1</span><span class="op" id="1351265">]</span>&nbsp;<span class="op" id="1351267">+=</span>&nbsp;<span class="ident" id="1351270">in</span><span class="op" id="1351272">[</span><span class="ident" id="1351273">i</span><span class="op" id="1351274">]</span>&nbsp;<span class="op" id="1351276">&gt;&gt;</span>&nbsp;<span class="num" id="1351279">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351284">out</span><span class="op" id="1351287">[</span><span class="ident" id="1351288">i</span><span class="op" id="1351289">]</span>&nbsp;<span class="op" id="1351291">=</span>&nbsp;<span class="builtintype" id="1351293">uint32</span><span class="op" id="1351299">(</span><span class="ident" id="1351300">in</span><span class="op" id="1351302">[</span><span class="ident" id="1351303">i</span><span class="op" id="1351304">]</span>&nbsp;<span class="op" id="1351306">&amp;</span>&nbsp;<span class="ident" id="1351308">bottom28Bits</span><span class="op" id="1351320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351323">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351326">in</span><span class="op" id="1351328">[</span><span class="num" id="1351329">0</span><span class="op" id="1351330">]</span>&nbsp;<span class="op" id="1351332">-=</span>&nbsp;<span class="ident" id="1351335">in</span><span class="op" id="1351337">[</span><span class="num" id="1351338">8</span><span class="op" id="1351339">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351342">out</span><span class="op" id="1351345">[</span><span class="num" id="1351346">3</span><span class="op" id="1351347">]</span>&nbsp;<span class="op" id="1351349">+=</span>&nbsp;<span class="builtintype" id="1351352">uint32</span><span class="op" id="1351358">(</span><span class="ident" id="1351359">in</span><span class="op" id="1351361">[</span><span class="num" id="1351362">8</span><span class="op" id="1351363">]</span><span class="op" id="1351364">&amp;</span><span class="num" id="1351365">0xffff</span><span class="op" id="1351371">)</span>&nbsp;<span class="op" id="1351373">&lt;&lt;</span>&nbsp;<span class="num" id="1351376">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351380">out</span><span class="op" id="1351383">[</span><span class="num" id="1351384">4</span><span class="op" id="1351385">]</span>&nbsp;<span class="op" id="1351387">+=</span>&nbsp;<span class="builtintype" id="1351390">uint32</span><span class="op" id="1351396">(</span><span class="ident" id="1351397">in</span><span class="op" id="1351399">[</span><span class="num" id="1351400">8</span><span class="op" id="1351401">]</span>&nbsp;<span class="op" id="1351403">&gt;&gt;</span>&nbsp;<span class="num" id="1351406">16</span><span class="op" id="1351408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351411">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351429">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351448">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351467">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351494">out</span><span class="op" id="1351497">[</span><span class="num" id="1351498">0</span><span class="op" id="1351499">]</span>&nbsp;<span class="op" id="1351501">=</span>&nbsp;<span class="builtintype" id="1351503">uint32</span><span class="op" id="1351509">(</span><span class="ident" id="1351510">in</span><span class="op" id="1351512">[</span><span class="num" id="1351513">0</span><span class="op" id="1351514">]</span>&nbsp;<span class="op" id="1351516">&amp;</span>&nbsp;<span class="ident" id="1351518">bottom28Bits</span><span class="op" id="1351530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351533">out</span><span class="op" id="1351536">[</span><span class="num" id="1351537">1</span><span class="op" id="1351538">]</span>&nbsp;<span class="op" id="1351540">+=</span>&nbsp;<span class="builtintype" id="1351543">uint32</span><span class="op" id="1351549">(</span><span class="op" id="1351550">(</span><span class="ident" id="1351551">in</span><span class="op" id="1351553">[</span><span class="num" id="1351554">0</span><span class="op" id="1351555">]</span>&nbsp;<span class="op" id="1351557">&gt;&gt;</span>&nbsp;<span class="num" id="1351560">28</span><span class="op" id="1351562">)</span>&nbsp;<span class="op" id="1351564">&amp;</span>&nbsp;<span class="ident" id="1351566">bottom28Bits</span><span class="op" id="1351578">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351581">out</span><span class="op" id="1351584">[</span><span class="num" id="1351585">2</span><span class="op" id="1351586">]</span>&nbsp;<span class="op" id="1351588">+=</span>&nbsp;<span class="builtintype" id="1351591">uint32</span><span class="op" id="1351597">(</span><span class="ident" id="1351598">in</span><span class="op" id="1351600">[</span><span class="num" id="1351601">0</span><span class="op" id="1351602">]</span>&nbsp;<span class="op" id="1351604">&gt;&gt;</span>&nbsp;<span class="num" id="1351607">56</span><span class="op" id="1351609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351612">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351631">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351653">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="1351674">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1351677">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="1351736">//</span><br>
<span class="lineno"></span><span class="comment" id="1351739">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="1351773">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="1351798">func</span>&nbsp;<span class="ident" id="1351803">p224Reduce</span><span class="op" id="1351813">(</span><span class="ident" id="1351814">a</span>&nbsp;<span class="op" id="1351816">*</span><span class="ident" id="1351817">p224FieldElement</span><span class="op" id="1351833">)</span>&nbsp;<span class="op" id="1351835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351838">for</span>&nbsp;<span class="ident" id="1351842">i</span>&nbsp;<span class="op" id="1351844">:=</span>&nbsp;<span class="num" id="1351847">0</span><span class="op" id="1351848">;</span>&nbsp;<span class="ident" id="1351850">i</span>&nbsp;<span class="op" id="1351852">&lt;</span>&nbsp;<span class="num" id="1351854">7</span><span class="op" id="1351855">;</span>&nbsp;<span class="ident" id="1351857">i</span><span class="op" id="1351858">++</span>&nbsp;<span class="op" id="1351861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351865">a</span><span class="op" id="1351866">[</span><span class="ident" id="1351867">i</span><span class="op" id="1351868">+</span><span class="num" id="1351869">1</span><span class="op" id="1351870">]</span>&nbsp;<span class="op" id="1351872">+=</span>&nbsp;<span class="ident" id="1351875">a</span><span class="op" id="1351876">[</span><span class="ident" id="1351877">i</span><span class="op" id="1351878">]</span>&nbsp;<span class="op" id="1351880">&gt;&gt;</span>&nbsp;<span class="num" id="1351883">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351888">a</span><span class="op" id="1351889">[</span><span class="ident" id="1351890">i</span><span class="op" id="1351891">]</span>&nbsp;<span class="op" id="1351893">&amp;=</span>&nbsp;<span class="ident" id="1351896">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351910">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351913">top</span>&nbsp;<span class="op" id="1351917">:=</span>&nbsp;<span class="ident" id="1351920">a</span><span class="op" id="1351921">[</span><span class="num" id="1351922">7</span><span class="op" id="1351923">]</span>&nbsp;<span class="op" id="1351925">&gt;&gt;</span>&nbsp;<span class="num" id="1351928">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351932">a</span><span class="op" id="1351933">[</span><span class="num" id="1351934">7</span><span class="op" id="1351935">]</span>&nbsp;<span class="op" id="1351937">&amp;=</span>&nbsp;<span class="ident" id="1351940">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351955">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351970">mask</span>&nbsp;<span class="op" id="1351975">:=</span>&nbsp;<span class="ident" id="1351978">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351983">mask</span>&nbsp;<span class="op" id="1351988">|=</span>&nbsp;<span class="ident" id="1351991">mask</span>&nbsp;<span class="op" id="1351996">&gt;&gt;</span>&nbsp;<span class="num" id="1351999">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352002">mask</span>&nbsp;<span class="op" id="1352007">|=</span>&nbsp;<span class="ident" id="1352010">mask</span>&nbsp;<span class="op" id="1352015">&gt;&gt;</span>&nbsp;<span class="num" id="1352018">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352021">mask</span>&nbsp;<span class="op" id="1352026">&lt;&lt;=</span>&nbsp;<span class="num" id="1352030">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352034">mask</span>&nbsp;<span class="op" id="1352039">=</span>&nbsp;<span class="builtintype" id="1352041">uint32</span><span class="op" id="1352047">(</span><span class="builtintype" id="1352048">int32</span><span class="op" id="1352053">(</span><span class="ident" id="1352054">mask</span><span class="op" id="1352058">)</span>&nbsp;<span class="op" id="1352060">&gt;&gt;</span>&nbsp;<span class="num" id="1352063">31</span><span class="op" id="1352065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1352068">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352122">a</span><span class="op" id="1352123">[</span><span class="num" id="1352124">0</span><span class="op" id="1352125">]</span>&nbsp;<span class="op" id="1352127">-=</span>&nbsp;<span class="ident" id="1352130">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352135">a</span><span class="op" id="1352136">[</span><span class="num" id="1352137">3</span><span class="op" id="1352138">]</span>&nbsp;<span class="op" id="1352140">+=</span>&nbsp;<span class="ident" id="1352143">top</span>&nbsp;<span class="op" id="1352147">&lt;&lt;</span>&nbsp;<span class="num" id="1352150">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1352155">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1352224">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1352294">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352318">a</span><span class="op" id="1352319">[</span><span class="num" id="1352320">3</span><span class="op" id="1352321">]</span>&nbsp;<span class="op" id="1352323">-=</span>&nbsp;<span class="num" id="1352326">1</span>&nbsp;<span class="op" id="1352328">&amp;</span>&nbsp;<span class="ident" id="1352330">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352336">a</span><span class="op" id="1352337">[</span><span class="num" id="1352338">2</span><span class="op" id="1352339">]</span>&nbsp;<span class="op" id="1352341">+=</span>&nbsp;<span class="ident" id="1352344">mask</span>&nbsp;<span class="op" id="1352349">&amp;</span>&nbsp;<span class="op" id="1352351">(</span><span class="num" id="1352352">1</span><span class="op" id="1352353">&lt;&lt;</span><span class="num" id="1352355">28</span>&nbsp;<span class="op" id="1352358">-</span>&nbsp;<span class="num" id="1352360">1</span><span class="op" id="1352361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352364">a</span><span class="op" id="1352365">[</span><span class="num" id="1352366">1</span><span class="op" id="1352367">]</span>&nbsp;<span class="op" id="1352369">+=</span>&nbsp;<span class="ident" id="1352372">mask</span>&nbsp;<span class="op" id="1352377">&amp;</span>&nbsp;<span class="op" id="1352379">(</span><span class="num" id="1352380">1</span><span class="op" id="1352381">&lt;&lt;</span><span class="num" id="1352383">28</span>&nbsp;<span class="op" id="1352386">-</span>&nbsp;<span class="num" id="1352388">1</span><span class="op" id="1352389">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352392">a</span><span class="op" id="1352393">[</span><span class="num" id="1352394">0</span><span class="op" id="1352395">]</span>&nbsp;<span class="op" id="1352397">+=</span>&nbsp;<span class="ident" id="1352400">mask</span>&nbsp;<span class="op" id="1352405">&amp;</span>&nbsp;<span class="op" id="1352407">(</span><span class="num" id="1352408">1</span>&nbsp;<span class="op" id="1352410">&lt;&lt;</span>&nbsp;<span class="num" id="1352413">28</span><span class="op" id="1352415">)</span><br>
<span class="lineno"></span><span class="op" id="1352417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1352420">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="1352498">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="1352531">func</span>&nbsp;<span class="ident" id="1352536">p224Invert</span><span class="op" id="1352546">(</span><span class="ident" id="1352547">out</span><span class="op" id="1352550">,</span>&nbsp;<span class="ident" id="1352552">in</span>&nbsp;<span class="op" id="1352555">*</span><span class="ident" id="1352556">p224FieldElement</span><span class="op" id="1352572">)</span>&nbsp;<span class="op" id="1352574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352577">var</span>&nbsp;<span class="ident" id="1352581">f1</span><span class="op" id="1352583">,</span>&nbsp;<span class="ident" id="1352585">f2</span><span class="op" id="1352587">,</span>&nbsp;<span class="ident" id="1352589">f3</span><span class="op" id="1352591">,</span>&nbsp;<span class="ident" id="1352593">f4</span>&nbsp;<span class="ident" id="1352596">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352614">var</span>&nbsp;<span class="ident" id="1352618">c</span>&nbsp;<span class="ident" id="1352620">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352644">p224Square</span><span class="op" id="1352654">(</span><span class="op" id="1352655">&amp;</span><span class="ident" id="1352656">f1</span><span class="op" id="1352658">,</span>&nbsp;<span class="ident" id="1352660">in</span><span class="op" id="1352662">,</span>&nbsp;<span class="op" id="1352664">&amp;</span><span class="ident" id="1352665">c</span><span class="op" id="1352666">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1352671">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352677">p224Mul</span><span class="op" id="1352684">(</span><span class="op" id="1352685">&amp;</span><span class="ident" id="1352686">f1</span><span class="op" id="1352688">,</span>&nbsp;<span class="op" id="1352690">&amp;</span><span class="ident" id="1352691">f1</span><span class="op" id="1352693">,</span>&nbsp;<span class="ident" id="1352695">in</span><span class="op" id="1352697">,</span>&nbsp;<span class="op" id="1352699">&amp;</span><span class="ident" id="1352700">c</span><span class="op" id="1352701">)</span>&nbsp;&nbsp;<span class="comment" id="1352704">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352717">p224Square</span><span class="op" id="1352727">(</span><span class="op" id="1352728">&amp;</span><span class="ident" id="1352729">f1</span><span class="op" id="1352731">,</span>&nbsp;<span class="op" id="1352733">&amp;</span><span class="ident" id="1352734">f1</span><span class="op" id="1352736">,</span>&nbsp;<span class="op" id="1352738">&amp;</span><span class="ident" id="1352739">c</span><span class="op" id="1352740">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1352744">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352757">p224Mul</span><span class="op" id="1352764">(</span><span class="op" id="1352765">&amp;</span><span class="ident" id="1352766">f1</span><span class="op" id="1352768">,</span>&nbsp;<span class="op" id="1352770">&amp;</span><span class="ident" id="1352771">f1</span><span class="op" id="1352773">,</span>&nbsp;<span class="ident" id="1352775">in</span><span class="op" id="1352777">,</span>&nbsp;<span class="op" id="1352779">&amp;</span><span class="ident" id="1352780">c</span><span class="op" id="1352781">)</span>&nbsp;&nbsp;<span class="comment" id="1352784">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352797">p224Square</span><span class="op" id="1352807">(</span><span class="op" id="1352808">&amp;</span><span class="ident" id="1352809">f2</span><span class="op" id="1352811">,</span>&nbsp;<span class="op" id="1352813">&amp;</span><span class="ident" id="1352814">f1</span><span class="op" id="1352816">,</span>&nbsp;<span class="op" id="1352818">&amp;</span><span class="ident" id="1352819">c</span><span class="op" id="1352820">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1352824">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352837">p224Square</span><span class="op" id="1352847">(</span><span class="op" id="1352848">&amp;</span><span class="ident" id="1352849">f2</span><span class="op" id="1352851">,</span>&nbsp;<span class="op" id="1352853">&amp;</span><span class="ident" id="1352854">f2</span><span class="op" id="1352856">,</span>&nbsp;<span class="op" id="1352858">&amp;</span><span class="ident" id="1352859">c</span><span class="op" id="1352860">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1352864">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352877">p224Square</span><span class="op" id="1352887">(</span><span class="op" id="1352888">&amp;</span><span class="ident" id="1352889">f2</span><span class="op" id="1352891">,</span>&nbsp;<span class="op" id="1352893">&amp;</span><span class="ident" id="1352894">f2</span><span class="op" id="1352896">,</span>&nbsp;<span class="op" id="1352898">&amp;</span><span class="ident" id="1352899">c</span><span class="op" id="1352900">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1352904">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352917">p224Mul</span><span class="op" id="1352924">(</span><span class="op" id="1352925">&amp;</span><span class="ident" id="1352926">f1</span><span class="op" id="1352928">,</span>&nbsp;<span class="op" id="1352930">&amp;</span><span class="ident" id="1352931">f1</span><span class="op" id="1352933">,</span>&nbsp;<span class="op" id="1352935">&amp;</span><span class="ident" id="1352936">f2</span><span class="op" id="1352938">,</span>&nbsp;<span class="op" id="1352940">&amp;</span><span class="ident" id="1352941">c</span><span class="op" id="1352942">)</span>&nbsp;<span class="comment" id="1352944">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352957">p224Square</span><span class="op" id="1352967">(</span><span class="op" id="1352968">&amp;</span><span class="ident" id="1352969">f2</span><span class="op" id="1352971">,</span>&nbsp;<span class="op" id="1352973">&amp;</span><span class="ident" id="1352974">f1</span><span class="op" id="1352976">,</span>&nbsp;<span class="op" id="1352978">&amp;</span><span class="ident" id="1352979">c</span><span class="op" id="1352980">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1352984">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352997">for</span>&nbsp;<span class="ident" id="1353001">i</span>&nbsp;<span class="op" id="1353003">:=</span>&nbsp;<span class="num" id="1353006">0</span><span class="op" id="1353007">;</span>&nbsp;<span class="ident" id="1353009">i</span>&nbsp;<span class="op" id="1353011">&lt;</span>&nbsp;<span class="num" id="1353013">5</span><span class="op" id="1353014">;</span>&nbsp;<span class="ident" id="1353016">i</span><span class="op" id="1353017">++</span>&nbsp;<span class="op" id="1353020">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1353024">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353042">p224Square</span><span class="op" id="1353052">(</span><span class="op" id="1353053">&amp;</span><span class="ident" id="1353054">f2</span><span class="op" id="1353056">,</span>&nbsp;<span class="op" id="1353058">&amp;</span><span class="ident" id="1353059">f2</span><span class="op" id="1353061">,</span>&nbsp;<span class="op" id="1353063">&amp;</span><span class="ident" id="1353064">c</span><span class="op" id="1353065">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353071">p224Mul</span><span class="op" id="1353078">(</span><span class="op" id="1353079">&amp;</span><span class="ident" id="1353080">f2</span><span class="op" id="1353082">,</span>&nbsp;<span class="op" id="1353084">&amp;</span><span class="ident" id="1353085">f2</span><span class="op" id="1353087">,</span>&nbsp;<span class="op" id="1353089">&amp;</span><span class="ident" id="1353090">f1</span><span class="op" id="1353092">,</span>&nbsp;<span class="op" id="1353094">&amp;</span><span class="ident" id="1353095">c</span><span class="op" id="1353096">)</span>&nbsp;<span class="comment" id="1353098">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353112">p224Square</span><span class="op" id="1353122">(</span><span class="op" id="1353123">&amp;</span><span class="ident" id="1353124">f3</span><span class="op" id="1353126">,</span>&nbsp;<span class="op" id="1353128">&amp;</span><span class="ident" id="1353129">f2</span><span class="op" id="1353131">,</span>&nbsp;<span class="op" id="1353133">&amp;</span><span class="ident" id="1353134">c</span><span class="op" id="1353135">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1353139">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353153">for</span>&nbsp;<span class="ident" id="1353157">i</span>&nbsp;<span class="op" id="1353159">:=</span>&nbsp;<span class="num" id="1353162">0</span><span class="op" id="1353163">;</span>&nbsp;<span class="ident" id="1353165">i</span>&nbsp;<span class="op" id="1353167">&lt;</span>&nbsp;<span class="num" id="1353169">11</span><span class="op" id="1353171">;</span>&nbsp;<span class="ident" id="1353173">i</span><span class="op" id="1353174">++</span>&nbsp;<span class="op" id="1353177">{</span>&nbsp;&nbsp;<span class="comment" id="1353180">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353199">p224Square</span><span class="op" id="1353209">(</span><span class="op" id="1353210">&amp;</span><span class="ident" id="1353211">f3</span><span class="op" id="1353213">,</span>&nbsp;<span class="op" id="1353215">&amp;</span><span class="ident" id="1353216">f3</span><span class="op" id="1353218">,</span>&nbsp;<span class="op" id="1353220">&amp;</span><span class="ident" id="1353221">c</span><span class="op" id="1353222">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353228">p224Mul</span><span class="op" id="1353235">(</span><span class="op" id="1353236">&amp;</span><span class="ident" id="1353237">f2</span><span class="op" id="1353239">,</span>&nbsp;<span class="op" id="1353241">&amp;</span><span class="ident" id="1353242">f3</span><span class="op" id="1353244">,</span>&nbsp;<span class="op" id="1353246">&amp;</span><span class="ident" id="1353247">f2</span><span class="op" id="1353249">,</span>&nbsp;<span class="op" id="1353251">&amp;</span><span class="ident" id="1353252">c</span><span class="op" id="1353253">)</span>&nbsp;<span class="comment" id="1353255">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353269">p224Square</span><span class="op" id="1353279">(</span><span class="op" id="1353280">&amp;</span><span class="ident" id="1353281">f3</span><span class="op" id="1353283">,</span>&nbsp;<span class="op" id="1353285">&amp;</span><span class="ident" id="1353286">f2</span><span class="op" id="1353288">,</span>&nbsp;<span class="op" id="1353290">&amp;</span><span class="ident" id="1353291">c</span><span class="op" id="1353292">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1353296">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353310">for</span>&nbsp;<span class="ident" id="1353314">i</span>&nbsp;<span class="op" id="1353316">:=</span>&nbsp;<span class="num" id="1353319">0</span><span class="op" id="1353320">;</span>&nbsp;<span class="ident" id="1353322">i</span>&nbsp;<span class="op" id="1353324">&lt;</span>&nbsp;<span class="num" id="1353326">23</span><span class="op" id="1353328">;</span>&nbsp;<span class="ident" id="1353330">i</span><span class="op" id="1353331">++</span>&nbsp;<span class="op" id="1353334">{</span>&nbsp;&nbsp;<span class="comment" id="1353337">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353356">p224Square</span><span class="op" id="1353366">(</span><span class="op" id="1353367">&amp;</span><span class="ident" id="1353368">f3</span><span class="op" id="1353370">,</span>&nbsp;<span class="op" id="1353372">&amp;</span><span class="ident" id="1353373">f3</span><span class="op" id="1353375">,</span>&nbsp;<span class="op" id="1353377">&amp;</span><span class="ident" id="1353378">c</span><span class="op" id="1353379">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353385">p224Mul</span><span class="op" id="1353392">(</span><span class="op" id="1353393">&amp;</span><span class="ident" id="1353394">f3</span><span class="op" id="1353396">,</span>&nbsp;<span class="op" id="1353398">&amp;</span><span class="ident" id="1353399">f3</span><span class="op" id="1353401">,</span>&nbsp;<span class="op" id="1353403">&amp;</span><span class="ident" id="1353404">f2</span><span class="op" id="1353406">,</span>&nbsp;<span class="op" id="1353408">&amp;</span><span class="ident" id="1353409">c</span><span class="op" id="1353410">)</span>&nbsp;<span class="comment" id="1353412">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353426">p224Square</span><span class="op" id="1353436">(</span><span class="op" id="1353437">&amp;</span><span class="ident" id="1353438">f4</span><span class="op" id="1353440">,</span>&nbsp;<span class="op" id="1353442">&amp;</span><span class="ident" id="1353443">f3</span><span class="op" id="1353445">,</span>&nbsp;<span class="op" id="1353447">&amp;</span><span class="ident" id="1353448">c</span><span class="op" id="1353449">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1353453">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353467">for</span>&nbsp;<span class="ident" id="1353471">i</span>&nbsp;<span class="op" id="1353473">:=</span>&nbsp;<span class="num" id="1353476">0</span><span class="op" id="1353477">;</span>&nbsp;<span class="ident" id="1353479">i</span>&nbsp;<span class="op" id="1353481">&lt;</span>&nbsp;<span class="num" id="1353483">47</span><span class="op" id="1353485">;</span>&nbsp;<span class="ident" id="1353487">i</span><span class="op" id="1353488">++</span>&nbsp;<span class="op" id="1353491">{</span>&nbsp;&nbsp;<span class="comment" id="1353494">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353513">p224Square</span><span class="op" id="1353523">(</span><span class="op" id="1353524">&amp;</span><span class="ident" id="1353525">f4</span><span class="op" id="1353527">,</span>&nbsp;<span class="op" id="1353529">&amp;</span><span class="ident" id="1353530">f4</span><span class="op" id="1353532">,</span>&nbsp;<span class="op" id="1353534">&amp;</span><span class="ident" id="1353535">c</span><span class="op" id="1353536">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353542">p224Mul</span><span class="op" id="1353549">(</span><span class="op" id="1353550">&amp;</span><span class="ident" id="1353551">f3</span><span class="op" id="1353553">,</span>&nbsp;<span class="op" id="1353555">&amp;</span><span class="ident" id="1353556">f3</span><span class="op" id="1353558">,</span>&nbsp;<span class="op" id="1353560">&amp;</span><span class="ident" id="1353561">f4</span><span class="op" id="1353563">,</span>&nbsp;<span class="op" id="1353565">&amp;</span><span class="ident" id="1353566">c</span><span class="op" id="1353567">)</span>&nbsp;<span class="comment" id="1353569">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353583">p224Square</span><span class="op" id="1353593">(</span><span class="op" id="1353594">&amp;</span><span class="ident" id="1353595">f4</span><span class="op" id="1353597">,</span>&nbsp;<span class="op" id="1353599">&amp;</span><span class="ident" id="1353600">f3</span><span class="op" id="1353602">,</span>&nbsp;<span class="op" id="1353604">&amp;</span><span class="ident" id="1353605">c</span><span class="op" id="1353606">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1353610">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353624">for</span>&nbsp;<span class="ident" id="1353628">i</span>&nbsp;<span class="op" id="1353630">:=</span>&nbsp;<span class="num" id="1353633">0</span><span class="op" id="1353634">;</span>&nbsp;<span class="ident" id="1353636">i</span>&nbsp;<span class="op" id="1353638">&lt;</span>&nbsp;<span class="num" id="1353640">23</span><span class="op" id="1353642">;</span>&nbsp;<span class="ident" id="1353644">i</span><span class="op" id="1353645">++</span>&nbsp;<span class="op" id="1353648">{</span>&nbsp;&nbsp;<span class="comment" id="1353651">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353671">p224Square</span><span class="op" id="1353681">(</span><span class="op" id="1353682">&amp;</span><span class="ident" id="1353683">f4</span><span class="op" id="1353685">,</span>&nbsp;<span class="op" id="1353687">&amp;</span><span class="ident" id="1353688">f4</span><span class="op" id="1353690">,</span>&nbsp;<span class="op" id="1353692">&amp;</span><span class="ident" id="1353693">c</span><span class="op" id="1353694">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353700">p224Mul</span><span class="op" id="1353707">(</span><span class="op" id="1353708">&amp;</span><span class="ident" id="1353709">f2</span><span class="op" id="1353711">,</span>&nbsp;<span class="op" id="1353713">&amp;</span><span class="ident" id="1353714">f4</span><span class="op" id="1353716">,</span>&nbsp;<span class="op" id="1353718">&amp;</span><span class="ident" id="1353719">f2</span><span class="op" id="1353721">,</span>&nbsp;<span class="op" id="1353723">&amp;</span><span class="ident" id="1353724">c</span><span class="op" id="1353725">)</span>&nbsp;<span class="comment" id="1353727">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353742">for</span>&nbsp;<span class="ident" id="1353746">i</span>&nbsp;<span class="op" id="1353748">:=</span>&nbsp;<span class="num" id="1353751">0</span><span class="op" id="1353752">;</span>&nbsp;<span class="ident" id="1353754">i</span>&nbsp;<span class="op" id="1353756">&lt;</span>&nbsp;<span class="num" id="1353758">6</span><span class="op" id="1353759">;</span>&nbsp;<span class="ident" id="1353761">i</span><span class="op" id="1353762">++</span>&nbsp;<span class="op" id="1353765">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1353769">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353788">p224Square</span><span class="op" id="1353798">(</span><span class="op" id="1353799">&amp;</span><span class="ident" id="1353800">f2</span><span class="op" id="1353802">,</span>&nbsp;<span class="op" id="1353804">&amp;</span><span class="ident" id="1353805">f2</span><span class="op" id="1353807">,</span>&nbsp;<span class="op" id="1353809">&amp;</span><span class="ident" id="1353810">c</span><span class="op" id="1353811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353814">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353817">p224Mul</span><span class="op" id="1353824">(</span><span class="op" id="1353825">&amp;</span><span class="ident" id="1353826">f1</span><span class="op" id="1353828">,</span>&nbsp;<span class="op" id="1353830">&amp;</span><span class="ident" id="1353831">f1</span><span class="op" id="1353833">,</span>&nbsp;<span class="op" id="1353835">&amp;</span><span class="ident" id="1353836">f2</span><span class="op" id="1353838">,</span>&nbsp;<span class="op" id="1353840">&amp;</span><span class="ident" id="1353841">c</span><span class="op" id="1353842">)</span>&nbsp;<span class="comment" id="1353844">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353859">p224Square</span><span class="op" id="1353869">(</span><span class="op" id="1353870">&amp;</span><span class="ident" id="1353871">f1</span><span class="op" id="1353873">,</span>&nbsp;<span class="op" id="1353875">&amp;</span><span class="ident" id="1353876">f1</span><span class="op" id="1353878">,</span>&nbsp;<span class="op" id="1353880">&amp;</span><span class="ident" id="1353881">c</span><span class="op" id="1353882">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1353886">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353901">p224Mul</span><span class="op" id="1353908">(</span><span class="op" id="1353909">&amp;</span><span class="ident" id="1353910">f1</span><span class="op" id="1353912">,</span>&nbsp;<span class="op" id="1353914">&amp;</span><span class="ident" id="1353915">f1</span><span class="op" id="1353917">,</span>&nbsp;<span class="ident" id="1353919">in</span><span class="op" id="1353921">,</span>&nbsp;<span class="op" id="1353923">&amp;</span><span class="ident" id="1353924">c</span><span class="op" id="1353925">)</span>&nbsp;&nbsp;<span class="comment" id="1353928">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353943">for</span>&nbsp;<span class="ident" id="1353947">i</span>&nbsp;<span class="op" id="1353949">:=</span>&nbsp;<span class="num" id="1353952">0</span><span class="op" id="1353953">;</span>&nbsp;<span class="ident" id="1353955">i</span>&nbsp;<span class="op" id="1353957">&lt;</span>&nbsp;<span class="num" id="1353959">97</span><span class="op" id="1353961">;</span>&nbsp;<span class="ident" id="1353963">i</span><span class="op" id="1353964">++</span>&nbsp;<span class="op" id="1353967">{</span>&nbsp;&nbsp;<span class="comment" id="1353970">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353990">p224Square</span><span class="op" id="1354000">(</span><span class="op" id="1354001">&amp;</span><span class="ident" id="1354002">f1</span><span class="op" id="1354004">,</span>&nbsp;<span class="op" id="1354006">&amp;</span><span class="ident" id="1354007">f1</span><span class="op" id="1354009">,</span>&nbsp;<span class="op" id="1354011">&amp;</span><span class="ident" id="1354012">c</span><span class="op" id="1354013">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354019">p224Mul</span><span class="op" id="1354026">(</span><span class="ident" id="1354027">out</span><span class="op" id="1354030">,</span>&nbsp;<span class="op" id="1354032">&amp;</span><span class="ident" id="1354033">f1</span><span class="op" id="1354035">,</span>&nbsp;<span class="op" id="1354037">&amp;</span><span class="ident" id="1354038">f3</span><span class="op" id="1354040">,</span>&nbsp;<span class="op" id="1354042">&amp;</span><span class="ident" id="1354043">c</span><span class="op" id="1354044">)</span>&nbsp;<span class="comment" id="1354046">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="1354068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1354071">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="1354140">//</span><br>
<span class="lineno"></span><span class="comment" id="1354143">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="1354170">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="1354196">func</span>&nbsp;<span class="ident" id="1354201">p224Contract</span><span class="op" id="1354213">(</span><span class="ident" id="1354214">out</span><span class="op" id="1354217">,</span>&nbsp;<span class="ident" id="1354219">in</span>&nbsp;<span class="op" id="1354222">*</span><span class="ident" id="1354223">p224FieldElement</span><span class="op" id="1354239">)</span>&nbsp;<span class="op" id="1354241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1354244">copy</span><span class="op" id="1354248">(</span><span class="ident" id="1354249">out</span><span class="op" id="1354252">[</span><span class="op" id="1354253">:</span><span class="op" id="1354254">]</span><span class="op" id="1354255">,</span>&nbsp;<span class="ident" id="1354257">in</span><span class="op" id="1354259">[</span><span class="op" id="1354260">:</span><span class="op" id="1354261">]</span><span class="op" id="1354262">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354266">for</span>&nbsp;<span class="ident" id="1354270">i</span>&nbsp;<span class="op" id="1354272">:=</span>&nbsp;<span class="num" id="1354275">0</span><span class="op" id="1354276">;</span>&nbsp;<span class="ident" id="1354278">i</span>&nbsp;<span class="op" id="1354280">&lt;</span>&nbsp;<span class="num" id="1354282">7</span><span class="op" id="1354283">;</span>&nbsp;<span class="ident" id="1354285">i</span><span class="op" id="1354286">++</span>&nbsp;<span class="op" id="1354289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354293">out</span><span class="op" id="1354296">[</span><span class="ident" id="1354297">i</span><span class="op" id="1354298">+</span><span class="num" id="1354299">1</span><span class="op" id="1354300">]</span>&nbsp;<span class="op" id="1354302">+=</span>&nbsp;<span class="ident" id="1354305">out</span><span class="op" id="1354308">[</span><span class="ident" id="1354309">i</span><span class="op" id="1354310">]</span>&nbsp;<span class="op" id="1354312">&gt;&gt;</span>&nbsp;<span class="num" id="1354315">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354320">out</span><span class="op" id="1354323">[</span><span class="ident" id="1354324">i</span><span class="op" id="1354325">]</span>&nbsp;<span class="op" id="1354327">&amp;=</span>&nbsp;<span class="ident" id="1354330">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354344">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354347">top</span>&nbsp;<span class="op" id="1354351">:=</span>&nbsp;<span class="ident" id="1354354">out</span><span class="op" id="1354357">[</span><span class="num" id="1354358">7</span><span class="op" id="1354359">]</span>&nbsp;<span class="op" id="1354361">&gt;&gt;</span>&nbsp;<span class="num" id="1354364">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354368">out</span><span class="op" id="1354371">[</span><span class="num" id="1354372">7</span><span class="op" id="1354373">]</span>&nbsp;<span class="op" id="1354375">&amp;=</span>&nbsp;<span class="ident" id="1354378">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354393">out</span><span class="op" id="1354396">[</span><span class="num" id="1354397">0</span><span class="op" id="1354398">]</span>&nbsp;<span class="op" id="1354400">-=</span>&nbsp;<span class="ident" id="1354403">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354408">out</span><span class="op" id="1354411">[</span><span class="num" id="1354412">3</span><span class="op" id="1354413">]</span>&nbsp;<span class="op" id="1354415">+=</span>&nbsp;<span class="ident" id="1354418">top</span>&nbsp;<span class="op" id="1354422">&lt;&lt;</span>&nbsp;<span class="num" id="1354425">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1354430">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1354502">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1354572">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354605">for</span>&nbsp;<span class="ident" id="1354609">i</span>&nbsp;<span class="op" id="1354611">:=</span>&nbsp;<span class="num" id="1354614">0</span><span class="op" id="1354615">;</span>&nbsp;<span class="ident" id="1354617">i</span>&nbsp;<span class="op" id="1354619">&lt;</span>&nbsp;<span class="num" id="1354621">3</span><span class="op" id="1354622">;</span>&nbsp;<span class="ident" id="1354624">i</span><span class="op" id="1354625">++</span>&nbsp;<span class="op" id="1354628">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354632">mask</span>&nbsp;<span class="op" id="1354637">:=</span>&nbsp;<span class="builtintype" id="1354640">uint32</span><span class="op" id="1354646">(</span><span class="builtintype" id="1354647">int32</span><span class="op" id="1354652">(</span><span class="ident" id="1354653">out</span><span class="op" id="1354656">[</span><span class="ident" id="1354657">i</span><span class="op" id="1354658">]</span><span class="op" id="1354659">)</span>&nbsp;<span class="op" id="1354661">&gt;&gt;</span>&nbsp;<span class="num" id="1354664">31</span><span class="op" id="1354666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354670">out</span><span class="op" id="1354673">[</span><span class="ident" id="1354674">i</span><span class="op" id="1354675">]</span>&nbsp;<span class="op" id="1354677">+=</span>&nbsp;<span class="op" id="1354680">(</span><span class="num" id="1354681">1</span>&nbsp;<span class="op" id="1354683">&lt;&lt;</span>&nbsp;<span class="num" id="1354686">28</span><span class="op" id="1354688">)</span>&nbsp;<span class="op" id="1354690">&amp;</span>&nbsp;<span class="ident" id="1354692">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354699">out</span><span class="op" id="1354702">[</span><span class="ident" id="1354703">i</span><span class="op" id="1354704">+</span><span class="num" id="1354705">1</span><span class="op" id="1354706">]</span>&nbsp;<span class="op" id="1354708">-=</span>&nbsp;<span class="num" id="1354711">1</span>&nbsp;<span class="op" id="1354713">&amp;</span>&nbsp;<span class="ident" id="1354715">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1354725">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1354800">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354817">for</span>&nbsp;<span class="ident" id="1354821">i</span>&nbsp;<span class="op" id="1354823">:=</span>&nbsp;<span class="num" id="1354826">3</span><span class="op" id="1354827">;</span>&nbsp;<span class="ident" id="1354829">i</span>&nbsp;<span class="op" id="1354831">&lt;</span>&nbsp;<span class="num" id="1354833">7</span><span class="op" id="1354834">;</span>&nbsp;<span class="ident" id="1354836">i</span><span class="op" id="1354837">++</span>&nbsp;<span class="op" id="1354840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354844">out</span><span class="op" id="1354847">[</span><span class="ident" id="1354848">i</span><span class="op" id="1354849">+</span><span class="num" id="1354850">1</span><span class="op" id="1354851">]</span>&nbsp;<span class="op" id="1354853">+=</span>&nbsp;<span class="ident" id="1354856">out</span><span class="op" id="1354859">[</span><span class="ident" id="1354860">i</span><span class="op" id="1354861">]</span>&nbsp;<span class="op" id="1354863">&gt;&gt;</span>&nbsp;<span class="num" id="1354866">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354871">out</span><span class="op" id="1354874">[</span><span class="ident" id="1354875">i</span><span class="op" id="1354876">]</span>&nbsp;<span class="op" id="1354878">&amp;=</span>&nbsp;<span class="ident" id="1354881">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354898">top</span>&nbsp;<span class="op" id="1354902">=</span>&nbsp;<span class="ident" id="1354904">out</span><span class="op" id="1354907">[</span><span class="num" id="1354908">7</span><span class="op" id="1354909">]</span>&nbsp;<span class="op" id="1354911">&gt;&gt;</span>&nbsp;<span class="num" id="1354914">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354918">out</span><span class="op" id="1354921">[</span><span class="num" id="1354922">7</span><span class="op" id="1354923">]</span>&nbsp;<span class="op" id="1354925">&amp;=</span>&nbsp;<span class="ident" id="1354928">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1354943">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355001">out</span><span class="op" id="1355004">[</span><span class="num" id="1355005">0</span><span class="op" id="1355006">]</span>&nbsp;<span class="op" id="1355008">-=</span>&nbsp;<span class="ident" id="1355011">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355016">out</span><span class="op" id="1355019">[</span><span class="num" id="1355020">3</span><span class="op" id="1355021">]</span>&nbsp;<span class="op" id="1355023">+=</span>&nbsp;<span class="ident" id="1355026">top</span>&nbsp;<span class="op" id="1355030">&lt;&lt;</span>&nbsp;<span class="num" id="1355033">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355038">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355086">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355161">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355240">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355266">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355344">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355424">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355499">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355575">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355677">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355754">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355824">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355851">for</span>&nbsp;<span class="ident" id="1355855">i</span>&nbsp;<span class="op" id="1355857">:=</span>&nbsp;<span class="num" id="1355860">0</span><span class="op" id="1355861">;</span>&nbsp;<span class="ident" id="1355863">i</span>&nbsp;<span class="op" id="1355865">&lt;</span>&nbsp;<span class="num" id="1355867">3</span><span class="op" id="1355868">;</span>&nbsp;<span class="ident" id="1355870">i</span><span class="op" id="1355871">++</span>&nbsp;<span class="op" id="1355874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355878">mask</span>&nbsp;<span class="op" id="1355883">:=</span>&nbsp;<span class="builtintype" id="1355886">uint32</span><span class="op" id="1355892">(</span><span class="builtintype" id="1355893">int32</span><span class="op" id="1355898">(</span><span class="ident" id="1355899">out</span><span class="op" id="1355902">[</span><span class="ident" id="1355903">i</span><span class="op" id="1355904">]</span><span class="op" id="1355905">)</span>&nbsp;<span class="op" id="1355907">&gt;&gt;</span>&nbsp;<span class="num" id="1355910">31</span><span class="op" id="1355912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355916">out</span><span class="op" id="1355919">[</span><span class="ident" id="1355920">i</span><span class="op" id="1355921">]</span>&nbsp;<span class="op" id="1355923">+=</span>&nbsp;<span class="op" id="1355926">(</span><span class="num" id="1355927">1</span>&nbsp;<span class="op" id="1355929">&lt;&lt;</span>&nbsp;<span class="num" id="1355932">28</span><span class="op" id="1355934">)</span>&nbsp;<span class="op" id="1355936">&amp;</span>&nbsp;<span class="ident" id="1355938">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355945">out</span><span class="op" id="1355948">[</span><span class="ident" id="1355949">i</span><span class="op" id="1355950">+</span><span class="num" id="1355951">1</span><span class="op" id="1355952">]</span>&nbsp;<span class="op" id="1355954">-=</span>&nbsp;<span class="num" id="1355957">1</span>&nbsp;<span class="op" id="1355959">&amp;</span>&nbsp;<span class="ident" id="1355961">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1355971">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1356032">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1356101">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1356170">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1356241">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356251">top4AllOnes</span>&nbsp;<span class="op" id="1356263">:=</span>&nbsp;<span class="builtintype" id="1356266">uint32</span><span class="op" id="1356272">(</span><span class="num" id="1356273">0xffffffff</span><span class="op" id="1356283">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1356286">for</span>&nbsp;<span class="ident" id="1356290">i</span>&nbsp;<span class="op" id="1356292">:=</span>&nbsp;<span class="num" id="1356295">4</span><span class="op" id="1356296">;</span>&nbsp;<span class="ident" id="1356298">i</span>&nbsp;<span class="op" id="1356300">&lt;</span>&nbsp;<span class="num" id="1356302">8</span><span class="op" id="1356303">;</span>&nbsp;<span class="ident" id="1356305">i</span><span class="op" id="1356306">++</span>&nbsp;<span class="op" id="1356309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356313">top4AllOnes</span>&nbsp;<span class="op" id="1356325">&amp;=</span>&nbsp;<span class="ident" id="1356328">out</span><span class="op" id="1356331">[</span><span class="ident" id="1356332">i</span><span class="op" id="1356333">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1356336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356339">top4AllOnes</span>&nbsp;<span class="op" id="1356351">|=</span>&nbsp;<span class="num" id="1356354">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1356366">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356433">top4AllOnes</span>&nbsp;<span class="op" id="1356445">&amp;=</span>&nbsp;<span class="ident" id="1356448">top4AllOnes</span>&nbsp;<span class="op" id="1356460">&gt;&gt;</span>&nbsp;<span class="num" id="1356463">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356467">top4AllOnes</span>&nbsp;<span class="op" id="1356479">&amp;=</span>&nbsp;<span class="ident" id="1356482">top4AllOnes</span>&nbsp;<span class="op" id="1356494">&gt;&gt;</span>&nbsp;<span class="num" id="1356497">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356500">top4AllOnes</span>&nbsp;<span class="op" id="1356512">&amp;=</span>&nbsp;<span class="ident" id="1356515">top4AllOnes</span>&nbsp;<span class="op" id="1356527">&gt;&gt;</span>&nbsp;<span class="num" id="1356530">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356533">top4AllOnes</span>&nbsp;<span class="op" id="1356545">&amp;=</span>&nbsp;<span class="ident" id="1356548">top4AllOnes</span>&nbsp;<span class="op" id="1356560">&gt;&gt;</span>&nbsp;<span class="num" id="1356563">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356566">top4AllOnes</span>&nbsp;<span class="op" id="1356578">&amp;=</span>&nbsp;<span class="ident" id="1356581">top4AllOnes</span>&nbsp;<span class="op" id="1356593">&gt;&gt;</span>&nbsp;<span class="num" id="1356596">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356599">top4AllOnes</span>&nbsp;<span class="op" id="1356611">=</span>&nbsp;<span class="builtintype" id="1356613">uint32</span><span class="op" id="1356619">(</span><span class="builtintype" id="1356620">int32</span><span class="op" id="1356625">(</span><span class="ident" id="1356626">top4AllOnes</span><span class="op" id="1356637">&lt;&lt;</span><span class="num" id="1356639">31</span><span class="op" id="1356641">)</span>&nbsp;<span class="op" id="1356643">&gt;&gt;</span>&nbsp;<span class="num" id="1356646">31</span><span class="op" id="1356648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1356652">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356713">bottom3NonZero</span>&nbsp;<span class="op" id="1356728">:=</span>&nbsp;<span class="ident" id="1356731">out</span><span class="op" id="1356734">[</span><span class="num" id="1356735">0</span><span class="op" id="1356736">]</span>&nbsp;<span class="op" id="1356738">|</span>&nbsp;<span class="ident" id="1356740">out</span><span class="op" id="1356743">[</span><span class="num" id="1356744">1</span><span class="op" id="1356745">]</span>&nbsp;<span class="op" id="1356747">|</span>&nbsp;<span class="ident" id="1356749">out</span><span class="op" id="1356752">[</span><span class="num" id="1356753">2</span><span class="op" id="1356754">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356757">bottom3NonZero</span>&nbsp;<span class="op" id="1356772">|=</span>&nbsp;<span class="ident" id="1356775">bottom3NonZero</span>&nbsp;<span class="op" id="1356790">&gt;&gt;</span>&nbsp;<span class="num" id="1356793">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356797">bottom3NonZero</span>&nbsp;<span class="op" id="1356812">|=</span>&nbsp;<span class="ident" id="1356815">bottom3NonZero</span>&nbsp;<span class="op" id="1356830">&gt;&gt;</span>&nbsp;<span class="num" id="1356833">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356836">bottom3NonZero</span>&nbsp;<span class="op" id="1356851">|=</span>&nbsp;<span class="ident" id="1356854">bottom3NonZero</span>&nbsp;<span class="op" id="1356869">&gt;&gt;</span>&nbsp;<span class="num" id="1356872">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356875">bottom3NonZero</span>&nbsp;<span class="op" id="1356890">|=</span>&nbsp;<span class="ident" id="1356893">bottom3NonZero</span>&nbsp;<span class="op" id="1356908">&gt;&gt;</span>&nbsp;<span class="num" id="1356911">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356914">bottom3NonZero</span>&nbsp;<span class="op" id="1356929">|=</span>&nbsp;<span class="ident" id="1356932">bottom3NonZero</span>&nbsp;<span class="op" id="1356947">&gt;&gt;</span>&nbsp;<span class="num" id="1356950">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356953">bottom3NonZero</span>&nbsp;<span class="op" id="1356968">=</span>&nbsp;<span class="builtintype" id="1356970">uint32</span><span class="op" id="1356976">(</span><span class="builtintype" id="1356977">int32</span><span class="op" id="1356982">(</span><span class="ident" id="1356983">bottom3NonZero</span><span class="op" id="1356997">&lt;&lt;</span><span class="num" id="1356999">31</span><span class="op" id="1357001">)</span>&nbsp;<span class="op" id="1357003">&gt;&gt;</span>&nbsp;<span class="num" id="1357006">31</span><span class="op" id="1357008">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357012">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357059">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357136">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357209">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357247">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357303">n</span>&nbsp;<span class="op" id="1357305">:=</span>&nbsp;<span class="ident" id="1357308">out</span><span class="op" id="1357311">[</span><span class="num" id="1357312">3</span><span class="op" id="1357313">]</span>&nbsp;<span class="op" id="1357315">-</span>&nbsp;<span class="num" id="1357317">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357328">out3Equal</span>&nbsp;<span class="op" id="1357338">:=</span>&nbsp;<span class="ident" id="1357341">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357344">out3Equal</span>&nbsp;<span class="op" id="1357354">|=</span>&nbsp;<span class="ident" id="1357357">out3Equal</span>&nbsp;<span class="op" id="1357367">&gt;&gt;</span>&nbsp;<span class="num" id="1357370">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357374">out3Equal</span>&nbsp;<span class="op" id="1357384">|=</span>&nbsp;<span class="ident" id="1357387">out3Equal</span>&nbsp;<span class="op" id="1357397">&gt;&gt;</span>&nbsp;<span class="num" id="1357400">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357403">out3Equal</span>&nbsp;<span class="op" id="1357413">|=</span>&nbsp;<span class="ident" id="1357416">out3Equal</span>&nbsp;<span class="op" id="1357426">&gt;&gt;</span>&nbsp;<span class="num" id="1357429">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357432">out3Equal</span>&nbsp;<span class="op" id="1357442">|=</span>&nbsp;<span class="ident" id="1357445">out3Equal</span>&nbsp;<span class="op" id="1357455">&gt;&gt;</span>&nbsp;<span class="num" id="1357458">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357461">out3Equal</span>&nbsp;<span class="op" id="1357471">|=</span>&nbsp;<span class="ident" id="1357474">out3Equal</span>&nbsp;<span class="op" id="1357484">&gt;&gt;</span>&nbsp;<span class="num" id="1357487">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357490">out3Equal</span>&nbsp;<span class="op" id="1357500">=</span>&nbsp;<span class="op" id="1357502">^</span><span class="builtintype" id="1357503">uint32</span><span class="op" id="1357509">(</span><span class="builtintype" id="1357510">int32</span><span class="op" id="1357515">(</span><span class="ident" id="1357516">out3Equal</span><span class="op" id="1357525">&lt;&lt;</span><span class="num" id="1357527">31</span><span class="op" id="1357529">)</span>&nbsp;<span class="op" id="1357531">&gt;&gt;</span>&nbsp;<span class="num" id="1357534">31</span><span class="op" id="1357536">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357540">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357593">out3GT</span>&nbsp;<span class="op" id="1357600">:=</span>&nbsp;<span class="op" id="1357603">^</span><span class="builtintype" id="1357604">uint32</span><span class="op" id="1357610">(</span><span class="builtintype" id="1357611">int32</span><span class="op" id="1357616">(</span><span class="ident" id="1357617">n</span><span class="op" id="1357618">)</span>&nbsp;<span class="op" id="1357620">&gt;&gt;</span>&nbsp;<span class="num" id="1357623">31</span><span class="op" id="1357625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357629">mask</span>&nbsp;<span class="op" id="1357634">:=</span>&nbsp;<span class="ident" id="1357637">top4AllOnes</span>&nbsp;<span class="op" id="1357649">&amp;</span>&nbsp;<span class="op" id="1357651">(</span><span class="op" id="1357652">(</span><span class="ident" id="1357653">out3Equal</span>&nbsp;<span class="op" id="1357663">&amp;</span>&nbsp;<span class="ident" id="1357665">bottom3NonZero</span><span class="op" id="1357679">)</span>&nbsp;<span class="op" id="1357681">|</span>&nbsp;<span class="ident" id="1357683">out3GT</span><span class="op" id="1357689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357692">out</span><span class="op" id="1357695">[</span><span class="num" id="1357696">0</span><span class="op" id="1357697">]</span>&nbsp;<span class="op" id="1357699">-=</span>&nbsp;<span class="num" id="1357702">1</span>&nbsp;<span class="op" id="1357704">&amp;</span>&nbsp;<span class="ident" id="1357706">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357712">out</span><span class="op" id="1357715">[</span><span class="num" id="1357716">3</span><span class="op" id="1357717">]</span>&nbsp;<span class="op" id="1357719">-=</span>&nbsp;<span class="num" id="1357722">0xffff000</span>&nbsp;<span class="op" id="1357732">&amp;</span>&nbsp;<span class="ident" id="1357734">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357740">out</span><span class="op" id="1357743">[</span><span class="num" id="1357744">4</span><span class="op" id="1357745">]</span>&nbsp;<span class="op" id="1357747">-=</span>&nbsp;<span class="num" id="1357750">0xfffffff</span>&nbsp;<span class="op" id="1357760">&amp;</span>&nbsp;<span class="ident" id="1357762">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357768">out</span><span class="op" id="1357771">[</span><span class="num" id="1357772">5</span><span class="op" id="1357773">]</span>&nbsp;<span class="op" id="1357775">-=</span>&nbsp;<span class="num" id="1357778">0xfffffff</span>&nbsp;<span class="op" id="1357788">&amp;</span>&nbsp;<span class="ident" id="1357790">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357796">out</span><span class="op" id="1357799">[</span><span class="num" id="1357800">6</span><span class="op" id="1357801">]</span>&nbsp;<span class="op" id="1357803">-=</span>&nbsp;<span class="num" id="1357806">0xfffffff</span>&nbsp;<span class="op" id="1357816">&amp;</span>&nbsp;<span class="ident" id="1357818">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357824">out</span><span class="op" id="1357827">[</span><span class="num" id="1357828">7</span><span class="op" id="1357829">]</span>&nbsp;<span class="op" id="1357831">-=</span>&nbsp;<span class="num" id="1357834">0xfffffff</span>&nbsp;<span class="op" id="1357844">&amp;</span>&nbsp;<span class="ident" id="1357846">mask</span><br>
<span class="lineno">495</span><span class="op" id="1357851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1357854">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="1357882">//</span><br>
<span class="lineno"></span><span class="comment" id="1357885">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="1357961">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1358021">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="1358074">func</span>&nbsp;<span class="ident" id="1358079">p224AddJacobian</span><span class="op" id="1358094">(</span><span class="ident" id="1358095">x3</span><span class="op" id="1358097">,</span>&nbsp;<span class="ident" id="1358099">y3</span><span class="op" id="1358101">,</span>&nbsp;<span class="ident" id="1358103">z3</span><span class="op" id="1358105">,</span>&nbsp;<span class="ident" id="1358107">x1</span><span class="op" id="1358109">,</span>&nbsp;<span class="ident" id="1358111">y1</span><span class="op" id="1358113">,</span>&nbsp;<span class="ident" id="1358115">z1</span><span class="op" id="1358117">,</span>&nbsp;<span class="ident" id="1358119">x2</span><span class="op" id="1358121">,</span>&nbsp;<span class="ident" id="1358123">y2</span><span class="op" id="1358125">,</span>&nbsp;<span class="ident" id="1358127">z2</span>&nbsp;<span class="op" id="1358130">*</span><span class="ident" id="1358131">p224FieldElement</span><span class="op" id="1358147">)</span>&nbsp;<span class="op" id="1358149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358152">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358246">var</span>&nbsp;<span class="ident" id="1358250">z1z1</span><span class="op" id="1358254">,</span>&nbsp;<span class="ident" id="1358256">z2z2</span><span class="op" id="1358260">,</span>&nbsp;<span class="ident" id="1358262">u1</span><span class="op" id="1358264">,</span>&nbsp;<span class="ident" id="1358266">u2</span><span class="op" id="1358268">,</span>&nbsp;<span class="ident" id="1358270">s1</span><span class="op" id="1358272">,</span>&nbsp;<span class="ident" id="1358274">s2</span><span class="op" id="1358276">,</span>&nbsp;<span class="ident" id="1358278">h</span><span class="op" id="1358279">,</span>&nbsp;<span class="ident" id="1358281">i</span><span class="op" id="1358282">,</span>&nbsp;<span class="ident" id="1358284">j</span><span class="op" id="1358285">,</span>&nbsp;<span class="ident" id="1358287">r</span><span class="op" id="1358288">,</span>&nbsp;<span class="ident" id="1358290">v</span>&nbsp;<span class="ident" id="1358292">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358310">var</span>&nbsp;<span class="ident" id="1358314">c</span>&nbsp;<span class="ident" id="1358316">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358340">z1IsZero</span>&nbsp;<span class="op" id="1358349">:=</span>&nbsp;<span class="ident" id="1358352">p224IsZero</span><span class="op" id="1358362">(</span><span class="ident" id="1358363">z1</span><span class="op" id="1358365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358368">z2IsZero</span>&nbsp;<span class="op" id="1358377">:=</span>&nbsp;<span class="ident" id="1358380">p224IsZero</span><span class="op" id="1358390">(</span><span class="ident" id="1358391">z2</span><span class="op" id="1358393">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358397">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358413">p224Square</span><span class="op" id="1358423">(</span><span class="op" id="1358424">&amp;</span><span class="ident" id="1358425">z1z1</span><span class="op" id="1358429">,</span>&nbsp;<span class="ident" id="1358431">z1</span><span class="op" id="1358433">,</span>&nbsp;<span class="op" id="1358435">&amp;</span><span class="ident" id="1358436">c</span><span class="op" id="1358437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358440">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358456">p224Square</span><span class="op" id="1358466">(</span><span class="op" id="1358467">&amp;</span><span class="ident" id="1358468">z2z2</span><span class="op" id="1358472">,</span>&nbsp;<span class="ident" id="1358474">z2</span><span class="op" id="1358476">,</span>&nbsp;<span class="op" id="1358478">&amp;</span><span class="ident" id="1358479">c</span><span class="op" id="1358480">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358483">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358500">p224Mul</span><span class="op" id="1358507">(</span><span class="op" id="1358508">&amp;</span><span class="ident" id="1358509">u1</span><span class="op" id="1358511">,</span>&nbsp;<span class="ident" id="1358513">x1</span><span class="op" id="1358515">,</span>&nbsp;<span class="op" id="1358517">&amp;</span><span class="ident" id="1358518">z2z2</span><span class="op" id="1358522">,</span>&nbsp;<span class="op" id="1358524">&amp;</span><span class="ident" id="1358525">c</span><span class="op" id="1358526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358529">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358546">p224Mul</span><span class="op" id="1358553">(</span><span class="op" id="1358554">&amp;</span><span class="ident" id="1358555">u2</span><span class="op" id="1358557">,</span>&nbsp;<span class="ident" id="1358559">x2</span><span class="op" id="1358561">,</span>&nbsp;<span class="op" id="1358563">&amp;</span><span class="ident" id="1358564">z1z1</span><span class="op" id="1358568">,</span>&nbsp;<span class="op" id="1358570">&amp;</span><span class="ident" id="1358571">c</span><span class="op" id="1358572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358575">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358595">p224Mul</span><span class="op" id="1358602">(</span><span class="op" id="1358603">&amp;</span><span class="ident" id="1358604">s1</span><span class="op" id="1358606">,</span>&nbsp;<span class="ident" id="1358608">z2</span><span class="op" id="1358610">,</span>&nbsp;<span class="op" id="1358612">&amp;</span><span class="ident" id="1358613">z2z2</span><span class="op" id="1358617">,</span>&nbsp;<span class="op" id="1358619">&amp;</span><span class="ident" id="1358620">c</span><span class="op" id="1358621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358624">p224Mul</span><span class="op" id="1358631">(</span><span class="op" id="1358632">&amp;</span><span class="ident" id="1358633">s1</span><span class="op" id="1358635">,</span>&nbsp;<span class="ident" id="1358637">y1</span><span class="op" id="1358639">,</span>&nbsp;<span class="op" id="1358641">&amp;</span><span class="ident" id="1358642">s1</span><span class="op" id="1358644">,</span>&nbsp;<span class="op" id="1358646">&amp;</span><span class="ident" id="1358647">c</span><span class="op" id="1358648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358651">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358671">p224Mul</span><span class="op" id="1358678">(</span><span class="op" id="1358679">&amp;</span><span class="ident" id="1358680">s2</span><span class="op" id="1358682">,</span>&nbsp;<span class="ident" id="1358684">z1</span><span class="op" id="1358686">,</span>&nbsp;<span class="op" id="1358688">&amp;</span><span class="ident" id="1358689">z1z1</span><span class="op" id="1358693">,</span>&nbsp;<span class="op" id="1358695">&amp;</span><span class="ident" id="1358696">c</span><span class="op" id="1358697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358700">p224Mul</span><span class="op" id="1358707">(</span><span class="op" id="1358708">&amp;</span><span class="ident" id="1358709">s2</span><span class="op" id="1358711">,</span>&nbsp;<span class="ident" id="1358713">y2</span><span class="op" id="1358715">,</span>&nbsp;<span class="op" id="1358717">&amp;</span><span class="ident" id="1358718">s2</span><span class="op" id="1358720">,</span>&nbsp;<span class="op" id="1358722">&amp;</span><span class="ident" id="1358723">c</span><span class="op" id="1358724">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358727">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358741">p224Sub</span><span class="op" id="1358748">(</span><span class="op" id="1358749">&amp;</span><span class="ident" id="1358750">h</span><span class="op" id="1358751">,</span>&nbsp;<span class="op" id="1358753">&amp;</span><span class="ident" id="1358754">u2</span><span class="op" id="1358756">,</span>&nbsp;<span class="op" id="1358758">&amp;</span><span class="ident" id="1358759">u1</span><span class="op" id="1358761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358764">p224Reduce</span><span class="op" id="1358774">(</span><span class="op" id="1358775">&amp;</span><span class="ident" id="1358776">h</span><span class="op" id="1358777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358780">xEqual</span>&nbsp;<span class="op" id="1358787">:=</span>&nbsp;<span class="ident" id="1358790">p224IsZero</span><span class="op" id="1358800">(</span><span class="op" id="1358801">&amp;</span><span class="ident" id="1358802">h</span><span class="op" id="1358803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358806">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358822">for</span>&nbsp;<span class="ident" id="1358826">j</span>&nbsp;<span class="op" id="1358828">:=</span>&nbsp;<span class="num" id="1358831">0</span><span class="op" id="1358832">;</span>&nbsp;<span class="ident" id="1358834">j</span>&nbsp;<span class="op" id="1358836">&lt;</span>&nbsp;<span class="num" id="1358838">8</span><span class="op" id="1358839">;</span>&nbsp;<span class="ident" id="1358841">j</span><span class="op" id="1358842">++</span>&nbsp;<span class="op" id="1358845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358849">i</span><span class="op" id="1358850">[</span><span class="ident" id="1358851">j</span><span class="op" id="1358852">]</span>&nbsp;<span class="op" id="1358854">=</span>&nbsp;<span class="ident" id="1358856">h</span><span class="op" id="1358857">[</span><span class="ident" id="1358858">j</span><span class="op" id="1358859">]</span>&nbsp;<span class="op" id="1358861">&lt;&lt;</span>&nbsp;<span class="num" id="1358864">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358870">p224Reduce</span><span class="op" id="1358880">(</span><span class="op" id="1358881">&amp;</span><span class="ident" id="1358882">i</span><span class="op" id="1358883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358886">p224Square</span><span class="op" id="1358896">(</span><span class="op" id="1358897">&amp;</span><span class="ident" id="1358898">i</span><span class="op" id="1358899">,</span>&nbsp;<span class="op" id="1358901">&amp;</span><span class="ident" id="1358902">i</span><span class="op" id="1358903">,</span>&nbsp;<span class="op" id="1358905">&amp;</span><span class="ident" id="1358906">c</span><span class="op" id="1358907">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358910">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358922">p224Mul</span><span class="op" id="1358929">(</span><span class="op" id="1358930">&amp;</span><span class="ident" id="1358931">j</span><span class="op" id="1358932">,</span>&nbsp;<span class="op" id="1358934">&amp;</span><span class="ident" id="1358935">h</span><span class="op" id="1358936">,</span>&nbsp;<span class="op" id="1358938">&amp;</span><span class="ident" id="1358939">i</span><span class="op" id="1358940">,</span>&nbsp;<span class="op" id="1358942">&amp;</span><span class="ident" id="1358943">c</span><span class="op" id="1358944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1358947">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358965">p224Sub</span><span class="op" id="1358972">(</span><span class="op" id="1358973">&amp;</span><span class="ident" id="1358974">r</span><span class="op" id="1358975">,</span>&nbsp;<span class="op" id="1358977">&amp;</span><span class="ident" id="1358978">s2</span><span class="op" id="1358980">,</span>&nbsp;<span class="op" id="1358982">&amp;</span><span class="ident" id="1358983">s1</span><span class="op" id="1358985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358988">p224Reduce</span><span class="op" id="1358998">(</span><span class="op" id="1358999">&amp;</span><span class="ident" id="1359000">r</span><span class="op" id="1359001">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359004">yEqual</span>&nbsp;<span class="op" id="1359011">:=</span>&nbsp;<span class="ident" id="1359014">p224IsZero</span><span class="op" id="1359024">(</span><span class="op" id="1359025">&amp;</span><span class="ident" id="1359026">r</span><span class="op" id="1359027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359030">if</span>&nbsp;<span class="ident" id="1359033">xEqual</span>&nbsp;<span class="op" id="1359040">==</span>&nbsp;<span class="num" id="1359043">1</span>&nbsp;<span class="op" id="1359045">&amp;&amp;</span>&nbsp;<span class="ident" id="1359048">yEqual</span>&nbsp;<span class="op" id="1359055">==</span>&nbsp;<span class="num" id="1359058">1</span>&nbsp;<span class="op" id="1359060">&amp;&amp;</span>&nbsp;<span class="ident" id="1359063">z1IsZero</span>&nbsp;<span class="op" id="1359072">==</span>&nbsp;<span class="num" id="1359075">0</span>&nbsp;<span class="op" id="1359077">&amp;&amp;</span>&nbsp;<span class="ident" id="1359080">z2IsZero</span>&nbsp;<span class="op" id="1359089">==</span>&nbsp;<span class="num" id="1359092">0</span>&nbsp;<span class="op" id="1359094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359098">p224DoubleJacobian</span><span class="op" id="1359116">(</span><span class="ident" id="1359117">x3</span><span class="op" id="1359119">,</span>&nbsp;<span class="ident" id="1359121">y3</span><span class="op" id="1359123">,</span>&nbsp;<span class="ident" id="1359125">z3</span><span class="op" id="1359127">,</span>&nbsp;<span class="ident" id="1359129">x1</span><span class="op" id="1359131">,</span>&nbsp;<span class="ident" id="1359133">y1</span><span class="op" id="1359135">,</span>&nbsp;<span class="ident" id="1359137">z1</span><span class="op" id="1359139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359143">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359151">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359154">for</span>&nbsp;<span class="ident" id="1359158">i</span>&nbsp;<span class="op" id="1359160">:=</span>&nbsp;<span class="num" id="1359163">0</span><span class="op" id="1359164">;</span>&nbsp;<span class="ident" id="1359166">i</span>&nbsp;<span class="op" id="1359168">&lt;</span>&nbsp;<span class="num" id="1359170">8</span><span class="op" id="1359171">;</span>&nbsp;<span class="ident" id="1359173">i</span><span class="op" id="1359174">++</span>&nbsp;<span class="op" id="1359177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359181">r</span><span class="op" id="1359182">[</span><span class="ident" id="1359183">i</span><span class="op" id="1359184">]</span>&nbsp;<span class="op" id="1359186">&lt;&lt;=</span>&nbsp;<span class="num" id="1359190">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359196">p224Reduce</span><span class="op" id="1359206">(</span><span class="op" id="1359207">&amp;</span><span class="ident" id="1359208">r</span><span class="op" id="1359209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1359212">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359225">p224Mul</span><span class="op" id="1359232">(</span><span class="op" id="1359233">&amp;</span><span class="ident" id="1359234">v</span><span class="op" id="1359235">,</span>&nbsp;<span class="op" id="1359237">&amp;</span><span class="ident" id="1359238">u1</span><span class="op" id="1359240">,</span>&nbsp;<span class="op" id="1359242">&amp;</span><span class="ident" id="1359243">i</span><span class="op" id="1359244">,</span>&nbsp;<span class="op" id="1359246">&amp;</span><span class="ident" id="1359247">c</span><span class="op" id="1359248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1359251">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359284">p224Add</span><span class="op" id="1359291">(</span><span class="op" id="1359292">&amp;</span><span class="ident" id="1359293">z1z1</span><span class="op" id="1359297">,</span>&nbsp;<span class="op" id="1359299">&amp;</span><span class="ident" id="1359300">z1z1</span><span class="op" id="1359304">,</span>&nbsp;<span class="op" id="1359306">&amp;</span><span class="ident" id="1359307">z2z2</span><span class="op" id="1359311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359314">p224Add</span><span class="op" id="1359321">(</span><span class="op" id="1359322">&amp;</span><span class="ident" id="1359323">z2z2</span><span class="op" id="1359327">,</span>&nbsp;<span class="ident" id="1359329">z1</span><span class="op" id="1359331">,</span>&nbsp;<span class="ident" id="1359333">z2</span><span class="op" id="1359335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359338">p224Reduce</span><span class="op" id="1359348">(</span><span class="op" id="1359349">&amp;</span><span class="ident" id="1359350">z2z2</span><span class="op" id="1359354">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359357">p224Square</span><span class="op" id="1359367">(</span><span class="op" id="1359368">&amp;</span><span class="ident" id="1359369">z2z2</span><span class="op" id="1359373">,</span>&nbsp;<span class="op" id="1359375">&amp;</span><span class="ident" id="1359376">z2z2</span><span class="op" id="1359380">,</span>&nbsp;<span class="op" id="1359382">&amp;</span><span class="ident" id="1359383">c</span><span class="op" id="1359384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359387">p224Sub</span><span class="op" id="1359394">(</span><span class="ident" id="1359395">z3</span><span class="op" id="1359397">,</span>&nbsp;<span class="op" id="1359399">&amp;</span><span class="ident" id="1359400">z2z2</span><span class="op" id="1359404">,</span>&nbsp;<span class="op" id="1359406">&amp;</span><span class="ident" id="1359407">z1z1</span><span class="op" id="1359411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359414">p224Reduce</span><span class="op" id="1359424">(</span><span class="ident" id="1359425">z3</span><span class="op" id="1359427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359430">p224Mul</span><span class="op" id="1359437">(</span><span class="ident" id="1359438">z3</span><span class="op" id="1359440">,</span>&nbsp;<span class="ident" id="1359442">z3</span><span class="op" id="1359444">,</span>&nbsp;<span class="op" id="1359446">&amp;</span><span class="ident" id="1359447">h</span><span class="op" id="1359448">,</span>&nbsp;<span class="op" id="1359450">&amp;</span><span class="ident" id="1359451">c</span><span class="op" id="1359452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1359455">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359474">for</span>&nbsp;<span class="ident" id="1359478">i</span>&nbsp;<span class="op" id="1359480">:=</span>&nbsp;<span class="num" id="1359483">0</span><span class="op" id="1359484">;</span>&nbsp;<span class="ident" id="1359486">i</span>&nbsp;<span class="op" id="1359488">&lt;</span>&nbsp;<span class="num" id="1359490">8</span><span class="op" id="1359491">;</span>&nbsp;<span class="ident" id="1359493">i</span><span class="op" id="1359494">++</span>&nbsp;<span class="op" id="1359497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359501">z1z1</span><span class="op" id="1359505">[</span><span class="ident" id="1359506">i</span><span class="op" id="1359507">]</span>&nbsp;<span class="op" id="1359509">=</span>&nbsp;<span class="ident" id="1359511">v</span><span class="op" id="1359512">[</span><span class="ident" id="1359513">i</span><span class="op" id="1359514">]</span>&nbsp;<span class="op" id="1359516">&lt;&lt;</span>&nbsp;<span class="num" id="1359519">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359525">p224Add</span><span class="op" id="1359532">(</span><span class="op" id="1359533">&amp;</span><span class="ident" id="1359534">z1z1</span><span class="op" id="1359538">,</span>&nbsp;<span class="op" id="1359540">&amp;</span><span class="ident" id="1359541">j</span><span class="op" id="1359542">,</span>&nbsp;<span class="op" id="1359544">&amp;</span><span class="ident" id="1359545">z1z1</span><span class="op" id="1359549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359552">p224Reduce</span><span class="op" id="1359562">(</span><span class="op" id="1359563">&amp;</span><span class="ident" id="1359564">z1z1</span><span class="op" id="1359568">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359571">p224Square</span><span class="op" id="1359581">(</span><span class="ident" id="1359582">x3</span><span class="op" id="1359584">,</span>&nbsp;<span class="op" id="1359586">&amp;</span><span class="ident" id="1359587">r</span><span class="op" id="1359588">,</span>&nbsp;<span class="op" id="1359590">&amp;</span><span class="ident" id="1359591">c</span><span class="op" id="1359592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359595">p224Sub</span><span class="op" id="1359602">(</span><span class="ident" id="1359603">x3</span><span class="op" id="1359605">,</span>&nbsp;<span class="ident" id="1359607">x3</span><span class="op" id="1359609">,</span>&nbsp;<span class="op" id="1359611">&amp;</span><span class="ident" id="1359612">z1z1</span><span class="op" id="1359616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359619">p224Reduce</span><span class="op" id="1359629">(</span><span class="ident" id="1359630">x3</span><span class="op" id="1359632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1359635">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359660">for</span>&nbsp;<span class="ident" id="1359664">i</span>&nbsp;<span class="op" id="1359666">:=</span>&nbsp;<span class="num" id="1359669">0</span><span class="op" id="1359670">;</span>&nbsp;<span class="ident" id="1359672">i</span>&nbsp;<span class="op" id="1359674">&lt;</span>&nbsp;<span class="num" id="1359676">8</span><span class="op" id="1359677">;</span>&nbsp;<span class="ident" id="1359679">i</span><span class="op" id="1359680">++</span>&nbsp;<span class="op" id="1359683">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359687">s1</span><span class="op" id="1359689">[</span><span class="ident" id="1359690">i</span><span class="op" id="1359691">]</span>&nbsp;<span class="op" id="1359693">&lt;&lt;=</span>&nbsp;<span class="num" id="1359697">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359703">p224Mul</span><span class="op" id="1359710">(</span><span class="op" id="1359711">&amp;</span><span class="ident" id="1359712">s1</span><span class="op" id="1359714">,</span>&nbsp;<span class="op" id="1359716">&amp;</span><span class="ident" id="1359717">s1</span><span class="op" id="1359719">,</span>&nbsp;<span class="op" id="1359721">&amp;</span><span class="ident" id="1359722">j</span><span class="op" id="1359723">,</span>&nbsp;<span class="op" id="1359725">&amp;</span><span class="ident" id="1359726">c</span><span class="op" id="1359727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359730">p224Sub</span><span class="op" id="1359737">(</span><span class="op" id="1359738">&amp;</span><span class="ident" id="1359739">z1z1</span><span class="op" id="1359743">,</span>&nbsp;<span class="op" id="1359745">&amp;</span><span class="ident" id="1359746">v</span><span class="op" id="1359747">,</span>&nbsp;<span class="ident" id="1359749">x3</span><span class="op" id="1359751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359754">p224Reduce</span><span class="op" id="1359764">(</span><span class="op" id="1359765">&amp;</span><span class="ident" id="1359766">z1z1</span><span class="op" id="1359770">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359773">p224Mul</span><span class="op" id="1359780">(</span><span class="op" id="1359781">&amp;</span><span class="ident" id="1359782">z1z1</span><span class="op" id="1359786">,</span>&nbsp;<span class="op" id="1359788">&amp;</span><span class="ident" id="1359789">z1z1</span><span class="op" id="1359793">,</span>&nbsp;<span class="op" id="1359795">&amp;</span><span class="ident" id="1359796">r</span><span class="op" id="1359797">,</span>&nbsp;<span class="op" id="1359799">&amp;</span><span class="ident" id="1359800">c</span><span class="op" id="1359801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359804">p224Sub</span><span class="op" id="1359811">(</span><span class="ident" id="1359812">y3</span><span class="op" id="1359814">,</span>&nbsp;<span class="op" id="1359816">&amp;</span><span class="ident" id="1359817">z1z1</span><span class="op" id="1359821">,</span>&nbsp;<span class="op" id="1359823">&amp;</span><span class="ident" id="1359824">s1</span><span class="op" id="1359826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359829">p224Reduce</span><span class="op" id="1359839">(</span><span class="ident" id="1359840">y3</span><span class="op" id="1359842">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359846">p224CopyConditional</span><span class="op" id="1359865">(</span><span class="ident" id="1359866">x3</span><span class="op" id="1359868">,</span>&nbsp;<span class="ident" id="1359870">x2</span><span class="op" id="1359872">,</span>&nbsp;<span class="ident" id="1359874">z1IsZero</span><span class="op" id="1359882">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359885">p224CopyConditional</span><span class="op" id="1359904">(</span><span class="ident" id="1359905">x3</span><span class="op" id="1359907">,</span>&nbsp;<span class="ident" id="1359909">x1</span><span class="op" id="1359911">,</span>&nbsp;<span class="ident" id="1359913">z2IsZero</span><span class="op" id="1359921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359924">p224CopyConditional</span><span class="op" id="1359943">(</span><span class="ident" id="1359944">y3</span><span class="op" id="1359946">,</span>&nbsp;<span class="ident" id="1359948">y2</span><span class="op" id="1359950">,</span>&nbsp;<span class="ident" id="1359952">z1IsZero</span><span class="op" id="1359960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359963">p224CopyConditional</span><span class="op" id="1359982">(</span><span class="ident" id="1359983">y3</span><span class="op" id="1359985">,</span>&nbsp;<span class="ident" id="1359987">y1</span><span class="op" id="1359989">,</span>&nbsp;<span class="ident" id="1359991">z2IsZero</span><span class="op" id="1359999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360002">p224CopyConditional</span><span class="op" id="1360021">(</span><span class="ident" id="1360022">z3</span><span class="op" id="1360024">,</span>&nbsp;<span class="ident" id="1360026">z2</span><span class="op" id="1360028">,</span>&nbsp;<span class="ident" id="1360030">z1IsZero</span><span class="op" id="1360038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360041">p224CopyConditional</span><span class="op" id="1360060">(</span><span class="ident" id="1360061">z3</span><span class="op" id="1360063">,</span>&nbsp;<span class="ident" id="1360065">z1</span><span class="op" id="1360067">,</span>&nbsp;<span class="ident" id="1360069">z2IsZero</span><span class="op" id="1360077">)</span><br>
<span class="lineno">585</span><span class="op" id="1360079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1360082">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="1360125">func</span>&nbsp;<span class="ident" id="1360130">p224DoubleJacobian</span><span class="op" id="1360148">(</span><span class="ident" id="1360149">x3</span><span class="op" id="1360151">,</span>&nbsp;<span class="ident" id="1360153">y3</span><span class="op" id="1360155">,</span>&nbsp;<span class="ident" id="1360157">z3</span><span class="op" id="1360159">,</span>&nbsp;<span class="ident" id="1360161">x1</span><span class="op" id="1360163">,</span>&nbsp;<span class="ident" id="1360165">y1</span><span class="op" id="1360167">,</span>&nbsp;<span class="ident" id="1360169">z1</span>&nbsp;<span class="op" id="1360172">*</span><span class="ident" id="1360173">p224FieldElement</span><span class="op" id="1360189">)</span>&nbsp;<span class="op" id="1360191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1360194">var</span>&nbsp;<span class="ident" id="1360198">delta</span><span class="op" id="1360203">,</span>&nbsp;<span class="ident" id="1360205">gamma</span><span class="op" id="1360210">,</span>&nbsp;<span class="ident" id="1360212">beta</span><span class="op" id="1360216">,</span>&nbsp;<span class="ident" id="1360218">alpha</span><span class="op" id="1360223">,</span>&nbsp;<span class="ident" id="1360225">t</span>&nbsp;<span class="ident" id="1360227">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1360245">var</span>&nbsp;<span class="ident" id="1360249">c</span>&nbsp;<span class="ident" id="1360251">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360275">p224Square</span><span class="op" id="1360285">(</span><span class="op" id="1360286">&amp;</span><span class="ident" id="1360287">delta</span><span class="op" id="1360292">,</span>&nbsp;<span class="ident" id="1360294">z1</span><span class="op" id="1360296">,</span>&nbsp;<span class="op" id="1360298">&amp;</span><span class="ident" id="1360299">c</span><span class="op" id="1360300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360303">p224Square</span><span class="op" id="1360313">(</span><span class="op" id="1360314">&amp;</span><span class="ident" id="1360315">gamma</span><span class="op" id="1360320">,</span>&nbsp;<span class="ident" id="1360322">y1</span><span class="op" id="1360324">,</span>&nbsp;<span class="op" id="1360326">&amp;</span><span class="ident" id="1360327">c</span><span class="op" id="1360328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360331">p224Mul</span><span class="op" id="1360338">(</span><span class="op" id="1360339">&amp;</span><span class="ident" id="1360340">beta</span><span class="op" id="1360344">,</span>&nbsp;<span class="ident" id="1360346">x1</span><span class="op" id="1360348">,</span>&nbsp;<span class="op" id="1360350">&amp;</span><span class="ident" id="1360351">gamma</span><span class="op" id="1360356">,</span>&nbsp;<span class="op" id="1360358">&amp;</span><span class="ident" id="1360359">c</span><span class="op" id="1360360">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360364">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360400">p224Add</span><span class="op" id="1360407">(</span><span class="op" id="1360408">&amp;</span><span class="ident" id="1360409">t</span><span class="op" id="1360410">,</span>&nbsp;<span class="ident" id="1360412">x1</span><span class="op" id="1360414">,</span>&nbsp;<span class="op" id="1360416">&amp;</span><span class="ident" id="1360417">delta</span><span class="op" id="1360422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1360425">for</span>&nbsp;<span class="ident" id="1360429">i</span>&nbsp;<span class="op" id="1360431">:=</span>&nbsp;<span class="num" id="1360434">0</span><span class="op" id="1360435">;</span>&nbsp;<span class="ident" id="1360437">i</span>&nbsp;<span class="op" id="1360439">&lt;</span>&nbsp;<span class="num" id="1360441">8</span><span class="op" id="1360442">;</span>&nbsp;<span class="ident" id="1360444">i</span><span class="op" id="1360445">++</span>&nbsp;<span class="op" id="1360448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360452">t</span><span class="op" id="1360453">[</span><span class="ident" id="1360454">i</span><span class="op" id="1360455">]</span>&nbsp;<span class="op" id="1360457">+=</span>&nbsp;<span class="ident" id="1360460">t</span><span class="op" id="1360461">[</span><span class="ident" id="1360462">i</span><span class="op" id="1360463">]</span>&nbsp;<span class="op" id="1360465">&lt;&lt;</span>&nbsp;<span class="num" id="1360468">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1360471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360474">p224Reduce</span><span class="op" id="1360484">(</span><span class="op" id="1360485">&amp;</span><span class="ident" id="1360486">t</span><span class="op" id="1360487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360490">p224Sub</span><span class="op" id="1360497">(</span><span class="op" id="1360498">&amp;</span><span class="ident" id="1360499">alpha</span><span class="op" id="1360504">,</span>&nbsp;<span class="ident" id="1360506">x1</span><span class="op" id="1360508">,</span>&nbsp;<span class="op" id="1360510">&amp;</span><span class="ident" id="1360511">delta</span><span class="op" id="1360516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360519">p224Reduce</span><span class="op" id="1360529">(</span><span class="op" id="1360530">&amp;</span><span class="ident" id="1360531">alpha</span><span class="op" id="1360536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360539">p224Mul</span><span class="op" id="1360546">(</span><span class="op" id="1360547">&amp;</span><span class="ident" id="1360548">alpha</span><span class="op" id="1360553">,</span>&nbsp;<span class="op" id="1360555">&amp;</span><span class="ident" id="1360556">alpha</span><span class="op" id="1360561">,</span>&nbsp;<span class="op" id="1360563">&amp;</span><span class="ident" id="1360564">t</span><span class="op" id="1360565">,</span>&nbsp;<span class="op" id="1360567">&amp;</span><span class="ident" id="1360568">c</span><span class="op" id="1360569">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360573">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360604">p224Add</span><span class="op" id="1360611">(</span><span class="ident" id="1360612">z3</span><span class="op" id="1360614">,</span>&nbsp;<span class="ident" id="1360616">y1</span><span class="op" id="1360618">,</span>&nbsp;<span class="ident" id="1360620">z1</span><span class="op" id="1360622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360625">p224Reduce</span><span class="op" id="1360635">(</span><span class="ident" id="1360636">z3</span><span class="op" id="1360638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360641">p224Square</span><span class="op" id="1360651">(</span><span class="ident" id="1360652">z3</span><span class="op" id="1360654">,</span>&nbsp;<span class="ident" id="1360656">z3</span><span class="op" id="1360658">,</span>&nbsp;<span class="op" id="1360660">&amp;</span><span class="ident" id="1360661">c</span><span class="op" id="1360662">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360665">p224Sub</span><span class="op" id="1360672">(</span><span class="ident" id="1360673">z3</span><span class="op" id="1360675">,</span>&nbsp;<span class="ident" id="1360677">z3</span><span class="op" id="1360679">,</span>&nbsp;<span class="op" id="1360681">&amp;</span><span class="ident" id="1360682">gamma</span><span class="op" id="1360687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360690">p224Reduce</span><span class="op" id="1360700">(</span><span class="ident" id="1360701">z3</span><span class="op" id="1360703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360706">p224Sub</span><span class="op" id="1360713">(</span><span class="ident" id="1360714">z3</span><span class="op" id="1360716">,</span>&nbsp;<span class="ident" id="1360718">z3</span><span class="op" id="1360720">,</span>&nbsp;<span class="op" id="1360722">&amp;</span><span class="ident" id="1360723">delta</span><span class="op" id="1360728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360731">p224Reduce</span><span class="op" id="1360741">(</span><span class="ident" id="1360742">z3</span><span class="op" id="1360744">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360748">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1360772">for</span>&nbsp;<span class="ident" id="1360776">i</span>&nbsp;<span class="op" id="1360778">:=</span>&nbsp;<span class="num" id="1360781">0</span><span class="op" id="1360782">;</span>&nbsp;<span class="ident" id="1360784">i</span>&nbsp;<span class="op" id="1360786">&lt;</span>&nbsp;<span class="num" id="1360788">8</span><span class="op" id="1360789">;</span>&nbsp;<span class="ident" id="1360791">i</span><span class="op" id="1360792">++</span>&nbsp;<span class="op" id="1360795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360799">delta</span><span class="op" id="1360804">[</span><span class="ident" id="1360805">i</span><span class="op" id="1360806">]</span>&nbsp;<span class="op" id="1360808">=</span>&nbsp;<span class="ident" id="1360810">beta</span><span class="op" id="1360814">[</span><span class="ident" id="1360815">i</span><span class="op" id="1360816">]</span>&nbsp;<span class="op" id="1360818">&lt;&lt;</span>&nbsp;<span class="num" id="1360821">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1360824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360827">p224Reduce</span><span class="op" id="1360837">(</span><span class="op" id="1360838">&amp;</span><span class="ident" id="1360839">delta</span><span class="op" id="1360844">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360847">p224Square</span><span class="op" id="1360857">(</span><span class="ident" id="1360858">x3</span><span class="op" id="1360860">,</span>&nbsp;<span class="op" id="1360862">&amp;</span><span class="ident" id="1360863">alpha</span><span class="op" id="1360868">,</span>&nbsp;<span class="op" id="1360870">&amp;</span><span class="ident" id="1360871">c</span><span class="op" id="1360872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360875">p224Sub</span><span class="op" id="1360882">(</span><span class="ident" id="1360883">x3</span><span class="op" id="1360885">,</span>&nbsp;<span class="ident" id="1360887">x3</span><span class="op" id="1360889">,</span>&nbsp;<span class="op" id="1360891">&amp;</span><span class="ident" id="1360892">delta</span><span class="op" id="1360897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360900">p224Reduce</span><span class="op" id="1360910">(</span><span class="ident" id="1360911">x3</span><span class="op" id="1360913">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360917">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1360954">for</span>&nbsp;<span class="ident" id="1360958">i</span>&nbsp;<span class="op" id="1360960">:=</span>&nbsp;<span class="num" id="1360963">0</span><span class="op" id="1360964">;</span>&nbsp;<span class="ident" id="1360966">i</span>&nbsp;<span class="op" id="1360968">&lt;</span>&nbsp;<span class="num" id="1360970">8</span><span class="op" id="1360971">;</span>&nbsp;<span class="ident" id="1360973">i</span><span class="op" id="1360974">++</span>&nbsp;<span class="op" id="1360977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360981">beta</span><span class="op" id="1360985">[</span><span class="ident" id="1360986">i</span><span class="op" id="1360987">]</span>&nbsp;<span class="op" id="1360989">&lt;&lt;=</span>&nbsp;<span class="num" id="1360993">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1360996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360999">p224Sub</span><span class="op" id="1361006">(</span><span class="op" id="1361007">&amp;</span><span class="ident" id="1361008">beta</span><span class="op" id="1361012">,</span>&nbsp;<span class="op" id="1361014">&amp;</span><span class="ident" id="1361015">beta</span><span class="op" id="1361019">,</span>&nbsp;<span class="ident" id="1361021">x3</span><span class="op" id="1361023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361026">p224Reduce</span><span class="op" id="1361036">(</span><span class="op" id="1361037">&amp;</span><span class="ident" id="1361038">beta</span><span class="op" id="1361042">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361045">p224Square</span><span class="op" id="1361055">(</span><span class="op" id="1361056">&amp;</span><span class="ident" id="1361057">gamma</span><span class="op" id="1361062">,</span>&nbsp;<span class="op" id="1361064">&amp;</span><span class="ident" id="1361065">gamma</span><span class="op" id="1361070">,</span>&nbsp;<span class="op" id="1361072">&amp;</span><span class="ident" id="1361073">c</span><span class="op" id="1361074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361077">for</span>&nbsp;<span class="ident" id="1361081">i</span>&nbsp;<span class="op" id="1361083">:=</span>&nbsp;<span class="num" id="1361086">0</span><span class="op" id="1361087">;</span>&nbsp;<span class="ident" id="1361089">i</span>&nbsp;<span class="op" id="1361091">&lt;</span>&nbsp;<span class="num" id="1361093">8</span><span class="op" id="1361094">;</span>&nbsp;<span class="ident" id="1361096">i</span><span class="op" id="1361097">++</span>&nbsp;<span class="op" id="1361100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361104">gamma</span><span class="op" id="1361109">[</span><span class="ident" id="1361110">i</span><span class="op" id="1361111">]</span>&nbsp;<span class="op" id="1361113">&lt;&lt;=</span>&nbsp;<span class="num" id="1361117">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1361120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361123">p224Reduce</span><span class="op" id="1361133">(</span><span class="op" id="1361134">&amp;</span><span class="ident" id="1361135">gamma</span><span class="op" id="1361140">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361143">p224Mul</span><span class="op" id="1361150">(</span><span class="ident" id="1361151">y3</span><span class="op" id="1361153">,</span>&nbsp;<span class="op" id="1361155">&amp;</span><span class="ident" id="1361156">alpha</span><span class="op" id="1361161">,</span>&nbsp;<span class="op" id="1361163">&amp;</span><span class="ident" id="1361164">beta</span><span class="op" id="1361168">,</span>&nbsp;<span class="op" id="1361170">&amp;</span><span class="ident" id="1361171">c</span><span class="op" id="1361172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361175">p224Sub</span><span class="op" id="1361182">(</span><span class="ident" id="1361183">y3</span><span class="op" id="1361185">,</span>&nbsp;<span class="ident" id="1361187">y3</span><span class="op" id="1361189">,</span>&nbsp;<span class="op" id="1361191">&amp;</span><span class="ident" id="1361192">gamma</span><span class="op" id="1361197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361200">p224Reduce</span><span class="op" id="1361210">(</span><span class="ident" id="1361211">y3</span><span class="op" id="1361213">)</span><br>
<span class="lineno"></span><span class="op" id="1361215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="1361218">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="1361298">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="1361340">func</span>&nbsp;<span class="ident" id="1361345">p224CopyConditional</span><span class="op" id="1361364">(</span><span class="ident" id="1361365">out</span><span class="op" id="1361368">,</span>&nbsp;<span class="ident" id="1361370">in</span>&nbsp;<span class="op" id="1361373">*</span><span class="ident" id="1361374">p224FieldElement</span><span class="op" id="1361390">,</span>&nbsp;<span class="ident" id="1361392">control</span>&nbsp;<span class="builtintype" id="1361400">uint32</span><span class="op" id="1361406">)</span>&nbsp;<span class="op" id="1361408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361411">control</span>&nbsp;<span class="op" id="1361419">&lt;&lt;=</span>&nbsp;<span class="num" id="1361423">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361427">control</span>&nbsp;<span class="op" id="1361435">=</span>&nbsp;<span class="builtintype" id="1361437">uint32</span><span class="op" id="1361443">(</span><span class="builtintype" id="1361444">int32</span><span class="op" id="1361449">(</span><span class="ident" id="1361450">control</span><span class="op" id="1361457">)</span>&nbsp;<span class="op" id="1361459">&gt;&gt;</span>&nbsp;<span class="num" id="1361462">31</span><span class="op" id="1361464">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361468">for</span>&nbsp;<span class="ident" id="1361472">i</span>&nbsp;<span class="op" id="1361474">:=</span>&nbsp;<span class="num" id="1361477">0</span><span class="op" id="1361478">;</span>&nbsp;<span class="ident" id="1361480">i</span>&nbsp;<span class="op" id="1361482">&lt;</span>&nbsp;<span class="num" id="1361484">8</span><span class="op" id="1361485">;</span>&nbsp;<span class="ident" id="1361487">i</span><span class="op" id="1361488">++</span>&nbsp;<span class="op" id="1361491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361495">out</span><span class="op" id="1361498">[</span><span class="ident" id="1361499">i</span><span class="op" id="1361500">]</span>&nbsp;<span class="op" id="1361502">^=</span>&nbsp;<span class="op" id="1361505">(</span><span class="ident" id="1361506">out</span><span class="op" id="1361509">[</span><span class="ident" id="1361510">i</span><span class="op" id="1361511">]</span>&nbsp;<span class="op" id="1361513">^</span>&nbsp;<span class="ident" id="1361515">in</span><span class="op" id="1361517">[</span><span class="ident" id="1361518">i</span><span class="op" id="1361519">]</span><span class="op" id="1361520">)</span>&nbsp;<span class="op" id="1361522">&amp;</span>&nbsp;<span class="ident" id="1361524">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1361533">}</span><br>
<span class="lineno"></span><span class="op" id="1361535">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="1361538">func</span>&nbsp;<span class="ident" id="1361543">p224ScalarMult</span><span class="op" id="1361557">(</span><span class="ident" id="1361558">outX</span><span class="op" id="1361562">,</span>&nbsp;<span class="ident" id="1361564">outY</span><span class="op" id="1361568">,</span>&nbsp;<span class="ident" id="1361570">outZ</span><span class="op" id="1361574">,</span>&nbsp;<span class="ident" id="1361576">inX</span><span class="op" id="1361579">,</span>&nbsp;<span class="ident" id="1361581">inY</span><span class="op" id="1361584">,</span>&nbsp;<span class="ident" id="1361586">inZ</span>&nbsp;<span class="op" id="1361590">*</span><span class="ident" id="1361591">p224FieldElement</span><span class="op" id="1361607">,</span>&nbsp;<span class="ident" id="1361609">scalar</span>&nbsp;<span class="op" id="1361616">[</span><span class="op" id="1361617">]</span><span class="builtintype" id="1361618">byte</span><span class="op" id="1361622">)</span>&nbsp;<span class="op" id="1361624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361627">var</span>&nbsp;<span class="ident" id="1361631">xx</span><span class="op" id="1361633">,</span>&nbsp;<span class="ident" id="1361635">yy</span><span class="op" id="1361637">,</span>&nbsp;<span class="ident" id="1361639">zz</span>&nbsp;<span class="ident" id="1361642">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361660">for</span>&nbsp;<span class="ident" id="1361664">i</span>&nbsp;<span class="op" id="1361666">:=</span>&nbsp;<span class="num" id="1361669">0</span><span class="op" id="1361670">;</span>&nbsp;<span class="ident" id="1361672">i</span>&nbsp;<span class="op" id="1361674">&lt;</span>&nbsp;<span class="num" id="1361676">8</span><span class="op" id="1361677">;</span>&nbsp;<span class="ident" id="1361679">i</span><span class="op" id="1361680">++</span>&nbsp;<span class="op" id="1361683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361687">outX</span><span class="op" id="1361691">[</span><span class="ident" id="1361692">i</span><span class="op" id="1361693">]</span>&nbsp;<span class="op" id="1361695">=</span>&nbsp;<span class="num" id="1361697">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361701">outY</span><span class="op" id="1361705">[</span><span class="ident" id="1361706">i</span><span class="op" id="1361707">]</span>&nbsp;<span class="op" id="1361709">=</span>&nbsp;<span class="num" id="1361711">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361715">outZ</span><span class="op" id="1361719">[</span><span class="ident" id="1361720">i</span><span class="op" id="1361721">]</span>&nbsp;<span class="op" id="1361723">=</span>&nbsp;<span class="num" id="1361725">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1361728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361732">for</span>&nbsp;<span class="ident" id="1361736">_</span><span class="op" id="1361737">,</span>&nbsp;<span class="builtintype" id="1361739">byte</span>&nbsp;<span class="op" id="1361744">:=</span>&nbsp;<span class="keyword" id="1361747">range</span>&nbsp;<span class="ident" id="1361753">scalar</span>&nbsp;<span class="op" id="1361760">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361764">for</span>&nbsp;<span class="ident" id="1361768">bitNum</span>&nbsp;<span class="op" id="1361775">:=</span>&nbsp;<span class="builtintype" id="1361778">uint</span><span class="op" id="1361782">(</span><span class="num" id="1361783">0</span><span class="op" id="1361784">)</span><span class="op" id="1361785">;</span>&nbsp;<span class="ident" id="1361787">bitNum</span>&nbsp;<span class="op" id="1361794">&lt;</span>&nbsp;<span class="num" id="1361796">8</span><span class="op" id="1361797">;</span>&nbsp;<span class="ident" id="1361799">bitNum</span><span class="op" id="1361805">++</span>&nbsp;<span class="op" id="1361808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361813">p224DoubleJacobian</span><span class="op" id="1361831">(</span><span class="ident" id="1361832">outX</span><span class="op" id="1361836">,</span>&nbsp;<span class="ident" id="1361838">outY</span><span class="op" id="1361842">,</span>&nbsp;<span class="ident" id="1361844">outZ</span><span class="op" id="1361848">,</span>&nbsp;<span class="ident" id="1361850">outX</span><span class="op" id="1361854">,</span>&nbsp;<span class="ident" id="1361856">outY</span><span class="op" id="1361860">,</span>&nbsp;<span class="ident" id="1361862">outZ</span><span class="op" id="1361866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361871">bit</span>&nbsp;<span class="op" id="1361875">:=</span>&nbsp;<span class="builtintype" id="1361878">uint32</span><span class="op" id="1361884">(</span><span class="op" id="1361885">(</span><span class="builtintype" id="1361886">byte</span>&nbsp;<span class="op" id="1361891">&gt;&gt;</span>&nbsp;<span class="op" id="1361894">(</span><span class="num" id="1361895">7</span>&nbsp;<span class="op" id="1361897">-</span>&nbsp;<span class="ident" id="1361899">bitNum</span><span class="op" id="1361905">)</span><span class="op" id="1361906">)</span>&nbsp;<span class="op" id="1361908">&amp;</span>&nbsp;<span class="num" id="1361910">1</span><span class="op" id="1361911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361916">p224AddJacobian</span><span class="op" id="1361931">(</span><span class="op" id="1361932">&amp;</span><span class="ident" id="1361933">xx</span><span class="op" id="1361935">,</span>&nbsp;<span class="op" id="1361937">&amp;</span><span class="ident" id="1361938">yy</span><span class="op" id="1361940">,</span>&nbsp;<span class="op" id="1361942">&amp;</span><span class="ident" id="1361943">zz</span><span class="op" id="1361945">,</span>&nbsp;<span class="ident" id="1361947">inX</span><span class="op" id="1361950">,</span>&nbsp;<span class="ident" id="1361952">inY</span><span class="op" id="1361955">,</span>&nbsp;<span class="ident" id="1361957">inZ</span><span class="op" id="1361960">,</span>&nbsp;<span class="ident" id="1361962">outX</span><span class="op" id="1361966">,</span>&nbsp;<span class="ident" id="1361968">outY</span><span class="op" id="1361972">,</span>&nbsp;<span class="ident" id="1361974">outZ</span><span class="op" id="1361978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361983">p224CopyConditional</span><span class="op" id="1362002">(</span><span class="ident" id="1362003">outX</span><span class="op" id="1362007">,</span>&nbsp;<span class="op" id="1362009">&amp;</span><span class="ident" id="1362010">xx</span><span class="op" id="1362012">,</span>&nbsp;<span class="ident" id="1362014">bit</span><span class="op" id="1362017">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362022">p224CopyConditional</span><span class="op" id="1362041">(</span><span class="ident" id="1362042">outY</span><span class="op" id="1362046">,</span>&nbsp;<span class="op" id="1362048">&amp;</span><span class="ident" id="1362049">yy</span><span class="op" id="1362051">,</span>&nbsp;<span class="ident" id="1362053">bit</span><span class="op" id="1362056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362061">p224CopyConditional</span><span class="op" id="1362080">(</span><span class="ident" id="1362081">outZ</span><span class="op" id="1362085">,</span>&nbsp;<span class="op" id="1362087">&amp;</span><span class="ident" id="1362088">zz</span><span class="op" id="1362090">,</span>&nbsp;<span class="ident" id="1362092">bit</span><span class="op" id="1362095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1362099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1362102">}</span><br>
<span class="lineno"></span><span class="op" id="1362104">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="1362107">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="1362162">func</span>&nbsp;<span class="ident" id="1362167">p224ToAffine</span><span class="op" id="1362179">(</span><span class="ident" id="1362180">x</span><span class="op" id="1362181">,</span>&nbsp;<span class="ident" id="1362183">y</span><span class="op" id="1362184">,</span>&nbsp;<span class="ident" id="1362186">z</span>&nbsp;<span class="op" id="1362188">*</span><span class="ident" id="1362189">p224FieldElement</span><span class="op" id="1362205">)</span>&nbsp;<span class="op" id="1362207">(</span><span class="op" id="1362208">*</span><span class="ident" id="1362209">big</span><span class="op" id="1362212">.</span><span class="ident" id="1362213">Int</span><span class="op" id="1362216">,</span>&nbsp;<span class="op" id="1362218">*</span><span class="ident" id="1362219">big</span><span class="op" id="1362222">.</span><span class="ident" id="1362223">Int</span><span class="op" id="1362226">)</span>&nbsp;<span class="op" id="1362228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362231">var</span>&nbsp;<span class="ident" id="1362235">zinv</span><span class="op" id="1362239">,</span>&nbsp;<span class="ident" id="1362241">zinvsq</span><span class="op" id="1362247">,</span>&nbsp;<span class="ident" id="1362249">outx</span><span class="op" id="1362253">,</span>&nbsp;<span class="ident" id="1362255">outy</span>&nbsp;<span class="ident" id="1362260">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362278">var</span>&nbsp;<span class="ident" id="1362282">tmp</span>&nbsp;<span class="ident" id="1362286">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362310">if</span>&nbsp;<span class="ident" id="1362313">isPointAtInfinity</span>&nbsp;<span class="op" id="1362331">:=</span>&nbsp;<span class="ident" id="1362334">p224IsZero</span><span class="op" id="1362344">(</span><span class="ident" id="1362345">z</span><span class="op" id="1362346">)</span><span class="op" id="1362347">;</span>&nbsp;<span class="ident" id="1362349">isPointAtInfinity</span>&nbsp;<span class="op" id="1362367">==</span>&nbsp;<span class="num" id="1362370">1</span>&nbsp;<span class="op" id="1362372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362376">return</span>&nbsp;<span class="builtinfunc" id="1362383">new</span><span class="op" id="1362386">(</span><span class="ident" id="1362387">big</span><span class="op" id="1362390">.</span><span class="ident" id="1362391">Int</span><span class="op" id="1362394">)</span><span class="op" id="1362395">,</span>&nbsp;<span class="builtinfunc" id="1362397">new</span><span class="op" id="1362400">(</span><span class="ident" id="1362401">big</span><span class="op" id="1362404">.</span><span class="ident" id="1362405">Int</span><span class="op" id="1362408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1362411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362415">p224Invert</span><span class="op" id="1362425">(</span><span class="op" id="1362426">&amp;</span><span class="ident" id="1362427">zinv</span><span class="op" id="1362431">,</span>&nbsp;<span class="ident" id="1362433">z</span><span class="op" id="1362434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362437">p224Square</span><span class="op" id="1362447">(</span><span class="op" id="1362448">&amp;</span><span class="ident" id="1362449">zinvsq</span><span class="op" id="1362455">,</span>&nbsp;<span class="op" id="1362457">&amp;</span><span class="ident" id="1362458">zinv</span><span class="op" id="1362462">,</span>&nbsp;<span class="op" id="1362464">&amp;</span><span class="ident" id="1362465">tmp</span><span class="op" id="1362468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362471">p224Mul</span><span class="op" id="1362478">(</span><span class="ident" id="1362479">x</span><span class="op" id="1362480">,</span>&nbsp;<span class="ident" id="1362482">x</span><span class="op" id="1362483">,</span>&nbsp;<span class="op" id="1362485">&amp;</span><span class="ident" id="1362486">zinvsq</span><span class="op" id="1362492">,</span>&nbsp;<span class="op" id="1362494">&amp;</span><span class="ident" id="1362495">tmp</span><span class="op" id="1362498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362501">p224Mul</span><span class="op" id="1362508">(</span><span class="op" id="1362509">&amp;</span><span class="ident" id="1362510">zinvsq</span><span class="op" id="1362516">,</span>&nbsp;<span class="op" id="1362518">&amp;</span><span class="ident" id="1362519">zinvsq</span><span class="op" id="1362525">,</span>&nbsp;<span class="op" id="1362527">&amp;</span><span class="ident" id="1362528">zinv</span><span class="op" id="1362532">,</span>&nbsp;<span class="op" id="1362534">&amp;</span><span class="ident" id="1362535">tmp</span><span class="op" id="1362538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362541">p224Mul</span><span class="op" id="1362548">(</span><span class="ident" id="1362549">y</span><span class="op" id="1362550">,</span>&nbsp;<span class="ident" id="1362552">y</span><span class="op" id="1362553">,</span>&nbsp;<span class="op" id="1362555">&amp;</span><span class="ident" id="1362556">zinvsq</span><span class="op" id="1362562">,</span>&nbsp;<span class="op" id="1362564">&amp;</span><span class="ident" id="1362565">tmp</span><span class="op" id="1362568">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362572">p224Contract</span><span class="op" id="1362584">(</span><span class="op" id="1362585">&amp;</span><span class="ident" id="1362586">outx</span><span class="op" id="1362590">,</span>&nbsp;<span class="ident" id="1362592">x</span><span class="op" id="1362593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362596">p224Contract</span><span class="op" id="1362608">(</span><span class="op" id="1362609">&amp;</span><span class="ident" id="1362610">outy</span><span class="op" id="1362614">,</span>&nbsp;<span class="ident" id="1362616">y</span><span class="op" id="1362617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362620">return</span>&nbsp;<span class="ident" id="1362627">p224ToBig</span><span class="op" id="1362636">(</span><span class="op" id="1362637">&amp;</span><span class="ident" id="1362638">outx</span><span class="op" id="1362642">)</span><span class="op" id="1362643">,</span>&nbsp;<span class="ident" id="1362645">p224ToBig</span><span class="op" id="1362654">(</span><span class="op" id="1362655">&amp;</span><span class="ident" id="1362656">outy</span><span class="op" id="1362660">)</span><br>
<span class="lineno"></span><span class="op" id="1362662">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="1362665">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="1362740">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="1362792">func</span>&nbsp;<span class="ident" id="1362797">get28BitsFromEnd</span><span class="op" id="1362813">(</span><span class="ident" id="1362814">buf</span>&nbsp;<span class="op" id="1362818">[</span><span class="op" id="1362819">]</span><span class="builtintype" id="1362820">byte</span><span class="op" id="1362824">,</span>&nbsp;<span class="ident" id="1362826">shift</span>&nbsp;<span class="builtintype" id="1362832">uint</span><span class="op" id="1362836">)</span>&nbsp;<span class="op" id="1362838">(</span><span class="builtintype" id="1362839">uint32</span><span class="op" id="1362845">,</span>&nbsp;<span class="op" id="1362847">[</span><span class="op" id="1362848">]</span><span class="builtintype" id="1362849">byte</span><span class="op" id="1362853">)</span>&nbsp;<span class="op" id="1362855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362858">var</span>&nbsp;<span class="ident" id="1362862">ret</span>&nbsp;<span class="builtintype" id="1362866">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362875">for</span>&nbsp;<span class="ident" id="1362879">i</span>&nbsp;<span class="op" id="1362881">:=</span>&nbsp;<span class="builtintype" id="1362884">uint</span><span class="op" id="1362888">(</span><span class="num" id="1362889">0</span><span class="op" id="1362890">)</span><span class="op" id="1362891">;</span>&nbsp;<span class="ident" id="1362893">i</span>&nbsp;<span class="op" id="1362895">&lt;</span>&nbsp;<span class="num" id="1362897">4</span><span class="op" id="1362898">;</span>&nbsp;<span class="ident" id="1362900">i</span><span class="op" id="1362901">++</span>&nbsp;<span class="op" id="1362904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362908">var</span>&nbsp;<span class="ident" id="1362912">b</span>&nbsp;<span class="builtintype" id="1362914">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362921">if</span>&nbsp;<span class="ident" id="1362924">l</span>&nbsp;<span class="op" id="1362926">:=</span>&nbsp;<span class="builtinfunc" id="1362929">len</span><span class="op" id="1362932">(</span><span class="ident" id="1362933">buf</span><span class="op" id="1362936">)</span><span class="op" id="1362937">;</span>&nbsp;<span class="ident" id="1362939">l</span>&nbsp;<span class="op" id="1362941">&gt;</span>&nbsp;<span class="num" id="1362943">0</span>&nbsp;<span class="op" id="1362945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362950">b</span>&nbsp;<span class="op" id="1362952">=</span>&nbsp;<span class="ident" id="1362954">buf</span><span class="op" id="1362957">[</span><span class="ident" id="1362958">l</span><span class="op" id="1362959">-</span><span class="num" id="1362960">1</span><span class="op" id="1362961">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1362966">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1363036">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363061">if</span>&nbsp;<span class="ident" id="1363064">i</span>&nbsp;<span class="op" id="1363066">!=</span>&nbsp;<span class="num" id="1363069">3</span>&nbsp;<span class="op" id="1363071">||</span>&nbsp;<span class="ident" id="1363074">shift</span>&nbsp;<span class="op" id="1363080">==</span>&nbsp;<span class="num" id="1363083">4</span>&nbsp;<span class="op" id="1363085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363091">buf</span>&nbsp;<span class="op" id="1363095">=</span>&nbsp;<span class="ident" id="1363097">buf</span><span class="op" id="1363100">[</span><span class="op" id="1363101">:</span><span class="ident" id="1363102">l</span><span class="op" id="1363103">-</span><span class="num" id="1363104">1</span><span class="op" id="1363105">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1363110">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1363114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363118">ret</span>&nbsp;<span class="op" id="1363122">|=</span>&nbsp;<span class="builtintype" id="1363125">uint32</span><span class="op" id="1363131">(</span><span class="ident" id="1363132">b</span><span class="op" id="1363133">)</span>&nbsp;<span class="op" id="1363135">&lt;&lt;</span>&nbsp;<span class="op" id="1363138">(</span><span class="num" id="1363139">8</span>&nbsp;<span class="op" id="1363141">*</span>&nbsp;<span class="ident" id="1363143">i</span><span class="op" id="1363144">)</span>&nbsp;<span class="op" id="1363146">&gt;&gt;</span>&nbsp;<span class="ident" id="1363149">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1363156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363159">ret</span>&nbsp;<span class="op" id="1363163">&amp;=</span>&nbsp;<span class="ident" id="1363166">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363180">return</span>&nbsp;<span class="ident" id="1363187">ret</span><span class="op" id="1363190">,</span>&nbsp;<span class="ident" id="1363192">buf</span><br>
<span class="lineno">710</span><span class="op" id="1363196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1363199">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="1363231">func</span>&nbsp;<span class="ident" id="1363236">p224FromBig</span><span class="op" id="1363247">(</span><span class="ident" id="1363248">out</span>&nbsp;<span class="op" id="1363252">*</span><span class="ident" id="1363253">p224FieldElement</span><span class="op" id="1363269">,</span>&nbsp;<span class="ident" id="1363271">in</span>&nbsp;<span class="op" id="1363274">*</span><span class="ident" id="1363275">big</span><span class="op" id="1363278">.</span><span class="ident" id="1363279">Int</span><span class="op" id="1363282">)</span>&nbsp;<span class="op" id="1363284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363287">bytes</span>&nbsp;<span class="op" id="1363293">:=</span>&nbsp;<span class="ident" id="1363296">in</span><span class="op" id="1363298">.</span><span class="ident" id="1363299">Bytes</span><span class="op" id="1363304">(</span><span class="op" id="1363305">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363308">out</span><span class="op" id="1363311">[</span><span class="num" id="1363312">0</span><span class="op" id="1363313">]</span><span class="op" id="1363314">,</span>&nbsp;<span class="ident" id="1363316">bytes</span>&nbsp;<span class="op" id="1363322">=</span>&nbsp;<span class="ident" id="1363324">get28BitsFromEnd</span><span class="op" id="1363340">(</span><span class="ident" id="1363341">bytes</span><span class="op" id="1363346">,</span>&nbsp;<span class="num" id="1363348">0</span><span class="op" id="1363349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363352">out</span><span class="op" id="1363355">[</span><span class="num" id="1363356">1</span><span class="op" id="1363357">]</span><span class="op" id="1363358">,</span>&nbsp;<span class="ident" id="1363360">bytes</span>&nbsp;<span class="op" id="1363366">=</span>&nbsp;<span class="ident" id="1363368">get28BitsFromEnd</span><span class="op" id="1363384">(</span><span class="ident" id="1363385">bytes</span><span class="op" id="1363390">,</span>&nbsp;<span class="num" id="1363392">4</span><span class="op" id="1363393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363396">out</span><span class="op" id="1363399">[</span><span class="num" id="1363400">2</span><span class="op" id="1363401">]</span><span class="op" id="1363402">,</span>&nbsp;<span class="ident" id="1363404">bytes</span>&nbsp;<span class="op" id="1363410">=</span>&nbsp;<span class="ident" id="1363412">get28BitsFromEnd</span><span class="op" id="1363428">(</span><span class="ident" id="1363429">bytes</span><span class="op" id="1363434">,</span>&nbsp;<span class="num" id="1363436">0</span><span class="op" id="1363437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363440">out</span><span class="op" id="1363443">[</span><span class="num" id="1363444">3</span><span class="op" id="1363445">]</span><span class="op" id="1363446">,</span>&nbsp;<span class="ident" id="1363448">bytes</span>&nbsp;<span class="op" id="1363454">=</span>&nbsp;<span class="ident" id="1363456">get28BitsFromEnd</span><span class="op" id="1363472">(</span><span class="ident" id="1363473">bytes</span><span class="op" id="1363478">,</span>&nbsp;<span class="num" id="1363480">4</span><span class="op" id="1363481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363484">out</span><span class="op" id="1363487">[</span><span class="num" id="1363488">4</span><span class="op" id="1363489">]</span><span class="op" id="1363490">,</span>&nbsp;<span class="ident" id="1363492">bytes</span>&nbsp;<span class="op" id="1363498">=</span>&nbsp;<span class="ident" id="1363500">get28BitsFromEnd</span><span class="op" id="1363516">(</span><span class="ident" id="1363517">bytes</span><span class="op" id="1363522">,</span>&nbsp;<span class="num" id="1363524">0</span><span class="op" id="1363525">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363528">out</span><span class="op" id="1363531">[</span><span class="num" id="1363532">5</span><span class="op" id="1363533">]</span><span class="op" id="1363534">,</span>&nbsp;<span class="ident" id="1363536">bytes</span>&nbsp;<span class="op" id="1363542">=</span>&nbsp;<span class="ident" id="1363544">get28BitsFromEnd</span><span class="op" id="1363560">(</span><span class="ident" id="1363561">bytes</span><span class="op" id="1363566">,</span>&nbsp;<span class="num" id="1363568">4</span><span class="op" id="1363569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363572">out</span><span class="op" id="1363575">[</span><span class="num" id="1363576">6</span><span class="op" id="1363577">]</span><span class="op" id="1363578">,</span>&nbsp;<span class="ident" id="1363580">bytes</span>&nbsp;<span class="op" id="1363586">=</span>&nbsp;<span class="ident" id="1363588">get28BitsFromEnd</span><span class="op" id="1363604">(</span><span class="ident" id="1363605">bytes</span><span class="op" id="1363610">,</span>&nbsp;<span class="num" id="1363612">0</span><span class="op" id="1363613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363616">out</span><span class="op" id="1363619">[</span><span class="num" id="1363620">7</span><span class="op" id="1363621">]</span><span class="op" id="1363622">,</span>&nbsp;<span class="ident" id="1363624">bytes</span>&nbsp;<span class="op" id="1363630">=</span>&nbsp;<span class="ident" id="1363632">get28BitsFromEnd</span><span class="op" id="1363648">(</span><span class="ident" id="1363649">bytes</span><span class="op" id="1363654">,</span>&nbsp;<span class="num" id="1363656">4</span><span class="op" id="1363657">)</span><br>
<span class="lineno"></span><span class="op" id="1363659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="1363662">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="1363700">func</span>&nbsp;<span class="ident" id="1363705">p224ToBig</span><span class="op" id="1363714">(</span><span class="ident" id="1363715">in</span>&nbsp;<span class="op" id="1363718">*</span><span class="ident" id="1363719">p224FieldElement</span><span class="op" id="1363735">)</span>&nbsp;<span class="op" id="1363737">*</span><span class="ident" id="1363738">big</span><span class="op" id="1363741">.</span><span class="ident" id="1363742">Int</span>&nbsp;<span class="op" id="1363746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363749">var</span>&nbsp;<span class="ident" id="1363753">buf</span>&nbsp;<span class="op" id="1363757">[</span><span class="num" id="1363758">28</span><span class="op" id="1363760">]</span><span class="builtintype" id="1363761">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363767">buf</span><span class="op" id="1363770">[</span><span class="num" id="1363771">27</span><span class="op" id="1363773">]</span>&nbsp;<span class="op" id="1363775">=</span>&nbsp;<span class="builtintype" id="1363777">byte</span><span class="op" id="1363781">(</span><span class="ident" id="1363782">in</span><span class="op" id="1363784">[</span><span class="num" id="1363785">0</span><span class="op" id="1363786">]</span><span class="op" id="1363787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363790">buf</span><span class="op" id="1363793">[</span><span class="num" id="1363794">26</span><span class="op" id="1363796">]</span>&nbsp;<span class="op" id="1363798">=</span>&nbsp;<span class="builtintype" id="1363800">byte</span><span class="op" id="1363804">(</span><span class="ident" id="1363805">in</span><span class="op" id="1363807">[</span><span class="num" id="1363808">0</span><span class="op" id="1363809">]</span>&nbsp;<span class="op" id="1363811">&gt;&gt;</span>&nbsp;<span class="num" id="1363814">8</span><span class="op" id="1363815">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363818">buf</span><span class="op" id="1363821">[</span><span class="num" id="1363822">25</span><span class="op" id="1363824">]</span>&nbsp;<span class="op" id="1363826">=</span>&nbsp;<span class="builtintype" id="1363828">byte</span><span class="op" id="1363832">(</span><span class="ident" id="1363833">in</span><span class="op" id="1363835">[</span><span class="num" id="1363836">0</span><span class="op" id="1363837">]</span>&nbsp;<span class="op" id="1363839">&gt;&gt;</span>&nbsp;<span class="num" id="1363842">16</span><span class="op" id="1363844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363847">buf</span><span class="op" id="1363850">[</span><span class="num" id="1363851">24</span><span class="op" id="1363853">]</span>&nbsp;<span class="op" id="1363855">=</span>&nbsp;<span class="builtintype" id="1363857">byte</span><span class="op" id="1363861">(</span><span class="op" id="1363862">(</span><span class="op" id="1363863">(</span><span class="ident" id="1363864">in</span><span class="op" id="1363866">[</span><span class="num" id="1363867">0</span><span class="op" id="1363868">]</span>&nbsp;<span class="op" id="1363870">&gt;&gt;</span>&nbsp;<span class="num" id="1363873">24</span><span class="op" id="1363875">)</span>&nbsp;<span class="op" id="1363877">&amp;</span>&nbsp;<span class="num" id="1363879">0x0f</span><span class="op" id="1363883">)</span>&nbsp;<span class="op" id="1363885">|</span>&nbsp;<span class="op" id="1363887">(</span><span class="ident" id="1363888">in</span><span class="op" id="1363890">[</span><span class="num" id="1363891">1</span><span class="op" id="1363892">]</span><span class="op" id="1363893">&lt;&lt;</span><span class="num" id="1363895">4</span><span class="op" id="1363896">)</span><span class="op" id="1363897">&amp;</span><span class="num" id="1363898">0xf0</span><span class="op" id="1363902">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363906">buf</span><span class="op" id="1363909">[</span><span class="num" id="1363910">23</span><span class="op" id="1363912">]</span>&nbsp;<span class="op" id="1363914">=</span>&nbsp;<span class="builtintype" id="1363916">byte</span><span class="op" id="1363920">(</span><span class="ident" id="1363921">in</span><span class="op" id="1363923">[</span><span class="num" id="1363924">1</span><span class="op" id="1363925">]</span>&nbsp;<span class="op" id="1363927">&gt;&gt;</span>&nbsp;<span class="num" id="1363930">4</span><span class="op" id="1363931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363934">buf</span><span class="op" id="1363937">[</span><span class="num" id="1363938">22</span><span class="op" id="1363940">]</span>&nbsp;<span class="op" id="1363942">=</span>&nbsp;<span class="builtintype" id="1363944">byte</span><span class="op" id="1363948">(</span><span class="ident" id="1363949">in</span><span class="op" id="1363951">[</span><span class="num" id="1363952">1</span><span class="op" id="1363953">]</span>&nbsp;<span class="op" id="1363955">&gt;&gt;</span>&nbsp;<span class="num" id="1363958">12</span><span class="op" id="1363960">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363963">buf</span><span class="op" id="1363966">[</span><span class="num" id="1363967">21</span><span class="op" id="1363969">]</span>&nbsp;<span class="op" id="1363971">=</span>&nbsp;<span class="builtintype" id="1363973">byte</span><span class="op" id="1363977">(</span><span class="ident" id="1363978">in</span><span class="op" id="1363980">[</span><span class="num" id="1363981">1</span><span class="op" id="1363982">]</span>&nbsp;<span class="op" id="1363984">&gt;&gt;</span>&nbsp;<span class="num" id="1363987">20</span><span class="op" id="1363989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363993">buf</span><span class="op" id="1363996">[</span><span class="num" id="1363997">20</span><span class="op" id="1363999">]</span>&nbsp;<span class="op" id="1364001">=</span>&nbsp;<span class="builtintype" id="1364003">byte</span><span class="op" id="1364007">(</span><span class="ident" id="1364008">in</span><span class="op" id="1364010">[</span><span class="num" id="1364011">2</span><span class="op" id="1364012">]</span><span class="op" id="1364013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364016">buf</span><span class="op" id="1364019">[</span><span class="num" id="1364020">19</span><span class="op" id="1364022">]</span>&nbsp;<span class="op" id="1364024">=</span>&nbsp;<span class="builtintype" id="1364026">byte</span><span class="op" id="1364030">(</span><span class="ident" id="1364031">in</span><span class="op" id="1364033">[</span><span class="num" id="1364034">2</span><span class="op" id="1364035">]</span>&nbsp;<span class="op" id="1364037">&gt;&gt;</span>&nbsp;<span class="num" id="1364040">8</span><span class="op" id="1364041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364044">buf</span><span class="op" id="1364047">[</span><span class="num" id="1364048">18</span><span class="op" id="1364050">]</span>&nbsp;<span class="op" id="1364052">=</span>&nbsp;<span class="builtintype" id="1364054">byte</span><span class="op" id="1364058">(</span><span class="ident" id="1364059">in</span><span class="op" id="1364061">[</span><span class="num" id="1364062">2</span><span class="op" id="1364063">]</span>&nbsp;<span class="op" id="1364065">&gt;&gt;</span>&nbsp;<span class="num" id="1364068">16</span><span class="op" id="1364070">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364073">buf</span><span class="op" id="1364076">[</span><span class="num" id="1364077">17</span><span class="op" id="1364079">]</span>&nbsp;<span class="op" id="1364081">=</span>&nbsp;<span class="builtintype" id="1364083">byte</span><span class="op" id="1364087">(</span><span class="op" id="1364088">(</span><span class="op" id="1364089">(</span><span class="ident" id="1364090">in</span><span class="op" id="1364092">[</span><span class="num" id="1364093">2</span><span class="op" id="1364094">]</span>&nbsp;<span class="op" id="1364096">&gt;&gt;</span>&nbsp;<span class="num" id="1364099">24</span><span class="op" id="1364101">)</span>&nbsp;<span class="op" id="1364103">&amp;</span>&nbsp;<span class="num" id="1364105">0x0f</span><span class="op" id="1364109">)</span>&nbsp;<span class="op" id="1364111">|</span>&nbsp;<span class="op" id="1364113">(</span><span class="ident" id="1364114">in</span><span class="op" id="1364116">[</span><span class="num" id="1364117">3</span><span class="op" id="1364118">]</span><span class="op" id="1364119">&lt;&lt;</span><span class="num" id="1364121">4</span><span class="op" id="1364122">)</span><span class="op" id="1364123">&amp;</span><span class="num" id="1364124">0xf0</span><span class="op" id="1364128">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364132">buf</span><span class="op" id="1364135">[</span><span class="num" id="1364136">16</span><span class="op" id="1364138">]</span>&nbsp;<span class="op" id="1364140">=</span>&nbsp;<span class="builtintype" id="1364142">byte</span><span class="op" id="1364146">(</span><span class="ident" id="1364147">in</span><span class="op" id="1364149">[</span><span class="num" id="1364150">3</span><span class="op" id="1364151">]</span>&nbsp;<span class="op" id="1364153">&gt;&gt;</span>&nbsp;<span class="num" id="1364156">4</span><span class="op" id="1364157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364160">buf</span><span class="op" id="1364163">[</span><span class="num" id="1364164">15</span><span class="op" id="1364166">]</span>&nbsp;<span class="op" id="1364168">=</span>&nbsp;<span class="builtintype" id="1364170">byte</span><span class="op" id="1364174">(</span><span class="ident" id="1364175">in</span><span class="op" id="1364177">[</span><span class="num" id="1364178">3</span><span class="op" id="1364179">]</span>&nbsp;<span class="op" id="1364181">&gt;&gt;</span>&nbsp;<span class="num" id="1364184">12</span><span class="op" id="1364186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364189">buf</span><span class="op" id="1364192">[</span><span class="num" id="1364193">14</span><span class="op" id="1364195">]</span>&nbsp;<span class="op" id="1364197">=</span>&nbsp;<span class="builtintype" id="1364199">byte</span><span class="op" id="1364203">(</span><span class="ident" id="1364204">in</span><span class="op" id="1364206">[</span><span class="num" id="1364207">3</span><span class="op" id="1364208">]</span>&nbsp;<span class="op" id="1364210">&gt;&gt;</span>&nbsp;<span class="num" id="1364213">20</span><span class="op" id="1364215">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364219">buf</span><span class="op" id="1364222">[</span><span class="num" id="1364223">13</span><span class="op" id="1364225">]</span>&nbsp;<span class="op" id="1364227">=</span>&nbsp;<span class="builtintype" id="1364229">byte</span><span class="op" id="1364233">(</span><span class="ident" id="1364234">in</span><span class="op" id="1364236">[</span><span class="num" id="1364237">4</span><span class="op" id="1364238">]</span><span class="op" id="1364239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364242">buf</span><span class="op" id="1364245">[</span><span class="num" id="1364246">12</span><span class="op" id="1364248">]</span>&nbsp;<span class="op" id="1364250">=</span>&nbsp;<span class="builtintype" id="1364252">byte</span><span class="op" id="1364256">(</span><span class="ident" id="1364257">in</span><span class="op" id="1364259">[</span><span class="num" id="1364260">4</span><span class="op" id="1364261">]</span>&nbsp;<span class="op" id="1364263">&gt;&gt;</span>&nbsp;<span class="num" id="1364266">8</span><span class="op" id="1364267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364270">buf</span><span class="op" id="1364273">[</span><span class="num" id="1364274">11</span><span class="op" id="1364276">]</span>&nbsp;<span class="op" id="1364278">=</span>&nbsp;<span class="builtintype" id="1364280">byte</span><span class="op" id="1364284">(</span><span class="ident" id="1364285">in</span><span class="op" id="1364287">[</span><span class="num" id="1364288">4</span><span class="op" id="1364289">]</span>&nbsp;<span class="op" id="1364291">&gt;&gt;</span>&nbsp;<span class="num" id="1364294">16</span><span class="op" id="1364296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364299">buf</span><span class="op" id="1364302">[</span><span class="num" id="1364303">10</span><span class="op" id="1364305">]</span>&nbsp;<span class="op" id="1364307">=</span>&nbsp;<span class="builtintype" id="1364309">byte</span><span class="op" id="1364313">(</span><span class="op" id="1364314">(</span><span class="op" id="1364315">(</span><span class="ident" id="1364316">in</span><span class="op" id="1364318">[</span><span class="num" id="1364319">4</span><span class="op" id="1364320">]</span>&nbsp;<span class="op" id="1364322">&gt;&gt;</span>&nbsp;<span class="num" id="1364325">24</span><span class="op" id="1364327">)</span>&nbsp;<span class="op" id="1364329">&amp;</span>&nbsp;<span class="num" id="1364331">0x0f</span><span class="op" id="1364335">)</span>&nbsp;<span class="op" id="1364337">|</span>&nbsp;<span class="op" id="1364339">(</span><span class="ident" id="1364340">in</span><span class="op" id="1364342">[</span><span class="num" id="1364343">5</span><span class="op" id="1364344">]</span><span class="op" id="1364345">&lt;&lt;</span><span class="num" id="1364347">4</span><span class="op" id="1364348">)</span><span class="op" id="1364349">&amp;</span><span class="num" id="1364350">0xf0</span><span class="op" id="1364354">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364358">buf</span><span class="op" id="1364361">[</span><span class="num" id="1364362">9</span><span class="op" id="1364363">]</span>&nbsp;<span class="op" id="1364365">=</span>&nbsp;<span class="builtintype" id="1364367">byte</span><span class="op" id="1364371">(</span><span class="ident" id="1364372">in</span><span class="op" id="1364374">[</span><span class="num" id="1364375">5</span><span class="op" id="1364376">]</span>&nbsp;<span class="op" id="1364378">&gt;&gt;</span>&nbsp;<span class="num" id="1364381">4</span><span class="op" id="1364382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364385">buf</span><span class="op" id="1364388">[</span><span class="num" id="1364389">8</span><span class="op" id="1364390">]</span>&nbsp;<span class="op" id="1364392">=</span>&nbsp;<span class="builtintype" id="1364394">byte</span><span class="op" id="1364398">(</span><span class="ident" id="1364399">in</span><span class="op" id="1364401">[</span><span class="num" id="1364402">5</span><span class="op" id="1364403">]</span>&nbsp;<span class="op" id="1364405">&gt;&gt;</span>&nbsp;<span class="num" id="1364408">12</span><span class="op" id="1364410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364413">buf</span><span class="op" id="1364416">[</span><span class="num" id="1364417">7</span><span class="op" id="1364418">]</span>&nbsp;<span class="op" id="1364420">=</span>&nbsp;<span class="builtintype" id="1364422">byte</span><span class="op" id="1364426">(</span><span class="ident" id="1364427">in</span><span class="op" id="1364429">[</span><span class="num" id="1364430">5</span><span class="op" id="1364431">]</span>&nbsp;<span class="op" id="1364433">&gt;&gt;</span>&nbsp;<span class="num" id="1364436">20</span><span class="op" id="1364438">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364442">buf</span><span class="op" id="1364445">[</span><span class="num" id="1364446">6</span><span class="op" id="1364447">]</span>&nbsp;<span class="op" id="1364449">=</span>&nbsp;<span class="builtintype" id="1364451">byte</span><span class="op" id="1364455">(</span><span class="ident" id="1364456">in</span><span class="op" id="1364458">[</span><span class="num" id="1364459">6</span><span class="op" id="1364460">]</span><span class="op" id="1364461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364464">buf</span><span class="op" id="1364467">[</span><span class="num" id="1364468">5</span><span class="op" id="1364469">]</span>&nbsp;<span class="op" id="1364471">=</span>&nbsp;<span class="builtintype" id="1364473">byte</span><span class="op" id="1364477">(</span><span class="ident" id="1364478">in</span><span class="op" id="1364480">[</span><span class="num" id="1364481">6</span><span class="op" id="1364482">]</span>&nbsp;<span class="op" id="1364484">&gt;&gt;</span>&nbsp;<span class="num" id="1364487">8</span><span class="op" id="1364488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364491">buf</span><span class="op" id="1364494">[</span><span class="num" id="1364495">4</span><span class="op" id="1364496">]</span>&nbsp;<span class="op" id="1364498">=</span>&nbsp;<span class="builtintype" id="1364500">byte</span><span class="op" id="1364504">(</span><span class="ident" id="1364505">in</span><span class="op" id="1364507">[</span><span class="num" id="1364508">6</span><span class="op" id="1364509">]</span>&nbsp;<span class="op" id="1364511">&gt;&gt;</span>&nbsp;<span class="num" id="1364514">16</span><span class="op" id="1364516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364519">buf</span><span class="op" id="1364522">[</span><span class="num" id="1364523">3</span><span class="op" id="1364524">]</span>&nbsp;<span class="op" id="1364526">=</span>&nbsp;<span class="builtintype" id="1364528">byte</span><span class="op" id="1364532">(</span><span class="op" id="1364533">(</span><span class="op" id="1364534">(</span><span class="ident" id="1364535">in</span><span class="op" id="1364537">[</span><span class="num" id="1364538">6</span><span class="op" id="1364539">]</span>&nbsp;<span class="op" id="1364541">&gt;&gt;</span>&nbsp;<span class="num" id="1364544">24</span><span class="op" id="1364546">)</span>&nbsp;<span class="op" id="1364548">&amp;</span>&nbsp;<span class="num" id="1364550">0x0f</span><span class="op" id="1364554">)</span>&nbsp;<span class="op" id="1364556">|</span>&nbsp;<span class="op" id="1364558">(</span><span class="ident" id="1364559">in</span><span class="op" id="1364561">[</span><span class="num" id="1364562">7</span><span class="op" id="1364563">]</span><span class="op" id="1364564">&lt;&lt;</span><span class="num" id="1364566">4</span><span class="op" id="1364567">)</span><span class="op" id="1364568">&amp;</span><span class="num" id="1364569">0xf0</span><span class="op" id="1364573">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364577">buf</span><span class="op" id="1364580">[</span><span class="num" id="1364581">2</span><span class="op" id="1364582">]</span>&nbsp;<span class="op" id="1364584">=</span>&nbsp;<span class="builtintype" id="1364586">byte</span><span class="op" id="1364590">(</span><span class="ident" id="1364591">in</span><span class="op" id="1364593">[</span><span class="num" id="1364594">7</span><span class="op" id="1364595">]</span>&nbsp;<span class="op" id="1364597">&gt;&gt;</span>&nbsp;<span class="num" id="1364600">4</span><span class="op" id="1364601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364604">buf</span><span class="op" id="1364607">[</span><span class="num" id="1364608">1</span><span class="op" id="1364609">]</span>&nbsp;<span class="op" id="1364611">=</span>&nbsp;<span class="builtintype" id="1364613">byte</span><span class="op" id="1364617">(</span><span class="ident" id="1364618">in</span><span class="op" id="1364620">[</span><span class="num" id="1364621">7</span><span class="op" id="1364622">]</span>&nbsp;<span class="op" id="1364624">&gt;&gt;</span>&nbsp;<span class="num" id="1364627">12</span><span class="op" id="1364629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364632">buf</span><span class="op" id="1364635">[</span><span class="num" id="1364636">0</span><span class="op" id="1364637">]</span>&nbsp;<span class="op" id="1364639">=</span>&nbsp;<span class="builtintype" id="1364641">byte</span><span class="op" id="1364645">(</span><span class="ident" id="1364646">in</span><span class="op" id="1364648">[</span><span class="num" id="1364649">7</span><span class="op" id="1364650">]</span>&nbsp;<span class="op" id="1364652">&gt;&gt;</span>&nbsp;<span class="num" id="1364655">20</span><span class="op" id="1364657">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364661">return</span>&nbsp;<span class="builtinfunc" id="1364668">new</span><span class="op" id="1364671">(</span><span class="ident" id="1364672">big</span><span class="op" id="1364675">.</span><span class="ident" id="1364676">Int</span><span class="op" id="1364679">)</span><span class="op" id="1364680">.</span><span class="ident" id="1364681">SetBytes</span><span class="op" id="1364689">(</span><span class="ident" id="1364690">buf</span><span class="op" id="1364693">[</span><span class="op" id="1364694">:</span><span class="op" id="1364695">]</span><span class="op" id="1364696">)</span><br>
<span class="lineno">765</span><span class="op" id="1364698">}</span>
</div>
</body>
</html>
