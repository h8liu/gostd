<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6859696">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6859752">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6859806">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6859857">package</span>&nbsp;<span class="ident" id="6859865">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6859871">import</span>&nbsp;<span class="op" id="6859878">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859881">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859890">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859899">&#34;compress/gzip&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859916">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859931">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859938">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859944">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859957">&#34;net/http/internal&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859978">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859989">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860000">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860010">&#34;strings&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860021">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6860031">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6860034">type</span>&nbsp;<span class="ident" id="6860039">respTest</span>&nbsp;<span class="keyword" id="6860048">struct</span>&nbsp;<span class="op" id="6860055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860058">Raw</span>&nbsp;&nbsp;<span class="builtintype" id="6860063">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860071">Resp</span>&nbsp;<span class="ident" id="6860076">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860086">Body</span>&nbsp;<span class="builtintype" id="6860091">string</span><br>
<span class="lineno"></span><span class="op" id="6860098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6860101">func</span>&nbsp;<span class="ident" id="6860106">dummyReq</span><span class="op" id="6860114">(</span><span class="ident" id="6860115">method</span>&nbsp;<span class="builtintype" id="6860122">string</span><span class="op" id="6860128">)</span>&nbsp;<span class="op" id="6860130">*</span><span class="ident" id="6860131">Request</span>&nbsp;<span class="op" id="6860139">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6860142">return</span>&nbsp;<span class="op" id="6860149">&amp;</span><span class="ident" id="6860150">Request</span><span class="op" id="6860157">{</span><span class="ident" id="6860158">Method</span><span class="op" id="6860164">:</span>&nbsp;<span class="ident" id="6860166">method</span><span class="op" id="6860172">}</span><br>
<span class="lineno"></span><span class="op" id="6860174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6860177">func</span>&nbsp;<span class="ident" id="6860182">dummyReq11</span><span class="op" id="6860192">(</span><span class="ident" id="6860193">method</span>&nbsp;<span class="builtintype" id="6860200">string</span><span class="op" id="6860206">)</span>&nbsp;<span class="op" id="6860208">*</span><span class="ident" id="6860209">Request</span>&nbsp;<span class="op" id="6860217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6860220">return</span>&nbsp;<span class="op" id="6860227">&amp;</span><span class="ident" id="6860228">Request</span><span class="op" id="6860235">{</span><span class="ident" id="6860236">Method</span><span class="op" id="6860242">:</span>&nbsp;<span class="ident" id="6860244">method</span><span class="op" id="6860250">,</span>&nbsp;<span class="ident" id="6860252">Proto</span><span class="op" id="6860257">:</span>&nbsp;<span class="string" id="6860259">&#34;HTTP/1.1&#34;</span><span class="op" id="6860269">,</span>&nbsp;<span class="ident" id="6860271">ProtoMajor</span><span class="op" id="6860281">:</span>&nbsp;<span class="num" id="6860283">1</span><span class="op" id="6860284">,</span>&nbsp;<span class="ident" id="6860286">ProtoMinor</span><span class="op" id="6860296">:</span>&nbsp;<span class="num" id="6860298">1</span><span class="op" id="6860299">}</span><br>
<span class="lineno">35</span><span class="op" id="6860301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6860304">var</span>&nbsp;<span class="ident" id="6860308">respTests</span>&nbsp;<span class="op" id="6860318">=</span>&nbsp;<span class="op" id="6860320">[</span><span class="op" id="6860321">]</span><span class="ident" id="6860322">respTest</span><span class="op" id="6860330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6860333">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860380">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860384">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6860406">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860411">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6860435">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860440">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6860447">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860452">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6860465">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860470">Response</span><span class="op" id="6860478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860483">Status</span><span class="op" id="6860489">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6860495">&#34;200&nbsp;OK&#34;</span><span class="op" id="6860503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860508">StatusCode</span><span class="op" id="6860518">:</span>&nbsp;<span class="num" id="6860520">200</span><span class="op" id="6860523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860528">Proto</span><span class="op" id="6860533">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6860540">&#34;HTTP/1.0&#34;</span><span class="op" id="6860550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860555">ProtoMajor</span><span class="op" id="6860565">:</span>&nbsp;<span class="num" id="6860567">1</span><span class="op" id="6860568">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860573">ProtoMinor</span><span class="op" id="6860583">:</span>&nbsp;<span class="num" id="6860585">0</span><span class="op" id="6860586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860591">Request</span><span class="op" id="6860598">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860603">dummyReq</span><span class="op" id="6860611">(</span><span class="string" id="6860612">&#34;GET&#34;</span><span class="op" id="6860617">)</span><span class="op" id="6860618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860623">Header</span><span class="op" id="6860629">:</span>&nbsp;<span class="ident" id="6860631">Header</span><span class="op" id="6860637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860643">&#34;Connection&#34;</span><span class="op" id="6860655">:</span>&nbsp;<span class="op" id="6860657">{</span><span class="string" id="6860658">&#34;close&#34;</span><span class="op" id="6860665">}</span><span class="op" id="6860666">,</span>&nbsp;<span class="comment" id="6860668">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860693">}</span><span class="op" id="6860694">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860699">Close</span><span class="op" id="6860704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6860714">true</span><span class="op" id="6860718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860723">ContentLength</span><span class="op" id="6860736">:</span>&nbsp;<span class="op" id="6860738">-</span><span class="num" id="6860739">1</span><span class="op" id="6860740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860744">}</span><span class="op" id="6860745">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860750">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6860763">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860766">}</span><span class="op" id="6860767">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6860771">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;response&nbsp;without&nbsp;Content-Length&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6860829">//&nbsp;Connection&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860853">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860857">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6860879">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860884">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6860891">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6860896">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6860909">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860914">Response</span><span class="op" id="6860922">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860927">Status</span><span class="op" id="6860933">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6860942">&#34;200&nbsp;OK&#34;</span><span class="op" id="6860950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860955">StatusCode</span><span class="op" id="6860965">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6860970">200</span><span class="op" id="6860973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860978">Proto</span><span class="op" id="6860983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6860993">&#34;HTTP/1.1&#34;</span><span class="op" id="6861003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861008">ProtoMajor</span><span class="op" id="6861018">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6861023">1</span><span class="op" id="6861024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861029">ProtoMinor</span><span class="op" id="6861039">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6861044">1</span><span class="op" id="6861045">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861050">Header</span><span class="op" id="6861056">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861065">Header</span><span class="op" id="6861071">{</span><span class="op" id="6861072">}</span><span class="op" id="6861073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861078">Request</span><span class="op" id="6861085">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861093">dummyReq</span><span class="op" id="6861101">(</span><span class="string" id="6861102">&#34;GET&#34;</span><span class="op" id="6861107">)</span><span class="op" id="6861108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861113">Close</span><span class="op" id="6861118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6861128">true</span><span class="op" id="6861132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861137">ContentLength</span><span class="op" id="6861150">:</span>&nbsp;<span class="op" id="6861152">-</span><span class="num" id="6861153">1</span><span class="op" id="6861154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861158">}</span><span class="op" id="6861159">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861164">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6861177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861180">}</span><span class="op" id="6861181">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6861185">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;204&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861249">&#34;HTTP/1.1&nbsp;204&nbsp;No&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="6861279">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861284">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6861291">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861296">&#34;Body&nbsp;should&nbsp;not&nbsp;be&nbsp;read!\n&#34;</span><span class="op" id="6861324">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861329">Response</span><span class="op" id="6861337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861342">Status</span><span class="op" id="6861348">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6861357">&#34;204&nbsp;No&nbsp;Content&#34;</span><span class="op" id="6861373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861378">StatusCode</span><span class="op" id="6861388">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6861393">204</span><span class="op" id="6861396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861401">Proto</span><span class="op" id="6861406">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6861416">&#34;HTTP/1.1&#34;</span><span class="op" id="6861426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861431">ProtoMajor</span><span class="op" id="6861441">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6861446">1</span><span class="op" id="6861447">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861452">ProtoMinor</span><span class="op" id="6861462">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6861467">1</span><span class="op" id="6861468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861473">Header</span><span class="op" id="6861479">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861488">Header</span><span class="op" id="6861494">{</span><span class="op" id="6861495">}</span><span class="op" id="6861496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861501">Request</span><span class="op" id="6861508">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861516">dummyReq</span><span class="op" id="6861524">(</span><span class="string" id="6861525">&#34;GET&#34;</span><span class="op" id="6861530">)</span><span class="op" id="6861531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861536">Close</span><span class="op" id="6861541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6861551">false</span><span class="op" id="6861556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861561">ContentLength</span><span class="op" id="6861574">:</span>&nbsp;<span class="num" id="6861576">0</span><span class="op" id="6861577">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861581">}</span><span class="op" id="6861582">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861587">&#34;&#34;</span><span class="op" id="6861589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861592">}</span><span class="op" id="6861593">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6861597">//&nbsp;Unchunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861645">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6861667">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861672">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="6861697">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861702">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6861726">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861731">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6861738">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861743">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6861756">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861761">Response</span><span class="op" id="6861769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861774">Status</span><span class="op" id="6861780">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6861786">&#34;200&nbsp;OK&#34;</span><span class="op" id="6861794">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861799">StatusCode</span><span class="op" id="6861809">:</span>&nbsp;<span class="num" id="6861811">200</span><span class="op" id="6861814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861819">Proto</span><span class="op" id="6861824">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6861831">&#34;HTTP/1.0&#34;</span><span class="op" id="6861841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861846">ProtoMajor</span><span class="op" id="6861856">:</span>&nbsp;<span class="num" id="6861858">1</span><span class="op" id="6861859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861864">ProtoMinor</span><span class="op" id="6861874">:</span>&nbsp;<span class="num" id="6861876">0</span><span class="op" id="6861877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861882">Request</span><span class="op" id="6861889">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861894">dummyReq</span><span class="op" id="6861902">(</span><span class="string" id="6861903">&#34;GET&#34;</span><span class="op" id="6861908">)</span><span class="op" id="6861909">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861914">Header</span><span class="op" id="6861920">:</span>&nbsp;<span class="ident" id="6861922">Header</span><span class="op" id="6861928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861934">&#34;Connection&#34;</span><span class="op" id="6861946">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6861952">{</span><span class="string" id="6861953">&#34;close&#34;</span><span class="op" id="6861960">}</span><span class="op" id="6861961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6861967">&#34;Content-Length&#34;</span><span class="op" id="6861983">:</span>&nbsp;<span class="op" id="6861985">{</span><span class="string" id="6861986">&#34;10&#34;</span><span class="op" id="6861990">}</span><span class="op" id="6861991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861996">}</span><span class="op" id="6861997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862002">Close</span><span class="op" id="6862007">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6862017">true</span><span class="op" id="6862021">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862026">ContentLength</span><span class="op" id="6862039">:</span>&nbsp;<span class="num" id="6862041">10</span><span class="op" id="6862043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862047">}</span><span class="op" id="6862048">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862053">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6862066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862069">}</span><span class="op" id="6862070">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6862074">//&nbsp;Chunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862123">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6862145">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862150">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="6862183">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862188">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6862195">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862200">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="6862209">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862214">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="6862232">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862237">&#34;09\r\n&#34;</span>&nbsp;<span class="op" id="6862246">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862251">&#34;continued\r\n&#34;</span>&nbsp;<span class="op" id="6862267">+</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862272">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="6862280">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862285">&#34;\r\n&#34;</span><span class="op" id="6862291">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862296">Response</span><span class="op" id="6862304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862309">Status</span><span class="op" id="6862315">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6862327">&#34;200&nbsp;OK&#34;</span><span class="op" id="6862335">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862340">StatusCode</span><span class="op" id="6862350">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6862358">200</span><span class="op" id="6862361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862366">Proto</span><span class="op" id="6862371">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6862384">&#34;HTTP/1.1&#34;</span><span class="op" id="6862394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862399">ProtoMajor</span><span class="op" id="6862409">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6862417">1</span><span class="op" id="6862418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862423">ProtoMinor</span><span class="op" id="6862433">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6862441">1</span><span class="op" id="6862442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862447">Request</span><span class="op" id="6862454">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6862465">dummyReq</span><span class="op" id="6862473">(</span><span class="string" id="6862474">&#34;GET&#34;</span><span class="op" id="6862479">)</span><span class="op" id="6862480">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862485">Header</span><span class="op" id="6862491">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6862503">Header</span><span class="op" id="6862509">{</span><span class="op" id="6862510">}</span><span class="op" id="6862511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862516">Close</span><span class="op" id="6862521">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6862534">false</span><span class="op" id="6862539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862544">ContentLength</span><span class="op" id="6862557">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6862562">-</span><span class="num" id="6862563">1</span><span class="op" id="6862564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862569">TransferEncoding</span><span class="op" id="6862585">:</span>&nbsp;<span class="op" id="6862587">[</span><span class="op" id="6862588">]</span><span class="builtintype" id="6862589">string</span><span class="op" id="6862595">{</span><span class="string" id="6862596">&#34;chunked&#34;</span><span class="op" id="6862605">}</span><span class="op" id="6862606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862610">}</span><span class="op" id="6862611">,</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862616">&#34;Body&nbsp;here\ncontinued&#34;</span><span class="op" id="6862638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862641">}</span><span class="op" id="6862642">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6862646">//&nbsp;Chunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862692">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6862714">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862719">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="6862752">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862757">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="6862782">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862787">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6862794">+</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862799">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="6862808">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862813">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="6862831">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862836">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="6862844">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6862849">&#34;\r\n&#34;</span><span class="op" id="6862855">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862860">Response</span><span class="op" id="6862868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862873">Status</span><span class="op" id="6862879">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6862891">&#34;200&nbsp;OK&#34;</span><span class="op" id="6862899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862904">StatusCode</span><span class="op" id="6862914">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6862922">200</span><span class="op" id="6862925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862930">Proto</span><span class="op" id="6862935">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6862948">&#34;HTTP/1.1&#34;</span><span class="op" id="6862958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862963">ProtoMajor</span><span class="op" id="6862973">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6862981">1</span><span class="op" id="6862982">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862987">ProtoMinor</span><span class="op" id="6862997">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6863005">1</span><span class="op" id="6863006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863011">Request</span><span class="op" id="6863018">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6863029">dummyReq</span><span class="op" id="6863037">(</span><span class="string" id="6863038">&#34;GET&#34;</span><span class="op" id="6863043">)</span><span class="op" id="6863044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863049">Header</span><span class="op" id="6863055">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6863067">Header</span><span class="op" id="6863073">{</span><span class="op" id="6863074">}</span><span class="op" id="6863075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863080">Close</span><span class="op" id="6863085">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6863098">false</span><span class="op" id="6863103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863108">ContentLength</span><span class="op" id="6863121">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6863126">-</span><span class="num" id="6863127">1</span><span class="op" id="6863128">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863133">TransferEncoding</span><span class="op" id="6863149">:</span>&nbsp;<span class="op" id="6863151">[</span><span class="op" id="6863152">]</span><span class="builtintype" id="6863153">string</span><span class="op" id="6863159">{</span><span class="string" id="6863160">&#34;chunked&#34;</span><span class="op" id="6863169">}</span><span class="op" id="6863170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863174">}</span><span class="op" id="6863175">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6863180">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6863193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863196">}</span><span class="op" id="6863197">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6863201">//&nbsp;Chunked&nbsp;response&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6863256">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6863278">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6863283">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="6863316">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6863321">&#34;\r\n&#34;</span><span class="op" id="6863327">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863332">Response</span><span class="op" id="6863340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863345">Status</span><span class="op" id="6863351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6863363">&#34;200&nbsp;OK&#34;</span><span class="op" id="6863371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863376">StatusCode</span><span class="op" id="6863386">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6863394">200</span><span class="op" id="6863397">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863402">Proto</span><span class="op" id="6863407">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6863420">&#34;HTTP/1.1&#34;</span><span class="op" id="6863430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863435">ProtoMajor</span><span class="op" id="6863445">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6863453">1</span><span class="op" id="6863454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863459">ProtoMinor</span><span class="op" id="6863469">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6863477">1</span><span class="op" id="6863478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863483">Request</span><span class="op" id="6863490">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6863501">dummyReq</span><span class="op" id="6863509">(</span><span class="string" id="6863510">&#34;HEAD&#34;</span><span class="op" id="6863516">)</span><span class="op" id="6863517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863522">Header</span><span class="op" id="6863528">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6863540">Header</span><span class="op" id="6863546">{</span><span class="op" id="6863547">}</span><span class="op" id="6863548">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863553">TransferEncoding</span><span class="op" id="6863569">:</span>&nbsp;<span class="op" id="6863571">[</span><span class="op" id="6863572">]</span><span class="builtintype" id="6863573">string</span><span class="op" id="6863579">{</span><span class="string" id="6863580">&#34;chunked&#34;</span><span class="op" id="6863589">}</span><span class="op" id="6863590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863595">Close</span><span class="op" id="6863600">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6863613">false</span><span class="op" id="6863618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863623">ContentLength</span><span class="op" id="6863636">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6863641">-</span><span class="num" id="6863642">1</span><span class="op" id="6863643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863647">}</span><span class="op" id="6863648">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6863653">&#34;&#34;</span><span class="op" id="6863655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863658">}</span><span class="op" id="6863659">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6863663">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863712">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6863716">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6863738">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6863743">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="6863769">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6863774">&#34;\r\n&#34;</span><span class="op" id="6863780">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863785">Response</span><span class="op" id="6863793">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863798">Status</span><span class="op" id="6863804">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6863816">&#34;200&nbsp;OK&#34;</span><span class="op" id="6863824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863829">StatusCode</span><span class="op" id="6863839">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6863847">200</span><span class="op" id="6863850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863855">Proto</span><span class="op" id="6863860">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6863873">&#34;HTTP/1.0&#34;</span><span class="op" id="6863883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863888">ProtoMajor</span><span class="op" id="6863898">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6863906">1</span><span class="op" id="6863907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863912">ProtoMinor</span><span class="op" id="6863922">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6863930">0</span><span class="op" id="6863931">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863936">Request</span><span class="op" id="6863943">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6863954">dummyReq</span><span class="op" id="6863962">(</span><span class="string" id="6863963">&#34;HEAD&#34;</span><span class="op" id="6863969">)</span><span class="op" id="6863970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863975">Header</span><span class="op" id="6863981">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6863993">Header</span><span class="op" id="6863999">{</span><span class="string" id="6864000">&#34;Content-Length&#34;</span><span class="op" id="6864016">:</span>&nbsp;<span class="op" id="6864018">{</span><span class="string" id="6864019">&#34;256&#34;</span><span class="op" id="6864024">}</span><span class="op" id="6864025">}</span><span class="op" id="6864026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864031">TransferEncoding</span><span class="op" id="6864047">:</span>&nbsp;<span class="ident" id="6864049">nil</span><span class="op" id="6864052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864057">Close</span><span class="op" id="6864062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6864075">true</span><span class="op" id="6864079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864084">ContentLength</span><span class="op" id="6864097">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6864102">256</span><span class="op" id="6864105">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6864109">}</span><span class="op" id="6864110">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864115">&#34;&#34;</span><span class="op" id="6864117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6864120">}</span><span class="op" id="6864121">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6864125">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;with&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6864188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864192">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6864214">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864219">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="6864245">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864250">&#34;\r\n&#34;</span><span class="op" id="6864256">,</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864261">Response</span><span class="op" id="6864269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864274">Status</span><span class="op" id="6864280">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6864292">&#34;200&nbsp;OK&#34;</span><span class="op" id="6864300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864305">StatusCode</span><span class="op" id="6864315">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6864323">200</span><span class="op" id="6864326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864331">Proto</span><span class="op" id="6864336">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6864349">&#34;HTTP/1.1&#34;</span><span class="op" id="6864359">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864364">ProtoMajor</span><span class="op" id="6864374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6864382">1</span><span class="op" id="6864383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864388">ProtoMinor</span><span class="op" id="6864398">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6864406">1</span><span class="op" id="6864407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864412">Request</span><span class="op" id="6864419">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6864430">dummyReq</span><span class="op" id="6864438">(</span><span class="string" id="6864439">&#34;HEAD&#34;</span><span class="op" id="6864445">)</span><span class="op" id="6864446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864451">Header</span><span class="op" id="6864457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6864469">Header</span><span class="op" id="6864475">{</span><span class="string" id="6864476">&#34;Content-Length&#34;</span><span class="op" id="6864492">:</span>&nbsp;<span class="op" id="6864494">{</span><span class="string" id="6864495">&#34;256&#34;</span><span class="op" id="6864500">}</span><span class="op" id="6864501">}</span><span class="op" id="6864502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864507">TransferEncoding</span><span class="op" id="6864523">:</span>&nbsp;<span class="ident" id="6864525">nil</span><span class="op" id="6864528">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864533">Close</span><span class="op" id="6864538">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6864551">false</span><span class="op" id="6864556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864561">ContentLength</span><span class="op" id="6864574">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6864579">256</span><span class="op" id="6864582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6864586">}</span><span class="op" id="6864587">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864592">&#34;&#34;</span><span class="op" id="6864594">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6864597">}</span><span class="op" id="6864598">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6864602">//&nbsp;No&nbsp;Content-Length&nbsp;or&nbsp;Chunked&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6864665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864669">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6864691">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864696">&#34;\r\n&#34;</span><span class="op" id="6864702">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864707">Response</span><span class="op" id="6864715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864720">Status</span><span class="op" id="6864726">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6864738">&#34;200&nbsp;OK&#34;</span><span class="op" id="6864746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864751">StatusCode</span><span class="op" id="6864761">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6864769">200</span><span class="op" id="6864772">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864777">Proto</span><span class="op" id="6864782">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6864795">&#34;HTTP/1.0&#34;</span><span class="op" id="6864805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864810">ProtoMajor</span><span class="op" id="6864820">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6864828">1</span><span class="op" id="6864829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864834">ProtoMinor</span><span class="op" id="6864844">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6864852">0</span><span class="op" id="6864853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864858">Request</span><span class="op" id="6864865">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6864876">dummyReq</span><span class="op" id="6864884">(</span><span class="string" id="6864885">&#34;HEAD&#34;</span><span class="op" id="6864891">)</span><span class="op" id="6864892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864897">Header</span><span class="op" id="6864903">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6864915">Header</span><span class="op" id="6864921">{</span><span class="op" id="6864922">}</span><span class="op" id="6864923">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864928">TransferEncoding</span><span class="op" id="6864944">:</span>&nbsp;<span class="ident" id="6864946">nil</span><span class="op" id="6864949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864954">Close</span><span class="op" id="6864959">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6864972">true</span><span class="op" id="6864976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864981">ContentLength</span><span class="op" id="6864994">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6864999">-</span><span class="num" id="6865000">1</span><span class="op" id="6865001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865005">}</span><span class="op" id="6865006">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865011">&#34;&#34;</span><span class="op" id="6865013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865016">}</span><span class="op" id="6865017">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6865021">//&nbsp;explicit&nbsp;Content-Length&nbsp;of&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865055">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865059">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6865081">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865086">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="6865110">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865115">&#34;\r\n&#34;</span><span class="op" id="6865121">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865126">Response</span><span class="op" id="6865134">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865139">Status</span><span class="op" id="6865145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6865151">&#34;200&nbsp;OK&#34;</span><span class="op" id="6865159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865164">StatusCode</span><span class="op" id="6865174">:</span>&nbsp;<span class="num" id="6865176">200</span><span class="op" id="6865179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865184">Proto</span><span class="op" id="6865189">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6865196">&#34;HTTP/1.1&#34;</span><span class="op" id="6865206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865211">ProtoMajor</span><span class="op" id="6865221">:</span>&nbsp;<span class="num" id="6865223">1</span><span class="op" id="6865224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865229">ProtoMinor</span><span class="op" id="6865239">:</span>&nbsp;<span class="num" id="6865241">1</span><span class="op" id="6865242">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865247">Request</span><span class="op" id="6865254">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6865259">dummyReq</span><span class="op" id="6865267">(</span><span class="string" id="6865268">&#34;GET&#34;</span><span class="op" id="6865273">)</span><span class="op" id="6865274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865279">Header</span><span class="op" id="6865285">:</span>&nbsp;<span class="ident" id="6865287">Header</span><span class="op" id="6865293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865299">&#34;Content-Length&#34;</span><span class="op" id="6865315">:</span>&nbsp;<span class="op" id="6865317">{</span><span class="string" id="6865318">&#34;0&#34;</span><span class="op" id="6865321">}</span><span class="op" id="6865322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865327">}</span><span class="op" id="6865328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865333">Close</span><span class="op" id="6865338">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6865348">false</span><span class="op" id="6865353">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865358">ContentLength</span><span class="op" id="6865371">:</span>&nbsp;<span class="num" id="6865373">0</span><span class="op" id="6865374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865378">}</span><span class="op" id="6865379">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865384">&#34;&#34;</span><span class="op" id="6865386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865389">}</span><span class="op" id="6865390">,</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6865394">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;but&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6865455">//&nbsp;(permitted&nbsp;by&nbsp;RFC&nbsp;2616)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865487">&#34;HTTP/1.0&nbsp;303&nbsp;\r\n\r\n&#34;</span><span class="op" id="6865510">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865514">Response</span><span class="op" id="6865522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865527">Status</span><span class="op" id="6865533">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6865542">&#34;303&nbsp;&#34;</span><span class="op" id="6865548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865553">StatusCode</span><span class="op" id="6865563">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6865568">303</span><span class="op" id="6865571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865576">Proto</span><span class="op" id="6865581">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6865591">&#34;HTTP/1.0&#34;</span><span class="op" id="6865601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865606">ProtoMajor</span><span class="op" id="6865616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6865621">1</span><span class="op" id="6865622">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865627">ProtoMinor</span><span class="op" id="6865637">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6865642">0</span><span class="op" id="6865643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865648">Request</span><span class="op" id="6865655">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6865663">dummyReq</span><span class="op" id="6865671">(</span><span class="string" id="6865672">&#34;GET&#34;</span><span class="op" id="6865677">)</span><span class="op" id="6865678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865683">Header</span><span class="op" id="6865689">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6865698">Header</span><span class="op" id="6865704">{</span><span class="op" id="6865705">}</span><span class="op" id="6865706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865711">Close</span><span class="op" id="6865716">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6865726">true</span><span class="op" id="6865730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865735">ContentLength</span><span class="op" id="6865748">:</span>&nbsp;<span class="op" id="6865750">-</span><span class="num" id="6865751">1</span><span class="op" id="6865752">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865756">}</span><span class="op" id="6865757">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865762">&#34;&#34;</span><span class="op" id="6865764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865767">}</span><span class="op" id="6865768">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6865772">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;and&nbsp;no&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6865836">//&nbsp;(not&nbsp;permitted&nbsp;by&nbsp;RFC&nbsp;2616,&nbsp;but&nbsp;we&#39;ll&nbsp;accept&nbsp;it&nbsp;anyway)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865900">&#34;HTTP/1.0&nbsp;303\r\n\r\n&#34;</span><span class="op" id="6865922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865926">Response</span><span class="op" id="6865934">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865939">Status</span><span class="op" id="6865945">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6865954">&#34;303&nbsp;&#34;</span><span class="op" id="6865960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865965">StatusCode</span><span class="op" id="6865975">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6865980">303</span><span class="op" id="6865983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865988">Proto</span><span class="op" id="6865993">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6866003">&#34;HTTP/1.0&#34;</span><span class="op" id="6866013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866018">ProtoMajor</span><span class="op" id="6866028">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866033">1</span><span class="op" id="6866034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866039">ProtoMinor</span><span class="op" id="6866049">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866054">0</span><span class="op" id="6866055">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866060">Request</span><span class="op" id="6866067">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6866075">dummyReq</span><span class="op" id="6866083">(</span><span class="string" id="6866084">&#34;GET&#34;</span><span class="op" id="6866089">)</span><span class="op" id="6866090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866095">Header</span><span class="op" id="6866101">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6866110">Header</span><span class="op" id="6866116">{</span><span class="op" id="6866117">}</span><span class="op" id="6866118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866123">Close</span><span class="op" id="6866128">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866138">true</span><span class="op" id="6866142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866147">ContentLength</span><span class="op" id="6866160">:</span>&nbsp;<span class="op" id="6866162">-</span><span class="num" id="6866163">1</span><span class="op" id="6866164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866168">}</span><span class="op" id="6866169">,</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6866174">&#34;&#34;</span><span class="op" id="6866176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866179">}</span><span class="op" id="6866180">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6866184">//&nbsp;golang.org/issue/4767:&nbsp;don&#39;t&nbsp;special-case&nbsp;multipart/byteranges&nbsp;responses</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6866265">`HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content<br>
<span class="lineno"></span>Connection:&nbsp;close<br>
<span class="lineno"></span>Content-Type:&nbsp;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef<br>
<span class="lineno"></span><br>
<span class="lineno">340</span>some&nbsp;body`</span><span class="op" id="6866386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866390">Response</span><span class="op" id="6866398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866403">Status</span><span class="op" id="6866409">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6866415">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="6866436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866441">StatusCode</span><span class="op" id="6866451">:</span>&nbsp;<span class="num" id="6866453">206</span><span class="op" id="6866456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866461">Proto</span><span class="op" id="6866466">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6866473">&#34;HTTP/1.1&#34;</span><span class="op" id="6866483">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866488">ProtoMajor</span><span class="op" id="6866498">:</span>&nbsp;<span class="num" id="6866500">1</span><span class="op" id="6866501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866506">ProtoMinor</span><span class="op" id="6866516">:</span>&nbsp;<span class="num" id="6866518">1</span><span class="op" id="6866519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866524">Request</span><span class="op" id="6866531">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6866536">dummyReq</span><span class="op" id="6866544">(</span><span class="string" id="6866545">&#34;GET&#34;</span><span class="op" id="6866550">)</span><span class="op" id="6866551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866556">Header</span><span class="op" id="6866562">:</span>&nbsp;<span class="ident" id="6866564">Header</span><span class="op" id="6866570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6866576">&#34;Content-Type&#34;</span><span class="op" id="6866590">:</span>&nbsp;<span class="op" id="6866592">[</span><span class="op" id="6866593">]</span><span class="builtintype" id="6866594">string</span><span class="op" id="6866600">{</span><span class="string" id="6866601">&#34;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef&#34;</span><span class="op" id="6866650">}</span><span class="op" id="6866651">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866656">}</span><span class="op" id="6866657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866662">Close</span><span class="op" id="6866667">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866677">true</span><span class="op" id="6866681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866686">ContentLength</span><span class="op" id="6866699">:</span>&nbsp;<span class="op" id="6866701">-</span><span class="num" id="6866702">1</span><span class="op" id="6866703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866707">}</span><span class="op" id="6866708">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6866713">&#34;some&nbsp;body&#34;</span><span class="op" id="6866724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866727">}</span><span class="op" id="6866728">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6866732">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length,&nbsp;Request&nbsp;is&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866794">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6866798">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6866820">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6866825">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6866849">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6866854">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6866861">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6866866">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6866879">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866884">Response</span><span class="op" id="6866892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866897">Status</span><span class="op" id="6866903">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6866909">&#34;200&nbsp;OK&#34;</span><span class="op" id="6866917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866922">StatusCode</span><span class="op" id="6866932">:</span>&nbsp;<span class="num" id="6866934">200</span><span class="op" id="6866937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866942">Proto</span><span class="op" id="6866947">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6866954">&#34;HTTP/1.0&#34;</span><span class="op" id="6866964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866969">ProtoMajor</span><span class="op" id="6866979">:</span>&nbsp;<span class="num" id="6866981">1</span><span class="op" id="6866982">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866987">ProtoMinor</span><span class="op" id="6866997">:</span>&nbsp;<span class="num" id="6866999">0</span><span class="op" id="6867000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867005">Header</span><span class="op" id="6867011">:</span>&nbsp;<span class="ident" id="6867013">Header</span><span class="op" id="6867019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867025">&#34;Connection&#34;</span><span class="op" id="6867037">:</span>&nbsp;<span class="op" id="6867039">{</span><span class="string" id="6867040">&#34;close&#34;</span><span class="op" id="6867047">}</span><span class="op" id="6867048">,</span>&nbsp;<span class="comment" id="6867050">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867075">}</span><span class="op" id="6867076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867081">Close</span><span class="op" id="6867086">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6867096">true</span><span class="op" id="6867100">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867105">ContentLength</span><span class="op" id="6867118">:</span>&nbsp;<span class="op" id="6867120">-</span><span class="num" id="6867121">1</span><span class="op" id="6867122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867126">}</span><span class="op" id="6867127">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867132">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6867145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867148">}</span><span class="op" id="6867149">,</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6867153">//&nbsp;206&nbsp;Partial&nbsp;Content.&nbsp;golang.org/issue/8923</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867204">&#34;HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="6867239">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867244">&#34;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8\r\n&#34;</span>&nbsp;<span class="op" id="6867290">+</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867295">&#34;Accept-Ranges:&nbsp;bytes\r\n&#34;</span>&nbsp;<span class="op" id="6867322">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867327">&#34;Content-Range:&nbsp;bytes&nbsp;0-5/1862\r\n&#34;</span>&nbsp;<span class="op" id="6867363">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867368">&#34;Content-Length:&nbsp;6\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6867396">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867401">&#34;foobar&#34;</span><span class="op" id="6867409">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867414">Response</span><span class="op" id="6867422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867427">Status</span><span class="op" id="6867433">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6867439">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="6867460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867465">StatusCode</span><span class="op" id="6867475">:</span>&nbsp;<span class="num" id="6867477">206</span><span class="op" id="6867480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867485">Proto</span><span class="op" id="6867490">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6867497">&#34;HTTP/1.1&#34;</span><span class="op" id="6867507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867512">ProtoMajor</span><span class="op" id="6867522">:</span>&nbsp;<span class="num" id="6867524">1</span><span class="op" id="6867525">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867530">ProtoMinor</span><span class="op" id="6867540">:</span>&nbsp;<span class="num" id="6867542">1</span><span class="op" id="6867543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867548">Request</span><span class="op" id="6867555">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6867560">dummyReq</span><span class="op" id="6867568">(</span><span class="string" id="6867569">&#34;GET&#34;</span><span class="op" id="6867574">)</span><span class="op" id="6867575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867580">Header</span><span class="op" id="6867586">:</span>&nbsp;<span class="ident" id="6867588">Header</span><span class="op" id="6867594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867600">&#34;Accept-Ranges&#34;</span><span class="op" id="6867615">:</span>&nbsp;&nbsp;<span class="op" id="6867618">[</span><span class="op" id="6867619">]</span><span class="builtintype" id="6867620">string</span><span class="op" id="6867626">{</span><span class="string" id="6867627">&#34;bytes&#34;</span><span class="op" id="6867634">}</span><span class="op" id="6867635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867641">&#34;Content-Length&#34;</span><span class="op" id="6867657">:</span>&nbsp;<span class="op" id="6867659">[</span><span class="op" id="6867660">]</span><span class="builtintype" id="6867661">string</span><span class="op" id="6867667">{</span><span class="string" id="6867668">&#34;6&#34;</span><span class="op" id="6867671">}</span><span class="op" id="6867672">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867678">&#34;Content-Type&#34;</span><span class="op" id="6867692">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6867696">[</span><span class="op" id="6867697">]</span><span class="builtintype" id="6867698">string</span><span class="op" id="6867704">{</span><span class="string" id="6867705">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="6867732">}</span><span class="op" id="6867733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867739">&#34;Content-Range&#34;</span><span class="op" id="6867754">:</span>&nbsp;&nbsp;<span class="op" id="6867757">[</span><span class="op" id="6867758">]</span><span class="builtintype" id="6867759">string</span><span class="op" id="6867765">{</span><span class="string" id="6867766">&#34;bytes&nbsp;0-5/1862&#34;</span><span class="op" id="6867782">}</span><span class="op" id="6867783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867788">}</span><span class="op" id="6867789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867794">ContentLength</span><span class="op" id="6867807">:</span>&nbsp;<span class="num" id="6867809">6</span><span class="op" id="6867810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867814">}</span><span class="op" id="6867815">,</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6867820">&#34;foobar&#34;</span><span class="op" id="6867828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867831">}</span><span class="op" id="6867832">,</span><br>
<span class="lineno"></span><span class="op" id="6867834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="6867837">func</span>&nbsp;<span class="ident" id="6867842">TestReadResponse</span><span class="op" id="6867858">(</span><span class="ident" id="6867859">t</span>&nbsp;<span class="op" id="6867861">*</span><span class="ident" id="6867862">testing</span><span class="op" id="6867869">.</span><span class="ident" id="6867870">T</span><span class="op" id="6867871">)</span>&nbsp;<span class="op" id="6867873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867876">for</span>&nbsp;<span class="ident" id="6867880">i</span><span class="op" id="6867881">,</span>&nbsp;<span class="ident" id="6867883">tt</span>&nbsp;<span class="op" id="6867886">:=</span>&nbsp;<span class="keyword" id="6867889">range</span>&nbsp;<span class="ident" id="6867895">respTests</span>&nbsp;<span class="op" id="6867905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867909">resp</span><span class="op" id="6867913">,</span>&nbsp;<span class="ident" id="6867915">err</span>&nbsp;<span class="op" id="6867919">:=</span>&nbsp;<span class="ident" id="6867922">ReadResponse</span><span class="op" id="6867934">(</span><span class="ident" id="6867935">bufio</span><span class="op" id="6867940">.</span><span class="ident" id="6867941">NewReader</span><span class="op" id="6867950">(</span><span class="ident" id="6867951">strings</span><span class="op" id="6867958">.</span><span class="ident" id="6867959">NewReader</span><span class="op" id="6867968">(</span><span class="ident" id="6867969">tt</span><span class="op" id="6867971">.</span><span class="ident" id="6867972">Raw</span><span class="op" id="6867975">)</span><span class="op" id="6867976">)</span><span class="op" id="6867977">,</span>&nbsp;<span class="ident" id="6867979">tt</span><span class="op" id="6867981">.</span><span class="ident" id="6867982">Resp</span><span class="op" id="6867986">.</span><span class="ident" id="6867987">Request</span><span class="op" id="6867994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867998">if</span>&nbsp;<span class="ident" id="6868001">err</span>&nbsp;<span class="op" id="6868005">!=</span>&nbsp;<span class="ident" id="6868008">nil</span>&nbsp;<span class="op" id="6868012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868017">t</span><span class="op" id="6868018">.</span><span class="ident" id="6868019">Errorf</span><span class="op" id="6868025">(</span><span class="string" id="6868026">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="6868035">,</span>&nbsp;<span class="ident" id="6868037">i</span><span class="op" id="6868038">,</span>&nbsp;<span class="ident" id="6868040">err</span><span class="op" id="6868043">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868048">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868063">rbody</span>&nbsp;<span class="op" id="6868069">:=</span>&nbsp;<span class="ident" id="6868072">resp</span><span class="op" id="6868076">.</span><span class="ident" id="6868077">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868084">resp</span><span class="op" id="6868088">.</span><span class="ident" id="6868089">Body</span>&nbsp;<span class="op" id="6868094">=</span>&nbsp;<span class="ident" id="6868096">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868102">diff</span><span class="op" id="6868106">(</span><span class="ident" id="6868107">t</span><span class="op" id="6868108">,</span>&nbsp;<span class="ident" id="6868110">fmt</span><span class="op" id="6868113">.</span><span class="ident" id="6868114">Sprintf</span><span class="op" id="6868121">(</span><span class="string" id="6868122">&#34;#%d&nbsp;Response&#34;</span><span class="op" id="6868136">,</span>&nbsp;<span class="ident" id="6868138">i</span><span class="op" id="6868139">)</span><span class="op" id="6868140">,</span>&nbsp;<span class="ident" id="6868142">resp</span><span class="op" id="6868146">,</span>&nbsp;<span class="op" id="6868148">&amp;</span><span class="ident" id="6868149">tt</span><span class="op" id="6868151">.</span><span class="ident" id="6868152">Resp</span><span class="op" id="6868156">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868160">var</span>&nbsp;<span class="ident" id="6868164">bout</span>&nbsp;<span class="ident" id="6868169">bytes</span><span class="op" id="6868174">.</span><span class="ident" id="6868175">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868184">if</span>&nbsp;<span class="ident" id="6868187">rbody</span>&nbsp;<span class="op" id="6868193">!=</span>&nbsp;<span class="ident" id="6868196">nil</span>&nbsp;<span class="op" id="6868200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868205">_</span><span class="op" id="6868206">,</span>&nbsp;<span class="ident" id="6868208">err</span>&nbsp;<span class="op" id="6868212">=</span>&nbsp;<span class="ident" id="6868214">io</span><span class="op" id="6868216">.</span><span class="ident" id="6868217">Copy</span><span class="op" id="6868221">(</span><span class="op" id="6868222">&amp;</span><span class="ident" id="6868223">bout</span><span class="op" id="6868227">,</span>&nbsp;<span class="ident" id="6868229">rbody</span><span class="op" id="6868234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868239">if</span>&nbsp;<span class="ident" id="6868242">err</span>&nbsp;<span class="op" id="6868246">!=</span>&nbsp;<span class="ident" id="6868249">nil</span>&nbsp;<span class="op" id="6868253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868259">t</span><span class="op" id="6868260">.</span><span class="ident" id="6868261">Errorf</span><span class="op" id="6868267">(</span><span class="string" id="6868268">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="6868277">,</span>&nbsp;<span class="ident" id="6868279">i</span><span class="op" id="6868280">,</span>&nbsp;<span class="ident" id="6868282">err</span><span class="op" id="6868285">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868291">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868308">rbody</span><span class="op" id="6868313">.</span><span class="ident" id="6868314">Close</span><span class="op" id="6868319">(</span><span class="op" id="6868320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868328">body</span>&nbsp;<span class="op" id="6868333">:=</span>&nbsp;<span class="ident" id="6868336">bout</span><span class="op" id="6868340">.</span><span class="ident" id="6868341">String</span><span class="op" id="6868347">(</span><span class="op" id="6868348">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868352">if</span>&nbsp;<span class="ident" id="6868355">body</span>&nbsp;<span class="op" id="6868360">!=</span>&nbsp;<span class="ident" id="6868363">tt</span><span class="op" id="6868365">.</span><span class="ident" id="6868366">Body</span>&nbsp;<span class="op" id="6868371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868376">t</span><span class="op" id="6868377">.</span><span class="ident" id="6868378">Errorf</span><span class="op" id="6868384">(</span><span class="string" id="6868385">&#34;#%d:&nbsp;Body&nbsp;=&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6868409">,</span>&nbsp;<span class="ident" id="6868411">i</span><span class="op" id="6868412">,</span>&nbsp;<span class="ident" id="6868414">body</span><span class="op" id="6868418">,</span>&nbsp;<span class="ident" id="6868420">tt</span><span class="op" id="6868422">.</span><span class="ident" id="6868423">Body</span><span class="op" id="6868427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868434">}</span><br>
<span class="lineno"></span><span class="op" id="6868436">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="6868439">func</span>&nbsp;<span class="ident" id="6868444">TestWriteResponse</span><span class="op" id="6868461">(</span><span class="ident" id="6868462">t</span>&nbsp;<span class="op" id="6868464">*</span><span class="ident" id="6868465">testing</span><span class="op" id="6868472">.</span><span class="ident" id="6868473">T</span><span class="op" id="6868474">)</span>&nbsp;<span class="op" id="6868476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868479">for</span>&nbsp;<span class="ident" id="6868483">i</span><span class="op" id="6868484">,</span>&nbsp;<span class="ident" id="6868486">tt</span>&nbsp;<span class="op" id="6868489">:=</span>&nbsp;<span class="keyword" id="6868492">range</span>&nbsp;<span class="ident" id="6868498">respTests</span>&nbsp;<span class="op" id="6868508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868512">resp</span><span class="op" id="6868516">,</span>&nbsp;<span class="ident" id="6868518">err</span>&nbsp;<span class="op" id="6868522">:=</span>&nbsp;<span class="ident" id="6868525">ReadResponse</span><span class="op" id="6868537">(</span><span class="ident" id="6868538">bufio</span><span class="op" id="6868543">.</span><span class="ident" id="6868544">NewReader</span><span class="op" id="6868553">(</span><span class="ident" id="6868554">strings</span><span class="op" id="6868561">.</span><span class="ident" id="6868562">NewReader</span><span class="op" id="6868571">(</span><span class="ident" id="6868572">tt</span><span class="op" id="6868574">.</span><span class="ident" id="6868575">Raw</span><span class="op" id="6868578">)</span><span class="op" id="6868579">)</span><span class="op" id="6868580">,</span>&nbsp;<span class="ident" id="6868582">tt</span><span class="op" id="6868584">.</span><span class="ident" id="6868585">Resp</span><span class="op" id="6868589">.</span><span class="ident" id="6868590">Request</span><span class="op" id="6868597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868601">if</span>&nbsp;<span class="ident" id="6868604">err</span>&nbsp;<span class="op" id="6868608">!=</span>&nbsp;<span class="ident" id="6868611">nil</span>&nbsp;<span class="op" id="6868615">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868620">t</span><span class="op" id="6868621">.</span><span class="ident" id="6868622">Errorf</span><span class="op" id="6868628">(</span><span class="string" id="6868629">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="6868638">,</span>&nbsp;<span class="ident" id="6868640">i</span><span class="op" id="6868641">,</span>&nbsp;<span class="ident" id="6868643">err</span><span class="op" id="6868646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868651">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868666">err</span>&nbsp;<span class="op" id="6868670">=</span>&nbsp;<span class="ident" id="6868672">resp</span><span class="op" id="6868676">.</span><span class="ident" id="6868677">Write</span><span class="op" id="6868682">(</span><span class="ident" id="6868683">ioutil</span><span class="op" id="6868689">.</span><span class="ident" id="6868690">Discard</span><span class="op" id="6868697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868701">if</span>&nbsp;<span class="ident" id="6868704">err</span>&nbsp;<span class="op" id="6868708">!=</span>&nbsp;<span class="ident" id="6868711">nil</span>&nbsp;<span class="op" id="6868715">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868720">t</span><span class="op" id="6868721">.</span><span class="ident" id="6868722">Errorf</span><span class="op" id="6868728">(</span><span class="string" id="6868729">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="6868738">,</span>&nbsp;<span class="ident" id="6868740">i</span><span class="op" id="6868741">,</span>&nbsp;<span class="ident" id="6868743">err</span><span class="op" id="6868746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868751">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868765">}</span><br>
<span class="lineno"></span><span class="op" id="6868767">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="6868770">var</span>&nbsp;<span class="ident" id="6868774">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="6868805">=</span>&nbsp;<span class="op" id="6868807">[</span><span class="op" id="6868808">]</span><span class="keyword" id="6868809">struct</span>&nbsp;<span class="op" id="6868816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868819">chunked</span><span class="op" id="6868826">,</span>&nbsp;<span class="ident" id="6868828">compressed</span>&nbsp;<span class="builtintype" id="6868839">bool</span><br>
<span class="lineno"></span><span class="op" id="6868844">}</span><span class="op" id="6868845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868848">{</span><span class="builtintype" id="6868849">false</span><span class="op" id="6868854">,</span>&nbsp;<span class="builtintype" id="6868856">false</span><span class="op" id="6868861">}</span><span class="op" id="6868862">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868865">{</span><span class="builtintype" id="6868866">true</span><span class="op" id="6868870">,</span>&nbsp;<span class="builtintype" id="6868872">false</span><span class="op" id="6868877">}</span><span class="op" id="6868878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868881">{</span><span class="builtintype" id="6868882">true</span><span class="op" id="6868886">,</span>&nbsp;<span class="builtintype" id="6868888">true</span><span class="op" id="6868892">}</span><span class="op" id="6868893">,</span><br>
<span class="lineno"></span><span class="op" id="6868895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6868898">//&nbsp;TestReadResponseCloseInMiddle&nbsp;tests&nbsp;that&nbsp;closing&nbsp;a&nbsp;body&nbsp;after</span><br>
<span class="lineno">460</span><span class="comment" id="6868963">//&nbsp;reading&nbsp;only&nbsp;part&nbsp;of&nbsp;its&nbsp;contents&nbsp;advances&nbsp;the&nbsp;read&nbsp;to&nbsp;the&nbsp;end&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="6869032">//&nbsp;the&nbsp;request,&nbsp;right&nbsp;up&nbsp;until&nbsp;the&nbsp;next&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="6869081">func</span>&nbsp;<span class="ident" id="6869086">TestReadResponseCloseInMiddle</span><span class="op" id="6869115">(</span><span class="ident" id="6869116">t</span>&nbsp;<span class="op" id="6869118">*</span><span class="ident" id="6869119">testing</span><span class="op" id="6869126">.</span><span class="ident" id="6869127">T</span><span class="op" id="6869128">)</span>&nbsp;<span class="op" id="6869130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869133">for</span>&nbsp;<span class="ident" id="6869137">_</span><span class="op" id="6869138">,</span>&nbsp;<span class="ident" id="6869140">test</span>&nbsp;<span class="op" id="6869145">:=</span>&nbsp;<span class="keyword" id="6869148">range</span>&nbsp;<span class="ident" id="6869154">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="6869185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869189">fatalf</span>&nbsp;<span class="op" id="6869196">:=</span>&nbsp;<span class="keyword" id="6869199">func</span><span class="op" id="6869203">(</span><span class="ident" id="6869204">format</span>&nbsp;<span class="builtintype" id="6869211">string</span><span class="op" id="6869217">,</span>&nbsp;<span class="ident" id="6869219">args</span>&nbsp;<span class="op" id="6869224">...</span><span class="keyword" id="6869227">interface</span><span class="op" id="6869236">{</span><span class="op" id="6869237">}</span><span class="op" id="6869238">)</span>&nbsp;<span class="op" id="6869240">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869245">args</span>&nbsp;<span class="op" id="6869250">=</span>&nbsp;<span class="builtinfunc" id="6869252">append</span><span class="op" id="6869258">(</span><span class="op" id="6869259">[</span><span class="op" id="6869260">]</span><span class="keyword" id="6869261">interface</span><span class="op" id="6869270">{</span><span class="op" id="6869271">}</span><span class="op" id="6869272">{</span><span class="ident" id="6869273">test</span><span class="op" id="6869277">.</span><span class="ident" id="6869278">chunked</span><span class="op" id="6869285">,</span>&nbsp;<span class="ident" id="6869287">test</span><span class="op" id="6869291">.</span><span class="ident" id="6869292">compressed</span><span class="op" id="6869302">}</span><span class="op" id="6869303">,</span>&nbsp;<span class="ident" id="6869305">args</span><span class="op" id="6869309">...</span><span class="op" id="6869312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869317">t</span><span class="op" id="6869318">.</span><span class="ident" id="6869319">Fatalf</span><span class="op" id="6869325">(</span><span class="string" id="6869326">&#34;on&nbsp;test&nbsp;chunked=%v,&nbsp;compressed=%v:&nbsp;&#34;</span><span class="op" id="6869363">+</span><span class="ident" id="6869364">format</span><span class="op" id="6869370">,</span>&nbsp;<span class="ident" id="6869372">args</span><span class="op" id="6869376">...</span><span class="op" id="6869379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869387">checkErr</span>&nbsp;<span class="op" id="6869396">:=</span>&nbsp;<span class="keyword" id="6869399">func</span><span class="op" id="6869403">(</span><span class="ident" id="6869404">err</span>&nbsp;<span class="builtintype" id="6869408">error</span><span class="op" id="6869413">,</span>&nbsp;<span class="ident" id="6869415">msg</span>&nbsp;<span class="builtintype" id="6869419">string</span><span class="op" id="6869425">)</span>&nbsp;<span class="op" id="6869427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869432">if</span>&nbsp;<span class="ident" id="6869435">err</span>&nbsp;<span class="op" id="6869439">==</span>&nbsp;<span class="ident" id="6869442">nil</span>&nbsp;<span class="op" id="6869446">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869452">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869467">fatalf</span><span class="op" id="6869473">(</span><span class="ident" id="6869474">msg</span><span class="op" id="6869477">+</span><span class="string" id="6869478">&#34;:&nbsp;%v&#34;</span><span class="op" id="6869484">,</span>&nbsp;<span class="ident" id="6869486">err</span><span class="op" id="6869489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869497">var</span>&nbsp;<span class="ident" id="6869501">buf</span>&nbsp;<span class="ident" id="6869505">bytes</span><span class="op" id="6869510">.</span><span class="ident" id="6869511">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869520">buf</span><span class="op" id="6869523">.</span><span class="ident" id="6869524">WriteString</span><span class="op" id="6869535">(</span><span class="string" id="6869536">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span><span class="op" id="6869557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869561">if</span>&nbsp;<span class="ident" id="6869564">test</span><span class="op" id="6869568">.</span><span class="ident" id="6869569">chunked</span>&nbsp;<span class="op" id="6869577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869582">buf</span><span class="op" id="6869585">.</span><span class="ident" id="6869586">WriteString</span><span class="op" id="6869597">(</span><span class="string" id="6869598">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span><span class="op" id="6869630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869634">}</span>&nbsp;<span class="keyword" id="6869636">else</span>&nbsp;<span class="op" id="6869641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869646">buf</span><span class="op" id="6869649">.</span><span class="ident" id="6869650">WriteString</span><span class="op" id="6869661">(</span><span class="string" id="6869662">&#34;Content-Length:&nbsp;1000000\r\n&#34;</span><span class="op" id="6869691">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869699">var</span>&nbsp;<span class="ident" id="6869703">wr</span>&nbsp;<span class="ident" id="6869706">io</span><span class="op" id="6869708">.</span><span class="ident" id="6869709">Writer</span>&nbsp;<span class="op" id="6869716">=</span>&nbsp;<span class="op" id="6869718">&amp;</span><span class="ident" id="6869719">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869725">if</span>&nbsp;<span class="ident" id="6869728">test</span><span class="op" id="6869732">.</span><span class="ident" id="6869733">chunked</span>&nbsp;<span class="op" id="6869741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869746">wr</span>&nbsp;<span class="op" id="6869749">=</span>&nbsp;<span class="ident" id="6869751">internal</span><span class="op" id="6869759">.</span><span class="ident" id="6869760">NewChunkedWriter</span><span class="op" id="6869776">(</span><span class="ident" id="6869777">wr</span><span class="op" id="6869779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869783">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869787">if</span>&nbsp;<span class="ident" id="6869790">test</span><span class="op" id="6869794">.</span><span class="ident" id="6869795">compressed</span>&nbsp;<span class="op" id="6869806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869811">buf</span><span class="op" id="6869814">.</span><span class="ident" id="6869815">WriteString</span><span class="op" id="6869826">(</span><span class="string" id="6869827">&#34;Content-Encoding:&nbsp;gzip\r\n&#34;</span><span class="op" id="6869855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869860">wr</span>&nbsp;<span class="op" id="6869863">=</span>&nbsp;<span class="ident" id="6869865">gzip</span><span class="op" id="6869869">.</span><span class="ident" id="6869870">NewWriter</span><span class="op" id="6869879">(</span><span class="ident" id="6869880">wr</span><span class="op" id="6869882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869890">buf</span><span class="op" id="6869893">.</span><span class="ident" id="6869894">WriteString</span><span class="op" id="6869905">(</span><span class="string" id="6869906">&#34;\r\n&#34;</span><span class="op" id="6869912">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869917">chunk</span>&nbsp;<span class="op" id="6869923">:=</span>&nbsp;<span class="ident" id="6869926">bytes</span><span class="op" id="6869931">.</span><span class="ident" id="6869932">Repeat</span><span class="op" id="6869938">(</span><span class="op" id="6869939">[</span><span class="op" id="6869940">]</span><span class="builtintype" id="6869941">byte</span><span class="op" id="6869945">{</span><span class="string" id="6869946">&#39;x&#39;</span><span class="op" id="6869949">}</span><span class="op" id="6869950">,</span>&nbsp;<span class="num" id="6869952">1000</span><span class="op" id="6869956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869960">for</span>&nbsp;<span class="ident" id="6869964">i</span>&nbsp;<span class="op" id="6869966">:=</span>&nbsp;<span class="num" id="6869969">0</span><span class="op" id="6869970">;</span>&nbsp;<span class="ident" id="6869972">i</span>&nbsp;<span class="op" id="6869974">&lt;</span>&nbsp;<span class="num" id="6869976">1000</span><span class="op" id="6869980">;</span>&nbsp;<span class="ident" id="6869982">i</span><span class="op" id="6869983">++</span>&nbsp;<span class="op" id="6869986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869991">if</span>&nbsp;<span class="ident" id="6869994">test</span><span class="op" id="6869998">.</span><span class="ident" id="6869999">compressed</span>&nbsp;<span class="op" id="6870010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6870016">//&nbsp;Otherwise&nbsp;this&nbsp;compresses&nbsp;too&nbsp;well.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870059">_</span><span class="op" id="6870060">,</span>&nbsp;<span class="ident" id="6870062">err</span>&nbsp;<span class="op" id="6870066">:=</span>&nbsp;<span class="ident" id="6870069">io</span><span class="op" id="6870071">.</span><span class="ident" id="6870072">ReadFull</span><span class="op" id="6870080">(</span><span class="ident" id="6870081">rand</span><span class="op" id="6870085">.</span><span class="ident" id="6870086">Reader</span><span class="op" id="6870092">,</span>&nbsp;<span class="ident" id="6870094">chunk</span><span class="op" id="6870099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870105">checkErr</span><span class="op" id="6870113">(</span><span class="ident" id="6870114">err</span><span class="op" id="6870117">,</span>&nbsp;<span class="string" id="6870119">&#34;rand.Reader&nbsp;ReadFull&#34;</span><span class="op" id="6870141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870151">wr</span><span class="op" id="6870153">.</span><span class="ident" id="6870154">Write</span><span class="op" id="6870159">(</span><span class="ident" id="6870160">chunk</span><span class="op" id="6870165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870169">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870173">if</span>&nbsp;<span class="ident" id="6870176">test</span><span class="op" id="6870180">.</span><span class="ident" id="6870181">compressed</span>&nbsp;<span class="op" id="6870192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870197">err</span>&nbsp;<span class="op" id="6870201">:=</span>&nbsp;<span class="ident" id="6870204">wr</span><span class="op" id="6870206">.</span><span class="op" id="6870207">(</span><span class="op" id="6870208">*</span><span class="ident" id="6870209">gzip</span><span class="op" id="6870213">.</span><span class="ident" id="6870214">Writer</span><span class="op" id="6870220">)</span><span class="op" id="6870221">.</span><span class="ident" id="6870222">Close</span><span class="op" id="6870227">(</span><span class="op" id="6870228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870233">checkErr</span><span class="op" id="6870241">(</span><span class="ident" id="6870242">err</span><span class="op" id="6870245">,</span>&nbsp;<span class="string" id="6870247">&#34;compressor&nbsp;close&#34;</span><span class="op" id="6870265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870273">if</span>&nbsp;<span class="ident" id="6870276">test</span><span class="op" id="6870280">.</span><span class="ident" id="6870281">chunked</span>&nbsp;<span class="op" id="6870289">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870294">buf</span><span class="op" id="6870297">.</span><span class="ident" id="6870298">WriteString</span><span class="op" id="6870309">(</span><span class="string" id="6870310">&#34;0\r\n\r\n&#34;</span><span class="op" id="6870321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870329">buf</span><span class="op" id="6870332">.</span><span class="ident" id="6870333">WriteString</span><span class="op" id="6870344">(</span><span class="string" id="6870345">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="6870364">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870369">bufr</span>&nbsp;<span class="op" id="6870374">:=</span>&nbsp;<span class="ident" id="6870377">bufio</span><span class="op" id="6870382">.</span><span class="ident" id="6870383">NewReader</span><span class="op" id="6870392">(</span><span class="op" id="6870393">&amp;</span><span class="ident" id="6870394">buf</span><span class="op" id="6870397">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870401">resp</span><span class="op" id="6870405">,</span>&nbsp;<span class="ident" id="6870407">err</span>&nbsp;<span class="op" id="6870411">:=</span>&nbsp;<span class="ident" id="6870414">ReadResponse</span><span class="op" id="6870426">(</span><span class="ident" id="6870427">bufr</span><span class="op" id="6870431">,</span>&nbsp;<span class="ident" id="6870433">dummyReq</span><span class="op" id="6870441">(</span><span class="string" id="6870442">&#34;GET&#34;</span><span class="op" id="6870447">)</span><span class="op" id="6870448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870452">checkErr</span><span class="op" id="6870460">(</span><span class="ident" id="6870461">err</span><span class="op" id="6870464">,</span>&nbsp;<span class="string" id="6870466">&#34;ReadResponse&#34;</span><span class="op" id="6870480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870484">expectedLength</span>&nbsp;<span class="op" id="6870499">:=</span>&nbsp;<span class="ident" id="6870502">int64</span><span class="op" id="6870507">(</span><span class="op" id="6870508">-</span><span class="num" id="6870509">1</span><span class="op" id="6870510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870514">if</span>&nbsp;<span class="op" id="6870517">!</span><span class="ident" id="6870518">test</span><span class="op" id="6870522">.</span><span class="ident" id="6870523">chunked</span>&nbsp;<span class="op" id="6870531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870536">expectedLength</span>&nbsp;<span class="op" id="6870551">=</span>&nbsp;<span class="num" id="6870553">1000000</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870567">if</span>&nbsp;<span class="ident" id="6870570">resp</span><span class="op" id="6870574">.</span><span class="ident" id="6870575">ContentLength</span>&nbsp;<span class="op" id="6870589">!=</span>&nbsp;<span class="ident" id="6870592">expectedLength</span>&nbsp;<span class="op" id="6870607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870612">fatalf</span><span class="op" id="6870618">(</span><span class="string" id="6870619">&#34;expected&nbsp;response&nbsp;length&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6870656">,</span>&nbsp;<span class="ident" id="6870658">expectedLength</span><span class="op" id="6870672">,</span>&nbsp;<span class="ident" id="6870674">resp</span><span class="op" id="6870678">.</span><span class="ident" id="6870679">ContentLength</span><span class="op" id="6870692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870700">if</span>&nbsp;<span class="ident" id="6870703">resp</span><span class="op" id="6870707">.</span><span class="ident" id="6870708">Body</span>&nbsp;<span class="op" id="6870713">==</span>&nbsp;<span class="ident" id="6870716">nil</span>&nbsp;<span class="op" id="6870720">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870725">fatalf</span><span class="op" id="6870731">(</span><span class="string" id="6870732">&#34;nil&nbsp;body&#34;</span><span class="op" id="6870742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870750">if</span>&nbsp;<span class="ident" id="6870753">test</span><span class="op" id="6870757">.</span><span class="ident" id="6870758">compressed</span>&nbsp;<span class="op" id="6870769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870774">gzReader</span><span class="op" id="6870782">,</span>&nbsp;<span class="ident" id="6870784">err</span>&nbsp;<span class="op" id="6870788">:=</span>&nbsp;<span class="ident" id="6870791">gzip</span><span class="op" id="6870795">.</span><span class="ident" id="6870796">NewReader</span><span class="op" id="6870805">(</span><span class="ident" id="6870806">resp</span><span class="op" id="6870810">.</span><span class="ident" id="6870811">Body</span><span class="op" id="6870815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870820">checkErr</span><span class="op" id="6870828">(</span><span class="ident" id="6870829">err</span><span class="op" id="6870832">,</span>&nbsp;<span class="string" id="6870834">&#34;gzip.NewReader&#34;</span><span class="op" id="6870850">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870855">resp</span><span class="op" id="6870859">.</span><span class="ident" id="6870860">Body</span>&nbsp;<span class="op" id="6870865">=</span>&nbsp;<span class="op" id="6870867">&amp;</span><span class="ident" id="6870868">readerAndCloser</span><span class="op" id="6870883">{</span><span class="ident" id="6870884">gzReader</span><span class="op" id="6870892">,</span>&nbsp;<span class="ident" id="6870894">resp</span><span class="op" id="6870898">.</span><span class="ident" id="6870899">Body</span><span class="op" id="6870903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870912">rbuf</span>&nbsp;<span class="op" id="6870917">:=</span>&nbsp;<span class="builtinfunc" id="6870920">make</span><span class="op" id="6870924">(</span><span class="op" id="6870925">[</span><span class="op" id="6870926">]</span><span class="builtintype" id="6870927">byte</span><span class="op" id="6870931">,</span>&nbsp;<span class="num" id="6870933">2500</span><span class="op" id="6870937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870941">n</span><span class="op" id="6870942">,</span>&nbsp;<span class="ident" id="6870944">err</span>&nbsp;<span class="op" id="6870948">:=</span>&nbsp;<span class="ident" id="6870951">io</span><span class="op" id="6870953">.</span><span class="ident" id="6870954">ReadFull</span><span class="op" id="6870962">(</span><span class="ident" id="6870963">resp</span><span class="op" id="6870967">.</span><span class="ident" id="6870968">Body</span><span class="op" id="6870972">,</span>&nbsp;<span class="ident" id="6870974">rbuf</span><span class="op" id="6870978">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870982">checkErr</span><span class="op" id="6870990">(</span><span class="ident" id="6870991">err</span><span class="op" id="6870994">,</span>&nbsp;<span class="string" id="6870996">&#34;2500&nbsp;byte&nbsp;ReadFull&#34;</span><span class="op" id="6871016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871020">if</span>&nbsp;<span class="ident" id="6871023">n</span>&nbsp;<span class="op" id="6871025">!=</span>&nbsp;<span class="num" id="6871028">2500</span>&nbsp;<span class="op" id="6871033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871038">fatalf</span><span class="op" id="6871044">(</span><span class="string" id="6871045">&#34;ReadFull&nbsp;only&nbsp;read&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="6871074">,</span>&nbsp;<span class="ident" id="6871076">n</span><span class="op" id="6871077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871085">if</span>&nbsp;<span class="ident" id="6871088">test</span><span class="op" id="6871092">.</span><span class="ident" id="6871093">compressed</span>&nbsp;<span class="op" id="6871104">==</span>&nbsp;<span class="builtintype" id="6871107">false</span>&nbsp;<span class="op" id="6871113">&amp;&amp;</span>&nbsp;<span class="op" id="6871116">!</span><span class="ident" id="6871117">bytes</span><span class="op" id="6871122">.</span><span class="ident" id="6871123">Equal</span><span class="op" id="6871128">(</span><span class="ident" id="6871129">bytes</span><span class="op" id="6871134">.</span><span class="ident" id="6871135">Repeat</span><span class="op" id="6871141">(</span><span class="op" id="6871142">[</span><span class="op" id="6871143">]</span><span class="builtintype" id="6871144">byte</span><span class="op" id="6871148">{</span><span class="string" id="6871149">&#39;x&#39;</span><span class="op" id="6871152">}</span><span class="op" id="6871153">,</span>&nbsp;<span class="num" id="6871155">2500</span><span class="op" id="6871159">)</span><span class="op" id="6871160">,</span>&nbsp;<span class="ident" id="6871162">rbuf</span><span class="op" id="6871166">)</span>&nbsp;<span class="op" id="6871168">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871173">fatalf</span><span class="op" id="6871179">(</span><span class="string" id="6871180">&#34;ReadFull&nbsp;didn&#39;t&nbsp;read&nbsp;2500&nbsp;&#39;x&#39;;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6871219">,</span>&nbsp;<span class="builtintype" id="6871221">string</span><span class="op" id="6871227">(</span><span class="ident" id="6871228">rbuf</span><span class="op" id="6871232">)</span><span class="op" id="6871233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871241">resp</span><span class="op" id="6871245">.</span><span class="ident" id="6871246">Body</span><span class="op" id="6871250">.</span><span class="ident" id="6871251">Close</span><span class="op" id="6871256">(</span><span class="op" id="6871257">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871262">rest</span><span class="op" id="6871266">,</span>&nbsp;<span class="ident" id="6871268">err</span>&nbsp;<span class="op" id="6871272">:=</span>&nbsp;<span class="ident" id="6871275">ioutil</span><span class="op" id="6871281">.</span><span class="ident" id="6871282">ReadAll</span><span class="op" id="6871289">(</span><span class="ident" id="6871290">bufr</span><span class="op" id="6871294">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871298">checkErr</span><span class="op" id="6871306">(</span><span class="ident" id="6871307">err</span><span class="op" id="6871310">,</span>&nbsp;<span class="string" id="6871312">&#34;ReadAll&nbsp;on&nbsp;remainder&#34;</span><span class="op" id="6871334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871338">if</span>&nbsp;<span class="ident" id="6871341">e</span><span class="op" id="6871342">,</span>&nbsp;<span class="ident" id="6871344">g</span>&nbsp;<span class="op" id="6871346">:=</span>&nbsp;<span class="string" id="6871349">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="6871368">,</span>&nbsp;<span class="builtintype" id="6871370">string</span><span class="op" id="6871376">(</span><span class="ident" id="6871377">rest</span><span class="op" id="6871381">)</span><span class="op" id="6871382">;</span>&nbsp;<span class="ident" id="6871384">e</span>&nbsp;<span class="op" id="6871386">!=</span>&nbsp;<span class="ident" id="6871389">g</span>&nbsp;<span class="op" id="6871391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871396">g</span>&nbsp;<span class="op" id="6871398">=</span>&nbsp;<span class="ident" id="6871400">regexp</span><span class="op" id="6871406">.</span><span class="ident" id="6871407">MustCompile</span><span class="op" id="6871418">(</span><span class="string" id="6871419">`(xx+)`</span><span class="op" id="6871426">)</span><span class="op" id="6871427">.</span><span class="ident" id="6871428">ReplaceAllStringFunc</span><span class="op" id="6871448">(</span><span class="ident" id="6871449">g</span><span class="op" id="6871450">,</span>&nbsp;<span class="keyword" id="6871452">func</span><span class="op" id="6871456">(</span><span class="ident" id="6871457">match</span>&nbsp;<span class="builtintype" id="6871463">string</span><span class="op" id="6871469">)</span>&nbsp;<span class="builtintype" id="6871471">string</span>&nbsp;<span class="op" id="6871478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871484">return</span>&nbsp;<span class="ident" id="6871491">fmt</span><span class="op" id="6871494">.</span><span class="ident" id="6871495">Sprintf</span><span class="op" id="6871502">(</span><span class="string" id="6871503">&#34;x(repeated&nbsp;x%d)&#34;</span><span class="op" id="6871520">,</span>&nbsp;<span class="builtinfunc" id="6871522">len</span><span class="op" id="6871525">(</span><span class="ident" id="6871526">match</span><span class="op" id="6871531">)</span><span class="op" id="6871532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871537">}</span><span class="op" id="6871538">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871543">fatalf</span><span class="op" id="6871549">(</span><span class="string" id="6871550">&#34;remainder&nbsp;=&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6871579">,</span>&nbsp;<span class="ident" id="6871581">g</span><span class="op" id="6871582">,</span>&nbsp;<span class="ident" id="6871584">e</span><span class="op" id="6871585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871592">}</span><br>
<span class="lineno"></span><span class="op" id="6871594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="keyword" id="6871597">func</span>&nbsp;<span class="ident" id="6871602">diff</span><span class="op" id="6871606">(</span><span class="ident" id="6871607">t</span>&nbsp;<span class="op" id="6871609">*</span><span class="ident" id="6871610">testing</span><span class="op" id="6871617">.</span><span class="ident" id="6871618">T</span><span class="op" id="6871619">,</span>&nbsp;<span class="ident" id="6871621">prefix</span>&nbsp;<span class="builtintype" id="6871628">string</span><span class="op" id="6871634">,</span>&nbsp;<span class="ident" id="6871636">have</span><span class="op" id="6871640">,</span>&nbsp;<span class="ident" id="6871642">want</span>&nbsp;<span class="keyword" id="6871647">interface</span><span class="op" id="6871656">{</span><span class="op" id="6871657">}</span><span class="op" id="6871658">)</span>&nbsp;<span class="op" id="6871660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871663">hv</span>&nbsp;<span class="op" id="6871666">:=</span>&nbsp;<span class="ident" id="6871669">reflect</span><span class="op" id="6871676">.</span><span class="ident" id="6871677">ValueOf</span><span class="op" id="6871684">(</span><span class="ident" id="6871685">have</span><span class="op" id="6871689">)</span><span class="op" id="6871690">.</span><span class="ident" id="6871691">Elem</span><span class="op" id="6871695">(</span><span class="op" id="6871696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871699">wv</span>&nbsp;<span class="op" id="6871702">:=</span>&nbsp;<span class="ident" id="6871705">reflect</span><span class="op" id="6871712">.</span><span class="ident" id="6871713">ValueOf</span><span class="op" id="6871720">(</span><span class="ident" id="6871721">want</span><span class="op" id="6871725">)</span><span class="op" id="6871726">.</span><span class="ident" id="6871727">Elem</span><span class="op" id="6871731">(</span><span class="op" id="6871732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871735">if</span>&nbsp;<span class="ident" id="6871738">hv</span><span class="op" id="6871740">.</span><span class="ident" id="6871741">Type</span><span class="op" id="6871745">(</span><span class="op" id="6871746">)</span>&nbsp;<span class="op" id="6871748">!=</span>&nbsp;<span class="ident" id="6871751">wv</span><span class="op" id="6871753">.</span><span class="ident" id="6871754">Type</span><span class="op" id="6871758">(</span><span class="op" id="6871759">)</span>&nbsp;<span class="op" id="6871761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871765">t</span><span class="op" id="6871766">.</span><span class="ident" id="6871767">Errorf</span><span class="op" id="6871773">(</span><span class="string" id="6871774">&#34;%s:&nbsp;type&nbsp;mismatch&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6871804">,</span>&nbsp;<span class="ident" id="6871806">prefix</span><span class="op" id="6871812">,</span>&nbsp;<span class="ident" id="6871814">hv</span><span class="op" id="6871816">.</span><span class="ident" id="6871817">Type</span><span class="op" id="6871821">(</span><span class="op" id="6871822">)</span><span class="op" id="6871823">,</span>&nbsp;<span class="ident" id="6871825">wv</span><span class="op" id="6871827">.</span><span class="ident" id="6871828">Type</span><span class="op" id="6871832">(</span><span class="op" id="6871833">)</span><span class="op" id="6871834">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871840">for</span>&nbsp;<span class="ident" id="6871844">i</span>&nbsp;<span class="op" id="6871846">:=</span>&nbsp;<span class="num" id="6871849">0</span><span class="op" id="6871850">;</span>&nbsp;<span class="ident" id="6871852">i</span>&nbsp;<span class="op" id="6871854">&lt;</span>&nbsp;<span class="ident" id="6871856">hv</span><span class="op" id="6871858">.</span><span class="ident" id="6871859">NumField</span><span class="op" id="6871867">(</span><span class="op" id="6871868">)</span><span class="op" id="6871869">;</span>&nbsp;<span class="ident" id="6871871">i</span><span class="op" id="6871872">++</span>&nbsp;<span class="op" id="6871875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871879">hf</span>&nbsp;<span class="op" id="6871882">:=</span>&nbsp;<span class="ident" id="6871885">hv</span><span class="op" id="6871887">.</span><span class="ident" id="6871888">Field</span><span class="op" id="6871893">(</span><span class="ident" id="6871894">i</span><span class="op" id="6871895">)</span><span class="op" id="6871896">.</span><span class="ident" id="6871897">Interface</span><span class="op" id="6871906">(</span><span class="op" id="6871907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871911">wf</span>&nbsp;<span class="op" id="6871914">:=</span>&nbsp;<span class="ident" id="6871917">wv</span><span class="op" id="6871919">.</span><span class="ident" id="6871920">Field</span><span class="op" id="6871925">(</span><span class="ident" id="6871926">i</span><span class="op" id="6871927">)</span><span class="op" id="6871928">.</span><span class="ident" id="6871929">Interface</span><span class="op" id="6871938">(</span><span class="op" id="6871939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871943">if</span>&nbsp;<span class="op" id="6871946">!</span><span class="ident" id="6871947">reflect</span><span class="op" id="6871954">.</span><span class="ident" id="6871955">DeepEqual</span><span class="op" id="6871964">(</span><span class="ident" id="6871965">hf</span><span class="op" id="6871967">,</span>&nbsp;<span class="ident" id="6871969">wf</span><span class="op" id="6871971">)</span>&nbsp;<span class="op" id="6871973">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871978">t</span><span class="op" id="6871979">.</span><span class="ident" id="6871980">Errorf</span><span class="op" id="6871986">(</span><span class="string" id="6871987">&#34;%s:&nbsp;%s&nbsp;=&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6872008">,</span>&nbsp;<span class="ident" id="6872010">prefix</span><span class="op" id="6872016">,</span>&nbsp;<span class="ident" id="6872018">hv</span><span class="op" id="6872020">.</span><span class="ident" id="6872021">Type</span><span class="op" id="6872025">(</span><span class="op" id="6872026">)</span><span class="op" id="6872027">.</span><span class="ident" id="6872028">Field</span><span class="op" id="6872033">(</span><span class="ident" id="6872034">i</span><span class="op" id="6872035">)</span><span class="op" id="6872036">.</span><span class="ident" id="6872037">Name</span><span class="op" id="6872041">,</span>&nbsp;<span class="ident" id="6872043">hf</span><span class="op" id="6872045">,</span>&nbsp;<span class="ident" id="6872047">wf</span><span class="op" id="6872049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872056">}</span><br>
<span class="lineno"></span><span class="op" id="6872058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="keyword" id="6872061">type</span>&nbsp;<span class="ident" id="6872066">responseLocationTest</span>&nbsp;<span class="keyword" id="6872087">struct</span>&nbsp;<span class="op" id="6872094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872097">location</span>&nbsp;<span class="builtintype" id="6872106">string</span>&nbsp;<span class="comment" id="6872113">//&nbsp;Response&#39;s&nbsp;Location&nbsp;header&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872150">requrl</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6872159">string</span>&nbsp;<span class="comment" id="6872166">//&nbsp;Response.Request.URL&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872197">want</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6872206">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872214">wantErr</span>&nbsp;&nbsp;<span class="builtintype" id="6872223">error</span><br>
<span class="lineno">570</span><span class="op" id="6872229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6872232">var</span>&nbsp;<span class="ident" id="6872236">responseLocationTests</span>&nbsp;<span class="op" id="6872258">=</span>&nbsp;<span class="op" id="6872260">[</span><span class="op" id="6872261">]</span><span class="ident" id="6872262">responseLocationTest</span><span class="op" id="6872282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872285">{</span><span class="string" id="6872286">&#34;/foo&#34;</span><span class="op" id="6872292">,</span>&nbsp;<span class="string" id="6872294">&#34;http://bar.com/baz&#34;</span><span class="op" id="6872314">,</span>&nbsp;<span class="string" id="6872316">&#34;http://bar.com/foo&#34;</span><span class="op" id="6872336">,</span>&nbsp;<span class="ident" id="6872338">nil</span><span class="op" id="6872341">}</span><span class="op" id="6872342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872345">{</span><span class="string" id="6872346">&#34;http://foo.com/&#34;</span><span class="op" id="6872363">,</span>&nbsp;<span class="string" id="6872365">&#34;http://bar.com/baz&#34;</span><span class="op" id="6872385">,</span>&nbsp;<span class="string" id="6872387">&#34;http://foo.com/&#34;</span><span class="op" id="6872404">,</span>&nbsp;<span class="ident" id="6872406">nil</span><span class="op" id="6872409">}</span><span class="op" id="6872410">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872413">{</span><span class="string" id="6872414">&#34;&#34;</span><span class="op" id="6872416">,</span>&nbsp;<span class="string" id="6872418">&#34;http://bar.com/baz&#34;</span><span class="op" id="6872438">,</span>&nbsp;<span class="string" id="6872440">&#34;&#34;</span><span class="op" id="6872442">,</span>&nbsp;<span class="ident" id="6872444">ErrNoLocation</span><span class="op" id="6872457">}</span><span class="op" id="6872458">,</span><br>
<span class="lineno"></span><span class="op" id="6872460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6872463">func</span>&nbsp;<span class="ident" id="6872468">TestLocationResponse</span><span class="op" id="6872488">(</span><span class="ident" id="6872489">t</span>&nbsp;<span class="op" id="6872491">*</span><span class="ident" id="6872492">testing</span><span class="op" id="6872499">.</span><span class="ident" id="6872500">T</span><span class="op" id="6872501">)</span>&nbsp;<span class="op" id="6872503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872506">for</span>&nbsp;<span class="ident" id="6872510">i</span><span class="op" id="6872511">,</span>&nbsp;<span class="ident" id="6872513">tt</span>&nbsp;<span class="op" id="6872516">:=</span>&nbsp;<span class="keyword" id="6872519">range</span>&nbsp;<span class="ident" id="6872525">responseLocationTests</span>&nbsp;<span class="op" id="6872547">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872551">res</span>&nbsp;<span class="op" id="6872555">:=</span>&nbsp;<span class="builtinfunc" id="6872558">new</span><span class="op" id="6872561">(</span><span class="ident" id="6872562">Response</span><span class="op" id="6872570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872574">res</span><span class="op" id="6872577">.</span><span class="ident" id="6872578">Header</span>&nbsp;<span class="op" id="6872585">=</span>&nbsp;<span class="builtinfunc" id="6872587">make</span><span class="op" id="6872591">(</span><span class="ident" id="6872592">Header</span><span class="op" id="6872598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872602">res</span><span class="op" id="6872605">.</span><span class="ident" id="6872606">Header</span><span class="op" id="6872612">.</span><span class="ident" id="6872613">Set</span><span class="op" id="6872616">(</span><span class="string" id="6872617">&#34;Location&#34;</span><span class="op" id="6872627">,</span>&nbsp;<span class="ident" id="6872629">tt</span><span class="op" id="6872631">.</span><span class="ident" id="6872632">location</span><span class="op" id="6872640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872644">if</span>&nbsp;<span class="ident" id="6872647">tt</span><span class="op" id="6872649">.</span><span class="ident" id="6872650">requrl</span>&nbsp;<span class="op" id="6872657">!=</span>&nbsp;<span class="string" id="6872660">&#34;&#34;</span>&nbsp;<span class="op" id="6872663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872668">res</span><span class="op" id="6872671">.</span><span class="ident" id="6872672">Request</span>&nbsp;<span class="op" id="6872680">=</span>&nbsp;<span class="op" id="6872682">&amp;</span><span class="ident" id="6872683">Request</span><span class="op" id="6872690">{</span><span class="op" id="6872691">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872696">var</span>&nbsp;<span class="ident" id="6872700">err</span>&nbsp;<span class="builtintype" id="6872704">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872713">res</span><span class="op" id="6872716">.</span><span class="ident" id="6872717">Request</span><span class="op" id="6872724">.</span><span class="ident" id="6872725">URL</span><span class="op" id="6872728">,</span>&nbsp;<span class="ident" id="6872730">err</span>&nbsp;<span class="op" id="6872734">=</span>&nbsp;<span class="ident" id="6872736">url</span><span class="op" id="6872739">.</span><span class="ident" id="6872740">Parse</span><span class="op" id="6872745">(</span><span class="ident" id="6872746">tt</span><span class="op" id="6872748">.</span><span class="ident" id="6872749">requrl</span><span class="op" id="6872755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872760">if</span>&nbsp;<span class="ident" id="6872763">err</span>&nbsp;<span class="op" id="6872767">!=</span>&nbsp;<span class="ident" id="6872770">nil</span>&nbsp;<span class="op" id="6872774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872780">t</span><span class="op" id="6872781">.</span><span class="ident" id="6872782">Fatalf</span><span class="op" id="6872788">(</span><span class="string" id="6872789">&#34;bad&nbsp;test&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="6872810">,</span>&nbsp;<span class="ident" id="6872812">tt</span><span class="op" id="6872814">.</span><span class="ident" id="6872815">requrl</span><span class="op" id="6872821">,</span>&nbsp;<span class="ident" id="6872823">err</span><span class="op" id="6872826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872831">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872840">got</span><span class="op" id="6872843">,</span>&nbsp;<span class="ident" id="6872845">err</span>&nbsp;<span class="op" id="6872849">:=</span>&nbsp;<span class="ident" id="6872852">res</span><span class="op" id="6872855">.</span><span class="ident" id="6872856">Location</span><span class="op" id="6872864">(</span><span class="op" id="6872865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872869">if</span>&nbsp;<span class="ident" id="6872872">tt</span><span class="op" id="6872874">.</span><span class="ident" id="6872875">wantErr</span>&nbsp;<span class="op" id="6872883">!=</span>&nbsp;<span class="ident" id="6872886">nil</span>&nbsp;<span class="op" id="6872890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872895">if</span>&nbsp;<span class="ident" id="6872898">err</span>&nbsp;<span class="op" id="6872902">==</span>&nbsp;<span class="ident" id="6872905">nil</span>&nbsp;<span class="op" id="6872909">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872915">t</span><span class="op" id="6872916">.</span><span class="ident" id="6872917">Errorf</span><span class="op" id="6872923">(</span><span class="string" id="6872924">&#34;%d.&nbsp;err=nil;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6872946">,</span>&nbsp;<span class="ident" id="6872948">i</span><span class="op" id="6872949">,</span>&nbsp;<span class="ident" id="6872951">tt</span><span class="op" id="6872953">.</span><span class="ident" id="6872954">wantErr</span><span class="op" id="6872961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872967">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872984">if</span>&nbsp;<span class="ident" id="6872987">g</span><span class="op" id="6872988">,</span>&nbsp;<span class="ident" id="6872990">e</span>&nbsp;<span class="op" id="6872992">:=</span>&nbsp;<span class="ident" id="6872995">err</span><span class="op" id="6872998">.</span><span class="ident" id="6872999">Error</span><span class="op" id="6873004">(</span><span class="op" id="6873005">)</span><span class="op" id="6873006">,</span>&nbsp;<span class="ident" id="6873008">tt</span><span class="op" id="6873010">.</span><span class="ident" id="6873011">wantErr</span><span class="op" id="6873018">.</span><span class="ident" id="6873019">Error</span><span class="op" id="6873024">(</span><span class="op" id="6873025">)</span><span class="op" id="6873026">;</span>&nbsp;<span class="ident" id="6873028">g</span>&nbsp;<span class="op" id="6873030">!=</span>&nbsp;<span class="ident" id="6873033">e</span>&nbsp;<span class="op" id="6873035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873041">t</span><span class="op" id="6873042">.</span><span class="ident" id="6873043">Errorf</span><span class="op" id="6873049">(</span><span class="string" id="6873050">&#34;%d.&nbsp;err=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6873071">,</span>&nbsp;<span class="ident" id="6873073">i</span><span class="op" id="6873074">,</span>&nbsp;<span class="ident" id="6873076">g</span><span class="op" id="6873077">,</span>&nbsp;<span class="ident" id="6873079">e</span><span class="op" id="6873080">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873086">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873103">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873118">if</span>&nbsp;<span class="ident" id="6873121">err</span>&nbsp;<span class="op" id="6873125">!=</span>&nbsp;<span class="ident" id="6873128">nil</span>&nbsp;<span class="op" id="6873132">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873137">t</span><span class="op" id="6873138">.</span><span class="ident" id="6873139">Errorf</span><span class="op" id="6873145">(</span><span class="string" id="6873146">&#34;%d.&nbsp;err=%q&#34;</span><span class="op" id="6873158">,</span>&nbsp;<span class="ident" id="6873160">i</span><span class="op" id="6873161">,</span>&nbsp;<span class="ident" id="6873163">err</span><span class="op" id="6873166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873171">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873186">if</span>&nbsp;<span class="ident" id="6873189">g</span><span class="op" id="6873190">,</span>&nbsp;<span class="ident" id="6873192">e</span>&nbsp;<span class="op" id="6873194">:=</span>&nbsp;<span class="ident" id="6873197">got</span><span class="op" id="6873200">.</span><span class="ident" id="6873201">String</span><span class="op" id="6873207">(</span><span class="op" id="6873208">)</span><span class="op" id="6873209">,</span>&nbsp;<span class="ident" id="6873211">tt</span><span class="op" id="6873213">.</span><span class="ident" id="6873214">want</span><span class="op" id="6873218">;</span>&nbsp;<span class="ident" id="6873220">g</span>&nbsp;<span class="op" id="6873222">!=</span>&nbsp;<span class="ident" id="6873225">e</span>&nbsp;<span class="op" id="6873227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873232">t</span><span class="op" id="6873233">.</span><span class="ident" id="6873234">Errorf</span><span class="op" id="6873240">(</span><span class="string" id="6873241">&#34;%d.&nbsp;Location=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6873267">,</span>&nbsp;<span class="ident" id="6873269">i</span><span class="op" id="6873270">,</span>&nbsp;<span class="ident" id="6873272">g</span><span class="op" id="6873273">,</span>&nbsp;<span class="ident" id="6873275">e</span><span class="op" id="6873276">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873283">}</span><br>
<span class="lineno"></span><span class="op" id="6873285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6873288">func</span>&nbsp;<span class="ident" id="6873293">TestResponseStatusStutter</span><span class="op" id="6873318">(</span><span class="ident" id="6873319">t</span>&nbsp;<span class="op" id="6873321">*</span><span class="ident" id="6873322">testing</span><span class="op" id="6873329">.</span><span class="ident" id="6873330">T</span><span class="op" id="6873331">)</span>&nbsp;<span class="op" id="6873333">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873336">r</span>&nbsp;<span class="op" id="6873338">:=</span>&nbsp;<span class="op" id="6873341">&amp;</span><span class="ident" id="6873342">Response</span><span class="op" id="6873350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873354">Status</span><span class="op" id="6873360">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6873366">&#34;123&nbsp;some&nbsp;status&#34;</span><span class="op" id="6873383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873387">StatusCode</span><span class="op" id="6873397">:</span>&nbsp;<span class="num" id="6873399">123</span><span class="op" id="6873402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873406">ProtoMajor</span><span class="op" id="6873416">:</span>&nbsp;<span class="num" id="6873418">1</span><span class="op" id="6873419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873423">ProtoMinor</span><span class="op" id="6873433">:</span>&nbsp;<span class="num" id="6873435">3</span><span class="op" id="6873436">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873442">var</span>&nbsp;<span class="ident" id="6873446">buf</span>&nbsp;<span class="ident" id="6873450">bytes</span><span class="op" id="6873455">.</span><span class="ident" id="6873456">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873464">r</span><span class="op" id="6873465">.</span><span class="ident" id="6873466">Write</span><span class="op" id="6873471">(</span><span class="op" id="6873472">&amp;</span><span class="ident" id="6873473">buf</span><span class="op" id="6873476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873479">if</span>&nbsp;<span class="ident" id="6873482">strings</span><span class="op" id="6873489">.</span><span class="ident" id="6873490">Contains</span><span class="op" id="6873498">(</span><span class="ident" id="6873499">buf</span><span class="op" id="6873502">.</span><span class="ident" id="6873503">String</span><span class="op" id="6873509">(</span><span class="op" id="6873510">)</span><span class="op" id="6873511">,</span>&nbsp;<span class="string" id="6873513">&#34;123&nbsp;123&#34;</span><span class="op" id="6873522">)</span>&nbsp;<span class="op" id="6873524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873528">t</span><span class="op" id="6873529">.</span><span class="ident" id="6873530">Errorf</span><span class="op" id="6873536">(</span><span class="string" id="6873537">&#34;stutter&nbsp;in&nbsp;status:&nbsp;%s&#34;</span><span class="op" id="6873560">,</span>&nbsp;<span class="ident" id="6873562">buf</span><span class="op" id="6873565">.</span><span class="ident" id="6873566">String</span><span class="op" id="6873572">(</span><span class="op" id="6873573">)</span><span class="op" id="6873574">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873577">}</span><br>
<span class="lineno"></span><span class="op" id="6873579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6873582">func</span>&nbsp;<span class="ident" id="6873587">TestResponseContentLengthShortBody</span><span class="op" id="6873621">(</span><span class="ident" id="6873622">t</span>&nbsp;<span class="op" id="6873624">*</span><span class="ident" id="6873625">testing</span><span class="op" id="6873632">.</span><span class="ident" id="6873633">T</span><span class="op" id="6873634">)</span>&nbsp;<span class="op" id="6873636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873639">const</span>&nbsp;<span class="ident" id="6873645">shortBody</span>&nbsp;<span class="op" id="6873655">=</span>&nbsp;<span class="string" id="6873657">&#34;Short&nbsp;body,&nbsp;not&nbsp;123&nbsp;bytes.&#34;</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873687">br</span>&nbsp;<span class="op" id="6873690">:=</span>&nbsp;<span class="ident" id="6873693">bufio</span><span class="op" id="6873698">.</span><span class="ident" id="6873699">NewReader</span><span class="op" id="6873708">(</span><span class="ident" id="6873709">strings</span><span class="op" id="6873716">.</span><span class="ident" id="6873717">NewReader</span><span class="op" id="6873726">(</span><span class="string" id="6873727">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6873749">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6873753">&#34;Content-Length:&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="6873779">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6873783">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6873790">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873794">shortBody</span><span class="op" id="6873803">)</span><span class="op" id="6873804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873807">res</span><span class="op" id="6873810">,</span>&nbsp;<span class="ident" id="6873812">err</span>&nbsp;<span class="op" id="6873816">:=</span>&nbsp;<span class="ident" id="6873819">ReadResponse</span><span class="op" id="6873831">(</span><span class="ident" id="6873832">br</span><span class="op" id="6873834">,</span>&nbsp;<span class="op" id="6873836">&amp;</span><span class="ident" id="6873837">Request</span><span class="op" id="6873844">{</span><span class="ident" id="6873845">Method</span><span class="op" id="6873851">:</span>&nbsp;<span class="string" id="6873853">&#34;GET&#34;</span><span class="op" id="6873858">}</span><span class="op" id="6873859">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873862">if</span>&nbsp;<span class="ident" id="6873865">err</span>&nbsp;<span class="op" id="6873869">!=</span>&nbsp;<span class="ident" id="6873872">nil</span>&nbsp;<span class="op" id="6873876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873880">t</span><span class="op" id="6873881">.</span><span class="ident" id="6873882">Fatal</span><span class="op" id="6873887">(</span><span class="ident" id="6873888">err</span><span class="op" id="6873891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873897">if</span>&nbsp;<span class="ident" id="6873900">res</span><span class="op" id="6873903">.</span><span class="ident" id="6873904">ContentLength</span>&nbsp;<span class="op" id="6873918">!=</span>&nbsp;<span class="num" id="6873921">123</span>&nbsp;<span class="op" id="6873925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873929">t</span><span class="op" id="6873930">.</span><span class="ident" id="6873931">Fatalf</span><span class="op" id="6873937">(</span><span class="string" id="6873938">&#34;Content-Length&nbsp;=&nbsp;%d;&nbsp;want&nbsp;123&#34;</span><span class="op" id="6873969">,</span>&nbsp;<span class="ident" id="6873971">res</span><span class="op" id="6873974">.</span><span class="ident" id="6873975">ContentLength</span><span class="op" id="6873988">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873994">var</span>&nbsp;<span class="ident" id="6873998">buf</span>&nbsp;<span class="ident" id="6874002">bytes</span><span class="op" id="6874007">.</span><span class="ident" id="6874008">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874016">n</span><span class="op" id="6874017">,</span>&nbsp;<span class="ident" id="6874019">err</span>&nbsp;<span class="op" id="6874023">:=</span>&nbsp;<span class="ident" id="6874026">io</span><span class="op" id="6874028">.</span><span class="ident" id="6874029">Copy</span><span class="op" id="6874033">(</span><span class="op" id="6874034">&amp;</span><span class="ident" id="6874035">buf</span><span class="op" id="6874038">,</span>&nbsp;<span class="ident" id="6874040">res</span><span class="op" id="6874043">.</span><span class="ident" id="6874044">Body</span><span class="op" id="6874048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874051">if</span>&nbsp;<span class="ident" id="6874054">n</span>&nbsp;<span class="op" id="6874056">!=</span>&nbsp;<span class="ident" id="6874059">int64</span><span class="op" id="6874064">(</span><span class="builtinfunc" id="6874065">len</span><span class="op" id="6874068">(</span><span class="ident" id="6874069">shortBody</span><span class="op" id="6874078">)</span><span class="op" id="6874079">)</span>&nbsp;<span class="op" id="6874081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874085">t</span><span class="op" id="6874086">.</span><span class="ident" id="6874087">Errorf</span><span class="op" id="6874093">(</span><span class="string" id="6874094">&#34;Copied&nbsp;%d&nbsp;bytes;&nbsp;want&nbsp;%d,&nbsp;len(%q)&#34;</span><span class="op" id="6874129">,</span>&nbsp;<span class="ident" id="6874131">n</span><span class="op" id="6874132">,</span>&nbsp;<span class="builtinfunc" id="6874134">len</span><span class="op" id="6874137">(</span><span class="ident" id="6874138">shortBody</span><span class="op" id="6874147">)</span><span class="op" id="6874148">,</span>&nbsp;<span class="ident" id="6874150">shortBody</span><span class="op" id="6874159">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874165">if</span>&nbsp;<span class="ident" id="6874168">buf</span><span class="op" id="6874171">.</span><span class="ident" id="6874172">String</span><span class="op" id="6874178">(</span><span class="op" id="6874179">)</span>&nbsp;<span class="op" id="6874181">!=</span>&nbsp;<span class="ident" id="6874184">shortBody</span>&nbsp;<span class="op" id="6874194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874198">t</span><span class="op" id="6874199">.</span><span class="ident" id="6874200">Errorf</span><span class="op" id="6874206">(</span><span class="string" id="6874207">&#34;Read&nbsp;body&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6874230">,</span>&nbsp;<span class="ident" id="6874232">buf</span><span class="op" id="6874235">.</span><span class="ident" id="6874236">String</span><span class="op" id="6874242">(</span><span class="op" id="6874243">)</span><span class="op" id="6874244">,</span>&nbsp;<span class="ident" id="6874246">shortBody</span><span class="op" id="6874255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874261">if</span>&nbsp;<span class="ident" id="6874264">err</span>&nbsp;<span class="op" id="6874268">!=</span>&nbsp;<span class="ident" id="6874271">io</span><span class="op" id="6874273">.</span><span class="ident" id="6874274">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="6874291">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874295">t</span><span class="op" id="6874296">.</span><span class="ident" id="6874297">Errorf</span><span class="op" id="6874303">(</span><span class="string" id="6874304">&#34;io.Copy&nbsp;error&nbsp;=&nbsp;%#v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="6874351">,</span>&nbsp;<span class="ident" id="6874353">err</span><span class="op" id="6874356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874359">}</span><br>
<span class="lineno"></span><span class="op" id="6874361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6874364">func</span>&nbsp;<span class="ident" id="6874369">TestReadResponseUnexpectedEOF</span><span class="op" id="6874398">(</span><span class="ident" id="6874399">t</span>&nbsp;<span class="op" id="6874401">*</span><span class="ident" id="6874402">testing</span><span class="op" id="6874409">.</span><span class="ident" id="6874410">T</span><span class="op" id="6874411">)</span>&nbsp;<span class="op" id="6874413">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874416">br</span>&nbsp;<span class="op" id="6874419">:=</span>&nbsp;<span class="ident" id="6874422">bufio</span><span class="op" id="6874427">.</span><span class="ident" id="6874428">NewReader</span><span class="op" id="6874437">(</span><span class="ident" id="6874438">strings</span><span class="op" id="6874445">.</span><span class="ident" id="6874446">NewReader</span><span class="op" id="6874455">(</span><span class="string" id="6874456">&#34;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently\r\n&#34;</span>&nbsp;<span class="op" id="6874493">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6874497">&#34;Location:&nbsp;http://example.com&#34;</span><span class="op" id="6874527">)</span><span class="op" id="6874528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874531">_</span><span class="op" id="6874532">,</span>&nbsp;<span class="ident" id="6874534">err</span>&nbsp;<span class="op" id="6874538">:=</span>&nbsp;<span class="ident" id="6874541">ReadResponse</span><span class="op" id="6874553">(</span><span class="ident" id="6874554">br</span><span class="op" id="6874556">,</span>&nbsp;<span class="ident" id="6874558">nil</span><span class="op" id="6874561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874564">if</span>&nbsp;<span class="ident" id="6874567">err</span>&nbsp;<span class="op" id="6874571">!=</span>&nbsp;<span class="ident" id="6874574">io</span><span class="op" id="6874576">.</span><span class="ident" id="6874577">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="6874594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874598">t</span><span class="op" id="6874599">.</span><span class="ident" id="6874600">Errorf</span><span class="op" id="6874606">(</span><span class="string" id="6874607">&#34;ReadResponse&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="6874652">,</span>&nbsp;<span class="ident" id="6874654">err</span><span class="op" id="6874657">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874660">}</span><br>
<span class="lineno"></span><span class="op" id="6874662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6874665">func</span>&nbsp;<span class="ident" id="6874670">TestNeedsSniff</span><span class="op" id="6874684">(</span><span class="ident" id="6874685">t</span>&nbsp;<span class="op" id="6874687">*</span><span class="ident" id="6874688">testing</span><span class="op" id="6874695">.</span><span class="ident" id="6874696">T</span><span class="op" id="6874697">)</span>&nbsp;<span class="op" id="6874699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6874702">//&nbsp;needsSniff&nbsp;returns&nbsp;true&nbsp;with&nbsp;an&nbsp;empty&nbsp;response.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874754">r</span>&nbsp;<span class="op" id="6874756">:=</span>&nbsp;<span class="op" id="6874759">&amp;</span><span class="ident" id="6874760">response</span><span class="op" id="6874768">{</span><span class="op" id="6874769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874772">if</span>&nbsp;<span class="ident" id="6874775">got</span><span class="op" id="6874778">,</span>&nbsp;<span class="ident" id="6874780">want</span>&nbsp;<span class="op" id="6874785">:=</span>&nbsp;<span class="ident" id="6874788">r</span><span class="op" id="6874789">.</span><span class="ident" id="6874790">needsSniff</span><span class="op" id="6874800">(</span><span class="op" id="6874801">)</span><span class="op" id="6874802">,</span>&nbsp;<span class="builtintype" id="6874804">true</span><span class="op" id="6874808">;</span>&nbsp;<span class="ident" id="6874810">got</span>&nbsp;<span class="op" id="6874814">!=</span>&nbsp;<span class="ident" id="6874817">want</span>&nbsp;<span class="op" id="6874822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874826">t</span><span class="op" id="6874827">.</span><span class="ident" id="6874828">Errorf</span><span class="op" id="6874834">(</span><span class="string" id="6874835">&#34;needsSniff&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="6874861">,</span>&nbsp;<span class="ident" id="6874863">got</span><span class="op" id="6874866">,</span>&nbsp;<span class="ident" id="6874868">want</span><span class="op" id="6874872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6874878">//&nbsp;needsSniff&nbsp;returns&nbsp;false&nbsp;when&nbsp;Content-Type&nbsp;=&nbsp;nil.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874932">r</span><span class="op" id="6874933">.</span><span class="ident" id="6874934">handlerHeader</span>&nbsp;<span class="op" id="6874948">=</span>&nbsp;<span class="ident" id="6874950">Header</span><span class="op" id="6874956">{</span><span class="string" id="6874957">&#34;Content-Type&#34;</span><span class="op" id="6874971">:</span>&nbsp;<span class="ident" id="6874973">nil</span><span class="op" id="6874976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874979">if</span>&nbsp;<span class="ident" id="6874982">got</span><span class="op" id="6874985">,</span>&nbsp;<span class="ident" id="6874987">want</span>&nbsp;<span class="op" id="6874992">:=</span>&nbsp;<span class="ident" id="6874995">r</span><span class="op" id="6874996">.</span><span class="ident" id="6874997">needsSniff</span><span class="op" id="6875007">(</span><span class="op" id="6875008">)</span><span class="op" id="6875009">,</span>&nbsp;<span class="builtintype" id="6875011">false</span><span class="op" id="6875016">;</span>&nbsp;<span class="ident" id="6875018">got</span>&nbsp;<span class="op" id="6875022">!=</span>&nbsp;<span class="ident" id="6875025">want</span>&nbsp;<span class="op" id="6875030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6875034">t</span><span class="op" id="6875035">.</span><span class="ident" id="6875036">Errorf</span><span class="op" id="6875042">(</span><span class="string" id="6875043">&#34;needsSniff&nbsp;empty&nbsp;Content-Type&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="6875088">,</span>&nbsp;<span class="ident" id="6875090">got</span><span class="op" id="6875093">,</span>&nbsp;<span class="ident" id="6875095">want</span><span class="op" id="6875099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6875102">}</span><br>
<span class="lineno"></span><span class="op" id="6875104">}</span>
</div>
</body>
</html>
