<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8444896">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8444951">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8445005">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8445056">package</span>&nbsp;<span class="ident" id="8445064">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8445069">import</span>&nbsp;<span class="op" id="8445076">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8445079">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8445085">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8445098">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8445104">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8445115">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8445126">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8445133">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8445136">func</span>&nbsp;<span class="ident" id="8445141">TestShutdown</span><span class="op" id="8445153">(</span><span class="ident" id="8445154">t</span>&nbsp;<span class="op" id="8445156">*</span><span class="ident" id="8445157">testing</span><span class="op" id="8445164">.</span><span class="ident" id="8445165">T</span><span class="op" id="8445166">)</span>&nbsp;<span class="op" id="8445168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445171">if</span>&nbsp;<span class="ident" id="8445174">runtime</span><span class="op" id="8445181">.</span><span class="ident" id="8445182">GOOS</span>&nbsp;<span class="op" id="8445187">==</span>&nbsp;<span class="string" id="8445190">&#34;plan9&#34;</span>&nbsp;<span class="op" id="8445198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445202">t</span><span class="op" id="8445203">.</span><span class="ident" id="8445204">Skipf</span><span class="op" id="8445209">(</span><span class="string" id="8445210">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8445231">,</span>&nbsp;<span class="ident" id="8445233">runtime</span><span class="op" id="8445240">.</span><span class="ident" id="8445241">GOOS</span><span class="op" id="8445245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8445248">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445251">ln</span><span class="op" id="8445253">,</span>&nbsp;<span class="ident" id="8445255">err</span>&nbsp;<span class="op" id="8445259">:=</span>&nbsp;<span class="ident" id="8445262">Listen</span><span class="op" id="8445268">(</span><span class="string" id="8445269">&#34;tcp&#34;</span><span class="op" id="8445274">,</span>&nbsp;<span class="string" id="8445276">&#34;127.0.0.1:0&#34;</span><span class="op" id="8445289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445292">if</span>&nbsp;<span class="ident" id="8445295">err</span>&nbsp;<span class="op" id="8445299">!=</span>&nbsp;<span class="ident" id="8445302">nil</span>&nbsp;<span class="op" id="8445306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445310">if</span>&nbsp;<span class="ident" id="8445313">ln</span><span class="op" id="8445315">,</span>&nbsp;<span class="ident" id="8445317">err</span>&nbsp;<span class="op" id="8445321">=</span>&nbsp;<span class="ident" id="8445323">Listen</span><span class="op" id="8445329">(</span><span class="string" id="8445330">&#34;tcp6&#34;</span><span class="op" id="8445336">,</span>&nbsp;<span class="string" id="8445338">&#34;[::1]:0&#34;</span><span class="op" id="8445347">)</span><span class="op" id="8445348">;</span>&nbsp;<span class="ident" id="8445350">err</span>&nbsp;<span class="op" id="8445354">!=</span>&nbsp;<span class="ident" id="8445357">nil</span>&nbsp;<span class="op" id="8445361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445366">t</span><span class="op" id="8445367">.</span><span class="ident" id="8445368">Fatalf</span><span class="op" id="8445374">(</span><span class="string" id="8445375">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="8445396">,</span>&nbsp;<span class="ident" id="8445398">err</span><span class="op" id="8445401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8445405">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8445408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445412">go</span>&nbsp;<span class="keyword" id="8445415">func</span><span class="op" id="8445419">(</span><span class="op" id="8445420">)</span>&nbsp;<span class="op" id="8445422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445426">defer</span>&nbsp;<span class="ident" id="8445432">ln</span><span class="op" id="8445434">.</span><span class="ident" id="8445435">Close</span><span class="op" id="8445440">(</span><span class="op" id="8445441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445445">c</span><span class="op" id="8445446">,</span>&nbsp;<span class="ident" id="8445448">err</span>&nbsp;<span class="op" id="8445452">:=</span>&nbsp;<span class="ident" id="8445455">ln</span><span class="op" id="8445457">.</span><span class="ident" id="8445458">Accept</span><span class="op" id="8445464">(</span><span class="op" id="8445465">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445469">if</span>&nbsp;<span class="ident" id="8445472">err</span>&nbsp;<span class="op" id="8445476">!=</span>&nbsp;<span class="ident" id="8445479">nil</span>&nbsp;<span class="op" id="8445483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445488">t</span><span class="op" id="8445489">.</span><span class="ident" id="8445490">Errorf</span><span class="op" id="8445496">(</span><span class="string" id="8445497">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="8445509">,</span>&nbsp;<span class="ident" id="8445511">err</span><span class="op" id="8445514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445519">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8445528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445532">var</span>&nbsp;<span class="ident" id="8445536">buf</span>&nbsp;<span class="op" id="8445540">[</span><span class="num" id="8445541">10</span><span class="op" id="8445543">]</span><span class="builtintype" id="8445544">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445551">n</span><span class="op" id="8445552">,</span>&nbsp;<span class="ident" id="8445554">err</span>&nbsp;<span class="op" id="8445558">:=</span>&nbsp;<span class="ident" id="8445561">c</span><span class="op" id="8445562">.</span><span class="ident" id="8445563">Read</span><span class="op" id="8445567">(</span><span class="ident" id="8445568">buf</span><span class="op" id="8445571">[</span><span class="op" id="8445572">:</span><span class="op" id="8445573">]</span><span class="op" id="8445574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445578">if</span>&nbsp;<span class="ident" id="8445581">n</span>&nbsp;<span class="op" id="8445583">!=</span>&nbsp;<span class="num" id="8445586">0</span>&nbsp;<span class="op" id="8445588">||</span>&nbsp;<span class="ident" id="8445591">err</span>&nbsp;<span class="op" id="8445595">!=</span>&nbsp;<span class="ident" id="8445598">io</span><span class="op" id="8445600">.</span><span class="ident" id="8445601">EOF</span>&nbsp;<span class="op" id="8445605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445610">t</span><span class="op" id="8445611">.</span><span class="ident" id="8445612">Errorf</span><span class="op" id="8445618">(</span><span class="string" id="8445619">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="8445657">,</span>&nbsp;<span class="ident" id="8445659">n</span><span class="op" id="8445660">,</span>&nbsp;<span class="ident" id="8445662">err</span><span class="op" id="8445665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445670">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8445679">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445683">c</span><span class="op" id="8445684">.</span><span class="ident" id="8445685">Write</span><span class="op" id="8445690">(</span><span class="op" id="8445691">[</span><span class="op" id="8445692">]</span><span class="builtintype" id="8445693">byte</span><span class="op" id="8445697">(</span><span class="string" id="8445698">&#34;response&#34;</span><span class="op" id="8445708">)</span><span class="op" id="8445709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445713">c</span><span class="op" id="8445714">.</span><span class="ident" id="8445715">Close</span><span class="op" id="8445720">(</span><span class="op" id="8445721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8445724">}</span><span class="op" id="8445725">(</span><span class="op" id="8445726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445730">c</span><span class="op" id="8445731">,</span>&nbsp;<span class="ident" id="8445733">err</span>&nbsp;<span class="op" id="8445737">:=</span>&nbsp;<span class="ident" id="8445740">Dial</span><span class="op" id="8445744">(</span><span class="string" id="8445745">&#34;tcp&#34;</span><span class="op" id="8445750">,</span>&nbsp;<span class="ident" id="8445752">ln</span><span class="op" id="8445754">.</span><span class="ident" id="8445755">Addr</span><span class="op" id="8445759">(</span><span class="op" id="8445760">)</span><span class="op" id="8445761">.</span><span class="ident" id="8445762">String</span><span class="op" id="8445768">(</span><span class="op" id="8445769">)</span><span class="op" id="8445770">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445773">if</span>&nbsp;<span class="ident" id="8445776">err</span>&nbsp;<span class="op" id="8445780">!=</span>&nbsp;<span class="ident" id="8445783">nil</span>&nbsp;<span class="op" id="8445787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445791">t</span><span class="op" id="8445792">.</span><span class="ident" id="8445793">Fatalf</span><span class="op" id="8445799">(</span><span class="string" id="8445800">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8445810">,</span>&nbsp;<span class="ident" id="8445812">err</span><span class="op" id="8445815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8445818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445821">defer</span>&nbsp;<span class="ident" id="8445827">c</span><span class="op" id="8445828">.</span><span class="ident" id="8445829">Close</span><span class="op" id="8445834">(</span><span class="op" id="8445835">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445839">err</span>&nbsp;<span class="op" id="8445843">=</span>&nbsp;<span class="ident" id="8445845">c</span><span class="op" id="8445846">.</span><span class="op" id="8445847">(</span><span class="op" id="8445848">*</span><span class="ident" id="8445849">TCPConn</span><span class="op" id="8445856">)</span><span class="op" id="8445857">.</span><span class="ident" id="8445858">CloseWrite</span><span class="op" id="8445868">(</span><span class="op" id="8445869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445872">if</span>&nbsp;<span class="ident" id="8445875">err</span>&nbsp;<span class="op" id="8445879">!=</span>&nbsp;<span class="ident" id="8445882">nil</span>&nbsp;<span class="op" id="8445886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445890">t</span><span class="op" id="8445891">.</span><span class="ident" id="8445892">Fatalf</span><span class="op" id="8445898">(</span><span class="string" id="8445899">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="8445915">,</span>&nbsp;<span class="ident" id="8445917">err</span><span class="op" id="8445920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8445923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445926">var</span>&nbsp;<span class="ident" id="8445930">buf</span>&nbsp;<span class="op" id="8445934">[</span><span class="num" id="8445935">10</span><span class="op" id="8445937">]</span><span class="builtintype" id="8445938">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445944">n</span><span class="op" id="8445945">,</span>&nbsp;<span class="ident" id="8445947">err</span>&nbsp;<span class="op" id="8445951">:=</span>&nbsp;<span class="ident" id="8445954">c</span><span class="op" id="8445955">.</span><span class="ident" id="8445956">Read</span><span class="op" id="8445960">(</span><span class="ident" id="8445961">buf</span><span class="op" id="8445964">[</span><span class="op" id="8445965">:</span><span class="op" id="8445966">]</span><span class="op" id="8445967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8445970">if</span>&nbsp;<span class="ident" id="8445973">err</span>&nbsp;<span class="op" id="8445977">!=</span>&nbsp;<span class="ident" id="8445980">nil</span>&nbsp;<span class="op" id="8445984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8445988">t</span><span class="op" id="8445989">.</span><span class="ident" id="8445990">Fatalf</span><span class="op" id="8445996">(</span><span class="string" id="8445997">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="8446018">,</span>&nbsp;<span class="ident" id="8446020">n</span><span class="op" id="8446021">,</span>&nbsp;<span class="ident" id="8446023">err</span><span class="op" id="8446026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446032">got</span>&nbsp;<span class="op" id="8446036">:=</span>&nbsp;<span class="builtintype" id="8446039">string</span><span class="op" id="8446045">(</span><span class="ident" id="8446046">buf</span><span class="op" id="8446049">[</span><span class="op" id="8446050">:</span><span class="ident" id="8446051">n</span><span class="op" id="8446052">]</span><span class="op" id="8446053">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446056">if</span>&nbsp;<span class="ident" id="8446059">got</span>&nbsp;<span class="op" id="8446063">!=</span>&nbsp;<span class="string" id="8446066">&#34;response&#34;</span>&nbsp;<span class="op" id="8446077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446081">t</span><span class="op" id="8446082">.</span><span class="ident" id="8446083">Errorf</span><span class="op" id="8446089">(</span><span class="string" id="8446090">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="8446120">,</span>&nbsp;<span class="ident" id="8446122">got</span><span class="op" id="8446125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446128">}</span><br>
<span class="lineno"></span><span class="op" id="8446130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8446133">func</span>&nbsp;<span class="ident" id="8446138">TestShutdownUnix</span><span class="op" id="8446154">(</span><span class="ident" id="8446155">t</span>&nbsp;<span class="op" id="8446157">*</span><span class="ident" id="8446158">testing</span><span class="op" id="8446165">.</span><span class="ident" id="8446166">T</span><span class="op" id="8446167">)</span>&nbsp;<span class="op" id="8446169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446172">switch</span>&nbsp;<span class="ident" id="8446179">runtime</span><span class="op" id="8446186">.</span><span class="ident" id="8446187">GOOS</span>&nbsp;<span class="op" id="8446192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446195">case</span>&nbsp;<span class="string" id="8446200">&#34;nacl&#34;</span><span class="op" id="8446206">,</span>&nbsp;<span class="string" id="8446208">&#34;plan9&#34;</span><span class="op" id="8446215">,</span>&nbsp;<span class="string" id="8446217">&#34;windows&#34;</span><span class="op" id="8446226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446230">t</span><span class="op" id="8446231">.</span><span class="ident" id="8446232">Skipf</span><span class="op" id="8446237">(</span><span class="string" id="8446238">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8446259">,</span>&nbsp;<span class="ident" id="8446261">runtime</span><span class="op" id="8446268">.</span><span class="ident" id="8446269">GOOS</span><span class="op" id="8446273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446276">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446279">f</span><span class="op" id="8446280">,</span>&nbsp;<span class="ident" id="8446282">err</span>&nbsp;<span class="op" id="8446286">:=</span>&nbsp;<span class="ident" id="8446289">ioutil</span><span class="op" id="8446295">.</span><span class="ident" id="8446296">TempFile</span><span class="op" id="8446304">(</span><span class="string" id="8446305">&#34;&#34;</span><span class="op" id="8446307">,</span>&nbsp;<span class="string" id="8446309">&#34;go_net_unixtest&#34;</span><span class="op" id="8446326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446329">if</span>&nbsp;<span class="ident" id="8446332">err</span>&nbsp;<span class="op" id="8446336">!=</span>&nbsp;<span class="ident" id="8446339">nil</span>&nbsp;<span class="op" id="8446343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446347">t</span><span class="op" id="8446348">.</span><span class="ident" id="8446349">Fatalf</span><span class="op" id="8446355">(</span><span class="string" id="8446356">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="8446370">,</span>&nbsp;<span class="ident" id="8446372">err</span><span class="op" id="8446375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446381">f</span><span class="op" id="8446382">.</span><span class="ident" id="8446383">Close</span><span class="op" id="8446388">(</span><span class="op" id="8446389">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446392">tmpname</span>&nbsp;<span class="op" id="8446400">:=</span>&nbsp;<span class="ident" id="8446403">f</span><span class="op" id="8446404">.</span><span class="ident" id="8446405">Name</span><span class="op" id="8446409">(</span><span class="op" id="8446410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446413">os</span><span class="op" id="8446415">.</span><span class="ident" id="8446416">Remove</span><span class="op" id="8446422">(</span><span class="ident" id="8446423">tmpname</span><span class="op" id="8446430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446433">ln</span><span class="op" id="8446435">,</span>&nbsp;<span class="ident" id="8446437">err</span>&nbsp;<span class="op" id="8446441">:=</span>&nbsp;<span class="ident" id="8446444">Listen</span><span class="op" id="8446450">(</span><span class="string" id="8446451">&#34;unix&#34;</span><span class="op" id="8446457">,</span>&nbsp;<span class="ident" id="8446459">tmpname</span><span class="op" id="8446466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446469">if</span>&nbsp;<span class="ident" id="8446472">err</span>&nbsp;<span class="op" id="8446476">!=</span>&nbsp;<span class="ident" id="8446479">nil</span>&nbsp;<span class="op" id="8446483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446487">t</span><span class="op" id="8446488">.</span><span class="ident" id="8446489">Fatalf</span><span class="op" id="8446495">(</span><span class="string" id="8446496">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="8446518">,</span>&nbsp;<span class="ident" id="8446520">tmpname</span><span class="op" id="8446527">,</span>&nbsp;<span class="ident" id="8446529">err</span><span class="op" id="8446532">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446538">defer</span>&nbsp;<span class="keyword" id="8446544">func</span><span class="op" id="8446548">(</span><span class="op" id="8446549">)</span>&nbsp;<span class="op" id="8446551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446555">ln</span><span class="op" id="8446557">.</span><span class="ident" id="8446558">Close</span><span class="op" id="8446563">(</span><span class="op" id="8446564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446568">os</span><span class="op" id="8446570">.</span><span class="ident" id="8446571">Remove</span><span class="op" id="8446577">(</span><span class="ident" id="8446578">tmpname</span><span class="op" id="8446585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446588">}</span><span class="op" id="8446589">(</span><span class="op" id="8446590">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446594">go</span>&nbsp;<span class="keyword" id="8446597">func</span><span class="op" id="8446601">(</span><span class="op" id="8446602">)</span>&nbsp;<span class="op" id="8446604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446608">c</span><span class="op" id="8446609">,</span>&nbsp;<span class="ident" id="8446611">err</span>&nbsp;<span class="op" id="8446615">:=</span>&nbsp;<span class="ident" id="8446618">ln</span><span class="op" id="8446620">.</span><span class="ident" id="8446621">Accept</span><span class="op" id="8446627">(</span><span class="op" id="8446628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446632">if</span>&nbsp;<span class="ident" id="8446635">err</span>&nbsp;<span class="op" id="8446639">!=</span>&nbsp;<span class="ident" id="8446642">nil</span>&nbsp;<span class="op" id="8446646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446651">t</span><span class="op" id="8446652">.</span><span class="ident" id="8446653">Errorf</span><span class="op" id="8446659">(</span><span class="string" id="8446660">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="8446672">,</span>&nbsp;<span class="ident" id="8446674">err</span><span class="op" id="8446677">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446682">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446695">var</span>&nbsp;<span class="ident" id="8446699">buf</span>&nbsp;<span class="op" id="8446703">[</span><span class="num" id="8446704">10</span><span class="op" id="8446706">]</span><span class="builtintype" id="8446707">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446714">n</span><span class="op" id="8446715">,</span>&nbsp;<span class="ident" id="8446717">err</span>&nbsp;<span class="op" id="8446721">:=</span>&nbsp;<span class="ident" id="8446724">c</span><span class="op" id="8446725">.</span><span class="ident" id="8446726">Read</span><span class="op" id="8446730">(</span><span class="ident" id="8446731">buf</span><span class="op" id="8446734">[</span><span class="op" id="8446735">:</span><span class="op" id="8446736">]</span><span class="op" id="8446737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446741">if</span>&nbsp;<span class="ident" id="8446744">n</span>&nbsp;<span class="op" id="8446746">!=</span>&nbsp;<span class="num" id="8446749">0</span>&nbsp;<span class="op" id="8446751">||</span>&nbsp;<span class="ident" id="8446754">err</span>&nbsp;<span class="op" id="8446758">!=</span>&nbsp;<span class="ident" id="8446761">io</span><span class="op" id="8446763">.</span><span class="ident" id="8446764">EOF</span>&nbsp;<span class="op" id="8446768">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446773">t</span><span class="op" id="8446774">.</span><span class="ident" id="8446775">Errorf</span><span class="op" id="8446781">(</span><span class="string" id="8446782">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="8446820">,</span>&nbsp;<span class="ident" id="8446822">n</span><span class="op" id="8446823">,</span>&nbsp;<span class="ident" id="8446825">err</span><span class="op" id="8446828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446833">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446846">c</span><span class="op" id="8446847">.</span><span class="ident" id="8446848">Write</span><span class="op" id="8446853">(</span><span class="op" id="8446854">[</span><span class="op" id="8446855">]</span><span class="builtintype" id="8446856">byte</span><span class="op" id="8446860">(</span><span class="string" id="8446861">&#34;response&#34;</span><span class="op" id="8446871">)</span><span class="op" id="8446872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446876">c</span><span class="op" id="8446877">.</span><span class="ident" id="8446878">Close</span><span class="op" id="8446883">(</span><span class="op" id="8446884">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446887">}</span><span class="op" id="8446888">(</span><span class="op" id="8446889">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446893">c</span><span class="op" id="8446894">,</span>&nbsp;<span class="ident" id="8446896">err</span>&nbsp;<span class="op" id="8446900">:=</span>&nbsp;<span class="ident" id="8446903">Dial</span><span class="op" id="8446907">(</span><span class="string" id="8446908">&#34;unix&#34;</span><span class="op" id="8446914">,</span>&nbsp;<span class="ident" id="8446916">tmpname</span><span class="op" id="8446923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446926">if</span>&nbsp;<span class="ident" id="8446929">err</span>&nbsp;<span class="op" id="8446933">!=</span>&nbsp;<span class="ident" id="8446936">nil</span>&nbsp;<span class="op" id="8446940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446944">t</span><span class="op" id="8446945">.</span><span class="ident" id="8446946">Fatalf</span><span class="op" id="8446952">(</span><span class="string" id="8446953">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8446963">,</span>&nbsp;<span class="ident" id="8446965">err</span><span class="op" id="8446968">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8446971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8446974">defer</span>&nbsp;<span class="ident" id="8446980">c</span><span class="op" id="8446981">.</span><span class="ident" id="8446982">Close</span><span class="op" id="8446987">(</span><span class="op" id="8446988">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8446992">err</span>&nbsp;<span class="op" id="8446996">=</span>&nbsp;<span class="ident" id="8446998">c</span><span class="op" id="8446999">.</span><span class="op" id="8447000">(</span><span class="op" id="8447001">*</span><span class="ident" id="8447002">UnixConn</span><span class="op" id="8447010">)</span><span class="op" id="8447011">.</span><span class="ident" id="8447012">CloseWrite</span><span class="op" id="8447022">(</span><span class="op" id="8447023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447026">if</span>&nbsp;<span class="ident" id="8447029">err</span>&nbsp;<span class="op" id="8447033">!=</span>&nbsp;<span class="ident" id="8447036">nil</span>&nbsp;<span class="op" id="8447040">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447044">t</span><span class="op" id="8447045">.</span><span class="ident" id="8447046">Fatalf</span><span class="op" id="8447052">(</span><span class="string" id="8447053">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="8447069">,</span>&nbsp;<span class="ident" id="8447071">err</span><span class="op" id="8447074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447080">var</span>&nbsp;<span class="ident" id="8447084">buf</span>&nbsp;<span class="op" id="8447088">[</span><span class="num" id="8447089">10</span><span class="op" id="8447091">]</span><span class="builtintype" id="8447092">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447098">n</span><span class="op" id="8447099">,</span>&nbsp;<span class="ident" id="8447101">err</span>&nbsp;<span class="op" id="8447105">:=</span>&nbsp;<span class="ident" id="8447108">c</span><span class="op" id="8447109">.</span><span class="ident" id="8447110">Read</span><span class="op" id="8447114">(</span><span class="ident" id="8447115">buf</span><span class="op" id="8447118">[</span><span class="op" id="8447119">:</span><span class="op" id="8447120">]</span><span class="op" id="8447121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447124">if</span>&nbsp;<span class="ident" id="8447127">err</span>&nbsp;<span class="op" id="8447131">!=</span>&nbsp;<span class="ident" id="8447134">nil</span>&nbsp;<span class="op" id="8447138">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447142">t</span><span class="op" id="8447143">.</span><span class="ident" id="8447144">Fatalf</span><span class="op" id="8447150">(</span><span class="string" id="8447151">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="8447172">,</span>&nbsp;<span class="ident" id="8447174">n</span><span class="op" id="8447175">,</span>&nbsp;<span class="ident" id="8447177">err</span><span class="op" id="8447180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447186">got</span>&nbsp;<span class="op" id="8447190">:=</span>&nbsp;<span class="builtintype" id="8447193">string</span><span class="op" id="8447199">(</span><span class="ident" id="8447200">buf</span><span class="op" id="8447203">[</span><span class="op" id="8447204">:</span><span class="ident" id="8447205">n</span><span class="op" id="8447206">]</span><span class="op" id="8447207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447210">if</span>&nbsp;<span class="ident" id="8447213">got</span>&nbsp;<span class="op" id="8447217">!=</span>&nbsp;<span class="string" id="8447220">&#34;response&#34;</span>&nbsp;<span class="op" id="8447231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447235">t</span><span class="op" id="8447236">.</span><span class="ident" id="8447237">Errorf</span><span class="op" id="8447243">(</span><span class="string" id="8447244">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="8447274">,</span>&nbsp;<span class="ident" id="8447276">got</span><span class="op" id="8447279">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447282">}</span><br>
<span class="lineno"></span><span class="op" id="8447284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8447287">func</span>&nbsp;<span class="ident" id="8447292">TestTCPListenClose</span><span class="op" id="8447310">(</span><span class="ident" id="8447311">t</span>&nbsp;<span class="op" id="8447313">*</span><span class="ident" id="8447314">testing</span><span class="op" id="8447321">.</span><span class="ident" id="8447322">T</span><span class="op" id="8447323">)</span>&nbsp;<span class="op" id="8447325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447328">ln</span><span class="op" id="8447330">,</span>&nbsp;<span class="ident" id="8447332">err</span>&nbsp;<span class="op" id="8447336">:=</span>&nbsp;<span class="ident" id="8447339">Listen</span><span class="op" id="8447345">(</span><span class="string" id="8447346">&#34;tcp&#34;</span><span class="op" id="8447351">,</span>&nbsp;<span class="string" id="8447353">&#34;127.0.0.1:0&#34;</span><span class="op" id="8447366">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447369">if</span>&nbsp;<span class="ident" id="8447372">err</span>&nbsp;<span class="op" id="8447376">!=</span>&nbsp;<span class="ident" id="8447379">nil</span>&nbsp;<span class="op" id="8447383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447387">t</span><span class="op" id="8447388">.</span><span class="ident" id="8447389">Fatalf</span><span class="op" id="8447395">(</span><span class="string" id="8447396">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8447415">,</span>&nbsp;<span class="ident" id="8447417">err</span><span class="op" id="8447420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447427">done</span>&nbsp;<span class="op" id="8447432">:=</span>&nbsp;<span class="builtinfunc" id="8447435">make</span><span class="op" id="8447439">(</span><span class="keyword" id="8447440">chan</span>&nbsp;<span class="builtintype" id="8447445">bool</span><span class="op" id="8447449">,</span>&nbsp;<span class="num" id="8447451">1</span><span class="op" id="8447452">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447455">go</span>&nbsp;<span class="keyword" id="8447458">func</span><span class="op" id="8447462">(</span><span class="op" id="8447463">)</span>&nbsp;<span class="op" id="8447465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447469">time</span><span class="op" id="8447473">.</span><span class="ident" id="8447474">Sleep</span><span class="op" id="8447479">(</span><span class="num" id="8447480">100</span>&nbsp;<span class="op" id="8447484">*</span>&nbsp;<span class="ident" id="8447486">time</span><span class="op" id="8447490">.</span><span class="ident" id="8447491">Millisecond</span><span class="op" id="8447502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447506">ln</span><span class="op" id="8447508">.</span><span class="ident" id="8447509">Close</span><span class="op" id="8447514">(</span><span class="op" id="8447515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447518">}</span><span class="op" id="8447519">(</span><span class="op" id="8447520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447523">go</span>&nbsp;<span class="keyword" id="8447526">func</span><span class="op" id="8447530">(</span><span class="op" id="8447531">)</span>&nbsp;<span class="op" id="8447533">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447537">c</span><span class="op" id="8447538">,</span>&nbsp;<span class="ident" id="8447540">err</span>&nbsp;<span class="op" id="8447544">:=</span>&nbsp;<span class="ident" id="8447547">ln</span><span class="op" id="8447549">.</span><span class="ident" id="8447550">Accept</span><span class="op" id="8447556">(</span><span class="op" id="8447557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447561">if</span>&nbsp;<span class="ident" id="8447564">err</span>&nbsp;<span class="op" id="8447568">==</span>&nbsp;<span class="ident" id="8447571">nil</span>&nbsp;<span class="op" id="8447575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447580">c</span><span class="op" id="8447581">.</span><span class="ident" id="8447582">Close</span><span class="op" id="8447587">(</span><span class="op" id="8447588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447593">t</span><span class="op" id="8447594">.</span><span class="ident" id="8447595">Error</span><span class="op" id="8447600">(</span><span class="string" id="8447601">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="8447619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447623">}</span>&nbsp;<span class="keyword" id="8447625">else</span>&nbsp;<span class="op" id="8447630">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447635">t</span><span class="op" id="8447636">.</span><span class="ident" id="8447637">Logf</span><span class="op" id="8447641">(</span><span class="string" id="8447642">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="8447688">,</span>&nbsp;<span class="ident" id="8447690">err</span><span class="op" id="8447693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447701">done</span>&nbsp;<span class="op" id="8447706">&lt;-</span>&nbsp;<span class="builtintype" id="8447709">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447715">}</span><span class="op" id="8447716">(</span><span class="op" id="8447717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447720">select</span>&nbsp;<span class="op" id="8447727">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447730">case</span>&nbsp;<span class="op" id="8447735">&lt;-</span><span class="ident" id="8447737">done</span><span class="op" id="8447741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447744">case</span>&nbsp;<span class="op" id="8447749">&lt;-</span><span class="ident" id="8447751">time</span><span class="op" id="8447755">.</span><span class="ident" id="8447756">After</span><span class="op" id="8447761">(</span><span class="num" id="8447762">2</span>&nbsp;<span class="op" id="8447764">*</span>&nbsp;<span class="ident" id="8447766">time</span><span class="op" id="8447770">.</span><span class="ident" id="8447771">Second</span><span class="op" id="8447777">)</span><span class="op" id="8447778">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447782">t</span><span class="op" id="8447783">.</span><span class="ident" id="8447784">Fatal</span><span class="op" id="8447789">(</span><span class="string" id="8447790">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="8447821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447824">}</span><br>
<span class="lineno"></span><span class="op" id="8447826">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="8447829">func</span>&nbsp;<span class="ident" id="8447834">TestUDPListenClose</span><span class="op" id="8447852">(</span><span class="ident" id="8447853">t</span>&nbsp;<span class="op" id="8447855">*</span><span class="ident" id="8447856">testing</span><span class="op" id="8447863">.</span><span class="ident" id="8447864">T</span><span class="op" id="8447865">)</span>&nbsp;<span class="op" id="8447867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447870">switch</span>&nbsp;<span class="ident" id="8447877">runtime</span><span class="op" id="8447884">.</span><span class="ident" id="8447885">GOOS</span>&nbsp;<span class="op" id="8447890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8447893">case</span>&nbsp;<span class="string" id="8447898">&#34;plan9&#34;</span><span class="op" id="8447905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447909">t</span><span class="op" id="8447910">.</span><span class="ident" id="8447911">Skipf</span><span class="op" id="8447916">(</span><span class="string" id="8447917">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8447938">,</span>&nbsp;<span class="ident" id="8447940">runtime</span><span class="op" id="8447947">.</span><span class="ident" id="8447948">GOOS</span><span class="op" id="8447952">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8447955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8447958">ln</span><span class="op" id="8447960">,</span>&nbsp;<span class="ident" id="8447962">err</span>&nbsp;<span class="op" id="8447966">:=</span>&nbsp;<span class="ident" id="8447969">ListenPacket</span><span class="op" id="8447981">(</span><span class="string" id="8447982">&#34;udp&#34;</span><span class="op" id="8447987">,</span>&nbsp;<span class="string" id="8447989">&#34;127.0.0.1:0&#34;</span><span class="op" id="8448002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448005">if</span>&nbsp;<span class="ident" id="8448008">err</span>&nbsp;<span class="op" id="8448012">!=</span>&nbsp;<span class="ident" id="8448015">nil</span>&nbsp;<span class="op" id="8448019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448023">t</span><span class="op" id="8448024">.</span><span class="ident" id="8448025">Fatalf</span><span class="op" id="8448031">(</span><span class="string" id="8448032">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8448051">,</span>&nbsp;<span class="ident" id="8448053">err</span><span class="op" id="8448056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448059">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448063">buf</span>&nbsp;<span class="op" id="8448067">:=</span>&nbsp;<span class="builtinfunc" id="8448070">make</span><span class="op" id="8448074">(</span><span class="op" id="8448075">[</span><span class="op" id="8448076">]</span><span class="builtintype" id="8448077">byte</span><span class="op" id="8448081">,</span>&nbsp;<span class="num" id="8448083">1000</span><span class="op" id="8448087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448090">done</span>&nbsp;<span class="op" id="8448095">:=</span>&nbsp;<span class="builtinfunc" id="8448098">make</span><span class="op" id="8448102">(</span><span class="keyword" id="8448103">chan</span>&nbsp;<span class="builtintype" id="8448108">bool</span><span class="op" id="8448112">,</span>&nbsp;<span class="num" id="8448114">1</span><span class="op" id="8448115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448118">go</span>&nbsp;<span class="keyword" id="8448121">func</span><span class="op" id="8448125">(</span><span class="op" id="8448126">)</span>&nbsp;<span class="op" id="8448128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448132">time</span><span class="op" id="8448136">.</span><span class="ident" id="8448137">Sleep</span><span class="op" id="8448142">(</span><span class="num" id="8448143">100</span>&nbsp;<span class="op" id="8448147">*</span>&nbsp;<span class="ident" id="8448149">time</span><span class="op" id="8448153">.</span><span class="ident" id="8448154">Millisecond</span><span class="op" id="8448165">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448169">ln</span><span class="op" id="8448171">.</span><span class="ident" id="8448172">Close</span><span class="op" id="8448177">(</span><span class="op" id="8448178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448181">}</span><span class="op" id="8448182">(</span><span class="op" id="8448183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448186">go</span>&nbsp;<span class="keyword" id="8448189">func</span><span class="op" id="8448193">(</span><span class="op" id="8448194">)</span>&nbsp;<span class="op" id="8448196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448200">_</span><span class="op" id="8448201">,</span>&nbsp;<span class="ident" id="8448203">_</span><span class="op" id="8448204">,</span>&nbsp;<span class="ident" id="8448206">err</span>&nbsp;<span class="op" id="8448210">=</span>&nbsp;<span class="ident" id="8448212">ln</span><span class="op" id="8448214">.</span><span class="ident" id="8448215">ReadFrom</span><span class="op" id="8448223">(</span><span class="ident" id="8448224">buf</span><span class="op" id="8448227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448231">if</span>&nbsp;<span class="ident" id="8448234">err</span>&nbsp;<span class="op" id="8448238">==</span>&nbsp;<span class="ident" id="8448241">nil</span>&nbsp;<span class="op" id="8448245">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448250">t</span><span class="op" id="8448251">.</span><span class="ident" id="8448252">Error</span><span class="op" id="8448257">(</span><span class="string" id="8448258">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="8448278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448282">}</span>&nbsp;<span class="keyword" id="8448284">else</span>&nbsp;<span class="op" id="8448289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448294">t</span><span class="op" id="8448295">.</span><span class="ident" id="8448296">Logf</span><span class="op" id="8448300">(</span><span class="string" id="8448301">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="8448349">,</span>&nbsp;<span class="ident" id="8448351">err</span><span class="op" id="8448354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448362">done</span>&nbsp;<span class="op" id="8448367">&lt;-</span>&nbsp;<span class="builtintype" id="8448370">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448376">}</span><span class="op" id="8448377">(</span><span class="op" id="8448378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448381">select</span>&nbsp;<span class="op" id="8448388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448391">case</span>&nbsp;<span class="op" id="8448396">&lt;-</span><span class="ident" id="8448398">done</span><span class="op" id="8448402">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448405">case</span>&nbsp;<span class="op" id="8448410">&lt;-</span><span class="ident" id="8448412">time</span><span class="op" id="8448416">.</span><span class="ident" id="8448417">After</span><span class="op" id="8448422">(</span><span class="num" id="8448423">2</span>&nbsp;<span class="op" id="8448425">*</span>&nbsp;<span class="ident" id="8448427">time</span><span class="op" id="8448431">.</span><span class="ident" id="8448432">Second</span><span class="op" id="8448438">)</span><span class="op" id="8448439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448443">t</span><span class="op" id="8448444">.</span><span class="ident" id="8448445">Fatal</span><span class="op" id="8448450">(</span><span class="string" id="8448451">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="8448482">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448485">}</span><br>
<span class="lineno"></span><span class="op" id="8448487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8448490">func</span>&nbsp;<span class="ident" id="8448495">TestTCPClose</span><span class="op" id="8448507">(</span><span class="ident" id="8448508">t</span>&nbsp;<span class="op" id="8448510">*</span><span class="ident" id="8448511">testing</span><span class="op" id="8448518">.</span><span class="ident" id="8448519">T</span><span class="op" id="8448520">)</span>&nbsp;<span class="op" id="8448522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448525">switch</span>&nbsp;<span class="ident" id="8448532">runtime</span><span class="op" id="8448539">.</span><span class="ident" id="8448540">GOOS</span>&nbsp;<span class="op" id="8448545">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448548">case</span>&nbsp;<span class="string" id="8448553">&#34;plan9&#34;</span><span class="op" id="8448560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448564">t</span><span class="op" id="8448565">.</span><span class="ident" id="8448566">Skipf</span><span class="op" id="8448571">(</span><span class="string" id="8448572">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8448593">,</span>&nbsp;<span class="ident" id="8448595">runtime</span><span class="op" id="8448602">.</span><span class="ident" id="8448603">GOOS</span><span class="op" id="8448607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448613">l</span><span class="op" id="8448614">,</span>&nbsp;<span class="ident" id="8448616">err</span>&nbsp;<span class="op" id="8448620">:=</span>&nbsp;<span class="ident" id="8448623">Listen</span><span class="op" id="8448629">(</span><span class="string" id="8448630">&#34;tcp&#34;</span><span class="op" id="8448635">,</span>&nbsp;<span class="string" id="8448637">&#34;127.0.0.1:0&#34;</span><span class="op" id="8448650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448653">if</span>&nbsp;<span class="ident" id="8448656">err</span>&nbsp;<span class="op" id="8448660">!=</span>&nbsp;<span class="ident" id="8448663">nil</span>&nbsp;<span class="op" id="8448667">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448671">t</span><span class="op" id="8448672">.</span><span class="ident" id="8448673">Fatal</span><span class="op" id="8448678">(</span><span class="ident" id="8448679">err</span><span class="op" id="8448682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448688">defer</span>&nbsp;<span class="ident" id="8448694">l</span><span class="op" id="8448695">.</span><span class="ident" id="8448696">Close</span><span class="op" id="8448701">(</span><span class="op" id="8448702">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448706">read</span>&nbsp;<span class="op" id="8448711">:=</span>&nbsp;<span class="keyword" id="8448714">func</span><span class="op" id="8448718">(</span><span class="ident" id="8448719">r</span>&nbsp;<span class="ident" id="8448721">io</span><span class="op" id="8448723">.</span><span class="ident" id="8448724">Reader</span><span class="op" id="8448730">)</span>&nbsp;<span class="builtintype" id="8448732">error</span>&nbsp;<span class="op" id="8448738">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448742">var</span>&nbsp;<span class="ident" id="8448746">m</span>&nbsp;<span class="op" id="8448748">[</span><span class="num" id="8448749">1</span><span class="op" id="8448750">]</span><span class="builtintype" id="8448751">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448758">_</span><span class="op" id="8448759">,</span>&nbsp;<span class="ident" id="8448761">err</span>&nbsp;<span class="op" id="8448765">:=</span>&nbsp;<span class="ident" id="8448768">r</span><span class="op" id="8448769">.</span><span class="ident" id="8448770">Read</span><span class="op" id="8448774">(</span><span class="ident" id="8448775">m</span><span class="op" id="8448776">[</span><span class="op" id="8448777">:</span><span class="op" id="8448778">]</span><span class="op" id="8448779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448783">return</span>&nbsp;<span class="ident" id="8448790">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448799">go</span>&nbsp;<span class="keyword" id="8448802">func</span><span class="op" id="8448806">(</span><span class="op" id="8448807">)</span>&nbsp;<span class="op" id="8448809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448813">c</span><span class="op" id="8448814">,</span>&nbsp;<span class="ident" id="8448816">err</span>&nbsp;<span class="op" id="8448820">:=</span>&nbsp;<span class="ident" id="8448823">Dial</span><span class="op" id="8448827">(</span><span class="string" id="8448828">&#34;tcp&#34;</span><span class="op" id="8448833">,</span>&nbsp;<span class="ident" id="8448835">l</span><span class="op" id="8448836">.</span><span class="ident" id="8448837">Addr</span><span class="op" id="8448841">(</span><span class="op" id="8448842">)</span><span class="op" id="8448843">.</span><span class="ident" id="8448844">String</span><span class="op" id="8448850">(</span><span class="op" id="8448851">)</span><span class="op" id="8448852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448856">if</span>&nbsp;<span class="ident" id="8448859">err</span>&nbsp;<span class="op" id="8448863">!=</span>&nbsp;<span class="ident" id="8448866">nil</span>&nbsp;<span class="op" id="8448870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448875">t</span><span class="op" id="8448876">.</span><span class="ident" id="8448877">Errorf</span><span class="op" id="8448883">(</span><span class="string" id="8448884">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8448894">,</span>&nbsp;<span class="ident" id="8448896">err</span><span class="op" id="8448899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448904">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448918">go</span>&nbsp;<span class="ident" id="8448921">read</span><span class="op" id="8448925">(</span><span class="ident" id="8448926">c</span><span class="op" id="8448927">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448932">time</span><span class="op" id="8448936">.</span><span class="ident" id="8448937">Sleep</span><span class="op" id="8448942">(</span><span class="num" id="8448943">10</span>&nbsp;<span class="op" id="8448946">*</span>&nbsp;<span class="ident" id="8448948">time</span><span class="op" id="8448952">.</span><span class="ident" id="8448953">Millisecond</span><span class="op" id="8448964">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448968">c</span><span class="op" id="8448969">.</span><span class="ident" id="8448970">Close</span><span class="op" id="8448975">(</span><span class="op" id="8448976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448979">}</span><span class="op" id="8448980">(</span><span class="op" id="8448981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448985">c</span><span class="op" id="8448986">,</span>&nbsp;<span class="ident" id="8448988">err</span>&nbsp;<span class="op" id="8448992">:=</span>&nbsp;<span class="ident" id="8448995">l</span><span class="op" id="8448996">.</span><span class="ident" id="8448997">Accept</span><span class="op" id="8449003">(</span><span class="op" id="8449004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449007">if</span>&nbsp;<span class="ident" id="8449010">err</span>&nbsp;<span class="op" id="8449014">!=</span>&nbsp;<span class="ident" id="8449017">nil</span>&nbsp;<span class="op" id="8449021">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449025">t</span><span class="op" id="8449026">.</span><span class="ident" id="8449027">Fatal</span><span class="op" id="8449032">(</span><span class="ident" id="8449033">err</span><span class="op" id="8449036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449042">defer</span>&nbsp;<span class="ident" id="8449048">c</span><span class="op" id="8449049">.</span><span class="ident" id="8449050">Close</span><span class="op" id="8449055">(</span><span class="op" id="8449056">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449060">for</span>&nbsp;<span class="ident" id="8449064">err</span>&nbsp;<span class="op" id="8449068">==</span>&nbsp;<span class="ident" id="8449071">nil</span>&nbsp;<span class="op" id="8449075">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449079">err</span>&nbsp;<span class="op" id="8449083">=</span>&nbsp;<span class="ident" id="8449085">read</span><span class="op" id="8449089">(</span><span class="ident" id="8449090">c</span><span class="op" id="8449091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449097">if</span>&nbsp;<span class="ident" id="8449100">err</span>&nbsp;<span class="op" id="8449104">!=</span>&nbsp;<span class="ident" id="8449107">nil</span>&nbsp;<span class="op" id="8449111">&amp;&amp;</span>&nbsp;<span class="ident" id="8449114">err</span>&nbsp;<span class="op" id="8449118">!=</span>&nbsp;<span class="ident" id="8449121">io</span><span class="op" id="8449123">.</span><span class="ident" id="8449124">EOF</span>&nbsp;<span class="op" id="8449128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449132">t</span><span class="op" id="8449133">.</span><span class="ident" id="8449134">Fatal</span><span class="op" id="8449139">(</span><span class="ident" id="8449140">err</span><span class="op" id="8449143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449146">}</span><br>
<span class="lineno">225</span><span class="op" id="8449148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8449151">func</span>&nbsp;<span class="ident" id="8449156">TestErrorNil</span><span class="op" id="8449168">(</span><span class="ident" id="8449169">t</span>&nbsp;<span class="op" id="8449171">*</span><span class="ident" id="8449172">testing</span><span class="op" id="8449179">.</span><span class="ident" id="8449180">T</span><span class="op" id="8449181">)</span>&nbsp;<span class="op" id="8449183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449186">c</span><span class="op" id="8449187">,</span>&nbsp;<span class="ident" id="8449189">err</span>&nbsp;<span class="op" id="8449193">:=</span>&nbsp;<span class="ident" id="8449196">Dial</span><span class="op" id="8449200">(</span><span class="string" id="8449201">&#34;tcp&#34;</span><span class="op" id="8449206">,</span>&nbsp;<span class="string" id="8449208">&#34;127.0.0.1:65535&#34;</span><span class="op" id="8449225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449228">if</span>&nbsp;<span class="ident" id="8449231">err</span>&nbsp;<span class="op" id="8449235">==</span>&nbsp;<span class="ident" id="8449238">nil</span>&nbsp;<span class="op" id="8449242">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449246">t</span><span class="op" id="8449247">.</span><span class="ident" id="8449248">Fatal</span><span class="op" id="8449253">(</span><span class="string" id="8449254">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="8449286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449292">if</span>&nbsp;<span class="ident" id="8449295">c</span>&nbsp;<span class="op" id="8449297">!=</span>&nbsp;<span class="ident" id="8449300">nil</span>&nbsp;<span class="op" id="8449304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449308">t</span><span class="op" id="8449309">.</span><span class="ident" id="8449310">Fatalf</span><span class="op" id="8449316">(</span><span class="string" id="8449317">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8449373">,</span>&nbsp;<span class="ident" id="8449375">c</span><span class="op" id="8449376">,</span>&nbsp;<span class="ident" id="8449378">c</span><span class="op" id="8449379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449382">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8449386">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449443">l</span><span class="op" id="8449444">,</span>&nbsp;<span class="ident" id="8449446">err</span>&nbsp;<span class="op" id="8449450">:=</span>&nbsp;<span class="ident" id="8449453">Listen</span><span class="op" id="8449459">(</span><span class="string" id="8449460">&#34;tcp&#34;</span><span class="op" id="8449465">,</span>&nbsp;<span class="string" id="8449467">&#34;127.0.0.1:0&#34;</span><span class="op" id="8449480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449483">if</span>&nbsp;<span class="ident" id="8449486">err</span>&nbsp;<span class="op" id="8449490">!=</span>&nbsp;<span class="ident" id="8449493">nil</span>&nbsp;<span class="op" id="8449497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449501">t</span><span class="op" id="8449502">.</span><span class="ident" id="8449503">Fatalf</span><span class="op" id="8449509">(</span><span class="string" id="8449510">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="8449534">,</span>&nbsp;<span class="ident" id="8449536">err</span><span class="op" id="8449539">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449545">defer</span>&nbsp;<span class="ident" id="8449551">l</span><span class="op" id="8449552">.</span><span class="ident" id="8449553">Close</span><span class="op" id="8449558">(</span><span class="op" id="8449559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449562">l1</span><span class="op" id="8449564">,</span>&nbsp;<span class="ident" id="8449566">err</span>&nbsp;<span class="op" id="8449570">:=</span>&nbsp;<span class="ident" id="8449573">Listen</span><span class="op" id="8449579">(</span><span class="string" id="8449580">&#34;tcp&#34;</span><span class="op" id="8449585">,</span>&nbsp;<span class="ident" id="8449587">l</span><span class="op" id="8449588">.</span><span class="ident" id="8449589">Addr</span><span class="op" id="8449593">(</span><span class="op" id="8449594">)</span><span class="op" id="8449595">.</span><span class="ident" id="8449596">String</span><span class="op" id="8449602">(</span><span class="op" id="8449603">)</span><span class="op" id="8449604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449607">if</span>&nbsp;<span class="ident" id="8449610">err</span>&nbsp;<span class="op" id="8449614">==</span>&nbsp;<span class="ident" id="8449617">nil</span>&nbsp;<span class="op" id="8449621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449625">t</span><span class="op" id="8449626">.</span><span class="ident" id="8449627">Fatalf</span><span class="op" id="8449633">(</span><span class="string" id="8449634">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="8449656">,</span>&nbsp;<span class="ident" id="8449658">l</span><span class="op" id="8449659">.</span><span class="ident" id="8449660">Addr</span><span class="op" id="8449664">(</span><span class="op" id="8449665">)</span><span class="op" id="8449666">,</span>&nbsp;<span class="ident" id="8449668">err</span><span class="op" id="8449671">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449677">if</span>&nbsp;<span class="ident" id="8449680">l1</span>&nbsp;<span class="op" id="8449683">!=</span>&nbsp;<span class="ident" id="8449686">nil</span>&nbsp;<span class="op" id="8449690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449694">t</span><span class="op" id="8449695">.</span><span class="ident" id="8449696">Fatalf</span><span class="op" id="8449702">(</span><span class="string" id="8449703">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8449761">,</span>&nbsp;<span class="ident" id="8449763">l1</span><span class="op" id="8449765">,</span>&nbsp;<span class="ident" id="8449767">l1</span><span class="op" id="8449769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8449776">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449839">lp</span><span class="op" id="8449841">,</span>&nbsp;<span class="ident" id="8449843">err</span>&nbsp;<span class="op" id="8449847">:=</span>&nbsp;<span class="ident" id="8449850">ListenPacket</span><span class="op" id="8449862">(</span><span class="string" id="8449863">&#34;udp&#34;</span><span class="op" id="8449868">,</span>&nbsp;<span class="string" id="8449870">&#34;127.0.0.1:0&#34;</span><span class="op" id="8449883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449886">if</span>&nbsp;<span class="ident" id="8449889">err</span>&nbsp;<span class="op" id="8449893">!=</span>&nbsp;<span class="ident" id="8449896">nil</span>&nbsp;<span class="op" id="8449900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449904">t</span><span class="op" id="8449905">.</span><span class="ident" id="8449906">Fatalf</span><span class="op" id="8449912">(</span><span class="string" id="8449913">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="8449937">,</span>&nbsp;<span class="ident" id="8449939">err</span><span class="op" id="8449942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449945">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449948">defer</span>&nbsp;<span class="ident" id="8449954">lp</span><span class="op" id="8449956">.</span><span class="ident" id="8449957">Close</span><span class="op" id="8449962">(</span><span class="op" id="8449963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449966">lp1</span><span class="op" id="8449969">,</span>&nbsp;<span class="ident" id="8449971">err</span>&nbsp;<span class="op" id="8449975">:=</span>&nbsp;<span class="ident" id="8449978">ListenPacket</span><span class="op" id="8449990">(</span><span class="string" id="8449991">&#34;udp&#34;</span><span class="op" id="8449996">,</span>&nbsp;<span class="ident" id="8449998">lp</span><span class="op" id="8450000">.</span><span class="ident" id="8450001">LocalAddr</span><span class="op" id="8450010">(</span><span class="op" id="8450011">)</span><span class="op" id="8450012">.</span><span class="ident" id="8450013">String</span><span class="op" id="8450019">(</span><span class="op" id="8450020">)</span><span class="op" id="8450021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8450024">if</span>&nbsp;<span class="ident" id="8450027">err</span>&nbsp;<span class="op" id="8450031">==</span>&nbsp;<span class="ident" id="8450034">nil</span>&nbsp;<span class="op" id="8450038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8450042">t</span><span class="op" id="8450043">.</span><span class="ident" id="8450044">Fatalf</span><span class="op" id="8450050">(</span><span class="string" id="8450051">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="8450073">,</span>&nbsp;<span class="ident" id="8450075">lp</span><span class="op" id="8450077">.</span><span class="ident" id="8450078">LocalAddr</span><span class="op" id="8450087">(</span><span class="op" id="8450088">)</span><span class="op" id="8450089">,</span>&nbsp;<span class="ident" id="8450091">err</span><span class="op" id="8450094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450097">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8450100">if</span>&nbsp;<span class="ident" id="8450103">lp1</span>&nbsp;<span class="op" id="8450107">!=</span>&nbsp;<span class="ident" id="8450110">nil</span>&nbsp;<span class="op" id="8450114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8450118">t</span><span class="op" id="8450119">.</span><span class="ident" id="8450120">Fatalf</span><span class="op" id="8450126">(</span><span class="string" id="8450127">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8450191">,</span>&nbsp;<span class="ident" id="8450193">lp1</span><span class="op" id="8450196">,</span>&nbsp;<span class="ident" id="8450198">lp1</span><span class="op" id="8450201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450204">}</span><br>
<span class="lineno"></span><span class="op" id="8450206">}</span>
</div>
</body>
</html>
