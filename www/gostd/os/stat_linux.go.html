<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2491596">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2491651">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2491705">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2491756">package</span>&nbsp;<span class="ident" id="2491764">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2491768">import</span>&nbsp;<span class="op" id="2491775">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2491778">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2491789">&#34;time&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2491796">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2491799">func</span>&nbsp;<span class="ident" id="2491804">sameFile</span><span class="op" id="2491812">(</span><span class="ident" id="2491813">fs1</span><span class="op" id="2491816">,</span>&nbsp;<span class="ident" id="2491818">fs2</span>&nbsp;<span class="op" id="2491822">*</span><span class="ident" id="2491823">fileStat</span><span class="op" id="2491831">)</span>&nbsp;<span class="builtintype" id="2491833">bool</span>&nbsp;<span class="op" id="2491838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2491841">stat1</span>&nbsp;<span class="op" id="2491847">:=</span>&nbsp;<span class="ident" id="2491850">fs1</span><span class="op" id="2491853">.</span><span class="ident" id="2491854">sys</span><span class="op" id="2491857">.</span><span class="op" id="2491858">(</span><span class="op" id="2491859">*</span><span class="ident" id="2491860">syscall</span><span class="op" id="2491867">.</span><span class="ident" id="2491868">Stat_t</span><span class="op" id="2491874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2491877">stat2</span>&nbsp;<span class="op" id="2491883">:=</span>&nbsp;<span class="ident" id="2491886">fs2</span><span class="op" id="2491889">.</span><span class="ident" id="2491890">sys</span><span class="op" id="2491893">.</span><span class="op" id="2491894">(</span><span class="op" id="2491895">*</span><span class="ident" id="2491896">syscall</span><span class="op" id="2491903">.</span><span class="ident" id="2491904">Stat_t</span><span class="op" id="2491910">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2491913">return</span>&nbsp;<span class="ident" id="2491920">stat1</span><span class="op" id="2491925">.</span><span class="ident" id="2491926">Dev</span>&nbsp;<span class="op" id="2491930">==</span>&nbsp;<span class="ident" id="2491933">stat2</span><span class="op" id="2491938">.</span><span class="ident" id="2491939">Dev</span>&nbsp;<span class="op" id="2491943">&amp;&amp;</span>&nbsp;<span class="ident" id="2491946">stat1</span><span class="op" id="2491951">.</span><span class="ident" id="2491952">Ino</span>&nbsp;<span class="op" id="2491956">==</span>&nbsp;<span class="ident" id="2491959">stat2</span><span class="op" id="2491964">.</span><span class="ident" id="2491965">Ino</span><br>
<span class="lineno"></span><span class="op" id="2491969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2491972">func</span>&nbsp;<span class="ident" id="2491977">fileInfoFromStat</span><span class="op" id="2491993">(</span><span class="ident" id="2491994">st</span>&nbsp;<span class="op" id="2491997">*</span><span class="ident" id="2491998">syscall</span><span class="op" id="2492005">.</span><span class="ident" id="2492006">Stat_t</span><span class="op" id="2492012">,</span>&nbsp;<span class="ident" id="2492014">name</span>&nbsp;<span class="builtintype" id="2492019">string</span><span class="op" id="2492025">)</span>&nbsp;<span class="ident" id="2492027">FileInfo</span>&nbsp;<span class="op" id="2492036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492039">fs</span>&nbsp;<span class="op" id="2492042">:=</span>&nbsp;<span class="op" id="2492045">&amp;</span><span class="ident" id="2492046">fileStat</span><span class="op" id="2492054">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492058">name</span><span class="op" id="2492062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2492067">basename</span><span class="op" id="2492075">(</span><span class="ident" id="2492076">name</span><span class="op" id="2492080">)</span><span class="op" id="2492081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492085">size</span><span class="op" id="2492089">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2492094">int64</span><span class="op" id="2492099">(</span><span class="ident" id="2492100">st</span><span class="op" id="2492102">.</span><span class="ident" id="2492103">Size</span><span class="op" id="2492107">)</span><span class="op" id="2492108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492112">modTime</span><span class="op" id="2492119">:</span>&nbsp;<span class="ident" id="2492121">timespecToTime</span><span class="op" id="2492135">(</span><span class="ident" id="2492136">st</span><span class="op" id="2492138">.</span><span class="ident" id="2492139">Mtim</span><span class="op" id="2492143">)</span><span class="op" id="2492144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492148">sys</span><span class="op" id="2492151">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2492157">st</span><span class="op" id="2492159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2492162">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492165">fs</span><span class="op" id="2492167">.</span><span class="ident" id="2492168">mode</span>&nbsp;<span class="op" id="2492173">=</span>&nbsp;<span class="ident" id="2492175">FileMode</span><span class="op" id="2492183">(</span><span class="ident" id="2492184">st</span><span class="op" id="2492186">.</span><span class="ident" id="2492187">Mode</span>&nbsp;<span class="op" id="2492192">&amp;</span>&nbsp;<span class="num" id="2492194">0777</span><span class="op" id="2492198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492201">switch</span>&nbsp;<span class="ident" id="2492208">st</span><span class="op" id="2492210">.</span><span class="ident" id="2492211">Mode</span>&nbsp;<span class="op" id="2492216">&amp;</span>&nbsp;<span class="ident" id="2492218">syscall</span><span class="op" id="2492225">.</span><span class="ident" id="2492226">S_IFMT</span>&nbsp;<span class="op" id="2492233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492236">case</span>&nbsp;<span class="ident" id="2492241">syscall</span><span class="op" id="2492248">.</span><span class="ident" id="2492249">S_IFBLK</span><span class="op" id="2492256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492260">fs</span><span class="op" id="2492262">.</span><span class="ident" id="2492263">mode</span>&nbsp;<span class="op" id="2492268">|=</span>&nbsp;<span class="ident" id="2492271">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492283">case</span>&nbsp;<span class="ident" id="2492288">syscall</span><span class="op" id="2492295">.</span><span class="ident" id="2492296">S_IFCHR</span><span class="op" id="2492303">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492307">fs</span><span class="op" id="2492309">.</span><span class="ident" id="2492310">mode</span>&nbsp;<span class="op" id="2492315">|=</span>&nbsp;<span class="ident" id="2492318">ModeDevice</span>&nbsp;<span class="op" id="2492329">|</span>&nbsp;<span class="ident" id="2492331">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492347">case</span>&nbsp;<span class="ident" id="2492352">syscall</span><span class="op" id="2492359">.</span><span class="ident" id="2492360">S_IFDIR</span><span class="op" id="2492367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492371">fs</span><span class="op" id="2492373">.</span><span class="ident" id="2492374">mode</span>&nbsp;<span class="op" id="2492379">|=</span>&nbsp;<span class="ident" id="2492382">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492391">case</span>&nbsp;<span class="ident" id="2492396">syscall</span><span class="op" id="2492403">.</span><span class="ident" id="2492404">S_IFIFO</span><span class="op" id="2492411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492415">fs</span><span class="op" id="2492417">.</span><span class="ident" id="2492418">mode</span>&nbsp;<span class="op" id="2492423">|=</span>&nbsp;<span class="ident" id="2492426">ModeNamedPipe</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492441">case</span>&nbsp;<span class="ident" id="2492446">syscall</span><span class="op" id="2492453">.</span><span class="ident" id="2492454">S_IFLNK</span><span class="op" id="2492461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492465">fs</span><span class="op" id="2492467">.</span><span class="ident" id="2492468">mode</span>&nbsp;<span class="op" id="2492473">|=</span>&nbsp;<span class="ident" id="2492476">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492489">case</span>&nbsp;<span class="ident" id="2492494">syscall</span><span class="op" id="2492501">.</span><span class="ident" id="2492502">S_IFREG</span><span class="op" id="2492509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2492513">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492531">case</span>&nbsp;<span class="ident" id="2492536">syscall</span><span class="op" id="2492543">.</span><span class="ident" id="2492544">S_IFSOCK</span><span class="op" id="2492552">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492556">fs</span><span class="op" id="2492558">.</span><span class="ident" id="2492559">mode</span>&nbsp;<span class="op" id="2492564">|=</span>&nbsp;<span class="ident" id="2492567">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2492579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492582">if</span>&nbsp;<span class="ident" id="2492585">st</span><span class="op" id="2492587">.</span><span class="ident" id="2492588">Mode</span><span class="op" id="2492592">&amp;</span><span class="ident" id="2492593">syscall</span><span class="op" id="2492600">.</span><span class="ident" id="2492601">S_ISGID</span>&nbsp;<span class="op" id="2492609">!=</span>&nbsp;<span class="num" id="2492612">0</span>&nbsp;<span class="op" id="2492614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492618">fs</span><span class="op" id="2492620">.</span><span class="ident" id="2492621">mode</span>&nbsp;<span class="op" id="2492626">|=</span>&nbsp;<span class="ident" id="2492629">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2492641">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492644">if</span>&nbsp;<span class="ident" id="2492647">st</span><span class="op" id="2492649">.</span><span class="ident" id="2492650">Mode</span><span class="op" id="2492654">&amp;</span><span class="ident" id="2492655">syscall</span><span class="op" id="2492662">.</span><span class="ident" id="2492663">S_ISUID</span>&nbsp;<span class="op" id="2492671">!=</span>&nbsp;<span class="num" id="2492674">0</span>&nbsp;<span class="op" id="2492676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492680">fs</span><span class="op" id="2492682">.</span><span class="ident" id="2492683">mode</span>&nbsp;<span class="op" id="2492688">|=</span>&nbsp;<span class="ident" id="2492691">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2492703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492706">if</span>&nbsp;<span class="ident" id="2492709">st</span><span class="op" id="2492711">.</span><span class="ident" id="2492712">Mode</span><span class="op" id="2492716">&amp;</span><span class="ident" id="2492717">syscall</span><span class="op" id="2492724">.</span><span class="ident" id="2492725">S_ISVTX</span>&nbsp;<span class="op" id="2492733">!=</span>&nbsp;<span class="num" id="2492736">0</span>&nbsp;<span class="op" id="2492738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2492742">fs</span><span class="op" id="2492744">.</span><span class="ident" id="2492745">mode</span>&nbsp;<span class="op" id="2492750">|=</span>&nbsp;<span class="ident" id="2492753">ModeSticky</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2492765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492768">return</span>&nbsp;<span class="ident" id="2492775">fs</span><br>
<span class="lineno"></span><span class="op" id="2492778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2492781">func</span>&nbsp;<span class="ident" id="2492786">timespecToTime</span><span class="op" id="2492800">(</span><span class="ident" id="2492801">ts</span>&nbsp;<span class="ident" id="2492804">syscall</span><span class="op" id="2492811">.</span><span class="ident" id="2492812">Timespec</span><span class="op" id="2492820">)</span>&nbsp;<span class="ident" id="2492822">time</span><span class="op" id="2492826">.</span><span class="ident" id="2492827">Time</span>&nbsp;<span class="op" id="2492832">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492835">return</span>&nbsp;<span class="ident" id="2492842">time</span><span class="op" id="2492846">.</span><span class="ident" id="2492847">Unix</span><span class="op" id="2492851">(</span><span class="ident" id="2492852">int64</span><span class="op" id="2492857">(</span><span class="ident" id="2492858">ts</span><span class="op" id="2492860">.</span><span class="ident" id="2492861">Sec</span><span class="op" id="2492864">)</span><span class="op" id="2492865">,</span>&nbsp;<span class="ident" id="2492867">int64</span><span class="op" id="2492872">(</span><span class="ident" id="2492873">ts</span><span class="op" id="2492875">.</span><span class="ident" id="2492876">Nsec</span><span class="op" id="2492880">)</span><span class="op" id="2492881">)</span><br>
<span class="lineno"></span><span class="op" id="2492883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2492886">//&nbsp;For&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="2492902">func</span>&nbsp;<span class="ident" id="2492907">atime</span><span class="op" id="2492912">(</span><span class="ident" id="2492913">fi</span>&nbsp;<span class="ident" id="2492916">FileInfo</span><span class="op" id="2492924">)</span>&nbsp;<span class="ident" id="2492926">time</span><span class="op" id="2492930">.</span><span class="ident" id="2492931">Time</span>&nbsp;<span class="op" id="2492936">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2492939">return</span>&nbsp;<span class="ident" id="2492946">timespecToTime</span><span class="op" id="2492960">(</span><span class="ident" id="2492961">fi</span><span class="op" id="2492963">.</span><span class="ident" id="2492964">Sys</span><span class="op" id="2492967">(</span><span class="op" id="2492968">)</span><span class="op" id="2492969">.</span><span class="op" id="2492970">(</span><span class="op" id="2492971">*</span><span class="ident" id="2492972">syscall</span><span class="op" id="2492979">.</span><span class="ident" id="2492980">Stat_t</span><span class="op" id="2492986">)</span><span class="op" id="2492987">.</span><span class="ident" id="2492988">Atim</span><span class="op" id="2492992">)</span><br>
<span class="lineno"></span><span class="op" id="2492994">}</span>
</div>
</body>
</html>
