<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8291069">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8291124">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8291178">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8291229">package</span>&nbsp;<span class="ident" id="8291237">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8291242">import</span>&nbsp;<span class="op" id="8291249">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8291252">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8291258">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8291271">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8291277">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8291288">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8291299">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8291306">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8291309">func</span>&nbsp;<span class="ident" id="8291314">TestShutdown</span><span class="op" id="8291326">(</span><span class="ident" id="8291327">t</span>&nbsp;<span class="op" id="8291329">*</span><span class="ident" id="8291330">testing</span><span class="op" id="8291337">.</span><span class="ident" id="8291338">T</span><span class="op" id="8291339">)</span>&nbsp;<span class="op" id="8291341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291344">if</span>&nbsp;<span class="ident" id="8291347">runtime</span><span class="op" id="8291354">.</span><span class="ident" id="8291355">GOOS</span>&nbsp;<span class="op" id="8291360">==</span>&nbsp;<span class="string" id="8291363">&#34;plan9&#34;</span>&nbsp;<span class="op" id="8291371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291375">t</span><span class="op" id="8291376">.</span><span class="ident" id="8291377">Skipf</span><span class="op" id="8291382">(</span><span class="string" id="8291383">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8291404">,</span>&nbsp;<span class="ident" id="8291406">runtime</span><span class="op" id="8291413">.</span><span class="ident" id="8291414">GOOS</span><span class="op" id="8291418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291421">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291424">ln</span><span class="op" id="8291426">,</span>&nbsp;<span class="ident" id="8291428">err</span>&nbsp;<span class="op" id="8291432">:=</span>&nbsp;<span class="ident" id="8291435">Listen</span><span class="op" id="8291441">(</span><span class="string" id="8291442">&#34;tcp&#34;</span><span class="op" id="8291447">,</span>&nbsp;<span class="string" id="8291449">&#34;127.0.0.1:0&#34;</span><span class="op" id="8291462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291465">if</span>&nbsp;<span class="ident" id="8291468">err</span>&nbsp;<span class="op" id="8291472">!=</span>&nbsp;<span class="ident" id="8291475">nil</span>&nbsp;<span class="op" id="8291479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291483">if</span>&nbsp;<span class="ident" id="8291486">ln</span><span class="op" id="8291488">,</span>&nbsp;<span class="ident" id="8291490">err</span>&nbsp;<span class="op" id="8291494">=</span>&nbsp;<span class="ident" id="8291496">Listen</span><span class="op" id="8291502">(</span><span class="string" id="8291503">&#34;tcp6&#34;</span><span class="op" id="8291509">,</span>&nbsp;<span class="string" id="8291511">&#34;[::1]:0&#34;</span><span class="op" id="8291520">)</span><span class="op" id="8291521">;</span>&nbsp;<span class="ident" id="8291523">err</span>&nbsp;<span class="op" id="8291527">!=</span>&nbsp;<span class="ident" id="8291530">nil</span>&nbsp;<span class="op" id="8291534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291539">t</span><span class="op" id="8291540">.</span><span class="ident" id="8291541">Fatalf</span><span class="op" id="8291547">(</span><span class="string" id="8291548">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="8291569">,</span>&nbsp;<span class="ident" id="8291571">err</span><span class="op" id="8291574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291578">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291585">go</span>&nbsp;<span class="keyword" id="8291588">func</span><span class="op" id="8291592">(</span><span class="op" id="8291593">)</span>&nbsp;<span class="op" id="8291595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291599">defer</span>&nbsp;<span class="ident" id="8291605">ln</span><span class="op" id="8291607">.</span><span class="ident" id="8291608">Close</span><span class="op" id="8291613">(</span><span class="op" id="8291614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291618">c</span><span class="op" id="8291619">,</span>&nbsp;<span class="ident" id="8291621">err</span>&nbsp;<span class="op" id="8291625">:=</span>&nbsp;<span class="ident" id="8291628">ln</span><span class="op" id="8291630">.</span><span class="ident" id="8291631">Accept</span><span class="op" id="8291637">(</span><span class="op" id="8291638">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291642">if</span>&nbsp;<span class="ident" id="8291645">err</span>&nbsp;<span class="op" id="8291649">!=</span>&nbsp;<span class="ident" id="8291652">nil</span>&nbsp;<span class="op" id="8291656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291661">t</span><span class="op" id="8291662">.</span><span class="ident" id="8291663">Errorf</span><span class="op" id="8291669">(</span><span class="string" id="8291670">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="8291682">,</span>&nbsp;<span class="ident" id="8291684">err</span><span class="op" id="8291687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291692">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291705">var</span>&nbsp;<span class="ident" id="8291709">buf</span>&nbsp;<span class="op" id="8291713">[</span><span class="num" id="8291714">10</span><span class="op" id="8291716">]</span><span class="builtintype" id="8291717">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291724">n</span><span class="op" id="8291725">,</span>&nbsp;<span class="ident" id="8291727">err</span>&nbsp;<span class="op" id="8291731">:=</span>&nbsp;<span class="ident" id="8291734">c</span><span class="op" id="8291735">.</span><span class="ident" id="8291736">Read</span><span class="op" id="8291740">(</span><span class="ident" id="8291741">buf</span><span class="op" id="8291744">[</span><span class="op" id="8291745">:</span><span class="op" id="8291746">]</span><span class="op" id="8291747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291751">if</span>&nbsp;<span class="ident" id="8291754">n</span>&nbsp;<span class="op" id="8291756">!=</span>&nbsp;<span class="num" id="8291759">0</span>&nbsp;<span class="op" id="8291761">||</span>&nbsp;<span class="ident" id="8291764">err</span>&nbsp;<span class="op" id="8291768">!=</span>&nbsp;<span class="ident" id="8291771">io</span><span class="op" id="8291773">.</span><span class="ident" id="8291774">EOF</span>&nbsp;<span class="op" id="8291778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291783">t</span><span class="op" id="8291784">.</span><span class="ident" id="8291785">Errorf</span><span class="op" id="8291791">(</span><span class="string" id="8291792">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="8291830">,</span>&nbsp;<span class="ident" id="8291832">n</span><span class="op" id="8291833">,</span>&nbsp;<span class="ident" id="8291835">err</span><span class="op" id="8291838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291843">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291852">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291856">c</span><span class="op" id="8291857">.</span><span class="ident" id="8291858">Write</span><span class="op" id="8291863">(</span><span class="op" id="8291864">[</span><span class="op" id="8291865">]</span><span class="builtintype" id="8291866">byte</span><span class="op" id="8291870">(</span><span class="string" id="8291871">&#34;response&#34;</span><span class="op" id="8291881">)</span><span class="op" id="8291882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291886">c</span><span class="op" id="8291887">.</span><span class="ident" id="8291888">Close</span><span class="op" id="8291893">(</span><span class="op" id="8291894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291897">}</span><span class="op" id="8291898">(</span><span class="op" id="8291899">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291903">c</span><span class="op" id="8291904">,</span>&nbsp;<span class="ident" id="8291906">err</span>&nbsp;<span class="op" id="8291910">:=</span>&nbsp;<span class="ident" id="8291913">Dial</span><span class="op" id="8291917">(</span><span class="string" id="8291918">&#34;tcp&#34;</span><span class="op" id="8291923">,</span>&nbsp;<span class="ident" id="8291925">ln</span><span class="op" id="8291927">.</span><span class="ident" id="8291928">Addr</span><span class="op" id="8291932">(</span><span class="op" id="8291933">)</span><span class="op" id="8291934">.</span><span class="ident" id="8291935">String</span><span class="op" id="8291941">(</span><span class="op" id="8291942">)</span><span class="op" id="8291943">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291946">if</span>&nbsp;<span class="ident" id="8291949">err</span>&nbsp;<span class="op" id="8291953">!=</span>&nbsp;<span class="ident" id="8291956">nil</span>&nbsp;<span class="op" id="8291960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8291964">t</span><span class="op" id="8291965">.</span><span class="ident" id="8291966">Fatalf</span><span class="op" id="8291972">(</span><span class="string" id="8291973">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8291983">,</span>&nbsp;<span class="ident" id="8291985">err</span><span class="op" id="8291988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291994">defer</span>&nbsp;<span class="ident" id="8292000">c</span><span class="op" id="8292001">.</span><span class="ident" id="8292002">Close</span><span class="op" id="8292007">(</span><span class="op" id="8292008">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292012">err</span>&nbsp;<span class="op" id="8292016">=</span>&nbsp;<span class="ident" id="8292018">c</span><span class="op" id="8292019">.</span><span class="op" id="8292020">(</span><span class="op" id="8292021">*</span><span class="ident" id="8292022">TCPConn</span><span class="op" id="8292029">)</span><span class="op" id="8292030">.</span><span class="ident" id="8292031">CloseWrite</span><span class="op" id="8292041">(</span><span class="op" id="8292042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292045">if</span>&nbsp;<span class="ident" id="8292048">err</span>&nbsp;<span class="op" id="8292052">!=</span>&nbsp;<span class="ident" id="8292055">nil</span>&nbsp;<span class="op" id="8292059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292063">t</span><span class="op" id="8292064">.</span><span class="ident" id="8292065">Fatalf</span><span class="op" id="8292071">(</span><span class="string" id="8292072">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="8292088">,</span>&nbsp;<span class="ident" id="8292090">err</span><span class="op" id="8292093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8292096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292099">var</span>&nbsp;<span class="ident" id="8292103">buf</span>&nbsp;<span class="op" id="8292107">[</span><span class="num" id="8292108">10</span><span class="op" id="8292110">]</span><span class="builtintype" id="8292111">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292117">n</span><span class="op" id="8292118">,</span>&nbsp;<span class="ident" id="8292120">err</span>&nbsp;<span class="op" id="8292124">:=</span>&nbsp;<span class="ident" id="8292127">c</span><span class="op" id="8292128">.</span><span class="ident" id="8292129">Read</span><span class="op" id="8292133">(</span><span class="ident" id="8292134">buf</span><span class="op" id="8292137">[</span><span class="op" id="8292138">:</span><span class="op" id="8292139">]</span><span class="op" id="8292140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292143">if</span>&nbsp;<span class="ident" id="8292146">err</span>&nbsp;<span class="op" id="8292150">!=</span>&nbsp;<span class="ident" id="8292153">nil</span>&nbsp;<span class="op" id="8292157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292161">t</span><span class="op" id="8292162">.</span><span class="ident" id="8292163">Fatalf</span><span class="op" id="8292169">(</span><span class="string" id="8292170">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="8292191">,</span>&nbsp;<span class="ident" id="8292193">n</span><span class="op" id="8292194">,</span>&nbsp;<span class="ident" id="8292196">err</span><span class="op" id="8292199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8292202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292205">got</span>&nbsp;<span class="op" id="8292209">:=</span>&nbsp;<span class="builtintype" id="8292212">string</span><span class="op" id="8292218">(</span><span class="ident" id="8292219">buf</span><span class="op" id="8292222">[</span><span class="op" id="8292223">:</span><span class="ident" id="8292224">n</span><span class="op" id="8292225">]</span><span class="op" id="8292226">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292229">if</span>&nbsp;<span class="ident" id="8292232">got</span>&nbsp;<span class="op" id="8292236">!=</span>&nbsp;<span class="string" id="8292239">&#34;response&#34;</span>&nbsp;<span class="op" id="8292250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292254">t</span><span class="op" id="8292255">.</span><span class="ident" id="8292256">Errorf</span><span class="op" id="8292262">(</span><span class="string" id="8292263">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="8292293">,</span>&nbsp;<span class="ident" id="8292295">got</span><span class="op" id="8292298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8292301">}</span><br>
<span class="lineno"></span><span class="op" id="8292303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8292306">func</span>&nbsp;<span class="ident" id="8292311">TestShutdownUnix</span><span class="op" id="8292327">(</span><span class="ident" id="8292328">t</span>&nbsp;<span class="op" id="8292330">*</span><span class="ident" id="8292331">testing</span><span class="op" id="8292338">.</span><span class="ident" id="8292339">T</span><span class="op" id="8292340">)</span>&nbsp;<span class="op" id="8292342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292345">switch</span>&nbsp;<span class="ident" id="8292352">runtime</span><span class="op" id="8292359">.</span><span class="ident" id="8292360">GOOS</span>&nbsp;<span class="op" id="8292365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292368">case</span>&nbsp;<span class="string" id="8292373">&#34;nacl&#34;</span><span class="op" id="8292379">,</span>&nbsp;<span class="string" id="8292381">&#34;plan9&#34;</span><span class="op" id="8292388">,</span>&nbsp;<span class="string" id="8292390">&#34;windows&#34;</span><span class="op" id="8292399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292403">t</span><span class="op" id="8292404">.</span><span class="ident" id="8292405">Skipf</span><span class="op" id="8292410">(</span><span class="string" id="8292411">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8292432">,</span>&nbsp;<span class="ident" id="8292434">runtime</span><span class="op" id="8292441">.</span><span class="ident" id="8292442">GOOS</span><span class="op" id="8292446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8292449">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292452">f</span><span class="op" id="8292453">,</span>&nbsp;<span class="ident" id="8292455">err</span>&nbsp;<span class="op" id="8292459">:=</span>&nbsp;<span class="ident" id="8292462">ioutil</span><span class="op" id="8292468">.</span><span class="ident" id="8292469">TempFile</span><span class="op" id="8292477">(</span><span class="string" id="8292478">&#34;&#34;</span><span class="op" id="8292480">,</span>&nbsp;<span class="string" id="8292482">&#34;go_net_unixtest&#34;</span><span class="op" id="8292499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292502">if</span>&nbsp;<span class="ident" id="8292505">err</span>&nbsp;<span class="op" id="8292509">!=</span>&nbsp;<span class="ident" id="8292512">nil</span>&nbsp;<span class="op" id="8292516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292520">t</span><span class="op" id="8292521">.</span><span class="ident" id="8292522">Fatalf</span><span class="op" id="8292528">(</span><span class="string" id="8292529">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="8292543">,</span>&nbsp;<span class="ident" id="8292545">err</span><span class="op" id="8292548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8292551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292554">f</span><span class="op" id="8292555">.</span><span class="ident" id="8292556">Close</span><span class="op" id="8292561">(</span><span class="op" id="8292562">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292565">tmpname</span>&nbsp;<span class="op" id="8292573">:=</span>&nbsp;<span class="ident" id="8292576">f</span><span class="op" id="8292577">.</span><span class="ident" id="8292578">Name</span><span class="op" id="8292582">(</span><span class="op" id="8292583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292586">os</span><span class="op" id="8292588">.</span><span class="ident" id="8292589">Remove</span><span class="op" id="8292595">(</span><span class="ident" id="8292596">tmpname</span><span class="op" id="8292603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292606">ln</span><span class="op" id="8292608">,</span>&nbsp;<span class="ident" id="8292610">err</span>&nbsp;<span class="op" id="8292614">:=</span>&nbsp;<span class="ident" id="8292617">Listen</span><span class="op" id="8292623">(</span><span class="string" id="8292624">&#34;unix&#34;</span><span class="op" id="8292630">,</span>&nbsp;<span class="ident" id="8292632">tmpname</span><span class="op" id="8292639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292642">if</span>&nbsp;<span class="ident" id="8292645">err</span>&nbsp;<span class="op" id="8292649">!=</span>&nbsp;<span class="ident" id="8292652">nil</span>&nbsp;<span class="op" id="8292656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292660">t</span><span class="op" id="8292661">.</span><span class="ident" id="8292662">Fatalf</span><span class="op" id="8292668">(</span><span class="string" id="8292669">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="8292691">,</span>&nbsp;<span class="ident" id="8292693">tmpname</span><span class="op" id="8292700">,</span>&nbsp;<span class="ident" id="8292702">err</span><span class="op" id="8292705">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8292708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292711">defer</span>&nbsp;<span class="keyword" id="8292717">func</span><span class="op" id="8292721">(</span><span class="op" id="8292722">)</span>&nbsp;<span class="op" id="8292724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292728">ln</span><span class="op" id="8292730">.</span><span class="ident" id="8292731">Close</span><span class="op" id="8292736">(</span><span class="op" id="8292737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292741">os</span><span class="op" id="8292743">.</span><span class="ident" id="8292744">Remove</span><span class="op" id="8292750">(</span><span class="ident" id="8292751">tmpname</span><span class="op" id="8292758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8292761">}</span><span class="op" id="8292762">(</span><span class="op" id="8292763">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292767">go</span>&nbsp;<span class="keyword" id="8292770">func</span><span class="op" id="8292774">(</span><span class="op" id="8292775">)</span>&nbsp;<span class="op" id="8292777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292781">c</span><span class="op" id="8292782">,</span>&nbsp;<span class="ident" id="8292784">err</span>&nbsp;<span class="op" id="8292788">:=</span>&nbsp;<span class="ident" id="8292791">ln</span><span class="op" id="8292793">.</span><span class="ident" id="8292794">Accept</span><span class="op" id="8292800">(</span><span class="op" id="8292801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292805">if</span>&nbsp;<span class="ident" id="8292808">err</span>&nbsp;<span class="op" id="8292812">!=</span>&nbsp;<span class="ident" id="8292815">nil</span>&nbsp;<span class="op" id="8292819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292824">t</span><span class="op" id="8292825">.</span><span class="ident" id="8292826">Errorf</span><span class="op" id="8292832">(</span><span class="string" id="8292833">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="8292845">,</span>&nbsp;<span class="ident" id="8292847">err</span><span class="op" id="8292850">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292855">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8292864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292868">var</span>&nbsp;<span class="ident" id="8292872">buf</span>&nbsp;<span class="op" id="8292876">[</span><span class="num" id="8292877">10</span><span class="op" id="8292879">]</span><span class="builtintype" id="8292880">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292887">n</span><span class="op" id="8292888">,</span>&nbsp;<span class="ident" id="8292890">err</span>&nbsp;<span class="op" id="8292894">:=</span>&nbsp;<span class="ident" id="8292897">c</span><span class="op" id="8292898">.</span><span class="ident" id="8292899">Read</span><span class="op" id="8292903">(</span><span class="ident" id="8292904">buf</span><span class="op" id="8292907">[</span><span class="op" id="8292908">:</span><span class="op" id="8292909">]</span><span class="op" id="8292910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8292914">if</span>&nbsp;<span class="ident" id="8292917">n</span>&nbsp;<span class="op" id="8292919">!=</span>&nbsp;<span class="num" id="8292922">0</span>&nbsp;<span class="op" id="8292924">||</span>&nbsp;<span class="ident" id="8292927">err</span>&nbsp;<span class="op" id="8292931">!=</span>&nbsp;<span class="ident" id="8292934">io</span><span class="op" id="8292936">.</span><span class="ident" id="8292937">EOF</span>&nbsp;<span class="op" id="8292941">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8292946">t</span><span class="op" id="8292947">.</span><span class="ident" id="8292948">Errorf</span><span class="op" id="8292954">(</span><span class="string" id="8292955">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="8292993">,</span>&nbsp;<span class="ident" id="8292995">n</span><span class="op" id="8292996">,</span>&nbsp;<span class="ident" id="8292998">err</span><span class="op" id="8293001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293006">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293019">c</span><span class="op" id="8293020">.</span><span class="ident" id="8293021">Write</span><span class="op" id="8293026">(</span><span class="op" id="8293027">[</span><span class="op" id="8293028">]</span><span class="builtintype" id="8293029">byte</span><span class="op" id="8293033">(</span><span class="string" id="8293034">&#34;response&#34;</span><span class="op" id="8293044">)</span><span class="op" id="8293045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293049">c</span><span class="op" id="8293050">.</span><span class="ident" id="8293051">Close</span><span class="op" id="8293056">(</span><span class="op" id="8293057">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293060">}</span><span class="op" id="8293061">(</span><span class="op" id="8293062">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293066">c</span><span class="op" id="8293067">,</span>&nbsp;<span class="ident" id="8293069">err</span>&nbsp;<span class="op" id="8293073">:=</span>&nbsp;<span class="ident" id="8293076">Dial</span><span class="op" id="8293080">(</span><span class="string" id="8293081">&#34;unix&#34;</span><span class="op" id="8293087">,</span>&nbsp;<span class="ident" id="8293089">tmpname</span><span class="op" id="8293096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293099">if</span>&nbsp;<span class="ident" id="8293102">err</span>&nbsp;<span class="op" id="8293106">!=</span>&nbsp;<span class="ident" id="8293109">nil</span>&nbsp;<span class="op" id="8293113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293117">t</span><span class="op" id="8293118">.</span><span class="ident" id="8293119">Fatalf</span><span class="op" id="8293125">(</span><span class="string" id="8293126">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8293136">,</span>&nbsp;<span class="ident" id="8293138">err</span><span class="op" id="8293141">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293147">defer</span>&nbsp;<span class="ident" id="8293153">c</span><span class="op" id="8293154">.</span><span class="ident" id="8293155">Close</span><span class="op" id="8293160">(</span><span class="op" id="8293161">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293165">err</span>&nbsp;<span class="op" id="8293169">=</span>&nbsp;<span class="ident" id="8293171">c</span><span class="op" id="8293172">.</span><span class="op" id="8293173">(</span><span class="op" id="8293174">*</span><span class="ident" id="8293175">UnixConn</span><span class="op" id="8293183">)</span><span class="op" id="8293184">.</span><span class="ident" id="8293185">CloseWrite</span><span class="op" id="8293195">(</span><span class="op" id="8293196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293199">if</span>&nbsp;<span class="ident" id="8293202">err</span>&nbsp;<span class="op" id="8293206">!=</span>&nbsp;<span class="ident" id="8293209">nil</span>&nbsp;<span class="op" id="8293213">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293217">t</span><span class="op" id="8293218">.</span><span class="ident" id="8293219">Fatalf</span><span class="op" id="8293225">(</span><span class="string" id="8293226">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="8293242">,</span>&nbsp;<span class="ident" id="8293244">err</span><span class="op" id="8293247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293253">var</span>&nbsp;<span class="ident" id="8293257">buf</span>&nbsp;<span class="op" id="8293261">[</span><span class="num" id="8293262">10</span><span class="op" id="8293264">]</span><span class="builtintype" id="8293265">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293271">n</span><span class="op" id="8293272">,</span>&nbsp;<span class="ident" id="8293274">err</span>&nbsp;<span class="op" id="8293278">:=</span>&nbsp;<span class="ident" id="8293281">c</span><span class="op" id="8293282">.</span><span class="ident" id="8293283">Read</span><span class="op" id="8293287">(</span><span class="ident" id="8293288">buf</span><span class="op" id="8293291">[</span><span class="op" id="8293292">:</span><span class="op" id="8293293">]</span><span class="op" id="8293294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293297">if</span>&nbsp;<span class="ident" id="8293300">err</span>&nbsp;<span class="op" id="8293304">!=</span>&nbsp;<span class="ident" id="8293307">nil</span>&nbsp;<span class="op" id="8293311">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293315">t</span><span class="op" id="8293316">.</span><span class="ident" id="8293317">Fatalf</span><span class="op" id="8293323">(</span><span class="string" id="8293324">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="8293345">,</span>&nbsp;<span class="ident" id="8293347">n</span><span class="op" id="8293348">,</span>&nbsp;<span class="ident" id="8293350">err</span><span class="op" id="8293353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293359">got</span>&nbsp;<span class="op" id="8293363">:=</span>&nbsp;<span class="builtintype" id="8293366">string</span><span class="op" id="8293372">(</span><span class="ident" id="8293373">buf</span><span class="op" id="8293376">[</span><span class="op" id="8293377">:</span><span class="ident" id="8293378">n</span><span class="op" id="8293379">]</span><span class="op" id="8293380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293383">if</span>&nbsp;<span class="ident" id="8293386">got</span>&nbsp;<span class="op" id="8293390">!=</span>&nbsp;<span class="string" id="8293393">&#34;response&#34;</span>&nbsp;<span class="op" id="8293404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293408">t</span><span class="op" id="8293409">.</span><span class="ident" id="8293410">Errorf</span><span class="op" id="8293416">(</span><span class="string" id="8293417">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="8293447">,</span>&nbsp;<span class="ident" id="8293449">got</span><span class="op" id="8293452">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293455">}</span><br>
<span class="lineno"></span><span class="op" id="8293457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8293460">func</span>&nbsp;<span class="ident" id="8293465">TestTCPListenClose</span><span class="op" id="8293483">(</span><span class="ident" id="8293484">t</span>&nbsp;<span class="op" id="8293486">*</span><span class="ident" id="8293487">testing</span><span class="op" id="8293494">.</span><span class="ident" id="8293495">T</span><span class="op" id="8293496">)</span>&nbsp;<span class="op" id="8293498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293501">ln</span><span class="op" id="8293503">,</span>&nbsp;<span class="ident" id="8293505">err</span>&nbsp;<span class="op" id="8293509">:=</span>&nbsp;<span class="ident" id="8293512">Listen</span><span class="op" id="8293518">(</span><span class="string" id="8293519">&#34;tcp&#34;</span><span class="op" id="8293524">,</span>&nbsp;<span class="string" id="8293526">&#34;127.0.0.1:0&#34;</span><span class="op" id="8293539">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293542">if</span>&nbsp;<span class="ident" id="8293545">err</span>&nbsp;<span class="op" id="8293549">!=</span>&nbsp;<span class="ident" id="8293552">nil</span>&nbsp;<span class="op" id="8293556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293560">t</span><span class="op" id="8293561">.</span><span class="ident" id="8293562">Fatalf</span><span class="op" id="8293568">(</span><span class="string" id="8293569">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8293588">,</span>&nbsp;<span class="ident" id="8293590">err</span><span class="op" id="8293593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293600">done</span>&nbsp;<span class="op" id="8293605">:=</span>&nbsp;<span class="builtinfunc" id="8293608">make</span><span class="op" id="8293612">(</span><span class="keyword" id="8293613">chan</span>&nbsp;<span class="builtintype" id="8293618">bool</span><span class="op" id="8293622">,</span>&nbsp;<span class="num" id="8293624">1</span><span class="op" id="8293625">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293628">go</span>&nbsp;<span class="keyword" id="8293631">func</span><span class="op" id="8293635">(</span><span class="op" id="8293636">)</span>&nbsp;<span class="op" id="8293638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293642">time</span><span class="op" id="8293646">.</span><span class="ident" id="8293647">Sleep</span><span class="op" id="8293652">(</span><span class="num" id="8293653">100</span>&nbsp;<span class="op" id="8293657">*</span>&nbsp;<span class="ident" id="8293659">time</span><span class="op" id="8293663">.</span><span class="ident" id="8293664">Millisecond</span><span class="op" id="8293675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293679">ln</span><span class="op" id="8293681">.</span><span class="ident" id="8293682">Close</span><span class="op" id="8293687">(</span><span class="op" id="8293688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293691">}</span><span class="op" id="8293692">(</span><span class="op" id="8293693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293696">go</span>&nbsp;<span class="keyword" id="8293699">func</span><span class="op" id="8293703">(</span><span class="op" id="8293704">)</span>&nbsp;<span class="op" id="8293706">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293710">c</span><span class="op" id="8293711">,</span>&nbsp;<span class="ident" id="8293713">err</span>&nbsp;<span class="op" id="8293717">:=</span>&nbsp;<span class="ident" id="8293720">ln</span><span class="op" id="8293722">.</span><span class="ident" id="8293723">Accept</span><span class="op" id="8293729">(</span><span class="op" id="8293730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293734">if</span>&nbsp;<span class="ident" id="8293737">err</span>&nbsp;<span class="op" id="8293741">==</span>&nbsp;<span class="ident" id="8293744">nil</span>&nbsp;<span class="op" id="8293748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293753">c</span><span class="op" id="8293754">.</span><span class="ident" id="8293755">Close</span><span class="op" id="8293760">(</span><span class="op" id="8293761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293766">t</span><span class="op" id="8293767">.</span><span class="ident" id="8293768">Error</span><span class="op" id="8293773">(</span><span class="string" id="8293774">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="8293792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293796">}</span>&nbsp;<span class="keyword" id="8293798">else</span>&nbsp;<span class="op" id="8293803">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293808">t</span><span class="op" id="8293809">.</span><span class="ident" id="8293810">Logf</span><span class="op" id="8293814">(</span><span class="string" id="8293815">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="8293861">,</span>&nbsp;<span class="ident" id="8293863">err</span><span class="op" id="8293866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293874">done</span>&nbsp;<span class="op" id="8293879">&lt;-</span>&nbsp;<span class="builtintype" id="8293882">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293888">}</span><span class="op" id="8293889">(</span><span class="op" id="8293890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293893">select</span>&nbsp;<span class="op" id="8293900">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293903">case</span>&nbsp;<span class="op" id="8293908">&lt;-</span><span class="ident" id="8293910">done</span><span class="op" id="8293914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8293917">case</span>&nbsp;<span class="op" id="8293922">&lt;-</span><span class="ident" id="8293924">time</span><span class="op" id="8293928">.</span><span class="ident" id="8293929">After</span><span class="op" id="8293934">(</span><span class="num" id="8293935">2</span>&nbsp;<span class="op" id="8293937">*</span>&nbsp;<span class="ident" id="8293939">time</span><span class="op" id="8293943">.</span><span class="ident" id="8293944">Second</span><span class="op" id="8293950">)</span><span class="op" id="8293951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8293955">t</span><span class="op" id="8293956">.</span><span class="ident" id="8293957">Fatal</span><span class="op" id="8293962">(</span><span class="string" id="8293963">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="8293994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8293997">}</span><br>
<span class="lineno"></span><span class="op" id="8293999">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="8294002">func</span>&nbsp;<span class="ident" id="8294007">TestUDPListenClose</span><span class="op" id="8294025">(</span><span class="ident" id="8294026">t</span>&nbsp;<span class="op" id="8294028">*</span><span class="ident" id="8294029">testing</span><span class="op" id="8294036">.</span><span class="ident" id="8294037">T</span><span class="op" id="8294038">)</span>&nbsp;<span class="op" id="8294040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294043">switch</span>&nbsp;<span class="ident" id="8294050">runtime</span><span class="op" id="8294057">.</span><span class="ident" id="8294058">GOOS</span>&nbsp;<span class="op" id="8294063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294066">case</span>&nbsp;<span class="string" id="8294071">&#34;plan9&#34;</span><span class="op" id="8294078">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294082">t</span><span class="op" id="8294083">.</span><span class="ident" id="8294084">Skipf</span><span class="op" id="8294089">(</span><span class="string" id="8294090">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8294111">,</span>&nbsp;<span class="ident" id="8294113">runtime</span><span class="op" id="8294120">.</span><span class="ident" id="8294121">GOOS</span><span class="op" id="8294125">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294131">ln</span><span class="op" id="8294133">,</span>&nbsp;<span class="ident" id="8294135">err</span>&nbsp;<span class="op" id="8294139">:=</span>&nbsp;<span class="ident" id="8294142">ListenPacket</span><span class="op" id="8294154">(</span><span class="string" id="8294155">&#34;udp&#34;</span><span class="op" id="8294160">,</span>&nbsp;<span class="string" id="8294162">&#34;127.0.0.1:0&#34;</span><span class="op" id="8294175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294178">if</span>&nbsp;<span class="ident" id="8294181">err</span>&nbsp;<span class="op" id="8294185">!=</span>&nbsp;<span class="ident" id="8294188">nil</span>&nbsp;<span class="op" id="8294192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294196">t</span><span class="op" id="8294197">.</span><span class="ident" id="8294198">Fatalf</span><span class="op" id="8294204">(</span><span class="string" id="8294205">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8294224">,</span>&nbsp;<span class="ident" id="8294226">err</span><span class="op" id="8294229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294232">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294236">buf</span>&nbsp;<span class="op" id="8294240">:=</span>&nbsp;<span class="builtinfunc" id="8294243">make</span><span class="op" id="8294247">(</span><span class="op" id="8294248">[</span><span class="op" id="8294249">]</span><span class="builtintype" id="8294250">byte</span><span class="op" id="8294254">,</span>&nbsp;<span class="num" id="8294256">1000</span><span class="op" id="8294260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294263">done</span>&nbsp;<span class="op" id="8294268">:=</span>&nbsp;<span class="builtinfunc" id="8294271">make</span><span class="op" id="8294275">(</span><span class="keyword" id="8294276">chan</span>&nbsp;<span class="builtintype" id="8294281">bool</span><span class="op" id="8294285">,</span>&nbsp;<span class="num" id="8294287">1</span><span class="op" id="8294288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294291">go</span>&nbsp;<span class="keyword" id="8294294">func</span><span class="op" id="8294298">(</span><span class="op" id="8294299">)</span>&nbsp;<span class="op" id="8294301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294305">time</span><span class="op" id="8294309">.</span><span class="ident" id="8294310">Sleep</span><span class="op" id="8294315">(</span><span class="num" id="8294316">100</span>&nbsp;<span class="op" id="8294320">*</span>&nbsp;<span class="ident" id="8294322">time</span><span class="op" id="8294326">.</span><span class="ident" id="8294327">Millisecond</span><span class="op" id="8294338">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294342">ln</span><span class="op" id="8294344">.</span><span class="ident" id="8294345">Close</span><span class="op" id="8294350">(</span><span class="op" id="8294351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294354">}</span><span class="op" id="8294355">(</span><span class="op" id="8294356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294359">go</span>&nbsp;<span class="keyword" id="8294362">func</span><span class="op" id="8294366">(</span><span class="op" id="8294367">)</span>&nbsp;<span class="op" id="8294369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294373">_</span><span class="op" id="8294374">,</span>&nbsp;<span class="ident" id="8294376">_</span><span class="op" id="8294377">,</span>&nbsp;<span class="ident" id="8294379">err</span>&nbsp;<span class="op" id="8294383">=</span>&nbsp;<span class="ident" id="8294385">ln</span><span class="op" id="8294387">.</span><span class="ident" id="8294388">ReadFrom</span><span class="op" id="8294396">(</span><span class="ident" id="8294397">buf</span><span class="op" id="8294400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294404">if</span>&nbsp;<span class="ident" id="8294407">err</span>&nbsp;<span class="op" id="8294411">==</span>&nbsp;<span class="ident" id="8294414">nil</span>&nbsp;<span class="op" id="8294418">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294423">t</span><span class="op" id="8294424">.</span><span class="ident" id="8294425">Error</span><span class="op" id="8294430">(</span><span class="string" id="8294431">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="8294451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294455">}</span>&nbsp;<span class="keyword" id="8294457">else</span>&nbsp;<span class="op" id="8294462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294467">t</span><span class="op" id="8294468">.</span><span class="ident" id="8294469">Logf</span><span class="op" id="8294473">(</span><span class="string" id="8294474">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="8294522">,</span>&nbsp;<span class="ident" id="8294524">err</span><span class="op" id="8294527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294535">done</span>&nbsp;<span class="op" id="8294540">&lt;-</span>&nbsp;<span class="builtintype" id="8294543">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294549">}</span><span class="op" id="8294550">(</span><span class="op" id="8294551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294554">select</span>&nbsp;<span class="op" id="8294561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294564">case</span>&nbsp;<span class="op" id="8294569">&lt;-</span><span class="ident" id="8294571">done</span><span class="op" id="8294575">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294578">case</span>&nbsp;<span class="op" id="8294583">&lt;-</span><span class="ident" id="8294585">time</span><span class="op" id="8294589">.</span><span class="ident" id="8294590">After</span><span class="op" id="8294595">(</span><span class="num" id="8294596">2</span>&nbsp;<span class="op" id="8294598">*</span>&nbsp;<span class="ident" id="8294600">time</span><span class="op" id="8294604">.</span><span class="ident" id="8294605">Second</span><span class="op" id="8294611">)</span><span class="op" id="8294612">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294616">t</span><span class="op" id="8294617">.</span><span class="ident" id="8294618">Fatal</span><span class="op" id="8294623">(</span><span class="string" id="8294624">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="8294655">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294658">}</span><br>
<span class="lineno"></span><span class="op" id="8294660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8294663">func</span>&nbsp;<span class="ident" id="8294668">TestTCPClose</span><span class="op" id="8294680">(</span><span class="ident" id="8294681">t</span>&nbsp;<span class="op" id="8294683">*</span><span class="ident" id="8294684">testing</span><span class="op" id="8294691">.</span><span class="ident" id="8294692">T</span><span class="op" id="8294693">)</span>&nbsp;<span class="op" id="8294695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294698">switch</span>&nbsp;<span class="ident" id="8294705">runtime</span><span class="op" id="8294712">.</span><span class="ident" id="8294713">GOOS</span>&nbsp;<span class="op" id="8294718">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294721">case</span>&nbsp;<span class="string" id="8294726">&#34;plan9&#34;</span><span class="op" id="8294733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294737">t</span><span class="op" id="8294738">.</span><span class="ident" id="8294739">Skipf</span><span class="op" id="8294744">(</span><span class="string" id="8294745">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8294766">,</span>&nbsp;<span class="ident" id="8294768">runtime</span><span class="op" id="8294775">.</span><span class="ident" id="8294776">GOOS</span><span class="op" id="8294780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294786">l</span><span class="op" id="8294787">,</span>&nbsp;<span class="ident" id="8294789">err</span>&nbsp;<span class="op" id="8294793">:=</span>&nbsp;<span class="ident" id="8294796">Listen</span><span class="op" id="8294802">(</span><span class="string" id="8294803">&#34;tcp&#34;</span><span class="op" id="8294808">,</span>&nbsp;<span class="string" id="8294810">&#34;127.0.0.1:0&#34;</span><span class="op" id="8294823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294826">if</span>&nbsp;<span class="ident" id="8294829">err</span>&nbsp;<span class="op" id="8294833">!=</span>&nbsp;<span class="ident" id="8294836">nil</span>&nbsp;<span class="op" id="8294840">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294844">t</span><span class="op" id="8294845">.</span><span class="ident" id="8294846">Fatal</span><span class="op" id="8294851">(</span><span class="ident" id="8294852">err</span><span class="op" id="8294855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294861">defer</span>&nbsp;<span class="ident" id="8294867">l</span><span class="op" id="8294868">.</span><span class="ident" id="8294869">Close</span><span class="op" id="8294874">(</span><span class="op" id="8294875">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294879">read</span>&nbsp;<span class="op" id="8294884">:=</span>&nbsp;<span class="keyword" id="8294887">func</span><span class="op" id="8294891">(</span><span class="ident" id="8294892">r</span>&nbsp;<span class="ident" id="8294894">io</span><span class="op" id="8294896">.</span><span class="ident" id="8294897">Reader</span><span class="op" id="8294903">)</span>&nbsp;<span class="builtintype" id="8294905">error</span>&nbsp;<span class="op" id="8294911">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294915">var</span>&nbsp;<span class="ident" id="8294919">m</span>&nbsp;<span class="op" id="8294921">[</span><span class="num" id="8294922">1</span><span class="op" id="8294923">]</span><span class="builtintype" id="8294924">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294931">_</span><span class="op" id="8294932">,</span>&nbsp;<span class="ident" id="8294934">err</span>&nbsp;<span class="op" id="8294938">:=</span>&nbsp;<span class="ident" id="8294941">r</span><span class="op" id="8294942">.</span><span class="ident" id="8294943">Read</span><span class="op" id="8294947">(</span><span class="ident" id="8294948">m</span><span class="op" id="8294949">[</span><span class="op" id="8294950">:</span><span class="op" id="8294951">]</span><span class="op" id="8294952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294956">return</span>&nbsp;<span class="ident" id="8294963">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8294968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8294972">go</span>&nbsp;<span class="keyword" id="8294975">func</span><span class="op" id="8294979">(</span><span class="op" id="8294980">)</span>&nbsp;<span class="op" id="8294982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8294986">c</span><span class="op" id="8294987">,</span>&nbsp;<span class="ident" id="8294989">err</span>&nbsp;<span class="op" id="8294993">:=</span>&nbsp;<span class="ident" id="8294996">Dial</span><span class="op" id="8295000">(</span><span class="string" id="8295001">&#34;tcp&#34;</span><span class="op" id="8295006">,</span>&nbsp;<span class="ident" id="8295008">l</span><span class="op" id="8295009">.</span><span class="ident" id="8295010">Addr</span><span class="op" id="8295014">(</span><span class="op" id="8295015">)</span><span class="op" id="8295016">.</span><span class="ident" id="8295017">String</span><span class="op" id="8295023">(</span><span class="op" id="8295024">)</span><span class="op" id="8295025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295029">if</span>&nbsp;<span class="ident" id="8295032">err</span>&nbsp;<span class="op" id="8295036">!=</span>&nbsp;<span class="ident" id="8295039">nil</span>&nbsp;<span class="op" id="8295043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295048">t</span><span class="op" id="8295049">.</span><span class="ident" id="8295050">Errorf</span><span class="op" id="8295056">(</span><span class="string" id="8295057">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8295067">,</span>&nbsp;<span class="ident" id="8295069">err</span><span class="op" id="8295072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295077">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295091">go</span>&nbsp;<span class="ident" id="8295094">read</span><span class="op" id="8295098">(</span><span class="ident" id="8295099">c</span><span class="op" id="8295100">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295105">time</span><span class="op" id="8295109">.</span><span class="ident" id="8295110">Sleep</span><span class="op" id="8295115">(</span><span class="num" id="8295116">10</span>&nbsp;<span class="op" id="8295119">*</span>&nbsp;<span class="ident" id="8295121">time</span><span class="op" id="8295125">.</span><span class="ident" id="8295126">Millisecond</span><span class="op" id="8295137">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295141">c</span><span class="op" id="8295142">.</span><span class="ident" id="8295143">Close</span><span class="op" id="8295148">(</span><span class="op" id="8295149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295152">}</span><span class="op" id="8295153">(</span><span class="op" id="8295154">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295158">c</span><span class="op" id="8295159">,</span>&nbsp;<span class="ident" id="8295161">err</span>&nbsp;<span class="op" id="8295165">:=</span>&nbsp;<span class="ident" id="8295168">l</span><span class="op" id="8295169">.</span><span class="ident" id="8295170">Accept</span><span class="op" id="8295176">(</span><span class="op" id="8295177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295180">if</span>&nbsp;<span class="ident" id="8295183">err</span>&nbsp;<span class="op" id="8295187">!=</span>&nbsp;<span class="ident" id="8295190">nil</span>&nbsp;<span class="op" id="8295194">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295198">t</span><span class="op" id="8295199">.</span><span class="ident" id="8295200">Fatal</span><span class="op" id="8295205">(</span><span class="ident" id="8295206">err</span><span class="op" id="8295209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295215">defer</span>&nbsp;<span class="ident" id="8295221">c</span><span class="op" id="8295222">.</span><span class="ident" id="8295223">Close</span><span class="op" id="8295228">(</span><span class="op" id="8295229">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295233">for</span>&nbsp;<span class="ident" id="8295237">err</span>&nbsp;<span class="op" id="8295241">==</span>&nbsp;<span class="ident" id="8295244">nil</span>&nbsp;<span class="op" id="8295248">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295252">err</span>&nbsp;<span class="op" id="8295256">=</span>&nbsp;<span class="ident" id="8295258">read</span><span class="op" id="8295262">(</span><span class="ident" id="8295263">c</span><span class="op" id="8295264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295270">if</span>&nbsp;<span class="ident" id="8295273">err</span>&nbsp;<span class="op" id="8295277">!=</span>&nbsp;<span class="ident" id="8295280">nil</span>&nbsp;<span class="op" id="8295284">&amp;&amp;</span>&nbsp;<span class="ident" id="8295287">err</span>&nbsp;<span class="op" id="8295291">!=</span>&nbsp;<span class="ident" id="8295294">io</span><span class="op" id="8295296">.</span><span class="ident" id="8295297">EOF</span>&nbsp;<span class="op" id="8295301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295305">t</span><span class="op" id="8295306">.</span><span class="ident" id="8295307">Fatal</span><span class="op" id="8295312">(</span><span class="ident" id="8295313">err</span><span class="op" id="8295316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295319">}</span><br>
<span class="lineno">225</span><span class="op" id="8295321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8295324">func</span>&nbsp;<span class="ident" id="8295329">TestErrorNil</span><span class="op" id="8295341">(</span><span class="ident" id="8295342">t</span>&nbsp;<span class="op" id="8295344">*</span><span class="ident" id="8295345">testing</span><span class="op" id="8295352">.</span><span class="ident" id="8295353">T</span><span class="op" id="8295354">)</span>&nbsp;<span class="op" id="8295356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295359">c</span><span class="op" id="8295360">,</span>&nbsp;<span class="ident" id="8295362">err</span>&nbsp;<span class="op" id="8295366">:=</span>&nbsp;<span class="ident" id="8295369">Dial</span><span class="op" id="8295373">(</span><span class="string" id="8295374">&#34;tcp&#34;</span><span class="op" id="8295379">,</span>&nbsp;<span class="string" id="8295381">&#34;127.0.0.1:65535&#34;</span><span class="op" id="8295398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295401">if</span>&nbsp;<span class="ident" id="8295404">err</span>&nbsp;<span class="op" id="8295408">==</span>&nbsp;<span class="ident" id="8295411">nil</span>&nbsp;<span class="op" id="8295415">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295419">t</span><span class="op" id="8295420">.</span><span class="ident" id="8295421">Fatal</span><span class="op" id="8295426">(</span><span class="string" id="8295427">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="8295459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295465">if</span>&nbsp;<span class="ident" id="8295468">c</span>&nbsp;<span class="op" id="8295470">!=</span>&nbsp;<span class="ident" id="8295473">nil</span>&nbsp;<span class="op" id="8295477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295481">t</span><span class="op" id="8295482">.</span><span class="ident" id="8295483">Fatalf</span><span class="op" id="8295489">(</span><span class="string" id="8295490">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8295546">,</span>&nbsp;<span class="ident" id="8295548">c</span><span class="op" id="8295549">,</span>&nbsp;<span class="ident" id="8295551">c</span><span class="op" id="8295552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295555">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8295559">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295616">l</span><span class="op" id="8295617">,</span>&nbsp;<span class="ident" id="8295619">err</span>&nbsp;<span class="op" id="8295623">:=</span>&nbsp;<span class="ident" id="8295626">Listen</span><span class="op" id="8295632">(</span><span class="string" id="8295633">&#34;tcp&#34;</span><span class="op" id="8295638">,</span>&nbsp;<span class="string" id="8295640">&#34;127.0.0.1:0&#34;</span><span class="op" id="8295653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295656">if</span>&nbsp;<span class="ident" id="8295659">err</span>&nbsp;<span class="op" id="8295663">!=</span>&nbsp;<span class="ident" id="8295666">nil</span>&nbsp;<span class="op" id="8295670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295674">t</span><span class="op" id="8295675">.</span><span class="ident" id="8295676">Fatalf</span><span class="op" id="8295682">(</span><span class="string" id="8295683">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="8295707">,</span>&nbsp;<span class="ident" id="8295709">err</span><span class="op" id="8295712">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295718">defer</span>&nbsp;<span class="ident" id="8295724">l</span><span class="op" id="8295725">.</span><span class="ident" id="8295726">Close</span><span class="op" id="8295731">(</span><span class="op" id="8295732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295735">l1</span><span class="op" id="8295737">,</span>&nbsp;<span class="ident" id="8295739">err</span>&nbsp;<span class="op" id="8295743">:=</span>&nbsp;<span class="ident" id="8295746">Listen</span><span class="op" id="8295752">(</span><span class="string" id="8295753">&#34;tcp&#34;</span><span class="op" id="8295758">,</span>&nbsp;<span class="ident" id="8295760">l</span><span class="op" id="8295761">.</span><span class="ident" id="8295762">Addr</span><span class="op" id="8295766">(</span><span class="op" id="8295767">)</span><span class="op" id="8295768">.</span><span class="ident" id="8295769">String</span><span class="op" id="8295775">(</span><span class="op" id="8295776">)</span><span class="op" id="8295777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295780">if</span>&nbsp;<span class="ident" id="8295783">err</span>&nbsp;<span class="op" id="8295787">==</span>&nbsp;<span class="ident" id="8295790">nil</span>&nbsp;<span class="op" id="8295794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295798">t</span><span class="op" id="8295799">.</span><span class="ident" id="8295800">Fatalf</span><span class="op" id="8295806">(</span><span class="string" id="8295807">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="8295829">,</span>&nbsp;<span class="ident" id="8295831">l</span><span class="op" id="8295832">.</span><span class="ident" id="8295833">Addr</span><span class="op" id="8295837">(</span><span class="op" id="8295838">)</span><span class="op" id="8295839">,</span>&nbsp;<span class="ident" id="8295841">err</span><span class="op" id="8295844">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8295850">if</span>&nbsp;<span class="ident" id="8295853">l1</span>&nbsp;<span class="op" id="8295856">!=</span>&nbsp;<span class="ident" id="8295859">nil</span>&nbsp;<span class="op" id="8295863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8295867">t</span><span class="op" id="8295868">.</span><span class="ident" id="8295869">Fatalf</span><span class="op" id="8295875">(</span><span class="string" id="8295876">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8295934">,</span>&nbsp;<span class="ident" id="8295936">l1</span><span class="op" id="8295938">,</span>&nbsp;<span class="ident" id="8295940">l1</span><span class="op" id="8295942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8295945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8295949">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8296012">lp</span><span class="op" id="8296014">,</span>&nbsp;<span class="ident" id="8296016">err</span>&nbsp;<span class="op" id="8296020">:=</span>&nbsp;<span class="ident" id="8296023">ListenPacket</span><span class="op" id="8296035">(</span><span class="string" id="8296036">&#34;udp&#34;</span><span class="op" id="8296041">,</span>&nbsp;<span class="string" id="8296043">&#34;127.0.0.1:0&#34;</span><span class="op" id="8296056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8296059">if</span>&nbsp;<span class="ident" id="8296062">err</span>&nbsp;<span class="op" id="8296066">!=</span>&nbsp;<span class="ident" id="8296069">nil</span>&nbsp;<span class="op" id="8296073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8296077">t</span><span class="op" id="8296078">.</span><span class="ident" id="8296079">Fatalf</span><span class="op" id="8296085">(</span><span class="string" id="8296086">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="8296110">,</span>&nbsp;<span class="ident" id="8296112">err</span><span class="op" id="8296115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8296118">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8296121">defer</span>&nbsp;<span class="ident" id="8296127">lp</span><span class="op" id="8296129">.</span><span class="ident" id="8296130">Close</span><span class="op" id="8296135">(</span><span class="op" id="8296136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8296139">lp1</span><span class="op" id="8296142">,</span>&nbsp;<span class="ident" id="8296144">err</span>&nbsp;<span class="op" id="8296148">:=</span>&nbsp;<span class="ident" id="8296151">ListenPacket</span><span class="op" id="8296163">(</span><span class="string" id="8296164">&#34;udp&#34;</span><span class="op" id="8296169">,</span>&nbsp;<span class="ident" id="8296171">lp</span><span class="op" id="8296173">.</span><span class="ident" id="8296174">LocalAddr</span><span class="op" id="8296183">(</span><span class="op" id="8296184">)</span><span class="op" id="8296185">.</span><span class="ident" id="8296186">String</span><span class="op" id="8296192">(</span><span class="op" id="8296193">)</span><span class="op" id="8296194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8296197">if</span>&nbsp;<span class="ident" id="8296200">err</span>&nbsp;<span class="op" id="8296204">==</span>&nbsp;<span class="ident" id="8296207">nil</span>&nbsp;<span class="op" id="8296211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8296215">t</span><span class="op" id="8296216">.</span><span class="ident" id="8296217">Fatalf</span><span class="op" id="8296223">(</span><span class="string" id="8296224">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="8296246">,</span>&nbsp;<span class="ident" id="8296248">lp</span><span class="op" id="8296250">.</span><span class="ident" id="8296251">LocalAddr</span><span class="op" id="8296260">(</span><span class="op" id="8296261">)</span><span class="op" id="8296262">,</span>&nbsp;<span class="ident" id="8296264">err</span><span class="op" id="8296267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8296270">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8296273">if</span>&nbsp;<span class="ident" id="8296276">lp1</span>&nbsp;<span class="op" id="8296280">!=</span>&nbsp;<span class="ident" id="8296283">nil</span>&nbsp;<span class="op" id="8296287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8296291">t</span><span class="op" id="8296292">.</span><span class="ident" id="8296293">Fatalf</span><span class="op" id="8296299">(</span><span class="string" id="8296300">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8296364">,</span>&nbsp;<span class="ident" id="8296366">lp1</span><span class="op" id="8296369">,</span>&nbsp;<span class="ident" id="8296371">lp1</span><span class="op" id="8296374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8296377">}</span><br>
<span class="lineno"></span><span class="op" id="8296379">}</span>
</div>
</body>
</html>
