<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/parser</h2>
<ul>
<li><a href="/gostd/go/parser/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/go/parser/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/parser/interface.go.html">interface.go</a></li>
<li><a href="/gostd/go/parser/parser.go.html">parser.go</a></li>
<li><a href="/gostd/go/parser/parser_test.go.html">parser_test.go</a></li>
<li><a href="/gostd/go/parser/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/parser/short_test.go.html">short_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7274804">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7274859">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7274913">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7274964">package</span>&nbsp;<span class="ident" id="7274972">parser</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7274980">import</span>&nbsp;<span class="op" id="7274987">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7274990">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7274999">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7275006">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7275016">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7275028">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7275034">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7275045">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7275055">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7275058">var</span>&nbsp;<span class="ident" id="7275062">fset</span>&nbsp;<span class="op" id="7275067">=</span>&nbsp;<span class="ident" id="7275069">token</span><span class="op" id="7275074">.</span><span class="ident" id="7275075">NewFileSet</span><span class="op" id="7275085">(</span><span class="op" id="7275086">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7275089">var</span>&nbsp;<span class="ident" id="7275093">validFiles</span>&nbsp;<span class="op" id="7275104">=</span>&nbsp;<span class="op" id="7275106">[</span><span class="op" id="7275107">]</span><span class="builtintype" id="7275108">string</span><span class="op" id="7275114">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7275117">&#34;parser.go&#34;</span><span class="op" id="7275128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7275131">&#34;parser_test.go&#34;</span><span class="op" id="7275147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7275150">&#34;error_test.go&#34;</span><span class="op" id="7275165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7275168">&#34;short_test.go&#34;</span><span class="op" id="7275183">,</span><br>
<span class="lineno"></span><span class="op" id="7275185">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="7275188">func</span>&nbsp;<span class="ident" id="7275193">TestParse</span><span class="op" id="7275202">(</span><span class="ident" id="7275203">t</span>&nbsp;<span class="op" id="7275205">*</span><span class="ident" id="7275206">testing</span><span class="op" id="7275213">.</span><span class="ident" id="7275214">T</span><span class="op" id="7275215">)</span>&nbsp;<span class="op" id="7275217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275220">for</span>&nbsp;<span class="ident" id="7275224">_</span><span class="op" id="7275225">,</span>&nbsp;<span class="ident" id="7275227">filename</span>&nbsp;<span class="op" id="7275236">:=</span>&nbsp;<span class="keyword" id="7275239">range</span>&nbsp;<span class="ident" id="7275245">validFiles</span>&nbsp;<span class="op" id="7275256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7275260">_</span><span class="op" id="7275261">,</span>&nbsp;<span class="ident" id="7275263">err</span>&nbsp;<span class="op" id="7275267">:=</span>&nbsp;<span class="ident" id="7275270">ParseFile</span><span class="op" id="7275279">(</span><span class="ident" id="7275280">fset</span><span class="op" id="7275284">,</span>&nbsp;<span class="ident" id="7275286">filename</span><span class="op" id="7275294">,</span>&nbsp;<span class="ident" id="7275296">nil</span><span class="op" id="7275299">,</span>&nbsp;<span class="ident" id="7275301">DeclarationErrors</span><span class="op" id="7275318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275322">if</span>&nbsp;<span class="ident" id="7275325">err</span>&nbsp;<span class="op" id="7275329">!=</span>&nbsp;<span class="ident" id="7275332">nil</span>&nbsp;<span class="op" id="7275336">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7275341">t</span><span class="op" id="7275342">.</span><span class="ident" id="7275343">Fatalf</span><span class="op" id="7275349">(</span><span class="string" id="7275350">&#34;ParseFile(%s):&nbsp;%v&#34;</span><span class="op" id="7275369">,</span>&nbsp;<span class="ident" id="7275371">filename</span><span class="op" id="7275379">,</span>&nbsp;<span class="ident" id="7275381">err</span><span class="op" id="7275384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7275388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7275391">}</span><br>
<span class="lineno"></span><span class="op" id="7275393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7275396">func</span>&nbsp;<span class="ident" id="7275401">nameFilter</span><span class="op" id="7275411">(</span><span class="ident" id="7275412">filename</span>&nbsp;<span class="builtintype" id="7275421">string</span><span class="op" id="7275427">)</span>&nbsp;<span class="builtintype" id="7275429">bool</span>&nbsp;<span class="op" id="7275434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275437">switch</span>&nbsp;<span class="ident" id="7275444">filename</span>&nbsp;<span class="op" id="7275453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275456">case</span>&nbsp;<span class="string" id="7275461">&#34;parser.go&#34;</span><span class="op" id="7275472">,</span>&nbsp;<span class="string" id="7275474">&#34;interface.go&#34;</span><span class="op" id="7275488">,</span>&nbsp;<span class="string" id="7275490">&#34;parser_test.go&#34;</span><span class="op" id="7275506">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275510">return</span>&nbsp;<span class="builtintype" id="7275517">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275523">case</span>&nbsp;<span class="string" id="7275528">&#34;parser.go.orig&#34;</span><span class="op" id="7275544">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275548">return</span>&nbsp;<span class="builtintype" id="7275555">true</span>&nbsp;<span class="comment" id="7275560">//&nbsp;permit&nbsp;but&nbsp;should&nbsp;be&nbsp;ignored&nbsp;by&nbsp;ParseDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7275605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275608">return</span>&nbsp;<span class="builtintype" id="7275615">false</span><br>
<span class="lineno"></span><span class="op" id="7275621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7275624">func</span>&nbsp;<span class="ident" id="7275629">dirFilter</span><span class="op" id="7275638">(</span><span class="ident" id="7275639">f</span>&nbsp;<span class="ident" id="7275641">os</span><span class="op" id="7275643">.</span><span class="ident" id="7275644">FileInfo</span><span class="op" id="7275652">)</span>&nbsp;<span class="builtintype" id="7275654">bool</span>&nbsp;<span class="op" id="7275659">{</span>&nbsp;<span class="keyword" id="7275661">return</span>&nbsp;<span class="ident" id="7275668">nameFilter</span><span class="op" id="7275678">(</span><span class="ident" id="7275679">f</span><span class="op" id="7275680">.</span><span class="ident" id="7275681">Name</span><span class="op" id="7275685">(</span><span class="op" id="7275686">)</span><span class="op" id="7275687">)</span>&nbsp;<span class="op" id="7275689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7275692">func</span>&nbsp;<span class="ident" id="7275697">TestParseDir</span><span class="op" id="7275709">(</span><span class="ident" id="7275710">t</span>&nbsp;<span class="op" id="7275712">*</span><span class="ident" id="7275713">testing</span><span class="op" id="7275720">.</span><span class="ident" id="7275721">T</span><span class="op" id="7275722">)</span>&nbsp;<span class="op" id="7275724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7275727">path</span>&nbsp;<span class="op" id="7275732">:=</span>&nbsp;<span class="string" id="7275735">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7275740">pkgs</span><span class="op" id="7275744">,</span>&nbsp;<span class="ident" id="7275746">err</span>&nbsp;<span class="op" id="7275750">:=</span>&nbsp;<span class="ident" id="7275753">ParseDir</span><span class="op" id="7275761">(</span><span class="ident" id="7275762">fset</span><span class="op" id="7275766">,</span>&nbsp;<span class="ident" id="7275768">path</span><span class="op" id="7275772">,</span>&nbsp;<span class="ident" id="7275774">dirFilter</span><span class="op" id="7275783">,</span>&nbsp;<span class="num" id="7275785">0</span><span class="op" id="7275786">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275789">if</span>&nbsp;<span class="ident" id="7275792">err</span>&nbsp;<span class="op" id="7275796">!=</span>&nbsp;<span class="ident" id="7275799">nil</span>&nbsp;<span class="op" id="7275803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7275807">t</span><span class="op" id="7275808">.</span><span class="ident" id="7275809">Fatalf</span><span class="op" id="7275815">(</span><span class="string" id="7275816">&#34;ParseDir(%s):&nbsp;%v&#34;</span><span class="op" id="7275834">,</span>&nbsp;<span class="ident" id="7275836">path</span><span class="op" id="7275840">,</span>&nbsp;<span class="ident" id="7275842">err</span><span class="op" id="7275845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7275848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275851">if</span>&nbsp;<span class="ident" id="7275854">n</span>&nbsp;<span class="op" id="7275856">:=</span>&nbsp;<span class="builtinfunc" id="7275859">len</span><span class="op" id="7275862">(</span><span class="ident" id="7275863">pkgs</span><span class="op" id="7275867">)</span><span class="op" id="7275868">;</span>&nbsp;<span class="ident" id="7275870">n</span>&nbsp;<span class="op" id="7275872">!=</span>&nbsp;<span class="num" id="7275875">1</span>&nbsp;<span class="op" id="7275877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7275881">t</span><span class="op" id="7275882">.</span><span class="ident" id="7275883">Errorf</span><span class="op" id="7275889">(</span><span class="string" id="7275890">&#34;got&nbsp;%d&nbsp;packages;&nbsp;want&nbsp;1&#34;</span><span class="op" id="7275915">,</span>&nbsp;<span class="ident" id="7275917">n</span><span class="op" id="7275918">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7275921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7275924">pkg</span>&nbsp;<span class="op" id="7275928">:=</span>&nbsp;<span class="ident" id="7275931">pkgs</span><span class="op" id="7275935">[</span><span class="string" id="7275936">&#34;parser&#34;</span><span class="op" id="7275944">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7275947">if</span>&nbsp;<span class="ident" id="7275950">pkg</span>&nbsp;<span class="op" id="7275954">==</span>&nbsp;<span class="ident" id="7275957">nil</span>&nbsp;<span class="op" id="7275961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7275965">t</span><span class="op" id="7275966">.</span><span class="ident" id="7275967">Errorf</span><span class="op" id="7275973">(</span><span class="string" id="7275974">`package&nbsp;&#34;parser&#34;&nbsp;not&nbsp;found`</span><span class="op" id="7276002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7276006">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7276014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7276017">if</span>&nbsp;<span class="ident" id="7276020">n</span>&nbsp;<span class="op" id="7276022">:=</span>&nbsp;<span class="builtinfunc" id="7276025">len</span><span class="op" id="7276028">(</span><span class="ident" id="7276029">pkg</span><span class="op" id="7276032">.</span><span class="ident" id="7276033">Files</span><span class="op" id="7276038">)</span><span class="op" id="7276039">;</span>&nbsp;<span class="ident" id="7276041">n</span>&nbsp;<span class="op" id="7276043">!=</span>&nbsp;<span class="num" id="7276046">3</span>&nbsp;<span class="op" id="7276048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276052">t</span><span class="op" id="7276053">.</span><span class="ident" id="7276054">Errorf</span><span class="op" id="7276060">(</span><span class="string" id="7276061">&#34;got&nbsp;%d&nbsp;package&nbsp;files;&nbsp;want&nbsp;3&#34;</span><span class="op" id="7276091">,</span>&nbsp;<span class="ident" id="7276093">n</span><span class="op" id="7276094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7276097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7276100">for</span>&nbsp;<span class="ident" id="7276104">filename</span>&nbsp;<span class="op" id="7276113">:=</span>&nbsp;<span class="keyword" id="7276116">range</span>&nbsp;<span class="ident" id="7276122">pkg</span><span class="op" id="7276125">.</span><span class="ident" id="7276126">Files</span>&nbsp;<span class="op" id="7276132">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7276136">if</span>&nbsp;<span class="op" id="7276139">!</span><span class="ident" id="7276140">nameFilter</span><span class="op" id="7276150">(</span><span class="ident" id="7276151">filename</span><span class="op" id="7276159">)</span>&nbsp;<span class="op" id="7276161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276166">t</span><span class="op" id="7276167">.</span><span class="ident" id="7276168">Errorf</span><span class="op" id="7276174">(</span><span class="string" id="7276175">&#34;unexpected&nbsp;package&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="7276204">,</span>&nbsp;<span class="ident" id="7276206">filename</span><span class="op" id="7276214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7276218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7276221">}</span><br>
<span class="lineno"></span><span class="op" id="7276223">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7276226">func</span>&nbsp;<span class="ident" id="7276231">TestParseExpr</span><span class="op" id="7276244">(</span><span class="ident" id="7276245">t</span>&nbsp;<span class="op" id="7276247">*</span><span class="ident" id="7276248">testing</span><span class="op" id="7276255">.</span><span class="ident" id="7276256">T</span><span class="op" id="7276257">)</span>&nbsp;<span class="op" id="7276259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7276262">//&nbsp;just&nbsp;kicking&nbsp;the&nbsp;tires:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7276290">//&nbsp;a&nbsp;valid&nbsp;arithmetic&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276324">src</span>&nbsp;<span class="op" id="7276328">:=</span>&nbsp;<span class="string" id="7276331">&#34;a&nbsp;+&nbsp;b&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276340">x</span><span class="op" id="7276341">,</span>&nbsp;<span class="ident" id="7276343">err</span>&nbsp;<span class="op" id="7276347">:=</span>&nbsp;<span class="ident" id="7276350">ParseExpr</span><span class="op" id="7276359">(</span><span class="ident" id="7276360">src</span><span class="op" id="7276363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7276366">if</span>&nbsp;<span class="ident" id="7276369">err</span>&nbsp;<span class="op" id="7276373">!=</span>&nbsp;<span class="ident" id="7276376">nil</span>&nbsp;<span class="op" id="7276380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276384">t</span><span class="op" id="7276385">.</span><span class="ident" id="7276386">Errorf</span><span class="op" id="7276392">(</span><span class="string" id="7276393">&#34;ParseExpr(%q):&nbsp;%v&#34;</span><span class="op" id="7276412">,</span>&nbsp;<span class="ident" id="7276414">src</span><span class="op" id="7276417">,</span>&nbsp;<span class="ident" id="7276419">err</span><span class="op" id="7276422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7276425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7276428">//&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7276445">if</span>&nbsp;<span class="ident" id="7276448">_</span><span class="op" id="7276449">,</span>&nbsp;<span class="ident" id="7276451">ok</span>&nbsp;<span class="op" id="7276454">:=</span>&nbsp;<span class="ident" id="7276457">x</span><span class="op" id="7276458">.</span><span class="op" id="7276459">(</span><span class="op" id="7276460">*</span><span class="ident" id="7276461">ast</span><span class="op" id="7276464">.</span><span class="ident" id="7276465">BinaryExpr</span><span class="op" id="7276475">)</span><span class="op" id="7276476">;</span>&nbsp;<span class="op" id="7276478">!</span><span class="ident" id="7276479">ok</span>&nbsp;<span class="op" id="7276482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276486">t</span><span class="op" id="7276487">.</span><span class="ident" id="7276488">Errorf</span><span class="op" id="7276494">(</span><span class="string" id="7276495">&#34;ParseExpr(%q):&nbsp;got&nbsp;%T,&nbsp;want&nbsp;*ast.BinaryExpr&#34;</span><span class="op" id="7276540">,</span>&nbsp;<span class="ident" id="7276542">src</span><span class="op" id="7276545">,</span>&nbsp;<span class="ident" id="7276547">x</span><span class="op" id="7276548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7276551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7276555">//&nbsp;a&nbsp;valid&nbsp;type&nbsp;expression</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276583">src</span>&nbsp;<span class="op" id="7276587">=</span>&nbsp;<span class="string" id="7276589">&#34;struct{x&nbsp;*int}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276607">x</span><span class="op" id="7276608">,</span>&nbsp;<span class="ident" id="7276610">err</span>&nbsp;<span class="op" id="7276614">=</span>&nbsp;<span class="ident" id="7276616">ParseExpr</span><span class="op" id="7276625">(</span><span class="ident" id="7276626">src</span><span class="op" id="7276629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7276632">if</span>&nbsp;<span class="ident" id="7276635">err</span>&nbsp;<span class="op" id="7276639">!=</span>&nbsp;<span class="ident" id="7276642">nil</span>&nbsp;<span class="op" id="7276646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276650">t</span><span class="op" id="7276651">.</span><span class="ident" id="7276652">Errorf</span><span class="op" id="7276658">(</span><span class="string" id="7276659">&#34;ParseExpr(%q):&nbsp;%v&#34;</span><span class="op" id="7276678">,</span>&nbsp;<span class="ident" id="7276680">src</span><span class="op" id="7276683">,</span>&nbsp;<span class="ident" id="7276685">err</span><span class="op" id="7276688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7276691">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7276694">//&nbsp;sanity&nbsp;check</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7276711">if</span>&nbsp;<span class="ident" id="7276714">_</span><span class="op" id="7276715">,</span>&nbsp;<span class="ident" id="7276717">ok</span>&nbsp;<span class="op" id="7276720">:=</span>&nbsp;<span class="ident" id="7276723">x</span><span class="op" id="7276724">.</span><span class="op" id="7276725">(</span><span class="op" id="7276726">*</span><span class="ident" id="7276727">ast</span><span class="op" id="7276730">.</span><span class="ident" id="7276731">StructType</span><span class="op" id="7276741">)</span><span class="op" id="7276742">;</span>&nbsp;<span class="op" id="7276744">!</span><span class="ident" id="7276745">ok</span>&nbsp;<span class="op" id="7276748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276752">t</span><span class="op" id="7276753">.</span><span class="ident" id="7276754">Errorf</span><span class="op" id="7276760">(</span><span class="string" id="7276761">&#34;ParseExpr(%q):&nbsp;got&nbsp;%T,&nbsp;want&nbsp;*ast.StructType&#34;</span><span class="op" id="7276806">,</span>&nbsp;<span class="ident" id="7276808">src</span><span class="op" id="7276811">,</span>&nbsp;<span class="ident" id="7276813">x</span><span class="op" id="7276814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7276817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7276821">//&nbsp;an&nbsp;invalid&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276847">src</span>&nbsp;<span class="op" id="7276851">=</span>&nbsp;<span class="string" id="7276853">&#34;a&nbsp;+&nbsp;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7276862">if</span>&nbsp;<span class="ident" id="7276865">_</span><span class="op" id="7276866">,</span>&nbsp;<span class="ident" id="7276868">err</span>&nbsp;<span class="op" id="7276872">:=</span>&nbsp;<span class="ident" id="7276875">ParseExpr</span><span class="op" id="7276884">(</span><span class="ident" id="7276885">src</span><span class="op" id="7276888">)</span><span class="op" id="7276889">;</span>&nbsp;<span class="ident" id="7276891">err</span>&nbsp;<span class="op" id="7276895">==</span>&nbsp;<span class="ident" id="7276898">nil</span>&nbsp;<span class="op" id="7276902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7276906">t</span><span class="op" id="7276907">.</span><span class="ident" id="7276908">Errorf</span><span class="op" id="7276914">(</span><span class="string" id="7276915">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7276944">,</span>&nbsp;<span class="ident" id="7276946">src</span><span class="op" id="7276949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7276952">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7276956">//&nbsp;a&nbsp;valid&nbsp;expression&nbsp;followed&nbsp;by&nbsp;extra&nbsp;tokens&nbsp;is&nbsp;invalid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277015">src</span>&nbsp;<span class="op" id="7277019">=</span>&nbsp;<span class="string" id="7277021">&#34;a[i]&nbsp;:=&nbsp;x&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7277034">if</span>&nbsp;<span class="ident" id="7277037">_</span><span class="op" id="7277038">,</span>&nbsp;<span class="ident" id="7277040">err</span>&nbsp;<span class="op" id="7277044">:=</span>&nbsp;<span class="ident" id="7277047">ParseExpr</span><span class="op" id="7277056">(</span><span class="ident" id="7277057">src</span><span class="op" id="7277060">)</span><span class="op" id="7277061">;</span>&nbsp;<span class="ident" id="7277063">err</span>&nbsp;<span class="op" id="7277067">==</span>&nbsp;<span class="ident" id="7277070">nil</span>&nbsp;<span class="op" id="7277074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277078">t</span><span class="op" id="7277079">.</span><span class="ident" id="7277080">Errorf</span><span class="op" id="7277086">(</span><span class="string" id="7277087">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7277116">,</span>&nbsp;<span class="ident" id="7277118">src</span><span class="op" id="7277121">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7277124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7277128">//&nbsp;a&nbsp;semicolon&nbsp;is&nbsp;not&nbsp;permitted&nbsp;unless&nbsp;automatically&nbsp;inserted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277191">src</span>&nbsp;<span class="op" id="7277195">=</span>&nbsp;<span class="string" id="7277197">&#34;a&nbsp;+&nbsp;b\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7277208">if</span>&nbsp;<span class="ident" id="7277211">_</span><span class="op" id="7277212">,</span>&nbsp;<span class="ident" id="7277214">err</span>&nbsp;<span class="op" id="7277218">:=</span>&nbsp;<span class="ident" id="7277221">ParseExpr</span><span class="op" id="7277230">(</span><span class="ident" id="7277231">src</span><span class="op" id="7277234">)</span><span class="op" id="7277235">;</span>&nbsp;<span class="ident" id="7277237">err</span>&nbsp;<span class="op" id="7277241">!=</span>&nbsp;<span class="ident" id="7277244">nil</span>&nbsp;<span class="op" id="7277248">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277252">t</span><span class="op" id="7277253">.</span><span class="ident" id="7277254">Errorf</span><span class="op" id="7277260">(</span><span class="string" id="7277261">&#34;ParseExpr(%q):&nbsp;got&nbsp;error&nbsp;%s&#34;</span><span class="op" id="7277290">,</span>&nbsp;<span class="ident" id="7277292">src</span><span class="op" id="7277295">,</span>&nbsp;<span class="ident" id="7277297">err</span><span class="op" id="7277300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7277303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277306">src</span>&nbsp;<span class="op" id="7277310">=</span>&nbsp;<span class="string" id="7277312">&#34;a&nbsp;+&nbsp;b;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7277322">if</span>&nbsp;<span class="ident" id="7277325">_</span><span class="op" id="7277326">,</span>&nbsp;<span class="ident" id="7277328">err</span>&nbsp;<span class="op" id="7277332">:=</span>&nbsp;<span class="ident" id="7277335">ParseExpr</span><span class="op" id="7277344">(</span><span class="ident" id="7277345">src</span><span class="op" id="7277348">)</span><span class="op" id="7277349">;</span>&nbsp;<span class="ident" id="7277351">err</span>&nbsp;<span class="op" id="7277355">==</span>&nbsp;<span class="ident" id="7277358">nil</span>&nbsp;<span class="op" id="7277362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277366">t</span><span class="op" id="7277367">.</span><span class="ident" id="7277368">Errorf</span><span class="op" id="7277374">(</span><span class="string" id="7277375">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7277404">,</span>&nbsp;<span class="ident" id="7277406">src</span><span class="op" id="7277409">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7277412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7277416">//&nbsp;various&nbsp;other&nbsp;stuff&nbsp;following&nbsp;a&nbsp;valid&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7277469">const</span>&nbsp;<span class="ident" id="7277475">validExpr</span>&nbsp;<span class="op" id="7277485">=</span>&nbsp;<span class="string" id="7277487">&#34;a&nbsp;+&nbsp;b&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7277496">const</span>&nbsp;<span class="ident" id="7277502">anything</span>&nbsp;<span class="op" id="7277511">=</span>&nbsp;<span class="string" id="7277513">&#34;dh3*#D)#_&#34;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7277526">for</span>&nbsp;<span class="ident" id="7277530">_</span><span class="op" id="7277531">,</span>&nbsp;<span class="ident" id="7277533">c</span>&nbsp;<span class="op" id="7277535">:=</span>&nbsp;<span class="keyword" id="7277538">range</span>&nbsp;<span class="string" id="7277544">&#34;!)]};,&#34;</span>&nbsp;<span class="op" id="7277553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277557">src</span>&nbsp;<span class="op" id="7277561">:=</span>&nbsp;<span class="ident" id="7277564">validExpr</span>&nbsp;<span class="op" id="7277574">+</span>&nbsp;<span class="builtintype" id="7277576">string</span><span class="op" id="7277582">(</span><span class="ident" id="7277583">c</span><span class="op" id="7277584">)</span>&nbsp;<span class="op" id="7277586">+</span>&nbsp;<span class="ident" id="7277588">anything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7277599">if</span>&nbsp;<span class="ident" id="7277602">_</span><span class="op" id="7277603">,</span>&nbsp;<span class="ident" id="7277605">err</span>&nbsp;<span class="op" id="7277609">:=</span>&nbsp;<span class="ident" id="7277612">ParseExpr</span><span class="op" id="7277621">(</span><span class="ident" id="7277622">src</span><span class="op" id="7277625">)</span><span class="op" id="7277626">;</span>&nbsp;<span class="ident" id="7277628">err</span>&nbsp;<span class="op" id="7277632">==</span>&nbsp;<span class="ident" id="7277635">nil</span>&nbsp;<span class="op" id="7277639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277644">t</span><span class="op" id="7277645">.</span><span class="ident" id="7277646">Errorf</span><span class="op" id="7277652">(</span><span class="string" id="7277653">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7277682">,</span>&nbsp;<span class="ident" id="7277684">src</span><span class="op" id="7277687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7277691">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7277694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7277698">//&nbsp;ParseExpr&nbsp;must&nbsp;not&nbsp;crash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7277727">for</span>&nbsp;<span class="ident" id="7277731">_</span><span class="op" id="7277732">,</span>&nbsp;<span class="ident" id="7277734">src</span>&nbsp;<span class="op" id="7277738">:=</span>&nbsp;<span class="keyword" id="7277741">range</span>&nbsp;<span class="ident" id="7277747">valids</span>&nbsp;<span class="op" id="7277754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277758">ParseExpr</span><span class="op" id="7277767">(</span><span class="ident" id="7277768">src</span><span class="op" id="7277771">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7277774">}</span><br>
<span class="lineno"></span><span class="op" id="7277776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7277779">func</span>&nbsp;<span class="ident" id="7277784">TestColonEqualsScope</span><span class="op" id="7277804">(</span><span class="ident" id="7277805">t</span>&nbsp;<span class="op" id="7277807">*</span><span class="ident" id="7277808">testing</span><span class="op" id="7277815">.</span><span class="ident" id="7277816">T</span><span class="op" id="7277817">)</span>&nbsp;<span class="op" id="7277819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277822">f</span><span class="op" id="7277823">,</span>&nbsp;<span class="ident" id="7277825">err</span>&nbsp;<span class="op" id="7277829">:=</span>&nbsp;<span class="ident" id="7277832">ParseFile</span><span class="op" id="7277841">(</span><span class="ident" id="7277842">fset</span><span class="op" id="7277846">,</span>&nbsp;<span class="string" id="7277848">&#34;&#34;</span><span class="op" id="7277850">,</span>&nbsp;<span class="string" id="7277852">`package&nbsp;p;&nbsp;func&nbsp;f()&nbsp;{&nbsp;x,&nbsp;y,&nbsp;z&nbsp;:=&nbsp;x,&nbsp;y,&nbsp;z&nbsp;}`</span><span class="op" id="7277896">,</span>&nbsp;<span class="num" id="7277898">0</span><span class="op" id="7277899">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7277902">if</span>&nbsp;<span class="ident" id="7277905">err</span>&nbsp;<span class="op" id="7277909">!=</span>&nbsp;<span class="ident" id="7277912">nil</span>&nbsp;<span class="op" id="7277916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277920">t</span><span class="op" id="7277921">.</span><span class="ident" id="7277922">Fatal</span><span class="op" id="7277927">(</span><span class="ident" id="7277928">err</span><span class="op" id="7277931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7277934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7277938">//&nbsp;RHS&nbsp;refers&nbsp;to&nbsp;undefined&nbsp;globals;&nbsp;LHS&nbsp;does&nbsp;not.</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7277989">as</span>&nbsp;<span class="op" id="7277992">:=</span>&nbsp;<span class="ident" id="7277995">f</span><span class="op" id="7277996">.</span><span class="ident" id="7277997">Decls</span><span class="op" id="7278002">[</span><span class="num" id="7278003">0</span><span class="op" id="7278004">]</span><span class="op" id="7278005">.</span><span class="op" id="7278006">(</span><span class="op" id="7278007">*</span><span class="ident" id="7278008">ast</span><span class="op" id="7278011">.</span><span class="ident" id="7278012">FuncDecl</span><span class="op" id="7278020">)</span><span class="op" id="7278021">.</span><span class="ident" id="7278022">Body</span><span class="op" id="7278026">.</span><span class="ident" id="7278027">List</span><span class="op" id="7278031">[</span><span class="num" id="7278032">0</span><span class="op" id="7278033">]</span><span class="op" id="7278034">.</span><span class="op" id="7278035">(</span><span class="op" id="7278036">*</span><span class="ident" id="7278037">ast</span><span class="op" id="7278040">.</span><span class="ident" id="7278041">AssignStmt</span><span class="op" id="7278051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278054">for</span>&nbsp;<span class="ident" id="7278058">_</span><span class="op" id="7278059">,</span>&nbsp;<span class="ident" id="7278061">v</span>&nbsp;<span class="op" id="7278063">:=</span>&nbsp;<span class="keyword" id="7278066">range</span>&nbsp;<span class="ident" id="7278072">as</span><span class="op" id="7278074">.</span><span class="ident" id="7278075">Rhs</span>&nbsp;<span class="op" id="7278079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278083">id</span>&nbsp;<span class="op" id="7278086">:=</span>&nbsp;<span class="ident" id="7278089">v</span><span class="op" id="7278090">.</span><span class="op" id="7278091">(</span><span class="op" id="7278092">*</span><span class="ident" id="7278093">ast</span><span class="op" id="7278096">.</span><span class="ident" id="7278097">Ident</span><span class="op" id="7278102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278106">if</span>&nbsp;<span class="ident" id="7278109">id</span><span class="op" id="7278111">.</span><span class="ident" id="7278112">Obj</span>&nbsp;<span class="op" id="7278116">!=</span>&nbsp;<span class="ident" id="7278119">nil</span>&nbsp;<span class="op" id="7278123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278128">t</span><span class="op" id="7278129">.</span><span class="ident" id="7278130">Errorf</span><span class="op" id="7278136">(</span><span class="string" id="7278137">&#34;rhs&nbsp;%s&nbsp;has&nbsp;Obj,&nbsp;should&nbsp;not&#34;</span><span class="op" id="7278165">,</span>&nbsp;<span class="ident" id="7278167">id</span><span class="op" id="7278169">.</span><span class="ident" id="7278170">Name</span><span class="op" id="7278174">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7278178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7278181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278184">for</span>&nbsp;<span class="ident" id="7278188">_</span><span class="op" id="7278189">,</span>&nbsp;<span class="ident" id="7278191">v</span>&nbsp;<span class="op" id="7278193">:=</span>&nbsp;<span class="keyword" id="7278196">range</span>&nbsp;<span class="ident" id="7278202">as</span><span class="op" id="7278204">.</span><span class="ident" id="7278205">Lhs</span>&nbsp;<span class="op" id="7278209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278213">id</span>&nbsp;<span class="op" id="7278216">:=</span>&nbsp;<span class="ident" id="7278219">v</span><span class="op" id="7278220">.</span><span class="op" id="7278221">(</span><span class="op" id="7278222">*</span><span class="ident" id="7278223">ast</span><span class="op" id="7278226">.</span><span class="ident" id="7278227">Ident</span><span class="op" id="7278232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278236">if</span>&nbsp;<span class="ident" id="7278239">id</span><span class="op" id="7278241">.</span><span class="ident" id="7278242">Obj</span>&nbsp;<span class="op" id="7278246">==</span>&nbsp;<span class="ident" id="7278249">nil</span>&nbsp;<span class="op" id="7278253">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278258">t</span><span class="op" id="7278259">.</span><span class="ident" id="7278260">Errorf</span><span class="op" id="7278266">(</span><span class="string" id="7278267">&#34;lhs&nbsp;%s&nbsp;does&nbsp;not&nbsp;have&nbsp;Obj,&nbsp;should&#34;</span><span class="op" id="7278301">,</span>&nbsp;<span class="ident" id="7278303">id</span><span class="op" id="7278305">.</span><span class="ident" id="7278306">Name</span><span class="op" id="7278310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7278314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7278317">}</span><br>
<span class="lineno"></span><span class="op" id="7278319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="7278322">func</span>&nbsp;<span class="ident" id="7278327">TestVarScope</span><span class="op" id="7278339">(</span><span class="ident" id="7278340">t</span>&nbsp;<span class="op" id="7278342">*</span><span class="ident" id="7278343">testing</span><span class="op" id="7278350">.</span><span class="ident" id="7278351">T</span><span class="op" id="7278352">)</span>&nbsp;<span class="op" id="7278354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278357">f</span><span class="op" id="7278358">,</span>&nbsp;<span class="ident" id="7278360">err</span>&nbsp;<span class="op" id="7278364">:=</span>&nbsp;<span class="ident" id="7278367">ParseFile</span><span class="op" id="7278376">(</span><span class="ident" id="7278377">fset</span><span class="op" id="7278381">,</span>&nbsp;<span class="string" id="7278383">&#34;&#34;</span><span class="op" id="7278385">,</span>&nbsp;<span class="string" id="7278387">`package&nbsp;p;&nbsp;func&nbsp;f()&nbsp;{&nbsp;var&nbsp;x,&nbsp;y,&nbsp;z&nbsp;=&nbsp;x,&nbsp;y,&nbsp;z&nbsp;}`</span><span class="op" id="7278434">,</span>&nbsp;<span class="num" id="7278436">0</span><span class="op" id="7278437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278440">if</span>&nbsp;<span class="ident" id="7278443">err</span>&nbsp;<span class="op" id="7278447">!=</span>&nbsp;<span class="ident" id="7278450">nil</span>&nbsp;<span class="op" id="7278454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278458">t</span><span class="op" id="7278459">.</span><span class="ident" id="7278460">Fatal</span><span class="op" id="7278465">(</span><span class="ident" id="7278466">err</span><span class="op" id="7278469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7278472">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7278476">//&nbsp;RHS&nbsp;refers&nbsp;to&nbsp;undefined&nbsp;globals;&nbsp;LHS&nbsp;does&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278527">as</span>&nbsp;<span class="op" id="7278530">:=</span>&nbsp;<span class="ident" id="7278533">f</span><span class="op" id="7278534">.</span><span class="ident" id="7278535">Decls</span><span class="op" id="7278540">[</span><span class="num" id="7278541">0</span><span class="op" id="7278542">]</span><span class="op" id="7278543">.</span><span class="op" id="7278544">(</span><span class="op" id="7278545">*</span><span class="ident" id="7278546">ast</span><span class="op" id="7278549">.</span><span class="ident" id="7278550">FuncDecl</span><span class="op" id="7278558">)</span><span class="op" id="7278559">.</span><span class="ident" id="7278560">Body</span><span class="op" id="7278564">.</span><span class="ident" id="7278565">List</span><span class="op" id="7278569">[</span><span class="num" id="7278570">0</span><span class="op" id="7278571">]</span><span class="op" id="7278572">.</span><span class="op" id="7278573">(</span><span class="op" id="7278574">*</span><span class="ident" id="7278575">ast</span><span class="op" id="7278578">.</span><span class="ident" id="7278579">DeclStmt</span><span class="op" id="7278587">)</span><span class="op" id="7278588">.</span><span class="ident" id="7278589">Decl</span><span class="op" id="7278593">.</span><span class="op" id="7278594">(</span><span class="op" id="7278595">*</span><span class="ident" id="7278596">ast</span><span class="op" id="7278599">.</span><span class="ident" id="7278600">GenDecl</span><span class="op" id="7278607">)</span><span class="op" id="7278608">.</span><span class="ident" id="7278609">Specs</span><span class="op" id="7278614">[</span><span class="num" id="7278615">0</span><span class="op" id="7278616">]</span><span class="op" id="7278617">.</span><span class="op" id="7278618">(</span><span class="op" id="7278619">*</span><span class="ident" id="7278620">ast</span><span class="op" id="7278623">.</span><span class="ident" id="7278624">ValueSpec</span><span class="op" id="7278633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278636">for</span>&nbsp;<span class="ident" id="7278640">_</span><span class="op" id="7278641">,</span>&nbsp;<span class="ident" id="7278643">v</span>&nbsp;<span class="op" id="7278645">:=</span>&nbsp;<span class="keyword" id="7278648">range</span>&nbsp;<span class="ident" id="7278654">as</span><span class="op" id="7278656">.</span><span class="ident" id="7278657">Values</span>&nbsp;<span class="op" id="7278664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278668">id</span>&nbsp;<span class="op" id="7278671">:=</span>&nbsp;<span class="ident" id="7278674">v</span><span class="op" id="7278675">.</span><span class="op" id="7278676">(</span><span class="op" id="7278677">*</span><span class="ident" id="7278678">ast</span><span class="op" id="7278681">.</span><span class="ident" id="7278682">Ident</span><span class="op" id="7278687">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278691">if</span>&nbsp;<span class="ident" id="7278694">id</span><span class="op" id="7278696">.</span><span class="ident" id="7278697">Obj</span>&nbsp;<span class="op" id="7278701">!=</span>&nbsp;<span class="ident" id="7278704">nil</span>&nbsp;<span class="op" id="7278708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278713">t</span><span class="op" id="7278714">.</span><span class="ident" id="7278715">Errorf</span><span class="op" id="7278721">(</span><span class="string" id="7278722">&#34;rhs&nbsp;%s&nbsp;has&nbsp;Obj,&nbsp;should&nbsp;not&#34;</span><span class="op" id="7278750">,</span>&nbsp;<span class="ident" id="7278752">id</span><span class="op" id="7278754">.</span><span class="ident" id="7278755">Name</span><span class="op" id="7278759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7278763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7278766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278769">for</span>&nbsp;<span class="ident" id="7278773">_</span><span class="op" id="7278774">,</span>&nbsp;<span class="ident" id="7278776">id</span>&nbsp;<span class="op" id="7278779">:=</span>&nbsp;<span class="keyword" id="7278782">range</span>&nbsp;<span class="ident" id="7278788">as</span><span class="op" id="7278790">.</span><span class="ident" id="7278791">Names</span>&nbsp;<span class="op" id="7278797">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278801">if</span>&nbsp;<span class="ident" id="7278804">id</span><span class="op" id="7278806">.</span><span class="ident" id="7278807">Obj</span>&nbsp;<span class="op" id="7278811">==</span>&nbsp;<span class="ident" id="7278814">nil</span>&nbsp;<span class="op" id="7278818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7278823">t</span><span class="op" id="7278824">.</span><span class="ident" id="7278825">Errorf</span><span class="op" id="7278831">(</span><span class="string" id="7278832">&#34;lhs&nbsp;%s&nbsp;does&nbsp;not&nbsp;have&nbsp;Obj,&nbsp;should&#34;</span><span class="op" id="7278866">,</span>&nbsp;<span class="ident" id="7278868">id</span><span class="op" id="7278870">.</span><span class="ident" id="7278871">Name</span><span class="op" id="7278875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7278879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7278882">}</span><br>
<span class="lineno"></span><span class="op" id="7278884">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7278887">func</span>&nbsp;<span class="ident" id="7278892">TestObjects</span><span class="op" id="7278903">(</span><span class="ident" id="7278904">t</span>&nbsp;<span class="op" id="7278906">*</span><span class="ident" id="7278907">testing</span><span class="op" id="7278914">.</span><span class="ident" id="7278915">T</span><span class="op" id="7278916">)</span>&nbsp;<span class="op" id="7278918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7278921">const</span>&nbsp;<span class="ident" id="7278927">src</span>&nbsp;<span class="op" id="7278931">=</span>&nbsp;<span class="string" id="7278933">`<br>
<span class="lineno"></span>package&nbsp;p<br>
<span class="lineno"></span>import&nbsp;fmt&nbsp;&#34;fmt&#34;<br>
<span class="lineno">180</span>const&nbsp;pi&nbsp;=&nbsp;3.14<br>
<span class="lineno"></span>type&nbsp;T&nbsp;struct{}<br>
<span class="lineno"></span>var&nbsp;x&nbsp;int<br>
<span class="lineno"></span>func&nbsp;f()&nbsp;{&nbsp;L:&nbsp;}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279024">f</span><span class="op" id="7279025">,</span>&nbsp;<span class="ident" id="7279027">err</span>&nbsp;<span class="op" id="7279031">:=</span>&nbsp;<span class="ident" id="7279034">ParseFile</span><span class="op" id="7279043">(</span><span class="ident" id="7279044">fset</span><span class="op" id="7279048">,</span>&nbsp;<span class="string" id="7279050">&#34;&#34;</span><span class="op" id="7279052">,</span>&nbsp;<span class="ident" id="7279054">src</span><span class="op" id="7279057">,</span>&nbsp;<span class="num" id="7279059">0</span><span class="op" id="7279060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7279063">if</span>&nbsp;<span class="ident" id="7279066">err</span>&nbsp;<span class="op" id="7279070">!=</span>&nbsp;<span class="ident" id="7279073">nil</span>&nbsp;<span class="op" id="7279077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279081">t</span><span class="op" id="7279082">.</span><span class="ident" id="7279083">Fatal</span><span class="op" id="7279088">(</span><span class="ident" id="7279089">err</span><span class="op" id="7279092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7279095">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279099">objects</span>&nbsp;<span class="op" id="7279107">:=</span>&nbsp;<span class="keyword" id="7279110">map</span><span class="op" id="7279113">[</span><span class="builtintype" id="7279114">string</span><span class="op" id="7279120">]</span><span class="ident" id="7279121">ast</span><span class="op" id="7279124">.</span><span class="ident" id="7279125">ObjKind</span><span class="op" id="7279132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7279136">&#34;p&#34;</span><span class="op" id="7279139">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7279143">ast</span><span class="op" id="7279146">.</span><span class="ident" id="7279147">Bad</span><span class="op" id="7279150">,</span>&nbsp;<span class="comment" id="7279152">//&nbsp;not&nbsp;in&nbsp;a&nbsp;scope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7279172">&#34;fmt&#34;</span><span class="op" id="7279177">:</span>&nbsp;<span class="ident" id="7279179">ast</span><span class="op" id="7279182">.</span><span class="ident" id="7279183">Bad</span><span class="op" id="7279186">,</span>&nbsp;<span class="comment" id="7279188">//&nbsp;not&nbsp;resolved&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7279210">&#34;pi&#34;</span><span class="op" id="7279214">:</span>&nbsp;&nbsp;<span class="ident" id="7279217">ast</span><span class="op" id="7279220">.</span><span class="ident" id="7279221">Con</span><span class="op" id="7279224">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7279228">&#34;T&#34;</span><span class="op" id="7279231">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7279235">ast</span><span class="op" id="7279238">.</span><span class="ident" id="7279239">Typ</span><span class="op" id="7279242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7279246">&#34;x&#34;</span><span class="op" id="7279249">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7279253">ast</span><span class="op" id="7279256">.</span><span class="ident" id="7279257">Var</span><span class="op" id="7279260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7279264">&#34;int&#34;</span><span class="op" id="7279269">:</span>&nbsp;<span class="ident" id="7279271">ast</span><span class="op" id="7279274">.</span><span class="ident" id="7279275">Bad</span><span class="op" id="7279278">,</span>&nbsp;<span class="comment" id="7279280">//&nbsp;not&nbsp;resolved&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7279302">&#34;f&#34;</span><span class="op" id="7279305">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7279309">ast</span><span class="op" id="7279312">.</span><span class="ident" id="7279313">Fun</span><span class="op" id="7279316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7279320">&#34;L&#34;</span><span class="op" id="7279323">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7279327">ast</span><span class="op" id="7279330">.</span><span class="ident" id="7279331">Lbl</span><span class="op" id="7279334">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7279337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279341">ast</span><span class="op" id="7279344">.</span><span class="ident" id="7279345">Inspect</span><span class="op" id="7279352">(</span><span class="ident" id="7279353">f</span><span class="op" id="7279354">,</span>&nbsp;<span class="keyword" id="7279356">func</span><span class="op" id="7279360">(</span><span class="ident" id="7279361">n</span>&nbsp;<span class="ident" id="7279363">ast</span><span class="op" id="7279366">.</span><span class="ident" id="7279367">Node</span><span class="op" id="7279371">)</span>&nbsp;<span class="builtintype" id="7279373">bool</span>&nbsp;<span class="op" id="7279378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7279382">if</span>&nbsp;<span class="ident" id="7279385">ident</span><span class="op" id="7279390">,</span>&nbsp;<span class="ident" id="7279392">ok</span>&nbsp;<span class="op" id="7279395">:=</span>&nbsp;<span class="ident" id="7279398">n</span><span class="op" id="7279399">.</span><span class="op" id="7279400">(</span><span class="op" id="7279401">*</span><span class="ident" id="7279402">ast</span><span class="op" id="7279405">.</span><span class="ident" id="7279406">Ident</span><span class="op" id="7279411">)</span><span class="op" id="7279412">;</span>&nbsp;<span class="ident" id="7279414">ok</span>&nbsp;<span class="op" id="7279417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279422">obj</span>&nbsp;<span class="op" id="7279426">:=</span>&nbsp;<span class="ident" id="7279429">ident</span><span class="op" id="7279434">.</span><span class="ident" id="7279435">Obj</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7279442">if</span>&nbsp;<span class="ident" id="7279445">obj</span>&nbsp;<span class="op" id="7279449">==</span>&nbsp;<span class="ident" id="7279452">nil</span>&nbsp;<span class="op" id="7279456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7279462">if</span>&nbsp;<span class="ident" id="7279465">objects</span><span class="op" id="7279472">[</span><span class="ident" id="7279473">ident</span><span class="op" id="7279478">.</span><span class="ident" id="7279479">Name</span><span class="op" id="7279483">]</span>&nbsp;<span class="op" id="7279485">!=</span>&nbsp;<span class="ident" id="7279488">ast</span><span class="op" id="7279491">.</span><span class="ident" id="7279492">Bad</span>&nbsp;<span class="op" id="7279496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279503">t</span><span class="op" id="7279504">.</span><span class="ident" id="7279505">Errorf</span><span class="op" id="7279511">(</span><span class="string" id="7279512">&#34;no&nbsp;object&nbsp;for&nbsp;%s&#34;</span><span class="op" id="7279530">,</span>&nbsp;<span class="ident" id="7279532">ident</span><span class="op" id="7279537">.</span><span class="ident" id="7279538">Name</span><span class="op" id="7279542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7279548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7279554">return</span>&nbsp;<span class="builtintype" id="7279561">true</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7279569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7279574">if</span>&nbsp;<span class="ident" id="7279577">obj</span><span class="op" id="7279580">.</span><span class="ident" id="7279581">Name</span>&nbsp;<span class="op" id="7279586">!=</span>&nbsp;<span class="ident" id="7279589">ident</span><span class="op" id="7279594">.</span><span class="ident" id="7279595">Name</span>&nbsp;<span class="op" id="7279600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279606">t</span><span class="op" id="7279607">.</span><span class="ident" id="7279608">Errorf</span><span class="op" id="7279614">(</span><span class="string" id="7279615">&#34;names&nbsp;don&#39;t&nbsp;match:&nbsp;obj.Name&nbsp;=&nbsp;%s,&nbsp;ident.Name&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7279666">,</span>&nbsp;<span class="ident" id="7279668">obj</span><span class="op" id="7279671">.</span><span class="ident" id="7279672">Name</span><span class="op" id="7279676">,</span>&nbsp;<span class="ident" id="7279678">ident</span><span class="op" id="7279683">.</span><span class="ident" id="7279684">Name</span><span class="op" id="7279688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7279693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279698">kind</span>&nbsp;<span class="op" id="7279703">:=</span>&nbsp;<span class="ident" id="7279706">objects</span><span class="op" id="7279713">[</span><span class="ident" id="7279714">ident</span><span class="op" id="7279719">.</span><span class="ident" id="7279720">Name</span><span class="op" id="7279724">]</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7279729">if</span>&nbsp;<span class="ident" id="7279732">obj</span><span class="op" id="7279735">.</span><span class="ident" id="7279736">Kind</span>&nbsp;<span class="op" id="7279741">!=</span>&nbsp;<span class="ident" id="7279744">kind</span>&nbsp;<span class="op" id="7279749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279755">t</span><span class="op" id="7279756">.</span><span class="ident" id="7279757">Errorf</span><span class="op" id="7279763">(</span><span class="string" id="7279764">&#34;%s:&nbsp;obj.Kind&nbsp;=&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7279792">,</span>&nbsp;<span class="ident" id="7279794">ident</span><span class="op" id="7279799">.</span><span class="ident" id="7279800">Name</span><span class="op" id="7279804">,</span>&nbsp;<span class="ident" id="7279806">obj</span><span class="op" id="7279809">.</span><span class="ident" id="7279810">Kind</span><span class="op" id="7279814">,</span>&nbsp;<span class="ident" id="7279816">kind</span><span class="op" id="7279820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7279825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7279829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7279833">return</span>&nbsp;<span class="builtintype" id="7279840">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7279846">}</span><span class="op" id="7279847">)</span><br>
<span class="lineno"></span><span class="op" id="7279849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7279852">func</span>&nbsp;<span class="ident" id="7279857">TestUnresolved</span><span class="op" id="7279871">(</span><span class="ident" id="7279872">t</span>&nbsp;<span class="op" id="7279874">*</span><span class="ident" id="7279875">testing</span><span class="op" id="7279882">.</span><span class="ident" id="7279883">T</span><span class="op" id="7279884">)</span>&nbsp;<span class="op" id="7279886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7279889">f</span><span class="op" id="7279890">,</span>&nbsp;<span class="ident" id="7279892">err</span>&nbsp;<span class="op" id="7279896">:=</span>&nbsp;<span class="ident" id="7279899">ParseFile</span><span class="op" id="7279908">(</span><span class="ident" id="7279909">fset</span><span class="op" id="7279913">,</span>&nbsp;<span class="string" id="7279915">&#34;&#34;</span><span class="op" id="7279917">,</span>&nbsp;<span class="string" id="7279919">`<br>
<span class="lineno">225</span>package&nbsp;p<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>func&nbsp;f1a(int)<br>
<span class="lineno"></span>func&nbsp;f2a(byte,&nbsp;int,&nbsp;float)<br>
<span class="lineno"></span>func&nbsp;f3a(a,&nbsp;b&nbsp;int,&nbsp;c&nbsp;float)<br>
<span class="lineno">230</span>func&nbsp;f4a(...complex)<br>
<span class="lineno"></span>func&nbsp;f5a(a&nbsp;s1a,&nbsp;b&nbsp;...complex)<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>func&nbsp;f1b(*int)<br>
<span class="lineno"></span>func&nbsp;f2b([]byte,&nbsp;(int),&nbsp;*float)<br>
<span class="lineno">235</span>func&nbsp;f3b(a,&nbsp;b&nbsp;*int,&nbsp;c&nbsp;[]float)<br>
<span class="lineno"></span>func&nbsp;f4b(...*complex)<br>
<span class="lineno"></span>func&nbsp;f5b(a&nbsp;s1a,&nbsp;b&nbsp;...[]complex)<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>type&nbsp;s1a&nbsp;struct&nbsp;{&nbsp;int&nbsp;}<br>
<span class="lineno">240</span>type&nbsp;s2a&nbsp;struct&nbsp;{&nbsp;byte;&nbsp;int;&nbsp;s1a&nbsp;}<br>
<span class="lineno"></span>type&nbsp;s3a&nbsp;struct&nbsp;{&nbsp;a,&nbsp;b&nbsp;int;&nbsp;c&nbsp;float&nbsp;}<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>type&nbsp;s1b&nbsp;struct&nbsp;{&nbsp;*int&nbsp;}<br>
<span class="lineno"></span>type&nbsp;s2b&nbsp;struct&nbsp;{&nbsp;byte;&nbsp;int;&nbsp;*float&nbsp;}<br>
<span class="lineno">245</span>type&nbsp;s3b&nbsp;struct&nbsp;{&nbsp;a,&nbsp;b&nbsp;*s3b;&nbsp;c&nbsp;[]float&nbsp;}<br>
<span class="lineno"></span>`</span><span class="op" id="7280397">,</span>&nbsp;<span class="num" id="7280399">0</span><span class="op" id="7280400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7280403">if</span>&nbsp;<span class="ident" id="7280406">err</span>&nbsp;<span class="op" id="7280410">!=</span>&nbsp;<span class="ident" id="7280413">nil</span>&nbsp;<span class="op" id="7280417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7280421">t</span><span class="op" id="7280422">.</span><span class="ident" id="7280423">Fatal</span><span class="op" id="7280428">(</span><span class="ident" id="7280429">err</span><span class="op" id="7280432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7280435">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7280439">want</span>&nbsp;<span class="op" id="7280444">:=</span>&nbsp;<span class="string" id="7280447">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7280454">+</span>&nbsp;<span class="comment" id="7280456">//&nbsp;f1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280465">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7280483">+</span>&nbsp;<span class="comment" id="7280485">//&nbsp;f2a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280494">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7280507">+</span>&nbsp;<span class="comment" id="7280509">//&nbsp;f3a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280518">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7280529">+</span>&nbsp;<span class="comment" id="7280531">//&nbsp;f4a</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280540">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7280551">+</span>&nbsp;<span class="comment" id="7280553">//&nbsp;f5a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7280562">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280567">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7280574">+</span>&nbsp;<span class="comment" id="7280576">//&nbsp;f1b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280585">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7280603">+</span>&nbsp;<span class="comment" id="7280605">//&nbsp;f2b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280614">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7280627">+</span>&nbsp;<span class="comment" id="7280629">//&nbsp;f3b</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280638">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7280649">+</span>&nbsp;<span class="comment" id="7280651">//&nbsp;f4b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280660">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7280671">+</span>&nbsp;<span class="comment" id="7280673">//&nbsp;f5b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7280682">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280687">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7280694">+</span>&nbsp;<span class="comment" id="7280696">//&nbsp;s1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280705">&#34;byte&nbsp;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7280717">+</span>&nbsp;<span class="comment" id="7280719">//&nbsp;s2a</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280728">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7280741">+</span>&nbsp;<span class="comment" id="7280743">//&nbsp;s3a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7280752">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280757">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7280764">+</span>&nbsp;<span class="comment" id="7280766">//&nbsp;s1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280775">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7280793">+</span>&nbsp;<span class="comment" id="7280795">//&nbsp;s2a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280804">&#34;float&nbsp;&#34;</span>&nbsp;<span class="comment" id="7280813">//&nbsp;s3a</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7280822">//&nbsp;collect&nbsp;unresolved&nbsp;identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7280857">var</span>&nbsp;<span class="ident" id="7280861">buf</span>&nbsp;<span class="ident" id="7280865">bytes</span><span class="op" id="7280870">.</span><span class="ident" id="7280871">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7280879">for</span>&nbsp;<span class="ident" id="7280883">_</span><span class="op" id="7280884">,</span>&nbsp;<span class="ident" id="7280886">u</span>&nbsp;<span class="op" id="7280888">:=</span>&nbsp;<span class="keyword" id="7280891">range</span>&nbsp;<span class="ident" id="7280897">f</span><span class="op" id="7280898">.</span><span class="ident" id="7280899">Unresolved</span>&nbsp;<span class="op" id="7280910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7280914">buf</span><span class="op" id="7280917">.</span><span class="ident" id="7280918">WriteString</span><span class="op" id="7280929">(</span><span class="ident" id="7280930">u</span><span class="op" id="7280931">.</span><span class="ident" id="7280932">Name</span><span class="op" id="7280936">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7280940">buf</span><span class="op" id="7280943">.</span><span class="ident" id="7280944">WriteByte</span><span class="op" id="7280953">(</span><span class="string" id="7280954">&#39;&nbsp;&#39;</span><span class="op" id="7280957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7280960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7280963">got</span>&nbsp;<span class="op" id="7280967">:=</span>&nbsp;<span class="ident" id="7280970">buf</span><span class="op" id="7280973">.</span><span class="ident" id="7280974">String</span><span class="op" id="7280980">(</span><span class="op" id="7280981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7280985">if</span>&nbsp;<span class="ident" id="7280988">got</span>&nbsp;<span class="op" id="7280992">!=</span>&nbsp;<span class="ident" id="7280995">want</span>&nbsp;<span class="op" id="7281000">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281004">t</span><span class="op" id="7281005">.</span><span class="ident" id="7281006">Errorf</span><span class="op" id="7281012">(</span><span class="string" id="7281013">&#34;\ngot:&nbsp;&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="7281035">,</span>&nbsp;<span class="ident" id="7281037">got</span><span class="op" id="7281040">,</span>&nbsp;<span class="ident" id="7281042">want</span><span class="op" id="7281046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7281049">}</span><br>
<span class="lineno"></span><span class="op" id="7281051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7281054">var</span>&nbsp;<span class="ident" id="7281058">imports</span>&nbsp;<span class="op" id="7281066">=</span>&nbsp;<span class="keyword" id="7281068">map</span><span class="op" id="7281071">[</span><span class="builtintype" id="7281072">string</span><span class="op" id="7281078">]</span><span class="builtintype" id="7281079">bool</span><span class="op" id="7281083">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281086">`&#34;a&#34;`</span><span class="op" id="7281091">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281100">true</span><span class="op" id="7281104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281107">&#34;`a`&#34;</span><span class="op" id="7281112">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281121">true</span><span class="op" id="7281125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281128">`&#34;a/b&#34;`</span><span class="op" id="7281135">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281142">true</span><span class="op" id="7281146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281149">`&#34;a.b&#34;`</span><span class="op" id="7281156">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281163">true</span><span class="op" id="7281167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281170">`&#34;m\x61th&#34;`</span><span class="op" id="7281181">:</span>&nbsp;&nbsp;<span class="builtintype" id="7281184">true</span><span class="op" id="7281188">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281191">`&#34;greek/αβ&#34;`</span><span class="op" id="7281205">:</span>&nbsp;<span class="builtintype" id="7281207">true</span><span class="op" id="7281211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281214">`&#34;&#34;`</span><span class="op" id="7281218">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281228">false</span><span class="op" id="7281233">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7281237">//&nbsp;Each&nbsp;of&nbsp;these&nbsp;pairs&nbsp;tests&nbsp;both&nbsp;``&nbsp;vs&nbsp;&#34;&#34;&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7281289">//&nbsp;and&nbsp;also&nbsp;use&nbsp;of&nbsp;invalid&nbsp;characters&nbsp;spelled&nbsp;out&nbsp;as</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7281343">//&nbsp;escape&nbsp;sequences&nbsp;and&nbsp;written&nbsp;directly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7281386">//&nbsp;For&nbsp;example&nbsp;`&#34;\x00&#34;`&nbsp;tests&nbsp;import&nbsp;&#34;\x00&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7281431">//&nbsp;while&nbsp;&#34;`\x00`&#34;&nbsp;tests&nbsp;import&nbsp;`&lt;actual-NUL-byte&gt;`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281484">`&#34;\x00&#34;`</span><span class="op" id="7281492">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281498">false</span><span class="op" id="7281503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281506">&#34;`\x00`&#34;</span><span class="op" id="7281514">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281520">false</span><span class="op" id="7281525">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281528">`&#34;\x7f&#34;`</span><span class="op" id="7281536">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281542">false</span><span class="op" id="7281547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281550">&#34;`\x7f`&#34;</span><span class="op" id="7281558">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281564">false</span><span class="op" id="7281569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281572">`&#34;a!&#34;`</span><span class="op" id="7281578">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281586">false</span><span class="op" id="7281591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281594">&#34;`a!`&#34;</span><span class="op" id="7281600">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281608">false</span><span class="op" id="7281613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281616">`&#34;a&nbsp;b&#34;`</span><span class="op" id="7281623">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281630">false</span><span class="op" id="7281635">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281638">&#34;`a&nbsp;b`&#34;</span><span class="op" id="7281645">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281652">false</span><span class="op" id="7281657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281660">`&#34;a\\b&#34;`</span><span class="op" id="7281668">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281674">false</span><span class="op" id="7281679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281682">&#34;`a\\b`&#34;</span><span class="op" id="7281690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281696">false</span><span class="op" id="7281701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281704">&#34;\&#34;`a`\&#34;&#34;</span><span class="op" id="7281713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281718">false</span><span class="op" id="7281723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281726">&#34;`\&#34;a\&#34;`&#34;</span><span class="op" id="7281735">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281740">false</span><span class="op" id="7281745">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281748">`&#34;\x80\x80&#34;`</span><span class="op" id="7281760">:</span>&nbsp;<span class="builtintype" id="7281762">false</span><span class="op" id="7281767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281770">&#34;`\x80\x80`&#34;</span><span class="op" id="7281782">:</span>&nbsp;<span class="builtintype" id="7281784">false</span><span class="op" id="7281789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281792">`&#34;\xFFFD&#34;`</span><span class="op" id="7281802">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281806">false</span><span class="op" id="7281811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281814">&#34;`\xFFFD`&#34;</span><span class="op" id="7281824">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281828">false</span><span class="op" id="7281833">,</span><br>
<span class="lineno"></span><span class="op" id="7281835">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="7281838">func</span>&nbsp;<span class="ident" id="7281843">TestImports</span><span class="op" id="7281854">(</span><span class="ident" id="7281855">t</span>&nbsp;<span class="op" id="7281857">*</span><span class="ident" id="7281858">testing</span><span class="op" id="7281865">.</span><span class="ident" id="7281866">T</span><span class="op" id="7281867">)</span>&nbsp;<span class="op" id="7281869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7281872">for</span>&nbsp;<span class="ident" id="7281876">path</span><span class="op" id="7281880">,</span>&nbsp;<span class="ident" id="7281882">isValid</span>&nbsp;<span class="op" id="7281890">:=</span>&nbsp;<span class="keyword" id="7281893">range</span>&nbsp;<span class="ident" id="7281899">imports</span>&nbsp;<span class="op" id="7281907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281911">src</span>&nbsp;<span class="op" id="7281915">:=</span>&nbsp;<span class="ident" id="7281918">fmt</span><span class="op" id="7281921">.</span><span class="ident" id="7281922">Sprintf</span><span class="op" id="7281929">(</span><span class="string" id="7281930">&#34;package&nbsp;p;&nbsp;import&nbsp;%s&#34;</span><span class="op" id="7281952">,</span>&nbsp;<span class="ident" id="7281954">path</span><span class="op" id="7281958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281962">_</span><span class="op" id="7281963">,</span>&nbsp;<span class="ident" id="7281965">err</span>&nbsp;<span class="op" id="7281969">:=</span>&nbsp;<span class="ident" id="7281972">ParseFile</span><span class="op" id="7281981">(</span><span class="ident" id="7281982">fset</span><span class="op" id="7281986">,</span>&nbsp;<span class="string" id="7281988">&#34;&#34;</span><span class="op" id="7281990">,</span>&nbsp;<span class="ident" id="7281992">src</span><span class="op" id="7281995">,</span>&nbsp;<span class="num" id="7281997">0</span><span class="op" id="7281998">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7282002">switch</span>&nbsp;<span class="op" id="7282009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7282013">case</span>&nbsp;<span class="ident" id="7282018">err</span>&nbsp;<span class="op" id="7282022">!=</span>&nbsp;<span class="ident" id="7282025">nil</span>&nbsp;<span class="op" id="7282029">&amp;&amp;</span>&nbsp;<span class="ident" id="7282032">isValid</span><span class="op" id="7282039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7282044">t</span><span class="op" id="7282045">.</span><span class="ident" id="7282046">Errorf</span><span class="op" id="7282052">(</span><span class="string" id="7282053">&#34;ParseFile(%s):&nbsp;got&nbsp;%v;&nbsp;expected&nbsp;no&nbsp;error&#34;</span><span class="op" id="7282095">,</span>&nbsp;<span class="ident" id="7282097">src</span><span class="op" id="7282100">,</span>&nbsp;<span class="ident" id="7282102">err</span><span class="op" id="7282105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7282109">case</span>&nbsp;<span class="ident" id="7282114">err</span>&nbsp;<span class="op" id="7282118">==</span>&nbsp;<span class="ident" id="7282121">nil</span>&nbsp;<span class="op" id="7282125">&amp;&amp;</span>&nbsp;<span class="op" id="7282128">!</span><span class="ident" id="7282129">isValid</span><span class="op" id="7282136">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7282141">t</span><span class="op" id="7282142">.</span><span class="ident" id="7282143">Errorf</span><span class="op" id="7282149">(</span><span class="string" id="7282150">&#34;ParseFile(%s):&nbsp;got&nbsp;no&nbsp;error;&nbsp;expected&nbsp;one&#34;</span><span class="op" id="7282193">,</span>&nbsp;<span class="ident" id="7282195">src</span><span class="op" id="7282198">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282205">}</span><br>
<span class="lineno"></span><span class="op" id="7282207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7282210">func</span>&nbsp;<span class="ident" id="7282215">TestCommentGroups</span><span class="op" id="7282232">(</span><span class="ident" id="7282233">t</span>&nbsp;<span class="op" id="7282235">*</span><span class="ident" id="7282236">testing</span><span class="op" id="7282243">.</span><span class="ident" id="7282244">T</span><span class="op" id="7282245">)</span>&nbsp;<span class="op" id="7282247">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7282250">f</span><span class="op" id="7282251">,</span>&nbsp;<span class="ident" id="7282253">err</span>&nbsp;<span class="op" id="7282257">:=</span>&nbsp;<span class="ident" id="7282260">ParseFile</span><span class="op" id="7282269">(</span><span class="ident" id="7282270">fset</span><span class="op" id="7282274">,</span>&nbsp;<span class="string" id="7282276">&#34;&#34;</span><span class="op" id="7282278">,</span>&nbsp;<span class="string" id="7282280">`<br>
<span class="lineno"></span>package&nbsp;p&nbsp;/*&nbsp;1a&nbsp;*/&nbsp;/*&nbsp;1b&nbsp;*/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;1c&nbsp;*/&nbsp;//&nbsp;1d<br>
<span class="lineno"></span>/*&nbsp;2a<br>
<span class="lineno"></span>*/<br>
<span class="lineno"></span>//&nbsp;2b<br>
<span class="lineno">335</span>const&nbsp;pi&nbsp;=&nbsp;3.1415<br>
<span class="lineno"></span>/*&nbsp;3a&nbsp;*/&nbsp;//&nbsp;3b<br>
<span class="lineno"></span>/*&nbsp;3c&nbsp;*/&nbsp;const&nbsp;e&nbsp;=&nbsp;2.7182<br>
<span class="lineno"></span><br>
<span class="lineno"></span>//&nbsp;Example&nbsp;from&nbsp;issue&nbsp;3139<br>
<span class="lineno">340</span>func&nbsp;ExampleCount()&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Println(strings.Count(&#34;cheese&#34;,&nbsp;&#34;e&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Println(strings.Count(&#34;five&#34;,&nbsp;&#34;&#34;))&nbsp;//&nbsp;before&nbsp;&amp;&nbsp;after&nbsp;each&nbsp;rune<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;Output:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;3<br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;5<br>
<span class="lineno"></span>}<br>
<span class="lineno"></span>`</span><span class="op" id="7282592">,</span>&nbsp;<span class="ident" id="7282594">ParseComments</span><span class="op" id="7282607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7282610">if</span>&nbsp;<span class="ident" id="7282613">err</span>&nbsp;<span class="op" id="7282617">!=</span>&nbsp;<span class="ident" id="7282620">nil</span>&nbsp;<span class="op" id="7282624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7282628">t</span><span class="op" id="7282629">.</span><span class="ident" id="7282630">Fatal</span><span class="op" id="7282635">(</span><span class="ident" id="7282636">err</span><span class="op" id="7282639">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7282645">expected</span>&nbsp;<span class="op" id="7282654">:=</span>&nbsp;<span class="op" id="7282657">[</span><span class="op" id="7282658">]</span><span class="op" id="7282659">[</span><span class="op" id="7282660">]</span><span class="builtintype" id="7282661">string</span><span class="op" id="7282667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282671">{</span><span class="string" id="7282672">&#34;/*&nbsp;1a&nbsp;*/&#34;</span><span class="op" id="7282682">,</span>&nbsp;<span class="string" id="7282684">&#34;/*&nbsp;1b&nbsp;*/&#34;</span><span class="op" id="7282694">,</span>&nbsp;<span class="string" id="7282696">&#34;/*&nbsp;1c&nbsp;*/&#34;</span><span class="op" id="7282706">,</span>&nbsp;<span class="string" id="7282708">&#34;//&nbsp;1d&#34;</span><span class="op" id="7282715">}</span><span class="op" id="7282716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282720">{</span><span class="string" id="7282721">&#34;/*&nbsp;2a\n*/&#34;</span><span class="op" id="7282732">,</span>&nbsp;<span class="string" id="7282734">&#34;//&nbsp;2b&#34;</span><span class="op" id="7282741">}</span><span class="op" id="7282742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282746">{</span><span class="string" id="7282747">&#34;/*&nbsp;3a&nbsp;*/&#34;</span><span class="op" id="7282757">,</span>&nbsp;<span class="string" id="7282759">&#34;//&nbsp;3b&#34;</span><span class="op" id="7282766">,</span>&nbsp;<span class="string" id="7282768">&#34;/*&nbsp;3c&nbsp;*/&#34;</span><span class="op" id="7282778">}</span><span class="op" id="7282779">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282783">{</span><span class="string" id="7282784">&#34;//&nbsp;Example&nbsp;from&nbsp;issue&nbsp;3139&#34;</span><span class="op" id="7282812">}</span><span class="op" id="7282813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282817">{</span><span class="string" id="7282818">&#34;//&nbsp;before&nbsp;&amp;&nbsp;after&nbsp;each&nbsp;rune&#34;</span><span class="op" id="7282847">}</span><span class="op" id="7282848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282852">{</span><span class="string" id="7282853">&#34;//&nbsp;Output:&#34;</span><span class="op" id="7282865">,</span>&nbsp;<span class="string" id="7282867">&#34;//&nbsp;3&#34;</span><span class="op" id="7282873">,</span>&nbsp;<span class="string" id="7282875">&#34;//&nbsp;5&#34;</span><span class="op" id="7282881">}</span><span class="op" id="7282882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7282888">if</span>&nbsp;<span class="builtinfunc" id="7282891">len</span><span class="op" id="7282894">(</span><span class="ident" id="7282895">f</span><span class="op" id="7282896">.</span><span class="ident" id="7282897">Comments</span><span class="op" id="7282905">)</span>&nbsp;<span class="op" id="7282907">!=</span>&nbsp;<span class="builtinfunc" id="7282910">len</span><span class="op" id="7282913">(</span><span class="ident" id="7282914">expected</span><span class="op" id="7282922">)</span>&nbsp;<span class="op" id="7282924">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7282928">t</span><span class="op" id="7282929">.</span><span class="ident" id="7282930">Fatalf</span><span class="op" id="7282936">(</span><span class="string" id="7282937">&#34;got&nbsp;%d&nbsp;comment&nbsp;groups;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7282973">,</span>&nbsp;<span class="builtinfunc" id="7282975">len</span><span class="op" id="7282978">(</span><span class="ident" id="7282979">f</span><span class="op" id="7282980">.</span><span class="ident" id="7282981">Comments</span><span class="op" id="7282989">)</span><span class="op" id="7282990">,</span>&nbsp;<span class="builtinfunc" id="7282992">len</span><span class="op" id="7282995">(</span><span class="ident" id="7282996">expected</span><span class="op" id="7283004">)</span><span class="op" id="7283005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283011">for</span>&nbsp;<span class="ident" id="7283015">i</span><span class="op" id="7283016">,</span>&nbsp;<span class="ident" id="7283018">exp</span>&nbsp;<span class="op" id="7283022">:=</span>&nbsp;<span class="keyword" id="7283025">range</span>&nbsp;<span class="ident" id="7283031">expected</span>&nbsp;<span class="op" id="7283040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283044">got</span>&nbsp;<span class="op" id="7283048">:=</span>&nbsp;<span class="ident" id="7283051">f</span><span class="op" id="7283052">.</span><span class="ident" id="7283053">Comments</span><span class="op" id="7283061">[</span><span class="ident" id="7283062">i</span><span class="op" id="7283063">]</span><span class="op" id="7283064">.</span><span class="ident" id="7283065">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283072">if</span>&nbsp;<span class="builtinfunc" id="7283075">len</span><span class="op" id="7283078">(</span><span class="ident" id="7283079">got</span><span class="op" id="7283082">)</span>&nbsp;<span class="op" id="7283084">!=</span>&nbsp;<span class="builtinfunc" id="7283087">len</span><span class="op" id="7283090">(</span><span class="ident" id="7283091">exp</span><span class="op" id="7283094">)</span>&nbsp;<span class="op" id="7283096">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283101">t</span><span class="op" id="7283102">.</span><span class="ident" id="7283103">Errorf</span><span class="op" id="7283109">(</span><span class="string" id="7283110">&#34;got&nbsp;%d&nbsp;comments&nbsp;in&nbsp;group&nbsp;%d;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7283152">,</span>&nbsp;<span class="builtinfunc" id="7283154">len</span><span class="op" id="7283157">(</span><span class="ident" id="7283158">got</span><span class="op" id="7283161">)</span><span class="op" id="7283162">,</span>&nbsp;<span class="ident" id="7283164">i</span><span class="op" id="7283165">,</span>&nbsp;<span class="builtinfunc" id="7283167">len</span><span class="op" id="7283170">(</span><span class="ident" id="7283171">exp</span><span class="op" id="7283174">)</span><span class="op" id="7283175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283180">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283195">for</span>&nbsp;<span class="ident" id="7283199">j</span><span class="op" id="7283200">,</span>&nbsp;<span class="ident" id="7283202">exp</span>&nbsp;<span class="op" id="7283206">:=</span>&nbsp;<span class="keyword" id="7283209">range</span>&nbsp;<span class="ident" id="7283215">exp</span>&nbsp;<span class="op" id="7283219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283224">got</span>&nbsp;<span class="op" id="7283228">:=</span>&nbsp;<span class="ident" id="7283231">got</span><span class="op" id="7283234">[</span><span class="ident" id="7283235">j</span><span class="op" id="7283236">]</span><span class="op" id="7283237">.</span><span class="ident" id="7283238">Text</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283246">if</span>&nbsp;<span class="ident" id="7283249">got</span>&nbsp;<span class="op" id="7283253">!=</span>&nbsp;<span class="ident" id="7283256">exp</span>&nbsp;<span class="op" id="7283260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283266">t</span><span class="op" id="7283267">.</span><span class="ident" id="7283268">Errorf</span><span class="op" id="7283274">(</span><span class="string" id="7283275">&#34;got&nbsp;%q&nbsp;in&nbsp;group&nbsp;%d;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7283308">,</span>&nbsp;<span class="ident" id="7283310">got</span><span class="op" id="7283313">,</span>&nbsp;<span class="ident" id="7283315">i</span><span class="op" id="7283316">,</span>&nbsp;<span class="ident" id="7283318">exp</span><span class="op" id="7283321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283333">}</span><br>
<span class="lineno">375</span><span class="op" id="7283335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7283338">func</span>&nbsp;<span class="ident" id="7283343">getField</span><span class="op" id="7283351">(</span><span class="ident" id="7283352">file</span>&nbsp;<span class="op" id="7283357">*</span><span class="ident" id="7283358">ast</span><span class="op" id="7283361">.</span><span class="ident" id="7283362">File</span><span class="op" id="7283366">,</span>&nbsp;<span class="ident" id="7283368">fieldname</span>&nbsp;<span class="builtintype" id="7283378">string</span><span class="op" id="7283384">)</span>&nbsp;<span class="op" id="7283386">*</span><span class="ident" id="7283387">ast</span><span class="op" id="7283390">.</span><span class="ident" id="7283391">Field</span>&nbsp;<span class="op" id="7283397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283400">parts</span>&nbsp;<span class="op" id="7283406">:=</span>&nbsp;<span class="ident" id="7283409">strings</span><span class="op" id="7283416">.</span><span class="ident" id="7283417">Split</span><span class="op" id="7283422">(</span><span class="ident" id="7283423">fieldname</span><span class="op" id="7283432">,</span>&nbsp;<span class="string" id="7283434">&#34;.&#34;</span><span class="op" id="7283437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283440">for</span>&nbsp;<span class="ident" id="7283444">_</span><span class="op" id="7283445">,</span>&nbsp;<span class="ident" id="7283447">d</span>&nbsp;<span class="op" id="7283449">:=</span>&nbsp;<span class="keyword" id="7283452">range</span>&nbsp;<span class="ident" id="7283458">file</span><span class="op" id="7283462">.</span><span class="ident" id="7283463">Decls</span>&nbsp;<span class="op" id="7283469">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283473">if</span>&nbsp;<span class="ident" id="7283476">d</span><span class="op" id="7283477">,</span>&nbsp;<span class="ident" id="7283479">ok</span>&nbsp;<span class="op" id="7283482">:=</span>&nbsp;<span class="ident" id="7283485">d</span><span class="op" id="7283486">.</span><span class="op" id="7283487">(</span><span class="op" id="7283488">*</span><span class="ident" id="7283489">ast</span><span class="op" id="7283492">.</span><span class="ident" id="7283493">GenDecl</span><span class="op" id="7283500">)</span><span class="op" id="7283501">;</span>&nbsp;<span class="ident" id="7283503">ok</span>&nbsp;<span class="op" id="7283506">&amp;&amp;</span>&nbsp;<span class="ident" id="7283509">d</span><span class="op" id="7283510">.</span><span class="ident" id="7283511">Tok</span>&nbsp;<span class="op" id="7283515">==</span>&nbsp;<span class="ident" id="7283518">token</span><span class="op" id="7283523">.</span><span class="ident" id="7283524">TYPE</span>&nbsp;<span class="op" id="7283529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283534">for</span>&nbsp;<span class="ident" id="7283538">_</span><span class="op" id="7283539">,</span>&nbsp;<span class="ident" id="7283541">s</span>&nbsp;<span class="op" id="7283543">:=</span>&nbsp;<span class="keyword" id="7283546">range</span>&nbsp;<span class="ident" id="7283552">d</span><span class="op" id="7283553">.</span><span class="ident" id="7283554">Specs</span>&nbsp;<span class="op" id="7283560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283566">if</span>&nbsp;<span class="ident" id="7283569">s</span><span class="op" id="7283570">,</span>&nbsp;<span class="ident" id="7283572">ok</span>&nbsp;<span class="op" id="7283575">:=</span>&nbsp;<span class="ident" id="7283578">s</span><span class="op" id="7283579">.</span><span class="op" id="7283580">(</span><span class="op" id="7283581">*</span><span class="ident" id="7283582">ast</span><span class="op" id="7283585">.</span><span class="ident" id="7283586">TypeSpec</span><span class="op" id="7283594">)</span><span class="op" id="7283595">;</span>&nbsp;<span class="ident" id="7283597">ok</span>&nbsp;<span class="op" id="7283600">&amp;&amp;</span>&nbsp;<span class="ident" id="7283603">s</span><span class="op" id="7283604">.</span><span class="ident" id="7283605">Name</span><span class="op" id="7283609">.</span><span class="ident" id="7283610">Name</span>&nbsp;<span class="op" id="7283615">==</span>&nbsp;<span class="ident" id="7283618">parts</span><span class="op" id="7283623">[</span><span class="num" id="7283624">0</span><span class="op" id="7283625">]</span>&nbsp;<span class="op" id="7283627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283634">if</span>&nbsp;<span class="ident" id="7283637">s</span><span class="op" id="7283638">,</span>&nbsp;<span class="ident" id="7283640">ok</span>&nbsp;<span class="op" id="7283643">:=</span>&nbsp;<span class="ident" id="7283646">s</span><span class="op" id="7283647">.</span><span class="ident" id="7283648">Type</span><span class="op" id="7283652">.</span><span class="op" id="7283653">(</span><span class="op" id="7283654">*</span><span class="ident" id="7283655">ast</span><span class="op" id="7283658">.</span><span class="ident" id="7283659">StructType</span><span class="op" id="7283669">)</span><span class="op" id="7283670">;</span>&nbsp;<span class="ident" id="7283672">ok</span>&nbsp;<span class="op" id="7283675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283683">for</span>&nbsp;<span class="ident" id="7283687">_</span><span class="op" id="7283688">,</span>&nbsp;<span class="ident" id="7283690">f</span>&nbsp;<span class="op" id="7283692">:=</span>&nbsp;<span class="keyword" id="7283695">range</span>&nbsp;<span class="ident" id="7283701">s</span><span class="op" id="7283702">.</span><span class="ident" id="7283703">Fields</span><span class="op" id="7283709">.</span><span class="ident" id="7283710">List</span>&nbsp;<span class="op" id="7283715">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283724">for</span>&nbsp;<span class="ident" id="7283728">_</span><span class="op" id="7283729">,</span>&nbsp;<span class="ident" id="7283731">name</span>&nbsp;<span class="op" id="7283736">:=</span>&nbsp;<span class="keyword" id="7283739">range</span>&nbsp;<span class="ident" id="7283745">f</span><span class="op" id="7283746">.</span><span class="ident" id="7283747">Names</span>&nbsp;<span class="op" id="7283753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283763">if</span>&nbsp;<span class="ident" id="7283766">name</span><span class="op" id="7283770">.</span><span class="ident" id="7283771">Name</span>&nbsp;<span class="op" id="7283776">==</span>&nbsp;<span class="ident" id="7283779">parts</span><span class="op" id="7283784">[</span><span class="num" id="7283785">1</span><span class="op" id="7283786">]</span>&nbsp;<span class="op" id="7283788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283799">return</span>&nbsp;<span class="ident" id="7283806">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283825">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283855">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283861">return</span>&nbsp;<span class="ident" id="7283868">nil</span><br>
<span class="lineno"></span><span class="op" id="7283872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7283875">//&nbsp;Don&#39;t&nbsp;use&nbsp;ast.CommentGroup.Text()&nbsp;-&nbsp;we&nbsp;want&nbsp;to&nbsp;see&nbsp;exact&nbsp;comment&nbsp;text.</span><br>
<span class="lineno">400</span><span class="keyword" id="7283949">func</span>&nbsp;<span class="ident" id="7283954">commentText</span><span class="op" id="7283965">(</span><span class="ident" id="7283966">c</span>&nbsp;<span class="op" id="7283968">*</span><span class="ident" id="7283969">ast</span><span class="op" id="7283972">.</span><span class="ident" id="7283973">CommentGroup</span><span class="op" id="7283985">)</span>&nbsp;<span class="builtintype" id="7283987">string</span>&nbsp;<span class="op" id="7283994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283997">var</span>&nbsp;<span class="ident" id="7284001">buf</span>&nbsp;<span class="ident" id="7284005">bytes</span><span class="op" id="7284010">.</span><span class="ident" id="7284011">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284019">if</span>&nbsp;<span class="ident" id="7284022">c</span>&nbsp;<span class="op" id="7284024">!=</span>&nbsp;<span class="ident" id="7284027">nil</span>&nbsp;<span class="op" id="7284031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284035">for</span>&nbsp;<span class="ident" id="7284039">_</span><span class="op" id="7284040">,</span>&nbsp;<span class="ident" id="7284042">c</span>&nbsp;<span class="op" id="7284044">:=</span>&nbsp;<span class="keyword" id="7284047">range</span>&nbsp;<span class="ident" id="7284053">c</span><span class="op" id="7284054">.</span><span class="ident" id="7284055">List</span>&nbsp;<span class="op" id="7284060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284065">buf</span><span class="op" id="7284068">.</span><span class="ident" id="7284069">WriteString</span><span class="op" id="7284080">(</span><span class="ident" id="7284081">c</span><span class="op" id="7284082">.</span><span class="ident" id="7284083">Text</span><span class="op" id="7284087">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284097">return</span>&nbsp;<span class="ident" id="7284104">buf</span><span class="op" id="7284107">.</span><span class="ident" id="7284108">String</span><span class="op" id="7284114">(</span><span class="op" id="7284115">)</span><br>
<span class="lineno"></span><span class="op" id="7284117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="7284120">func</span>&nbsp;<span class="ident" id="7284125">checkFieldComments</span><span class="op" id="7284143">(</span><span class="ident" id="7284144">t</span>&nbsp;<span class="op" id="7284146">*</span><span class="ident" id="7284147">testing</span><span class="op" id="7284154">.</span><span class="ident" id="7284155">T</span><span class="op" id="7284156">,</span>&nbsp;<span class="ident" id="7284158">file</span>&nbsp;<span class="op" id="7284163">*</span><span class="ident" id="7284164">ast</span><span class="op" id="7284167">.</span><span class="ident" id="7284168">File</span><span class="op" id="7284172">,</span>&nbsp;<span class="ident" id="7284174">fieldname</span><span class="op" id="7284183">,</span>&nbsp;<span class="ident" id="7284185">lead</span><span class="op" id="7284189">,</span>&nbsp;<span class="ident" id="7284191">line</span>&nbsp;<span class="builtintype" id="7284196">string</span><span class="op" id="7284202">)</span>&nbsp;<span class="op" id="7284204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284207">f</span>&nbsp;<span class="op" id="7284209">:=</span>&nbsp;<span class="ident" id="7284212">getField</span><span class="op" id="7284220">(</span><span class="ident" id="7284221">file</span><span class="op" id="7284225">,</span>&nbsp;<span class="ident" id="7284227">fieldname</span><span class="op" id="7284236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284239">if</span>&nbsp;<span class="ident" id="7284242">f</span>&nbsp;<span class="op" id="7284244">==</span>&nbsp;<span class="ident" id="7284247">nil</span>&nbsp;<span class="op" id="7284251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284255">t</span><span class="op" id="7284256">.</span><span class="ident" id="7284257">Fatalf</span><span class="op" id="7284263">(</span><span class="string" id="7284264">&#34;field&nbsp;not&nbsp;found:&nbsp;%s&#34;</span><span class="op" id="7284285">,</span>&nbsp;<span class="ident" id="7284287">fieldname</span><span class="op" id="7284296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284299">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284302">if</span>&nbsp;<span class="ident" id="7284305">got</span>&nbsp;<span class="op" id="7284309">:=</span>&nbsp;<span class="ident" id="7284312">commentText</span><span class="op" id="7284323">(</span><span class="ident" id="7284324">f</span><span class="op" id="7284325">.</span><span class="ident" id="7284326">Doc</span><span class="op" id="7284329">)</span><span class="op" id="7284330">;</span>&nbsp;<span class="ident" id="7284332">got</span>&nbsp;<span class="op" id="7284336">!=</span>&nbsp;<span class="ident" id="7284339">lead</span>&nbsp;<span class="op" id="7284344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284348">t</span><span class="op" id="7284349">.</span><span class="ident" id="7284350">Errorf</span><span class="op" id="7284356">(</span><span class="string" id="7284357">&#34;got&nbsp;lead&nbsp;comment&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7284391">,</span>&nbsp;<span class="ident" id="7284393">got</span><span class="op" id="7284396">,</span>&nbsp;<span class="ident" id="7284398">lead</span><span class="op" id="7284402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284408">if</span>&nbsp;<span class="ident" id="7284411">got</span>&nbsp;<span class="op" id="7284415">:=</span>&nbsp;<span class="ident" id="7284418">commentText</span><span class="op" id="7284429">(</span><span class="ident" id="7284430">f</span><span class="op" id="7284431">.</span><span class="ident" id="7284432">Comment</span><span class="op" id="7284439">)</span><span class="op" id="7284440">;</span>&nbsp;<span class="ident" id="7284442">got</span>&nbsp;<span class="op" id="7284446">!=</span>&nbsp;<span class="ident" id="7284449">line</span>&nbsp;<span class="op" id="7284454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284458">t</span><span class="op" id="7284459">.</span><span class="ident" id="7284460">Errorf</span><span class="op" id="7284466">(</span><span class="string" id="7284467">&#34;got&nbsp;line&nbsp;comment&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7284501">,</span>&nbsp;<span class="ident" id="7284503">got</span><span class="op" id="7284506">,</span>&nbsp;<span class="ident" id="7284508">line</span><span class="op" id="7284512">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284515">}</span><br>
<span class="lineno"></span><span class="op" id="7284517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7284520">func</span>&nbsp;<span class="ident" id="7284525">TestLeadAndLineComments</span><span class="op" id="7284548">(</span><span class="ident" id="7284549">t</span>&nbsp;<span class="op" id="7284551">*</span><span class="ident" id="7284552">testing</span><span class="op" id="7284559">.</span><span class="ident" id="7284560">T</span><span class="op" id="7284561">)</span>&nbsp;<span class="op" id="7284563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284566">f</span><span class="op" id="7284567">,</span>&nbsp;<span class="ident" id="7284569">err</span>&nbsp;<span class="op" id="7284573">:=</span>&nbsp;<span class="ident" id="7284576">ParseFile</span><span class="op" id="7284585">(</span><span class="ident" id="7284586">fset</span><span class="op" id="7284590">,</span>&nbsp;<span class="string" id="7284592">&#34;&#34;</span><span class="op" id="7284594">,</span>&nbsp;<span class="string" id="7284596">`<br>
<span class="lineno">425</span>package&nbsp;p<br>
<span class="lineno"></span>type&nbsp;T&nbsp;struct&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*/<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspF1&nbsp;int&nbsp;&nbsp;/*&nbsp;F1&nbsp;*/&nbsp;//&nbsp;line&nbsp;comment<br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;F2&nbsp;lead<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspF2&nbsp;int&nbsp;&nbsp;//&nbsp;F2&nbsp;line&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;f3&nbsp;lead&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspf3&nbsp;int&nbsp;&nbsp;//&nbsp;f3&nbsp;line&nbsp;comment<br>
<span class="lineno">435</span>}<br>
<span class="lineno"></span>`</span><span class="op" id="7284788">,</span>&nbsp;<span class="ident" id="7284790">ParseComments</span><span class="op" id="7284803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284806">if</span>&nbsp;<span class="ident" id="7284809">err</span>&nbsp;<span class="op" id="7284813">!=</span>&nbsp;<span class="ident" id="7284816">nil</span>&nbsp;<span class="op" id="7284820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284824">t</span><span class="op" id="7284825">.</span><span class="ident" id="7284826">Fatal</span><span class="op" id="7284831">(</span><span class="ident" id="7284832">err</span><span class="op" id="7284835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284838">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284841">checkFieldComments</span><span class="op" id="7284859">(</span><span class="ident" id="7284860">t</span><span class="op" id="7284861">,</span>&nbsp;<span class="ident" id="7284863">f</span><span class="op" id="7284864">,</span>&nbsp;<span class="string" id="7284866">&#34;T.F1&#34;</span><span class="op" id="7284872">,</span>&nbsp;<span class="string" id="7284874">&#34;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*///&#34;</span><span class="op" id="7284899">,</span>&nbsp;<span class="string" id="7284901">&#34;/*&nbsp;F1&nbsp;*///&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7284926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284929">checkFieldComments</span><span class="op" id="7284947">(</span><span class="ident" id="7284948">t</span><span class="op" id="7284949">,</span>&nbsp;<span class="ident" id="7284951">f</span><span class="op" id="7284952">,</span>&nbsp;<span class="string" id="7284954">&#34;T.F2&#34;</span><span class="op" id="7284960">,</span>&nbsp;<span class="string" id="7284962">&#34;//&nbsp;F2&nbsp;lead//&nbsp;comment&#34;</span><span class="op" id="7284984">,</span>&nbsp;<span class="string" id="7284986">&#34;//&nbsp;F2&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7285006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285009">checkFieldComments</span><span class="op" id="7285027">(</span><span class="ident" id="7285028">t</span><span class="op" id="7285029">,</span>&nbsp;<span class="ident" id="7285031">f</span><span class="op" id="7285032">,</span>&nbsp;<span class="string" id="7285034">&#34;T.f3&#34;</span><span class="op" id="7285040">,</span>&nbsp;<span class="string" id="7285042">&#34;//&nbsp;f3&nbsp;lead&nbsp;comment&#34;</span><span class="op" id="7285062">,</span>&nbsp;<span class="string" id="7285064">&#34;//&nbsp;f3&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7285084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285087">ast</span><span class="op" id="7285090">.</span><span class="ident" id="7285091">FileExports</span><span class="op" id="7285102">(</span><span class="ident" id="7285103">f</span><span class="op" id="7285104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285107">checkFieldComments</span><span class="op" id="7285125">(</span><span class="ident" id="7285126">t</span><span class="op" id="7285127">,</span>&nbsp;<span class="ident" id="7285129">f</span><span class="op" id="7285130">,</span>&nbsp;<span class="string" id="7285132">&#34;T.F1&#34;</span><span class="op" id="7285138">,</span>&nbsp;<span class="string" id="7285140">&#34;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*///&#34;</span><span class="op" id="7285165">,</span>&nbsp;<span class="string" id="7285167">&#34;/*&nbsp;F1&nbsp;*///&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7285192">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285195">checkFieldComments</span><span class="op" id="7285213">(</span><span class="ident" id="7285214">t</span><span class="op" id="7285215">,</span>&nbsp;<span class="ident" id="7285217">f</span><span class="op" id="7285218">,</span>&nbsp;<span class="string" id="7285220">&#34;T.F2&#34;</span><span class="op" id="7285226">,</span>&nbsp;<span class="string" id="7285228">&#34;//&nbsp;F2&nbsp;lead//&nbsp;comment&#34;</span><span class="op" id="7285250">,</span>&nbsp;<span class="string" id="7285252">&#34;//&nbsp;F2&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7285272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7285275">if</span>&nbsp;<span class="ident" id="7285278">getField</span><span class="op" id="7285286">(</span><span class="ident" id="7285287">f</span><span class="op" id="7285288">,</span>&nbsp;<span class="string" id="7285290">&#34;T.f3&#34;</span><span class="op" id="7285296">)</span>&nbsp;<span class="op" id="7285298">!=</span>&nbsp;<span class="ident" id="7285301">nil</span>&nbsp;<span class="op" id="7285305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285309">t</span><span class="op" id="7285310">.</span><span class="ident" id="7285311">Error</span><span class="op" id="7285316">(</span><span class="string" id="7285317">&#34;not&nbsp;expected&nbsp;to&nbsp;find&nbsp;T.f3&#34;</span><span class="op" id="7285344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7285347">}</span><br>
<span class="lineno"></span><span class="op" id="7285349">}</span>
</div>
</body>
</html>
