<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1494207">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1494262">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1494316">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1494367">package</span>&nbsp;<span class="ident" id="1494375">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1494381">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1494447">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1494501">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1494552">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1494607">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1494637">//</span><br>
<span class="lineno"></span><span class="comment" id="1494640">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1494696">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1494765">//</span><br>
<span class="lineno"></span><span class="comment" id="1494768">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1494827">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1494883">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1494940">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1494957">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1495013">//</span><br>
<span class="lineno">25</span><span class="comment" id="1495016">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1495058">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="1495118">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="1495132">//</span><br>
<span class="lineno"></span><span class="comment" id="1495135">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="1495153">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="1495218">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="1495281">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="1495315">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="1495349">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="1495383">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="1495435">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="1495475">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1495530">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="1495585">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="1495642">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1495695">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1495749">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="1495783">//</span><br>
<span class="lineno"></span><span class="comment" id="1495786">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="1495837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="1495884">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1495908">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="1495969">//</span><br>
<span class="lineno">50</span><span class="comment" id="1495972">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1495994">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1496014">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1496034">func</span>&nbsp;<span class="ident" id="1496039">Jn</span><span class="op" id="1496041">(</span><span class="ident" id="1496042">n</span>&nbsp;<span class="builtintype" id="1496044">int</span><span class="op" id="1496047">,</span>&nbsp;<span class="ident" id="1496049">x</span>&nbsp;<span class="builtintype" id="1496051">float64</span><span class="op" id="1496058">)</span>&nbsp;<span class="builtintype" id="1496060">float64</span>&nbsp;<span class="op" id="1496068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496071">const</span>&nbsp;<span class="op" id="1496077">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496081">TwoM29</span>&nbsp;<span class="op" id="1496088">=</span>&nbsp;<span class="num" id="1496090">1.0</span>&nbsp;<span class="op" id="1496094">/</span>&nbsp;<span class="op" id="1496096">(</span><span class="num" id="1496097">1</span>&nbsp;<span class="op" id="1496099">&lt;&lt;</span>&nbsp;<span class="num" id="1496102">29</span><span class="op" id="1496104">)</span>&nbsp;<span class="comment" id="1496106">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496137">Two302</span>&nbsp;<span class="op" id="1496144">=</span>&nbsp;<span class="num" id="1496146">1</span>&nbsp;<span class="op" id="1496148">&lt;&lt;</span>&nbsp;<span class="num" id="1496151">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1496162">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496195">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496213">switch</span>&nbsp;<span class="op" id="1496220">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496223">case</span>&nbsp;<span class="ident" id="1496228"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1496233">(</span><span class="ident" id="1496234"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1496235">)</span><span class="op" id="1496236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496240">return</span>&nbsp;<span class="ident" id="1496247"><a href="/math/jn.go.html#1496049">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496250">case</span>&nbsp;<span class="ident" id="1496255"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1496260">(</span><span class="ident" id="1496261"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1496262">,</span>&nbsp;<span class="num" id="1496264">0</span><span class="op" id="1496265">)</span><span class="op" id="1496266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496270">return</span>&nbsp;<span class="num" id="1496277">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496280">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496283">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496346">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496377">if</span>&nbsp;<span class="ident" id="1496380"><a href="/math/jn.go.html#1496042">n</a></span>&nbsp;<span class="op" id="1496382">==</span>&nbsp;<span class="num" id="1496385">0</span>&nbsp;<span class="op" id="1496387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496391">return</span>&nbsp;<span class="ident" id="1496398"><a href="/math/j0.go.html#1469585">J0</a></span><span class="op" id="1496400">(</span><span class="ident" id="1496401"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1496402">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496408">if</span>&nbsp;<span class="ident" id="1496411"><a href="/math/jn.go.html#1496049">x</a></span>&nbsp;<span class="op" id="1496413">==</span>&nbsp;<span class="num" id="1496416">0</span>&nbsp;<span class="op" id="1496418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496422">return</span>&nbsp;<span class="num" id="1496429">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496435">if</span>&nbsp;<span class="ident" id="1496438"><a href="/math/jn.go.html#1496042">n</a></span>&nbsp;<span class="op" id="1496440">&lt;</span>&nbsp;<span class="num" id="1496442">0</span>&nbsp;<span class="op" id="1496444">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496448"><a href="/math/jn.go.html#1496042">n</a></span><span class="op" id="1496449">,</span>&nbsp;<span class="ident" id="1496451"><a href="/math/jn.go.html#1496049">x</a></span>&nbsp;<span class="op" id="1496453">=</span>&nbsp;<span class="op" id="1496455">-</span><span class="ident" id="1496456"><a href="/math/jn.go.html#1496042">n</a></span><span class="op" id="1496457">,</span>&nbsp;<span class="op" id="1496459">-</span><span class="ident" id="1496460"><a href="/math/jn.go.html#1496049">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496466">if</span>&nbsp;<span class="ident" id="1496469"><a href="/math/jn.go.html#1496042">n</a></span>&nbsp;<span class="op" id="1496471">==</span>&nbsp;<span class="num" id="1496474">1</span>&nbsp;<span class="op" id="1496476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496480">return</span>&nbsp;<span class="ident" id="1496487"><a href="/math/j1.go.html#1483558">J1</a></span><span class="op" id="1496489">(</span><span class="ident" id="1496490"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1496491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496494">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496497">sign</span>&nbsp;<span class="op" id="1496502">:=</span>&nbsp;<span class="ident" id="1496505">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496512">if</span>&nbsp;<span class="ident" id="1496515"><a href="/math/jn.go.html#1496049">x</a></span>&nbsp;<span class="op" id="1496517">&lt;</span>&nbsp;<span class="num" id="1496519">0</span>&nbsp;<span class="op" id="1496521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496525"><a href="/math/jn.go.html#1496049">x</a></span>&nbsp;<span class="op" id="1496527">=</span>&nbsp;<span class="op" id="1496529">-</span><span class="ident" id="1496530"><a href="/math/jn.go.html#1496049">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496534">if</span>&nbsp;<span class="ident" id="1496537"><a href="/math/jn.go.html#1496042">n</a></span><span class="op" id="1496538">&amp;</span><span class="num" id="1496539">1</span>&nbsp;<span class="op" id="1496541">==</span>&nbsp;<span class="num" id="1496544">1</span>&nbsp;<span class="op" id="1496546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496551"><a href="/math/jn.go.html#1496497">sign</a></span>&nbsp;<span class="op" id="1496556">=</span>&nbsp;<span class="ident" id="1496558">true</span>&nbsp;<span class="comment" id="1496563">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496595">var</span>&nbsp;<span class="ident" id="1496599">b</span>&nbsp;<span class="builtintype" id="1496601">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496610">if</span>&nbsp;<span class="builtintype" id="1496613">float64</span><span class="op" id="1496620">(</span><span class="ident" id="1496621"><a href="/math/jn.go.html#1496042">n</a></span><span class="op" id="1496622">)</span>&nbsp;<span class="op" id="1496624">&lt;=</span>&nbsp;<span class="ident" id="1496627"><a href="/math/jn.go.html#1496049">x</a></span>&nbsp;<span class="op" id="1496629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496633">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496681">if</span>&nbsp;<span class="ident" id="1496684"><a href="/math/jn.go.html#1496049">x</a></span>&nbsp;<span class="op" id="1496686">&gt;=</span>&nbsp;<span class="ident" id="1496689"><a href="/math/jn.go.html#1496137">Two302</a></span>&nbsp;<span class="op" id="1496696">{</span>&nbsp;<span class="comment" id="1496698">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496716">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496734">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496789">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496844">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496883">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496940">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496946">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1497002">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1497056">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1497104">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1497152">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1497200">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497249">var</span>&nbsp;<span class="ident" id="1497253">temp</span>&nbsp;<span class="builtintype" id="1497258">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497269">switch</span>&nbsp;<span class="ident" id="1497276"><a href="/math/jn.go.html#1496042">n</a></span>&nbsp;<span class="op" id="1497278">&amp;</span>&nbsp;<span class="num" id="1497280">3</span>&nbsp;<span class="op" id="1497282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497287">case</span>&nbsp;<span class="num" id="1497292">0</span><span class="op" id="1497293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497299"><a href="/math/jn.go.html#1497253">temp</a></span>&nbsp;<span class="op" id="1497304">=</span>&nbsp;<span class="ident" id="1497306"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1497309">(</span><span class="ident" id="1497310"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497311">)</span>&nbsp;<span class="op" id="1497313">+</span>&nbsp;<span class="ident" id="1497315"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1497318">(</span><span class="ident" id="1497319"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497325">case</span>&nbsp;<span class="num" id="1497330">1</span><span class="op" id="1497331">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497337"><a href="/math/jn.go.html#1497253">temp</a></span>&nbsp;<span class="op" id="1497342">=</span>&nbsp;<span class="op" id="1497344">-</span><span class="ident" id="1497345"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1497348">(</span><span class="ident" id="1497349"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497350">)</span>&nbsp;<span class="op" id="1497352">+</span>&nbsp;<span class="ident" id="1497354"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1497357">(</span><span class="ident" id="1497358"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497364">case</span>&nbsp;<span class="num" id="1497369">2</span><span class="op" id="1497370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497376"><a href="/math/jn.go.html#1497253">temp</a></span>&nbsp;<span class="op" id="1497381">=</span>&nbsp;<span class="op" id="1497383">-</span><span class="ident" id="1497384"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1497387">(</span><span class="ident" id="1497388"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497389">)</span>&nbsp;<span class="op" id="1497391">-</span>&nbsp;<span class="ident" id="1497393"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1497396">(</span><span class="ident" id="1497397"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497403">case</span>&nbsp;<span class="num" id="1497408">3</span><span class="op" id="1497409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497415"><a href="/math/jn.go.html#1497253">temp</a></span>&nbsp;<span class="op" id="1497420">=</span>&nbsp;<span class="ident" id="1497422"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1497425">(</span><span class="ident" id="1497426"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497427">)</span>&nbsp;<span class="op" id="1497429">-</span>&nbsp;<span class="ident" id="1497431"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1497434">(</span><span class="ident" id="1497435"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497436">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497446"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1497448">=</span>&nbsp;<span class="op" id="1497450">(</span><span class="num" id="1497451">1</span>&nbsp;<span class="op" id="1497453">/</span>&nbsp;<span class="ident" id="1497455"><a href="/math/const.go.html#1430893">SqrtPi</a></span><span class="op" id="1497461">)</span>&nbsp;<span class="op" id="1497463">*</span>&nbsp;<span class="ident" id="1497465"><a href="/math/jn.go.html#1497253">temp</a></span>&nbsp;<span class="op" id="1497470">/</span>&nbsp;<span class="ident" id="1497472"><a href="/math/sqrt.go.html#1548013">Sqrt</a></span><span class="op" id="1497476">(</span><span class="ident" id="1497477"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497482">}</span>&nbsp;<span class="keyword" id="1497484">else</span>&nbsp;<span class="op" id="1497489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497494"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1497496">=</span>&nbsp;<span class="ident" id="1497498"><a href="/math/j1.go.html#1483558">J1</a></span><span class="op" id="1497500">(</span><span class="ident" id="1497501"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497507">for</span>&nbsp;<span class="ident" id="1497511">i</span><span class="op" id="1497512">,</span>&nbsp;<span class="ident" id="1497514">a</span>&nbsp;<span class="op" id="1497516">:=</span>&nbsp;<span class="num" id="1497519">1</span><span class="op" id="1497520">,</span>&nbsp;<span class="ident" id="1497522"><a href="/math/j0.go.html#1469585">J0</a></span><span class="op" id="1497524">(</span><span class="ident" id="1497525"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497526">)</span><span class="op" id="1497527">;</span>&nbsp;<span class="ident" id="1497529"><a href="/math/jn.go.html#1497511">i</a></span>&nbsp;<span class="op" id="1497531">&lt;</span>&nbsp;<span class="ident" id="1497533"><a href="/math/jn.go.html#1496042">n</a></span><span class="op" id="1497534">;</span>&nbsp;<span class="ident" id="1497536"><a href="/math/jn.go.html#1497511">i</a></span><span class="op" id="1497537">++</span>&nbsp;<span class="op" id="1497540">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497546"><a href="/math/jn.go.html#1497514">a</a></span><span class="op" id="1497547">,</span>&nbsp;<span class="ident" id="1497549"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1497551">=</span>&nbsp;<span class="ident" id="1497553"><a href="/math/jn.go.html#1496599">b</a></span><span class="op" id="1497554">,</span>&nbsp;<span class="ident" id="1497556"><a href="/math/jn.go.html#1496599">b</a></span><span class="op" id="1497557">*</span><span class="op" id="1497558">(</span><span class="builtintype" id="1497559">float64</span><span class="op" id="1497566">(</span><span class="ident" id="1497567"><a href="/math/jn.go.html#1497511">i</a></span><span class="op" id="1497568">+</span><span class="ident" id="1497569"><a href="/math/jn.go.html#1497511">i</a></span><span class="op" id="1497570">)</span><span class="op" id="1497571">/</span><span class="ident" id="1497572"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1497573">)</span><span class="op" id="1497574">-</span><span class="ident" id="1497575"><a href="/math/jn.go.html#1497514">a</a></span>&nbsp;<span class="comment" id="1497577">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497606">}</span>&nbsp;<span class="keyword" id="1497608">else</span>&nbsp;<span class="op" id="1497613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497617">if</span>&nbsp;<span class="ident" id="1497620"><a href="/math/jn.go.html#1496049">x</a></span>&nbsp;<span class="op" id="1497622">&lt;</span>&nbsp;<span class="ident" id="1497624"><a href="/math/jn.go.html#1496081">TwoM29</a></span>&nbsp;<span class="op" id="1497631">{</span>&nbsp;<span class="comment" id="1497633">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1497650">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1497711">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497748">if</span>&nbsp;<span class="ident" id="1497751"><a href="/math/jn.go.html#1496042">n</a></span>&nbsp;<span class="op" id="1497753">&gt;</span>&nbsp;<span class="num" id="1497755">33</span>&nbsp;<span class="op" id="1497758">{</span>&nbsp;<span class="comment" id="1497760">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497777"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1497779">=</span>&nbsp;<span class="num" id="1497781">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497786">}</span>&nbsp;<span class="keyword" id="1497788">else</span>&nbsp;<span class="op" id="1497793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497799">temp</span>&nbsp;<span class="op" id="1497804">:=</span>&nbsp;<span class="ident" id="1497807"><a href="/math/jn.go.html#1496049">x</a></span>&nbsp;<span class="op" id="1497809">*</span>&nbsp;<span class="num" id="1497811">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497819"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1497821">=</span>&nbsp;<span class="ident" id="1497823"><a href="/math/jn.go.html#1497799">temp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497832">a</span>&nbsp;<span class="op" id="1497834">:=</span>&nbsp;<span class="num" id="1497837">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497845">for</span>&nbsp;<span class="ident" id="1497849">i</span>&nbsp;<span class="op" id="1497851">:=</span>&nbsp;<span class="num" id="1497854">2</span><span class="op" id="1497855">;</span>&nbsp;<span class="ident" id="1497857"><a href="/math/jn.go.html#1497849">i</a></span>&nbsp;<span class="op" id="1497859">&lt;=</span>&nbsp;<span class="ident" id="1497862"><a href="/math/jn.go.html#1496042">n</a></span><span class="op" id="1497863">;</span>&nbsp;<span class="ident" id="1497865"><a href="/math/jn.go.html#1497849">i</a></span><span class="op" id="1497866">++</span>&nbsp;<span class="op" id="1497869">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497876"><a href="/math/jn.go.html#1497832">a</a></span>&nbsp;<span class="op" id="1497878">*=</span>&nbsp;<span class="builtintype" id="1497881">float64</span><span class="op" id="1497888">(</span><span class="ident" id="1497889"><a href="/math/jn.go.html#1497849">i</a></span><span class="op" id="1497890">)</span>&nbsp;<span class="comment" id="1497892">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497907"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1497909">*=</span>&nbsp;<span class="ident" id="1497912"><a href="/math/jn.go.html#1497799">temp</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1497923">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497949"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1497951">/=</span>&nbsp;<span class="ident" id="1497954"><a href="/math/jn.go.html#1497832">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497959">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497963">}</span>&nbsp;<span class="keyword" id="1497965">else</span>&nbsp;<span class="op" id="1497970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1497975">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498005">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498054">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498111">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498160">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498166">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498211">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498267">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498315">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498365">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498411">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498417">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498471">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498538">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498575">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498603">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498639">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498670">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498705">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498742">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498748">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498794">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498829">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498867">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498905">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498943">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498986">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499004">w</span>&nbsp;<span class="op" id="1499006">:=</span>&nbsp;<span class="builtintype" id="1499009">float64</span><span class="op" id="1499016">(</span><span class="ident" id="1499017"><a href="/math/jn.go.html#1496042">n</a></span><span class="op" id="1499018">+</span><span class="ident" id="1499019"><a href="/math/jn.go.html#1496042">n</a></span><span class="op" id="1499020">)</span>&nbsp;<span class="op" id="1499022">/</span>&nbsp;<span class="ident" id="1499024"><a href="/math/jn.go.html#1496049">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499029">h</span>&nbsp;<span class="op" id="1499031">:=</span>&nbsp;<span class="num" id="1499034">2</span>&nbsp;<span class="op" id="1499036">/</span>&nbsp;<span class="ident" id="1499038"><a href="/math/jn.go.html#1496049">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499043">q0</span>&nbsp;<span class="op" id="1499046">:=</span>&nbsp;<span class="ident" id="1499049"><a href="/math/jn.go.html#1499004">w</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499054">z</span>&nbsp;<span class="op" id="1499056">:=</span>&nbsp;<span class="ident" id="1499059"><a href="/math/jn.go.html#1499004">w</a></span>&nbsp;<span class="op" id="1499061">+</span>&nbsp;<span class="ident" id="1499063"><a href="/math/jn.go.html#1499029">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499068">q1</span>&nbsp;<span class="op" id="1499071">:=</span>&nbsp;<span class="ident" id="1499074"><a href="/math/jn.go.html#1499004">w</a></span><span class="op" id="1499075">*</span><span class="ident" id="1499076"><a href="/math/jn.go.html#1499054">z</a></span>&nbsp;<span class="op" id="1499078">-</span>&nbsp;<span class="num" id="1499080">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499085">k</span>&nbsp;<span class="op" id="1499087">:=</span>&nbsp;<span class="num" id="1499090">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499095">for</span>&nbsp;<span class="ident" id="1499099"><a href="/math/jn.go.html#1499068">q1</a></span>&nbsp;<span class="op" id="1499102">&lt;</span>&nbsp;<span class="num" id="1499104">1e9</span>&nbsp;<span class="op" id="1499108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499114"><a href="/math/jn.go.html#1499085">k</a></span>&nbsp;<span class="op" id="1499116">+=</span>&nbsp;<span class="num" id="1499119">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499125"><a href="/math/jn.go.html#1499054">z</a></span>&nbsp;<span class="op" id="1499127">+=</span>&nbsp;<span class="ident" id="1499130"><a href="/math/jn.go.html#1499029">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499136"><a href="/math/jn.go.html#1499043">q0</a></span><span class="op" id="1499138">,</span>&nbsp;<span class="ident" id="1499140"><a href="/math/jn.go.html#1499068">q1</a></span>&nbsp;<span class="op" id="1499143">=</span>&nbsp;<span class="ident" id="1499145"><a href="/math/jn.go.html#1499068">q1</a></span><span class="op" id="1499147">,</span>&nbsp;<span class="ident" id="1499149"><a href="/math/jn.go.html#1499054">z</a></span><span class="op" id="1499150">*</span><span class="ident" id="1499151"><a href="/math/jn.go.html#1499068">q1</a></span><span class="op" id="1499153">-</span><span class="ident" id="1499154"><a href="/math/jn.go.html#1499043">q0</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499165">m</span>&nbsp;<span class="op" id="1499167">:=</span>&nbsp;<span class="ident" id="1499170"><a href="/math/jn.go.html#1496042">n</a></span>&nbsp;<span class="op" id="1499172">+</span>&nbsp;<span class="ident" id="1499174"><a href="/math/jn.go.html#1496042">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499179">t</span>&nbsp;<span class="op" id="1499181">:=</span>&nbsp;<span class="num" id="1499184">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499191">for</span>&nbsp;<span class="ident" id="1499195">i</span>&nbsp;<span class="op" id="1499197">:=</span>&nbsp;<span class="num" id="1499200">2</span>&nbsp;<span class="op" id="1499202">*</span>&nbsp;<span class="op" id="1499204">(</span><span class="ident" id="1499205"><a href="/math/jn.go.html#1496042">n</a></span>&nbsp;<span class="op" id="1499207">+</span>&nbsp;<span class="ident" id="1499209"><a href="/math/jn.go.html#1499085">k</a></span><span class="op" id="1499210">)</span><span class="op" id="1499211">;</span>&nbsp;<span class="ident" id="1499213"><a href="/math/jn.go.html#1499195">i</a></span>&nbsp;<span class="op" id="1499215">&gt;=</span>&nbsp;<span class="ident" id="1499218"><a href="/math/jn.go.html#1499165">m</a></span><span class="op" id="1499219">;</span>&nbsp;<span class="ident" id="1499221"><a href="/math/jn.go.html#1499195">i</a></span>&nbsp;<span class="op" id="1499223">-=</span>&nbsp;<span class="num" id="1499226">2</span>&nbsp;<span class="op" id="1499228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499234"><a href="/math/jn.go.html#1499179">t</a></span>&nbsp;<span class="op" id="1499236">=</span>&nbsp;<span class="num" id="1499238">1</span>&nbsp;<span class="op" id="1499240">/</span>&nbsp;<span class="op" id="1499242">(</span><span class="builtintype" id="1499243">float64</span><span class="op" id="1499250">(</span><span class="ident" id="1499251"><a href="/math/jn.go.html#1499195">i</a></span><span class="op" id="1499252">)</span><span class="op" id="1499253">/</span><span class="ident" id="1499254"><a href="/math/jn.go.html#1496049">x</a></span>&nbsp;<span class="op" id="1499256">-</span>&nbsp;<span class="ident" id="1499258"><a href="/math/jn.go.html#1499179">t</a></span><span class="op" id="1499259">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499269">a</span>&nbsp;<span class="op" id="1499271">:=</span>&nbsp;<span class="ident" id="1499274"><a href="/math/jn.go.html#1499179">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499279"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1499281">=</span>&nbsp;<span class="num" id="1499283">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499288">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499342">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499379">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499410">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499451">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499517">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499576">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499609">tmp</span>&nbsp;<span class="op" id="1499613">:=</span>&nbsp;<span class="builtintype" id="1499616">float64</span><span class="op" id="1499623">(</span><span class="ident" id="1499624"><a href="/math/jn.go.html#1496042">n</a></span><span class="op" id="1499625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499630">v</span>&nbsp;<span class="op" id="1499632">:=</span>&nbsp;<span class="num" id="1499635">2</span>&nbsp;<span class="op" id="1499637">/</span>&nbsp;<span class="ident" id="1499639"><a href="/math/jn.go.html#1496049">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499644"><a href="/math/jn.go.html#1499609">tmp</a></span>&nbsp;<span class="op" id="1499648">=</span>&nbsp;<span class="ident" id="1499650"><a href="/math/jn.go.html#1499609">tmp</a></span>&nbsp;<span class="op" id="1499654">*</span>&nbsp;<span class="ident" id="1499656"><a href="/math/log.go.html#1516693">Log</a></span><span class="op" id="1499659">(</span><span class="ident" id="1499660"><a href="/math/abs.go.html#1415452">Abs</a></span><span class="op" id="1499663">(</span><span class="ident" id="1499664"><a href="/math/jn.go.html#1499630">v</a></span><span class="op" id="1499665">*</span><span class="ident" id="1499666"><a href="/math/jn.go.html#1499609">tmp</a></span><span class="op" id="1499669">)</span><span class="op" id="1499670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499675">if</span>&nbsp;<span class="ident" id="1499678"><a href="/math/jn.go.html#1499609">tmp</a></span>&nbsp;<span class="op" id="1499682">&lt;</span>&nbsp;<span class="num" id="1499684">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="1499711">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499717">for</span>&nbsp;<span class="ident" id="1499721">i</span>&nbsp;<span class="op" id="1499723">:=</span>&nbsp;<span class="ident" id="1499726"><a href="/math/jn.go.html#1496042">n</a></span>&nbsp;<span class="op" id="1499728">-</span>&nbsp;<span class="num" id="1499730">1</span><span class="op" id="1499731">;</span>&nbsp;<span class="ident" id="1499733"><a href="/math/jn.go.html#1499721">i</a></span>&nbsp;<span class="op" id="1499735">&gt;</span>&nbsp;<span class="num" id="1499737">0</span><span class="op" id="1499738">;</span>&nbsp;<span class="ident" id="1499740"><a href="/math/jn.go.html#1499721">i</a></span><span class="op" id="1499741">--</span>&nbsp;<span class="op" id="1499744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499751">di</span>&nbsp;<span class="op" id="1499754">:=</span>&nbsp;<span class="builtintype" id="1499757">float64</span><span class="op" id="1499764">(</span><span class="ident" id="1499765"><a href="/math/jn.go.html#1499721">i</a></span>&nbsp;<span class="op" id="1499767">+</span>&nbsp;<span class="ident" id="1499769"><a href="/math/jn.go.html#1499721">i</a></span><span class="op" id="1499770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499777"><a href="/math/jn.go.html#1499269">a</a></span><span class="op" id="1499778">,</span>&nbsp;<span class="ident" id="1499780"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1499782">=</span>&nbsp;<span class="ident" id="1499784"><a href="/math/jn.go.html#1496599">b</a></span><span class="op" id="1499785">,</span>&nbsp;<span class="ident" id="1499787"><a href="/math/jn.go.html#1496599">b</a></span><span class="op" id="1499788">*</span><span class="ident" id="1499789"><a href="/math/jn.go.html#1499751">di</a></span><span class="op" id="1499791">/</span><span class="ident" id="1499792"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1499793">-</span><span class="ident" id="1499794"><a href="/math/jn.go.html#1499269">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499801"><a href="/math/jn.go.html#1499751">di</a></span>&nbsp;<span class="op" id="1499804">-=</span>&nbsp;<span class="num" id="1499807">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499813">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499818">}</span>&nbsp;<span class="keyword" id="1499820">else</span>&nbsp;<span class="op" id="1499825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499831">for</span>&nbsp;<span class="ident" id="1499835">i</span>&nbsp;<span class="op" id="1499837">:=</span>&nbsp;<span class="ident" id="1499840"><a href="/math/jn.go.html#1496042">n</a></span>&nbsp;<span class="op" id="1499842">-</span>&nbsp;<span class="num" id="1499844">1</span><span class="op" id="1499845">;</span>&nbsp;<span class="ident" id="1499847"><a href="/math/jn.go.html#1499835">i</a></span>&nbsp;<span class="op" id="1499849">&gt;</span>&nbsp;<span class="num" id="1499851">0</span><span class="op" id="1499852">;</span>&nbsp;<span class="ident" id="1499854"><a href="/math/jn.go.html#1499835">i</a></span><span class="op" id="1499855">--</span>&nbsp;<span class="op" id="1499858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499865">di</span>&nbsp;<span class="op" id="1499868">:=</span>&nbsp;<span class="builtintype" id="1499871">float64</span><span class="op" id="1499878">(</span><span class="ident" id="1499879"><a href="/math/jn.go.html#1499835">i</a></span>&nbsp;<span class="op" id="1499881">+</span>&nbsp;<span class="ident" id="1499883"><a href="/math/jn.go.html#1499835">i</a></span><span class="op" id="1499884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499891"><a href="/math/jn.go.html#1499269">a</a></span><span class="op" id="1499892">,</span>&nbsp;<span class="ident" id="1499894"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1499896">=</span>&nbsp;<span class="ident" id="1499898"><a href="/math/jn.go.html#1496599">b</a></span><span class="op" id="1499899">,</span>&nbsp;<span class="ident" id="1499901"><a href="/math/jn.go.html#1496599">b</a></span><span class="op" id="1499902">*</span><span class="ident" id="1499903"><a href="/math/jn.go.html#1499865">di</a></span><span class="op" id="1499905">/</span><span class="ident" id="1499906"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1499907">-</span><span class="ident" id="1499908"><a href="/math/jn.go.html#1499269">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499915"><a href="/math/jn.go.html#1499865">di</a></span>&nbsp;<span class="op" id="1499918">-=</span>&nbsp;<span class="num" id="1499921">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499928">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499971">if</span>&nbsp;<span class="ident" id="1499974"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1499976">&gt;</span>&nbsp;<span class="num" id="1499978">1e100</span>&nbsp;<span class="op" id="1499984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499992"><a href="/math/jn.go.html#1499269">a</a></span>&nbsp;<span class="op" id="1499994">/=</span>&nbsp;<span class="ident" id="1499997"><a href="/math/jn.go.html#1496599">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500005"><a href="/math/jn.go.html#1499179">t</a></span>&nbsp;<span class="op" id="1500007">/=</span>&nbsp;<span class="ident" id="1500010"><a href="/math/jn.go.html#1496599">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500018"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1500020">=</span>&nbsp;<span class="num" id="1500022">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500045"><a href="/math/jn.go.html#1496599">b</a></span>&nbsp;<span class="op" id="1500047">=</span>&nbsp;<span class="ident" id="1500049"><a href="/math/jn.go.html#1499179">t</a></span>&nbsp;<span class="op" id="1500051">*</span>&nbsp;<span class="ident" id="1500053"><a href="/math/j0.go.html#1469585">J0</a></span><span class="op" id="1500055">(</span><span class="ident" id="1500056"><a href="/math/jn.go.html#1496049">x</a></span><span class="op" id="1500057">)</span>&nbsp;<span class="op" id="1500059">/</span>&nbsp;<span class="ident" id="1500061"><a href="/math/jn.go.html#1496599">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500065">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500071">if</span>&nbsp;<span class="ident" id="1500074"><a href="/math/jn.go.html#1496497">sign</a></span>&nbsp;<span class="op" id="1500079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500083">return</span>&nbsp;<span class="op" id="1500090">-</span><span class="ident" id="1500091"><a href="/math/jn.go.html#1496599">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500097">return</span>&nbsp;<span class="ident" id="1500104"><a href="/math/jn.go.html#1496599">b</a></span><br>
<span class="lineno">225</span><span class="op" id="1500106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1500109">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="1500171">//</span><br>
<span class="lineno"></span><span class="comment" id="1500174">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="1500196">//&nbsp;&nbsp;&nbsp;&nbspYn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1500215">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1500238">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="1500292">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1500314">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="1500334">func</span>&nbsp;<span class="ident" id="1500339">Yn</span><span class="op" id="1500341">(</span><span class="ident" id="1500342">n</span>&nbsp;<span class="builtintype" id="1500344">int</span><span class="op" id="1500347">,</span>&nbsp;<span class="ident" id="1500349">x</span>&nbsp;<span class="builtintype" id="1500351">float64</span><span class="op" id="1500358">)</span>&nbsp;<span class="builtintype" id="1500360">float64</span>&nbsp;<span class="op" id="1500368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500371">const</span>&nbsp;<span class="ident" id="1500377">Two302</span>&nbsp;<span class="op" id="1500384">=</span>&nbsp;<span class="num" id="1500386">1</span>&nbsp;<span class="op" id="1500388">&lt;&lt;</span>&nbsp;<span class="num" id="1500391">302</span>&nbsp;<span class="comment" id="1500395">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1500425">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500443">switch</span>&nbsp;<span class="op" id="1500450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500453">case</span>&nbsp;<span class="ident" id="1500458"><a href="/math/jn.go.html#1500349">x</a></span>&nbsp;<span class="op" id="1500460">&lt;</span>&nbsp;<span class="num" id="1500462">0</span>&nbsp;<span class="op" id="1500464">||</span>&nbsp;<span class="ident" id="1500467"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1500472">(</span><span class="ident" id="1500473"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1500474">)</span><span class="op" id="1500475">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500479">return</span>&nbsp;<span class="ident" id="1500486"><a href="/math/bits.go.html#1427274">NaN</a></span><span class="op" id="1500489">(</span><span class="op" id="1500490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500493">case</span>&nbsp;<span class="ident" id="1500498"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1500503">(</span><span class="ident" id="1500504"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1500505">,</span>&nbsp;<span class="num" id="1500507">1</span><span class="op" id="1500508">)</span><span class="op" id="1500509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500513">return</span>&nbsp;<span class="num" id="1500520">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500527">if</span>&nbsp;<span class="ident" id="1500530"><a href="/math/jn.go.html#1500342">n</a></span>&nbsp;<span class="op" id="1500532">==</span>&nbsp;<span class="num" id="1500535">0</span>&nbsp;<span class="op" id="1500537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500541">return</span>&nbsp;<span class="ident" id="1500548"><a href="/math/j0.go.html#1471504">Y0</a></span><span class="op" id="1500550">(</span><span class="ident" id="1500551"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1500552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500558">if</span>&nbsp;<span class="ident" id="1500561"><a href="/math/jn.go.html#1500349">x</a></span>&nbsp;<span class="op" id="1500563">==</span>&nbsp;<span class="num" id="1500566">0</span>&nbsp;<span class="op" id="1500568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500572">if</span>&nbsp;<span class="ident" id="1500575"><a href="/math/jn.go.html#1500342">n</a></span>&nbsp;<span class="op" id="1500577">&lt;</span>&nbsp;<span class="num" id="1500579">0</span>&nbsp;<span class="op" id="1500581">&amp;&amp;</span>&nbsp;<span class="ident" id="1500584"><a href="/math/jn.go.html#1500342">n</a></span><span class="op" id="1500585">&amp;</span><span class="num" id="1500586">1</span>&nbsp;<span class="op" id="1500588">==</span>&nbsp;<span class="num" id="1500591">1</span>&nbsp;<span class="op" id="1500593">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500598">return</span>&nbsp;<span class="ident" id="1500605"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1500608">(</span><span class="num" id="1500609">1</span><span class="op" id="1500610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500618">return</span>&nbsp;<span class="ident" id="1500625"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1500628">(</span><span class="op" id="1500629">-</span><span class="num" id="1500630">1</span><span class="op" id="1500631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500637">sign</span>&nbsp;<span class="op" id="1500642">:=</span>&nbsp;<span class="ident" id="1500645">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500652">if</span>&nbsp;<span class="ident" id="1500655"><a href="/math/jn.go.html#1500342">n</a></span>&nbsp;<span class="op" id="1500657">&lt;</span>&nbsp;<span class="num" id="1500659">0</span>&nbsp;<span class="op" id="1500661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500665"><a href="/math/jn.go.html#1500342">n</a></span>&nbsp;<span class="op" id="1500667">=</span>&nbsp;<span class="op" id="1500669">-</span><span class="ident" id="1500670"><a href="/math/jn.go.html#1500342">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500674">if</span>&nbsp;<span class="ident" id="1500677"><a href="/math/jn.go.html#1500342">n</a></span><span class="op" id="1500678">&amp;</span><span class="num" id="1500679">1</span>&nbsp;<span class="op" id="1500681">==</span>&nbsp;<span class="num" id="1500684">1</span>&nbsp;<span class="op" id="1500686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500691"><a href="/math/jn.go.html#1500637">sign</a></span>&nbsp;<span class="op" id="1500696">=</span>&nbsp;<span class="ident" id="1500698">true</span>&nbsp;<span class="comment" id="1500703">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500738">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500744">if</span>&nbsp;<span class="ident" id="1500747"><a href="/math/jn.go.html#1500342">n</a></span>&nbsp;<span class="op" id="1500749">==</span>&nbsp;<span class="num" id="1500752">1</span>&nbsp;<span class="op" id="1500754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500758">if</span>&nbsp;<span class="ident" id="1500761"><a href="/math/jn.go.html#1500637">sign</a></span>&nbsp;<span class="op" id="1500766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500771">return</span>&nbsp;<span class="op" id="1500778">-</span><span class="ident" id="1500779"><a href="/math/j1.go.html#1485348">Y1</a></span><span class="op" id="1500781">(</span><span class="ident" id="1500782"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1500783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500787">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500791">return</span>&nbsp;<span class="ident" id="1500798"><a href="/math/j1.go.html#1485348">Y1</a></span><span class="op" id="1500800">(</span><span class="ident" id="1500801"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1500802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500808">var</span>&nbsp;<span class="ident" id="1500812">b</span>&nbsp;<span class="builtintype" id="1500814">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500823">if</span>&nbsp;<span class="ident" id="1500826"><a href="/math/jn.go.html#1500349">x</a></span>&nbsp;<span class="op" id="1500828">&gt;=</span>&nbsp;<span class="ident" id="1500831"><a href="/math/jn.go.html#1500377">Two302</a></span>&nbsp;<span class="op" id="1500838">{</span>&nbsp;<span class="comment" id="1500840">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1500856">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1500873">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1500922">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1500971">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501004">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspxn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501048">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501053">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbspsin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbspcos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501090">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501131">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501153">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501176">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp-s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501198">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501221">var</span>&nbsp;<span class="ident" id="1501225">temp</span>&nbsp;<span class="builtintype" id="1501230">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501240">switch</span>&nbsp;<span class="ident" id="1501247"><a href="/math/jn.go.html#1500342">n</a></span>&nbsp;<span class="op" id="1501249">&amp;</span>&nbsp;<span class="num" id="1501251">3</span>&nbsp;<span class="op" id="1501253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501257">case</span>&nbsp;<span class="num" id="1501262">0</span><span class="op" id="1501263">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501268"><a href="/math/jn.go.html#1501225">temp</a></span>&nbsp;<span class="op" id="1501273">=</span>&nbsp;<span class="ident" id="1501275"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1501278">(</span><span class="ident" id="1501279"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501280">)</span>&nbsp;<span class="op" id="1501282">-</span>&nbsp;<span class="ident" id="1501284"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1501287">(</span><span class="ident" id="1501288"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501293">case</span>&nbsp;<span class="num" id="1501298">1</span><span class="op" id="1501299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501304"><a href="/math/jn.go.html#1501225">temp</a></span>&nbsp;<span class="op" id="1501309">=</span>&nbsp;<span class="op" id="1501311">-</span><span class="ident" id="1501312"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1501315">(</span><span class="ident" id="1501316"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501317">)</span>&nbsp;<span class="op" id="1501319">-</span>&nbsp;<span class="ident" id="1501321"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1501324">(</span><span class="ident" id="1501325"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501330">case</span>&nbsp;<span class="num" id="1501335">2</span><span class="op" id="1501336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501341"><a href="/math/jn.go.html#1501225">temp</a></span>&nbsp;<span class="op" id="1501346">=</span>&nbsp;<span class="op" id="1501348">-</span><span class="ident" id="1501349"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1501352">(</span><span class="ident" id="1501353"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501354">)</span>&nbsp;<span class="op" id="1501356">+</span>&nbsp;<span class="ident" id="1501358"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1501361">(</span><span class="ident" id="1501362"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501363">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501367">case</span>&nbsp;<span class="num" id="1501372">3</span><span class="op" id="1501373">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501378"><a href="/math/jn.go.html#1501225">temp</a></span>&nbsp;<span class="op" id="1501383">=</span>&nbsp;<span class="ident" id="1501385"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1501388">(</span><span class="ident" id="1501389"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501390">)</span>&nbsp;<span class="op" id="1501392">+</span>&nbsp;<span class="ident" id="1501394"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1501397">(</span><span class="ident" id="1501398"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501407"><a href="/math/jn.go.html#1500812">b</a></span>&nbsp;<span class="op" id="1501409">=</span>&nbsp;<span class="op" id="1501411">(</span><span class="num" id="1501412">1</span>&nbsp;<span class="op" id="1501414">/</span>&nbsp;<span class="ident" id="1501416"><a href="/math/const.go.html#1430893">SqrtPi</a></span><span class="op" id="1501422">)</span>&nbsp;<span class="op" id="1501424">*</span>&nbsp;<span class="ident" id="1501426"><a href="/math/jn.go.html#1501225">temp</a></span>&nbsp;<span class="op" id="1501431">/</span>&nbsp;<span class="ident" id="1501433"><a href="/math/sqrt.go.html#1548013">Sqrt</a></span><span class="op" id="1501437">(</span><span class="ident" id="1501438"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501442">}</span>&nbsp;<span class="keyword" id="1501444">else</span>&nbsp;<span class="op" id="1501449">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501453">a</span>&nbsp;<span class="op" id="1501455">:=</span>&nbsp;<span class="ident" id="1501458"><a href="/math/j0.go.html#1471504">Y0</a></span><span class="op" id="1501460">(</span><span class="ident" id="1501461"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501466"><a href="/math/jn.go.html#1500812">b</a></span>&nbsp;<span class="op" id="1501468">=</span>&nbsp;<span class="ident" id="1501470"><a href="/math/j1.go.html#1485348">Y1</a></span><span class="op" id="1501472">(</span><span class="ident" id="1501473"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501478">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501501">for</span>&nbsp;<span class="ident" id="1501505">i</span>&nbsp;<span class="op" id="1501507">:=</span>&nbsp;<span class="num" id="1501510">1</span><span class="op" id="1501511">;</span>&nbsp;<span class="ident" id="1501513"><a href="/math/jn.go.html#1501505">i</a></span>&nbsp;<span class="op" id="1501515">&lt;</span>&nbsp;<span class="ident" id="1501517"><a href="/math/jn.go.html#1500342">n</a></span>&nbsp;<span class="op" id="1501519">&amp;&amp;</span>&nbsp;<span class="op" id="1501522">!</span><span class="ident" id="1501523"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1501528">(</span><span class="ident" id="1501529"><a href="/math/jn.go.html#1500812">b</a></span><span class="op" id="1501530">,</span>&nbsp;<span class="op" id="1501532">-</span><span class="num" id="1501533">1</span><span class="op" id="1501534">)</span><span class="op" id="1501535">;</span>&nbsp;<span class="ident" id="1501537"><a href="/math/jn.go.html#1501505">i</a></span><span class="op" id="1501538">++</span>&nbsp;<span class="op" id="1501541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501546"><a href="/math/jn.go.html#1501453">a</a></span><span class="op" id="1501547">,</span>&nbsp;<span class="ident" id="1501549"><a href="/math/jn.go.html#1500812">b</a></span>&nbsp;<span class="op" id="1501551">=</span>&nbsp;<span class="ident" id="1501553"><a href="/math/jn.go.html#1500812">b</a></span><span class="op" id="1501554">,</span>&nbsp;<span class="op" id="1501556">(</span><span class="builtintype" id="1501557">float64</span><span class="op" id="1501564">(</span><span class="ident" id="1501565"><a href="/math/jn.go.html#1501505">i</a></span><span class="op" id="1501566">+</span><span class="ident" id="1501567"><a href="/math/jn.go.html#1501505">i</a></span><span class="op" id="1501568">)</span><span class="op" id="1501569">/</span><span class="ident" id="1501570"><a href="/math/jn.go.html#1500349">x</a></span><span class="op" id="1501571">)</span><span class="op" id="1501572">*</span><span class="ident" id="1501573"><a href="/math/jn.go.html#1500812">b</a></span><span class="op" id="1501574">-</span><span class="ident" id="1501575"><a href="/math/jn.go.html#1501453">a</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501585">if</span>&nbsp;<span class="ident" id="1501588"><a href="/math/jn.go.html#1500637">sign</a></span>&nbsp;<span class="op" id="1501593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501597">return</span>&nbsp;<span class="op" id="1501604">-</span><span class="ident" id="1501605"><a href="/math/jn.go.html#1500812">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501608">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501611">return</span>&nbsp;<span class="ident" id="1501618"><a href="/math/jn.go.html#1500812">b</a></span><br>
<span class="lineno"></span><span class="op" id="1501620">}</span>
</div>
</body>
</html>
