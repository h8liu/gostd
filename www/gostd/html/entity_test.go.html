<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html</h2>
<ul>
<li><a href="/gostd/html/entity.go.html">entity.go</a></li>
<li><a href="/gostd/html/entity_test.go.html" class="current">entity_test.go</a></li>
<li><a href="/gostd/html/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/escape_test.go.html">escape_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7946397">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7946452">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7946506">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7946557">package</span>&nbsp;<span class="ident" id="7946565">html</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7946571">import</span>&nbsp;<span class="op" id="7946578">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7946581">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7946592">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7946607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7946610">func</span>&nbsp;<span class="ident" id="7946615">TestEntityLength</span><span class="op" id="7946631">(</span><span class="ident" id="7946632">t</span>&nbsp;<span class="op" id="7946634">*</span><span class="ident" id="7946635">testing</span><span class="op" id="7946642">.</span><span class="ident" id="7946643">T</span><span class="op" id="7946644">)</span>&nbsp;<span class="op" id="7946646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7946649">//&nbsp;We&nbsp;verify&nbsp;that&nbsp;the&nbsp;length&nbsp;of&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;each&nbsp;value&nbsp;is&nbsp;&lt;=&nbsp;1&nbsp;+&nbsp;len(key).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7946731">//&nbsp;The&nbsp;+1&nbsp;comes&nbsp;from&nbsp;the&nbsp;leading&nbsp;&#34;&amp;&#34;.&nbsp;This&nbsp;property&nbsp;implies&nbsp;that&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7946811">//&nbsp;unescaped&nbsp;text&nbsp;is&nbsp;&lt;=&nbsp;the&nbsp;length&nbsp;of&nbsp;escaped&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7946864">for</span>&nbsp;<span class="ident" id="7946868">k</span><span class="op" id="7946869">,</span>&nbsp;<span class="ident" id="7946871">v</span>&nbsp;<span class="op" id="7946873">:=</span>&nbsp;<span class="keyword" id="7946876">range</span>&nbsp;<span class="ident" id="7946882">entity</span>&nbsp;<span class="op" id="7946889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7946893">if</span>&nbsp;<span class="num" id="7946896">1</span><span class="op" id="7946897">+</span><span class="builtinfunc" id="7946898">len</span><span class="op" id="7946901">(</span><span class="ident" id="7946902">k</span><span class="op" id="7946903">)</span>&nbsp;<span class="op" id="7946905">&lt;</span>&nbsp;<span class="ident" id="7946907">utf8</span><span class="op" id="7946911">.</span><span class="ident" id="7946912">RuneLen</span><span class="op" id="7946919">(</span><span class="ident" id="7946920">v</span><span class="op" id="7946921">)</span>&nbsp;<span class="op" id="7946923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7946928">t</span><span class="op" id="7946929">.</span><span class="ident" id="7946930">Error</span><span class="op" id="7946935">(</span><span class="string" id="7946936">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7946955">+</span>&nbsp;<span class="ident" id="7946957">k</span>&nbsp;<span class="op" id="7946959">+</span>&nbsp;<span class="string" id="7946961">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7947000">+</span>&nbsp;<span class="builtintype" id="7947002">string</span><span class="op" id="7947008">(</span><span class="ident" id="7947009">v</span><span class="op" id="7947010">)</span><span class="op" id="7947011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947015">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7947019">if</span>&nbsp;<span class="builtinfunc" id="7947022">len</span><span class="op" id="7947025">(</span><span class="ident" id="7947026">k</span><span class="op" id="7947027">)</span>&nbsp;<span class="op" id="7947029">&gt;</span>&nbsp;<span class="ident" id="7947031">longestEntityWithoutSemicolon</span>&nbsp;<span class="op" id="7947061">&amp;&amp;</span>&nbsp;<span class="ident" id="7947064">k</span><span class="op" id="7947065">[</span><span class="builtinfunc" id="7947066">len</span><span class="op" id="7947069">(</span><span class="ident" id="7947070">k</span><span class="op" id="7947071">)</span><span class="op" id="7947072">-</span><span class="num" id="7947073">1</span><span class="op" id="7947074">]</span>&nbsp;<span class="op" id="7947076">!=</span>&nbsp;<span class="string" id="7947079">&#39;;&#39;</span>&nbsp;<span class="op" id="7947083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947088">t</span><span class="op" id="7947089">.</span><span class="ident" id="7947090">Errorf</span><span class="op" id="7947096">(</span><span class="string" id="7947097">&#34;entity&nbsp;name&nbsp;%s&nbsp;is&nbsp;%d&nbsp;characters,&nbsp;but&nbsp;longestEntityWithoutSemicolon=%d&#34;</span><span class="op" id="7947168">,</span>&nbsp;<span class="ident" id="7947170">k</span><span class="op" id="7947171">,</span>&nbsp;<span class="builtinfunc" id="7947173">len</span><span class="op" id="7947176">(</span><span class="ident" id="7947177">k</span><span class="op" id="7947178">)</span><span class="op" id="7947179">,</span>&nbsp;<span class="ident" id="7947181">longestEntityWithoutSemicolon</span><span class="op" id="7947210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7947220">for</span>&nbsp;<span class="ident" id="7947224">k</span><span class="op" id="7947225">,</span>&nbsp;<span class="ident" id="7947227">v</span>&nbsp;<span class="op" id="7947229">:=</span>&nbsp;<span class="keyword" id="7947232">range</span>&nbsp;<span class="ident" id="7947238">entity2</span>&nbsp;<span class="op" id="7947246">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7947250">if</span>&nbsp;<span class="num" id="7947253">1</span><span class="op" id="7947254">+</span><span class="builtinfunc" id="7947255">len</span><span class="op" id="7947258">(</span><span class="ident" id="7947259">k</span><span class="op" id="7947260">)</span>&nbsp;<span class="op" id="7947262">&lt;</span>&nbsp;<span class="ident" id="7947264">utf8</span><span class="op" id="7947268">.</span><span class="ident" id="7947269">RuneLen</span><span class="op" id="7947276">(</span><span class="ident" id="7947277">v</span><span class="op" id="7947278">[</span><span class="num" id="7947279">0</span><span class="op" id="7947280">]</span><span class="op" id="7947281">)</span><span class="op" id="7947282">+</span><span class="ident" id="7947283">utf8</span><span class="op" id="7947287">.</span><span class="ident" id="7947288">RuneLen</span><span class="op" id="7947295">(</span><span class="ident" id="7947296">v</span><span class="op" id="7947297">[</span><span class="num" id="7947298">1</span><span class="op" id="7947299">]</span><span class="op" id="7947300">)</span>&nbsp;<span class="op" id="7947302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947307">t</span><span class="op" id="7947308">.</span><span class="ident" id="7947309">Error</span><span class="op" id="7947314">(</span><span class="string" id="7947315">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7947334">+</span>&nbsp;<span class="ident" id="7947336">k</span>&nbsp;<span class="op" id="7947338">+</span>&nbsp;<span class="string" id="7947340">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7947379">+</span>&nbsp;<span class="builtintype" id="7947381">string</span><span class="op" id="7947387">(</span><span class="ident" id="7947388">v</span><span class="op" id="7947389">[</span><span class="num" id="7947390">0</span><span class="op" id="7947391">]</span><span class="op" id="7947392">)</span>&nbsp;<span class="op" id="7947394">+</span>&nbsp;<span class="builtintype" id="7947396">string</span><span class="op" id="7947402">(</span><span class="ident" id="7947403">v</span><span class="op" id="7947404">[</span><span class="num" id="7947405">1</span><span class="op" id="7947406">]</span><span class="op" id="7947407">)</span><span class="op" id="7947408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947415">}</span><br>
<span class="lineno"></span><span class="op" id="7947417">}</span>
</div>
</body>
</html>
