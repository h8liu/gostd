<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6602688">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6602743">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6602797">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6602848">package</span>&nbsp;<span class="ident" id="6602856">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6602863">import</span>&nbsp;<span class="op" id="6602870">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6602873">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6602882">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6602900">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6602919">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6602934">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6602949">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6602966">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6602983">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6602999">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6603007">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6603013">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6603025">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6603031">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6603042">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6603052">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6603055">func</span>&nbsp;<span class="ident" id="6603060">testKeyGeneration</span><span class="op" id="6603077">(</span><span class="ident" id="6603078">t</span>&nbsp;<span class="op" id="6603080">*</span><span class="ident" id="6603081">testing</span><span class="op" id="6603088">.</span><span class="ident" id="6603089">T</span><span class="op" id="6603090">,</span>&nbsp;<span class="ident" id="6603092">c</span>&nbsp;<span class="ident" id="6603094">elliptic</span><span class="op" id="6603102">.</span><span class="ident" id="6603103">Curve</span><span class="op" id="6603108">,</span>&nbsp;<span class="ident" id="6603110">tag</span>&nbsp;<span class="builtintype" id="6603114">string</span><span class="op" id="6603120">)</span>&nbsp;<span class="op" id="6603122">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603125">priv</span><span class="op" id="6603129">,</span>&nbsp;<span class="ident" id="6603131">err</span>&nbsp;<span class="op" id="6603135">:=</span>&nbsp;<span class="ident" id="6603138">GenerateKey</span><span class="op" id="6603149">(</span><span class="ident" id="6603150">c</span><span class="op" id="6603151">,</span>&nbsp;<span class="ident" id="6603153">rand</span><span class="op" id="6603157">.</span><span class="ident" id="6603158">Reader</span><span class="op" id="6603164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603167">if</span>&nbsp;<span class="ident" id="6603170">err</span>&nbsp;<span class="op" id="6603174">!=</span>&nbsp;<span class="ident" id="6603177">nil</span>&nbsp;<span class="op" id="6603181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603185">t</span><span class="op" id="6603186">.</span><span class="ident" id="6603187">Errorf</span><span class="op" id="6603193">(</span><span class="string" id="6603194">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6603209">,</span>&nbsp;<span class="ident" id="6603211">tag</span><span class="op" id="6603214">,</span>&nbsp;<span class="ident" id="6603216">err</span><span class="op" id="6603219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603223">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603231">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603234">if</span>&nbsp;<span class="op" id="6603237">!</span><span class="ident" id="6603238">c</span><span class="op" id="6603239">.</span><span class="ident" id="6603240">IsOnCurve</span><span class="op" id="6603249">(</span><span class="ident" id="6603250">priv</span><span class="op" id="6603254">.</span><span class="ident" id="6603255">PublicKey</span><span class="op" id="6603264">.</span><span class="ident" id="6603265">X</span><span class="op" id="6603266">,</span>&nbsp;<span class="ident" id="6603268">priv</span><span class="op" id="6603272">.</span><span class="ident" id="6603273">PublicKey</span><span class="op" id="6603282">.</span><span class="ident" id="6603283">Y</span><span class="op" id="6603284">)</span>&nbsp;<span class="op" id="6603286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603290">t</span><span class="op" id="6603291">.</span><span class="ident" id="6603292">Errorf</span><span class="op" id="6603298">(</span><span class="string" id="6603299">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="6603327">,</span>&nbsp;<span class="ident" id="6603329">tag</span><span class="op" id="6603332">,</span>&nbsp;<span class="ident" id="6603334">err</span><span class="op" id="6603337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603340">}</span><br>
<span class="lineno"></span><span class="op" id="6603342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6603345">func</span>&nbsp;<span class="ident" id="6603350">TestKeyGeneration</span><span class="op" id="6603367">(</span><span class="ident" id="6603368">t</span>&nbsp;<span class="op" id="6603370">*</span><span class="ident" id="6603371">testing</span><span class="op" id="6603378">.</span><span class="ident" id="6603379">T</span><span class="op" id="6603380">)</span>&nbsp;<span class="op" id="6603382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603385">testKeyGeneration</span><span class="op" id="6603402">(</span><span class="ident" id="6603403">t</span><span class="op" id="6603404">,</span>&nbsp;<span class="ident" id="6603406">elliptic</span><span class="op" id="6603414">.</span><span class="ident" id="6603415">P224</span><span class="op" id="6603419">(</span><span class="op" id="6603420">)</span><span class="op" id="6603421">,</span>&nbsp;<span class="string" id="6603423">&#34;p224&#34;</span><span class="op" id="6603429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603432">if</span>&nbsp;<span class="ident" id="6603435">testing</span><span class="op" id="6603442">.</span><span class="ident" id="6603443">Short</span><span class="op" id="6603448">(</span><span class="op" id="6603449">)</span>&nbsp;<span class="op" id="6603451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603455">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603463">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603466">testKeyGeneration</span><span class="op" id="6603483">(</span><span class="ident" id="6603484">t</span><span class="op" id="6603485">,</span>&nbsp;<span class="ident" id="6603487">elliptic</span><span class="op" id="6603495">.</span><span class="ident" id="6603496">P256</span><span class="op" id="6603500">(</span><span class="op" id="6603501">)</span><span class="op" id="6603502">,</span>&nbsp;<span class="string" id="6603504">&#34;p256&#34;</span><span class="op" id="6603510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603513">testKeyGeneration</span><span class="op" id="6603530">(</span><span class="ident" id="6603531">t</span><span class="op" id="6603532">,</span>&nbsp;<span class="ident" id="6603534">elliptic</span><span class="op" id="6603542">.</span><span class="ident" id="6603543">P384</span><span class="op" id="6603547">(</span><span class="op" id="6603548">)</span><span class="op" id="6603549">,</span>&nbsp;<span class="string" id="6603551">&#34;p384&#34;</span><span class="op" id="6603557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603560">testKeyGeneration</span><span class="op" id="6603577">(</span><span class="ident" id="6603578">t</span><span class="op" id="6603579">,</span>&nbsp;<span class="ident" id="6603581">elliptic</span><span class="op" id="6603589">.</span><span class="ident" id="6603590">P521</span><span class="op" id="6603594">(</span><span class="op" id="6603595">)</span><span class="op" id="6603596">,</span>&nbsp;<span class="string" id="6603598">&#34;p521&#34;</span><span class="op" id="6603604">)</span><br>
<span class="lineno"></span><span class="op" id="6603606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="6603609">func</span>&nbsp;<span class="ident" id="6603614">testSignAndVerify</span><span class="op" id="6603631">(</span><span class="ident" id="6603632">t</span>&nbsp;<span class="op" id="6603634">*</span><span class="ident" id="6603635">testing</span><span class="op" id="6603642">.</span><span class="ident" id="6603643">T</span><span class="op" id="6603644">,</span>&nbsp;<span class="ident" id="6603646">c</span>&nbsp;<span class="ident" id="6603648">elliptic</span><span class="op" id="6603656">.</span><span class="ident" id="6603657">Curve</span><span class="op" id="6603662">,</span>&nbsp;<span class="ident" id="6603664">tag</span>&nbsp;<span class="builtintype" id="6603668">string</span><span class="op" id="6603674">)</span>&nbsp;<span class="op" id="6603676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603679">priv</span><span class="op" id="6603683">,</span>&nbsp;<span class="ident" id="6603685">_</span>&nbsp;<span class="op" id="6603687">:=</span>&nbsp;<span class="ident" id="6603690">GenerateKey</span><span class="op" id="6603701">(</span><span class="ident" id="6603702">c</span><span class="op" id="6603703">,</span>&nbsp;<span class="ident" id="6603705">rand</span><span class="op" id="6603709">.</span><span class="ident" id="6603710">Reader</span><span class="op" id="6603716">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603720">hashed</span>&nbsp;<span class="op" id="6603727">:=</span>&nbsp;<span class="op" id="6603730">[</span><span class="op" id="6603731">]</span><span class="builtintype" id="6603732">byte</span><span class="op" id="6603736">(</span><span class="string" id="6603737">&#34;testing&#34;</span><span class="op" id="6603746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603749">r</span><span class="op" id="6603750">,</span>&nbsp;<span class="ident" id="6603752">s</span><span class="op" id="6603753">,</span>&nbsp;<span class="ident" id="6603755">err</span>&nbsp;<span class="op" id="6603759">:=</span>&nbsp;<span class="ident" id="6603762">Sign</span><span class="op" id="6603766">(</span><span class="ident" id="6603767">rand</span><span class="op" id="6603771">.</span><span class="ident" id="6603772">Reader</span><span class="op" id="6603778">,</span>&nbsp;<span class="ident" id="6603780">priv</span><span class="op" id="6603784">,</span>&nbsp;<span class="ident" id="6603786">hashed</span><span class="op" id="6603792">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603795">if</span>&nbsp;<span class="ident" id="6603798">err</span>&nbsp;<span class="op" id="6603802">!=</span>&nbsp;<span class="ident" id="6603805">nil</span>&nbsp;<span class="op" id="6603809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603813">t</span><span class="op" id="6603814">.</span><span class="ident" id="6603815">Errorf</span><span class="op" id="6603821">(</span><span class="string" id="6603822">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6603845">,</span>&nbsp;<span class="ident" id="6603847">tag</span><span class="op" id="6603850">,</span>&nbsp;<span class="ident" id="6603852">err</span><span class="op" id="6603855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603859">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603871">if</span>&nbsp;<span class="op" id="6603874">!</span><span class="ident" id="6603875">Verify</span><span class="op" id="6603881">(</span><span class="op" id="6603882">&amp;</span><span class="ident" id="6603883">priv</span><span class="op" id="6603887">.</span><span class="ident" id="6603888">PublicKey</span><span class="op" id="6603897">,</span>&nbsp;<span class="ident" id="6603899">hashed</span><span class="op" id="6603905">,</span>&nbsp;<span class="ident" id="6603907">r</span><span class="op" id="6603908">,</span>&nbsp;<span class="ident" id="6603910">s</span><span class="op" id="6603911">)</span>&nbsp;<span class="op" id="6603913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603917">t</span><span class="op" id="6603918">.</span><span class="ident" id="6603919">Errorf</span><span class="op" id="6603925">(</span><span class="string" id="6603926">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="6603945">,</span>&nbsp;<span class="ident" id="6603947">tag</span><span class="op" id="6603950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603957">hashed</span><span class="op" id="6603963">[</span><span class="num" id="6603964">0</span><span class="op" id="6603965">]</span>&nbsp;<span class="op" id="6603967">^=</span>&nbsp;<span class="num" id="6603970">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603976">if</span>&nbsp;<span class="ident" id="6603979">Verify</span><span class="op" id="6603985">(</span><span class="op" id="6603986">&amp;</span><span class="ident" id="6603987">priv</span><span class="op" id="6603991">.</span><span class="ident" id="6603992">PublicKey</span><span class="op" id="6604001">,</span>&nbsp;<span class="ident" id="6604003">hashed</span><span class="op" id="6604009">,</span>&nbsp;<span class="ident" id="6604011">r</span><span class="op" id="6604012">,</span>&nbsp;<span class="ident" id="6604014">s</span><span class="op" id="6604015">)</span>&nbsp;<span class="op" id="6604017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604021">t</span><span class="op" id="6604022">.</span><span class="ident" id="6604023">Errorf</span><span class="op" id="6604029">(</span><span class="string" id="6604030">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="6604056">,</span>&nbsp;<span class="ident" id="6604058">tag</span><span class="op" id="6604061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604064">}</span><br>
<span class="lineno"></span><span class="op" id="6604066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6604069">func</span>&nbsp;<span class="ident" id="6604074">TestSignAndVerify</span><span class="op" id="6604091">(</span><span class="ident" id="6604092">t</span>&nbsp;<span class="op" id="6604094">*</span><span class="ident" id="6604095">testing</span><span class="op" id="6604102">.</span><span class="ident" id="6604103">T</span><span class="op" id="6604104">)</span>&nbsp;<span class="op" id="6604106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604109">testSignAndVerify</span><span class="op" id="6604126">(</span><span class="ident" id="6604127">t</span><span class="op" id="6604128">,</span>&nbsp;<span class="ident" id="6604130">elliptic</span><span class="op" id="6604138">.</span><span class="ident" id="6604139">P224</span><span class="op" id="6604143">(</span><span class="op" id="6604144">)</span><span class="op" id="6604145">,</span>&nbsp;<span class="string" id="6604147">&#34;p224&#34;</span><span class="op" id="6604153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604156">if</span>&nbsp;<span class="ident" id="6604159">testing</span><span class="op" id="6604166">.</span><span class="ident" id="6604167">Short</span><span class="op" id="6604172">(</span><span class="op" id="6604173">)</span>&nbsp;<span class="op" id="6604175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604179">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604187">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604190">testSignAndVerify</span><span class="op" id="6604207">(</span><span class="ident" id="6604208">t</span><span class="op" id="6604209">,</span>&nbsp;<span class="ident" id="6604211">elliptic</span><span class="op" id="6604219">.</span><span class="ident" id="6604220">P256</span><span class="op" id="6604224">(</span><span class="op" id="6604225">)</span><span class="op" id="6604226">,</span>&nbsp;<span class="string" id="6604228">&#34;p256&#34;</span><span class="op" id="6604234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604237">testSignAndVerify</span><span class="op" id="6604254">(</span><span class="ident" id="6604255">t</span><span class="op" id="6604256">,</span>&nbsp;<span class="ident" id="6604258">elliptic</span><span class="op" id="6604266">.</span><span class="ident" id="6604267">P384</span><span class="op" id="6604271">(</span><span class="op" id="6604272">)</span><span class="op" id="6604273">,</span>&nbsp;<span class="string" id="6604275">&#34;p384&#34;</span><span class="op" id="6604281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604284">testSignAndVerify</span><span class="op" id="6604301">(</span><span class="ident" id="6604302">t</span><span class="op" id="6604303">,</span>&nbsp;<span class="ident" id="6604305">elliptic</span><span class="op" id="6604313">.</span><span class="ident" id="6604314">P521</span><span class="op" id="6604318">(</span><span class="op" id="6604319">)</span><span class="op" id="6604320">,</span>&nbsp;<span class="string" id="6604322">&#34;p521&#34;</span><span class="op" id="6604328">)</span><br>
<span class="lineno"></span><span class="op" id="6604330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6604333">func</span>&nbsp;<span class="ident" id="6604338">fromHex</span><span class="op" id="6604345">(</span><span class="ident" id="6604346">s</span>&nbsp;<span class="builtintype" id="6604348">string</span><span class="op" id="6604354">)</span>&nbsp;<span class="op" id="6604356">*</span><span class="ident" id="6604357">big</span><span class="op" id="6604360">.</span><span class="ident" id="6604361">Int</span>&nbsp;<span class="op" id="6604365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604368">r</span><span class="op" id="6604369">,</span>&nbsp;<span class="ident" id="6604371">ok</span>&nbsp;<span class="op" id="6604374">:=</span>&nbsp;<span class="builtinfunc" id="6604377">new</span><span class="op" id="6604380">(</span><span class="ident" id="6604381">big</span><span class="op" id="6604384">.</span><span class="ident" id="6604385">Int</span><span class="op" id="6604388">)</span><span class="op" id="6604389">.</span><span class="ident" id="6604390">SetString</span><span class="op" id="6604399">(</span><span class="ident" id="6604400">s</span><span class="op" id="6604401">,</span>&nbsp;<span class="num" id="6604403">16</span><span class="op" id="6604405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604408">if</span>&nbsp;<span class="op" id="6604411">!</span><span class="ident" id="6604412">ok</span>&nbsp;<span class="op" id="6604415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6604419">panic</span><span class="op" id="6604424">(</span><span class="string" id="6604425">&#34;bad&nbsp;hex&#34;</span><span class="op" id="6604434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604437">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604440">return</span>&nbsp;<span class="ident" id="6604447">r</span><br>
<span class="lineno"></span><span class="op" id="6604449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6604452">func</span>&nbsp;<span class="ident" id="6604457">TestVectors</span><span class="op" id="6604468">(</span><span class="ident" id="6604469">t</span>&nbsp;<span class="op" id="6604471">*</span><span class="ident" id="6604472">testing</span><span class="op" id="6604479">.</span><span class="ident" id="6604480">T</span><span class="op" id="6604481">)</span>&nbsp;<span class="op" id="6604483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6604486">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6604544">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6604625">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6604629">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6604696">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604749">if</span>&nbsp;<span class="ident" id="6604752">testing</span><span class="op" id="6604759">.</span><span class="ident" id="6604760">Short</span><span class="op" id="6604765">(</span><span class="op" id="6604766">)</span>&nbsp;<span class="op" id="6604768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604772">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604784">f</span><span class="op" id="6604785">,</span>&nbsp;<span class="ident" id="6604787">err</span>&nbsp;<span class="op" id="6604791">:=</span>&nbsp;<span class="ident" id="6604794">os</span><span class="op" id="6604796">.</span><span class="ident" id="6604797">Open</span><span class="op" id="6604801">(</span><span class="string" id="6604802">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="6604827">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604830">if</span>&nbsp;<span class="ident" id="6604833">err</span>&nbsp;<span class="op" id="6604837">!=</span>&nbsp;<span class="ident" id="6604840">nil</span>&nbsp;<span class="op" id="6604844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604848">t</span><span class="op" id="6604849">.</span><span class="ident" id="6604850">Fatal</span><span class="op" id="6604855">(</span><span class="ident" id="6604856">err</span><span class="op" id="6604859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604866">buf</span>&nbsp;<span class="op" id="6604870">:=</span>&nbsp;<span class="ident" id="6604873">bufio</span><span class="op" id="6604878">.</span><span class="ident" id="6604879">NewReader</span><span class="op" id="6604888">(</span><span class="ident" id="6604889">bzip2</span><span class="op" id="6604894">.</span><span class="ident" id="6604895">NewReader</span><span class="op" id="6604904">(</span><span class="ident" id="6604905">f</span><span class="op" id="6604906">)</span><span class="op" id="6604907">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604911">lineNo</span>&nbsp;<span class="op" id="6604918">:=</span>&nbsp;<span class="num" id="6604921">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604924">var</span>&nbsp;<span class="ident" id="6604928">h</span>&nbsp;<span class="ident" id="6604930">hash</span><span class="op" id="6604934">.</span><span class="ident" id="6604935">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604941">var</span>&nbsp;<span class="ident" id="6604945">msg</span>&nbsp;<span class="op" id="6604949">[</span><span class="op" id="6604950">]</span><span class="builtintype" id="6604951">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604957">var</span>&nbsp;<span class="ident" id="6604961">hashed</span>&nbsp;<span class="op" id="6604968">[</span><span class="op" id="6604969">]</span><span class="builtintype" id="6604970">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604976">var</span>&nbsp;<span class="ident" id="6604980">r</span><span class="op" id="6604981">,</span>&nbsp;<span class="ident" id="6604983">s</span>&nbsp;<span class="op" id="6604985">*</span><span class="ident" id="6604986">big</span><span class="op" id="6604989">.</span><span class="ident" id="6604990">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604995">pub</span>&nbsp;<span class="op" id="6604999">:=</span>&nbsp;<span class="builtinfunc" id="6605002">new</span><span class="op" id="6605005">(</span><span class="ident" id="6605006">PublicKey</span><span class="op" id="6605015">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605019">for</span>&nbsp;<span class="op" id="6605023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605027">line</span><span class="op" id="6605031">,</span>&nbsp;<span class="ident" id="6605033">err</span>&nbsp;<span class="op" id="6605037">:=</span>&nbsp;<span class="ident" id="6605040">buf</span><span class="op" id="6605043">.</span><span class="ident" id="6605044">ReadString</span><span class="op" id="6605054">(</span><span class="string" id="6605055">&#39;\n&#39;</span><span class="op" id="6605059">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605063">if</span>&nbsp;<span class="builtinfunc" id="6605066">len</span><span class="op" id="6605069">(</span><span class="ident" id="6605070">line</span><span class="op" id="6605074">)</span>&nbsp;<span class="op" id="6605076">==</span>&nbsp;<span class="num" id="6605079">0</span>&nbsp;<span class="op" id="6605081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605086">if</span>&nbsp;<span class="ident" id="6605089">err</span>&nbsp;<span class="op" id="6605093">==</span>&nbsp;<span class="ident" id="6605096">io</span><span class="op" id="6605098">.</span><span class="ident" id="6605099">EOF</span>&nbsp;<span class="op" id="6605103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605109">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6605118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605123">t</span><span class="op" id="6605124">.</span><span class="ident" id="6605125">Fatalf</span><span class="op" id="6605131">(</span><span class="string" id="6605132">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="6605162">,</span>&nbsp;<span class="ident" id="6605164">err</span><span class="op" id="6605167">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6605171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605175">lineNo</span><span class="op" id="6605181">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6605186">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605237">if</span>&nbsp;<span class="op" id="6605240">!</span><span class="ident" id="6605241">strings</span><span class="op" id="6605248">.</span><span class="ident" id="6605249">HasSuffix</span><span class="op" id="6605258">(</span><span class="ident" id="6605259">line</span><span class="op" id="6605263">,</span>&nbsp;<span class="string" id="6605265">&#34;\r\n&#34;</span><span class="op" id="6605271">)</span>&nbsp;<span class="op" id="6605273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605278">t</span><span class="op" id="6605279">.</span><span class="ident" id="6605280">Fatalf</span><span class="op" id="6605286">(</span><span class="string" id="6605287">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="6605333">,</span>&nbsp;<span class="ident" id="6605335">lineNo</span><span class="op" id="6605341">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6605345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605349">line</span>&nbsp;<span class="op" id="6605354">=</span>&nbsp;<span class="ident" id="6605356">line</span><span class="op" id="6605360">[</span><span class="op" id="6605361">:</span><span class="builtinfunc" id="6605362">len</span><span class="op" id="6605365">(</span><span class="ident" id="6605366">line</span><span class="op" id="6605370">)</span><span class="op" id="6605371">-</span><span class="num" id="6605372">2</span><span class="op" id="6605373">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605378">if</span>&nbsp;<span class="builtinfunc" id="6605381">len</span><span class="op" id="6605384">(</span><span class="ident" id="6605385">line</span><span class="op" id="6605389">)</span>&nbsp;<span class="op" id="6605391">==</span>&nbsp;<span class="num" id="6605394">0</span>&nbsp;<span class="op" id="6605396">||</span>&nbsp;<span class="ident" id="6605399">line</span><span class="op" id="6605403">[</span><span class="num" id="6605404">0</span><span class="op" id="6605405">]</span>&nbsp;<span class="op" id="6605407">==</span>&nbsp;<span class="string" id="6605410">&#39;#&#39;</span>&nbsp;<span class="op" id="6605414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605419">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6605430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605435">if</span>&nbsp;<span class="ident" id="6605438">line</span><span class="op" id="6605442">[</span><span class="num" id="6605443">0</span><span class="op" id="6605444">]</span>&nbsp;<span class="op" id="6605446">==</span>&nbsp;<span class="string" id="6605449">&#39;[&#39;</span>&nbsp;<span class="op" id="6605453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605458">line</span>&nbsp;<span class="op" id="6605463">=</span>&nbsp;<span class="ident" id="6605465">line</span><span class="op" id="6605469">[</span><span class="num" id="6605470">1</span>&nbsp;<span class="op" id="6605472">:</span>&nbsp;<span class="builtinfunc" id="6605474">len</span><span class="op" id="6605477">(</span><span class="ident" id="6605478">line</span><span class="op" id="6605482">)</span><span class="op" id="6605483">-</span><span class="num" id="6605484">1</span><span class="op" id="6605485">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605490">parts</span>&nbsp;<span class="op" id="6605496">:=</span>&nbsp;<span class="ident" id="6605499">strings</span><span class="op" id="6605506">.</span><span class="ident" id="6605507">SplitN</span><span class="op" id="6605513">(</span><span class="ident" id="6605514">line</span><span class="op" id="6605518">,</span>&nbsp;<span class="string" id="6605520">&#34;,&#34;</span><span class="op" id="6605523">,</span>&nbsp;<span class="num" id="6605525">2</span><span class="op" id="6605526">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605532">switch</span>&nbsp;<span class="ident" id="6605539">parts</span><span class="op" id="6605544">[</span><span class="num" id="6605545">0</span><span class="op" id="6605546">]</span>&nbsp;<span class="op" id="6605548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605553">case</span>&nbsp;<span class="string" id="6605558">&#34;P-224&#34;</span><span class="op" id="6605565">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605571">pub</span><span class="op" id="6605574">.</span><span class="ident" id="6605575">Curve</span>&nbsp;<span class="op" id="6605581">=</span>&nbsp;<span class="ident" id="6605583">elliptic</span><span class="op" id="6605591">.</span><span class="ident" id="6605592">P224</span><span class="op" id="6605596">(</span><span class="op" id="6605597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605602">case</span>&nbsp;<span class="string" id="6605607">&#34;P-256&#34;</span><span class="op" id="6605614">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605620">pub</span><span class="op" id="6605623">.</span><span class="ident" id="6605624">Curve</span>&nbsp;<span class="op" id="6605630">=</span>&nbsp;<span class="ident" id="6605632">elliptic</span><span class="op" id="6605640">.</span><span class="ident" id="6605641">P256</span><span class="op" id="6605645">(</span><span class="op" id="6605646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605651">case</span>&nbsp;<span class="string" id="6605656">&#34;P-384&#34;</span><span class="op" id="6605663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605669">pub</span><span class="op" id="6605672">.</span><span class="ident" id="6605673">Curve</span>&nbsp;<span class="op" id="6605679">=</span>&nbsp;<span class="ident" id="6605681">elliptic</span><span class="op" id="6605689">.</span><span class="ident" id="6605690">P384</span><span class="op" id="6605694">(</span><span class="op" id="6605695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605700">case</span>&nbsp;<span class="string" id="6605705">&#34;P-521&#34;</span><span class="op" id="6605712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605718">pub</span><span class="op" id="6605721">.</span><span class="ident" id="6605722">Curve</span>&nbsp;<span class="op" id="6605728">=</span>&nbsp;<span class="ident" id="6605730">elliptic</span><span class="op" id="6605738">.</span><span class="ident" id="6605739">P521</span><span class="op" id="6605743">(</span><span class="op" id="6605744">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605749">default</span><span class="op" id="6605756">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605762">pub</span><span class="op" id="6605765">.</span><span class="ident" id="6605766">Curve</span>&nbsp;<span class="op" id="6605772">=</span>&nbsp;<span class="ident" id="6605774">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6605781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605787">switch</span>&nbsp;<span class="ident" id="6605794">parts</span><span class="op" id="6605799">[</span><span class="num" id="6605800">1</span><span class="op" id="6605801">]</span>&nbsp;<span class="op" id="6605803">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605808">case</span>&nbsp;<span class="string" id="6605813">&#34;SHA-1&#34;</span><span class="op" id="6605820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605826">h</span>&nbsp;<span class="op" id="6605828">=</span>&nbsp;<span class="ident" id="6605830">sha1</span><span class="op" id="6605834">.</span><span class="ident" id="6605835">New</span><span class="op" id="6605838">(</span><span class="op" id="6605839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605844">case</span>&nbsp;<span class="string" id="6605849">&#34;SHA-224&#34;</span><span class="op" id="6605858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605864">h</span>&nbsp;<span class="op" id="6605866">=</span>&nbsp;<span class="ident" id="6605868">sha256</span><span class="op" id="6605874">.</span><span class="ident" id="6605875">New224</span><span class="op" id="6605881">(</span><span class="op" id="6605882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605887">case</span>&nbsp;<span class="string" id="6605892">&#34;SHA-256&#34;</span><span class="op" id="6605901">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605907">h</span>&nbsp;<span class="op" id="6605909">=</span>&nbsp;<span class="ident" id="6605911">sha256</span><span class="op" id="6605917">.</span><span class="ident" id="6605918">New</span><span class="op" id="6605921">(</span><span class="op" id="6605922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605927">case</span>&nbsp;<span class="string" id="6605932">&#34;SHA-384&#34;</span><span class="op" id="6605941">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605947">h</span>&nbsp;<span class="op" id="6605949">=</span>&nbsp;<span class="ident" id="6605951">sha512</span><span class="op" id="6605957">.</span><span class="ident" id="6605958">New384</span><span class="op" id="6605964">(</span><span class="op" id="6605965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605970">case</span>&nbsp;<span class="string" id="6605975">&#34;SHA-512&#34;</span><span class="op" id="6605984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605990">h</span>&nbsp;<span class="op" id="6605992">=</span>&nbsp;<span class="ident" id="6605994">sha512</span><span class="op" id="6606000">.</span><span class="ident" id="6606001">New</span><span class="op" id="6606004">(</span><span class="op" id="6606005">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606010">default</span><span class="op" id="6606017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606023">h</span>&nbsp;<span class="op" id="6606025">=</span>&nbsp;<span class="ident" id="6606027">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6606034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606040">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6606051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606056">if</span>&nbsp;<span class="ident" id="6606059">h</span>&nbsp;<span class="op" id="6606061">==</span>&nbsp;<span class="ident" id="6606064">nil</span>&nbsp;<span class="op" id="6606068">||</span>&nbsp;<span class="ident" id="6606071">pub</span><span class="op" id="6606074">.</span><span class="ident" id="6606075">Curve</span>&nbsp;<span class="op" id="6606081">==</span>&nbsp;<span class="ident" id="6606084">nil</span>&nbsp;<span class="op" id="6606088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606093">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6606104">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606109">switch</span>&nbsp;<span class="op" id="6606116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606120">case</span>&nbsp;<span class="ident" id="6606125">strings</span><span class="op" id="6606132">.</span><span class="ident" id="6606133">HasPrefix</span><span class="op" id="6606142">(</span><span class="ident" id="6606143">line</span><span class="op" id="6606147">,</span>&nbsp;<span class="string" id="6606149">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="6606157">)</span><span class="op" id="6606158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606163">if</span>&nbsp;<span class="ident" id="6606166">msg</span><span class="op" id="6606169">,</span>&nbsp;<span class="ident" id="6606171">err</span>&nbsp;<span class="op" id="6606175">=</span>&nbsp;<span class="ident" id="6606177">hex</span><span class="op" id="6606180">.</span><span class="ident" id="6606181">DecodeString</span><span class="op" id="6606193">(</span><span class="ident" id="6606194">line</span><span class="op" id="6606198">[</span><span class="num" id="6606199">6</span><span class="op" id="6606200">:</span><span class="op" id="6606201">]</span><span class="op" id="6606202">)</span><span class="op" id="6606203">;</span>&nbsp;<span class="ident" id="6606205">err</span>&nbsp;<span class="op" id="6606209">!=</span>&nbsp;<span class="ident" id="6606212">nil</span>&nbsp;<span class="op" id="6606216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606222">t</span><span class="op" id="6606223">.</span><span class="ident" id="6606224">Fatalf</span><span class="op" id="6606230">(</span><span class="string" id="6606231">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="6606272">,</span>&nbsp;<span class="ident" id="6606274">lineNo</span><span class="op" id="6606280">,</span>&nbsp;<span class="ident" id="6606282">err</span><span class="op" id="6606285">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6606290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606294">case</span>&nbsp;<span class="ident" id="6606299">strings</span><span class="op" id="6606306">.</span><span class="ident" id="6606307">HasPrefix</span><span class="op" id="6606316">(</span><span class="ident" id="6606317">line</span><span class="op" id="6606321">,</span>&nbsp;<span class="string" id="6606323">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="6606330">)</span><span class="op" id="6606331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606336">pub</span><span class="op" id="6606339">.</span><span class="ident" id="6606340">X</span>&nbsp;<span class="op" id="6606342">=</span>&nbsp;<span class="ident" id="6606344">fromHex</span><span class="op" id="6606351">(</span><span class="ident" id="6606352">line</span><span class="op" id="6606356">[</span><span class="num" id="6606357">5</span><span class="op" id="6606358">:</span><span class="op" id="6606359">]</span><span class="op" id="6606360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606364">case</span>&nbsp;<span class="ident" id="6606369">strings</span><span class="op" id="6606376">.</span><span class="ident" id="6606377">HasPrefix</span><span class="op" id="6606386">(</span><span class="ident" id="6606387">line</span><span class="op" id="6606391">,</span>&nbsp;<span class="string" id="6606393">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="6606400">)</span><span class="op" id="6606401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606406">pub</span><span class="op" id="6606409">.</span><span class="ident" id="6606410">Y</span>&nbsp;<span class="op" id="6606412">=</span>&nbsp;<span class="ident" id="6606414">fromHex</span><span class="op" id="6606421">(</span><span class="ident" id="6606422">line</span><span class="op" id="6606426">[</span><span class="num" id="6606427">5</span><span class="op" id="6606428">:</span><span class="op" id="6606429">]</span><span class="op" id="6606430">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606434">case</span>&nbsp;<span class="ident" id="6606439">strings</span><span class="op" id="6606446">.</span><span class="ident" id="6606447">HasPrefix</span><span class="op" id="6606456">(</span><span class="ident" id="6606457">line</span><span class="op" id="6606461">,</span>&nbsp;<span class="string" id="6606463">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="6606469">)</span><span class="op" id="6606470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606475">r</span>&nbsp;<span class="op" id="6606477">=</span>&nbsp;<span class="ident" id="6606479">fromHex</span><span class="op" id="6606486">(</span><span class="ident" id="6606487">line</span><span class="op" id="6606491">[</span><span class="num" id="6606492">4</span><span class="op" id="6606493">:</span><span class="op" id="6606494">]</span><span class="op" id="6606495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606499">case</span>&nbsp;<span class="ident" id="6606504">strings</span><span class="op" id="6606511">.</span><span class="ident" id="6606512">HasPrefix</span><span class="op" id="6606521">(</span><span class="ident" id="6606522">line</span><span class="op" id="6606526">,</span>&nbsp;<span class="string" id="6606528">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="6606534">)</span><span class="op" id="6606535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606540">s</span>&nbsp;<span class="op" id="6606542">=</span>&nbsp;<span class="ident" id="6606544">fromHex</span><span class="op" id="6606551">(</span><span class="ident" id="6606552">line</span><span class="op" id="6606556">[</span><span class="num" id="6606557">4</span><span class="op" id="6606558">:</span><span class="op" id="6606559">]</span><span class="op" id="6606560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606564">case</span>&nbsp;<span class="ident" id="6606569">strings</span><span class="op" id="6606576">.</span><span class="ident" id="6606577">HasPrefix</span><span class="op" id="6606586">(</span><span class="ident" id="6606587">line</span><span class="op" id="6606591">,</span>&nbsp;<span class="string" id="6606593">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="6606604">)</span><span class="op" id="6606605">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606610">expected</span>&nbsp;<span class="op" id="6606619">:=</span>&nbsp;<span class="ident" id="6606622">line</span><span class="op" id="6606626">[</span><span class="num" id="6606627">9</span><span class="op" id="6606628">]</span>&nbsp;<span class="op" id="6606630">==</span>&nbsp;<span class="string" id="6606633">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606640">h</span><span class="op" id="6606641">.</span><span class="ident" id="6606642">Reset</span><span class="op" id="6606647">(</span><span class="op" id="6606648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606653">h</span><span class="op" id="6606654">.</span><span class="ident" id="6606655">Write</span><span class="op" id="6606660">(</span><span class="ident" id="6606661">msg</span><span class="op" id="6606664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606669">hashed</span>&nbsp;<span class="op" id="6606676">:=</span>&nbsp;<span class="ident" id="6606679">h</span><span class="op" id="6606680">.</span><span class="ident" id="6606681">Sum</span><span class="op" id="6606684">(</span><span class="ident" id="6606685">hashed</span><span class="op" id="6606691">[</span><span class="op" id="6606692">:</span><span class="num" id="6606693">0</span><span class="op" id="6606694">]</span><span class="op" id="6606695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606700">if</span>&nbsp;<span class="ident" id="6606703">Verify</span><span class="op" id="6606709">(</span><span class="ident" id="6606710">pub</span><span class="op" id="6606713">,</span>&nbsp;<span class="ident" id="6606715">hashed</span><span class="op" id="6606721">,</span>&nbsp;<span class="ident" id="6606723">r</span><span class="op" id="6606724">,</span>&nbsp;<span class="ident" id="6606726">s</span><span class="op" id="6606727">)</span>&nbsp;<span class="op" id="6606729">!=</span>&nbsp;<span class="ident" id="6606732">expected</span>&nbsp;<span class="op" id="6606741">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606747">t</span><span class="op" id="6606748">.</span><span class="ident" id="6606749">Fatalf</span><span class="op" id="6606755">(</span><span class="string" id="6606756">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="6606785">,</span>&nbsp;<span class="ident" id="6606787">lineNo</span><span class="op" id="6606793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6606798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6606802">default</span><span class="op" id="6606809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6606814">t</span><span class="op" id="6606815">.</span><span class="ident" id="6606816">Fatalf</span><span class="op" id="6606822">(</span><span class="string" id="6606823">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="6606856">,</span>&nbsp;<span class="ident" id="6606858">lineNo</span><span class="op" id="6606864">,</span>&nbsp;<span class="ident" id="6606866">line</span><span class="op" id="6606870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6606874">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6606877">}</span><br>
<span class="lineno"></span><span class="op" id="6606879">}</span>
</div>
</body>
</html>
