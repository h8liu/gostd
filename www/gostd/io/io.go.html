<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io</h2>
<ul>
<li><a href="/gostd/io/io.go.html" class="current">io.go</a></li>
<li><a href="/gostd/io/io_test.go.html">io_test.go</a></li>
<li><a href="/gostd/io/multi.go.html">multi.go</a></li>
<li><a href="/gostd/io/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/io/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/io/pipe_test.go.html">pipe_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1330743">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1330798">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1330852">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1330903">//&nbsp;Package&nbsp;io&nbsp;provides&nbsp;basic&nbsp;interfaces&nbsp;to&nbsp;I/O&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1330962">//&nbsp;Its&nbsp;primary&nbsp;job&nbsp;is&nbsp;to&nbsp;wrap&nbsp;existing&nbsp;implementations&nbsp;of&nbsp;such&nbsp;primitives,</span><br>
<span class="lineno"></span><span class="comment" id="1331037">//&nbsp;such&nbsp;as&nbsp;those&nbsp;in&nbsp;package&nbsp;os,&nbsp;into&nbsp;shared&nbsp;public&nbsp;interfaces&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1331104">//&nbsp;abstract&nbsp;the&nbsp;functionality,&nbsp;plus&nbsp;some&nbsp;other&nbsp;related&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1331171">//</span><br>
<span class="lineno">10</span><span class="comment" id="1331174">//&nbsp;Because&nbsp;these&nbsp;interfaces&nbsp;and&nbsp;primitives&nbsp;wrap&nbsp;lower-level&nbsp;operations&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1331250">//&nbsp;various&nbsp;implementations,&nbsp;unless&nbsp;otherwise&nbsp;informed&nbsp;clients&nbsp;should&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1331323">//&nbsp;assume&nbsp;they&nbsp;are&nbsp;safe&nbsp;for&nbsp;parallel&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="1331371">package</span>&nbsp;<span class="ident" id="1331379">io</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1331383">import</span>&nbsp;<span class="op" id="1331390">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1331393">&#34;errors&#34;</span><br>
<span class="lineno"></span><span class="op" id="1331402">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1331405">//&nbsp;ErrShortWrite&nbsp;means&nbsp;that&nbsp;a&nbsp;write&nbsp;accepted&nbsp;fewer&nbsp;bytes&nbsp;than&nbsp;requested</span><br>
<span class="lineno">20</span><span class="comment" id="1331477">//&nbsp;but&nbsp;failed&nbsp;to&nbsp;return&nbsp;an&nbsp;explicit&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1331520">var</span>&nbsp;<span class="ident" id="1331524">ErrShortWrite</span>&nbsp;<span class="op" id="1331538">=</span>&nbsp;<span class="ident" id="1331540">errors</span><span class="op" id="1331546">.</span><span class="ident" id="1331547">New</span><span class="op" id="1331550">(</span><span class="string" id="1331551">&#34;short&nbsp;write&#34;</span><span class="op" id="1331564">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1331567">//&nbsp;ErrShortBuffer&nbsp;means&nbsp;that&nbsp;a&nbsp;read&nbsp;required&nbsp;a&nbsp;longer&nbsp;buffer&nbsp;than&nbsp;was&nbsp;provided.</span><br>
<span class="lineno"></span><span class="keyword" id="1331647">var</span>&nbsp;<span class="ident" id="1331651">ErrShortBuffer</span>&nbsp;<span class="op" id="1331666">=</span>&nbsp;<span class="ident" id="1331668">errors</span><span class="op" id="1331674">.</span><span class="ident" id="1331675">New</span><span class="op" id="1331678">(</span><span class="string" id="1331679">&#34;short&nbsp;buffer&#34;</span><span class="op" id="1331693">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1331696">//&nbsp;EOF&nbsp;is&nbsp;the&nbsp;error&nbsp;returned&nbsp;by&nbsp;Read&nbsp;when&nbsp;no&nbsp;more&nbsp;input&nbsp;is&nbsp;available.</span><br>
<span class="lineno"></span><span class="comment" id="1331766">//&nbsp;Functions&nbsp;should&nbsp;return&nbsp;EOF&nbsp;only&nbsp;to&nbsp;signal&nbsp;a&nbsp;graceful&nbsp;end&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1331837">//&nbsp;If&nbsp;the&nbsp;EOF&nbsp;occurs&nbsp;unexpectedly&nbsp;in&nbsp;a&nbsp;structured&nbsp;data&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="1331900">//&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;is&nbsp;either&nbsp;ErrUnexpectedEOF&nbsp;or&nbsp;some&nbsp;other&nbsp;error</span><br>
<span class="lineno">30</span><span class="comment" id="1331972">//&nbsp;giving&nbsp;more&nbsp;detail.</span><br>
<span class="lineno"></span><span class="keyword" id="1331995">var</span>&nbsp;<span class="ident" id="1331999">EOF</span>&nbsp;<span class="op" id="1332003">=</span>&nbsp;<span class="ident" id="1332005">errors</span><span class="op" id="1332011">.</span><span class="ident" id="1332012">New</span><span class="op" id="1332015">(</span><span class="string" id="1332016">&#34;EOF&#34;</span><span class="op" id="1332021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1332024">//&nbsp;ErrUnexpectedEOF&nbsp;means&nbsp;that&nbsp;EOF&nbsp;was&nbsp;encountered&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1332082">//&nbsp;middle&nbsp;of&nbsp;reading&nbsp;a&nbsp;fixed-size&nbsp;block&nbsp;or&nbsp;data&nbsp;structure.</span><br>
<span class="lineno">35</span><span class="keyword" id="1332141">var</span>&nbsp;<span class="ident" id="1332145">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="1332162">=</span>&nbsp;<span class="ident" id="1332164">errors</span><span class="op" id="1332170">.</span><span class="ident" id="1332171">New</span><span class="op" id="1332174">(</span><span class="string" id="1332175">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="1332191">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1332194">//&nbsp;ErrNoProgress&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;clients&nbsp;of&nbsp;an&nbsp;io.Reader&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="1332260">//&nbsp;many&nbsp;calls&nbsp;to&nbsp;Read&nbsp;have&nbsp;failed&nbsp;to&nbsp;return&nbsp;any&nbsp;data&nbsp;or&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="1332323">//&nbsp;usually&nbsp;the&nbsp;sign&nbsp;of&nbsp;a&nbsp;broken&nbsp;io.Reader&nbsp;implementation.</span><br>
<span class="lineno">40</span><span class="keyword" id="1332381">var</span>&nbsp;<span class="ident" id="1332385">ErrNoProgress</span>&nbsp;<span class="op" id="1332399">=</span>&nbsp;<span class="ident" id="1332401">errors</span><span class="op" id="1332407">.</span><span class="ident" id="1332408">New</span><span class="op" id="1332411">(</span><span class="string" id="1332412">&#34;multiple&nbsp;Read&nbsp;calls&nbsp;return&nbsp;no&nbsp;data&nbsp;or&nbsp;error&#34;</span><span class="op" id="1332457">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1332460">//&nbsp;Reader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1332521">//</span><br>
<span class="lineno"></span><span class="comment" id="1332524">//&nbsp;Read&nbsp;reads&nbsp;up&nbsp;to&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">45</span><span class="comment" id="1332597">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.&nbsp;&nbsp;Even&nbsp;if&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="1332665">//&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch&nbsp;space&nbsp;during&nbsp;the&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1332742">//&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,&nbsp;Read&nbsp;conventionally</span><br>
<span class="lineno"></span><span class="comment" id="1332813">//&nbsp;returns&nbsp;what&nbsp;is&nbsp;available&nbsp;instead&nbsp;of&nbsp;waiting&nbsp;for&nbsp;more.</span><br>
<span class="lineno"></span><span class="comment" id="1332871">//</span><br>
<span class="lineno">50</span><span class="comment" id="1332874">//&nbsp;When&nbsp;Read&nbsp;encounters&nbsp;an&nbsp;error&nbsp;or&nbsp;end-of-file&nbsp;condition&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="1332938">//&nbsp;successfully&nbsp;reading&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes,&nbsp;it&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1333000">//&nbsp;bytes&nbsp;read.&nbsp;&nbsp;It&nbsp;may&nbsp;return&nbsp;the&nbsp;(non-nil)&nbsp;error&nbsp;from&nbsp;the&nbsp;same&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="1333069">//&nbsp;or&nbsp;return&nbsp;the&nbsp;error&nbsp;(and&nbsp;n&nbsp;==&nbsp;0)&nbsp;from&nbsp;a&nbsp;subsequent&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1333129">//&nbsp;An&nbsp;instance&nbsp;of&nbsp;this&nbsp;general&nbsp;case&nbsp;is&nbsp;that&nbsp;a&nbsp;Reader&nbsp;returning</span><br>
<span class="lineno">55</span><span class="comment" id="1333192">//&nbsp;a&nbsp;non-zero&nbsp;number&nbsp;of&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;stream&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1333257">//&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.&nbsp;&nbsp;The&nbsp;next&nbsp;Read&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="1333322">//&nbsp;return&nbsp;0,&nbsp;EOF&nbsp;regardless.</span><br>
<span class="lineno"></span><span class="comment" id="1333351">//</span><br>
<span class="lineno"></span><span class="comment" id="1333354">//&nbsp;Callers&nbsp;should&nbsp;always&nbsp;process&nbsp;the&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes&nbsp;returned&nbsp;before</span><br>
<span class="lineno">60</span><span class="comment" id="1333419">//&nbsp;considering&nbsp;the&nbsp;error&nbsp;err.&nbsp;&nbsp;Doing&nbsp;so&nbsp;correctly&nbsp;handles&nbsp;I/O&nbsp;errors</span><br>
<span class="lineno"></span><span class="comment" id="1333488">//&nbsp;that&nbsp;happen&nbsp;after&nbsp;reading&nbsp;some&nbsp;bytes&nbsp;and&nbsp;also&nbsp;both&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1333549">//&nbsp;allowed&nbsp;EOF&nbsp;behaviors.</span><br>
<span class="lineno"></span><span class="comment" id="1333575">//</span><br>
<span class="lineno"></span><span class="comment" id="1333578">//&nbsp;Implementations&nbsp;of&nbsp;Read&nbsp;are&nbsp;discouraged&nbsp;from&nbsp;returning&nbsp;a</span><br>
<span class="lineno">65</span><span class="comment" id="1333638">//&nbsp;zero&nbsp;byte&nbsp;count&nbsp;with&nbsp;a&nbsp;nil&nbsp;error,&nbsp;except&nbsp;when&nbsp;len(p)&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1333700">//&nbsp;Callers&nbsp;should&nbsp;treat&nbsp;a&nbsp;return&nbsp;of&nbsp;0&nbsp;and&nbsp;nil&nbsp;as&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1333765">//&nbsp;nothing&nbsp;happened;&nbsp;in&nbsp;particular&nbsp;it&nbsp;does&nbsp;not&nbsp;indicate&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1333826">//</span><br>
<span class="lineno"></span><span class="comment" id="1333829">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno">70</span><span class="keyword" id="1333867">type</span>&nbsp;<span class="ident" id="1333872">Reader</span>&nbsp;<span class="keyword" id="1333879">interface</span>&nbsp;<span class="op" id="1333889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1333892">Read</span><span class="op" id="1333896">(</span><span class="ident" id="1333897">p</span>&nbsp;<span class="op" id="1333899">[</span><span class="op" id="1333900">]</span><span class="builtintype" id="1333901">byte</span><span class="op" id="1333905">)</span>&nbsp;<span class="op" id="1333907">(</span><span class="ident" id="1333908">n</span>&nbsp;<span class="builtintype" id="1333910">int</span><span class="op" id="1333913">,</span>&nbsp;<span class="ident" id="1333915">err</span>&nbsp;<span class="builtintype" id="1333919">error</span><span class="op" id="1333924">)</span><br>
<span class="lineno"></span><span class="op" id="1333926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1333929">//&nbsp;Writer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">75</span><span class="comment" id="1333991">//</span><br>
<span class="lineno"></span><span class="comment" id="1333994">//&nbsp;Write&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="1334061">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno"></span><span class="comment" id="1334129">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1334195">//&nbsp;Write&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno">80</span><span class="comment" id="1334258">//&nbsp;Write&nbsp;must&nbsp;not&nbsp;modify&nbsp;the&nbsp;slice&nbsp;data,&nbsp;even&nbsp;temporarily.</span><br>
<span class="lineno"></span><span class="comment" id="1334317">//</span><br>
<span class="lineno"></span><span class="comment" id="1334320">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1334358">type</span>&nbsp;<span class="ident" id="1334363">Writer</span>&nbsp;<span class="keyword" id="1334370">interface</span>&nbsp;<span class="op" id="1334380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1334383">Write</span><span class="op" id="1334388">(</span><span class="ident" id="1334389">p</span>&nbsp;<span class="op" id="1334391">[</span><span class="op" id="1334392">]</span><span class="builtintype" id="1334393">byte</span><span class="op" id="1334397">)</span>&nbsp;<span class="op" id="1334399">(</span><span class="ident" id="1334400">n</span>&nbsp;<span class="builtintype" id="1334402">int</span><span class="op" id="1334405">,</span>&nbsp;<span class="ident" id="1334407">err</span>&nbsp;<span class="builtintype" id="1334411">error</span><span class="op" id="1334416">)</span><br>
<span class="lineno">85</span><span class="op" id="1334418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1334421">//&nbsp;Closer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1334483">//</span><br>
<span class="lineno"></span><span class="comment" id="1334486">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Close&nbsp;after&nbsp;the&nbsp;first&nbsp;call&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">90</span><span class="comment" id="1334546">//&nbsp;Specific&nbsp;implementations&nbsp;may&nbsp;document&nbsp;their&nbsp;own&nbsp;behavior.</span><br>
<span class="lineno"></span><span class="keyword" id="1334607">type</span>&nbsp;<span class="ident" id="1334612">Closer</span>&nbsp;<span class="keyword" id="1334619">interface</span>&nbsp;<span class="op" id="1334629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1334632">Close</span><span class="op" id="1334637">(</span><span class="op" id="1334638">)</span>&nbsp;<span class="builtintype" id="1334640">error</span><br>
<span class="lineno"></span><span class="op" id="1334646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1334649">//&nbsp;Seeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Seek&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1334710">//</span><br>
<span class="lineno"></span><span class="comment" id="1334713">//&nbsp;Seek&nbsp;sets&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;next&nbsp;Read&nbsp;or&nbsp;Write&nbsp;to&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1334775">//&nbsp;interpreted&nbsp;according&nbsp;to&nbsp;whence:&nbsp;0&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;origin&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1334845">//&nbsp;the&nbsp;file,&nbsp;1&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;offset,&nbsp;and&nbsp;2&nbsp;means</span><br>
<span class="lineno">100</span><span class="comment" id="1334910">//&nbsp;relative&nbsp;to&nbsp;the&nbsp;end.&nbsp;&nbsp;Seek&nbsp;returns&nbsp;the&nbsp;new&nbsp;offset&nbsp;and&nbsp;an&nbsp;error,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1334980">//&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1334988">//</span><br>
<span class="lineno"></span><span class="comment" id="1334991">//&nbsp;Seeking&nbsp;to&nbsp;a&nbsp;negative&nbsp;offset&nbsp;is&nbsp;an&nbsp;error.&nbsp;Seeking&nbsp;to&nbsp;any&nbsp;positive</span><br>
<span class="lineno"></span><span class="comment" id="1335060">//&nbsp;offset&nbsp;is&nbsp;legal,&nbsp;but&nbsp;the&nbsp;behavior&nbsp;of&nbsp;subsequent&nbsp;I/O&nbsp;operations&nbsp;on</span><br>
<span class="lineno">105</span><span class="comment" id="1335129">//&nbsp;the&nbsp;underlying&nbsp;object&nbsp;is&nbsp;implementation-dependent.</span><br>
<span class="lineno"></span><span class="keyword" id="1335183">type</span>&nbsp;<span class="ident" id="1335188">Seeker</span>&nbsp;<span class="keyword" id="1335195">interface</span>&nbsp;<span class="op" id="1335205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335208">Seek</span><span class="op" id="1335212">(</span><span class="ident" id="1335213">offset</span>&nbsp;<span class="builtintype" id="1335220">int64</span><span class="op" id="1335225">,</span>&nbsp;<span class="ident" id="1335227">whence</span>&nbsp;<span class="builtintype" id="1335234">int</span><span class="op" id="1335237">)</span>&nbsp;<span class="op" id="1335239">(</span><span class="builtintype" id="1335240">int64</span><span class="op" id="1335245">,</span>&nbsp;<span class="builtintype" id="1335247">error</span><span class="op" id="1335252">)</span><br>
<span class="lineno"></span><span class="op" id="1335254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1335257">//&nbsp;ReadWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Write&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1335334">type</span>&nbsp;<span class="ident" id="1335339">ReadWriter</span>&nbsp;<span class="keyword" id="1335350">interface</span>&nbsp;<span class="op" id="1335360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335363">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335371">Writer</span><br>
<span class="lineno"></span><span class="op" id="1335378">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="1335381">//&nbsp;ReadCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1335458">type</span>&nbsp;<span class="ident" id="1335463">ReadCloser</span>&nbsp;<span class="keyword" id="1335474">interface</span>&nbsp;<span class="op" id="1335484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335487">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335495">Closer</span><br>
<span class="lineno">120</span><span class="op" id="1335502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1335505">//&nbsp;WriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1335584">type</span>&nbsp;<span class="ident" id="1335589">WriteCloser</span>&nbsp;<span class="keyword" id="1335601">interface</span>&nbsp;<span class="op" id="1335611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335614">Writer</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335622">Closer</span><br>
<span class="lineno"></span><span class="op" id="1335629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1335632">//&nbsp;ReadWriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1335721">type</span>&nbsp;<span class="ident" id="1335726">ReadWriteCloser</span>&nbsp;<span class="keyword" id="1335742">interface</span>&nbsp;<span class="op" id="1335752">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335755">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335763">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335771">Closer</span><br>
<span class="lineno"></span><span class="op" id="1335778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="1335781">//&nbsp;ReadSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1335857">type</span>&nbsp;<span class="ident" id="1335862">ReadSeeker</span>&nbsp;<span class="keyword" id="1335873">interface</span>&nbsp;<span class="op" id="1335883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335886">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335894">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1335901">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1335904">//&nbsp;WriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1335982">type</span>&nbsp;<span class="ident" id="1335987">WriteSeeker</span>&nbsp;<span class="keyword" id="1335999">interface</span>&nbsp;<span class="op" id="1336009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1336012">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1336020">Seeker</span><br>
<span class="lineno">145</span><span class="op" id="1336027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1336030">//&nbsp;ReadWriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1336118">type</span>&nbsp;<span class="ident" id="1336123">ReadWriteSeeker</span>&nbsp;<span class="keyword" id="1336139">interface</span>&nbsp;<span class="op" id="1336149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1336152">Reader</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1336160">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1336168">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1336175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1336178">//&nbsp;ReaderFrom&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno">155</span><span class="comment" id="1336241">//</span><br>
<span class="lineno"></span><span class="comment" id="1336244">//&nbsp;ReadFrom&nbsp;reads&nbsp;data&nbsp;from&nbsp;r&nbsp;until&nbsp;EOF&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="1336294">//&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1336345">//&nbsp;Any&nbsp;error&nbsp;except&nbsp;io.EOF&nbsp;encountered&nbsp;during&nbsp;the&nbsp;read&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="1336418">//</span><br>
<span class="lineno">160</span><span class="comment" id="1336421">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;ReaderFrom&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1336472">type</span>&nbsp;<span class="ident" id="1336477">ReaderFrom</span>&nbsp;<span class="keyword" id="1336488">interface</span>&nbsp;<span class="op" id="1336498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1336501">ReadFrom</span><span class="op" id="1336509">(</span><span class="ident" id="1336510">r</span>&nbsp;<span class="ident" id="1336512">Reader</span><span class="op" id="1336518">)</span>&nbsp;<span class="op" id="1336520">(</span><span class="ident" id="1336521">n</span>&nbsp;<span class="builtintype" id="1336523">int64</span><span class="op" id="1336528">,</span>&nbsp;<span class="ident" id="1336530">err</span>&nbsp;<span class="builtintype" id="1336534">error</span><span class="op" id="1336539">)</span><br>
<span class="lineno"></span><span class="op" id="1336541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="1336544">//&nbsp;WriterTo&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1336604">//</span><br>
<span class="lineno"></span><span class="comment" id="1336607">//&nbsp;WriteTo&nbsp;writes&nbsp;data&nbsp;to&nbsp;w&nbsp;until&nbsp;there&#39;s&nbsp;no&nbsp;more&nbsp;data&nbsp;to&nbsp;write&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1336674">//&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="1336741">//&nbsp;written.&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;during&nbsp;the&nbsp;write&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno">170</span><span class="comment" id="1336810">//</span><br>
<span class="lineno"></span><span class="comment" id="1336813">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;WriterTo&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1336862">type</span>&nbsp;<span class="ident" id="1336867">WriterTo</span>&nbsp;<span class="keyword" id="1336876">interface</span>&nbsp;<span class="op" id="1336886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1336889">WriteTo</span><span class="op" id="1336896">(</span><span class="ident" id="1336897">w</span>&nbsp;<span class="ident" id="1336899">Writer</span><span class="op" id="1336905">)</span>&nbsp;<span class="op" id="1336907">(</span><span class="ident" id="1336908">n</span>&nbsp;<span class="builtintype" id="1336910">int64</span><span class="op" id="1336915">,</span>&nbsp;<span class="ident" id="1336917">err</span>&nbsp;<span class="builtintype" id="1336921">error</span><span class="op" id="1336926">)</span><br>
<span class="lineno"></span><span class="op" id="1336928">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="1336931">//&nbsp;ReaderAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1336996">//</span><br>
<span class="lineno"></span><span class="comment" id="1336999">//&nbsp;ReadAt&nbsp;reads&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1337065">//&nbsp;underlying&nbsp;input&nbsp;source.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">180</span><span class="comment" id="1337125">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="comment" id="1337179">//</span><br>
<span class="lineno"></span><span class="comment" id="1337182">//&nbsp;When&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1337244">//&nbsp;explaining&nbsp;why&nbsp;more&nbsp;bytes&nbsp;were&nbsp;not&nbsp;returned.&nbsp;&nbsp;In&nbsp;this&nbsp;respect,</span><br>
<span class="lineno"></span><span class="comment" id="1337310">//&nbsp;ReadAt&nbsp;is&nbsp;stricter&nbsp;than&nbsp;Read.</span><br>
<span class="lineno">185</span><span class="comment" id="1337343">//</span><br>
<span class="lineno"></span><span class="comment" id="1337346">//&nbsp;Even&nbsp;if&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch</span><br>
<span class="lineno"></span><span class="comment" id="1337415">//&nbsp;space&nbsp;during&nbsp;the&nbsp;call.&nbsp;&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1337490">//&nbsp;ReadAt&nbsp;blocks&nbsp;until&nbsp;either&nbsp;all&nbsp;the&nbsp;data&nbsp;is&nbsp;available&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="1337566">//&nbsp;In&nbsp;this&nbsp;respect&nbsp;ReadAt&nbsp;is&nbsp;different&nbsp;from&nbsp;Read.</span><br>
<span class="lineno">190</span><span class="comment" id="1337616">//</span><br>
<span class="lineno"></span><span class="comment" id="1337619">//&nbsp;If&nbsp;the&nbsp;n&nbsp;=&nbsp;len(p)&nbsp;bytes&nbsp;returned&nbsp;by&nbsp;ReadAt&nbsp;are&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1337687">//&nbsp;input&nbsp;source,&nbsp;ReadAt&nbsp;may&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1337755">//</span><br>
<span class="lineno"></span><span class="comment" id="1337758">//&nbsp;If&nbsp;ReadAt&nbsp;is&nbsp;reading&nbsp;from&nbsp;an&nbsp;input&nbsp;source&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno">195</span><span class="comment" id="1337823">//&nbsp;ReadAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="1337885">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1337901">//</span><br>
<span class="lineno"></span><span class="comment" id="1337904">//&nbsp;Clients&nbsp;of&nbsp;ReadAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;ReadAt&nbsp;calls&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1337966">//&nbsp;same&nbsp;input&nbsp;source.</span><br>
<span class="lineno">200</span><span class="comment" id="1337988">//</span><br>
<span class="lineno"></span><span class="comment" id="1337991">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1338029">type</span>&nbsp;<span class="ident" id="1338034">ReaderAt</span>&nbsp;<span class="keyword" id="1338043">interface</span>&nbsp;<span class="op" id="1338053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1338056">ReadAt</span><span class="op" id="1338062">(</span><span class="ident" id="1338063">p</span>&nbsp;<span class="op" id="1338065">[</span><span class="op" id="1338066">]</span><span class="builtintype" id="1338067">byte</span><span class="op" id="1338071">,</span>&nbsp;<span class="ident" id="1338073">off</span>&nbsp;<span class="builtintype" id="1338077">int64</span><span class="op" id="1338082">)</span>&nbsp;<span class="op" id="1338084">(</span><span class="ident" id="1338085">n</span>&nbsp;<span class="builtintype" id="1338087">int</span><span class="op" id="1338090">,</span>&nbsp;<span class="ident" id="1338092">err</span>&nbsp;<span class="builtintype" id="1338096">error</span><span class="op" id="1338101">)</span><br>
<span class="lineno"></span><span class="op" id="1338103">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="1338106">//&nbsp;WriterAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;WriteAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1338172">//</span><br>
<span class="lineno"></span><span class="comment" id="1338175">//&nbsp;WriteAt&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream</span><br>
<span class="lineno"></span><span class="comment" id="1338243">//&nbsp;at&nbsp;offset&nbsp;off.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno">210</span><span class="comment" id="1338327">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1338393">//&nbsp;WriteAt&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno"></span><span class="comment" id="1338458">//</span><br>
<span class="lineno"></span><span class="comment" id="1338461">//&nbsp;If&nbsp;WriteAt&nbsp;is&nbsp;writing&nbsp;to&nbsp;a&nbsp;destination&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1338523">//&nbsp;WriteAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">215</span><span class="comment" id="1338586">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1338602">//</span><br>
<span class="lineno"></span><span class="comment" id="1338605">//&nbsp;Clients&nbsp;of&nbsp;WriteAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;WriteAt&nbsp;calls&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="1338674">//&nbsp;destination&nbsp;if&nbsp;the&nbsp;ranges&nbsp;do&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="comment" id="1338719">//</span><br>
<span class="lineno">220</span><span class="comment" id="1338722">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1338760">type</span>&nbsp;<span class="ident" id="1338765">WriterAt</span>&nbsp;<span class="keyword" id="1338774">interface</span>&nbsp;<span class="op" id="1338784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1338787">WriteAt</span><span class="op" id="1338794">(</span><span class="ident" id="1338795">p</span>&nbsp;<span class="op" id="1338797">[</span><span class="op" id="1338798">]</span><span class="builtintype" id="1338799">byte</span><span class="op" id="1338803">,</span>&nbsp;<span class="ident" id="1338805">off</span>&nbsp;<span class="builtintype" id="1338809">int64</span><span class="op" id="1338814">)</span>&nbsp;<span class="op" id="1338816">(</span><span class="ident" id="1338817">n</span>&nbsp;<span class="builtintype" id="1338819">int</span><span class="op" id="1338822">,</span>&nbsp;<span class="ident" id="1338824">err</span>&nbsp;<span class="builtintype" id="1338828">error</span><span class="op" id="1338833">)</span><br>
<span class="lineno"></span><span class="op" id="1338835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="1338838">//&nbsp;ByteReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1338901">//</span><br>
<span class="lineno"></span><span class="comment" id="1338904">//&nbsp;ReadByte&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1338964">//&nbsp;If&nbsp;no&nbsp;byte&nbsp;is&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="1339009">type</span>&nbsp;<span class="ident" id="1339014">ByteReader</span>&nbsp;<span class="keyword" id="1339025">interface</span>&nbsp;<span class="op" id="1339035">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1339038">ReadByte</span><span class="op" id="1339046">(</span><span class="op" id="1339047">)</span>&nbsp;<span class="op" id="1339049">(</span><span class="ident" id="1339050">c</span>&nbsp;<span class="builtintype" id="1339052">byte</span><span class="op" id="1339056">,</span>&nbsp;<span class="ident" id="1339058">err</span>&nbsp;<span class="builtintype" id="1339062">error</span><span class="op" id="1339067">)</span><br>
<span class="lineno"></span><span class="op" id="1339069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1339072">//&nbsp;ByteScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadByte&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1339143">//&nbsp;basic&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno">235</span><span class="comment" id="1339169">//</span><br>
<span class="lineno"></span><span class="comment" id="1339172">//&nbsp;UnreadByte&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadByte&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="1339243">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno"></span><span class="comment" id="1339280">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadByte&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno"></span><span class="comment" id="1339350">//&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno">240</span><span class="keyword" id="1339371">type</span>&nbsp;<span class="ident" id="1339376">ByteScanner</span>&nbsp;<span class="keyword" id="1339388">interface</span>&nbsp;<span class="op" id="1339398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1339401">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1339413">UnreadByte</span><span class="op" id="1339423">(</span><span class="op" id="1339424">)</span>&nbsp;<span class="builtintype" id="1339426">error</span><br>
<span class="lineno"></span><span class="op" id="1339432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1339435">//&nbsp;ByteWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1339499">type</span>&nbsp;<span class="ident" id="1339504">ByteWriter</span>&nbsp;<span class="keyword" id="1339515">interface</span>&nbsp;<span class="op" id="1339525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1339528">WriteByte</span><span class="op" id="1339537">(</span><span class="ident" id="1339538">c</span>&nbsp;<span class="builtintype" id="1339540">byte</span><span class="op" id="1339544">)</span>&nbsp;<span class="builtintype" id="1339546">error</span><br>
<span class="lineno"></span><span class="op" id="1339552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1339555">//&nbsp;RuneReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1339618">//</span><br>
<span class="lineno"></span><span class="comment" id="1339621">//&nbsp;ReadRune&nbsp;reads&nbsp;a&nbsp;single&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="1339680">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and&nbsp;its&nbsp;size&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;no&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1339746">//&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno">255</span><span class="keyword" id="1339777">type</span>&nbsp;<span class="ident" id="1339782">RuneReader</span>&nbsp;<span class="keyword" id="1339793">interface</span>&nbsp;<span class="op" id="1339803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1339806">ReadRune</span><span class="op" id="1339814">(</span><span class="op" id="1339815">)</span>&nbsp;<span class="op" id="1339817">(</span><span class="ident" id="1339818">r</span>&nbsp;<span class="builtintype" id="1339820">rune</span><span class="op" id="1339824">,</span>&nbsp;<span class="ident" id="1339826">size</span>&nbsp;<span class="builtintype" id="1339831">int</span><span class="op" id="1339834">,</span>&nbsp;<span class="ident" id="1339836">err</span>&nbsp;<span class="builtintype" id="1339840">error</span><span class="op" id="1339845">)</span><br>
<span class="lineno"></span><span class="op" id="1339847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1339850">//&nbsp;RuneScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadRune&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1339921">//&nbsp;basic&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1339947">//</span><br>
<span class="lineno"></span><span class="comment" id="1339950">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune</span><br>
<span class="lineno"></span><span class="comment" id="1340021">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="comment" id="1340058">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadRune&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno">265</span><span class="comment" id="1340128">//&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="keyword" id="1340149">type</span>&nbsp;<span class="ident" id="1340154">RuneScanner</span>&nbsp;<span class="keyword" id="1340166">interface</span>&nbsp;<span class="op" id="1340176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1340179">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1340191">UnreadRune</span><span class="op" id="1340201">(</span><span class="op" id="1340202">)</span>&nbsp;<span class="builtintype" id="1340204">error</span><br>
<span class="lineno"></span><span class="op" id="1340210">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="1340213">//&nbsp;stringWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteString&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1340281">type</span>&nbsp;<span class="ident" id="1340286">stringWriter</span>&nbsp;<span class="keyword" id="1340299">interface</span>&nbsp;<span class="op" id="1340309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1340312">WriteString</span><span class="op" id="1340323">(</span><span class="ident" id="1340324">s</span>&nbsp;<span class="builtintype" id="1340326">string</span><span class="op" id="1340332">)</span>&nbsp;<span class="op" id="1340334">(</span><span class="ident" id="1340335">n</span>&nbsp;<span class="builtintype" id="1340337">int</span><span class="op" id="1340340">,</span>&nbsp;<span class="ident" id="1340342">err</span>&nbsp;<span class="builtintype" id="1340346">error</span><span class="op" id="1340351">)</span><br>
<span class="lineno"></span><span class="op" id="1340353">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="1340356">//&nbsp;WriteString&nbsp;writes&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;w,&nbsp;which&nbsp;accepts&nbsp;an&nbsp;array&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1340446">//&nbsp;If&nbsp;w&nbsp;already&nbsp;implements&nbsp;a&nbsp;WriteString&nbsp;method,&nbsp;it&nbsp;is&nbsp;invoked&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="1340519">func</span>&nbsp;<span class="ident" id="1340524">WriteString</span><span class="op" id="1340535">(</span><span class="ident" id="1340536">w</span>&nbsp;<span class="ident" id="1340538">Writer</span><span class="op" id="1340544">,</span>&nbsp;<span class="ident" id="1340546">s</span>&nbsp;<span class="builtintype" id="1340548">string</span><span class="op" id="1340554">)</span>&nbsp;<span class="op" id="1340556">(</span><span class="ident" id="1340557">n</span>&nbsp;<span class="builtintype" id="1340559">int</span><span class="op" id="1340562">,</span>&nbsp;<span class="ident" id="1340564">err</span>&nbsp;<span class="builtintype" id="1340568">error</span><span class="op" id="1340573">)</span>&nbsp;<span class="op" id="1340575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1340578">if</span>&nbsp;<span class="ident" id="1340581">sw</span><span class="op" id="1340583">,</span>&nbsp;<span class="ident" id="1340585">ok</span>&nbsp;<span class="op" id="1340588">:=</span>&nbsp;<span class="ident" id="1340591">w</span><span class="op" id="1340592">.</span><span class="op" id="1340593">(</span><span class="ident" id="1340594">stringWriter</span><span class="op" id="1340606">)</span><span class="op" id="1340607">;</span>&nbsp;<span class="ident" id="1340609">ok</span>&nbsp;<span class="op" id="1340612">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1340616">return</span>&nbsp;<span class="ident" id="1340623">sw</span><span class="op" id="1340625">.</span><span class="ident" id="1340626">WriteString</span><span class="op" id="1340637">(</span><span class="ident" id="1340638">s</span><span class="op" id="1340639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1340642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1340645">return</span>&nbsp;<span class="ident" id="1340652">w</span><span class="op" id="1340653">.</span><span class="ident" id="1340654">Write</span><span class="op" id="1340659">(</span><span class="op" id="1340660">[</span><span class="op" id="1340661">]</span><span class="builtintype" id="1340662">byte</span><span class="op" id="1340666">(</span><span class="ident" id="1340667">s</span><span class="op" id="1340668">)</span><span class="op" id="1340669">)</span><br>
<span class="lineno"></span><span class="op" id="1340671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="1340674">//&nbsp;ReadAtLeast&nbsp;reads&nbsp;from&nbsp;r&nbsp;into&nbsp;buf&nbsp;until&nbsp;it&nbsp;has&nbsp;read&nbsp;at&nbsp;least&nbsp;min&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1340749">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1340829">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1340877">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;fewer&nbsp;than&nbsp;min&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1340934">//&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno">290</span><span class="comment" id="1340975">//&nbsp;If&nbsp;min&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;buf,&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrShortBuffer.</span><br>
<span class="lineno"></span><span class="comment" id="1341056">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;&gt;=&nbsp;min&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1341106">func</span>&nbsp;<span class="ident" id="1341111">ReadAtLeast</span><span class="op" id="1341122">(</span><span class="ident" id="1341123">r</span>&nbsp;<span class="ident" id="1341125">Reader</span><span class="op" id="1341131">,</span>&nbsp;<span class="ident" id="1341133">buf</span>&nbsp;<span class="op" id="1341137">[</span><span class="op" id="1341138">]</span><span class="builtintype" id="1341139">byte</span><span class="op" id="1341143">,</span>&nbsp;<span class="ident" id="1341145">min</span>&nbsp;<span class="builtintype" id="1341149">int</span><span class="op" id="1341152">)</span>&nbsp;<span class="op" id="1341154">(</span><span class="ident" id="1341155">n</span>&nbsp;<span class="builtintype" id="1341157">int</span><span class="op" id="1341160">,</span>&nbsp;<span class="ident" id="1341162">err</span>&nbsp;<span class="builtintype" id="1341166">error</span><span class="op" id="1341171">)</span>&nbsp;<span class="op" id="1341173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1341176">if</span>&nbsp;<span class="builtinfunc" id="1341179">len</span><span class="op" id="1341182">(</span><span class="ident" id="1341183">buf</span><span class="op" id="1341186">)</span>&nbsp;<span class="op" id="1341188">&lt;</span>&nbsp;<span class="ident" id="1341190">min</span>&nbsp;<span class="op" id="1341194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1341198">return</span>&nbsp;<span class="num" id="1341205">0</span><span class="op" id="1341206">,</span>&nbsp;<span class="ident" id="1341208">ErrShortBuffer</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1341224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1341227">for</span>&nbsp;<span class="ident" id="1341231">n</span>&nbsp;<span class="op" id="1341233">&lt;</span>&nbsp;<span class="ident" id="1341235">min</span>&nbsp;<span class="op" id="1341239">&amp;&amp;</span>&nbsp;<span class="ident" id="1341242">err</span>&nbsp;<span class="op" id="1341246">==</span>&nbsp;<span class="builtintype" id="1341249">nil</span>&nbsp;<span class="op" id="1341253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1341257">var</span>&nbsp;<span class="ident" id="1341261">nn</span>&nbsp;<span class="builtintype" id="1341264">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1341270">nn</span><span class="op" id="1341272">,</span>&nbsp;<span class="ident" id="1341274">err</span>&nbsp;<span class="op" id="1341278">=</span>&nbsp;<span class="ident" id="1341280">r</span><span class="op" id="1341281">.</span><span class="ident" id="1341282">Read</span><span class="op" id="1341286">(</span><span class="ident" id="1341287">buf</span><span class="op" id="1341290">[</span><span class="ident" id="1341291">n</span><span class="op" id="1341292">:</span><span class="op" id="1341293">]</span><span class="op" id="1341294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1341298">n</span>&nbsp;<span class="op" id="1341300">+=</span>&nbsp;<span class="ident" id="1341303">nn</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1341307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1341310">if</span>&nbsp;<span class="ident" id="1341313">n</span>&nbsp;<span class="op" id="1341315">&gt;=</span>&nbsp;<span class="ident" id="1341318">min</span>&nbsp;<span class="op" id="1341322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1341326">err</span>&nbsp;<span class="op" id="1341330">=</span>&nbsp;<span class="builtintype" id="1341332">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1341337">}</span>&nbsp;<span class="keyword" id="1341339">else</span>&nbsp;<span class="keyword" id="1341344">if</span>&nbsp;<span class="ident" id="1341347">n</span>&nbsp;<span class="op" id="1341349">&gt;</span>&nbsp;<span class="num" id="1341351">0</span>&nbsp;<span class="op" id="1341353">&amp;&amp;</span>&nbsp;<span class="ident" id="1341356">err</span>&nbsp;<span class="op" id="1341360">==</span>&nbsp;<span class="ident" id="1341363">EOF</span>&nbsp;<span class="op" id="1341367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1341371">err</span>&nbsp;<span class="op" id="1341375">=</span>&nbsp;<span class="ident" id="1341377">ErrUnexpectedEOF</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1341395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1341398">return</span><br>
<span class="lineno"></span><span class="op" id="1341405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1341408">//&nbsp;ReadFull&nbsp;reads&nbsp;exactly&nbsp;len(buf)&nbsp;bytes&nbsp;from&nbsp;r&nbsp;into&nbsp;buf.</span><br>
<span class="lineno">310</span><span class="comment" id="1341466">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1341546">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1341594">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;some&nbsp;but&nbsp;not&nbsp;all&nbsp;the&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1341657">//&nbsp;ReadFull&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno"></span><span class="comment" id="1341695">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;==&nbsp;len(buf)&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno">315</span><span class="keyword" id="1341750">func</span>&nbsp;<span class="ident" id="1341755">ReadFull</span><span class="op" id="1341763">(</span><span class="ident" id="1341764">r</span>&nbsp;<span class="ident" id="1341766">Reader</span><span class="op" id="1341772">,</span>&nbsp;<span class="ident" id="1341774">buf</span>&nbsp;<span class="op" id="1341778">[</span><span class="op" id="1341779">]</span><span class="builtintype" id="1341780">byte</span><span class="op" id="1341784">)</span>&nbsp;<span class="op" id="1341786">(</span><span class="ident" id="1341787">n</span>&nbsp;<span class="builtintype" id="1341789">int</span><span class="op" id="1341792">,</span>&nbsp;<span class="ident" id="1341794">err</span>&nbsp;<span class="builtintype" id="1341798">error</span><span class="op" id="1341803">)</span>&nbsp;<span class="op" id="1341805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1341808">return</span>&nbsp;<span class="ident" id="1341815">ReadAtLeast</span><span class="op" id="1341826">(</span><span class="ident" id="1341827">r</span><span class="op" id="1341828">,</span>&nbsp;<span class="ident" id="1341830">buf</span><span class="op" id="1341833">,</span>&nbsp;<span class="builtinfunc" id="1341835">len</span><span class="op" id="1341838">(</span><span class="ident" id="1341839">buf</span><span class="op" id="1341842">)</span><span class="op" id="1341843">)</span><br>
<span class="lineno"></span><span class="op" id="1341845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1341848">//&nbsp;CopyN&nbsp;copies&nbsp;n&nbsp;bytes&nbsp;(or&nbsp;until&nbsp;an&nbsp;error)&nbsp;from&nbsp;src&nbsp;to&nbsp;dst.</span><br>
<span class="lineno">320</span><span class="comment" id="1341909">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;the&nbsp;earliest</span><br>
<span class="lineno"></span><span class="comment" id="1341967">//&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying.</span><br>
<span class="lineno"></span><span class="comment" id="1342003">//&nbsp;On&nbsp;return,&nbsp;written&nbsp;==&nbsp;n&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1342057">//</span><br>
<span class="lineno"></span><span class="comment" id="1342060">//&nbsp;If&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno">325</span><span class="comment" id="1342107">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;using&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1342144">func</span>&nbsp;<span class="ident" id="1342149">CopyN</span><span class="op" id="1342154">(</span><span class="ident" id="1342155">dst</span>&nbsp;<span class="ident" id="1342159">Writer</span><span class="op" id="1342165">,</span>&nbsp;<span class="ident" id="1342167">src</span>&nbsp;<span class="ident" id="1342171">Reader</span><span class="op" id="1342177">,</span>&nbsp;<span class="ident" id="1342179">n</span>&nbsp;<span class="builtintype" id="1342181">int64</span><span class="op" id="1342186">)</span>&nbsp;<span class="op" id="1342188">(</span><span class="ident" id="1342189">written</span>&nbsp;<span class="builtintype" id="1342197">int64</span><span class="op" id="1342202">,</span>&nbsp;<span class="ident" id="1342204">err</span>&nbsp;<span class="builtintype" id="1342208">error</span><span class="op" id="1342213">)</span>&nbsp;<span class="op" id="1342215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1342218">written</span><span class="op" id="1342225">,</span>&nbsp;<span class="ident" id="1342227">err</span>&nbsp;<span class="op" id="1342231">=</span>&nbsp;<span class="ident" id="1342233">Copy</span><span class="op" id="1342237">(</span><span class="ident" id="1342238">dst</span><span class="op" id="1342241">,</span>&nbsp;<span class="ident" id="1342243">LimitReader</span><span class="op" id="1342254">(</span><span class="ident" id="1342255">src</span><span class="op" id="1342258">,</span>&nbsp;<span class="ident" id="1342260">n</span><span class="op" id="1342261">)</span><span class="op" id="1342262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1342265">if</span>&nbsp;<span class="ident" id="1342268">written</span>&nbsp;<span class="op" id="1342276">==</span>&nbsp;<span class="ident" id="1342279">n</span>&nbsp;<span class="op" id="1342281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1342285">return</span>&nbsp;<span class="ident" id="1342292">n</span><span class="op" id="1342293">,</span>&nbsp;<span class="builtintype" id="1342295">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1342300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1342303">if</span>&nbsp;<span class="ident" id="1342306">written</span>&nbsp;<span class="op" id="1342314">&lt;</span>&nbsp;<span class="ident" id="1342316">n</span>&nbsp;<span class="op" id="1342318">&amp;&amp;</span>&nbsp;<span class="ident" id="1342321">err</span>&nbsp;<span class="op" id="1342325">==</span>&nbsp;<span class="builtintype" id="1342328">nil</span>&nbsp;<span class="op" id="1342332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1342336">//&nbsp;src&nbsp;stopped&nbsp;early;&nbsp;must&nbsp;have&nbsp;been&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1342380">err</span>&nbsp;<span class="op" id="1342384">=</span>&nbsp;<span class="ident" id="1342386">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1342391">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1342394">return</span><br>
<span class="lineno"></span><span class="op" id="1342401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1342404">//&nbsp;Copy&nbsp;copies&nbsp;from&nbsp;src&nbsp;to&nbsp;dst&nbsp;until&nbsp;either&nbsp;EOF&nbsp;is&nbsp;reached</span><br>
<span class="lineno"></span><span class="comment" id="1342463">//&nbsp;on&nbsp;src&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">340</span><span class="comment" id="1342525">//&nbsp;copied&nbsp;and&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1342590">//</span><br>
<span class="lineno"></span><span class="comment" id="1342593">//&nbsp;A&nbsp;successful&nbsp;Copy&nbsp;returns&nbsp;err&nbsp;==&nbsp;nil,&nbsp;not&nbsp;err&nbsp;==&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1342650">//&nbsp;Because&nbsp;Copy&nbsp;is&nbsp;defined&nbsp;to&nbsp;read&nbsp;from&nbsp;src&nbsp;until&nbsp;EOF,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1342713">//&nbsp;not&nbsp;treat&nbsp;an&nbsp;EOF&nbsp;from&nbsp;Read&nbsp;as&nbsp;an&nbsp;error&nbsp;to&nbsp;be&nbsp;reported.</span><br>
<span class="lineno">345</span><span class="comment" id="1342771">//</span><br>
<span class="lineno"></span><span class="comment" id="1342774">//&nbsp;If&nbsp;src&nbsp;implements&nbsp;the&nbsp;WriterTo&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1342819">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;src.WriteTo(dst).</span><br>
<span class="lineno"></span><span class="comment" id="1342875">//&nbsp;Otherwise,&nbsp;if&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1342933">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;dst.ReadFrom(src).</span><br>
<span class="lineno">350</span><span class="keyword" id="1342990">func</span>&nbsp;<span class="ident" id="1342995">Copy</span><span class="op" id="1342999">(</span><span class="ident" id="1343000">dst</span>&nbsp;<span class="ident" id="1343004">Writer</span><span class="op" id="1343010">,</span>&nbsp;<span class="ident" id="1343012">src</span>&nbsp;<span class="ident" id="1343016">Reader</span><span class="op" id="1343022">)</span>&nbsp;<span class="op" id="1343024">(</span><span class="ident" id="1343025">written</span>&nbsp;<span class="builtintype" id="1343033">int64</span><span class="op" id="1343038">,</span>&nbsp;<span class="ident" id="1343040">err</span>&nbsp;<span class="builtintype" id="1343044">error</span><span class="op" id="1343049">)</span>&nbsp;<span class="op" id="1343051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1343054">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;has&nbsp;a&nbsp;WriteTo&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1343117">//&nbsp;Avoids&nbsp;an&nbsp;allocation&nbsp;and&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343154">if</span>&nbsp;<span class="ident" id="1343157">wt</span><span class="op" id="1343159">,</span>&nbsp;<span class="ident" id="1343161">ok</span>&nbsp;<span class="op" id="1343164">:=</span>&nbsp;<span class="ident" id="1343167">src</span><span class="op" id="1343170">.</span><span class="op" id="1343171">(</span><span class="ident" id="1343172">WriterTo</span><span class="op" id="1343180">)</span><span class="op" id="1343181">;</span>&nbsp;<span class="ident" id="1343183">ok</span>&nbsp;<span class="op" id="1343186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343190">return</span>&nbsp;<span class="ident" id="1343197">wt</span><span class="op" id="1343199">.</span><span class="ident" id="1343200">WriteTo</span><span class="op" id="1343207">(</span><span class="ident" id="1343208">dst</span><span class="op" id="1343211">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1343217">//&nbsp;Similarly,&nbsp;if&nbsp;the&nbsp;writer&nbsp;has&nbsp;a&nbsp;ReadFrom&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343292">if</span>&nbsp;<span class="ident" id="1343295">rt</span><span class="op" id="1343297">,</span>&nbsp;<span class="ident" id="1343299">ok</span>&nbsp;<span class="op" id="1343302">:=</span>&nbsp;<span class="ident" id="1343305">dst</span><span class="op" id="1343308">.</span><span class="op" id="1343309">(</span><span class="ident" id="1343310">ReaderFrom</span><span class="op" id="1343320">)</span><span class="op" id="1343321">;</span>&nbsp;<span class="ident" id="1343323">ok</span>&nbsp;<span class="op" id="1343326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343330">return</span>&nbsp;<span class="ident" id="1343337">rt</span><span class="op" id="1343339">.</span><span class="ident" id="1343340">ReadFrom</span><span class="op" id="1343348">(</span><span class="ident" id="1343349">src</span><span class="op" id="1343352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343355">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343358">buf</span>&nbsp;<span class="op" id="1343362">:=</span>&nbsp;<span class="builtinfunc" id="1343365">make</span><span class="op" id="1343369">(</span><span class="op" id="1343370">[</span><span class="op" id="1343371">]</span><span class="builtintype" id="1343372">byte</span><span class="op" id="1343376">,</span>&nbsp;<span class="num" id="1343378">32</span><span class="op" id="1343380">*</span><span class="num" id="1343381">1024</span><span class="op" id="1343385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343388">for</span>&nbsp;<span class="op" id="1343392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343396">nr</span><span class="op" id="1343398">,</span>&nbsp;<span class="ident" id="1343400">er</span>&nbsp;<span class="op" id="1343403">:=</span>&nbsp;<span class="ident" id="1343406">src</span><span class="op" id="1343409">.</span><span class="ident" id="1343410">Read</span><span class="op" id="1343414">(</span><span class="ident" id="1343415">buf</span><span class="op" id="1343418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343422">if</span>&nbsp;<span class="ident" id="1343425">nr</span>&nbsp;<span class="op" id="1343428">&gt;</span>&nbsp;<span class="num" id="1343430">0</span>&nbsp;<span class="op" id="1343432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343437">nw</span><span class="op" id="1343439">,</span>&nbsp;<span class="ident" id="1343441">ew</span>&nbsp;<span class="op" id="1343444">:=</span>&nbsp;<span class="ident" id="1343447">dst</span><span class="op" id="1343450">.</span><span class="ident" id="1343451">Write</span><span class="op" id="1343456">(</span><span class="ident" id="1343457">buf</span><span class="op" id="1343460">[</span><span class="num" id="1343461">0</span><span class="op" id="1343462">:</span><span class="ident" id="1343463">nr</span><span class="op" id="1343465">]</span><span class="op" id="1343466">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343471">if</span>&nbsp;<span class="ident" id="1343474">nw</span>&nbsp;<span class="op" id="1343477">&gt;</span>&nbsp;<span class="num" id="1343479">0</span>&nbsp;<span class="op" id="1343481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343487">written</span>&nbsp;<span class="op" id="1343495">+=</span>&nbsp;<span class="builtintype" id="1343498">int64</span><span class="op" id="1343503">(</span><span class="ident" id="1343504">nw</span><span class="op" id="1343506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343516">if</span>&nbsp;<span class="ident" id="1343519">ew</span>&nbsp;<span class="op" id="1343522">!=</span>&nbsp;<span class="builtintype" id="1343525">nil</span>&nbsp;<span class="op" id="1343529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343535">err</span>&nbsp;<span class="op" id="1343539">=</span>&nbsp;<span class="ident" id="1343541">ew</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343548">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343562">if</span>&nbsp;<span class="ident" id="1343565">nr</span>&nbsp;<span class="op" id="1343568">!=</span>&nbsp;<span class="ident" id="1343571">nw</span>&nbsp;<span class="op" id="1343574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343580">err</span>&nbsp;<span class="op" id="1343584">=</span>&nbsp;<span class="ident" id="1343586">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343604">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343621">if</span>&nbsp;<span class="ident" id="1343624">er</span>&nbsp;<span class="op" id="1343627">==</span>&nbsp;<span class="ident" id="1343630">EOF</span>&nbsp;<span class="op" id="1343634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343639">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343647">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343651">if</span>&nbsp;<span class="ident" id="1343654">er</span>&nbsp;<span class="op" id="1343657">!=</span>&nbsp;<span class="builtintype" id="1343660">nil</span>&nbsp;<span class="op" id="1343664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343669">err</span>&nbsp;<span class="op" id="1343673">=</span>&nbsp;<span class="ident" id="1343675">er</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343681">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343692">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343695">return</span>&nbsp;<span class="ident" id="1343702">written</span><span class="op" id="1343709">,</span>&nbsp;<span class="ident" id="1343711">err</span><br>
<span class="lineno"></span><span class="op" id="1343715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1343718">//&nbsp;LimitReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1343768">//&nbsp;but&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">390</span><span class="comment" id="1343805">//&nbsp;The&nbsp;underlying&nbsp;implementation&nbsp;is&nbsp;a&nbsp;*LimitedReader.</span><br>
<span class="lineno"></span><span class="keyword" id="1343859">func</span>&nbsp;<span class="ident" id="1343864">LimitReader</span><span class="op" id="1343875">(</span><span class="ident" id="1343876">r</span>&nbsp;<span class="ident" id="1343878">Reader</span><span class="op" id="1343884">,</span>&nbsp;<span class="ident" id="1343886">n</span>&nbsp;<span class="builtintype" id="1343888">int64</span><span class="op" id="1343893">)</span>&nbsp;<span class="ident" id="1343895">Reader</span>&nbsp;<span class="op" id="1343902">{</span>&nbsp;<span class="keyword" id="1343904">return</span>&nbsp;<span class="op" id="1343911">&amp;</span><span class="ident" id="1343912">LimitedReader</span><span class="op" id="1343925">{</span><span class="ident" id="1343926">r</span><span class="op" id="1343927">,</span>&nbsp;<span class="ident" id="1343929">n</span><span class="op" id="1343930">}</span>&nbsp;<span class="op" id="1343932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1343935">//&nbsp;A&nbsp;LimitedReader&nbsp;reads&nbsp;from&nbsp;R&nbsp;but&nbsp;limits&nbsp;the&nbsp;amount&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1343992">//&nbsp;data&nbsp;returned&nbsp;to&nbsp;just&nbsp;N&nbsp;bytes.&nbsp;Each&nbsp;call&nbsp;to&nbsp;Read</span><br>
<span class="lineno">395</span><span class="comment" id="1344044">//&nbsp;updates&nbsp;N&nbsp;to&nbsp;reflect&nbsp;the&nbsp;new&nbsp;amount&nbsp;remaining.</span><br>
<span class="lineno"></span><span class="keyword" id="1344094">type</span>&nbsp;<span class="ident" id="1344099">LimitedReader</span>&nbsp;<span class="keyword" id="1344113">struct</span>&nbsp;<span class="op" id="1344120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344123">R</span>&nbsp;<span class="ident" id="1344125">Reader</span>&nbsp;<span class="comment" id="1344132">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344154">N</span>&nbsp;<span class="builtintype" id="1344156">int64</span>&nbsp;&nbsp;<span class="comment" id="1344163">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span><span class="op" id="1344186">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span><span class="keyword" id="1344189">func</span>&nbsp;<span class="op" id="1344194">(</span><span class="ident" id="1344195">l</span>&nbsp;<span class="op" id="1344197">*</span><span class="ident" id="1344198">LimitedReader</span><span class="op" id="1344211">)</span>&nbsp;<span class="ident" id="1344213">Read</span><span class="op" id="1344217">(</span><span class="ident" id="1344218">p</span>&nbsp;<span class="op" id="1344220">[</span><span class="op" id="1344221">]</span><span class="builtintype" id="1344222">byte</span><span class="op" id="1344226">)</span>&nbsp;<span class="op" id="1344228">(</span><span class="ident" id="1344229">n</span>&nbsp;<span class="builtintype" id="1344231">int</span><span class="op" id="1344234">,</span>&nbsp;<span class="ident" id="1344236">err</span>&nbsp;<span class="builtintype" id="1344240">error</span><span class="op" id="1344245">)</span>&nbsp;<span class="op" id="1344247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344250">if</span>&nbsp;<span class="ident" id="1344253">l</span><span class="op" id="1344254">.</span><span class="ident" id="1344255">N</span>&nbsp;<span class="op" id="1344257">&lt;=</span>&nbsp;<span class="num" id="1344260">0</span>&nbsp;<span class="op" id="1344262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344266">return</span>&nbsp;<span class="num" id="1344273">0</span><span class="op" id="1344274">,</span>&nbsp;<span class="ident" id="1344276">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344281">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344284">if</span>&nbsp;<span class="builtintype" id="1344287">int64</span><span class="op" id="1344292">(</span><span class="builtinfunc" id="1344293">len</span><span class="op" id="1344296">(</span><span class="ident" id="1344297">p</span><span class="op" id="1344298">)</span><span class="op" id="1344299">)</span>&nbsp;<span class="op" id="1344301">&gt;</span>&nbsp;<span class="ident" id="1344303">l</span><span class="op" id="1344304">.</span><span class="ident" id="1344305">N</span>&nbsp;<span class="op" id="1344307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344311">p</span>&nbsp;<span class="op" id="1344313">=</span>&nbsp;<span class="ident" id="1344315">p</span><span class="op" id="1344316">[</span><span class="num" id="1344317">0</span><span class="op" id="1344318">:</span><span class="ident" id="1344319">l</span><span class="op" id="1344320">.</span><span class="ident" id="1344321">N</span><span class="op" id="1344322">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344328">n</span><span class="op" id="1344329">,</span>&nbsp;<span class="ident" id="1344331">err</span>&nbsp;<span class="op" id="1344335">=</span>&nbsp;<span class="ident" id="1344337">l</span><span class="op" id="1344338">.</span><span class="ident" id="1344339">R</span><span class="op" id="1344340">.</span><span class="ident" id="1344341">Read</span><span class="op" id="1344345">(</span><span class="ident" id="1344346">p</span><span class="op" id="1344347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344350">l</span><span class="op" id="1344351">.</span><span class="ident" id="1344352">N</span>&nbsp;<span class="op" id="1344354">-=</span>&nbsp;<span class="builtintype" id="1344357">int64</span><span class="op" id="1344362">(</span><span class="ident" id="1344363">n</span><span class="op" id="1344364">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344367">return</span><br>
<span class="lineno"></span><span class="op" id="1344374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1344377">//&nbsp;NewSectionReader&nbsp;returns&nbsp;a&nbsp;SectionReader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1344439">//&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;and&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">415</span><span class="keyword" id="1344499">func</span>&nbsp;<span class="ident" id="1344504">NewSectionReader</span><span class="op" id="1344520">(</span><span class="ident" id="1344521">r</span>&nbsp;<span class="ident" id="1344523">ReaderAt</span><span class="op" id="1344531">,</span>&nbsp;<span class="ident" id="1344533">off</span>&nbsp;<span class="builtintype" id="1344537">int64</span><span class="op" id="1344542">,</span>&nbsp;<span class="ident" id="1344544">n</span>&nbsp;<span class="builtintype" id="1344546">int64</span><span class="op" id="1344551">)</span>&nbsp;<span class="op" id="1344553">*</span><span class="ident" id="1344554">SectionReader</span>&nbsp;<span class="op" id="1344568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344571">return</span>&nbsp;<span class="op" id="1344578">&amp;</span><span class="ident" id="1344579">SectionReader</span><span class="op" id="1344592">{</span><span class="ident" id="1344593">r</span><span class="op" id="1344594">,</span>&nbsp;<span class="ident" id="1344596">off</span><span class="op" id="1344599">,</span>&nbsp;<span class="ident" id="1344601">off</span><span class="op" id="1344604">,</span>&nbsp;<span class="ident" id="1344606">off</span>&nbsp;<span class="op" id="1344610">+</span>&nbsp;<span class="ident" id="1344612">n</span><span class="op" id="1344613">}</span><br>
<span class="lineno"></span><span class="op" id="1344615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1344618">//&nbsp;SectionReader&nbsp;implements&nbsp;Read,&nbsp;Seek,&nbsp;and&nbsp;ReadAt&nbsp;on&nbsp;a&nbsp;section</span><br>
<span class="lineno">420</span><span class="comment" id="1344682">//&nbsp;of&nbsp;an&nbsp;underlying&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="1344712">type</span>&nbsp;<span class="ident" id="1344717">SectionReader</span>&nbsp;<span class="keyword" id="1344731">struct</span>&nbsp;<span class="op" id="1344738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344741">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344747">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344757">base</span>&nbsp;&nbsp;<span class="builtintype" id="1344763">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344770">off</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1344776">int64</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344783">limit</span>&nbsp;<span class="builtintype" id="1344789">int64</span><br>
<span class="lineno"></span><span class="op" id="1344795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1344798">func</span>&nbsp;<span class="op" id="1344803">(</span><span class="ident" id="1344804">s</span>&nbsp;<span class="op" id="1344806">*</span><span class="ident" id="1344807">SectionReader</span><span class="op" id="1344820">)</span>&nbsp;<span class="ident" id="1344822">Read</span><span class="op" id="1344826">(</span><span class="ident" id="1344827">p</span>&nbsp;<span class="op" id="1344829">[</span><span class="op" id="1344830">]</span><span class="builtintype" id="1344831">byte</span><span class="op" id="1344835">)</span>&nbsp;<span class="op" id="1344837">(</span><span class="ident" id="1344838">n</span>&nbsp;<span class="builtintype" id="1344840">int</span><span class="op" id="1344843">,</span>&nbsp;<span class="ident" id="1344845">err</span>&nbsp;<span class="builtintype" id="1344849">error</span><span class="op" id="1344854">)</span>&nbsp;<span class="op" id="1344856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344859">if</span>&nbsp;<span class="ident" id="1344862">s</span><span class="op" id="1344863">.</span><span class="ident" id="1344864">off</span>&nbsp;<span class="op" id="1344868">&gt;=</span>&nbsp;<span class="ident" id="1344871">s</span><span class="op" id="1344872">.</span><span class="ident" id="1344873">limit</span>&nbsp;<span class="op" id="1344879">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344883">return</span>&nbsp;<span class="num" id="1344890">0</span><span class="op" id="1344891">,</span>&nbsp;<span class="ident" id="1344893">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344901">if</span>&nbsp;<span class="ident" id="1344904">max</span>&nbsp;<span class="op" id="1344908">:=</span>&nbsp;<span class="ident" id="1344911">s</span><span class="op" id="1344912">.</span><span class="ident" id="1344913">limit</span>&nbsp;<span class="op" id="1344919">-</span>&nbsp;<span class="ident" id="1344921">s</span><span class="op" id="1344922">.</span><span class="ident" id="1344923">off</span><span class="op" id="1344926">;</span>&nbsp;<span class="builtintype" id="1344928">int64</span><span class="op" id="1344933">(</span><span class="builtinfunc" id="1344934">len</span><span class="op" id="1344937">(</span><span class="ident" id="1344938">p</span><span class="op" id="1344939">)</span><span class="op" id="1344940">)</span>&nbsp;<span class="op" id="1344942">&gt;</span>&nbsp;<span class="ident" id="1344944">max</span>&nbsp;<span class="op" id="1344948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344952">p</span>&nbsp;<span class="op" id="1344954">=</span>&nbsp;<span class="ident" id="1344956">p</span><span class="op" id="1344957">[</span><span class="num" id="1344958">0</span><span class="op" id="1344959">:</span><span class="ident" id="1344960">max</span><span class="op" id="1344963">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344966">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344969">n</span><span class="op" id="1344970">,</span>&nbsp;<span class="ident" id="1344972">err</span>&nbsp;<span class="op" id="1344976">=</span>&nbsp;<span class="ident" id="1344978">s</span><span class="op" id="1344979">.</span><span class="ident" id="1344980">r</span><span class="op" id="1344981">.</span><span class="ident" id="1344982">ReadAt</span><span class="op" id="1344988">(</span><span class="ident" id="1344989">p</span><span class="op" id="1344990">,</span>&nbsp;<span class="ident" id="1344992">s</span><span class="op" id="1344993">.</span><span class="ident" id="1344994">off</span><span class="op" id="1344997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345000">s</span><span class="op" id="1345001">.</span><span class="ident" id="1345002">off</span>&nbsp;<span class="op" id="1345006">+=</span>&nbsp;<span class="builtintype" id="1345009">int64</span><span class="op" id="1345014">(</span><span class="ident" id="1345015">n</span><span class="op" id="1345016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345019">return</span><br>
<span class="lineno"></span><span class="op" id="1345026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="1345029">var</span>&nbsp;<span class="ident" id="1345033">errWhence</span>&nbsp;<span class="op" id="1345043">=</span>&nbsp;<span class="ident" id="1345045">errors</span><span class="op" id="1345051">.</span><span class="ident" id="1345052">New</span><span class="op" id="1345055">(</span><span class="string" id="1345056">&#34;Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="1345078">)</span><br>
<span class="lineno"></span><span class="keyword" id="1345080">var</span>&nbsp;<span class="ident" id="1345084">errOffset</span>&nbsp;<span class="op" id="1345094">=</span>&nbsp;<span class="ident" id="1345096">errors</span><span class="op" id="1345102">.</span><span class="ident" id="1345103">New</span><span class="op" id="1345106">(</span><span class="string" id="1345107">&#34;Seek:&nbsp;invalid&nbsp;offset&#34;</span><span class="op" id="1345129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1345132">func</span>&nbsp;<span class="op" id="1345137">(</span><span class="ident" id="1345138">s</span>&nbsp;<span class="op" id="1345140">*</span><span class="ident" id="1345141">SectionReader</span><span class="op" id="1345154">)</span>&nbsp;<span class="ident" id="1345156">Seek</span><span class="op" id="1345160">(</span><span class="ident" id="1345161">offset</span>&nbsp;<span class="builtintype" id="1345168">int64</span><span class="op" id="1345173">,</span>&nbsp;<span class="ident" id="1345175">whence</span>&nbsp;<span class="builtintype" id="1345182">int</span><span class="op" id="1345185">)</span>&nbsp;<span class="op" id="1345187">(</span><span class="builtintype" id="1345188">int64</span><span class="op" id="1345193">,</span>&nbsp;<span class="builtintype" id="1345195">error</span><span class="op" id="1345200">)</span>&nbsp;<span class="op" id="1345202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345205">switch</span>&nbsp;<span class="ident" id="1345212">whence</span>&nbsp;<span class="op" id="1345219">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345222">default</span><span class="op" id="1345229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345233">return</span>&nbsp;<span class="num" id="1345240">0</span><span class="op" id="1345241">,</span>&nbsp;<span class="ident" id="1345243">errWhence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345254">case</span>&nbsp;<span class="num" id="1345259">0</span><span class="op" id="1345260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345264">offset</span>&nbsp;<span class="op" id="1345271">+=</span>&nbsp;<span class="ident" id="1345274">s</span><span class="op" id="1345275">.</span><span class="ident" id="1345276">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345282">case</span>&nbsp;<span class="num" id="1345287">1</span><span class="op" id="1345288">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345292">offset</span>&nbsp;<span class="op" id="1345299">+=</span>&nbsp;<span class="ident" id="1345302">s</span><span class="op" id="1345303">.</span><span class="ident" id="1345304">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345309">case</span>&nbsp;<span class="num" id="1345314">2</span><span class="op" id="1345315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345319">offset</span>&nbsp;<span class="op" id="1345326">+=</span>&nbsp;<span class="ident" id="1345329">s</span><span class="op" id="1345330">.</span><span class="ident" id="1345331">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345341">if</span>&nbsp;<span class="ident" id="1345344">offset</span>&nbsp;<span class="op" id="1345351">&lt;</span>&nbsp;<span class="ident" id="1345353">s</span><span class="op" id="1345354">.</span><span class="ident" id="1345355">base</span>&nbsp;<span class="op" id="1345360">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345364">return</span>&nbsp;<span class="num" id="1345371">0</span><span class="op" id="1345372">,</span>&nbsp;<span class="ident" id="1345374">errOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345388">s</span><span class="op" id="1345389">.</span><span class="ident" id="1345390">off</span>&nbsp;<span class="op" id="1345394">=</span>&nbsp;<span class="ident" id="1345396">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345404">return</span>&nbsp;<span class="ident" id="1345411">offset</span>&nbsp;<span class="op" id="1345418">-</span>&nbsp;<span class="ident" id="1345420">s</span><span class="op" id="1345421">.</span><span class="ident" id="1345422">base</span><span class="op" id="1345426">,</span>&nbsp;<span class="builtintype" id="1345428">nil</span><br>
<span class="lineno"></span><span class="op" id="1345432">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="1345435">func</span>&nbsp;<span class="op" id="1345440">(</span><span class="ident" id="1345441">s</span>&nbsp;<span class="op" id="1345443">*</span><span class="ident" id="1345444">SectionReader</span><span class="op" id="1345457">)</span>&nbsp;<span class="ident" id="1345459">ReadAt</span><span class="op" id="1345465">(</span><span class="ident" id="1345466">p</span>&nbsp;<span class="op" id="1345468">[</span><span class="op" id="1345469">]</span><span class="builtintype" id="1345470">byte</span><span class="op" id="1345474">,</span>&nbsp;<span class="ident" id="1345476">off</span>&nbsp;<span class="builtintype" id="1345480">int64</span><span class="op" id="1345485">)</span>&nbsp;<span class="op" id="1345487">(</span><span class="ident" id="1345488">n</span>&nbsp;<span class="builtintype" id="1345490">int</span><span class="op" id="1345493">,</span>&nbsp;<span class="ident" id="1345495">err</span>&nbsp;<span class="builtintype" id="1345499">error</span><span class="op" id="1345504">)</span>&nbsp;<span class="op" id="1345506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345509">if</span>&nbsp;<span class="ident" id="1345512">off</span>&nbsp;<span class="op" id="1345516">&lt;</span>&nbsp;<span class="num" id="1345518">0</span>&nbsp;<span class="op" id="1345520">||</span>&nbsp;<span class="ident" id="1345523">off</span>&nbsp;<span class="op" id="1345527">&gt;=</span>&nbsp;<span class="ident" id="1345530">s</span><span class="op" id="1345531">.</span><span class="ident" id="1345532">limit</span><span class="op" id="1345537">-</span><span class="ident" id="1345538">s</span><span class="op" id="1345539">.</span><span class="ident" id="1345540">base</span>&nbsp;<span class="op" id="1345545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345549">return</span>&nbsp;<span class="num" id="1345556">0</span><span class="op" id="1345557">,</span>&nbsp;<span class="ident" id="1345559">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345564">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345567">off</span>&nbsp;<span class="op" id="1345571">+=</span>&nbsp;<span class="ident" id="1345574">s</span><span class="op" id="1345575">.</span><span class="ident" id="1345576">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345582">if</span>&nbsp;<span class="ident" id="1345585">max</span>&nbsp;<span class="op" id="1345589">:=</span>&nbsp;<span class="ident" id="1345592">s</span><span class="op" id="1345593">.</span><span class="ident" id="1345594">limit</span>&nbsp;<span class="op" id="1345600">-</span>&nbsp;<span class="ident" id="1345602">off</span><span class="op" id="1345605">;</span>&nbsp;<span class="builtintype" id="1345607">int64</span><span class="op" id="1345612">(</span><span class="builtinfunc" id="1345613">len</span><span class="op" id="1345616">(</span><span class="ident" id="1345617">p</span><span class="op" id="1345618">)</span><span class="op" id="1345619">)</span>&nbsp;<span class="op" id="1345621">&gt;</span>&nbsp;<span class="ident" id="1345623">max</span>&nbsp;<span class="op" id="1345627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345631">p</span>&nbsp;<span class="op" id="1345633">=</span>&nbsp;<span class="ident" id="1345635">p</span><span class="op" id="1345636">[</span><span class="num" id="1345637">0</span><span class="op" id="1345638">:</span><span class="ident" id="1345639">max</span><span class="op" id="1345642">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345646">n</span><span class="op" id="1345647">,</span>&nbsp;<span class="ident" id="1345649">err</span>&nbsp;<span class="op" id="1345653">=</span>&nbsp;<span class="ident" id="1345655">s</span><span class="op" id="1345656">.</span><span class="ident" id="1345657">r</span><span class="op" id="1345658">.</span><span class="ident" id="1345659">ReadAt</span><span class="op" id="1345665">(</span><span class="ident" id="1345666">p</span><span class="op" id="1345667">,</span>&nbsp;<span class="ident" id="1345669">off</span><span class="op" id="1345672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345676">if</span>&nbsp;<span class="ident" id="1345679">err</span>&nbsp;<span class="op" id="1345683">==</span>&nbsp;<span class="builtintype" id="1345686">nil</span>&nbsp;<span class="op" id="1345690">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345695">err</span>&nbsp;<span class="op" id="1345699">=</span>&nbsp;<span class="ident" id="1345701">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345711">return</span>&nbsp;<span class="ident" id="1345718">n</span><span class="op" id="1345719">,</span>&nbsp;<span class="ident" id="1345721">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345729">return</span>&nbsp;<span class="ident" id="1345736">s</span><span class="op" id="1345737">.</span><span class="ident" id="1345738">r</span><span class="op" id="1345739">.</span><span class="ident" id="1345740">ReadAt</span><span class="op" id="1345746">(</span><span class="ident" id="1345747">p</span><span class="op" id="1345748">,</span>&nbsp;<span class="ident" id="1345750">off</span><span class="op" id="1345753">)</span><br>
<span class="lineno">475</span><span class="op" id="1345755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1345758">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;section&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1345808">func</span>&nbsp;<span class="op" id="1345813">(</span><span class="ident" id="1345814">s</span>&nbsp;<span class="op" id="1345816">*</span><span class="ident" id="1345817">SectionReader</span><span class="op" id="1345830">)</span>&nbsp;<span class="ident" id="1345832">Size</span><span class="op" id="1345836">(</span><span class="op" id="1345837">)</span>&nbsp;<span class="builtintype" id="1345839">int64</span>&nbsp;<span class="op" id="1345845">{</span>&nbsp;<span class="keyword" id="1345847">return</span>&nbsp;<span class="ident" id="1345854">s</span><span class="op" id="1345855">.</span><span class="ident" id="1345856">limit</span>&nbsp;<span class="op" id="1345862">-</span>&nbsp;<span class="ident" id="1345864">s</span><span class="op" id="1345865">.</span><span class="ident" id="1345866">base</span>&nbsp;<span class="op" id="1345871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1345874">//&nbsp;TeeReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;writes&nbsp;to&nbsp;w&nbsp;what&nbsp;it&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="1345943">//&nbsp;All&nbsp;reads&nbsp;from&nbsp;r&nbsp;performed&nbsp;through&nbsp;it&nbsp;are&nbsp;matched&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1346001">//&nbsp;corresponding&nbsp;writes&nbsp;to&nbsp;w.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;internal&nbsp;buffering&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="1346065">//&nbsp;the&nbsp;write&nbsp;must&nbsp;complete&nbsp;before&nbsp;the&nbsp;read&nbsp;completes.</span><br>
<span class="lineno"></span><span class="comment" id="1346119">//&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;while&nbsp;writing&nbsp;is&nbsp;reported&nbsp;as&nbsp;a&nbsp;read&nbsp;error.</span><br>
<span class="lineno">485</span><span class="keyword" id="1346187">func</span>&nbsp;<span class="ident" id="1346192">TeeReader</span><span class="op" id="1346201">(</span><span class="ident" id="1346202">r</span>&nbsp;<span class="ident" id="1346204">Reader</span><span class="op" id="1346210">,</span>&nbsp;<span class="ident" id="1346212">w</span>&nbsp;<span class="ident" id="1346214">Writer</span><span class="op" id="1346220">)</span>&nbsp;<span class="ident" id="1346222">Reader</span>&nbsp;<span class="op" id="1346229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346232">return</span>&nbsp;<span class="op" id="1346239">&amp;</span><span class="ident" id="1346240">teeReader</span><span class="op" id="1346249">{</span><span class="ident" id="1346250">r</span><span class="op" id="1346251">,</span>&nbsp;<span class="ident" id="1346253">w</span><span class="op" id="1346254">}</span><br>
<span class="lineno"></span><span class="op" id="1346256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1346259">type</span>&nbsp;<span class="ident" id="1346264">teeReader</span>&nbsp;<span class="keyword" id="1346274">struct</span>&nbsp;<span class="op" id="1346281">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346284">r</span>&nbsp;<span class="ident" id="1346286">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346294">w</span>&nbsp;<span class="ident" id="1346296">Writer</span><br>
<span class="lineno"></span><span class="op" id="1346303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1346306">func</span>&nbsp;<span class="op" id="1346311">(</span><span class="ident" id="1346312">t</span>&nbsp;<span class="op" id="1346314">*</span><span class="ident" id="1346315">teeReader</span><span class="op" id="1346324">)</span>&nbsp;<span class="ident" id="1346326">Read</span><span class="op" id="1346330">(</span><span class="ident" id="1346331">p</span>&nbsp;<span class="op" id="1346333">[</span><span class="op" id="1346334">]</span><span class="builtintype" id="1346335">byte</span><span class="op" id="1346339">)</span>&nbsp;<span class="op" id="1346341">(</span><span class="ident" id="1346342">n</span>&nbsp;<span class="builtintype" id="1346344">int</span><span class="op" id="1346347">,</span>&nbsp;<span class="ident" id="1346349">err</span>&nbsp;<span class="builtintype" id="1346353">error</span><span class="op" id="1346358">)</span>&nbsp;<span class="op" id="1346360">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346363">n</span><span class="op" id="1346364">,</span>&nbsp;<span class="ident" id="1346366">err</span>&nbsp;<span class="op" id="1346370">=</span>&nbsp;<span class="ident" id="1346372">t</span><span class="op" id="1346373">.</span><span class="ident" id="1346374">r</span><span class="op" id="1346375">.</span><span class="ident" id="1346376">Read</span><span class="op" id="1346380">(</span><span class="ident" id="1346381">p</span><span class="op" id="1346382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346385">if</span>&nbsp;<span class="ident" id="1346388">n</span>&nbsp;<span class="op" id="1346390">&gt;</span>&nbsp;<span class="num" id="1346392">0</span>&nbsp;<span class="op" id="1346394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346398">if</span>&nbsp;<span class="ident" id="1346401">n</span><span class="op" id="1346402">,</span>&nbsp;<span class="ident" id="1346404">err</span>&nbsp;<span class="op" id="1346408">:=</span>&nbsp;<span class="ident" id="1346411">t</span><span class="op" id="1346412">.</span><span class="ident" id="1346413">w</span><span class="op" id="1346414">.</span><span class="ident" id="1346415">Write</span><span class="op" id="1346420">(</span><span class="ident" id="1346421">p</span><span class="op" id="1346422">[</span><span class="op" id="1346423">:</span><span class="ident" id="1346424">n</span><span class="op" id="1346425">]</span><span class="op" id="1346426">)</span><span class="op" id="1346427">;</span>&nbsp;<span class="ident" id="1346429">err</span>&nbsp;<span class="op" id="1346433">!=</span>&nbsp;<span class="builtintype" id="1346436">nil</span>&nbsp;<span class="op" id="1346440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346445">return</span>&nbsp;<span class="ident" id="1346452">n</span><span class="op" id="1346453">,</span>&nbsp;<span class="ident" id="1346455">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346461">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346467">return</span><br>
<span class="lineno"></span><span class="op" id="1346474">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
