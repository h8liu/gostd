<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5169817">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5169872">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5169926">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5169977">package</span>&nbsp;<span class="ident" id="5169985">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5169995">import</span>&nbsp;<span class="op" id="5170002">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5170005">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="5170011">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="5170014">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5170091">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="5170161">//</span><br>
<span class="lineno"></span><span class="comment" id="5170164">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5170239">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5170282">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="5170332">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="5170370">type</span>&nbsp;<span class="ident" id="5170375">context</span>&nbsp;<span class="keyword" id="5170383">struct</span>&nbsp;<span class="op" id="5170390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170393">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5170401">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170408">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5170416">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170423">urlPart</span>&nbsp;<span class="ident" id="5170431">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170440">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5170448">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170455">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5170463">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170469">element</span>&nbsp;<span class="ident" id="5170477">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170486">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5170494">*</span><span class="ident" id="5170495">Error</span><br>
<span class="lineno"></span><span class="op" id="5170501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5170504">func</span>&nbsp;<span class="op" id="5170509">(</span><span class="ident" id="5170510">c</span>&nbsp;<span class="ident" id="5170512">context</span><span class="op" id="5170519">)</span>&nbsp;<span class="ident" id="5170521">String</span><span class="op" id="5170527">(</span><span class="op" id="5170528">)</span>&nbsp;<span class="builtintype" id="5170530">string</span>&nbsp;<span class="op" id="5170537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170540">return</span>&nbsp;<span class="ident" id="5170547">fmt</span><span class="op" id="5170550">.</span><span class="ident" id="5170551">Sprintf</span><span class="op" id="5170558">(</span><span class="string" id="5170559">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="5170583">,</span>&nbsp;<span class="ident" id="5170585">c</span><span class="op" id="5170586">.</span><span class="ident" id="5170587">state</span><span class="op" id="5170592">,</span>&nbsp;<span class="ident" id="5170594">c</span><span class="op" id="5170595">.</span><span class="ident" id="5170596">delim</span><span class="op" id="5170601">,</span>&nbsp;<span class="ident" id="5170603">c</span><span class="op" id="5170604">.</span><span class="ident" id="5170605">urlPart</span><span class="op" id="5170612">,</span>&nbsp;<span class="ident" id="5170614">c</span><span class="op" id="5170615">.</span><span class="ident" id="5170616">jsCtx</span><span class="op" id="5170621">,</span>&nbsp;<span class="ident" id="5170623">c</span><span class="op" id="5170624">.</span><span class="ident" id="5170625">attr</span><span class="op" id="5170629">,</span>&nbsp;<span class="ident" id="5170631">c</span><span class="op" id="5170632">.</span><span class="ident" id="5170633">element</span><span class="op" id="5170640">,</span>&nbsp;<span class="ident" id="5170642">c</span><span class="op" id="5170643">.</span><span class="ident" id="5170644">err</span><span class="op" id="5170647">)</span><br>
<span class="lineno">30</span><span class="op" id="5170649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5170652">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="5170698">func</span>&nbsp;<span class="op" id="5170703">(</span><span class="ident" id="5170704">c</span>&nbsp;<span class="ident" id="5170706">context</span><span class="op" id="5170713">)</span>&nbsp;<span class="ident" id="5170715">eq</span><span class="op" id="5170717">(</span><span class="ident" id="5170718">d</span>&nbsp;<span class="ident" id="5170720">context</span><span class="op" id="5170727">)</span>&nbsp;<span class="builtintype" id="5170729">bool</span>&nbsp;<span class="op" id="5170734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170737">return</span>&nbsp;<span class="ident" id="5170744">c</span><span class="op" id="5170745">.</span><span class="ident" id="5170746">state</span>&nbsp;<span class="op" id="5170752">==</span>&nbsp;<span class="ident" id="5170755">d</span><span class="op" id="5170756">.</span><span class="ident" id="5170757">state</span>&nbsp;<span class="op" id="5170763">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170768">c</span><span class="op" id="5170769">.</span><span class="ident" id="5170770">delim</span>&nbsp;<span class="op" id="5170776">==</span>&nbsp;<span class="ident" id="5170779">d</span><span class="op" id="5170780">.</span><span class="ident" id="5170781">delim</span>&nbsp;<span class="op" id="5170787">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170792">c</span><span class="op" id="5170793">.</span><span class="ident" id="5170794">urlPart</span>&nbsp;<span class="op" id="5170802">==</span>&nbsp;<span class="ident" id="5170805">d</span><span class="op" id="5170806">.</span><span class="ident" id="5170807">urlPart</span>&nbsp;<span class="op" id="5170815">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170820">c</span><span class="op" id="5170821">.</span><span class="ident" id="5170822">jsCtx</span>&nbsp;<span class="op" id="5170828">==</span>&nbsp;<span class="ident" id="5170831">d</span><span class="op" id="5170832">.</span><span class="ident" id="5170833">jsCtx</span>&nbsp;<span class="op" id="5170839">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170844">c</span><span class="op" id="5170845">.</span><span class="ident" id="5170846">attr</span>&nbsp;<span class="op" id="5170851">==</span>&nbsp;<span class="ident" id="5170854">d</span><span class="op" id="5170855">.</span><span class="ident" id="5170856">attr</span>&nbsp;<span class="op" id="5170861">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170866">c</span><span class="op" id="5170867">.</span><span class="ident" id="5170868">element</span>&nbsp;<span class="op" id="5170876">==</span>&nbsp;<span class="ident" id="5170879">d</span><span class="op" id="5170880">.</span><span class="ident" id="5170881">element</span>&nbsp;<span class="op" id="5170889">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170894">c</span><span class="op" id="5170895">.</span><span class="ident" id="5170896">err</span>&nbsp;<span class="op" id="5170900">==</span>&nbsp;<span class="ident" id="5170903">d</span><span class="op" id="5170904">.</span><span class="ident" id="5170905">err</span><br>
<span class="lineno"></span><span class="op" id="5170909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5170912">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5170990">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="5171046">func</span>&nbsp;<span class="op" id="5171051">(</span><span class="ident" id="5171052">c</span>&nbsp;<span class="ident" id="5171054">context</span><span class="op" id="5171061">)</span>&nbsp;<span class="ident" id="5171063">mangle</span><span class="op" id="5171069">(</span><span class="ident" id="5171070">templateName</span>&nbsp;<span class="builtintype" id="5171083">string</span><span class="op" id="5171089">)</span>&nbsp;<span class="builtintype" id="5171091">string</span>&nbsp;<span class="op" id="5171098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5171101">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171173">if</span>&nbsp;<span class="ident" id="5171176">c</span><span class="op" id="5171177">.</span><span class="ident" id="5171178">state</span>&nbsp;<span class="op" id="5171184">==</span>&nbsp;<span class="ident" id="5171187">stateText</span>&nbsp;<span class="op" id="5171197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171201">return</span>&nbsp;<span class="ident" id="5171208">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171222">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171225">s</span>&nbsp;<span class="op" id="5171227">:=</span>&nbsp;<span class="ident" id="5171230">templateName</span>&nbsp;<span class="op" id="5171243">+</span>&nbsp;<span class="string" id="5171245">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="5171262">+</span>&nbsp;<span class="ident" id="5171264">c</span><span class="op" id="5171265">.</span><span class="ident" id="5171266">state</span><span class="op" id="5171271">.</span><span class="ident" id="5171272">String</span><span class="op" id="5171278">(</span><span class="op" id="5171279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171282">if</span>&nbsp;<span class="ident" id="5171285">c</span><span class="op" id="5171286">.</span><span class="ident" id="5171287">delim</span>&nbsp;<span class="op" id="5171293">!=</span>&nbsp;<span class="num" id="5171296">0</span>&nbsp;<span class="op" id="5171298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171302">s</span>&nbsp;<span class="op" id="5171304">+=</span>&nbsp;<span class="string" id="5171307">&#34;_&#34;</span>&nbsp;<span class="op" id="5171311">+</span>&nbsp;<span class="ident" id="5171313">c</span><span class="op" id="5171314">.</span><span class="ident" id="5171315">delim</span><span class="op" id="5171320">.</span><span class="ident" id="5171321">String</span><span class="op" id="5171327">(</span><span class="op" id="5171328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171334">if</span>&nbsp;<span class="ident" id="5171337">c</span><span class="op" id="5171338">.</span><span class="ident" id="5171339">urlPart</span>&nbsp;<span class="op" id="5171347">!=</span>&nbsp;<span class="num" id="5171350">0</span>&nbsp;<span class="op" id="5171352">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171356">s</span>&nbsp;<span class="op" id="5171358">+=</span>&nbsp;<span class="string" id="5171361">&#34;_&#34;</span>&nbsp;<span class="op" id="5171365">+</span>&nbsp;<span class="ident" id="5171367">c</span><span class="op" id="5171368">.</span><span class="ident" id="5171369">urlPart</span><span class="op" id="5171376">.</span><span class="ident" id="5171377">String</span><span class="op" id="5171383">(</span><span class="op" id="5171384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171390">if</span>&nbsp;<span class="ident" id="5171393">c</span><span class="op" id="5171394">.</span><span class="ident" id="5171395">jsCtx</span>&nbsp;<span class="op" id="5171401">!=</span>&nbsp;<span class="num" id="5171404">0</span>&nbsp;<span class="op" id="5171406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171410">s</span>&nbsp;<span class="op" id="5171412">+=</span>&nbsp;<span class="string" id="5171415">&#34;_&#34;</span>&nbsp;<span class="op" id="5171419">+</span>&nbsp;<span class="ident" id="5171421">c</span><span class="op" id="5171422">.</span><span class="ident" id="5171423">jsCtx</span><span class="op" id="5171428">.</span><span class="ident" id="5171429">String</span><span class="op" id="5171435">(</span><span class="op" id="5171436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171439">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171442">if</span>&nbsp;<span class="ident" id="5171445">c</span><span class="op" id="5171446">.</span><span class="ident" id="5171447">attr</span>&nbsp;<span class="op" id="5171452">!=</span>&nbsp;<span class="num" id="5171455">0</span>&nbsp;<span class="op" id="5171457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171461">s</span>&nbsp;<span class="op" id="5171463">+=</span>&nbsp;<span class="string" id="5171466">&#34;_&#34;</span>&nbsp;<span class="op" id="5171470">+</span>&nbsp;<span class="ident" id="5171472">c</span><span class="op" id="5171473">.</span><span class="ident" id="5171474">attr</span><span class="op" id="5171478">.</span><span class="ident" id="5171479">String</span><span class="op" id="5171485">(</span><span class="op" id="5171486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171492">if</span>&nbsp;<span class="ident" id="5171495">c</span><span class="op" id="5171496">.</span><span class="ident" id="5171497">element</span>&nbsp;<span class="op" id="5171505">!=</span>&nbsp;<span class="num" id="5171508">0</span>&nbsp;<span class="op" id="5171510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171514">s</span>&nbsp;<span class="op" id="5171516">+=</span>&nbsp;<span class="string" id="5171519">&#34;_&#34;</span>&nbsp;<span class="op" id="5171523">+</span>&nbsp;<span class="ident" id="5171525">c</span><span class="op" id="5171526">.</span><span class="ident" id="5171527">element</span><span class="op" id="5171534">.</span><span class="ident" id="5171535">String</span><span class="op" id="5171541">(</span><span class="op" id="5171542">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171548">return</span>&nbsp;<span class="ident" id="5171555">s</span><br>
<span class="lineno"></span><span class="op" id="5171557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5171560">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="5171611">//</span><br>
<span class="lineno"></span><span class="comment" id="5171614">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="5171693">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5171770">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="5171843">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="5171923">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5171953">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="5171991">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5172069">type</span>&nbsp;<span class="ident" id="5172074">state</span>&nbsp;<span class="builtintype" id="5172080">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="5172087">const</span>&nbsp;<span class="op" id="5172093">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172096">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172157">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172220">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172270">stateText</span>&nbsp;<span class="ident" id="5172280">state</span>&nbsp;<span class="op" id="5172286">=</span>&nbsp;<span class="ident" id="5172288">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172294">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172360">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172370">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172421">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172473">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172488">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172558">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172623">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172639">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172711">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172763">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172781">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172838">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172852">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172924">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172994">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173007">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173076">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173087">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173156">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173166">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173228">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173237">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173303">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173317">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173383">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173397">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173458">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173473">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173541">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173558">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173621">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173637">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173702">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173712">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173772">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173787">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173847">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173862">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173926">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173941">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174005">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174020">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174075">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174088">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174150">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174168">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174225">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174242">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174304">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174331">stateError</span><br>
<span class="lineno"></span><span class="op" id="5174342">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5174345">var</span>&nbsp;<span class="ident" id="5174349">stateNames</span>&nbsp;<span class="op" id="5174360">=</span>&nbsp;<span class="op" id="5174362">[</span><span class="op" id="5174363">...</span><span class="op" id="5174366">]</span><span class="builtintype" id="5174367">string</span><span class="op" id="5174373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174376">stateText</span><span class="op" id="5174385">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174394">&#34;stateText&#34;</span><span class="op" id="5174405">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174408">stateTag</span><span class="op" id="5174416">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174426">&#34;stateTag&#34;</span><span class="op" id="5174436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174439">stateAttrName</span><span class="op" id="5174452">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174457">&#34;stateAttrName&#34;</span><span class="op" id="5174472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174475">stateAfterName</span><span class="op" id="5174489">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5174493">&#34;stateAfterName&#34;</span><span class="op" id="5174509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174512">stateBeforeValue</span><span class="op" id="5174528">:</span>&nbsp;<span class="string" id="5174530">&#34;stateBeforeValue&#34;</span><span class="op" id="5174548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174551">stateHTMLCmt</span><span class="op" id="5174563">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174569">&#34;stateHTMLCmt&#34;</span><span class="op" id="5174583">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174586">stateRCDATA</span><span class="op" id="5174597">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174604">&#34;stateRCDATA&#34;</span><span class="op" id="5174617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174620">stateAttr</span><span class="op" id="5174629">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174638">&#34;stateAttr&#34;</span><span class="op" id="5174649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174652">stateURL</span><span class="op" id="5174660">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174670">&#34;stateURL&#34;</span><span class="op" id="5174680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174683">stateJS</span><span class="op" id="5174690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174701">&#34;stateJS&#34;</span><span class="op" id="5174710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174713">stateJSDqStr</span><span class="op" id="5174725">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174731">&#34;stateJSDqStr&#34;</span><span class="op" id="5174745">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174748">stateJSSqStr</span><span class="op" id="5174760">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174766">&#34;stateJSSqStr&#34;</span><span class="op" id="5174780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174783">stateJSRegexp</span><span class="op" id="5174796">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174801">&#34;stateJSRegexp&#34;</span><span class="op" id="5174816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174819">stateJSBlockCmt</span><span class="op" id="5174834">:</span>&nbsp;&nbsp;<span class="string" id="5174837">&#34;stateJSBlockCmt&#34;</span><span class="op" id="5174854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174857">stateJSLineCmt</span><span class="op" id="5174871">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5174875">&#34;stateJSLineCmt&#34;</span><span class="op" id="5174891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174894">stateCSS</span><span class="op" id="5174902">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174912">&#34;stateCSS&#34;</span><span class="op" id="5174922">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174925">stateCSSDqStr</span><span class="op" id="5174938">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174943">&#34;stateCSSDqStr&#34;</span><span class="op" id="5174958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174961">stateCSSSqStr</span><span class="op" id="5174974">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5174979">&#34;stateCSSSqStr&#34;</span><span class="op" id="5174994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174997">stateCSSDqURL</span><span class="op" id="5175010">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5175015">&#34;stateCSSDqURL&#34;</span><span class="op" id="5175030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175033">stateCSSSqURL</span><span class="op" id="5175046">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5175051">&#34;stateCSSSqURL&#34;</span><span class="op" id="5175066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175069">stateCSSURL</span><span class="op" id="5175080">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5175087">&#34;stateCSSURL&#34;</span><span class="op" id="5175100">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175103">stateCSSBlockCmt</span><span class="op" id="5175119">:</span>&nbsp;<span class="string" id="5175121">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="5175139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175142">stateCSSLineCmt</span><span class="op" id="5175157">:</span>&nbsp;&nbsp;<span class="string" id="5175160">&#34;stateCSSLineCmt&#34;</span><span class="op" id="5175177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175180">stateError</span><span class="op" id="5175190">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5175198">&#34;stateError&#34;</span><span class="op" id="5175210">,</span><br>
<span class="lineno"></span><span class="op" id="5175212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="5175215">func</span>&nbsp;<span class="op" id="5175220">(</span><span class="ident" id="5175221">s</span>&nbsp;<span class="ident" id="5175223">state</span><span class="op" id="5175228">)</span>&nbsp;<span class="ident" id="5175230">String</span><span class="op" id="5175236">(</span><span class="op" id="5175237">)</span>&nbsp;<span class="builtintype" id="5175239">string</span>&nbsp;<span class="op" id="5175246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175249">if</span>&nbsp;<span class="builtintype" id="5175252">int</span><span class="op" id="5175255">(</span><span class="ident" id="5175256">s</span><span class="op" id="5175257">)</span>&nbsp;<span class="op" id="5175259">&lt;</span>&nbsp;<span class="builtinfunc" id="5175261">len</span><span class="op" id="5175264">(</span><span class="ident" id="5175265">stateNames</span><span class="op" id="5175275">)</span>&nbsp;<span class="op" id="5175277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175281">return</span>&nbsp;<span class="ident" id="5175288">stateNames</span><span class="op" id="5175298">[</span><span class="ident" id="5175299">s</span><span class="op" id="5175300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175306">return</span>&nbsp;<span class="ident" id="5175313">fmt</span><span class="op" id="5175316">.</span><span class="ident" id="5175317">Sprintf</span><span class="op" id="5175324">(</span><span class="string" id="5175325">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="5175343">,</span>&nbsp;<span class="builtintype" id="5175345">int</span><span class="op" id="5175348">(</span><span class="ident" id="5175349">s</span><span class="op" id="5175350">)</span><span class="op" id="5175351">)</span><br>
<span class="lineno">170</span><span class="op" id="5175353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5175356">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5175432">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="5175489">func</span>&nbsp;<span class="ident" id="5175494">isComment</span><span class="op" id="5175503">(</span><span class="ident" id="5175504">s</span>&nbsp;<span class="ident" id="5175506">state</span><span class="op" id="5175511">)</span>&nbsp;<span class="builtintype" id="5175513">bool</span>&nbsp;<span class="op" id="5175518">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175521">switch</span>&nbsp;<span class="ident" id="5175528">s</span>&nbsp;<span class="op" id="5175530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175533">case</span>&nbsp;<span class="ident" id="5175538">stateHTMLCmt</span><span class="op" id="5175550">,</span>&nbsp;<span class="ident" id="5175552">stateJSBlockCmt</span><span class="op" id="5175567">,</span>&nbsp;<span class="ident" id="5175569">stateJSLineCmt</span><span class="op" id="5175583">,</span>&nbsp;<span class="ident" id="5175585">stateCSSBlockCmt</span><span class="op" id="5175601">,</span>&nbsp;<span class="ident" id="5175603">stateCSSLineCmt</span><span class="op" id="5175618">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175622">return</span>&nbsp;<span class="builtintype" id="5175629">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175638">return</span>&nbsp;<span class="builtintype" id="5175645">false</span><br>
<span class="lineno">180</span><span class="op" id="5175651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5175654">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5175716">func</span>&nbsp;<span class="ident" id="5175721">isInTag</span><span class="op" id="5175728">(</span><span class="ident" id="5175729">s</span>&nbsp;<span class="ident" id="5175731">state</span><span class="op" id="5175736">)</span>&nbsp;<span class="builtintype" id="5175738">bool</span>&nbsp;<span class="op" id="5175743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175746">switch</span>&nbsp;<span class="ident" id="5175753">s</span>&nbsp;<span class="op" id="5175755">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175758">case</span>&nbsp;<span class="ident" id="5175763">stateTag</span><span class="op" id="5175771">,</span>&nbsp;<span class="ident" id="5175773">stateAttrName</span><span class="op" id="5175786">,</span>&nbsp;<span class="ident" id="5175788">stateAfterName</span><span class="op" id="5175802">,</span>&nbsp;<span class="ident" id="5175804">stateBeforeValue</span><span class="op" id="5175820">,</span>&nbsp;<span class="ident" id="5175822">stateAttr</span><span class="op" id="5175831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175835">return</span>&nbsp;<span class="builtintype" id="5175842">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175851">return</span>&nbsp;<span class="builtintype" id="5175858">false</span><br>
<span class="lineno"></span><span class="op" id="5175864">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5175867">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="5175935">type</span>&nbsp;<span class="ident" id="5175940">delim</span>&nbsp;<span class="builtintype" id="5175946">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5175953">const</span>&nbsp;<span class="op" id="5175959">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5175962">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176006">delimNone</span>&nbsp;<span class="ident" id="5176016">delim</span>&nbsp;<span class="op" id="5176022">=</span>&nbsp;<span class="ident" id="5176024">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176030">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176104">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176122">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176196">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176214">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176284">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176310">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="5176329">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="5176332">var</span>&nbsp;<span class="ident" id="5176336">delimNames</span>&nbsp;<span class="op" id="5176347">=</span>&nbsp;<span class="op" id="5176349">[</span><span class="op" id="5176350">...</span><span class="op" id="5176353">]</span><span class="builtintype" id="5176354">string</span><span class="op" id="5176360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176363">delimNone</span><span class="op" id="5176372">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5176383">&#34;delimNone&#34;</span><span class="op" id="5176394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176397">delimDoubleQuote</span><span class="op" id="5176413">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5176417">&#34;delimDoubleQuote&#34;</span><span class="op" id="5176435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176438">delimSingleQuote</span><span class="op" id="5176454">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5176458">&#34;delimSingleQuote&#34;</span><span class="op" id="5176476">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176479">delimSpaceOrTagEnd</span><span class="op" id="5176497">:</span>&nbsp;<span class="string" id="5176499">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="5176519">,</span><br>
<span class="lineno"></span><span class="op" id="5176521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5176524">func</span>&nbsp;<span class="op" id="5176529">(</span><span class="ident" id="5176530">d</span>&nbsp;<span class="ident" id="5176532">delim</span><span class="op" id="5176537">)</span>&nbsp;<span class="ident" id="5176539">String</span><span class="op" id="5176545">(</span><span class="op" id="5176546">)</span>&nbsp;<span class="builtintype" id="5176548">string</span>&nbsp;<span class="op" id="5176555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176558">if</span>&nbsp;<span class="builtintype" id="5176561">int</span><span class="op" id="5176564">(</span><span class="ident" id="5176565">d</span><span class="op" id="5176566">)</span>&nbsp;<span class="op" id="5176568">&lt;</span>&nbsp;<span class="builtinfunc" id="5176570">len</span><span class="op" id="5176573">(</span><span class="ident" id="5176574">delimNames</span><span class="op" id="5176584">)</span>&nbsp;<span class="op" id="5176586">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176590">return</span>&nbsp;<span class="ident" id="5176597">delimNames</span><span class="op" id="5176607">[</span><span class="ident" id="5176608">d</span><span class="op" id="5176609">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176615">return</span>&nbsp;<span class="ident" id="5176622">fmt</span><span class="op" id="5176625">.</span><span class="ident" id="5176626">Sprintf</span><span class="op" id="5176633">(</span><span class="string" id="5176634">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="5176652">,</span>&nbsp;<span class="builtintype" id="5176654">int</span><span class="op" id="5176657">(</span><span class="ident" id="5176658">d</span><span class="op" id="5176659">)</span><span class="op" id="5176660">)</span><br>
<span class="lineno"></span><span class="op" id="5176662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5176665">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="5176745">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="5176769">type</span>&nbsp;<span class="ident" id="5176774">urlPart</span>&nbsp;<span class="builtintype" id="5176782">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5176789">const</span>&nbsp;<span class="op" id="5176795">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176798">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176866">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176905">urlPartNone</span>&nbsp;<span class="ident" id="5176917">urlPart</span>&nbsp;<span class="op" id="5176925">=</span>&nbsp;<span class="ident" id="5176927">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176933">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177007">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177048">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177065">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177134">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177169">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177189">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177258">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177289">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="5177304">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5177307">var</span>&nbsp;<span class="ident" id="5177311">urlPartNames</span>&nbsp;<span class="op" id="5177324">=</span>&nbsp;<span class="op" id="5177326">[</span><span class="op" id="5177327">...</span><span class="op" id="5177330">]</span><span class="builtintype" id="5177331">string</span><span class="op" id="5177337">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177340">urlPartNone</span><span class="op" id="5177351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5177360">&#34;urlPartNone&#34;</span><span class="op" id="5177373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177376">urlPartPreQuery</span><span class="op" id="5177391">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5177396">&#34;urlPartPreQuery&#34;</span><span class="op" id="5177413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177416">urlPartQueryOrFrag</span><span class="op" id="5177434">:</span>&nbsp;<span class="string" id="5177436">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="5177456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177459">urlPartUnknown</span><span class="op" id="5177473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5177479">&#34;urlPartUnknown&#34;</span><span class="op" id="5177495">,</span><br>
<span class="lineno"></span><span class="op" id="5177497">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="5177500">func</span>&nbsp;<span class="op" id="5177505">(</span><span class="ident" id="5177506">u</span>&nbsp;<span class="ident" id="5177508">urlPart</span><span class="op" id="5177515">)</span>&nbsp;<span class="ident" id="5177517">String</span><span class="op" id="5177523">(</span><span class="op" id="5177524">)</span>&nbsp;<span class="builtintype" id="5177526">string</span>&nbsp;<span class="op" id="5177533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177536">if</span>&nbsp;<span class="builtintype" id="5177539">int</span><span class="op" id="5177542">(</span><span class="ident" id="5177543">u</span><span class="op" id="5177544">)</span>&nbsp;<span class="op" id="5177546">&lt;</span>&nbsp;<span class="builtinfunc" id="5177548">len</span><span class="op" id="5177551">(</span><span class="ident" id="5177552">urlPartNames</span><span class="op" id="5177564">)</span>&nbsp;<span class="op" id="5177566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177570">return</span>&nbsp;<span class="ident" id="5177577">urlPartNames</span><span class="op" id="5177589">[</span><span class="ident" id="5177590">u</span><span class="op" id="5177591">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177594">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177597">return</span>&nbsp;<span class="ident" id="5177604">fmt</span><span class="op" id="5177607">.</span><span class="ident" id="5177608">Sprintf</span><span class="op" id="5177615">(</span><span class="string" id="5177616">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="5177636">,</span>&nbsp;<span class="builtintype" id="5177638">int</span><span class="op" id="5177641">(</span><span class="ident" id="5177642">u</span><span class="op" id="5177643">)</span><span class="op" id="5177644">)</span><br>
<span class="lineno"></span><span class="op" id="5177646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5177649">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5177724">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="5177746">type</span>&nbsp;<span class="ident" id="5177751">jsCtx</span>&nbsp;<span class="builtintype" id="5177757">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5177764">const</span>&nbsp;<span class="op" id="5177770">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177773">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177838">jsCtxRegexp</span>&nbsp;<span class="ident" id="5177850">jsCtx</span>&nbsp;<span class="op" id="5177856">=</span>&nbsp;<span class="ident" id="5177858">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177864">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177931">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177943">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178016">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="5178029">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="5178032">func</span>&nbsp;<span class="op" id="5178037">(</span><span class="ident" id="5178038">c</span>&nbsp;<span class="ident" id="5178040">jsCtx</span><span class="op" id="5178045">)</span>&nbsp;<span class="ident" id="5178047">String</span><span class="op" id="5178053">(</span><span class="op" id="5178054">)</span>&nbsp;<span class="builtintype" id="5178056">string</span>&nbsp;<span class="op" id="5178063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178066">switch</span>&nbsp;<span class="ident" id="5178073">c</span>&nbsp;<span class="op" id="5178075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178078">case</span>&nbsp;<span class="ident" id="5178083">jsCtxRegexp</span><span class="op" id="5178094">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178098">return</span>&nbsp;<span class="string" id="5178105">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178120">case</span>&nbsp;<span class="ident" id="5178125">jsCtxDivOp</span><span class="op" id="5178135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178139">return</span>&nbsp;<span class="string" id="5178146">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178160">case</span>&nbsp;<span class="ident" id="5178165">jsCtxUnknown</span><span class="op" id="5178177">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178181">return</span>&nbsp;<span class="string" id="5178188">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178204">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178207">return</span>&nbsp;<span class="ident" id="5178214">fmt</span><span class="op" id="5178217">.</span><span class="ident" id="5178218">Sprintf</span><span class="op" id="5178225">(</span><span class="string" id="5178226">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="5178244">,</span>&nbsp;<span class="builtintype" id="5178246">int</span><span class="op" id="5178249">(</span><span class="ident" id="5178250">c</span><span class="op" id="5178251">)</span><span class="op" id="5178252">)</span><br>
<span class="lineno"></span><span class="op" id="5178254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5178257">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="5178337">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="5178417">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5178491">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5178570">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5178601">type</span>&nbsp;<span class="ident" id="5178606">element</span>&nbsp;<span class="builtintype" id="5178614">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5178621">const</span>&nbsp;<span class="op" id="5178627">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178630">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178700">elementNone</span>&nbsp;<span class="ident" id="5178712">element</span>&nbsp;<span class="op" id="5178720">=</span>&nbsp;<span class="ident" id="5178722">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178728">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178792">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178807">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178869">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178883">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178949">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178966">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179026">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="5179039">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5179042">var</span>&nbsp;<span class="ident" id="5179046">elementNames</span>&nbsp;<span class="op" id="5179059">=</span>&nbsp;<span class="op" id="5179061">[</span><span class="op" id="5179062">...</span><span class="op" id="5179065">]</span><span class="builtintype" id="5179066">string</span><span class="op" id="5179072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179075">elementNone</span><span class="op" id="5179086">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5179092">&#34;elementNone&#34;</span><span class="op" id="5179105">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179108">elementScript</span><span class="op" id="5179121">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5179125">&#34;elementScript&#34;</span><span class="op" id="5179140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179143">elementStyle</span><span class="op" id="5179155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5179160">&#34;elementStyle&#34;</span><span class="op" id="5179174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179177">elementTextarea</span><span class="op" id="5179192">:</span>&nbsp;<span class="string" id="5179194">&#34;elementTextarea&#34;</span><span class="op" id="5179211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179214">elementTitle</span><span class="op" id="5179226">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5179231">&#34;elementTitle&#34;</span><span class="op" id="5179245">,</span><br>
<span class="lineno"></span><span class="op" id="5179247">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="5179250">func</span>&nbsp;<span class="op" id="5179255">(</span><span class="ident" id="5179256">e</span>&nbsp;<span class="ident" id="5179258">element</span><span class="op" id="5179265">)</span>&nbsp;<span class="ident" id="5179267">String</span><span class="op" id="5179273">(</span><span class="op" id="5179274">)</span>&nbsp;<span class="builtintype" id="5179276">string</span>&nbsp;<span class="op" id="5179283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179286">if</span>&nbsp;<span class="builtintype" id="5179289">int</span><span class="op" id="5179292">(</span><span class="ident" id="5179293">e</span><span class="op" id="5179294">)</span>&nbsp;<span class="op" id="5179296">&lt;</span>&nbsp;<span class="builtinfunc" id="5179298">len</span><span class="op" id="5179301">(</span><span class="ident" id="5179302">elementNames</span><span class="op" id="5179314">)</span>&nbsp;<span class="op" id="5179316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179320">return</span>&nbsp;<span class="ident" id="5179327">elementNames</span><span class="op" id="5179339">[</span><span class="ident" id="5179340">e</span><span class="op" id="5179341">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179344">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179347">return</span>&nbsp;<span class="ident" id="5179354">fmt</span><span class="op" id="5179357">.</span><span class="ident" id="5179358">Sprintf</span><span class="op" id="5179365">(</span><span class="string" id="5179366">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="5179386">,</span>&nbsp;<span class="builtintype" id="5179388">int</span><span class="op" id="5179391">(</span><span class="ident" id="5179392">e</span><span class="op" id="5179393">)</span><span class="op" id="5179394">)</span><br>
<span class="lineno"></span><span class="op" id="5179396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5179399">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5179474">type</span>&nbsp;<span class="ident" id="5179479">attr</span>&nbsp;<span class="builtintype" id="5179484">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5179491">const</span>&nbsp;<span class="op" id="5179497">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179500">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179564">attrNone</span>&nbsp;<span class="ident" id="5179573">attr</span>&nbsp;<span class="op" id="5179578">=</span>&nbsp;<span class="ident" id="5179580">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179586">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179644">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179656">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179725">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179736">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179798">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="5179806">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5179809">var</span>&nbsp;<span class="ident" id="5179813">attrNames</span>&nbsp;<span class="op" id="5179823">=</span>&nbsp;<span class="op" id="5179825">[</span><span class="op" id="5179826">...</span><span class="op" id="5179829">]</span><span class="builtintype" id="5179830">string</span><span class="op" id="5179836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179839">attrNone</span><span class="op" id="5179847">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5179851">&#34;attrNone&#34;</span><span class="op" id="5179861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179864">attrScript</span><span class="op" id="5179874">:</span>&nbsp;<span class="string" id="5179876">&#34;attrScript&#34;</span><span class="op" id="5179888">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179891">attrStyle</span><span class="op" id="5179900">:</span>&nbsp;&nbsp;<span class="string" id="5179903">&#34;attrStyle&#34;</span><span class="op" id="5179914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179917">attrURL</span><span class="op" id="5179924">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5179929">&#34;attrURL&#34;</span><span class="op" id="5179938">,</span><br>
<span class="lineno"></span><span class="op" id="5179940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5179943">func</span>&nbsp;<span class="op" id="5179948">(</span><span class="ident" id="5179949">a</span>&nbsp;<span class="ident" id="5179951">attr</span><span class="op" id="5179955">)</span>&nbsp;<span class="ident" id="5179957">String</span><span class="op" id="5179963">(</span><span class="op" id="5179964">)</span>&nbsp;<span class="builtintype" id="5179966">string</span>&nbsp;<span class="op" id="5179973">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179976">if</span>&nbsp;<span class="builtintype" id="5179979">int</span><span class="op" id="5179982">(</span><span class="ident" id="5179983">a</span><span class="op" id="5179984">)</span>&nbsp;<span class="op" id="5179986">&lt;</span>&nbsp;<span class="builtinfunc" id="5179988">len</span><span class="op" id="5179991">(</span><span class="ident" id="5179992">attrNames</span><span class="op" id="5180001">)</span>&nbsp;<span class="op" id="5180003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180007">return</span>&nbsp;<span class="ident" id="5180014">attrNames</span><span class="op" id="5180023">[</span><span class="ident" id="5180024">a</span><span class="op" id="5180025">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180031">return</span>&nbsp;<span class="ident" id="5180038">fmt</span><span class="op" id="5180041">.</span><span class="ident" id="5180042">Sprintf</span><span class="op" id="5180049">(</span><span class="string" id="5180050">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="5180067">,</span>&nbsp;<span class="builtintype" id="5180069">int</span><span class="op" id="5180072">(</span><span class="ident" id="5180073">a</span><span class="op" id="5180074">)</span><span class="op" id="5180075">)</span><br>
<span class="lineno"></span><span class="op" id="5180077">}</span>
</div>
</body>
</html>
