<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7894479">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7894534">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7894588">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7894639">package</span>&nbsp;<span class="ident" id="7894647">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7894652">import</span>&nbsp;<span class="op" id="7894659">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7894662">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7894671">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7894678">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7894688">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7894691">type</span>&nbsp;<span class="ident" id="7894696">rc4Test</span>&nbsp;<span class="keyword" id="7894704">struct</span>&nbsp;<span class="op" id="7894711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7894714">key</span><span class="op" id="7894717">,</span>&nbsp;<span class="ident" id="7894719">keystream</span>&nbsp;<span class="op" id="7894729">[</span><span class="op" id="7894730">]</span><span class="builtintype" id="7894731">byte</span><br>
<span class="lineno">15</span><span class="op" id="7894736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7894739">var</span>&nbsp;<span class="ident" id="7894743">golden</span>&nbsp;<span class="op" id="7894750">=</span>&nbsp;<span class="op" id="7894752">[</span><span class="op" id="7894753">]</span><span class="ident" id="7894754">rc4Test</span><span class="op" id="7894761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7894764">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7894827">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7894901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7894905">[</span><span class="op" id="7894906">]</span><span class="builtintype" id="7894907">byte</span><span class="op" id="7894911">{</span><span class="num" id="7894912">0x01</span><span class="op" id="7894916">,</span>&nbsp;<span class="num" id="7894918">0x23</span><span class="op" id="7894922">,</span>&nbsp;<span class="num" id="7894924">0x45</span><span class="op" id="7894928">,</span>&nbsp;<span class="num" id="7894930">0x67</span><span class="op" id="7894934">,</span>&nbsp;<span class="num" id="7894936">0x89</span><span class="op" id="7894940">,</span>&nbsp;<span class="num" id="7894942">0xab</span><span class="op" id="7894946">,</span>&nbsp;<span class="num" id="7894948">0xcd</span><span class="op" id="7894952">,</span>&nbsp;<span class="num" id="7894954">0xef</span><span class="op" id="7894958">}</span><span class="op" id="7894959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7894963">[</span><span class="op" id="7894964">]</span><span class="builtintype" id="7894965">byte</span><span class="op" id="7894969">{</span><span class="num" id="7894970">0x74</span><span class="op" id="7894974">,</span>&nbsp;<span class="num" id="7894976">0x94</span><span class="op" id="7894980">,</span>&nbsp;<span class="num" id="7894982">0xc2</span><span class="op" id="7894986">,</span>&nbsp;<span class="num" id="7894988">0xe7</span><span class="op" id="7894992">,</span>&nbsp;<span class="num" id="7894994">0x10</span><span class="op" id="7894998">,</span>&nbsp;<span class="num" id="7895000">0x4b</span><span class="op" id="7895004">,</span>&nbsp;<span class="num" id="7895006">0x08</span><span class="op" id="7895010">,</span>&nbsp;<span class="num" id="7895012">0x79</span><span class="op" id="7895016">}</span><span class="op" id="7895017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895020">}</span><span class="op" id="7895021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895024">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895028">[</span><span class="op" id="7895029">]</span><span class="builtintype" id="7895030">byte</span><span class="op" id="7895034">{</span><span class="num" id="7895035">0x00</span><span class="op" id="7895039">,</span>&nbsp;<span class="num" id="7895041">0x00</span><span class="op" id="7895045">,</span>&nbsp;<span class="num" id="7895047">0x00</span><span class="op" id="7895051">,</span>&nbsp;<span class="num" id="7895053">0x00</span><span class="op" id="7895057">,</span>&nbsp;<span class="num" id="7895059">0x00</span><span class="op" id="7895063">,</span>&nbsp;<span class="num" id="7895065">0x00</span><span class="op" id="7895069">,</span>&nbsp;<span class="num" id="7895071">0x00</span><span class="op" id="7895075">,</span>&nbsp;<span class="num" id="7895077">0x00</span><span class="op" id="7895081">}</span><span class="op" id="7895082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895086">[</span><span class="op" id="7895087">]</span><span class="builtintype" id="7895088">byte</span><span class="op" id="7895092">{</span><span class="num" id="7895093">0xde</span><span class="op" id="7895097">,</span>&nbsp;<span class="num" id="7895099">0x18</span><span class="op" id="7895103">,</span>&nbsp;<span class="num" id="7895105">0x89</span><span class="op" id="7895109">,</span>&nbsp;<span class="num" id="7895111">0x41</span><span class="op" id="7895115">,</span>&nbsp;<span class="num" id="7895117">0xa3</span><span class="op" id="7895121">,</span>&nbsp;<span class="num" id="7895123">0x37</span><span class="op" id="7895127">,</span>&nbsp;<span class="num" id="7895129">0x5d</span><span class="op" id="7895133">,</span>&nbsp;<span class="num" id="7895135">0x3a</span><span class="op" id="7895139">}</span><span class="op" id="7895140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895143">}</span><span class="op" id="7895144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895151">[</span><span class="op" id="7895152">]</span><span class="builtintype" id="7895153">byte</span><span class="op" id="7895157">{</span><span class="num" id="7895158">0xef</span><span class="op" id="7895162">,</span>&nbsp;<span class="num" id="7895164">0x01</span><span class="op" id="7895168">,</span>&nbsp;<span class="num" id="7895170">0x23</span><span class="op" id="7895174">,</span>&nbsp;<span class="num" id="7895176">0x45</span><span class="op" id="7895180">}</span><span class="op" id="7895181">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895185">[</span><span class="op" id="7895186">]</span><span class="builtintype" id="7895187">byte</span><span class="op" id="7895191">{</span><span class="num" id="7895192">0xd6</span><span class="op" id="7895196">,</span>&nbsp;<span class="num" id="7895198">0xa1</span><span class="op" id="7895202">,</span>&nbsp;<span class="num" id="7895204">0x41</span><span class="op" id="7895208">,</span>&nbsp;<span class="num" id="7895210">0xa7</span><span class="op" id="7895214">,</span>&nbsp;<span class="num" id="7895216">0xec</span><span class="op" id="7895220">,</span>&nbsp;<span class="num" id="7895222">0x3c</span><span class="op" id="7895226">,</span>&nbsp;<span class="num" id="7895228">0x38</span><span class="op" id="7895232">,</span>&nbsp;<span class="num" id="7895234">0xdf</span><span class="op" id="7895238">,</span>&nbsp;<span class="num" id="7895240">0xbd</span><span class="op" id="7895244">,</span>&nbsp;<span class="num" id="7895246">0x61</span><span class="op" id="7895250">}</span><span class="op" id="7895251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895254">}</span><span class="op" id="7895255">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7895259">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895334">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895338">[</span><span class="op" id="7895339">]</span><span class="builtintype" id="7895340">byte</span><span class="op" id="7895344">{</span><span class="num" id="7895345">0x4b</span><span class="op" id="7895349">,</span>&nbsp;<span class="num" id="7895351">0x65</span><span class="op" id="7895355">,</span>&nbsp;<span class="num" id="7895357">0x79</span><span class="op" id="7895361">}</span><span class="op" id="7895362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895366">[</span><span class="op" id="7895367">]</span><span class="builtintype" id="7895368">byte</span><span class="op" id="7895372">{</span><span class="num" id="7895373">0xeb</span><span class="op" id="7895377">,</span>&nbsp;<span class="num" id="7895379">0x9f</span><span class="op" id="7895383">,</span>&nbsp;<span class="num" id="7895385">0x77</span><span class="op" id="7895389">,</span>&nbsp;<span class="num" id="7895391">0x81</span><span class="op" id="7895395">,</span>&nbsp;<span class="num" id="7895397">0xb7</span><span class="op" id="7895401">,</span>&nbsp;<span class="num" id="7895403">0x34</span><span class="op" id="7895407">,</span>&nbsp;<span class="num" id="7895409">0xca</span><span class="op" id="7895413">,</span>&nbsp;<span class="num" id="7895415">0x72</span><span class="op" id="7895419">,</span>&nbsp;<span class="num" id="7895421">0xa7</span><span class="op" id="7895425">,</span>&nbsp;<span class="num" id="7895427">0x19</span><span class="op" id="7895431">}</span><span class="op" id="7895432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895435">}</span><span class="op" id="7895436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895443">[</span><span class="op" id="7895444">]</span><span class="builtintype" id="7895445">byte</span><span class="op" id="7895449">{</span><span class="num" id="7895450">0x57</span><span class="op" id="7895454">,</span>&nbsp;<span class="num" id="7895456">0x69</span><span class="op" id="7895460">,</span>&nbsp;<span class="num" id="7895462">0x6b</span><span class="op" id="7895466">,</span>&nbsp;<span class="num" id="7895468">0x69</span><span class="op" id="7895472">}</span><span class="op" id="7895473">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895477">[</span><span class="op" id="7895478">]</span><span class="builtintype" id="7895479">byte</span><span class="op" id="7895483">{</span><span class="num" id="7895484">0x60</span><span class="op" id="7895488">,</span>&nbsp;<span class="num" id="7895490">0x44</span><span class="op" id="7895494">,</span>&nbsp;<span class="num" id="7895496">0xdb</span><span class="op" id="7895500">,</span>&nbsp;<span class="num" id="7895502">0x6d</span><span class="op" id="7895506">,</span>&nbsp;<span class="num" id="7895508">0x41</span><span class="op" id="7895512">,</span>&nbsp;<span class="num" id="7895514">0xb7</span><span class="op" id="7895518">}</span><span class="op" id="7895519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895522">}</span><span class="op" id="7895523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895530">[</span><span class="op" id="7895531">]</span><span class="builtintype" id="7895532">byte</span><span class="op" id="7895536">{</span><span class="num" id="7895537">0x00</span><span class="op" id="7895541">,</span>&nbsp;<span class="num" id="7895543">0x00</span><span class="op" id="7895547">,</span>&nbsp;<span class="num" id="7895549">0x00</span><span class="op" id="7895553">,</span>&nbsp;<span class="num" id="7895555">0x00</span><span class="op" id="7895559">,</span>&nbsp;<span class="num" id="7895561">0x00</span><span class="op" id="7895565">,</span>&nbsp;<span class="num" id="7895567">0x00</span><span class="op" id="7895571">,</span>&nbsp;<span class="num" id="7895573">0x00</span><span class="op" id="7895577">,</span>&nbsp;<span class="num" id="7895579">0x00</span><span class="op" id="7895583">}</span><span class="op" id="7895584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7895588">[</span><span class="op" id="7895589">]</span><span class="builtintype" id="7895590">byte</span><span class="op" id="7895594">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7895599">0xde</span><span class="op" id="7895603">,</span>&nbsp;<span class="num" id="7895605">0x18</span><span class="op" id="7895609">,</span>&nbsp;<span class="num" id="7895611">0x89</span><span class="op" id="7895615">,</span>&nbsp;<span class="num" id="7895617">0x41</span><span class="op" id="7895621">,</span>&nbsp;<span class="num" id="7895623">0xa3</span><span class="op" id="7895627">,</span>&nbsp;<span class="num" id="7895629">0x37</span><span class="op" id="7895633">,</span>&nbsp;<span class="num" id="7895635">0x5d</span><span class="op" id="7895639">,</span>&nbsp;<span class="num" id="7895641">0x3a</span><span class="op" id="7895645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7895650">0x8a</span><span class="op" id="7895654">,</span>&nbsp;<span class="num" id="7895656">0x06</span><span class="op" id="7895660">,</span>&nbsp;<span class="num" id="7895662">0x1e</span><span class="op" id="7895666">,</span>&nbsp;<span class="num" id="7895668">0x67</span><span class="op" id="7895672">,</span>&nbsp;<span class="num" id="7895674">0x57</span><span class="op" id="7895678">,</span>&nbsp;<span class="num" id="7895680">0x6e</span><span class="op" id="7895684">,</span>&nbsp;<span class="num" id="7895686">0x92</span><span class="op" id="7895690">,</span>&nbsp;<span class="num" id="7895692">0x6d</span><span class="op" id="7895696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7895701">0xc7</span><span class="op" id="7895705">,</span>&nbsp;<span class="num" id="7895707">0x1a</span><span class="op" id="7895711">,</span>&nbsp;<span class="num" id="7895713">0x7f</span><span class="op" id="7895717">,</span>&nbsp;<span class="num" id="7895719">0xa3</span><span class="op" id="7895723">,</span>&nbsp;<span class="num" id="7895725">0xf0</span><span class="op" id="7895729">,</span>&nbsp;<span class="num" id="7895731">0xcc</span><span class="op" id="7895735">,</span>&nbsp;<span class="num" id="7895737">0xeb</span><span class="op" id="7895741">,</span>&nbsp;<span class="num" id="7895743">0x97</span><span class="op" id="7895747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7895752">0x45</span><span class="op" id="7895756">,</span>&nbsp;<span class="num" id="7895758">0x2b</span><span class="op" id="7895762">,</span>&nbsp;<span class="num" id="7895764">0x4d</span><span class="op" id="7895768">,</span>&nbsp;<span class="num" id="7895770">0x32</span><span class="op" id="7895774">,</span>&nbsp;<span class="num" id="7895776">0x27</span><span class="op" id="7895780">,</span>&nbsp;<span class="num" id="7895782">0x96</span><span class="op" id="7895786">,</span>&nbsp;<span class="num" id="7895788">0x5f</span><span class="op" id="7895792">,</span>&nbsp;<span class="num" id="7895794">0x9e</span><span class="op" id="7895798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7895803">0xa8</span><span class="op" id="7895807">,</span>&nbsp;<span class="num" id="7895809">0xcc</span><span class="op" id="7895813">,</span>&nbsp;<span class="num" id="7895815">0x75</span><span class="op" id="7895819">,</span>&nbsp;<span class="num" id="7895821">0x07</span><span class="op" id="7895825">,</span>&nbsp;<span class="num" id="7895827">0x6d</span><span class="op" id="7895831">,</span>&nbsp;<span class="num" id="7895833">0x9f</span><span class="op" id="7895837">,</span>&nbsp;<span class="num" id="7895839">0xb9</span><span class="op" id="7895843">,</span>&nbsp;<span class="num" id="7895845">0xc5</span><span class="op" id="7895849">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7895854">0x41</span><span class="op" id="7895858">,</span>&nbsp;<span class="num" id="7895860">0x7a</span><span class="op" id="7895864">,</span>&nbsp;<span class="num" id="7895866">0xa5</span><span class="op" id="7895870">,</span>&nbsp;<span class="num" id="7895872">0xcb</span><span class="op" id="7895876">,</span>&nbsp;<span class="num" id="7895878">0x30</span><span class="op" id="7895882">,</span>&nbsp;<span class="num" id="7895884">0xfc</span><span class="op" id="7895888">,</span>&nbsp;<span class="num" id="7895890">0x22</span><span class="op" id="7895894">,</span>&nbsp;<span class="num" id="7895896">0x19</span><span class="op" id="7895900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7895905">0x8b</span><span class="op" id="7895909">,</span>&nbsp;<span class="num" id="7895911">0x34</span><span class="op" id="7895915">,</span>&nbsp;<span class="num" id="7895917">0x98</span><span class="op" id="7895921">,</span>&nbsp;<span class="num" id="7895923">0x2d</span><span class="op" id="7895927">,</span>&nbsp;<span class="num" id="7895929">0xbb</span><span class="op" id="7895933">,</span>&nbsp;<span class="num" id="7895935">0x62</span><span class="op" id="7895939">,</span>&nbsp;<span class="num" id="7895941">0x9e</span><span class="op" id="7895945">,</span>&nbsp;<span class="num" id="7895947">0xc0</span><span class="op" id="7895951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7895956">0x4b</span><span class="op" id="7895960">,</span>&nbsp;<span class="num" id="7895962">0x4f</span><span class="op" id="7895966">,</span>&nbsp;<span class="num" id="7895968">0x8b</span><span class="op" id="7895972">,</span>&nbsp;<span class="num" id="7895974">0x05</span><span class="op" id="7895978">,</span>&nbsp;<span class="num" id="7895980">0xa0</span><span class="op" id="7895984">,</span>&nbsp;<span class="num" id="7895986">0x71</span><span class="op" id="7895990">,</span>&nbsp;<span class="num" id="7895992">0x08</span><span class="op" id="7895996">,</span>&nbsp;<span class="num" id="7895998">0x50</span><span class="op" id="7896002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896007">0x92</span><span class="op" id="7896011">,</span>&nbsp;<span class="num" id="7896013">0xa0</span><span class="op" id="7896017">,</span>&nbsp;<span class="num" id="7896019">0xc3</span><span class="op" id="7896023">,</span>&nbsp;<span class="num" id="7896025">0x58</span><span class="op" id="7896029">,</span>&nbsp;<span class="num" id="7896031">0x4a</span><span class="op" id="7896035">,</span>&nbsp;<span class="num" id="7896037">0x48</span><span class="op" id="7896041">,</span>&nbsp;<span class="num" id="7896043">0xe4</span><span class="op" id="7896047">,</span>&nbsp;<span class="num" id="7896049">0xa3</span><span class="op" id="7896053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896058">0x0a</span><span class="op" id="7896062">,</span>&nbsp;<span class="num" id="7896064">0x39</span><span class="op" id="7896068">,</span>&nbsp;<span class="num" id="7896070">0x7b</span><span class="op" id="7896074">,</span>&nbsp;<span class="num" id="7896076">0x8a</span><span class="op" id="7896080">,</span>&nbsp;<span class="num" id="7896082">0xcd</span><span class="op" id="7896086">,</span>&nbsp;<span class="num" id="7896088">0x1d</span><span class="op" id="7896092">,</span>&nbsp;<span class="num" id="7896094">0x00</span><span class="op" id="7896098">,</span>&nbsp;<span class="num" id="7896100">0x9e</span><span class="op" id="7896104">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896109">0xc8</span><span class="op" id="7896113">,</span>&nbsp;<span class="num" id="7896115">0x7d</span><span class="op" id="7896119">,</span>&nbsp;<span class="num" id="7896121">0x68</span><span class="op" id="7896125">,</span>&nbsp;<span class="num" id="7896127">0x11</span><span class="op" id="7896131">,</span>&nbsp;<span class="num" id="7896133">0xf2</span><span class="op" id="7896137">,</span>&nbsp;<span class="num" id="7896139">0x2c</span><span class="op" id="7896143">,</span>&nbsp;<span class="num" id="7896145">0xf4</span><span class="op" id="7896149">,</span>&nbsp;<span class="num" id="7896151">0x9c</span><span class="op" id="7896155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896160">0xa3</span><span class="op" id="7896164">,</span>&nbsp;<span class="num" id="7896166">0xe5</span><span class="op" id="7896170">,</span>&nbsp;<span class="num" id="7896172">0x93</span><span class="op" id="7896176">,</span>&nbsp;<span class="num" id="7896178">0x54</span><span class="op" id="7896182">,</span>&nbsp;<span class="num" id="7896184">0xb9</span><span class="op" id="7896188">,</span>&nbsp;<span class="num" id="7896190">0x45</span><span class="op" id="7896194">,</span>&nbsp;<span class="num" id="7896196">0x15</span><span class="op" id="7896200">,</span>&nbsp;<span class="num" id="7896202">0x35</span><span class="op" id="7896206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896211">0xa2</span><span class="op" id="7896215">,</span>&nbsp;<span class="num" id="7896217">0x18</span><span class="op" id="7896221">,</span>&nbsp;<span class="num" id="7896223">0x7a</span><span class="op" id="7896227">,</span>&nbsp;<span class="num" id="7896229">0x86</span><span class="op" id="7896233">,</span>&nbsp;<span class="num" id="7896235">0x42</span><span class="op" id="7896239">,</span>&nbsp;<span class="num" id="7896241">0x6c</span><span class="op" id="7896245">,</span>&nbsp;<span class="num" id="7896247">0xca</span><span class="op" id="7896251">,</span>&nbsp;<span class="num" id="7896253">0x7d</span><span class="op" id="7896257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896262">0x5e</span><span class="op" id="7896266">,</span>&nbsp;<span class="num" id="7896268">0x82</span><span class="op" id="7896272">,</span>&nbsp;<span class="num" id="7896274">0x3e</span><span class="op" id="7896278">,</span>&nbsp;<span class="num" id="7896280">0xba</span><span class="op" id="7896284">,</span>&nbsp;<span class="num" id="7896286">0x00</span><span class="op" id="7896290">,</span>&nbsp;<span class="num" id="7896292">0x44</span><span class="op" id="7896296">,</span>&nbsp;<span class="num" id="7896298">0x12</span><span class="op" id="7896302">,</span>&nbsp;<span class="num" id="7896304">0x67</span><span class="op" id="7896308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896313">0x12</span><span class="op" id="7896317">,</span>&nbsp;<span class="num" id="7896319">0x57</span><span class="op" id="7896323">,</span>&nbsp;<span class="num" id="7896325">0xb8</span><span class="op" id="7896329">,</span>&nbsp;<span class="num" id="7896331">0xd8</span><span class="op" id="7896335">,</span>&nbsp;<span class="num" id="7896337">0x60</span><span class="op" id="7896341">,</span>&nbsp;<span class="num" id="7896343">0xae</span><span class="op" id="7896347">,</span>&nbsp;<span class="num" id="7896349">0x4c</span><span class="op" id="7896353">,</span>&nbsp;<span class="num" id="7896355">0xbd</span><span class="op" id="7896359">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896364">0x4c</span><span class="op" id="7896368">,</span>&nbsp;<span class="num" id="7896370">0x49</span><span class="op" id="7896374">,</span>&nbsp;<span class="num" id="7896376">0x06</span><span class="op" id="7896380">,</span>&nbsp;<span class="num" id="7896382">0xbb</span><span class="op" id="7896386">,</span>&nbsp;<span class="num" id="7896388">0xc5</span><span class="op" id="7896392">,</span>&nbsp;<span class="num" id="7896394">0x35</span><span class="op" id="7896398">,</span>&nbsp;<span class="num" id="7896400">0xef</span><span class="op" id="7896404">,</span>&nbsp;<span class="num" id="7896406">0xe1</span><span class="op" id="7896410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896415">0x58</span><span class="op" id="7896419">,</span>&nbsp;<span class="num" id="7896421">0x7f</span><span class="op" id="7896425">,</span>&nbsp;<span class="num" id="7896427">0x08</span><span class="op" id="7896431">,</span>&nbsp;<span class="num" id="7896433">0xdb</span><span class="op" id="7896437">,</span>&nbsp;<span class="num" id="7896439">0x33</span><span class="op" id="7896443">,</span>&nbsp;<span class="num" id="7896445">0x95</span><span class="op" id="7896449">,</span>&nbsp;<span class="num" id="7896451">0x5c</span><span class="op" id="7896455">,</span>&nbsp;<span class="num" id="7896457">0xdb</span><span class="op" id="7896461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896466">0xcb</span><span class="op" id="7896470">,</span>&nbsp;<span class="num" id="7896472">0xad</span><span class="op" id="7896476">,</span>&nbsp;<span class="num" id="7896478">0x9b</span><span class="op" id="7896482">,</span>&nbsp;<span class="num" id="7896484">0x10</span><span class="op" id="7896488">,</span>&nbsp;<span class="num" id="7896490">0xf5</span><span class="op" id="7896494">,</span>&nbsp;<span class="num" id="7896496">0x3f</span><span class="op" id="7896500">,</span>&nbsp;<span class="num" id="7896502">0xc4</span><span class="op" id="7896506">,</span>&nbsp;<span class="num" id="7896508">0xe5</span><span class="op" id="7896512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896517">0x2c</span><span class="op" id="7896521">,</span>&nbsp;<span class="num" id="7896523">0x59</span><span class="op" id="7896527">,</span>&nbsp;<span class="num" id="7896529">0x15</span><span class="op" id="7896533">,</span>&nbsp;<span class="num" id="7896535">0x65</span><span class="op" id="7896539">,</span>&nbsp;<span class="num" id="7896541">0x51</span><span class="op" id="7896545">,</span>&nbsp;<span class="num" id="7896547">0x84</span><span class="op" id="7896551">,</span>&nbsp;<span class="num" id="7896553">0x87</span><span class="op" id="7896557">,</span>&nbsp;<span class="num" id="7896559">0xfe</span><span class="op" id="7896563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896568">0x08</span><span class="op" id="7896572">,</span>&nbsp;<span class="num" id="7896574">0x4d</span><span class="op" id="7896578">,</span>&nbsp;<span class="num" id="7896580">0x0e</span><span class="op" id="7896584">,</span>&nbsp;<span class="num" id="7896586">0x3f</span><span class="op" id="7896590">,</span>&nbsp;<span class="num" id="7896592">0x03</span><span class="op" id="7896596">,</span>&nbsp;<span class="num" id="7896598">0xde</span><span class="op" id="7896602">,</span>&nbsp;<span class="num" id="7896604">0xbc</span><span class="op" id="7896608">,</span>&nbsp;<span class="num" id="7896610">0xc9</span><span class="op" id="7896614">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896619">0xda</span><span class="op" id="7896623">,</span>&nbsp;<span class="num" id="7896625">0x1c</span><span class="op" id="7896629">,</span>&nbsp;<span class="num" id="7896631">0xe9</span><span class="op" id="7896635">,</span>&nbsp;<span class="num" id="7896637">0x0d</span><span class="op" id="7896641">,</span>&nbsp;<span class="num" id="7896643">0x08</span><span class="op" id="7896647">,</span>&nbsp;<span class="num" id="7896649">0x5c</span><span class="op" id="7896653">,</span>&nbsp;<span class="num" id="7896655">0x2d</span><span class="op" id="7896659">,</span>&nbsp;<span class="num" id="7896661">0x8a</span><span class="op" id="7896665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896670">0x19</span><span class="op" id="7896674">,</span>&nbsp;<span class="num" id="7896676">0xd8</span><span class="op" id="7896680">,</span>&nbsp;<span class="num" id="7896682">0x37</span><span class="op" id="7896686">,</span>&nbsp;<span class="num" id="7896688">0x30</span><span class="op" id="7896692">,</span>&nbsp;<span class="num" id="7896694">0x86</span><span class="op" id="7896698">,</span>&nbsp;<span class="num" id="7896700">0x16</span><span class="op" id="7896704">,</span>&nbsp;<span class="num" id="7896706">0x36</span><span class="op" id="7896710">,</span>&nbsp;<span class="num" id="7896712">0x92</span><span class="op" id="7896716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896721">0x14</span><span class="op" id="7896725">,</span>&nbsp;<span class="num" id="7896727">0x2b</span><span class="op" id="7896731">,</span>&nbsp;<span class="num" id="7896733">0xd8</span><span class="op" id="7896737">,</span>&nbsp;<span class="num" id="7896739">0xfc</span><span class="op" id="7896743">,</span>&nbsp;<span class="num" id="7896745">0x5d</span><span class="op" id="7896749">,</span>&nbsp;<span class="num" id="7896751">0x7a</span><span class="op" id="7896755">,</span>&nbsp;<span class="num" id="7896757">0x73</span><span class="op" id="7896761">,</span>&nbsp;<span class="num" id="7896763">0x49</span><span class="op" id="7896767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896772">0x6a</span><span class="op" id="7896776">,</span>&nbsp;<span class="num" id="7896778">0x8e</span><span class="op" id="7896782">,</span>&nbsp;<span class="num" id="7896784">0x59</span><span class="op" id="7896788">,</span>&nbsp;<span class="num" id="7896790">0xee</span><span class="op" id="7896794">,</span>&nbsp;<span class="num" id="7896796">0x7e</span><span class="op" id="7896800">,</span>&nbsp;<span class="num" id="7896802">0xcf</span><span class="op" id="7896806">,</span>&nbsp;<span class="num" id="7896808">0x6b</span><span class="op" id="7896812">,</span>&nbsp;<span class="num" id="7896814">0x94</span><span class="op" id="7896818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896823">0x06</span><span class="op" id="7896827">,</span>&nbsp;<span class="num" id="7896829">0x63</span><span class="op" id="7896833">,</span>&nbsp;<span class="num" id="7896835">0xf4</span><span class="op" id="7896839">,</span>&nbsp;<span class="num" id="7896841">0xa6</span><span class="op" id="7896845">,</span>&nbsp;<span class="num" id="7896847">0xbe</span><span class="op" id="7896851">,</span>&nbsp;<span class="num" id="7896853">0xe6</span><span class="op" id="7896857">,</span>&nbsp;<span class="num" id="7896859">0x5b</span><span class="op" id="7896863">,</span>&nbsp;<span class="num" id="7896865">0xd2</span><span class="op" id="7896869">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896874">0xc8</span><span class="op" id="7896878">,</span>&nbsp;<span class="num" id="7896880">0x5c</span><span class="op" id="7896884">,</span>&nbsp;<span class="num" id="7896886">0x46</span><span class="op" id="7896890">,</span>&nbsp;<span class="num" id="7896892">0x98</span><span class="op" id="7896896">,</span>&nbsp;<span class="num" id="7896898">0x6c</span><span class="op" id="7896902">,</span>&nbsp;<span class="num" id="7896904">0x1b</span><span class="op" id="7896908">,</span>&nbsp;<span class="num" id="7896910">0xef</span><span class="op" id="7896914">,</span>&nbsp;<span class="num" id="7896916">0x34</span><span class="op" id="7896920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896925">0x90</span><span class="op" id="7896929">,</span>&nbsp;<span class="num" id="7896931">0xd3</span><span class="op" id="7896935">,</span>&nbsp;<span class="num" id="7896937">0x7b</span><span class="op" id="7896941">,</span>&nbsp;<span class="num" id="7896943">0x38</span><span class="op" id="7896947">,</span>&nbsp;<span class="num" id="7896949">0xda</span><span class="op" id="7896953">,</span>&nbsp;<span class="num" id="7896955">0x85</span><span class="op" id="7896959">,</span>&nbsp;<span class="num" id="7896961">0xd3</span><span class="op" id="7896965">,</span>&nbsp;<span class="num" id="7896967">0x2e</span><span class="op" id="7896971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7896976">0x97</span><span class="op" id="7896980">,</span>&nbsp;<span class="num" id="7896982">0x39</span><span class="op" id="7896986">,</span>&nbsp;<span class="num" id="7896988">0xcb</span><span class="op" id="7896992">,</span>&nbsp;<span class="num" id="7896994">0x23</span><span class="op" id="7896998">,</span>&nbsp;<span class="num" id="7897000">0x4a</span><span class="op" id="7897004">,</span>&nbsp;<span class="num" id="7897006">0x2b</span><span class="op" id="7897010">,</span>&nbsp;<span class="num" id="7897012">0xe7</span><span class="op" id="7897016">,</span>&nbsp;<span class="num" id="7897018">0x40</span><span class="op" id="7897022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897026">}</span><span class="op" id="7897027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897030">}</span><span class="op" id="7897031">,</span><br>
<span class="lineno">75</span><span class="op" id="7897033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7897036">func</span>&nbsp;<span class="ident" id="7897041">testEncrypt</span><span class="op" id="7897052">(</span><span class="ident" id="7897053">t</span>&nbsp;<span class="op" id="7897055">*</span><span class="ident" id="7897056">testing</span><span class="op" id="7897063">.</span><span class="ident" id="7897064">T</span><span class="op" id="7897065">,</span>&nbsp;<span class="ident" id="7897067">desc</span>&nbsp;<span class="builtintype" id="7897072">string</span><span class="op" id="7897078">,</span>&nbsp;<span class="ident" id="7897080">c</span>&nbsp;<span class="op" id="7897082">*</span><span class="ident" id="7897083">Cipher</span><span class="op" id="7897089">,</span>&nbsp;<span class="ident" id="7897091">src</span><span class="op" id="7897094">,</span>&nbsp;<span class="ident" id="7897096">expect</span>&nbsp;<span class="op" id="7897103">[</span><span class="op" id="7897104">]</span><span class="builtintype" id="7897105">byte</span><span class="op" id="7897109">)</span>&nbsp;<span class="op" id="7897111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897114">dst</span>&nbsp;<span class="op" id="7897118">:=</span>&nbsp;<span class="builtinfunc" id="7897121">make</span><span class="op" id="7897125">(</span><span class="op" id="7897126">[</span><span class="op" id="7897127">]</span><span class="builtintype" id="7897128">byte</span><span class="op" id="7897132">,</span>&nbsp;<span class="builtinfunc" id="7897134">len</span><span class="op" id="7897137">(</span><span class="ident" id="7897138">src</span><span class="op" id="7897141">)</span><span class="op" id="7897142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897145">c</span><span class="op" id="7897146">.</span><span class="ident" id="7897147">XORKeyStream</span><span class="op" id="7897159">(</span><span class="ident" id="7897160">dst</span><span class="op" id="7897163">,</span>&nbsp;<span class="ident" id="7897165">src</span><span class="op" id="7897168">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7897171">for</span>&nbsp;<span class="ident" id="7897175">i</span><span class="op" id="7897176">,</span>&nbsp;<span class="ident" id="7897178">v</span>&nbsp;<span class="op" id="7897180">:=</span>&nbsp;<span class="keyword" id="7897183">range</span>&nbsp;<span class="ident" id="7897189">dst</span>&nbsp;<span class="op" id="7897193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7897197">if</span>&nbsp;<span class="ident" id="7897200">v</span>&nbsp;<span class="op" id="7897202">!=</span>&nbsp;<span class="ident" id="7897205">expect</span><span class="op" id="7897211">[</span><span class="ident" id="7897212">i</span><span class="op" id="7897213">]</span>&nbsp;<span class="op" id="7897215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897220">t</span><span class="op" id="7897221">.</span><span class="ident" id="7897222">Fatalf</span><span class="op" id="7897228">(</span><span class="string" id="7897229">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="7897273">,</span>&nbsp;<span class="ident" id="7897275">desc</span><span class="op" id="7897279">,</span>&nbsp;<span class="ident" id="7897281">i</span><span class="op" id="7897282">,</span>&nbsp;<span class="ident" id="7897284">dst</span><span class="op" id="7897287">,</span>&nbsp;<span class="ident" id="7897289">expect</span><span class="op" id="7897295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897302">}</span><br>
<span class="lineno">85</span><span class="op" id="7897304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7897307">func</span>&nbsp;<span class="ident" id="7897312">TestGolden</span><span class="op" id="7897322">(</span><span class="ident" id="7897323">t</span>&nbsp;<span class="op" id="7897325">*</span><span class="ident" id="7897326">testing</span><span class="op" id="7897333">.</span><span class="ident" id="7897334">T</span><span class="op" id="7897335">)</span>&nbsp;<span class="op" id="7897337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7897340">for</span>&nbsp;<span class="ident" id="7897344">gi</span><span class="op" id="7897346">,</span>&nbsp;<span class="ident" id="7897348">g</span>&nbsp;<span class="op" id="7897350">:=</span>&nbsp;<span class="keyword" id="7897353">range</span>&nbsp;<span class="ident" id="7897359">golden</span>&nbsp;<span class="op" id="7897366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897370">data</span>&nbsp;<span class="op" id="7897375">:=</span>&nbsp;<span class="builtinfunc" id="7897378">make</span><span class="op" id="7897382">(</span><span class="op" id="7897383">[</span><span class="op" id="7897384">]</span><span class="builtintype" id="7897385">byte</span><span class="op" id="7897389">,</span>&nbsp;<span class="builtinfunc" id="7897391">len</span><span class="op" id="7897394">(</span><span class="ident" id="7897395">g</span><span class="op" id="7897396">.</span><span class="ident" id="7897397">keystream</span><span class="op" id="7897406">)</span><span class="op" id="7897407">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7897411">for</span>&nbsp;<span class="ident" id="7897415">i</span>&nbsp;<span class="op" id="7897417">:=</span>&nbsp;<span class="keyword" id="7897420">range</span>&nbsp;<span class="ident" id="7897426">data</span>&nbsp;<span class="op" id="7897431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897436">data</span><span class="op" id="7897440">[</span><span class="ident" id="7897441">i</span><span class="op" id="7897442">]</span>&nbsp;<span class="op" id="7897444">=</span>&nbsp;<span class="builtintype" id="7897446">byte</span><span class="op" id="7897450">(</span><span class="ident" id="7897451">i</span><span class="op" id="7897452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897461">expect</span>&nbsp;<span class="op" id="7897468">:=</span>&nbsp;<span class="builtinfunc" id="7897471">make</span><span class="op" id="7897475">(</span><span class="op" id="7897476">[</span><span class="op" id="7897477">]</span><span class="builtintype" id="7897478">byte</span><span class="op" id="7897482">,</span>&nbsp;<span class="builtinfunc" id="7897484">len</span><span class="op" id="7897487">(</span><span class="ident" id="7897488">g</span><span class="op" id="7897489">.</span><span class="ident" id="7897490">keystream</span><span class="op" id="7897499">)</span><span class="op" id="7897500">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7897504">for</span>&nbsp;<span class="ident" id="7897508">i</span>&nbsp;<span class="op" id="7897510">:=</span>&nbsp;<span class="keyword" id="7897513">range</span>&nbsp;<span class="ident" id="7897519">expect</span>&nbsp;<span class="op" id="7897526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897531">expect</span><span class="op" id="7897537">[</span><span class="ident" id="7897538">i</span><span class="op" id="7897539">]</span>&nbsp;<span class="op" id="7897541">=</span>&nbsp;<span class="builtintype" id="7897543">byte</span><span class="op" id="7897547">(</span><span class="ident" id="7897548">i</span><span class="op" id="7897549">)</span>&nbsp;<span class="op" id="7897551">^</span>&nbsp;<span class="ident" id="7897553">g</span><span class="op" id="7897554">.</span><span class="ident" id="7897555">keystream</span><span class="op" id="7897564">[</span><span class="ident" id="7897565">i</span><span class="op" id="7897566">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7897575">for</span>&nbsp;<span class="ident" id="7897579">size</span>&nbsp;<span class="op" id="7897584">:=</span>&nbsp;<span class="num" id="7897587">1</span><span class="op" id="7897588">;</span>&nbsp;<span class="ident" id="7897590">size</span>&nbsp;<span class="op" id="7897595">&lt;=</span>&nbsp;<span class="builtinfunc" id="7897598">len</span><span class="op" id="7897601">(</span><span class="ident" id="7897602">g</span><span class="op" id="7897603">.</span><span class="ident" id="7897604">keystream</span><span class="op" id="7897613">)</span><span class="op" id="7897614">;</span>&nbsp;<span class="ident" id="7897616">size</span><span class="op" id="7897620">++</span>&nbsp;<span class="op" id="7897623">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897628">c</span><span class="op" id="7897629">,</span>&nbsp;<span class="ident" id="7897631">err</span>&nbsp;<span class="op" id="7897635">:=</span>&nbsp;<span class="ident" id="7897638">NewCipher</span><span class="op" id="7897647">(</span><span class="ident" id="7897648">g</span><span class="op" id="7897649">.</span><span class="ident" id="7897650">key</span><span class="op" id="7897653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7897658">if</span>&nbsp;<span class="ident" id="7897661">err</span>&nbsp;<span class="op" id="7897665">!=</span>&nbsp;<span class="ident" id="7897668">nil</span>&nbsp;<span class="op" id="7897672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897678">t</span><span class="op" id="7897679">.</span><span class="ident" id="7897680">Fatalf</span><span class="op" id="7897686">(</span><span class="string" id="7897687">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="7897707">,</span>&nbsp;<span class="ident" id="7897709">gi</span><span class="op" id="7897711">,</span>&nbsp;<span class="ident" id="7897713">err</span><span class="op" id="7897716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897727">off</span>&nbsp;<span class="op" id="7897731">:=</span>&nbsp;<span class="num" id="7897734">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7897739">for</span>&nbsp;<span class="ident" id="7897743">off</span>&nbsp;<span class="op" id="7897747">&lt;</span>&nbsp;<span class="builtinfunc" id="7897749">len</span><span class="op" id="7897752">(</span><span class="ident" id="7897753">g</span><span class="op" id="7897754">.</span><span class="ident" id="7897755">keystream</span><span class="op" id="7897764">)</span>&nbsp;<span class="op" id="7897766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897772">n</span>&nbsp;<span class="op" id="7897774">:=</span>&nbsp;<span class="builtinfunc" id="7897777">len</span><span class="op" id="7897780">(</span><span class="ident" id="7897781">g</span><span class="op" id="7897782">.</span><span class="ident" id="7897783">keystream</span><span class="op" id="7897792">)</span>&nbsp;<span class="op" id="7897794">-</span>&nbsp;<span class="ident" id="7897796">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7897804">if</span>&nbsp;<span class="ident" id="7897807">n</span>&nbsp;<span class="op" id="7897809">&gt;</span>&nbsp;<span class="ident" id="7897811">size</span>&nbsp;<span class="op" id="7897816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897823">n</span>&nbsp;<span class="op" id="7897825">=</span>&nbsp;<span class="ident" id="7897827">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897842">desc</span>&nbsp;<span class="op" id="7897847">:=</span>&nbsp;<span class="ident" id="7897850">fmt</span><span class="op" id="7897853">.</span><span class="ident" id="7897854">Sprintf</span><span class="op" id="7897861">(</span><span class="string" id="7897862">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="7897875">,</span>&nbsp;<span class="ident" id="7897877">gi</span><span class="op" id="7897879">,</span>&nbsp;<span class="ident" id="7897881">off</span><span class="op" id="7897884">,</span>&nbsp;<span class="ident" id="7897886">off</span><span class="op" id="7897889">+</span><span class="ident" id="7897890">n</span><span class="op" id="7897891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897897">testEncrypt</span><span class="op" id="7897908">(</span><span class="ident" id="7897909">t</span><span class="op" id="7897910">,</span>&nbsp;<span class="ident" id="7897912">desc</span><span class="op" id="7897916">,</span>&nbsp;<span class="ident" id="7897918">c</span><span class="op" id="7897919">,</span>&nbsp;<span class="ident" id="7897921">data</span><span class="op" id="7897925">[</span><span class="ident" id="7897926">off</span><span class="op" id="7897929">:</span><span class="ident" id="7897930">off</span><span class="op" id="7897933">+</span><span class="ident" id="7897934">n</span><span class="op" id="7897935">]</span><span class="op" id="7897936">,</span>&nbsp;<span class="ident" id="7897938">expect</span><span class="op" id="7897944">[</span><span class="ident" id="7897945">off</span><span class="op" id="7897948">:</span><span class="ident" id="7897949">off</span><span class="op" id="7897952">+</span><span class="ident" id="7897953">n</span><span class="op" id="7897954">]</span><span class="op" id="7897955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7897961">off</span>&nbsp;<span class="op" id="7897965">+=</span>&nbsp;<span class="ident" id="7897968">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897973">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7897980">}</span><br>
<span class="lineno"></span><span class="op" id="7897982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7897985">func</span>&nbsp;<span class="ident" id="7897990">TestBlock</span><span class="op" id="7897999">(</span><span class="ident" id="7898000">t</span>&nbsp;<span class="op" id="7898002">*</span><span class="ident" id="7898003">testing</span><span class="op" id="7898010">.</span><span class="ident" id="7898011">T</span><span class="op" id="7898012">)</span>&nbsp;<span class="op" id="7898014">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898017">testBlock</span><span class="op" id="7898026">(</span><span class="ident" id="7898027">t</span><span class="op" id="7898028">,</span>&nbsp;<span class="op" id="7898030">(</span><span class="op" id="7898031">*</span><span class="ident" id="7898032">Cipher</span><span class="op" id="7898038">)</span><span class="op" id="7898039">.</span><span class="ident" id="7898040">XORKeyStream</span><span class="op" id="7898052">)</span><br>
<span class="lineno"></span><span class="op" id="7898054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7898057">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="7898086">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="7898153">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="7898197">func</span>&nbsp;<span class="ident" id="7898202">TestBlockGeneric</span><span class="op" id="7898218">(</span><span class="ident" id="7898219">t</span>&nbsp;<span class="op" id="7898221">*</span><span class="ident" id="7898222">testing</span><span class="op" id="7898229">.</span><span class="ident" id="7898230">T</span><span class="op" id="7898231">)</span>&nbsp;<span class="op" id="7898233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898236">testBlock</span><span class="op" id="7898245">(</span><span class="ident" id="7898246">t</span><span class="op" id="7898247">,</span>&nbsp;<span class="op" id="7898249">(</span><span class="op" id="7898250">*</span><span class="ident" id="7898251">Cipher</span><span class="op" id="7898257">)</span><span class="op" id="7898258">.</span><span class="ident" id="7898259">xorKeyStreamGeneric</span><span class="op" id="7898278">)</span><br>
<span class="lineno"></span><span class="op" id="7898280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7898283">func</span>&nbsp;<span class="ident" id="7898288">testBlock</span><span class="op" id="7898297">(</span><span class="ident" id="7898298">t</span>&nbsp;<span class="op" id="7898300">*</span><span class="ident" id="7898301">testing</span><span class="op" id="7898308">.</span><span class="ident" id="7898309">T</span><span class="op" id="7898310">,</span>&nbsp;<span class="ident" id="7898312">xor</span>&nbsp;<span class="keyword" id="7898316">func</span><span class="op" id="7898320">(</span><span class="ident" id="7898321">c</span>&nbsp;<span class="op" id="7898323">*</span><span class="ident" id="7898324">Cipher</span><span class="op" id="7898330">,</span>&nbsp;<span class="ident" id="7898332">dst</span><span class="op" id="7898335">,</span>&nbsp;<span class="ident" id="7898337">src</span>&nbsp;<span class="op" id="7898341">[</span><span class="op" id="7898342">]</span><span class="builtintype" id="7898343">byte</span><span class="op" id="7898347">)</span><span class="op" id="7898348">)</span>&nbsp;<span class="op" id="7898350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898353">c1a</span><span class="op" id="7898356">,</span>&nbsp;<span class="ident" id="7898358">_</span>&nbsp;<span class="op" id="7898360">:=</span>&nbsp;<span class="ident" id="7898363">NewCipher</span><span class="op" id="7898372">(</span><span class="ident" id="7898373">golden</span><span class="op" id="7898379">[</span><span class="num" id="7898380">0</span><span class="op" id="7898381">]</span><span class="op" id="7898382">.</span><span class="ident" id="7898383">key</span><span class="op" id="7898386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898389">c1b</span><span class="op" id="7898392">,</span>&nbsp;<span class="ident" id="7898394">_</span>&nbsp;<span class="op" id="7898396">:=</span>&nbsp;<span class="ident" id="7898399">NewCipher</span><span class="op" id="7898408">(</span><span class="ident" id="7898409">golden</span><span class="op" id="7898415">[</span><span class="num" id="7898416">1</span><span class="op" id="7898417">]</span><span class="op" id="7898418">.</span><span class="ident" id="7898419">key</span><span class="op" id="7898422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898425">data1</span>&nbsp;<span class="op" id="7898431">:=</span>&nbsp;<span class="builtinfunc" id="7898434">make</span><span class="op" id="7898438">(</span><span class="op" id="7898439">[</span><span class="op" id="7898440">]</span><span class="builtintype" id="7898441">byte</span><span class="op" id="7898445">,</span>&nbsp;<span class="num" id="7898447">1</span><span class="op" id="7898448">&lt;&lt;</span><span class="num" id="7898450">20</span><span class="op" id="7898452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7898455">for</span>&nbsp;<span class="ident" id="7898459">i</span>&nbsp;<span class="op" id="7898461">:=</span>&nbsp;<span class="keyword" id="7898464">range</span>&nbsp;<span class="ident" id="7898470">data1</span>&nbsp;<span class="op" id="7898476">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898480">xor</span><span class="op" id="7898483">(</span><span class="ident" id="7898484">c1a</span><span class="op" id="7898487">,</span>&nbsp;<span class="ident" id="7898489">data1</span><span class="op" id="7898494">[</span><span class="ident" id="7898495">i</span><span class="op" id="7898496">:</span><span class="ident" id="7898497">i</span><span class="op" id="7898498">+</span><span class="num" id="7898499">1</span><span class="op" id="7898500">]</span><span class="op" id="7898501">,</span>&nbsp;<span class="ident" id="7898503">data1</span><span class="op" id="7898508">[</span><span class="ident" id="7898509">i</span><span class="op" id="7898510">:</span><span class="ident" id="7898511">i</span><span class="op" id="7898512">+</span><span class="num" id="7898513">1</span><span class="op" id="7898514">]</span><span class="op" id="7898515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898519">xor</span><span class="op" id="7898522">(</span><span class="ident" id="7898523">c1b</span><span class="op" id="7898526">,</span>&nbsp;<span class="ident" id="7898528">data1</span><span class="op" id="7898533">[</span><span class="ident" id="7898534">i</span><span class="op" id="7898535">:</span><span class="ident" id="7898536">i</span><span class="op" id="7898537">+</span><span class="num" id="7898538">1</span><span class="op" id="7898539">]</span><span class="op" id="7898540">,</span>&nbsp;<span class="ident" id="7898542">data1</span><span class="op" id="7898547">[</span><span class="ident" id="7898548">i</span><span class="op" id="7898549">:</span><span class="ident" id="7898550">i</span><span class="op" id="7898551">+</span><span class="num" id="7898552">1</span><span class="op" id="7898553">]</span><span class="op" id="7898554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7898557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898561">c2a</span><span class="op" id="7898564">,</span>&nbsp;<span class="ident" id="7898566">_</span>&nbsp;<span class="op" id="7898568">:=</span>&nbsp;<span class="ident" id="7898571">NewCipher</span><span class="op" id="7898580">(</span><span class="ident" id="7898581">golden</span><span class="op" id="7898587">[</span><span class="num" id="7898588">0</span><span class="op" id="7898589">]</span><span class="op" id="7898590">.</span><span class="ident" id="7898591">key</span><span class="op" id="7898594">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898597">c2b</span><span class="op" id="7898600">,</span>&nbsp;<span class="ident" id="7898602">_</span>&nbsp;<span class="op" id="7898604">:=</span>&nbsp;<span class="ident" id="7898607">NewCipher</span><span class="op" id="7898616">(</span><span class="ident" id="7898617">golden</span><span class="op" id="7898623">[</span><span class="num" id="7898624">1</span><span class="op" id="7898625">]</span><span class="op" id="7898626">.</span><span class="ident" id="7898627">key</span><span class="op" id="7898630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898633">data2</span>&nbsp;<span class="op" id="7898639">:=</span>&nbsp;<span class="builtinfunc" id="7898642">make</span><span class="op" id="7898646">(</span><span class="op" id="7898647">[</span><span class="op" id="7898648">]</span><span class="builtintype" id="7898649">byte</span><span class="op" id="7898653">,</span>&nbsp;<span class="num" id="7898655">1</span><span class="op" id="7898656">&lt;&lt;</span><span class="num" id="7898658">20</span><span class="op" id="7898660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898663">xor</span><span class="op" id="7898666">(</span><span class="ident" id="7898667">c2a</span><span class="op" id="7898670">,</span>&nbsp;<span class="ident" id="7898672">data2</span><span class="op" id="7898677">,</span>&nbsp;<span class="ident" id="7898679">data2</span><span class="op" id="7898684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898687">xor</span><span class="op" id="7898690">(</span><span class="ident" id="7898691">c2b</span><span class="op" id="7898694">,</span>&nbsp;<span class="ident" id="7898696">data2</span><span class="op" id="7898701">,</span>&nbsp;<span class="ident" id="7898703">data2</span><span class="op" id="7898708">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7898712">if</span>&nbsp;<span class="op" id="7898715">!</span><span class="ident" id="7898716">bytes</span><span class="op" id="7898721">.</span><span class="ident" id="7898722">Equal</span><span class="op" id="7898727">(</span><span class="ident" id="7898728">data1</span><span class="op" id="7898733">,</span>&nbsp;<span class="ident" id="7898735">data2</span><span class="op" id="7898740">)</span>&nbsp;<span class="op" id="7898742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898746">t</span><span class="op" id="7898747">.</span><span class="ident" id="7898748">Fatalf</span><span class="op" id="7898754">(</span><span class="string" id="7898755">&#34;bad&nbsp;block&#34;</span><span class="op" id="7898766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7898769">}</span><br>
<span class="lineno"></span><span class="op" id="7898771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7898774">func</span>&nbsp;<span class="ident" id="7898779">benchmark</span><span class="op" id="7898788">(</span><span class="ident" id="7898789">b</span>&nbsp;<span class="op" id="7898791">*</span><span class="ident" id="7898792">testing</span><span class="op" id="7898799">.</span><span class="ident" id="7898800">B</span><span class="op" id="7898801">,</span>&nbsp;<span class="ident" id="7898803">size</span>&nbsp;<span class="ident" id="7898808">int64</span><span class="op" id="7898813">)</span>&nbsp;<span class="op" id="7898815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898818">buf</span>&nbsp;<span class="op" id="7898822">:=</span>&nbsp;<span class="builtinfunc" id="7898825">make</span><span class="op" id="7898829">(</span><span class="op" id="7898830">[</span><span class="op" id="7898831">]</span><span class="builtintype" id="7898832">byte</span><span class="op" id="7898836">,</span>&nbsp;<span class="ident" id="7898838">size</span><span class="op" id="7898842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898845">c</span><span class="op" id="7898846">,</span>&nbsp;<span class="ident" id="7898848">err</span>&nbsp;<span class="op" id="7898852">:=</span>&nbsp;<span class="ident" id="7898855">NewCipher</span><span class="op" id="7898864">(</span><span class="ident" id="7898865">golden</span><span class="op" id="7898871">[</span><span class="num" id="7898872">0</span><span class="op" id="7898873">]</span><span class="op" id="7898874">.</span><span class="ident" id="7898875">key</span><span class="op" id="7898878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7898881">if</span>&nbsp;<span class="ident" id="7898884">err</span>&nbsp;<span class="op" id="7898888">!=</span>&nbsp;<span class="ident" id="7898891">nil</span>&nbsp;<span class="op" id="7898895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7898899">panic</span><span class="op" id="7898904">(</span><span class="ident" id="7898905">err</span><span class="op" id="7898908">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7898911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898914">b</span><span class="op" id="7898915">.</span><span class="ident" id="7898916">SetBytes</span><span class="op" id="7898924">(</span><span class="ident" id="7898925">size</span><span class="op" id="7898929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7898933">for</span>&nbsp;<span class="ident" id="7898937">i</span>&nbsp;<span class="op" id="7898939">:=</span>&nbsp;<span class="num" id="7898942">0</span><span class="op" id="7898943">;</span>&nbsp;<span class="ident" id="7898945">i</span>&nbsp;<span class="op" id="7898947">&lt;</span>&nbsp;<span class="ident" id="7898949">b</span><span class="op" id="7898950">.</span><span class="ident" id="7898951">N</span><span class="op" id="7898952">;</span>&nbsp;<span class="ident" id="7898954">i</span><span class="op" id="7898955">++</span>&nbsp;<span class="op" id="7898958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7898962">c</span><span class="op" id="7898963">.</span><span class="ident" id="7898964">XORKeyStream</span><span class="op" id="7898976">(</span><span class="ident" id="7898977">buf</span><span class="op" id="7898980">,</span>&nbsp;<span class="ident" id="7898982">buf</span><span class="op" id="7898985">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7898988">}</span><br>
<span class="lineno"></span><span class="op" id="7898990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7898993">func</span>&nbsp;<span class="ident" id="7898998">BenchmarkRC4_128</span><span class="op" id="7899014">(</span><span class="ident" id="7899015">b</span>&nbsp;<span class="op" id="7899017">*</span><span class="ident" id="7899018">testing</span><span class="op" id="7899025">.</span><span class="ident" id="7899026">B</span><span class="op" id="7899027">)</span>&nbsp;<span class="op" id="7899029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899032">benchmark</span><span class="op" id="7899041">(</span><span class="ident" id="7899042">b</span><span class="op" id="7899043">,</span>&nbsp;<span class="num" id="7899045">128</span><span class="op" id="7899048">)</span><br>
<span class="lineno">165</span><span class="op" id="7899050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7899053">func</span>&nbsp;<span class="ident" id="7899058">BenchmarkRC4_1K</span><span class="op" id="7899073">(</span><span class="ident" id="7899074">b</span>&nbsp;<span class="op" id="7899076">*</span><span class="ident" id="7899077">testing</span><span class="op" id="7899084">.</span><span class="ident" id="7899085">B</span><span class="op" id="7899086">)</span>&nbsp;<span class="op" id="7899088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899091">benchmark</span><span class="op" id="7899100">(</span><span class="ident" id="7899101">b</span><span class="op" id="7899102">,</span>&nbsp;<span class="num" id="7899104">1024</span><span class="op" id="7899108">)</span><br>
<span class="lineno"></span><span class="op" id="7899110">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7899113">func</span>&nbsp;<span class="ident" id="7899118">BenchmarkRC4_8K</span><span class="op" id="7899133">(</span><span class="ident" id="7899134">b</span>&nbsp;<span class="op" id="7899136">*</span><span class="ident" id="7899137">testing</span><span class="op" id="7899144">.</span><span class="ident" id="7899145">B</span><span class="op" id="7899146">)</span>&nbsp;<span class="op" id="7899148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899151">benchmark</span><span class="op" id="7899160">(</span><span class="ident" id="7899161">b</span><span class="op" id="7899162">,</span>&nbsp;<span class="num" id="7899164">8096</span><span class="op" id="7899168">)</span><br>
<span class="lineno"></span><span class="op" id="7899170">}</span>
</div>
</body>
</html>
