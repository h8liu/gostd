<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3802804">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3802859">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3802913">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3802964">package</span>&nbsp;<span class="ident" id="3802972">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3802977">import</span>&nbsp;<span class="op" id="3802984">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3802987">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3803004">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3803014">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3803017">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3803049">const</span>&nbsp;<span class="ident" id="3803055">BlockSize</span>&nbsp;<span class="op" id="3803065">=</span>&nbsp;<span class="num" id="3803067">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3803070">type</span>&nbsp;<span class="ident" id="3803075">KeySizeError</span>&nbsp;<span class="builtintype" id="3803088">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3803093">func</span>&nbsp;<span class="op" id="3803098">(</span><span class="ident" id="3803099">k</span>&nbsp;<span class="ident" id="3803101">KeySizeError</span><span class="op" id="3803113">)</span>&nbsp;<span class="ident" id="3803115">Error</span><span class="op" id="3803120">(</span><span class="op" id="3803121">)</span>&nbsp;<span class="builtintype" id="3803123">string</span>&nbsp;<span class="op" id="3803130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803133">return</span>&nbsp;<span class="string" id="3803140">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3803172">+</span>&nbsp;<span class="ident" id="3803174">strconv</span><span class="op" id="3803181">.</span><span class="ident" id="3803182">Itoa</span><span class="op" id="3803186">(</span><span class="builtintype" id="3803187">int</span><span class="op" id="3803190">(</span><span class="ident" id="3803191">k</span><span class="op" id="3803192">)</span><span class="op" id="3803193">)</span><br>
<span class="lineno"></span><span class="op" id="3803195">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3803198">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3803245">type</span>&nbsp;<span class="ident" id="3803250">desCipher</span>&nbsp;<span class="keyword" id="3803260">struct</span>&nbsp;<span class="op" id="3803267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803270">subkeys</span>&nbsp;<span class="op" id="3803278">[</span><span class="num" id="3803279">16</span><span class="op" id="3803281">]</span><span class="ident" id="3803282">uint64</span><br>
<span class="lineno"></span><span class="op" id="3803289">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3803292">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3803345">func</span>&nbsp;<span class="ident" id="3803350">NewCipher</span><span class="op" id="3803359">(</span><span class="ident" id="3803360">key</span>&nbsp;<span class="op" id="3803364">[</span><span class="op" id="3803365">]</span><span class="builtintype" id="3803366">byte</span><span class="op" id="3803370">)</span>&nbsp;<span class="op" id="3803372">(</span><span class="ident" id="3803373">cipher</span><span class="op" id="3803379">.</span><span class="ident" id="3803380">Block</span><span class="op" id="3803385">,</span>&nbsp;<span class="builtintype" id="3803387">error</span><span class="op" id="3803392">)</span>&nbsp;<span class="op" id="3803394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803397">if</span>&nbsp;<span class="builtinfunc" id="3803400">len</span><span class="op" id="3803403">(</span><span class="ident" id="3803404">key</span><span class="op" id="3803407">)</span>&nbsp;<span class="op" id="3803409">!=</span>&nbsp;<span class="num" id="3803412">8</span>&nbsp;<span class="op" id="3803414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803418">return</span>&nbsp;<span class="ident" id="3803425">nil</span><span class="op" id="3803428">,</span>&nbsp;<span class="ident" id="3803430">KeySizeError</span><span class="op" id="3803442">(</span><span class="builtinfunc" id="3803443">len</span><span class="op" id="3803446">(</span><span class="ident" id="3803447">key</span><span class="op" id="3803450">)</span><span class="op" id="3803451">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803458">c</span>&nbsp;<span class="op" id="3803460">:=</span>&nbsp;<span class="builtinfunc" id="3803463">new</span><span class="op" id="3803466">(</span><span class="ident" id="3803467">desCipher</span><span class="op" id="3803476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803479">c</span><span class="op" id="3803480">.</span><span class="ident" id="3803481">generateSubkeys</span><span class="op" id="3803496">(</span><span class="ident" id="3803497">key</span><span class="op" id="3803500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803503">return</span>&nbsp;<span class="ident" id="3803510">c</span><span class="op" id="3803511">,</span>&nbsp;<span class="ident" id="3803513">nil</span><br>
<span class="lineno">35</span><span class="op" id="3803517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3803520">func</span>&nbsp;<span class="op" id="3803525">(</span><span class="ident" id="3803526">c</span>&nbsp;<span class="op" id="3803528">*</span><span class="ident" id="3803529">desCipher</span><span class="op" id="3803538">)</span>&nbsp;<span class="ident" id="3803540">BlockSize</span><span class="op" id="3803549">(</span><span class="op" id="3803550">)</span>&nbsp;<span class="builtintype" id="3803552">int</span>&nbsp;<span class="op" id="3803556">{</span>&nbsp;<span class="keyword" id="3803558">return</span>&nbsp;<span class="ident" id="3803565">BlockSize</span>&nbsp;<span class="op" id="3803575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3803578">func</span>&nbsp;<span class="op" id="3803583">(</span><span class="ident" id="3803584">c</span>&nbsp;<span class="op" id="3803586">*</span><span class="ident" id="3803587">desCipher</span><span class="op" id="3803596">)</span>&nbsp;<span class="ident" id="3803598">Encrypt</span><span class="op" id="3803605">(</span><span class="ident" id="3803606">dst</span><span class="op" id="3803609">,</span>&nbsp;<span class="ident" id="3803611">src</span>&nbsp;<span class="op" id="3803615">[</span><span class="op" id="3803616">]</span><span class="builtintype" id="3803617">byte</span><span class="op" id="3803621">)</span>&nbsp;<span class="op" id="3803623">{</span>&nbsp;<span class="ident" id="3803625">encryptBlock</span><span class="op" id="3803637">(</span><span class="ident" id="3803638">c</span><span class="op" id="3803639">.</span><span class="ident" id="3803640">subkeys</span><span class="op" id="3803647">[</span><span class="op" id="3803648">:</span><span class="op" id="3803649">]</span><span class="op" id="3803650">,</span>&nbsp;<span class="ident" id="3803652">dst</span><span class="op" id="3803655">,</span>&nbsp;<span class="ident" id="3803657">src</span><span class="op" id="3803660">)</span>&nbsp;<span class="op" id="3803662">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3803665">func</span>&nbsp;<span class="op" id="3803670">(</span><span class="ident" id="3803671">c</span>&nbsp;<span class="op" id="3803673">*</span><span class="ident" id="3803674">desCipher</span><span class="op" id="3803683">)</span>&nbsp;<span class="ident" id="3803685">Decrypt</span><span class="op" id="3803692">(</span><span class="ident" id="3803693">dst</span><span class="op" id="3803696">,</span>&nbsp;<span class="ident" id="3803698">src</span>&nbsp;<span class="op" id="3803702">[</span><span class="op" id="3803703">]</span><span class="builtintype" id="3803704">byte</span><span class="op" id="3803708">)</span>&nbsp;<span class="op" id="3803710">{</span>&nbsp;<span class="ident" id="3803712">decryptBlock</span><span class="op" id="3803724">(</span><span class="ident" id="3803725">c</span><span class="op" id="3803726">.</span><span class="ident" id="3803727">subkeys</span><span class="op" id="3803734">[</span><span class="op" id="3803735">:</span><span class="op" id="3803736">]</span><span class="op" id="3803737">,</span>&nbsp;<span class="ident" id="3803739">dst</span><span class="op" id="3803742">,</span>&nbsp;<span class="ident" id="3803744">src</span><span class="op" id="3803747">)</span>&nbsp;<span class="op" id="3803749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3803752">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3803813">type</span>&nbsp;<span class="ident" id="3803818">tripleDESCipher</span>&nbsp;<span class="keyword" id="3803834">struct</span>&nbsp;<span class="op" id="3803841">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803844">cipher1</span><span class="op" id="3803851">,</span>&nbsp;<span class="ident" id="3803853">cipher2</span><span class="op" id="3803860">,</span>&nbsp;<span class="ident" id="3803862">cipher3</span>&nbsp;<span class="ident" id="3803870">desCipher</span><br>
<span class="lineno"></span><span class="op" id="3803880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3803883">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3803945">func</span>&nbsp;<span class="ident" id="3803950">NewTripleDESCipher</span><span class="op" id="3803968">(</span><span class="ident" id="3803969">key</span>&nbsp;<span class="op" id="3803973">[</span><span class="op" id="3803974">]</span><span class="builtintype" id="3803975">byte</span><span class="op" id="3803979">)</span>&nbsp;<span class="op" id="3803981">(</span><span class="ident" id="3803982">cipher</span><span class="op" id="3803988">.</span><span class="ident" id="3803989">Block</span><span class="op" id="3803994">,</span>&nbsp;<span class="builtintype" id="3803996">error</span><span class="op" id="3804001">)</span>&nbsp;<span class="op" id="3804003">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804006">if</span>&nbsp;<span class="builtinfunc" id="3804009">len</span><span class="op" id="3804012">(</span><span class="ident" id="3804013">key</span><span class="op" id="3804016">)</span>&nbsp;<span class="op" id="3804018">!=</span>&nbsp;<span class="num" id="3804021">24</span>&nbsp;<span class="op" id="3804024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804028">return</span>&nbsp;<span class="ident" id="3804035">nil</span><span class="op" id="3804038">,</span>&nbsp;<span class="ident" id="3804040">KeySizeError</span><span class="op" id="3804052">(</span><span class="builtinfunc" id="3804053">len</span><span class="op" id="3804056">(</span><span class="ident" id="3804057">key</span><span class="op" id="3804060">)</span><span class="op" id="3804061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3804064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804068">c</span>&nbsp;<span class="op" id="3804070">:=</span>&nbsp;<span class="builtinfunc" id="3804073">new</span><span class="op" id="3804076">(</span><span class="ident" id="3804077">tripleDESCipher</span><span class="op" id="3804092">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804095">c</span><span class="op" id="3804096">.</span><span class="ident" id="3804097">cipher1</span><span class="op" id="3804104">.</span><span class="ident" id="3804105">generateSubkeys</span><span class="op" id="3804120">(</span><span class="ident" id="3804121">key</span><span class="op" id="3804124">[</span><span class="op" id="3804125">:</span><span class="num" id="3804126">8</span><span class="op" id="3804127">]</span><span class="op" id="3804128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804131">c</span><span class="op" id="3804132">.</span><span class="ident" id="3804133">cipher2</span><span class="op" id="3804140">.</span><span class="ident" id="3804141">generateSubkeys</span><span class="op" id="3804156">(</span><span class="ident" id="3804157">key</span><span class="op" id="3804160">[</span><span class="num" id="3804161">8</span><span class="op" id="3804162">:</span><span class="num" id="3804163">16</span><span class="op" id="3804165">]</span><span class="op" id="3804166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804169">c</span><span class="op" id="3804170">.</span><span class="ident" id="3804171">cipher3</span><span class="op" id="3804178">.</span><span class="ident" id="3804179">generateSubkeys</span><span class="op" id="3804194">(</span><span class="ident" id="3804195">key</span><span class="op" id="3804198">[</span><span class="num" id="3804199">16</span><span class="op" id="3804201">:</span><span class="op" id="3804202">]</span><span class="op" id="3804203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804206">return</span>&nbsp;<span class="ident" id="3804213">c</span><span class="op" id="3804214">,</span>&nbsp;<span class="ident" id="3804216">nil</span><br>
<span class="lineno"></span><span class="op" id="3804220">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3804223">func</span>&nbsp;<span class="op" id="3804228">(</span><span class="ident" id="3804229">c</span>&nbsp;<span class="op" id="3804231">*</span><span class="ident" id="3804232">tripleDESCipher</span><span class="op" id="3804247">)</span>&nbsp;<span class="ident" id="3804249">BlockSize</span><span class="op" id="3804258">(</span><span class="op" id="3804259">)</span>&nbsp;<span class="builtintype" id="3804261">int</span>&nbsp;<span class="op" id="3804265">{</span>&nbsp;<span class="keyword" id="3804267">return</span>&nbsp;<span class="ident" id="3804274">BlockSize</span>&nbsp;<span class="op" id="3804284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3804287">func</span>&nbsp;<span class="op" id="3804292">(</span><span class="ident" id="3804293">c</span>&nbsp;<span class="op" id="3804295">*</span><span class="ident" id="3804296">tripleDESCipher</span><span class="op" id="3804311">)</span>&nbsp;<span class="ident" id="3804313">Encrypt</span><span class="op" id="3804320">(</span><span class="ident" id="3804321">dst</span><span class="op" id="3804324">,</span>&nbsp;<span class="ident" id="3804326">src</span>&nbsp;<span class="op" id="3804330">[</span><span class="op" id="3804331">]</span><span class="builtintype" id="3804332">byte</span><span class="op" id="3804336">)</span>&nbsp;<span class="op" id="3804338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804341">c</span><span class="op" id="3804342">.</span><span class="ident" id="3804343">cipher1</span><span class="op" id="3804350">.</span><span class="ident" id="3804351">Encrypt</span><span class="op" id="3804358">(</span><span class="ident" id="3804359">dst</span><span class="op" id="3804362">,</span>&nbsp;<span class="ident" id="3804364">src</span><span class="op" id="3804367">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804370">c</span><span class="op" id="3804371">.</span><span class="ident" id="3804372">cipher2</span><span class="op" id="3804379">.</span><span class="ident" id="3804380">Decrypt</span><span class="op" id="3804387">(</span><span class="ident" id="3804388">dst</span><span class="op" id="3804391">,</span>&nbsp;<span class="ident" id="3804393">dst</span><span class="op" id="3804396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804399">c</span><span class="op" id="3804400">.</span><span class="ident" id="3804401">cipher3</span><span class="op" id="3804408">.</span><span class="ident" id="3804409">Encrypt</span><span class="op" id="3804416">(</span><span class="ident" id="3804417">dst</span><span class="op" id="3804420">,</span>&nbsp;<span class="ident" id="3804422">dst</span><span class="op" id="3804425">)</span><br>
<span class="lineno"></span><span class="op" id="3804427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3804430">func</span>&nbsp;<span class="op" id="3804435">(</span><span class="ident" id="3804436">c</span>&nbsp;<span class="op" id="3804438">*</span><span class="ident" id="3804439">tripleDESCipher</span><span class="op" id="3804454">)</span>&nbsp;<span class="ident" id="3804456">Decrypt</span><span class="op" id="3804463">(</span><span class="ident" id="3804464">dst</span><span class="op" id="3804467">,</span>&nbsp;<span class="ident" id="3804469">src</span>&nbsp;<span class="op" id="3804473">[</span><span class="op" id="3804474">]</span><span class="builtintype" id="3804475">byte</span><span class="op" id="3804479">)</span>&nbsp;<span class="op" id="3804481">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804484">c</span><span class="op" id="3804485">.</span><span class="ident" id="3804486">cipher3</span><span class="op" id="3804493">.</span><span class="ident" id="3804494">Decrypt</span><span class="op" id="3804501">(</span><span class="ident" id="3804502">dst</span><span class="op" id="3804505">,</span>&nbsp;<span class="ident" id="3804507">src</span><span class="op" id="3804510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804513">c</span><span class="op" id="3804514">.</span><span class="ident" id="3804515">cipher2</span><span class="op" id="3804522">.</span><span class="ident" id="3804523">Encrypt</span><span class="op" id="3804530">(</span><span class="ident" id="3804531">dst</span><span class="op" id="3804534">,</span>&nbsp;<span class="ident" id="3804536">dst</span><span class="op" id="3804539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804542">c</span><span class="op" id="3804543">.</span><span class="ident" id="3804544">cipher1</span><span class="op" id="3804551">.</span><span class="ident" id="3804552">Decrypt</span><span class="op" id="3804559">(</span><span class="ident" id="3804560">dst</span><span class="op" id="3804563">,</span>&nbsp;<span class="ident" id="3804565">dst</span><span class="op" id="3804568">)</span><br>
<span class="lineno"></span><span class="op" id="3804570">}</span>
</div>
</body>
</html>
