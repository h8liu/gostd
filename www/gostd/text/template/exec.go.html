<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3117248">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3117303">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3117357">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3117408">package</span>&nbsp;<span class="ident" id="3117416">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3117426">import</span>&nbsp;<span class="op" id="3117433">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3117436">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3117445">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3117452">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3117458">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3117469">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3117480">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3117488">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3117499">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="3117521">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3117524">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3117592">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="3117653">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3117681">type</span>&nbsp;<span class="ident" id="3117686">state</span>&nbsp;<span class="keyword" id="3117692">struct</span>&nbsp;<span class="op" id="3117699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117702">tmpl</span>&nbsp;<span class="op" id="3117707">*</span><span class="ident" id="3117708">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117718">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3117723">io</span><span class="op" id="3117725">.</span><span class="ident" id="3117726">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117734">node</span>&nbsp;<span class="ident" id="3117739">parse</span><span class="op" id="3117744">.</span><span class="ident" id="3117745">Node</span>&nbsp;<span class="comment" id="3117750">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117779">vars</span>&nbsp;<span class="op" id="3117784">[</span><span class="op" id="3117785">]</span><span class="ident" id="3117786">variable</span>&nbsp;<span class="comment" id="3117795">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="3117834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3117837">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="3117906">type</span>&nbsp;<span class="ident" id="3117911">variable</span>&nbsp;<span class="keyword" id="3117920">struct</span>&nbsp;<span class="op" id="3117927">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117930">name</span>&nbsp;&nbsp;<span class="builtintype" id="3117936">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117944">value</span>&nbsp;<span class="ident" id="3117950">reflect</span><span class="op" id="3117957">.</span><span class="ident" id="3117958">Value</span><br>
<span class="lineno"></span><span class="op" id="3117964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3117967">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="3118011">func</span>&nbsp;<span class="op" id="3118016">(</span><span class="ident" id="3118017">s</span>&nbsp;<span class="op" id="3118019">*</span><span class="ident" id="3118020">state</span><span class="op" id="3118025">)</span>&nbsp;<span class="ident" id="3118027">push</span><span class="op" id="3118031">(</span><span class="ident" id="3118032">name</span>&nbsp;<span class="builtintype" id="3118037">string</span><span class="op" id="3118043">,</span>&nbsp;<span class="ident" id="3118045">value</span>&nbsp;<span class="ident" id="3118051">reflect</span><span class="op" id="3118058">.</span><span class="ident" id="3118059">Value</span><span class="op" id="3118064">)</span>&nbsp;<span class="op" id="3118066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118069">s</span><span class="op" id="3118070">.</span><span class="ident" id="3118071">vars</span>&nbsp;<span class="op" id="3118076">=</span>&nbsp;<span class="builtinfunc" id="3118078">append</span><span class="op" id="3118084">(</span><span class="ident" id="3118085">s</span><span class="op" id="3118086">.</span><span class="ident" id="3118087">vars</span><span class="op" id="3118091">,</span>&nbsp;<span class="ident" id="3118093">variable</span><span class="op" id="3118101">{</span><span class="ident" id="3118102">name</span><span class="op" id="3118106">,</span>&nbsp;<span class="ident" id="3118108">value</span><span class="op" id="3118113">}</span><span class="op" id="3118114">)</span><br>
<span class="lineno"></span><span class="op" id="3118116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3118119">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="3118169">func</span>&nbsp;<span class="op" id="3118174">(</span><span class="ident" id="3118175">s</span>&nbsp;<span class="op" id="3118177">*</span><span class="ident" id="3118178">state</span><span class="op" id="3118183">)</span>&nbsp;<span class="ident" id="3118185">mark</span><span class="op" id="3118189">(</span><span class="op" id="3118190">)</span>&nbsp;<span class="builtintype" id="3118192">int</span>&nbsp;<span class="op" id="3118196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118199">return</span>&nbsp;<span class="builtinfunc" id="3118206">len</span><span class="op" id="3118209">(</span><span class="ident" id="3118210">s</span><span class="op" id="3118211">.</span><span class="ident" id="3118212">vars</span><span class="op" id="3118216">)</span><br>
<span class="lineno"></span><span class="op" id="3118218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3118221">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="3118268">func</span>&nbsp;<span class="op" id="3118273">(</span><span class="ident" id="3118274">s</span>&nbsp;<span class="op" id="3118276">*</span><span class="ident" id="3118277">state</span><span class="op" id="3118282">)</span>&nbsp;<span class="ident" id="3118284">pop</span><span class="op" id="3118287">(</span><span class="ident" id="3118288">mark</span>&nbsp;<span class="builtintype" id="3118293">int</span><span class="op" id="3118296">)</span>&nbsp;<span class="op" id="3118298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118301">s</span><span class="op" id="3118302">.</span><span class="ident" id="3118303">vars</span>&nbsp;<span class="op" id="3118308">=</span>&nbsp;<span class="ident" id="3118310">s</span><span class="op" id="3118311">.</span><span class="ident" id="3118312">vars</span><span class="op" id="3118316">[</span><span class="num" id="3118317">0</span><span class="op" id="3118318">:</span><span class="ident" id="3118319">mark</span><span class="op" id="3118323">]</span><br>
<span class="lineno"></span><span class="op" id="3118325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3118328">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="3118410">func</span>&nbsp;<span class="op" id="3118415">(</span><span class="ident" id="3118416">s</span>&nbsp;<span class="op" id="3118418">*</span><span class="ident" id="3118419">state</span><span class="op" id="3118424">)</span>&nbsp;<span class="ident" id="3118426">setVar</span><span class="op" id="3118432">(</span><span class="ident" id="3118433">n</span>&nbsp;<span class="builtintype" id="3118435">int</span><span class="op" id="3118438">,</span>&nbsp;<span class="ident" id="3118440">value</span>&nbsp;<span class="ident" id="3118446">reflect</span><span class="op" id="3118453">.</span><span class="ident" id="3118454">Value</span><span class="op" id="3118459">)</span>&nbsp;<span class="op" id="3118461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118464">s</span><span class="op" id="3118465">.</span><span class="ident" id="3118466">vars</span><span class="op" id="3118470">[</span><span class="builtinfunc" id="3118471">len</span><span class="op" id="3118474">(</span><span class="ident" id="3118475">s</span><span class="op" id="3118476">.</span><span class="ident" id="3118477">vars</span><span class="op" id="3118481">)</span><span class="op" id="3118482">-</span><span class="ident" id="3118483">n</span><span class="op" id="3118484">]</span><span class="op" id="3118485">.</span><span class="ident" id="3118486">value</span>&nbsp;<span class="op" id="3118492">=</span>&nbsp;<span class="ident" id="3118494">value</span><br>
<span class="lineno"></span><span class="op" id="3118500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3118503">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="3118556">func</span>&nbsp;<span class="op" id="3118561">(</span><span class="ident" id="3118562">s</span>&nbsp;<span class="op" id="3118564">*</span><span class="ident" id="3118565">state</span><span class="op" id="3118570">)</span>&nbsp;<span class="ident" id="3118572">varValue</span><span class="op" id="3118580">(</span><span class="ident" id="3118581">name</span>&nbsp;<span class="builtintype" id="3118586">string</span><span class="op" id="3118592">)</span>&nbsp;<span class="ident" id="3118594">reflect</span><span class="op" id="3118601">.</span><span class="ident" id="3118602">Value</span>&nbsp;<span class="op" id="3118608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118611">for</span>&nbsp;<span class="ident" id="3118615">i</span>&nbsp;<span class="op" id="3118617">:=</span>&nbsp;<span class="ident" id="3118620">s</span><span class="op" id="3118621">.</span><span class="ident" id="3118622">mark</span><span class="op" id="3118626">(</span><span class="op" id="3118627">)</span>&nbsp;<span class="op" id="3118629">-</span>&nbsp;<span class="num" id="3118631">1</span><span class="op" id="3118632">;</span>&nbsp;<span class="ident" id="3118634">i</span>&nbsp;<span class="op" id="3118636">&gt;=</span>&nbsp;<span class="num" id="3118639">0</span><span class="op" id="3118640">;</span>&nbsp;<span class="ident" id="3118642">i</span><span class="op" id="3118643">--</span>&nbsp;<span class="op" id="3118646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118650">if</span>&nbsp;<span class="ident" id="3118653">s</span><span class="op" id="3118654">.</span><span class="ident" id="3118655">vars</span><span class="op" id="3118659">[</span><span class="ident" id="3118660">i</span><span class="op" id="3118661">]</span><span class="op" id="3118662">.</span><span class="ident" id="3118663">name</span>&nbsp;<span class="op" id="3118668">==</span>&nbsp;<span class="ident" id="3118671">name</span>&nbsp;<span class="op" id="3118676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118681">return</span>&nbsp;<span class="ident" id="3118688">s</span><span class="op" id="3118689">.</span><span class="ident" id="3118690">vars</span><span class="op" id="3118694">[</span><span class="ident" id="3118695">i</span><span class="op" id="3118696">]</span><span class="op" id="3118697">.</span><span class="ident" id="3118698">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3118706">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3118709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118712">s</span><span class="op" id="3118713">.</span><span class="ident" id="3118714">errorf</span><span class="op" id="3118720">(</span><span class="string" id="3118721">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="3118745">,</span>&nbsp;<span class="ident" id="3118747">name</span><span class="op" id="3118751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118754">return</span>&nbsp;<span class="ident" id="3118761">zero</span><br>
<span class="lineno"></span><span class="op" id="3118766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="3118769">var</span>&nbsp;<span class="ident" id="3118773">zero</span>&nbsp;<span class="ident" id="3118778">reflect</span><span class="op" id="3118785">.</span><span class="ident" id="3118786">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3118793">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="3118853">func</span>&nbsp;<span class="op" id="3118858">(</span><span class="ident" id="3118859">s</span>&nbsp;<span class="op" id="3118861">*</span><span class="ident" id="3118862">state</span><span class="op" id="3118867">)</span>&nbsp;<span class="ident" id="3118869">at</span><span class="op" id="3118871">(</span><span class="ident" id="3118872">node</span>&nbsp;<span class="ident" id="3118877">parse</span><span class="op" id="3118882">.</span><span class="ident" id="3118883">Node</span><span class="op" id="3118887">)</span>&nbsp;<span class="op" id="3118889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118892">s</span><span class="op" id="3118893">.</span><span class="ident" id="3118894">node</span>&nbsp;<span class="op" id="3118899">=</span>&nbsp;<span class="ident" id="3118901">node</span><br>
<span class="lineno">70</span><span class="op" id="3118906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3118909">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3118984">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3119043">func</span>&nbsp;<span class="ident" id="3119048">doublePercent</span><span class="op" id="3119061">(</span><span class="ident" id="3119062">str</span>&nbsp;<span class="builtintype" id="3119066">string</span><span class="op" id="3119072">)</span>&nbsp;<span class="builtintype" id="3119074">string</span>&nbsp;<span class="op" id="3119081">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119084">if</span>&nbsp;<span class="ident" id="3119087">strings</span><span class="op" id="3119094">.</span><span class="ident" id="3119095">Contains</span><span class="op" id="3119103">(</span><span class="ident" id="3119104">str</span><span class="op" id="3119107">,</span>&nbsp;<span class="string" id="3119109">&#34;%&#34;</span><span class="op" id="3119112">)</span>&nbsp;<span class="op" id="3119114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119118">str</span>&nbsp;<span class="op" id="3119122">=</span>&nbsp;<span class="ident" id="3119124">strings</span><span class="op" id="3119131">.</span><span class="ident" id="3119132">Replace</span><span class="op" id="3119139">(</span><span class="ident" id="3119140">str</span><span class="op" id="3119143">,</span>&nbsp;<span class="string" id="3119145">&#34;%&#34;</span><span class="op" id="3119148">,</span>&nbsp;<span class="string" id="3119150">&#34;%%&#34;</span><span class="op" id="3119154">,</span>&nbsp;<span class="op" id="3119156">-</span><span class="num" id="3119157">1</span><span class="op" id="3119158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3119161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119164">return</span>&nbsp;<span class="ident" id="3119171">str</span><br>
<span class="lineno"></span><span class="op" id="3119175">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3119178">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="3119233">func</span>&nbsp;<span class="op" id="3119238">(</span><span class="ident" id="3119239">s</span>&nbsp;<span class="op" id="3119241">*</span><span class="ident" id="3119242">state</span><span class="op" id="3119247">)</span>&nbsp;<span class="ident" id="3119249">errorf</span><span class="op" id="3119255">(</span><span class="ident" id="3119256">format</span>&nbsp;<span class="builtintype" id="3119263">string</span><span class="op" id="3119269">,</span>&nbsp;<span class="ident" id="3119271">args</span>&nbsp;<span class="op" id="3119276">...</span><span class="keyword" id="3119279">interface</span><span class="op" id="3119288">{</span><span class="op" id="3119289">}</span><span class="op" id="3119290">)</span>&nbsp;<span class="op" id="3119292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119295">name</span>&nbsp;<span class="op" id="3119300">:=</span>&nbsp;<span class="ident" id="3119303">doublePercent</span><span class="op" id="3119316">(</span><span class="ident" id="3119317">s</span><span class="op" id="3119318">.</span><span class="ident" id="3119319">tmpl</span><span class="op" id="3119323">.</span><span class="ident" id="3119324">Name</span><span class="op" id="3119328">(</span><span class="op" id="3119329">)</span><span class="op" id="3119330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119333">if</span>&nbsp;<span class="ident" id="3119336">s</span><span class="op" id="3119337">.</span><span class="ident" id="3119338">node</span>&nbsp;<span class="op" id="3119343">==</span>&nbsp;<span class="ident" id="3119346">nil</span>&nbsp;<span class="op" id="3119350">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119354">format</span>&nbsp;<span class="op" id="3119361">=</span>&nbsp;<span class="ident" id="3119363">fmt</span><span class="op" id="3119366">.</span><span class="ident" id="3119367">Sprintf</span><span class="op" id="3119374">(</span><span class="string" id="3119375">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3119393">,</span>&nbsp;<span class="ident" id="3119395">name</span><span class="op" id="3119399">,</span>&nbsp;<span class="ident" id="3119401">format</span><span class="op" id="3119407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3119410">}</span>&nbsp;<span class="keyword" id="3119412">else</span>&nbsp;<span class="op" id="3119417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119421">location</span><span class="op" id="3119429">,</span>&nbsp;<span class="ident" id="3119431">context</span>&nbsp;<span class="op" id="3119439">:=</span>&nbsp;<span class="ident" id="3119442">s</span><span class="op" id="3119443">.</span><span class="ident" id="3119444">tmpl</span><span class="op" id="3119448">.</span><span class="ident" id="3119449">ErrorContext</span><span class="op" id="3119461">(</span><span class="ident" id="3119462">s</span><span class="op" id="3119463">.</span><span class="ident" id="3119464">node</span><span class="op" id="3119468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119472">format</span>&nbsp;<span class="op" id="3119479">=</span>&nbsp;<span class="ident" id="3119481">fmt</span><span class="op" id="3119484">.</span><span class="ident" id="3119485">Sprintf</span><span class="op" id="3119492">(</span><span class="string" id="3119493">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="3119533">,</span>&nbsp;<span class="ident" id="3119535">location</span><span class="op" id="3119543">,</span>&nbsp;<span class="ident" id="3119545">name</span><span class="op" id="3119549">,</span>&nbsp;<span class="ident" id="3119551">doublePercent</span><span class="op" id="3119564">(</span><span class="ident" id="3119565">context</span><span class="op" id="3119572">)</span><span class="op" id="3119573">,</span>&nbsp;<span class="ident" id="3119575">format</span><span class="op" id="3119581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3119584">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3119587">panic</span><span class="op" id="3119592">(</span><span class="ident" id="3119593">fmt</span><span class="op" id="3119596">.</span><span class="ident" id="3119597">Errorf</span><span class="op" id="3119603">(</span><span class="ident" id="3119604">format</span><span class="op" id="3119610">,</span>&nbsp;<span class="ident" id="3119612">args</span><span class="op" id="3119616">...</span><span class="op" id="3119619">)</span><span class="op" id="3119620">)</span><br>
<span class="lineno"></span><span class="op" id="3119622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3119625">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="3119698">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="3119717">func</span>&nbsp;<span class="ident" id="3119722">errRecover</span><span class="op" id="3119732">(</span><span class="ident" id="3119733">errp</span>&nbsp;<span class="op" id="3119738">*</span><span class="builtintype" id="3119739">error</span><span class="op" id="3119744">)</span>&nbsp;<span class="op" id="3119746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3119749">e</span>&nbsp;<span class="op" id="3119751">:=</span>&nbsp;<span class="builtinfunc" id="3119754">recover</span><span class="op" id="3119761">(</span><span class="op" id="3119762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119765">if</span>&nbsp;<span class="ident" id="3119768">e</span>&nbsp;<span class="op" id="3119770">!=</span>&nbsp;<span class="ident" id="3119773">nil</span>&nbsp;<span class="op" id="3119777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119781">switch</span>&nbsp;<span class="ident" id="3119788">err</span>&nbsp;<span class="op" id="3119792">:=</span>&nbsp;<span class="ident" id="3119795">e</span><span class="op" id="3119796">.</span><span class="op" id="3119797">(</span><span class="keyword" id="3119798">type</span><span class="op" id="3119802">)</span>&nbsp;<span class="op" id="3119804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119808">case</span>&nbsp;<span class="ident" id="3119813">runtime</span><span class="op" id="3119820">.</span><span class="ident" id="3119821">Error</span><span class="op" id="3119826">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3119831">panic</span><span class="op" id="3119836">(</span><span class="ident" id="3119837">e</span><span class="op" id="3119838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119842">case</span>&nbsp;<span class="builtintype" id="3119847">error</span><span class="op" id="3119852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3119857">*</span><span class="ident" id="3119858">errp</span>&nbsp;<span class="op" id="3119863">=</span>&nbsp;<span class="ident" id="3119865">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119871">default</span><span class="op" id="3119878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3119883">panic</span><span class="op" id="3119888">(</span><span class="ident" id="3119889">e</span><span class="op" id="3119890">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3119894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3119897">}</span><br>
<span class="lineno"></span><span class="op" id="3119899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3119902">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="3119984">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="3120045">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3120113">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3120186">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3120208">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="3120258">func</span>&nbsp;<span class="op" id="3120263">(</span><span class="ident" id="3120264">t</span>&nbsp;<span class="op" id="3120266">*</span><span class="ident" id="3120267">Template</span><span class="op" id="3120275">)</span>&nbsp;<span class="ident" id="3120277">ExecuteTemplate</span><span class="op" id="3120292">(</span><span class="ident" id="3120293">wr</span>&nbsp;<span class="ident" id="3120296">io</span><span class="op" id="3120298">.</span><span class="ident" id="3120299">Writer</span><span class="op" id="3120305">,</span>&nbsp;<span class="ident" id="3120307">name</span>&nbsp;<span class="builtintype" id="3120312">string</span><span class="op" id="3120318">,</span>&nbsp;<span class="ident" id="3120320">data</span>&nbsp;<span class="keyword" id="3120325">interface</span><span class="op" id="3120334">{</span><span class="op" id="3120335">}</span><span class="op" id="3120336">)</span>&nbsp;<span class="builtintype" id="3120338">error</span>&nbsp;<span class="op" id="3120344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120347">tmpl</span>&nbsp;<span class="op" id="3120352">:=</span>&nbsp;<span class="ident" id="3120355">t</span><span class="op" id="3120356">.</span><span class="ident" id="3120357">tmpl</span><span class="op" id="3120361">[</span><span class="ident" id="3120362">name</span><span class="op" id="3120366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120369">if</span>&nbsp;<span class="ident" id="3120372">tmpl</span>&nbsp;<span class="op" id="3120377">==</span>&nbsp;<span class="ident" id="3120380">nil</span>&nbsp;<span class="op" id="3120384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120388">return</span>&nbsp;<span class="ident" id="3120395">fmt</span><span class="op" id="3120398">.</span><span class="ident" id="3120399">Errorf</span><span class="op" id="3120405">(</span><span class="string" id="3120406">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="3120460">,</span>&nbsp;<span class="ident" id="3120462">name</span><span class="op" id="3120466">,</span>&nbsp;<span class="ident" id="3120468">t</span><span class="op" id="3120469">.</span><span class="ident" id="3120470">name</span><span class="op" id="3120474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3120477">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120480">return</span>&nbsp;<span class="ident" id="3120487">tmpl</span><span class="op" id="3120491">.</span><span class="ident" id="3120492">Execute</span><span class="op" id="3120499">(</span><span class="ident" id="3120500">wr</span><span class="op" id="3120502">,</span>&nbsp;<span class="ident" id="3120504">data</span><span class="op" id="3120508">)</span><br>
<span class="lineno"></span><span class="op" id="3120510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3120513">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="3120580">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="3120612">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3120680">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3120753">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3120775">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3120825">func</span>&nbsp;<span class="op" id="3120830">(</span><span class="ident" id="3120831">t</span>&nbsp;<span class="op" id="3120833">*</span><span class="ident" id="3120834">Template</span><span class="op" id="3120842">)</span>&nbsp;<span class="ident" id="3120844">Execute</span><span class="op" id="3120851">(</span><span class="ident" id="3120852">wr</span>&nbsp;<span class="ident" id="3120855">io</span><span class="op" id="3120857">.</span><span class="ident" id="3120858">Writer</span><span class="op" id="3120864">,</span>&nbsp;<span class="ident" id="3120866">data</span>&nbsp;<span class="keyword" id="3120871">interface</span><span class="op" id="3120880">{</span><span class="op" id="3120881">}</span><span class="op" id="3120882">)</span>&nbsp;<span class="op" id="3120884">(</span><span class="ident" id="3120885">err</span>&nbsp;<span class="builtintype" id="3120889">error</span><span class="op" id="3120894">)</span>&nbsp;<span class="op" id="3120896">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120899">defer</span>&nbsp;<span class="ident" id="3120905">errRecover</span><span class="op" id="3120915">(</span><span class="op" id="3120916">&amp;</span><span class="ident" id="3120917">err</span><span class="op" id="3120920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120923">value</span>&nbsp;<span class="op" id="3120929">:=</span>&nbsp;<span class="ident" id="3120932">reflect</span><span class="op" id="3120939">.</span><span class="ident" id="3120940">ValueOf</span><span class="op" id="3120947">(</span><span class="ident" id="3120948">data</span><span class="op" id="3120952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120955">state</span>&nbsp;<span class="op" id="3120961">:=</span>&nbsp;<span class="op" id="3120964">&amp;</span><span class="ident" id="3120965">state</span><span class="op" id="3120970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120974">tmpl</span><span class="op" id="3120978">:</span>&nbsp;<span class="ident" id="3120980">t</span><span class="op" id="3120981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120985">wr</span><span class="op" id="3120987">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3120991">wr</span><span class="op" id="3120993">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3120997">vars</span><span class="op" id="3121001">:</span>&nbsp;<span class="op" id="3121003">[</span><span class="op" id="3121004">]</span><span class="ident" id="3121005">variable</span><span class="op" id="3121013">{</span><span class="op" id="3121014">{</span><span class="string" id="3121015">&#34;$&#34;</span><span class="op" id="3121018">,</span>&nbsp;<span class="ident" id="3121020">value</span><span class="op" id="3121025">}</span><span class="op" id="3121026">}</span><span class="op" id="3121027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121033">t</span><span class="op" id="3121034">.</span><span class="ident" id="3121035">init</span><span class="op" id="3121039">(</span><span class="op" id="3121040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121043">if</span>&nbsp;<span class="ident" id="3121046">t</span><span class="op" id="3121047">.</span><span class="ident" id="3121048">Tree</span>&nbsp;<span class="op" id="3121053">==</span>&nbsp;<span class="ident" id="3121056">nil</span>&nbsp;<span class="op" id="3121060">||</span>&nbsp;<span class="ident" id="3121063">t</span><span class="op" id="3121064">.</span><span class="ident" id="3121065">Root</span>&nbsp;<span class="op" id="3121070">==</span>&nbsp;<span class="ident" id="3121073">nil</span>&nbsp;<span class="op" id="3121077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121081">var</span>&nbsp;<span class="ident" id="3121085">b</span>&nbsp;<span class="ident" id="3121087">bytes</span><span class="op" id="3121092">.</span><span class="ident" id="3121093">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121102">for</span>&nbsp;<span class="ident" id="3121106">name</span><span class="op" id="3121110">,</span>&nbsp;<span class="ident" id="3121112">tmpl</span>&nbsp;<span class="op" id="3121117">:=</span>&nbsp;<span class="keyword" id="3121120">range</span>&nbsp;<span class="ident" id="3121126">t</span><span class="op" id="3121127">.</span><span class="ident" id="3121128">tmpl</span>&nbsp;<span class="op" id="3121133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121138">if</span>&nbsp;<span class="ident" id="3121141">tmpl</span><span class="op" id="3121145">.</span><span class="ident" id="3121146">Tree</span>&nbsp;<span class="op" id="3121151">==</span>&nbsp;<span class="ident" id="3121154">nil</span>&nbsp;<span class="op" id="3121158">||</span>&nbsp;<span class="ident" id="3121161">tmpl</span><span class="op" id="3121165">.</span><span class="ident" id="3121166">Root</span>&nbsp;<span class="op" id="3121171">==</span>&nbsp;<span class="ident" id="3121174">nil</span>&nbsp;<span class="op" id="3121178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121184">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121201">if</span>&nbsp;<span class="ident" id="3121204">b</span><span class="op" id="3121205">.</span><span class="ident" id="3121206">Len</span><span class="op" id="3121209">(</span><span class="op" id="3121210">)</span>&nbsp;<span class="op" id="3121212">&gt;</span>&nbsp;<span class="num" id="3121214">0</span>&nbsp;<span class="op" id="3121216">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121222">b</span><span class="op" id="3121223">.</span><span class="ident" id="3121224">WriteString</span><span class="op" id="3121235">(</span><span class="string" id="3121236">&#34;,&nbsp;&#34;</span><span class="op" id="3121240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121250">fmt</span><span class="op" id="3121253">.</span><span class="ident" id="3121254">Fprintf</span><span class="op" id="3121261">(</span><span class="op" id="3121262">&amp;</span><span class="ident" id="3121263">b</span><span class="op" id="3121264">,</span>&nbsp;<span class="string" id="3121266">&#34;%q&#34;</span><span class="op" id="3121270">,</span>&nbsp;<span class="ident" id="3121272">name</span><span class="op" id="3121276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121284">var</span>&nbsp;<span class="ident" id="3121288">s</span>&nbsp;<span class="builtintype" id="3121290">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121299">if</span>&nbsp;<span class="ident" id="3121302">b</span><span class="op" id="3121303">.</span><span class="ident" id="3121304">Len</span><span class="op" id="3121307">(</span><span class="op" id="3121308">)</span>&nbsp;<span class="op" id="3121310">&gt;</span>&nbsp;<span class="num" id="3121312">0</span>&nbsp;<span class="op" id="3121314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121319">s</span>&nbsp;<span class="op" id="3121321">=</span>&nbsp;<span class="string" id="3121323">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="3121351">+</span>&nbsp;<span class="ident" id="3121353">b</span><span class="op" id="3121354">.</span><span class="ident" id="3121355">String</span><span class="op" id="3121361">(</span><span class="op" id="3121362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121370">state</span><span class="op" id="3121375">.</span><span class="ident" id="3121376">errorf</span><span class="op" id="3121382">(</span><span class="string" id="3121383">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="3121424">,</span>&nbsp;<span class="ident" id="3121426">t</span><span class="op" id="3121427">.</span><span class="ident" id="3121428">Name</span><span class="op" id="3121432">(</span><span class="op" id="3121433">)</span><span class="op" id="3121434">,</span>&nbsp;<span class="ident" id="3121436">s</span><span class="op" id="3121437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121440">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121443">state</span><span class="op" id="3121448">.</span><span class="ident" id="3121449">walk</span><span class="op" id="3121453">(</span><span class="ident" id="3121454">value</span><span class="op" id="3121459">,</span>&nbsp;<span class="ident" id="3121461">t</span><span class="op" id="3121462">.</span><span class="ident" id="3121463">Root</span><span class="op" id="3121467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121470">return</span><br>
<span class="lineno"></span><span class="op" id="3121477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3121480">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="3121555">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="3121588">func</span>&nbsp;<span class="op" id="3121593">(</span><span class="ident" id="3121594">s</span>&nbsp;<span class="op" id="3121596">*</span><span class="ident" id="3121597">state</span><span class="op" id="3121602">)</span>&nbsp;<span class="ident" id="3121604">walk</span><span class="op" id="3121608">(</span><span class="ident" id="3121609">dot</span>&nbsp;<span class="ident" id="3121613">reflect</span><span class="op" id="3121620">.</span><span class="ident" id="3121621">Value</span><span class="op" id="3121626">,</span>&nbsp;<span class="ident" id="3121628">node</span>&nbsp;<span class="ident" id="3121633">parse</span><span class="op" id="3121638">.</span><span class="ident" id="3121639">Node</span><span class="op" id="3121643">)</span>&nbsp;<span class="op" id="3121645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121648">s</span><span class="op" id="3121649">.</span><span class="ident" id="3121650">at</span><span class="op" id="3121652">(</span><span class="ident" id="3121653">node</span><span class="op" id="3121657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121660">switch</span>&nbsp;<span class="ident" id="3121667">node</span>&nbsp;<span class="op" id="3121672">:=</span>&nbsp;<span class="ident" id="3121675">node</span><span class="op" id="3121679">.</span><span class="op" id="3121680">(</span><span class="keyword" id="3121681">type</span><span class="op" id="3121685">)</span>&nbsp;<span class="op" id="3121687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121690">case</span>&nbsp;<span class="op" id="3121695">*</span><span class="ident" id="3121696">parse</span><span class="op" id="3121701">.</span><span class="ident" id="3121702">ActionNode</span><span class="op" id="3121712">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121716">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121774">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121843">val</span>&nbsp;<span class="op" id="3121847">:=</span>&nbsp;<span class="ident" id="3121850">s</span><span class="op" id="3121851">.</span><span class="ident" id="3121852">evalPipeline</span><span class="op" id="3121864">(</span><span class="ident" id="3121865">dot</span><span class="op" id="3121868">,</span>&nbsp;<span class="ident" id="3121870">node</span><span class="op" id="3121874">.</span><span class="ident" id="3121875">Pipe</span><span class="op" id="3121879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121883">if</span>&nbsp;<span class="builtinfunc" id="3121886">len</span><span class="op" id="3121889">(</span><span class="ident" id="3121890">node</span><span class="op" id="3121894">.</span><span class="ident" id="3121895">Pipe</span><span class="op" id="3121899">.</span><span class="ident" id="3121900">Decl</span><span class="op" id="3121904">)</span>&nbsp;<span class="op" id="3121906">==</span>&nbsp;<span class="num" id="3121909">0</span>&nbsp;<span class="op" id="3121911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121916">s</span><span class="op" id="3121917">.</span><span class="ident" id="3121918">printValue</span><span class="op" id="3121928">(</span><span class="ident" id="3121929">node</span><span class="op" id="3121933">,</span>&nbsp;<span class="ident" id="3121935">val</span><span class="op" id="3121938">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121945">case</span>&nbsp;<span class="op" id="3121950">*</span><span class="ident" id="3121951">parse</span><span class="op" id="3121956">.</span><span class="ident" id="3121957">IfNode</span><span class="op" id="3121963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121967">s</span><span class="op" id="3121968">.</span><span class="ident" id="3121969">walkIfOrWith</span><span class="op" id="3121981">(</span><span class="ident" id="3121982">parse</span><span class="op" id="3121987">.</span><span class="ident" id="3121988">NodeIf</span><span class="op" id="3121994">,</span>&nbsp;<span class="ident" id="3121996">dot</span><span class="op" id="3121999">,</span>&nbsp;<span class="ident" id="3122001">node</span><span class="op" id="3122005">.</span><span class="ident" id="3122006">Pipe</span><span class="op" id="3122010">,</span>&nbsp;<span class="ident" id="3122012">node</span><span class="op" id="3122016">.</span><span class="ident" id="3122017">List</span><span class="op" id="3122021">,</span>&nbsp;<span class="ident" id="3122023">node</span><span class="op" id="3122027">.</span><span class="ident" id="3122028">ElseList</span><span class="op" id="3122036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122039">case</span>&nbsp;<span class="op" id="3122044">*</span><span class="ident" id="3122045">parse</span><span class="op" id="3122050">.</span><span class="ident" id="3122051">ListNode</span><span class="op" id="3122059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122063">for</span>&nbsp;<span class="ident" id="3122067">_</span><span class="op" id="3122068">,</span>&nbsp;<span class="ident" id="3122070">node</span>&nbsp;<span class="op" id="3122075">:=</span>&nbsp;<span class="keyword" id="3122078">range</span>&nbsp;<span class="ident" id="3122084">node</span><span class="op" id="3122088">.</span><span class="ident" id="3122089">Nodes</span>&nbsp;<span class="op" id="3122095">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122100">s</span><span class="op" id="3122101">.</span><span class="ident" id="3122102">walk</span><span class="op" id="3122106">(</span><span class="ident" id="3122107">dot</span><span class="op" id="3122110">,</span>&nbsp;<span class="ident" id="3122112">node</span><span class="op" id="3122116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122123">case</span>&nbsp;<span class="op" id="3122128">*</span><span class="ident" id="3122129">parse</span><span class="op" id="3122134">.</span><span class="ident" id="3122135">RangeNode</span><span class="op" id="3122144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122148">s</span><span class="op" id="3122149">.</span><span class="ident" id="3122150">walkRange</span><span class="op" id="3122159">(</span><span class="ident" id="3122160">dot</span><span class="op" id="3122163">,</span>&nbsp;<span class="ident" id="3122165">node</span><span class="op" id="3122169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122172">case</span>&nbsp;<span class="op" id="3122177">*</span><span class="ident" id="3122178">parse</span><span class="op" id="3122183">.</span><span class="ident" id="3122184">TemplateNode</span><span class="op" id="3122196">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122200">s</span><span class="op" id="3122201">.</span><span class="ident" id="3122202">walkTemplate</span><span class="op" id="3122214">(</span><span class="ident" id="3122215">dot</span><span class="op" id="3122218">,</span>&nbsp;<span class="ident" id="3122220">node</span><span class="op" id="3122224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122227">case</span>&nbsp;<span class="op" id="3122232">*</span><span class="ident" id="3122233">parse</span><span class="op" id="3122238">.</span><span class="ident" id="3122239">TextNode</span><span class="op" id="3122247">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122251">if</span>&nbsp;<span class="ident" id="3122254">_</span><span class="op" id="3122255">,</span>&nbsp;<span class="ident" id="3122257">err</span>&nbsp;<span class="op" id="3122261">:=</span>&nbsp;<span class="ident" id="3122264">s</span><span class="op" id="3122265">.</span><span class="ident" id="3122266">wr</span><span class="op" id="3122268">.</span><span class="ident" id="3122269">Write</span><span class="op" id="3122274">(</span><span class="ident" id="3122275">node</span><span class="op" id="3122279">.</span><span class="ident" id="3122280">Text</span><span class="op" id="3122284">)</span><span class="op" id="3122285">;</span>&nbsp;<span class="ident" id="3122287">err</span>&nbsp;<span class="op" id="3122291">!=</span>&nbsp;<span class="ident" id="3122294">nil</span>&nbsp;<span class="op" id="3122298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122303">s</span><span class="op" id="3122304">.</span><span class="ident" id="3122305">errorf</span><span class="op" id="3122311">(</span><span class="string" id="3122312">&#34;%s&#34;</span><span class="op" id="3122316">,</span>&nbsp;<span class="ident" id="3122318">err</span><span class="op" id="3122321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122325">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122328">case</span>&nbsp;<span class="op" id="3122333">*</span><span class="ident" id="3122334">parse</span><span class="op" id="3122339">.</span><span class="ident" id="3122340">WithNode</span><span class="op" id="3122348">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122352">s</span><span class="op" id="3122353">.</span><span class="ident" id="3122354">walkIfOrWith</span><span class="op" id="3122366">(</span><span class="ident" id="3122367">parse</span><span class="op" id="3122372">.</span><span class="ident" id="3122373">NodeWith</span><span class="op" id="3122381">,</span>&nbsp;<span class="ident" id="3122383">dot</span><span class="op" id="3122386">,</span>&nbsp;<span class="ident" id="3122388">node</span><span class="op" id="3122392">.</span><span class="ident" id="3122393">Pipe</span><span class="op" id="3122397">,</span>&nbsp;<span class="ident" id="3122399">node</span><span class="op" id="3122403">.</span><span class="ident" id="3122404">List</span><span class="op" id="3122408">,</span>&nbsp;<span class="ident" id="3122410">node</span><span class="op" id="3122414">.</span><span class="ident" id="3122415">ElseList</span><span class="op" id="3122423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122426">default</span><span class="op" id="3122433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122437">s</span><span class="op" id="3122438">.</span><span class="ident" id="3122439">errorf</span><span class="op" id="3122445">(</span><span class="string" id="3122446">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="3122464">,</span>&nbsp;<span class="ident" id="3122466">node</span><span class="op" id="3122470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122473">}</span><br>
<span class="lineno">190</span><span class="op" id="3122475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3122478">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="3122551">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3122609">func</span>&nbsp;<span class="op" id="3122614">(</span><span class="ident" id="3122615">s</span>&nbsp;<span class="op" id="3122617">*</span><span class="ident" id="3122618">state</span><span class="op" id="3122623">)</span>&nbsp;<span class="ident" id="3122625">walkIfOrWith</span><span class="op" id="3122637">(</span><span class="ident" id="3122638">typ</span>&nbsp;<span class="ident" id="3122642">parse</span><span class="op" id="3122647">.</span><span class="ident" id="3122648">NodeType</span><span class="op" id="3122656">,</span>&nbsp;<span class="ident" id="3122658">dot</span>&nbsp;<span class="ident" id="3122662">reflect</span><span class="op" id="3122669">.</span><span class="ident" id="3122670">Value</span><span class="op" id="3122675">,</span>&nbsp;<span class="ident" id="3122677">pipe</span>&nbsp;<span class="op" id="3122682">*</span><span class="ident" id="3122683">parse</span><span class="op" id="3122688">.</span><span class="ident" id="3122689">PipeNode</span><span class="op" id="3122697">,</span>&nbsp;<span class="ident" id="3122699">list</span><span class="op" id="3122703">,</span>&nbsp;<span class="ident" id="3122705">elseList</span>&nbsp;<span class="op" id="3122714">*</span><span class="ident" id="3122715">parse</span><span class="op" id="3122720">.</span><span class="ident" id="3122721">ListNode</span><span class="op" id="3122729">)</span>&nbsp;<span class="op" id="3122731">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122734">defer</span>&nbsp;<span class="ident" id="3122740">s</span><span class="op" id="3122741">.</span><span class="ident" id="3122742">pop</span><span class="op" id="3122745">(</span><span class="ident" id="3122746">s</span><span class="op" id="3122747">.</span><span class="ident" id="3122748">mark</span><span class="op" id="3122752">(</span><span class="op" id="3122753">)</span><span class="op" id="3122754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122757">val</span>&nbsp;<span class="op" id="3122761">:=</span>&nbsp;<span class="ident" id="3122764">s</span><span class="op" id="3122765">.</span><span class="ident" id="3122766">evalPipeline</span><span class="op" id="3122778">(</span><span class="ident" id="3122779">dot</span><span class="op" id="3122782">,</span>&nbsp;<span class="ident" id="3122784">pipe</span><span class="op" id="3122788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122791">truth</span><span class="op" id="3122796">,</span>&nbsp;<span class="ident" id="3122798">ok</span>&nbsp;<span class="op" id="3122801">:=</span>&nbsp;<span class="ident" id="3122804">isTrue</span><span class="op" id="3122810">(</span><span class="ident" id="3122811">val</span><span class="op" id="3122814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122817">if</span>&nbsp;<span class="op" id="3122820">!</span><span class="ident" id="3122821">ok</span>&nbsp;<span class="op" id="3122824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122828">s</span><span class="op" id="3122829">.</span><span class="ident" id="3122830">errorf</span><span class="op" id="3122836">(</span><span class="string" id="3122837">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="3122859">,</span>&nbsp;<span class="ident" id="3122861">val</span><span class="op" id="3122864">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122870">if</span>&nbsp;<span class="ident" id="3122873">truth</span>&nbsp;<span class="op" id="3122879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3122883">if</span>&nbsp;<span class="ident" id="3122886">typ</span>&nbsp;<span class="op" id="3122890">==</span>&nbsp;<span class="ident" id="3122893">parse</span><span class="op" id="3122898">.</span><span class="ident" id="3122899">NodeWith</span>&nbsp;<span class="op" id="3122908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122913">s</span><span class="op" id="3122914">.</span><span class="ident" id="3122915">walk</span><span class="op" id="3122919">(</span><span class="ident" id="3122920">val</span><span class="op" id="3122923">,</span>&nbsp;<span class="ident" id="3122925">list</span><span class="op" id="3122929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122933">}</span>&nbsp;<span class="keyword" id="3122935">else</span>&nbsp;<span class="op" id="3122940">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122945">s</span><span class="op" id="3122946">.</span><span class="ident" id="3122947">walk</span><span class="op" id="3122951">(</span><span class="ident" id="3122952">dot</span><span class="op" id="3122955">,</span>&nbsp;<span class="ident" id="3122957">list</span><span class="op" id="3122961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3122968">}</span>&nbsp;<span class="keyword" id="3122970">else</span>&nbsp;<span class="keyword" id="3122975">if</span>&nbsp;<span class="ident" id="3122978">elseList</span>&nbsp;<span class="op" id="3122987">!=</span>&nbsp;<span class="ident" id="3122990">nil</span>&nbsp;<span class="op" id="3122994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3122998">s</span><span class="op" id="3122999">.</span><span class="ident" id="3123000">walk</span><span class="op" id="3123004">(</span><span class="ident" id="3123005">dot</span><span class="op" id="3123008">,</span>&nbsp;<span class="ident" id="3123010">elseList</span><span class="op" id="3123018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3123021">}</span><br>
<span class="lineno">210</span><span class="op" id="3123023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3123026">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="3123115">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3123170">func</span>&nbsp;<span class="ident" id="3123175">isTrue</span><span class="op" id="3123181">(</span><span class="ident" id="3123182">val</span>&nbsp;<span class="ident" id="3123186">reflect</span><span class="op" id="3123193">.</span><span class="ident" id="3123194">Value</span><span class="op" id="3123199">)</span>&nbsp;<span class="op" id="3123201">(</span><span class="ident" id="3123202">truth</span><span class="op" id="3123207">,</span>&nbsp;<span class="ident" id="3123209">ok</span>&nbsp;<span class="builtintype" id="3123212">bool</span><span class="op" id="3123216">)</span>&nbsp;<span class="op" id="3123218">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123221">if</span>&nbsp;<span class="op" id="3123224">!</span><span class="ident" id="3123225">val</span><span class="op" id="3123228">.</span><span class="ident" id="3123229">IsValid</span><span class="op" id="3123236">(</span><span class="op" id="3123237">)</span>&nbsp;<span class="op" id="3123239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3123243">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123313">return</span>&nbsp;<span class="builtintype" id="3123320">false</span><span class="op" id="3123325">,</span>&nbsp;<span class="builtintype" id="3123327">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3123333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123336">switch</span>&nbsp;<span class="ident" id="3123343">val</span><span class="op" id="3123346">.</span><span class="ident" id="3123347">Kind</span><span class="op" id="3123351">(</span><span class="op" id="3123352">)</span>&nbsp;<span class="op" id="3123354">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123357">case</span>&nbsp;<span class="ident" id="3123362">reflect</span><span class="op" id="3123369">.</span><span class="ident" id="3123370">Array</span><span class="op" id="3123375">,</span>&nbsp;<span class="ident" id="3123377">reflect</span><span class="op" id="3123384">.</span><span class="ident" id="3123385">Map</span><span class="op" id="3123388">,</span>&nbsp;<span class="ident" id="3123390">reflect</span><span class="op" id="3123397">.</span><span class="ident" id="3123398">Slice</span><span class="op" id="3123403">,</span>&nbsp;<span class="ident" id="3123405">reflect</span><span class="op" id="3123412">.</span><span class="ident" id="3123413">String</span><span class="op" id="3123419">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123423">truth</span>&nbsp;<span class="op" id="3123429">=</span>&nbsp;<span class="ident" id="3123431">val</span><span class="op" id="3123434">.</span><span class="ident" id="3123435">Len</span><span class="op" id="3123438">(</span><span class="op" id="3123439">)</span>&nbsp;<span class="op" id="3123441">&gt;</span>&nbsp;<span class="num" id="3123443">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123446">case</span>&nbsp;<span class="ident" id="3123451">reflect</span><span class="op" id="3123458">.</span><span class="ident" id="3123459">Bool</span><span class="op" id="3123463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123467">truth</span>&nbsp;<span class="op" id="3123473">=</span>&nbsp;<span class="ident" id="3123475">val</span><span class="op" id="3123478">.</span><span class="ident" id="3123479">Bool</span><span class="op" id="3123483">(</span><span class="op" id="3123484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123487">case</span>&nbsp;<span class="ident" id="3123492">reflect</span><span class="op" id="3123499">.</span><span class="ident" id="3123500">Complex64</span><span class="op" id="3123509">,</span>&nbsp;<span class="ident" id="3123511">reflect</span><span class="op" id="3123518">.</span><span class="ident" id="3123519">Complex128</span><span class="op" id="3123529">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123533">truth</span>&nbsp;<span class="op" id="3123539">=</span>&nbsp;<span class="ident" id="3123541">val</span><span class="op" id="3123544">.</span><span class="ident" id="3123545">Complex</span><span class="op" id="3123552">(</span><span class="op" id="3123553">)</span>&nbsp;<span class="op" id="3123555">!=</span>&nbsp;<span class="num" id="3123558">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123561">case</span>&nbsp;<span class="ident" id="3123566">reflect</span><span class="op" id="3123573">.</span><span class="ident" id="3123574">Chan</span><span class="op" id="3123578">,</span>&nbsp;<span class="ident" id="3123580">reflect</span><span class="op" id="3123587">.</span><span class="ident" id="3123588">Func</span><span class="op" id="3123592">,</span>&nbsp;<span class="ident" id="3123594">reflect</span><span class="op" id="3123601">.</span><span class="ident" id="3123602">Ptr</span><span class="op" id="3123605">,</span>&nbsp;<span class="ident" id="3123607">reflect</span><span class="op" id="3123614">.</span><span class="ident" id="3123615">Interface</span><span class="op" id="3123624">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123628">truth</span>&nbsp;<span class="op" id="3123634">=</span>&nbsp;<span class="op" id="3123636">!</span><span class="ident" id="3123637">val</span><span class="op" id="3123640">.</span><span class="ident" id="3123641">IsNil</span><span class="op" id="3123646">(</span><span class="op" id="3123647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123650">case</span>&nbsp;<span class="ident" id="3123655">reflect</span><span class="op" id="3123662">.</span><span class="ident" id="3123663">Int</span><span class="op" id="3123666">,</span>&nbsp;<span class="ident" id="3123668">reflect</span><span class="op" id="3123675">.</span><span class="ident" id="3123676">Int8</span><span class="op" id="3123680">,</span>&nbsp;<span class="ident" id="3123682">reflect</span><span class="op" id="3123689">.</span><span class="ident" id="3123690">Int16</span><span class="op" id="3123695">,</span>&nbsp;<span class="ident" id="3123697">reflect</span><span class="op" id="3123704">.</span><span class="ident" id="3123705">Int32</span><span class="op" id="3123710">,</span>&nbsp;<span class="ident" id="3123712">reflect</span><span class="op" id="3123719">.</span><span class="ident" id="3123720">Int64</span><span class="op" id="3123725">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123729">truth</span>&nbsp;<span class="op" id="3123735">=</span>&nbsp;<span class="ident" id="3123737">val</span><span class="op" id="3123740">.</span><span class="ident" id="3123741">Int</span><span class="op" id="3123744">(</span><span class="op" id="3123745">)</span>&nbsp;<span class="op" id="3123747">!=</span>&nbsp;<span class="num" id="3123750">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123753">case</span>&nbsp;<span class="ident" id="3123758">reflect</span><span class="op" id="3123765">.</span><span class="ident" id="3123766">Float32</span><span class="op" id="3123773">,</span>&nbsp;<span class="ident" id="3123775">reflect</span><span class="op" id="3123782">.</span><span class="ident" id="3123783">Float64</span><span class="op" id="3123790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123794">truth</span>&nbsp;<span class="op" id="3123800">=</span>&nbsp;<span class="ident" id="3123802">val</span><span class="op" id="3123805">.</span><span class="ident" id="3123806">Float</span><span class="op" id="3123811">(</span><span class="op" id="3123812">)</span>&nbsp;<span class="op" id="3123814">!=</span>&nbsp;<span class="num" id="3123817">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123820">case</span>&nbsp;<span class="ident" id="3123825">reflect</span><span class="op" id="3123832">.</span><span class="ident" id="3123833">Uint</span><span class="op" id="3123837">,</span>&nbsp;<span class="ident" id="3123839">reflect</span><span class="op" id="3123846">.</span><span class="ident" id="3123847">Uint8</span><span class="op" id="3123852">,</span>&nbsp;<span class="ident" id="3123854">reflect</span><span class="op" id="3123861">.</span><span class="ident" id="3123862">Uint16</span><span class="op" id="3123868">,</span>&nbsp;<span class="ident" id="3123870">reflect</span><span class="op" id="3123877">.</span><span class="ident" id="3123878">Uint32</span><span class="op" id="3123884">,</span>&nbsp;<span class="ident" id="3123886">reflect</span><span class="op" id="3123893">.</span><span class="ident" id="3123894">Uint64</span><span class="op" id="3123900">,</span>&nbsp;<span class="ident" id="3123902">reflect</span><span class="op" id="3123909">.</span><span class="ident" id="3123910">Uintptr</span><span class="op" id="3123917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123921">truth</span>&nbsp;<span class="op" id="3123927">=</span>&nbsp;<span class="ident" id="3123929">val</span><span class="op" id="3123932">.</span><span class="ident" id="3123933">Uint</span><span class="op" id="3123937">(</span><span class="op" id="3123938">)</span>&nbsp;<span class="op" id="3123940">!=</span>&nbsp;<span class="num" id="3123943">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3123946">case</span>&nbsp;<span class="ident" id="3123951">reflect</span><span class="op" id="3123958">.</span><span class="ident" id="3123959">Struct</span><span class="op" id="3123965">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3123969">truth</span>&nbsp;<span class="op" id="3123975">=</span>&nbsp;<span class="builtintype" id="3123977">true</span>&nbsp;<span class="comment" id="3123982">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124017">default</span><span class="op" id="3124024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124028">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124039">return</span>&nbsp;<span class="ident" id="3124046">truth</span><span class="op" id="3124051">,</span>&nbsp;<span class="builtintype" id="3124053">true</span><br>
<span class="lineno">240</span><span class="op" id="3124058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3124061">func</span>&nbsp;<span class="op" id="3124066">(</span><span class="ident" id="3124067">s</span>&nbsp;<span class="op" id="3124069">*</span><span class="ident" id="3124070">state</span><span class="op" id="3124075">)</span>&nbsp;<span class="ident" id="3124077">walkRange</span><span class="op" id="3124086">(</span><span class="ident" id="3124087">dot</span>&nbsp;<span class="ident" id="3124091">reflect</span><span class="op" id="3124098">.</span><span class="ident" id="3124099">Value</span><span class="op" id="3124104">,</span>&nbsp;<span class="ident" id="3124106">r</span>&nbsp;<span class="op" id="3124108">*</span><span class="ident" id="3124109">parse</span><span class="op" id="3124114">.</span><span class="ident" id="3124115">RangeNode</span><span class="op" id="3124124">)</span>&nbsp;<span class="op" id="3124126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124129">s</span><span class="op" id="3124130">.</span><span class="ident" id="3124131">at</span><span class="op" id="3124133">(</span><span class="ident" id="3124134">r</span><span class="op" id="3124135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124138">defer</span>&nbsp;<span class="ident" id="3124144">s</span><span class="op" id="3124145">.</span><span class="ident" id="3124146">pop</span><span class="op" id="3124149">(</span><span class="ident" id="3124150">s</span><span class="op" id="3124151">.</span><span class="ident" id="3124152">mark</span><span class="op" id="3124156">(</span><span class="op" id="3124157">)</span><span class="op" id="3124158">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124161">val</span><span class="op" id="3124164">,</span>&nbsp;<span class="ident" id="3124166">_</span>&nbsp;<span class="op" id="3124168">:=</span>&nbsp;<span class="ident" id="3124171">indirect</span><span class="op" id="3124179">(</span><span class="ident" id="3124180">s</span><span class="op" id="3124181">.</span><span class="ident" id="3124182">evalPipeline</span><span class="op" id="3124194">(</span><span class="ident" id="3124195">dot</span><span class="op" id="3124198">,</span>&nbsp;<span class="ident" id="3124200">r</span><span class="op" id="3124201">.</span><span class="ident" id="3124202">Pipe</span><span class="op" id="3124206">)</span><span class="op" id="3124207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3124210">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124277">mark</span>&nbsp;<span class="op" id="3124282">:=</span>&nbsp;<span class="ident" id="3124285">s</span><span class="op" id="3124286">.</span><span class="ident" id="3124287">mark</span><span class="op" id="3124291">(</span><span class="op" id="3124292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124295">oneIteration</span>&nbsp;<span class="op" id="3124308">:=</span>&nbsp;<span class="keyword" id="3124311">func</span><span class="op" id="3124315">(</span><span class="ident" id="3124316">index</span><span class="op" id="3124321">,</span>&nbsp;<span class="ident" id="3124323">elem</span>&nbsp;<span class="ident" id="3124328">reflect</span><span class="op" id="3124335">.</span><span class="ident" id="3124336">Value</span><span class="op" id="3124341">)</span>&nbsp;<span class="op" id="3124343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3124347">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124420">if</span>&nbsp;<span class="builtinfunc" id="3124423">len</span><span class="op" id="3124426">(</span><span class="ident" id="3124427">r</span><span class="op" id="3124428">.</span><span class="ident" id="3124429">Pipe</span><span class="op" id="3124433">.</span><span class="ident" id="3124434">Decl</span><span class="op" id="3124438">)</span>&nbsp;<span class="op" id="3124440">&gt;</span>&nbsp;<span class="num" id="3124442">0</span>&nbsp;<span class="op" id="3124444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124449">s</span><span class="op" id="3124450">.</span><span class="ident" id="3124451">setVar</span><span class="op" id="3124457">(</span><span class="num" id="3124458">1</span><span class="op" id="3124459">,</span>&nbsp;<span class="ident" id="3124461">elem</span><span class="op" id="3124465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3124473">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124544">if</span>&nbsp;<span class="builtinfunc" id="3124547">len</span><span class="op" id="3124550">(</span><span class="ident" id="3124551">r</span><span class="op" id="3124552">.</span><span class="ident" id="3124553">Pipe</span><span class="op" id="3124557">.</span><span class="ident" id="3124558">Decl</span><span class="op" id="3124562">)</span>&nbsp;<span class="op" id="3124564">&gt;</span>&nbsp;<span class="num" id="3124566">1</span>&nbsp;<span class="op" id="3124568">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124573">s</span><span class="op" id="3124574">.</span><span class="ident" id="3124575">setVar</span><span class="op" id="3124581">(</span><span class="num" id="3124582">2</span><span class="op" id="3124583">,</span>&nbsp;<span class="ident" id="3124585">index</span><span class="op" id="3124590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124598">s</span><span class="op" id="3124599">.</span><span class="ident" id="3124600">walk</span><span class="op" id="3124604">(</span><span class="ident" id="3124605">elem</span><span class="op" id="3124609">,</span>&nbsp;<span class="ident" id="3124611">r</span><span class="op" id="3124612">.</span><span class="ident" id="3124613">List</span><span class="op" id="3124617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124621">s</span><span class="op" id="3124622">.</span><span class="ident" id="3124623">pop</span><span class="op" id="3124626">(</span><span class="ident" id="3124627">mark</span><span class="op" id="3124631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124634">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124637">switch</span>&nbsp;<span class="ident" id="3124644">val</span><span class="op" id="3124647">.</span><span class="ident" id="3124648">Kind</span><span class="op" id="3124652">(</span><span class="op" id="3124653">)</span>&nbsp;<span class="op" id="3124655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124658">case</span>&nbsp;<span class="ident" id="3124663">reflect</span><span class="op" id="3124670">.</span><span class="ident" id="3124671">Array</span><span class="op" id="3124676">,</span>&nbsp;<span class="ident" id="3124678">reflect</span><span class="op" id="3124685">.</span><span class="ident" id="3124686">Slice</span><span class="op" id="3124691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124695">if</span>&nbsp;<span class="ident" id="3124698">val</span><span class="op" id="3124701">.</span><span class="ident" id="3124702">Len</span><span class="op" id="3124705">(</span><span class="op" id="3124706">)</span>&nbsp;<span class="op" id="3124708">==</span>&nbsp;<span class="num" id="3124711">0</span>&nbsp;<span class="op" id="3124713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124718">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124726">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124730">for</span>&nbsp;<span class="ident" id="3124734">i</span>&nbsp;<span class="op" id="3124736">:=</span>&nbsp;<span class="num" id="3124739">0</span><span class="op" id="3124740">;</span>&nbsp;<span class="ident" id="3124742">i</span>&nbsp;<span class="op" id="3124744">&lt;</span>&nbsp;<span class="ident" id="3124746">val</span><span class="op" id="3124749">.</span><span class="ident" id="3124750">Len</span><span class="op" id="3124753">(</span><span class="op" id="3124754">)</span><span class="op" id="3124755">;</span>&nbsp;<span class="ident" id="3124757">i</span><span class="op" id="3124758">++</span>&nbsp;<span class="op" id="3124761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124766">oneIteration</span><span class="op" id="3124778">(</span><span class="ident" id="3124779">reflect</span><span class="op" id="3124786">.</span><span class="ident" id="3124787">ValueOf</span><span class="op" id="3124794">(</span><span class="ident" id="3124795">i</span><span class="op" id="3124796">)</span><span class="op" id="3124797">,</span>&nbsp;<span class="ident" id="3124799">val</span><span class="op" id="3124802">.</span><span class="ident" id="3124803">Index</span><span class="op" id="3124808">(</span><span class="ident" id="3124809">i</span><span class="op" id="3124810">)</span><span class="op" id="3124811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124819">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124827">case</span>&nbsp;<span class="ident" id="3124832">reflect</span><span class="op" id="3124839">.</span><span class="ident" id="3124840">Map</span><span class="op" id="3124843">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124847">if</span>&nbsp;<span class="ident" id="3124850">val</span><span class="op" id="3124853">.</span><span class="ident" id="3124854">Len</span><span class="op" id="3124857">(</span><span class="op" id="3124858">)</span>&nbsp;<span class="op" id="3124860">==</span>&nbsp;<span class="num" id="3124863">0</span>&nbsp;<span class="op" id="3124865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124870">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124882">for</span>&nbsp;<span class="ident" id="3124886">_</span><span class="op" id="3124887">,</span>&nbsp;<span class="ident" id="3124889">key</span>&nbsp;<span class="op" id="3124893">:=</span>&nbsp;<span class="keyword" id="3124896">range</span>&nbsp;<span class="ident" id="3124902">sortKeys</span><span class="op" id="3124910">(</span><span class="ident" id="3124911">val</span><span class="op" id="3124914">.</span><span class="ident" id="3124915">MapKeys</span><span class="op" id="3124922">(</span><span class="op" id="3124923">)</span><span class="op" id="3124924">)</span>&nbsp;<span class="op" id="3124926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3124931">oneIteration</span><span class="op" id="3124943">(</span><span class="ident" id="3124944">key</span><span class="op" id="3124947">,</span>&nbsp;<span class="ident" id="3124949">val</span><span class="op" id="3124952">.</span><span class="ident" id="3124953">MapIndex</span><span class="op" id="3124961">(</span><span class="ident" id="3124962">key</span><span class="op" id="3124965">)</span><span class="op" id="3124966">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3124970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124974">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3124982">case</span>&nbsp;<span class="ident" id="3124987">reflect</span><span class="op" id="3124994">.</span><span class="ident" id="3124995">Chan</span><span class="op" id="3124999">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125003">if</span>&nbsp;<span class="ident" id="3125006">val</span><span class="op" id="3125009">.</span><span class="ident" id="3125010">IsNil</span><span class="op" id="3125015">(</span><span class="op" id="3125016">)</span>&nbsp;<span class="op" id="3125018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125023">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125035">i</span>&nbsp;<span class="op" id="3125037">:=</span>&nbsp;<span class="num" id="3125040">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125044">for</span>&nbsp;<span class="op" id="3125048">;</span>&nbsp;<span class="op" id="3125050">;</span>&nbsp;<span class="ident" id="3125052">i</span><span class="op" id="3125053">++</span>&nbsp;<span class="op" id="3125056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125061">elem</span><span class="op" id="3125065">,</span>&nbsp;<span class="ident" id="3125067">ok</span>&nbsp;<span class="op" id="3125070">:=</span>&nbsp;<span class="ident" id="3125073">val</span><span class="op" id="3125076">.</span><span class="ident" id="3125077">Recv</span><span class="op" id="3125081">(</span><span class="op" id="3125082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125087">if</span>&nbsp;<span class="op" id="3125090">!</span><span class="ident" id="3125091">ok</span>&nbsp;<span class="op" id="3125094">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125100">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125114">oneIteration</span><span class="op" id="3125126">(</span><span class="ident" id="3125127">reflect</span><span class="op" id="3125134">.</span><span class="ident" id="3125135">ValueOf</span><span class="op" id="3125142">(</span><span class="ident" id="3125143">i</span><span class="op" id="3125144">)</span><span class="op" id="3125145">,</span>&nbsp;<span class="ident" id="3125147">elem</span><span class="op" id="3125151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125159">if</span>&nbsp;<span class="ident" id="3125162">i</span>&nbsp;<span class="op" id="3125164">==</span>&nbsp;<span class="num" id="3125167">0</span>&nbsp;<span class="op" id="3125169">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125174">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125186">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125194">case</span>&nbsp;<span class="ident" id="3125199">reflect</span><span class="op" id="3125206">.</span><span class="ident" id="3125207">Invalid</span><span class="op" id="3125214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125218">break</span>&nbsp;<span class="comment" id="3125224">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125299">default</span><span class="op" id="3125306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125310">s</span><span class="op" id="3125311">.</span><span class="ident" id="3125312">errorf</span><span class="op" id="3125318">(</span><span class="string" id="3125319">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="3125348">,</span>&nbsp;<span class="ident" id="3125350">val</span><span class="op" id="3125353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125359">if</span>&nbsp;<span class="ident" id="3125362">r</span><span class="op" id="3125363">.</span><span class="ident" id="3125364">ElseList</span>&nbsp;<span class="op" id="3125373">!=</span>&nbsp;<span class="ident" id="3125376">nil</span>&nbsp;<span class="op" id="3125380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125384">s</span><span class="op" id="3125385">.</span><span class="ident" id="3125386">walk</span><span class="op" id="3125390">(</span><span class="ident" id="3125391">dot</span><span class="op" id="3125394">,</span>&nbsp;<span class="ident" id="3125396">r</span><span class="op" id="3125397">.</span><span class="ident" id="3125398">ElseList</span><span class="op" id="3125406">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125409">}</span><br>
<span class="lineno"></span><span class="op" id="3125411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3125414">func</span>&nbsp;<span class="op" id="3125419">(</span><span class="ident" id="3125420">s</span>&nbsp;<span class="op" id="3125422">*</span><span class="ident" id="3125423">state</span><span class="op" id="3125428">)</span>&nbsp;<span class="ident" id="3125430">walkTemplate</span><span class="op" id="3125442">(</span><span class="ident" id="3125443">dot</span>&nbsp;<span class="ident" id="3125447">reflect</span><span class="op" id="3125454">.</span><span class="ident" id="3125455">Value</span><span class="op" id="3125460">,</span>&nbsp;<span class="ident" id="3125462">t</span>&nbsp;<span class="op" id="3125464">*</span><span class="ident" id="3125465">parse</span><span class="op" id="3125470">.</span><span class="ident" id="3125471">TemplateNode</span><span class="op" id="3125483">)</span>&nbsp;<span class="op" id="3125485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125488">s</span><span class="op" id="3125489">.</span><span class="ident" id="3125490">at</span><span class="op" id="3125492">(</span><span class="ident" id="3125493">t</span><span class="op" id="3125494">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125497">tmpl</span>&nbsp;<span class="op" id="3125502">:=</span>&nbsp;<span class="ident" id="3125505">s</span><span class="op" id="3125506">.</span><span class="ident" id="3125507">tmpl</span><span class="op" id="3125511">.</span><span class="ident" id="3125512">tmpl</span><span class="op" id="3125516">[</span><span class="ident" id="3125517">t</span><span class="op" id="3125518">.</span><span class="ident" id="3125519">Name</span><span class="op" id="3125523">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3125526">if</span>&nbsp;<span class="ident" id="3125529">tmpl</span>&nbsp;<span class="op" id="3125534">==</span>&nbsp;<span class="ident" id="3125537">nil</span>&nbsp;<span class="op" id="3125541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125545">s</span><span class="op" id="3125546">.</span><span class="ident" id="3125547">errorf</span><span class="op" id="3125553">(</span><span class="string" id="3125554">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="3125579">,</span>&nbsp;<span class="ident" id="3125581">t</span><span class="op" id="3125582">.</span><span class="ident" id="3125583">Name</span><span class="op" id="3125587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3125590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3125593">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125641">dot</span>&nbsp;<span class="op" id="3125645">=</span>&nbsp;<span class="ident" id="3125647">s</span><span class="op" id="3125648">.</span><span class="ident" id="3125649">evalPipeline</span><span class="op" id="3125661">(</span><span class="ident" id="3125662">dot</span><span class="op" id="3125665">,</span>&nbsp;<span class="ident" id="3125667">t</span><span class="op" id="3125668">.</span><span class="ident" id="3125669">Pipe</span><span class="op" id="3125673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125676">newState</span>&nbsp;<span class="op" id="3125685">:=</span>&nbsp;<span class="op" id="3125688">*</span><span class="ident" id="3125689">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125692">newState</span><span class="op" id="3125700">.</span><span class="ident" id="3125701">tmpl</span>&nbsp;<span class="op" id="3125706">=</span>&nbsp;<span class="ident" id="3125708">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3125714">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125781">newState</span><span class="op" id="3125789">.</span><span class="ident" id="3125790">vars</span>&nbsp;<span class="op" id="3125795">=</span>&nbsp;<span class="op" id="3125797">[</span><span class="op" id="3125798">]</span><span class="ident" id="3125799">variable</span><span class="op" id="3125807">{</span><span class="op" id="3125808">{</span><span class="string" id="3125809">&#34;$&#34;</span><span class="op" id="3125812">,</span>&nbsp;<span class="ident" id="3125814">dot</span><span class="op" id="3125817">}</span><span class="op" id="3125818">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3125821">newState</span><span class="op" id="3125829">.</span><span class="ident" id="3125830">walk</span><span class="op" id="3125834">(</span><span class="ident" id="3125835">dot</span><span class="op" id="3125838">,</span>&nbsp;<span class="ident" id="3125840">tmpl</span><span class="op" id="3125844">.</span><span class="ident" id="3125845">Root</span><span class="op" id="3125849">)</span><br>
<span class="lineno"></span><span class="op" id="3125851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3125854">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="3125933">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="3126016">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3126086">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3126162">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3126237">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="3126310">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3126365">func</span>&nbsp;<span class="op" id="3126370">(</span><span class="ident" id="3126371">s</span>&nbsp;<span class="op" id="3126373">*</span><span class="ident" id="3126374">state</span><span class="op" id="3126379">)</span>&nbsp;<span class="ident" id="3126381">evalPipeline</span><span class="op" id="3126393">(</span><span class="ident" id="3126394">dot</span>&nbsp;<span class="ident" id="3126398">reflect</span><span class="op" id="3126405">.</span><span class="ident" id="3126406">Value</span><span class="op" id="3126411">,</span>&nbsp;<span class="ident" id="3126413">pipe</span>&nbsp;<span class="op" id="3126418">*</span><span class="ident" id="3126419">parse</span><span class="op" id="3126424">.</span><span class="ident" id="3126425">PipeNode</span><span class="op" id="3126433">)</span>&nbsp;<span class="op" id="3126435">(</span><span class="ident" id="3126436">value</span>&nbsp;<span class="ident" id="3126442">reflect</span><span class="op" id="3126449">.</span><span class="ident" id="3126450">Value</span><span class="op" id="3126455">)</span>&nbsp;<span class="op" id="3126457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126460">if</span>&nbsp;<span class="ident" id="3126463">pipe</span>&nbsp;<span class="op" id="3126468">==</span>&nbsp;<span class="ident" id="3126471">nil</span>&nbsp;<span class="op" id="3126475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126479">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126487">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126490">s</span><span class="op" id="3126491">.</span><span class="ident" id="3126492">at</span><span class="op" id="3126494">(</span><span class="ident" id="3126495">pipe</span><span class="op" id="3126499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126502">for</span>&nbsp;<span class="ident" id="3126506">_</span><span class="op" id="3126507">,</span>&nbsp;<span class="ident" id="3126509">cmd</span>&nbsp;<span class="op" id="3126513">:=</span>&nbsp;<span class="keyword" id="3126516">range</span>&nbsp;<span class="ident" id="3126522">pipe</span><span class="op" id="3126526">.</span><span class="ident" id="3126527">Cmds</span>&nbsp;<span class="op" id="3126532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126536">value</span>&nbsp;<span class="op" id="3126542">=</span>&nbsp;<span class="ident" id="3126544">s</span><span class="op" id="3126545">.</span><span class="ident" id="3126546">evalCommand</span><span class="op" id="3126557">(</span><span class="ident" id="3126558">dot</span><span class="op" id="3126561">,</span>&nbsp;<span class="ident" id="3126563">cmd</span><span class="op" id="3126566">,</span>&nbsp;<span class="ident" id="3126568">value</span><span class="op" id="3126573">)</span>&nbsp;<span class="comment" id="3126575">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3126620">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126701">if</span>&nbsp;<span class="ident" id="3126704">value</span><span class="op" id="3126709">.</span><span class="ident" id="3126710">Kind</span><span class="op" id="3126714">(</span><span class="op" id="3126715">)</span>&nbsp;<span class="op" id="3126717">==</span>&nbsp;<span class="ident" id="3126720">reflect</span><span class="op" id="3126727">.</span><span class="ident" id="3126728">Interface</span>&nbsp;<span class="op" id="3126738">&amp;&amp;</span>&nbsp;<span class="ident" id="3126741">value</span><span class="op" id="3126746">.</span><span class="ident" id="3126747">Type</span><span class="op" id="3126751">(</span><span class="op" id="3126752">)</span><span class="op" id="3126753">.</span><span class="ident" id="3126754">NumMethod</span><span class="op" id="3126763">(</span><span class="op" id="3126764">)</span>&nbsp;<span class="op" id="3126766">==</span>&nbsp;<span class="num" id="3126769">0</span>&nbsp;<span class="op" id="3126771">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126776">value</span>&nbsp;<span class="op" id="3126782">=</span>&nbsp;<span class="ident" id="3126784">reflect</span><span class="op" id="3126791">.</span><span class="ident" id="3126792">ValueOf</span><span class="op" id="3126799">(</span><span class="ident" id="3126800">value</span><span class="op" id="3126805">.</span><span class="ident" id="3126806">Interface</span><span class="op" id="3126815">(</span><span class="op" id="3126816">)</span><span class="op" id="3126817">)</span>&nbsp;<span class="comment" id="3126819">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126838">for</span>&nbsp;<span class="ident" id="3126842">_</span><span class="op" id="3126843">,</span>&nbsp;<span class="ident" id="3126845">variable</span>&nbsp;<span class="op" id="3126854">:=</span>&nbsp;<span class="keyword" id="3126857">range</span>&nbsp;<span class="ident" id="3126863">pipe</span><span class="op" id="3126867">.</span><span class="ident" id="3126868">Decl</span>&nbsp;<span class="op" id="3126873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3126877">s</span><span class="op" id="3126878">.</span><span class="ident" id="3126879">push</span><span class="op" id="3126883">(</span><span class="ident" id="3126884">variable</span><span class="op" id="3126892">.</span><span class="ident" id="3126893">Ident</span><span class="op" id="3126898">[</span><span class="num" id="3126899">0</span><span class="op" id="3126900">]</span><span class="op" id="3126901">,</span>&nbsp;<span class="ident" id="3126903">value</span><span class="op" id="3126908">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3126911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3126914">return</span>&nbsp;<span class="ident" id="3126921">value</span><br>
<span class="lineno"></span><span class="op" id="3126927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3126930">func</span>&nbsp;<span class="op" id="3126935">(</span><span class="ident" id="3126936">s</span>&nbsp;<span class="op" id="3126938">*</span><span class="ident" id="3126939">state</span><span class="op" id="3126944">)</span>&nbsp;<span class="ident" id="3126946">notAFunction</span><span class="op" id="3126958">(</span><span class="ident" id="3126959">args</span>&nbsp;<span class="op" id="3126964">[</span><span class="op" id="3126965">]</span><span class="ident" id="3126966">parse</span><span class="op" id="3126971">.</span><span class="ident" id="3126972">Node</span><span class="op" id="3126976">,</span>&nbsp;<span class="ident" id="3126978">final</span>&nbsp;<span class="ident" id="3126984">reflect</span><span class="op" id="3126991">.</span><span class="ident" id="3126992">Value</span><span class="op" id="3126997">)</span>&nbsp;<span class="op" id="3126999">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127002">if</span>&nbsp;<span class="builtinfunc" id="3127005">len</span><span class="op" id="3127008">(</span><span class="ident" id="3127009">args</span><span class="op" id="3127013">)</span>&nbsp;<span class="op" id="3127015">&gt;</span>&nbsp;<span class="num" id="3127017">1</span>&nbsp;<span class="op" id="3127019">||</span>&nbsp;<span class="ident" id="3127022">final</span><span class="op" id="3127027">.</span><span class="ident" id="3127028">IsValid</span><span class="op" id="3127035">(</span><span class="op" id="3127036">)</span>&nbsp;<span class="op" id="3127038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127042">s</span><span class="op" id="3127043">.</span><span class="ident" id="3127044">errorf</span><span class="op" id="3127050">(</span><span class="string" id="3127051">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="3127091">,</span>&nbsp;<span class="ident" id="3127093">args</span><span class="op" id="3127097">[</span><span class="num" id="3127098">0</span><span class="op" id="3127099">]</span><span class="op" id="3127100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3127103">}</span><br>
<span class="lineno"></span><span class="op" id="3127105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3127108">func</span>&nbsp;<span class="op" id="3127113">(</span><span class="ident" id="3127114">s</span>&nbsp;<span class="op" id="3127116">*</span><span class="ident" id="3127117">state</span><span class="op" id="3127122">)</span>&nbsp;<span class="ident" id="3127124">evalCommand</span><span class="op" id="3127135">(</span><span class="ident" id="3127136">dot</span>&nbsp;<span class="ident" id="3127140">reflect</span><span class="op" id="3127147">.</span><span class="ident" id="3127148">Value</span><span class="op" id="3127153">,</span>&nbsp;<span class="ident" id="3127155">cmd</span>&nbsp;<span class="op" id="3127159">*</span><span class="ident" id="3127160">parse</span><span class="op" id="3127165">.</span><span class="ident" id="3127166">CommandNode</span><span class="op" id="3127177">,</span>&nbsp;<span class="ident" id="3127179">final</span>&nbsp;<span class="ident" id="3127185">reflect</span><span class="op" id="3127192">.</span><span class="ident" id="3127193">Value</span><span class="op" id="3127198">)</span>&nbsp;<span class="ident" id="3127200">reflect</span><span class="op" id="3127207">.</span><span class="ident" id="3127208">Value</span>&nbsp;<span class="op" id="3127214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127217">firstWord</span>&nbsp;<span class="op" id="3127227">:=</span>&nbsp;<span class="ident" id="3127230">cmd</span><span class="op" id="3127233">.</span><span class="ident" id="3127234">Args</span><span class="op" id="3127238">[</span><span class="num" id="3127239">0</span><span class="op" id="3127240">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127243">switch</span>&nbsp;<span class="ident" id="3127250">n</span>&nbsp;<span class="op" id="3127252">:=</span>&nbsp;<span class="ident" id="3127255">firstWord</span><span class="op" id="3127264">.</span><span class="op" id="3127265">(</span><span class="keyword" id="3127266">type</span><span class="op" id="3127270">)</span>&nbsp;<span class="op" id="3127272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127275">case</span>&nbsp;<span class="op" id="3127280">*</span><span class="ident" id="3127281">parse</span><span class="op" id="3127286">.</span><span class="ident" id="3127287">FieldNode</span><span class="op" id="3127296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127300">return</span>&nbsp;<span class="ident" id="3127307">s</span><span class="op" id="3127308">.</span><span class="ident" id="3127309">evalFieldNode</span><span class="op" id="3127322">(</span><span class="ident" id="3127323">dot</span><span class="op" id="3127326">,</span>&nbsp;<span class="ident" id="3127328">n</span><span class="op" id="3127329">,</span>&nbsp;<span class="ident" id="3127331">cmd</span><span class="op" id="3127334">.</span><span class="ident" id="3127335">Args</span><span class="op" id="3127339">,</span>&nbsp;<span class="ident" id="3127341">final</span><span class="op" id="3127346">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127349">case</span>&nbsp;<span class="op" id="3127354">*</span><span class="ident" id="3127355">parse</span><span class="op" id="3127360">.</span><span class="ident" id="3127361">ChainNode</span><span class="op" id="3127370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127374">return</span>&nbsp;<span class="ident" id="3127381">s</span><span class="op" id="3127382">.</span><span class="ident" id="3127383">evalChainNode</span><span class="op" id="3127396">(</span><span class="ident" id="3127397">dot</span><span class="op" id="3127400">,</span>&nbsp;<span class="ident" id="3127402">n</span><span class="op" id="3127403">,</span>&nbsp;<span class="ident" id="3127405">cmd</span><span class="op" id="3127408">.</span><span class="ident" id="3127409">Args</span><span class="op" id="3127413">,</span>&nbsp;<span class="ident" id="3127415">final</span><span class="op" id="3127420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127423">case</span>&nbsp;<span class="op" id="3127428">*</span><span class="ident" id="3127429">parse</span><span class="op" id="3127434">.</span><span class="ident" id="3127435">IdentifierNode</span><span class="op" id="3127449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3127453">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127478">return</span>&nbsp;<span class="ident" id="3127485">s</span><span class="op" id="3127486">.</span><span class="ident" id="3127487">evalFunction</span><span class="op" id="3127499">(</span><span class="ident" id="3127500">dot</span><span class="op" id="3127503">,</span>&nbsp;<span class="ident" id="3127505">n</span><span class="op" id="3127506">,</span>&nbsp;<span class="ident" id="3127508">cmd</span><span class="op" id="3127511">,</span>&nbsp;<span class="ident" id="3127513">cmd</span><span class="op" id="3127516">.</span><span class="ident" id="3127517">Args</span><span class="op" id="3127521">,</span>&nbsp;<span class="ident" id="3127523">final</span><span class="op" id="3127528">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127531">case</span>&nbsp;<span class="op" id="3127536">*</span><span class="ident" id="3127537">parse</span><span class="op" id="3127542">.</span><span class="ident" id="3127543">PipeNode</span><span class="op" id="3127551">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3127555">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127645">return</span>&nbsp;<span class="ident" id="3127652">s</span><span class="op" id="3127653">.</span><span class="ident" id="3127654">evalPipeline</span><span class="op" id="3127666">(</span><span class="ident" id="3127667">dot</span><span class="op" id="3127670">,</span>&nbsp;<span class="ident" id="3127672">n</span><span class="op" id="3127673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127676">case</span>&nbsp;<span class="op" id="3127681">*</span><span class="ident" id="3127682">parse</span><span class="op" id="3127687">.</span><span class="ident" id="3127688">VariableNode</span><span class="op" id="3127700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127704">return</span>&nbsp;<span class="ident" id="3127711">s</span><span class="op" id="3127712">.</span><span class="ident" id="3127713">evalVariableNode</span><span class="op" id="3127729">(</span><span class="ident" id="3127730">dot</span><span class="op" id="3127733">,</span>&nbsp;<span class="ident" id="3127735">n</span><span class="op" id="3127736">,</span>&nbsp;<span class="ident" id="3127738">cmd</span><span class="op" id="3127741">.</span><span class="ident" id="3127742">Args</span><span class="op" id="3127746">,</span>&nbsp;<span class="ident" id="3127748">final</span><span class="op" id="3127753">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3127756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127759">s</span><span class="op" id="3127760">.</span><span class="ident" id="3127761">at</span><span class="op" id="3127763">(</span><span class="ident" id="3127764">firstWord</span><span class="op" id="3127773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127776">s</span><span class="op" id="3127777">.</span><span class="ident" id="3127778">notAFunction</span><span class="op" id="3127790">(</span><span class="ident" id="3127791">cmd</span><span class="op" id="3127794">.</span><span class="ident" id="3127795">Args</span><span class="op" id="3127799">,</span>&nbsp;<span class="ident" id="3127801">final</span><span class="op" id="3127806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127809">switch</span>&nbsp;<span class="ident" id="3127816">word</span>&nbsp;<span class="op" id="3127821">:=</span>&nbsp;<span class="ident" id="3127824">firstWord</span><span class="op" id="3127833">.</span><span class="op" id="3127834">(</span><span class="keyword" id="3127835">type</span><span class="op" id="3127839">)</span>&nbsp;<span class="op" id="3127841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127844">case</span>&nbsp;<span class="op" id="3127849">*</span><span class="ident" id="3127850">parse</span><span class="op" id="3127855">.</span><span class="ident" id="3127856">BoolNode</span><span class="op" id="3127864">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127868">return</span>&nbsp;<span class="ident" id="3127875">reflect</span><span class="op" id="3127882">.</span><span class="ident" id="3127883">ValueOf</span><span class="op" id="3127890">(</span><span class="ident" id="3127891">word</span><span class="op" id="3127895">.</span><span class="ident" id="3127896">True</span><span class="op" id="3127900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127903">case</span>&nbsp;<span class="op" id="3127908">*</span><span class="ident" id="3127909">parse</span><span class="op" id="3127914">.</span><span class="ident" id="3127915">DotNode</span><span class="op" id="3127922">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127926">return</span>&nbsp;<span class="ident" id="3127933">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127938">case</span>&nbsp;<span class="op" id="3127943">*</span><span class="ident" id="3127944">parse</span><span class="op" id="3127949">.</span><span class="ident" id="3127950">NilNode</span><span class="op" id="3127957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3127961">s</span><span class="op" id="3127962">.</span><span class="ident" id="3127963">errorf</span><span class="op" id="3127969">(</span><span class="string" id="3127970">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="3127992">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3127995">case</span>&nbsp;<span class="op" id="3128000">*</span><span class="ident" id="3128001">parse</span><span class="op" id="3128006">.</span><span class="ident" id="3128007">NumberNode</span><span class="op" id="3128017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128021">return</span>&nbsp;<span class="ident" id="3128028">s</span><span class="op" id="3128029">.</span><span class="ident" id="3128030">idealConstant</span><span class="op" id="3128043">(</span><span class="ident" id="3128044">word</span><span class="op" id="3128048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128051">case</span>&nbsp;<span class="op" id="3128056">*</span><span class="ident" id="3128057">parse</span><span class="op" id="3128062">.</span><span class="ident" id="3128063">StringNode</span><span class="op" id="3128073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128077">return</span>&nbsp;<span class="ident" id="3128084">reflect</span><span class="op" id="3128091">.</span><span class="ident" id="3128092">ValueOf</span><span class="op" id="3128099">(</span><span class="ident" id="3128100">word</span><span class="op" id="3128104">.</span><span class="ident" id="3128105">Text</span><span class="op" id="3128109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3128112">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128115">s</span><span class="op" id="3128116">.</span><span class="ident" id="3128117">errorf</span><span class="op" id="3128123">(</span><span class="string" id="3128124">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="3128151">,</span>&nbsp;<span class="ident" id="3128153">firstWord</span><span class="op" id="3128162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3128165">panic</span><span class="op" id="3128170">(</span><span class="string" id="3128171">&#34;not&nbsp;reached&#34;</span><span class="op" id="3128184">)</span><br>
<span class="lineno"></span><span class="op" id="3128186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3128189">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="3128267">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="3128342">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3128419">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3128495">func</span>&nbsp;<span class="op" id="3128500">(</span><span class="ident" id="3128501">s</span>&nbsp;<span class="op" id="3128503">*</span><span class="ident" id="3128504">state</span><span class="op" id="3128509">)</span>&nbsp;<span class="ident" id="3128511">idealConstant</span><span class="op" id="3128524">(</span><span class="ident" id="3128525">constant</span>&nbsp;<span class="op" id="3128534">*</span><span class="ident" id="3128535">parse</span><span class="op" id="3128540">.</span><span class="ident" id="3128541">NumberNode</span><span class="op" id="3128551">)</span>&nbsp;<span class="ident" id="3128553">reflect</span><span class="op" id="3128560">.</span><span class="ident" id="3128561">Value</span>&nbsp;<span class="op" id="3128567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3128570">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3128627">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3128686">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3128752">s</span><span class="op" id="3128753">.</span><span class="ident" id="3128754">at</span><span class="op" id="3128756">(</span><span class="ident" id="3128757">constant</span><span class="op" id="3128765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128768">switch</span>&nbsp;<span class="op" id="3128775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128778">case</span>&nbsp;<span class="ident" id="3128783">constant</span><span class="op" id="3128791">.</span><span class="ident" id="3128792">IsComplex</span><span class="op" id="3128801">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128805">return</span>&nbsp;<span class="ident" id="3128812">reflect</span><span class="op" id="3128819">.</span><span class="ident" id="3128820">ValueOf</span><span class="op" id="3128827">(</span><span class="ident" id="3128828">constant</span><span class="op" id="3128836">.</span><span class="ident" id="3128837">Complex128</span><span class="op" id="3128847">)</span>&nbsp;<span class="comment" id="3128849">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128871">case</span>&nbsp;<span class="ident" id="3128876">constant</span><span class="op" id="3128884">.</span><span class="ident" id="3128885">IsFloat</span>&nbsp;<span class="op" id="3128893">&amp;&amp;</span>&nbsp;<span class="op" id="3128896">!</span><span class="ident" id="3128897">isHexConstant</span><span class="op" id="3128910">(</span><span class="ident" id="3128911">constant</span><span class="op" id="3128919">.</span><span class="ident" id="3128920">Text</span><span class="op" id="3128924">)</span>&nbsp;<span class="op" id="3128926">&amp;&amp;</span>&nbsp;<span class="ident" id="3128929">strings</span><span class="op" id="3128936">.</span><span class="ident" id="3128937">IndexAny</span><span class="op" id="3128945">(</span><span class="ident" id="3128946">constant</span><span class="op" id="3128954">.</span><span class="ident" id="3128955">Text</span><span class="op" id="3128959">,</span>&nbsp;<span class="string" id="3128961">&#34;.eE&#34;</span><span class="op" id="3128966">)</span>&nbsp;<span class="op" id="3128968">&gt;=</span>&nbsp;<span class="num" id="3128971">0</span><span class="op" id="3128972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3128976">return</span>&nbsp;<span class="ident" id="3128983">reflect</span><span class="op" id="3128990">.</span><span class="ident" id="3128991">ValueOf</span><span class="op" id="3128998">(</span><span class="ident" id="3128999">constant</span><span class="op" id="3129007">.</span><span class="ident" id="3129008">Float64</span><span class="op" id="3129015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129018">case</span>&nbsp;<span class="ident" id="3129023">constant</span><span class="op" id="3129031">.</span><span class="ident" id="3129032">IsInt</span><span class="op" id="3129037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129041">n</span>&nbsp;<span class="op" id="3129043">:=</span>&nbsp;<span class="builtintype" id="3129046">int</span><span class="op" id="3129049">(</span><span class="ident" id="3129050">constant</span><span class="op" id="3129058">.</span><span class="ident" id="3129059">Int64</span><span class="op" id="3129064">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129068">if</span>&nbsp;<span class="ident" id="3129071">int64</span><span class="op" id="3129076">(</span><span class="ident" id="3129077">n</span><span class="op" id="3129078">)</span>&nbsp;<span class="op" id="3129080">!=</span>&nbsp;<span class="ident" id="3129083">constant</span><span class="op" id="3129091">.</span><span class="ident" id="3129092">Int64</span>&nbsp;<span class="op" id="3129098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129103">s</span><span class="op" id="3129104">.</span><span class="ident" id="3129105">errorf</span><span class="op" id="3129111">(</span><span class="string" id="3129112">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3129130">,</span>&nbsp;<span class="ident" id="3129132">constant</span><span class="op" id="3129140">.</span><span class="ident" id="3129141">Text</span><span class="op" id="3129145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3129149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129153">return</span>&nbsp;<span class="ident" id="3129160">reflect</span><span class="op" id="3129167">.</span><span class="ident" id="3129168">ValueOf</span><span class="op" id="3129175">(</span><span class="ident" id="3129176">n</span><span class="op" id="3129177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129180">case</span>&nbsp;<span class="ident" id="3129185">constant</span><span class="op" id="3129193">.</span><span class="ident" id="3129194">IsUint</span><span class="op" id="3129200">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129204">s</span><span class="op" id="3129205">.</span><span class="ident" id="3129206">errorf</span><span class="op" id="3129212">(</span><span class="string" id="3129213">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3129231">,</span>&nbsp;<span class="ident" id="3129233">constant</span><span class="op" id="3129241">.</span><span class="ident" id="3129242">Text</span><span class="op" id="3129246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3129249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129252">return</span>&nbsp;<span class="ident" id="3129259">zero</span><br>
<span class="lineno"></span><span class="op" id="3129264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="3129267">func</span>&nbsp;<span class="ident" id="3129272">isHexConstant</span><span class="op" id="3129285">(</span><span class="ident" id="3129286">s</span>&nbsp;<span class="builtintype" id="3129288">string</span><span class="op" id="3129294">)</span>&nbsp;<span class="builtintype" id="3129296">bool</span>&nbsp;<span class="op" id="3129301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129304">return</span>&nbsp;<span class="builtinfunc" id="3129311">len</span><span class="op" id="3129314">(</span><span class="ident" id="3129315">s</span><span class="op" id="3129316">)</span>&nbsp;<span class="op" id="3129318">&gt;</span>&nbsp;<span class="num" id="3129320">2</span>&nbsp;<span class="op" id="3129322">&amp;&amp;</span>&nbsp;<span class="ident" id="3129325">s</span><span class="op" id="3129326">[</span><span class="num" id="3129327">0</span><span class="op" id="3129328">]</span>&nbsp;<span class="op" id="3129330">==</span>&nbsp;<span class="string" id="3129333">&#39;0&#39;</span>&nbsp;<span class="op" id="3129337">&amp;&amp;</span>&nbsp;<span class="op" id="3129340">(</span><span class="ident" id="3129341">s</span><span class="op" id="3129342">[</span><span class="num" id="3129343">1</span><span class="op" id="3129344">]</span>&nbsp;<span class="op" id="3129346">==</span>&nbsp;<span class="string" id="3129349">&#39;x&#39;</span>&nbsp;<span class="op" id="3129353">||</span>&nbsp;<span class="ident" id="3129356">s</span><span class="op" id="3129357">[</span><span class="num" id="3129358">1</span><span class="op" id="3129359">]</span>&nbsp;<span class="op" id="3129361">==</span>&nbsp;<span class="string" id="3129364">&#39;X&#39;</span><span class="op" id="3129367">)</span><br>
<span class="lineno"></span><span class="op" id="3129369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3129372">func</span>&nbsp;<span class="op" id="3129377">(</span><span class="ident" id="3129378">s</span>&nbsp;<span class="op" id="3129380">*</span><span class="ident" id="3129381">state</span><span class="op" id="3129386">)</span>&nbsp;<span class="ident" id="3129388">evalFieldNode</span><span class="op" id="3129401">(</span><span class="ident" id="3129402">dot</span>&nbsp;<span class="ident" id="3129406">reflect</span><span class="op" id="3129413">.</span><span class="ident" id="3129414">Value</span><span class="op" id="3129419">,</span>&nbsp;<span class="ident" id="3129421">field</span>&nbsp;<span class="op" id="3129427">*</span><span class="ident" id="3129428">parse</span><span class="op" id="3129433">.</span><span class="ident" id="3129434">FieldNode</span><span class="op" id="3129443">,</span>&nbsp;<span class="ident" id="3129445">args</span>&nbsp;<span class="op" id="3129450">[</span><span class="op" id="3129451">]</span><span class="ident" id="3129452">parse</span><span class="op" id="3129457">.</span><span class="ident" id="3129458">Node</span><span class="op" id="3129462">,</span>&nbsp;<span class="ident" id="3129464">final</span>&nbsp;<span class="ident" id="3129470">reflect</span><span class="op" id="3129477">.</span><span class="ident" id="3129478">Value</span><span class="op" id="3129483">)</span>&nbsp;<span class="ident" id="3129485">reflect</span><span class="op" id="3129492">.</span><span class="ident" id="3129493">Value</span>&nbsp;<span class="op" id="3129499">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129502">s</span><span class="op" id="3129503">.</span><span class="ident" id="3129504">at</span><span class="op" id="3129506">(</span><span class="ident" id="3129507">field</span><span class="op" id="3129512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129515">return</span>&nbsp;<span class="ident" id="3129522">s</span><span class="op" id="3129523">.</span><span class="ident" id="3129524">evalFieldChain</span><span class="op" id="3129538">(</span><span class="ident" id="3129539">dot</span><span class="op" id="3129542">,</span>&nbsp;<span class="ident" id="3129544">dot</span><span class="op" id="3129547">,</span>&nbsp;<span class="ident" id="3129549">field</span><span class="op" id="3129554">,</span>&nbsp;<span class="ident" id="3129556">field</span><span class="op" id="3129561">.</span><span class="ident" id="3129562">Ident</span><span class="op" id="3129567">,</span>&nbsp;<span class="ident" id="3129569">args</span><span class="op" id="3129573">,</span>&nbsp;<span class="ident" id="3129575">final</span><span class="op" id="3129580">)</span><br>
<span class="lineno"></span><span class="op" id="3129582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3129585">func</span>&nbsp;<span class="op" id="3129590">(</span><span class="ident" id="3129591">s</span>&nbsp;<span class="op" id="3129593">*</span><span class="ident" id="3129594">state</span><span class="op" id="3129599">)</span>&nbsp;<span class="ident" id="3129601">evalChainNode</span><span class="op" id="3129614">(</span><span class="ident" id="3129615">dot</span>&nbsp;<span class="ident" id="3129619">reflect</span><span class="op" id="3129626">.</span><span class="ident" id="3129627">Value</span><span class="op" id="3129632">,</span>&nbsp;<span class="ident" id="3129634">chain</span>&nbsp;<span class="op" id="3129640">*</span><span class="ident" id="3129641">parse</span><span class="op" id="3129646">.</span><span class="ident" id="3129647">ChainNode</span><span class="op" id="3129656">,</span>&nbsp;<span class="ident" id="3129658">args</span>&nbsp;<span class="op" id="3129663">[</span><span class="op" id="3129664">]</span><span class="ident" id="3129665">parse</span><span class="op" id="3129670">.</span><span class="ident" id="3129671">Node</span><span class="op" id="3129675">,</span>&nbsp;<span class="ident" id="3129677">final</span>&nbsp;<span class="ident" id="3129683">reflect</span><span class="op" id="3129690">.</span><span class="ident" id="3129691">Value</span><span class="op" id="3129696">)</span>&nbsp;<span class="ident" id="3129698">reflect</span><span class="op" id="3129705">.</span><span class="ident" id="3129706">Value</span>&nbsp;<span class="op" id="3129712">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129715">s</span><span class="op" id="3129716">.</span><span class="ident" id="3129717">at</span><span class="op" id="3129719">(</span><span class="ident" id="3129720">chain</span><span class="op" id="3129725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3129728">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129826">pipe</span>&nbsp;<span class="op" id="3129831">:=</span>&nbsp;<span class="ident" id="3129834">s</span><span class="op" id="3129835">.</span><span class="ident" id="3129836">evalArg</span><span class="op" id="3129843">(</span><span class="ident" id="3129844">dot</span><span class="op" id="3129847">,</span>&nbsp;<span class="ident" id="3129849">nil</span><span class="op" id="3129852">,</span>&nbsp;<span class="ident" id="3129854">chain</span><span class="op" id="3129859">.</span><span class="ident" id="3129860">Node</span><span class="op" id="3129864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129867">if</span>&nbsp;<span class="builtinfunc" id="3129870">len</span><span class="op" id="3129873">(</span><span class="ident" id="3129874">chain</span><span class="op" id="3129879">.</span><span class="ident" id="3129880">Field</span><span class="op" id="3129885">)</span>&nbsp;<span class="op" id="3129887">==</span>&nbsp;<span class="num" id="3129890">0</span>&nbsp;<span class="op" id="3129892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3129896">s</span><span class="op" id="3129897">.</span><span class="ident" id="3129898">errorf</span><span class="op" id="3129904">(</span><span class="string" id="3129905">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="3129949">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3129952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3129955">return</span>&nbsp;<span class="ident" id="3129962">s</span><span class="op" id="3129963">.</span><span class="ident" id="3129964">evalFieldChain</span><span class="op" id="3129978">(</span><span class="ident" id="3129979">dot</span><span class="op" id="3129982">,</span>&nbsp;<span class="ident" id="3129984">pipe</span><span class="op" id="3129988">,</span>&nbsp;<span class="ident" id="3129990">chain</span><span class="op" id="3129995">,</span>&nbsp;<span class="ident" id="3129997">chain</span><span class="op" id="3130002">.</span><span class="ident" id="3130003">Field</span><span class="op" id="3130008">,</span>&nbsp;<span class="ident" id="3130010">args</span><span class="op" id="3130014">,</span>&nbsp;<span class="ident" id="3130016">final</span><span class="op" id="3130021">)</span><br>
<span class="lineno"></span><span class="op" id="3130023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3130026">func</span>&nbsp;<span class="op" id="3130031">(</span><span class="ident" id="3130032">s</span>&nbsp;<span class="op" id="3130034">*</span><span class="ident" id="3130035">state</span><span class="op" id="3130040">)</span>&nbsp;<span class="ident" id="3130042">evalVariableNode</span><span class="op" id="3130058">(</span><span class="ident" id="3130059">dot</span>&nbsp;<span class="ident" id="3130063">reflect</span><span class="op" id="3130070">.</span><span class="ident" id="3130071">Value</span><span class="op" id="3130076">,</span>&nbsp;<span class="ident" id="3130078">variable</span>&nbsp;<span class="op" id="3130087">*</span><span class="ident" id="3130088">parse</span><span class="op" id="3130093">.</span><span class="ident" id="3130094">VariableNode</span><span class="op" id="3130106">,</span>&nbsp;<span class="ident" id="3130108">args</span>&nbsp;<span class="op" id="3130113">[</span><span class="op" id="3130114">]</span><span class="ident" id="3130115">parse</span><span class="op" id="3130120">.</span><span class="ident" id="3130121">Node</span><span class="op" id="3130125">,</span>&nbsp;<span class="ident" id="3130127">final</span>&nbsp;<span class="ident" id="3130133">reflect</span><span class="op" id="3130140">.</span><span class="ident" id="3130141">Value</span><span class="op" id="3130146">)</span>&nbsp;<span class="ident" id="3130148">reflect</span><span class="op" id="3130155">.</span><span class="ident" id="3130156">Value</span>&nbsp;<span class="op" id="3130162">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3130165">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130257">s</span><span class="op" id="3130258">.</span><span class="ident" id="3130259">at</span><span class="op" id="3130261">(</span><span class="ident" id="3130262">variable</span><span class="op" id="3130270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130273">value</span>&nbsp;<span class="op" id="3130279">:=</span>&nbsp;<span class="ident" id="3130282">s</span><span class="op" id="3130283">.</span><span class="ident" id="3130284">varValue</span><span class="op" id="3130292">(</span><span class="ident" id="3130293">variable</span><span class="op" id="3130301">.</span><span class="ident" id="3130302">Ident</span><span class="op" id="3130307">[</span><span class="num" id="3130308">0</span><span class="op" id="3130309">]</span><span class="op" id="3130310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130313">if</span>&nbsp;<span class="builtinfunc" id="3130316">len</span><span class="op" id="3130319">(</span><span class="ident" id="3130320">variable</span><span class="op" id="3130328">.</span><span class="ident" id="3130329">Ident</span><span class="op" id="3130334">)</span>&nbsp;<span class="op" id="3130336">==</span>&nbsp;<span class="num" id="3130339">1</span>&nbsp;<span class="op" id="3130341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130345">s</span><span class="op" id="3130346">.</span><span class="ident" id="3130347">notAFunction</span><span class="op" id="3130359">(</span><span class="ident" id="3130360">args</span><span class="op" id="3130364">,</span>&nbsp;<span class="ident" id="3130366">final</span><span class="op" id="3130371">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130375">return</span>&nbsp;<span class="ident" id="3130382">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3130389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130392">return</span>&nbsp;<span class="ident" id="3130399">s</span><span class="op" id="3130400">.</span><span class="ident" id="3130401">evalFieldChain</span><span class="op" id="3130415">(</span><span class="ident" id="3130416">dot</span><span class="op" id="3130419">,</span>&nbsp;<span class="ident" id="3130421">value</span><span class="op" id="3130426">,</span>&nbsp;<span class="ident" id="3130428">variable</span><span class="op" id="3130436">,</span>&nbsp;<span class="ident" id="3130438">variable</span><span class="op" id="3130446">.</span><span class="ident" id="3130447">Ident</span><span class="op" id="3130452">[</span><span class="num" id="3130453">1</span><span class="op" id="3130454">:</span><span class="op" id="3130455">]</span><span class="op" id="3130456">,</span>&nbsp;<span class="ident" id="3130458">args</span><span class="op" id="3130462">,</span>&nbsp;<span class="ident" id="3130464">final</span><span class="op" id="3130469">)</span><br>
<span class="lineno"></span><span class="op" id="3130471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="3130474">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="3130541">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="3130605">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3130660">func</span>&nbsp;<span class="op" id="3130665">(</span><span class="ident" id="3130666">s</span>&nbsp;<span class="op" id="3130668">*</span><span class="ident" id="3130669">state</span><span class="op" id="3130674">)</span>&nbsp;<span class="ident" id="3130676">evalFieldChain</span><span class="op" id="3130690">(</span><span class="ident" id="3130691">dot</span><span class="op" id="3130694">,</span>&nbsp;<span class="ident" id="3130696">receiver</span>&nbsp;<span class="ident" id="3130705">reflect</span><span class="op" id="3130712">.</span><span class="ident" id="3130713">Value</span><span class="op" id="3130718">,</span>&nbsp;<span class="ident" id="3130720">node</span>&nbsp;<span class="ident" id="3130725">parse</span><span class="op" id="3130730">.</span><span class="ident" id="3130731">Node</span><span class="op" id="3130735">,</span>&nbsp;<span class="ident" id="3130737">ident</span>&nbsp;<span class="op" id="3130743">[</span><span class="op" id="3130744">]</span><span class="builtintype" id="3130745">string</span><span class="op" id="3130751">,</span>&nbsp;<span class="ident" id="3130753">args</span>&nbsp;<span class="op" id="3130758">[</span><span class="op" id="3130759">]</span><span class="ident" id="3130760">parse</span><span class="op" id="3130765">.</span><span class="ident" id="3130766">Node</span><span class="op" id="3130770">,</span>&nbsp;<span class="ident" id="3130772">final</span>&nbsp;<span class="ident" id="3130778">reflect</span><span class="op" id="3130785">.</span><span class="ident" id="3130786">Value</span><span class="op" id="3130791">)</span>&nbsp;<span class="ident" id="3130793">reflect</span><span class="op" id="3130800">.</span><span class="ident" id="3130801">Value</span>&nbsp;<span class="op" id="3130807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130810">n</span>&nbsp;<span class="op" id="3130812">:=</span>&nbsp;<span class="builtinfunc" id="3130815">len</span><span class="op" id="3130818">(</span><span class="ident" id="3130819">ident</span><span class="op" id="3130824">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130827">for</span>&nbsp;<span class="ident" id="3130831">i</span>&nbsp;<span class="op" id="3130833">:=</span>&nbsp;<span class="num" id="3130836">0</span><span class="op" id="3130837">;</span>&nbsp;<span class="ident" id="3130839">i</span>&nbsp;<span class="op" id="3130841">&lt;</span>&nbsp;<span class="ident" id="3130843">n</span><span class="op" id="3130844">-</span><span class="num" id="3130845">1</span><span class="op" id="3130846">;</span>&nbsp;<span class="ident" id="3130848">i</span><span class="op" id="3130849">++</span>&nbsp;<span class="op" id="3130852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3130856">receiver</span>&nbsp;<span class="op" id="3130865">=</span>&nbsp;<span class="ident" id="3130867">s</span><span class="op" id="3130868">.</span><span class="ident" id="3130869">evalField</span><span class="op" id="3130878">(</span><span class="ident" id="3130879">dot</span><span class="op" id="3130882">,</span>&nbsp;<span class="ident" id="3130884">ident</span><span class="op" id="3130889">[</span><span class="ident" id="3130890">i</span><span class="op" id="3130891">]</span><span class="op" id="3130892">,</span>&nbsp;<span class="ident" id="3130894">node</span><span class="op" id="3130898">,</span>&nbsp;<span class="ident" id="3130900">nil</span><span class="op" id="3130903">,</span>&nbsp;<span class="ident" id="3130905">zero</span><span class="op" id="3130909">,</span>&nbsp;<span class="ident" id="3130911">receiver</span><span class="op" id="3130919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3130922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3130925">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3130974">return</span>&nbsp;<span class="ident" id="3130981">s</span><span class="op" id="3130982">.</span><span class="ident" id="3130983">evalField</span><span class="op" id="3130992">(</span><span class="ident" id="3130993">dot</span><span class="op" id="3130996">,</span>&nbsp;<span class="ident" id="3130998">ident</span><span class="op" id="3131003">[</span><span class="ident" id="3131004">n</span><span class="op" id="3131005">-</span><span class="num" id="3131006">1</span><span class="op" id="3131007">]</span><span class="op" id="3131008">,</span>&nbsp;<span class="ident" id="3131010">node</span><span class="op" id="3131014">,</span>&nbsp;<span class="ident" id="3131016">args</span><span class="op" id="3131020">,</span>&nbsp;<span class="ident" id="3131022">final</span><span class="op" id="3131027">,</span>&nbsp;<span class="ident" id="3131029">receiver</span><span class="op" id="3131037">)</span><br>
<span class="lineno">450</span><span class="op" id="3131039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3131042">func</span>&nbsp;<span class="op" id="3131047">(</span><span class="ident" id="3131048">s</span>&nbsp;<span class="op" id="3131050">*</span><span class="ident" id="3131051">state</span><span class="op" id="3131056">)</span>&nbsp;<span class="ident" id="3131058">evalFunction</span><span class="op" id="3131070">(</span><span class="ident" id="3131071">dot</span>&nbsp;<span class="ident" id="3131075">reflect</span><span class="op" id="3131082">.</span><span class="ident" id="3131083">Value</span><span class="op" id="3131088">,</span>&nbsp;<span class="ident" id="3131090">node</span>&nbsp;<span class="op" id="3131095">*</span><span class="ident" id="3131096">parse</span><span class="op" id="3131101">.</span><span class="ident" id="3131102">IdentifierNode</span><span class="op" id="3131116">,</span>&nbsp;<span class="ident" id="3131118">cmd</span>&nbsp;<span class="ident" id="3131122">parse</span><span class="op" id="3131127">.</span><span class="ident" id="3131128">Node</span><span class="op" id="3131132">,</span>&nbsp;<span class="ident" id="3131134">args</span>&nbsp;<span class="op" id="3131139">[</span><span class="op" id="3131140">]</span><span class="ident" id="3131141">parse</span><span class="op" id="3131146">.</span><span class="ident" id="3131147">Node</span><span class="op" id="3131151">,</span>&nbsp;<span class="ident" id="3131153">final</span>&nbsp;<span class="ident" id="3131159">reflect</span><span class="op" id="3131166">.</span><span class="ident" id="3131167">Value</span><span class="op" id="3131172">)</span>&nbsp;<span class="ident" id="3131174">reflect</span><span class="op" id="3131181">.</span><span class="ident" id="3131182">Value</span>&nbsp;<span class="op" id="3131188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131191">s</span><span class="op" id="3131192">.</span><span class="ident" id="3131193">at</span><span class="op" id="3131195">(</span><span class="ident" id="3131196">node</span><span class="op" id="3131200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131203">name</span>&nbsp;<span class="op" id="3131208">:=</span>&nbsp;<span class="ident" id="3131211">node</span><span class="op" id="3131215">.</span><span class="ident" id="3131216">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131223">function</span><span class="op" id="3131231">,</span>&nbsp;<span class="ident" id="3131233">ok</span>&nbsp;<span class="op" id="3131236">:=</span>&nbsp;<span class="ident" id="3131239">findFunction</span><span class="op" id="3131251">(</span><span class="ident" id="3131252">name</span><span class="op" id="3131256">,</span>&nbsp;<span class="ident" id="3131258">s</span><span class="op" id="3131259">.</span><span class="ident" id="3131260">tmpl</span><span class="op" id="3131264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131267">if</span>&nbsp;<span class="op" id="3131270">!</span><span class="ident" id="3131271">ok</span>&nbsp;<span class="op" id="3131274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131278">s</span><span class="op" id="3131279">.</span><span class="ident" id="3131280">errorf</span><span class="op" id="3131286">(</span><span class="string" id="3131287">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="3131317">,</span>&nbsp;<span class="ident" id="3131319">name</span><span class="op" id="3131323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3131326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131329">return</span>&nbsp;<span class="ident" id="3131336">s</span><span class="op" id="3131337">.</span><span class="ident" id="3131338">evalCall</span><span class="op" id="3131346">(</span><span class="ident" id="3131347">dot</span><span class="op" id="3131350">,</span>&nbsp;<span class="ident" id="3131352">function</span><span class="op" id="3131360">,</span>&nbsp;<span class="ident" id="3131362">cmd</span><span class="op" id="3131365">,</span>&nbsp;<span class="ident" id="3131367">name</span><span class="op" id="3131371">,</span>&nbsp;<span class="ident" id="3131373">args</span><span class="op" id="3131377">,</span>&nbsp;<span class="ident" id="3131379">final</span><span class="op" id="3131384">)</span><br>
<span class="lineno">460</span><span class="op" id="3131386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3131389">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="3131463">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="3131534">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="3131568">func</span>&nbsp;<span class="op" id="3131573">(</span><span class="ident" id="3131574">s</span>&nbsp;<span class="op" id="3131576">*</span><span class="ident" id="3131577">state</span><span class="op" id="3131582">)</span>&nbsp;<span class="ident" id="3131584">evalField</span><span class="op" id="3131593">(</span><span class="ident" id="3131594">dot</span>&nbsp;<span class="ident" id="3131598">reflect</span><span class="op" id="3131605">.</span><span class="ident" id="3131606">Value</span><span class="op" id="3131611">,</span>&nbsp;<span class="ident" id="3131613">fieldName</span>&nbsp;<span class="builtintype" id="3131623">string</span><span class="op" id="3131629">,</span>&nbsp;<span class="ident" id="3131631">node</span>&nbsp;<span class="ident" id="3131636">parse</span><span class="op" id="3131641">.</span><span class="ident" id="3131642">Node</span><span class="op" id="3131646">,</span>&nbsp;<span class="ident" id="3131648">args</span>&nbsp;<span class="op" id="3131653">[</span><span class="op" id="3131654">]</span><span class="ident" id="3131655">parse</span><span class="op" id="3131660">.</span><span class="ident" id="3131661">Node</span><span class="op" id="3131665">,</span>&nbsp;<span class="ident" id="3131667">final</span><span class="op" id="3131672">,</span>&nbsp;<span class="ident" id="3131674">receiver</span>&nbsp;<span class="ident" id="3131683">reflect</span><span class="op" id="3131690">.</span><span class="ident" id="3131691">Value</span><span class="op" id="3131696">)</span>&nbsp;<span class="ident" id="3131698">reflect</span><span class="op" id="3131705">.</span><span class="ident" id="3131706">Value</span>&nbsp;<span class="op" id="3131712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131715">if</span>&nbsp;<span class="op" id="3131718">!</span><span class="ident" id="3131719">receiver</span><span class="op" id="3131727">.</span><span class="ident" id="3131728">IsValid</span><span class="op" id="3131735">(</span><span class="op" id="3131736">)</span>&nbsp;<span class="op" id="3131738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131742">return</span>&nbsp;<span class="ident" id="3131749">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3131755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131758">typ</span>&nbsp;<span class="op" id="3131762">:=</span>&nbsp;<span class="ident" id="3131765">receiver</span><span class="op" id="3131773">.</span><span class="ident" id="3131774">Type</span><span class="op" id="3131778">(</span><span class="op" id="3131779">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131782">receiver</span><span class="op" id="3131790">,</span>&nbsp;<span class="ident" id="3131792">_</span>&nbsp;<span class="op" id="3131794">=</span>&nbsp;<span class="ident" id="3131796">indirect</span><span class="op" id="3131804">(</span><span class="ident" id="3131805">receiver</span><span class="op" id="3131813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3131816">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3131893">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3131929">ptr</span>&nbsp;<span class="op" id="3131933">:=</span>&nbsp;<span class="ident" id="3131936">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3131946">if</span>&nbsp;<span class="ident" id="3131949">ptr</span><span class="op" id="3131952">.</span><span class="ident" id="3131953">Kind</span><span class="op" id="3131957">(</span><span class="op" id="3131958">)</span>&nbsp;<span class="op" id="3131960">!=</span>&nbsp;<span class="ident" id="3131963">reflect</span><span class="op" id="3131970">.</span><span class="ident" id="3131971">Interface</span>&nbsp;<span class="op" id="3131981">&amp;&amp;</span>&nbsp;<span class="ident" id="3131984">ptr</span><span class="op" id="3131987">.</span><span class="ident" id="3131988">CanAddr</span><span class="op" id="3131995">(</span><span class="op" id="3131996">)</span>&nbsp;<span class="op" id="3131998">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132002">ptr</span>&nbsp;<span class="op" id="3132006">=</span>&nbsp;<span class="ident" id="3132008">ptr</span><span class="op" id="3132011">.</span><span class="ident" id="3132012">Addr</span><span class="op" id="3132016">(</span><span class="op" id="3132017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132023">if</span>&nbsp;<span class="ident" id="3132026">method</span>&nbsp;<span class="op" id="3132033">:=</span>&nbsp;<span class="ident" id="3132036">ptr</span><span class="op" id="3132039">.</span><span class="ident" id="3132040">MethodByName</span><span class="op" id="3132052">(</span><span class="ident" id="3132053">fieldName</span><span class="op" id="3132062">)</span><span class="op" id="3132063">;</span>&nbsp;<span class="ident" id="3132065">method</span><span class="op" id="3132071">.</span><span class="ident" id="3132072">IsValid</span><span class="op" id="3132079">(</span><span class="op" id="3132080">)</span>&nbsp;<span class="op" id="3132082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132086">return</span>&nbsp;<span class="ident" id="3132093">s</span><span class="op" id="3132094">.</span><span class="ident" id="3132095">evalCall</span><span class="op" id="3132103">(</span><span class="ident" id="3132104">dot</span><span class="op" id="3132107">,</span>&nbsp;<span class="ident" id="3132109">method</span><span class="op" id="3132115">,</span>&nbsp;<span class="ident" id="3132117">node</span><span class="op" id="3132121">,</span>&nbsp;<span class="ident" id="3132123">fieldName</span><span class="op" id="3132132">,</span>&nbsp;<span class="ident" id="3132134">args</span><span class="op" id="3132138">,</span>&nbsp;<span class="ident" id="3132140">final</span><span class="op" id="3132145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132148">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132151">hasArgs</span>&nbsp;<span class="op" id="3132159">:=</span>&nbsp;<span class="builtinfunc" id="3132162">len</span><span class="op" id="3132165">(</span><span class="ident" id="3132166">args</span><span class="op" id="3132170">)</span>&nbsp;<span class="op" id="3132172">&gt;</span>&nbsp;<span class="num" id="3132174">1</span>&nbsp;<span class="op" id="3132176">||</span>&nbsp;<span class="ident" id="3132179">final</span><span class="op" id="3132184">.</span><span class="ident" id="3132185">IsValid</span><span class="op" id="3132192">(</span><span class="op" id="3132193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3132196">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132301">receiver</span><span class="op" id="3132309">,</span>&nbsp;<span class="ident" id="3132311">isNil</span>&nbsp;<span class="op" id="3132317">:=</span>&nbsp;<span class="ident" id="3132320">indirect</span><span class="op" id="3132328">(</span><span class="ident" id="3132329">receiver</span><span class="op" id="3132337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132340">if</span>&nbsp;<span class="ident" id="3132343">isNil</span>&nbsp;<span class="op" id="3132349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132353">s</span><span class="op" id="3132354">.</span><span class="ident" id="3132355">errorf</span><span class="op" id="3132361">(</span><span class="string" id="3132362">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="3132392">,</span>&nbsp;<span class="ident" id="3132394">typ</span><span class="op" id="3132397">,</span>&nbsp;<span class="ident" id="3132399">fieldName</span><span class="op" id="3132408">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132414">switch</span>&nbsp;<span class="ident" id="3132421">receiver</span><span class="op" id="3132429">.</span><span class="ident" id="3132430">Kind</span><span class="op" id="3132434">(</span><span class="op" id="3132435">)</span>&nbsp;<span class="op" id="3132437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132440">case</span>&nbsp;<span class="ident" id="3132445">reflect</span><span class="op" id="3132452">.</span><span class="ident" id="3132453">Struct</span><span class="op" id="3132459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132463">tField</span><span class="op" id="3132469">,</span>&nbsp;<span class="ident" id="3132471">ok</span>&nbsp;<span class="op" id="3132474">:=</span>&nbsp;<span class="ident" id="3132477">receiver</span><span class="op" id="3132485">.</span><span class="ident" id="3132486">Type</span><span class="op" id="3132490">(</span><span class="op" id="3132491">)</span><span class="op" id="3132492">.</span><span class="ident" id="3132493">FieldByName</span><span class="op" id="3132504">(</span><span class="ident" id="3132505">fieldName</span><span class="op" id="3132514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132518">if</span>&nbsp;<span class="ident" id="3132521">ok</span>&nbsp;<span class="op" id="3132524">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132529">field</span>&nbsp;<span class="op" id="3132535">:=</span>&nbsp;<span class="ident" id="3132538">receiver</span><span class="op" id="3132546">.</span><span class="ident" id="3132547">FieldByIndex</span><span class="op" id="3132559">(</span><span class="ident" id="3132560">tField</span><span class="op" id="3132566">.</span><span class="ident" id="3132567">Index</span><span class="op" id="3132572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132577">if</span>&nbsp;<span class="ident" id="3132580">tField</span><span class="op" id="3132586">.</span><span class="ident" id="3132587">PkgPath</span>&nbsp;<span class="op" id="3132595">!=</span>&nbsp;<span class="string" id="3132598">&#34;&#34;</span>&nbsp;<span class="op" id="3132601">{</span>&nbsp;<span class="comment" id="3132603">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132630">s</span><span class="op" id="3132631">.</span><span class="ident" id="3132632">errorf</span><span class="op" id="3132638">(</span><span class="string" id="3132639">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3132684">,</span>&nbsp;<span class="ident" id="3132686">fieldName</span><span class="op" id="3132695">,</span>&nbsp;<span class="ident" id="3132697">typ</span><span class="op" id="3132700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3132710">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132753">if</span>&nbsp;<span class="ident" id="3132756">hasArgs</span>&nbsp;<span class="op" id="3132764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132770">s</span><span class="op" id="3132771">.</span><span class="ident" id="3132772">errorf</span><span class="op" id="3132778">(</span><span class="string" id="3132779">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="3132831">,</span>&nbsp;<span class="ident" id="3132833">fieldName</span><span class="op" id="3132842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132852">return</span>&nbsp;<span class="ident" id="3132859">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3132867">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3132871">s</span><span class="op" id="3132872">.</span><span class="ident" id="3132873">errorf</span><span class="op" id="3132879">(</span><span class="string" id="3132880">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3132917">,</span>&nbsp;<span class="ident" id="3132919">fieldName</span><span class="op" id="3132928">,</span>&nbsp;<span class="ident" id="3132930">typ</span><span class="op" id="3132933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3132936">case</span>&nbsp;<span class="ident" id="3132941">reflect</span><span class="op" id="3132948">.</span><span class="ident" id="3132949">Map</span><span class="op" id="3132952">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3132956">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3133016">nameVal</span>&nbsp;<span class="op" id="3133024">:=</span>&nbsp;<span class="ident" id="3133027">reflect</span><span class="op" id="3133034">.</span><span class="ident" id="3133035">ValueOf</span><span class="op" id="3133042">(</span><span class="ident" id="3133043">fieldName</span><span class="op" id="3133052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3133056">if</span>&nbsp;<span class="ident" id="3133059">nameVal</span><span class="op" id="3133066">.</span><span class="ident" id="3133067">Type</span><span class="op" id="3133071">(</span><span class="op" id="3133072">)</span><span class="op" id="3133073">.</span><span class="ident" id="3133074">AssignableTo</span><span class="op" id="3133086">(</span><span class="ident" id="3133087">receiver</span><span class="op" id="3133095">.</span><span class="ident" id="3133096">Type</span><span class="op" id="3133100">(</span><span class="op" id="3133101">)</span><span class="op" id="3133102">.</span><span class="ident" id="3133103">Key</span><span class="op" id="3133106">(</span><span class="op" id="3133107">)</span><span class="op" id="3133108">)</span>&nbsp;<span class="op" id="3133110">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3133115">if</span>&nbsp;<span class="ident" id="3133118">hasArgs</span>&nbsp;<span class="op" id="3133126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3133132">s</span><span class="op" id="3133133">.</span><span class="ident" id="3133134">errorf</span><span class="op" id="3133140">(</span><span class="string" id="3133141">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="3133179">,</span>&nbsp;<span class="ident" id="3133181">fieldName</span><span class="op" id="3133190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3133195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3133200">return</span>&nbsp;<span class="ident" id="3133207">receiver</span><span class="op" id="3133215">.</span><span class="ident" id="3133216">MapIndex</span><span class="op" id="3133224">(</span><span class="ident" id="3133225">nameVal</span><span class="op" id="3133232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3133236">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3133239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3133242">s</span><span class="op" id="3133243">.</span><span class="ident" id="3133244">errorf</span><span class="op" id="3133250">(</span><span class="string" id="3133251">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3133287">,</span>&nbsp;<span class="ident" id="3133289">fieldName</span><span class="op" id="3133298">,</span>&nbsp;<span class="ident" id="3133300">typ</span><span class="op" id="3133303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3133306">panic</span><span class="op" id="3133311">(</span><span class="string" id="3133312">&#34;not&nbsp;reached&#34;</span><span class="op" id="3133325">)</span><br>
<span class="lineno"></span><span class="op" id="3133327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="3133330">var</span>&nbsp;<span class="op" id="3133334">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3133337">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3133353">=</span>&nbsp;<span class="ident" id="3133355">reflect</span><span class="op" id="3133362">.</span><span class="ident" id="3133363">TypeOf</span><span class="op" id="3133369">(</span><span class="op" id="3133370">(</span><span class="op" id="3133371">*</span><span class="builtintype" id="3133372">error</span><span class="op" id="3133377">)</span><span class="op" id="3133378">(</span><span class="ident" id="3133379">nil</span><span class="op" id="3133382">)</span><span class="op" id="3133383">)</span><span class="op" id="3133384">.</span><span class="ident" id="3133385">Elem</span><span class="op" id="3133389">(</span><span class="op" id="3133390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3133393">fmtStringerType</span>&nbsp;<span class="op" id="3133409">=</span>&nbsp;<span class="ident" id="3133411">reflect</span><span class="op" id="3133418">.</span><span class="ident" id="3133419">TypeOf</span><span class="op" id="3133425">(</span><span class="op" id="3133426">(</span><span class="op" id="3133427">*</span><span class="ident" id="3133428">fmt</span><span class="op" id="3133431">.</span><span class="ident" id="3133432">Stringer</span><span class="op" id="3133440">)</span><span class="op" id="3133441">(</span><span class="ident" id="3133442">nil</span><span class="op" id="3133445">)</span><span class="op" id="3133446">)</span><span class="op" id="3133447">.</span><span class="ident" id="3133448">Elem</span><span class="op" id="3133452">(</span><span class="op" id="3133453">)</span><br>
<span class="lineno"></span><span class="op" id="3133455">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="3133458">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="3133563">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="3133675">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="3133702">func</span>&nbsp;<span class="op" id="3133707">(</span><span class="ident" id="3133708">s</span>&nbsp;<span class="op" id="3133710">*</span><span class="ident" id="3133711">state</span><span class="op" id="3133716">)</span>&nbsp;<span class="ident" id="3133718">evalCall</span><span class="op" id="3133726">(</span><span class="ident" id="3133727">dot</span><span class="op" id="3133730">,</span>&nbsp;<span class="ident" id="3133732">fun</span>&nbsp;<span class="ident" id="3133736">reflect</span><span class="op" id="3133743">.</span><span class="ident" id="3133744">Value</span><span class="op" id="3133749">,</span>&nbsp;<span class="ident" id="3133751">node</span>&nbsp;<span class="ident" id="3133756">parse</span><span class="op" id="3133761">.</span><span class="ident" id="3133762">Node</span><span class="op" id="3133766">,</span>&nbsp;<span class="ident" id="3133768">name</span>&nbsp;<span class="builtintype" id="3133773">string</span><span class="op" id="3133779">,</span>&nbsp;<span class="ident" id="3133781">args</span>&nbsp;<span class="op" id="3133786">[</span><span class="op" id="3133787">]</span><span class="ident" id="3133788">parse</span><span class="op" id="3133793">.</span><span class="ident" id="3133794">Node</span><span class="op" id="3133798">,</span>&nbsp;<span class="ident" id="3133800">final</span>&nbsp;<span class="ident" id="3133806">reflect</span><span class="op" id="3133813">.</span><span class="ident" id="3133814">Value</span><span class="op" id="3133819">)</span>&nbsp;<span class="ident" id="3133821">reflect</span><span class="op" id="3133828">.</span><span class="ident" id="3133829">Value</span>&nbsp;<span class="op" id="3133835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3133838">if</span>&nbsp;<span class="ident" id="3133841">args</span>&nbsp;<span class="op" id="3133846">!=</span>&nbsp;<span class="ident" id="3133849">nil</span>&nbsp;<span class="op" id="3133853">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3133857">args</span>&nbsp;<span class="op" id="3133862">=</span>&nbsp;<span class="ident" id="3133864">args</span><span class="op" id="3133868">[</span><span class="num" id="3133869">1</span><span class="op" id="3133870">:</span><span class="op" id="3133871">]</span>&nbsp;<span class="comment" id="3133873">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3133935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3133938">typ</span>&nbsp;<span class="op" id="3133942">:=</span>&nbsp;<span class="ident" id="3133945">fun</span><span class="op" id="3133948">.</span><span class="ident" id="3133949">Type</span><span class="op" id="3133953">(</span><span class="op" id="3133954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3133957">numIn</span>&nbsp;<span class="op" id="3133963">:=</span>&nbsp;<span class="builtinfunc" id="3133966">len</span><span class="op" id="3133969">(</span><span class="ident" id="3133970">args</span><span class="op" id="3133974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3133977">if</span>&nbsp;<span class="ident" id="3133980">final</span><span class="op" id="3133985">.</span><span class="ident" id="3133986">IsValid</span><span class="op" id="3133993">(</span><span class="op" id="3133994">)</span>&nbsp;<span class="op" id="3133996">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134000">numIn</span><span class="op" id="3134005">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3134009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134012">numFixed</span>&nbsp;<span class="op" id="3134021">:=</span>&nbsp;<span class="builtinfunc" id="3134024">len</span><span class="op" id="3134027">(</span><span class="ident" id="3134028">args</span><span class="op" id="3134032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3134035">if</span>&nbsp;<span class="ident" id="3134038">typ</span><span class="op" id="3134041">.</span><span class="ident" id="3134042">IsVariadic</span><span class="op" id="3134052">(</span><span class="op" id="3134053">)</span>&nbsp;<span class="op" id="3134055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134059">numFixed</span>&nbsp;<span class="op" id="3134068">=</span>&nbsp;<span class="ident" id="3134070">typ</span><span class="op" id="3134073">.</span><span class="ident" id="3134074">NumIn</span><span class="op" id="3134079">(</span><span class="op" id="3134080">)</span>&nbsp;<span class="op" id="3134082">-</span>&nbsp;<span class="num" id="3134084">1</span>&nbsp;<span class="comment" id="3134086">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3134121">if</span>&nbsp;<span class="ident" id="3134124">numIn</span>&nbsp;<span class="op" id="3134130">&lt;</span>&nbsp;<span class="ident" id="3134132">numFixed</span>&nbsp;<span class="op" id="3134141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134146">s</span><span class="op" id="3134147">.</span><span class="ident" id="3134148">errorf</span><span class="op" id="3134154">(</span><span class="string" id="3134155">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3134209">,</span>&nbsp;<span class="ident" id="3134211">name</span><span class="op" id="3134215">,</span>&nbsp;<span class="ident" id="3134217">typ</span><span class="op" id="3134220">.</span><span class="ident" id="3134221">NumIn</span><span class="op" id="3134226">(</span><span class="op" id="3134227">)</span><span class="op" id="3134228">-</span><span class="num" id="3134229">1</span><span class="op" id="3134230">,</span>&nbsp;<span class="builtinfunc" id="3134232">len</span><span class="op" id="3134235">(</span><span class="ident" id="3134236">args</span><span class="op" id="3134240">)</span><span class="op" id="3134241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3134245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3134248">}</span>&nbsp;<span class="keyword" id="3134250">else</span>&nbsp;<span class="keyword" id="3134255">if</span>&nbsp;<span class="ident" id="3134258">numIn</span>&nbsp;<span class="op" id="3134264">&lt;</span>&nbsp;<span class="ident" id="3134266">typ</span><span class="op" id="3134269">.</span><span class="ident" id="3134270">NumIn</span><span class="op" id="3134275">(</span><span class="op" id="3134276">)</span><span class="op" id="3134277">-</span><span class="num" id="3134278">1</span>&nbsp;<span class="op" id="3134280">||</span>&nbsp;<span class="op" id="3134283">!</span><span class="ident" id="3134284">typ</span><span class="op" id="3134287">.</span><span class="ident" id="3134288">IsVariadic</span><span class="op" id="3134298">(</span><span class="op" id="3134299">)</span>&nbsp;<span class="op" id="3134301">&amp;&amp;</span>&nbsp;<span class="ident" id="3134304">numIn</span>&nbsp;<span class="op" id="3134310">!=</span>&nbsp;<span class="ident" id="3134313">typ</span><span class="op" id="3134316">.</span><span class="ident" id="3134317">NumIn</span><span class="op" id="3134322">(</span><span class="op" id="3134323">)</span>&nbsp;<span class="op" id="3134325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134329">s</span><span class="op" id="3134330">.</span><span class="ident" id="3134331">errorf</span><span class="op" id="3134337">(</span><span class="string" id="3134338">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3134383">,</span>&nbsp;<span class="ident" id="3134385">name</span><span class="op" id="3134389">,</span>&nbsp;<span class="ident" id="3134391">typ</span><span class="op" id="3134394">.</span><span class="ident" id="3134395">NumIn</span><span class="op" id="3134400">(</span><span class="op" id="3134401">)</span><span class="op" id="3134402">,</span>&nbsp;<span class="builtinfunc" id="3134404">len</span><span class="op" id="3134407">(</span><span class="ident" id="3134408">args</span><span class="op" id="3134412">)</span><span class="op" id="3134413">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3134416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3134419">if</span>&nbsp;<span class="op" id="3134422">!</span><span class="ident" id="3134423">goodFunc</span><span class="op" id="3134431">(</span><span class="ident" id="3134432">typ</span><span class="op" id="3134435">)</span>&nbsp;<span class="op" id="3134437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3134441">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134527">s</span><span class="op" id="3134528">.</span><span class="ident" id="3134529">errorf</span><span class="op" id="3134535">(</span><span class="string" id="3134536">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="3134583">,</span>&nbsp;<span class="ident" id="3134585">name</span><span class="op" id="3134589">,</span>&nbsp;<span class="ident" id="3134591">typ</span><span class="op" id="3134594">.</span><span class="ident" id="3134595">NumOut</span><span class="op" id="3134601">(</span><span class="op" id="3134602">)</span><span class="op" id="3134603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3134606">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3134609">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134633">argv</span>&nbsp;<span class="op" id="3134638">:=</span>&nbsp;<span class="builtinfunc" id="3134641">make</span><span class="op" id="3134645">(</span><span class="op" id="3134646">[</span><span class="op" id="3134647">]</span><span class="ident" id="3134648">reflect</span><span class="op" id="3134655">.</span><span class="ident" id="3134656">Value</span><span class="op" id="3134661">,</span>&nbsp;<span class="ident" id="3134663">numIn</span><span class="op" id="3134668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3134671">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134717">i</span>&nbsp;<span class="op" id="3134719">:=</span>&nbsp;<span class="num" id="3134722">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3134725">for</span>&nbsp;<span class="op" id="3134729">;</span>&nbsp;<span class="ident" id="3134731">i</span>&nbsp;<span class="op" id="3134733">&lt;</span>&nbsp;<span class="ident" id="3134735">numFixed</span>&nbsp;<span class="op" id="3134744">&amp;&amp;</span>&nbsp;<span class="ident" id="3134747">i</span>&nbsp;<span class="op" id="3134749">&lt;</span>&nbsp;<span class="builtinfunc" id="3134751">len</span><span class="op" id="3134754">(</span><span class="ident" id="3134755">args</span><span class="op" id="3134759">)</span><span class="op" id="3134760">;</span>&nbsp;<span class="ident" id="3134762">i</span><span class="op" id="3134763">++</span>&nbsp;<span class="op" id="3134766">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134770">argv</span><span class="op" id="3134774">[</span><span class="ident" id="3134775">i</span><span class="op" id="3134776">]</span>&nbsp;<span class="op" id="3134778">=</span>&nbsp;<span class="ident" id="3134780">s</span><span class="op" id="3134781">.</span><span class="ident" id="3134782">evalArg</span><span class="op" id="3134789">(</span><span class="ident" id="3134790">dot</span><span class="op" id="3134793">,</span>&nbsp;<span class="ident" id="3134795">typ</span><span class="op" id="3134798">.</span><span class="ident" id="3134799">In</span><span class="op" id="3134801">(</span><span class="ident" id="3134802">i</span><span class="op" id="3134803">)</span><span class="op" id="3134804">,</span>&nbsp;<span class="ident" id="3134806">args</span><span class="op" id="3134810">[</span><span class="ident" id="3134811">i</span><span class="op" id="3134812">]</span><span class="op" id="3134813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3134816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3134819">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3134841">if</span>&nbsp;<span class="ident" id="3134844">typ</span><span class="op" id="3134847">.</span><span class="ident" id="3134848">IsVariadic</span><span class="op" id="3134858">(</span><span class="op" id="3134859">)</span>&nbsp;<span class="op" id="3134861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134865">argType</span>&nbsp;<span class="op" id="3134873">:=</span>&nbsp;<span class="ident" id="3134876">typ</span><span class="op" id="3134879">.</span><span class="ident" id="3134880">In</span><span class="op" id="3134882">(</span><span class="ident" id="3134883">typ</span><span class="op" id="3134886">.</span><span class="ident" id="3134887">NumIn</span><span class="op" id="3134892">(</span><span class="op" id="3134893">)</span>&nbsp;<span class="op" id="3134895">-</span>&nbsp;<span class="num" id="3134897">1</span><span class="op" id="3134898">)</span><span class="op" id="3134899">.</span><span class="ident" id="3134900">Elem</span><span class="op" id="3134904">(</span><span class="op" id="3134905">)</span>&nbsp;<span class="comment" id="3134907">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3134933">for</span>&nbsp;<span class="op" id="3134937">;</span>&nbsp;<span class="ident" id="3134939">i</span>&nbsp;<span class="op" id="3134941">&lt;</span>&nbsp;<span class="builtinfunc" id="3134943">len</span><span class="op" id="3134946">(</span><span class="ident" id="3134947">args</span><span class="op" id="3134951">)</span><span class="op" id="3134952">;</span>&nbsp;<span class="ident" id="3134954">i</span><span class="op" id="3134955">++</span>&nbsp;<span class="op" id="3134958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3134963">argv</span><span class="op" id="3134967">[</span><span class="ident" id="3134968">i</span><span class="op" id="3134969">]</span>&nbsp;<span class="op" id="3134971">=</span>&nbsp;<span class="ident" id="3134973">s</span><span class="op" id="3134974">.</span><span class="ident" id="3134975">evalArg</span><span class="op" id="3134982">(</span><span class="ident" id="3134983">dot</span><span class="op" id="3134986">,</span>&nbsp;<span class="ident" id="3134988">argType</span><span class="op" id="3134995">,</span>&nbsp;<span class="ident" id="3134997">args</span><span class="op" id="3135001">[</span><span class="ident" id="3135002">i</span><span class="op" id="3135003">]</span><span class="op" id="3135004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3135008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3135011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3135014">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135048">if</span>&nbsp;<span class="ident" id="3135051">final</span><span class="op" id="3135056">.</span><span class="ident" id="3135057">IsValid</span><span class="op" id="3135064">(</span><span class="op" id="3135065">)</span>&nbsp;<span class="op" id="3135067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3135071">t</span>&nbsp;<span class="op" id="3135073">:=</span>&nbsp;<span class="ident" id="3135076">typ</span><span class="op" id="3135079">.</span><span class="ident" id="3135080">In</span><span class="op" id="3135082">(</span><span class="ident" id="3135083">typ</span><span class="op" id="3135086">.</span><span class="ident" id="3135087">NumIn</span><span class="op" id="3135092">(</span><span class="op" id="3135093">)</span>&nbsp;<span class="op" id="3135095">-</span>&nbsp;<span class="num" id="3135097">1</span><span class="op" id="3135098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135102">if</span>&nbsp;<span class="ident" id="3135105">typ</span><span class="op" id="3135108">.</span><span class="ident" id="3135109">IsVariadic</span><span class="op" id="3135119">(</span><span class="op" id="3135120">)</span>&nbsp;<span class="op" id="3135122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3135127">t</span>&nbsp;<span class="op" id="3135129">=</span>&nbsp;<span class="ident" id="3135131">t</span><span class="op" id="3135132">.</span><span class="ident" id="3135133">Elem</span><span class="op" id="3135137">(</span><span class="op" id="3135138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3135142">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3135146">argv</span><span class="op" id="3135150">[</span><span class="ident" id="3135151">i</span><span class="op" id="3135152">]</span>&nbsp;<span class="op" id="3135154">=</span>&nbsp;<span class="ident" id="3135156">s</span><span class="op" id="3135157">.</span><span class="ident" id="3135158">validateType</span><span class="op" id="3135170">(</span><span class="ident" id="3135171">final</span><span class="op" id="3135176">,</span>&nbsp;<span class="ident" id="3135178">t</span><span class="op" id="3135179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3135182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3135185">result</span>&nbsp;<span class="op" id="3135192">:=</span>&nbsp;<span class="ident" id="3135195">fun</span><span class="op" id="3135198">.</span><span class="ident" id="3135199">Call</span><span class="op" id="3135203">(</span><span class="ident" id="3135204">argv</span><span class="op" id="3135208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3135211">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135304">if</span>&nbsp;<span class="builtinfunc" id="3135307">len</span><span class="op" id="3135310">(</span><span class="ident" id="3135311">result</span><span class="op" id="3135317">)</span>&nbsp;<span class="op" id="3135319">==</span>&nbsp;<span class="num" id="3135322">2</span>&nbsp;<span class="op" id="3135324">&amp;&amp;</span>&nbsp;<span class="op" id="3135327">!</span><span class="ident" id="3135328">result</span><span class="op" id="3135334">[</span><span class="num" id="3135335">1</span><span class="op" id="3135336">]</span><span class="op" id="3135337">.</span><span class="ident" id="3135338">IsNil</span><span class="op" id="3135343">(</span><span class="op" id="3135344">)</span>&nbsp;<span class="op" id="3135346">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3135350">s</span><span class="op" id="3135351">.</span><span class="ident" id="3135352">at</span><span class="op" id="3135354">(</span><span class="ident" id="3135355">node</span><span class="op" id="3135359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3135363">s</span><span class="op" id="3135364">.</span><span class="ident" id="3135365">errorf</span><span class="op" id="3135371">(</span><span class="string" id="3135372">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3135394">,</span>&nbsp;<span class="ident" id="3135396">name</span><span class="op" id="3135400">,</span>&nbsp;<span class="ident" id="3135402">result</span><span class="op" id="3135408">[</span><span class="num" id="3135409">1</span><span class="op" id="3135410">]</span><span class="op" id="3135411">.</span><span class="ident" id="3135412">Interface</span><span class="op" id="3135421">(</span><span class="op" id="3135422">)</span><span class="op" id="3135423">.</span><span class="op" id="3135424">(</span><span class="builtintype" id="3135425">error</span><span class="op" id="3135430">)</span><span class="op" id="3135431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3135434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135437">return</span>&nbsp;<span class="ident" id="3135444">result</span><span class="op" id="3135450">[</span><span class="num" id="3135451">0</span><span class="op" id="3135452">]</span><br>
<span class="lineno"></span><span class="op" id="3135454">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3135457">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3135547">func</span>&nbsp;<span class="ident" id="3135552">canBeNil</span><span class="op" id="3135560">(</span><span class="ident" id="3135561">typ</span>&nbsp;<span class="ident" id="3135565">reflect</span><span class="op" id="3135572">.</span><span class="ident" id="3135573">Type</span><span class="op" id="3135577">)</span>&nbsp;<span class="builtintype" id="3135579">bool</span>&nbsp;<span class="op" id="3135584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135587">switch</span>&nbsp;<span class="ident" id="3135594">typ</span><span class="op" id="3135597">.</span><span class="ident" id="3135598">Kind</span><span class="op" id="3135602">(</span><span class="op" id="3135603">)</span>&nbsp;<span class="op" id="3135605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135608">case</span>&nbsp;<span class="ident" id="3135613">reflect</span><span class="op" id="3135620">.</span><span class="ident" id="3135621">Chan</span><span class="op" id="3135625">,</span>&nbsp;<span class="ident" id="3135627">reflect</span><span class="op" id="3135634">.</span><span class="ident" id="3135635">Func</span><span class="op" id="3135639">,</span>&nbsp;<span class="ident" id="3135641">reflect</span><span class="op" id="3135648">.</span><span class="ident" id="3135649">Interface</span><span class="op" id="3135658">,</span>&nbsp;<span class="ident" id="3135660">reflect</span><span class="op" id="3135667">.</span><span class="ident" id="3135668">Map</span><span class="op" id="3135671">,</span>&nbsp;<span class="ident" id="3135673">reflect</span><span class="op" id="3135680">.</span><span class="ident" id="3135681">Ptr</span><span class="op" id="3135684">,</span>&nbsp;<span class="ident" id="3135686">reflect</span><span class="op" id="3135693">.</span><span class="ident" id="3135694">Slice</span><span class="op" id="3135699">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135703">return</span>&nbsp;<span class="builtintype" id="3135710">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3135716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135719">return</span>&nbsp;<span class="builtintype" id="3135726">false</span><br>
<span class="lineno"></span><span class="op" id="3135732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="3135735">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3135814">func</span>&nbsp;<span class="op" id="3135819">(</span><span class="ident" id="3135820">s</span>&nbsp;<span class="op" id="3135822">*</span><span class="ident" id="3135823">state</span><span class="op" id="3135828">)</span>&nbsp;<span class="ident" id="3135830">validateType</span><span class="op" id="3135842">(</span><span class="ident" id="3135843">value</span>&nbsp;<span class="ident" id="3135849">reflect</span><span class="op" id="3135856">.</span><span class="ident" id="3135857">Value</span><span class="op" id="3135862">,</span>&nbsp;<span class="ident" id="3135864">typ</span>&nbsp;<span class="ident" id="3135868">reflect</span><span class="op" id="3135875">.</span><span class="ident" id="3135876">Type</span><span class="op" id="3135880">)</span>&nbsp;<span class="ident" id="3135882">reflect</span><span class="op" id="3135889">.</span><span class="ident" id="3135890">Value</span>&nbsp;<span class="op" id="3135896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135899">if</span>&nbsp;<span class="op" id="3135902">!</span><span class="ident" id="3135903">value</span><span class="op" id="3135908">.</span><span class="ident" id="3135909">IsValid</span><span class="op" id="3135916">(</span><span class="op" id="3135917">)</span>&nbsp;<span class="op" id="3135919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3135923">if</span>&nbsp;<span class="ident" id="3135926">typ</span>&nbsp;<span class="op" id="3135930">==</span>&nbsp;<span class="ident" id="3135933">nil</span>&nbsp;<span class="op" id="3135937">||</span>&nbsp;<span class="ident" id="3135940">canBeNil</span><span class="op" id="3135948">(</span><span class="ident" id="3135949">typ</span><span class="op" id="3135952">)</span>&nbsp;<span class="op" id="3135954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3135959">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136023">return</span>&nbsp;<span class="ident" id="3136030">reflect</span><span class="op" id="3136037">.</span><span class="ident" id="3136038">Zero</span><span class="op" id="3136042">(</span><span class="ident" id="3136043">typ</span><span class="op" id="3136046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3136050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3136054">s</span><span class="op" id="3136055">.</span><span class="ident" id="3136056">errorf</span><span class="op" id="3136062">(</span><span class="string" id="3136063">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="3136091">,</span>&nbsp;<span class="ident" id="3136093">typ</span><span class="op" id="3136096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3136099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136102">if</span>&nbsp;<span class="ident" id="3136105">typ</span>&nbsp;<span class="op" id="3136109">!=</span>&nbsp;<span class="ident" id="3136112">nil</span>&nbsp;<span class="op" id="3136116">&amp;&amp;</span>&nbsp;<span class="op" id="3136119">!</span><span class="ident" id="3136120">value</span><span class="op" id="3136125">.</span><span class="ident" id="3136126">Type</span><span class="op" id="3136130">(</span><span class="op" id="3136131">)</span><span class="op" id="3136132">.</span><span class="ident" id="3136133">AssignableTo</span><span class="op" id="3136145">(</span><span class="ident" id="3136146">typ</span><span class="op" id="3136149">)</span>&nbsp;<span class="op" id="3136151">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136155">if</span>&nbsp;<span class="ident" id="3136158">value</span><span class="op" id="3136163">.</span><span class="ident" id="3136164">Kind</span><span class="op" id="3136168">(</span><span class="op" id="3136169">)</span>&nbsp;<span class="op" id="3136171">==</span>&nbsp;<span class="ident" id="3136174">reflect</span><span class="op" id="3136181">.</span><span class="ident" id="3136182">Interface</span>&nbsp;<span class="op" id="3136192">&amp;&amp;</span>&nbsp;<span class="op" id="3136195">!</span><span class="ident" id="3136196">value</span><span class="op" id="3136201">.</span><span class="ident" id="3136202">IsNil</span><span class="op" id="3136207">(</span><span class="op" id="3136208">)</span>&nbsp;<span class="op" id="3136210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3136215">value</span>&nbsp;<span class="op" id="3136221">=</span>&nbsp;<span class="ident" id="3136223">value</span><span class="op" id="3136228">.</span><span class="ident" id="3136229">Elem</span><span class="op" id="3136233">(</span><span class="op" id="3136234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136239">if</span>&nbsp;<span class="ident" id="3136242">value</span><span class="op" id="3136247">.</span><span class="ident" id="3136248">Type</span><span class="op" id="3136252">(</span><span class="op" id="3136253">)</span><span class="op" id="3136254">.</span><span class="ident" id="3136255">AssignableTo</span><span class="op" id="3136267">(</span><span class="ident" id="3136268">typ</span><span class="op" id="3136271">)</span>&nbsp;<span class="op" id="3136273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136279">return</span>&nbsp;<span class="ident" id="3136286">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3136295">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3136300">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3136317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3136321">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3136392">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3136464">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3136536">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136585">switch</span>&nbsp;<span class="op" id="3136592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136596">case</span>&nbsp;<span class="ident" id="3136601">value</span><span class="op" id="3136606">.</span><span class="ident" id="3136607">Kind</span><span class="op" id="3136611">(</span><span class="op" id="3136612">)</span>&nbsp;<span class="op" id="3136614">==</span>&nbsp;<span class="ident" id="3136617">reflect</span><span class="op" id="3136624">.</span><span class="ident" id="3136625">Ptr</span>&nbsp;<span class="op" id="3136629">&amp;&amp;</span>&nbsp;<span class="ident" id="3136632">value</span><span class="op" id="3136637">.</span><span class="ident" id="3136638">Type</span><span class="op" id="3136642">(</span><span class="op" id="3136643">)</span><span class="op" id="3136644">.</span><span class="ident" id="3136645">Elem</span><span class="op" id="3136649">(</span><span class="op" id="3136650">)</span><span class="op" id="3136651">.</span><span class="ident" id="3136652">AssignableTo</span><span class="op" id="3136664">(</span><span class="ident" id="3136665">typ</span><span class="op" id="3136668">)</span><span class="op" id="3136669">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3136674">value</span>&nbsp;<span class="op" id="3136680">=</span>&nbsp;<span class="ident" id="3136682">value</span><span class="op" id="3136687">.</span><span class="ident" id="3136688">Elem</span><span class="op" id="3136692">(</span><span class="op" id="3136693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136698">if</span>&nbsp;<span class="op" id="3136701">!</span><span class="ident" id="3136702">value</span><span class="op" id="3136707">.</span><span class="ident" id="3136708">IsValid</span><span class="op" id="3136715">(</span><span class="op" id="3136716">)</span>&nbsp;<span class="op" id="3136718">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3136724">s</span><span class="op" id="3136725">.</span><span class="ident" id="3136726">errorf</span><span class="op" id="3136732">(</span><span class="string" id="3136733">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3136772">,</span>&nbsp;<span class="ident" id="3136774">typ</span><span class="op" id="3136777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3136782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136786">case</span>&nbsp;<span class="ident" id="3136791">reflect</span><span class="op" id="3136798">.</span><span class="ident" id="3136799">PtrTo</span><span class="op" id="3136804">(</span><span class="ident" id="3136805">value</span><span class="op" id="3136810">.</span><span class="ident" id="3136811">Type</span><span class="op" id="3136815">(</span><span class="op" id="3136816">)</span><span class="op" id="3136817">)</span><span class="op" id="3136818">.</span><span class="ident" id="3136819">AssignableTo</span><span class="op" id="3136831">(</span><span class="ident" id="3136832">typ</span><span class="op" id="3136835">)</span>&nbsp;<span class="op" id="3136837">&amp;&amp;</span>&nbsp;<span class="ident" id="3136840">value</span><span class="op" id="3136845">.</span><span class="ident" id="3136846">CanAddr</span><span class="op" id="3136853">(</span><span class="op" id="3136854">)</span><span class="op" id="3136855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3136860">value</span>&nbsp;<span class="op" id="3136866">=</span>&nbsp;<span class="ident" id="3136868">value</span><span class="op" id="3136873">.</span><span class="ident" id="3136874">Addr</span><span class="op" id="3136878">(</span><span class="op" id="3136879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136883">default</span><span class="op" id="3136890">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3136895">s</span><span class="op" id="3136896">.</span><span class="ident" id="3136897">errorf</span><span class="op" id="3136903">(</span><span class="string" id="3136904">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="3136947">,</span>&nbsp;<span class="ident" id="3136949">typ</span><span class="op" id="3136952">,</span>&nbsp;<span class="ident" id="3136954">value</span><span class="op" id="3136959">.</span><span class="ident" id="3136960">Type</span><span class="op" id="3136964">(</span><span class="op" id="3136965">)</span><span class="op" id="3136966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3136970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3136973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3136976">return</span>&nbsp;<span class="ident" id="3136983">value</span><br>
<span class="lineno"></span><span class="op" id="3136989">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="3136992">func</span>&nbsp;<span class="op" id="3136997">(</span><span class="ident" id="3136998">s</span>&nbsp;<span class="op" id="3137000">*</span><span class="ident" id="3137001">state</span><span class="op" id="3137006">)</span>&nbsp;<span class="ident" id="3137008">evalArg</span><span class="op" id="3137015">(</span><span class="ident" id="3137016">dot</span>&nbsp;<span class="ident" id="3137020">reflect</span><span class="op" id="3137027">.</span><span class="ident" id="3137028">Value</span><span class="op" id="3137033">,</span>&nbsp;<span class="ident" id="3137035">typ</span>&nbsp;<span class="ident" id="3137039">reflect</span><span class="op" id="3137046">.</span><span class="ident" id="3137047">Type</span><span class="op" id="3137051">,</span>&nbsp;<span class="ident" id="3137053">n</span>&nbsp;<span class="ident" id="3137055">parse</span><span class="op" id="3137060">.</span><span class="ident" id="3137061">Node</span><span class="op" id="3137065">)</span>&nbsp;<span class="ident" id="3137067">reflect</span><span class="op" id="3137074">.</span><span class="ident" id="3137075">Value</span>&nbsp;<span class="op" id="3137081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3137084">s</span><span class="op" id="3137085">.</span><span class="ident" id="3137086">at</span><span class="op" id="3137088">(</span><span class="ident" id="3137089">n</span><span class="op" id="3137090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137093">switch</span>&nbsp;<span class="ident" id="3137100">arg</span>&nbsp;<span class="op" id="3137104">:=</span>&nbsp;<span class="ident" id="3137107">n</span><span class="op" id="3137108">.</span><span class="op" id="3137109">(</span><span class="keyword" id="3137110">type</span><span class="op" id="3137114">)</span>&nbsp;<span class="op" id="3137116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137119">case</span>&nbsp;<span class="op" id="3137124">*</span><span class="ident" id="3137125">parse</span><span class="op" id="3137130">.</span><span class="ident" id="3137131">DotNode</span><span class="op" id="3137138">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137142">return</span>&nbsp;<span class="ident" id="3137149">s</span><span class="op" id="3137150">.</span><span class="ident" id="3137151">validateType</span><span class="op" id="3137163">(</span><span class="ident" id="3137164">dot</span><span class="op" id="3137167">,</span>&nbsp;<span class="ident" id="3137169">typ</span><span class="op" id="3137172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137175">case</span>&nbsp;<span class="op" id="3137180">*</span><span class="ident" id="3137181">parse</span><span class="op" id="3137186">.</span><span class="ident" id="3137187">NilNode</span><span class="op" id="3137194">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137198">if</span>&nbsp;<span class="ident" id="3137201">canBeNil</span><span class="op" id="3137209">(</span><span class="ident" id="3137210">typ</span><span class="op" id="3137213">)</span>&nbsp;<span class="op" id="3137215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137220">return</span>&nbsp;<span class="ident" id="3137227">reflect</span><span class="op" id="3137234">.</span><span class="ident" id="3137235">Zero</span><span class="op" id="3137239">(</span><span class="ident" id="3137240">typ</span><span class="op" id="3137243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3137247">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3137251">s</span><span class="op" id="3137252">.</span><span class="ident" id="3137253">errorf</span><span class="op" id="3137259">(</span><span class="string" id="3137260">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="3137285">,</span>&nbsp;<span class="ident" id="3137287">typ</span><span class="op" id="3137290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137293">case</span>&nbsp;<span class="op" id="3137298">*</span><span class="ident" id="3137299">parse</span><span class="op" id="3137304">.</span><span class="ident" id="3137305">FieldNode</span><span class="op" id="3137314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137318">return</span>&nbsp;<span class="ident" id="3137325">s</span><span class="op" id="3137326">.</span><span class="ident" id="3137327">validateType</span><span class="op" id="3137339">(</span><span class="ident" id="3137340">s</span><span class="op" id="3137341">.</span><span class="ident" id="3137342">evalFieldNode</span><span class="op" id="3137355">(</span><span class="ident" id="3137356">dot</span><span class="op" id="3137359">,</span>&nbsp;<span class="ident" id="3137361">arg</span><span class="op" id="3137364">,</span>&nbsp;<span class="op" id="3137366">[</span><span class="op" id="3137367">]</span><span class="ident" id="3137368">parse</span><span class="op" id="3137373">.</span><span class="ident" id="3137374">Node</span><span class="op" id="3137378">{</span><span class="ident" id="3137379">n</span><span class="op" id="3137380">}</span><span class="op" id="3137381">,</span>&nbsp;<span class="ident" id="3137383">zero</span><span class="op" id="3137387">)</span><span class="op" id="3137388">,</span>&nbsp;<span class="ident" id="3137390">typ</span><span class="op" id="3137393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137396">case</span>&nbsp;<span class="op" id="3137401">*</span><span class="ident" id="3137402">parse</span><span class="op" id="3137407">.</span><span class="ident" id="3137408">VariableNode</span><span class="op" id="3137420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137424">return</span>&nbsp;<span class="ident" id="3137431">s</span><span class="op" id="3137432">.</span><span class="ident" id="3137433">validateType</span><span class="op" id="3137445">(</span><span class="ident" id="3137446">s</span><span class="op" id="3137447">.</span><span class="ident" id="3137448">evalVariableNode</span><span class="op" id="3137464">(</span><span class="ident" id="3137465">dot</span><span class="op" id="3137468">,</span>&nbsp;<span class="ident" id="3137470">arg</span><span class="op" id="3137473">,</span>&nbsp;<span class="ident" id="3137475">nil</span><span class="op" id="3137478">,</span>&nbsp;<span class="ident" id="3137480">zero</span><span class="op" id="3137484">)</span><span class="op" id="3137485">,</span>&nbsp;<span class="ident" id="3137487">typ</span><span class="op" id="3137490">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137493">case</span>&nbsp;<span class="op" id="3137498">*</span><span class="ident" id="3137499">parse</span><span class="op" id="3137504">.</span><span class="ident" id="3137505">PipeNode</span><span class="op" id="3137513">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137517">return</span>&nbsp;<span class="ident" id="3137524">s</span><span class="op" id="3137525">.</span><span class="ident" id="3137526">validateType</span><span class="op" id="3137538">(</span><span class="ident" id="3137539">s</span><span class="op" id="3137540">.</span><span class="ident" id="3137541">evalPipeline</span><span class="op" id="3137553">(</span><span class="ident" id="3137554">dot</span><span class="op" id="3137557">,</span>&nbsp;<span class="ident" id="3137559">arg</span><span class="op" id="3137562">)</span><span class="op" id="3137563">,</span>&nbsp;<span class="ident" id="3137565">typ</span><span class="op" id="3137568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137571">case</span>&nbsp;<span class="op" id="3137576">*</span><span class="ident" id="3137577">parse</span><span class="op" id="3137582">.</span><span class="ident" id="3137583">IdentifierNode</span><span class="op" id="3137597">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137601">return</span>&nbsp;<span class="ident" id="3137608">s</span><span class="op" id="3137609">.</span><span class="ident" id="3137610">evalFunction</span><span class="op" id="3137622">(</span><span class="ident" id="3137623">dot</span><span class="op" id="3137626">,</span>&nbsp;<span class="ident" id="3137628">arg</span><span class="op" id="3137631">,</span>&nbsp;<span class="ident" id="3137633">arg</span><span class="op" id="3137636">,</span>&nbsp;<span class="ident" id="3137638">nil</span><span class="op" id="3137641">,</span>&nbsp;<span class="ident" id="3137643">zero</span><span class="op" id="3137647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137650">case</span>&nbsp;<span class="op" id="3137655">*</span><span class="ident" id="3137656">parse</span><span class="op" id="3137661">.</span><span class="ident" id="3137662">ChainNode</span><span class="op" id="3137671">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137675">return</span>&nbsp;<span class="ident" id="3137682">s</span><span class="op" id="3137683">.</span><span class="ident" id="3137684">validateType</span><span class="op" id="3137696">(</span><span class="ident" id="3137697">s</span><span class="op" id="3137698">.</span><span class="ident" id="3137699">evalChainNode</span><span class="op" id="3137712">(</span><span class="ident" id="3137713">dot</span><span class="op" id="3137716">,</span>&nbsp;<span class="ident" id="3137718">arg</span><span class="op" id="3137721">,</span>&nbsp;<span class="ident" id="3137723">nil</span><span class="op" id="3137726">,</span>&nbsp;<span class="ident" id="3137728">zero</span><span class="op" id="3137732">)</span><span class="op" id="3137733">,</span>&nbsp;<span class="ident" id="3137735">typ</span><span class="op" id="3137738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3137741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137744">switch</span>&nbsp;<span class="ident" id="3137751">typ</span><span class="op" id="3137754">.</span><span class="ident" id="3137755">Kind</span><span class="op" id="3137759">(</span><span class="op" id="3137760">)</span>&nbsp;<span class="op" id="3137762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137765">case</span>&nbsp;<span class="ident" id="3137770">reflect</span><span class="op" id="3137777">.</span><span class="ident" id="3137778">Bool</span><span class="op" id="3137782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137786">return</span>&nbsp;<span class="ident" id="3137793">s</span><span class="op" id="3137794">.</span><span class="ident" id="3137795">evalBool</span><span class="op" id="3137803">(</span><span class="ident" id="3137804">typ</span><span class="op" id="3137807">,</span>&nbsp;<span class="ident" id="3137809">n</span><span class="op" id="3137810">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137813">case</span>&nbsp;<span class="ident" id="3137818">reflect</span><span class="op" id="3137825">.</span><span class="ident" id="3137826">Complex64</span><span class="op" id="3137835">,</span>&nbsp;<span class="ident" id="3137837">reflect</span><span class="op" id="3137844">.</span><span class="ident" id="3137845">Complex128</span><span class="op" id="3137855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137859">return</span>&nbsp;<span class="ident" id="3137866">s</span><span class="op" id="3137867">.</span><span class="ident" id="3137868">evalComplex</span><span class="op" id="3137879">(</span><span class="ident" id="3137880">typ</span><span class="op" id="3137883">,</span>&nbsp;<span class="ident" id="3137885">n</span><span class="op" id="3137886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137889">case</span>&nbsp;<span class="ident" id="3137894">reflect</span><span class="op" id="3137901">.</span><span class="ident" id="3137902">Float32</span><span class="op" id="3137909">,</span>&nbsp;<span class="ident" id="3137911">reflect</span><span class="op" id="3137918">.</span><span class="ident" id="3137919">Float64</span><span class="op" id="3137926">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137930">return</span>&nbsp;<span class="ident" id="3137937">s</span><span class="op" id="3137938">.</span><span class="ident" id="3137939">evalFloat</span><span class="op" id="3137948">(</span><span class="ident" id="3137949">typ</span><span class="op" id="3137952">,</span>&nbsp;<span class="ident" id="3137954">n</span><span class="op" id="3137955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3137958">case</span>&nbsp;<span class="ident" id="3137963">reflect</span><span class="op" id="3137970">.</span><span class="ident" id="3137971">Int</span><span class="op" id="3137974">,</span>&nbsp;<span class="ident" id="3137976">reflect</span><span class="op" id="3137983">.</span><span class="ident" id="3137984">Int8</span><span class="op" id="3137988">,</span>&nbsp;<span class="ident" id="3137990">reflect</span><span class="op" id="3137997">.</span><span class="ident" id="3137998">Int16</span><span class="op" id="3138003">,</span>&nbsp;<span class="ident" id="3138005">reflect</span><span class="op" id="3138012">.</span><span class="ident" id="3138013">Int32</span><span class="op" id="3138018">,</span>&nbsp;<span class="ident" id="3138020">reflect</span><span class="op" id="3138027">.</span><span class="ident" id="3138028">Int64</span><span class="op" id="3138033">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138037">return</span>&nbsp;<span class="ident" id="3138044">s</span><span class="op" id="3138045">.</span><span class="ident" id="3138046">evalInteger</span><span class="op" id="3138057">(</span><span class="ident" id="3138058">typ</span><span class="op" id="3138061">,</span>&nbsp;<span class="ident" id="3138063">n</span><span class="op" id="3138064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138067">case</span>&nbsp;<span class="ident" id="3138072">reflect</span><span class="op" id="3138079">.</span><span class="ident" id="3138080">Interface</span><span class="op" id="3138089">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138093">if</span>&nbsp;<span class="ident" id="3138096">typ</span><span class="op" id="3138099">.</span><span class="ident" id="3138100">NumMethod</span><span class="op" id="3138109">(</span><span class="op" id="3138110">)</span>&nbsp;<span class="op" id="3138112">==</span>&nbsp;<span class="num" id="3138115">0</span>&nbsp;<span class="op" id="3138117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138122">return</span>&nbsp;<span class="ident" id="3138129">s</span><span class="op" id="3138130">.</span><span class="ident" id="3138131">evalEmptyInterface</span><span class="op" id="3138149">(</span><span class="ident" id="3138150">dot</span><span class="op" id="3138153">,</span>&nbsp;<span class="ident" id="3138155">n</span><span class="op" id="3138156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3138160">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138163">case</span>&nbsp;<span class="ident" id="3138168">reflect</span><span class="op" id="3138175">.</span><span class="ident" id="3138176">String</span><span class="op" id="3138182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138186">return</span>&nbsp;<span class="ident" id="3138193">s</span><span class="op" id="3138194">.</span><span class="ident" id="3138195">evalString</span><span class="op" id="3138205">(</span><span class="ident" id="3138206">typ</span><span class="op" id="3138209">,</span>&nbsp;<span class="ident" id="3138211">n</span><span class="op" id="3138212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138215">case</span>&nbsp;<span class="ident" id="3138220">reflect</span><span class="op" id="3138227">.</span><span class="ident" id="3138228">Uint</span><span class="op" id="3138232">,</span>&nbsp;<span class="ident" id="3138234">reflect</span><span class="op" id="3138241">.</span><span class="ident" id="3138242">Uint8</span><span class="op" id="3138247">,</span>&nbsp;<span class="ident" id="3138249">reflect</span><span class="op" id="3138256">.</span><span class="ident" id="3138257">Uint16</span><span class="op" id="3138263">,</span>&nbsp;<span class="ident" id="3138265">reflect</span><span class="op" id="3138272">.</span><span class="ident" id="3138273">Uint32</span><span class="op" id="3138279">,</span>&nbsp;<span class="ident" id="3138281">reflect</span><span class="op" id="3138288">.</span><span class="ident" id="3138289">Uint64</span><span class="op" id="3138295">,</span>&nbsp;<span class="ident" id="3138297">reflect</span><span class="op" id="3138304">.</span><span class="ident" id="3138305">Uintptr</span><span class="op" id="3138312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138316">return</span>&nbsp;<span class="ident" id="3138323">s</span><span class="op" id="3138324">.</span><span class="ident" id="3138325">evalUnsignedInteger</span><span class="op" id="3138344">(</span><span class="ident" id="3138345">typ</span><span class="op" id="3138348">,</span>&nbsp;<span class="ident" id="3138350">n</span><span class="op" id="3138351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3138354">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138357">s</span><span class="op" id="3138358">.</span><span class="ident" id="3138359">errorf</span><span class="op" id="3138365">(</span><span class="string" id="3138366">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3138402">,</span>&nbsp;<span class="ident" id="3138404">n</span><span class="op" id="3138405">,</span>&nbsp;<span class="ident" id="3138407">typ</span><span class="op" id="3138410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3138413">panic</span><span class="op" id="3138418">(</span><span class="string" id="3138419">&#34;not&nbsp;reached&#34;</span><span class="op" id="3138432">)</span><br>
<span class="lineno"></span><span class="op" id="3138434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3138437">func</span>&nbsp;<span class="op" id="3138442">(</span><span class="ident" id="3138443">s</span>&nbsp;<span class="op" id="3138445">*</span><span class="ident" id="3138446">state</span><span class="op" id="3138451">)</span>&nbsp;<span class="ident" id="3138453">evalBool</span><span class="op" id="3138461">(</span><span class="ident" id="3138462">typ</span>&nbsp;<span class="ident" id="3138466">reflect</span><span class="op" id="3138473">.</span><span class="ident" id="3138474">Type</span><span class="op" id="3138478">,</span>&nbsp;<span class="ident" id="3138480">n</span>&nbsp;<span class="ident" id="3138482">parse</span><span class="op" id="3138487">.</span><span class="ident" id="3138488">Node</span><span class="op" id="3138492">)</span>&nbsp;<span class="ident" id="3138494">reflect</span><span class="op" id="3138501">.</span><span class="ident" id="3138502">Value</span>&nbsp;<span class="op" id="3138508">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138511">s</span><span class="op" id="3138512">.</span><span class="ident" id="3138513">at</span><span class="op" id="3138515">(</span><span class="ident" id="3138516">n</span><span class="op" id="3138517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138520">if</span>&nbsp;<span class="ident" id="3138523">n</span><span class="op" id="3138524">,</span>&nbsp;<span class="ident" id="3138526">ok</span>&nbsp;<span class="op" id="3138529">:=</span>&nbsp;<span class="ident" id="3138532">n</span><span class="op" id="3138533">.</span><span class="op" id="3138534">(</span><span class="op" id="3138535">*</span><span class="ident" id="3138536">parse</span><span class="op" id="3138541">.</span><span class="ident" id="3138542">BoolNode</span><span class="op" id="3138550">)</span><span class="op" id="3138551">;</span>&nbsp;<span class="ident" id="3138553">ok</span>&nbsp;<span class="op" id="3138556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138560">value</span>&nbsp;<span class="op" id="3138566">:=</span>&nbsp;<span class="ident" id="3138569">reflect</span><span class="op" id="3138576">.</span><span class="ident" id="3138577">New</span><span class="op" id="3138580">(</span><span class="ident" id="3138581">typ</span><span class="op" id="3138584">)</span><span class="op" id="3138585">.</span><span class="ident" id="3138586">Elem</span><span class="op" id="3138590">(</span><span class="op" id="3138591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138595">value</span><span class="op" id="3138600">.</span><span class="ident" id="3138601">SetBool</span><span class="op" id="3138608">(</span><span class="ident" id="3138609">n</span><span class="op" id="3138610">.</span><span class="ident" id="3138611">True</span><span class="op" id="3138615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138619">return</span>&nbsp;<span class="ident" id="3138626">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3138633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138636">s</span><span class="op" id="3138637">.</span><span class="ident" id="3138638">errorf</span><span class="op" id="3138644">(</span><span class="string" id="3138645">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3138670">,</span>&nbsp;<span class="ident" id="3138672">n</span><span class="op" id="3138673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3138676">panic</span><span class="op" id="3138681">(</span><span class="string" id="3138682">&#34;not&nbsp;reached&#34;</span><span class="op" id="3138695">)</span><br>
<span class="lineno"></span><span class="op" id="3138697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="3138700">func</span>&nbsp;<span class="op" id="3138705">(</span><span class="ident" id="3138706">s</span>&nbsp;<span class="op" id="3138708">*</span><span class="ident" id="3138709">state</span><span class="op" id="3138714">)</span>&nbsp;<span class="ident" id="3138716">evalString</span><span class="op" id="3138726">(</span><span class="ident" id="3138727">typ</span>&nbsp;<span class="ident" id="3138731">reflect</span><span class="op" id="3138738">.</span><span class="ident" id="3138739">Type</span><span class="op" id="3138743">,</span>&nbsp;<span class="ident" id="3138745">n</span>&nbsp;<span class="ident" id="3138747">parse</span><span class="op" id="3138752">.</span><span class="ident" id="3138753">Node</span><span class="op" id="3138757">)</span>&nbsp;<span class="ident" id="3138759">reflect</span><span class="op" id="3138766">.</span><span class="ident" id="3138767">Value</span>&nbsp;<span class="op" id="3138773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138776">s</span><span class="op" id="3138777">.</span><span class="ident" id="3138778">at</span><span class="op" id="3138780">(</span><span class="ident" id="3138781">n</span><span class="op" id="3138782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138785">if</span>&nbsp;<span class="ident" id="3138788">n</span><span class="op" id="3138789">,</span>&nbsp;<span class="ident" id="3138791">ok</span>&nbsp;<span class="op" id="3138794">:=</span>&nbsp;<span class="ident" id="3138797">n</span><span class="op" id="3138798">.</span><span class="op" id="3138799">(</span><span class="op" id="3138800">*</span><span class="ident" id="3138801">parse</span><span class="op" id="3138806">.</span><span class="ident" id="3138807">StringNode</span><span class="op" id="3138817">)</span><span class="op" id="3138818">;</span>&nbsp;<span class="ident" id="3138820">ok</span>&nbsp;<span class="op" id="3138823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138827">value</span>&nbsp;<span class="op" id="3138833">:=</span>&nbsp;<span class="ident" id="3138836">reflect</span><span class="op" id="3138843">.</span><span class="ident" id="3138844">New</span><span class="op" id="3138847">(</span><span class="ident" id="3138848">typ</span><span class="op" id="3138851">)</span><span class="op" id="3138852">.</span><span class="ident" id="3138853">Elem</span><span class="op" id="3138857">(</span><span class="op" id="3138858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138862">value</span><span class="op" id="3138867">.</span><span class="ident" id="3138868">SetString</span><span class="op" id="3138877">(</span><span class="ident" id="3138878">n</span><span class="op" id="3138879">.</span><span class="ident" id="3138880">Text</span><span class="op" id="3138884">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3138888">return</span>&nbsp;<span class="ident" id="3138895">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3138902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3138905">s</span><span class="op" id="3138906">.</span><span class="ident" id="3138907">errorf</span><span class="op" id="3138913">(</span><span class="string" id="3138914">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3138941">,</span>&nbsp;<span class="ident" id="3138943">n</span><span class="op" id="3138944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3138947">panic</span><span class="op" id="3138952">(</span><span class="string" id="3138953">&#34;not&nbsp;reached&#34;</span><span class="op" id="3138966">)</span><br>
<span class="lineno"></span><span class="op" id="3138968">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3138971">func</span>&nbsp;<span class="op" id="3138976">(</span><span class="ident" id="3138977">s</span>&nbsp;<span class="op" id="3138979">*</span><span class="ident" id="3138980">state</span><span class="op" id="3138985">)</span>&nbsp;<span class="ident" id="3138987">evalInteger</span><span class="op" id="3138998">(</span><span class="ident" id="3138999">typ</span>&nbsp;<span class="ident" id="3139003">reflect</span><span class="op" id="3139010">.</span><span class="ident" id="3139011">Type</span><span class="op" id="3139015">,</span>&nbsp;<span class="ident" id="3139017">n</span>&nbsp;<span class="ident" id="3139019">parse</span><span class="op" id="3139024">.</span><span class="ident" id="3139025">Node</span><span class="op" id="3139029">)</span>&nbsp;<span class="ident" id="3139031">reflect</span><span class="op" id="3139038">.</span><span class="ident" id="3139039">Value</span>&nbsp;<span class="op" id="3139045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139048">s</span><span class="op" id="3139049">.</span><span class="ident" id="3139050">at</span><span class="op" id="3139052">(</span><span class="ident" id="3139053">n</span><span class="op" id="3139054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139057">if</span>&nbsp;<span class="ident" id="3139060">n</span><span class="op" id="3139061">,</span>&nbsp;<span class="ident" id="3139063">ok</span>&nbsp;<span class="op" id="3139066">:=</span>&nbsp;<span class="ident" id="3139069">n</span><span class="op" id="3139070">.</span><span class="op" id="3139071">(</span><span class="op" id="3139072">*</span><span class="ident" id="3139073">parse</span><span class="op" id="3139078">.</span><span class="ident" id="3139079">NumberNode</span><span class="op" id="3139089">)</span><span class="op" id="3139090">;</span>&nbsp;<span class="ident" id="3139092">ok</span>&nbsp;<span class="op" id="3139095">&amp;&amp;</span>&nbsp;<span class="ident" id="3139098">n</span><span class="op" id="3139099">.</span><span class="ident" id="3139100">IsInt</span>&nbsp;<span class="op" id="3139106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139110">value</span>&nbsp;<span class="op" id="3139116">:=</span>&nbsp;<span class="ident" id="3139119">reflect</span><span class="op" id="3139126">.</span><span class="ident" id="3139127">New</span><span class="op" id="3139130">(</span><span class="ident" id="3139131">typ</span><span class="op" id="3139134">)</span><span class="op" id="3139135">.</span><span class="ident" id="3139136">Elem</span><span class="op" id="3139140">(</span><span class="op" id="3139141">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139145">value</span><span class="op" id="3139150">.</span><span class="ident" id="3139151">SetInt</span><span class="op" id="3139157">(</span><span class="ident" id="3139158">n</span><span class="op" id="3139159">.</span><span class="ident" id="3139160">Int64</span><span class="op" id="3139165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139169">return</span>&nbsp;<span class="ident" id="3139176">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3139183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139186">s</span><span class="op" id="3139187">.</span><span class="ident" id="3139188">errorf</span><span class="op" id="3139194">(</span><span class="string" id="3139195">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3139223">,</span>&nbsp;<span class="ident" id="3139225">n</span><span class="op" id="3139226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3139229">panic</span><span class="op" id="3139234">(</span><span class="string" id="3139235">&#34;not&nbsp;reached&#34;</span><span class="op" id="3139248">)</span><br>
<span class="lineno">695</span><span class="op" id="3139250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139253">func</span>&nbsp;<span class="op" id="3139258">(</span><span class="ident" id="3139259">s</span>&nbsp;<span class="op" id="3139261">*</span><span class="ident" id="3139262">state</span><span class="op" id="3139267">)</span>&nbsp;<span class="ident" id="3139269">evalUnsignedInteger</span><span class="op" id="3139288">(</span><span class="ident" id="3139289">typ</span>&nbsp;<span class="ident" id="3139293">reflect</span><span class="op" id="3139300">.</span><span class="ident" id="3139301">Type</span><span class="op" id="3139305">,</span>&nbsp;<span class="ident" id="3139307">n</span>&nbsp;<span class="ident" id="3139309">parse</span><span class="op" id="3139314">.</span><span class="ident" id="3139315">Node</span><span class="op" id="3139319">)</span>&nbsp;<span class="ident" id="3139321">reflect</span><span class="op" id="3139328">.</span><span class="ident" id="3139329">Value</span>&nbsp;<span class="op" id="3139335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139338">s</span><span class="op" id="3139339">.</span><span class="ident" id="3139340">at</span><span class="op" id="3139342">(</span><span class="ident" id="3139343">n</span><span class="op" id="3139344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139347">if</span>&nbsp;<span class="ident" id="3139350">n</span><span class="op" id="3139351">,</span>&nbsp;<span class="ident" id="3139353">ok</span>&nbsp;<span class="op" id="3139356">:=</span>&nbsp;<span class="ident" id="3139359">n</span><span class="op" id="3139360">.</span><span class="op" id="3139361">(</span><span class="op" id="3139362">*</span><span class="ident" id="3139363">parse</span><span class="op" id="3139368">.</span><span class="ident" id="3139369">NumberNode</span><span class="op" id="3139379">)</span><span class="op" id="3139380">;</span>&nbsp;<span class="ident" id="3139382">ok</span>&nbsp;<span class="op" id="3139385">&amp;&amp;</span>&nbsp;<span class="ident" id="3139388">n</span><span class="op" id="3139389">.</span><span class="ident" id="3139390">IsUint</span>&nbsp;<span class="op" id="3139397">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139401">value</span>&nbsp;<span class="op" id="3139407">:=</span>&nbsp;<span class="ident" id="3139410">reflect</span><span class="op" id="3139417">.</span><span class="ident" id="3139418">New</span><span class="op" id="3139421">(</span><span class="ident" id="3139422">typ</span><span class="op" id="3139425">)</span><span class="op" id="3139426">.</span><span class="ident" id="3139427">Elem</span><span class="op" id="3139431">(</span><span class="op" id="3139432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139436">value</span><span class="op" id="3139441">.</span><span class="ident" id="3139442">SetUint</span><span class="op" id="3139449">(</span><span class="ident" id="3139450">n</span><span class="op" id="3139451">.</span><span class="ident" id="3139452">Uint64</span><span class="op" id="3139458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139462">return</span>&nbsp;<span class="ident" id="3139469">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3139476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139479">s</span><span class="op" id="3139480">.</span><span class="ident" id="3139481">errorf</span><span class="op" id="3139487">(</span><span class="string" id="3139488">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3139525">,</span>&nbsp;<span class="ident" id="3139527">n</span><span class="op" id="3139528">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3139531">panic</span><span class="op" id="3139536">(</span><span class="string" id="3139537">&#34;not&nbsp;reached&#34;</span><span class="op" id="3139550">)</span><br>
<span class="lineno"></span><span class="op" id="3139552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139555">func</span>&nbsp;<span class="op" id="3139560">(</span><span class="ident" id="3139561">s</span>&nbsp;<span class="op" id="3139563">*</span><span class="ident" id="3139564">state</span><span class="op" id="3139569">)</span>&nbsp;<span class="ident" id="3139571">evalFloat</span><span class="op" id="3139580">(</span><span class="ident" id="3139581">typ</span>&nbsp;<span class="ident" id="3139585">reflect</span><span class="op" id="3139592">.</span><span class="ident" id="3139593">Type</span><span class="op" id="3139597">,</span>&nbsp;<span class="ident" id="3139599">n</span>&nbsp;<span class="ident" id="3139601">parse</span><span class="op" id="3139606">.</span><span class="ident" id="3139607">Node</span><span class="op" id="3139611">)</span>&nbsp;<span class="ident" id="3139613">reflect</span><span class="op" id="3139620">.</span><span class="ident" id="3139621">Value</span>&nbsp;<span class="op" id="3139627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139630">s</span><span class="op" id="3139631">.</span><span class="ident" id="3139632">at</span><span class="op" id="3139634">(</span><span class="ident" id="3139635">n</span><span class="op" id="3139636">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139639">if</span>&nbsp;<span class="ident" id="3139642">n</span><span class="op" id="3139643">,</span>&nbsp;<span class="ident" id="3139645">ok</span>&nbsp;<span class="op" id="3139648">:=</span>&nbsp;<span class="ident" id="3139651">n</span><span class="op" id="3139652">.</span><span class="op" id="3139653">(</span><span class="op" id="3139654">*</span><span class="ident" id="3139655">parse</span><span class="op" id="3139660">.</span><span class="ident" id="3139661">NumberNode</span><span class="op" id="3139671">)</span><span class="op" id="3139672">;</span>&nbsp;<span class="ident" id="3139674">ok</span>&nbsp;<span class="op" id="3139677">&amp;&amp;</span>&nbsp;<span class="ident" id="3139680">n</span><span class="op" id="3139681">.</span><span class="ident" id="3139682">IsFloat</span>&nbsp;<span class="op" id="3139690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139694">value</span>&nbsp;<span class="op" id="3139700">:=</span>&nbsp;<span class="ident" id="3139703">reflect</span><span class="op" id="3139710">.</span><span class="ident" id="3139711">New</span><span class="op" id="3139714">(</span><span class="ident" id="3139715">typ</span><span class="op" id="3139718">)</span><span class="op" id="3139719">.</span><span class="ident" id="3139720">Elem</span><span class="op" id="3139724">(</span><span class="op" id="3139725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139729">value</span><span class="op" id="3139734">.</span><span class="ident" id="3139735">SetFloat</span><span class="op" id="3139743">(</span><span class="ident" id="3139744">n</span><span class="op" id="3139745">.</span><span class="ident" id="3139746">Float64</span><span class="op" id="3139753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139757">return</span>&nbsp;<span class="ident" id="3139764">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3139771">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139774">s</span><span class="op" id="3139775">.</span><span class="ident" id="3139776">errorf</span><span class="op" id="3139782">(</span><span class="string" id="3139783">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3139809">,</span>&nbsp;<span class="ident" id="3139811">n</span><span class="op" id="3139812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3139815">panic</span><span class="op" id="3139820">(</span><span class="string" id="3139821">&#34;not&nbsp;reached&#34;</span><span class="op" id="3139834">)</span><br>
<span class="lineno"></span><span class="op" id="3139836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3139839">func</span>&nbsp;<span class="op" id="3139844">(</span><span class="ident" id="3139845">s</span>&nbsp;<span class="op" id="3139847">*</span><span class="ident" id="3139848">state</span><span class="op" id="3139853">)</span>&nbsp;<span class="ident" id="3139855">evalComplex</span><span class="op" id="3139866">(</span><span class="ident" id="3139867">typ</span>&nbsp;<span class="ident" id="3139871">reflect</span><span class="op" id="3139878">.</span><span class="ident" id="3139879">Type</span><span class="op" id="3139883">,</span>&nbsp;<span class="ident" id="3139885">n</span>&nbsp;<span class="ident" id="3139887">parse</span><span class="op" id="3139892">.</span><span class="ident" id="3139893">Node</span><span class="op" id="3139897">)</span>&nbsp;<span class="ident" id="3139899">reflect</span><span class="op" id="3139906">.</span><span class="ident" id="3139907">Value</span>&nbsp;<span class="op" id="3139913">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3139916">if</span>&nbsp;<span class="ident" id="3139919">n</span><span class="op" id="3139920">,</span>&nbsp;<span class="ident" id="3139922">ok</span>&nbsp;<span class="op" id="3139925">:=</span>&nbsp;<span class="ident" id="3139928">n</span><span class="op" id="3139929">.</span><span class="op" id="3139930">(</span><span class="op" id="3139931">*</span><span class="ident" id="3139932">parse</span><span class="op" id="3139937">.</span><span class="ident" id="3139938">NumberNode</span><span class="op" id="3139948">)</span><span class="op" id="3139949">;</span>&nbsp;<span class="ident" id="3139951">ok</span>&nbsp;<span class="op" id="3139954">&amp;&amp;</span>&nbsp;<span class="ident" id="3139957">n</span><span class="op" id="3139958">.</span><span class="ident" id="3139959">IsComplex</span>&nbsp;<span class="op" id="3139969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3139973">value</span>&nbsp;<span class="op" id="3139979">:=</span>&nbsp;<span class="ident" id="3139982">reflect</span><span class="op" id="3139989">.</span><span class="ident" id="3139990">New</span><span class="op" id="3139993">(</span><span class="ident" id="3139994">typ</span><span class="op" id="3139997">)</span><span class="op" id="3139998">.</span><span class="ident" id="3139999">Elem</span><span class="op" id="3140003">(</span><span class="op" id="3140004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3140008">value</span><span class="op" id="3140013">.</span><span class="ident" id="3140014">SetComplex</span><span class="op" id="3140024">(</span><span class="ident" id="3140025">n</span><span class="op" id="3140026">.</span><span class="ident" id="3140027">Complex128</span><span class="op" id="3140037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140041">return</span>&nbsp;<span class="ident" id="3140048">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3140055">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3140058">s</span><span class="op" id="3140059">.</span><span class="ident" id="3140060">errorf</span><span class="op" id="3140066">(</span><span class="string" id="3140067">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3140095">,</span>&nbsp;<span class="ident" id="3140097">n</span><span class="op" id="3140098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3140101">panic</span><span class="op" id="3140106">(</span><span class="string" id="3140107">&#34;not&nbsp;reached&#34;</span><span class="op" id="3140120">)</span><br>
<span class="lineno"></span><span class="op" id="3140122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3140125">func</span>&nbsp;<span class="op" id="3140130">(</span><span class="ident" id="3140131">s</span>&nbsp;<span class="op" id="3140133">*</span><span class="ident" id="3140134">state</span><span class="op" id="3140139">)</span>&nbsp;<span class="ident" id="3140141">evalEmptyInterface</span><span class="op" id="3140159">(</span><span class="ident" id="3140160">dot</span>&nbsp;<span class="ident" id="3140164">reflect</span><span class="op" id="3140171">.</span><span class="ident" id="3140172">Value</span><span class="op" id="3140177">,</span>&nbsp;<span class="ident" id="3140179">n</span>&nbsp;<span class="ident" id="3140181">parse</span><span class="op" id="3140186">.</span><span class="ident" id="3140187">Node</span><span class="op" id="3140191">)</span>&nbsp;<span class="ident" id="3140193">reflect</span><span class="op" id="3140200">.</span><span class="ident" id="3140201">Value</span>&nbsp;<span class="op" id="3140207">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3140210">s</span><span class="op" id="3140211">.</span><span class="ident" id="3140212">at</span><span class="op" id="3140214">(</span><span class="ident" id="3140215">n</span><span class="op" id="3140216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140219">switch</span>&nbsp;<span class="ident" id="3140226">n</span>&nbsp;<span class="op" id="3140228">:=</span>&nbsp;<span class="ident" id="3140231">n</span><span class="op" id="3140232">.</span><span class="op" id="3140233">(</span><span class="keyword" id="3140234">type</span><span class="op" id="3140238">)</span>&nbsp;<span class="op" id="3140240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140243">case</span>&nbsp;<span class="op" id="3140248">*</span><span class="ident" id="3140249">parse</span><span class="op" id="3140254">.</span><span class="ident" id="3140255">BoolNode</span><span class="op" id="3140263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140267">return</span>&nbsp;<span class="ident" id="3140274">reflect</span><span class="op" id="3140281">.</span><span class="ident" id="3140282">ValueOf</span><span class="op" id="3140289">(</span><span class="ident" id="3140290">n</span><span class="op" id="3140291">.</span><span class="ident" id="3140292">True</span><span class="op" id="3140296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140299">case</span>&nbsp;<span class="op" id="3140304">*</span><span class="ident" id="3140305">parse</span><span class="op" id="3140310">.</span><span class="ident" id="3140311">DotNode</span><span class="op" id="3140318">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140322">return</span>&nbsp;<span class="ident" id="3140329">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140334">case</span>&nbsp;<span class="op" id="3140339">*</span><span class="ident" id="3140340">parse</span><span class="op" id="3140345">.</span><span class="ident" id="3140346">FieldNode</span><span class="op" id="3140355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140359">return</span>&nbsp;<span class="ident" id="3140366">s</span><span class="op" id="3140367">.</span><span class="ident" id="3140368">evalFieldNode</span><span class="op" id="3140381">(</span><span class="ident" id="3140382">dot</span><span class="op" id="3140385">,</span>&nbsp;<span class="ident" id="3140387">n</span><span class="op" id="3140388">,</span>&nbsp;<span class="ident" id="3140390">nil</span><span class="op" id="3140393">,</span>&nbsp;<span class="ident" id="3140395">zero</span><span class="op" id="3140399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140402">case</span>&nbsp;<span class="op" id="3140407">*</span><span class="ident" id="3140408">parse</span><span class="op" id="3140413">.</span><span class="ident" id="3140414">IdentifierNode</span><span class="op" id="3140428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140432">return</span>&nbsp;<span class="ident" id="3140439">s</span><span class="op" id="3140440">.</span><span class="ident" id="3140441">evalFunction</span><span class="op" id="3140453">(</span><span class="ident" id="3140454">dot</span><span class="op" id="3140457">,</span>&nbsp;<span class="ident" id="3140459">n</span><span class="op" id="3140460">,</span>&nbsp;<span class="ident" id="3140462">n</span><span class="op" id="3140463">,</span>&nbsp;<span class="ident" id="3140465">nil</span><span class="op" id="3140468">,</span>&nbsp;<span class="ident" id="3140470">zero</span><span class="op" id="3140474">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140477">case</span>&nbsp;<span class="op" id="3140482">*</span><span class="ident" id="3140483">parse</span><span class="op" id="3140488">.</span><span class="ident" id="3140489">NilNode</span><span class="op" id="3140496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3140500">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3140568">s</span><span class="op" id="3140569">.</span><span class="ident" id="3140570">errorf</span><span class="op" id="3140576">(</span><span class="string" id="3140577">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="3140617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140620">case</span>&nbsp;<span class="op" id="3140625">*</span><span class="ident" id="3140626">parse</span><span class="op" id="3140631">.</span><span class="ident" id="3140632">NumberNode</span><span class="op" id="3140642">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140646">return</span>&nbsp;<span class="ident" id="3140653">s</span><span class="op" id="3140654">.</span><span class="ident" id="3140655">idealConstant</span><span class="op" id="3140668">(</span><span class="ident" id="3140669">n</span><span class="op" id="3140670">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140673">case</span>&nbsp;<span class="op" id="3140678">*</span><span class="ident" id="3140679">parse</span><span class="op" id="3140684">.</span><span class="ident" id="3140685">StringNode</span><span class="op" id="3140695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140699">return</span>&nbsp;<span class="ident" id="3140706">reflect</span><span class="op" id="3140713">.</span><span class="ident" id="3140714">ValueOf</span><span class="op" id="3140721">(</span><span class="ident" id="3140722">n</span><span class="op" id="3140723">.</span><span class="ident" id="3140724">Text</span><span class="op" id="3140728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140731">case</span>&nbsp;<span class="op" id="3140736">*</span><span class="ident" id="3140737">parse</span><span class="op" id="3140742">.</span><span class="ident" id="3140743">VariableNode</span><span class="op" id="3140755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140759">return</span>&nbsp;<span class="ident" id="3140766">s</span><span class="op" id="3140767">.</span><span class="ident" id="3140768">evalVariableNode</span><span class="op" id="3140784">(</span><span class="ident" id="3140785">dot</span><span class="op" id="3140788">,</span>&nbsp;<span class="ident" id="3140790">n</span><span class="op" id="3140791">,</span>&nbsp;<span class="ident" id="3140793">nil</span><span class="op" id="3140796">,</span>&nbsp;<span class="ident" id="3140798">zero</span><span class="op" id="3140802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140805">case</span>&nbsp;<span class="op" id="3140810">*</span><span class="ident" id="3140811">parse</span><span class="op" id="3140816">.</span><span class="ident" id="3140817">PipeNode</span><span class="op" id="3140825">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3140829">return</span>&nbsp;<span class="ident" id="3140836">s</span><span class="op" id="3140837">.</span><span class="ident" id="3140838">evalPipeline</span><span class="op" id="3140850">(</span><span class="ident" id="3140851">dot</span><span class="op" id="3140854">,</span>&nbsp;<span class="ident" id="3140856">n</span><span class="op" id="3140857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3140860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3140863">s</span><span class="op" id="3140864">.</span><span class="ident" id="3140865">errorf</span><span class="op" id="3140871">(</span><span class="string" id="3140872">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="3140931">,</span>&nbsp;<span class="ident" id="3140933">n</span><span class="op" id="3140934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3140937">panic</span><span class="op" id="3140942">(</span><span class="string" id="3140943">&#34;not&nbsp;reached&#34;</span><span class="op" id="3140956">)</span><br>
<span class="lineno"></span><span class="op" id="3140958">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="3140961">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3141053">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3141121">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="3141173">func</span>&nbsp;<span class="ident" id="3141178">indirect</span><span class="op" id="3141186">(</span><span class="ident" id="3141187">v</span>&nbsp;<span class="ident" id="3141189">reflect</span><span class="op" id="3141196">.</span><span class="ident" id="3141197">Value</span><span class="op" id="3141202">)</span>&nbsp;<span class="op" id="3141204">(</span><span class="ident" id="3141205">rv</span>&nbsp;<span class="ident" id="3141208">reflect</span><span class="op" id="3141215">.</span><span class="ident" id="3141216">Value</span><span class="op" id="3141221">,</span>&nbsp;<span class="ident" id="3141223">isNil</span>&nbsp;<span class="builtintype" id="3141229">bool</span><span class="op" id="3141233">)</span>&nbsp;<span class="op" id="3141235">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3141238">for</span>&nbsp;<span class="op" id="3141242">;</span>&nbsp;<span class="ident" id="3141244">v</span><span class="op" id="3141245">.</span><span class="ident" id="3141246">Kind</span><span class="op" id="3141250">(</span><span class="op" id="3141251">)</span>&nbsp;<span class="op" id="3141253">==</span>&nbsp;<span class="ident" id="3141256">reflect</span><span class="op" id="3141263">.</span><span class="ident" id="3141264">Ptr</span>&nbsp;<span class="op" id="3141268">||</span>&nbsp;<span class="ident" id="3141271">v</span><span class="op" id="3141272">.</span><span class="ident" id="3141273">Kind</span><span class="op" id="3141277">(</span><span class="op" id="3141278">)</span>&nbsp;<span class="op" id="3141280">==</span>&nbsp;<span class="ident" id="3141283">reflect</span><span class="op" id="3141290">.</span><span class="ident" id="3141291">Interface</span><span class="op" id="3141300">;</span>&nbsp;<span class="ident" id="3141302">v</span>&nbsp;<span class="op" id="3141304">=</span>&nbsp;<span class="ident" id="3141306">v</span><span class="op" id="3141307">.</span><span class="ident" id="3141308">Elem</span><span class="op" id="3141312">(</span><span class="op" id="3141313">)</span>&nbsp;<span class="op" id="3141315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3141319">if</span>&nbsp;<span class="ident" id="3141322">v</span><span class="op" id="3141323">.</span><span class="ident" id="3141324">IsNil</span><span class="op" id="3141329">(</span><span class="op" id="3141330">)</span>&nbsp;<span class="op" id="3141332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3141337">return</span>&nbsp;<span class="ident" id="3141344">v</span><span class="op" id="3141345">,</span>&nbsp;<span class="builtintype" id="3141347">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3141354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3141358">if</span>&nbsp;<span class="ident" id="3141361">v</span><span class="op" id="3141362">.</span><span class="ident" id="3141363">Kind</span><span class="op" id="3141367">(</span><span class="op" id="3141368">)</span>&nbsp;<span class="op" id="3141370">==</span>&nbsp;<span class="ident" id="3141373">reflect</span><span class="op" id="3141380">.</span><span class="ident" id="3141381">Interface</span>&nbsp;<span class="op" id="3141391">&amp;&amp;</span>&nbsp;<span class="ident" id="3141394">v</span><span class="op" id="3141395">.</span><span class="ident" id="3141396">NumMethod</span><span class="op" id="3141405">(</span><span class="op" id="3141406">)</span>&nbsp;<span class="op" id="3141408">&gt;</span>&nbsp;<span class="num" id="3141410">0</span>&nbsp;<span class="op" id="3141412">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3141417">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3141425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3141428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3141431">return</span>&nbsp;<span class="ident" id="3141438">v</span><span class="op" id="3141439">,</span>&nbsp;<span class="builtintype" id="3141441">false</span><br>
<span class="lineno"></span><span class="op" id="3141447">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="3141450">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3141528">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3141545">func</span>&nbsp;<span class="op" id="3141550">(</span><span class="ident" id="3141551">s</span>&nbsp;<span class="op" id="3141553">*</span><span class="ident" id="3141554">state</span><span class="op" id="3141559">)</span>&nbsp;<span class="ident" id="3141561">printValue</span><span class="op" id="3141571">(</span><span class="ident" id="3141572">n</span>&nbsp;<span class="ident" id="3141574">parse</span><span class="op" id="3141579">.</span><span class="ident" id="3141580">Node</span><span class="op" id="3141584">,</span>&nbsp;<span class="ident" id="3141586">v</span>&nbsp;<span class="ident" id="3141588">reflect</span><span class="op" id="3141595">.</span><span class="ident" id="3141596">Value</span><span class="op" id="3141601">)</span>&nbsp;<span class="op" id="3141603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3141606">s</span><span class="op" id="3141607">.</span><span class="ident" id="3141608">at</span><span class="op" id="3141610">(</span><span class="ident" id="3141611">n</span><span class="op" id="3141612">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3141615">iface</span><span class="op" id="3141620">,</span>&nbsp;<span class="ident" id="3141622">ok</span>&nbsp;<span class="op" id="3141625">:=</span>&nbsp;<span class="ident" id="3141628">printableValue</span><span class="op" id="3141642">(</span><span class="ident" id="3141643">v</span><span class="op" id="3141644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3141647">if</span>&nbsp;<span class="op" id="3141650">!</span><span class="ident" id="3141651">ok</span>&nbsp;<span class="op" id="3141654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3141658">s</span><span class="op" id="3141659">.</span><span class="ident" id="3141660">errorf</span><span class="op" id="3141666">(</span><span class="string" id="3141667">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3141694">,</span>&nbsp;<span class="ident" id="3141696">n</span><span class="op" id="3141697">,</span>&nbsp;<span class="ident" id="3141699">v</span><span class="op" id="3141700">.</span><span class="ident" id="3141701">Type</span><span class="op" id="3141705">(</span><span class="op" id="3141706">)</span><span class="op" id="3141707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3141710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3141713">fmt</span><span class="op" id="3141716">.</span><span class="ident" id="3141717">Fprint</span><span class="op" id="3141723">(</span><span class="ident" id="3141724">s</span><span class="op" id="3141725">.</span><span class="ident" id="3141726">wr</span><span class="op" id="3141728">,</span>&nbsp;<span class="ident" id="3141730">iface</span><span class="op" id="3141735">)</span><br>
<span class="lineno">780</span><span class="op" id="3141737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3141740">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3141822">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="3141866">func</span>&nbsp;<span class="ident" id="3141871">printableValue</span><span class="op" id="3141885">(</span><span class="ident" id="3141886">v</span>&nbsp;<span class="ident" id="3141888">reflect</span><span class="op" id="3141895">.</span><span class="ident" id="3141896">Value</span><span class="op" id="3141901">)</span>&nbsp;<span class="op" id="3141903">(</span><span class="keyword" id="3141904">interface</span><span class="op" id="3141913">{</span><span class="op" id="3141914">}</span><span class="op" id="3141915">,</span>&nbsp;<span class="builtintype" id="3141917">bool</span><span class="op" id="3141921">)</span>&nbsp;<span class="op" id="3141923">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3141926">if</span>&nbsp;<span class="ident" id="3141929">v</span><span class="op" id="3141930">.</span><span class="ident" id="3141931">Kind</span><span class="op" id="3141935">(</span><span class="op" id="3141936">)</span>&nbsp;<span class="op" id="3141938">==</span>&nbsp;<span class="ident" id="3141941">reflect</span><span class="op" id="3141948">.</span><span class="ident" id="3141949">Ptr</span>&nbsp;<span class="op" id="3141953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3141957">v</span><span class="op" id="3141958">,</span>&nbsp;<span class="ident" id="3141960">_</span>&nbsp;<span class="op" id="3141962">=</span>&nbsp;<span class="ident" id="3141964">indirect</span><span class="op" id="3141972">(</span><span class="ident" id="3141973">v</span><span class="op" id="3141974">)</span>&nbsp;<span class="comment" id="3141976">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3142004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142007">if</span>&nbsp;<span class="op" id="3142010">!</span><span class="ident" id="3142011">v</span><span class="op" id="3142012">.</span><span class="ident" id="3142013">IsValid</span><span class="op" id="3142020">(</span><span class="op" id="3142021">)</span>&nbsp;<span class="op" id="3142023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142027">return</span>&nbsp;<span class="string" id="3142034">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="3142046">,</span>&nbsp;<span class="builtintype" id="3142048">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3142054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142058">if</span>&nbsp;<span class="op" id="3142061">!</span><span class="ident" id="3142062">v</span><span class="op" id="3142063">.</span><span class="ident" id="3142064">Type</span><span class="op" id="3142068">(</span><span class="op" id="3142069">)</span><span class="op" id="3142070">.</span><span class="ident" id="3142071">Implements</span><span class="op" id="3142081">(</span><span class="ident" id="3142082">errorType</span><span class="op" id="3142091">)</span>&nbsp;<span class="op" id="3142093">&amp;&amp;</span>&nbsp;<span class="op" id="3142096">!</span><span class="ident" id="3142097">v</span><span class="op" id="3142098">.</span><span class="ident" id="3142099">Type</span><span class="op" id="3142103">(</span><span class="op" id="3142104">)</span><span class="op" id="3142105">.</span><span class="ident" id="3142106">Implements</span><span class="op" id="3142116">(</span><span class="ident" id="3142117">fmtStringerType</span><span class="op" id="3142132">)</span>&nbsp;<span class="op" id="3142134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142138">if</span>&nbsp;<span class="ident" id="3142141">v</span><span class="op" id="3142142">.</span><span class="ident" id="3142143">CanAddr</span><span class="op" id="3142150">(</span><span class="op" id="3142151">)</span>&nbsp;<span class="op" id="3142153">&amp;&amp;</span>&nbsp;<span class="op" id="3142156">(</span><span class="ident" id="3142157">reflect</span><span class="op" id="3142164">.</span><span class="ident" id="3142165">PtrTo</span><span class="op" id="3142170">(</span><span class="ident" id="3142171">v</span><span class="op" id="3142172">.</span><span class="ident" id="3142173">Type</span><span class="op" id="3142177">(</span><span class="op" id="3142178">)</span><span class="op" id="3142179">)</span><span class="op" id="3142180">.</span><span class="ident" id="3142181">Implements</span><span class="op" id="3142191">(</span><span class="ident" id="3142192">errorType</span><span class="op" id="3142201">)</span>&nbsp;<span class="op" id="3142203">||</span>&nbsp;<span class="ident" id="3142206">reflect</span><span class="op" id="3142213">.</span><span class="ident" id="3142214">PtrTo</span><span class="op" id="3142219">(</span><span class="ident" id="3142220">v</span><span class="op" id="3142221">.</span><span class="ident" id="3142222">Type</span><span class="op" id="3142226">(</span><span class="op" id="3142227">)</span><span class="op" id="3142228">)</span><span class="op" id="3142229">.</span><span class="ident" id="3142230">Implements</span><span class="op" id="3142240">(</span><span class="ident" id="3142241">fmtStringerType</span><span class="op" id="3142256">)</span><span class="op" id="3142257">)</span>&nbsp;<span class="op" id="3142259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142264">v</span>&nbsp;<span class="op" id="3142266">=</span>&nbsp;<span class="ident" id="3142268">v</span><span class="op" id="3142269">.</span><span class="ident" id="3142270">Addr</span><span class="op" id="3142274">(</span><span class="op" id="3142275">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3142279">}</span>&nbsp;<span class="keyword" id="3142281">else</span>&nbsp;<span class="op" id="3142286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142291">switch</span>&nbsp;<span class="ident" id="3142298">v</span><span class="op" id="3142299">.</span><span class="ident" id="3142300">Kind</span><span class="op" id="3142304">(</span><span class="op" id="3142305">)</span>&nbsp;<span class="op" id="3142307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142312">case</span>&nbsp;<span class="ident" id="3142317">reflect</span><span class="op" id="3142324">.</span><span class="ident" id="3142325">Chan</span><span class="op" id="3142329">,</span>&nbsp;<span class="ident" id="3142331">reflect</span><span class="op" id="3142338">.</span><span class="ident" id="3142339">Func</span><span class="op" id="3142343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142349">return</span>&nbsp;<span class="ident" id="3142356">nil</span><span class="op" id="3142359">,</span>&nbsp;<span class="builtintype" id="3142361">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3142370">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3142374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3142377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142380">return</span>&nbsp;<span class="ident" id="3142387">v</span><span class="op" id="3142388">.</span><span class="ident" id="3142389">Interface</span><span class="op" id="3142398">(</span><span class="op" id="3142399">)</span><span class="op" id="3142400">,</span>&nbsp;<span class="builtintype" id="3142402">true</span><br>
<span class="lineno"></span><span class="op" id="3142407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="3142410">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142476">type</span>&nbsp;<span class="ident" id="3142481">rvs</span>&nbsp;<span class="op" id="3142485">[</span><span class="op" id="3142486">]</span><span class="ident" id="3142487">reflect</span><span class="op" id="3142494">.</span><span class="ident" id="3142495">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142502">func</span>&nbsp;<span class="op" id="3142507">(</span><span class="ident" id="3142508">x</span>&nbsp;<span class="ident" id="3142510">rvs</span><span class="op" id="3142513">)</span>&nbsp;<span class="ident" id="3142515">Len</span><span class="op" id="3142518">(</span><span class="op" id="3142519">)</span>&nbsp;<span class="builtintype" id="3142521">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3142530">{</span>&nbsp;<span class="keyword" id="3142532">return</span>&nbsp;<span class="builtinfunc" id="3142539">len</span><span class="op" id="3142542">(</span><span class="ident" id="3142543">x</span><span class="op" id="3142544">)</span>&nbsp;<span class="op" id="3142546">}</span><br>
<span class="lineno">810</span><span class="keyword" id="3142548">func</span>&nbsp;<span class="op" id="3142553">(</span><span class="ident" id="3142554">x</span>&nbsp;<span class="ident" id="3142556">rvs</span><span class="op" id="3142559">)</span>&nbsp;<span class="ident" id="3142561">Swap</span><span class="op" id="3142565">(</span><span class="ident" id="3142566">i</span><span class="op" id="3142567">,</span>&nbsp;<span class="ident" id="3142569">j</span>&nbsp;<span class="builtintype" id="3142571">int</span><span class="op" id="3142574">)</span>&nbsp;<span class="op" id="3142576">{</span>&nbsp;<span class="ident" id="3142578">x</span><span class="op" id="3142579">[</span><span class="ident" id="3142580">i</span><span class="op" id="3142581">]</span><span class="op" id="3142582">,</span>&nbsp;<span class="ident" id="3142584">x</span><span class="op" id="3142585">[</span><span class="ident" id="3142586">j</span><span class="op" id="3142587">]</span>&nbsp;<span class="op" id="3142589">=</span>&nbsp;<span class="ident" id="3142591">x</span><span class="op" id="3142592">[</span><span class="ident" id="3142593">j</span><span class="op" id="3142594">]</span><span class="op" id="3142595">,</span>&nbsp;<span class="ident" id="3142597">x</span><span class="op" id="3142598">[</span><span class="ident" id="3142599">i</span><span class="op" id="3142600">]</span>&nbsp;<span class="op" id="3142602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142605">type</span>&nbsp;<span class="ident" id="3142610">rvInts</span>&nbsp;<span class="keyword" id="3142617">struct</span><span class="op" id="3142623">{</span>&nbsp;<span class="ident" id="3142625">rvs</span>&nbsp;<span class="op" id="3142629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142632">func</span>&nbsp;<span class="op" id="3142637">(</span><span class="ident" id="3142638">x</span>&nbsp;<span class="ident" id="3142640">rvInts</span><span class="op" id="3142646">)</span>&nbsp;<span class="ident" id="3142648">Less</span><span class="op" id="3142652">(</span><span class="ident" id="3142653">i</span><span class="op" id="3142654">,</span>&nbsp;<span class="ident" id="3142656">j</span>&nbsp;<span class="builtintype" id="3142658">int</span><span class="op" id="3142661">)</span>&nbsp;<span class="builtintype" id="3142663">bool</span>&nbsp;<span class="op" id="3142668">{</span>&nbsp;<span class="keyword" id="3142670">return</span>&nbsp;<span class="ident" id="3142677">x</span><span class="op" id="3142678">.</span><span class="ident" id="3142679">rvs</span><span class="op" id="3142682">[</span><span class="ident" id="3142683">i</span><span class="op" id="3142684">]</span><span class="op" id="3142685">.</span><span class="ident" id="3142686">Int</span><span class="op" id="3142689">(</span><span class="op" id="3142690">)</span>&nbsp;<span class="op" id="3142692">&lt;</span>&nbsp;<span class="ident" id="3142694">x</span><span class="op" id="3142695">.</span><span class="ident" id="3142696">rvs</span><span class="op" id="3142699">[</span><span class="ident" id="3142700">j</span><span class="op" id="3142701">]</span><span class="op" id="3142702">.</span><span class="ident" id="3142703">Int</span><span class="op" id="3142706">(</span><span class="op" id="3142707">)</span>&nbsp;<span class="op" id="3142709">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="3142712">type</span>&nbsp;<span class="ident" id="3142717">rvUints</span>&nbsp;<span class="keyword" id="3142725">struct</span><span class="op" id="3142731">{</span>&nbsp;<span class="ident" id="3142733">rvs</span>&nbsp;<span class="op" id="3142737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142740">func</span>&nbsp;<span class="op" id="3142745">(</span><span class="ident" id="3142746">x</span>&nbsp;<span class="ident" id="3142748">rvUints</span><span class="op" id="3142755">)</span>&nbsp;<span class="ident" id="3142757">Less</span><span class="op" id="3142761">(</span><span class="ident" id="3142762">i</span><span class="op" id="3142763">,</span>&nbsp;<span class="ident" id="3142765">j</span>&nbsp;<span class="builtintype" id="3142767">int</span><span class="op" id="3142770">)</span>&nbsp;<span class="builtintype" id="3142772">bool</span>&nbsp;<span class="op" id="3142777">{</span>&nbsp;<span class="keyword" id="3142779">return</span>&nbsp;<span class="ident" id="3142786">x</span><span class="op" id="3142787">.</span><span class="ident" id="3142788">rvs</span><span class="op" id="3142791">[</span><span class="ident" id="3142792">i</span><span class="op" id="3142793">]</span><span class="op" id="3142794">.</span><span class="ident" id="3142795">Uint</span><span class="op" id="3142799">(</span><span class="op" id="3142800">)</span>&nbsp;<span class="op" id="3142802">&lt;</span>&nbsp;<span class="ident" id="3142804">x</span><span class="op" id="3142805">.</span><span class="ident" id="3142806">rvs</span><span class="op" id="3142809">[</span><span class="ident" id="3142810">j</span><span class="op" id="3142811">]</span><span class="op" id="3142812">.</span><span class="ident" id="3142813">Uint</span><span class="op" id="3142817">(</span><span class="op" id="3142818">)</span>&nbsp;<span class="op" id="3142820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="3142823">type</span>&nbsp;<span class="ident" id="3142828">rvFloats</span>&nbsp;<span class="keyword" id="3142837">struct</span><span class="op" id="3142843">{</span>&nbsp;<span class="ident" id="3142845">rvs</span>&nbsp;<span class="op" id="3142849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142852">func</span>&nbsp;<span class="op" id="3142857">(</span><span class="ident" id="3142858">x</span>&nbsp;<span class="ident" id="3142860">rvFloats</span><span class="op" id="3142868">)</span>&nbsp;<span class="ident" id="3142870">Less</span><span class="op" id="3142874">(</span><span class="ident" id="3142875">i</span><span class="op" id="3142876">,</span>&nbsp;<span class="ident" id="3142878">j</span>&nbsp;<span class="builtintype" id="3142880">int</span><span class="op" id="3142883">)</span>&nbsp;<span class="builtintype" id="3142885">bool</span>&nbsp;<span class="op" id="3142890">{</span>&nbsp;<span class="keyword" id="3142892">return</span>&nbsp;<span class="ident" id="3142899">x</span><span class="op" id="3142900">.</span><span class="ident" id="3142901">rvs</span><span class="op" id="3142904">[</span><span class="ident" id="3142905">i</span><span class="op" id="3142906">]</span><span class="op" id="3142907">.</span><span class="ident" id="3142908">Float</span><span class="op" id="3142913">(</span><span class="op" id="3142914">)</span>&nbsp;<span class="op" id="3142916">&lt;</span>&nbsp;<span class="ident" id="3142918">x</span><span class="op" id="3142919">.</span><span class="ident" id="3142920">rvs</span><span class="op" id="3142923">[</span><span class="ident" id="3142924">j</span><span class="op" id="3142925">]</span><span class="op" id="3142926">.</span><span class="ident" id="3142927">Float</span><span class="op" id="3142932">(</span><span class="op" id="3142933">)</span>&nbsp;<span class="op" id="3142935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142938">type</span>&nbsp;<span class="ident" id="3142943">rvStrings</span>&nbsp;<span class="keyword" id="3142953">struct</span><span class="op" id="3142959">{</span>&nbsp;<span class="ident" id="3142961">rvs</span>&nbsp;<span class="op" id="3142965">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="3142968">func</span>&nbsp;<span class="op" id="3142973">(</span><span class="ident" id="3142974">x</span>&nbsp;<span class="ident" id="3142976">rvStrings</span><span class="op" id="3142985">)</span>&nbsp;<span class="ident" id="3142987">Less</span><span class="op" id="3142991">(</span><span class="ident" id="3142992">i</span><span class="op" id="3142993">,</span>&nbsp;<span class="ident" id="3142995">j</span>&nbsp;<span class="builtintype" id="3142997">int</span><span class="op" id="3143000">)</span>&nbsp;<span class="builtintype" id="3143002">bool</span>&nbsp;<span class="op" id="3143007">{</span>&nbsp;<span class="keyword" id="3143009">return</span>&nbsp;<span class="ident" id="3143016">x</span><span class="op" id="3143017">.</span><span class="ident" id="3143018">rvs</span><span class="op" id="3143021">[</span><span class="ident" id="3143022">i</span><span class="op" id="3143023">]</span><span class="op" id="3143024">.</span><span class="ident" id="3143025">String</span><span class="op" id="3143031">(</span><span class="op" id="3143032">)</span>&nbsp;<span class="op" id="3143034">&lt;</span>&nbsp;<span class="ident" id="3143036">x</span><span class="op" id="3143037">.</span><span class="ident" id="3143038">rvs</span><span class="op" id="3143041">[</span><span class="ident" id="3143042">j</span><span class="op" id="3143043">]</span><span class="op" id="3143044">.</span><span class="ident" id="3143045">String</span><span class="op" id="3143051">(</span><span class="op" id="3143052">)</span>&nbsp;<span class="op" id="3143054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3143057">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="3143146">func</span>&nbsp;<span class="ident" id="3143151">sortKeys</span><span class="op" id="3143159">(</span><span class="ident" id="3143160">v</span>&nbsp;<span class="op" id="3143162">[</span><span class="op" id="3143163">]</span><span class="ident" id="3143164">reflect</span><span class="op" id="3143171">.</span><span class="ident" id="3143172">Value</span><span class="op" id="3143177">)</span>&nbsp;<span class="op" id="3143179">[</span><span class="op" id="3143180">]</span><span class="ident" id="3143181">reflect</span><span class="op" id="3143188">.</span><span class="ident" id="3143189">Value</span>&nbsp;<span class="op" id="3143195">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143198">if</span>&nbsp;<span class="builtinfunc" id="3143201">len</span><span class="op" id="3143204">(</span><span class="ident" id="3143205">v</span><span class="op" id="3143206">)</span>&nbsp;<span class="op" id="3143208">&lt;=</span>&nbsp;<span class="num" id="3143211">1</span>&nbsp;<span class="op" id="3143213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143217">return</span>&nbsp;<span class="ident" id="3143224">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3143227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143230">switch</span>&nbsp;<span class="ident" id="3143237">v</span><span class="op" id="3143238">[</span><span class="num" id="3143239">0</span><span class="op" id="3143240">]</span><span class="op" id="3143241">.</span><span class="ident" id="3143242">Kind</span><span class="op" id="3143246">(</span><span class="op" id="3143247">)</span>&nbsp;<span class="op" id="3143249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143252">case</span>&nbsp;<span class="ident" id="3143257">reflect</span><span class="op" id="3143264">.</span><span class="ident" id="3143265">Float32</span><span class="op" id="3143272">,</span>&nbsp;<span class="ident" id="3143274">reflect</span><span class="op" id="3143281">.</span><span class="ident" id="3143282">Float64</span><span class="op" id="3143289">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143293">sort</span><span class="op" id="3143297">.</span><span class="ident" id="3143298">Sort</span><span class="op" id="3143302">(</span><span class="ident" id="3143303">rvFloats</span><span class="op" id="3143311">{</span><span class="ident" id="3143312">v</span><span class="op" id="3143313">}</span><span class="op" id="3143314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143317">case</span>&nbsp;<span class="ident" id="3143322">reflect</span><span class="op" id="3143329">.</span><span class="ident" id="3143330">Int</span><span class="op" id="3143333">,</span>&nbsp;<span class="ident" id="3143335">reflect</span><span class="op" id="3143342">.</span><span class="ident" id="3143343">Int8</span><span class="op" id="3143347">,</span>&nbsp;<span class="ident" id="3143349">reflect</span><span class="op" id="3143356">.</span><span class="ident" id="3143357">Int16</span><span class="op" id="3143362">,</span>&nbsp;<span class="ident" id="3143364">reflect</span><span class="op" id="3143371">.</span><span class="ident" id="3143372">Int32</span><span class="op" id="3143377">,</span>&nbsp;<span class="ident" id="3143379">reflect</span><span class="op" id="3143386">.</span><span class="ident" id="3143387">Int64</span><span class="op" id="3143392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143396">sort</span><span class="op" id="3143400">.</span><span class="ident" id="3143401">Sort</span><span class="op" id="3143405">(</span><span class="ident" id="3143406">rvInts</span><span class="op" id="3143412">{</span><span class="ident" id="3143413">v</span><span class="op" id="3143414">}</span><span class="op" id="3143415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143418">case</span>&nbsp;<span class="ident" id="3143423">reflect</span><span class="op" id="3143430">.</span><span class="ident" id="3143431">String</span><span class="op" id="3143437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143441">sort</span><span class="op" id="3143445">.</span><span class="ident" id="3143446">Sort</span><span class="op" id="3143450">(</span><span class="ident" id="3143451">rvStrings</span><span class="op" id="3143460">{</span><span class="ident" id="3143461">v</span><span class="op" id="3143462">}</span><span class="op" id="3143463">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143466">case</span>&nbsp;<span class="ident" id="3143471">reflect</span><span class="op" id="3143478">.</span><span class="ident" id="3143479">Uint</span><span class="op" id="3143483">,</span>&nbsp;<span class="ident" id="3143485">reflect</span><span class="op" id="3143492">.</span><span class="ident" id="3143493">Uint8</span><span class="op" id="3143498">,</span>&nbsp;<span class="ident" id="3143500">reflect</span><span class="op" id="3143507">.</span><span class="ident" id="3143508">Uint16</span><span class="op" id="3143514">,</span>&nbsp;<span class="ident" id="3143516">reflect</span><span class="op" id="3143523">.</span><span class="ident" id="3143524">Uint32</span><span class="op" id="3143530">,</span>&nbsp;<span class="ident" id="3143532">reflect</span><span class="op" id="3143539">.</span><span class="ident" id="3143540">Uint64</span><span class="op" id="3143546">,</span>&nbsp;<span class="ident" id="3143548">reflect</span><span class="op" id="3143555">.</span><span class="ident" id="3143556">Uintptr</span><span class="op" id="3143563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143567">sort</span><span class="op" id="3143571">.</span><span class="ident" id="3143572">Sort</span><span class="op" id="3143576">(</span><span class="ident" id="3143577">rvUints</span><span class="op" id="3143584">{</span><span class="ident" id="3143585">v</span><span class="op" id="3143586">}</span><span class="op" id="3143587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3143590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143593">return</span>&nbsp;<span class="ident" id="3143600">v</span><br>
<span class="lineno"></span><span class="op" id="3143602">}</span>
</div>
</body>
</html>
