<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5243650">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5243705">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5243759">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5243810">package</span>&nbsp;<span class="ident" id="5243818">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5243828">import</span>&nbsp;<span class="op" id="5243835">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5243838">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5243845">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5243851">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5243864">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5243881">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5243889">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5243906">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5243928">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5243931">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="5244011">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="5244038">type</span>&nbsp;<span class="ident" id="5244043">Template</span>&nbsp;<span class="keyword" id="5244052">struct</span>&nbsp;<span class="op" id="5244059">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5244062">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5244098">escapeErr</span>&nbsp;<span class="builtintype" id="5244108">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5244115">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5244189">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5244258">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5244282">text</span>&nbsp;<span class="op" id="5244287">*</span><span class="ident" id="5244288">template</span><span class="op" id="5244296">.</span><span class="ident" id="5244297">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5244307">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5244374">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5244385">*</span><span class="ident" id="5244386">parse</span><span class="op" id="5244391">.</span><span class="ident" id="5244392">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5244398">*</span><span class="ident" id="5244399">nameSpace</span>&nbsp;<span class="comment" id="5244409">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="5244447">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5244450">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="5244515">var</span>&nbsp;<span class="ident" id="5244519">escapeOK</span>&nbsp;<span class="op" id="5244528">=</span>&nbsp;<span class="ident" id="5244530">fmt</span><span class="op" id="5244533">.</span><span class="ident" id="5244534">Errorf</span><span class="op" id="5244540">(</span><span class="string" id="5244541">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="5244569">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5244572">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="5244650">type</span>&nbsp;<span class="ident" id="5244655">nameSpace</span>&nbsp;<span class="keyword" id="5244665">struct</span>&nbsp;<span class="op" id="5244672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5244675">mu</span>&nbsp;&nbsp;<span class="ident" id="5244679">sync</span><span class="op" id="5244683">.</span><span class="ident" id="5244684">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5244691">set</span>&nbsp;<span class="keyword" id="5244695">map</span><span class="op" id="5244698">[</span><span class="builtintype" id="5244699">string</span><span class="op" id="5244705">]</span><span class="op" id="5244706">*</span><span class="ident" id="5244707">Template</span><br>
<span class="lineno"></span><span class="op" id="5244716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5244719">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="5244796">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="5244807">func</span>&nbsp;<span class="op" id="5244812">(</span><span class="ident" id="5244813">t</span>&nbsp;<span class="op" id="5244815">*</span><span class="ident" id="5244816">Template</span><span class="op" id="5244824">)</span>&nbsp;<span class="ident" id="5244826">Templates</span><span class="op" id="5244835">(</span><span class="op" id="5244836">)</span>&nbsp;<span class="op" id="5244838">[</span><span class="op" id="5244839">]</span><span class="op" id="5244840">*</span><span class="ident" id="5244841">Template</span>&nbsp;<span class="op" id="5244850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5244853">ns</span>&nbsp;<span class="op" id="5244856">:=</span>&nbsp;<span class="ident" id="5244859">t</span><span class="op" id="5244860">.</span><span class="ident" id="5244861">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5244872">ns</span><span class="op" id="5244874">.</span><span class="ident" id="5244875">mu</span><span class="op" id="5244877">.</span><span class="ident" id="5244878">Lock</span><span class="op" id="5244882">(</span><span class="op" id="5244883">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5244886">defer</span>&nbsp;<span class="ident" id="5244892">ns</span><span class="op" id="5244894">.</span><span class="ident" id="5244895">mu</span><span class="op" id="5244897">.</span><span class="ident" id="5244898">Unlock</span><span class="op" id="5244904">(</span><span class="op" id="5244905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5244908">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5244955">m</span>&nbsp;<span class="op" id="5244957">:=</span>&nbsp;<span class="builtinfunc" id="5244960">make</span><span class="op" id="5244964">(</span><span class="op" id="5244965">[</span><span class="op" id="5244966">]</span><span class="op" id="5244967">*</span><span class="ident" id="5244968">Template</span><span class="op" id="5244976">,</span>&nbsp;<span class="num" id="5244978">0</span><span class="op" id="5244979">,</span>&nbsp;<span class="builtinfunc" id="5244981">len</span><span class="op" id="5244984">(</span><span class="ident" id="5244985">ns</span><span class="op" id="5244987">.</span><span class="ident" id="5244988">set</span><span class="op" id="5244991">)</span><span class="op" id="5244992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5244995">for</span>&nbsp;<span class="ident" id="5244999">_</span><span class="op" id="5245000">,</span>&nbsp;<span class="ident" id="5245002">v</span>&nbsp;<span class="op" id="5245004">:=</span>&nbsp;<span class="keyword" id="5245007">range</span>&nbsp;<span class="ident" id="5245013">ns</span><span class="op" id="5245015">.</span><span class="ident" id="5245016">set</span>&nbsp;<span class="op" id="5245020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5245024">m</span>&nbsp;<span class="op" id="5245026">=</span>&nbsp;<span class="builtinfunc" id="5245028">append</span><span class="op" id="5245034">(</span><span class="ident" id="5245035">m</span><span class="op" id="5245036">,</span>&nbsp;<span class="ident" id="5245038">v</span><span class="op" id="5245039">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5245042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245045">return</span>&nbsp;<span class="ident" id="5245052">m</span><br>
<span class="lineno"></span><span class="op" id="5245054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5245057">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="5245101">func</span>&nbsp;<span class="op" id="5245106">(</span><span class="ident" id="5245107">t</span>&nbsp;<span class="op" id="5245109">*</span><span class="ident" id="5245110">Template</span><span class="op" id="5245118">)</span>&nbsp;<span class="ident" id="5245120">escape</span><span class="op" id="5245126">(</span><span class="op" id="5245127">)</span>&nbsp;<span class="builtintype" id="5245129">error</span>&nbsp;<span class="op" id="5245135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5245138">t</span><span class="op" id="5245139">.</span><span class="ident" id="5245140">nameSpace</span><span class="op" id="5245149">.</span><span class="ident" id="5245150">mu</span><span class="op" id="5245152">.</span><span class="ident" id="5245153">Lock</span><span class="op" id="5245157">(</span><span class="op" id="5245158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245161">defer</span>&nbsp;<span class="ident" id="5245167">t</span><span class="op" id="5245168">.</span><span class="ident" id="5245169">nameSpace</span><span class="op" id="5245178">.</span><span class="ident" id="5245179">mu</span><span class="op" id="5245181">.</span><span class="ident" id="5245182">Unlock</span><span class="op" id="5245188">(</span><span class="op" id="5245189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245192">if</span>&nbsp;<span class="ident" id="5245195">t</span><span class="op" id="5245196">.</span><span class="ident" id="5245197">escapeErr</span>&nbsp;<span class="op" id="5245207">==</span>&nbsp;<span class="ident" id="5245210">nil</span>&nbsp;<span class="op" id="5245214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245218">if</span>&nbsp;<span class="ident" id="5245221">err</span>&nbsp;<span class="op" id="5245225">:=</span>&nbsp;<span class="ident" id="5245228">escapeTemplate</span><span class="op" id="5245242">(</span><span class="ident" id="5245243">t</span><span class="op" id="5245244">,</span>&nbsp;<span class="ident" id="5245246">t</span><span class="op" id="5245247">.</span><span class="ident" id="5245248">text</span><span class="op" id="5245252">.</span><span class="ident" id="5245253">Root</span><span class="op" id="5245257">,</span>&nbsp;<span class="ident" id="5245259">t</span><span class="op" id="5245260">.</span><span class="ident" id="5245261">Name</span><span class="op" id="5245265">(</span><span class="op" id="5245266">)</span><span class="op" id="5245267">)</span><span class="op" id="5245268">;</span>&nbsp;<span class="ident" id="5245270">err</span>&nbsp;<span class="op" id="5245274">!=</span>&nbsp;<span class="ident" id="5245277">nil</span>&nbsp;<span class="op" id="5245281">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245286">return</span>&nbsp;<span class="ident" id="5245293">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5245299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5245302">}</span>&nbsp;<span class="keyword" id="5245304">else</span>&nbsp;<span class="keyword" id="5245309">if</span>&nbsp;<span class="ident" id="5245312">t</span><span class="op" id="5245313">.</span><span class="ident" id="5245314">escapeErr</span>&nbsp;<span class="op" id="5245324">!=</span>&nbsp;<span class="ident" id="5245327">escapeOK</span>&nbsp;<span class="op" id="5245336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245340">return</span>&nbsp;<span class="ident" id="5245347">t</span><span class="op" id="5245348">.</span><span class="ident" id="5245349">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5245360">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245363">return</span>&nbsp;<span class="ident" id="5245370">nil</span><br>
<span class="lineno"></span><span class="op" id="5245374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5245377">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="5245444">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="5245473">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5245541">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5245614">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5245636">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5245686">func</span>&nbsp;<span class="op" id="5245691">(</span><span class="ident" id="5245692">t</span>&nbsp;<span class="op" id="5245694">*</span><span class="ident" id="5245695">Template</span><span class="op" id="5245703">)</span>&nbsp;<span class="ident" id="5245705">Execute</span><span class="op" id="5245712">(</span><span class="ident" id="5245713">wr</span>&nbsp;<span class="ident" id="5245716">io</span><span class="op" id="5245718">.</span><span class="ident" id="5245719">Writer</span><span class="op" id="5245725">,</span>&nbsp;<span class="ident" id="5245727">data</span>&nbsp;<span class="keyword" id="5245732">interface</span><span class="op" id="5245741">{</span><span class="op" id="5245742">}</span><span class="op" id="5245743">)</span>&nbsp;<span class="builtintype" id="5245745">error</span>&nbsp;<span class="op" id="5245751">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245754">if</span>&nbsp;<span class="ident" id="5245757">err</span>&nbsp;<span class="op" id="5245761">:=</span>&nbsp;<span class="ident" id="5245764">t</span><span class="op" id="5245765">.</span><span class="ident" id="5245766">escape</span><span class="op" id="5245772">(</span><span class="op" id="5245773">)</span><span class="op" id="5245774">;</span>&nbsp;<span class="ident" id="5245776">err</span>&nbsp;<span class="op" id="5245780">!=</span>&nbsp;<span class="ident" id="5245783">nil</span>&nbsp;<span class="op" id="5245787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245791">return</span>&nbsp;<span class="ident" id="5245798">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5245803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5245806">return</span>&nbsp;<span class="ident" id="5245813">t</span><span class="op" id="5245814">.</span><span class="ident" id="5245815">text</span><span class="op" id="5245819">.</span><span class="ident" id="5245820">Execute</span><span class="op" id="5245827">(</span><span class="ident" id="5245828">wr</span><span class="op" id="5245830">,</span>&nbsp;<span class="ident" id="5245832">data</span><span class="op" id="5245836">)</span><br>
<span class="lineno"></span><span class="op" id="5245838">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5245841">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="5245918">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="5245984">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5246052">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="5246125">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5246147">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5246197">func</span>&nbsp;<span class="op" id="5246202">(</span><span class="ident" id="5246203">t</span>&nbsp;<span class="op" id="5246205">*</span><span class="ident" id="5246206">Template</span><span class="op" id="5246214">)</span>&nbsp;<span class="ident" id="5246216">ExecuteTemplate</span><span class="op" id="5246231">(</span><span class="ident" id="5246232">wr</span>&nbsp;<span class="ident" id="5246235">io</span><span class="op" id="5246237">.</span><span class="ident" id="5246238">Writer</span><span class="op" id="5246244">,</span>&nbsp;<span class="ident" id="5246246">name</span>&nbsp;<span class="builtintype" id="5246251">string</span><span class="op" id="5246257">,</span>&nbsp;<span class="ident" id="5246259">data</span>&nbsp;<span class="keyword" id="5246264">interface</span><span class="op" id="5246273">{</span><span class="op" id="5246274">}</span><span class="op" id="5246275">)</span>&nbsp;<span class="builtintype" id="5246277">error</span>&nbsp;<span class="op" id="5246283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5246286">tmpl</span><span class="op" id="5246290">,</span>&nbsp;<span class="ident" id="5246292">err</span>&nbsp;<span class="op" id="5246296">:=</span>&nbsp;<span class="ident" id="5246299">t</span><span class="op" id="5246300">.</span><span class="ident" id="5246301">lookupAndEscapeTemplate</span><span class="op" id="5246324">(</span><span class="ident" id="5246325">name</span><span class="op" id="5246329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246332">if</span>&nbsp;<span class="ident" id="5246335">err</span>&nbsp;<span class="op" id="5246339">!=</span>&nbsp;<span class="ident" id="5246342">nil</span>&nbsp;<span class="op" id="5246346">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246350">return</span>&nbsp;<span class="ident" id="5246357">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5246362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246365">return</span>&nbsp;<span class="ident" id="5246372">tmpl</span><span class="op" id="5246376">.</span><span class="ident" id="5246377">text</span><span class="op" id="5246381">.</span><span class="ident" id="5246382">Execute</span><span class="op" id="5246389">(</span><span class="ident" id="5246390">wr</span><span class="op" id="5246392">,</span>&nbsp;<span class="ident" id="5246394">data</span><span class="op" id="5246398">)</span><br>
<span class="lineno"></span><span class="op" id="5246400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="5246403">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5246479">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="5246552">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5246565">func</span>&nbsp;<span class="op" id="5246570">(</span><span class="ident" id="5246571">t</span>&nbsp;<span class="op" id="5246573">*</span><span class="ident" id="5246574">Template</span><span class="op" id="5246582">)</span>&nbsp;<span class="ident" id="5246584">lookupAndEscapeTemplate</span><span class="op" id="5246607">(</span><span class="ident" id="5246608">name</span>&nbsp;<span class="builtintype" id="5246613">string</span><span class="op" id="5246619">)</span>&nbsp;<span class="op" id="5246621">(</span><span class="ident" id="5246622">tmpl</span>&nbsp;<span class="op" id="5246627">*</span><span class="ident" id="5246628">Template</span><span class="op" id="5246636">,</span>&nbsp;<span class="ident" id="5246638">err</span>&nbsp;<span class="builtintype" id="5246642">error</span><span class="op" id="5246647">)</span>&nbsp;<span class="op" id="5246649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5246652">t</span><span class="op" id="5246653">.</span><span class="ident" id="5246654">nameSpace</span><span class="op" id="5246663">.</span><span class="ident" id="5246664">mu</span><span class="op" id="5246666">.</span><span class="ident" id="5246667">Lock</span><span class="op" id="5246671">(</span><span class="op" id="5246672">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246675">defer</span>&nbsp;<span class="ident" id="5246681">t</span><span class="op" id="5246682">.</span><span class="ident" id="5246683">nameSpace</span><span class="op" id="5246692">.</span><span class="ident" id="5246693">mu</span><span class="op" id="5246695">.</span><span class="ident" id="5246696">Unlock</span><span class="op" id="5246702">(</span><span class="op" id="5246703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5246706">tmpl</span>&nbsp;<span class="op" id="5246711">=</span>&nbsp;<span class="ident" id="5246713">t</span><span class="op" id="5246714">.</span><span class="ident" id="5246715">set</span><span class="op" id="5246718">[</span><span class="ident" id="5246719">name</span><span class="op" id="5246723">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246726">if</span>&nbsp;<span class="ident" id="5246729">tmpl</span>&nbsp;<span class="op" id="5246734">==</span>&nbsp;<span class="ident" id="5246737">nil</span>&nbsp;<span class="op" id="5246741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246745">return</span>&nbsp;<span class="ident" id="5246752">nil</span><span class="op" id="5246755">,</span>&nbsp;<span class="ident" id="5246757">fmt</span><span class="op" id="5246760">.</span><span class="ident" id="5246761">Errorf</span><span class="op" id="5246767">(</span><span class="string" id="5246768">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="5246800">,</span>&nbsp;<span class="ident" id="5246802">name</span><span class="op" id="5246806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5246809">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246812">if</span>&nbsp;<span class="ident" id="5246815">tmpl</span><span class="op" id="5246819">.</span><span class="ident" id="5246820">escapeErr</span>&nbsp;<span class="op" id="5246830">!=</span>&nbsp;<span class="ident" id="5246833">nil</span>&nbsp;<span class="op" id="5246837">&amp;&amp;</span>&nbsp;<span class="ident" id="5246840">tmpl</span><span class="op" id="5246844">.</span><span class="ident" id="5246845">escapeErr</span>&nbsp;<span class="op" id="5246855">!=</span>&nbsp;<span class="ident" id="5246858">escapeOK</span>&nbsp;<span class="op" id="5246867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246871">return</span>&nbsp;<span class="ident" id="5246878">nil</span><span class="op" id="5246881">,</span>&nbsp;<span class="ident" id="5246883">tmpl</span><span class="op" id="5246887">.</span><span class="ident" id="5246888">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5246899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246902">if</span>&nbsp;<span class="ident" id="5246905">tmpl</span><span class="op" id="5246909">.</span><span class="ident" id="5246910">text</span><span class="op" id="5246914">.</span><span class="ident" id="5246915">Tree</span>&nbsp;<span class="op" id="5246920">==</span>&nbsp;<span class="ident" id="5246923">nil</span>&nbsp;<span class="op" id="5246927">||</span>&nbsp;<span class="ident" id="5246930">tmpl</span><span class="op" id="5246934">.</span><span class="ident" id="5246935">text</span><span class="op" id="5246939">.</span><span class="ident" id="5246940">Root</span>&nbsp;<span class="op" id="5246945">==</span>&nbsp;<span class="ident" id="5246948">nil</span>&nbsp;<span class="op" id="5246952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5246956">return</span>&nbsp;<span class="ident" id="5246963">nil</span><span class="op" id="5246966">,</span>&nbsp;<span class="ident" id="5246968">fmt</span><span class="op" id="5246971">.</span><span class="ident" id="5246972">Errorf</span><span class="op" id="5246978">(</span><span class="string" id="5246979">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="5247024">,</span>&nbsp;<span class="ident" id="5247026">name</span><span class="op" id="5247030">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5247033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5247036">if</span>&nbsp;<span class="ident" id="5247039">t</span><span class="op" id="5247040">.</span><span class="ident" id="5247041">text</span><span class="op" id="5247045">.</span><span class="ident" id="5247046">Lookup</span><span class="op" id="5247052">(</span><span class="ident" id="5247053">name</span><span class="op" id="5247057">)</span>&nbsp;<span class="op" id="5247059">==</span>&nbsp;<span class="ident" id="5247062">nil</span>&nbsp;<span class="op" id="5247066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5247070">panic</span><span class="op" id="5247075">(</span><span class="string" id="5247076">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="5247137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5247140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5247143">if</span>&nbsp;<span class="ident" id="5247146">tmpl</span><span class="op" id="5247150">.</span><span class="ident" id="5247151">escapeErr</span>&nbsp;<span class="op" id="5247161">==</span>&nbsp;<span class="ident" id="5247164">nil</span>&nbsp;<span class="op" id="5247168">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5247172">err</span>&nbsp;<span class="op" id="5247176">=</span>&nbsp;<span class="ident" id="5247178">escapeTemplate</span><span class="op" id="5247192">(</span><span class="ident" id="5247193">tmpl</span><span class="op" id="5247197">,</span>&nbsp;<span class="ident" id="5247199">tmpl</span><span class="op" id="5247203">.</span><span class="ident" id="5247204">text</span><span class="op" id="5247208">.</span><span class="ident" id="5247209">Root</span><span class="op" id="5247213">,</span>&nbsp;<span class="ident" id="5247215">name</span><span class="op" id="5247219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5247222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5247225">return</span>&nbsp;<span class="ident" id="5247232">tmpl</span><span class="op" id="5247236">,</span>&nbsp;<span class="ident" id="5247238">err</span><br>
<span class="lineno"></span><span class="op" id="5247242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="5247245">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="5247315">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5247381">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="5247453">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="5247526">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="5247590">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="5247661">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="5247728">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="5247786">func</span>&nbsp;<span class="op" id="5247791">(</span><span class="ident" id="5247792">t</span>&nbsp;<span class="op" id="5247794">*</span><span class="ident" id="5247795">Template</span><span class="op" id="5247803">)</span>&nbsp;<span class="ident" id="5247805">Parse</span><span class="op" id="5247810">(</span><span class="ident" id="5247811">src</span>&nbsp;<span class="builtintype" id="5247815">string</span><span class="op" id="5247821">)</span>&nbsp;<span class="op" id="5247823">(</span><span class="op" id="5247824">*</span><span class="ident" id="5247825">Template</span><span class="op" id="5247833">,</span>&nbsp;<span class="builtintype" id="5247835">error</span><span class="op" id="5247840">)</span>&nbsp;<span class="op" id="5247842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5247845">t</span><span class="op" id="5247846">.</span><span class="ident" id="5247847">nameSpace</span><span class="op" id="5247856">.</span><span class="ident" id="5247857">mu</span><span class="op" id="5247859">.</span><span class="ident" id="5247860">Lock</span><span class="op" id="5247864">(</span><span class="op" id="5247865">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5247868">t</span><span class="op" id="5247869">.</span><span class="ident" id="5247870">escapeErr</span>&nbsp;<span class="op" id="5247880">=</span>&nbsp;<span class="ident" id="5247882">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5247887">t</span><span class="op" id="5247888">.</span><span class="ident" id="5247889">nameSpace</span><span class="op" id="5247898">.</span><span class="ident" id="5247899">mu</span><span class="op" id="5247901">.</span><span class="ident" id="5247902">Unlock</span><span class="op" id="5247908">(</span><span class="op" id="5247909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5247912">ret</span><span class="op" id="5247915">,</span>&nbsp;<span class="ident" id="5247917">err</span>&nbsp;<span class="op" id="5247921">:=</span>&nbsp;<span class="ident" id="5247924">t</span><span class="op" id="5247925">.</span><span class="ident" id="5247926">text</span><span class="op" id="5247930">.</span><span class="ident" id="5247931">Parse</span><span class="op" id="5247936">(</span><span class="ident" id="5247937">src</span><span class="op" id="5247940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5247943">if</span>&nbsp;<span class="ident" id="5247946">err</span>&nbsp;<span class="op" id="5247950">!=</span>&nbsp;<span class="ident" id="5247953">nil</span>&nbsp;<span class="op" id="5247957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5247961">return</span>&nbsp;<span class="ident" id="5247968">nil</span><span class="op" id="5247971">,</span>&nbsp;<span class="ident" id="5247973">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5247978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5247981">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5248051">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5248104">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5248165">t</span><span class="op" id="5248166">.</span><span class="ident" id="5248167">nameSpace</span><span class="op" id="5248176">.</span><span class="ident" id="5248177">mu</span><span class="op" id="5248179">.</span><span class="ident" id="5248180">Lock</span><span class="op" id="5248184">(</span><span class="op" id="5248185">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5248188">defer</span>&nbsp;<span class="ident" id="5248194">t</span><span class="op" id="5248195">.</span><span class="ident" id="5248196">nameSpace</span><span class="op" id="5248205">.</span><span class="ident" id="5248206">mu</span><span class="op" id="5248208">.</span><span class="ident" id="5248209">Unlock</span><span class="op" id="5248215">(</span><span class="op" id="5248216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5248219">for</span>&nbsp;<span class="ident" id="5248223">_</span><span class="op" id="5248224">,</span>&nbsp;<span class="ident" id="5248226">v</span>&nbsp;<span class="op" id="5248228">:=</span>&nbsp;<span class="keyword" id="5248231">range</span>&nbsp;<span class="ident" id="5248237">ret</span><span class="op" id="5248240">.</span><span class="ident" id="5248241">Templates</span><span class="op" id="5248250">(</span><span class="op" id="5248251">)</span>&nbsp;<span class="op" id="5248253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5248257">name</span>&nbsp;<span class="op" id="5248262">:=</span>&nbsp;<span class="ident" id="5248265">v</span><span class="op" id="5248266">.</span><span class="ident" id="5248267">Name</span><span class="op" id="5248271">(</span><span class="op" id="5248272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5248276">tmpl</span>&nbsp;<span class="op" id="5248281">:=</span>&nbsp;<span class="ident" id="5248284">t</span><span class="op" id="5248285">.</span><span class="ident" id="5248286">set</span><span class="op" id="5248289">[</span><span class="ident" id="5248290">name</span><span class="op" id="5248294">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5248298">if</span>&nbsp;<span class="ident" id="5248301">tmpl</span>&nbsp;<span class="op" id="5248306">==</span>&nbsp;<span class="ident" id="5248309">nil</span>&nbsp;<span class="op" id="5248313">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5248318">tmpl</span>&nbsp;<span class="op" id="5248323">=</span>&nbsp;<span class="ident" id="5248325">t</span><span class="op" id="5248326">.</span><span class="builtinfunc" id="5248327">new</span><span class="op" id="5248330">(</span><span class="ident" id="5248331">name</span><span class="op" id="5248335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5248339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5248343">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5248422">tmpl</span><span class="op" id="5248426">.</span><span class="ident" id="5248427">escapeErr</span>&nbsp;<span class="op" id="5248437">=</span>&nbsp;<span class="ident" id="5248439">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5248445">tmpl</span><span class="op" id="5248449">.</span><span class="ident" id="5248450">text</span>&nbsp;<span class="op" id="5248455">=</span>&nbsp;<span class="ident" id="5248457">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5248461">tmpl</span><span class="op" id="5248465">.</span><span class="ident" id="5248466">Tree</span>&nbsp;<span class="op" id="5248471">=</span>&nbsp;<span class="ident" id="5248473">v</span><span class="op" id="5248474">.</span><span class="ident" id="5248475">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5248481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5248484">return</span>&nbsp;<span class="ident" id="5248491">t</span><span class="op" id="5248492">,</span>&nbsp;<span class="ident" id="5248494">nil</span><br>
<span class="lineno"></span><span class="op" id="5248498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="5248501">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="5248569">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="5248598">//</span><br>
<span class="lineno"></span><span class="comment" id="5248601">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5248656">func</span>&nbsp;<span class="op" id="5248661">(</span><span class="ident" id="5248662">t</span>&nbsp;<span class="op" id="5248664">*</span><span class="ident" id="5248665">Template</span><span class="op" id="5248673">)</span>&nbsp;<span class="ident" id="5248675">AddParseTree</span><span class="op" id="5248687">(</span><span class="ident" id="5248688">name</span>&nbsp;<span class="builtintype" id="5248693">string</span><span class="op" id="5248699">,</span>&nbsp;<span class="ident" id="5248701">tree</span>&nbsp;<span class="op" id="5248706">*</span><span class="ident" id="5248707">parse</span><span class="op" id="5248712">.</span><span class="ident" id="5248713">Tree</span><span class="op" id="5248717">)</span>&nbsp;<span class="op" id="5248719">(</span><span class="op" id="5248720">*</span><span class="ident" id="5248721">Template</span><span class="op" id="5248729">,</span>&nbsp;<span class="builtintype" id="5248731">error</span><span class="op" id="5248736">)</span>&nbsp;<span class="op" id="5248738">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5248741">t</span><span class="op" id="5248742">.</span><span class="ident" id="5248743">nameSpace</span><span class="op" id="5248752">.</span><span class="ident" id="5248753">mu</span><span class="op" id="5248755">.</span><span class="ident" id="5248756">Lock</span><span class="op" id="5248760">(</span><span class="op" id="5248761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5248764">defer</span>&nbsp;<span class="ident" id="5248770">t</span><span class="op" id="5248771">.</span><span class="ident" id="5248772">nameSpace</span><span class="op" id="5248781">.</span><span class="ident" id="5248782">mu</span><span class="op" id="5248784">.</span><span class="ident" id="5248785">Unlock</span><span class="op" id="5248791">(</span><span class="op" id="5248792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5248795">if</span>&nbsp;<span class="ident" id="5248798">t</span><span class="op" id="5248799">.</span><span class="ident" id="5248800">escapeErr</span>&nbsp;<span class="op" id="5248810">!=</span>&nbsp;<span class="ident" id="5248813">nil</span>&nbsp;<span class="op" id="5248817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5248821">return</span>&nbsp;<span class="ident" id="5248828">nil</span><span class="op" id="5248831">,</span>&nbsp;<span class="ident" id="5248833">fmt</span><span class="op" id="5248836">.</span><span class="ident" id="5248837">Errorf</span><span class="op" id="5248843">(</span><span class="string" id="5248844">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5248908">,</span>&nbsp;<span class="ident" id="5248910">t</span><span class="op" id="5248911">.</span><span class="ident" id="5248912">Name</span><span class="op" id="5248916">(</span><span class="op" id="5248917">)</span><span class="op" id="5248918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5248921">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5248924">text</span><span class="op" id="5248928">,</span>&nbsp;<span class="ident" id="5248930">err</span>&nbsp;<span class="op" id="5248934">:=</span>&nbsp;<span class="ident" id="5248937">t</span><span class="op" id="5248938">.</span><span class="ident" id="5248939">text</span><span class="op" id="5248943">.</span><span class="ident" id="5248944">AddParseTree</span><span class="op" id="5248956">(</span><span class="ident" id="5248957">name</span><span class="op" id="5248961">,</span>&nbsp;<span class="ident" id="5248963">tree</span><span class="op" id="5248967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5248970">if</span>&nbsp;<span class="ident" id="5248973">err</span>&nbsp;<span class="op" id="5248977">!=</span>&nbsp;<span class="ident" id="5248980">nil</span>&nbsp;<span class="op" id="5248984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5248988">return</span>&nbsp;<span class="ident" id="5248995">nil</span><span class="op" id="5248998">,</span>&nbsp;<span class="ident" id="5249000">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5249005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249008">ret</span>&nbsp;<span class="op" id="5249012">:=</span>&nbsp;<span class="op" id="5249015">&amp;</span><span class="ident" id="5249016">Template</span><span class="op" id="5249024">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249028">nil</span><span class="op" id="5249031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249035">text</span><span class="op" id="5249039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249043">text</span><span class="op" id="5249047">.</span><span class="ident" id="5249048">Tree</span><span class="op" id="5249052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249056">t</span><span class="op" id="5249057">.</span><span class="ident" id="5249058">nameSpace</span><span class="op" id="5249067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5249070">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249073">t</span><span class="op" id="5249074">.</span><span class="ident" id="5249075">set</span><span class="op" id="5249078">[</span><span class="ident" id="5249079">name</span><span class="op" id="5249083">]</span>&nbsp;<span class="op" id="5249085">=</span>&nbsp;<span class="ident" id="5249087">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5249092">return</span>&nbsp;<span class="ident" id="5249099">ret</span><span class="op" id="5249102">,</span>&nbsp;<span class="ident" id="5249104">nil</span><br>
<span class="lineno"></span><span class="op" id="5249108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5249111">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="5249182">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5249259">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="5249334">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="5249413">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="5249491">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="5249542">//</span><br>
<span class="lineno"></span><span class="comment" id="5249545">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5249600">func</span>&nbsp;<span class="op" id="5249605">(</span><span class="ident" id="5249606">t</span>&nbsp;<span class="op" id="5249608">*</span><span class="ident" id="5249609">Template</span><span class="op" id="5249617">)</span>&nbsp;<span class="ident" id="5249619">Clone</span><span class="op" id="5249624">(</span><span class="op" id="5249625">)</span>&nbsp;<span class="op" id="5249627">(</span><span class="op" id="5249628">*</span><span class="ident" id="5249629">Template</span><span class="op" id="5249637">,</span>&nbsp;<span class="builtintype" id="5249639">error</span><span class="op" id="5249644">)</span>&nbsp;<span class="op" id="5249646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249649">t</span><span class="op" id="5249650">.</span><span class="ident" id="5249651">nameSpace</span><span class="op" id="5249660">.</span><span class="ident" id="5249661">mu</span><span class="op" id="5249663">.</span><span class="ident" id="5249664">Lock</span><span class="op" id="5249668">(</span><span class="op" id="5249669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5249672">defer</span>&nbsp;<span class="ident" id="5249678">t</span><span class="op" id="5249679">.</span><span class="ident" id="5249680">nameSpace</span><span class="op" id="5249689">.</span><span class="ident" id="5249690">mu</span><span class="op" id="5249692">.</span><span class="ident" id="5249693">Unlock</span><span class="op" id="5249699">(</span><span class="op" id="5249700">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5249703">if</span>&nbsp;<span class="ident" id="5249706">t</span><span class="op" id="5249707">.</span><span class="ident" id="5249708">escapeErr</span>&nbsp;<span class="op" id="5249718">!=</span>&nbsp;<span class="ident" id="5249721">nil</span>&nbsp;<span class="op" id="5249725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5249729">return</span>&nbsp;<span class="ident" id="5249736">nil</span><span class="op" id="5249739">,</span>&nbsp;<span class="ident" id="5249741">fmt</span><span class="op" id="5249744">.</span><span class="ident" id="5249745">Errorf</span><span class="op" id="5249751">(</span><span class="string" id="5249752">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5249806">,</span>&nbsp;<span class="ident" id="5249808">t</span><span class="op" id="5249809">.</span><span class="ident" id="5249810">Name</span><span class="op" id="5249814">(</span><span class="op" id="5249815">)</span><span class="op" id="5249816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5249819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249822">textClone</span><span class="op" id="5249831">,</span>&nbsp;<span class="ident" id="5249833">err</span>&nbsp;<span class="op" id="5249837">:=</span>&nbsp;<span class="ident" id="5249840">t</span><span class="op" id="5249841">.</span><span class="ident" id="5249842">text</span><span class="op" id="5249846">.</span><span class="ident" id="5249847">Clone</span><span class="op" id="5249852">(</span><span class="op" id="5249853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5249856">if</span>&nbsp;<span class="ident" id="5249859">err</span>&nbsp;<span class="op" id="5249863">!=</span>&nbsp;<span class="ident" id="5249866">nil</span>&nbsp;<span class="op" id="5249870">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5249874">return</span>&nbsp;<span class="ident" id="5249881">nil</span><span class="op" id="5249884">,</span>&nbsp;<span class="ident" id="5249886">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5249891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249894">ret</span>&nbsp;<span class="op" id="5249898">:=</span>&nbsp;<span class="op" id="5249901">&amp;</span><span class="ident" id="5249902">Template</span><span class="op" id="5249910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249914">nil</span><span class="op" id="5249917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249921">textClone</span><span class="op" id="5249930">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249934">textClone</span><span class="op" id="5249943">.</span><span class="ident" id="5249944">Tree</span><span class="op" id="5249948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5249952">&amp;</span><span class="ident" id="5249953">nameSpace</span><span class="op" id="5249962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5249967">set</span><span class="op" id="5249970">:</span>&nbsp;<span class="builtinfunc" id="5249972">make</span><span class="op" id="5249976">(</span><span class="keyword" id="5249977">map</span><span class="op" id="5249980">[</span><span class="builtintype" id="5249981">string</span><span class="op" id="5249987">]</span><span class="op" id="5249988">*</span><span class="ident" id="5249989">Template</span><span class="op" id="5249997">)</span><span class="op" id="5249998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5250002">}</span><span class="op" id="5250003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5250006">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5250009">for</span>&nbsp;<span class="ident" id="5250013">_</span><span class="op" id="5250014">,</span>&nbsp;<span class="ident" id="5250016">x</span>&nbsp;<span class="op" id="5250018">:=</span>&nbsp;<span class="keyword" id="5250021">range</span>&nbsp;<span class="ident" id="5250027">textClone</span><span class="op" id="5250036">.</span><span class="ident" id="5250037">Templates</span><span class="op" id="5250046">(</span><span class="op" id="5250047">)</span>&nbsp;<span class="op" id="5250049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250053">name</span>&nbsp;<span class="op" id="5250058">:=</span>&nbsp;<span class="ident" id="5250061">x</span><span class="op" id="5250062">.</span><span class="ident" id="5250063">Name</span><span class="op" id="5250067">(</span><span class="op" id="5250068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250072">src</span>&nbsp;<span class="op" id="5250076">:=</span>&nbsp;<span class="ident" id="5250079">t</span><span class="op" id="5250080">.</span><span class="ident" id="5250081">set</span><span class="op" id="5250084">[</span><span class="ident" id="5250085">name</span><span class="op" id="5250089">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5250093">if</span>&nbsp;<span class="ident" id="5250096">src</span>&nbsp;<span class="op" id="5250100">==</span>&nbsp;<span class="ident" id="5250103">nil</span>&nbsp;<span class="op" id="5250107">||</span>&nbsp;<span class="ident" id="5250110">src</span><span class="op" id="5250113">.</span><span class="ident" id="5250114">escapeErr</span>&nbsp;<span class="op" id="5250124">!=</span>&nbsp;<span class="ident" id="5250127">nil</span>&nbsp;<span class="op" id="5250131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5250136">return</span>&nbsp;<span class="ident" id="5250143">nil</span><span class="op" id="5250146">,</span>&nbsp;<span class="ident" id="5250148">fmt</span><span class="op" id="5250151">.</span><span class="ident" id="5250152">Errorf</span><span class="op" id="5250158">(</span><span class="string" id="5250159">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5250213">,</span>&nbsp;<span class="ident" id="5250215">t</span><span class="op" id="5250216">.</span><span class="ident" id="5250217">Name</span><span class="op" id="5250221">(</span><span class="op" id="5250222">)</span><span class="op" id="5250223">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5250227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250231">x</span><span class="op" id="5250232">.</span><span class="ident" id="5250233">Tree</span>&nbsp;<span class="op" id="5250238">=</span>&nbsp;<span class="ident" id="5250240">x</span><span class="op" id="5250241">.</span><span class="ident" id="5250242">Tree</span><span class="op" id="5250246">.</span><span class="ident" id="5250247">Copy</span><span class="op" id="5250251">(</span><span class="op" id="5250252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250256">ret</span><span class="op" id="5250259">.</span><span class="ident" id="5250260">set</span><span class="op" id="5250263">[</span><span class="ident" id="5250264">name</span><span class="op" id="5250268">]</span>&nbsp;<span class="op" id="5250270">=</span>&nbsp;<span class="op" id="5250272">&amp;</span><span class="ident" id="5250273">Template</span><span class="op" id="5250281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250286">nil</span><span class="op" id="5250289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250294">x</span><span class="op" id="5250295">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250300">x</span><span class="op" id="5250301">.</span><span class="ident" id="5250302">Tree</span><span class="op" id="5250306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250311">ret</span><span class="op" id="5250314">.</span><span class="ident" id="5250315">nameSpace</span><span class="op" id="5250324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5250328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5250331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5250334">return</span>&nbsp;<span class="ident" id="5250341">ret</span><span class="op" id="5250344">,</span>&nbsp;<span class="ident" id="5250346">nil</span><br>
<span class="lineno">220</span><span class="op" id="5250350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5250353">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5250411">func</span>&nbsp;<span class="ident" id="5250416">New</span><span class="op" id="5250419">(</span><span class="ident" id="5250420">name</span>&nbsp;<span class="builtintype" id="5250425">string</span><span class="op" id="5250431">)</span>&nbsp;<span class="op" id="5250433">*</span><span class="ident" id="5250434">Template</span>&nbsp;<span class="op" id="5250443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250446">tmpl</span>&nbsp;<span class="op" id="5250451">:=</span>&nbsp;<span class="op" id="5250454">&amp;</span><span class="ident" id="5250455">Template</span><span class="op" id="5250463">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250467">nil</span><span class="op" id="5250470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250474">template</span><span class="op" id="5250482">.</span><span class="ident" id="5250483">New</span><span class="op" id="5250486">(</span><span class="ident" id="5250487">name</span><span class="op" id="5250491">)</span><span class="op" id="5250492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250496">nil</span><span class="op" id="5250499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5250503">&amp;</span><span class="ident" id="5250504">nameSpace</span><span class="op" id="5250513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250518">set</span><span class="op" id="5250521">:</span>&nbsp;<span class="builtinfunc" id="5250523">make</span><span class="op" id="5250527">(</span><span class="keyword" id="5250528">map</span><span class="op" id="5250531">[</span><span class="builtintype" id="5250532">string</span><span class="op" id="5250538">]</span><span class="op" id="5250539">*</span><span class="ident" id="5250540">Template</span><span class="op" id="5250548">)</span><span class="op" id="5250549">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5250553">}</span><span class="op" id="5250554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5250557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250560">tmpl</span><span class="op" id="5250564">.</span><span class="ident" id="5250565">set</span><span class="op" id="5250568">[</span><span class="ident" id="5250569">name</span><span class="op" id="5250573">]</span>&nbsp;<span class="op" id="5250575">=</span>&nbsp;<span class="ident" id="5250577">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5250583">return</span>&nbsp;<span class="ident" id="5250590">tmpl</span><br>
<span class="lineno"></span><span class="op" id="5250595">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="5250598">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5250665">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="5250736">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="5250805">func</span>&nbsp;<span class="op" id="5250810">(</span><span class="ident" id="5250811">t</span>&nbsp;<span class="op" id="5250813">*</span><span class="ident" id="5250814">Template</span><span class="op" id="5250822">)</span>&nbsp;<span class="ident" id="5250824">New</span><span class="op" id="5250827">(</span><span class="ident" id="5250828">name</span>&nbsp;<span class="builtintype" id="5250833">string</span><span class="op" id="5250839">)</span>&nbsp;<span class="op" id="5250841">*</span><span class="ident" id="5250842">Template</span>&nbsp;<span class="op" id="5250851">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5250854">t</span><span class="op" id="5250855">.</span><span class="ident" id="5250856">nameSpace</span><span class="op" id="5250865">.</span><span class="ident" id="5250866">mu</span><span class="op" id="5250868">.</span><span class="ident" id="5250869">Lock</span><span class="op" id="5250873">(</span><span class="op" id="5250874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5250877">defer</span>&nbsp;<span class="ident" id="5250883">t</span><span class="op" id="5250884">.</span><span class="ident" id="5250885">nameSpace</span><span class="op" id="5250894">.</span><span class="ident" id="5250895">mu</span><span class="op" id="5250897">.</span><span class="ident" id="5250898">Unlock</span><span class="op" id="5250904">(</span><span class="op" id="5250905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5250908">return</span>&nbsp;<span class="ident" id="5250915">t</span><span class="op" id="5250916">.</span><span class="builtinfunc" id="5250917">new</span><span class="op" id="5250920">(</span><span class="ident" id="5250921">name</span><span class="op" id="5250925">)</span><br>
<span class="lineno"></span><span class="op" id="5250927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="5250930">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="5250985">func</span>&nbsp;<span class="op" id="5250990">(</span><span class="ident" id="5250991">t</span>&nbsp;<span class="op" id="5250993">*</span><span class="ident" id="5250994">Template</span><span class="op" id="5251002">)</span>&nbsp;<span class="builtinfunc" id="5251004">new</span><span class="op" id="5251007">(</span><span class="ident" id="5251008">name</span>&nbsp;<span class="builtintype" id="5251013">string</span><span class="op" id="5251019">)</span>&nbsp;<span class="op" id="5251021">*</span><span class="ident" id="5251022">Template</span>&nbsp;<span class="op" id="5251031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5251034">tmpl</span>&nbsp;<span class="op" id="5251039">:=</span>&nbsp;<span class="op" id="5251042">&amp;</span><span class="ident" id="5251043">Template</span><span class="op" id="5251051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5251055">nil</span><span class="op" id="5251058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5251062">t</span><span class="op" id="5251063">.</span><span class="ident" id="5251064">text</span><span class="op" id="5251068">.</span><span class="ident" id="5251069">New</span><span class="op" id="5251072">(</span><span class="ident" id="5251073">name</span><span class="op" id="5251077">)</span><span class="op" id="5251078">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5251082">nil</span><span class="op" id="5251085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5251089">t</span><span class="op" id="5251090">.</span><span class="ident" id="5251091">nameSpace</span><span class="op" id="5251100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5251103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5251106">tmpl</span><span class="op" id="5251110">.</span><span class="ident" id="5251111">set</span><span class="op" id="5251114">[</span><span class="ident" id="5251115">name</span><span class="op" id="5251119">]</span>&nbsp;<span class="op" id="5251121">=</span>&nbsp;<span class="ident" id="5251123">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5251129">return</span>&nbsp;<span class="ident" id="5251136">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="5251141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5251144">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5251186">func</span>&nbsp;<span class="op" id="5251191">(</span><span class="ident" id="5251192">t</span>&nbsp;<span class="op" id="5251194">*</span><span class="ident" id="5251195">Template</span><span class="op" id="5251203">)</span>&nbsp;<span class="ident" id="5251205">Name</span><span class="op" id="5251209">(</span><span class="op" id="5251210">)</span>&nbsp;<span class="builtintype" id="5251212">string</span>&nbsp;<span class="op" id="5251219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5251222">return</span>&nbsp;<span class="ident" id="5251229">t</span><span class="op" id="5251230">.</span><span class="ident" id="5251231">text</span><span class="op" id="5251235">.</span><span class="ident" id="5251236">Name</span><span class="op" id="5251240">(</span><span class="op" id="5251241">)</span><br>
<span class="lineno">260</span><span class="op" id="5251243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5251246">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5251315">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="5251390">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="5251464">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="5251540">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5251617">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="5251690">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5251710">type</span>&nbsp;<span class="ident" id="5251715">FuncMap</span>&nbsp;<span class="keyword" id="5251723">map</span><span class="op" id="5251726">[</span><span class="builtintype" id="5251727">string</span><span class="op" id="5251733">]</span><span class="keyword" id="5251734">interface</span><span class="op" id="5251743">{</span><span class="op" id="5251744">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="5251747">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5251826">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5251903">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5251978">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="5252029">func</span>&nbsp;<span class="op" id="5252034">(</span><span class="ident" id="5252035">t</span>&nbsp;<span class="op" id="5252037">*</span><span class="ident" id="5252038">Template</span><span class="op" id="5252046">)</span>&nbsp;<span class="ident" id="5252048">Funcs</span><span class="op" id="5252053">(</span><span class="ident" id="5252054">funcMap</span>&nbsp;<span class="ident" id="5252062">FuncMap</span><span class="op" id="5252069">)</span>&nbsp;<span class="op" id="5252071">*</span><span class="ident" id="5252072">Template</span>&nbsp;<span class="op" id="5252081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5252084">t</span><span class="op" id="5252085">.</span><span class="ident" id="5252086">text</span><span class="op" id="5252090">.</span><span class="ident" id="5252091">Funcs</span><span class="op" id="5252096">(</span><span class="ident" id="5252097">template</span><span class="op" id="5252105">.</span><span class="ident" id="5252106">FuncMap</span><span class="op" id="5252113">(</span><span class="ident" id="5252114">funcMap</span><span class="op" id="5252121">)</span><span class="op" id="5252122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5252125">return</span>&nbsp;<span class="ident" id="5252132">t</span><br>
<span class="lineno"></span><span class="op" id="5252134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="5252137">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5252214">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5252286">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5252362">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="5252398">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="5252460">func</span>&nbsp;<span class="op" id="5252465">(</span><span class="ident" id="5252466">t</span>&nbsp;<span class="op" id="5252468">*</span><span class="ident" id="5252469">Template</span><span class="op" id="5252477">)</span>&nbsp;<span class="ident" id="5252479">Delims</span><span class="op" id="5252485">(</span><span class="ident" id="5252486">left</span><span class="op" id="5252490">,</span>&nbsp;<span class="ident" id="5252492">right</span>&nbsp;<span class="builtintype" id="5252498">string</span><span class="op" id="5252504">)</span>&nbsp;<span class="op" id="5252506">*</span><span class="ident" id="5252507">Template</span>&nbsp;<span class="op" id="5252516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5252519">t</span><span class="op" id="5252520">.</span><span class="ident" id="5252521">text</span><span class="op" id="5252525">.</span><span class="ident" id="5252526">Delims</span><span class="op" id="5252532">(</span><span class="ident" id="5252533">left</span><span class="op" id="5252537">,</span>&nbsp;<span class="ident" id="5252539">right</span><span class="op" id="5252544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5252547">return</span>&nbsp;<span class="ident" id="5252554">t</span><br>
<span class="lineno"></span><span class="op" id="5252556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="5252559">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="5252637">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5252677">func</span>&nbsp;<span class="op" id="5252682">(</span><span class="ident" id="5252683">t</span>&nbsp;<span class="op" id="5252685">*</span><span class="ident" id="5252686">Template</span><span class="op" id="5252694">)</span>&nbsp;<span class="ident" id="5252696">Lookup</span><span class="op" id="5252702">(</span><span class="ident" id="5252703">name</span>&nbsp;<span class="builtintype" id="5252708">string</span><span class="op" id="5252714">)</span>&nbsp;<span class="op" id="5252716">*</span><span class="ident" id="5252717">Template</span>&nbsp;<span class="op" id="5252726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5252729">t</span><span class="op" id="5252730">.</span><span class="ident" id="5252731">nameSpace</span><span class="op" id="5252740">.</span><span class="ident" id="5252741">mu</span><span class="op" id="5252743">.</span><span class="ident" id="5252744">Lock</span><span class="op" id="5252748">(</span><span class="op" id="5252749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5252752">defer</span>&nbsp;<span class="ident" id="5252758">t</span><span class="op" id="5252759">.</span><span class="ident" id="5252760">nameSpace</span><span class="op" id="5252769">.</span><span class="ident" id="5252770">mu</span><span class="op" id="5252772">.</span><span class="ident" id="5252773">Unlock</span><span class="op" id="5252779">(</span><span class="op" id="5252780">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5252783">return</span>&nbsp;<span class="ident" id="5252790">t</span><span class="op" id="5252791">.</span><span class="ident" id="5252792">set</span><span class="op" id="5252795">[</span><span class="ident" id="5252796">name</span><span class="op" id="5252800">]</span><br>
<span class="lineno"></span><span class="op" id="5252802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5252805">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="5252886">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="5252976">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5252987">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="5253048">func</span>&nbsp;<span class="ident" id="5253053">Must</span><span class="op" id="5253057">(</span><span class="ident" id="5253058">t</span>&nbsp;<span class="op" id="5253060">*</span><span class="ident" id="5253061">Template</span><span class="op" id="5253069">,</span>&nbsp;<span class="ident" id="5253071">err</span>&nbsp;<span class="builtintype" id="5253075">error</span><span class="op" id="5253080">)</span>&nbsp;<span class="op" id="5253082">*</span><span class="ident" id="5253083">Template</span>&nbsp;<span class="op" id="5253092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5253095">if</span>&nbsp;<span class="ident" id="5253098">err</span>&nbsp;<span class="op" id="5253102">!=</span>&nbsp;<span class="ident" id="5253105">nil</span>&nbsp;<span class="op" id="5253109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5253113">panic</span><span class="op" id="5253118">(</span><span class="ident" id="5253119">err</span><span class="op" id="5253122">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5253125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5253128">return</span>&nbsp;<span class="ident" id="5253135">t</span><br>
<span class="lineno"></span><span class="op" id="5253137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5253140">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="5253218">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5253297">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5253370">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5253442">func</span>&nbsp;<span class="ident" id="5253447">ParseFiles</span><span class="op" id="5253457">(</span><span class="ident" id="5253458">filenames</span>&nbsp;<span class="op" id="5253468">...</span><span class="builtintype" id="5253471">string</span><span class="op" id="5253477">)</span>&nbsp;<span class="op" id="5253479">(</span><span class="op" id="5253480">*</span><span class="ident" id="5253481">Template</span><span class="op" id="5253489">,</span>&nbsp;<span class="builtintype" id="5253491">error</span><span class="op" id="5253496">)</span>&nbsp;<span class="op" id="5253498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5253501">return</span>&nbsp;<span class="ident" id="5253508">parseFiles</span><span class="op" id="5253518">(</span><span class="ident" id="5253519">nil</span><span class="op" id="5253522">,</span>&nbsp;<span class="ident" id="5253524">filenames</span><span class="op" id="5253533">...</span><span class="op" id="5253536">)</span><br>
<span class="lineno">315</span><span class="op" id="5253538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5253541">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5253622">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="5253696">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="5253751">func</span>&nbsp;<span class="op" id="5253756">(</span><span class="ident" id="5253757">t</span>&nbsp;<span class="op" id="5253759">*</span><span class="ident" id="5253760">Template</span><span class="op" id="5253768">)</span>&nbsp;<span class="ident" id="5253770">ParseFiles</span><span class="op" id="5253780">(</span><span class="ident" id="5253781">filenames</span>&nbsp;<span class="op" id="5253791">...</span><span class="builtintype" id="5253794">string</span><span class="op" id="5253800">)</span>&nbsp;<span class="op" id="5253802">(</span><span class="op" id="5253803">*</span><span class="ident" id="5253804">Template</span><span class="op" id="5253812">,</span>&nbsp;<span class="builtintype" id="5253814">error</span><span class="op" id="5253819">)</span>&nbsp;<span class="op" id="5253821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5253824">return</span>&nbsp;<span class="ident" id="5253831">parseFiles</span><span class="op" id="5253841">(</span><span class="ident" id="5253842">t</span><span class="op" id="5253843">,</span>&nbsp;<span class="ident" id="5253845">filenames</span><span class="op" id="5253854">...</span><span class="op" id="5253857">)</span><br>
<span class="lineno"></span><span class="op" id="5253859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5253862">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="5253935">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5253990">func</span>&nbsp;<span class="ident" id="5253995">parseFiles</span><span class="op" id="5254005">(</span><span class="ident" id="5254006">t</span>&nbsp;<span class="op" id="5254008">*</span><span class="ident" id="5254009">Template</span><span class="op" id="5254017">,</span>&nbsp;<span class="ident" id="5254019">filenames</span>&nbsp;<span class="op" id="5254029">...</span><span class="builtintype" id="5254032">string</span><span class="op" id="5254038">)</span>&nbsp;<span class="op" id="5254040">(</span><span class="op" id="5254041">*</span><span class="ident" id="5254042">Template</span><span class="op" id="5254050">,</span>&nbsp;<span class="builtintype" id="5254052">error</span><span class="op" id="5254057">)</span>&nbsp;<span class="op" id="5254059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254062">if</span>&nbsp;<span class="builtinfunc" id="5254065">len</span><span class="op" id="5254068">(</span><span class="ident" id="5254069">filenames</span><span class="op" id="5254078">)</span>&nbsp;<span class="op" id="5254080">==</span>&nbsp;<span class="num" id="5254083">0</span>&nbsp;<span class="op" id="5254085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5254089">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254135">return</span>&nbsp;<span class="ident" id="5254142">nil</span><span class="op" id="5254145">,</span>&nbsp;<span class="ident" id="5254147">fmt</span><span class="op" id="5254150">.</span><span class="ident" id="5254151">Errorf</span><span class="op" id="5254157">(</span><span class="string" id="5254158">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="5254211">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5254214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254217">for</span>&nbsp;<span class="ident" id="5254221">_</span><span class="op" id="5254222">,</span>&nbsp;<span class="ident" id="5254224">filename</span>&nbsp;<span class="op" id="5254233">:=</span>&nbsp;<span class="keyword" id="5254236">range</span>&nbsp;<span class="ident" id="5254242">filenames</span>&nbsp;<span class="op" id="5254252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5254256">b</span><span class="op" id="5254257">,</span>&nbsp;<span class="ident" id="5254259">err</span>&nbsp;<span class="op" id="5254263">:=</span>&nbsp;<span class="ident" id="5254266">ioutil</span><span class="op" id="5254272">.</span><span class="ident" id="5254273">ReadFile</span><span class="op" id="5254281">(</span><span class="ident" id="5254282">filename</span><span class="op" id="5254290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254294">if</span>&nbsp;<span class="ident" id="5254297">err</span>&nbsp;<span class="op" id="5254301">!=</span>&nbsp;<span class="ident" id="5254304">nil</span>&nbsp;<span class="op" id="5254308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254313">return</span>&nbsp;<span class="ident" id="5254320">nil</span><span class="op" id="5254323">,</span>&nbsp;<span class="ident" id="5254325">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5254331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5254335">s</span>&nbsp;<span class="op" id="5254337">:=</span>&nbsp;<span class="builtintype" id="5254340">string</span><span class="op" id="5254346">(</span><span class="ident" id="5254347">b</span><span class="op" id="5254348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5254352">name</span>&nbsp;<span class="op" id="5254357">:=</span>&nbsp;<span class="ident" id="5254360">filepath</span><span class="op" id="5254368">.</span><span class="ident" id="5254369">Base</span><span class="op" id="5254373">(</span><span class="ident" id="5254374">filename</span><span class="op" id="5254382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5254386">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5254451">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5254514">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5254584">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5254635">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5254689">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254755">var</span>&nbsp;<span class="ident" id="5254759">tmpl</span>&nbsp;<span class="op" id="5254764">*</span><span class="ident" id="5254765">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254776">if</span>&nbsp;<span class="ident" id="5254779">t</span>&nbsp;<span class="op" id="5254781">==</span>&nbsp;<span class="ident" id="5254784">nil</span>&nbsp;<span class="op" id="5254788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5254793">t</span>&nbsp;<span class="op" id="5254795">=</span>&nbsp;<span class="ident" id="5254797">New</span><span class="op" id="5254800">(</span><span class="ident" id="5254801">name</span><span class="op" id="5254805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5254809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254813">if</span>&nbsp;<span class="ident" id="5254816">name</span>&nbsp;<span class="op" id="5254821">==</span>&nbsp;<span class="ident" id="5254824">t</span><span class="op" id="5254825">.</span><span class="ident" id="5254826">Name</span><span class="op" id="5254830">(</span><span class="op" id="5254831">)</span>&nbsp;<span class="op" id="5254833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5254838">tmpl</span>&nbsp;<span class="op" id="5254843">=</span>&nbsp;<span class="ident" id="5254845">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5254849">}</span>&nbsp;<span class="keyword" id="5254851">else</span>&nbsp;<span class="op" id="5254856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5254861">tmpl</span>&nbsp;<span class="op" id="5254866">=</span>&nbsp;<span class="ident" id="5254868">t</span><span class="op" id="5254869">.</span><span class="ident" id="5254870">New</span><span class="op" id="5254873">(</span><span class="ident" id="5254874">name</span><span class="op" id="5254878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5254882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5254886">_</span><span class="op" id="5254887">,</span>&nbsp;<span class="ident" id="5254889">err</span>&nbsp;<span class="op" id="5254893">=</span>&nbsp;<span class="ident" id="5254895">tmpl</span><span class="op" id="5254899">.</span><span class="ident" id="5254900">Parse</span><span class="op" id="5254905">(</span><span class="ident" id="5254906">s</span><span class="op" id="5254907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254911">if</span>&nbsp;<span class="ident" id="5254914">err</span>&nbsp;<span class="op" id="5254918">!=</span>&nbsp;<span class="ident" id="5254921">nil</span>&nbsp;<span class="op" id="5254925">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254930">return</span>&nbsp;<span class="ident" id="5254937">nil</span><span class="op" id="5254940">,</span>&nbsp;<span class="ident" id="5254942">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5254948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5254951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5254954">return</span>&nbsp;<span class="ident" id="5254961">t</span><span class="op" id="5254962">,</span>&nbsp;<span class="ident" id="5254964">nil</span><br>
<span class="lineno"></span><span class="op" id="5254968">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="5254971">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5255052">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="5255128">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5255204">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="5255277">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="5255338">func</span>&nbsp;<span class="ident" id="5255343">ParseGlob</span><span class="op" id="5255352">(</span><span class="ident" id="5255353">pattern</span>&nbsp;<span class="builtintype" id="5255361">string</span><span class="op" id="5255367">)</span>&nbsp;<span class="op" id="5255369">(</span><span class="op" id="5255370">*</span><span class="ident" id="5255371">Template</span><span class="op" id="5255379">,</span>&nbsp;<span class="builtintype" id="5255381">error</span><span class="op" id="5255386">)</span>&nbsp;<span class="op" id="5255388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5255391">return</span>&nbsp;<span class="ident" id="5255398">parseGlob</span><span class="op" id="5255407">(</span><span class="ident" id="5255408">nil</span><span class="op" id="5255411">,</span>&nbsp;<span class="ident" id="5255413">pattern</span><span class="op" id="5255420">)</span><br>
<span class="lineno"></span><span class="op" id="5255422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="5255425">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5255501">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5255574">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5255651">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5255727">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="5255739">func</span>&nbsp;<span class="op" id="5255744">(</span><span class="ident" id="5255745">t</span>&nbsp;<span class="op" id="5255747">*</span><span class="ident" id="5255748">Template</span><span class="op" id="5255756">)</span>&nbsp;<span class="ident" id="5255758">ParseGlob</span><span class="op" id="5255767">(</span><span class="ident" id="5255768">pattern</span>&nbsp;<span class="builtintype" id="5255776">string</span><span class="op" id="5255782">)</span>&nbsp;<span class="op" id="5255784">(</span><span class="op" id="5255785">*</span><span class="ident" id="5255786">Template</span><span class="op" id="5255794">,</span>&nbsp;<span class="builtintype" id="5255796">error</span><span class="op" id="5255801">)</span>&nbsp;<span class="op" id="5255803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5255806">return</span>&nbsp;<span class="ident" id="5255813">parseGlob</span><span class="op" id="5255822">(</span><span class="ident" id="5255823">t</span><span class="op" id="5255824">,</span>&nbsp;<span class="ident" id="5255826">pattern</span><span class="op" id="5255833">)</span><br>
<span class="lineno"></span><span class="op" id="5255835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5255838">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="5255911">func</span>&nbsp;<span class="ident" id="5255916">parseGlob</span><span class="op" id="5255925">(</span><span class="ident" id="5255926">t</span>&nbsp;<span class="op" id="5255928">*</span><span class="ident" id="5255929">Template</span><span class="op" id="5255937">,</span>&nbsp;<span class="ident" id="5255939">pattern</span>&nbsp;<span class="builtintype" id="5255947">string</span><span class="op" id="5255953">)</span>&nbsp;<span class="op" id="5255955">(</span><span class="op" id="5255956">*</span><span class="ident" id="5255957">Template</span><span class="op" id="5255965">,</span>&nbsp;<span class="builtintype" id="5255967">error</span><span class="op" id="5255972">)</span>&nbsp;<span class="op" id="5255974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5255977">filenames</span><span class="op" id="5255986">,</span>&nbsp;<span class="ident" id="5255988">err</span>&nbsp;<span class="op" id="5255992">:=</span>&nbsp;<span class="ident" id="5255995">filepath</span><span class="op" id="5256003">.</span><span class="ident" id="5256004">Glob</span><span class="op" id="5256008">(</span><span class="ident" id="5256009">pattern</span><span class="op" id="5256016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5256019">if</span>&nbsp;<span class="ident" id="5256022">err</span>&nbsp;<span class="op" id="5256026">!=</span>&nbsp;<span class="ident" id="5256029">nil</span>&nbsp;<span class="op" id="5256033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5256037">return</span>&nbsp;<span class="ident" id="5256044">nil</span><span class="op" id="5256047">,</span>&nbsp;<span class="ident" id="5256049">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5256054">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5256057">if</span>&nbsp;<span class="builtinfunc" id="5256060">len</span><span class="op" id="5256063">(</span><span class="ident" id="5256064">filenames</span><span class="op" id="5256073">)</span>&nbsp;<span class="op" id="5256075">==</span>&nbsp;<span class="num" id="5256078">0</span>&nbsp;<span class="op" id="5256080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5256084">return</span>&nbsp;<span class="ident" id="5256091">nil</span><span class="op" id="5256094">,</span>&nbsp;<span class="ident" id="5256096">fmt</span><span class="op" id="5256099">.</span><span class="ident" id="5256100">Errorf</span><span class="op" id="5256106">(</span><span class="string" id="5256107">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="5256153">,</span>&nbsp;<span class="ident" id="5256155">pattern</span><span class="op" id="5256162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5256165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5256168">return</span>&nbsp;<span class="ident" id="5256175">parseFiles</span><span class="op" id="5256185">(</span><span class="ident" id="5256186">t</span><span class="op" id="5256187">,</span>&nbsp;<span class="ident" id="5256189">filenames</span><span class="op" id="5256198">...</span><span class="op" id="5256201">)</span><br>
<span class="lineno"></span><span class="op" id="5256203">}</span>
</div>
</body>
</html>
