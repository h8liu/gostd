<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/binary</h2>
<ul>
<li><a href="/gostd/encoding/binary/binary.go.html">binary.go</a></li>
<li><a href="/gostd/encoding/binary/binary_test.go.html">binary_test.go</a></li>
<li><a href="/gostd/encoding/binary/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/binary/varint.go.html">varint.go</a></li>
<li><a href="/gostd/encoding/binary/varint_test.go.html" class="current">varint_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8498871">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8498926">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8498980">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8499031">package</span>&nbsp;<span class="ident" id="8499039">binary</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8499047">import</span>&nbsp;<span class="op" id="8499054">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8499057">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8499066">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8499072">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8499082">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8499085">func</span>&nbsp;<span class="ident" id="8499090">testConstant</span><span class="op" id="8499102">(</span><span class="ident" id="8499103">t</span>&nbsp;<span class="op" id="8499105">*</span><span class="ident" id="8499106">testing</span><span class="op" id="8499113">.</span><span class="ident" id="8499114">T</span><span class="op" id="8499115">,</span>&nbsp;<span class="ident" id="8499117">w</span>&nbsp;<span class="builtintype" id="8499119">uint</span><span class="op" id="8499123">,</span>&nbsp;<span class="ident" id="8499125">max</span>&nbsp;<span class="builtintype" id="8499129">int</span><span class="op" id="8499132">)</span>&nbsp;<span class="op" id="8499134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499137">buf</span>&nbsp;<span class="op" id="8499141">:=</span>&nbsp;<span class="builtinfunc" id="8499144">make</span><span class="op" id="8499148">(</span><span class="op" id="8499149">[</span><span class="op" id="8499150">]</span><span class="builtintype" id="8499151">byte</span><span class="op" id="8499155">,</span>&nbsp;<span class="ident" id="8499157">MaxVarintLen64</span><span class="op" id="8499171">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499174">n</span>&nbsp;<span class="op" id="8499176">:=</span>&nbsp;<span class="ident" id="8499179">PutUvarint</span><span class="op" id="8499189">(</span><span class="ident" id="8499190">buf</span><span class="op" id="8499193">,</span>&nbsp;<span class="num" id="8499195">1</span><span class="op" id="8499196">&lt;&lt;</span><span class="ident" id="8499198">w</span><span class="op" id="8499199">-</span><span class="num" id="8499200">1</span><span class="op" id="8499201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8499204">if</span>&nbsp;<span class="ident" id="8499207">n</span>&nbsp;<span class="op" id="8499209">!=</span>&nbsp;<span class="ident" id="8499212">max</span>&nbsp;<span class="op" id="8499216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499220">t</span><span class="op" id="8499221">.</span><span class="ident" id="8499222">Errorf</span><span class="op" id="8499228">(</span><span class="string" id="8499229">&#34;MaxVarintLen%d&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8499259">,</span>&nbsp;<span class="ident" id="8499261">w</span><span class="op" id="8499262">,</span>&nbsp;<span class="ident" id="8499264">max</span><span class="op" id="8499267">,</span>&nbsp;<span class="ident" id="8499269">n</span><span class="op" id="8499270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499273">}</span><br>
<span class="lineno"></span><span class="op" id="8499275">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8499278">func</span>&nbsp;<span class="ident" id="8499283">TestConstants</span><span class="op" id="8499296">(</span><span class="ident" id="8499297">t</span>&nbsp;<span class="op" id="8499299">*</span><span class="ident" id="8499300">testing</span><span class="op" id="8499307">.</span><span class="ident" id="8499308">T</span><span class="op" id="8499309">)</span>&nbsp;<span class="op" id="8499311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499314">testConstant</span><span class="op" id="8499326">(</span><span class="ident" id="8499327">t</span><span class="op" id="8499328">,</span>&nbsp;<span class="num" id="8499330">16</span><span class="op" id="8499332">,</span>&nbsp;<span class="ident" id="8499334">MaxVarintLen16</span><span class="op" id="8499348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499351">testConstant</span><span class="op" id="8499363">(</span><span class="ident" id="8499364">t</span><span class="op" id="8499365">,</span>&nbsp;<span class="num" id="8499367">32</span><span class="op" id="8499369">,</span>&nbsp;<span class="ident" id="8499371">MaxVarintLen32</span><span class="op" id="8499385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499388">testConstant</span><span class="op" id="8499400">(</span><span class="ident" id="8499401">t</span><span class="op" id="8499402">,</span>&nbsp;<span class="num" id="8499404">64</span><span class="op" id="8499406">,</span>&nbsp;<span class="ident" id="8499408">MaxVarintLen64</span><span class="op" id="8499422">)</span><br>
<span class="lineno">25</span><span class="op" id="8499424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8499427">func</span>&nbsp;<span class="ident" id="8499432">testVarint</span><span class="op" id="8499442">(</span><span class="ident" id="8499443">t</span>&nbsp;<span class="op" id="8499445">*</span><span class="ident" id="8499446">testing</span><span class="op" id="8499453">.</span><span class="ident" id="8499454">T</span><span class="op" id="8499455">,</span>&nbsp;<span class="ident" id="8499457">x</span>&nbsp;<span class="ident" id="8499459">int64</span><span class="op" id="8499464">)</span>&nbsp;<span class="op" id="8499466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499469">buf</span>&nbsp;<span class="op" id="8499473">:=</span>&nbsp;<span class="builtinfunc" id="8499476">make</span><span class="op" id="8499480">(</span><span class="op" id="8499481">[</span><span class="op" id="8499482">]</span><span class="builtintype" id="8499483">byte</span><span class="op" id="8499487">,</span>&nbsp;<span class="ident" id="8499489">MaxVarintLen64</span><span class="op" id="8499503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499506">n</span>&nbsp;<span class="op" id="8499508">:=</span>&nbsp;<span class="ident" id="8499511">PutVarint</span><span class="op" id="8499520">(</span><span class="ident" id="8499521">buf</span><span class="op" id="8499524">,</span>&nbsp;<span class="ident" id="8499526">x</span><span class="op" id="8499527">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499530">y</span><span class="op" id="8499531">,</span>&nbsp;<span class="ident" id="8499533">m</span>&nbsp;<span class="op" id="8499535">:=</span>&nbsp;<span class="ident" id="8499538">Varint</span><span class="op" id="8499544">(</span><span class="ident" id="8499545">buf</span><span class="op" id="8499548">[</span><span class="num" id="8499549">0</span><span class="op" id="8499550">:</span><span class="ident" id="8499551">n</span><span class="op" id="8499552">]</span><span class="op" id="8499553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8499556">if</span>&nbsp;<span class="ident" id="8499559">x</span>&nbsp;<span class="op" id="8499561">!=</span>&nbsp;<span class="ident" id="8499564">y</span>&nbsp;<span class="op" id="8499566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499570">t</span><span class="op" id="8499571">.</span><span class="ident" id="8499572">Errorf</span><span class="op" id="8499578">(</span><span class="string" id="8499579">&#34;Varint(%d):&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8499599">,</span>&nbsp;<span class="ident" id="8499601">x</span><span class="op" id="8499602">,</span>&nbsp;<span class="ident" id="8499604">y</span><span class="op" id="8499605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8499611">if</span>&nbsp;<span class="ident" id="8499614">n</span>&nbsp;<span class="op" id="8499616">!=</span>&nbsp;<span class="ident" id="8499619">m</span>&nbsp;<span class="op" id="8499621">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499625">t</span><span class="op" id="8499626">.</span><span class="ident" id="8499627">Errorf</span><span class="op" id="8499633">(</span><span class="string" id="8499634">&#34;Varint(%d):&nbsp;got&nbsp;n&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8499667">,</span>&nbsp;<span class="ident" id="8499669">x</span><span class="op" id="8499670">,</span>&nbsp;<span class="ident" id="8499672">m</span><span class="op" id="8499673">,</span>&nbsp;<span class="ident" id="8499675">n</span><span class="op" id="8499676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499683">y</span><span class="op" id="8499684">,</span>&nbsp;<span class="ident" id="8499686">err</span>&nbsp;<span class="op" id="8499690">:=</span>&nbsp;<span class="ident" id="8499693">ReadVarint</span><span class="op" id="8499703">(</span><span class="ident" id="8499704">bytes</span><span class="op" id="8499709">.</span><span class="ident" id="8499710">NewReader</span><span class="op" id="8499719">(</span><span class="ident" id="8499720">buf</span><span class="op" id="8499723">)</span><span class="op" id="8499724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8499727">if</span>&nbsp;<span class="ident" id="8499730">err</span>&nbsp;<span class="op" id="8499734">!=</span>&nbsp;<span class="ident" id="8499737">nil</span>&nbsp;<span class="op" id="8499741">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499745">t</span><span class="op" id="8499746">.</span><span class="ident" id="8499747">Errorf</span><span class="op" id="8499753">(</span><span class="string" id="8499754">&#34;ReadVarint(%d):&nbsp;%s&#34;</span><span class="op" id="8499774">,</span>&nbsp;<span class="ident" id="8499776">x</span><span class="op" id="8499777">,</span>&nbsp;<span class="ident" id="8499779">err</span><span class="op" id="8499782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8499788">if</span>&nbsp;<span class="ident" id="8499791">x</span>&nbsp;<span class="op" id="8499793">!=</span>&nbsp;<span class="ident" id="8499796">y</span>&nbsp;<span class="op" id="8499798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499802">t</span><span class="op" id="8499803">.</span><span class="ident" id="8499804">Errorf</span><span class="op" id="8499810">(</span><span class="string" id="8499811">&#34;ReadVarint(%d):&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8499835">,</span>&nbsp;<span class="ident" id="8499837">x</span><span class="op" id="8499838">,</span>&nbsp;<span class="ident" id="8499840">y</span><span class="op" id="8499841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8499844">}</span><br>
<span class="lineno">45</span><span class="op" id="8499846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8499849">func</span>&nbsp;<span class="ident" id="8499854">testUvarint</span><span class="op" id="8499865">(</span><span class="ident" id="8499866">t</span>&nbsp;<span class="op" id="8499868">*</span><span class="ident" id="8499869">testing</span><span class="op" id="8499876">.</span><span class="ident" id="8499877">T</span><span class="op" id="8499878">,</span>&nbsp;<span class="ident" id="8499880">x</span>&nbsp;<span class="ident" id="8499882">uint64</span><span class="op" id="8499888">)</span>&nbsp;<span class="op" id="8499890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499893">buf</span>&nbsp;<span class="op" id="8499897">:=</span>&nbsp;<span class="builtinfunc" id="8499900">make</span><span class="op" id="8499904">(</span><span class="op" id="8499905">[</span><span class="op" id="8499906">]</span><span class="builtintype" id="8499907">byte</span><span class="op" id="8499911">,</span>&nbsp;<span class="ident" id="8499913">MaxVarintLen64</span><span class="op" id="8499927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499930">n</span>&nbsp;<span class="op" id="8499932">:=</span>&nbsp;<span class="ident" id="8499935">PutUvarint</span><span class="op" id="8499945">(</span><span class="ident" id="8499946">buf</span><span class="op" id="8499949">,</span>&nbsp;<span class="ident" id="8499951">x</span><span class="op" id="8499952">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499955">y</span><span class="op" id="8499956">,</span>&nbsp;<span class="ident" id="8499958">m</span>&nbsp;<span class="op" id="8499960">:=</span>&nbsp;<span class="ident" id="8499963">Uvarint</span><span class="op" id="8499970">(</span><span class="ident" id="8499971">buf</span><span class="op" id="8499974">[</span><span class="num" id="8499975">0</span><span class="op" id="8499976">:</span><span class="ident" id="8499977">n</span><span class="op" id="8499978">]</span><span class="op" id="8499979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8499982">if</span>&nbsp;<span class="ident" id="8499985">x</span>&nbsp;<span class="op" id="8499987">!=</span>&nbsp;<span class="ident" id="8499990">y</span>&nbsp;<span class="op" id="8499992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8499996">t</span><span class="op" id="8499997">.</span><span class="ident" id="8499998">Errorf</span><span class="op" id="8500004">(</span><span class="string" id="8500005">&#34;Uvarint(%d):&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8500026">,</span>&nbsp;<span class="ident" id="8500028">x</span><span class="op" id="8500029">,</span>&nbsp;<span class="ident" id="8500031">y</span><span class="op" id="8500032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8500038">if</span>&nbsp;<span class="ident" id="8500041">n</span>&nbsp;<span class="op" id="8500043">!=</span>&nbsp;<span class="ident" id="8500046">m</span>&nbsp;<span class="op" id="8500048">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500052">t</span><span class="op" id="8500053">.</span><span class="ident" id="8500054">Errorf</span><span class="op" id="8500060">(</span><span class="string" id="8500061">&#34;Uvarint(%d):&nbsp;got&nbsp;n&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8500095">,</span>&nbsp;<span class="ident" id="8500097">x</span><span class="op" id="8500098">,</span>&nbsp;<span class="ident" id="8500100">m</span><span class="op" id="8500101">,</span>&nbsp;<span class="ident" id="8500103">n</span><span class="op" id="8500104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500111">y</span><span class="op" id="8500112">,</span>&nbsp;<span class="ident" id="8500114">err</span>&nbsp;<span class="op" id="8500118">:=</span>&nbsp;<span class="ident" id="8500121">ReadUvarint</span><span class="op" id="8500132">(</span><span class="ident" id="8500133">bytes</span><span class="op" id="8500138">.</span><span class="ident" id="8500139">NewReader</span><span class="op" id="8500148">(</span><span class="ident" id="8500149">buf</span><span class="op" id="8500152">)</span><span class="op" id="8500153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8500156">if</span>&nbsp;<span class="ident" id="8500159">err</span>&nbsp;<span class="op" id="8500163">!=</span>&nbsp;<span class="ident" id="8500166">nil</span>&nbsp;<span class="op" id="8500170">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500174">t</span><span class="op" id="8500175">.</span><span class="ident" id="8500176">Errorf</span><span class="op" id="8500182">(</span><span class="string" id="8500183">&#34;ReadUvarint(%d):&nbsp;%s&#34;</span><span class="op" id="8500204">,</span>&nbsp;<span class="ident" id="8500206">x</span><span class="op" id="8500207">,</span>&nbsp;<span class="ident" id="8500209">err</span><span class="op" id="8500212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8500218">if</span>&nbsp;<span class="ident" id="8500221">x</span>&nbsp;<span class="op" id="8500223">!=</span>&nbsp;<span class="ident" id="8500226">y</span>&nbsp;<span class="op" id="8500228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500232">t</span><span class="op" id="8500233">.</span><span class="ident" id="8500234">Errorf</span><span class="op" id="8500240">(</span><span class="string" id="8500241">&#34;ReadUvarint(%d):&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8500266">,</span>&nbsp;<span class="ident" id="8500268">x</span><span class="op" id="8500269">,</span>&nbsp;<span class="ident" id="8500271">y</span><span class="op" id="8500272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500275">}</span><br>
<span class="lineno">65</span><span class="op" id="8500277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8500280">var</span>&nbsp;<span class="ident" id="8500284">tests</span>&nbsp;<span class="op" id="8500290">=</span>&nbsp;<span class="op" id="8500292">[</span><span class="op" id="8500293">]</span><span class="ident" id="8500294">int64</span><span class="op" id="8500299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500302">-</span><span class="num" id="8500303">1</span>&nbsp;<span class="op" id="8500305">&lt;&lt;</span>&nbsp;<span class="num" id="8500308">63</span><span class="op" id="8500310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500313">-</span><span class="num" id="8500314">1</span><span class="op" id="8500315">&lt;&lt;</span><span class="num" id="8500317">63</span>&nbsp;<span class="op" id="8500320">+</span>&nbsp;<span class="num" id="8500322">1</span><span class="op" id="8500323">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500326">-</span><span class="num" id="8500327">1</span><span class="op" id="8500328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500331">0</span><span class="op" id="8500332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500335">1</span><span class="op" id="8500336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500339">2</span><span class="op" id="8500340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500343">10</span><span class="op" id="8500345">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500348">20</span><span class="op" id="8500350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500353">63</span><span class="op" id="8500355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500358">64</span><span class="op" id="8500360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500363">65</span><span class="op" id="8500365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500368">127</span><span class="op" id="8500371">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500374">128</span><span class="op" id="8500377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500380">129</span><span class="op" id="8500383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500386">255</span><span class="op" id="8500389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500392">256</span><span class="op" id="8500395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500398">257</span><span class="op" id="8500401">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8500404">1</span><span class="op" id="8500405">&lt;&lt;</span><span class="num" id="8500407">63</span>&nbsp;<span class="op" id="8500410">-</span>&nbsp;<span class="num" id="8500412">1</span><span class="op" id="8500413">,</span><br>
<span class="lineno"></span><span class="op" id="8500415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8500418">func</span>&nbsp;<span class="ident" id="8500423">TestVarint</span><span class="op" id="8500433">(</span><span class="ident" id="8500434">t</span>&nbsp;<span class="op" id="8500436">*</span><span class="ident" id="8500437">testing</span><span class="op" id="8500444">.</span><span class="ident" id="8500445">T</span><span class="op" id="8500446">)</span>&nbsp;<span class="op" id="8500448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8500451">for</span>&nbsp;<span class="ident" id="8500455">_</span><span class="op" id="8500456">,</span>&nbsp;<span class="ident" id="8500458">x</span>&nbsp;<span class="op" id="8500460">:=</span>&nbsp;<span class="keyword" id="8500463">range</span>&nbsp;<span class="ident" id="8500469">tests</span>&nbsp;<span class="op" id="8500475">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500479">testVarint</span><span class="op" id="8500489">(</span><span class="ident" id="8500490">t</span><span class="op" id="8500491">,</span>&nbsp;<span class="ident" id="8500493">x</span><span class="op" id="8500494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500498">testVarint</span><span class="op" id="8500508">(</span><span class="ident" id="8500509">t</span><span class="op" id="8500510">,</span>&nbsp;<span class="op" id="8500512">-</span><span class="ident" id="8500513">x</span><span class="op" id="8500514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8500520">for</span>&nbsp;<span class="ident" id="8500524">x</span>&nbsp;<span class="op" id="8500526">:=</span>&nbsp;<span class="ident" id="8500529">int64</span><span class="op" id="8500534">(</span><span class="num" id="8500535">0x7</span><span class="op" id="8500538">)</span><span class="op" id="8500539">;</span>&nbsp;<span class="ident" id="8500541">x</span>&nbsp;<span class="op" id="8500543">!=</span>&nbsp;<span class="num" id="8500546">0</span><span class="op" id="8500547">;</span>&nbsp;<span class="ident" id="8500549">x</span>&nbsp;<span class="op" id="8500551">&lt;&lt;=</span>&nbsp;<span class="num" id="8500555">1</span>&nbsp;<span class="op" id="8500557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500561">testVarint</span><span class="op" id="8500571">(</span><span class="ident" id="8500572">t</span><span class="op" id="8500573">,</span>&nbsp;<span class="ident" id="8500575">x</span><span class="op" id="8500576">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500580">testVarint</span><span class="op" id="8500590">(</span><span class="ident" id="8500591">t</span><span class="op" id="8500592">,</span>&nbsp;<span class="op" id="8500594">-</span><span class="ident" id="8500595">x</span><span class="op" id="8500596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500599">}</span><br>
<span class="lineno"></span><span class="op" id="8500601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8500604">func</span>&nbsp;<span class="ident" id="8500609">TestUvarint</span><span class="op" id="8500620">(</span><span class="ident" id="8500621">t</span>&nbsp;<span class="op" id="8500623">*</span><span class="ident" id="8500624">testing</span><span class="op" id="8500631">.</span><span class="ident" id="8500632">T</span><span class="op" id="8500633">)</span>&nbsp;<span class="op" id="8500635">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8500638">for</span>&nbsp;<span class="ident" id="8500642">_</span><span class="op" id="8500643">,</span>&nbsp;<span class="ident" id="8500645">x</span>&nbsp;<span class="op" id="8500647">:=</span>&nbsp;<span class="keyword" id="8500650">range</span>&nbsp;<span class="ident" id="8500656">tests</span>&nbsp;<span class="op" id="8500662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500666">testUvarint</span><span class="op" id="8500677">(</span><span class="ident" id="8500678">t</span><span class="op" id="8500679">,</span>&nbsp;<span class="ident" id="8500681">uint64</span><span class="op" id="8500687">(</span><span class="ident" id="8500688">x</span><span class="op" id="8500689">)</span><span class="op" id="8500690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8500696">for</span>&nbsp;<span class="ident" id="8500700">x</span>&nbsp;<span class="op" id="8500702">:=</span>&nbsp;<span class="ident" id="8500705">uint64</span><span class="op" id="8500711">(</span><span class="num" id="8500712">0x7</span><span class="op" id="8500715">)</span><span class="op" id="8500716">;</span>&nbsp;<span class="ident" id="8500718">x</span>&nbsp;<span class="op" id="8500720">!=</span>&nbsp;<span class="num" id="8500723">0</span><span class="op" id="8500724">;</span>&nbsp;<span class="ident" id="8500726">x</span>&nbsp;<span class="op" id="8500728">&lt;&lt;=</span>&nbsp;<span class="num" id="8500732">1</span>&nbsp;<span class="op" id="8500734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500738">testUvarint</span><span class="op" id="8500749">(</span><span class="ident" id="8500750">t</span><span class="op" id="8500751">,</span>&nbsp;<span class="ident" id="8500753">x</span><span class="op" id="8500754">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8500757">}</span><br>
<span class="lineno"></span><span class="op" id="8500759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8500762">func</span>&nbsp;<span class="ident" id="8500767">TestBufferTooSmall</span><span class="op" id="8500785">(</span><span class="ident" id="8500786">t</span>&nbsp;<span class="op" id="8500788">*</span><span class="ident" id="8500789">testing</span><span class="op" id="8500796">.</span><span class="ident" id="8500797">T</span><span class="op" id="8500798">)</span>&nbsp;<span class="op" id="8500800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500803">buf</span>&nbsp;<span class="op" id="8500807">:=</span>&nbsp;<span class="op" id="8500810">[</span><span class="op" id="8500811">]</span><span class="builtintype" id="8500812">byte</span><span class="op" id="8500816">{</span><span class="num" id="8500817">0x80</span><span class="op" id="8500821">,</span>&nbsp;<span class="num" id="8500823">0x80</span><span class="op" id="8500827">,</span>&nbsp;<span class="num" id="8500829">0x80</span><span class="op" id="8500833">,</span>&nbsp;<span class="num" id="8500835">0x80</span><span class="op" id="8500839">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8500842">for</span>&nbsp;<span class="ident" id="8500846">i</span>&nbsp;<span class="op" id="8500848">:=</span>&nbsp;<span class="num" id="8500851">0</span><span class="op" id="8500852">;</span>&nbsp;<span class="ident" id="8500854">i</span>&nbsp;<span class="op" id="8500856">&lt;=</span>&nbsp;<span class="builtinfunc" id="8500859">len</span><span class="op" id="8500862">(</span><span class="ident" id="8500863">buf</span><span class="op" id="8500866">)</span><span class="op" id="8500867">;</span>&nbsp;<span class="ident" id="8500869">i</span><span class="op" id="8500870">++</span>&nbsp;<span class="op" id="8500873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500877">buf</span>&nbsp;<span class="op" id="8500881">:=</span>&nbsp;<span class="ident" id="8500884">buf</span><span class="op" id="8500887">[</span><span class="num" id="8500888">0</span><span class="op" id="8500889">:</span><span class="ident" id="8500890">i</span><span class="op" id="8500891">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500895">x</span><span class="op" id="8500896">,</span>&nbsp;<span class="ident" id="8500898">n</span>&nbsp;<span class="op" id="8500900">:=</span>&nbsp;<span class="ident" id="8500903">Uvarint</span><span class="op" id="8500910">(</span><span class="ident" id="8500911">buf</span><span class="op" id="8500914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8500918">if</span>&nbsp;<span class="ident" id="8500921">x</span>&nbsp;<span class="op" id="8500923">!=</span>&nbsp;<span class="num" id="8500926">0</span>&nbsp;<span class="op" id="8500928">||</span>&nbsp;<span class="ident" id="8500931">n</span>&nbsp;<span class="op" id="8500933">!=</span>&nbsp;<span class="num" id="8500936">0</span>&nbsp;<span class="op" id="8500938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8500943">t</span><span class="op" id="8500944">.</span><span class="ident" id="8500945">Errorf</span><span class="op" id="8500951">(</span><span class="string" id="8500952">&#34;Uvarint(%v):&nbsp;got&nbsp;x&nbsp;=&nbsp;%d,&nbsp;n&nbsp;=&nbsp;%d&#34;</span><span class="op" id="8500985">,</span>&nbsp;<span class="ident" id="8500987">buf</span><span class="op" id="8500990">,</span>&nbsp;<span class="ident" id="8500992">x</span><span class="op" id="8500993">,</span>&nbsp;<span class="ident" id="8500995">n</span><span class="op" id="8500996">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501005">x</span><span class="op" id="8501006">,</span>&nbsp;<span class="ident" id="8501008">err</span>&nbsp;<span class="op" id="8501012">:=</span>&nbsp;<span class="ident" id="8501015">ReadUvarint</span><span class="op" id="8501026">(</span><span class="ident" id="8501027">bytes</span><span class="op" id="8501032">.</span><span class="ident" id="8501033">NewReader</span><span class="op" id="8501042">(</span><span class="ident" id="8501043">buf</span><span class="op" id="8501046">)</span><span class="op" id="8501047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8501051">if</span>&nbsp;<span class="ident" id="8501054">x</span>&nbsp;<span class="op" id="8501056">!=</span>&nbsp;<span class="num" id="8501059">0</span>&nbsp;<span class="op" id="8501061">||</span>&nbsp;<span class="ident" id="8501064">err</span>&nbsp;<span class="op" id="8501068">!=</span>&nbsp;<span class="ident" id="8501071">io</span><span class="op" id="8501073">.</span><span class="ident" id="8501074">EOF</span>&nbsp;<span class="op" id="8501078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501083">t</span><span class="op" id="8501084">.</span><span class="ident" id="8501085">Errorf</span><span class="op" id="8501091">(</span><span class="string" id="8501092">&#34;ReadUvarint(%v):&nbsp;got&nbsp;x&nbsp;=&nbsp;%d,&nbsp;err&nbsp;=&nbsp;%s&#34;</span><span class="op" id="8501131">,</span>&nbsp;<span class="ident" id="8501133">buf</span><span class="op" id="8501136">,</span>&nbsp;<span class="ident" id="8501138">x</span><span class="op" id="8501139">,</span>&nbsp;<span class="ident" id="8501141">err</span><span class="op" id="8501144">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501151">}</span><br>
<span class="lineno"></span><span class="op" id="8501153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8501156">func</span>&nbsp;<span class="ident" id="8501161">testOverflow</span><span class="op" id="8501173">(</span><span class="ident" id="8501174">t</span>&nbsp;<span class="op" id="8501176">*</span><span class="ident" id="8501177">testing</span><span class="op" id="8501184">.</span><span class="ident" id="8501185">T</span><span class="op" id="8501186">,</span>&nbsp;<span class="ident" id="8501188">buf</span>&nbsp;<span class="op" id="8501192">[</span><span class="op" id="8501193">]</span><span class="builtintype" id="8501194">byte</span><span class="op" id="8501198">,</span>&nbsp;<span class="ident" id="8501200">n0</span>&nbsp;<span class="builtintype" id="8501203">int</span><span class="op" id="8501206">,</span>&nbsp;<span class="ident" id="8501208">err0</span>&nbsp;<span class="builtintype" id="8501213">error</span><span class="op" id="8501218">)</span>&nbsp;<span class="op" id="8501220">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501223">x</span><span class="op" id="8501224">,</span>&nbsp;<span class="ident" id="8501226">n</span>&nbsp;<span class="op" id="8501228">:=</span>&nbsp;<span class="ident" id="8501231">Uvarint</span><span class="op" id="8501238">(</span><span class="ident" id="8501239">buf</span><span class="op" id="8501242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8501245">if</span>&nbsp;<span class="ident" id="8501248">x</span>&nbsp;<span class="op" id="8501250">!=</span>&nbsp;<span class="num" id="8501253">0</span>&nbsp;<span class="op" id="8501255">||</span>&nbsp;<span class="ident" id="8501258">n</span>&nbsp;<span class="op" id="8501260">!=</span>&nbsp;<span class="ident" id="8501263">n0</span>&nbsp;<span class="op" id="8501266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501270">t</span><span class="op" id="8501271">.</span><span class="ident" id="8501272">Errorf</span><span class="op" id="8501278">(</span><span class="string" id="8501279">&#34;Uvarint(%v):&nbsp;got&nbsp;x&nbsp;=&nbsp;%d,&nbsp;n&nbsp;=&nbsp;%d;&nbsp;want&nbsp;0,&nbsp;%d&#34;</span><span class="op" id="8501324">,</span>&nbsp;<span class="ident" id="8501326">buf</span><span class="op" id="8501329">,</span>&nbsp;<span class="ident" id="8501331">x</span><span class="op" id="8501332">,</span>&nbsp;<span class="ident" id="8501334">n</span><span class="op" id="8501335">,</span>&nbsp;<span class="ident" id="8501337">n0</span><span class="op" id="8501339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501346">x</span><span class="op" id="8501347">,</span>&nbsp;<span class="ident" id="8501349">err</span>&nbsp;<span class="op" id="8501353">:=</span>&nbsp;<span class="ident" id="8501356">ReadUvarint</span><span class="op" id="8501367">(</span><span class="ident" id="8501368">bytes</span><span class="op" id="8501373">.</span><span class="ident" id="8501374">NewReader</span><span class="op" id="8501383">(</span><span class="ident" id="8501384">buf</span><span class="op" id="8501387">)</span><span class="op" id="8501388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8501391">if</span>&nbsp;<span class="ident" id="8501394">x</span>&nbsp;<span class="op" id="8501396">!=</span>&nbsp;<span class="num" id="8501399">0</span>&nbsp;<span class="op" id="8501401">||</span>&nbsp;<span class="ident" id="8501404">err</span>&nbsp;<span class="op" id="8501408">!=</span>&nbsp;<span class="ident" id="8501411">err0</span>&nbsp;<span class="op" id="8501416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501420">t</span><span class="op" id="8501421">.</span><span class="ident" id="8501422">Errorf</span><span class="op" id="8501428">(</span><span class="string" id="8501429">&#34;ReadUvarint(%v):&nbsp;got&nbsp;x&nbsp;=&nbsp;%d,&nbsp;err&nbsp;=&nbsp;%s;&nbsp;want&nbsp;0,&nbsp;%s&#34;</span><span class="op" id="8501480">,</span>&nbsp;<span class="ident" id="8501482">buf</span><span class="op" id="8501485">,</span>&nbsp;<span class="ident" id="8501487">x</span><span class="op" id="8501488">,</span>&nbsp;<span class="ident" id="8501490">err</span><span class="op" id="8501493">,</span>&nbsp;<span class="ident" id="8501495">err0</span><span class="op" id="8501499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501502">}</span><br>
<span class="lineno"></span><span class="op" id="8501504">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="8501507">func</span>&nbsp;<span class="ident" id="8501512">TestOverflow</span><span class="op" id="8501524">(</span><span class="ident" id="8501525">t</span>&nbsp;<span class="op" id="8501527">*</span><span class="ident" id="8501528">testing</span><span class="op" id="8501535">.</span><span class="ident" id="8501536">T</span><span class="op" id="8501537">)</span>&nbsp;<span class="op" id="8501539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501542">testOverflow</span><span class="op" id="8501554">(</span><span class="ident" id="8501555">t</span><span class="op" id="8501556">,</span>&nbsp;<span class="op" id="8501558">[</span><span class="op" id="8501559">]</span><span class="builtintype" id="8501560">byte</span><span class="op" id="8501564">{</span><span class="num" id="8501565">0x80</span><span class="op" id="8501569">,</span>&nbsp;<span class="num" id="8501571">0x80</span><span class="op" id="8501575">,</span>&nbsp;<span class="num" id="8501577">0x80</span><span class="op" id="8501581">,</span>&nbsp;<span class="num" id="8501583">0x80</span><span class="op" id="8501587">,</span>&nbsp;<span class="num" id="8501589">0x80</span><span class="op" id="8501593">,</span>&nbsp;<span class="num" id="8501595">0x80</span><span class="op" id="8501599">,</span>&nbsp;<span class="num" id="8501601">0x80</span><span class="op" id="8501605">,</span>&nbsp;<span class="num" id="8501607">0x80</span><span class="op" id="8501611">,</span>&nbsp;<span class="num" id="8501613">0x80</span><span class="op" id="8501617">,</span>&nbsp;<span class="num" id="8501619">0x2</span><span class="op" id="8501622">}</span><span class="op" id="8501623">,</span>&nbsp;<span class="op" id="8501625">-</span><span class="num" id="8501626">10</span><span class="op" id="8501628">,</span>&nbsp;<span class="ident" id="8501630">overflow</span><span class="op" id="8501638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501641">testOverflow</span><span class="op" id="8501653">(</span><span class="ident" id="8501654">t</span><span class="op" id="8501655">,</span>&nbsp;<span class="op" id="8501657">[</span><span class="op" id="8501658">]</span><span class="builtintype" id="8501659">byte</span><span class="op" id="8501663">{</span><span class="num" id="8501664">0x80</span><span class="op" id="8501668">,</span>&nbsp;<span class="num" id="8501670">0x80</span><span class="op" id="8501674">,</span>&nbsp;<span class="num" id="8501676">0x80</span><span class="op" id="8501680">,</span>&nbsp;<span class="num" id="8501682">0x80</span><span class="op" id="8501686">,</span>&nbsp;<span class="num" id="8501688">0x80</span><span class="op" id="8501692">,</span>&nbsp;<span class="num" id="8501694">0x80</span><span class="op" id="8501698">,</span>&nbsp;<span class="num" id="8501700">0x80</span><span class="op" id="8501704">,</span>&nbsp;<span class="num" id="8501706">0x80</span><span class="op" id="8501710">,</span>&nbsp;<span class="num" id="8501712">0x80</span><span class="op" id="8501716">,</span>&nbsp;<span class="num" id="8501718">0x80</span><span class="op" id="8501722">,</span>&nbsp;<span class="num" id="8501724">0x80</span><span class="op" id="8501728">,</span>&nbsp;<span class="num" id="8501730">0x80</span><span class="op" id="8501734">,</span>&nbsp;<span class="num" id="8501736">0x1</span><span class="op" id="8501739">,</span>&nbsp;<span class="num" id="8501741">0</span><span class="op" id="8501742">,</span>&nbsp;<span class="num" id="8501744">0</span><span class="op" id="8501745">}</span><span class="op" id="8501746">,</span>&nbsp;<span class="op" id="8501748">-</span><span class="num" id="8501749">13</span><span class="op" id="8501751">,</span>&nbsp;<span class="ident" id="8501753">overflow</span><span class="op" id="8501761">)</span><br>
<span class="lineno"></span><span class="op" id="8501763">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8501766">func</span>&nbsp;<span class="ident" id="8501771">TestNonCanonicalZero</span><span class="op" id="8501791">(</span><span class="ident" id="8501792">t</span>&nbsp;<span class="op" id="8501794">*</span><span class="ident" id="8501795">testing</span><span class="op" id="8501802">.</span><span class="ident" id="8501803">T</span><span class="op" id="8501804">)</span>&nbsp;<span class="op" id="8501806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501809">buf</span>&nbsp;<span class="op" id="8501813">:=</span>&nbsp;<span class="op" id="8501816">[</span><span class="op" id="8501817">]</span><span class="builtintype" id="8501818">byte</span><span class="op" id="8501822">{</span><span class="num" id="8501823">0x80</span><span class="op" id="8501827">,</span>&nbsp;<span class="num" id="8501829">0x80</span><span class="op" id="8501833">,</span>&nbsp;<span class="num" id="8501835">0x80</span><span class="op" id="8501839">,</span>&nbsp;<span class="num" id="8501841">0</span><span class="op" id="8501842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501845">x</span><span class="op" id="8501846">,</span>&nbsp;<span class="ident" id="8501848">n</span>&nbsp;<span class="op" id="8501850">:=</span>&nbsp;<span class="ident" id="8501853">Uvarint</span><span class="op" id="8501860">(</span><span class="ident" id="8501861">buf</span><span class="op" id="8501864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8501867">if</span>&nbsp;<span class="ident" id="8501870">x</span>&nbsp;<span class="op" id="8501872">!=</span>&nbsp;<span class="num" id="8501875">0</span>&nbsp;<span class="op" id="8501877">||</span>&nbsp;<span class="ident" id="8501880">n</span>&nbsp;<span class="op" id="8501882">!=</span>&nbsp;<span class="num" id="8501885">4</span>&nbsp;<span class="op" id="8501887">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8501891">t</span><span class="op" id="8501892">.</span><span class="ident" id="8501893">Errorf</span><span class="op" id="8501899">(</span><span class="string" id="8501900">&#34;Uvarint(%v):&nbsp;got&nbsp;x&nbsp;=&nbsp;%d,&nbsp;n&nbsp;=&nbsp;%d;&nbsp;want&nbsp;0,&nbsp;4&#34;</span><span class="op" id="8501944">,</span>&nbsp;<span class="ident" id="8501946">buf</span><span class="op" id="8501949">,</span>&nbsp;<span class="ident" id="8501951">x</span><span class="op" id="8501952">,</span>&nbsp;<span class="ident" id="8501954">n</span><span class="op" id="8501955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8501959">}</span><br>
<span class="lineno"></span><span class="op" id="8501961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8501964">func</span>&nbsp;<span class="ident" id="8501969">BenchmarkPutUvarint32</span><span class="op" id="8501990">(</span><span class="ident" id="8501991">b</span>&nbsp;<span class="op" id="8501993">*</span><span class="ident" id="8501994">testing</span><span class="op" id="8502001">.</span><span class="ident" id="8502002">B</span><span class="op" id="8502003">)</span>&nbsp;<span class="op" id="8502005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502008">buf</span>&nbsp;<span class="op" id="8502012">:=</span>&nbsp;<span class="builtinfunc" id="8502015">make</span><span class="op" id="8502019">(</span><span class="op" id="8502020">[</span><span class="op" id="8502021">]</span><span class="builtintype" id="8502022">byte</span><span class="op" id="8502026">,</span>&nbsp;<span class="ident" id="8502028">MaxVarintLen32</span><span class="op" id="8502042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502045">b</span><span class="op" id="8502046">.</span><span class="ident" id="8502047">SetBytes</span><span class="op" id="8502055">(</span><span class="num" id="8502056">4</span><span class="op" id="8502057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8502060">for</span>&nbsp;<span class="ident" id="8502064">i</span>&nbsp;<span class="op" id="8502066">:=</span>&nbsp;<span class="num" id="8502069">0</span><span class="op" id="8502070">;</span>&nbsp;<span class="ident" id="8502072">i</span>&nbsp;<span class="op" id="8502074">&lt;</span>&nbsp;<span class="ident" id="8502076">b</span><span class="op" id="8502077">.</span><span class="ident" id="8502078">N</span><span class="op" id="8502079">;</span>&nbsp;<span class="ident" id="8502081">i</span><span class="op" id="8502082">++</span>&nbsp;<span class="op" id="8502085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8502089">for</span>&nbsp;<span class="ident" id="8502093">j</span>&nbsp;<span class="op" id="8502095">:=</span>&nbsp;<span class="builtintype" id="8502098">uint</span><span class="op" id="8502102">(</span><span class="num" id="8502103">0</span><span class="op" id="8502104">)</span><span class="op" id="8502105">;</span>&nbsp;<span class="ident" id="8502107">j</span>&nbsp;<span class="op" id="8502109">&lt;</span>&nbsp;<span class="ident" id="8502111">MaxVarintLen32</span><span class="op" id="8502125">;</span>&nbsp;<span class="ident" id="8502127">j</span><span class="op" id="8502128">++</span>&nbsp;<span class="op" id="8502131">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502136">PutUvarint</span><span class="op" id="8502146">(</span><span class="ident" id="8502147">buf</span><span class="op" id="8502150">,</span>&nbsp;<span class="num" id="8502152">1</span><span class="op" id="8502153">&lt;&lt;</span><span class="op" id="8502155">(</span><span class="ident" id="8502156">j</span><span class="op" id="8502157">*</span><span class="num" id="8502158">7</span><span class="op" id="8502159">)</span><span class="op" id="8502160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8502164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8502167">}</span><br>
<span class="lineno"></span><span class="op" id="8502169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="keyword" id="8502172">func</span>&nbsp;<span class="ident" id="8502177">BenchmarkPutUvarint64</span><span class="op" id="8502198">(</span><span class="ident" id="8502199">b</span>&nbsp;<span class="op" id="8502201">*</span><span class="ident" id="8502202">testing</span><span class="op" id="8502209">.</span><span class="ident" id="8502210">B</span><span class="op" id="8502211">)</span>&nbsp;<span class="op" id="8502213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502216">buf</span>&nbsp;<span class="op" id="8502220">:=</span>&nbsp;<span class="builtinfunc" id="8502223">make</span><span class="op" id="8502227">(</span><span class="op" id="8502228">[</span><span class="op" id="8502229">]</span><span class="builtintype" id="8502230">byte</span><span class="op" id="8502234">,</span>&nbsp;<span class="ident" id="8502236">MaxVarintLen64</span><span class="op" id="8502250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502253">b</span><span class="op" id="8502254">.</span><span class="ident" id="8502255">SetBytes</span><span class="op" id="8502263">(</span><span class="num" id="8502264">8</span><span class="op" id="8502265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8502268">for</span>&nbsp;<span class="ident" id="8502272">i</span>&nbsp;<span class="op" id="8502274">:=</span>&nbsp;<span class="num" id="8502277">0</span><span class="op" id="8502278">;</span>&nbsp;<span class="ident" id="8502280">i</span>&nbsp;<span class="op" id="8502282">&lt;</span>&nbsp;<span class="ident" id="8502284">b</span><span class="op" id="8502285">.</span><span class="ident" id="8502286">N</span><span class="op" id="8502287">;</span>&nbsp;<span class="ident" id="8502289">i</span><span class="op" id="8502290">++</span>&nbsp;<span class="op" id="8502293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8502297">for</span>&nbsp;<span class="ident" id="8502301">j</span>&nbsp;<span class="op" id="8502303">:=</span>&nbsp;<span class="builtintype" id="8502306">uint</span><span class="op" id="8502310">(</span><span class="num" id="8502311">0</span><span class="op" id="8502312">)</span><span class="op" id="8502313">;</span>&nbsp;<span class="ident" id="8502315">j</span>&nbsp;<span class="op" id="8502317">&lt;</span>&nbsp;<span class="ident" id="8502319">MaxVarintLen64</span><span class="op" id="8502333">;</span>&nbsp;<span class="ident" id="8502335">j</span><span class="op" id="8502336">++</span>&nbsp;<span class="op" id="8502339">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8502344">PutUvarint</span><span class="op" id="8502354">(</span><span class="ident" id="8502355">buf</span><span class="op" id="8502358">,</span>&nbsp;<span class="num" id="8502360">1</span><span class="op" id="8502361">&lt;&lt;</span><span class="op" id="8502363">(</span><span class="ident" id="8502364">j</span><span class="op" id="8502365">*</span><span class="num" id="8502366">7</span><span class="op" id="8502367">)</span><span class="op" id="8502368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8502372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8502375">}</span><br>
<span class="lineno"></span><span class="op" id="8502377">}</span>
</div>
</body>
</html>
