<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html" class="current">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6727443">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6727499">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6727553">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6727604">package</span>&nbsp;<span class="ident" id="6727612">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6727617">import</span>&nbsp;<span class="string" id="6727624">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6727634">const</span>&nbsp;<span class="op" id="6727640">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727643">icmpv4EchoRequest</span>&nbsp;<span class="op" id="6727661">=</span>&nbsp;<span class="num" id="6727663">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727666">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6727684">=</span>&nbsp;<span class="num" id="6727686">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727689">icmpv6EchoRequest</span>&nbsp;<span class="op" id="6727707">=</span>&nbsp;<span class="num" id="6727709">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727714">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6727732">=</span>&nbsp;<span class="num" id="6727734">129</span><br>
<span class="lineno"></span><span class="op" id="6727738">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6727741">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6727784">type</span>&nbsp;<span class="ident" id="6727789">icmpMessage</span>&nbsp;<span class="keyword" id="6727801">struct</span>&nbsp;<span class="op" id="6727808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727811">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6727820">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6727836">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727845">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6727854">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6727870">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727879">Checksum</span>&nbsp;<span class="builtintype" id="6727888">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6727904">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727917">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727926">icmpMessageBody</span>&nbsp;<span class="comment" id="6727942">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="6727950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6727953">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="6728005">type</span>&nbsp;<span class="ident" id="6728010">icmpMessageBody</span>&nbsp;<span class="keyword" id="6728026">interface</span>&nbsp;<span class="op" id="6728036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728039">Len</span><span class="op" id="6728042">(</span><span class="op" id="6728043">)</span>&nbsp;<span class="builtintype" id="6728045">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728050">Marshal</span><span class="op" id="6728057">(</span><span class="op" id="6728058">)</span>&nbsp;<span class="op" id="6728060">(</span><span class="op" id="6728061">[</span><span class="op" id="6728062">]</span><span class="builtintype" id="6728063">byte</span><span class="op" id="6728067">,</span>&nbsp;<span class="builtintype" id="6728069">error</span><span class="op" id="6728074">)</span><br>
<span class="lineno"></span><span class="op" id="6728076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="6728079">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6728147">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="6728167">func</span>&nbsp;<span class="op" id="6728172">(</span><span class="ident" id="6728173">m</span>&nbsp;<span class="op" id="6728175">*</span><span class="ident" id="6728176">icmpMessage</span><span class="op" id="6728187">)</span>&nbsp;<span class="ident" id="6728189">Marshal</span><span class="op" id="6728196">(</span><span class="op" id="6728197">)</span>&nbsp;<span class="op" id="6728199">(</span><span class="op" id="6728200">[</span><span class="op" id="6728201">]</span><span class="builtintype" id="6728202">byte</span><span class="op" id="6728206">,</span>&nbsp;<span class="builtintype" id="6728208">error</span><span class="op" id="6728213">)</span>&nbsp;<span class="op" id="6728215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728218">b</span>&nbsp;<span class="op" id="6728220">:=</span>&nbsp;<span class="op" id="6728223">[</span><span class="op" id="6728224">]</span><span class="builtintype" id="6728225">byte</span><span class="op" id="6728229">{</span><span class="builtintype" id="6728230">byte</span><span class="op" id="6728234">(</span><span class="ident" id="6728235">m</span><span class="op" id="6728236">.</span><span class="ident" id="6728237">Type</span><span class="op" id="6728241">)</span><span class="op" id="6728242">,</span>&nbsp;<span class="builtintype" id="6728244">byte</span><span class="op" id="6728248">(</span><span class="ident" id="6728249">m</span><span class="op" id="6728250">.</span><span class="ident" id="6728251">Code</span><span class="op" id="6728255">)</span><span class="op" id="6728256">,</span>&nbsp;<span class="num" id="6728258">0</span><span class="op" id="6728259">,</span>&nbsp;<span class="num" id="6728261">0</span><span class="op" id="6728262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728265">if</span>&nbsp;<span class="ident" id="6728268">m</span><span class="op" id="6728269">.</span><span class="ident" id="6728270">Body</span>&nbsp;<span class="op" id="6728275">!=</span>&nbsp;<span class="builtintype" id="6728278">nil</span>&nbsp;<span class="op" id="6728282">&amp;&amp;</span>&nbsp;<span class="ident" id="6728285">m</span><span class="op" id="6728286">.</span><span class="ident" id="6728287">Body</span><span class="op" id="6728291">.</span><span class="ident" id="6728292">Len</span><span class="op" id="6728295">(</span><span class="op" id="6728296">)</span>&nbsp;<span class="op" id="6728298">!=</span>&nbsp;<span class="num" id="6728301">0</span>&nbsp;<span class="op" id="6728303">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728307">mb</span><span class="op" id="6728309">,</span>&nbsp;<span class="ident" id="6728311">err</span>&nbsp;<span class="op" id="6728315">:=</span>&nbsp;<span class="ident" id="6728318">m</span><span class="op" id="6728319">.</span><span class="ident" id="6728320">Body</span><span class="op" id="6728324">.</span><span class="ident" id="6728325">Marshal</span><span class="op" id="6728332">(</span><span class="op" id="6728333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728337">if</span>&nbsp;<span class="ident" id="6728340">err</span>&nbsp;<span class="op" id="6728344">!=</span>&nbsp;<span class="builtintype" id="6728347">nil</span>&nbsp;<span class="op" id="6728351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728356">return</span>&nbsp;<span class="builtintype" id="6728363">nil</span><span class="op" id="6728366">,</span>&nbsp;<span class="ident" id="6728368">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6728374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728378">b</span>&nbsp;<span class="op" id="6728380">=</span>&nbsp;<span class="builtinfunc" id="6728382">append</span><span class="op" id="6728388">(</span><span class="ident" id="6728389">b</span><span class="op" id="6728390">,</span>&nbsp;<span class="ident" id="6728392">mb</span><span class="op" id="6728394">...</span><span class="op" id="6728397">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6728400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728403">switch</span>&nbsp;<span class="ident" id="6728410">m</span><span class="op" id="6728411">.</span><span class="ident" id="6728412">Type</span>&nbsp;<span class="op" id="6728417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728420">case</span>&nbsp;<span class="ident" id="6728425">icmpv6EchoRequest</span><span class="op" id="6728442">,</span>&nbsp;<span class="ident" id="6728444">icmpv6EchoReply</span><span class="op" id="6728459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728463">return</span>&nbsp;<span class="ident" id="6728470">b</span><span class="op" id="6728471">,</span>&nbsp;<span class="builtintype" id="6728473">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6728478">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728481">csumcv</span>&nbsp;<span class="op" id="6728488">:=</span>&nbsp;<span class="builtinfunc" id="6728491">len</span><span class="op" id="6728494">(</span><span class="ident" id="6728495">b</span><span class="op" id="6728496">)</span>&nbsp;<span class="op" id="6728498">-</span>&nbsp;<span class="num" id="6728500">1</span>&nbsp;<span class="comment" id="6728502">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728524">s</span>&nbsp;<span class="op" id="6728526">:=</span>&nbsp;<span class="builtintype" id="6728529">uint32</span><span class="op" id="6728535">(</span><span class="num" id="6728536">0</span><span class="op" id="6728537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728540">for</span>&nbsp;<span class="ident" id="6728544">i</span>&nbsp;<span class="op" id="6728546">:=</span>&nbsp;<span class="num" id="6728549">0</span><span class="op" id="6728550">;</span>&nbsp;<span class="ident" id="6728552">i</span>&nbsp;<span class="op" id="6728554">&lt;</span>&nbsp;<span class="ident" id="6728556">csumcv</span><span class="op" id="6728562">;</span>&nbsp;<span class="ident" id="6728564">i</span>&nbsp;<span class="op" id="6728566">+=</span>&nbsp;<span class="num" id="6728569">2</span>&nbsp;<span class="op" id="6728571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728575">s</span>&nbsp;<span class="op" id="6728577">+=</span>&nbsp;<span class="builtintype" id="6728580">uint32</span><span class="op" id="6728586">(</span><span class="ident" id="6728587">b</span><span class="op" id="6728588">[</span><span class="ident" id="6728589">i</span><span class="op" id="6728590">+</span><span class="num" id="6728591">1</span><span class="op" id="6728592">]</span><span class="op" id="6728593">)</span><span class="op" id="6728594">&lt;&lt;</span><span class="num" id="6728596">8</span>&nbsp;<span class="op" id="6728598">|</span>&nbsp;<span class="builtintype" id="6728600">uint32</span><span class="op" id="6728606">(</span><span class="ident" id="6728607">b</span><span class="op" id="6728608">[</span><span class="ident" id="6728609">i</span><span class="op" id="6728610">]</span><span class="op" id="6728611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6728614">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728617">if</span>&nbsp;<span class="ident" id="6728620">csumcv</span><span class="op" id="6728626">&amp;</span><span class="num" id="6728627">1</span>&nbsp;<span class="op" id="6728629">==</span>&nbsp;<span class="num" id="6728632">0</span>&nbsp;<span class="op" id="6728634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728638">s</span>&nbsp;<span class="op" id="6728640">+=</span>&nbsp;<span class="builtintype" id="6728643">uint32</span><span class="op" id="6728649">(</span><span class="ident" id="6728650">b</span><span class="op" id="6728651">[</span><span class="ident" id="6728652">csumcv</span><span class="op" id="6728658">]</span><span class="op" id="6728659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6728662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728665">s</span>&nbsp;<span class="op" id="6728667">=</span>&nbsp;<span class="ident" id="6728669">s</span><span class="op" id="6728670">&gt;&gt;</span><span class="num" id="6728672">16</span>&nbsp;<span class="op" id="6728675">+</span>&nbsp;<span class="ident" id="6728677">s</span><span class="op" id="6728678">&amp;</span><span class="num" id="6728679">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728687">s</span>&nbsp;<span class="op" id="6728689">=</span>&nbsp;<span class="ident" id="6728691">s</span>&nbsp;<span class="op" id="6728693">+</span>&nbsp;<span class="ident" id="6728695">s</span><span class="op" id="6728696">&gt;&gt;</span><span class="num" id="6728698">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6728702">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6728757">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728801">b</span><span class="op" id="6728802">[</span><span class="num" id="6728803">2</span><span class="op" id="6728804">]</span>&nbsp;<span class="op" id="6728806">^=</span>&nbsp;<span class="builtintype" id="6728809">byte</span><span class="op" id="6728813">(</span><span class="op" id="6728814">^</span><span class="ident" id="6728815">s</span><span class="op" id="6728816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728819">b</span><span class="op" id="6728820">[</span><span class="num" id="6728821">3</span><span class="op" id="6728822">]</span>&nbsp;<span class="op" id="6728824">^=</span>&nbsp;<span class="builtintype" id="6728827">byte</span><span class="op" id="6728831">(</span><span class="op" id="6728832">^</span><span class="ident" id="6728833">s</span>&nbsp;<span class="op" id="6728835">&gt;&gt;</span>&nbsp;<span class="num" id="6728838">8</span><span class="op" id="6728839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728842">return</span>&nbsp;<span class="ident" id="6728849">b</span><span class="op" id="6728850">,</span>&nbsp;<span class="builtintype" id="6728852">nil</span><br>
<span class="lineno">60</span><span class="op" id="6728856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6728859">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6728908">func</span>&nbsp;<span class="ident" id="6728913">parseICMPMessage</span><span class="op" id="6728929">(</span><span class="ident" id="6728930">b</span>&nbsp;<span class="op" id="6728932">[</span><span class="op" id="6728933">]</span><span class="builtintype" id="6728934">byte</span><span class="op" id="6728938">)</span>&nbsp;<span class="op" id="6728940">(</span><span class="op" id="6728941">*</span><span class="ident" id="6728942">icmpMessage</span><span class="op" id="6728953">,</span>&nbsp;<span class="builtintype" id="6728955">error</span><span class="op" id="6728960">)</span>&nbsp;<span class="op" id="6728962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728965">msglen</span>&nbsp;<span class="op" id="6728972">:=</span>&nbsp;<span class="builtinfunc" id="6728975">len</span><span class="op" id="6728978">(</span><span class="ident" id="6728979">b</span><span class="op" id="6728980">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728983">if</span>&nbsp;<span class="ident" id="6728986">msglen</span>&nbsp;<span class="op" id="6728993">&lt;</span>&nbsp;<span class="num" id="6728995">4</span>&nbsp;<span class="op" id="6728997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729001">return</span>&nbsp;<span class="builtintype" id="6729008">nil</span><span class="op" id="6729011">,</span>&nbsp;<span class="ident" id="6729013">errors</span><span class="op" id="6729019">.</span><span class="ident" id="6729020">New</span><span class="op" id="6729023">(</span><span class="string" id="6729024">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="6729043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729049">m</span>&nbsp;<span class="op" id="6729051">:=</span>&nbsp;<span class="op" id="6729054">&amp;</span><span class="ident" id="6729055">icmpMessage</span><span class="op" id="6729066">{</span><span class="ident" id="6729067">Type</span><span class="op" id="6729071">:</span>&nbsp;<span class="builtintype" id="6729073">int</span><span class="op" id="6729076">(</span><span class="ident" id="6729077">b</span><span class="op" id="6729078">[</span><span class="num" id="6729079">0</span><span class="op" id="6729080">]</span><span class="op" id="6729081">)</span><span class="op" id="6729082">,</span>&nbsp;<span class="ident" id="6729084">Code</span><span class="op" id="6729088">:</span>&nbsp;<span class="builtintype" id="6729090">int</span><span class="op" id="6729093">(</span><span class="ident" id="6729094">b</span><span class="op" id="6729095">[</span><span class="num" id="6729096">1</span><span class="op" id="6729097">]</span><span class="op" id="6729098">)</span><span class="op" id="6729099">,</span>&nbsp;<span class="ident" id="6729101">Checksum</span><span class="op" id="6729109">:</span>&nbsp;<span class="builtintype" id="6729111">int</span><span class="op" id="6729114">(</span><span class="ident" id="6729115">b</span><span class="op" id="6729116">[</span><span class="num" id="6729117">2</span><span class="op" id="6729118">]</span><span class="op" id="6729119">)</span><span class="op" id="6729120">&lt;&lt;</span><span class="num" id="6729122">8</span>&nbsp;<span class="op" id="6729124">|</span>&nbsp;<span class="builtintype" id="6729126">int</span><span class="op" id="6729129">(</span><span class="ident" id="6729130">b</span><span class="op" id="6729131">[</span><span class="num" id="6729132">3</span><span class="op" id="6729133">]</span><span class="op" id="6729134">)</span><span class="op" id="6729135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729138">if</span>&nbsp;<span class="ident" id="6729141">msglen</span>&nbsp;<span class="op" id="6729148">&gt;</span>&nbsp;<span class="num" id="6729150">4</span>&nbsp;<span class="op" id="6729152">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729156">var</span>&nbsp;<span class="ident" id="6729160">err</span>&nbsp;<span class="builtintype" id="6729164">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729172">switch</span>&nbsp;<span class="ident" id="6729179">m</span><span class="op" id="6729180">.</span><span class="ident" id="6729181">Type</span>&nbsp;<span class="op" id="6729186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729190">case</span>&nbsp;<span class="ident" id="6729195">icmpv4EchoRequest</span><span class="op" id="6729212">,</span>&nbsp;<span class="ident" id="6729214">icmpv4EchoReply</span><span class="op" id="6729229">,</span>&nbsp;<span class="ident" id="6729231">icmpv6EchoRequest</span><span class="op" id="6729248">,</span>&nbsp;<span class="ident" id="6729250">icmpv6EchoReply</span><span class="op" id="6729265">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729270">m</span><span class="op" id="6729271">.</span><span class="ident" id="6729272">Body</span><span class="op" id="6729276">,</span>&nbsp;<span class="ident" id="6729278">err</span>&nbsp;<span class="op" id="6729282">=</span>&nbsp;<span class="ident" id="6729284">parseICMPEcho</span><span class="op" id="6729297">(</span><span class="ident" id="6729298">b</span><span class="op" id="6729299">[</span><span class="num" id="6729300">4</span><span class="op" id="6729301">:</span><span class="op" id="6729302">]</span><span class="op" id="6729303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729308">if</span>&nbsp;<span class="ident" id="6729311">err</span>&nbsp;<span class="op" id="6729315">!=</span>&nbsp;<span class="builtintype" id="6729318">nil</span>&nbsp;<span class="op" id="6729322">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729328">return</span>&nbsp;<span class="builtintype" id="6729335">nil</span><span class="op" id="6729338">,</span>&nbsp;<span class="ident" id="6729340">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729357">return</span>&nbsp;<span class="ident" id="6729364">m</span><span class="op" id="6729365">,</span>&nbsp;<span class="builtintype" id="6729367">nil</span><br>
<span class="lineno">80</span><span class="op" id="6729371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6729374">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6729442">type</span>&nbsp;<span class="ident" id="6729447">icmpEcho</span>&nbsp;<span class="keyword" id="6729456">struct</span>&nbsp;<span class="op" id="6729463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729466">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6729471">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6729478">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729493">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="6729498">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6729505">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729525">Data</span>&nbsp;<span class="op" id="6729530">[</span><span class="op" id="6729531">]</span><span class="builtintype" id="6729532">byte</span>&nbsp;<span class="comment" id="6729537">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="6729545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6729548">func</span>&nbsp;<span class="op" id="6729553">(</span><span class="ident" id="6729554">p</span>&nbsp;<span class="op" id="6729556">*</span><span class="ident" id="6729557">icmpEcho</span><span class="op" id="6729565">)</span>&nbsp;<span class="ident" id="6729567">Len</span><span class="op" id="6729570">(</span><span class="op" id="6729571">)</span>&nbsp;<span class="builtintype" id="6729573">int</span>&nbsp;<span class="op" id="6729577">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729580">if</span>&nbsp;<span class="ident" id="6729583">p</span>&nbsp;<span class="op" id="6729585">==</span>&nbsp;<span class="builtintype" id="6729588">nil</span>&nbsp;<span class="op" id="6729592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729596">return</span>&nbsp;<span class="num" id="6729603">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729609">return</span>&nbsp;<span class="num" id="6729616">4</span>&nbsp;<span class="op" id="6729618">+</span>&nbsp;<span class="builtinfunc" id="6729620">len</span><span class="op" id="6729623">(</span><span class="ident" id="6729624">p</span><span class="op" id="6729625">.</span><span class="ident" id="6729626">Data</span><span class="op" id="6729630">)</span><br>
<span class="lineno"></span><span class="op" id="6729632">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="6729635">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6729703">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6729728">func</span>&nbsp;<span class="op" id="6729733">(</span><span class="ident" id="6729734">p</span>&nbsp;<span class="op" id="6729736">*</span><span class="ident" id="6729737">icmpEcho</span><span class="op" id="6729745">)</span>&nbsp;<span class="ident" id="6729747">Marshal</span><span class="op" id="6729754">(</span><span class="op" id="6729755">)</span>&nbsp;<span class="op" id="6729757">(</span><span class="op" id="6729758">[</span><span class="op" id="6729759">]</span><span class="builtintype" id="6729760">byte</span><span class="op" id="6729764">,</span>&nbsp;<span class="builtintype" id="6729766">error</span><span class="op" id="6729771">)</span>&nbsp;<span class="op" id="6729773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729776">b</span>&nbsp;<span class="op" id="6729778">:=</span>&nbsp;<span class="builtinfunc" id="6729781">make</span><span class="op" id="6729785">(</span><span class="op" id="6729786">[</span><span class="op" id="6729787">]</span><span class="builtintype" id="6729788">byte</span><span class="op" id="6729792">,</span>&nbsp;<span class="num" id="6729794">4</span><span class="op" id="6729795">+</span><span class="builtinfunc" id="6729796">len</span><span class="op" id="6729799">(</span><span class="ident" id="6729800">p</span><span class="op" id="6729801">.</span><span class="ident" id="6729802">Data</span><span class="op" id="6729806">)</span><span class="op" id="6729807">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729810">b</span><span class="op" id="6729811">[</span><span class="num" id="6729812">0</span><span class="op" id="6729813">]</span><span class="op" id="6729814">,</span>&nbsp;<span class="ident" id="6729816">b</span><span class="op" id="6729817">[</span><span class="num" id="6729818">1</span><span class="op" id="6729819">]</span>&nbsp;<span class="op" id="6729821">=</span>&nbsp;<span class="builtintype" id="6729823">byte</span><span class="op" id="6729827">(</span><span class="ident" id="6729828">p</span><span class="op" id="6729829">.</span><span class="ident" id="6729830">ID</span><span class="op" id="6729832">&gt;&gt;</span><span class="num" id="6729834">8</span><span class="op" id="6729835">)</span><span class="op" id="6729836">,</span>&nbsp;<span class="builtintype" id="6729838">byte</span><span class="op" id="6729842">(</span><span class="ident" id="6729843">p</span><span class="op" id="6729844">.</span><span class="ident" id="6729845">ID</span><span class="op" id="6729847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729850">b</span><span class="op" id="6729851">[</span><span class="num" id="6729852">2</span><span class="op" id="6729853">]</span><span class="op" id="6729854">,</span>&nbsp;<span class="ident" id="6729856">b</span><span class="op" id="6729857">[</span><span class="num" id="6729858">3</span><span class="op" id="6729859">]</span>&nbsp;<span class="op" id="6729861">=</span>&nbsp;<span class="builtintype" id="6729863">byte</span><span class="op" id="6729867">(</span><span class="ident" id="6729868">p</span><span class="op" id="6729869">.</span><span class="ident" id="6729870">Seq</span><span class="op" id="6729873">&gt;&gt;</span><span class="num" id="6729875">8</span><span class="op" id="6729876">)</span><span class="op" id="6729877">,</span>&nbsp;<span class="builtintype" id="6729879">byte</span><span class="op" id="6729883">(</span><span class="ident" id="6729884">p</span><span class="op" id="6729885">.</span><span class="ident" id="6729886">Seq</span><span class="op" id="6729889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6729892">copy</span><span class="op" id="6729896">(</span><span class="ident" id="6729897">b</span><span class="op" id="6729898">[</span><span class="num" id="6729899">4</span><span class="op" id="6729900">:</span><span class="op" id="6729901">]</span><span class="op" id="6729902">,</span>&nbsp;<span class="ident" id="6729904">p</span><span class="op" id="6729905">.</span><span class="ident" id="6729906">Data</span><span class="op" id="6729910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729913">return</span>&nbsp;<span class="ident" id="6729920">b</span><span class="op" id="6729921">,</span>&nbsp;<span class="builtintype" id="6729923">nil</span><br>
<span class="lineno"></span><span class="op" id="6729927">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="6729930">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="6729997">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6730006">func</span>&nbsp;<span class="ident" id="6730011">parseICMPEcho</span><span class="op" id="6730024">(</span><span class="ident" id="6730025">b</span>&nbsp;<span class="op" id="6730027">[</span><span class="op" id="6730028">]</span><span class="builtintype" id="6730029">byte</span><span class="op" id="6730033">)</span>&nbsp;<span class="op" id="6730035">(</span><span class="op" id="6730036">*</span><span class="ident" id="6730037">icmpEcho</span><span class="op" id="6730045">,</span>&nbsp;<span class="builtintype" id="6730047">error</span><span class="op" id="6730052">)</span>&nbsp;<span class="op" id="6730054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730057">bodylen</span>&nbsp;<span class="op" id="6730065">:=</span>&nbsp;<span class="builtinfunc" id="6730068">len</span><span class="op" id="6730071">(</span><span class="ident" id="6730072">b</span><span class="op" id="6730073">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730076">p</span>&nbsp;<span class="op" id="6730078">:=</span>&nbsp;<span class="op" id="6730081">&amp;</span><span class="ident" id="6730082">icmpEcho</span><span class="op" id="6730090">{</span><span class="ident" id="6730091">ID</span><span class="op" id="6730093">:</span>&nbsp;<span class="builtintype" id="6730095">int</span><span class="op" id="6730098">(</span><span class="ident" id="6730099">b</span><span class="op" id="6730100">[</span><span class="num" id="6730101">0</span><span class="op" id="6730102">]</span><span class="op" id="6730103">)</span><span class="op" id="6730104">&lt;&lt;</span><span class="num" id="6730106">8</span>&nbsp;<span class="op" id="6730108">|</span>&nbsp;<span class="builtintype" id="6730110">int</span><span class="op" id="6730113">(</span><span class="ident" id="6730114">b</span><span class="op" id="6730115">[</span><span class="num" id="6730116">1</span><span class="op" id="6730117">]</span><span class="op" id="6730118">)</span><span class="op" id="6730119">,</span>&nbsp;<span class="ident" id="6730121">Seq</span><span class="op" id="6730124">:</span>&nbsp;<span class="builtintype" id="6730126">int</span><span class="op" id="6730129">(</span><span class="ident" id="6730130">b</span><span class="op" id="6730131">[</span><span class="num" id="6730132">2</span><span class="op" id="6730133">]</span><span class="op" id="6730134">)</span><span class="op" id="6730135">&lt;&lt;</span><span class="num" id="6730137">8</span>&nbsp;<span class="op" id="6730139">|</span>&nbsp;<span class="builtintype" id="6730141">int</span><span class="op" id="6730144">(</span><span class="ident" id="6730145">b</span><span class="op" id="6730146">[</span><span class="num" id="6730147">3</span><span class="op" id="6730148">]</span><span class="op" id="6730149">)</span><span class="op" id="6730150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730153">if</span>&nbsp;<span class="ident" id="6730156">bodylen</span>&nbsp;<span class="op" id="6730164">&gt;</span>&nbsp;<span class="num" id="6730166">4</span>&nbsp;<span class="op" id="6730168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730172">p</span><span class="op" id="6730173">.</span><span class="ident" id="6730174">Data</span>&nbsp;<span class="op" id="6730179">=</span>&nbsp;<span class="builtinfunc" id="6730181">make</span><span class="op" id="6730185">(</span><span class="op" id="6730186">[</span><span class="op" id="6730187">]</span><span class="builtintype" id="6730188">byte</span><span class="op" id="6730192">,</span>&nbsp;<span class="ident" id="6730194">bodylen</span><span class="op" id="6730201">-</span><span class="num" id="6730202">4</span><span class="op" id="6730203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6730207">copy</span><span class="op" id="6730211">(</span><span class="ident" id="6730212">p</span><span class="op" id="6730213">.</span><span class="ident" id="6730214">Data</span><span class="op" id="6730218">,</span>&nbsp;<span class="ident" id="6730220">b</span><span class="op" id="6730221">[</span><span class="num" id="6730222">4</span><span class="op" id="6730223">:</span><span class="op" id="6730224">]</span><span class="op" id="6730225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6730228">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730231">return</span>&nbsp;<span class="ident" id="6730238">p</span><span class="op" id="6730239">,</span>&nbsp;<span class="builtintype" id="6730241">nil</span><br>
<span class="lineno"></span><span class="op" id="6730245">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
