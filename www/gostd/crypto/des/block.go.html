<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html" class="current">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4011033">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4011088">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4011142">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4011193">package</span>&nbsp;<span class="ident" id="4011201">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4011206">import</span>&nbsp;<span class="op" id="4011213">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4011216">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="4011234">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4011237">func</span>&nbsp;<span class="ident" id="4011242">cryptBlock</span><span class="op" id="4011252">(</span><span class="ident" id="4011253">subkeys</span>&nbsp;<span class="op" id="4011261">[</span><span class="op" id="4011262">]</span><span class="ident" id="4011263">uint64</span><span class="op" id="4011269">,</span>&nbsp;<span class="ident" id="4011271">dst</span><span class="op" id="4011274">,</span>&nbsp;<span class="ident" id="4011276">src</span>&nbsp;<span class="op" id="4011280">[</span><span class="op" id="4011281">]</span><span class="builtintype" id="4011282">byte</span><span class="op" id="4011286">,</span>&nbsp;<span class="ident" id="4011288">decrypt</span>&nbsp;<span class="builtintype" id="4011296">bool</span><span class="op" id="4011300">)</span>&nbsp;<span class="op" id="4011302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011305">b</span>&nbsp;<span class="op" id="4011307">:=</span>&nbsp;<span class="ident" id="4011310">binary</span><span class="op" id="4011316">.</span><span class="ident" id="4011317">BigEndian</span><span class="op" id="4011326">.</span><span class="ident" id="4011327">Uint64</span><span class="op" id="4011333">(</span><span class="ident" id="4011334">src</span><span class="op" id="4011337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011340">b</span>&nbsp;<span class="op" id="4011342">=</span>&nbsp;<span class="ident" id="4011344">permuteInitialBlock</span><span class="op" id="4011363">(</span><span class="ident" id="4011364">b</span><span class="op" id="4011365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011368">left</span><span class="op" id="4011372">,</span>&nbsp;<span class="ident" id="4011374">right</span>&nbsp;<span class="op" id="4011380">:=</span>&nbsp;<span class="builtintype" id="4011383">uint32</span><span class="op" id="4011389">(</span><span class="ident" id="4011390">b</span><span class="op" id="4011391">&gt;&gt;</span><span class="num" id="4011393">32</span><span class="op" id="4011395">)</span><span class="op" id="4011396">,</span>&nbsp;<span class="builtintype" id="4011398">uint32</span><span class="op" id="4011404">(</span><span class="ident" id="4011405">b</span><span class="op" id="4011406">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4011410">var</span>&nbsp;<span class="ident" id="4011414">subkey</span>&nbsp;<span class="ident" id="4011421">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4011429">for</span>&nbsp;<span class="ident" id="4011433">i</span>&nbsp;<span class="op" id="4011435">:=</span>&nbsp;<span class="num" id="4011438">0</span><span class="op" id="4011439">;</span>&nbsp;<span class="ident" id="4011441">i</span>&nbsp;<span class="op" id="4011443">&lt;</span>&nbsp;<span class="num" id="4011445">16</span><span class="op" id="4011447">;</span>&nbsp;<span class="ident" id="4011449">i</span><span class="op" id="4011450">++</span>&nbsp;<span class="op" id="4011453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4011457">if</span>&nbsp;<span class="ident" id="4011460">decrypt</span>&nbsp;<span class="op" id="4011468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011473">subkey</span>&nbsp;<span class="op" id="4011480">=</span>&nbsp;<span class="ident" id="4011482">subkeys</span><span class="op" id="4011489">[</span><span class="num" id="4011490">15</span><span class="op" id="4011492">-</span><span class="ident" id="4011493">i</span><span class="op" id="4011494">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4011498">}</span>&nbsp;<span class="keyword" id="4011500">else</span>&nbsp;<span class="op" id="4011505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011510">subkey</span>&nbsp;<span class="op" id="4011517">=</span>&nbsp;<span class="ident" id="4011519">subkeys</span><span class="op" id="4011526">[</span><span class="ident" id="4011527">i</span><span class="op" id="4011528">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4011532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011537">left</span><span class="op" id="4011541">,</span>&nbsp;<span class="ident" id="4011543">right</span>&nbsp;<span class="op" id="4011549">=</span>&nbsp;<span class="ident" id="4011551">right</span><span class="op" id="4011556">,</span>&nbsp;<span class="ident" id="4011558">left</span><span class="op" id="4011562">^</span><span class="ident" id="4011563">feistel</span><span class="op" id="4011570">(</span><span class="ident" id="4011571">right</span><span class="op" id="4011576">,</span>&nbsp;<span class="ident" id="4011578">subkey</span><span class="op" id="4011584">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4011587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011590">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011644">preOutput</span>&nbsp;<span class="op" id="4011654">:=</span>&nbsp;<span class="op" id="4011657">(</span><span class="ident" id="4011658">uint64</span><span class="op" id="4011664">(</span><span class="ident" id="4011665">right</span><span class="op" id="4011670">)</span>&nbsp;<span class="op" id="4011672">&lt;&lt;</span>&nbsp;<span class="num" id="4011675">32</span><span class="op" id="4011677">)</span>&nbsp;<span class="op" id="4011679">|</span>&nbsp;<span class="ident" id="4011681">uint64</span><span class="op" id="4011687">(</span><span class="ident" id="4011688">left</span><span class="op" id="4011692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011695">binary</span><span class="op" id="4011701">.</span><span class="ident" id="4011702">BigEndian</span><span class="op" id="4011711">.</span><span class="ident" id="4011712">PutUint64</span><span class="op" id="4011721">(</span><span class="ident" id="4011722">dst</span><span class="op" id="4011725">,</span>&nbsp;<span class="ident" id="4011727">permuteFinalBlock</span><span class="op" id="4011744">(</span><span class="ident" id="4011745">preOutput</span><span class="op" id="4011754">)</span><span class="op" id="4011755">)</span><br>
<span class="lineno"></span><span class="op" id="4011757">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4011760">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4011819">func</span>&nbsp;<span class="ident" id="4011824">encryptBlock</span><span class="op" id="4011836">(</span><span class="ident" id="4011837">subkeys</span>&nbsp;<span class="op" id="4011845">[</span><span class="op" id="4011846">]</span><span class="ident" id="4011847">uint64</span><span class="op" id="4011853">,</span>&nbsp;<span class="ident" id="4011855">dst</span><span class="op" id="4011858">,</span>&nbsp;<span class="ident" id="4011860">src</span>&nbsp;<span class="op" id="4011864">[</span><span class="op" id="4011865">]</span><span class="builtintype" id="4011866">byte</span><span class="op" id="4011870">)</span>&nbsp;<span class="op" id="4011872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011875">cryptBlock</span><span class="op" id="4011885">(</span><span class="ident" id="4011886">subkeys</span><span class="op" id="4011893">,</span>&nbsp;<span class="ident" id="4011895">dst</span><span class="op" id="4011898">,</span>&nbsp;<span class="ident" id="4011900">src</span><span class="op" id="4011903">,</span>&nbsp;<span class="builtintype" id="4011905">false</span><span class="op" id="4011910">)</span><br>
<span class="lineno"></span><span class="op" id="4011912">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4011915">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4011974">func</span>&nbsp;<span class="ident" id="4011979">decryptBlock</span><span class="op" id="4011991">(</span><span class="ident" id="4011992">subkeys</span>&nbsp;<span class="op" id="4012000">[</span><span class="op" id="4012001">]</span><span class="ident" id="4012002">uint64</span><span class="op" id="4012008">,</span>&nbsp;<span class="ident" id="4012010">dst</span><span class="op" id="4012013">,</span>&nbsp;<span class="ident" id="4012015">src</span>&nbsp;<span class="op" id="4012019">[</span><span class="op" id="4012020">]</span><span class="builtintype" id="4012021">byte</span><span class="op" id="4012025">)</span>&nbsp;<span class="op" id="4012027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012030">cryptBlock</span><span class="op" id="4012040">(</span><span class="ident" id="4012041">subkeys</span><span class="op" id="4012048">,</span>&nbsp;<span class="ident" id="4012050">dst</span><span class="op" id="4012053">,</span>&nbsp;<span class="ident" id="4012055">src</span><span class="op" id="4012058">,</span>&nbsp;<span class="builtintype" id="4012060">true</span><span class="op" id="4012064">)</span><br>
<span class="lineno"></span><span class="op" id="4012066">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4012069">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="4012093">func</span>&nbsp;<span class="ident" id="4012098">feistel</span><span class="op" id="4012105">(</span><span class="ident" id="4012106">right</span>&nbsp;<span class="builtintype" id="4012112">uint32</span><span class="op" id="4012118">,</span>&nbsp;<span class="ident" id="4012120">key</span>&nbsp;<span class="ident" id="4012124">uint64</span><span class="op" id="4012130">)</span>&nbsp;<span class="op" id="4012132">(</span><span class="ident" id="4012133">result</span>&nbsp;<span class="builtintype" id="4012140">uint32</span><span class="op" id="4012146">)</span>&nbsp;<span class="op" id="4012148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012151">sBoxLocations</span>&nbsp;<span class="op" id="4012165">:=</span>&nbsp;<span class="ident" id="4012168">key</span>&nbsp;<span class="op" id="4012172">^</span>&nbsp;<span class="ident" id="4012174">expandBlock</span><span class="op" id="4012185">(</span><span class="ident" id="4012186">right</span><span class="op" id="4012191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012194">var</span>&nbsp;<span class="ident" id="4012198">sBoxResult</span>&nbsp;<span class="builtintype" id="4012209">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012217">for</span>&nbsp;<span class="ident" id="4012221">i</span>&nbsp;<span class="op" id="4012223">:=</span>&nbsp;<span class="builtintype" id="4012226">uint8</span><span class="op" id="4012231">(</span><span class="num" id="4012232">0</span><span class="op" id="4012233">)</span><span class="op" id="4012234">;</span>&nbsp;<span class="ident" id="4012236">i</span>&nbsp;<span class="op" id="4012238">&lt;</span>&nbsp;<span class="num" id="4012240">8</span><span class="op" id="4012241">;</span>&nbsp;<span class="ident" id="4012243">i</span><span class="op" id="4012244">++</span>&nbsp;<span class="op" id="4012247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012251">sBoxLocation</span>&nbsp;<span class="op" id="4012264">:=</span>&nbsp;<span class="builtintype" id="4012267">uint8</span><span class="op" id="4012272">(</span><span class="ident" id="4012273">sBoxLocations</span><span class="op" id="4012286">&gt;&gt;</span><span class="num" id="4012288">42</span><span class="op" id="4012290">)</span>&nbsp;<span class="op" id="4012292">&amp;</span>&nbsp;<span class="num" id="4012294">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012301">sBoxLocations</span>&nbsp;<span class="op" id="4012315">&lt;&lt;=</span>&nbsp;<span class="num" id="4012319">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4012323">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4012362">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012394">row</span>&nbsp;<span class="op" id="4012398">:=</span>&nbsp;<span class="op" id="4012401">(</span><span class="ident" id="4012402">sBoxLocation</span>&nbsp;<span class="op" id="4012415">&amp;</span>&nbsp;<span class="num" id="4012417">0x1</span><span class="op" id="4012420">)</span>&nbsp;<span class="op" id="4012422">|</span>&nbsp;<span class="op" id="4012424">(</span><span class="op" id="4012425">(</span><span class="ident" id="4012426">sBoxLocation</span>&nbsp;<span class="op" id="4012439">&amp;</span>&nbsp;<span class="num" id="4012441">0x20</span><span class="op" id="4012445">)</span>&nbsp;<span class="op" id="4012447">&gt;&gt;</span>&nbsp;<span class="num" id="4012450">4</span><span class="op" id="4012451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012455">column</span>&nbsp;<span class="op" id="4012462">:=</span>&nbsp;<span class="op" id="4012465">(</span><span class="ident" id="4012466">sBoxLocation</span>&nbsp;<span class="op" id="4012479">&gt;&gt;</span>&nbsp;<span class="num" id="4012482">1</span><span class="op" id="4012483">)</span>&nbsp;<span class="op" id="4012485">&amp;</span>&nbsp;<span class="num" id="4012487">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012493">sBoxResult</span>&nbsp;<span class="op" id="4012504">^=</span>&nbsp;<span class="ident" id="4012507">feistelBox</span><span class="op" id="4012517">[</span><span class="ident" id="4012518">i</span><span class="op" id="4012519">]</span><span class="op" id="4012520">[</span><span class="num" id="4012521">16</span><span class="op" id="4012523">*</span><span class="ident" id="4012524">row</span><span class="op" id="4012527">+</span><span class="ident" id="4012528">column</span><span class="op" id="4012534">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4012537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012540">return</span>&nbsp;<span class="ident" id="4012547">sBoxResult</span><br>
<span class="lineno">55</span><span class="op" id="4012558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4012561">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="4012629">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="4012663">var</span>&nbsp;<span class="ident" id="4012667">feistelBox</span>&nbsp;<span class="op" id="4012678">[</span><span class="num" id="4012679">8</span><span class="op" id="4012680">]</span><span class="op" id="4012681">[</span><span class="num" id="4012682">64</span><span class="op" id="4012684">]</span><span class="builtintype" id="4012685">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4012693">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="4012755">func</span>&nbsp;<span class="ident" id="4012760">permuteBlock</span><span class="op" id="4012772">(</span><span class="ident" id="4012773">src</span>&nbsp;<span class="ident" id="4012777">uint64</span><span class="op" id="4012783">,</span>&nbsp;<span class="ident" id="4012785">permutation</span>&nbsp;<span class="op" id="4012797">[</span><span class="op" id="4012798">]</span><span class="builtintype" id="4012799">uint8</span><span class="op" id="4012804">)</span>&nbsp;<span class="op" id="4012806">(</span><span class="ident" id="4012807">block</span>&nbsp;<span class="ident" id="4012813">uint64</span><span class="op" id="4012819">)</span>&nbsp;<span class="op" id="4012821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012824">for</span>&nbsp;<span class="ident" id="4012828">position</span><span class="op" id="4012836">,</span>&nbsp;<span class="ident" id="4012838">n</span>&nbsp;<span class="op" id="4012840">:=</span>&nbsp;<span class="keyword" id="4012843">range</span>&nbsp;<span class="ident" id="4012849">permutation</span>&nbsp;<span class="op" id="4012861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012865">bit</span>&nbsp;<span class="op" id="4012869">:=</span>&nbsp;<span class="op" id="4012872">(</span><span class="ident" id="4012873">src</span>&nbsp;<span class="op" id="4012877">&gt;&gt;</span>&nbsp;<span class="ident" id="4012880">n</span><span class="op" id="4012881">)</span>&nbsp;<span class="op" id="4012883">&amp;</span>&nbsp;<span class="num" id="4012885">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012889">block</span>&nbsp;<span class="op" id="4012895">|=</span>&nbsp;<span class="ident" id="4012898">bit</span>&nbsp;<span class="op" id="4012902">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4012905">uint</span><span class="op" id="4012909">(</span><span class="op" id="4012910">(</span><span class="builtinfunc" id="4012911">len</span><span class="op" id="4012914">(</span><span class="ident" id="4012915">permutation</span><span class="op" id="4012926">)</span><span class="op" id="4012927">-</span><span class="num" id="4012928">1</span><span class="op" id="4012929">)</span><span class="op" id="4012930">-</span><span class="ident" id="4012931">position</span><span class="op" id="4012939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4012942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012945">return</span><br>
<span class="lineno"></span><span class="op" id="4012952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="4012955">func</span>&nbsp;<span class="ident" id="4012960">init</span><span class="op" id="4012964">(</span><span class="op" id="4012965">)</span>&nbsp;<span class="op" id="4012967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012970">for</span>&nbsp;<span class="ident" id="4012974">s</span>&nbsp;<span class="op" id="4012976">:=</span>&nbsp;<span class="keyword" id="4012979">range</span>&nbsp;<span class="ident" id="4012985">sBoxes</span>&nbsp;<span class="op" id="4012992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012996">for</span>&nbsp;<span class="ident" id="4013000">i</span>&nbsp;<span class="op" id="4013002">:=</span>&nbsp;<span class="num" id="4013005">0</span><span class="op" id="4013006">;</span>&nbsp;<span class="ident" id="4013008">i</span>&nbsp;<span class="op" id="4013010">&lt;</span>&nbsp;<span class="num" id="4013012">4</span><span class="op" id="4013013">;</span>&nbsp;<span class="ident" id="4013015">i</span><span class="op" id="4013016">++</span>&nbsp;<span class="op" id="4013019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013024">for</span>&nbsp;<span class="ident" id="4013028">j</span>&nbsp;<span class="op" id="4013030">:=</span>&nbsp;<span class="num" id="4013033">0</span><span class="op" id="4013034">;</span>&nbsp;<span class="ident" id="4013036">j</span>&nbsp;<span class="op" id="4013038">&lt;</span>&nbsp;<span class="num" id="4013040">16</span><span class="op" id="4013042">;</span>&nbsp;<span class="ident" id="4013044">j</span><span class="op" id="4013045">++</span>&nbsp;<span class="op" id="4013048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013054">f</span>&nbsp;<span class="op" id="4013056">:=</span>&nbsp;<span class="ident" id="4013059">uint64</span><span class="op" id="4013065">(</span><span class="ident" id="4013066">sBoxes</span><span class="op" id="4013072">[</span><span class="ident" id="4013073">s</span><span class="op" id="4013074">]</span><span class="op" id="4013075">[</span><span class="ident" id="4013076">i</span><span class="op" id="4013077">]</span><span class="op" id="4013078">[</span><span class="ident" id="4013079">j</span><span class="op" id="4013080">]</span><span class="op" id="4013081">)</span>&nbsp;<span class="op" id="4013083">&lt;&lt;</span>&nbsp;<span class="op" id="4013086">(</span><span class="num" id="4013087">4</span>&nbsp;<span class="op" id="4013089">*</span>&nbsp;<span class="op" id="4013091">(</span><span class="num" id="4013092">7</span>&nbsp;<span class="op" id="4013094">-</span>&nbsp;<span class="builtintype" id="4013096">uint</span><span class="op" id="4013100">(</span><span class="ident" id="4013101">s</span><span class="op" id="4013102">)</span><span class="op" id="4013103">)</span><span class="op" id="4013104">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013110">f</span>&nbsp;<span class="op" id="4013112">=</span>&nbsp;<span class="ident" id="4013114">permuteBlock</span><span class="op" id="4013126">(</span><span class="ident" id="4013127">uint64</span><span class="op" id="4013133">(</span><span class="ident" id="4013134">f</span><span class="op" id="4013135">)</span><span class="op" id="4013136">,</span>&nbsp;<span class="ident" id="4013138">permutationFunction</span><span class="op" id="4013157">[</span><span class="op" id="4013158">:</span><span class="op" id="4013159">]</span><span class="op" id="4013160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013166">feistelBox</span><span class="op" id="4013176">[</span><span class="ident" id="4013177">s</span><span class="op" id="4013178">]</span><span class="op" id="4013179">[</span><span class="num" id="4013180">16</span><span class="op" id="4013182">*</span><span class="ident" id="4013183">i</span><span class="op" id="4013184">+</span><span class="ident" id="4013185">j</span><span class="op" id="4013186">]</span>&nbsp;<span class="op" id="4013188">=</span>&nbsp;<span class="builtintype" id="4013190">uint32</span><span class="op" id="4013196">(</span><span class="ident" id="4013197">f</span><span class="op" id="4013198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013210">}</span><br>
<span class="lineno">80</span><span class="op" id="4013212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4013215">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="4013265">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="4013306">func</span>&nbsp;<span class="ident" id="4013311">expandBlock</span><span class="op" id="4013322">(</span><span class="ident" id="4013323">src</span>&nbsp;<span class="builtintype" id="4013327">uint32</span><span class="op" id="4013333">)</span>&nbsp;<span class="op" id="4013335">(</span><span class="ident" id="4013336">block</span>&nbsp;<span class="ident" id="4013342">uint64</span><span class="op" id="4013348">)</span>&nbsp;<span class="op" id="4013350">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013353">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013397">src</span>&nbsp;<span class="op" id="4013401">=</span>&nbsp;<span class="op" id="4013403">(</span><span class="ident" id="4013404">src</span>&nbsp;<span class="op" id="4013408">&lt;&lt;</span>&nbsp;<span class="num" id="4013411">5</span><span class="op" id="4013412">)</span>&nbsp;<span class="op" id="4013414">|</span>&nbsp;<span class="op" id="4013416">(</span><span class="ident" id="4013417">src</span>&nbsp;<span class="op" id="4013421">&gt;&gt;</span>&nbsp;<span class="num" id="4013424">27</span><span class="op" id="4013426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013429">for</span>&nbsp;<span class="ident" id="4013433">i</span>&nbsp;<span class="op" id="4013435">:=</span>&nbsp;<span class="num" id="4013438">0</span><span class="op" id="4013439">;</span>&nbsp;<span class="ident" id="4013441">i</span>&nbsp;<span class="op" id="4013443">&lt;</span>&nbsp;<span class="num" id="4013445">8</span><span class="op" id="4013446">;</span>&nbsp;<span class="ident" id="4013448">i</span><span class="op" id="4013449">++</span>&nbsp;<span class="op" id="4013452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013456">block</span>&nbsp;<span class="op" id="4013462">&lt;&lt;=</span>&nbsp;<span class="num" id="4013466">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013470">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013504">block</span>&nbsp;<span class="op" id="4013510">|=</span>&nbsp;<span class="ident" id="4013513">uint64</span><span class="op" id="4013519">(</span><span class="ident" id="4013520">src</span><span class="op" id="4013523">)</span>&nbsp;<span class="op" id="4013525">&amp;</span>&nbsp;<span class="op" id="4013527">(</span><span class="num" id="4013528">1</span><span class="op" id="4013529">&lt;&lt;</span><span class="num" id="4013531">6</span>&nbsp;<span class="op" id="4013533">-</span>&nbsp;<span class="num" id="4013535">1</span><span class="op" id="4013536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013540">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013564">src</span>&nbsp;<span class="op" id="4013568">=</span>&nbsp;<span class="op" id="4013570">(</span><span class="ident" id="4013571">src</span>&nbsp;<span class="op" id="4013575">&lt;&lt;</span>&nbsp;<span class="num" id="4013578">4</span><span class="op" id="4013579">)</span>&nbsp;<span class="op" id="4013581">|</span>&nbsp;<span class="op" id="4013583">(</span><span class="ident" id="4013584">src</span>&nbsp;<span class="op" id="4013588">&gt;&gt;</span>&nbsp;<span class="num" id="4013591">28</span><span class="op" id="4013593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013599">return</span><br>
<span class="lineno">95</span><span class="op" id="4013606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4013609">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4013673">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4013699">func</span>&nbsp;<span class="ident" id="4013704">permuteInitialBlock</span><span class="op" id="4013723">(</span><span class="ident" id="4013724">block</span>&nbsp;<span class="ident" id="4013730">uint64</span><span class="op" id="4013736">)</span>&nbsp;<span class="ident" id="4013738">uint64</span>&nbsp;<span class="op" id="4013745">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013748">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013794">b1</span>&nbsp;<span class="op" id="4013797">:=</span>&nbsp;<span class="ident" id="4013800">block</span>&nbsp;<span class="op" id="4013806">&gt;&gt;</span>&nbsp;<span class="num" id="4013809">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013813">b2</span>&nbsp;<span class="op" id="4013816">:=</span>&nbsp;<span class="ident" id="4013819">block</span>&nbsp;<span class="op" id="4013825">&lt;&lt;</span>&nbsp;<span class="num" id="4013828">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013832">block</span>&nbsp;<span class="op" id="4013838">^=</span>&nbsp;<span class="ident" id="4013841">b1</span>&nbsp;<span class="op" id="4013844">^</span>&nbsp;<span class="ident" id="4013846">b2</span>&nbsp;<span class="op" id="4013849">^</span>&nbsp;<span class="ident" id="4013851">b1</span><span class="op" id="4013853">&lt;&lt;</span><span class="num" id="4013855">48</span>&nbsp;<span class="op" id="4013858">^</span>&nbsp;<span class="ident" id="4013860">b2</span><span class="op" id="4013862">&gt;&gt;</span><span class="num" id="4013864">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013869">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013905">b1</span>&nbsp;<span class="op" id="4013908">=</span>&nbsp;<span class="ident" id="4013910">block</span>&nbsp;<span class="op" id="4013916">&gt;&gt;</span>&nbsp;<span class="num" id="4013919">32</span>&nbsp;<span class="op" id="4013922">&amp;</span>&nbsp;<span class="num" id="4013924">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013934">b2</span>&nbsp;<span class="op" id="4013937">=</span>&nbsp;<span class="op" id="4013939">(</span><span class="ident" id="4013940">block</span>&nbsp;<span class="op" id="4013946">&amp;</span>&nbsp;<span class="num" id="4013948">0xff00ff00</span><span class="op" id="4013958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013961">block</span>&nbsp;<span class="op" id="4013967">^=</span>&nbsp;<span class="ident" id="4013970">b1</span><span class="op" id="4013972">&lt;&lt;</span><span class="num" id="4013974">32</span>&nbsp;<span class="op" id="4013977">^</span>&nbsp;<span class="ident" id="4013979">b2</span>&nbsp;<span class="op" id="4013982">^</span>&nbsp;<span class="ident" id="4013984">b1</span><span class="op" id="4013986">&lt;&lt;</span><span class="num" id="4013988">8</span>&nbsp;<span class="op" id="4013990">^</span>&nbsp;<span class="ident" id="4013992">b2</span><span class="op" id="4013994">&lt;&lt;</span><span class="num" id="4013996">24</span>&nbsp;<span class="comment" id="4013999">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014030">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014089">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014117">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014145">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014173">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014201">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014229">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014257">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014285">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014314">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014357">b1</span>&nbsp;<span class="op" id="4014360">=</span>&nbsp;<span class="ident" id="4014362">block</span>&nbsp;<span class="op" id="4014368">&amp;</span>&nbsp;<span class="num" id="4014370">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014390">b2</span>&nbsp;<span class="op" id="4014393">=</span>&nbsp;<span class="ident" id="4014395">block</span>&nbsp;<span class="op" id="4014401">&amp;</span>&nbsp;<span class="num" id="4014403">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014423">block</span>&nbsp;<span class="op" id="4014429">^=</span>&nbsp;<span class="ident" id="4014432">b1</span>&nbsp;<span class="op" id="4014435">^</span>&nbsp;<span class="ident" id="4014437">b2</span>&nbsp;<span class="op" id="4014440">^</span>&nbsp;<span class="ident" id="4014442">b1</span><span class="op" id="4014444">&gt;&gt;</span><span class="num" id="4014446">12</span>&nbsp;<span class="op" id="4014449">^</span>&nbsp;<span class="ident" id="4014451">b2</span><span class="op" id="4014453">&lt;&lt;</span><span class="num" id="4014455">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014460">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014490">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014494">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014519">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014523">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014539">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014555">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014571">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014597">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014635">b1</span>&nbsp;<span class="op" id="4014638">=</span>&nbsp;<span class="ident" id="4014640">block</span>&nbsp;<span class="op" id="4014646">&amp;</span>&nbsp;<span class="num" id="4014648">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014668">b2</span>&nbsp;<span class="op" id="4014671">=</span>&nbsp;<span class="ident" id="4014673">block</span>&nbsp;<span class="op" id="4014679">&amp;</span>&nbsp;<span class="num" id="4014681">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014701">block</span>&nbsp;<span class="op" id="4014707">^=</span>&nbsp;<span class="ident" id="4014710">b1</span>&nbsp;<span class="op" id="4014713">^</span>&nbsp;<span class="ident" id="4014715">b2</span>&nbsp;<span class="op" id="4014718">^</span>&nbsp;<span class="ident" id="4014720">b1</span><span class="op" id="4014722">&gt;&gt;</span><span class="num" id="4014724">6</span>&nbsp;<span class="op" id="4014726">^</span>&nbsp;<span class="ident" id="4014728">b2</span><span class="op" id="4014730">&lt;&lt;</span><span class="num" id="4014732">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014736">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014766">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014776">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014786">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014796">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014806">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014816">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014826">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014836">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014865">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014903">b1</span>&nbsp;<span class="op" id="4014906">=</span>&nbsp;<span class="ident" id="4014908">block</span>&nbsp;<span class="op" id="4014914">&amp;</span>&nbsp;<span class="num" id="4014916">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014936">block</span>&nbsp;<span class="op" id="4014942">^=</span>&nbsp;<span class="ident" id="4014945">b1</span>&nbsp;<span class="op" id="4014948">^</span>&nbsp;<span class="ident" id="4014950">b1</span><span class="op" id="4014952">&gt;&gt;</span><span class="num" id="4014954">33</span>&nbsp;<span class="op" id="4014957">^</span>&nbsp;<span class="ident" id="4014959">b1</span><span class="op" id="4014961">&lt;&lt;</span><span class="num" id="4014963">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014968">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014998">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015025">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015052">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015079">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015106">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015133">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015160">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015187">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4015214">return</span>&nbsp;<span class="ident" id="4015221">block</span><br>
<span class="lineno"></span><span class="op" id="4015227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4015230">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4015294">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4015318">func</span>&nbsp;<span class="ident" id="4015323">permuteFinalBlock</span><span class="op" id="4015340">(</span><span class="ident" id="4015341">block</span>&nbsp;<span class="ident" id="4015347">uint64</span><span class="op" id="4015353">)</span>&nbsp;<span class="ident" id="4015355">uint64</span>&nbsp;<span class="op" id="4015362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015365">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015423">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015449">b1</span>&nbsp;<span class="op" id="4015452">:=</span>&nbsp;<span class="ident" id="4015455">block</span>&nbsp;<span class="op" id="4015461">&amp;</span>&nbsp;<span class="num" id="4015463">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015483">block</span>&nbsp;<span class="op" id="4015489">^=</span>&nbsp;<span class="ident" id="4015492">b1</span>&nbsp;<span class="op" id="4015495">^</span>&nbsp;<span class="ident" id="4015497">b1</span><span class="op" id="4015499">&gt;&gt;</span><span class="num" id="4015501">33</span>&nbsp;<span class="op" id="4015504">^</span>&nbsp;<span class="ident" id="4015506">b1</span><span class="op" id="4015508">&lt;&lt;</span><span class="num" id="4015510">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015515">b1</span>&nbsp;<span class="op" id="4015518">=</span>&nbsp;<span class="ident" id="4015520">block</span>&nbsp;<span class="op" id="4015526">&amp;</span>&nbsp;<span class="num" id="4015528">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015548">b2</span>&nbsp;<span class="op" id="4015551">:=</span>&nbsp;<span class="ident" id="4015554">block</span>&nbsp;<span class="op" id="4015560">&amp;</span>&nbsp;<span class="num" id="4015562">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015582">block</span>&nbsp;<span class="op" id="4015588">^=</span>&nbsp;<span class="ident" id="4015591">b1</span>&nbsp;<span class="op" id="4015594">^</span>&nbsp;<span class="ident" id="4015596">b2</span>&nbsp;<span class="op" id="4015599">^</span>&nbsp;<span class="ident" id="4015601">b1</span><span class="op" id="4015603">&gt;&gt;</span><span class="num" id="4015605">6</span>&nbsp;<span class="op" id="4015607">^</span>&nbsp;<span class="ident" id="4015609">b2</span><span class="op" id="4015611">&lt;&lt;</span><span class="num" id="4015613">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015617">b1</span>&nbsp;<span class="op" id="4015620">=</span>&nbsp;<span class="ident" id="4015622">block</span>&nbsp;<span class="op" id="4015628">&amp;</span>&nbsp;<span class="num" id="4015630">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015650">b2</span>&nbsp;<span class="op" id="4015653">=</span>&nbsp;<span class="ident" id="4015655">block</span>&nbsp;<span class="op" id="4015661">&amp;</span>&nbsp;<span class="num" id="4015663">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015683">block</span>&nbsp;<span class="op" id="4015689">^=</span>&nbsp;<span class="ident" id="4015692">b1</span>&nbsp;<span class="op" id="4015695">^</span>&nbsp;<span class="ident" id="4015697">b2</span>&nbsp;<span class="op" id="4015700">^</span>&nbsp;<span class="ident" id="4015702">b1</span><span class="op" id="4015704">&gt;&gt;</span><span class="num" id="4015706">12</span>&nbsp;<span class="op" id="4015709">^</span>&nbsp;<span class="ident" id="4015711">b2</span><span class="op" id="4015713">&lt;&lt;</span><span class="num" id="4015715">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015720">b1</span>&nbsp;<span class="op" id="4015723">=</span>&nbsp;<span class="ident" id="4015725">block</span>&nbsp;<span class="op" id="4015731">&gt;&gt;</span>&nbsp;<span class="num" id="4015734">32</span>&nbsp;<span class="op" id="4015737">&amp;</span>&nbsp;<span class="num" id="4015739">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015749">b2</span>&nbsp;<span class="op" id="4015752">=</span>&nbsp;<span class="op" id="4015754">(</span><span class="ident" id="4015755">block</span>&nbsp;<span class="op" id="4015761">&amp;</span>&nbsp;<span class="num" id="4015763">0xff00ff00</span><span class="op" id="4015773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015776">block</span>&nbsp;<span class="op" id="4015782">^=</span>&nbsp;<span class="ident" id="4015785">b1</span><span class="op" id="4015787">&lt;&lt;</span><span class="num" id="4015789">32</span>&nbsp;<span class="op" id="4015792">^</span>&nbsp;<span class="ident" id="4015794">b2</span>&nbsp;<span class="op" id="4015797">^</span>&nbsp;<span class="ident" id="4015799">b1</span><span class="op" id="4015801">&lt;&lt;</span><span class="num" id="4015803">8</span>&nbsp;<span class="op" id="4015805">^</span>&nbsp;<span class="ident" id="4015807">b2</span><span class="op" id="4015809">&lt;&lt;</span><span class="num" id="4015811">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015816">b1</span>&nbsp;<span class="op" id="4015819">=</span>&nbsp;<span class="ident" id="4015821">block</span>&nbsp;<span class="op" id="4015827">&gt;&gt;</span>&nbsp;<span class="num" id="4015830">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015834">b2</span>&nbsp;<span class="op" id="4015837">=</span>&nbsp;<span class="ident" id="4015839">block</span>&nbsp;<span class="op" id="4015845">&lt;&lt;</span>&nbsp;<span class="num" id="4015848">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015852">block</span>&nbsp;<span class="op" id="4015858">^=</span>&nbsp;<span class="ident" id="4015861">b1</span>&nbsp;<span class="op" id="4015864">^</span>&nbsp;<span class="ident" id="4015866">b2</span>&nbsp;<span class="op" id="4015869">^</span>&nbsp;<span class="ident" id="4015871">b1</span><span class="op" id="4015873">&lt;&lt;</span><span class="num" id="4015875">48</span>&nbsp;<span class="op" id="4015878">^</span>&nbsp;<span class="ident" id="4015880">b2</span><span class="op" id="4015882">&gt;&gt;</span><span class="num" id="4015884">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4015888">return</span>&nbsp;<span class="ident" id="4015895">block</span><br>
<span class="lineno"></span><span class="op" id="4015901">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4015904">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="4015950">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="4015978">func</span>&nbsp;<span class="ident" id="4015983">ksRotate</span><span class="op" id="4015991">(</span><span class="ident" id="4015992">in</span>&nbsp;<span class="builtintype" id="4015995">uint32</span><span class="op" id="4016001">)</span>&nbsp;<span class="op" id="4016003">(</span><span class="ident" id="4016004">out</span>&nbsp;<span class="op" id="4016008">[</span><span class="op" id="4016009">]</span><span class="builtintype" id="4016010">uint32</span><span class="op" id="4016016">)</span>&nbsp;<span class="op" id="4016018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016021">out</span>&nbsp;<span class="op" id="4016025">=</span>&nbsp;<span class="builtinfunc" id="4016027">make</span><span class="op" id="4016031">(</span><span class="op" id="4016032">[</span><span class="op" id="4016033">]</span><span class="builtintype" id="4016034">uint32</span><span class="op" id="4016040">,</span>&nbsp;<span class="num" id="4016042">16</span><span class="op" id="4016044">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016047">last</span>&nbsp;<span class="op" id="4016052">:=</span>&nbsp;<span class="ident" id="4016055">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016059">for</span>&nbsp;<span class="ident" id="4016063">i</span>&nbsp;<span class="op" id="4016065">:=</span>&nbsp;<span class="num" id="4016068">0</span><span class="op" id="4016069">;</span>&nbsp;<span class="ident" id="4016071">i</span>&nbsp;<span class="op" id="4016073">&lt;</span>&nbsp;<span class="num" id="4016075">16</span><span class="op" id="4016077">;</span>&nbsp;<span class="ident" id="4016079">i</span><span class="op" id="4016080">++</span>&nbsp;<span class="op" id="4016083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016087">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016119">left</span>&nbsp;<span class="op" id="4016124">:=</span>&nbsp;<span class="op" id="4016127">(</span><span class="ident" id="4016128">last</span>&nbsp;<span class="op" id="4016133">&lt;&lt;</span>&nbsp;<span class="op" id="4016136">(</span><span class="num" id="4016137">4</span>&nbsp;<span class="op" id="4016139">+</span>&nbsp;<span class="ident" id="4016141">ksRotations</span><span class="op" id="4016152">[</span><span class="ident" id="4016153">i</span><span class="op" id="4016154">]</span><span class="op" id="4016155">)</span><span class="op" id="4016156">)</span>&nbsp;<span class="op" id="4016158">&gt;&gt;</span>&nbsp;<span class="num" id="4016161">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016165">right</span>&nbsp;<span class="op" id="4016171">:=</span>&nbsp;<span class="op" id="4016174">(</span><span class="ident" id="4016175">last</span>&nbsp;<span class="op" id="4016180">&lt;&lt;</span>&nbsp;<span class="num" id="4016183">4</span><span class="op" id="4016184">)</span>&nbsp;<span class="op" id="4016186">&gt;&gt;</span>&nbsp;<span class="op" id="4016189">(</span><span class="num" id="4016190">32</span>&nbsp;<span class="op" id="4016193">-</span>&nbsp;<span class="ident" id="4016195">ksRotations</span><span class="op" id="4016206">[</span><span class="ident" id="4016207">i</span><span class="op" id="4016208">]</span><span class="op" id="4016209">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016213">out</span><span class="op" id="4016216">[</span><span class="ident" id="4016217">i</span><span class="op" id="4016218">]</span>&nbsp;<span class="op" id="4016220">=</span>&nbsp;<span class="ident" id="4016222">left</span>&nbsp;<span class="op" id="4016227">|</span>&nbsp;<span class="ident" id="4016229">right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016237">last</span>&nbsp;<span class="op" id="4016242">=</span>&nbsp;<span class="ident" id="4016244">out</span><span class="op" id="4016247">[</span><span class="ident" id="4016248">i</span><span class="op" id="4016249">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4016252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016255">return</span><br>
<span class="lineno"></span><span class="op" id="4016262">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="4016265">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="4016316">func</span>&nbsp;<span class="op" id="4016321">(</span><span class="ident" id="4016322">c</span>&nbsp;<span class="op" id="4016324">*</span><span class="ident" id="4016325">desCipher</span><span class="op" id="4016334">)</span>&nbsp;<span class="ident" id="4016336">generateSubkeys</span><span class="op" id="4016351">(</span><span class="ident" id="4016352">keyBytes</span>&nbsp;<span class="op" id="4016361">[</span><span class="op" id="4016362">]</span><span class="builtintype" id="4016363">byte</span><span class="op" id="4016367">)</span>&nbsp;<span class="op" id="4016369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016372">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016405">key</span>&nbsp;<span class="op" id="4016409">:=</span>&nbsp;<span class="ident" id="4016412">binary</span><span class="op" id="4016418">.</span><span class="ident" id="4016419">BigEndian</span><span class="op" id="4016428">.</span><span class="ident" id="4016429">Uint64</span><span class="op" id="4016435">(</span><span class="ident" id="4016436">keyBytes</span><span class="op" id="4016444">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016447">permutedKey</span>&nbsp;<span class="op" id="4016459">:=</span>&nbsp;<span class="ident" id="4016462">permuteBlock</span><span class="op" id="4016474">(</span><span class="ident" id="4016475">key</span><span class="op" id="4016478">,</span>&nbsp;<span class="ident" id="4016480">permutedChoice1</span><span class="op" id="4016495">[</span><span class="op" id="4016496">:</span><span class="op" id="4016497">]</span><span class="op" id="4016498">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016502">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016571">leftRotations</span>&nbsp;<span class="op" id="4016585">:=</span>&nbsp;<span class="ident" id="4016588">ksRotate</span><span class="op" id="4016596">(</span><span class="builtintype" id="4016597">uint32</span><span class="op" id="4016603">(</span><span class="ident" id="4016604">permutedKey</span>&nbsp;<span class="op" id="4016616">&gt;&gt;</span>&nbsp;<span class="num" id="4016619">28</span><span class="op" id="4016621">)</span><span class="op" id="4016622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016625">rightRotations</span>&nbsp;<span class="op" id="4016640">:=</span>&nbsp;<span class="ident" id="4016643">ksRotate</span><span class="op" id="4016651">(</span><span class="builtintype" id="4016652">uint32</span><span class="op" id="4016658">(</span><span class="ident" id="4016659">permutedKey</span><span class="op" id="4016670">&lt;&lt;</span><span class="num" id="4016672">4</span><span class="op" id="4016673">)</span>&nbsp;<span class="op" id="4016675">&gt;&gt;</span>&nbsp;<span class="num" id="4016678">4</span><span class="op" id="4016679">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016683">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016704">for</span>&nbsp;<span class="ident" id="4016708">i</span>&nbsp;<span class="op" id="4016710">:=</span>&nbsp;<span class="num" id="4016713">0</span><span class="op" id="4016714">;</span>&nbsp;<span class="ident" id="4016716">i</span>&nbsp;<span class="op" id="4016718">&lt;</span>&nbsp;<span class="num" id="4016720">16</span><span class="op" id="4016722">;</span>&nbsp;<span class="ident" id="4016724">i</span><span class="op" id="4016725">++</span>&nbsp;<span class="op" id="4016728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016732">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016780">pc2Input</span>&nbsp;<span class="op" id="4016789">:=</span>&nbsp;<span class="ident" id="4016792">uint64</span><span class="op" id="4016798">(</span><span class="ident" id="4016799">leftRotations</span><span class="op" id="4016812">[</span><span class="ident" id="4016813">i</span><span class="op" id="4016814">]</span><span class="op" id="4016815">)</span><span class="op" id="4016816">&lt;&lt;</span><span class="num" id="4016818">28</span>&nbsp;<span class="op" id="4016821">|</span>&nbsp;<span class="ident" id="4016823">uint64</span><span class="op" id="4016829">(</span><span class="ident" id="4016830">rightRotations</span><span class="op" id="4016844">[</span><span class="ident" id="4016845">i</span><span class="op" id="4016846">]</span><span class="op" id="4016847">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016851">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016894">c</span><span class="op" id="4016895">.</span><span class="ident" id="4016896">subkeys</span><span class="op" id="4016903">[</span><span class="ident" id="4016904">i</span><span class="op" id="4016905">]</span>&nbsp;<span class="op" id="4016907">=</span>&nbsp;<span class="ident" id="4016909">permuteBlock</span><span class="op" id="4016921">(</span><span class="ident" id="4016922">pc2Input</span><span class="op" id="4016930">,</span>&nbsp;<span class="ident" id="4016932">permutedChoice2</span><span class="op" id="4016947">[</span><span class="op" id="4016948">:</span><span class="op" id="4016949">]</span><span class="op" id="4016950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4016953">}</span><br>
<span class="lineno"></span><span class="op" id="4016955">}</span>
</div>
</body>
</html>
