<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1329532">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1329587">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1329641">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1329692">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="1329749">package</span>&nbsp;<span class="ident" id="1329757">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1329763">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="1329816">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="1329887">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="1329958">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="1330026">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="1330052">//</span><br>
<span class="lineno"></span><span class="keyword" id="1330055">type</span>&nbsp;<span class="ident" id="1330060">Ring</span>&nbsp;<span class="keyword" id="1330065">struct</span>&nbsp;<span class="op" id="1330072">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1330075">next</span><span class="op" id="1330079">,</span>&nbsp;<span class="ident" id="1330081">prev</span>&nbsp;<span class="op" id="1330086">*</span><span class="ident" id="1330087">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1330093">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1330104">interface</span><span class="op" id="1330113">{</span><span class="op" id="1330114">}</span>&nbsp;<span class="comment" id="1330116">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="1330164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1330167">func</span>&nbsp;<span class="op" id="1330172">(</span><span class="ident" id="1330173">r</span>&nbsp;<span class="op" id="1330175">*</span><span class="ident" id="1330176">Ring</span><span class="op" id="1330180">)</span>&nbsp;<span class="ident" id="1330182">init</span><span class="op" id="1330186">(</span><span class="op" id="1330187">)</span>&nbsp;<span class="op" id="1330189">*</span><span class="ident" id="1330190">Ring</span>&nbsp;<span class="op" id="1330195">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1330198">r</span><span class="op" id="1330199">.</span><span class="ident" id="1330200">next</span>&nbsp;<span class="op" id="1330205">=</span>&nbsp;<span class="ident" id="1330207">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1330210">r</span><span class="op" id="1330211">.</span><span class="ident" id="1330212">prev</span>&nbsp;<span class="op" id="1330217">=</span>&nbsp;<span class="ident" id="1330219">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330222">return</span>&nbsp;<span class="ident" id="1330229">r</span><br>
<span class="lineno"></span><span class="op" id="1330231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="1330234">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="1330294">func</span>&nbsp;<span class="op" id="1330299">(</span><span class="ident" id="1330300">r</span>&nbsp;<span class="op" id="1330302">*</span><span class="ident" id="1330303">Ring</span><span class="op" id="1330307">)</span>&nbsp;<span class="ident" id="1330309">Next</span><span class="op" id="1330313">(</span><span class="op" id="1330314">)</span>&nbsp;<span class="op" id="1330316">*</span><span class="ident" id="1330317">Ring</span>&nbsp;<span class="op" id="1330322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330325">if</span>&nbsp;<span class="ident" id="1330328">r</span><span class="op" id="1330329">.</span><span class="ident" id="1330330">next</span>&nbsp;<span class="op" id="1330335">==</span>&nbsp;<span class="ident" id="1330338">nil</span>&nbsp;<span class="op" id="1330342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330346">return</span>&nbsp;<span class="ident" id="1330353">r</span><span class="op" id="1330354">.</span><span class="ident" id="1330355">init</span><span class="op" id="1330359">(</span><span class="op" id="1330360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1330363">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330366">return</span>&nbsp;<span class="ident" id="1330373">r</span><span class="op" id="1330374">.</span><span class="ident" id="1330375">next</span><br>
<span class="lineno"></span><span class="op" id="1330380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1330383">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="1330447">func</span>&nbsp;<span class="op" id="1330452">(</span><span class="ident" id="1330453">r</span>&nbsp;<span class="op" id="1330455">*</span><span class="ident" id="1330456">Ring</span><span class="op" id="1330460">)</span>&nbsp;<span class="ident" id="1330462">Prev</span><span class="op" id="1330466">(</span><span class="op" id="1330467">)</span>&nbsp;<span class="op" id="1330469">*</span><span class="ident" id="1330470">Ring</span>&nbsp;<span class="op" id="1330475">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330478">if</span>&nbsp;<span class="ident" id="1330481">r</span><span class="op" id="1330482">.</span><span class="ident" id="1330483">next</span>&nbsp;<span class="op" id="1330488">==</span>&nbsp;<span class="ident" id="1330491">nil</span>&nbsp;<span class="op" id="1330495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330499">return</span>&nbsp;<span class="ident" id="1330506">r</span><span class="op" id="1330507">.</span><span class="ident" id="1330508">init</span><span class="op" id="1330512">(</span><span class="op" id="1330513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1330516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330519">return</span>&nbsp;<span class="ident" id="1330526">r</span><span class="op" id="1330527">.</span><span class="ident" id="1330528">prev</span><br>
<span class="lineno"></span><span class="op" id="1330533">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1330536">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="1330608">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="1330675">//</span><br>
<span class="lineno"></span><span class="keyword" id="1330678">func</span>&nbsp;<span class="op" id="1330683">(</span><span class="ident" id="1330684">r</span>&nbsp;<span class="op" id="1330686">*</span><span class="ident" id="1330687">Ring</span><span class="op" id="1330691">)</span>&nbsp;<span class="ident" id="1330693">Move</span><span class="op" id="1330697">(</span><span class="ident" id="1330698">n</span>&nbsp;<span class="builtintype" id="1330700">int</span><span class="op" id="1330703">)</span>&nbsp;<span class="op" id="1330705">*</span><span class="ident" id="1330706">Ring</span>&nbsp;<span class="op" id="1330711">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330714">if</span>&nbsp;<span class="ident" id="1330717">r</span><span class="op" id="1330718">.</span><span class="ident" id="1330719">next</span>&nbsp;<span class="op" id="1330724">==</span>&nbsp;<span class="ident" id="1330727">nil</span>&nbsp;<span class="op" id="1330731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330735">return</span>&nbsp;<span class="ident" id="1330742">r</span><span class="op" id="1330743">.</span><span class="ident" id="1330744">init</span><span class="op" id="1330748">(</span><span class="op" id="1330749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1330752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330755">switch</span>&nbsp;<span class="op" id="1330762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330765">case</span>&nbsp;<span class="ident" id="1330770">n</span>&nbsp;<span class="op" id="1330772">&lt;</span>&nbsp;<span class="num" id="1330774">0</span><span class="op" id="1330775">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330779">for</span>&nbsp;<span class="op" id="1330783">;</span>&nbsp;<span class="ident" id="1330785">n</span>&nbsp;<span class="op" id="1330787">&lt;</span>&nbsp;<span class="num" id="1330789">0</span><span class="op" id="1330790">;</span>&nbsp;<span class="ident" id="1330792">n</span><span class="op" id="1330793">++</span>&nbsp;<span class="op" id="1330796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1330801">r</span>&nbsp;<span class="op" id="1330803">=</span>&nbsp;<span class="ident" id="1330805">r</span><span class="op" id="1330806">.</span><span class="ident" id="1330807">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1330814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330817">case</span>&nbsp;<span class="ident" id="1330822">n</span>&nbsp;<span class="op" id="1330824">&gt;</span>&nbsp;<span class="num" id="1330826">0</span><span class="op" id="1330827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330831">for</span>&nbsp;<span class="op" id="1330835">;</span>&nbsp;<span class="ident" id="1330837">n</span>&nbsp;<span class="op" id="1330839">&gt;</span>&nbsp;<span class="num" id="1330841">0</span><span class="op" id="1330842">;</span>&nbsp;<span class="ident" id="1330844">n</span><span class="op" id="1330845">--</span>&nbsp;<span class="op" id="1330848">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1330853">r</span>&nbsp;<span class="op" id="1330855">=</span>&nbsp;<span class="ident" id="1330857">r</span><span class="op" id="1330858">.</span><span class="ident" id="1330859">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1330866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1330869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330872">return</span>&nbsp;<span class="ident" id="1330879">r</span><br>
<span class="lineno"></span><span class="op" id="1330881">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1330884">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="1330921">func</span>&nbsp;<span class="ident" id="1330926">New</span><span class="op" id="1330929">(</span><span class="ident" id="1330930">n</span>&nbsp;<span class="builtintype" id="1330932">int</span><span class="op" id="1330935">)</span>&nbsp;<span class="op" id="1330937">*</span><span class="ident" id="1330938">Ring</span>&nbsp;<span class="op" id="1330943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330946">if</span>&nbsp;<span class="ident" id="1330949">n</span>&nbsp;<span class="op" id="1330951">&lt;=</span>&nbsp;<span class="num" id="1330954">0</span>&nbsp;<span class="op" id="1330956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330960">return</span>&nbsp;<span class="ident" id="1330967">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1330972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1330975">r</span>&nbsp;<span class="op" id="1330977">:=</span>&nbsp;<span class="builtinfunc" id="1330980">new</span><span class="op" id="1330983">(</span><span class="ident" id="1330984">Ring</span><span class="op" id="1330988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1330991">p</span>&nbsp;<span class="op" id="1330993">:=</span>&nbsp;<span class="ident" id="1330996">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1330999">for</span>&nbsp;<span class="ident" id="1331003">i</span>&nbsp;<span class="op" id="1331005">:=</span>&nbsp;<span class="num" id="1331008">1</span><span class="op" id="1331009">;</span>&nbsp;<span class="ident" id="1331011">i</span>&nbsp;<span class="op" id="1331013">&lt;</span>&nbsp;<span class="ident" id="1331015">n</span><span class="op" id="1331016">;</span>&nbsp;<span class="ident" id="1331018">i</span><span class="op" id="1331019">++</span>&nbsp;<span class="op" id="1331022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331026">p</span><span class="op" id="1331027">.</span><span class="ident" id="1331028">next</span>&nbsp;<span class="op" id="1331033">=</span>&nbsp;<span class="op" id="1331035">&amp;</span><span class="ident" id="1331036">Ring</span><span class="op" id="1331040">{</span><span class="ident" id="1331041">prev</span><span class="op" id="1331045">:</span>&nbsp;<span class="ident" id="1331047">p</span><span class="op" id="1331048">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331052">p</span>&nbsp;<span class="op" id="1331054">=</span>&nbsp;<span class="ident" id="1331056">p</span><span class="op" id="1331057">.</span><span class="ident" id="1331058">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1331064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331067">p</span><span class="op" id="1331068">.</span><span class="ident" id="1331069">next</span>&nbsp;<span class="op" id="1331074">=</span>&nbsp;<span class="ident" id="1331076">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331079">r</span><span class="op" id="1331080">.</span><span class="ident" id="1331081">prev</span>&nbsp;<span class="op" id="1331086">=</span>&nbsp;<span class="ident" id="1331088">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1331091">return</span>&nbsp;<span class="ident" id="1331098">r</span><br>
<span class="lineno">75</span><span class="op" id="1331100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1331103">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="1331158">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="1331216">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="1331240">//</span><br>
<span class="lineno"></span><span class="comment" id="1331243">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="1331289">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="1331349">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1331408">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="1331467">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="1331523">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="1331540">//</span><br>
<span class="lineno"></span><span class="comment" id="1331543">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="1331591">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="1331653">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1331712">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="1331750">//</span><br>
<span class="lineno"></span><span class="keyword" id="1331753">func</span>&nbsp;<span class="op" id="1331758">(</span><span class="ident" id="1331759">r</span>&nbsp;<span class="op" id="1331761">*</span><span class="ident" id="1331762">Ring</span><span class="op" id="1331766">)</span>&nbsp;<span class="ident" id="1331768">Link</span><span class="op" id="1331772">(</span><span class="ident" id="1331773">s</span>&nbsp;<span class="op" id="1331775">*</span><span class="ident" id="1331776">Ring</span><span class="op" id="1331780">)</span>&nbsp;<span class="op" id="1331782">*</span><span class="ident" id="1331783">Ring</span>&nbsp;<span class="op" id="1331788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331791">n</span>&nbsp;<span class="op" id="1331793">:=</span>&nbsp;<span class="ident" id="1331796">r</span><span class="op" id="1331797">.</span><span class="ident" id="1331798">Next</span><span class="op" id="1331802">(</span><span class="op" id="1331803">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1331806">if</span>&nbsp;<span class="ident" id="1331809">s</span>&nbsp;<span class="op" id="1331811">!=</span>&nbsp;<span class="ident" id="1331814">nil</span>&nbsp;<span class="op" id="1331818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331822">p</span>&nbsp;<span class="op" id="1331824">:=</span>&nbsp;<span class="ident" id="1331827">s</span><span class="op" id="1331828">.</span><span class="ident" id="1331829">Prev</span><span class="op" id="1331833">(</span><span class="op" id="1331834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1331838">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1331888">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331935">r</span><span class="op" id="1331936">.</span><span class="ident" id="1331937">next</span>&nbsp;<span class="op" id="1331942">=</span>&nbsp;<span class="ident" id="1331944">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331948">s</span><span class="op" id="1331949">.</span><span class="ident" id="1331950">prev</span>&nbsp;<span class="op" id="1331955">=</span>&nbsp;<span class="ident" id="1331957">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331961">n</span><span class="op" id="1331962">.</span><span class="ident" id="1331963">prev</span>&nbsp;<span class="op" id="1331968">=</span>&nbsp;<span class="ident" id="1331970">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1331974">p</span><span class="op" id="1331975">.</span><span class="ident" id="1331976">next</span>&nbsp;<span class="op" id="1331981">=</span>&nbsp;<span class="ident" id="1331983">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1331986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1331989">return</span>&nbsp;<span class="ident" id="1331996">n</span><br>
<span class="lineno">105</span><span class="op" id="1331998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1332001">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="1332066">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="1332124">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="1332183">//</span><br>
<span class="lineno"></span><span class="keyword" id="1332186">func</span>&nbsp;<span class="op" id="1332191">(</span><span class="ident" id="1332192">r</span>&nbsp;<span class="op" id="1332194">*</span><span class="ident" id="1332195">Ring</span><span class="op" id="1332199">)</span>&nbsp;<span class="ident" id="1332201">Unlink</span><span class="op" id="1332207">(</span><span class="ident" id="1332208">n</span>&nbsp;<span class="builtintype" id="1332210">int</span><span class="op" id="1332213">)</span>&nbsp;<span class="op" id="1332215">*</span><span class="ident" id="1332216">Ring</span>&nbsp;<span class="op" id="1332221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1332224">if</span>&nbsp;<span class="ident" id="1332227">n</span>&nbsp;<span class="op" id="1332229">&lt;=</span>&nbsp;<span class="num" id="1332232">0</span>&nbsp;<span class="op" id="1332234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1332238">return</span>&nbsp;<span class="ident" id="1332245">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1332250">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1332253">return</span>&nbsp;<span class="ident" id="1332260">r</span><span class="op" id="1332261">.</span><span class="ident" id="1332262">Link</span><span class="op" id="1332266">(</span><span class="ident" id="1332267">r</span><span class="op" id="1332268">.</span><span class="ident" id="1332269">Move</span><span class="op" id="1332273">(</span><span class="ident" id="1332274">n</span>&nbsp;<span class="op" id="1332276">+</span>&nbsp;<span class="num" id="1332278">1</span><span class="op" id="1332279">)</span><span class="op" id="1332280">)</span><br>
<span class="lineno"></span><span class="op" id="1332282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1332285">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="1332335">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="1332398">//</span><br>
<span class="lineno"></span><span class="keyword" id="1332401">func</span>&nbsp;<span class="op" id="1332406">(</span><span class="ident" id="1332407">r</span>&nbsp;<span class="op" id="1332409">*</span><span class="ident" id="1332410">Ring</span><span class="op" id="1332414">)</span>&nbsp;<span class="ident" id="1332416">Len</span><span class="op" id="1332419">(</span><span class="op" id="1332420">)</span>&nbsp;<span class="builtintype" id="1332422">int</span>&nbsp;<span class="op" id="1332426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1332429">n</span>&nbsp;<span class="op" id="1332431">:=</span>&nbsp;<span class="num" id="1332434">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1332437">if</span>&nbsp;<span class="ident" id="1332440">r</span>&nbsp;<span class="op" id="1332442">!=</span>&nbsp;<span class="ident" id="1332445">nil</span>&nbsp;<span class="op" id="1332449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1332453">n</span>&nbsp;<span class="op" id="1332455">=</span>&nbsp;<span class="num" id="1332457">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1332461">for</span>&nbsp;<span class="ident" id="1332465">p</span>&nbsp;<span class="op" id="1332467">:=</span>&nbsp;<span class="ident" id="1332470">r</span><span class="op" id="1332471">.</span><span class="ident" id="1332472">Next</span><span class="op" id="1332476">(</span><span class="op" id="1332477">)</span><span class="op" id="1332478">;</span>&nbsp;<span class="ident" id="1332480">p</span>&nbsp;<span class="op" id="1332482">!=</span>&nbsp;<span class="ident" id="1332485">r</span><span class="op" id="1332486">;</span>&nbsp;<span class="ident" id="1332488">p</span>&nbsp;<span class="op" id="1332490">=</span>&nbsp;<span class="ident" id="1332492">p</span><span class="op" id="1332493">.</span><span class="ident" id="1332494">next</span>&nbsp;<span class="op" id="1332499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1332504">n</span><span class="op" id="1332505">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1332510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1332513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1332516">return</span>&nbsp;<span class="ident" id="1332523">n</span><br>
<span class="lineno">130</span><span class="op" id="1332525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1332528">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="1332598">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="1332650">func</span>&nbsp;<span class="op" id="1332655">(</span><span class="ident" id="1332656">r</span>&nbsp;<span class="op" id="1332658">*</span><span class="ident" id="1332659">Ring</span><span class="op" id="1332663">)</span>&nbsp;<span class="ident" id="1332665">Do</span><span class="op" id="1332667">(</span><span class="ident" id="1332668">f</span>&nbsp;<span class="keyword" id="1332670">func</span><span class="op" id="1332674">(</span><span class="keyword" id="1332675">interface</span><span class="op" id="1332684">{</span><span class="op" id="1332685">}</span><span class="op" id="1332686">)</span><span class="op" id="1332687">)</span>&nbsp;<span class="op" id="1332689">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1332692">if</span>&nbsp;<span class="ident" id="1332695">r</span>&nbsp;<span class="op" id="1332697">!=</span>&nbsp;<span class="ident" id="1332700">nil</span>&nbsp;<span class="op" id="1332704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1332708">f</span><span class="op" id="1332709">(</span><span class="ident" id="1332710">r</span><span class="op" id="1332711">.</span><span class="ident" id="1332712">Value</span><span class="op" id="1332717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1332721">for</span>&nbsp;<span class="ident" id="1332725">p</span>&nbsp;<span class="op" id="1332727">:=</span>&nbsp;<span class="ident" id="1332730">r</span><span class="op" id="1332731">.</span><span class="ident" id="1332732">Next</span><span class="op" id="1332736">(</span><span class="op" id="1332737">)</span><span class="op" id="1332738">;</span>&nbsp;<span class="ident" id="1332740">p</span>&nbsp;<span class="op" id="1332742">!=</span>&nbsp;<span class="ident" id="1332745">r</span><span class="op" id="1332746">;</span>&nbsp;<span class="ident" id="1332748">p</span>&nbsp;<span class="op" id="1332750">=</span>&nbsp;<span class="ident" id="1332752">p</span><span class="op" id="1332753">.</span><span class="ident" id="1332754">next</span>&nbsp;<span class="op" id="1332759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1332764">f</span><span class="op" id="1332765">(</span><span class="ident" id="1332766">p</span><span class="op" id="1332767">.</span><span class="ident" id="1332768">Value</span><span class="op" id="1332773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1332777">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1332780">}</span><br>
<span class="lineno"></span><span class="op" id="1332782">}</span>
</div>
</body>
</html>
