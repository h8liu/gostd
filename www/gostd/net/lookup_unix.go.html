<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html" class="current">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3314949">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3315005">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3315059">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3315110">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3315175">package</span>&nbsp;<span class="ident" id="3315183">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3315188">import</span>&nbsp;<span class="op" id="3315195">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3315198">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3315208">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3315215">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3315218">var</span>&nbsp;<span class="ident" id="3315222">onceReadProtocols</span>&nbsp;<span class="ident" id="3315240">sync</span><span class="op" id="3315244">.</span><span class="ident" id="3315245">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3315251">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3315320">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3315341">func</span>&nbsp;<span class="ident" id="3315346">readProtocols</span><span class="op" id="3315359">(</span><span class="op" id="3315360">)</span>&nbsp;<span class="op" id="3315362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3315365">if</span>&nbsp;<span class="ident" id="3315368">file</span><span class="op" id="3315372">,</span>&nbsp;<span class="ident" id="3315374">err</span>&nbsp;<span class="op" id="3315378">:=</span>&nbsp;<span class="ident" id="3315381">open</span><span class="op" id="3315385">(</span><span class="string" id="3315386">&#34;/etc/protocols&#34;</span><span class="op" id="3315402">)</span><span class="op" id="3315403">;</span>&nbsp;<span class="ident" id="3315405">err</span>&nbsp;<span class="op" id="3315409">==</span>&nbsp;<span class="builtintype" id="3315412">nil</span>&nbsp;<span class="op" id="3315416">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3315420">for</span>&nbsp;<span class="ident" id="3315424">line</span><span class="op" id="3315428">,</span>&nbsp;<span class="ident" id="3315430">ok</span>&nbsp;<span class="op" id="3315433">:=</span>&nbsp;<span class="ident" id="3315436">file</span><span class="op" id="3315440">.</span><span class="ident" id="3315441">readLine</span><span class="op" id="3315449">(</span><span class="op" id="3315450">)</span><span class="op" id="3315451">;</span>&nbsp;<span class="ident" id="3315453">ok</span><span class="op" id="3315455">;</span>&nbsp;<span class="ident" id="3315457">line</span><span class="op" id="3315461">,</span>&nbsp;<span class="ident" id="3315463">ok</span>&nbsp;<span class="op" id="3315466">=</span>&nbsp;<span class="ident" id="3315468">file</span><span class="op" id="3315472">.</span><span class="ident" id="3315473">readLine</span><span class="op" id="3315481">(</span><span class="op" id="3315482">)</span>&nbsp;<span class="op" id="3315484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3315489">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3315545">if</span>&nbsp;<span class="ident" id="3315548">i</span>&nbsp;<span class="op" id="3315550">:=</span>&nbsp;<span class="ident" id="3315553">byteIndex</span><span class="op" id="3315562">(</span><span class="ident" id="3315563">line</span><span class="op" id="3315567">,</span>&nbsp;<span class="string" id="3315569">&#39;#&#39;</span><span class="op" id="3315572">)</span><span class="op" id="3315573">;</span>&nbsp;<span class="ident" id="3315575">i</span>&nbsp;<span class="op" id="3315577">&gt;=</span>&nbsp;<span class="num" id="3315580">0</span>&nbsp;<span class="op" id="3315582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3315588">line</span>&nbsp;<span class="op" id="3315593">=</span>&nbsp;<span class="ident" id="3315595">line</span><span class="op" id="3315599">[</span><span class="num" id="3315600">0</span><span class="op" id="3315601">:</span><span class="ident" id="3315602">i</span><span class="op" id="3315603">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3315608">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3315613">f</span>&nbsp;<span class="op" id="3315615">:=</span>&nbsp;<span class="ident" id="3315618">getFields</span><span class="op" id="3315627">(</span><span class="ident" id="3315628">line</span><span class="op" id="3315632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3315637">if</span>&nbsp;<span class="builtinfunc" id="3315640">len</span><span class="op" id="3315643">(</span><span class="ident" id="3315644">f</span><span class="op" id="3315645">)</span>&nbsp;<span class="op" id="3315647">&lt;</span>&nbsp;<span class="num" id="3315649">2</span>&nbsp;<span class="op" id="3315651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3315657">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3315669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3315674">if</span>&nbsp;<span class="ident" id="3315677">proto</span><span class="op" id="3315682">,</span>&nbsp;<span class="ident" id="3315684">_</span><span class="op" id="3315685">,</span>&nbsp;<span class="ident" id="3315687">ok</span>&nbsp;<span class="op" id="3315690">:=</span>&nbsp;<span class="ident" id="3315693">dtoi</span><span class="op" id="3315697">(</span><span class="ident" id="3315698">f</span><span class="op" id="3315699">[</span><span class="num" id="3315700">1</span><span class="op" id="3315701">]</span><span class="op" id="3315702">,</span>&nbsp;<span class="num" id="3315704">0</span><span class="op" id="3315705">)</span><span class="op" id="3315706">;</span>&nbsp;<span class="ident" id="3315708">ok</span>&nbsp;<span class="op" id="3315711">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3315717">if</span>&nbsp;<span class="ident" id="3315720">_</span><span class="op" id="3315721">,</span>&nbsp;<span class="ident" id="3315723">ok</span>&nbsp;<span class="op" id="3315726">:=</span>&nbsp;<span class="ident" id="3315729">protocols</span><span class="op" id="3315738">[</span><span class="ident" id="3315739">f</span><span class="op" id="3315740">[</span><span class="num" id="3315741">0</span><span class="op" id="3315742">]</span><span class="op" id="3315743">]</span><span class="op" id="3315744">;</span>&nbsp;<span class="op" id="3315746">!</span><span class="ident" id="3315747">ok</span>&nbsp;<span class="op" id="3315750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3315757">protocols</span><span class="op" id="3315766">[</span><span class="ident" id="3315767">f</span><span class="op" id="3315768">[</span><span class="num" id="3315769">0</span><span class="op" id="3315770">]</span><span class="op" id="3315771">]</span>&nbsp;<span class="op" id="3315773">=</span>&nbsp;<span class="ident" id="3315775">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3315785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3315791">for</span>&nbsp;<span class="ident" id="3315795">_</span><span class="op" id="3315796">,</span>&nbsp;<span class="ident" id="3315798">alias</span>&nbsp;<span class="op" id="3315804">:=</span>&nbsp;<span class="keyword" id="3315807">range</span>&nbsp;<span class="ident" id="3315813">f</span><span class="op" id="3315814">[</span><span class="num" id="3315815">2</span><span class="op" id="3315816">:</span><span class="op" id="3315817">]</span>&nbsp;<span class="op" id="3315819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3315826">if</span>&nbsp;<span class="ident" id="3315829">_</span><span class="op" id="3315830">,</span>&nbsp;<span class="ident" id="3315832">ok</span>&nbsp;<span class="op" id="3315835">:=</span>&nbsp;<span class="ident" id="3315838">protocols</span><span class="op" id="3315847">[</span><span class="ident" id="3315848">alias</span><span class="op" id="3315853">]</span><span class="op" id="3315854">;</span>&nbsp;<span class="op" id="3315856">!</span><span class="ident" id="3315857">ok</span>&nbsp;<span class="op" id="3315860">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3315868">protocols</span><span class="op" id="3315877">[</span><span class="ident" id="3315878">alias</span><span class="op" id="3315883">]</span>&nbsp;<span class="op" id="3315885">=</span>&nbsp;<span class="ident" id="3315887">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3315898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3315904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3315909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3315913">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3315917">file</span><span class="op" id="3315921">.</span><span class="builtinfunc" id="3315922">close</span><span class="op" id="3315927">(</span><span class="op" id="3315928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3315931">}</span><br>
<span class="lineno"></span><span class="op" id="3315933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3315936">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3316002">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3316044">func</span>&nbsp;<span class="ident" id="3316049">lookupProtocol</span><span class="op" id="3316063">(</span><span class="ident" id="3316064">name</span>&nbsp;<span class="builtintype" id="3316069">string</span><span class="op" id="3316075">)</span>&nbsp;<span class="op" id="3316077">(</span><span class="ident" id="3316078">proto</span>&nbsp;<span class="builtintype" id="3316084">int</span><span class="op" id="3316087">,</span>&nbsp;<span class="ident" id="3316089">err</span>&nbsp;<span class="builtintype" id="3316093">error</span><span class="op" id="3316098">)</span>&nbsp;<span class="op" id="3316100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316103">onceReadProtocols</span><span class="op" id="3316120">.</span><span class="ident" id="3316121">Do</span><span class="op" id="3316123">(</span><span class="ident" id="3316124">readProtocols</span><span class="op" id="3316137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316140">proto</span><span class="op" id="3316145">,</span>&nbsp;<span class="ident" id="3316147">found</span>&nbsp;<span class="op" id="3316153">:=</span>&nbsp;<span class="ident" id="3316156">protocols</span><span class="op" id="3316165">[</span><span class="ident" id="3316166">name</span><span class="op" id="3316170">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316173">if</span>&nbsp;<span class="op" id="3316176">!</span><span class="ident" id="3316177">found</span>&nbsp;<span class="op" id="3316183">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316187">return</span>&nbsp;<span class="num" id="3316194">0</span><span class="op" id="3316195">,</span>&nbsp;<span class="ident" id="3316197">errors</span><span class="op" id="3316203">.</span><span class="ident" id="3316204">New</span><span class="op" id="3316207">(</span><span class="string" id="3316208">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3316242">+</span>&nbsp;<span class="ident" id="3316244">name</span><span class="op" id="3316248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3316251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316254">return</span><br>
<span class="lineno"></span><span class="op" id="3316261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3316264">func</span>&nbsp;<span class="ident" id="3316269">lookupHost</span><span class="op" id="3316279">(</span><span class="ident" id="3316280">host</span>&nbsp;<span class="builtintype" id="3316285">string</span><span class="op" id="3316291">)</span>&nbsp;<span class="op" id="3316293">(</span><span class="ident" id="3316294">addrs</span>&nbsp;<span class="op" id="3316300">[</span><span class="op" id="3316301">]</span><span class="builtintype" id="3316302">string</span><span class="op" id="3316308">,</span>&nbsp;<span class="ident" id="3316310">err</span>&nbsp;<span class="builtintype" id="3316314">error</span><span class="op" id="3316319">)</span>&nbsp;<span class="op" id="3316321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316324">addrs</span><span class="op" id="3316329">,</span>&nbsp;<span class="ident" id="3316331">err</span><span class="op" id="3316334">,</span>&nbsp;<span class="ident" id="3316336">ok</span>&nbsp;<span class="op" id="3316339">:=</span>&nbsp;<span class="ident" id="3316342">cgoLookupHost</span><span class="op" id="3316355">(</span><span class="ident" id="3316356">host</span><span class="op" id="3316360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316363">if</span>&nbsp;<span class="op" id="3316366">!</span><span class="ident" id="3316367">ok</span>&nbsp;<span class="op" id="3316370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316374">addrs</span><span class="op" id="3316379">,</span>&nbsp;<span class="ident" id="3316381">err</span>&nbsp;<span class="op" id="3316385">=</span>&nbsp;<span class="ident" id="3316387">goLookupHost</span><span class="op" id="3316399">(</span><span class="ident" id="3316400">host</span><span class="op" id="3316404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3316407">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316410">return</span><br>
<span class="lineno"></span><span class="op" id="3316417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3316420">func</span>&nbsp;<span class="ident" id="3316425">lookupIP</span><span class="op" id="3316433">(</span><span class="ident" id="3316434">host</span>&nbsp;<span class="builtintype" id="3316439">string</span><span class="op" id="3316445">)</span>&nbsp;<span class="op" id="3316447">(</span><span class="ident" id="3316448">addrs</span>&nbsp;<span class="op" id="3316454">[</span><span class="op" id="3316455">]</span><span class="ident" id="3316456">IP</span><span class="op" id="3316458">,</span>&nbsp;<span class="ident" id="3316460">err</span>&nbsp;<span class="builtintype" id="3316464">error</span><span class="op" id="3316469">)</span>&nbsp;<span class="op" id="3316471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316474">addrs</span><span class="op" id="3316479">,</span>&nbsp;<span class="ident" id="3316481">err</span><span class="op" id="3316484">,</span>&nbsp;<span class="ident" id="3316486">ok</span>&nbsp;<span class="op" id="3316489">:=</span>&nbsp;<span class="ident" id="3316492">cgoLookupIP</span><span class="op" id="3316503">(</span><span class="ident" id="3316504">host</span><span class="op" id="3316508">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316511">if</span>&nbsp;<span class="op" id="3316514">!</span><span class="ident" id="3316515">ok</span>&nbsp;<span class="op" id="3316518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316522">addrs</span><span class="op" id="3316527">,</span>&nbsp;<span class="ident" id="3316529">err</span>&nbsp;<span class="op" id="3316533">=</span>&nbsp;<span class="ident" id="3316535">goLookupIP</span><span class="op" id="3316545">(</span><span class="ident" id="3316546">host</span><span class="op" id="3316550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3316553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316556">return</span><br>
<span class="lineno"></span><span class="op" id="3316563">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3316566">func</span>&nbsp;<span class="ident" id="3316571">lookupPort</span><span class="op" id="3316581">(</span><span class="ident" id="3316582">network</span><span class="op" id="3316589">,</span>&nbsp;<span class="ident" id="3316591">service</span>&nbsp;<span class="builtintype" id="3316599">string</span><span class="op" id="3316605">)</span>&nbsp;<span class="op" id="3316607">(</span><span class="ident" id="3316608">port</span>&nbsp;<span class="builtintype" id="3316613">int</span><span class="op" id="3316616">,</span>&nbsp;<span class="ident" id="3316618">err</span>&nbsp;<span class="builtintype" id="3316622">error</span><span class="op" id="3316627">)</span>&nbsp;<span class="op" id="3316629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316632">port</span><span class="op" id="3316636">,</span>&nbsp;<span class="ident" id="3316638">err</span><span class="op" id="3316641">,</span>&nbsp;<span class="ident" id="3316643">ok</span>&nbsp;<span class="op" id="3316646">:=</span>&nbsp;<span class="ident" id="3316649">cgoLookupPort</span><span class="op" id="3316662">(</span><span class="ident" id="3316663">network</span><span class="op" id="3316670">,</span>&nbsp;<span class="ident" id="3316672">service</span><span class="op" id="3316679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316682">if</span>&nbsp;<span class="op" id="3316685">!</span><span class="ident" id="3316686">ok</span>&nbsp;<span class="op" id="3316689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316693">port</span><span class="op" id="3316697">,</span>&nbsp;<span class="ident" id="3316699">err</span>&nbsp;<span class="op" id="3316703">=</span>&nbsp;<span class="ident" id="3316705">goLookupPort</span><span class="op" id="3316717">(</span><span class="ident" id="3316718">network</span><span class="op" id="3316725">,</span>&nbsp;<span class="ident" id="3316727">service</span><span class="op" id="3316734">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3316737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316740">return</span><br>
<span class="lineno"></span><span class="op" id="3316747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3316750">func</span>&nbsp;<span class="ident" id="3316755">lookupCNAME</span><span class="op" id="3316766">(</span><span class="ident" id="3316767">name</span>&nbsp;<span class="builtintype" id="3316772">string</span><span class="op" id="3316778">)</span>&nbsp;<span class="op" id="3316780">(</span><span class="ident" id="3316781">cname</span>&nbsp;<span class="builtintype" id="3316787">string</span><span class="op" id="3316793">,</span>&nbsp;<span class="ident" id="3316795">err</span>&nbsp;<span class="builtintype" id="3316799">error</span><span class="op" id="3316804">)</span>&nbsp;<span class="op" id="3316806">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316809">cname</span><span class="op" id="3316814">,</span>&nbsp;<span class="ident" id="3316816">err</span><span class="op" id="3316819">,</span>&nbsp;<span class="ident" id="3316821">ok</span>&nbsp;<span class="op" id="3316824">:=</span>&nbsp;<span class="ident" id="3316827">cgoLookupCNAME</span><span class="op" id="3316841">(</span><span class="ident" id="3316842">name</span><span class="op" id="3316846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316849">if</span>&nbsp;<span class="op" id="3316852">!</span><span class="ident" id="3316853">ok</span>&nbsp;<span class="op" id="3316856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3316860">cname</span><span class="op" id="3316865">,</span>&nbsp;<span class="ident" id="3316867">err</span>&nbsp;<span class="op" id="3316871">=</span>&nbsp;<span class="ident" id="3316873">goLookupCNAME</span><span class="op" id="3316886">(</span><span class="ident" id="3316887">name</span><span class="op" id="3316891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3316894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316897">return</span><br>
<span class="lineno">85</span><span class="op" id="3316904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3316907">func</span>&nbsp;<span class="ident" id="3316912">lookupSRV</span><span class="op" id="3316921">(</span><span class="ident" id="3316922">service</span><span class="op" id="3316929">,</span>&nbsp;<span class="ident" id="3316931">proto</span><span class="op" id="3316936">,</span>&nbsp;<span class="ident" id="3316938">name</span>&nbsp;<span class="builtintype" id="3316943">string</span><span class="op" id="3316949">)</span>&nbsp;<span class="op" id="3316951">(</span><span class="ident" id="3316952">cname</span>&nbsp;<span class="builtintype" id="3316958">string</span><span class="op" id="3316964">,</span>&nbsp;<span class="ident" id="3316966">addrs</span>&nbsp;<span class="op" id="3316972">[</span><span class="op" id="3316973">]</span><span class="op" id="3316974">*</span><span class="ident" id="3316975">SRV</span><span class="op" id="3316978">,</span>&nbsp;<span class="ident" id="3316980">err</span>&nbsp;<span class="builtintype" id="3316984">error</span><span class="op" id="3316989">)</span>&nbsp;<span class="op" id="3316991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3316994">var</span>&nbsp;<span class="ident" id="3316998">target</span>&nbsp;<span class="builtintype" id="3317005">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317013">if</span>&nbsp;<span class="ident" id="3317016">service</span>&nbsp;<span class="op" id="3317024">==</span>&nbsp;<span class="string" id="3317027">&#34;&#34;</span>&nbsp;<span class="op" id="3317030">&amp;&amp;</span>&nbsp;<span class="ident" id="3317033">proto</span>&nbsp;<span class="op" id="3317039">==</span>&nbsp;<span class="string" id="3317042">&#34;&#34;</span>&nbsp;<span class="op" id="3317045">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317049">target</span>&nbsp;<span class="op" id="3317056">=</span>&nbsp;<span class="ident" id="3317058">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3317064">}</span>&nbsp;<span class="keyword" id="3317066">else</span>&nbsp;<span class="op" id="3317071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317075">target</span>&nbsp;<span class="op" id="3317082">=</span>&nbsp;<span class="string" id="3317084">&#34;_&#34;</span>&nbsp;<span class="op" id="3317088">+</span>&nbsp;<span class="ident" id="3317090">service</span>&nbsp;<span class="op" id="3317098">+</span>&nbsp;<span class="string" id="3317100">&#34;._&#34;</span>&nbsp;<span class="op" id="3317105">+</span>&nbsp;<span class="ident" id="3317107">proto</span>&nbsp;<span class="op" id="3317113">+</span>&nbsp;<span class="string" id="3317115">&#34;.&#34;</span>&nbsp;<span class="op" id="3317119">+</span>&nbsp;<span class="ident" id="3317121">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3317127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317130">var</span>&nbsp;<span class="ident" id="3317134">records</span>&nbsp;<span class="op" id="3317142">[</span><span class="op" id="3317143">]</span><span class="ident" id="3317144">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317151">cname</span><span class="op" id="3317156">,</span>&nbsp;<span class="ident" id="3317158">records</span><span class="op" id="3317165">,</span>&nbsp;<span class="ident" id="3317167">err</span>&nbsp;<span class="op" id="3317171">=</span>&nbsp;<span class="ident" id="3317173">lookup</span><span class="op" id="3317179">(</span><span class="ident" id="3317180">target</span><span class="op" id="3317186">,</span>&nbsp;<span class="ident" id="3317188">dnsTypeSRV</span><span class="op" id="3317198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317201">if</span>&nbsp;<span class="ident" id="3317204">err</span>&nbsp;<span class="op" id="3317208">!=</span>&nbsp;<span class="builtintype" id="3317211">nil</span>&nbsp;<span class="op" id="3317215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317219">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3317227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317230">addrs</span>&nbsp;<span class="op" id="3317236">=</span>&nbsp;<span class="builtinfunc" id="3317238">make</span><span class="op" id="3317242">(</span><span class="op" id="3317243">[</span><span class="op" id="3317244">]</span><span class="op" id="3317245">*</span><span class="ident" id="3317246">SRV</span><span class="op" id="3317249">,</span>&nbsp;<span class="builtinfunc" id="3317251">len</span><span class="op" id="3317254">(</span><span class="ident" id="3317255">records</span><span class="op" id="3317262">)</span><span class="op" id="3317263">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317266">for</span>&nbsp;<span class="ident" id="3317270">i</span><span class="op" id="3317271">,</span>&nbsp;<span class="ident" id="3317273">rr</span>&nbsp;<span class="op" id="3317276">:=</span>&nbsp;<span class="keyword" id="3317279">range</span>&nbsp;<span class="ident" id="3317285">records</span>&nbsp;<span class="op" id="3317293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317297">r</span>&nbsp;<span class="op" id="3317299">:=</span>&nbsp;<span class="ident" id="3317302">rr</span><span class="op" id="3317304">.</span><span class="op" id="3317305">(</span><span class="op" id="3317306">*</span><span class="ident" id="3317307">dnsRR_SRV</span><span class="op" id="3317316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317320">addrs</span><span class="op" id="3317325">[</span><span class="ident" id="3317326">i</span><span class="op" id="3317327">]</span>&nbsp;<span class="op" id="3317329">=</span>&nbsp;<span class="op" id="3317331">&amp;</span><span class="ident" id="3317332">SRV</span><span class="op" id="3317335">{</span><span class="ident" id="3317336">r</span><span class="op" id="3317337">.</span><span class="ident" id="3317338">Target</span><span class="op" id="3317344">,</span>&nbsp;<span class="ident" id="3317346">r</span><span class="op" id="3317347">.</span><span class="ident" id="3317348">Port</span><span class="op" id="3317352">,</span>&nbsp;<span class="ident" id="3317354">r</span><span class="op" id="3317355">.</span><span class="ident" id="3317356">Priority</span><span class="op" id="3317364">,</span>&nbsp;<span class="ident" id="3317366">r</span><span class="op" id="3317367">.</span><span class="ident" id="3317368">Weight</span><span class="op" id="3317374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3317377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317380">byPriorityWeight</span><span class="op" id="3317396">(</span><span class="ident" id="3317397">addrs</span><span class="op" id="3317402">)</span><span class="op" id="3317403">.</span><span class="ident" id="3317404">sort</span><span class="op" id="3317408">(</span><span class="op" id="3317409">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317412">return</span><br>
<span class="lineno"></span><span class="op" id="3317419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3317422">func</span>&nbsp;<span class="ident" id="3317427">lookupMX</span><span class="op" id="3317435">(</span><span class="ident" id="3317436">name</span>&nbsp;<span class="builtintype" id="3317441">string</span><span class="op" id="3317447">)</span>&nbsp;<span class="op" id="3317449">(</span><span class="ident" id="3317450">mx</span>&nbsp;<span class="op" id="3317453">[</span><span class="op" id="3317454">]</span><span class="op" id="3317455">*</span><span class="ident" id="3317456">MX</span><span class="op" id="3317458">,</span>&nbsp;<span class="ident" id="3317460">err</span>&nbsp;<span class="builtintype" id="3317464">error</span><span class="op" id="3317469">)</span>&nbsp;<span class="op" id="3317471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317474">_</span><span class="op" id="3317475">,</span>&nbsp;<span class="ident" id="3317477">records</span><span class="op" id="3317484">,</span>&nbsp;<span class="ident" id="3317486">err</span>&nbsp;<span class="op" id="3317490">:=</span>&nbsp;<span class="ident" id="3317493">lookup</span><span class="op" id="3317499">(</span><span class="ident" id="3317500">name</span><span class="op" id="3317504">,</span>&nbsp;<span class="ident" id="3317506">dnsTypeMX</span><span class="op" id="3317515">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317518">if</span>&nbsp;<span class="ident" id="3317521">err</span>&nbsp;<span class="op" id="3317525">!=</span>&nbsp;<span class="builtintype" id="3317528">nil</span>&nbsp;<span class="op" id="3317532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317536">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3317544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317547">mx</span>&nbsp;<span class="op" id="3317550">=</span>&nbsp;<span class="builtinfunc" id="3317552">make</span><span class="op" id="3317556">(</span><span class="op" id="3317557">[</span><span class="op" id="3317558">]</span><span class="op" id="3317559">*</span><span class="ident" id="3317560">MX</span><span class="op" id="3317562">,</span>&nbsp;<span class="builtinfunc" id="3317564">len</span><span class="op" id="3317567">(</span><span class="ident" id="3317568">records</span><span class="op" id="3317575">)</span><span class="op" id="3317576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317579">for</span>&nbsp;<span class="ident" id="3317583">i</span><span class="op" id="3317584">,</span>&nbsp;<span class="ident" id="3317586">rr</span>&nbsp;<span class="op" id="3317589">:=</span>&nbsp;<span class="keyword" id="3317592">range</span>&nbsp;<span class="ident" id="3317598">records</span>&nbsp;<span class="op" id="3317606">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317610">r</span>&nbsp;<span class="op" id="3317612">:=</span>&nbsp;<span class="ident" id="3317615">rr</span><span class="op" id="3317617">.</span><span class="op" id="3317618">(</span><span class="op" id="3317619">*</span><span class="ident" id="3317620">dnsRR_MX</span><span class="op" id="3317628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317632">mx</span><span class="op" id="3317634">[</span><span class="ident" id="3317635">i</span><span class="op" id="3317636">]</span>&nbsp;<span class="op" id="3317638">=</span>&nbsp;<span class="op" id="3317640">&amp;</span><span class="ident" id="3317641">MX</span><span class="op" id="3317643">{</span><span class="ident" id="3317644">r</span><span class="op" id="3317645">.</span><span class="ident" id="3317646">Mx</span><span class="op" id="3317648">,</span>&nbsp;<span class="ident" id="3317650">r</span><span class="op" id="3317651">.</span><span class="ident" id="3317652">Pref</span><span class="op" id="3317656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3317659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317662">byPref</span><span class="op" id="3317668">(</span><span class="ident" id="3317669">mx</span><span class="op" id="3317671">)</span><span class="op" id="3317672">.</span><span class="ident" id="3317673">sort</span><span class="op" id="3317677">(</span><span class="op" id="3317678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317681">return</span><br>
<span class="lineno">120</span><span class="op" id="3317688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3317691">func</span>&nbsp;<span class="ident" id="3317696">lookupNS</span><span class="op" id="3317704">(</span><span class="ident" id="3317705">name</span>&nbsp;<span class="builtintype" id="3317710">string</span><span class="op" id="3317716">)</span>&nbsp;<span class="op" id="3317718">(</span><span class="ident" id="3317719">ns</span>&nbsp;<span class="op" id="3317722">[</span><span class="op" id="3317723">]</span><span class="op" id="3317724">*</span><span class="ident" id="3317725">NS</span><span class="op" id="3317727">,</span>&nbsp;<span class="ident" id="3317729">err</span>&nbsp;<span class="builtintype" id="3317733">error</span><span class="op" id="3317738">)</span>&nbsp;<span class="op" id="3317740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317743">_</span><span class="op" id="3317744">,</span>&nbsp;<span class="ident" id="3317746">records</span><span class="op" id="3317753">,</span>&nbsp;<span class="ident" id="3317755">err</span>&nbsp;<span class="op" id="3317759">:=</span>&nbsp;<span class="ident" id="3317762">lookup</span><span class="op" id="3317768">(</span><span class="ident" id="3317769">name</span><span class="op" id="3317773">,</span>&nbsp;<span class="ident" id="3317775">dnsTypeNS</span><span class="op" id="3317784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317787">if</span>&nbsp;<span class="ident" id="3317790">err</span>&nbsp;<span class="op" id="3317794">!=</span>&nbsp;<span class="builtintype" id="3317797">nil</span>&nbsp;<span class="op" id="3317801">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317805">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3317813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317816">ns</span>&nbsp;<span class="op" id="3317819">=</span>&nbsp;<span class="builtinfunc" id="3317821">make</span><span class="op" id="3317825">(</span><span class="op" id="3317826">[</span><span class="op" id="3317827">]</span><span class="op" id="3317828">*</span><span class="ident" id="3317829">NS</span><span class="op" id="3317831">,</span>&nbsp;<span class="builtinfunc" id="3317833">len</span><span class="op" id="3317836">(</span><span class="ident" id="3317837">records</span><span class="op" id="3317844">)</span><span class="op" id="3317845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317848">for</span>&nbsp;<span class="ident" id="3317852">i</span><span class="op" id="3317853">,</span>&nbsp;<span class="ident" id="3317855">r</span>&nbsp;<span class="op" id="3317857">:=</span>&nbsp;<span class="keyword" id="3317860">range</span>&nbsp;<span class="ident" id="3317866">records</span>&nbsp;<span class="op" id="3317874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317878">r</span>&nbsp;<span class="op" id="3317880">:=</span>&nbsp;<span class="ident" id="3317883">r</span><span class="op" id="3317884">.</span><span class="op" id="3317885">(</span><span class="op" id="3317886">*</span><span class="ident" id="3317887">dnsRR_NS</span><span class="op" id="3317895">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317899">ns</span><span class="op" id="3317901">[</span><span class="ident" id="3317902">i</span><span class="op" id="3317903">]</span>&nbsp;<span class="op" id="3317905">=</span>&nbsp;<span class="op" id="3317907">&amp;</span><span class="ident" id="3317908">NS</span><span class="op" id="3317910">{</span><span class="ident" id="3317911">r</span><span class="op" id="3317912">.</span><span class="ident" id="3317913">Ns</span><span class="op" id="3317915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3317918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3317921">return</span><br>
<span class="lineno"></span><span class="op" id="3317928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3317931">func</span>&nbsp;<span class="ident" id="3317936">lookupTXT</span><span class="op" id="3317945">(</span><span class="ident" id="3317946">name</span>&nbsp;<span class="builtintype" id="3317951">string</span><span class="op" id="3317957">)</span>&nbsp;<span class="op" id="3317959">(</span><span class="ident" id="3317960">txt</span>&nbsp;<span class="op" id="3317964">[</span><span class="op" id="3317965">]</span><span class="builtintype" id="3317966">string</span><span class="op" id="3317972">,</span>&nbsp;<span class="ident" id="3317974">err</span>&nbsp;<span class="builtintype" id="3317978">error</span><span class="op" id="3317983">)</span>&nbsp;<span class="op" id="3317985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3317988">_</span><span class="op" id="3317989">,</span>&nbsp;<span class="ident" id="3317991">records</span><span class="op" id="3317998">,</span>&nbsp;<span class="ident" id="3318000">err</span>&nbsp;<span class="op" id="3318004">:=</span>&nbsp;<span class="ident" id="3318007">lookup</span><span class="op" id="3318013">(</span><span class="ident" id="3318014">name</span><span class="op" id="3318018">,</span>&nbsp;<span class="ident" id="3318020">dnsTypeTXT</span><span class="op" id="3318030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318033">if</span>&nbsp;<span class="ident" id="3318036">err</span>&nbsp;<span class="op" id="3318040">!=</span>&nbsp;<span class="builtintype" id="3318043">nil</span>&nbsp;<span class="op" id="3318047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318051">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3318059">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318062">txt</span>&nbsp;<span class="op" id="3318066">=</span>&nbsp;<span class="builtinfunc" id="3318068">make</span><span class="op" id="3318072">(</span><span class="op" id="3318073">[</span><span class="op" id="3318074">]</span><span class="builtintype" id="3318075">string</span><span class="op" id="3318081">,</span>&nbsp;<span class="builtinfunc" id="3318083">len</span><span class="op" id="3318086">(</span><span class="ident" id="3318087">records</span><span class="op" id="3318094">)</span><span class="op" id="3318095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318098">for</span>&nbsp;<span class="ident" id="3318102">i</span><span class="op" id="3318103">,</span>&nbsp;<span class="ident" id="3318105">r</span>&nbsp;<span class="op" id="3318107">:=</span>&nbsp;<span class="keyword" id="3318110">range</span>&nbsp;<span class="ident" id="3318116">records</span>&nbsp;<span class="op" id="3318124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318128">txt</span><span class="op" id="3318131">[</span><span class="ident" id="3318132">i</span><span class="op" id="3318133">]</span>&nbsp;<span class="op" id="3318135">=</span>&nbsp;<span class="ident" id="3318137">r</span><span class="op" id="3318138">.</span><span class="op" id="3318139">(</span><span class="op" id="3318140">*</span><span class="ident" id="3318141">dnsRR_TXT</span><span class="op" id="3318150">)</span><span class="op" id="3318151">.</span><span class="ident" id="3318152">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3318157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318160">return</span><br>
<span class="lineno">145</span><span class="op" id="3318167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3318170">func</span>&nbsp;<span class="ident" id="3318175">lookupAddr</span><span class="op" id="3318185">(</span><span class="ident" id="3318186">addr</span>&nbsp;<span class="builtintype" id="3318191">string</span><span class="op" id="3318197">)</span>&nbsp;<span class="op" id="3318199">(</span><span class="ident" id="3318200">name</span>&nbsp;<span class="op" id="3318205">[</span><span class="op" id="3318206">]</span><span class="builtintype" id="3318207">string</span><span class="op" id="3318213">,</span>&nbsp;<span class="ident" id="3318215">err</span>&nbsp;<span class="builtintype" id="3318219">error</span><span class="op" id="3318224">)</span>&nbsp;<span class="op" id="3318226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318229">name</span>&nbsp;<span class="op" id="3318234">=</span>&nbsp;<span class="ident" id="3318236">lookupStaticAddr</span><span class="op" id="3318252">(</span><span class="ident" id="3318253">addr</span><span class="op" id="3318257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318260">if</span>&nbsp;<span class="builtinfunc" id="3318263">len</span><span class="op" id="3318266">(</span><span class="ident" id="3318267">name</span><span class="op" id="3318271">)</span>&nbsp;<span class="op" id="3318273">&gt;</span>&nbsp;<span class="num" id="3318275">0</span>&nbsp;<span class="op" id="3318277">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318281">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3318289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318292">var</span>&nbsp;<span class="ident" id="3318296">arpa</span>&nbsp;<span class="builtintype" id="3318301">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318309">arpa</span><span class="op" id="3318313">,</span>&nbsp;<span class="ident" id="3318315">err</span>&nbsp;<span class="op" id="3318319">=</span>&nbsp;<span class="ident" id="3318321">reverseaddr</span><span class="op" id="3318332">(</span><span class="ident" id="3318333">addr</span><span class="op" id="3318337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318340">if</span>&nbsp;<span class="ident" id="3318343">err</span>&nbsp;<span class="op" id="3318347">!=</span>&nbsp;<span class="builtintype" id="3318350">nil</span>&nbsp;<span class="op" id="3318354">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318358">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3318366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318369">var</span>&nbsp;<span class="ident" id="3318373">records</span>&nbsp;<span class="op" id="3318381">[</span><span class="op" id="3318382">]</span><span class="ident" id="3318383">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318390">_</span><span class="op" id="3318391">,</span>&nbsp;<span class="ident" id="3318393">records</span><span class="op" id="3318400">,</span>&nbsp;<span class="ident" id="3318402">err</span>&nbsp;<span class="op" id="3318406">=</span>&nbsp;<span class="ident" id="3318408">lookup</span><span class="op" id="3318414">(</span><span class="ident" id="3318415">arpa</span><span class="op" id="3318419">,</span>&nbsp;<span class="ident" id="3318421">dnsTypePTR</span><span class="op" id="3318431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318434">if</span>&nbsp;<span class="ident" id="3318437">err</span>&nbsp;<span class="op" id="3318441">!=</span>&nbsp;<span class="builtintype" id="3318444">nil</span>&nbsp;<span class="op" id="3318448">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318452">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3318460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318463">name</span>&nbsp;<span class="op" id="3318468">=</span>&nbsp;<span class="builtinfunc" id="3318470">make</span><span class="op" id="3318474">(</span><span class="op" id="3318475">[</span><span class="op" id="3318476">]</span><span class="builtintype" id="3318477">string</span><span class="op" id="3318483">,</span>&nbsp;<span class="builtinfunc" id="3318485">len</span><span class="op" id="3318488">(</span><span class="ident" id="3318489">records</span><span class="op" id="3318496">)</span><span class="op" id="3318497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318500">for</span>&nbsp;<span class="ident" id="3318504">i</span>&nbsp;<span class="op" id="3318506">:=</span>&nbsp;<span class="keyword" id="3318509">range</span>&nbsp;<span class="ident" id="3318515">records</span>&nbsp;<span class="op" id="3318523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318527">r</span>&nbsp;<span class="op" id="3318529">:=</span>&nbsp;<span class="ident" id="3318532">records</span><span class="op" id="3318539">[</span><span class="ident" id="3318540">i</span><span class="op" id="3318541">]</span><span class="op" id="3318542">.</span><span class="op" id="3318543">(</span><span class="op" id="3318544">*</span><span class="ident" id="3318545">dnsRR_PTR</span><span class="op" id="3318554">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318558">name</span><span class="op" id="3318562">[</span><span class="ident" id="3318563">i</span><span class="op" id="3318564">]</span>&nbsp;<span class="op" id="3318566">=</span>&nbsp;<span class="ident" id="3318568">r</span><span class="op" id="3318569">.</span><span class="ident" id="3318570">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3318575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318578">return</span><br>
<span class="lineno"></span><span class="op" id="3318585">}</span>
</div>
</body>
</html>
