<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4832804">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4832860">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4832914">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4832965">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4833041">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="4833094">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4833109">package</span>&nbsp;<span class="ident" id="4833117">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4833123">import</span>&nbsp;<span class="op" id="4833130">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4833133">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4833142">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4833156">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4833173">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4833179">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4833185">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4833196">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4833204">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4833211">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4833214">const</span>&nbsp;<span class="ident" id="4833220">urandomDevice</span>&nbsp;<span class="op" id="4833234">=</span>&nbsp;<span class="string" id="4833236">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4833252">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="4833300">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4833352">func</span>&nbsp;<span class="ident" id="4833357">init</span><span class="op" id="4833361">(</span><span class="op" id="4833362">)</span>&nbsp;<span class="op" id="4833364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4833367">if</span>&nbsp;<span class="ident" id="4833370">runtime</span><span class="op" id="4833377">.</span><span class="ident" id="4833378">GOOS</span>&nbsp;<span class="op" id="4833383">==</span>&nbsp;<span class="string" id="4833386">&#34;plan9&#34;</span>&nbsp;<span class="op" id="4833394">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833398">Reader</span>&nbsp;<span class="op" id="4833405">=</span>&nbsp;<span class="ident" id="4833407">newReader</span><span class="op" id="4833416">(</span><span class="ident" id="4833417">nil</span><span class="op" id="4833420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4833423">}</span>&nbsp;<span class="keyword" id="4833425">else</span>&nbsp;<span class="op" id="4833430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833434">Reader</span>&nbsp;<span class="op" id="4833441">=</span>&nbsp;<span class="op" id="4833443">&amp;</span><span class="ident" id="4833444">devReader</span><span class="op" id="4833453">{</span><span class="ident" id="4833454">name</span><span class="op" id="4833458">:</span>&nbsp;<span class="ident" id="4833460">urandomDevice</span><span class="op" id="4833473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4833476">}</span><br>
<span class="lineno"></span><span class="op" id="4833478">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4833481">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4833544">type</span>&nbsp;<span class="ident" id="4833549">devReader</span>&nbsp;<span class="keyword" id="4833559">struct</span>&nbsp;<span class="op" id="4833566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833569">name</span>&nbsp;<span class="builtintype" id="4833574">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833582">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833587">io</span><span class="op" id="4833589">.</span><span class="ident" id="4833590">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833598">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4833603">sync</span><span class="op" id="4833607">.</span><span class="ident" id="4833608">Mutex</span><br>
<span class="lineno"></span><span class="op" id="4833614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4833617">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="4833685">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="4833714">var</span>&nbsp;<span class="ident" id="4833718">altGetRandom</span>&nbsp;<span class="keyword" id="4833731">func</span><span class="op" id="4833735">(</span><span class="op" id="4833736">[</span><span class="op" id="4833737">]</span><span class="builtintype" id="4833738">byte</span><span class="op" id="4833742">)</span>&nbsp;<span class="op" id="4833744">(</span><span class="ident" id="4833745">ok</span>&nbsp;<span class="builtintype" id="4833748">bool</span><span class="op" id="4833752">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4833755">func</span>&nbsp;<span class="op" id="4833760">(</span><span class="ident" id="4833761">r</span>&nbsp;<span class="op" id="4833763">*</span><span class="ident" id="4833764">devReader</span><span class="op" id="4833773">)</span>&nbsp;<span class="ident" id="4833775">Read</span><span class="op" id="4833779">(</span><span class="ident" id="4833780">b</span>&nbsp;<span class="op" id="4833782">[</span><span class="op" id="4833783">]</span><span class="builtintype" id="4833784">byte</span><span class="op" id="4833788">)</span>&nbsp;<span class="op" id="4833790">(</span><span class="ident" id="4833791">n</span>&nbsp;<span class="builtintype" id="4833793">int</span><span class="op" id="4833796">,</span>&nbsp;<span class="ident" id="4833798">err</span>&nbsp;<span class="builtintype" id="4833802">error</span><span class="op" id="4833807">)</span>&nbsp;<span class="op" id="4833809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4833812">if</span>&nbsp;<span class="ident" id="4833815">altGetRandom</span>&nbsp;<span class="op" id="4833828">!=</span>&nbsp;<span class="ident" id="4833831">nil</span>&nbsp;<span class="op" id="4833835">&amp;&amp;</span>&nbsp;<span class="ident" id="4833838">r</span><span class="op" id="4833839">.</span><span class="ident" id="4833840">name</span>&nbsp;<span class="op" id="4833845">==</span>&nbsp;<span class="ident" id="4833848">urandomDevice</span>&nbsp;<span class="op" id="4833862">&amp;&amp;</span>&nbsp;<span class="ident" id="4833865">altGetRandom</span><span class="op" id="4833877">(</span><span class="ident" id="4833878">b</span><span class="op" id="4833879">)</span>&nbsp;<span class="op" id="4833881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4833885">return</span>&nbsp;<span class="builtinfunc" id="4833892">len</span><span class="op" id="4833895">(</span><span class="ident" id="4833896">b</span><span class="op" id="4833897">)</span><span class="op" id="4833898">,</span>&nbsp;<span class="ident" id="4833900">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4833905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833908">r</span><span class="op" id="4833909">.</span><span class="ident" id="4833910">mu</span><span class="op" id="4833912">.</span><span class="ident" id="4833913">Lock</span><span class="op" id="4833917">(</span><span class="op" id="4833918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4833921">defer</span>&nbsp;<span class="ident" id="4833927">r</span><span class="op" id="4833928">.</span><span class="ident" id="4833929">mu</span><span class="op" id="4833931">.</span><span class="ident" id="4833932">Unlock</span><span class="op" id="4833938">(</span><span class="op" id="4833939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4833942">if</span>&nbsp;<span class="ident" id="4833945">r</span><span class="op" id="4833946">.</span><span class="ident" id="4833947">f</span>&nbsp;<span class="op" id="4833949">==</span>&nbsp;<span class="ident" id="4833952">nil</span>&nbsp;<span class="op" id="4833956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833960">f</span><span class="op" id="4833961">,</span>&nbsp;<span class="ident" id="4833963">err</span>&nbsp;<span class="op" id="4833967">:=</span>&nbsp;<span class="ident" id="4833970">os</span><span class="op" id="4833972">.</span><span class="ident" id="4833973">Open</span><span class="op" id="4833977">(</span><span class="ident" id="4833978">r</span><span class="op" id="4833979">.</span><span class="ident" id="4833980">name</span><span class="op" id="4833984">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4833988">if</span>&nbsp;<span class="ident" id="4833991">f</span>&nbsp;<span class="op" id="4833993">==</span>&nbsp;<span class="ident" id="4833996">nil</span>&nbsp;<span class="op" id="4834000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834005">return</span>&nbsp;<span class="num" id="4834012">0</span><span class="op" id="4834013">,</span>&nbsp;<span class="ident" id="4834015">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834025">if</span>&nbsp;<span class="ident" id="4834028">runtime</span><span class="op" id="4834035">.</span><span class="ident" id="4834036">GOOS</span>&nbsp;<span class="op" id="4834041">==</span>&nbsp;<span class="string" id="4834044">&#34;plan9&#34;</span>&nbsp;<span class="op" id="4834052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834057">r</span><span class="op" id="4834058">.</span><span class="ident" id="4834059">f</span>&nbsp;<span class="op" id="4834061">=</span>&nbsp;<span class="ident" id="4834063">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834067">}</span>&nbsp;<span class="keyword" id="4834069">else</span>&nbsp;<span class="op" id="4834074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834079">r</span><span class="op" id="4834080">.</span><span class="ident" id="4834081">f</span>&nbsp;<span class="op" id="4834083">=</span>&nbsp;<span class="ident" id="4834085">bufio</span><span class="op" id="4834090">.</span><span class="ident" id="4834091">NewReader</span><span class="op" id="4834100">(</span><span class="ident" id="4834101">f</span><span class="op" id="4834102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834112">return</span>&nbsp;<span class="ident" id="4834119">r</span><span class="op" id="4834120">.</span><span class="ident" id="4834121">f</span><span class="op" id="4834122">.</span><span class="ident" id="4834123">Read</span><span class="op" id="4834127">(</span><span class="ident" id="4834128">b</span><span class="op" id="4834129">)</span><br>
<span class="lineno">65</span><span class="op" id="4834131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4834134">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="4834187">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4834232">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4834287">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="4834348">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4834407">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="4834458">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="4834515">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4834574">//</span><br>
<span class="lineno"></span><span class="comment" id="4834577">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="4834633">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4834682">func</span>&nbsp;<span class="ident" id="4834687">newReader</span><span class="op" id="4834696">(</span><span class="ident" id="4834697">entropy</span>&nbsp;<span class="ident" id="4834705">io</span><span class="op" id="4834707">.</span><span class="ident" id="4834708">Reader</span><span class="op" id="4834714">)</span>&nbsp;<span class="ident" id="4834716">io</span><span class="op" id="4834718">.</span><span class="ident" id="4834719">Reader</span>&nbsp;<span class="op" id="4834726">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834729">if</span>&nbsp;<span class="ident" id="4834732">entropy</span>&nbsp;<span class="op" id="4834740">==</span>&nbsp;<span class="ident" id="4834743">nil</span>&nbsp;<span class="op" id="4834747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834751">entropy</span>&nbsp;<span class="op" id="4834759">=</span>&nbsp;<span class="op" id="4834761">&amp;</span><span class="ident" id="4834762">devReader</span><span class="op" id="4834771">{</span><span class="ident" id="4834772">name</span><span class="op" id="4834776">:</span>&nbsp;<span class="string" id="4834778">&#34;/dev/random&#34;</span><span class="op" id="4834791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834797">return</span>&nbsp;<span class="op" id="4834804">&amp;</span><span class="ident" id="4834805">reader</span><span class="op" id="4834811">{</span><span class="ident" id="4834812">entropy</span><span class="op" id="4834819">:</span>&nbsp;<span class="ident" id="4834821">entropy</span><span class="op" id="4834828">}</span><br>
<span class="lineno"></span><span class="op" id="4834830">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4834833">type</span>&nbsp;<span class="ident" id="4834838">reader</span>&nbsp;<span class="keyword" id="4834845">struct</span>&nbsp;<span class="op" id="4834852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834855">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834876">sync</span><span class="op" id="4834880">.</span><span class="ident" id="4834881">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834888">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4834909">int</span>&nbsp;<span class="comment" id="4834913">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834955">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834976">cipher</span><span class="op" id="4834982">.</span><span class="ident" id="4834983">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834990">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4835011">io</span><span class="op" id="4835013">.</span><span class="ident" id="4835014">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835022">time</span><span class="op" id="4835026">,</span>&nbsp;<span class="ident" id="4835028">seed</span><span class="op" id="4835032">,</span>&nbsp;<span class="ident" id="4835034">dst</span><span class="op" id="4835037">,</span>&nbsp;<span class="ident" id="4835039">key</span>&nbsp;<span class="op" id="4835043">[</span><span class="ident" id="4835044">aes</span><span class="op" id="4835047">.</span><span class="ident" id="4835048">BlockSize</span><span class="op" id="4835057">]</span><span class="builtintype" id="4835058">byte</span><br>
<span class="lineno"></span><span class="op" id="4835063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4835066">func</span>&nbsp;<span class="op" id="4835071">(</span><span class="ident" id="4835072">r</span>&nbsp;<span class="op" id="4835074">*</span><span class="ident" id="4835075">reader</span><span class="op" id="4835081">)</span>&nbsp;<span class="ident" id="4835083">Read</span><span class="op" id="4835087">(</span><span class="ident" id="4835088">b</span>&nbsp;<span class="op" id="4835090">[</span><span class="op" id="4835091">]</span><span class="builtintype" id="4835092">byte</span><span class="op" id="4835096">)</span>&nbsp;<span class="op" id="4835098">(</span><span class="ident" id="4835099">n</span>&nbsp;<span class="builtintype" id="4835101">int</span><span class="op" id="4835104">,</span>&nbsp;<span class="ident" id="4835106">err</span>&nbsp;<span class="builtintype" id="4835110">error</span><span class="op" id="4835115">)</span>&nbsp;<span class="op" id="4835117">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835120">r</span><span class="op" id="4835121">.</span><span class="ident" id="4835122">mu</span><span class="op" id="4835124">.</span><span class="ident" id="4835125">Lock</span><span class="op" id="4835129">(</span><span class="op" id="4835130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835133">defer</span>&nbsp;<span class="ident" id="4835139">r</span><span class="op" id="4835140">.</span><span class="ident" id="4835141">mu</span><span class="op" id="4835143">.</span><span class="ident" id="4835144">Unlock</span><span class="op" id="4835150">(</span><span class="op" id="4835151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835154">n</span>&nbsp;<span class="op" id="4835156">=</span>&nbsp;<span class="builtinfunc" id="4835158">len</span><span class="op" id="4835161">(</span><span class="ident" id="4835162">b</span><span class="op" id="4835163">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835167">for</span>&nbsp;<span class="builtinfunc" id="4835171">len</span><span class="op" id="4835174">(</span><span class="ident" id="4835175">b</span><span class="op" id="4835176">)</span>&nbsp;<span class="op" id="4835178">&gt;</span>&nbsp;<span class="num" id="4835180">0</span>&nbsp;<span class="op" id="4835182">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835186">if</span>&nbsp;<span class="ident" id="4835189">r</span><span class="op" id="4835190">.</span><span class="ident" id="4835191">budget</span>&nbsp;<span class="op" id="4835198">==</span>&nbsp;<span class="num" id="4835201">0</span>&nbsp;<span class="op" id="4835203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835208">_</span><span class="op" id="4835209">,</span>&nbsp;<span class="ident" id="4835211">err</span>&nbsp;<span class="op" id="4835215">:=</span>&nbsp;<span class="ident" id="4835218">io</span><span class="op" id="4835220">.</span><span class="ident" id="4835221">ReadFull</span><span class="op" id="4835229">(</span><span class="ident" id="4835230">r</span><span class="op" id="4835231">.</span><span class="ident" id="4835232">entropy</span><span class="op" id="4835239">,</span>&nbsp;<span class="ident" id="4835241">r</span><span class="op" id="4835242">.</span><span class="ident" id="4835243">seed</span><span class="op" id="4835247">[</span><span class="num" id="4835248">0</span><span class="op" id="4835249">:</span><span class="op" id="4835250">]</span><span class="op" id="4835251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835256">if</span>&nbsp;<span class="ident" id="4835259">err</span>&nbsp;<span class="op" id="4835263">!=</span>&nbsp;<span class="ident" id="4835266">nil</span>&nbsp;<span class="op" id="4835270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835276">return</span>&nbsp;<span class="ident" id="4835283">n</span>&nbsp;<span class="op" id="4835285">-</span>&nbsp;<span class="builtinfunc" id="4835287">len</span><span class="op" id="4835290">(</span><span class="ident" id="4835291">b</span><span class="op" id="4835292">)</span><span class="op" id="4835293">,</span>&nbsp;<span class="ident" id="4835295">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835302">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835307">_</span><span class="op" id="4835308">,</span>&nbsp;<span class="ident" id="4835310">err</span>&nbsp;<span class="op" id="4835314">=</span>&nbsp;<span class="ident" id="4835316">io</span><span class="op" id="4835318">.</span><span class="ident" id="4835319">ReadFull</span><span class="op" id="4835327">(</span><span class="ident" id="4835328">r</span><span class="op" id="4835329">.</span><span class="ident" id="4835330">entropy</span><span class="op" id="4835337">,</span>&nbsp;<span class="ident" id="4835339">r</span><span class="op" id="4835340">.</span><span class="ident" id="4835341">key</span><span class="op" id="4835344">[</span><span class="num" id="4835345">0</span><span class="op" id="4835346">:</span><span class="op" id="4835347">]</span><span class="op" id="4835348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835353">if</span>&nbsp;<span class="ident" id="4835356">err</span>&nbsp;<span class="op" id="4835360">!=</span>&nbsp;<span class="ident" id="4835363">nil</span>&nbsp;<span class="op" id="4835367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835373">return</span>&nbsp;<span class="ident" id="4835380">n</span>&nbsp;<span class="op" id="4835382">-</span>&nbsp;<span class="builtinfunc" id="4835384">len</span><span class="op" id="4835387">(</span><span class="ident" id="4835388">b</span><span class="op" id="4835389">)</span><span class="op" id="4835390">,</span>&nbsp;<span class="ident" id="4835392">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835404">r</span><span class="op" id="4835405">.</span><span class="ident" id="4835406">cipher</span><span class="op" id="4835412">,</span>&nbsp;<span class="ident" id="4835414">err</span>&nbsp;<span class="op" id="4835418">=</span>&nbsp;<span class="ident" id="4835420">aes</span><span class="op" id="4835423">.</span><span class="ident" id="4835424">NewCipher</span><span class="op" id="4835433">(</span><span class="ident" id="4835434">r</span><span class="op" id="4835435">.</span><span class="ident" id="4835436">key</span><span class="op" id="4835439">[</span><span class="num" id="4835440">0</span><span class="op" id="4835441">:</span><span class="op" id="4835442">]</span><span class="op" id="4835443">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835448">if</span>&nbsp;<span class="ident" id="4835451">err</span>&nbsp;<span class="op" id="4835455">!=</span>&nbsp;<span class="ident" id="4835458">nil</span>&nbsp;<span class="op" id="4835462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835468">return</span>&nbsp;<span class="ident" id="4835475">n</span>&nbsp;<span class="op" id="4835477">-</span>&nbsp;<span class="builtinfunc" id="4835479">len</span><span class="op" id="4835482">(</span><span class="ident" id="4835483">b</span><span class="op" id="4835484">)</span><span class="op" id="4835485">,</span>&nbsp;<span class="ident" id="4835487">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835499">r</span><span class="op" id="4835500">.</span><span class="ident" id="4835501">budget</span>&nbsp;<span class="op" id="4835508">=</span>&nbsp;<span class="num" id="4835510">1</span>&nbsp;<span class="op" id="4835512">&lt;&lt;</span>&nbsp;<span class="num" id="4835515">20</span>&nbsp;<span class="comment" id="4835518">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835551">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835555">r</span><span class="op" id="4835556">.</span><span class="ident" id="4835557">budget</span>&nbsp;<span class="op" id="4835564">-=</span>&nbsp;<span class="ident" id="4835567">aes</span><span class="op" id="4835570">.</span><span class="ident" id="4835571">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4835584">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4835654">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4835659">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4835678">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4835701">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4835728">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835755">ns</span>&nbsp;<span class="op" id="4835758">:=</span>&nbsp;<span class="ident" id="4835761">time</span><span class="op" id="4835765">.</span><span class="ident" id="4835766">Now</span><span class="op" id="4835769">(</span><span class="op" id="4835770">)</span><span class="op" id="4835771">.</span><span class="ident" id="4835772">UnixNano</span><span class="op" id="4835780">(</span><span class="op" id="4835781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835785">r</span><span class="op" id="4835786">.</span><span class="ident" id="4835787">time</span><span class="op" id="4835791">[</span><span class="num" id="4835792">0</span><span class="op" id="4835793">]</span>&nbsp;<span class="op" id="4835795">=</span>&nbsp;<span class="builtintype" id="4835797">byte</span><span class="op" id="4835801">(</span><span class="ident" id="4835802">ns</span>&nbsp;<span class="op" id="4835805">&gt;&gt;</span>&nbsp;<span class="num" id="4835808">56</span><span class="op" id="4835810">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835814">r</span><span class="op" id="4835815">.</span><span class="ident" id="4835816">time</span><span class="op" id="4835820">[</span><span class="num" id="4835821">1</span><span class="op" id="4835822">]</span>&nbsp;<span class="op" id="4835824">=</span>&nbsp;<span class="builtintype" id="4835826">byte</span><span class="op" id="4835830">(</span><span class="ident" id="4835831">ns</span>&nbsp;<span class="op" id="4835834">&gt;&gt;</span>&nbsp;<span class="num" id="4835837">48</span><span class="op" id="4835839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835843">r</span><span class="op" id="4835844">.</span><span class="ident" id="4835845">time</span><span class="op" id="4835849">[</span><span class="num" id="4835850">2</span><span class="op" id="4835851">]</span>&nbsp;<span class="op" id="4835853">=</span>&nbsp;<span class="builtintype" id="4835855">byte</span><span class="op" id="4835859">(</span><span class="ident" id="4835860">ns</span>&nbsp;<span class="op" id="4835863">&gt;&gt;</span>&nbsp;<span class="num" id="4835866">40</span><span class="op" id="4835868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835872">r</span><span class="op" id="4835873">.</span><span class="ident" id="4835874">time</span><span class="op" id="4835878">[</span><span class="num" id="4835879">3</span><span class="op" id="4835880">]</span>&nbsp;<span class="op" id="4835882">=</span>&nbsp;<span class="builtintype" id="4835884">byte</span><span class="op" id="4835888">(</span><span class="ident" id="4835889">ns</span>&nbsp;<span class="op" id="4835892">&gt;&gt;</span>&nbsp;<span class="num" id="4835895">32</span><span class="op" id="4835897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835901">r</span><span class="op" id="4835902">.</span><span class="ident" id="4835903">time</span><span class="op" id="4835907">[</span><span class="num" id="4835908">4</span><span class="op" id="4835909">]</span>&nbsp;<span class="op" id="4835911">=</span>&nbsp;<span class="builtintype" id="4835913">byte</span><span class="op" id="4835917">(</span><span class="ident" id="4835918">ns</span>&nbsp;<span class="op" id="4835921">&gt;&gt;</span>&nbsp;<span class="num" id="4835924">24</span><span class="op" id="4835926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835930">r</span><span class="op" id="4835931">.</span><span class="ident" id="4835932">time</span><span class="op" id="4835936">[</span><span class="num" id="4835937">5</span><span class="op" id="4835938">]</span>&nbsp;<span class="op" id="4835940">=</span>&nbsp;<span class="builtintype" id="4835942">byte</span><span class="op" id="4835946">(</span><span class="ident" id="4835947">ns</span>&nbsp;<span class="op" id="4835950">&gt;&gt;</span>&nbsp;<span class="num" id="4835953">16</span><span class="op" id="4835955">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835959">r</span><span class="op" id="4835960">.</span><span class="ident" id="4835961">time</span><span class="op" id="4835965">[</span><span class="num" id="4835966">6</span><span class="op" id="4835967">]</span>&nbsp;<span class="op" id="4835969">=</span>&nbsp;<span class="builtintype" id="4835971">byte</span><span class="op" id="4835975">(</span><span class="ident" id="4835976">ns</span>&nbsp;<span class="op" id="4835979">&gt;&gt;</span>&nbsp;<span class="num" id="4835982">8</span><span class="op" id="4835983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835987">r</span><span class="op" id="4835988">.</span><span class="ident" id="4835989">time</span><span class="op" id="4835993">[</span><span class="num" id="4835994">7</span><span class="op" id="4835995">]</span>&nbsp;<span class="op" id="4835997">=</span>&nbsp;<span class="builtintype" id="4835999">byte</span><span class="op" id="4836003">(</span><span class="ident" id="4836004">ns</span><span class="op" id="4836006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836010">r</span><span class="op" id="4836011">.</span><span class="ident" id="4836012">cipher</span><span class="op" id="4836018">.</span><span class="ident" id="4836019">Encrypt</span><span class="op" id="4836026">(</span><span class="ident" id="4836027">r</span><span class="op" id="4836028">.</span><span class="ident" id="4836029">time</span><span class="op" id="4836033">[</span><span class="num" id="4836034">0</span><span class="op" id="4836035">:</span><span class="op" id="4836036">]</span><span class="op" id="4836037">,</span>&nbsp;<span class="ident" id="4836039">r</span><span class="op" id="4836040">.</span><span class="ident" id="4836041">time</span><span class="op" id="4836045">[</span><span class="num" id="4836046">0</span><span class="op" id="4836047">:</span><span class="op" id="4836048">]</span><span class="op" id="4836049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836053">for</span>&nbsp;<span class="ident" id="4836057">i</span>&nbsp;<span class="op" id="4836059">:=</span>&nbsp;<span class="num" id="4836062">0</span><span class="op" id="4836063">;</span>&nbsp;<span class="ident" id="4836065">i</span>&nbsp;<span class="op" id="4836067">&lt;</span>&nbsp;<span class="ident" id="4836069">aes</span><span class="op" id="4836072">.</span><span class="ident" id="4836073">BlockSize</span><span class="op" id="4836082">;</span>&nbsp;<span class="ident" id="4836084">i</span><span class="op" id="4836085">++</span>&nbsp;<span class="op" id="4836088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836093">r</span><span class="op" id="4836094">.</span><span class="ident" id="4836095">dst</span><span class="op" id="4836098">[</span><span class="ident" id="4836099">i</span><span class="op" id="4836100">]</span>&nbsp;<span class="op" id="4836102">=</span>&nbsp;<span class="ident" id="4836104">r</span><span class="op" id="4836105">.</span><span class="ident" id="4836106">time</span><span class="op" id="4836110">[</span><span class="ident" id="4836111">i</span><span class="op" id="4836112">]</span>&nbsp;<span class="op" id="4836114">^</span>&nbsp;<span class="ident" id="4836116">r</span><span class="op" id="4836117">.</span><span class="ident" id="4836118">seed</span><span class="op" id="4836122">[</span><span class="ident" id="4836123">i</span><span class="op" id="4836124">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4836128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836132">r</span><span class="op" id="4836133">.</span><span class="ident" id="4836134">cipher</span><span class="op" id="4836140">.</span><span class="ident" id="4836141">Encrypt</span><span class="op" id="4836148">(</span><span class="ident" id="4836149">r</span><span class="op" id="4836150">.</span><span class="ident" id="4836151">dst</span><span class="op" id="4836154">[</span><span class="num" id="4836155">0</span><span class="op" id="4836156">:</span><span class="op" id="4836157">]</span><span class="op" id="4836158">,</span>&nbsp;<span class="ident" id="4836160">r</span><span class="op" id="4836161">.</span><span class="ident" id="4836162">dst</span><span class="op" id="4836165">[</span><span class="num" id="4836166">0</span><span class="op" id="4836167">:</span><span class="op" id="4836168">]</span><span class="op" id="4836169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836173">for</span>&nbsp;<span class="ident" id="4836177">i</span>&nbsp;<span class="op" id="4836179">:=</span>&nbsp;<span class="num" id="4836182">0</span><span class="op" id="4836183">;</span>&nbsp;<span class="ident" id="4836185">i</span>&nbsp;<span class="op" id="4836187">&lt;</span>&nbsp;<span class="ident" id="4836189">aes</span><span class="op" id="4836192">.</span><span class="ident" id="4836193">BlockSize</span><span class="op" id="4836202">;</span>&nbsp;<span class="ident" id="4836204">i</span><span class="op" id="4836205">++</span>&nbsp;<span class="op" id="4836208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836213">r</span><span class="op" id="4836214">.</span><span class="ident" id="4836215">seed</span><span class="op" id="4836219">[</span><span class="ident" id="4836220">i</span><span class="op" id="4836221">]</span>&nbsp;<span class="op" id="4836223">=</span>&nbsp;<span class="ident" id="4836225">r</span><span class="op" id="4836226">.</span><span class="ident" id="4836227">time</span><span class="op" id="4836231">[</span><span class="ident" id="4836232">i</span><span class="op" id="4836233">]</span>&nbsp;<span class="op" id="4836235">^</span>&nbsp;<span class="ident" id="4836237">r</span><span class="op" id="4836238">.</span><span class="ident" id="4836239">dst</span><span class="op" id="4836242">[</span><span class="ident" id="4836243">i</span><span class="op" id="4836244">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4836248">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836252">r</span><span class="op" id="4836253">.</span><span class="ident" id="4836254">cipher</span><span class="op" id="4836260">.</span><span class="ident" id="4836261">Encrypt</span><span class="op" id="4836268">(</span><span class="ident" id="4836269">r</span><span class="op" id="4836270">.</span><span class="ident" id="4836271">seed</span><span class="op" id="4836275">[</span><span class="num" id="4836276">0</span><span class="op" id="4836277">:</span><span class="op" id="4836278">]</span><span class="op" id="4836279">,</span>&nbsp;<span class="ident" id="4836281">r</span><span class="op" id="4836282">.</span><span class="ident" id="4836283">seed</span><span class="op" id="4836287">[</span><span class="num" id="4836288">0</span><span class="op" id="4836289">:</span><span class="op" id="4836290">]</span><span class="op" id="4836291">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836296">m</span>&nbsp;<span class="op" id="4836298">:=</span>&nbsp;<span class="builtinfunc" id="4836301">copy</span><span class="op" id="4836305">(</span><span class="ident" id="4836306">b</span><span class="op" id="4836307">,</span>&nbsp;<span class="ident" id="4836309">r</span><span class="op" id="4836310">.</span><span class="ident" id="4836311">dst</span><span class="op" id="4836314">[</span><span class="num" id="4836315">0</span><span class="op" id="4836316">:</span><span class="op" id="4836317">]</span><span class="op" id="4836318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836322">b</span>&nbsp;<span class="op" id="4836324">=</span>&nbsp;<span class="ident" id="4836326">b</span><span class="op" id="4836327">[</span><span class="ident" id="4836328">m</span><span class="op" id="4836329">:</span><span class="op" id="4836330">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4836333">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836337">return</span>&nbsp;<span class="ident" id="4836344">n</span><span class="op" id="4836345">,</span>&nbsp;<span class="ident" id="4836347">nil</span><br>
<span class="lineno"></span><span class="op" id="4836351">}</span>
</div>
</body>
</html>
