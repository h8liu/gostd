<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/jpeg</h2>
<ul>
<li><a href="/gostd/image/jpeg/dct_test.go.html">dct_test.go</a></li>
<li><a href="/gostd/image/jpeg/fdct.go.html">fdct.go</a></li>
<li><a href="/gostd/image/jpeg/huffman.go.html">huffman.go</a></li>
<li><a href="/gostd/image/jpeg/idct.go.html">idct.go</a></li>
<li><a href="/gostd/image/jpeg/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/jpeg/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/jpeg/scan.go.html">scan.go</a></li>
<li><a href="/gostd/image/jpeg/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/jpeg/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8135514">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8135569">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8135623">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8135674">package</span>&nbsp;<span class="ident" id="8135682">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8135688">import</span>&nbsp;<span class="op" id="8135695">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8135698">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8135707">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8135714">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8135723">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8135738">&#34;image/png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8135751">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8135764">&#34;math/rand&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8135777">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8135783">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8135793">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8135796">//&nbsp;zigzag&nbsp;maps&nbsp;from&nbsp;the&nbsp;natural&nbsp;ordering&nbsp;to&nbsp;the&nbsp;zig-zag&nbsp;ordering.&nbsp;For&nbsp;example,</span><br>
<span class="lineno">20</span><span class="comment" id="8135875">//&nbsp;zigzag[0*8&nbsp;+&nbsp;3]&nbsp;is&nbsp;the&nbsp;zig-zag&nbsp;sequence&nbsp;number&nbsp;of&nbsp;the&nbsp;element&nbsp;in&nbsp;the&nbsp;fourth</span><br>
<span class="lineno"></span><span class="comment" id="8135954">//&nbsp;column&nbsp;and&nbsp;first&nbsp;row.</span><br>
<span class="lineno"></span><span class="keyword" id="8135979">var</span>&nbsp;<span class="ident" id="8135983">zigzag</span>&nbsp;<span class="op" id="8135990">=</span>&nbsp;<span class="op" id="8135992">[</span><span class="ident" id="8135993">blockSize</span><span class="op" id="8136002">]</span><span class="builtintype" id="8136003">int</span><span class="op" id="8136006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136009">0</span><span class="op" id="8136010">,</span>&nbsp;<span class="num" id="8136012">1</span><span class="op" id="8136013">,</span>&nbsp;<span class="num" id="8136015">5</span><span class="op" id="8136016">,</span>&nbsp;<span class="num" id="8136018">6</span><span class="op" id="8136019">,</span>&nbsp;<span class="num" id="8136021">14</span><span class="op" id="8136023">,</span>&nbsp;<span class="num" id="8136025">15</span><span class="op" id="8136027">,</span>&nbsp;<span class="num" id="8136029">27</span><span class="op" id="8136031">,</span>&nbsp;<span class="num" id="8136033">28</span><span class="op" id="8136035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136038">2</span><span class="op" id="8136039">,</span>&nbsp;<span class="num" id="8136041">4</span><span class="op" id="8136042">,</span>&nbsp;<span class="num" id="8136044">7</span><span class="op" id="8136045">,</span>&nbsp;<span class="num" id="8136047">13</span><span class="op" id="8136049">,</span>&nbsp;<span class="num" id="8136051">16</span><span class="op" id="8136053">,</span>&nbsp;<span class="num" id="8136055">26</span><span class="op" id="8136057">,</span>&nbsp;<span class="num" id="8136059">29</span><span class="op" id="8136061">,</span>&nbsp;<span class="num" id="8136063">42</span><span class="op" id="8136065">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136068">3</span><span class="op" id="8136069">,</span>&nbsp;<span class="num" id="8136071">8</span><span class="op" id="8136072">,</span>&nbsp;<span class="num" id="8136074">12</span><span class="op" id="8136076">,</span>&nbsp;<span class="num" id="8136078">17</span><span class="op" id="8136080">,</span>&nbsp;<span class="num" id="8136082">25</span><span class="op" id="8136084">,</span>&nbsp;<span class="num" id="8136086">30</span><span class="op" id="8136088">,</span>&nbsp;<span class="num" id="8136090">41</span><span class="op" id="8136092">,</span>&nbsp;<span class="num" id="8136094">43</span><span class="op" id="8136096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136099">9</span><span class="op" id="8136100">,</span>&nbsp;<span class="num" id="8136102">11</span><span class="op" id="8136104">,</span>&nbsp;<span class="num" id="8136106">18</span><span class="op" id="8136108">,</span>&nbsp;<span class="num" id="8136110">24</span><span class="op" id="8136112">,</span>&nbsp;<span class="num" id="8136114">31</span><span class="op" id="8136116">,</span>&nbsp;<span class="num" id="8136118">40</span><span class="op" id="8136120">,</span>&nbsp;<span class="num" id="8136122">44</span><span class="op" id="8136124">,</span>&nbsp;<span class="num" id="8136126">53</span><span class="op" id="8136128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136131">10</span><span class="op" id="8136133">,</span>&nbsp;<span class="num" id="8136135">19</span><span class="op" id="8136137">,</span>&nbsp;<span class="num" id="8136139">23</span><span class="op" id="8136141">,</span>&nbsp;<span class="num" id="8136143">32</span><span class="op" id="8136145">,</span>&nbsp;<span class="num" id="8136147">39</span><span class="op" id="8136149">,</span>&nbsp;<span class="num" id="8136151">45</span><span class="op" id="8136153">,</span>&nbsp;<span class="num" id="8136155">52</span><span class="op" id="8136157">,</span>&nbsp;<span class="num" id="8136159">54</span><span class="op" id="8136161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136164">20</span><span class="op" id="8136166">,</span>&nbsp;<span class="num" id="8136168">22</span><span class="op" id="8136170">,</span>&nbsp;<span class="num" id="8136172">33</span><span class="op" id="8136174">,</span>&nbsp;<span class="num" id="8136176">38</span><span class="op" id="8136178">,</span>&nbsp;<span class="num" id="8136180">46</span><span class="op" id="8136182">,</span>&nbsp;<span class="num" id="8136184">51</span><span class="op" id="8136186">,</span>&nbsp;<span class="num" id="8136188">55</span><span class="op" id="8136190">,</span>&nbsp;<span class="num" id="8136192">60</span><span class="op" id="8136194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136197">21</span><span class="op" id="8136199">,</span>&nbsp;<span class="num" id="8136201">34</span><span class="op" id="8136203">,</span>&nbsp;<span class="num" id="8136205">37</span><span class="op" id="8136207">,</span>&nbsp;<span class="num" id="8136209">47</span><span class="op" id="8136211">,</span>&nbsp;<span class="num" id="8136213">50</span><span class="op" id="8136215">,</span>&nbsp;<span class="num" id="8136217">56</span><span class="op" id="8136219">,</span>&nbsp;<span class="num" id="8136221">59</span><span class="op" id="8136223">,</span>&nbsp;<span class="num" id="8136225">61</span><span class="op" id="8136227">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136230">35</span><span class="op" id="8136232">,</span>&nbsp;<span class="num" id="8136234">36</span><span class="op" id="8136236">,</span>&nbsp;<span class="num" id="8136238">48</span><span class="op" id="8136240">,</span>&nbsp;<span class="num" id="8136242">49</span><span class="op" id="8136244">,</span>&nbsp;<span class="num" id="8136246">57</span><span class="op" id="8136248">,</span>&nbsp;<span class="num" id="8136250">58</span><span class="op" id="8136252">,</span>&nbsp;<span class="num" id="8136254">62</span><span class="op" id="8136256">,</span>&nbsp;<span class="num" id="8136258">63</span><span class="op" id="8136260">,</span><br>
<span class="lineno"></span><span class="op" id="8136262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8136265">func</span>&nbsp;<span class="ident" id="8136270">TestZigUnzig</span><span class="op" id="8136282">(</span><span class="ident" id="8136283">t</span>&nbsp;<span class="op" id="8136285">*</span><span class="ident" id="8136286">testing</span><span class="op" id="8136293">.</span><span class="ident" id="8136294">T</span><span class="op" id="8136295">)</span>&nbsp;<span class="op" id="8136297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8136300">for</span>&nbsp;<span class="ident" id="8136304">i</span>&nbsp;<span class="op" id="8136306">:=</span>&nbsp;<span class="num" id="8136309">0</span><span class="op" id="8136310">;</span>&nbsp;<span class="ident" id="8136312">i</span>&nbsp;<span class="op" id="8136314">&lt;</span>&nbsp;<span class="ident" id="8136316">blockSize</span><span class="op" id="8136325">;</span>&nbsp;<span class="ident" id="8136327">i</span><span class="op" id="8136328">++</span>&nbsp;<span class="op" id="8136331">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8136335">if</span>&nbsp;<span class="ident" id="8136338">unzig</span><span class="op" id="8136343">[</span><span class="ident" id="8136344">zigzag</span><span class="op" id="8136350">[</span><span class="ident" id="8136351">i</span><span class="op" id="8136352">]</span><span class="op" id="8136353">]</span>&nbsp;<span class="op" id="8136355">!=</span>&nbsp;<span class="ident" id="8136358">i</span>&nbsp;<span class="op" id="8136360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136365">t</span><span class="op" id="8136366">.</span><span class="ident" id="8136367">Errorf</span><span class="op" id="8136373">(</span><span class="string" id="8136374">&#34;unzig[zigzag[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="8136399">,</span>&nbsp;<span class="ident" id="8136401">i</span><span class="op" id="8136402">,</span>&nbsp;<span class="ident" id="8136404">unzig</span><span class="op" id="8136409">[</span><span class="ident" id="8136410">zigzag</span><span class="op" id="8136416">[</span><span class="ident" id="8136417">i</span><span class="op" id="8136418">]</span><span class="op" id="8136419">]</span><span class="op" id="8136420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8136424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8136428">if</span>&nbsp;<span class="ident" id="8136431">zigzag</span><span class="op" id="8136437">[</span><span class="ident" id="8136438">unzig</span><span class="op" id="8136443">[</span><span class="ident" id="8136444">i</span><span class="op" id="8136445">]</span><span class="op" id="8136446">]</span>&nbsp;<span class="op" id="8136448">!=</span>&nbsp;<span class="ident" id="8136451">i</span>&nbsp;<span class="op" id="8136453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8136458">t</span><span class="op" id="8136459">.</span><span class="ident" id="8136460">Errorf</span><span class="op" id="8136466">(</span><span class="string" id="8136467">&#34;zigzag[unzig[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="8136492">,</span>&nbsp;<span class="ident" id="8136494">i</span><span class="op" id="8136495">,</span>&nbsp;<span class="ident" id="8136497">zigzag</span><span class="op" id="8136503">[</span><span class="ident" id="8136504">unzig</span><span class="op" id="8136509">[</span><span class="ident" id="8136510">i</span><span class="op" id="8136511">]</span><span class="op" id="8136512">]</span><span class="op" id="8136513">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8136517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8136520">}</span><br>
<span class="lineno"></span><span class="op" id="8136522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8136525">//&nbsp;unscaledQuantInNaturalOrder&nbsp;are&nbsp;the&nbsp;unscaled&nbsp;quantization&nbsp;tables&nbsp;in</span><br>
<span class="lineno">45</span><span class="comment" id="8136596">//&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;K.1.</span><br>
<span class="lineno"></span><span class="keyword" id="8136657">var</span>&nbsp;<span class="ident" id="8136661">unscaledQuantInNaturalOrder</span>&nbsp;<span class="op" id="8136689">=</span>&nbsp;<span class="op" id="8136691">[</span><span class="ident" id="8136692">nQuantIndex</span><span class="op" id="8136703">]</span><span class="op" id="8136704">[</span><span class="ident" id="8136705">blockSize</span><span class="op" id="8136714">]</span><span class="builtintype" id="8136715">byte</span><span class="op" id="8136719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8136722">//&nbsp;Luminance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8136737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136741">16</span><span class="op" id="8136743">,</span>&nbsp;<span class="num" id="8136745">11</span><span class="op" id="8136747">,</span>&nbsp;<span class="num" id="8136749">10</span><span class="op" id="8136751">,</span>&nbsp;<span class="num" id="8136753">16</span><span class="op" id="8136755">,</span>&nbsp;<span class="num" id="8136757">24</span><span class="op" id="8136759">,</span>&nbsp;<span class="num" id="8136761">40</span><span class="op" id="8136763">,</span>&nbsp;<span class="num" id="8136765">51</span><span class="op" id="8136767">,</span>&nbsp;<span class="num" id="8136769">61</span><span class="op" id="8136771">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136775">12</span><span class="op" id="8136777">,</span>&nbsp;<span class="num" id="8136779">12</span><span class="op" id="8136781">,</span>&nbsp;<span class="num" id="8136783">14</span><span class="op" id="8136785">,</span>&nbsp;<span class="num" id="8136787">19</span><span class="op" id="8136789">,</span>&nbsp;<span class="num" id="8136791">26</span><span class="op" id="8136793">,</span>&nbsp;<span class="num" id="8136795">58</span><span class="op" id="8136797">,</span>&nbsp;<span class="num" id="8136799">60</span><span class="op" id="8136801">,</span>&nbsp;<span class="num" id="8136803">55</span><span class="op" id="8136805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136809">14</span><span class="op" id="8136811">,</span>&nbsp;<span class="num" id="8136813">13</span><span class="op" id="8136815">,</span>&nbsp;<span class="num" id="8136817">16</span><span class="op" id="8136819">,</span>&nbsp;<span class="num" id="8136821">24</span><span class="op" id="8136823">,</span>&nbsp;<span class="num" id="8136825">40</span><span class="op" id="8136827">,</span>&nbsp;<span class="num" id="8136829">57</span><span class="op" id="8136831">,</span>&nbsp;<span class="num" id="8136833">69</span><span class="op" id="8136835">,</span>&nbsp;<span class="num" id="8136837">56</span><span class="op" id="8136839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136843">14</span><span class="op" id="8136845">,</span>&nbsp;<span class="num" id="8136847">17</span><span class="op" id="8136849">,</span>&nbsp;<span class="num" id="8136851">22</span><span class="op" id="8136853">,</span>&nbsp;<span class="num" id="8136855">29</span><span class="op" id="8136857">,</span>&nbsp;<span class="num" id="8136859">51</span><span class="op" id="8136861">,</span>&nbsp;<span class="num" id="8136863">87</span><span class="op" id="8136865">,</span>&nbsp;<span class="num" id="8136867">80</span><span class="op" id="8136869">,</span>&nbsp;<span class="num" id="8136871">62</span><span class="op" id="8136873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136877">18</span><span class="op" id="8136879">,</span>&nbsp;<span class="num" id="8136881">22</span><span class="op" id="8136883">,</span>&nbsp;<span class="num" id="8136885">37</span><span class="op" id="8136887">,</span>&nbsp;<span class="num" id="8136889">56</span><span class="op" id="8136891">,</span>&nbsp;<span class="num" id="8136893">68</span><span class="op" id="8136895">,</span>&nbsp;<span class="num" id="8136897">109</span><span class="op" id="8136900">,</span>&nbsp;<span class="num" id="8136902">103</span><span class="op" id="8136905">,</span>&nbsp;<span class="num" id="8136907">77</span><span class="op" id="8136909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136913">24</span><span class="op" id="8136915">,</span>&nbsp;<span class="num" id="8136917">35</span><span class="op" id="8136919">,</span>&nbsp;<span class="num" id="8136921">55</span><span class="op" id="8136923">,</span>&nbsp;<span class="num" id="8136925">64</span><span class="op" id="8136927">,</span>&nbsp;<span class="num" id="8136929">81</span><span class="op" id="8136931">,</span>&nbsp;<span class="num" id="8136933">104</span><span class="op" id="8136936">,</span>&nbsp;<span class="num" id="8136938">113</span><span class="op" id="8136941">,</span>&nbsp;<span class="num" id="8136943">92</span><span class="op" id="8136945">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136949">49</span><span class="op" id="8136951">,</span>&nbsp;<span class="num" id="8136953">64</span><span class="op" id="8136955">,</span>&nbsp;<span class="num" id="8136957">78</span><span class="op" id="8136959">,</span>&nbsp;<span class="num" id="8136961">87</span><span class="op" id="8136963">,</span>&nbsp;<span class="num" id="8136965">103</span><span class="op" id="8136968">,</span>&nbsp;<span class="num" id="8136970">121</span><span class="op" id="8136973">,</span>&nbsp;<span class="num" id="8136975">120</span><span class="op" id="8136978">,</span>&nbsp;<span class="num" id="8136980">101</span><span class="op" id="8136983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8136987">72</span><span class="op" id="8136989">,</span>&nbsp;<span class="num" id="8136991">92</span><span class="op" id="8136993">,</span>&nbsp;<span class="num" id="8136995">95</span><span class="op" id="8136997">,</span>&nbsp;<span class="num" id="8136999">98</span><span class="op" id="8137001">,</span>&nbsp;<span class="num" id="8137003">112</span><span class="op" id="8137006">,</span>&nbsp;<span class="num" id="8137008">100</span><span class="op" id="8137011">,</span>&nbsp;<span class="num" id="8137013">103</span><span class="op" id="8137016">,</span>&nbsp;<span class="num" id="8137018">99</span><span class="op" id="8137020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8137023">}</span><span class="op" id="8137024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8137027">//&nbsp;Chrominance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8137044">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8137048">17</span><span class="op" id="8137050">,</span>&nbsp;<span class="num" id="8137052">18</span><span class="op" id="8137054">,</span>&nbsp;<span class="num" id="8137056">24</span><span class="op" id="8137058">,</span>&nbsp;<span class="num" id="8137060">47</span><span class="op" id="8137062">,</span>&nbsp;<span class="num" id="8137064">99</span><span class="op" id="8137066">,</span>&nbsp;<span class="num" id="8137068">99</span><span class="op" id="8137070">,</span>&nbsp;<span class="num" id="8137072">99</span><span class="op" id="8137074">,</span>&nbsp;<span class="num" id="8137076">99</span><span class="op" id="8137078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8137082">18</span><span class="op" id="8137084">,</span>&nbsp;<span class="num" id="8137086">21</span><span class="op" id="8137088">,</span>&nbsp;<span class="num" id="8137090">26</span><span class="op" id="8137092">,</span>&nbsp;<span class="num" id="8137094">66</span><span class="op" id="8137096">,</span>&nbsp;<span class="num" id="8137098">99</span><span class="op" id="8137100">,</span>&nbsp;<span class="num" id="8137102">99</span><span class="op" id="8137104">,</span>&nbsp;<span class="num" id="8137106">99</span><span class="op" id="8137108">,</span>&nbsp;<span class="num" id="8137110">99</span><span class="op" id="8137112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8137116">24</span><span class="op" id="8137118">,</span>&nbsp;<span class="num" id="8137120">26</span><span class="op" id="8137122">,</span>&nbsp;<span class="num" id="8137124">56</span><span class="op" id="8137126">,</span>&nbsp;<span class="num" id="8137128">99</span><span class="op" id="8137130">,</span>&nbsp;<span class="num" id="8137132">99</span><span class="op" id="8137134">,</span>&nbsp;<span class="num" id="8137136">99</span><span class="op" id="8137138">,</span>&nbsp;<span class="num" id="8137140">99</span><span class="op" id="8137142">,</span>&nbsp;<span class="num" id="8137144">99</span><span class="op" id="8137146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8137150">47</span><span class="op" id="8137152">,</span>&nbsp;<span class="num" id="8137154">66</span><span class="op" id="8137156">,</span>&nbsp;<span class="num" id="8137158">99</span><span class="op" id="8137160">,</span>&nbsp;<span class="num" id="8137162">99</span><span class="op" id="8137164">,</span>&nbsp;<span class="num" id="8137166">99</span><span class="op" id="8137168">,</span>&nbsp;<span class="num" id="8137170">99</span><span class="op" id="8137172">,</span>&nbsp;<span class="num" id="8137174">99</span><span class="op" id="8137176">,</span>&nbsp;<span class="num" id="8137178">99</span><span class="op" id="8137180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8137184">99</span><span class="op" id="8137186">,</span>&nbsp;<span class="num" id="8137188">99</span><span class="op" id="8137190">,</span>&nbsp;<span class="num" id="8137192">99</span><span class="op" id="8137194">,</span>&nbsp;<span class="num" id="8137196">99</span><span class="op" id="8137198">,</span>&nbsp;<span class="num" id="8137200">99</span><span class="op" id="8137202">,</span>&nbsp;<span class="num" id="8137204">99</span><span class="op" id="8137206">,</span>&nbsp;<span class="num" id="8137208">99</span><span class="op" id="8137210">,</span>&nbsp;<span class="num" id="8137212">99</span><span class="op" id="8137214">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8137218">99</span><span class="op" id="8137220">,</span>&nbsp;<span class="num" id="8137222">99</span><span class="op" id="8137224">,</span>&nbsp;<span class="num" id="8137226">99</span><span class="op" id="8137228">,</span>&nbsp;<span class="num" id="8137230">99</span><span class="op" id="8137232">,</span>&nbsp;<span class="num" id="8137234">99</span><span class="op" id="8137236">,</span>&nbsp;<span class="num" id="8137238">99</span><span class="op" id="8137240">,</span>&nbsp;<span class="num" id="8137242">99</span><span class="op" id="8137244">,</span>&nbsp;<span class="num" id="8137246">99</span><span class="op" id="8137248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8137252">99</span><span class="op" id="8137254">,</span>&nbsp;<span class="num" id="8137256">99</span><span class="op" id="8137258">,</span>&nbsp;<span class="num" id="8137260">99</span><span class="op" id="8137262">,</span>&nbsp;<span class="num" id="8137264">99</span><span class="op" id="8137266">,</span>&nbsp;<span class="num" id="8137268">99</span><span class="op" id="8137270">,</span>&nbsp;<span class="num" id="8137272">99</span><span class="op" id="8137274">,</span>&nbsp;<span class="num" id="8137276">99</span><span class="op" id="8137278">,</span>&nbsp;<span class="num" id="8137280">99</span><span class="op" id="8137282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8137286">99</span><span class="op" id="8137288">,</span>&nbsp;<span class="num" id="8137290">99</span><span class="op" id="8137292">,</span>&nbsp;<span class="num" id="8137294">99</span><span class="op" id="8137296">,</span>&nbsp;<span class="num" id="8137298">99</span><span class="op" id="8137300">,</span>&nbsp;<span class="num" id="8137302">99</span><span class="op" id="8137304">,</span>&nbsp;<span class="num" id="8137306">99</span><span class="op" id="8137308">,</span>&nbsp;<span class="num" id="8137310">99</span><span class="op" id="8137312">,</span>&nbsp;<span class="num" id="8137314">99</span><span class="op" id="8137316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8137319">}</span><span class="op" id="8137320">,</span><br>
<span class="lineno"></span><span class="op" id="8137322">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="8137325">func</span>&nbsp;<span class="ident" id="8137330">TestUnscaledQuant</span><span class="op" id="8137347">(</span><span class="ident" id="8137348">t</span>&nbsp;<span class="op" id="8137350">*</span><span class="ident" id="8137351">testing</span><span class="op" id="8137358">.</span><span class="ident" id="8137359">T</span><span class="op" id="8137360">)</span>&nbsp;<span class="op" id="8137362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137365">bad</span>&nbsp;<span class="op" id="8137369">:=</span>&nbsp;<span class="builtintype" id="8137372">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8137379">for</span>&nbsp;<span class="ident" id="8137383">i</span>&nbsp;<span class="op" id="8137385">:=</span>&nbsp;<span class="ident" id="8137388">quantIndex</span><span class="op" id="8137398">(</span><span class="num" id="8137399">0</span><span class="op" id="8137400">)</span><span class="op" id="8137401">;</span>&nbsp;<span class="ident" id="8137403">i</span>&nbsp;<span class="op" id="8137405">&lt;</span>&nbsp;<span class="ident" id="8137407">nQuantIndex</span><span class="op" id="8137418">;</span>&nbsp;<span class="ident" id="8137420">i</span><span class="op" id="8137421">++</span>&nbsp;<span class="op" id="8137424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8137428">for</span>&nbsp;<span class="ident" id="8137432">zig</span>&nbsp;<span class="op" id="8137436">:=</span>&nbsp;<span class="num" id="8137439">0</span><span class="op" id="8137440">;</span>&nbsp;<span class="ident" id="8137442">zig</span>&nbsp;<span class="op" id="8137446">&lt;</span>&nbsp;<span class="ident" id="8137448">blockSize</span><span class="op" id="8137457">;</span>&nbsp;<span class="ident" id="8137459">zig</span><span class="op" id="8137462">++</span>&nbsp;<span class="op" id="8137465">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137470">got</span>&nbsp;<span class="op" id="8137474">:=</span>&nbsp;<span class="ident" id="8137477">unscaledQuant</span><span class="op" id="8137490">[</span><span class="ident" id="8137491">i</span><span class="op" id="8137492">]</span><span class="op" id="8137493">[</span><span class="ident" id="8137494">zig</span><span class="op" id="8137497">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137502">want</span>&nbsp;<span class="op" id="8137507">:=</span>&nbsp;<span class="ident" id="8137510">unscaledQuantInNaturalOrder</span><span class="op" id="8137537">[</span><span class="ident" id="8137538">i</span><span class="op" id="8137539">]</span><span class="op" id="8137540">[</span><span class="ident" id="8137541">unzig</span><span class="op" id="8137546">[</span><span class="ident" id="8137547">zig</span><span class="op" id="8137550">]</span><span class="op" id="8137551">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8137556">if</span>&nbsp;<span class="ident" id="8137559">got</span>&nbsp;<span class="op" id="8137563">!=</span>&nbsp;<span class="ident" id="8137566">want</span>&nbsp;<span class="op" id="8137571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137577">t</span><span class="op" id="8137578">.</span><span class="ident" id="8137579">Errorf</span><span class="op" id="8137585">(</span><span class="string" id="8137586">&#34;i=%d,&nbsp;zig=%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8137617">,</span>&nbsp;<span class="ident" id="8137619">i</span><span class="op" id="8137620">,</span>&nbsp;<span class="ident" id="8137622">zig</span><span class="op" id="8137625">,</span>&nbsp;<span class="ident" id="8137627">got</span><span class="op" id="8137630">,</span>&nbsp;<span class="ident" id="8137632">want</span><span class="op" id="8137636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137642">bad</span>&nbsp;<span class="op" id="8137646">=</span>&nbsp;<span class="builtintype" id="8137648">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8137656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8137660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8137663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8137666">if</span>&nbsp;<span class="ident" id="8137669">bad</span>&nbsp;<span class="op" id="8137673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137677">names</span>&nbsp;<span class="op" id="8137683">:=</span>&nbsp;<span class="op" id="8137686">[</span><span class="ident" id="8137687">nQuantIndex</span><span class="op" id="8137698">]</span><span class="builtintype" id="8137699">string</span><span class="op" id="8137705">{</span><span class="string" id="8137706">&#34;Luminance&#34;</span><span class="op" id="8137717">,</span>&nbsp;<span class="string" id="8137719">&#34;Chrominance&#34;</span><span class="op" id="8137732">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137736">buf</span>&nbsp;<span class="op" id="8137740">:=</span>&nbsp;<span class="op" id="8137743">&amp;</span><span class="ident" id="8137744">bytes</span><span class="op" id="8137749">.</span><span class="ident" id="8137750">Buffer</span><span class="op" id="8137756">{</span><span class="op" id="8137757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8137761">for</span>&nbsp;<span class="ident" id="8137765">i</span><span class="op" id="8137766">,</span>&nbsp;<span class="ident" id="8137768">name</span>&nbsp;<span class="op" id="8137773">:=</span>&nbsp;<span class="keyword" id="8137776">range</span>&nbsp;<span class="ident" id="8137782">names</span>&nbsp;<span class="op" id="8137788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137793">fmt</span><span class="op" id="8137796">.</span><span class="ident" id="8137797">Fprintf</span><span class="op" id="8137804">(</span><span class="ident" id="8137805">buf</span><span class="op" id="8137808">,</span>&nbsp;<span class="string" id="8137810">&#34;//&nbsp;%s.\n{\n&#34;</span><span class="op" id="8137823">,</span>&nbsp;<span class="ident" id="8137825">name</span><span class="op" id="8137829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8137834">for</span>&nbsp;<span class="ident" id="8137838">zig</span>&nbsp;<span class="op" id="8137842">:=</span>&nbsp;<span class="num" id="8137845">0</span><span class="op" id="8137846">;</span>&nbsp;<span class="ident" id="8137848">zig</span>&nbsp;<span class="op" id="8137852">&lt;</span>&nbsp;<span class="ident" id="8137854">blockSize</span><span class="op" id="8137863">;</span>&nbsp;<span class="ident" id="8137865">zig</span><span class="op" id="8137868">++</span>&nbsp;<span class="op" id="8137871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137877">fmt</span><span class="op" id="8137880">.</span><span class="ident" id="8137881">Fprintf</span><span class="op" id="8137888">(</span><span class="ident" id="8137889">buf</span><span class="op" id="8137892">,</span>&nbsp;<span class="string" id="8137894">&#34;%d,&nbsp;&#34;</span><span class="op" id="8137900">,</span>&nbsp;<span class="ident" id="8137902">unscaledQuantInNaturalOrder</span><span class="op" id="8137929">[</span><span class="ident" id="8137930">i</span><span class="op" id="8137931">]</span><span class="op" id="8137932">[</span><span class="ident" id="8137933">unzig</span><span class="op" id="8137938">[</span><span class="ident" id="8137939">zig</span><span class="op" id="8137942">]</span><span class="op" id="8137943">]</span><span class="op" id="8137944">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8137950">if</span>&nbsp;<span class="ident" id="8137953">zig</span><span class="op" id="8137956">%</span><span class="num" id="8137957">8</span>&nbsp;<span class="op" id="8137959">==</span>&nbsp;<span class="num" id="8137962">7</span>&nbsp;<span class="op" id="8137964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8137971">buf</span><span class="op" id="8137974">.</span><span class="ident" id="8137975">WriteString</span><span class="op" id="8137986">(</span><span class="string" id="8137987">&#34;\n&#34;</span><span class="op" id="8137991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8137997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138007">buf</span><span class="op" id="8138010">.</span><span class="ident" id="8138011">WriteString</span><span class="op" id="8138022">(</span><span class="string" id="8138023">&#34;},\n&#34;</span><span class="op" id="8138029">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138037">t</span><span class="op" id="8138038">.</span><span class="ident" id="8138039">Logf</span><span class="op" id="8138043">(</span><span class="string" id="8138044">&#34;expected&nbsp;unscaledQuant&nbsp;values:\n%s&#34;</span><span class="op" id="8138080">,</span>&nbsp;<span class="ident" id="8138082">buf</span><span class="op" id="8138085">.</span><span class="ident" id="8138086">String</span><span class="op" id="8138092">(</span><span class="op" id="8138093">)</span><span class="op" id="8138094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138097">}</span><br>
<span class="lineno"></span><span class="op" id="8138099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="8138102">var</span>&nbsp;<span class="ident" id="8138106">testCase</span>&nbsp;<span class="op" id="8138115">=</span>&nbsp;<span class="op" id="8138117">[</span><span class="op" id="8138118">]</span><span class="keyword" id="8138119">struct</span>&nbsp;<span class="op" id="8138126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138129">filename</span>&nbsp;&nbsp;<span class="builtintype" id="8138139">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138147">quality</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8138157">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138162">tolerance</span>&nbsp;<span class="ident" id="8138172">int64</span><br>
<span class="lineno"></span><span class="op" id="8138178">}</span><span class="op" id="8138179">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138182">{</span><span class="string" id="8138183">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8138210">,</span>&nbsp;<span class="num" id="8138212">1</span><span class="op" id="8138213">,</span>&nbsp;<span class="num" id="8138215">24</span>&nbsp;<span class="op" id="8138218">&lt;&lt;</span>&nbsp;<span class="num" id="8138221">8</span><span class="op" id="8138222">}</span><span class="op" id="8138223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138226">{</span><span class="string" id="8138227">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8138254">,</span>&nbsp;<span class="num" id="8138256">20</span><span class="op" id="8138258">,</span>&nbsp;<span class="num" id="8138260">12</span>&nbsp;<span class="op" id="8138263">&lt;&lt;</span>&nbsp;<span class="num" id="8138266">8</span><span class="op" id="8138267">}</span><span class="op" id="8138268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138271">{</span><span class="string" id="8138272">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8138299">,</span>&nbsp;<span class="num" id="8138301">60</span><span class="op" id="8138303">,</span>&nbsp;<span class="num" id="8138305">8</span>&nbsp;<span class="op" id="8138307">&lt;&lt;</span>&nbsp;<span class="num" id="8138310">8</span><span class="op" id="8138311">}</span><span class="op" id="8138312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138315">{</span><span class="string" id="8138316">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8138343">,</span>&nbsp;<span class="num" id="8138345">80</span><span class="op" id="8138347">,</span>&nbsp;<span class="num" id="8138349">6</span>&nbsp;<span class="op" id="8138351">&lt;&lt;</span>&nbsp;<span class="num" id="8138354">8</span><span class="op" id="8138355">}</span><span class="op" id="8138356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138359">{</span><span class="string" id="8138360">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8138387">,</span>&nbsp;<span class="num" id="8138389">90</span><span class="op" id="8138391">,</span>&nbsp;<span class="num" id="8138393">4</span>&nbsp;<span class="op" id="8138395">&lt;&lt;</span>&nbsp;<span class="num" id="8138398">8</span><span class="op" id="8138399">}</span><span class="op" id="8138400">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138403">{</span><span class="string" id="8138404">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8138431">,</span>&nbsp;<span class="num" id="8138433">100</span><span class="op" id="8138436">,</span>&nbsp;<span class="num" id="8138438">2</span>&nbsp;<span class="op" id="8138440">&lt;&lt;</span>&nbsp;<span class="num" id="8138443">8</span><span class="op" id="8138444">}</span><span class="op" id="8138445">,</span><br>
<span class="lineno"></span><span class="op" id="8138447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8138450">func</span>&nbsp;<span class="ident" id="8138455">delta</span><span class="op" id="8138460">(</span><span class="ident" id="8138461">u0</span><span class="op" id="8138463">,</span>&nbsp;<span class="ident" id="8138465">u1</span>&nbsp;<span class="builtintype" id="8138468">uint32</span><span class="op" id="8138474">)</span>&nbsp;<span class="ident" id="8138476">int64</span>&nbsp;<span class="op" id="8138482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138485">d</span>&nbsp;<span class="op" id="8138487">:=</span>&nbsp;<span class="ident" id="8138490">int64</span><span class="op" id="8138495">(</span><span class="ident" id="8138496">u0</span><span class="op" id="8138498">)</span>&nbsp;<span class="op" id="8138500">-</span>&nbsp;<span class="ident" id="8138502">int64</span><span class="op" id="8138507">(</span><span class="ident" id="8138508">u1</span><span class="op" id="8138510">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138513">if</span>&nbsp;<span class="ident" id="8138516">d</span>&nbsp;<span class="op" id="8138518">&lt;</span>&nbsp;<span class="num" id="8138520">0</span>&nbsp;<span class="op" id="8138522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138526">return</span>&nbsp;<span class="op" id="8138533">-</span><span class="ident" id="8138534">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138540">return</span>&nbsp;<span class="ident" id="8138547">d</span><br>
<span class="lineno"></span><span class="op" id="8138549">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="8138552">func</span>&nbsp;<span class="ident" id="8138557">readPng</span><span class="op" id="8138564">(</span><span class="ident" id="8138565">filename</span>&nbsp;<span class="builtintype" id="8138574">string</span><span class="op" id="8138580">)</span>&nbsp;<span class="op" id="8138582">(</span><span class="ident" id="8138583">image</span><span class="op" id="8138588">.</span><span class="ident" id="8138589">Image</span><span class="op" id="8138594">,</span>&nbsp;<span class="builtintype" id="8138596">error</span><span class="op" id="8138601">)</span>&nbsp;<span class="op" id="8138603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138606">f</span><span class="op" id="8138607">,</span>&nbsp;<span class="ident" id="8138609">err</span>&nbsp;<span class="op" id="8138613">:=</span>&nbsp;<span class="ident" id="8138616">os</span><span class="op" id="8138618">.</span><span class="ident" id="8138619">Open</span><span class="op" id="8138623">(</span><span class="ident" id="8138624">filename</span><span class="op" id="8138632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138635">if</span>&nbsp;<span class="ident" id="8138638">err</span>&nbsp;<span class="op" id="8138642">!=</span>&nbsp;<span class="ident" id="8138645">nil</span>&nbsp;<span class="op" id="8138649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138653">return</span>&nbsp;<span class="ident" id="8138660">nil</span><span class="op" id="8138663">,</span>&nbsp;<span class="ident" id="8138665">err</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138673">defer</span>&nbsp;<span class="ident" id="8138679">f</span><span class="op" id="8138680">.</span><span class="ident" id="8138681">Close</span><span class="op" id="8138686">(</span><span class="op" id="8138687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138690">return</span>&nbsp;<span class="ident" id="8138697">png</span><span class="op" id="8138700">.</span><span class="ident" id="8138701">Decode</span><span class="op" id="8138707">(</span><span class="ident" id="8138708">f</span><span class="op" id="8138709">)</span><br>
<span class="lineno"></span><span class="op" id="8138711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="8138714">func</span>&nbsp;<span class="ident" id="8138719">TestWriter</span><span class="op" id="8138729">(</span><span class="ident" id="8138730">t</span>&nbsp;<span class="op" id="8138732">*</span><span class="ident" id="8138733">testing</span><span class="op" id="8138740">.</span><span class="ident" id="8138741">T</span><span class="op" id="8138742">)</span>&nbsp;<span class="op" id="8138744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138747">for</span>&nbsp;<span class="ident" id="8138751">_</span><span class="op" id="8138752">,</span>&nbsp;<span class="ident" id="8138754">tc</span>&nbsp;<span class="op" id="8138757">:=</span>&nbsp;<span class="keyword" id="8138760">range</span>&nbsp;<span class="ident" id="8138766">testCase</span>&nbsp;<span class="op" id="8138775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8138779">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138800">m0</span><span class="op" id="8138802">,</span>&nbsp;<span class="ident" id="8138804">err</span>&nbsp;<span class="op" id="8138808">:=</span>&nbsp;<span class="ident" id="8138811">readPng</span><span class="op" id="8138818">(</span><span class="ident" id="8138819">tc</span><span class="op" id="8138821">.</span><span class="ident" id="8138822">filename</span><span class="op" id="8138830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138834">if</span>&nbsp;<span class="ident" id="8138837">err</span>&nbsp;<span class="op" id="8138841">!=</span>&nbsp;<span class="ident" id="8138844">nil</span>&nbsp;<span class="op" id="8138848">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138853">t</span><span class="op" id="8138854">.</span><span class="ident" id="8138855">Error</span><span class="op" id="8138860">(</span><span class="ident" id="8138861">tc</span><span class="op" id="8138863">.</span><span class="ident" id="8138864">filename</span><span class="op" id="8138872">,</span>&nbsp;<span class="ident" id="8138874">err</span><span class="op" id="8138877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138882">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8138893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8138897">//&nbsp;Encode&nbsp;that&nbsp;image&nbsp;as&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8138929">var</span>&nbsp;<span class="ident" id="8138933">buf</span>&nbsp;<span class="ident" id="8138937">bytes</span><span class="op" id="8138942">.</span><span class="ident" id="8138943">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8138952">err</span>&nbsp;<span class="op" id="8138956">=</span>&nbsp;<span class="ident" id="8138958">Encode</span><span class="op" id="8138964">(</span><span class="op" id="8138965">&amp;</span><span class="ident" id="8138966">buf</span><span class="op" id="8138969">,</span>&nbsp;<span class="ident" id="8138971">m0</span><span class="op" id="8138973">,</span>&nbsp;<span class="op" id="8138975">&amp;</span><span class="ident" id="8138976">Options</span><span class="op" id="8138983">{</span><span class="ident" id="8138984">Quality</span><span class="op" id="8138991">:</span>&nbsp;<span class="ident" id="8138993">tc</span><span class="op" id="8138995">.</span><span class="ident" id="8138996">quality</span><span class="op" id="8139003">}</span><span class="op" id="8139004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139008">if</span>&nbsp;<span class="ident" id="8139011">err</span>&nbsp;<span class="op" id="8139015">!=</span>&nbsp;<span class="ident" id="8139018">nil</span>&nbsp;<span class="op" id="8139022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139027">t</span><span class="op" id="8139028">.</span><span class="ident" id="8139029">Error</span><span class="op" id="8139034">(</span><span class="ident" id="8139035">tc</span><span class="op" id="8139037">.</span><span class="ident" id="8139038">filename</span><span class="op" id="8139046">,</span>&nbsp;<span class="ident" id="8139048">err</span><span class="op" id="8139051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139056">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139067">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8139071">//&nbsp;Decode&nbsp;that&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139094">m1</span><span class="op" id="8139096">,</span>&nbsp;<span class="ident" id="8139098">err</span>&nbsp;<span class="op" id="8139102">:=</span>&nbsp;<span class="ident" id="8139105">Decode</span><span class="op" id="8139111">(</span><span class="op" id="8139112">&amp;</span><span class="ident" id="8139113">buf</span><span class="op" id="8139116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139120">if</span>&nbsp;<span class="ident" id="8139123">err</span>&nbsp;<span class="op" id="8139127">!=</span>&nbsp;<span class="ident" id="8139130">nil</span>&nbsp;<span class="op" id="8139134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139139">t</span><span class="op" id="8139140">.</span><span class="ident" id="8139141">Error</span><span class="op" id="8139146">(</span><span class="ident" id="8139147">tc</span><span class="op" id="8139149">.</span><span class="ident" id="8139150">filename</span><span class="op" id="8139158">,</span>&nbsp;<span class="ident" id="8139160">err</span><span class="op" id="8139163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139168">continue</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139183">if</span>&nbsp;<span class="ident" id="8139186">m0</span><span class="op" id="8139188">.</span><span class="ident" id="8139189">Bounds</span><span class="op" id="8139195">(</span><span class="op" id="8139196">)</span>&nbsp;<span class="op" id="8139198">!=</span>&nbsp;<span class="ident" id="8139201">m1</span><span class="op" id="8139203">.</span><span class="ident" id="8139204">Bounds</span><span class="op" id="8139210">(</span><span class="op" id="8139211">)</span>&nbsp;<span class="op" id="8139213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139218">t</span><span class="op" id="8139219">.</span><span class="ident" id="8139220">Errorf</span><span class="op" id="8139226">(</span><span class="string" id="8139227">&#34;%s,&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="8139257">,</span>&nbsp;<span class="ident" id="8139259">tc</span><span class="op" id="8139261">.</span><span class="ident" id="8139262">filename</span><span class="op" id="8139270">,</span>&nbsp;<span class="ident" id="8139272">m0</span><span class="op" id="8139274">.</span><span class="ident" id="8139275">Bounds</span><span class="op" id="8139281">(</span><span class="op" id="8139282">)</span><span class="op" id="8139283">,</span>&nbsp;<span class="ident" id="8139285">m1</span><span class="op" id="8139287">.</span><span class="ident" id="8139288">Bounds</span><span class="op" id="8139294">(</span><span class="op" id="8139295">)</span><span class="op" id="8139296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139301">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139312">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8139316">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139371">if</span>&nbsp;<span class="ident" id="8139374">averageDelta</span><span class="op" id="8139386">(</span><span class="ident" id="8139387">m0</span><span class="op" id="8139389">,</span>&nbsp;<span class="ident" id="8139391">m1</span><span class="op" id="8139393">)</span>&nbsp;<span class="op" id="8139395">&gt;</span>&nbsp;<span class="ident" id="8139397">tc</span><span class="op" id="8139399">.</span><span class="ident" id="8139400">tolerance</span>&nbsp;<span class="op" id="8139410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139415">t</span><span class="op" id="8139416">.</span><span class="ident" id="8139417">Errorf</span><span class="op" id="8139423">(</span><span class="string" id="8139424">&#34;%s,&nbsp;quality=%d:&nbsp;average&nbsp;delta&nbsp;is&nbsp;too&nbsp;high&#34;</span><span class="op" id="8139467">,</span>&nbsp;<span class="ident" id="8139469">tc</span><span class="op" id="8139471">.</span><span class="ident" id="8139472">filename</span><span class="op" id="8139480">,</span>&nbsp;<span class="ident" id="8139482">tc</span><span class="op" id="8139484">.</span><span class="ident" id="8139485">quality</span><span class="op" id="8139492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139497">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139508">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139511">}</span><br>
<span class="lineno"></span><span class="op" id="8139513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8139516">//&nbsp;TestWriteGrayscale&nbsp;tests&nbsp;that&nbsp;a&nbsp;grayscale&nbsp;images&nbsp;survives&nbsp;a&nbsp;round-trip</span><br>
<span class="lineno"></span><span class="comment" id="8139590">//&nbsp;through&nbsp;encode/decode&nbsp;cycle.</span><br>
<span class="lineno">165</span><span class="keyword" id="8139622">func</span>&nbsp;<span class="ident" id="8139627">TestWriteGrayscale</span><span class="op" id="8139645">(</span><span class="ident" id="8139646">t</span>&nbsp;<span class="op" id="8139648">*</span><span class="ident" id="8139649">testing</span><span class="op" id="8139656">.</span><span class="ident" id="8139657">T</span><span class="op" id="8139658">)</span>&nbsp;<span class="op" id="8139660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139663">m0</span>&nbsp;<span class="op" id="8139666">:=</span>&nbsp;<span class="ident" id="8139669">image</span><span class="op" id="8139674">.</span><span class="ident" id="8139675">NewGray</span><span class="op" id="8139682">(</span><span class="ident" id="8139683">image</span><span class="op" id="8139688">.</span><span class="ident" id="8139689">Rect</span><span class="op" id="8139693">(</span><span class="num" id="8139694">0</span><span class="op" id="8139695">,</span>&nbsp;<span class="num" id="8139697">0</span><span class="op" id="8139698">,</span>&nbsp;<span class="num" id="8139700">32</span><span class="op" id="8139702">,</span>&nbsp;<span class="num" id="8139704">32</span><span class="op" id="8139706">)</span><span class="op" id="8139707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139710">for</span>&nbsp;<span class="ident" id="8139714">i</span>&nbsp;<span class="op" id="8139716">:=</span>&nbsp;<span class="keyword" id="8139719">range</span>&nbsp;<span class="ident" id="8139725">m0</span><span class="op" id="8139727">.</span><span class="ident" id="8139728">Pix</span>&nbsp;<span class="op" id="8139732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139736">m0</span><span class="op" id="8139738">.</span><span class="ident" id="8139739">Pix</span><span class="op" id="8139742">[</span><span class="ident" id="8139743">i</span><span class="op" id="8139744">]</span>&nbsp;<span class="op" id="8139746">=</span>&nbsp;<span class="builtintype" id="8139748">uint8</span><span class="op" id="8139753">(</span><span class="ident" id="8139754">i</span><span class="op" id="8139755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139758">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139761">var</span>&nbsp;<span class="ident" id="8139765">buf</span>&nbsp;<span class="ident" id="8139769">bytes</span><span class="op" id="8139774">.</span><span class="ident" id="8139775">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139783">if</span>&nbsp;<span class="ident" id="8139786">err</span>&nbsp;<span class="op" id="8139790">:=</span>&nbsp;<span class="ident" id="8139793">Encode</span><span class="op" id="8139799">(</span><span class="op" id="8139800">&amp;</span><span class="ident" id="8139801">buf</span><span class="op" id="8139804">,</span>&nbsp;<span class="ident" id="8139806">m0</span><span class="op" id="8139808">,</span>&nbsp;<span class="ident" id="8139810">nil</span><span class="op" id="8139813">)</span><span class="op" id="8139814">;</span>&nbsp;<span class="ident" id="8139816">err</span>&nbsp;<span class="op" id="8139820">!=</span>&nbsp;<span class="ident" id="8139823">nil</span>&nbsp;<span class="op" id="8139827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139831">t</span><span class="op" id="8139832">.</span><span class="ident" id="8139833">Fatal</span><span class="op" id="8139838">(</span><span class="ident" id="8139839">err</span><span class="op" id="8139842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139848">m1</span><span class="op" id="8139850">,</span>&nbsp;<span class="ident" id="8139852">err</span>&nbsp;<span class="op" id="8139856">:=</span>&nbsp;<span class="ident" id="8139859">Decode</span><span class="op" id="8139865">(</span><span class="op" id="8139866">&amp;</span><span class="ident" id="8139867">buf</span><span class="op" id="8139870">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139873">if</span>&nbsp;<span class="ident" id="8139876">err</span>&nbsp;<span class="op" id="8139880">!=</span>&nbsp;<span class="ident" id="8139883">nil</span>&nbsp;<span class="op" id="8139887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139891">t</span><span class="op" id="8139892">.</span><span class="ident" id="8139893">Fatal</span><span class="op" id="8139898">(</span><span class="ident" id="8139899">err</span><span class="op" id="8139902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8139905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8139908">if</span>&nbsp;<span class="ident" id="8139911">m0</span><span class="op" id="8139913">.</span><span class="ident" id="8139914">Bounds</span><span class="op" id="8139920">(</span><span class="op" id="8139921">)</span>&nbsp;<span class="op" id="8139923">!=</span>&nbsp;<span class="ident" id="8139926">m1</span><span class="op" id="8139928">.</span><span class="ident" id="8139929">Bounds</span><span class="op" id="8139935">(</span><span class="op" id="8139936">)</span>&nbsp;<span class="op" id="8139938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8139942">t</span><span class="op" id="8139943">.</span><span class="ident" id="8139944">Fatalf</span><span class="op" id="8139950">(</span><span class="string" id="8139951">&#34;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="8139977">,</span>&nbsp;<span class="ident" id="8139979">m0</span><span class="op" id="8139981">.</span><span class="ident" id="8139982">Bounds</span><span class="op" id="8139988">(</span><span class="op" id="8139989">)</span><span class="op" id="8139990">,</span>&nbsp;<span class="ident" id="8139992">m1</span><span class="op" id="8139994">.</span><span class="ident" id="8139995">Bounds</span><span class="op" id="8140001">(</span><span class="op" id="8140002">)</span><span class="op" id="8140003">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140009">if</span>&nbsp;<span class="ident" id="8140012">_</span><span class="op" id="8140013">,</span>&nbsp;<span class="ident" id="8140015">ok</span>&nbsp;<span class="op" id="8140018">:=</span>&nbsp;<span class="ident" id="8140021">m1</span><span class="op" id="8140023">.</span><span class="op" id="8140024">(</span><span class="op" id="8140025">*</span><span class="ident" id="8140026">image</span><span class="op" id="8140031">.</span><span class="ident" id="8140032">Gray</span><span class="op" id="8140036">)</span><span class="op" id="8140037">;</span>&nbsp;<span class="op" id="8140039">!</span><span class="ident" id="8140040">ok</span>&nbsp;<span class="op" id="8140043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140047">t</span><span class="op" id="8140048">.</span><span class="ident" id="8140049">Errorf</span><span class="op" id="8140055">(</span><span class="string" id="8140056">&#34;got&nbsp;%T,&nbsp;want&nbsp;*image.Gray&#34;</span><span class="op" id="8140082">,</span>&nbsp;<span class="ident" id="8140084">m1</span><span class="op" id="8140086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8140092">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140146">want</span>&nbsp;<span class="op" id="8140151">:=</span>&nbsp;<span class="ident" id="8140154">int64</span><span class="op" id="8140159">(</span><span class="num" id="8140160">2</span>&nbsp;<span class="op" id="8140162">&lt;&lt;</span>&nbsp;<span class="num" id="8140165">8</span><span class="op" id="8140166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140169">if</span>&nbsp;<span class="ident" id="8140172">got</span>&nbsp;<span class="op" id="8140176">:=</span>&nbsp;<span class="ident" id="8140179">averageDelta</span><span class="op" id="8140191">(</span><span class="ident" id="8140192">m0</span><span class="op" id="8140194">,</span>&nbsp;<span class="ident" id="8140196">m1</span><span class="op" id="8140198">)</span><span class="op" id="8140199">;</span>&nbsp;<span class="ident" id="8140201">got</span>&nbsp;<span class="op" id="8140205">&gt;</span>&nbsp;<span class="ident" id="8140207">want</span>&nbsp;<span class="op" id="8140212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140216">t</span><span class="op" id="8140217">.</span><span class="ident" id="8140218">Errorf</span><span class="op" id="8140224">(</span><span class="string" id="8140225">&#34;average&nbsp;delta&nbsp;too&nbsp;high;&nbsp;got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&#34;</span><span class="op" id="8140269">,</span>&nbsp;<span class="ident" id="8140271">got</span><span class="op" id="8140274">,</span>&nbsp;<span class="ident" id="8140276">want</span><span class="op" id="8140280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140283">}</span><br>
<span class="lineno"></span><span class="op" id="8140285">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="8140288">//&nbsp;averageDelta&nbsp;returns&nbsp;the&nbsp;average&nbsp;delta&nbsp;in&nbsp;RGB&nbsp;space.&nbsp;The&nbsp;two&nbsp;images&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="8140364">//&nbsp;have&nbsp;the&nbsp;same&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword" id="8140389">func</span>&nbsp;<span class="ident" id="8140394">averageDelta</span><span class="op" id="8140406">(</span><span class="ident" id="8140407">m0</span><span class="op" id="8140409">,</span>&nbsp;<span class="ident" id="8140411">m1</span>&nbsp;<span class="ident" id="8140414">image</span><span class="op" id="8140419">.</span><span class="ident" id="8140420">Image</span><span class="op" id="8140425">)</span>&nbsp;<span class="ident" id="8140427">int64</span>&nbsp;<span class="op" id="8140433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140436">b</span>&nbsp;<span class="op" id="8140438">:=</span>&nbsp;<span class="ident" id="8140441">m0</span><span class="op" id="8140443">.</span><span class="ident" id="8140444">Bounds</span><span class="op" id="8140450">(</span><span class="op" id="8140451">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140454">var</span>&nbsp;<span class="ident" id="8140458">sum</span><span class="op" id="8140461">,</span>&nbsp;<span class="ident" id="8140463">n</span>&nbsp;<span class="ident" id="8140465">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140472">for</span>&nbsp;<span class="ident" id="8140476">y</span>&nbsp;<span class="op" id="8140478">:=</span>&nbsp;<span class="ident" id="8140481">b</span><span class="op" id="8140482">.</span><span class="ident" id="8140483">Min</span><span class="op" id="8140486">.</span><span class="ident" id="8140487">Y</span><span class="op" id="8140488">;</span>&nbsp;<span class="ident" id="8140490">y</span>&nbsp;<span class="op" id="8140492">&lt;</span>&nbsp;<span class="ident" id="8140494">b</span><span class="op" id="8140495">.</span><span class="ident" id="8140496">Max</span><span class="op" id="8140499">.</span><span class="ident" id="8140500">Y</span><span class="op" id="8140501">;</span>&nbsp;<span class="ident" id="8140503">y</span><span class="op" id="8140504">++</span>&nbsp;<span class="op" id="8140507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140511">for</span>&nbsp;<span class="ident" id="8140515">x</span>&nbsp;<span class="op" id="8140517">:=</span>&nbsp;<span class="ident" id="8140520">b</span><span class="op" id="8140521">.</span><span class="ident" id="8140522">Min</span><span class="op" id="8140525">.</span><span class="ident" id="8140526">X</span><span class="op" id="8140527">;</span>&nbsp;<span class="ident" id="8140529">x</span>&nbsp;<span class="op" id="8140531">&lt;</span>&nbsp;<span class="ident" id="8140533">b</span><span class="op" id="8140534">.</span><span class="ident" id="8140535">Max</span><span class="op" id="8140538">.</span><span class="ident" id="8140539">X</span><span class="op" id="8140540">;</span>&nbsp;<span class="ident" id="8140542">x</span><span class="op" id="8140543">++</span>&nbsp;<span class="op" id="8140546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140551">c0</span>&nbsp;<span class="op" id="8140554">:=</span>&nbsp;<span class="ident" id="8140557">m0</span><span class="op" id="8140559">.</span><span class="ident" id="8140560">At</span><span class="op" id="8140562">(</span><span class="ident" id="8140563">x</span><span class="op" id="8140564">,</span>&nbsp;<span class="ident" id="8140566">y</span><span class="op" id="8140567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140572">c1</span>&nbsp;<span class="op" id="8140575">:=</span>&nbsp;<span class="ident" id="8140578">m1</span><span class="op" id="8140580">.</span><span class="ident" id="8140581">At</span><span class="op" id="8140583">(</span><span class="ident" id="8140584">x</span><span class="op" id="8140585">,</span>&nbsp;<span class="ident" id="8140587">y</span><span class="op" id="8140588">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140593">r0</span><span class="op" id="8140595">,</span>&nbsp;<span class="ident" id="8140597">g0</span><span class="op" id="8140599">,</span>&nbsp;<span class="ident" id="8140601">b0</span><span class="op" id="8140603">,</span>&nbsp;<span class="ident" id="8140605">_</span>&nbsp;<span class="op" id="8140607">:=</span>&nbsp;<span class="ident" id="8140610">c0</span><span class="op" id="8140612">.</span><span class="ident" id="8140613">RGBA</span><span class="op" id="8140617">(</span><span class="op" id="8140618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140623">r1</span><span class="op" id="8140625">,</span>&nbsp;<span class="ident" id="8140627">g1</span><span class="op" id="8140629">,</span>&nbsp;<span class="ident" id="8140631">b1</span><span class="op" id="8140633">,</span>&nbsp;<span class="ident" id="8140635">_</span>&nbsp;<span class="op" id="8140637">:=</span>&nbsp;<span class="ident" id="8140640">c1</span><span class="op" id="8140642">.</span><span class="ident" id="8140643">RGBA</span><span class="op" id="8140647">(</span><span class="op" id="8140648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140653">sum</span>&nbsp;<span class="op" id="8140657">+=</span>&nbsp;<span class="ident" id="8140660">delta</span><span class="op" id="8140665">(</span><span class="ident" id="8140666">r0</span><span class="op" id="8140668">,</span>&nbsp;<span class="ident" id="8140670">r1</span><span class="op" id="8140672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140677">sum</span>&nbsp;<span class="op" id="8140681">+=</span>&nbsp;<span class="ident" id="8140684">delta</span><span class="op" id="8140689">(</span><span class="ident" id="8140690">g0</span><span class="op" id="8140692">,</span>&nbsp;<span class="ident" id="8140694">g1</span><span class="op" id="8140696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140701">sum</span>&nbsp;<span class="op" id="8140705">+=</span>&nbsp;<span class="ident" id="8140708">delta</span><span class="op" id="8140713">(</span><span class="ident" id="8140714">b0</span><span class="op" id="8140716">,</span>&nbsp;<span class="ident" id="8140718">b1</span><span class="op" id="8140720">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140725">n</span>&nbsp;<span class="op" id="8140727">+=</span>&nbsp;<span class="num" id="8140730">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8140737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140740">return</span>&nbsp;<span class="ident" id="8140747">sum</span>&nbsp;<span class="op" id="8140751">/</span>&nbsp;<span class="ident" id="8140753">n</span><br>
<span class="lineno"></span><span class="op" id="8140755">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="8140758">func</span>&nbsp;<span class="ident" id="8140763">BenchmarkEncode</span><span class="op" id="8140778">(</span><span class="ident" id="8140779">b</span>&nbsp;<span class="op" id="8140781">*</span><span class="ident" id="8140782">testing</span><span class="op" id="8140789">.</span><span class="ident" id="8140790">B</span><span class="op" id="8140791">)</span>&nbsp;<span class="op" id="8140793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140796">b</span><span class="op" id="8140797">.</span><span class="ident" id="8140798">StopTimer</span><span class="op" id="8140807">(</span><span class="op" id="8140808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140811">img</span>&nbsp;<span class="op" id="8140815">:=</span>&nbsp;<span class="ident" id="8140818">image</span><span class="op" id="8140823">.</span><span class="ident" id="8140824">NewRGBA</span><span class="op" id="8140831">(</span><span class="ident" id="8140832">image</span><span class="op" id="8140837">.</span><span class="ident" id="8140838">Rect</span><span class="op" id="8140842">(</span><span class="num" id="8140843">0</span><span class="op" id="8140844">,</span>&nbsp;<span class="num" id="8140846">0</span><span class="op" id="8140847">,</span>&nbsp;<span class="num" id="8140849">640</span><span class="op" id="8140852">,</span>&nbsp;<span class="num" id="8140854">480</span><span class="op" id="8140857">)</span><span class="op" id="8140858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140861">bo</span>&nbsp;<span class="op" id="8140864">:=</span>&nbsp;<span class="ident" id="8140867">img</span><span class="op" id="8140870">.</span><span class="ident" id="8140871">Bounds</span><span class="op" id="8140877">(</span><span class="op" id="8140878">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8140881">rnd</span>&nbsp;<span class="op" id="8140885">:=</span>&nbsp;<span class="ident" id="8140888">rand</span><span class="op" id="8140892">.</span><span class="ident" id="8140893">New</span><span class="op" id="8140896">(</span><span class="ident" id="8140897">rand</span><span class="op" id="8140901">.</span><span class="ident" id="8140902">NewSource</span><span class="op" id="8140911">(</span><span class="num" id="8140912">123</span><span class="op" id="8140915">)</span><span class="op" id="8140916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140919">for</span>&nbsp;<span class="ident" id="8140923">y</span>&nbsp;<span class="op" id="8140925">:=</span>&nbsp;<span class="ident" id="8140928">bo</span><span class="op" id="8140930">.</span><span class="ident" id="8140931">Min</span><span class="op" id="8140934">.</span><span class="ident" id="8140935">Y</span><span class="op" id="8140936">;</span>&nbsp;<span class="ident" id="8140938">y</span>&nbsp;<span class="op" id="8140940">&lt;</span>&nbsp;<span class="ident" id="8140942">bo</span><span class="op" id="8140944">.</span><span class="ident" id="8140945">Max</span><span class="op" id="8140948">.</span><span class="ident" id="8140949">Y</span><span class="op" id="8140950">;</span>&nbsp;<span class="ident" id="8140952">y</span><span class="op" id="8140953">++</span>&nbsp;<span class="op" id="8140956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8140960">for</span>&nbsp;<span class="ident" id="8140964">x</span>&nbsp;<span class="op" id="8140966">:=</span>&nbsp;<span class="ident" id="8140969">bo</span><span class="op" id="8140971">.</span><span class="ident" id="8140972">Min</span><span class="op" id="8140975">.</span><span class="ident" id="8140976">X</span><span class="op" id="8140977">;</span>&nbsp;<span class="ident" id="8140979">x</span>&nbsp;<span class="op" id="8140981">&lt;</span>&nbsp;<span class="ident" id="8140983">bo</span><span class="op" id="8140985">.</span><span class="ident" id="8140986">Max</span><span class="op" id="8140989">.</span><span class="ident" id="8140990">X</span><span class="op" id="8140991">;</span>&nbsp;<span class="ident" id="8140993">x</span><span class="op" id="8140994">++</span>&nbsp;<span class="op" id="8140997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141002">img</span><span class="op" id="8141005">.</span><span class="ident" id="8141006">SetRGBA</span><span class="op" id="8141013">(</span><span class="ident" id="8141014">x</span><span class="op" id="8141015">,</span>&nbsp;<span class="ident" id="8141017">y</span><span class="op" id="8141018">,</span>&nbsp;<span class="ident" id="8141020">color</span><span class="op" id="8141025">.</span><span class="ident" id="8141026">RGBA</span><span class="op" id="8141030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="8141036">uint8</span><span class="op" id="8141041">(</span><span class="ident" id="8141042">rnd</span><span class="op" id="8141045">.</span><span class="ident" id="8141046">Intn</span><span class="op" id="8141050">(</span><span class="num" id="8141051">256</span><span class="op" id="8141054">)</span><span class="op" id="8141055">)</span><span class="op" id="8141056">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="8141062">uint8</span><span class="op" id="8141067">(</span><span class="ident" id="8141068">rnd</span><span class="op" id="8141071">.</span><span class="ident" id="8141072">Intn</span><span class="op" id="8141076">(</span><span class="num" id="8141077">256</span><span class="op" id="8141080">)</span><span class="op" id="8141081">)</span><span class="op" id="8141082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="8141088">uint8</span><span class="op" id="8141093">(</span><span class="ident" id="8141094">rnd</span><span class="op" id="8141097">.</span><span class="ident" id="8141098">Intn</span><span class="op" id="8141102">(</span><span class="num" id="8141103">256</span><span class="op" id="8141106">)</span><span class="op" id="8141107">)</span><span class="op" id="8141108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8141114">255</span><span class="op" id="8141117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8141122">}</span><span class="op" id="8141123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8141127">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8141130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141133">b</span><span class="op" id="8141134">.</span><span class="ident" id="8141135">SetBytes</span><span class="op" id="8141143">(</span><span class="num" id="8141144">640</span>&nbsp;<span class="op" id="8141148">*</span>&nbsp;<span class="num" id="8141150">480</span>&nbsp;<span class="op" id="8141154">*</span>&nbsp;<span class="num" id="8141156">4</span><span class="op" id="8141157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141160">b</span><span class="op" id="8141161">.</span><span class="ident" id="8141162">StartTimer</span><span class="op" id="8141172">(</span><span class="op" id="8141173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141176">options</span>&nbsp;<span class="op" id="8141184">:=</span>&nbsp;<span class="op" id="8141187">&amp;</span><span class="ident" id="8141188">Options</span><span class="op" id="8141195">{</span><span class="ident" id="8141196">Quality</span><span class="op" id="8141203">:</span>&nbsp;<span class="num" id="8141205">90</span><span class="op" id="8141207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8141210">for</span>&nbsp;<span class="ident" id="8141214">i</span>&nbsp;<span class="op" id="8141216">:=</span>&nbsp;<span class="num" id="8141219">0</span><span class="op" id="8141220">;</span>&nbsp;<span class="ident" id="8141222">i</span>&nbsp;<span class="op" id="8141224">&lt;</span>&nbsp;<span class="ident" id="8141226">b</span><span class="op" id="8141227">.</span><span class="ident" id="8141228">N</span><span class="op" id="8141229">;</span>&nbsp;<span class="ident" id="8141231">i</span><span class="op" id="8141232">++</span>&nbsp;<span class="op" id="8141235">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8141239">Encode</span><span class="op" id="8141245">(</span><span class="ident" id="8141246">ioutil</span><span class="op" id="8141252">.</span><span class="ident" id="8141253">Discard</span><span class="op" id="8141260">,</span>&nbsp;<span class="ident" id="8141262">img</span><span class="op" id="8141265">,</span>&nbsp;<span class="ident" id="8141267">options</span><span class="op" id="8141274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8141277">}</span><br>
<span class="lineno"></span><span class="op" id="8141279">}</span>
</div>
</body>
</html>
