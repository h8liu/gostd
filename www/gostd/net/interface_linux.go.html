<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3194583">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3194639">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3194693">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3194744">package</span>&nbsp;<span class="ident" id="3194752">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3194757">import</span>&nbsp;<span class="op" id="3194764">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3194767">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3194773">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3194784">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3194793">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3194796">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3194862">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3194931">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3194945">func</span>&nbsp;<span class="ident" id="3194950">interfaceTable</span><span class="op" id="3194964">(</span><span class="ident" id="3194965">ifindex</span>&nbsp;<span class="builtintype" id="3194973">int</span><span class="op" id="3194976">)</span>&nbsp;<span class="op" id="3194978">(</span><span class="op" id="3194979">[</span><span class="op" id="3194980">]</span><span class="ident" id="3194981">Interface</span><span class="op" id="3194990">,</span>&nbsp;<span class="builtintype" id="3194992">error</span><span class="op" id="3194997">)</span>&nbsp;<span class="op" id="3194999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3195002">tab</span><span class="op" id="3195005">,</span>&nbsp;<span class="ident" id="3195007">err</span>&nbsp;<span class="op" id="3195011">:=</span>&nbsp;<span class="ident" id="3195014">syscall</span><span class="op" id="3195021">.</span><span class="ident" id="3195022">NetlinkRIB</span><span class="op" id="3195032">(</span><span class="ident" id="3195033">syscall</span><span class="op" id="3195040">.</span><span class="ident" id="3195041">RTM_GETLINK</span><span class="op" id="3195052">,</span>&nbsp;<span class="ident" id="3195054">syscall</span><span class="op" id="3195061">.</span><span class="ident" id="3195062">AF_UNSPEC</span><span class="op" id="3195071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195074">if</span>&nbsp;<span class="ident" id="3195077">err</span>&nbsp;<span class="op" id="3195081">!=</span>&nbsp;<span class="ident" id="3195084">nil</span>&nbsp;<span class="op" id="3195088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195092">return</span>&nbsp;<span class="ident" id="3195099">nil</span><span class="op" id="3195102">,</span>&nbsp;<span class="ident" id="3195104">os</span><span class="op" id="3195106">.</span><span class="ident" id="3195107">NewSyscallError</span><span class="op" id="3195122">(</span><span class="string" id="3195123">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3195136">,</span>&nbsp;<span class="ident" id="3195138">err</span><span class="op" id="3195141">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3195144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3195147">msgs</span><span class="op" id="3195151">,</span>&nbsp;<span class="ident" id="3195153">err</span>&nbsp;<span class="op" id="3195157">:=</span>&nbsp;<span class="ident" id="3195160">syscall</span><span class="op" id="3195167">.</span><span class="ident" id="3195168">ParseNetlinkMessage</span><span class="op" id="3195187">(</span><span class="ident" id="3195188">tab</span><span class="op" id="3195191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195194">if</span>&nbsp;<span class="ident" id="3195197">err</span>&nbsp;<span class="op" id="3195201">!=</span>&nbsp;<span class="ident" id="3195204">nil</span>&nbsp;<span class="op" id="3195208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195212">return</span>&nbsp;<span class="ident" id="3195219">nil</span><span class="op" id="3195222">,</span>&nbsp;<span class="ident" id="3195224">os</span><span class="op" id="3195226">.</span><span class="ident" id="3195227">NewSyscallError</span><span class="op" id="3195242">(</span><span class="string" id="3195243">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3195260">,</span>&nbsp;<span class="ident" id="3195262">err</span><span class="op" id="3195265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3195268">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195271">var</span>&nbsp;<span class="ident" id="3195275">ift</span>&nbsp;<span class="op" id="3195279">[</span><span class="op" id="3195280">]</span><span class="ident" id="3195281">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3195291">loop</span><span class="op" id="3195295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195298">for</span>&nbsp;<span class="ident" id="3195302">_</span><span class="op" id="3195303">,</span>&nbsp;<span class="ident" id="3195305">m</span>&nbsp;<span class="op" id="3195307">:=</span>&nbsp;<span class="keyword" id="3195310">range</span>&nbsp;<span class="ident" id="3195316">msgs</span>&nbsp;<span class="op" id="3195321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195325">switch</span>&nbsp;<span class="ident" id="3195332">m</span><span class="op" id="3195333">.</span><span class="ident" id="3195334">Header</span><span class="op" id="3195340">.</span><span class="ident" id="3195341">Type</span>&nbsp;<span class="op" id="3195346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195350">case</span>&nbsp;<span class="ident" id="3195355">syscall</span><span class="op" id="3195362">.</span><span class="ident" id="3195363">NLMSG_DONE</span><span class="op" id="3195373">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195378">break</span>&nbsp;<span class="ident" id="3195384">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195391">case</span>&nbsp;<span class="ident" id="3195396">syscall</span><span class="op" id="3195403">.</span><span class="ident" id="3195404">RTM_NEWLINK</span><span class="op" id="3195415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3195420">ifim</span>&nbsp;<span class="op" id="3195425">:=</span>&nbsp;<span class="op" id="3195428">(</span><span class="op" id="3195429">*</span><span class="ident" id="3195430">syscall</span><span class="op" id="3195437">.</span><span class="ident" id="3195438">IfInfomsg</span><span class="op" id="3195447">)</span><span class="op" id="3195448">(</span><span class="ident" id="3195449">unsafe</span><span class="op" id="3195455">.</span><span class="ident" id="3195456">Pointer</span><span class="op" id="3195463">(</span><span class="op" id="3195464">&amp;</span><span class="ident" id="3195465">m</span><span class="op" id="3195466">.</span><span class="ident" id="3195467">Data</span><span class="op" id="3195471">[</span><span class="num" id="3195472">0</span><span class="op" id="3195473">]</span><span class="op" id="3195474">)</span><span class="op" id="3195475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195480">if</span>&nbsp;<span class="ident" id="3195483">ifindex</span>&nbsp;<span class="op" id="3195491">==</span>&nbsp;<span class="num" id="3195494">0</span>&nbsp;<span class="op" id="3195496">||</span>&nbsp;<span class="ident" id="3195499">ifindex</span>&nbsp;<span class="op" id="3195507">==</span>&nbsp;<span class="builtintype" id="3195510">int</span><span class="op" id="3195513">(</span><span class="ident" id="3195514">ifim</span><span class="op" id="3195518">.</span><span class="ident" id="3195519">Index</span><span class="op" id="3195524">)</span>&nbsp;<span class="op" id="3195526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3195532">attrs</span><span class="op" id="3195537">,</span>&nbsp;<span class="ident" id="3195539">err</span>&nbsp;<span class="op" id="3195543">:=</span>&nbsp;<span class="ident" id="3195546">syscall</span><span class="op" id="3195553">.</span><span class="ident" id="3195554">ParseNetlinkRouteAttr</span><span class="op" id="3195575">(</span><span class="op" id="3195576">&amp;</span><span class="ident" id="3195577">m</span><span class="op" id="3195578">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195584">if</span>&nbsp;<span class="ident" id="3195587">err</span>&nbsp;<span class="op" id="3195591">!=</span>&nbsp;<span class="ident" id="3195594">nil</span>&nbsp;<span class="op" id="3195598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195605">return</span>&nbsp;<span class="ident" id="3195612">nil</span><span class="op" id="3195615">,</span>&nbsp;<span class="ident" id="3195617">os</span><span class="op" id="3195619">.</span><span class="ident" id="3195620">NewSyscallError</span><span class="op" id="3195635">(</span><span class="string" id="3195636">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3195655">,</span>&nbsp;<span class="ident" id="3195657">err</span><span class="op" id="3195660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3195666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3195672">ift</span>&nbsp;<span class="op" id="3195676">=</span>&nbsp;<span class="builtinfunc" id="3195678">append</span><span class="op" id="3195684">(</span><span class="ident" id="3195685">ift</span><span class="op" id="3195688">,</span>&nbsp;<span class="op" id="3195690">*</span><span class="ident" id="3195691">newLink</span><span class="op" id="3195698">(</span><span class="ident" id="3195699">ifim</span><span class="op" id="3195703">,</span>&nbsp;<span class="ident" id="3195705">attrs</span><span class="op" id="3195710">)</span><span class="op" id="3195711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195717">if</span>&nbsp;<span class="ident" id="3195720">ifindex</span>&nbsp;<span class="op" id="3195728">==</span>&nbsp;<span class="builtintype" id="3195731">int</span><span class="op" id="3195734">(</span><span class="ident" id="3195735">ifim</span><span class="op" id="3195739">.</span><span class="ident" id="3195740">Index</span><span class="op" id="3195745">)</span>&nbsp;<span class="op" id="3195747">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195754">break</span>&nbsp;<span class="ident" id="3195760">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3195769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3195774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3195778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3195781">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3195784">return</span>&nbsp;<span class="ident" id="3195791">ift</span><span class="op" id="3195794">,</span>&nbsp;<span class="ident" id="3195796">nil</span><br>
<span class="lineno"></span><span class="op" id="3195800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3195803">const</span>&nbsp;<span class="op" id="3195809">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3195812">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3195836">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3195898">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3195921">=</span>&nbsp;<span class="num" id="3195923">768</span>&nbsp;<span class="comment" id="3195927">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3195956">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3195979">=</span>&nbsp;<span class="num" id="3195981">769</span>&nbsp;<span class="comment" id="3195985">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3196014">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3196037">=</span>&nbsp;<span class="num" id="3196039">776</span>&nbsp;<span class="comment" id="3196043">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3196072">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3196095">=</span>&nbsp;<span class="num" id="3196097">778</span>&nbsp;<span class="comment" id="3196101">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3196138">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3196161">=</span>&nbsp;<span class="num" id="3196163">823</span>&nbsp;<span class="comment" id="3196167">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3196203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3196206">func</span>&nbsp;<span class="ident" id="3196211">newLink</span><span class="op" id="3196218">(</span><span class="ident" id="3196219">ifim</span>&nbsp;<span class="op" id="3196224">*</span><span class="ident" id="3196225">syscall</span><span class="op" id="3196232">.</span><span class="ident" id="3196233">IfInfomsg</span><span class="op" id="3196242">,</span>&nbsp;<span class="ident" id="3196244">attrs</span>&nbsp;<span class="op" id="3196250">[</span><span class="op" id="3196251">]</span><span class="ident" id="3196252">syscall</span><span class="op" id="3196259">.</span><span class="ident" id="3196260">NetlinkRouteAttr</span><span class="op" id="3196276">)</span>&nbsp;<span class="op" id="3196278">*</span><span class="ident" id="3196279">Interface</span>&nbsp;<span class="op" id="3196289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3196292">ifi</span>&nbsp;<span class="op" id="3196296">:=</span>&nbsp;<span class="op" id="3196299">&amp;</span><span class="ident" id="3196300">Interface</span><span class="op" id="3196309">{</span><span class="ident" id="3196310">Index</span><span class="op" id="3196315">:</span>&nbsp;<span class="builtintype" id="3196317">int</span><span class="op" id="3196320">(</span><span class="ident" id="3196321">ifim</span><span class="op" id="3196325">.</span><span class="ident" id="3196326">Index</span><span class="op" id="3196331">)</span><span class="op" id="3196332">,</span>&nbsp;<span class="ident" id="3196334">Flags</span><span class="op" id="3196339">:</span>&nbsp;<span class="ident" id="3196341">linkFlags</span><span class="op" id="3196350">(</span><span class="ident" id="3196351">ifim</span><span class="op" id="3196355">.</span><span class="ident" id="3196356">Flags</span><span class="op" id="3196361">)</span><span class="op" id="3196362">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196365">for</span>&nbsp;<span class="ident" id="3196369">_</span><span class="op" id="3196370">,</span>&nbsp;<span class="ident" id="3196372">a</span>&nbsp;<span class="op" id="3196374">:=</span>&nbsp;<span class="keyword" id="3196377">range</span>&nbsp;<span class="ident" id="3196383">attrs</span>&nbsp;<span class="op" id="3196389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196393">switch</span>&nbsp;<span class="ident" id="3196400">a</span><span class="op" id="3196401">.</span><span class="ident" id="3196402">Attr</span><span class="op" id="3196406">.</span><span class="ident" id="3196407">Type</span>&nbsp;<span class="op" id="3196412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196416">case</span>&nbsp;<span class="ident" id="3196421">syscall</span><span class="op" id="3196428">.</span><span class="ident" id="3196429">IFLA_ADDRESS</span><span class="op" id="3196441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3196446">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3196495">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3196542">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196566">switch</span>&nbsp;<span class="builtinfunc" id="3196573">len</span><span class="op" id="3196576">(</span><span class="ident" id="3196577">a</span><span class="op" id="3196578">.</span><span class="ident" id="3196579">Value</span><span class="op" id="3196584">)</span>&nbsp;<span class="op" id="3196586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196591">case</span>&nbsp;<span class="ident" id="3196596">IPv4len</span><span class="op" id="3196603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196609">switch</span>&nbsp;<span class="ident" id="3196616">ifim</span><span class="op" id="3196620">.</span><span class="ident" id="3196621">Type</span>&nbsp;<span class="op" id="3196626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196632">case</span>&nbsp;<span class="ident" id="3196637">sysARPHardwareIPv4IPv4</span><span class="op" id="3196659">,</span>&nbsp;<span class="ident" id="3196661">sysARPHardwareGREIPv4</span><span class="op" id="3196682">,</span>&nbsp;<span class="ident" id="3196684">sysARPHardwareIPv6IPv4</span><span class="op" id="3196706">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196713">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3196726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196731">case</span>&nbsp;<span class="ident" id="3196736">IPv6len</span><span class="op" id="3196743">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196749">switch</span>&nbsp;<span class="ident" id="3196756">ifim</span><span class="op" id="3196760">.</span><span class="ident" id="3196761">Type</span>&nbsp;<span class="op" id="3196766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196772">case</span>&nbsp;<span class="ident" id="3196777">sysARPHardwareIPv6IPv6</span><span class="op" id="3196799">,</span>&nbsp;<span class="ident" id="3196801">sysARPHardwareGREIPv6</span><span class="op" id="3196822">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196829">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3196842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3196847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196852">var</span>&nbsp;<span class="ident" id="3196856">nonzero</span>&nbsp;<span class="builtintype" id="3196864">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196872">for</span>&nbsp;<span class="ident" id="3196876">_</span><span class="op" id="3196877">,</span>&nbsp;<span class="ident" id="3196879">b</span>&nbsp;<span class="op" id="3196881">:=</span>&nbsp;<span class="keyword" id="3196884">range</span>&nbsp;<span class="ident" id="3196890">a</span><span class="op" id="3196891">.</span><span class="ident" id="3196892">Value</span>&nbsp;<span class="op" id="3196898">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196904">if</span>&nbsp;<span class="ident" id="3196907">b</span>&nbsp;<span class="op" id="3196909">!=</span>&nbsp;<span class="num" id="3196912">0</span>&nbsp;<span class="op" id="3196914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3196921">nonzero</span>&nbsp;<span class="op" id="3196929">=</span>&nbsp;<span class="builtintype" id="3196931">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196941">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3196951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3196956">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3196961">if</span>&nbsp;<span class="ident" id="3196964">nonzero</span>&nbsp;<span class="op" id="3196972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3196978">ifi</span><span class="op" id="3196981">.</span><span class="ident" id="3196982">HardwareAddr</span>&nbsp;<span class="op" id="3196995">=</span>&nbsp;<span class="ident" id="3196997">a</span><span class="op" id="3196998">.</span><span class="ident" id="3196999">Value</span><span class="op" id="3197004">[</span><span class="op" id="3197005">:</span><span class="op" id="3197006">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3197011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197015">case</span>&nbsp;<span class="ident" id="3197020">syscall</span><span class="op" id="3197027">.</span><span class="ident" id="3197028">IFLA_IFNAME</span><span class="op" id="3197039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3197044">ifi</span><span class="op" id="3197047">.</span><span class="ident" id="3197048">Name</span>&nbsp;<span class="op" id="3197053">=</span>&nbsp;<span class="builtintype" id="3197055">string</span><span class="op" id="3197061">(</span><span class="ident" id="3197062">a</span><span class="op" id="3197063">.</span><span class="ident" id="3197064">Value</span><span class="op" id="3197069">[</span><span class="op" id="3197070">:</span><span class="builtinfunc" id="3197071">len</span><span class="op" id="3197074">(</span><span class="ident" id="3197075">a</span><span class="op" id="3197076">.</span><span class="ident" id="3197077">Value</span><span class="op" id="3197082">)</span><span class="op" id="3197083">-</span><span class="num" id="3197084">1</span><span class="op" id="3197085">]</span><span class="op" id="3197086">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197090">case</span>&nbsp;<span class="ident" id="3197095">syscall</span><span class="op" id="3197102">.</span><span class="ident" id="3197103">IFLA_MTU</span><span class="op" id="3197111">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3197116">ifi</span><span class="op" id="3197119">.</span><span class="ident" id="3197120">MTU</span>&nbsp;<span class="op" id="3197124">=</span>&nbsp;<span class="builtintype" id="3197126">int</span><span class="op" id="3197129">(</span><span class="op" id="3197130">*</span><span class="op" id="3197131">(</span><span class="op" id="3197132">*</span><span class="builtintype" id="3197133">uint32</span><span class="op" id="3197139">)</span><span class="op" id="3197140">(</span><span class="ident" id="3197141">unsafe</span><span class="op" id="3197147">.</span><span class="ident" id="3197148">Pointer</span><span class="op" id="3197155">(</span><span class="op" id="3197156">&amp;</span><span class="ident" id="3197157">a</span><span class="op" id="3197158">.</span><span class="ident" id="3197159">Value</span><span class="op" id="3197164">[</span><span class="op" id="3197165">:</span><span class="num" id="3197166">4</span><span class="op" id="3197167">]</span><span class="op" id="3197168">[</span><span class="num" id="3197169">0</span><span class="op" id="3197170">]</span><span class="op" id="3197171">)</span><span class="op" id="3197172">)</span><span class="op" id="3197173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3197177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3197180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197183">return</span>&nbsp;<span class="ident" id="3197190">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3197194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3197197">func</span>&nbsp;<span class="ident" id="3197202">linkFlags</span><span class="op" id="3197211">(</span><span class="ident" id="3197212">rawFlags</span>&nbsp;<span class="builtintype" id="3197221">uint32</span><span class="op" id="3197227">)</span>&nbsp;<span class="ident" id="3197229">Flags</span>&nbsp;<span class="op" id="3197235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197238">var</span>&nbsp;<span class="ident" id="3197242">f</span>&nbsp;<span class="ident" id="3197244">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197251">if</span>&nbsp;<span class="ident" id="3197254">rawFlags</span><span class="op" id="3197262">&amp;</span><span class="ident" id="3197263">syscall</span><span class="op" id="3197270">.</span><span class="ident" id="3197271">IFF_UP</span>&nbsp;<span class="op" id="3197278">!=</span>&nbsp;<span class="num" id="3197281">0</span>&nbsp;<span class="op" id="3197283">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3197287">f</span>&nbsp;<span class="op" id="3197289">|=</span>&nbsp;<span class="ident" id="3197292">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3197300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197303">if</span>&nbsp;<span class="ident" id="3197306">rawFlags</span><span class="op" id="3197314">&amp;</span><span class="ident" id="3197315">syscall</span><span class="op" id="3197322">.</span><span class="ident" id="3197323">IFF_BROADCAST</span>&nbsp;<span class="op" id="3197337">!=</span>&nbsp;<span class="num" id="3197340">0</span>&nbsp;<span class="op" id="3197342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3197346">f</span>&nbsp;<span class="op" id="3197348">|=</span>&nbsp;<span class="ident" id="3197351">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3197366">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197369">if</span>&nbsp;<span class="ident" id="3197372">rawFlags</span><span class="op" id="3197380">&amp;</span><span class="ident" id="3197381">syscall</span><span class="op" id="3197388">.</span><span class="ident" id="3197389">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3197402">!=</span>&nbsp;<span class="num" id="3197405">0</span>&nbsp;<span class="op" id="3197407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3197411">f</span>&nbsp;<span class="op" id="3197413">|=</span>&nbsp;<span class="ident" id="3197416">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3197430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197433">if</span>&nbsp;<span class="ident" id="3197436">rawFlags</span><span class="op" id="3197444">&amp;</span><span class="ident" id="3197445">syscall</span><span class="op" id="3197452">.</span><span class="ident" id="3197453">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3197469">!=</span>&nbsp;<span class="num" id="3197472">0</span>&nbsp;<span class="op" id="3197474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3197478">f</span>&nbsp;<span class="op" id="3197480">|=</span>&nbsp;<span class="ident" id="3197483">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3197501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197504">if</span>&nbsp;<span class="ident" id="3197507">rawFlags</span><span class="op" id="3197515">&amp;</span><span class="ident" id="3197516">syscall</span><span class="op" id="3197523">.</span><span class="ident" id="3197524">IFF_MULTICAST</span>&nbsp;<span class="op" id="3197538">!=</span>&nbsp;<span class="num" id="3197541">0</span>&nbsp;<span class="op" id="3197543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3197547">f</span>&nbsp;<span class="op" id="3197549">|=</span>&nbsp;<span class="ident" id="3197552">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3197567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197570">return</span>&nbsp;<span class="ident" id="3197577">f</span><br>
<span class="lineno">115</span><span class="op" id="3197579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3197582">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3197649">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3197719">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3197733">func</span>&nbsp;<span class="ident" id="3197738">interfaceAddrTable</span><span class="op" id="3197756">(</span><span class="ident" id="3197757">ifi</span>&nbsp;<span class="op" id="3197761">*</span><span class="ident" id="3197762">Interface</span><span class="op" id="3197771">)</span>&nbsp;<span class="op" id="3197773">(</span><span class="op" id="3197774">[</span><span class="op" id="3197775">]</span><span class="ident" id="3197776">Addr</span><span class="op" id="3197780">,</span>&nbsp;<span class="builtintype" id="3197782">error</span><span class="op" id="3197787">)</span>&nbsp;<span class="op" id="3197789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3197792">tab</span><span class="op" id="3197795">,</span>&nbsp;<span class="ident" id="3197797">err</span>&nbsp;<span class="op" id="3197801">:=</span>&nbsp;<span class="ident" id="3197804">syscall</span><span class="op" id="3197811">.</span><span class="ident" id="3197812">NetlinkRIB</span><span class="op" id="3197822">(</span><span class="ident" id="3197823">syscall</span><span class="op" id="3197830">.</span><span class="ident" id="3197831">RTM_GETADDR</span><span class="op" id="3197842">,</span>&nbsp;<span class="ident" id="3197844">syscall</span><span class="op" id="3197851">.</span><span class="ident" id="3197852">AF_UNSPEC</span><span class="op" id="3197861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197864">if</span>&nbsp;<span class="ident" id="3197867">err</span>&nbsp;<span class="op" id="3197871">!=</span>&nbsp;<span class="ident" id="3197874">nil</span>&nbsp;<span class="op" id="3197878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197882">return</span>&nbsp;<span class="ident" id="3197889">nil</span><span class="op" id="3197892">,</span>&nbsp;<span class="ident" id="3197894">os</span><span class="op" id="3197896">.</span><span class="ident" id="3197897">NewSyscallError</span><span class="op" id="3197912">(</span><span class="string" id="3197913">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3197926">,</span>&nbsp;<span class="ident" id="3197928">err</span><span class="op" id="3197931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3197934">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3197937">msgs</span><span class="op" id="3197941">,</span>&nbsp;<span class="ident" id="3197943">err</span>&nbsp;<span class="op" id="3197947">:=</span>&nbsp;<span class="ident" id="3197950">syscall</span><span class="op" id="3197957">.</span><span class="ident" id="3197958">ParseNetlinkMessage</span><span class="op" id="3197977">(</span><span class="ident" id="3197978">tab</span><span class="op" id="3197981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3197984">if</span>&nbsp;<span class="ident" id="3197987">err</span>&nbsp;<span class="op" id="3197991">!=</span>&nbsp;<span class="ident" id="3197994">nil</span>&nbsp;<span class="op" id="3197998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198002">return</span>&nbsp;<span class="ident" id="3198009">nil</span><span class="op" id="3198012">,</span>&nbsp;<span class="ident" id="3198014">os</span><span class="op" id="3198016">.</span><span class="ident" id="3198017">NewSyscallError</span><span class="op" id="3198032">(</span><span class="string" id="3198033">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3198050">,</span>&nbsp;<span class="ident" id="3198052">err</span><span class="op" id="3198055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3198058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198061">var</span>&nbsp;<span class="ident" id="3198065">ift</span>&nbsp;<span class="op" id="3198069">[</span><span class="op" id="3198070">]</span><span class="ident" id="3198071">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198082">if</span>&nbsp;<span class="ident" id="3198085">ifi</span>&nbsp;<span class="op" id="3198089">==</span>&nbsp;<span class="ident" id="3198092">nil</span>&nbsp;<span class="op" id="3198096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198100">var</span>&nbsp;<span class="ident" id="3198104">err</span>&nbsp;<span class="builtintype" id="3198108">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3198116">ift</span><span class="op" id="3198119">,</span>&nbsp;<span class="ident" id="3198121">err</span>&nbsp;<span class="op" id="3198125">=</span>&nbsp;<span class="ident" id="3198127">interfaceTable</span><span class="op" id="3198141">(</span><span class="num" id="3198142">0</span><span class="op" id="3198143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198147">if</span>&nbsp;<span class="ident" id="3198150">err</span>&nbsp;<span class="op" id="3198154">!=</span>&nbsp;<span class="ident" id="3198157">nil</span>&nbsp;<span class="op" id="3198161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198166">return</span>&nbsp;<span class="ident" id="3198173">nil</span><span class="op" id="3198176">,</span>&nbsp;<span class="ident" id="3198178">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3198184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3198187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3198190">ifat</span><span class="op" id="3198194">,</span>&nbsp;<span class="ident" id="3198196">err</span>&nbsp;<span class="op" id="3198200">:=</span>&nbsp;<span class="ident" id="3198203">addrTable</span><span class="op" id="3198212">(</span><span class="ident" id="3198213">ift</span><span class="op" id="3198216">,</span>&nbsp;<span class="ident" id="3198218">ifi</span><span class="op" id="3198221">,</span>&nbsp;<span class="ident" id="3198223">msgs</span><span class="op" id="3198227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198230">if</span>&nbsp;<span class="ident" id="3198233">err</span>&nbsp;<span class="op" id="3198237">!=</span>&nbsp;<span class="ident" id="3198240">nil</span>&nbsp;<span class="op" id="3198244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198248">return</span>&nbsp;<span class="ident" id="3198255">nil</span><span class="op" id="3198258">,</span>&nbsp;<span class="ident" id="3198260">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3198265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198268">return</span>&nbsp;<span class="ident" id="3198275">ifat</span><span class="op" id="3198279">,</span>&nbsp;<span class="ident" id="3198281">nil</span><br>
<span class="lineno"></span><span class="op" id="3198285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3198288">func</span>&nbsp;<span class="ident" id="3198293">addrTable</span><span class="op" id="3198302">(</span><span class="ident" id="3198303">ift</span>&nbsp;<span class="op" id="3198307">[</span><span class="op" id="3198308">]</span><span class="ident" id="3198309">Interface</span><span class="op" id="3198318">,</span>&nbsp;<span class="ident" id="3198320">ifi</span>&nbsp;<span class="op" id="3198324">*</span><span class="ident" id="3198325">Interface</span><span class="op" id="3198334">,</span>&nbsp;<span class="ident" id="3198336">msgs</span>&nbsp;<span class="op" id="3198341">[</span><span class="op" id="3198342">]</span><span class="ident" id="3198343">syscall</span><span class="op" id="3198350">.</span><span class="ident" id="3198351">NetlinkMessage</span><span class="op" id="3198365">)</span>&nbsp;<span class="op" id="3198367">(</span><span class="op" id="3198368">[</span><span class="op" id="3198369">]</span><span class="ident" id="3198370">Addr</span><span class="op" id="3198374">,</span>&nbsp;<span class="builtintype" id="3198376">error</span><span class="op" id="3198381">)</span>&nbsp;<span class="op" id="3198383">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198386">var</span>&nbsp;<span class="ident" id="3198390">ifat</span>&nbsp;<span class="op" id="3198395">[</span><span class="op" id="3198396">]</span><span class="ident" id="3198397">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3198402">loop</span><span class="op" id="3198406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198409">for</span>&nbsp;<span class="ident" id="3198413">_</span><span class="op" id="3198414">,</span>&nbsp;<span class="ident" id="3198416">m</span>&nbsp;<span class="op" id="3198418">:=</span>&nbsp;<span class="keyword" id="3198421">range</span>&nbsp;<span class="ident" id="3198427">msgs</span>&nbsp;<span class="op" id="3198432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198436">switch</span>&nbsp;<span class="ident" id="3198443">m</span><span class="op" id="3198444">.</span><span class="ident" id="3198445">Header</span><span class="op" id="3198451">.</span><span class="ident" id="3198452">Type</span>&nbsp;<span class="op" id="3198457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198461">case</span>&nbsp;<span class="ident" id="3198466">syscall</span><span class="op" id="3198473">.</span><span class="ident" id="3198474">NLMSG_DONE</span><span class="op" id="3198484">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198489">break</span>&nbsp;<span class="ident" id="3198495">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198502">case</span>&nbsp;<span class="ident" id="3198507">syscall</span><span class="op" id="3198514">.</span><span class="ident" id="3198515">RTM_NEWADDR</span><span class="op" id="3198526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3198531">ifam</span>&nbsp;<span class="op" id="3198536">:=</span>&nbsp;<span class="op" id="3198539">(</span><span class="op" id="3198540">*</span><span class="ident" id="3198541">syscall</span><span class="op" id="3198548">.</span><span class="ident" id="3198549">IfAddrmsg</span><span class="op" id="3198558">)</span><span class="op" id="3198559">(</span><span class="ident" id="3198560">unsafe</span><span class="op" id="3198566">.</span><span class="ident" id="3198567">Pointer</span><span class="op" id="3198574">(</span><span class="op" id="3198575">&amp;</span><span class="ident" id="3198576">m</span><span class="op" id="3198577">.</span><span class="ident" id="3198578">Data</span><span class="op" id="3198582">[</span><span class="num" id="3198583">0</span><span class="op" id="3198584">]</span><span class="op" id="3198585">)</span><span class="op" id="3198586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198591">if</span>&nbsp;<span class="builtinfunc" id="3198594">len</span><span class="op" id="3198597">(</span><span class="ident" id="3198598">ift</span><span class="op" id="3198601">)</span>&nbsp;<span class="op" id="3198603">!=</span>&nbsp;<span class="num" id="3198606">0</span>&nbsp;<span class="op" id="3198608">||</span>&nbsp;<span class="ident" id="3198611">ifi</span><span class="op" id="3198614">.</span><span class="ident" id="3198615">Index</span>&nbsp;<span class="op" id="3198621">==</span>&nbsp;<span class="builtintype" id="3198624">int</span><span class="op" id="3198627">(</span><span class="ident" id="3198628">ifam</span><span class="op" id="3198632">.</span><span class="ident" id="3198633">Index</span><span class="op" id="3198638">)</span>&nbsp;<span class="op" id="3198640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198646">if</span>&nbsp;<span class="builtinfunc" id="3198649">len</span><span class="op" id="3198652">(</span><span class="ident" id="3198653">ift</span><span class="op" id="3198656">)</span>&nbsp;<span class="op" id="3198658">!=</span>&nbsp;<span class="num" id="3198661">0</span>&nbsp;<span class="op" id="3198663">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198670">var</span>&nbsp;<span class="ident" id="3198674">err</span>&nbsp;<span class="builtintype" id="3198678">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3198689">ifi</span><span class="op" id="3198692">,</span>&nbsp;<span class="ident" id="3198694">err</span>&nbsp;<span class="op" id="3198698">=</span>&nbsp;<span class="ident" id="3198700">interfaceByIndex</span><span class="op" id="3198716">(</span><span class="ident" id="3198717">ift</span><span class="op" id="3198720">,</span>&nbsp;<span class="builtintype" id="3198722">int</span><span class="op" id="3198725">(</span><span class="ident" id="3198726">ifam</span><span class="op" id="3198730">.</span><span class="ident" id="3198731">Index</span><span class="op" id="3198736">)</span><span class="op" id="3198737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198744">if</span>&nbsp;<span class="ident" id="3198747">err</span>&nbsp;<span class="op" id="3198751">!=</span>&nbsp;<span class="ident" id="3198754">nil</span>&nbsp;<span class="op" id="3198758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198766">return</span>&nbsp;<span class="ident" id="3198773">nil</span><span class="op" id="3198776">,</span>&nbsp;<span class="ident" id="3198778">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3198787">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3198793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3198799">attrs</span><span class="op" id="3198804">,</span>&nbsp;<span class="ident" id="3198806">err</span>&nbsp;<span class="op" id="3198810">:=</span>&nbsp;<span class="ident" id="3198813">syscall</span><span class="op" id="3198820">.</span><span class="ident" id="3198821">ParseNetlinkRouteAttr</span><span class="op" id="3198842">(</span><span class="op" id="3198843">&amp;</span><span class="ident" id="3198844">m</span><span class="op" id="3198845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198851">if</span>&nbsp;<span class="ident" id="3198854">err</span>&nbsp;<span class="op" id="3198858">!=</span>&nbsp;<span class="ident" id="3198861">nil</span>&nbsp;<span class="op" id="3198865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198872">return</span>&nbsp;<span class="ident" id="3198879">nil</span><span class="op" id="3198882">,</span>&nbsp;<span class="ident" id="3198884">os</span><span class="op" id="3198886">.</span><span class="ident" id="3198887">NewSyscallError</span><span class="op" id="3198902">(</span><span class="string" id="3198903">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3198922">,</span>&nbsp;<span class="ident" id="3198924">err</span><span class="op" id="3198927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3198933">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3198939">ifa</span>&nbsp;<span class="op" id="3198943">:=</span>&nbsp;<span class="ident" id="3198946">newAddr</span><span class="op" id="3198953">(</span><span class="ident" id="3198954">ifi</span><span class="op" id="3198957">,</span>&nbsp;<span class="ident" id="3198959">ifam</span><span class="op" id="3198963">,</span>&nbsp;<span class="ident" id="3198965">attrs</span><span class="op" id="3198970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3198976">if</span>&nbsp;<span class="ident" id="3198979">ifa</span>&nbsp;<span class="op" id="3198983">!=</span>&nbsp;<span class="ident" id="3198986">nil</span>&nbsp;<span class="op" id="3198990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3198997">ifat</span>&nbsp;<span class="op" id="3199002">=</span>&nbsp;<span class="builtinfunc" id="3199004">append</span><span class="op" id="3199010">(</span><span class="ident" id="3199011">ifat</span><span class="op" id="3199015">,</span>&nbsp;<span class="ident" id="3199017">ifa</span><span class="op" id="3199020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3199026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3199031">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3199035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3199038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199041">return</span>&nbsp;<span class="ident" id="3199048">ifat</span><span class="op" id="3199052">,</span>&nbsp;<span class="ident" id="3199054">nil</span><br>
<span class="lineno"></span><span class="op" id="3199058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3199061">func</span>&nbsp;<span class="ident" id="3199066">newAddr</span><span class="op" id="3199073">(</span><span class="ident" id="3199074">ifi</span>&nbsp;<span class="op" id="3199078">*</span><span class="ident" id="3199079">Interface</span><span class="op" id="3199088">,</span>&nbsp;<span class="ident" id="3199090">ifam</span>&nbsp;<span class="op" id="3199095">*</span><span class="ident" id="3199096">syscall</span><span class="op" id="3199103">.</span><span class="ident" id="3199104">IfAddrmsg</span><span class="op" id="3199113">,</span>&nbsp;<span class="ident" id="3199115">attrs</span>&nbsp;<span class="op" id="3199121">[</span><span class="op" id="3199122">]</span><span class="ident" id="3199123">syscall</span><span class="op" id="3199130">.</span><span class="ident" id="3199131">NetlinkRouteAttr</span><span class="op" id="3199147">)</span>&nbsp;<span class="ident" id="3199149">Addr</span>&nbsp;<span class="op" id="3199154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199157">var</span>&nbsp;<span class="ident" id="3199161">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3199176">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3199182">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3199243">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3199306">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199361">if</span>&nbsp;<span class="ident" id="3199364">ifi</span><span class="op" id="3199367">.</span><span class="ident" id="3199368">Flags</span><span class="op" id="3199373">&amp;</span><span class="ident" id="3199374">FlagPointToPoint</span>&nbsp;<span class="op" id="3199391">!=</span>&nbsp;<span class="num" id="3199394">0</span>&nbsp;<span class="op" id="3199396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199400">for</span>&nbsp;<span class="ident" id="3199404">_</span><span class="op" id="3199405">,</span>&nbsp;<span class="ident" id="3199407">a</span>&nbsp;<span class="op" id="3199409">:=</span>&nbsp;<span class="keyword" id="3199412">range</span>&nbsp;<span class="ident" id="3199418">attrs</span>&nbsp;<span class="op" id="3199424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199429">if</span>&nbsp;<span class="ident" id="3199432">a</span><span class="op" id="3199433">.</span><span class="ident" id="3199434">Attr</span><span class="op" id="3199438">.</span><span class="ident" id="3199439">Type</span>&nbsp;<span class="op" id="3199444">==</span>&nbsp;<span class="ident" id="3199447">syscall</span><span class="op" id="3199454">.</span><span class="ident" id="3199455">IFA_LOCAL</span>&nbsp;<span class="op" id="3199465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3199471">ipPointToPoint</span>&nbsp;<span class="op" id="3199486">=</span>&nbsp;<span class="builtintype" id="3199488">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199497">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3199506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3199510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3199513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199516">for</span>&nbsp;<span class="ident" id="3199520">_</span><span class="op" id="3199521">,</span>&nbsp;<span class="ident" id="3199523">a</span>&nbsp;<span class="op" id="3199525">:=</span>&nbsp;<span class="keyword" id="3199528">range</span>&nbsp;<span class="ident" id="3199534">attrs</span>&nbsp;<span class="op" id="3199540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199544">if</span>&nbsp;<span class="ident" id="3199547">ipPointToPoint</span>&nbsp;<span class="op" id="3199562">&amp;&amp;</span>&nbsp;<span class="ident" id="3199565">a</span><span class="op" id="3199566">.</span><span class="ident" id="3199567">Attr</span><span class="op" id="3199571">.</span><span class="ident" id="3199572">Type</span>&nbsp;<span class="op" id="3199577">==</span>&nbsp;<span class="ident" id="3199580">syscall</span><span class="op" id="3199587">.</span><span class="ident" id="3199588">IFA_ADDRESS</span>&nbsp;<span class="op" id="3199600">||</span>&nbsp;<span class="op" id="3199603">!</span><span class="ident" id="3199604">ipPointToPoint</span>&nbsp;<span class="op" id="3199619">&amp;&amp;</span>&nbsp;<span class="ident" id="3199622">a</span><span class="op" id="3199623">.</span><span class="ident" id="3199624">Attr</span><span class="op" id="3199628">.</span><span class="ident" id="3199629">Type</span>&nbsp;<span class="op" id="3199634">==</span>&nbsp;<span class="ident" id="3199637">syscall</span><span class="op" id="3199644">.</span><span class="ident" id="3199645">IFA_LOCAL</span>&nbsp;<span class="op" id="3199655">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199660">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3199671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199675">switch</span>&nbsp;<span class="ident" id="3199682">ifam</span><span class="op" id="3199686">.</span><span class="ident" id="3199687">Family</span>&nbsp;<span class="op" id="3199694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199698">case</span>&nbsp;<span class="ident" id="3199703">syscall</span><span class="op" id="3199710">.</span><span class="ident" id="3199711">AF_INET</span><span class="op" id="3199718">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199723">return</span>&nbsp;<span class="op" id="3199730">&amp;</span><span class="ident" id="3199731">IPNet</span><span class="op" id="3199736">{</span><span class="ident" id="3199737">IP</span><span class="op" id="3199739">:</span>&nbsp;<span class="ident" id="3199741">IPv4</span><span class="op" id="3199745">(</span><span class="ident" id="3199746">a</span><span class="op" id="3199747">.</span><span class="ident" id="3199748">Value</span><span class="op" id="3199753">[</span><span class="num" id="3199754">0</span><span class="op" id="3199755">]</span><span class="op" id="3199756">,</span>&nbsp;<span class="ident" id="3199758">a</span><span class="op" id="3199759">.</span><span class="ident" id="3199760">Value</span><span class="op" id="3199765">[</span><span class="num" id="3199766">1</span><span class="op" id="3199767">]</span><span class="op" id="3199768">,</span>&nbsp;<span class="ident" id="3199770">a</span><span class="op" id="3199771">.</span><span class="ident" id="3199772">Value</span><span class="op" id="3199777">[</span><span class="num" id="3199778">2</span><span class="op" id="3199779">]</span><span class="op" id="3199780">,</span>&nbsp;<span class="ident" id="3199782">a</span><span class="op" id="3199783">.</span><span class="ident" id="3199784">Value</span><span class="op" id="3199789">[</span><span class="num" id="3199790">3</span><span class="op" id="3199791">]</span><span class="op" id="3199792">)</span><span class="op" id="3199793">,</span>&nbsp;<span class="ident" id="3199795">Mask</span><span class="op" id="3199799">:</span>&nbsp;<span class="ident" id="3199801">CIDRMask</span><span class="op" id="3199809">(</span><span class="builtintype" id="3199810">int</span><span class="op" id="3199813">(</span><span class="ident" id="3199814">ifam</span><span class="op" id="3199818">.</span><span class="ident" id="3199819">Prefixlen</span><span class="op" id="3199828">)</span><span class="op" id="3199829">,</span>&nbsp;<span class="num" id="3199831">8</span><span class="op" id="3199832">*</span><span class="ident" id="3199833">IPv4len</span><span class="op" id="3199840">)</span><span class="op" id="3199841">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199845">case</span>&nbsp;<span class="ident" id="3199850">syscall</span><span class="op" id="3199857">.</span><span class="ident" id="3199858">AF_INET6</span><span class="op" id="3199866">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3199871">ifa</span>&nbsp;<span class="op" id="3199875">:=</span>&nbsp;<span class="op" id="3199878">&amp;</span><span class="ident" id="3199879">IPNet</span><span class="op" id="3199884">{</span><span class="ident" id="3199885">IP</span><span class="op" id="3199887">:</span>&nbsp;<span class="builtinfunc" id="3199889">make</span><span class="op" id="3199893">(</span><span class="ident" id="3199894">IP</span><span class="op" id="3199896">,</span>&nbsp;<span class="ident" id="3199898">IPv6len</span><span class="op" id="3199905">)</span><span class="op" id="3199906">,</span>&nbsp;<span class="ident" id="3199908">Mask</span><span class="op" id="3199912">:</span>&nbsp;<span class="ident" id="3199914">CIDRMask</span><span class="op" id="3199922">(</span><span class="builtintype" id="3199923">int</span><span class="op" id="3199926">(</span><span class="ident" id="3199927">ifam</span><span class="op" id="3199931">.</span><span class="ident" id="3199932">Prefixlen</span><span class="op" id="3199941">)</span><span class="op" id="3199942">,</span>&nbsp;<span class="num" id="3199944">8</span><span class="op" id="3199945">*</span><span class="ident" id="3199946">IPv6len</span><span class="op" id="3199953">)</span><span class="op" id="3199954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3199959">copy</span><span class="op" id="3199963">(</span><span class="ident" id="3199964">ifa</span><span class="op" id="3199967">.</span><span class="ident" id="3199968">IP</span><span class="op" id="3199970">,</span>&nbsp;<span class="ident" id="3199972">a</span><span class="op" id="3199973">.</span><span class="ident" id="3199974">Value</span><span class="op" id="3199979">[</span><span class="op" id="3199980">:</span><span class="op" id="3199981">]</span><span class="op" id="3199982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199987">return</span>&nbsp;<span class="ident" id="3199994">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3200000">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3200003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200006">return</span>&nbsp;<span class="ident" id="3200013">nil</span><br>
<span class="lineno"></span><span class="op" id="3200017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3200020">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3200084">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3200098">func</span>&nbsp;<span class="ident" id="3200103">interfaceMulticastAddrTable</span><span class="op" id="3200130">(</span><span class="ident" id="3200131">ifi</span>&nbsp;<span class="op" id="3200135">*</span><span class="ident" id="3200136">Interface</span><span class="op" id="3200145">)</span>&nbsp;<span class="op" id="3200147">(</span><span class="op" id="3200148">[</span><span class="op" id="3200149">]</span><span class="ident" id="3200150">Addr</span><span class="op" id="3200154">,</span>&nbsp;<span class="builtintype" id="3200156">error</span><span class="op" id="3200161">)</span>&nbsp;<span class="op" id="3200163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200166">ifmat4</span>&nbsp;<span class="op" id="3200173">:=</span>&nbsp;<span class="ident" id="3200176">parseProcNetIGMP</span><span class="op" id="3200192">(</span><span class="string" id="3200193">&#34;/proc/net/igmp&#34;</span><span class="op" id="3200209">,</span>&nbsp;<span class="ident" id="3200211">ifi</span><span class="op" id="3200214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200217">ifmat6</span>&nbsp;<span class="op" id="3200224">:=</span>&nbsp;<span class="ident" id="3200227">parseProcNetIGMP6</span><span class="op" id="3200244">(</span><span class="string" id="3200245">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3200262">,</span>&nbsp;<span class="ident" id="3200264">ifi</span><span class="op" id="3200267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200270">return</span>&nbsp;<span class="builtinfunc" id="3200277">append</span><span class="op" id="3200283">(</span><span class="ident" id="3200284">ifmat4</span><span class="op" id="3200290">,</span>&nbsp;<span class="ident" id="3200292">ifmat6</span><span class="op" id="3200298">...</span><span class="op" id="3200301">)</span><span class="op" id="3200302">,</span>&nbsp;<span class="ident" id="3200304">nil</span><br>
<span class="lineno">210</span><span class="op" id="3200308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3200311">func</span>&nbsp;<span class="ident" id="3200316">parseProcNetIGMP</span><span class="op" id="3200332">(</span><span class="ident" id="3200333">path</span>&nbsp;<span class="builtintype" id="3200338">string</span><span class="op" id="3200344">,</span>&nbsp;<span class="ident" id="3200346">ifi</span>&nbsp;<span class="op" id="3200350">*</span><span class="ident" id="3200351">Interface</span><span class="op" id="3200360">)</span>&nbsp;<span class="op" id="3200362">[</span><span class="op" id="3200363">]</span><span class="ident" id="3200364">Addr</span>&nbsp;<span class="op" id="3200369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200372">fd</span><span class="op" id="3200374">,</span>&nbsp;<span class="ident" id="3200376">err</span>&nbsp;<span class="op" id="3200380">:=</span>&nbsp;<span class="ident" id="3200383">open</span><span class="op" id="3200387">(</span><span class="ident" id="3200388">path</span><span class="op" id="3200392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200395">if</span>&nbsp;<span class="ident" id="3200398">err</span>&nbsp;<span class="op" id="3200402">!=</span>&nbsp;<span class="ident" id="3200405">nil</span>&nbsp;<span class="op" id="3200409">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200413">return</span>&nbsp;<span class="ident" id="3200420">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3200425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200428">defer</span>&nbsp;<span class="ident" id="3200434">fd</span><span class="op" id="3200436">.</span><span class="builtinfunc" id="3200437">close</span><span class="op" id="3200442">(</span><span class="op" id="3200443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200446">var</span>&nbsp;<span class="op" id="3200450">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200454">ifmat</span>&nbsp;<span class="op" id="3200460">[</span><span class="op" id="3200461">]</span><span class="ident" id="3200462">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200469">name</span>&nbsp;&nbsp;<span class="builtintype" id="3200475">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3200483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200486">fd</span><span class="op" id="3200488">.</span><span class="ident" id="3200489">readLine</span><span class="op" id="3200497">(</span><span class="op" id="3200498">)</span>&nbsp;<span class="comment" id="3200500">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200520">b</span>&nbsp;<span class="op" id="3200522">:=</span>&nbsp;<span class="builtinfunc" id="3200525">make</span><span class="op" id="3200529">(</span><span class="op" id="3200530">[</span><span class="op" id="3200531">]</span><span class="builtintype" id="3200532">byte</span><span class="op" id="3200536">,</span>&nbsp;<span class="ident" id="3200538">IPv4len</span><span class="op" id="3200545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200548">for</span>&nbsp;<span class="ident" id="3200552">l</span><span class="op" id="3200553">,</span>&nbsp;<span class="ident" id="3200555">ok</span>&nbsp;<span class="op" id="3200558">:=</span>&nbsp;<span class="ident" id="3200561">fd</span><span class="op" id="3200563">.</span><span class="ident" id="3200564">readLine</span><span class="op" id="3200572">(</span><span class="op" id="3200573">)</span><span class="op" id="3200574">;</span>&nbsp;<span class="ident" id="3200576">ok</span><span class="op" id="3200578">;</span>&nbsp;<span class="ident" id="3200580">l</span><span class="op" id="3200581">,</span>&nbsp;<span class="ident" id="3200583">ok</span>&nbsp;<span class="op" id="3200586">=</span>&nbsp;<span class="ident" id="3200588">fd</span><span class="op" id="3200590">.</span><span class="ident" id="3200591">readLine</span><span class="op" id="3200599">(</span><span class="op" id="3200600">)</span>&nbsp;<span class="op" id="3200602">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200606">f</span>&nbsp;<span class="op" id="3200608">:=</span>&nbsp;<span class="ident" id="3200611">splitAtBytes</span><span class="op" id="3200623">(</span><span class="ident" id="3200624">l</span><span class="op" id="3200625">,</span>&nbsp;<span class="string" id="3200627">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3200637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200641">if</span>&nbsp;<span class="builtinfunc" id="3200644">len</span><span class="op" id="3200647">(</span><span class="ident" id="3200648">f</span><span class="op" id="3200649">)</span>&nbsp;<span class="op" id="3200651">&lt;</span>&nbsp;<span class="num" id="3200653">4</span>&nbsp;<span class="op" id="3200655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200660">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3200671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200675">switch</span>&nbsp;<span class="op" id="3200682">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200686">case</span>&nbsp;<span class="ident" id="3200691">l</span><span class="op" id="3200692">[</span><span class="num" id="3200693">0</span><span class="op" id="3200694">]</span>&nbsp;<span class="op" id="3200696">!=</span>&nbsp;<span class="string" id="3200699">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3200703">&amp;&amp;</span>&nbsp;<span class="ident" id="3200706">l</span><span class="op" id="3200707">[</span><span class="num" id="3200708">0</span><span class="op" id="3200709">]</span>&nbsp;<span class="op" id="3200711">!=</span>&nbsp;<span class="string" id="3200714">&#39;\t&#39;</span><span class="op" id="3200718">:</span>&nbsp;<span class="comment" id="3200720">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200745">name</span>&nbsp;<span class="op" id="3200750">=</span>&nbsp;<span class="ident" id="3200752">f</span><span class="op" id="3200753">[</span><span class="num" id="3200754">1</span><span class="op" id="3200755">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200759">case</span>&nbsp;<span class="builtinfunc" id="3200764">len</span><span class="op" id="3200767">(</span><span class="ident" id="3200768">f</span><span class="op" id="3200769">[</span><span class="num" id="3200770">0</span><span class="op" id="3200771">]</span><span class="op" id="3200772">)</span>&nbsp;<span class="op" id="3200774">==</span>&nbsp;<span class="num" id="3200777">8</span><span class="op" id="3200778">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200783">if</span>&nbsp;<span class="ident" id="3200786">ifi</span>&nbsp;<span class="op" id="3200790">==</span>&nbsp;<span class="ident" id="3200793">nil</span>&nbsp;<span class="op" id="3200797">||</span>&nbsp;<span class="ident" id="3200800">name</span>&nbsp;<span class="op" id="3200805">==</span>&nbsp;<span class="ident" id="3200808">ifi</span><span class="op" id="3200811">.</span><span class="ident" id="3200812">Name</span>&nbsp;<span class="op" id="3200817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3200823">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3200859">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3200902">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200921">for</span>&nbsp;<span class="ident" id="3200925">i</span>&nbsp;<span class="op" id="3200927">:=</span>&nbsp;<span class="num" id="3200930">0</span><span class="op" id="3200931">;</span>&nbsp;<span class="ident" id="3200933">i</span><span class="op" id="3200934">+</span><span class="num" id="3200935">1</span>&nbsp;<span class="op" id="3200937">&lt;</span>&nbsp;<span class="builtinfunc" id="3200939">len</span><span class="op" id="3200942">(</span><span class="ident" id="3200943">f</span><span class="op" id="3200944">[</span><span class="num" id="3200945">0</span><span class="op" id="3200946">]</span><span class="op" id="3200947">)</span><span class="op" id="3200948">;</span>&nbsp;<span class="ident" id="3200950">i</span>&nbsp;<span class="op" id="3200952">+=</span>&nbsp;<span class="num" id="3200955">2</span>&nbsp;<span class="op" id="3200957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200964">b</span><span class="op" id="3200965">[</span><span class="ident" id="3200966">i</span><span class="op" id="3200967">/</span><span class="num" id="3200968">2</span><span class="op" id="3200969">]</span><span class="op" id="3200970">,</span>&nbsp;<span class="ident" id="3200972">_</span>&nbsp;<span class="op" id="3200974">=</span>&nbsp;<span class="ident" id="3200976">xtoi2</span><span class="op" id="3200981">(</span><span class="ident" id="3200982">f</span><span class="op" id="3200983">[</span><span class="num" id="3200984">0</span><span class="op" id="3200985">]</span><span class="op" id="3200986">[</span><span class="ident" id="3200987">i</span><span class="op" id="3200988">:</span><span class="ident" id="3200989">i</span><span class="op" id="3200990">+</span><span class="num" id="3200991">2</span><span class="op" id="3200992">]</span><span class="op" id="3200993">,</span>&nbsp;<span class="num" id="3200995">0</span><span class="op" id="3200996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201002">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201008">i</span>&nbsp;<span class="op" id="3201010">:=</span>&nbsp;<span class="op" id="3201013">*</span><span class="op" id="3201014">(</span><span class="op" id="3201015">*</span><span class="builtintype" id="3201016">uint32</span><span class="op" id="3201022">)</span><span class="op" id="3201023">(</span><span class="ident" id="3201024">unsafe</span><span class="op" id="3201030">.</span><span class="ident" id="3201031">Pointer</span><span class="op" id="3201038">(</span><span class="op" id="3201039">&amp;</span><span class="ident" id="3201040">b</span><span class="op" id="3201041">[</span><span class="op" id="3201042">:</span><span class="num" id="3201043">4</span><span class="op" id="3201044">]</span><span class="op" id="3201045">[</span><span class="num" id="3201046">0</span><span class="op" id="3201047">]</span><span class="op" id="3201048">)</span><span class="op" id="3201049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201055">ifma</span>&nbsp;<span class="op" id="3201060">:=</span>&nbsp;<span class="ident" id="3201063">IPAddr</span><span class="op" id="3201069">{</span><span class="ident" id="3201070">IP</span><span class="op" id="3201072">:</span>&nbsp;<span class="ident" id="3201074">IPv4</span><span class="op" id="3201078">(</span><span class="builtintype" id="3201079">byte</span><span class="op" id="3201083">(</span><span class="ident" id="3201084">i</span><span class="op" id="3201085">&gt;&gt;</span><span class="num" id="3201087">24</span><span class="op" id="3201089">)</span><span class="op" id="3201090">,</span>&nbsp;<span class="builtintype" id="3201092">byte</span><span class="op" id="3201096">(</span><span class="ident" id="3201097">i</span><span class="op" id="3201098">&gt;&gt;</span><span class="num" id="3201100">16</span><span class="op" id="3201102">)</span><span class="op" id="3201103">,</span>&nbsp;<span class="builtintype" id="3201105">byte</span><span class="op" id="3201109">(</span><span class="ident" id="3201110">i</span><span class="op" id="3201111">&gt;&gt;</span><span class="num" id="3201113">8</span><span class="op" id="3201114">)</span><span class="op" id="3201115">,</span>&nbsp;<span class="builtintype" id="3201117">byte</span><span class="op" id="3201121">(</span><span class="ident" id="3201122">i</span><span class="op" id="3201123">)</span><span class="op" id="3201124">)</span><span class="op" id="3201125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201131">ifmat</span>&nbsp;<span class="op" id="3201137">=</span>&nbsp;<span class="builtinfunc" id="3201139">append</span><span class="op" id="3201145">(</span><span class="ident" id="3201146">ifmat</span><span class="op" id="3201151">,</span>&nbsp;<span class="ident" id="3201153">ifma</span><span class="op" id="3201157">.</span><span class="ident" id="3201158">toAddr</span><span class="op" id="3201164">(</span><span class="op" id="3201165">)</span><span class="op" id="3201166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201175">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201181">return</span>&nbsp;<span class="ident" id="3201188">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3201194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3201197">func</span>&nbsp;<span class="ident" id="3201202">parseProcNetIGMP6</span><span class="op" id="3201219">(</span><span class="ident" id="3201220">path</span>&nbsp;<span class="builtintype" id="3201225">string</span><span class="op" id="3201231">,</span>&nbsp;<span class="ident" id="3201233">ifi</span>&nbsp;<span class="op" id="3201237">*</span><span class="ident" id="3201238">Interface</span><span class="op" id="3201247">)</span>&nbsp;<span class="op" id="3201249">[</span><span class="op" id="3201250">]</span><span class="ident" id="3201251">Addr</span>&nbsp;<span class="op" id="3201256">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201259">fd</span><span class="op" id="3201261">,</span>&nbsp;<span class="ident" id="3201263">err</span>&nbsp;<span class="op" id="3201267">:=</span>&nbsp;<span class="ident" id="3201270">open</span><span class="op" id="3201274">(</span><span class="ident" id="3201275">path</span><span class="op" id="3201279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201282">if</span>&nbsp;<span class="ident" id="3201285">err</span>&nbsp;<span class="op" id="3201289">!=</span>&nbsp;<span class="ident" id="3201292">nil</span>&nbsp;<span class="op" id="3201296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201300">return</span>&nbsp;<span class="ident" id="3201307">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201315">defer</span>&nbsp;<span class="ident" id="3201321">fd</span><span class="op" id="3201323">.</span><span class="builtinfunc" id="3201324">close</span><span class="op" id="3201329">(</span><span class="op" id="3201330">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201333">var</span>&nbsp;<span class="ident" id="3201337">ifmat</span>&nbsp;<span class="op" id="3201343">[</span><span class="op" id="3201344">]</span><span class="ident" id="3201345">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201351">b</span>&nbsp;<span class="op" id="3201353">:=</span>&nbsp;<span class="builtinfunc" id="3201356">make</span><span class="op" id="3201360">(</span><span class="op" id="3201361">[</span><span class="op" id="3201362">]</span><span class="builtintype" id="3201363">byte</span><span class="op" id="3201367">,</span>&nbsp;<span class="ident" id="3201369">IPv6len</span><span class="op" id="3201376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201379">for</span>&nbsp;<span class="ident" id="3201383">l</span><span class="op" id="3201384">,</span>&nbsp;<span class="ident" id="3201386">ok</span>&nbsp;<span class="op" id="3201389">:=</span>&nbsp;<span class="ident" id="3201392">fd</span><span class="op" id="3201394">.</span><span class="ident" id="3201395">readLine</span><span class="op" id="3201403">(</span><span class="op" id="3201404">)</span><span class="op" id="3201405">;</span>&nbsp;<span class="ident" id="3201407">ok</span><span class="op" id="3201409">;</span>&nbsp;<span class="ident" id="3201411">l</span><span class="op" id="3201412">,</span>&nbsp;<span class="ident" id="3201414">ok</span>&nbsp;<span class="op" id="3201417">=</span>&nbsp;<span class="ident" id="3201419">fd</span><span class="op" id="3201421">.</span><span class="ident" id="3201422">readLine</span><span class="op" id="3201430">(</span><span class="op" id="3201431">)</span>&nbsp;<span class="op" id="3201433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201437">f</span>&nbsp;<span class="op" id="3201439">:=</span>&nbsp;<span class="ident" id="3201442">splitAtBytes</span><span class="op" id="3201454">(</span><span class="ident" id="3201455">l</span><span class="op" id="3201456">,</span>&nbsp;<span class="string" id="3201458">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3201467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201471">if</span>&nbsp;<span class="builtinfunc" id="3201474">len</span><span class="op" id="3201477">(</span><span class="ident" id="3201478">f</span><span class="op" id="3201479">)</span>&nbsp;<span class="op" id="3201481">&lt;</span>&nbsp;<span class="num" id="3201483">6</span>&nbsp;<span class="op" id="3201485">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201490">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201505">if</span>&nbsp;<span class="ident" id="3201508">ifi</span>&nbsp;<span class="op" id="3201512">==</span>&nbsp;<span class="ident" id="3201515">nil</span>&nbsp;<span class="op" id="3201519">||</span>&nbsp;<span class="ident" id="3201522">f</span><span class="op" id="3201523">[</span><span class="num" id="3201524">1</span><span class="op" id="3201525">]</span>&nbsp;<span class="op" id="3201527">==</span>&nbsp;<span class="ident" id="3201530">ifi</span><span class="op" id="3201533">.</span><span class="ident" id="3201534">Name</span>&nbsp;<span class="op" id="3201539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201544">for</span>&nbsp;<span class="ident" id="3201548">i</span>&nbsp;<span class="op" id="3201550">:=</span>&nbsp;<span class="num" id="3201553">0</span><span class="op" id="3201554">;</span>&nbsp;<span class="ident" id="3201556">i</span><span class="op" id="3201557">+</span><span class="num" id="3201558">1</span>&nbsp;<span class="op" id="3201560">&lt;</span>&nbsp;<span class="builtinfunc" id="3201562">len</span><span class="op" id="3201565">(</span><span class="ident" id="3201566">f</span><span class="op" id="3201567">[</span><span class="num" id="3201568">2</span><span class="op" id="3201569">]</span><span class="op" id="3201570">)</span><span class="op" id="3201571">;</span>&nbsp;<span class="ident" id="3201573">i</span>&nbsp;<span class="op" id="3201575">+=</span>&nbsp;<span class="num" id="3201578">2</span>&nbsp;<span class="op" id="3201580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201586">b</span><span class="op" id="3201587">[</span><span class="ident" id="3201588">i</span><span class="op" id="3201589">/</span><span class="num" id="3201590">2</span><span class="op" id="3201591">]</span><span class="op" id="3201592">,</span>&nbsp;<span class="ident" id="3201594">_</span>&nbsp;<span class="op" id="3201596">=</span>&nbsp;<span class="ident" id="3201598">xtoi2</span><span class="op" id="3201603">(</span><span class="ident" id="3201604">f</span><span class="op" id="3201605">[</span><span class="num" id="3201606">2</span><span class="op" id="3201607">]</span><span class="op" id="3201608">[</span><span class="ident" id="3201609">i</span><span class="op" id="3201610">:</span><span class="ident" id="3201611">i</span><span class="op" id="3201612">+</span><span class="num" id="3201613">2</span><span class="op" id="3201614">]</span><span class="op" id="3201615">,</span>&nbsp;<span class="num" id="3201617">0</span><span class="op" id="3201618">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201628">ifma</span>&nbsp;<span class="op" id="3201633">:=</span>&nbsp;<span class="ident" id="3201636">IPAddr</span><span class="op" id="3201642">{</span><span class="ident" id="3201643">IP</span><span class="op" id="3201645">:</span>&nbsp;<span class="ident" id="3201647">IP</span><span class="op" id="3201649">{</span><span class="ident" id="3201650">b</span><span class="op" id="3201651">[</span><span class="num" id="3201652">0</span><span class="op" id="3201653">]</span><span class="op" id="3201654">,</span>&nbsp;<span class="ident" id="3201656">b</span><span class="op" id="3201657">[</span><span class="num" id="3201658">1</span><span class="op" id="3201659">]</span><span class="op" id="3201660">,</span>&nbsp;<span class="ident" id="3201662">b</span><span class="op" id="3201663">[</span><span class="num" id="3201664">2</span><span class="op" id="3201665">]</span><span class="op" id="3201666">,</span>&nbsp;<span class="ident" id="3201668">b</span><span class="op" id="3201669">[</span><span class="num" id="3201670">3</span><span class="op" id="3201671">]</span><span class="op" id="3201672">,</span>&nbsp;<span class="ident" id="3201674">b</span><span class="op" id="3201675">[</span><span class="num" id="3201676">4</span><span class="op" id="3201677">]</span><span class="op" id="3201678">,</span>&nbsp;<span class="ident" id="3201680">b</span><span class="op" id="3201681">[</span><span class="num" id="3201682">5</span><span class="op" id="3201683">]</span><span class="op" id="3201684">,</span>&nbsp;<span class="ident" id="3201686">b</span><span class="op" id="3201687">[</span><span class="num" id="3201688">6</span><span class="op" id="3201689">]</span><span class="op" id="3201690">,</span>&nbsp;<span class="ident" id="3201692">b</span><span class="op" id="3201693">[</span><span class="num" id="3201694">7</span><span class="op" id="3201695">]</span><span class="op" id="3201696">,</span>&nbsp;<span class="ident" id="3201698">b</span><span class="op" id="3201699">[</span><span class="num" id="3201700">8</span><span class="op" id="3201701">]</span><span class="op" id="3201702">,</span>&nbsp;<span class="ident" id="3201704">b</span><span class="op" id="3201705">[</span><span class="num" id="3201706">9</span><span class="op" id="3201707">]</span><span class="op" id="3201708">,</span>&nbsp;<span class="ident" id="3201710">b</span><span class="op" id="3201711">[</span><span class="num" id="3201712">10</span><span class="op" id="3201714">]</span><span class="op" id="3201715">,</span>&nbsp;<span class="ident" id="3201717">b</span><span class="op" id="3201718">[</span><span class="num" id="3201719">11</span><span class="op" id="3201721">]</span><span class="op" id="3201722">,</span>&nbsp;<span class="ident" id="3201724">b</span><span class="op" id="3201725">[</span><span class="num" id="3201726">12</span><span class="op" id="3201728">]</span><span class="op" id="3201729">,</span>&nbsp;<span class="ident" id="3201731">b</span><span class="op" id="3201732">[</span><span class="num" id="3201733">13</span><span class="op" id="3201735">]</span><span class="op" id="3201736">,</span>&nbsp;<span class="ident" id="3201738">b</span><span class="op" id="3201739">[</span><span class="num" id="3201740">14</span><span class="op" id="3201742">]</span><span class="op" id="3201743">,</span>&nbsp;<span class="ident" id="3201745">b</span><span class="op" id="3201746">[</span><span class="num" id="3201747">15</span><span class="op" id="3201749">]</span><span class="op" id="3201750">}</span><span class="op" id="3201751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201756">ifmat</span>&nbsp;<span class="op" id="3201762">=</span>&nbsp;<span class="builtinfunc" id="3201764">append</span><span class="op" id="3201770">(</span><span class="ident" id="3201771">ifmat</span><span class="op" id="3201776">,</span>&nbsp;<span class="ident" id="3201778">ifma</span><span class="op" id="3201782">.</span><span class="ident" id="3201783">toAddr</span><span class="op" id="3201789">(</span><span class="op" id="3201790">)</span><span class="op" id="3201791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201798">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201801">return</span>&nbsp;<span class="ident" id="3201808">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3201814">}</span>
</div>
</body>
</html>
