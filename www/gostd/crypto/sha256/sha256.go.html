<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha256</h2>
<ul>
<li><a href="/gostd/crypto/sha256/sha256.go.html">sha256.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256_test.go.html">sha256_test.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256block_decl.go.html">sha256block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4076305">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4076360">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4076414">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4076465">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4076543">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4076561">package</span>&nbsp;<span class="ident" id="4076569">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4076577">import</span>&nbsp;<span class="op" id="4076584">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4076587">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4076597">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4076604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4076607">func</span>&nbsp;<span class="ident" id="4076612">init</span><span class="op" id="4076616">(</span><span class="op" id="4076617">)</span>&nbsp;<span class="op" id="4076619">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076622">crypto</span><span class="op" id="4076628">.</span><span class="ident" id="4076629">RegisterHash</span><span class="op" id="4076641">(</span><span class="ident" id="4076642">crypto</span><span class="op" id="4076648">.</span><span class="ident" id="4076649">SHA224</span><span class="op" id="4076655">,</span>&nbsp;<span class="ident" id="4076657">New224</span><span class="op" id="4076663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076666">crypto</span><span class="op" id="4076672">.</span><span class="ident" id="4076673">RegisterHash</span><span class="op" id="4076685">(</span><span class="ident" id="4076686">crypto</span><span class="op" id="4076692">.</span><span class="ident" id="4076693">SHA256</span><span class="op" id="4076699">,</span>&nbsp;<span class="ident" id="4076701">New</span><span class="op" id="4076704">)</span><br>
<span class="lineno"></span><span class="op" id="4076706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4076709">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4076752">const</span>&nbsp;<span class="ident" id="4076758">Size</span>&nbsp;<span class="op" id="4076763">=</span>&nbsp;<span class="num" id="4076765">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4076769">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4076812">const</span>&nbsp;<span class="ident" id="4076818">Size224</span>&nbsp;<span class="op" id="4076826">=</span>&nbsp;<span class="num" id="4076828">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4076832">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4076880">const</span>&nbsp;<span class="ident" id="4076886">BlockSize</span>&nbsp;<span class="op" id="4076896">=</span>&nbsp;<span class="num" id="4076898">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4076902">const</span>&nbsp;<span class="op" id="4076908">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076911">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4076921">=</span>&nbsp;<span class="num" id="4076923">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076927">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4076937">=</span>&nbsp;<span class="num" id="4076939">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076951">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4076961">=</span>&nbsp;<span class="num" id="4076963">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076975">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4076985">=</span>&nbsp;<span class="num" id="4076987">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076999">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077009">=</span>&nbsp;<span class="num" id="4077011">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077023">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077033">=</span>&nbsp;<span class="num" id="4077035">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077047">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077057">=</span>&nbsp;<span class="num" id="4077059">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077071">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077081">=</span>&nbsp;<span class="num" id="4077083">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077095">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077105">=</span>&nbsp;<span class="num" id="4077107">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077119">init0_224</span>&nbsp;<span class="op" id="4077129">=</span>&nbsp;<span class="num" id="4077131">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077143">init1_224</span>&nbsp;<span class="op" id="4077153">=</span>&nbsp;<span class="num" id="4077155">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077167">init2_224</span>&nbsp;<span class="op" id="4077177">=</span>&nbsp;<span class="num" id="4077179">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077191">init3_224</span>&nbsp;<span class="op" id="4077201">=</span>&nbsp;<span class="num" id="4077203">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077215">init4_224</span>&nbsp;<span class="op" id="4077225">=</span>&nbsp;<span class="num" id="4077227">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077239">init5_224</span>&nbsp;<span class="op" id="4077249">=</span>&nbsp;<span class="num" id="4077251">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077263">init6_224</span>&nbsp;<span class="op" id="4077273">=</span>&nbsp;<span class="num" id="4077275">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077287">init7_224</span>&nbsp;<span class="op" id="4077297">=</span>&nbsp;<span class="num" id="4077299">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4077310">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4077313">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4077372">type</span>&nbsp;<span class="ident" id="4077377">digest</span>&nbsp;<span class="keyword" id="4077384">struct</span>&nbsp;<span class="op" id="4077391">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077394">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077400">[</span><span class="num" id="4077401">8</span><span class="op" id="4077402">]</span><span class="builtintype" id="4077403">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077411">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077417">[</span><span class="ident" id="4077418">chunk</span><span class="op" id="4077423">]</span><span class="builtintype" id="4077424">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077430">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4077436">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4077441">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4077447">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077455">is224</span>&nbsp;<span class="builtintype" id="4077461">bool</span>&nbsp;<span class="comment" id="4077466">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4077500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4077503">func</span>&nbsp;<span class="op" id="4077508">(</span><span class="ident" id="4077509">d</span>&nbsp;<span class="op" id="4077511">*</span><span class="ident" id="4077512">digest</span><span class="op" id="4077518">)</span>&nbsp;<span class="ident" id="4077520">Reset</span><span class="op" id="4077525">(</span><span class="op" id="4077526">)</span>&nbsp;<span class="op" id="4077528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077531">if</span>&nbsp;<span class="op" id="4077534">!</span><span class="ident" id="4077535">d</span><span class="op" id="4077536">.</span><span class="ident" id="4077537">is224</span>&nbsp;<span class="op" id="4077543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077547">d</span><span class="op" id="4077548">.</span><span class="ident" id="4077549">h</span><span class="op" id="4077550">[</span><span class="num" id="4077551">0</span><span class="op" id="4077552">]</span>&nbsp;<span class="op" id="4077554">=</span>&nbsp;<span class="ident" id="4077556">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077564">d</span><span class="op" id="4077565">.</span><span class="ident" id="4077566">h</span><span class="op" id="4077567">[</span><span class="num" id="4077568">1</span><span class="op" id="4077569">]</span>&nbsp;<span class="op" id="4077571">=</span>&nbsp;<span class="ident" id="4077573">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077581">d</span><span class="op" id="4077582">.</span><span class="ident" id="4077583">h</span><span class="op" id="4077584">[</span><span class="num" id="4077585">2</span><span class="op" id="4077586">]</span>&nbsp;<span class="op" id="4077588">=</span>&nbsp;<span class="ident" id="4077590">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077598">d</span><span class="op" id="4077599">.</span><span class="ident" id="4077600">h</span><span class="op" id="4077601">[</span><span class="num" id="4077602">3</span><span class="op" id="4077603">]</span>&nbsp;<span class="op" id="4077605">=</span>&nbsp;<span class="ident" id="4077607">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077615">d</span><span class="op" id="4077616">.</span><span class="ident" id="4077617">h</span><span class="op" id="4077618">[</span><span class="num" id="4077619">4</span><span class="op" id="4077620">]</span>&nbsp;<span class="op" id="4077622">=</span>&nbsp;<span class="ident" id="4077624">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077632">d</span><span class="op" id="4077633">.</span><span class="ident" id="4077634">h</span><span class="op" id="4077635">[</span><span class="num" id="4077636">5</span><span class="op" id="4077637">]</span>&nbsp;<span class="op" id="4077639">=</span>&nbsp;<span class="ident" id="4077641">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077649">d</span><span class="op" id="4077650">.</span><span class="ident" id="4077651">h</span><span class="op" id="4077652">[</span><span class="num" id="4077653">6</span><span class="op" id="4077654">]</span>&nbsp;<span class="op" id="4077656">=</span>&nbsp;<span class="ident" id="4077658">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077666">d</span><span class="op" id="4077667">.</span><span class="ident" id="4077668">h</span><span class="op" id="4077669">[</span><span class="num" id="4077670">7</span><span class="op" id="4077671">]</span>&nbsp;<span class="op" id="4077673">=</span>&nbsp;<span class="ident" id="4077675">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077682">}</span>&nbsp;<span class="keyword" id="4077684">else</span>&nbsp;<span class="op" id="4077689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077693">d</span><span class="op" id="4077694">.</span><span class="ident" id="4077695">h</span><span class="op" id="4077696">[</span><span class="num" id="4077697">0</span><span class="op" id="4077698">]</span>&nbsp;<span class="op" id="4077700">=</span>&nbsp;<span class="ident" id="4077702">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077714">d</span><span class="op" id="4077715">.</span><span class="ident" id="4077716">h</span><span class="op" id="4077717">[</span><span class="num" id="4077718">1</span><span class="op" id="4077719">]</span>&nbsp;<span class="op" id="4077721">=</span>&nbsp;<span class="ident" id="4077723">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077735">d</span><span class="op" id="4077736">.</span><span class="ident" id="4077737">h</span><span class="op" id="4077738">[</span><span class="num" id="4077739">2</span><span class="op" id="4077740">]</span>&nbsp;<span class="op" id="4077742">=</span>&nbsp;<span class="ident" id="4077744">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077756">d</span><span class="op" id="4077757">.</span><span class="ident" id="4077758">h</span><span class="op" id="4077759">[</span><span class="num" id="4077760">3</span><span class="op" id="4077761">]</span>&nbsp;<span class="op" id="4077763">=</span>&nbsp;<span class="ident" id="4077765">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077777">d</span><span class="op" id="4077778">.</span><span class="ident" id="4077779">h</span><span class="op" id="4077780">[</span><span class="num" id="4077781">4</span><span class="op" id="4077782">]</span>&nbsp;<span class="op" id="4077784">=</span>&nbsp;<span class="ident" id="4077786">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077798">d</span><span class="op" id="4077799">.</span><span class="ident" id="4077800">h</span><span class="op" id="4077801">[</span><span class="num" id="4077802">5</span><span class="op" id="4077803">]</span>&nbsp;<span class="op" id="4077805">=</span>&nbsp;<span class="ident" id="4077807">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077819">d</span><span class="op" id="4077820">.</span><span class="ident" id="4077821">h</span><span class="op" id="4077822">[</span><span class="num" id="4077823">6</span><span class="op" id="4077824">]</span>&nbsp;<span class="op" id="4077826">=</span>&nbsp;<span class="ident" id="4077828">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077840">d</span><span class="op" id="4077841">.</span><span class="ident" id="4077842">h</span><span class="op" id="4077843">[</span><span class="num" id="4077844">7</span><span class="op" id="4077845">]</span>&nbsp;<span class="op" id="4077847">=</span>&nbsp;<span class="ident" id="4077849">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077863">d</span><span class="op" id="4077864">.</span><span class="ident" id="4077865">nx</span>&nbsp;<span class="op" id="4077868">=</span>&nbsp;<span class="num" id="4077870">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077873">d</span><span class="op" id="4077874">.</span><span class="builtinfunc" id="4077875">len</span>&nbsp;<span class="op" id="4077879">=</span>&nbsp;<span class="num" id="4077881">0</span><br>
<span class="lineno"></span><span class="op" id="4077883">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4077886">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4077948">func</span>&nbsp;<span class="ident" id="4077953">New</span><span class="op" id="4077956">(</span><span class="op" id="4077957">)</span>&nbsp;<span class="ident" id="4077959">hash</span><span class="op" id="4077963">.</span><span class="ident" id="4077964">Hash</span>&nbsp;<span class="op" id="4077969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077972">d</span>&nbsp;<span class="op" id="4077974">:=</span>&nbsp;<span class="builtinfunc" id="4077977">new</span><span class="op" id="4077980">(</span><span class="ident" id="4077981">digest</span><span class="op" id="4077987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077990">d</span><span class="op" id="4077991">.</span><span class="ident" id="4077992">Reset</span><span class="op" id="4077997">(</span><span class="op" id="4077998">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078001">return</span>&nbsp;<span class="ident" id="4078008">d</span><br>
<span class="lineno"></span><span class="op" id="4078010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4078013">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4078078">func</span>&nbsp;<span class="ident" id="4078083">New224</span><span class="op" id="4078089">(</span><span class="op" id="4078090">)</span>&nbsp;<span class="ident" id="4078092">hash</span><span class="op" id="4078096">.</span><span class="ident" id="4078097">Hash</span>&nbsp;<span class="op" id="4078102">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078105">d</span>&nbsp;<span class="op" id="4078107">:=</span>&nbsp;<span class="builtinfunc" id="4078110">new</span><span class="op" id="4078113">(</span><span class="ident" id="4078114">digest</span><span class="op" id="4078120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078123">d</span><span class="op" id="4078124">.</span><span class="ident" id="4078125">is224</span>&nbsp;<span class="op" id="4078131">=</span>&nbsp;<span class="builtintype" id="4078133">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078139">d</span><span class="op" id="4078140">.</span><span class="ident" id="4078141">Reset</span><span class="op" id="4078146">(</span><span class="op" id="4078147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078150">return</span>&nbsp;<span class="ident" id="4078157">d</span><br>
<span class="lineno"></span><span class="op" id="4078159">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4078162">func</span>&nbsp;<span class="op" id="4078167">(</span><span class="ident" id="4078168">d</span>&nbsp;<span class="op" id="4078170">*</span><span class="ident" id="4078171">digest</span><span class="op" id="4078177">)</span>&nbsp;<span class="ident" id="4078179">Size</span><span class="op" id="4078183">(</span><span class="op" id="4078184">)</span>&nbsp;<span class="builtintype" id="4078186">int</span>&nbsp;<span class="op" id="4078190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078193">if</span>&nbsp;<span class="op" id="4078196">!</span><span class="ident" id="4078197">d</span><span class="op" id="4078198">.</span><span class="ident" id="4078199">is224</span>&nbsp;<span class="op" id="4078205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078209">return</span>&nbsp;<span class="ident" id="4078216">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078222">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078225">return</span>&nbsp;<span class="ident" id="4078232">Size224</span><br>
<span class="lineno"></span><span class="op" id="4078240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4078243">func</span>&nbsp;<span class="op" id="4078248">(</span><span class="ident" id="4078249">d</span>&nbsp;<span class="op" id="4078251">*</span><span class="ident" id="4078252">digest</span><span class="op" id="4078258">)</span>&nbsp;<span class="ident" id="4078260">BlockSize</span><span class="op" id="4078269">(</span><span class="op" id="4078270">)</span>&nbsp;<span class="builtintype" id="4078272">int</span>&nbsp;<span class="op" id="4078276">{</span>&nbsp;<span class="keyword" id="4078278">return</span>&nbsp;<span class="ident" id="4078285">BlockSize</span>&nbsp;<span class="op" id="4078295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4078298">func</span>&nbsp;<span class="op" id="4078303">(</span><span class="ident" id="4078304">d</span>&nbsp;<span class="op" id="4078306">*</span><span class="ident" id="4078307">digest</span><span class="op" id="4078313">)</span>&nbsp;<span class="ident" id="4078315">Write</span><span class="op" id="4078320">(</span><span class="ident" id="4078321">p</span>&nbsp;<span class="op" id="4078323">[</span><span class="op" id="4078324">]</span><span class="builtintype" id="4078325">byte</span><span class="op" id="4078329">)</span>&nbsp;<span class="op" id="4078331">(</span><span class="ident" id="4078332">nn</span>&nbsp;<span class="builtintype" id="4078335">int</span><span class="op" id="4078338">,</span>&nbsp;<span class="ident" id="4078340">err</span>&nbsp;<span class="builtintype" id="4078344">error</span><span class="op" id="4078349">)</span>&nbsp;<span class="op" id="4078351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078354">nn</span>&nbsp;<span class="op" id="4078357">=</span>&nbsp;<span class="builtinfunc" id="4078359">len</span><span class="op" id="4078362">(</span><span class="ident" id="4078363">p</span><span class="op" id="4078364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078367">d</span><span class="op" id="4078368">.</span><span class="builtinfunc" id="4078369">len</span>&nbsp;<span class="op" id="4078373">+=</span>&nbsp;<span class="ident" id="4078376">uint64</span><span class="op" id="4078382">(</span><span class="ident" id="4078383">nn</span><span class="op" id="4078385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078388">if</span>&nbsp;<span class="ident" id="4078391">d</span><span class="op" id="4078392">.</span><span class="ident" id="4078393">nx</span>&nbsp;<span class="op" id="4078396">&gt;</span>&nbsp;<span class="num" id="4078398">0</span>&nbsp;<span class="op" id="4078400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078404">n</span>&nbsp;<span class="op" id="4078406">:=</span>&nbsp;<span class="builtinfunc" id="4078409">copy</span><span class="op" id="4078413">(</span><span class="ident" id="4078414">d</span><span class="op" id="4078415">.</span><span class="ident" id="4078416">x</span><span class="op" id="4078417">[</span><span class="ident" id="4078418">d</span><span class="op" id="4078419">.</span><span class="ident" id="4078420">nx</span><span class="op" id="4078422">:</span><span class="op" id="4078423">]</span><span class="op" id="4078424">,</span>&nbsp;<span class="ident" id="4078426">p</span><span class="op" id="4078427">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078431">d</span><span class="op" id="4078432">.</span><span class="ident" id="4078433">nx</span>&nbsp;<span class="op" id="4078436">+=</span>&nbsp;<span class="ident" id="4078439">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078443">if</span>&nbsp;<span class="ident" id="4078446">d</span><span class="op" id="4078447">.</span><span class="ident" id="4078448">nx</span>&nbsp;<span class="op" id="4078451">==</span>&nbsp;<span class="ident" id="4078454">chunk</span>&nbsp;<span class="op" id="4078460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078465">block</span><span class="op" id="4078470">(</span><span class="ident" id="4078471">d</span><span class="op" id="4078472">,</span>&nbsp;<span class="ident" id="4078474">d</span><span class="op" id="4078475">.</span><span class="ident" id="4078476">x</span><span class="op" id="4078477">[</span><span class="op" id="4078478">:</span><span class="op" id="4078479">]</span><span class="op" id="4078480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078485">d</span><span class="op" id="4078486">.</span><span class="ident" id="4078487">nx</span>&nbsp;<span class="op" id="4078490">=</span>&nbsp;<span class="num" id="4078492">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078496">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078500">p</span>&nbsp;<span class="op" id="4078502">=</span>&nbsp;<span class="ident" id="4078504">p</span><span class="op" id="4078505">[</span><span class="ident" id="4078506">n</span><span class="op" id="4078507">:</span><span class="op" id="4078508">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078514">if</span>&nbsp;<span class="builtinfunc" id="4078517">len</span><span class="op" id="4078520">(</span><span class="ident" id="4078521">p</span><span class="op" id="4078522">)</span>&nbsp;<span class="op" id="4078524">&gt;=</span>&nbsp;<span class="ident" id="4078527">chunk</span>&nbsp;<span class="op" id="4078533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078537">n</span>&nbsp;<span class="op" id="4078539">:=</span>&nbsp;<span class="builtinfunc" id="4078542">len</span><span class="op" id="4078545">(</span><span class="ident" id="4078546">p</span><span class="op" id="4078547">)</span>&nbsp;<span class="op" id="4078549">&amp;^</span>&nbsp;<span class="op" id="4078552">(</span><span class="ident" id="4078553">chunk</span>&nbsp;<span class="op" id="4078559">-</span>&nbsp;<span class="num" id="4078561">1</span><span class="op" id="4078562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078566">block</span><span class="op" id="4078571">(</span><span class="ident" id="4078572">d</span><span class="op" id="4078573">,</span>&nbsp;<span class="ident" id="4078575">p</span><span class="op" id="4078576">[</span><span class="op" id="4078577">:</span><span class="ident" id="4078578">n</span><span class="op" id="4078579">]</span><span class="op" id="4078580">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078584">p</span>&nbsp;<span class="op" id="4078586">=</span>&nbsp;<span class="ident" id="4078588">p</span><span class="op" id="4078589">[</span><span class="ident" id="4078590">n</span><span class="op" id="4078591">:</span><span class="op" id="4078592">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078598">if</span>&nbsp;<span class="builtinfunc" id="4078601">len</span><span class="op" id="4078604">(</span><span class="ident" id="4078605">p</span><span class="op" id="4078606">)</span>&nbsp;<span class="op" id="4078608">&gt;</span>&nbsp;<span class="num" id="4078610">0</span>&nbsp;<span class="op" id="4078612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078616">d</span><span class="op" id="4078617">.</span><span class="ident" id="4078618">nx</span>&nbsp;<span class="op" id="4078621">=</span>&nbsp;<span class="builtinfunc" id="4078623">copy</span><span class="op" id="4078627">(</span><span class="ident" id="4078628">d</span><span class="op" id="4078629">.</span><span class="ident" id="4078630">x</span><span class="op" id="4078631">[</span><span class="op" id="4078632">:</span><span class="op" id="4078633">]</span><span class="op" id="4078634">,</span>&nbsp;<span class="ident" id="4078636">p</span><span class="op" id="4078637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078640">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078643">return</span><br>
<span class="lineno"></span><span class="op" id="4078650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4078653">func</span>&nbsp;<span class="op" id="4078658">(</span><span class="ident" id="4078659">d0</span>&nbsp;<span class="op" id="4078662">*</span><span class="ident" id="4078663">digest</span><span class="op" id="4078669">)</span>&nbsp;<span class="ident" id="4078671">Sum</span><span class="op" id="4078674">(</span><span class="ident" id="4078675">in</span>&nbsp;<span class="op" id="4078678">[</span><span class="op" id="4078679">]</span><span class="builtintype" id="4078680">byte</span><span class="op" id="4078684">)</span>&nbsp;<span class="op" id="4078686">[</span><span class="op" id="4078687">]</span><span class="builtintype" id="4078688">byte</span>&nbsp;<span class="op" id="4078693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4078696">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078763">d</span>&nbsp;<span class="op" id="4078765">:=</span>&nbsp;<span class="op" id="4078768">*</span><span class="ident" id="4078769">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078773">hash</span>&nbsp;<span class="op" id="4078778">:=</span>&nbsp;<span class="ident" id="4078781">d</span><span class="op" id="4078782">.</span><span class="ident" id="4078783">checkSum</span><span class="op" id="4078791">(</span><span class="op" id="4078792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078795">if</span>&nbsp;<span class="ident" id="4078798">d</span><span class="op" id="4078799">.</span><span class="ident" id="4078800">is224</span>&nbsp;<span class="op" id="4078806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078810">return</span>&nbsp;<span class="builtinfunc" id="4078817">append</span><span class="op" id="4078823">(</span><span class="ident" id="4078824">in</span><span class="op" id="4078826">,</span>&nbsp;<span class="ident" id="4078828">hash</span><span class="op" id="4078832">[</span><span class="op" id="4078833">:</span><span class="ident" id="4078834">Size224</span><span class="op" id="4078841">]</span><span class="op" id="4078842">...</span><span class="op" id="4078845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078848">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078851">return</span>&nbsp;<span class="builtinfunc" id="4078858">append</span><span class="op" id="4078864">(</span><span class="ident" id="4078865">in</span><span class="op" id="4078867">,</span>&nbsp;<span class="ident" id="4078869">hash</span><span class="op" id="4078873">[</span><span class="op" id="4078874">:</span><span class="op" id="4078875">]</span><span class="op" id="4078876">...</span><span class="op" id="4078879">)</span><br>
<span class="lineno"></span><span class="op" id="4078881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4078884">func</span>&nbsp;<span class="op" id="4078889">(</span><span class="ident" id="4078890">d</span>&nbsp;<span class="op" id="4078892">*</span><span class="ident" id="4078893">digest</span><span class="op" id="4078899">)</span>&nbsp;<span class="ident" id="4078901">checkSum</span><span class="op" id="4078909">(</span><span class="op" id="4078910">)</span>&nbsp;<span class="op" id="4078912">[</span><span class="ident" id="4078913">Size</span><span class="op" id="4078917">]</span><span class="builtintype" id="4078918">byte</span>&nbsp;<span class="op" id="4078923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4078926">len</span>&nbsp;<span class="op" id="4078930">:=</span>&nbsp;<span class="ident" id="4078933">d</span><span class="op" id="4078934">.</span><span class="builtinfunc" id="4078935">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4078940">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079000">var</span>&nbsp;<span class="ident" id="4079004">tmp</span>&nbsp;<span class="op" id="4079008">[</span><span class="num" id="4079009">64</span><span class="op" id="4079011">]</span><span class="builtintype" id="4079012">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079018">tmp</span><span class="op" id="4079021">[</span><span class="num" id="4079022">0</span><span class="op" id="4079023">]</span>&nbsp;<span class="op" id="4079025">=</span>&nbsp;<span class="num" id="4079027">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079033">if</span>&nbsp;<span class="builtinfunc" id="4079036">len</span><span class="op" id="4079039">%</span><span class="num" id="4079040">64</span>&nbsp;<span class="op" id="4079043">&lt;</span>&nbsp;<span class="num" id="4079045">56</span>&nbsp;<span class="op" id="4079048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079052">d</span><span class="op" id="4079053">.</span><span class="ident" id="4079054">Write</span><span class="op" id="4079059">(</span><span class="ident" id="4079060">tmp</span><span class="op" id="4079063">[</span><span class="num" id="4079064">0</span>&nbsp;<span class="op" id="4079066">:</span>&nbsp;<span class="num" id="4079068">56</span><span class="op" id="4079070">-</span><span class="builtinfunc" id="4079071">len</span><span class="op" id="4079074">%</span><span class="num" id="4079075">64</span><span class="op" id="4079077">]</span><span class="op" id="4079078">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4079081">}</span>&nbsp;<span class="keyword" id="4079083">else</span>&nbsp;<span class="op" id="4079088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079092">d</span><span class="op" id="4079093">.</span><span class="ident" id="4079094">Write</span><span class="op" id="4079099">(</span><span class="ident" id="4079100">tmp</span><span class="op" id="4079103">[</span><span class="num" id="4079104">0</span>&nbsp;<span class="op" id="4079106">:</span>&nbsp;<span class="num" id="4079108">64</span><span class="op" id="4079110">+</span><span class="num" id="4079111">56</span><span class="op" id="4079113">-</span><span class="builtinfunc" id="4079114">len</span><span class="op" id="4079117">%</span><span class="num" id="4079118">64</span><span class="op" id="4079120">]</span><span class="op" id="4079121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4079124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079128">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4079148">len</span>&nbsp;<span class="op" id="4079152">&lt;&lt;=</span>&nbsp;<span class="num" id="4079156">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079159">for</span>&nbsp;<span class="ident" id="4079163">i</span>&nbsp;<span class="op" id="4079165">:=</span>&nbsp;<span class="builtintype" id="4079168">uint</span><span class="op" id="4079172">(</span><span class="num" id="4079173">0</span><span class="op" id="4079174">)</span><span class="op" id="4079175">;</span>&nbsp;<span class="ident" id="4079177">i</span>&nbsp;<span class="op" id="4079179">&lt;</span>&nbsp;<span class="num" id="4079181">8</span><span class="op" id="4079182">;</span>&nbsp;<span class="ident" id="4079184">i</span><span class="op" id="4079185">++</span>&nbsp;<span class="op" id="4079188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079192">tmp</span><span class="op" id="4079195">[</span><span class="ident" id="4079196">i</span><span class="op" id="4079197">]</span>&nbsp;<span class="op" id="4079199">=</span>&nbsp;<span class="builtintype" id="4079201">byte</span><span class="op" id="4079205">(</span><span class="builtinfunc" id="4079206">len</span>&nbsp;<span class="op" id="4079210">&gt;&gt;</span>&nbsp;<span class="op" id="4079213">(</span><span class="num" id="4079214">56</span>&nbsp;<span class="op" id="4079217">-</span>&nbsp;<span class="num" id="4079219">8</span><span class="op" id="4079220">*</span><span class="ident" id="4079221">i</span><span class="op" id="4079222">)</span><span class="op" id="4079223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4079226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079229">d</span><span class="op" id="4079230">.</span><span class="ident" id="4079231">Write</span><span class="op" id="4079236">(</span><span class="ident" id="4079237">tmp</span><span class="op" id="4079240">[</span><span class="num" id="4079241">0</span><span class="op" id="4079242">:</span><span class="num" id="4079243">8</span><span class="op" id="4079244">]</span><span class="op" id="4079245">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079249">if</span>&nbsp;<span class="ident" id="4079252">d</span><span class="op" id="4079253">.</span><span class="ident" id="4079254">nx</span>&nbsp;<span class="op" id="4079257">!=</span>&nbsp;<span class="num" id="4079260">0</span>&nbsp;<span class="op" id="4079262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4079266">panic</span><span class="op" id="4079271">(</span><span class="string" id="4079272">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4079283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4079286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079290">h</span>&nbsp;<span class="op" id="4079292">:=</span>&nbsp;<span class="ident" id="4079295">d</span><span class="op" id="4079296">.</span><span class="ident" id="4079297">h</span><span class="op" id="4079298">[</span><span class="op" id="4079299">:</span><span class="op" id="4079300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079303">if</span>&nbsp;<span class="ident" id="4079306">d</span><span class="op" id="4079307">.</span><span class="ident" id="4079308">is224</span>&nbsp;<span class="op" id="4079314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079318">h</span>&nbsp;<span class="op" id="4079320">=</span>&nbsp;<span class="ident" id="4079322">d</span><span class="op" id="4079323">.</span><span class="ident" id="4079324">h</span><span class="op" id="4079325">[</span><span class="op" id="4079326">:</span><span class="num" id="4079327">7</span><span class="op" id="4079328">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4079331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079335">var</span>&nbsp;<span class="ident" id="4079339">digest</span>&nbsp;<span class="op" id="4079346">[</span><span class="ident" id="4079347">Size</span><span class="op" id="4079351">]</span><span class="builtintype" id="4079352">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079358">for</span>&nbsp;<span class="ident" id="4079362">i</span><span class="op" id="4079363">,</span>&nbsp;<span class="ident" id="4079365">s</span>&nbsp;<span class="op" id="4079367">:=</span>&nbsp;<span class="keyword" id="4079370">range</span>&nbsp;<span class="ident" id="4079376">h</span>&nbsp;<span class="op" id="4079378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079382">digest</span><span class="op" id="4079388">[</span><span class="ident" id="4079389">i</span><span class="op" id="4079390">*</span><span class="num" id="4079391">4</span><span class="op" id="4079392">]</span>&nbsp;<span class="op" id="4079394">=</span>&nbsp;<span class="builtintype" id="4079396">byte</span><span class="op" id="4079400">(</span><span class="ident" id="4079401">s</span>&nbsp;<span class="op" id="4079403">&gt;&gt;</span>&nbsp;<span class="num" id="4079406">24</span><span class="op" id="4079408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079412">digest</span><span class="op" id="4079418">[</span><span class="ident" id="4079419">i</span><span class="op" id="4079420">*</span><span class="num" id="4079421">4</span><span class="op" id="4079422">+</span><span class="num" id="4079423">1</span><span class="op" id="4079424">]</span>&nbsp;<span class="op" id="4079426">=</span>&nbsp;<span class="builtintype" id="4079428">byte</span><span class="op" id="4079432">(</span><span class="ident" id="4079433">s</span>&nbsp;<span class="op" id="4079435">&gt;&gt;</span>&nbsp;<span class="num" id="4079438">16</span><span class="op" id="4079440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079444">digest</span><span class="op" id="4079450">[</span><span class="ident" id="4079451">i</span><span class="op" id="4079452">*</span><span class="num" id="4079453">4</span><span class="op" id="4079454">+</span><span class="num" id="4079455">2</span><span class="op" id="4079456">]</span>&nbsp;<span class="op" id="4079458">=</span>&nbsp;<span class="builtintype" id="4079460">byte</span><span class="op" id="4079464">(</span><span class="ident" id="4079465">s</span>&nbsp;<span class="op" id="4079467">&gt;&gt;</span>&nbsp;<span class="num" id="4079470">8</span><span class="op" id="4079471">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079475">digest</span><span class="op" id="4079481">[</span><span class="ident" id="4079482">i</span><span class="op" id="4079483">*</span><span class="num" id="4079484">4</span><span class="op" id="4079485">+</span><span class="num" id="4079486">3</span><span class="op" id="4079487">]</span>&nbsp;<span class="op" id="4079489">=</span>&nbsp;<span class="builtintype" id="4079491">byte</span><span class="op" id="4079495">(</span><span class="ident" id="4079496">s</span><span class="op" id="4079497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4079500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079504">return</span>&nbsp;<span class="ident" id="4079511">digest</span><br>
<span class="lineno"></span><span class="op" id="4079518">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4079521">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4079572">func</span>&nbsp;<span class="ident" id="4079577">Sum256</span><span class="op" id="4079583">(</span><span class="ident" id="4079584">data</span>&nbsp;<span class="op" id="4079589">[</span><span class="op" id="4079590">]</span><span class="builtintype" id="4079591">byte</span><span class="op" id="4079595">)</span>&nbsp;<span class="op" id="4079597">[</span><span class="ident" id="4079598">Size</span><span class="op" id="4079602">]</span><span class="builtintype" id="4079603">byte</span>&nbsp;<span class="op" id="4079608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079611">var</span>&nbsp;<span class="ident" id="4079615">d</span>&nbsp;<span class="ident" id="4079617">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079625">d</span><span class="op" id="4079626">.</span><span class="ident" id="4079627">Reset</span><span class="op" id="4079632">(</span><span class="op" id="4079633">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079636">d</span><span class="op" id="4079637">.</span><span class="ident" id="4079638">Write</span><span class="op" id="4079643">(</span><span class="ident" id="4079644">data</span><span class="op" id="4079648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079651">return</span>&nbsp;<span class="ident" id="4079658">d</span><span class="op" id="4079659">.</span><span class="ident" id="4079660">checkSum</span><span class="op" id="4079668">(</span><span class="op" id="4079669">)</span><br>
<span class="lineno"></span><span class="op" id="4079671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4079674">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4079725">func</span>&nbsp;<span class="ident" id="4079730">Sum224</span><span class="op" id="4079736">(</span><span class="ident" id="4079737">data</span>&nbsp;<span class="op" id="4079742">[</span><span class="op" id="4079743">]</span><span class="builtintype" id="4079744">byte</span><span class="op" id="4079748">)</span>&nbsp;<span class="op" id="4079750">(</span><span class="ident" id="4079751">sum224</span>&nbsp;<span class="op" id="4079758">[</span><span class="ident" id="4079759">Size224</span><span class="op" id="4079766">]</span><span class="builtintype" id="4079767">byte</span><span class="op" id="4079771">)</span>&nbsp;<span class="op" id="4079773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079776">var</span>&nbsp;<span class="ident" id="4079780">d</span>&nbsp;<span class="ident" id="4079782">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079790">d</span><span class="op" id="4079791">.</span><span class="ident" id="4079792">is224</span>&nbsp;<span class="op" id="4079798">=</span>&nbsp;<span class="builtintype" id="4079800">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079806">d</span><span class="op" id="4079807">.</span><span class="ident" id="4079808">Reset</span><span class="op" id="4079813">(</span><span class="op" id="4079814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079817">d</span><span class="op" id="4079818">.</span><span class="ident" id="4079819">Write</span><span class="op" id="4079824">(</span><span class="ident" id="4079825">data</span><span class="op" id="4079829">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079832">sum</span>&nbsp;<span class="op" id="4079836">:=</span>&nbsp;<span class="ident" id="4079839">d</span><span class="op" id="4079840">.</span><span class="ident" id="4079841">checkSum</span><span class="op" id="4079849">(</span><span class="op" id="4079850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4079853">copy</span><span class="op" id="4079857">(</span><span class="ident" id="4079858">sum224</span><span class="op" id="4079864">[</span><span class="op" id="4079865">:</span><span class="op" id="4079866">]</span><span class="op" id="4079867">,</span>&nbsp;<span class="ident" id="4079869">sum</span><span class="op" id="4079872">[</span><span class="op" id="4079873">:</span><span class="ident" id="4079874">Size224</span><span class="op" id="4079881">]</span><span class="op" id="4079882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079885">return</span><br>
<span class="lineno"></span><span class="op" id="4079892">}</span>
</div>
</body>
</html>
