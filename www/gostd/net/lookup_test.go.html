<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html" class="current">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6704860">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6704915">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6704969">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6705020">//&nbsp;TODO&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;use&nbsp;a&nbsp;mock&nbsp;DNS&nbsp;server,&nbsp;to&nbsp;eliminate</span><br>
<span class="lineno"></span><span class="comment" id="6705084">//&nbsp;external&nbsp;dependencies.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6705111">package</span>&nbsp;<span class="ident" id="6705119">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6705124">import</span>&nbsp;<span class="op" id="6705131">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6705134">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6705142">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6705153">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6705163">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6705166">var</span>&nbsp;<span class="ident" id="6705170">testExternal</span>&nbsp;<span class="op" id="6705183">=</span>&nbsp;<span class="ident" id="6705185">flag</span><span class="op" id="6705189">.</span><span class="ident" id="6705190">Bool</span><span class="op" id="6705194">(</span><span class="string" id="6705195">&#34;external&#34;</span><span class="op" id="6705205">,</span>&nbsp;<span class="builtintype" id="6705207">true</span><span class="op" id="6705211">,</span>&nbsp;<span class="string" id="6705213">&#34;allow&nbsp;use&nbsp;of&nbsp;external&nbsp;networks&nbsp;during&nbsp;long&nbsp;test&#34;</span><span class="op" id="6705262">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6705265">var</span>&nbsp;<span class="ident" id="6705269">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="6705290">=</span>&nbsp;<span class="op" id="6705292">[</span><span class="op" id="6705293">]</span><span class="keyword" id="6705294">struct</span>&nbsp;<span class="op" id="6705301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6705304">service</span><span class="op" id="6705311">,</span>&nbsp;<span class="ident" id="6705313">proto</span><span class="op" id="6705318">,</span>&nbsp;<span class="ident" id="6705320">name</span>&nbsp;<span class="builtintype" id="6705325">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6705333">cname</span><span class="op" id="6705338">,</span>&nbsp;<span class="ident" id="6705340">target</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6705354">string</span><br>
<span class="lineno"></span><span class="op" id="6705361">}</span><span class="op" id="6705362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6705365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6705369">&#34;xmpp-server&#34;</span><span class="op" id="6705382">,</span>&nbsp;<span class="string" id="6705384">&#34;tcp&#34;</span><span class="op" id="6705389">,</span>&nbsp;<span class="string" id="6705391">&#34;google.com&#34;</span><span class="op" id="6705403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6705407">&#34;.google.com&#34;</span><span class="op" id="6705420">,</span>&nbsp;<span class="string" id="6705422">&#34;.google.com&#34;</span><span class="op" id="6705435">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6705438">}</span><span class="op" id="6705439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6705442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6705446">&#34;&#34;</span><span class="op" id="6705448">,</span>&nbsp;<span class="string" id="6705450">&#34;&#34;</span><span class="op" id="6705452">,</span>&nbsp;<span class="string" id="6705454">&#34;_xmpp-server._tcp.google.com&#34;</span><span class="op" id="6705484">,</span>&nbsp;<span class="comment" id="6705486">//&nbsp;non-standard&nbsp;back&nbsp;door</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6705514">&#34;.google.com&#34;</span><span class="op" id="6705527">,</span>&nbsp;<span class="string" id="6705529">&#34;.google.com&#34;</span><span class="op" id="6705542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6705545">}</span><span class="op" id="6705546">,</span><br>
<span class="lineno">30</span><span class="op" id="6705548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6705551">func</span>&nbsp;<span class="ident" id="6705556">TestLookupGoogleSRV</span><span class="op" id="6705575">(</span><span class="ident" id="6705576">t</span>&nbsp;<span class="op" id="6705578">*</span><span class="ident" id="6705579">testing</span><span class="op" id="6705586">.</span><span class="ident" id="6705587">T</span><span class="op" id="6705588">)</span>&nbsp;<span class="op" id="6705590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6705593">if</span>&nbsp;<span class="ident" id="6705596">testing</span><span class="op" id="6705603">.</span><span class="ident" id="6705604">Short</span><span class="op" id="6705609">(</span><span class="op" id="6705610">)</span>&nbsp;<span class="op" id="6705612">||</span>&nbsp;<span class="op" id="6705615">!</span><span class="op" id="6705616">*</span><span class="ident" id="6705617">testExternal</span>&nbsp;<span class="op" id="6705630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6705634">t</span><span class="op" id="6705635">.</span><span class="ident" id="6705636">Skip</span><span class="op" id="6705640">(</span><span class="string" id="6705641">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6705682">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6705685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6705689">for</span>&nbsp;<span class="ident" id="6705693">_</span><span class="op" id="6705694">,</span>&nbsp;<span class="ident" id="6705696">tt</span>&nbsp;<span class="op" id="6705699">:=</span>&nbsp;<span class="keyword" id="6705702">range</span>&nbsp;<span class="ident" id="6705708">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="6705729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6705733">cname</span><span class="op" id="6705738">,</span>&nbsp;<span class="ident" id="6705740">srvs</span><span class="op" id="6705744">,</span>&nbsp;<span class="ident" id="6705746">err</span>&nbsp;<span class="op" id="6705750">:=</span>&nbsp;<span class="ident" id="6705753">LookupSRV</span><span class="op" id="6705762">(</span><span class="ident" id="6705763">tt</span><span class="op" id="6705765">.</span><span class="ident" id="6705766">service</span><span class="op" id="6705773">,</span>&nbsp;<span class="ident" id="6705775">tt</span><span class="op" id="6705777">.</span><span class="ident" id="6705778">proto</span><span class="op" id="6705783">,</span>&nbsp;<span class="ident" id="6705785">tt</span><span class="op" id="6705787">.</span><span class="ident" id="6705788">name</span><span class="op" id="6705792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6705796">if</span>&nbsp;<span class="ident" id="6705799">err</span>&nbsp;<span class="op" id="6705803">!=</span>&nbsp;<span class="builtintype" id="6705806">nil</span>&nbsp;<span class="op" id="6705810">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6705815">t</span><span class="op" id="6705816">.</span><span class="ident" id="6705817">Fatal</span><span class="op" id="6705822">(</span><span class="ident" id="6705823">err</span><span class="op" id="6705826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6705830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6705834">if</span>&nbsp;<span class="builtinfunc" id="6705837">len</span><span class="op" id="6705840">(</span><span class="ident" id="6705841">srvs</span><span class="op" id="6705845">)</span>&nbsp;<span class="op" id="6705847">==</span>&nbsp;<span class="num" id="6705850">0</span>&nbsp;<span class="op" id="6705852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6705857">t</span><span class="op" id="6705858">.</span><span class="ident" id="6705859">Error</span><span class="op" id="6705864">(</span><span class="string" id="6705865">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6705880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6705884">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6705888">if</span>&nbsp;<span class="op" id="6705891">!</span><span class="ident" id="6705892">strings</span><span class="op" id="6705899">.</span><span class="ident" id="6705900">Contains</span><span class="op" id="6705908">(</span><span class="ident" id="6705909">cname</span><span class="op" id="6705914">,</span>&nbsp;<span class="ident" id="6705916">tt</span><span class="op" id="6705918">.</span><span class="ident" id="6705919">cname</span><span class="op" id="6705924">)</span>&nbsp;<span class="op" id="6705926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6705931">t</span><span class="op" id="6705932">.</span><span class="ident" id="6705933">Errorf</span><span class="op" id="6705939">(</span><span class="string" id="6705940">&#34;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6705957">,</span>&nbsp;<span class="ident" id="6705959">cname</span><span class="op" id="6705964">,</span>&nbsp;<span class="ident" id="6705966">tt</span><span class="op" id="6705968">.</span><span class="ident" id="6705969">cname</span><span class="op" id="6705974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6705978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6705982">for</span>&nbsp;<span class="ident" id="6705986">_</span><span class="op" id="6705987">,</span>&nbsp;<span class="ident" id="6705989">srv</span>&nbsp;<span class="op" id="6705993">:=</span>&nbsp;<span class="keyword" id="6705996">range</span>&nbsp;<span class="ident" id="6706002">srvs</span>&nbsp;<span class="op" id="6706007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706012">if</span>&nbsp;<span class="op" id="6706015">!</span><span class="ident" id="6706016">strings</span><span class="op" id="6706023">.</span><span class="ident" id="6706024">Contains</span><span class="op" id="6706032">(</span><span class="ident" id="6706033">srv</span><span class="op" id="6706036">.</span><span class="ident" id="6706037">Target</span><span class="op" id="6706043">,</span>&nbsp;<span class="ident" id="6706045">tt</span><span class="op" id="6706047">.</span><span class="ident" id="6706048">target</span><span class="op" id="6706054">)</span>&nbsp;<span class="op" id="6706056">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706062">t</span><span class="op" id="6706063">.</span><span class="ident" id="6706064">Errorf</span><span class="op" id="6706070">(</span><span class="string" id="6706071">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="6706108">,</span>&nbsp;<span class="ident" id="6706110">srv</span><span class="op" id="6706113">,</span>&nbsp;<span class="ident" id="6706115">tt</span><span class="op" id="6706117">.</span><span class="ident" id="6706118">target</span><span class="op" id="6706124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706136">}</span><br>
<span class="lineno"></span><span class="op" id="6706138">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="6706141">func</span>&nbsp;<span class="ident" id="6706146">TestLookupGmailMX</span><span class="op" id="6706163">(</span><span class="ident" id="6706164">t</span>&nbsp;<span class="op" id="6706166">*</span><span class="ident" id="6706167">testing</span><span class="op" id="6706174">.</span><span class="ident" id="6706175">T</span><span class="op" id="6706176">)</span>&nbsp;<span class="op" id="6706178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706181">if</span>&nbsp;<span class="ident" id="6706184">testing</span><span class="op" id="6706191">.</span><span class="ident" id="6706192">Short</span><span class="op" id="6706197">(</span><span class="op" id="6706198">)</span>&nbsp;<span class="op" id="6706200">||</span>&nbsp;<span class="op" id="6706203">!</span><span class="op" id="6706204">*</span><span class="ident" id="6706205">testExternal</span>&nbsp;<span class="op" id="6706218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706222">t</span><span class="op" id="6706223">.</span><span class="ident" id="6706224">Skip</span><span class="op" id="6706228">(</span><span class="string" id="6706229">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6706270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706273">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706277">mxs</span><span class="op" id="6706280">,</span>&nbsp;<span class="ident" id="6706282">err</span>&nbsp;<span class="op" id="6706286">:=</span>&nbsp;<span class="ident" id="6706289">LookupMX</span><span class="op" id="6706297">(</span><span class="string" id="6706298">&#34;gmail.com&#34;</span><span class="op" id="6706309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706312">if</span>&nbsp;<span class="ident" id="6706315">err</span>&nbsp;<span class="op" id="6706319">!=</span>&nbsp;<span class="builtintype" id="6706322">nil</span>&nbsp;<span class="op" id="6706326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706330">t</span><span class="op" id="6706331">.</span><span class="ident" id="6706332">Fatal</span><span class="op" id="6706337">(</span><span class="ident" id="6706338">err</span><span class="op" id="6706341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706344">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706347">if</span>&nbsp;<span class="builtinfunc" id="6706350">len</span><span class="op" id="6706353">(</span><span class="ident" id="6706354">mxs</span><span class="op" id="6706357">)</span>&nbsp;<span class="op" id="6706359">==</span>&nbsp;<span class="num" id="6706362">0</span>&nbsp;<span class="op" id="6706364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706368">t</span><span class="op" id="6706369">.</span><span class="ident" id="6706370">Error</span><span class="op" id="6706375">(</span><span class="string" id="6706376">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6706391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706397">for</span>&nbsp;<span class="ident" id="6706401">_</span><span class="op" id="6706402">,</span>&nbsp;<span class="ident" id="6706404">mx</span>&nbsp;<span class="op" id="6706407">:=</span>&nbsp;<span class="keyword" id="6706410">range</span>&nbsp;<span class="ident" id="6706416">mxs</span>&nbsp;<span class="op" id="6706420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706424">if</span>&nbsp;<span class="op" id="6706427">!</span><span class="ident" id="6706428">strings</span><span class="op" id="6706435">.</span><span class="ident" id="6706436">Contains</span><span class="op" id="6706444">(</span><span class="ident" id="6706445">mx</span><span class="op" id="6706447">.</span><span class="ident" id="6706448">Host</span><span class="op" id="6706452">,</span>&nbsp;<span class="string" id="6706454">&#34;.google.com&#34;</span><span class="op" id="6706467">)</span>&nbsp;<span class="op" id="6706469">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706474">t</span><span class="op" id="6706475">.</span><span class="ident" id="6706476">Errorf</span><span class="op" id="6706482">(</span><span class="string" id="6706483">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="6706530">,</span>&nbsp;<span class="ident" id="6706532">mx</span><span class="op" id="6706534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706541">}</span><br>
<span class="lineno"></span><span class="op" id="6706543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6706546">func</span>&nbsp;<span class="ident" id="6706551">TestLookupGmailNS</span><span class="op" id="6706568">(</span><span class="ident" id="6706569">t</span>&nbsp;<span class="op" id="6706571">*</span><span class="ident" id="6706572">testing</span><span class="op" id="6706579">.</span><span class="ident" id="6706580">T</span><span class="op" id="6706581">)</span>&nbsp;<span class="op" id="6706583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706586">if</span>&nbsp;<span class="ident" id="6706589">testing</span><span class="op" id="6706596">.</span><span class="ident" id="6706597">Short</span><span class="op" id="6706602">(</span><span class="op" id="6706603">)</span>&nbsp;<span class="op" id="6706605">||</span>&nbsp;<span class="op" id="6706608">!</span><span class="op" id="6706609">*</span><span class="ident" id="6706610">testExternal</span>&nbsp;<span class="op" id="6706623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706627">t</span><span class="op" id="6706628">.</span><span class="ident" id="6706629">Skip</span><span class="op" id="6706633">(</span><span class="string" id="6706634">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6706675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706682">nss</span><span class="op" id="6706685">,</span>&nbsp;<span class="ident" id="6706687">err</span>&nbsp;<span class="op" id="6706691">:=</span>&nbsp;<span class="ident" id="6706694">LookupNS</span><span class="op" id="6706702">(</span><span class="string" id="6706703">&#34;gmail.com&#34;</span><span class="op" id="6706714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706717">if</span>&nbsp;<span class="ident" id="6706720">err</span>&nbsp;<span class="op" id="6706724">!=</span>&nbsp;<span class="builtintype" id="6706727">nil</span>&nbsp;<span class="op" id="6706731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706735">t</span><span class="op" id="6706736">.</span><span class="ident" id="6706737">Fatal</span><span class="op" id="6706742">(</span><span class="ident" id="6706743">err</span><span class="op" id="6706746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706752">if</span>&nbsp;<span class="builtinfunc" id="6706755">len</span><span class="op" id="6706758">(</span><span class="ident" id="6706759">nss</span><span class="op" id="6706762">)</span>&nbsp;<span class="op" id="6706764">==</span>&nbsp;<span class="num" id="6706767">0</span>&nbsp;<span class="op" id="6706769">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706773">t</span><span class="op" id="6706774">.</span><span class="ident" id="6706775">Error</span><span class="op" id="6706780">(</span><span class="string" id="6706781">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6706796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706802">for</span>&nbsp;<span class="ident" id="6706806">_</span><span class="op" id="6706807">,</span>&nbsp;<span class="ident" id="6706809">ns</span>&nbsp;<span class="op" id="6706812">:=</span>&nbsp;<span class="keyword" id="6706815">range</span>&nbsp;<span class="ident" id="6706821">nss</span>&nbsp;<span class="op" id="6706825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706829">if</span>&nbsp;<span class="op" id="6706832">!</span><span class="ident" id="6706833">strings</span><span class="op" id="6706840">.</span><span class="ident" id="6706841">Contains</span><span class="op" id="6706849">(</span><span class="ident" id="6706850">ns</span><span class="op" id="6706852">.</span><span class="ident" id="6706853">Host</span><span class="op" id="6706857">,</span>&nbsp;<span class="string" id="6706859">&#34;.google.com&#34;</span><span class="op" id="6706872">)</span>&nbsp;<span class="op" id="6706874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6706879">t</span><span class="op" id="6706880">.</span><span class="ident" id="6706881">Errorf</span><span class="op" id="6706887">(</span><span class="string" id="6706888">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="6706935">,</span>&nbsp;<span class="ident" id="6706937">ns</span><span class="op" id="6706939">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6706946">}</span><br>
<span class="lineno"></span><span class="op" id="6706948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6706951">func</span>&nbsp;<span class="ident" id="6706956">TestLookupGmailTXT</span><span class="op" id="6706974">(</span><span class="ident" id="6706975">t</span>&nbsp;<span class="op" id="6706977">*</span><span class="ident" id="6706978">testing</span><span class="op" id="6706985">.</span><span class="ident" id="6706986">T</span><span class="op" id="6706987">)</span>&nbsp;<span class="op" id="6706989">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6706992">if</span>&nbsp;<span class="ident" id="6706995">testing</span><span class="op" id="6707002">.</span><span class="ident" id="6707003">Short</span><span class="op" id="6707008">(</span><span class="op" id="6707009">)</span>&nbsp;<span class="op" id="6707011">||</span>&nbsp;<span class="op" id="6707014">!</span><span class="op" id="6707015">*</span><span class="ident" id="6707016">testExternal</span>&nbsp;<span class="op" id="6707029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707033">t</span><span class="op" id="6707034">.</span><span class="ident" id="6707035">Skip</span><span class="op" id="6707039">(</span><span class="string" id="6707040">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6707081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707088">txts</span><span class="op" id="6707092">,</span>&nbsp;<span class="ident" id="6707094">err</span>&nbsp;<span class="op" id="6707098">:=</span>&nbsp;<span class="ident" id="6707101">LookupTXT</span><span class="op" id="6707110">(</span><span class="string" id="6707111">&#34;gmail.com&#34;</span><span class="op" id="6707122">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707125">if</span>&nbsp;<span class="ident" id="6707128">err</span>&nbsp;<span class="op" id="6707132">!=</span>&nbsp;<span class="builtintype" id="6707135">nil</span>&nbsp;<span class="op" id="6707139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707143">t</span><span class="op" id="6707144">.</span><span class="ident" id="6707145">Fatal</span><span class="op" id="6707150">(</span><span class="ident" id="6707151">err</span><span class="op" id="6707154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707160">if</span>&nbsp;<span class="builtinfunc" id="6707163">len</span><span class="op" id="6707166">(</span><span class="ident" id="6707167">txts</span><span class="op" id="6707171">)</span>&nbsp;<span class="op" id="6707173">==</span>&nbsp;<span class="num" id="6707176">0</span>&nbsp;<span class="op" id="6707178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707182">t</span><span class="op" id="6707183">.</span><span class="ident" id="6707184">Error</span><span class="op" id="6707189">(</span><span class="string" id="6707190">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6707205">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707211">for</span>&nbsp;<span class="ident" id="6707215">_</span><span class="op" id="6707216">,</span>&nbsp;<span class="ident" id="6707218">txt</span>&nbsp;<span class="op" id="6707222">:=</span>&nbsp;<span class="keyword" id="6707225">range</span>&nbsp;<span class="ident" id="6707231">txts</span>&nbsp;<span class="op" id="6707236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707240">if</span>&nbsp;<span class="op" id="6707243">!</span><span class="ident" id="6707244">strings</span><span class="op" id="6707251">.</span><span class="ident" id="6707252">Contains</span><span class="op" id="6707260">(</span><span class="ident" id="6707261">txt</span><span class="op" id="6707264">,</span>&nbsp;<span class="string" id="6707266">&#34;spf&#34;</span><span class="op" id="6707271">)</span>&nbsp;<span class="op" id="6707273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707278">t</span><span class="op" id="6707279">.</span><span class="ident" id="6707280">Errorf</span><span class="op" id="6707286">(</span><span class="string" id="6707287">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;spf&nbsp;record&#34;</span><span class="op" id="6707314">,</span>&nbsp;<span class="ident" id="6707316">txt</span><span class="op" id="6707319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707323">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707326">}</span><br>
<span class="lineno"></span><span class="op" id="6707328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6707331">var</span>&nbsp;<span class="ident" id="6707335">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="6707362">=</span>&nbsp;<span class="op" id="6707364">[</span><span class="op" id="6707365">]</span><span class="keyword" id="6707366">struct</span>&nbsp;<span class="op" id="6707373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707376">addr</span>&nbsp;<span class="builtintype" id="6707381">string</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707389">name</span>&nbsp;<span class="builtintype" id="6707394">string</span><br>
<span class="lineno"></span><span class="op" id="6707401">}</span><span class="op" id="6707402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707405">{</span><span class="string" id="6707406">&#34;8.8.8.8&#34;</span><span class="op" id="6707415">,</span>&nbsp;<span class="string" id="6707417">&#34;.google.com.&#34;</span><span class="op" id="6707431">}</span><span class="op" id="6707432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707435">{</span><span class="string" id="6707436">&#34;8.8.4.4&#34;</span><span class="op" id="6707445">,</span>&nbsp;<span class="string" id="6707447">&#34;.google.com.&#34;</span><span class="op" id="6707461">}</span><span class="op" id="6707462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707465">{</span><span class="string" id="6707466">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="6707488">,</span>&nbsp;<span class="string" id="6707490">&#34;.google.com.&#34;</span><span class="op" id="6707504">}</span><span class="op" id="6707505">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707508">{</span><span class="string" id="6707509">&#34;2001:4860:4860::8844&#34;</span><span class="op" id="6707531">,</span>&nbsp;<span class="string" id="6707533">&#34;.google.com.&#34;</span><span class="op" id="6707547">}</span><span class="op" id="6707548">,</span><br>
<span class="lineno"></span><span class="op" id="6707550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6707553">func</span>&nbsp;<span class="ident" id="6707558">TestLookupGooglePublicDNSAddr</span><span class="op" id="6707587">(</span><span class="ident" id="6707588">t</span>&nbsp;<span class="op" id="6707590">*</span><span class="ident" id="6707591">testing</span><span class="op" id="6707598">.</span><span class="ident" id="6707599">T</span><span class="op" id="6707600">)</span>&nbsp;<span class="op" id="6707602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707605">if</span>&nbsp;<span class="ident" id="6707608">testing</span><span class="op" id="6707615">.</span><span class="ident" id="6707616">Short</span><span class="op" id="6707621">(</span><span class="op" id="6707622">)</span>&nbsp;<span class="op" id="6707624">||</span>&nbsp;<span class="op" id="6707627">!</span><span class="op" id="6707628">*</span><span class="ident" id="6707629">testExternal</span>&nbsp;<span class="op" id="6707642">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707646">t</span><span class="op" id="6707647">.</span><span class="ident" id="6707648">Skip</span><span class="op" id="6707652">(</span><span class="string" id="6707653">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6707694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707701">for</span>&nbsp;<span class="ident" id="6707705">_</span><span class="op" id="6707706">,</span>&nbsp;<span class="ident" id="6707708">tt</span>&nbsp;<span class="op" id="6707711">:=</span>&nbsp;<span class="keyword" id="6707714">range</span>&nbsp;<span class="ident" id="6707720">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="6707747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707751">names</span><span class="op" id="6707756">,</span>&nbsp;<span class="ident" id="6707758">err</span>&nbsp;<span class="op" id="6707762">:=</span>&nbsp;<span class="ident" id="6707765">LookupAddr</span><span class="op" id="6707775">(</span><span class="ident" id="6707776">tt</span><span class="op" id="6707778">.</span><span class="ident" id="6707779">addr</span><span class="op" id="6707783">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707787">if</span>&nbsp;<span class="ident" id="6707790">err</span>&nbsp;<span class="op" id="6707794">!=</span>&nbsp;<span class="builtintype" id="6707797">nil</span>&nbsp;<span class="op" id="6707801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707806">t</span><span class="op" id="6707807">.</span><span class="ident" id="6707808">Fatal</span><span class="op" id="6707813">(</span><span class="ident" id="6707814">err</span><span class="op" id="6707817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707825">if</span>&nbsp;<span class="builtinfunc" id="6707828">len</span><span class="op" id="6707831">(</span><span class="ident" id="6707832">names</span><span class="op" id="6707837">)</span>&nbsp;<span class="op" id="6707839">==</span>&nbsp;<span class="num" id="6707842">0</span>&nbsp;<span class="op" id="6707844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707849">t</span><span class="op" id="6707850">.</span><span class="ident" id="6707851">Error</span><span class="op" id="6707856">(</span><span class="string" id="6707857">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6707872">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6707876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707880">for</span>&nbsp;<span class="ident" id="6707884">_</span><span class="op" id="6707885">,</span>&nbsp;<span class="ident" id="6707887">name</span>&nbsp;<span class="op" id="6707892">:=</span>&nbsp;<span class="keyword" id="6707895">range</span>&nbsp;<span class="ident" id="6707901">names</span>&nbsp;<span class="op" id="6707907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6707912">if</span>&nbsp;<span class="op" id="6707915">!</span><span class="ident" id="6707916">strings</span><span class="op" id="6707923">.</span><span class="ident" id="6707924">HasSuffix</span><span class="op" id="6707933">(</span><span class="ident" id="6707934">name</span><span class="op" id="6707938">,</span>&nbsp;<span class="ident" id="6707940">tt</span><span class="op" id="6707942">.</span><span class="ident" id="6707943">name</span><span class="op" id="6707947">)</span>&nbsp;<span class="op" id="6707949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6707955">t</span><span class="op" id="6707956">.</span><span class="ident" id="6707957">Errorf</span><span class="op" id="6707963">(</span><span class="string" id="6707964">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="6708001">,</span>&nbsp;<span class="ident" id="6708003">name</span><span class="op" id="6708007">,</span>&nbsp;<span class="ident" id="6708009">tt</span><span class="op" id="6708011">.</span><span class="ident" id="6708012">name</span><span class="op" id="6708016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708021">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708028">}</span><br>
<span class="lineno"></span><span class="op" id="6708030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6708033">func</span>&nbsp;<span class="ident" id="6708038">TestLookupIANACNAME</span><span class="op" id="6708057">(</span><span class="ident" id="6708058">t</span>&nbsp;<span class="op" id="6708060">*</span><span class="ident" id="6708061">testing</span><span class="op" id="6708068">.</span><span class="ident" id="6708069">T</span><span class="op" id="6708070">)</span>&nbsp;<span class="op" id="6708072">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708075">if</span>&nbsp;<span class="ident" id="6708078">testing</span><span class="op" id="6708085">.</span><span class="ident" id="6708086">Short</span><span class="op" id="6708091">(</span><span class="op" id="6708092">)</span>&nbsp;<span class="op" id="6708094">||</span>&nbsp;<span class="op" id="6708097">!</span><span class="op" id="6708098">*</span><span class="ident" id="6708099">testExternal</span>&nbsp;<span class="op" id="6708112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708116">t</span><span class="op" id="6708117">.</span><span class="ident" id="6708118">Skip</span><span class="op" id="6708122">(</span><span class="string" id="6708123">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6708164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708171">cname</span><span class="op" id="6708176">,</span>&nbsp;<span class="ident" id="6708178">err</span>&nbsp;<span class="op" id="6708182">:=</span>&nbsp;<span class="ident" id="6708185">LookupCNAME</span><span class="op" id="6708196">(</span><span class="string" id="6708197">&#34;www.iana.org&#34;</span><span class="op" id="6708211">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708214">if</span>&nbsp;<span class="ident" id="6708217">err</span>&nbsp;<span class="op" id="6708221">!=</span>&nbsp;<span class="builtintype" id="6708224">nil</span>&nbsp;<span class="op" id="6708228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708232">t</span><span class="op" id="6708233">.</span><span class="ident" id="6708234">Fatal</span><span class="op" id="6708239">(</span><span class="ident" id="6708240">err</span><span class="op" id="6708243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708249">if</span>&nbsp;<span class="op" id="6708252">!</span><span class="ident" id="6708253">strings</span><span class="op" id="6708260">.</span><span class="ident" id="6708261">HasSuffix</span><span class="op" id="6708270">(</span><span class="ident" id="6708271">cname</span><span class="op" id="6708276">,</span>&nbsp;<span class="string" id="6708278">&#34;.icann.org.&#34;</span><span class="op" id="6708291">)</span>&nbsp;<span class="op" id="6708293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708297">t</span><span class="op" id="6708298">.</span><span class="ident" id="6708299">Errorf</span><span class="op" id="6708305">(</span><span class="string" id="6708306">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.icann.org.&#34;</span><span class="op" id="6708352">,</span>&nbsp;<span class="ident" id="6708354">cname</span><span class="op" id="6708359">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708362">}</span><br>
<span class="lineno"></span><span class="op" id="6708364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6708367">func</span>&nbsp;<span class="ident" id="6708372">TestLookupGoogleHost</span><span class="op" id="6708392">(</span><span class="ident" id="6708393">t</span>&nbsp;<span class="op" id="6708395">*</span><span class="ident" id="6708396">testing</span><span class="op" id="6708403">.</span><span class="ident" id="6708404">T</span><span class="op" id="6708405">)</span>&nbsp;<span class="op" id="6708407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708410">if</span>&nbsp;<span class="ident" id="6708413">testing</span><span class="op" id="6708420">.</span><span class="ident" id="6708421">Short</span><span class="op" id="6708426">(</span><span class="op" id="6708427">)</span>&nbsp;<span class="op" id="6708429">||</span>&nbsp;<span class="op" id="6708432">!</span><span class="op" id="6708433">*</span><span class="ident" id="6708434">testExternal</span>&nbsp;<span class="op" id="6708447">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708451">t</span><span class="op" id="6708452">.</span><span class="ident" id="6708453">Skip</span><span class="op" id="6708457">(</span><span class="string" id="6708458">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6708499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708506">addrs</span><span class="op" id="6708511">,</span>&nbsp;<span class="ident" id="6708513">err</span>&nbsp;<span class="op" id="6708517">:=</span>&nbsp;<span class="ident" id="6708520">LookupHost</span><span class="op" id="6708530">(</span><span class="string" id="6708531">&#34;google.com&#34;</span><span class="op" id="6708543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708546">if</span>&nbsp;<span class="ident" id="6708549">err</span>&nbsp;<span class="op" id="6708553">!=</span>&nbsp;<span class="builtintype" id="6708556">nil</span>&nbsp;<span class="op" id="6708560">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708564">t</span><span class="op" id="6708565">.</span><span class="ident" id="6708566">Fatal</span><span class="op" id="6708571">(</span><span class="ident" id="6708572">err</span><span class="op" id="6708575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708581">if</span>&nbsp;<span class="builtinfunc" id="6708584">len</span><span class="op" id="6708587">(</span><span class="ident" id="6708588">addrs</span><span class="op" id="6708593">)</span>&nbsp;<span class="op" id="6708595">==</span>&nbsp;<span class="num" id="6708598">0</span>&nbsp;<span class="op" id="6708600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708604">t</span><span class="op" id="6708605">.</span><span class="ident" id="6708606">Error</span><span class="op" id="6708611">(</span><span class="string" id="6708612">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6708627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708630">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708633">for</span>&nbsp;<span class="ident" id="6708637">_</span><span class="op" id="6708638">,</span>&nbsp;<span class="ident" id="6708640">addr</span>&nbsp;<span class="op" id="6708645">:=</span>&nbsp;<span class="keyword" id="6708648">range</span>&nbsp;<span class="ident" id="6708654">addrs</span>&nbsp;<span class="op" id="6708660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708664">if</span>&nbsp;<span class="ident" id="6708667">ParseIP</span><span class="op" id="6708674">(</span><span class="ident" id="6708675">addr</span><span class="op" id="6708679">)</span>&nbsp;<span class="op" id="6708681">==</span>&nbsp;<span class="builtintype" id="6708684">nil</span>&nbsp;<span class="op" id="6708688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708693">t</span><span class="op" id="6708694">.</span><span class="ident" id="6708695">Errorf</span><span class="op" id="6708701">(</span><span class="string" id="6708702">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;literal&nbsp;ip&nbsp;address&#34;</span><span class="op" id="6708737">,</span>&nbsp;<span class="ident" id="6708739">addr</span><span class="op" id="6708743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708750">}</span><br>
<span class="lineno">175</span><span class="op" id="6708752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6708755">func</span>&nbsp;<span class="ident" id="6708760">TestLookupGoogleIP</span><span class="op" id="6708778">(</span><span class="ident" id="6708779">t</span>&nbsp;<span class="op" id="6708781">*</span><span class="ident" id="6708782">testing</span><span class="op" id="6708789">.</span><span class="ident" id="6708790">T</span><span class="op" id="6708791">)</span>&nbsp;<span class="op" id="6708793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708796">if</span>&nbsp;<span class="ident" id="6708799">testing</span><span class="op" id="6708806">.</span><span class="ident" id="6708807">Short</span><span class="op" id="6708812">(</span><span class="op" id="6708813">)</span>&nbsp;<span class="op" id="6708815">||</span>&nbsp;<span class="op" id="6708818">!</span><span class="op" id="6708819">*</span><span class="ident" id="6708820">testExternal</span>&nbsp;<span class="op" id="6708833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708837">t</span><span class="op" id="6708838">.</span><span class="ident" id="6708839">Skip</span><span class="op" id="6708843">(</span><span class="string" id="6708844">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6708885">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708892">ips</span><span class="op" id="6708895">,</span>&nbsp;<span class="ident" id="6708897">err</span>&nbsp;<span class="op" id="6708901">:=</span>&nbsp;<span class="ident" id="6708904">LookupIP</span><span class="op" id="6708912">(</span><span class="string" id="6708913">&#34;google.com&#34;</span><span class="op" id="6708925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708928">if</span>&nbsp;<span class="ident" id="6708931">err</span>&nbsp;<span class="op" id="6708935">!=</span>&nbsp;<span class="builtintype" id="6708938">nil</span>&nbsp;<span class="op" id="6708942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708946">t</span><span class="op" id="6708947">.</span><span class="ident" id="6708948">Fatal</span><span class="op" id="6708953">(</span><span class="ident" id="6708954">err</span><span class="op" id="6708957">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6708960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6708963">if</span>&nbsp;<span class="builtinfunc" id="6708966">len</span><span class="op" id="6708969">(</span><span class="ident" id="6708970">ips</span><span class="op" id="6708973">)</span>&nbsp;<span class="op" id="6708975">==</span>&nbsp;<span class="num" id="6708978">0</span>&nbsp;<span class="op" id="6708980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708984">t</span><span class="op" id="6708985">.</span><span class="ident" id="6708986">Error</span><span class="op" id="6708991">(</span><span class="string" id="6708992">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6709007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6709013">for</span>&nbsp;<span class="ident" id="6709017">_</span><span class="op" id="6709018">,</span>&nbsp;<span class="ident" id="6709020">ip</span>&nbsp;<span class="op" id="6709023">:=</span>&nbsp;<span class="keyword" id="6709026">range</span>&nbsp;<span class="ident" id="6709032">ips</span>&nbsp;<span class="op" id="6709036">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6709040">if</span>&nbsp;<span class="ident" id="6709043">ip</span><span class="op" id="6709045">.</span><span class="ident" id="6709046">To4</span><span class="op" id="6709049">(</span><span class="op" id="6709050">)</span>&nbsp;<span class="op" id="6709052">==</span>&nbsp;<span class="builtintype" id="6709055">nil</span>&nbsp;<span class="op" id="6709059">&amp;&amp;</span>&nbsp;<span class="ident" id="6709062">ip</span><span class="op" id="6709064">.</span><span class="ident" id="6709065">To16</span><span class="op" id="6709069">(</span><span class="op" id="6709070">)</span>&nbsp;<span class="op" id="6709072">==</span>&nbsp;<span class="builtintype" id="6709075">nil</span>&nbsp;<span class="op" id="6709079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6709084">t</span><span class="op" id="6709085">.</span><span class="ident" id="6709086">Errorf</span><span class="op" id="6709092">(</span><span class="string" id="6709093">&#34;got&nbsp;%v;&nbsp;want&nbsp;an&nbsp;ip&nbsp;address&#34;</span><span class="op" id="6709121">,</span>&nbsp;<span class="ident" id="6709123">ip</span><span class="op" id="6709125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709132">}</span><br>
<span class="lineno"></span><span class="op" id="6709134">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="6709137">var</span>&nbsp;<span class="ident" id="6709141">revAddrTests</span>&nbsp;<span class="op" id="6709154">=</span>&nbsp;<span class="op" id="6709156">[</span><span class="op" id="6709157">]</span><span class="keyword" id="6709158">struct</span>&nbsp;<span class="op" id="6709165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6709168">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6709178">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6709186">Reverse</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6709196">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6709204">ErrPrefix</span>&nbsp;<span class="builtintype" id="6709214">string</span><br>
<span class="lineno">200</span><span class="op" id="6709221">}</span><span class="op" id="6709222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709225">{</span><span class="string" id="6709226">&#34;1.2.3.4&#34;</span><span class="op" id="6709235">,</span>&nbsp;<span class="string" id="6709237">&#34;4.3.2.1.in-addr.arpa.&#34;</span><span class="op" id="6709260">,</span>&nbsp;<span class="string" id="6709262">&#34;&#34;</span><span class="op" id="6709264">}</span><span class="op" id="6709265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709268">{</span><span class="string" id="6709269">&#34;245.110.36.114&#34;</span><span class="op" id="6709285">,</span>&nbsp;<span class="string" id="6709287">&#34;114.36.110.245.in-addr.arpa.&#34;</span><span class="op" id="6709317">,</span>&nbsp;<span class="string" id="6709319">&#34;&#34;</span><span class="op" id="6709321">}</span><span class="op" id="6709322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709325">{</span><span class="string" id="6709326">&#34;::ffff:12.34.56.78&#34;</span><span class="op" id="6709346">,</span>&nbsp;<span class="string" id="6709348">&#34;78.56.34.12.in-addr.arpa.&#34;</span><span class="op" id="6709375">,</span>&nbsp;<span class="string" id="6709377">&#34;&#34;</span><span class="op" id="6709379">}</span><span class="op" id="6709380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709383">{</span><span class="string" id="6709384">&#34;::1&#34;</span><span class="op" id="6709389">,</span>&nbsp;<span class="string" id="6709391">&#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa.&#34;</span><span class="op" id="6709466">,</span>&nbsp;<span class="string" id="6709468">&#34;&#34;</span><span class="op" id="6709470">}</span><span class="op" id="6709471">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709474">{</span><span class="string" id="6709475">&#34;1::&#34;</span><span class="op" id="6709480">,</span>&nbsp;<span class="string" id="6709482">&#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1.0.0.0.ip6.arpa.&#34;</span><span class="op" id="6709557">,</span>&nbsp;<span class="string" id="6709559">&#34;&#34;</span><span class="op" id="6709561">}</span><span class="op" id="6709562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709565">{</span><span class="string" id="6709566">&#34;1234:567::89a:bcde&#34;</span><span class="op" id="6709586">,</span>&nbsp;<span class="string" id="6709588">&#34;e.d.c.b.a.9.8.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="6709663">,</span>&nbsp;<span class="string" id="6709665">&#34;&#34;</span><span class="op" id="6709667">}</span><span class="op" id="6709668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709671">{</span><span class="string" id="6709672">&#34;1234:567:fefe:bcbc:adad:9e4a:89a:bcde&#34;</span><span class="op" id="6709711">,</span>&nbsp;<span class="string" id="6709713">&#34;e.d.c.b.a.9.8.0.a.4.e.9.d.a.d.a.c.b.c.b.e.f.e.f.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="6709788">,</span>&nbsp;<span class="string" id="6709790">&#34;&#34;</span><span class="op" id="6709792">}</span><span class="op" id="6709793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709796">{</span><span class="string" id="6709797">&#34;1.2.3&#34;</span><span class="op" id="6709804">,</span>&nbsp;<span class="string" id="6709806">&#34;&#34;</span><span class="op" id="6709808">,</span>&nbsp;<span class="string" id="6709810">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6709832">}</span><span class="op" id="6709833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709836">{</span><span class="string" id="6709837">&#34;1.2.3.4.5&#34;</span><span class="op" id="6709848">,</span>&nbsp;<span class="string" id="6709850">&#34;&#34;</span><span class="op" id="6709852">,</span>&nbsp;<span class="string" id="6709854">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6709876">}</span><span class="op" id="6709877">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709880">{</span><span class="string" id="6709881">&#34;1234:567:bcbca::89a:bcde&#34;</span><span class="op" id="6709907">,</span>&nbsp;<span class="string" id="6709909">&#34;&#34;</span><span class="op" id="6709911">,</span>&nbsp;<span class="string" id="6709913">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6709935">}</span><span class="op" id="6709936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709939">{</span><span class="string" id="6709940">&#34;1234:567::bcbc:adad::89a:bcde&#34;</span><span class="op" id="6709971">,</span>&nbsp;<span class="string" id="6709973">&#34;&#34;</span><span class="op" id="6709975">,</span>&nbsp;<span class="string" id="6709977">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6709999">}</span><span class="op" id="6710000">,</span><br>
<span class="lineno"></span><span class="op" id="6710002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6710005">func</span>&nbsp;<span class="ident" id="6710010">TestReverseAddress</span><span class="op" id="6710028">(</span><span class="ident" id="6710029">t</span>&nbsp;<span class="op" id="6710031">*</span><span class="ident" id="6710032">testing</span><span class="op" id="6710039">.</span><span class="ident" id="6710040">T</span><span class="op" id="6710041">)</span>&nbsp;<span class="op" id="6710043">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6710046">for</span>&nbsp;<span class="ident" id="6710050">i</span><span class="op" id="6710051">,</span>&nbsp;<span class="ident" id="6710053">tt</span>&nbsp;<span class="op" id="6710056">:=</span>&nbsp;<span class="keyword" id="6710059">range</span>&nbsp;<span class="ident" id="6710065">revAddrTests</span>&nbsp;<span class="op" id="6710078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6710082">a</span><span class="op" id="6710083">,</span>&nbsp;<span class="ident" id="6710085">err</span>&nbsp;<span class="op" id="6710089">:=</span>&nbsp;<span class="ident" id="6710092">reverseaddr</span><span class="op" id="6710103">(</span><span class="ident" id="6710104">tt</span><span class="op" id="6710106">.</span><span class="ident" id="6710107">Addr</span><span class="op" id="6710111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6710115">if</span>&nbsp;<span class="builtinfunc" id="6710118">len</span><span class="op" id="6710121">(</span><span class="ident" id="6710122">tt</span><span class="op" id="6710124">.</span><span class="ident" id="6710125">ErrPrefix</span><span class="op" id="6710134">)</span>&nbsp;<span class="op" id="6710136">&gt;</span>&nbsp;<span class="num" id="6710138">0</span>&nbsp;<span class="op" id="6710140">&amp;&amp;</span>&nbsp;<span class="ident" id="6710143">err</span>&nbsp;<span class="op" id="6710147">==</span>&nbsp;<span class="builtintype" id="6710150">nil</span>&nbsp;<span class="op" id="6710154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6710159">t</span><span class="op" id="6710160">.</span><span class="ident" id="6710161">Errorf</span><span class="op" id="6710167">(</span><span class="string" id="6710168">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;&lt;nil&gt;&nbsp;(error)&#34;</span><span class="op" id="6710205">,</span>&nbsp;<span class="ident" id="6710207">i</span><span class="op" id="6710208">,</span>&nbsp;<span class="ident" id="6710210">tt</span><span class="op" id="6710212">.</span><span class="ident" id="6710213">ErrPrefix</span><span class="op" id="6710222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6710227">continue</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6710242">if</span>&nbsp;<span class="builtinfunc" id="6710245">len</span><span class="op" id="6710248">(</span><span class="ident" id="6710249">tt</span><span class="op" id="6710251">.</span><span class="ident" id="6710252">ErrPrefix</span><span class="op" id="6710261">)</span>&nbsp;<span class="op" id="6710263">==</span>&nbsp;<span class="num" id="6710266">0</span>&nbsp;<span class="op" id="6710268">&amp;&amp;</span>&nbsp;<span class="ident" id="6710271">err</span>&nbsp;<span class="op" id="6710275">!=</span>&nbsp;<span class="builtintype" id="6710278">nil</span>&nbsp;<span class="op" id="6710282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6710287">t</span><span class="op" id="6710288">.</span><span class="ident" id="6710289">Errorf</span><span class="op" id="6710295">(</span><span class="string" id="6710296">&#34;#%d:&nbsp;expected&nbsp;&lt;nil&gt;,&nbsp;got&nbsp;%q&nbsp;(error)&#34;</span><span class="op" id="6710333">,</span>&nbsp;<span class="ident" id="6710335">i</span><span class="op" id="6710336">,</span>&nbsp;<span class="ident" id="6710338">err</span><span class="op" id="6710341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6710349">if</span>&nbsp;<span class="ident" id="6710352">err</span>&nbsp;<span class="op" id="6710356">!=</span>&nbsp;<span class="builtintype" id="6710359">nil</span>&nbsp;<span class="op" id="6710363">&amp;&amp;</span>&nbsp;<span class="ident" id="6710366">err</span><span class="op" id="6710369">.</span><span class="op" id="6710370">(</span><span class="op" id="6710371">*</span><span class="ident" id="6710372">DNSError</span><span class="op" id="6710380">)</span><span class="op" id="6710381">.</span><span class="ident" id="6710382">Err</span>&nbsp;<span class="op" id="6710386">!=</span>&nbsp;<span class="ident" id="6710389">tt</span><span class="op" id="6710391">.</span><span class="ident" id="6710392">ErrPrefix</span>&nbsp;<span class="op" id="6710402">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6710407">t</span><span class="op" id="6710408">.</span><span class="ident" id="6710409">Errorf</span><span class="op" id="6710415">(</span><span class="string" id="6710416">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(mismatched&nbsp;error)&#34;</span><span class="op" id="6710461">,</span>&nbsp;<span class="ident" id="6710463">i</span><span class="op" id="6710464">,</span>&nbsp;<span class="ident" id="6710466">tt</span><span class="op" id="6710468">.</span><span class="ident" id="6710469">ErrPrefix</span><span class="op" id="6710478">,</span>&nbsp;<span class="ident" id="6710480">err</span><span class="op" id="6710483">.</span><span class="op" id="6710484">(</span><span class="op" id="6710485">*</span><span class="ident" id="6710486">DNSError</span><span class="op" id="6710494">)</span><span class="op" id="6710495">.</span><span class="ident" id="6710496">Err</span><span class="op" id="6710499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6710507">if</span>&nbsp;<span class="ident" id="6710510">a</span>&nbsp;<span class="op" id="6710512">!=</span>&nbsp;<span class="ident" id="6710515">tt</span><span class="op" id="6710517">.</span><span class="ident" id="6710518">Reverse</span>&nbsp;<span class="op" id="6710526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6710531">t</span><span class="op" id="6710532">.</span><span class="ident" id="6710533">Errorf</span><span class="op" id="6710539">(</span><span class="string" id="6710540">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(reverse&nbsp;address)&#34;</span><span class="op" id="6710584">,</span>&nbsp;<span class="ident" id="6710586">i</span><span class="op" id="6710587">,</span>&nbsp;<span class="ident" id="6710589">tt</span><span class="op" id="6710591">.</span><span class="ident" id="6710592">Reverse</span><span class="op" id="6710599">,</span>&nbsp;<span class="ident" id="6710601">a</span><span class="op" id="6710602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710606">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710609">}</span><br>
<span class="lineno"></span><span class="op" id="6710611">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
