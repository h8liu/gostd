<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2359150">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2359205">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2359259">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2359310">package</span>&nbsp;<span class="ident" id="2359318">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2359324">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2359364">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2359424">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2359488">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2359546">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2359604">//</span><br>
<span class="lineno"></span><span class="comment" id="2359607">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2359621">//</span><br>
<span class="lineno"></span><span class="comment" id="2359624">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2359646">//</span><br>
<span class="lineno">20</span><span class="comment" id="2359649">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2359662">//</span><br>
<span class="lineno"></span><span class="comment" id="2359665">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2359688">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2359705">//</span><br>
<span class="lineno">25</span><span class="comment" id="2359708">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2359724">//</span><br>
<span class="lineno"></span><span class="comment" id="2359727">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2359804">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2359874">//</span><br>
<span class="lineno">30</span><span class="comment" id="2359877">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2359933">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2359983">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2360011">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2360065">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2360093">//</span><br>
<span class="lineno"></span><span class="comment" id="2360096">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2360109">//</span><br>
<span class="lineno"></span><span class="comment" id="2360112">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2360152">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2360211">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2360272">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2360333">//</span><br>
<span class="lineno"></span><span class="comment" id="2360336">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2360414">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2360490">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2360532">//</span><br>
<span class="lineno"></span><span class="comment" id="2360535">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2360549">//</span><br>
<span class="lineno"></span><span class="comment" id="2360552">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2360576">//</span><br>
<span class="lineno"></span><span class="comment" id="2360579">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2360592">//</span><br>
<span class="lineno"></span><span class="comment" id="2360595">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2360618">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2360635">//</span><br>
<span class="lineno"></span><span class="comment" id="2360638">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2360654">//</span><br>
<span class="lineno"></span><span class="comment" id="2360657">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2360734">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2360804">//</span><br>
<span class="lineno"></span><span class="comment" id="2360807">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2360863">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2360915">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2360943">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2360995">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2361023">//</span><br>
<span class="lineno"></span><span class="comment" id="2361026">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2361039">//</span><br>
<span class="lineno"></span><span class="comment" id="2361042">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2361082">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2361141">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2361202">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2361263">//</span><br>
<span class="lineno"></span><span class="comment" id="2361266">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2361314">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2361378">//</span><br>
<span class="lineno"></span><span class="comment" id="2361381">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2361442">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2361512">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2361587">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2361654">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2361727">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2361799">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2361813">//</span><br>
<span class="lineno">85</span><span class="comment" id="2361816">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2361882">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2361948">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2361961">//</span><br>
<span class="lineno"></span><span class="comment" id="2361964">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2361988">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2362018">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2362038">var</span>&nbsp;<span class="ident" id="2362042">_sin</span>&nbsp;<span class="op" id="2362047">=</span>&nbsp;<span class="op" id="2362049">[</span><span class="op" id="2362050">...</span><span class="op" id="2362053">]</span><span class="builtintype" id="2362054">float64</span><span class="op" id="2362061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2362064">1.58962301576546568060E-10</span><span class="op" id="2362090">,</span>&nbsp;<span class="comment" id="2362092">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2362115">-</span><span class="num" id="2362116">2.50507477628578072866E-8</span><span class="op" id="2362141">,</span>&nbsp;<span class="comment" id="2362143">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2362166">2.75573136213857245213E-6</span><span class="op" id="2362191">,</span>&nbsp;&nbsp;<span class="comment" id="2362194">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2362217">-</span><span class="num" id="2362218">1.98412698295895385996E-4</span><span class="op" id="2362243">,</span>&nbsp;<span class="comment" id="2362245">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2362268">8.33333333332211858878E-3</span><span class="op" id="2362293">,</span>&nbsp;&nbsp;<span class="comment" id="2362296">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2362319">-</span><span class="num" id="2362320">1.66666666666666307295E-1</span><span class="op" id="2362345">,</span>&nbsp;<span class="comment" id="2362347">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2362369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2362372">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2362392">var</span>&nbsp;<span class="ident" id="2362396">_cos</span>&nbsp;<span class="op" id="2362401">=</span>&nbsp;<span class="op" id="2362403">[</span><span class="op" id="2362404">...</span><span class="op" id="2362407">]</span><span class="builtintype" id="2362408">float64</span><span class="op" id="2362415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2362418">-</span><span class="num" id="2362419">1.13585365213876817300E-11</span><span class="op" id="2362445">,</span>&nbsp;<span class="comment" id="2362447">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2362470">2.08757008419747316778E-9</span><span class="op" id="2362495">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2362499">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2362522">-</span><span class="num" id="2362523">2.75573141792967388112E-7</span><span class="op" id="2362548">,</span>&nbsp;&nbsp;<span class="comment" id="2362551">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2362574">2.48015872888517045348E-5</span><span class="op" id="2362599">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2362603">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2362626">-</span><span class="num" id="2362627">1.38888888888730564116E-3</span><span class="op" id="2362652">,</span>&nbsp;&nbsp;<span class="comment" id="2362655">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2362678">4.16666666666665929218E-2</span><span class="op" id="2362703">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2362707">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2362729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2362732">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2362784">//</span><br>
<span class="lineno"></span><span class="comment" id="2362787">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2362809">//&nbsp;&nbsp;&nbsp;&nbspCos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2362829">//&nbsp;&nbsp;&nbsp;&nbspCos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2362847">func</span>&nbsp;<span class="ident" id="2362852">Cos</span><span class="op" id="2362855">(</span><span class="ident" id="2362856">x</span>&nbsp;<span class="builtintype" id="2362858">float64</span><span class="op" id="2362865">)</span>&nbsp;<span class="builtintype" id="2362867">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2362876">func</span>&nbsp;<span class="ident" id="2362881">cos</span><span class="op" id="2362884">(</span><span class="ident" id="2362885">x</span>&nbsp;<span class="builtintype" id="2362887">float64</span><span class="op" id="2362894">)</span>&nbsp;<span class="builtintype" id="2362896">float64</span>&nbsp;<span class="op" id="2362904">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2362907">const</span>&nbsp;<span class="op" id="2362913">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2362917">PI4A</span>&nbsp;<span class="op" id="2362922">=</span>&nbsp;<span class="num" id="2362924">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2362978">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363031">PI4B</span>&nbsp;<span class="op" id="2363036">=</span>&nbsp;<span class="num" id="2363038">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2363092">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363117">PI4C</span>&nbsp;<span class="op" id="2363122">=</span>&nbsp;<span class="num" id="2363124">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2363178">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363203">M4PI</span>&nbsp;<span class="op" id="2363208">=</span>&nbsp;<span class="num" id="2363210">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2363264">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2363273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2363276">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2363294">switch</span>&nbsp;<span class="op" id="2363301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2363304">case</span>&nbsp;<span class="ident" id="2363309"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2363314">(</span><span class="ident" id="2363315"><a href="/math/sin.go.html#2362885">x</a></span><span class="op" id="2363316">)</span>&nbsp;<span class="op" id="2363318">||</span>&nbsp;<span class="ident" id="2363321"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2363326">(</span><span class="ident" id="2363327"><a href="/math/sin.go.html#2362885">x</a></span><span class="op" id="2363328">,</span>&nbsp;<span class="num" id="2363330">0</span><span class="op" id="2363331">)</span><span class="op" id="2363332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2363336">return</span>&nbsp;<span class="ident" id="2363343"><a href="/math/bits.go.html#2251945">NaN</a></span><span class="op" id="2363346">(</span><span class="op" id="2363347">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2363350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2363354">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363381">sign</span>&nbsp;<span class="op" id="2363386">:=</span>&nbsp;<span class="builtintype" id="2363389">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2363396">if</span>&nbsp;<span class="ident" id="2363399"><a href="/math/sin.go.html#2362885">x</a></span>&nbsp;<span class="op" id="2363401">&lt;</span>&nbsp;<span class="num" id="2363403">0</span>&nbsp;<span class="op" id="2363405">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363409"><a href="/math/sin.go.html#2362885">x</a></span>&nbsp;<span class="op" id="2363411">=</span>&nbsp;<span class="op" id="2363413">-</span><span class="ident" id="2363414"><a href="/math/sin.go.html#2362885">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2363417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363421">j</span>&nbsp;<span class="op" id="2363423">:=</span>&nbsp;<span class="ident" id="2363426">int64</span><span class="op" id="2363431">(</span><span class="ident" id="2363432"><a href="/math/sin.go.html#2362885">x</a></span>&nbsp;<span class="op" id="2363434">*</span>&nbsp;<span class="ident" id="2363436"><a href="/math/sin.go.html#2363203">M4PI</a></span><span class="op" id="2363440">)</span>&nbsp;<span class="comment" id="2363442">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363512">y</span>&nbsp;<span class="op" id="2363514">:=</span>&nbsp;<span class="builtintype" id="2363517">float64</span><span class="op" id="2363524">(</span><span class="ident" id="2363525"><a href="/math/sin.go.html#2363421">j</a></span><span class="op" id="2363526">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2363533">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2363573">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2363597">if</span>&nbsp;<span class="ident" id="2363600"><a href="/math/sin.go.html#2363421">j</a></span><span class="op" id="2363601">&amp;</span><span class="num" id="2363602">1</span>&nbsp;<span class="op" id="2363604">==</span>&nbsp;<span class="num" id="2363607">1</span>&nbsp;<span class="op" id="2363609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363613"><a href="/math/sin.go.html#2363421">j</a></span>&nbsp;<span class="op" id="2363615">+=</span>&nbsp;<span class="num" id="2363618">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363622"><a href="/math/sin.go.html#2363512">y</a></span>&nbsp;<span class="op" id="2363624">+=</span>&nbsp;<span class="num" id="2363627">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2363630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363633"><a href="/math/sin.go.html#2363421">j</a></span>&nbsp;<span class="op" id="2363635">&amp;=</span>&nbsp;<span class="num" id="2363638">7</span>&nbsp;<span class="comment" id="2363640">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2363684">if</span>&nbsp;<span class="ident" id="2363687"><a href="/math/sin.go.html#2363421">j</a></span>&nbsp;<span class="op" id="2363689">&gt;</span>&nbsp;<span class="num" id="2363691">3</span>&nbsp;<span class="op" id="2363693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363697"><a href="/math/sin.go.html#2363421">j</a></span>&nbsp;<span class="op" id="2363699">-=</span>&nbsp;<span class="num" id="2363702">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363706"><a href="/math/sin.go.html#2363381">sign</a></span>&nbsp;<span class="op" id="2363711">=</span>&nbsp;<span class="op" id="2363713">!</span><span class="ident" id="2363714"><a href="/math/sin.go.html#2363381">sign</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2363720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2363723">if</span>&nbsp;<span class="ident" id="2363726"><a href="/math/sin.go.html#2363421">j</a></span>&nbsp;<span class="op" id="2363728">&gt;</span>&nbsp;<span class="num" id="2363730">1</span>&nbsp;<span class="op" id="2363732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363736"><a href="/math/sin.go.html#2363381">sign</a></span>&nbsp;<span class="op" id="2363741">=</span>&nbsp;<span class="op" id="2363743">!</span><span class="ident" id="2363744"><a href="/math/sin.go.html#2363381">sign</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2363750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363754">z</span>&nbsp;<span class="op" id="2363756">:=</span>&nbsp;<span class="op" id="2363759">(</span><span class="op" id="2363760">(</span><span class="ident" id="2363761"><a href="/math/sin.go.html#2362885">x</a></span>&nbsp;<span class="op" id="2363763">-</span>&nbsp;<span class="ident" id="2363765"><a href="/math/sin.go.html#2363512">y</a></span><span class="op" id="2363766">*</span><span class="ident" id="2363767"><a href="/math/sin.go.html#2362917">PI4A</a></span><span class="op" id="2363771">)</span>&nbsp;<span class="op" id="2363773">-</span>&nbsp;<span class="ident" id="2363775"><a href="/math/sin.go.html#2363512">y</a></span><span class="op" id="2363776">*</span><span class="ident" id="2363777"><a href="/math/sin.go.html#2363031">PI4B</a></span><span class="op" id="2363781">)</span>&nbsp;<span class="op" id="2363783">-</span>&nbsp;<span class="ident" id="2363785"><a href="/math/sin.go.html#2363512">y</a></span><span class="op" id="2363786">*</span><span class="ident" id="2363787"><a href="/math/sin.go.html#2363117">PI4C</a></span>&nbsp;<span class="comment" id="2363792">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363834">zz</span>&nbsp;<span class="op" id="2363837">:=</span>&nbsp;<span class="ident" id="2363840"><a href="/math/sin.go.html#2363754">z</a></span>&nbsp;<span class="op" id="2363842">*</span>&nbsp;<span class="ident" id="2363844"><a href="/math/sin.go.html#2363754">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2363847">if</span>&nbsp;<span class="ident" id="2363850"><a href="/math/sin.go.html#2363421">j</a></span>&nbsp;<span class="op" id="2363852">==</span>&nbsp;<span class="num" id="2363855">1</span>&nbsp;<span class="op" id="2363857">||</span>&nbsp;<span class="ident" id="2363860"><a href="/math/sin.go.html#2363421">j</a></span>&nbsp;<span class="op" id="2363862">==</span>&nbsp;<span class="num" id="2363865">2</span>&nbsp;<span class="op" id="2363867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363871"><a href="/math/sin.go.html#2363512">y</a></span>&nbsp;<span class="op" id="2363873">=</span>&nbsp;<span class="ident" id="2363875"><a href="/math/sin.go.html#2363754">z</a></span>&nbsp;<span class="op" id="2363877">+</span>&nbsp;<span class="ident" id="2363879"><a href="/math/sin.go.html#2363754">z</a></span><span class="op" id="2363880">*</span><span class="ident" id="2363881"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2363883">*</span><span class="op" id="2363884">(</span><span class="op" id="2363885">(</span><span class="op" id="2363886">(</span><span class="op" id="2363887">(</span><span class="op" id="2363888">(</span><span class="op" id="2363889">(</span><span class="ident" id="2363890"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2363894">[</span><span class="num" id="2363895">0</span><span class="op" id="2363896">]</span><span class="op" id="2363897">*</span><span class="ident" id="2363898"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2363900">)</span><span class="op" id="2363901">+</span><span class="ident" id="2363902"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2363906">[</span><span class="num" id="2363907">1</span><span class="op" id="2363908">]</span><span class="op" id="2363909">)</span><span class="op" id="2363910">*</span><span class="ident" id="2363911"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2363913">+</span><span class="ident" id="2363914"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2363918">[</span><span class="num" id="2363919">2</span><span class="op" id="2363920">]</span><span class="op" id="2363921">)</span><span class="op" id="2363922">*</span><span class="ident" id="2363923"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2363925">+</span><span class="ident" id="2363926"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2363930">[</span><span class="num" id="2363931">3</span><span class="op" id="2363932">]</span><span class="op" id="2363933">)</span><span class="op" id="2363934">*</span><span class="ident" id="2363935"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2363937">+</span><span class="ident" id="2363938"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2363942">[</span><span class="num" id="2363943">4</span><span class="op" id="2363944">]</span><span class="op" id="2363945">)</span><span class="op" id="2363946">*</span><span class="ident" id="2363947"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2363949">+</span><span class="ident" id="2363950"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2363954">[</span><span class="num" id="2363955">5</span><span class="op" id="2363956">]</span><span class="op" id="2363957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2363960">}</span>&nbsp;<span class="keyword" id="2363962">else</span>&nbsp;<span class="op" id="2363967">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2363971"><a href="/math/sin.go.html#2363512">y</a></span>&nbsp;<span class="op" id="2363973">=</span>&nbsp;<span class="num" id="2363975">1.0</span>&nbsp;<span class="op" id="2363979">-</span>&nbsp;<span class="num" id="2363981">0.5</span><span class="op" id="2363984">*</span><span class="ident" id="2363985"><a href="/math/sin.go.html#2363834">zz</a></span>&nbsp;<span class="op" id="2363988">+</span>&nbsp;<span class="ident" id="2363990"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2363992">*</span><span class="ident" id="2363993"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2363995">*</span><span class="op" id="2363996">(</span><span class="op" id="2363997">(</span><span class="op" id="2363998">(</span><span class="op" id="2363999">(</span><span class="op" id="2364000">(</span><span class="op" id="2364001">(</span><span class="ident" id="2364002"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2364006">[</span><span class="num" id="2364007">0</span><span class="op" id="2364008">]</span><span class="op" id="2364009">*</span><span class="ident" id="2364010"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2364012">)</span><span class="op" id="2364013">+</span><span class="ident" id="2364014"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2364018">[</span><span class="num" id="2364019">1</span><span class="op" id="2364020">]</span><span class="op" id="2364021">)</span><span class="op" id="2364022">*</span><span class="ident" id="2364023"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2364025">+</span><span class="ident" id="2364026"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2364030">[</span><span class="num" id="2364031">2</span><span class="op" id="2364032">]</span><span class="op" id="2364033">)</span><span class="op" id="2364034">*</span><span class="ident" id="2364035"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2364037">+</span><span class="ident" id="2364038"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2364042">[</span><span class="num" id="2364043">3</span><span class="op" id="2364044">]</span><span class="op" id="2364045">)</span><span class="op" id="2364046">*</span><span class="ident" id="2364047"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2364049">+</span><span class="ident" id="2364050"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2364054">[</span><span class="num" id="2364055">4</span><span class="op" id="2364056">]</span><span class="op" id="2364057">)</span><span class="op" id="2364058">*</span><span class="ident" id="2364059"><a href="/math/sin.go.html#2363834">zz</a></span><span class="op" id="2364061">+</span><span class="ident" id="2364062"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2364066">[</span><span class="num" id="2364067">5</span><span class="op" id="2364068">]</span><span class="op" id="2364069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2364072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2364075">if</span>&nbsp;<span class="ident" id="2364078"><a href="/math/sin.go.html#2363381">sign</a></span>&nbsp;<span class="op" id="2364083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364087"><a href="/math/sin.go.html#2363512">y</a></span>&nbsp;<span class="op" id="2364089">=</span>&nbsp;<span class="op" id="2364091">-</span><span class="ident" id="2364092"><a href="/math/sin.go.html#2363512">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2364095">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2364098">return</span>&nbsp;<span class="ident" id="2364105"><a href="/math/sin.go.html#2363512">y</a></span><br>
<span class="lineno"></span><span class="op" id="2364107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2364110">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2364160">//</span><br>
<span class="lineno">170</span><span class="comment" id="2364163">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2364185">//&nbsp;&nbsp;&nbsp;&nbspSin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2364203">//&nbsp;&nbsp;&nbsp;&nbspSin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2364223">//&nbsp;&nbsp;&nbsp;&nbspSin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2364241">func</span>&nbsp;<span class="ident" id="2364246">Sin</span><span class="op" id="2364249">(</span><span class="ident" id="2364250">x</span>&nbsp;<span class="builtintype" id="2364252">float64</span><span class="op" id="2364259">)</span>&nbsp;<span class="builtintype" id="2364261">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2364270">func</span>&nbsp;<span class="ident" id="2364275">sin</span><span class="op" id="2364278">(</span><span class="ident" id="2364279">x</span>&nbsp;<span class="builtintype" id="2364281">float64</span><span class="op" id="2364288">)</span>&nbsp;<span class="builtintype" id="2364290">float64</span>&nbsp;<span class="op" id="2364298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2364301">const</span>&nbsp;<span class="op" id="2364307">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364311">PI4A</span>&nbsp;<span class="op" id="2364316">=</span>&nbsp;<span class="num" id="2364318">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2364372">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364425">PI4B</span>&nbsp;<span class="op" id="2364430">=</span>&nbsp;<span class="num" id="2364432">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2364486">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364511">PI4C</span>&nbsp;<span class="op" id="2364516">=</span>&nbsp;<span class="num" id="2364518">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2364572">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364597">M4PI</span>&nbsp;<span class="op" id="2364602">=</span>&nbsp;<span class="num" id="2364604">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2364658">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2364667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2364670">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2364688">switch</span>&nbsp;<span class="op" id="2364695">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2364698">case</span>&nbsp;<span class="ident" id="2364703"><a href="/math/sin.go.html#2364279">x</a></span>&nbsp;<span class="op" id="2364705">==</span>&nbsp;<span class="num" id="2364708">0</span>&nbsp;<span class="op" id="2364710">||</span>&nbsp;<span class="ident" id="2364713"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2364718">(</span><span class="ident" id="2364719"><a href="/math/sin.go.html#2364279">x</a></span><span class="op" id="2364720">)</span><span class="op" id="2364721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2364725">return</span>&nbsp;<span class="ident" id="2364732"><a href="/math/sin.go.html#2364279">x</a></span>&nbsp;<span class="comment" id="2364734">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2364758">case</span>&nbsp;<span class="ident" id="2364763"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2364768">(</span><span class="ident" id="2364769"><a href="/math/sin.go.html#2364279">x</a></span><span class="op" id="2364770">,</span>&nbsp;<span class="num" id="2364772">0</span><span class="op" id="2364773">)</span><span class="op" id="2364774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2364778">return</span>&nbsp;<span class="ident" id="2364785"><a href="/math/bits.go.html#2251945">NaN</a></span><span class="op" id="2364788">(</span><span class="op" id="2364789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2364792">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2364796">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364841">sign</span>&nbsp;<span class="op" id="2364846">:=</span>&nbsp;<span class="builtintype" id="2364849">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2364856">if</span>&nbsp;<span class="ident" id="2364859"><a href="/math/sin.go.html#2364279">x</a></span>&nbsp;<span class="op" id="2364861">&lt;</span>&nbsp;<span class="num" id="2364863">0</span>&nbsp;<span class="op" id="2364865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364869"><a href="/math/sin.go.html#2364279">x</a></span>&nbsp;<span class="op" id="2364871">=</span>&nbsp;<span class="op" id="2364873">-</span><span class="ident" id="2364874"><a href="/math/sin.go.html#2364279">x</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364878"><a href="/math/sin.go.html#2364841">sign</a></span>&nbsp;<span class="op" id="2364883">=</span>&nbsp;<span class="builtintype" id="2364885">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2364891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364895">j</span>&nbsp;<span class="op" id="2364897">:=</span>&nbsp;<span class="ident" id="2364900">int64</span><span class="op" id="2364905">(</span><span class="ident" id="2364906"><a href="/math/sin.go.html#2364279">x</a></span>&nbsp;<span class="op" id="2364908">*</span>&nbsp;<span class="ident" id="2364910"><a href="/math/sin.go.html#2364597">M4PI</a></span><span class="op" id="2364914">)</span>&nbsp;<span class="comment" id="2364916">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2364986">y</span>&nbsp;<span class="op" id="2364988">:=</span>&nbsp;<span class="builtintype" id="2364991">float64</span><span class="op" id="2364998">(</span><span class="ident" id="2364999"><a href="/math/sin.go.html#2364895">j</a></span><span class="op" id="2365000">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2365007">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2365047">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2365071">if</span>&nbsp;<span class="ident" id="2365074"><a href="/math/sin.go.html#2364895">j</a></span><span class="op" id="2365075">&amp;</span><span class="num" id="2365076">1</span>&nbsp;<span class="op" id="2365078">==</span>&nbsp;<span class="num" id="2365081">1</span>&nbsp;<span class="op" id="2365083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365087"><a href="/math/sin.go.html#2364895">j</a></span>&nbsp;<span class="op" id="2365089">+=</span>&nbsp;<span class="num" id="2365092">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365096"><a href="/math/sin.go.html#2364986">y</a></span>&nbsp;<span class="op" id="2365098">+=</span>&nbsp;<span class="num" id="2365101">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2365104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365107"><a href="/math/sin.go.html#2364895">j</a></span>&nbsp;<span class="op" id="2365109">&amp;=</span>&nbsp;<span class="num" id="2365112">7</span>&nbsp;<span class="comment" id="2365114">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2365158">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2365180">if</span>&nbsp;<span class="ident" id="2365183"><a href="/math/sin.go.html#2364895">j</a></span>&nbsp;<span class="op" id="2365185">&gt;</span>&nbsp;<span class="num" id="2365187">3</span>&nbsp;<span class="op" id="2365189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365193"><a href="/math/sin.go.html#2364841">sign</a></span>&nbsp;<span class="op" id="2365198">=</span>&nbsp;<span class="op" id="2365200">!</span><span class="ident" id="2365201"><a href="/math/sin.go.html#2364841">sign</a></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365208"><a href="/math/sin.go.html#2364895">j</a></span>&nbsp;<span class="op" id="2365210">-=</span>&nbsp;<span class="num" id="2365213">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2365216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365220">z</span>&nbsp;<span class="op" id="2365222">:=</span>&nbsp;<span class="op" id="2365225">(</span><span class="op" id="2365226">(</span><span class="ident" id="2365227"><a href="/math/sin.go.html#2364279">x</a></span>&nbsp;<span class="op" id="2365229">-</span>&nbsp;<span class="ident" id="2365231"><a href="/math/sin.go.html#2364986">y</a></span><span class="op" id="2365232">*</span><span class="ident" id="2365233"><a href="/math/sin.go.html#2364311">PI4A</a></span><span class="op" id="2365237">)</span>&nbsp;<span class="op" id="2365239">-</span>&nbsp;<span class="ident" id="2365241"><a href="/math/sin.go.html#2364986">y</a></span><span class="op" id="2365242">*</span><span class="ident" id="2365243"><a href="/math/sin.go.html#2364425">PI4B</a></span><span class="op" id="2365247">)</span>&nbsp;<span class="op" id="2365249">-</span>&nbsp;<span class="ident" id="2365251"><a href="/math/sin.go.html#2364986">y</a></span><span class="op" id="2365252">*</span><span class="ident" id="2365253"><a href="/math/sin.go.html#2364511">PI4C</a></span>&nbsp;<span class="comment" id="2365258">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365300">zz</span>&nbsp;<span class="op" id="2365303">:=</span>&nbsp;<span class="ident" id="2365306"><a href="/math/sin.go.html#2365220">z</a></span>&nbsp;<span class="op" id="2365308">*</span>&nbsp;<span class="ident" id="2365310"><a href="/math/sin.go.html#2365220">z</a></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2365313">if</span>&nbsp;<span class="ident" id="2365316"><a href="/math/sin.go.html#2364895">j</a></span>&nbsp;<span class="op" id="2365318">==</span>&nbsp;<span class="num" id="2365321">1</span>&nbsp;<span class="op" id="2365323">||</span>&nbsp;<span class="ident" id="2365326"><a href="/math/sin.go.html#2364895">j</a></span>&nbsp;<span class="op" id="2365328">==</span>&nbsp;<span class="num" id="2365331">2</span>&nbsp;<span class="op" id="2365333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365337"><a href="/math/sin.go.html#2364986">y</a></span>&nbsp;<span class="op" id="2365339">=</span>&nbsp;<span class="num" id="2365341">1.0</span>&nbsp;<span class="op" id="2365345">-</span>&nbsp;<span class="num" id="2365347">0.5</span><span class="op" id="2365350">*</span><span class="ident" id="2365351"><a href="/math/sin.go.html#2365300">zz</a></span>&nbsp;<span class="op" id="2365354">+</span>&nbsp;<span class="ident" id="2365356"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365358">*</span><span class="ident" id="2365359"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365361">*</span><span class="op" id="2365362">(</span><span class="op" id="2365363">(</span><span class="op" id="2365364">(</span><span class="op" id="2365365">(</span><span class="op" id="2365366">(</span><span class="op" id="2365367">(</span><span class="ident" id="2365368"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2365372">[</span><span class="num" id="2365373">0</span><span class="op" id="2365374">]</span><span class="op" id="2365375">*</span><span class="ident" id="2365376"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365378">)</span><span class="op" id="2365379">+</span><span class="ident" id="2365380"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2365384">[</span><span class="num" id="2365385">1</span><span class="op" id="2365386">]</span><span class="op" id="2365387">)</span><span class="op" id="2365388">*</span><span class="ident" id="2365389"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365391">+</span><span class="ident" id="2365392"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2365396">[</span><span class="num" id="2365397">2</span><span class="op" id="2365398">]</span><span class="op" id="2365399">)</span><span class="op" id="2365400">*</span><span class="ident" id="2365401"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365403">+</span><span class="ident" id="2365404"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2365408">[</span><span class="num" id="2365409">3</span><span class="op" id="2365410">]</span><span class="op" id="2365411">)</span><span class="op" id="2365412">*</span><span class="ident" id="2365413"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365415">+</span><span class="ident" id="2365416"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2365420">[</span><span class="num" id="2365421">4</span><span class="op" id="2365422">]</span><span class="op" id="2365423">)</span><span class="op" id="2365424">*</span><span class="ident" id="2365425"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365427">+</span><span class="ident" id="2365428"><a href="/math/sin.go.html#2362396">_cos</a></span><span class="op" id="2365432">[</span><span class="num" id="2365433">5</span><span class="op" id="2365434">]</span><span class="op" id="2365435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2365438">}</span>&nbsp;<span class="keyword" id="2365440">else</span>&nbsp;<span class="op" id="2365445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365449"><a href="/math/sin.go.html#2364986">y</a></span>&nbsp;<span class="op" id="2365451">=</span>&nbsp;<span class="ident" id="2365453"><a href="/math/sin.go.html#2365220">z</a></span>&nbsp;<span class="op" id="2365455">+</span>&nbsp;<span class="ident" id="2365457"><a href="/math/sin.go.html#2365220">z</a></span><span class="op" id="2365458">*</span><span class="ident" id="2365459"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365461">*</span><span class="op" id="2365462">(</span><span class="op" id="2365463">(</span><span class="op" id="2365464">(</span><span class="op" id="2365465">(</span><span class="op" id="2365466">(</span><span class="op" id="2365467">(</span><span class="ident" id="2365468"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2365472">[</span><span class="num" id="2365473">0</span><span class="op" id="2365474">]</span><span class="op" id="2365475">*</span><span class="ident" id="2365476"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365478">)</span><span class="op" id="2365479">+</span><span class="ident" id="2365480"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2365484">[</span><span class="num" id="2365485">1</span><span class="op" id="2365486">]</span><span class="op" id="2365487">)</span><span class="op" id="2365488">*</span><span class="ident" id="2365489"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365491">+</span><span class="ident" id="2365492"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2365496">[</span><span class="num" id="2365497">2</span><span class="op" id="2365498">]</span><span class="op" id="2365499">)</span><span class="op" id="2365500">*</span><span class="ident" id="2365501"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365503">+</span><span class="ident" id="2365504"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2365508">[</span><span class="num" id="2365509">3</span><span class="op" id="2365510">]</span><span class="op" id="2365511">)</span><span class="op" id="2365512">*</span><span class="ident" id="2365513"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365515">+</span><span class="ident" id="2365516"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2365520">[</span><span class="num" id="2365521">4</span><span class="op" id="2365522">]</span><span class="op" id="2365523">)</span><span class="op" id="2365524">*</span><span class="ident" id="2365525"><a href="/math/sin.go.html#2365300">zz</a></span><span class="op" id="2365527">+</span><span class="ident" id="2365528"><a href="/math/sin.go.html#2362042">_sin</a></span><span class="op" id="2365532">[</span><span class="num" id="2365533">5</span><span class="op" id="2365534">]</span><span class="op" id="2365535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2365538">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2365541">if</span>&nbsp;<span class="ident" id="2365544"><a href="/math/sin.go.html#2364841">sign</a></span>&nbsp;<span class="op" id="2365549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2365553"><a href="/math/sin.go.html#2364986">y</a></span>&nbsp;<span class="op" id="2365555">=</span>&nbsp;<span class="op" id="2365557">-</span><span class="ident" id="2365558"><a href="/math/sin.go.html#2364986">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2365561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2365564">return</span>&nbsp;<span class="ident" id="2365571"><a href="/math/sin.go.html#2364986">y</a></span><br>
<span class="lineno"></span><span class="op" id="2365573">}</span>
</div>
</body>
</html>
