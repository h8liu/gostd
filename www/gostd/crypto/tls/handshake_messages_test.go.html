<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html" class="current">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6575019">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6575074">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6575128">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6575179">package</span>&nbsp;<span class="ident" id="6575187">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6575192">import</span>&nbsp;<span class="op" id="6575199">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6575202">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6575215">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6575226">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6575237">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="6575253">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6575256">var</span>&nbsp;<span class="ident" id="6575260">tests</span>&nbsp;<span class="op" id="6575266">=</span>&nbsp;<span class="op" id="6575268">[</span><span class="op" id="6575269">]</span><span class="keyword" id="6575270">interface</span><span class="op" id="6575279">{</span><span class="op" id="6575280">}</span><span class="op" id="6575281">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575284">&amp;</span><span class="ident" id="6575285">clientHelloMsg</span><span class="op" id="6575299">{</span><span class="op" id="6575300">}</span><span class="op" id="6575301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575304">&amp;</span><span class="ident" id="6575305">serverHelloMsg</span><span class="op" id="6575319">{</span><span class="op" id="6575320">}</span><span class="op" id="6575321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575324">&amp;</span><span class="ident" id="6575325">finishedMsg</span><span class="op" id="6575336">{</span><span class="op" id="6575337">}</span><span class="op" id="6575338">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575342">&amp;</span><span class="ident" id="6575343">certificateMsg</span><span class="op" id="6575357">{</span><span class="op" id="6575358">}</span><span class="op" id="6575359">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575362">&amp;</span><span class="ident" id="6575363">certificateRequestMsg</span><span class="op" id="6575384">{</span><span class="op" id="6575385">}</span><span class="op" id="6575386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575389">&amp;</span><span class="ident" id="6575390">certificateVerifyMsg</span><span class="op" id="6575410">{</span><span class="op" id="6575411">}</span><span class="op" id="6575412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575415">&amp;</span><span class="ident" id="6575416">certificateStatusMsg</span><span class="op" id="6575436">{</span><span class="op" id="6575437">}</span><span class="op" id="6575438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575441">&amp;</span><span class="ident" id="6575442">clientKeyExchangeMsg</span><span class="op" id="6575462">{</span><span class="op" id="6575463">}</span><span class="op" id="6575464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575467">&amp;</span><span class="ident" id="6575468">nextProtoMsg</span><span class="op" id="6575480">{</span><span class="op" id="6575481">}</span><span class="op" id="6575482">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575485">&amp;</span><span class="ident" id="6575486">newSessionTicketMsg</span><span class="op" id="6575505">{</span><span class="op" id="6575506">}</span><span class="op" id="6575507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575510">&amp;</span><span class="ident" id="6575511">sessionState</span><span class="op" id="6575523">{</span><span class="op" id="6575524">}</span><span class="op" id="6575525">,</span><br>
<span class="lineno"></span><span class="op" id="6575527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6575530">type</span>&nbsp;<span class="ident" id="6575535">testMessage</span>&nbsp;<span class="keyword" id="6575547">interface</span>&nbsp;<span class="op" id="6575557">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575560">marshal</span><span class="op" id="6575567">(</span><span class="op" id="6575568">)</span>&nbsp;<span class="op" id="6575570">[</span><span class="op" id="6575571">]</span><span class="builtintype" id="6575572">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575578">unmarshal</span><span class="op" id="6575587">(</span><span class="op" id="6575588">[</span><span class="op" id="6575589">]</span><span class="builtintype" id="6575590">byte</span><span class="op" id="6575594">)</span>&nbsp;<span class="builtintype" id="6575596">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575602">equal</span><span class="op" id="6575607">(</span><span class="keyword" id="6575608">interface</span><span class="op" id="6575617">{</span><span class="op" id="6575618">}</span><span class="op" id="6575619">)</span>&nbsp;<span class="builtintype" id="6575621">bool</span><br>
<span class="lineno"></span><span class="op" id="6575626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6575629">func</span>&nbsp;<span class="ident" id="6575634">TestMarshalUnmarshal</span><span class="op" id="6575654">(</span><span class="ident" id="6575655">t</span>&nbsp;<span class="op" id="6575657">*</span><span class="ident" id="6575658">testing</span><span class="op" id="6575665">.</span><span class="ident" id="6575666">T</span><span class="op" id="6575667">)</span>&nbsp;<span class="op" id="6575669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575672">rand</span>&nbsp;<span class="op" id="6575677">:=</span>&nbsp;<span class="ident" id="6575680">rand</span><span class="op" id="6575684">.</span><span class="ident" id="6575685">New</span><span class="op" id="6575688">(</span><span class="ident" id="6575689">rand</span><span class="op" id="6575693">.</span><span class="ident" id="6575694">NewSource</span><span class="op" id="6575703">(</span><span class="num" id="6575704">0</span><span class="op" id="6575705">)</span><span class="op" id="6575706">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575710">for</span>&nbsp;<span class="ident" id="6575714">i</span><span class="op" id="6575715">,</span>&nbsp;<span class="ident" id="6575717">iface</span>&nbsp;<span class="op" id="6575723">:=</span>&nbsp;<span class="keyword" id="6575726">range</span>&nbsp;<span class="ident" id="6575732">tests</span>&nbsp;<span class="op" id="6575738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575742">ty</span>&nbsp;<span class="op" id="6575745">:=</span>&nbsp;<span class="ident" id="6575748">reflect</span><span class="op" id="6575755">.</span><span class="ident" id="6575756">ValueOf</span><span class="op" id="6575763">(</span><span class="ident" id="6575764">iface</span><span class="op" id="6575769">)</span><span class="op" id="6575770">.</span><span class="ident" id="6575771">Type</span><span class="op" id="6575775">(</span><span class="op" id="6575776">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575781">n</span>&nbsp;<span class="op" id="6575783">:=</span>&nbsp;<span class="num" id="6575786">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575792">if</span>&nbsp;<span class="ident" id="6575795">testing</span><span class="op" id="6575802">.</span><span class="ident" id="6575803">Short</span><span class="op" id="6575808">(</span><span class="op" id="6575809">)</span>&nbsp;<span class="op" id="6575811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575816">n</span>&nbsp;<span class="op" id="6575818">=</span>&nbsp;<span class="num" id="6575820">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575824">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575828">for</span>&nbsp;<span class="ident" id="6575832">j</span>&nbsp;<span class="op" id="6575834">:=</span>&nbsp;<span class="num" id="6575837">0</span><span class="op" id="6575838">;</span>&nbsp;<span class="ident" id="6575840">j</span>&nbsp;<span class="op" id="6575842">&lt;</span>&nbsp;<span class="ident" id="6575844">n</span><span class="op" id="6575845">;</span>&nbsp;<span class="ident" id="6575847">j</span><span class="op" id="6575848">++</span>&nbsp;<span class="op" id="6575851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575856">v</span><span class="op" id="6575857">,</span>&nbsp;<span class="ident" id="6575859">ok</span>&nbsp;<span class="op" id="6575862">:=</span>&nbsp;<span class="ident" id="6575865">quick</span><span class="op" id="6575870">.</span><span class="ident" id="6575871">Value</span><span class="op" id="6575876">(</span><span class="ident" id="6575877">ty</span><span class="op" id="6575879">,</span>&nbsp;<span class="ident" id="6575881">rand</span><span class="op" id="6575885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575890">if</span>&nbsp;<span class="op" id="6575893">!</span><span class="ident" id="6575894">ok</span>&nbsp;<span class="op" id="6575897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575903">t</span><span class="op" id="6575904">.</span><span class="ident" id="6575905">Errorf</span><span class="op" id="6575911">(</span><span class="string" id="6575912">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="6575941">,</span>&nbsp;<span class="ident" id="6575943">i</span><span class="op" id="6575944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6575950">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6575965">m1</span>&nbsp;<span class="op" id="6575968">:=</span>&nbsp;<span class="ident" id="6575971">v</span><span class="op" id="6575972">.</span><span class="ident" id="6575973">Interface</span><span class="op" id="6575982">(</span><span class="op" id="6575983">)</span><span class="op" id="6575984">.</span><span class="op" id="6575985">(</span><span class="ident" id="6575986">testMessage</span><span class="op" id="6575997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576002">marshaled</span>&nbsp;<span class="op" id="6576012">:=</span>&nbsp;<span class="ident" id="6576015">m1</span><span class="op" id="6576017">.</span><span class="ident" id="6576018">marshal</span><span class="op" id="6576025">(</span><span class="op" id="6576026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576031">m2</span>&nbsp;<span class="op" id="6576034">:=</span>&nbsp;<span class="ident" id="6576037">iface</span><span class="op" id="6576042">.</span><span class="op" id="6576043">(</span><span class="ident" id="6576044">testMessage</span><span class="op" id="6576055">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576060">if</span>&nbsp;<span class="op" id="6576063">!</span><span class="ident" id="6576064">m2</span><span class="op" id="6576066">.</span><span class="ident" id="6576067">unmarshal</span><span class="op" id="6576076">(</span><span class="ident" id="6576077">marshaled</span><span class="op" id="6576086">)</span>&nbsp;<span class="op" id="6576088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576094">t</span><span class="op" id="6576095">.</span><span class="ident" id="6576096">Errorf</span><span class="op" id="6576102">(</span><span class="string" id="6576103">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="6576135">,</span>&nbsp;<span class="ident" id="6576137">i</span><span class="op" id="6576138">,</span>&nbsp;<span class="ident" id="6576140">m1</span><span class="op" id="6576142">,</span>&nbsp;<span class="ident" id="6576144">marshaled</span><span class="op" id="6576153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576159">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576173">m2</span><span class="op" id="6576175">.</span><span class="ident" id="6576176">marshal</span><span class="op" id="6576183">(</span><span class="op" id="6576184">)</span>&nbsp;<span class="comment" id="6576186">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576234">if</span>&nbsp;<span class="op" id="6576237">!</span><span class="ident" id="6576238">m1</span><span class="op" id="6576240">.</span><span class="ident" id="6576241">equal</span><span class="op" id="6576246">(</span><span class="ident" id="6576247">m2</span><span class="op" id="6576249">)</span>&nbsp;<span class="op" id="6576251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576257">t</span><span class="op" id="6576258">.</span><span class="ident" id="6576259">Errorf</span><span class="op" id="6576265">(</span><span class="string" id="6576266">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="6576291">,</span>&nbsp;<span class="ident" id="6576293">i</span><span class="op" id="6576294">,</span>&nbsp;<span class="ident" id="6576296">m2</span><span class="op" id="6576298">,</span>&nbsp;<span class="ident" id="6576300">m1</span><span class="op" id="6576302">,</span>&nbsp;<span class="ident" id="6576304">marshaled</span><span class="op" id="6576313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576319">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576328">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576334">if</span>&nbsp;<span class="ident" id="6576337">i</span>&nbsp;<span class="op" id="6576339">&gt;=</span>&nbsp;<span class="num" id="6576342">3</span>&nbsp;<span class="op" id="6576344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6576350">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6576401">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6576449">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6576501">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6576547">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576587">for</span>&nbsp;<span class="ident" id="6576591">j</span>&nbsp;<span class="op" id="6576593">:=</span>&nbsp;<span class="num" id="6576596">0</span><span class="op" id="6576597">;</span>&nbsp;<span class="ident" id="6576599">j</span>&nbsp;<span class="op" id="6576601">&lt;</span>&nbsp;<span class="builtinfunc" id="6576603">len</span><span class="op" id="6576606">(</span><span class="ident" id="6576607">marshaled</span><span class="op" id="6576616">)</span><span class="op" id="6576617">;</span>&nbsp;<span class="ident" id="6576619">j</span><span class="op" id="6576620">++</span>&nbsp;<span class="op" id="6576623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576630">if</span>&nbsp;<span class="ident" id="6576633">m2</span><span class="op" id="6576635">.</span><span class="ident" id="6576636">unmarshal</span><span class="op" id="6576645">(</span><span class="ident" id="6576646">marshaled</span><span class="op" id="6576655">[</span><span class="num" id="6576656">0</span><span class="op" id="6576657">:</span><span class="ident" id="6576658">j</span><span class="op" id="6576659">]</span><span class="op" id="6576660">)</span>&nbsp;<span class="op" id="6576662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576670">t</span><span class="op" id="6576671">.</span><span class="ident" id="6576672">Errorf</span><span class="op" id="6576678">(</span><span class="string" id="6576679">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="6576725">,</span>&nbsp;<span class="ident" id="6576727">i</span><span class="op" id="6576728">,</span>&nbsp;<span class="ident" id="6576730">j</span><span class="op" id="6576731">,</span>&nbsp;<span class="ident" id="6576733">m1</span><span class="op" id="6576735">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576743">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576769">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576772">}</span><br>
<span class="lineno"></span><span class="op" id="6576774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6576777">func</span>&nbsp;<span class="ident" id="6576782">TestFuzz</span><span class="op" id="6576790">(</span><span class="ident" id="6576791">t</span>&nbsp;<span class="op" id="6576793">*</span><span class="ident" id="6576794">testing</span><span class="op" id="6576801">.</span><span class="ident" id="6576802">T</span><span class="op" id="6576803">)</span>&nbsp;<span class="op" id="6576805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576808">rand</span>&nbsp;<span class="op" id="6576813">:=</span>&nbsp;<span class="ident" id="6576816">rand</span><span class="op" id="6576820">.</span><span class="ident" id="6576821">New</span><span class="op" id="6576824">(</span><span class="ident" id="6576825">rand</span><span class="op" id="6576829">.</span><span class="ident" id="6576830">NewSource</span><span class="op" id="6576839">(</span><span class="num" id="6576840">0</span><span class="op" id="6576841">)</span><span class="op" id="6576842">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576845">for</span>&nbsp;<span class="ident" id="6576849">_</span><span class="op" id="6576850">,</span>&nbsp;<span class="ident" id="6576852">iface</span>&nbsp;<span class="op" id="6576858">:=</span>&nbsp;<span class="keyword" id="6576861">range</span>&nbsp;<span class="ident" id="6576867">tests</span>&nbsp;<span class="op" id="6576873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576877">m</span>&nbsp;<span class="op" id="6576879">:=</span>&nbsp;<span class="ident" id="6576882">iface</span><span class="op" id="6576887">.</span><span class="op" id="6576888">(</span><span class="ident" id="6576889">testMessage</span><span class="op" id="6576900">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6576905">for</span>&nbsp;<span class="ident" id="6576909">j</span>&nbsp;<span class="op" id="6576911">:=</span>&nbsp;<span class="num" id="6576914">0</span><span class="op" id="6576915">;</span>&nbsp;<span class="ident" id="6576917">j</span>&nbsp;<span class="op" id="6576919">&lt;</span>&nbsp;<span class="num" id="6576921">1000</span><span class="op" id="6576925">;</span>&nbsp;<span class="ident" id="6576927">j</span><span class="op" id="6576928">++</span>&nbsp;<span class="op" id="6576931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6576936">len</span>&nbsp;<span class="op" id="6576940">:=</span>&nbsp;<span class="ident" id="6576943">rand</span><span class="op" id="6576947">.</span><span class="ident" id="6576948">Intn</span><span class="op" id="6576952">(</span><span class="num" id="6576953">100</span><span class="op" id="6576956">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6576961">bytes</span>&nbsp;<span class="op" id="6576967">:=</span>&nbsp;<span class="ident" id="6576970">randomBytes</span><span class="op" id="6576981">(</span><span class="builtinfunc" id="6576982">len</span><span class="op" id="6576985">,</span>&nbsp;<span class="ident" id="6576987">rand</span><span class="op" id="6576991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6576996">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577056">m</span><span class="op" id="6577057">.</span><span class="ident" id="6577058">unmarshal</span><span class="op" id="6577067">(</span><span class="ident" id="6577068">bytes</span><span class="op" id="6577073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577080">}</span><br>
<span class="lineno">95</span><span class="op" id="6577082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6577085">func</span>&nbsp;<span class="ident" id="6577090">randomBytes</span><span class="op" id="6577101">(</span><span class="ident" id="6577102">n</span>&nbsp;<span class="builtintype" id="6577104">int</span><span class="op" id="6577107">,</span>&nbsp;<span class="ident" id="6577109">rand</span>&nbsp;<span class="op" id="6577114">*</span><span class="ident" id="6577115">rand</span><span class="op" id="6577119">.</span><span class="ident" id="6577120">Rand</span><span class="op" id="6577124">)</span>&nbsp;<span class="op" id="6577126">[</span><span class="op" id="6577127">]</span><span class="builtintype" id="6577128">byte</span>&nbsp;<span class="op" id="6577133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577136">r</span>&nbsp;<span class="op" id="6577138">:=</span>&nbsp;<span class="builtinfunc" id="6577141">make</span><span class="op" id="6577145">(</span><span class="op" id="6577146">[</span><span class="op" id="6577147">]</span><span class="builtintype" id="6577148">byte</span><span class="op" id="6577152">,</span>&nbsp;<span class="ident" id="6577154">n</span><span class="op" id="6577155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577158">for</span>&nbsp;<span class="ident" id="6577162">i</span>&nbsp;<span class="op" id="6577164">:=</span>&nbsp;<span class="num" id="6577167">0</span><span class="op" id="6577168">;</span>&nbsp;<span class="ident" id="6577170">i</span>&nbsp;<span class="op" id="6577172">&lt;</span>&nbsp;<span class="ident" id="6577174">n</span><span class="op" id="6577175">;</span>&nbsp;<span class="ident" id="6577177">i</span><span class="op" id="6577178">++</span>&nbsp;<span class="op" id="6577181">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577185">r</span><span class="op" id="6577186">[</span><span class="ident" id="6577187">i</span><span class="op" id="6577188">]</span>&nbsp;<span class="op" id="6577190">=</span>&nbsp;<span class="builtintype" id="6577192">byte</span><span class="op" id="6577196">(</span><span class="ident" id="6577197">rand</span><span class="op" id="6577201">.</span><span class="ident" id="6577202">Int31</span><span class="op" id="6577207">(</span><span class="op" id="6577208">)</span><span class="op" id="6577209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577215">return</span>&nbsp;<span class="ident" id="6577222">r</span><br>
<span class="lineno"></span><span class="op" id="6577224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="6577227">func</span>&nbsp;<span class="ident" id="6577232">randomString</span><span class="op" id="6577244">(</span><span class="ident" id="6577245">n</span>&nbsp;<span class="builtintype" id="6577247">int</span><span class="op" id="6577250">,</span>&nbsp;<span class="ident" id="6577252">rand</span>&nbsp;<span class="op" id="6577257">*</span><span class="ident" id="6577258">rand</span><span class="op" id="6577262">.</span><span class="ident" id="6577263">Rand</span><span class="op" id="6577267">)</span>&nbsp;<span class="builtintype" id="6577269">string</span>&nbsp;<span class="op" id="6577276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577279">b</span>&nbsp;<span class="op" id="6577281">:=</span>&nbsp;<span class="ident" id="6577284">randomBytes</span><span class="op" id="6577295">(</span><span class="ident" id="6577296">n</span><span class="op" id="6577297">,</span>&nbsp;<span class="ident" id="6577299">rand</span><span class="op" id="6577303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577306">return</span>&nbsp;<span class="builtintype" id="6577313">string</span><span class="op" id="6577319">(</span><span class="ident" id="6577320">b</span><span class="op" id="6577321">)</span><br>
<span class="lineno"></span><span class="op" id="6577323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6577326">func</span>&nbsp;<span class="op" id="6577331">(</span><span class="op" id="6577332">*</span><span class="ident" id="6577333">clientHelloMsg</span><span class="op" id="6577347">)</span>&nbsp;<span class="ident" id="6577349">Generate</span><span class="op" id="6577357">(</span><span class="ident" id="6577358">rand</span>&nbsp;<span class="op" id="6577363">*</span><span class="ident" id="6577364">rand</span><span class="op" id="6577368">.</span><span class="ident" id="6577369">Rand</span><span class="op" id="6577373">,</span>&nbsp;<span class="ident" id="6577375">size</span>&nbsp;<span class="builtintype" id="6577380">int</span><span class="op" id="6577383">)</span>&nbsp;<span class="ident" id="6577385">reflect</span><span class="op" id="6577392">.</span><span class="ident" id="6577393">Value</span>&nbsp;<span class="op" id="6577399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577402">m</span>&nbsp;<span class="op" id="6577404">:=</span>&nbsp;<span class="op" id="6577407">&amp;</span><span class="ident" id="6577408">clientHelloMsg</span><span class="op" id="6577422">{</span><span class="op" id="6577423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577426">m</span><span class="op" id="6577427">.</span><span class="ident" id="6577428">vers</span>&nbsp;<span class="op" id="6577433">=</span>&nbsp;<span class="builtintype" id="6577435">uint16</span><span class="op" id="6577441">(</span><span class="ident" id="6577442">rand</span><span class="op" id="6577446">.</span><span class="ident" id="6577447">Intn</span><span class="op" id="6577451">(</span><span class="num" id="6577452">65536</span><span class="op" id="6577457">)</span><span class="op" id="6577458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577461">m</span><span class="op" id="6577462">.</span><span class="ident" id="6577463">random</span>&nbsp;<span class="op" id="6577470">=</span>&nbsp;<span class="ident" id="6577472">randomBytes</span><span class="op" id="6577483">(</span><span class="num" id="6577484">32</span><span class="op" id="6577486">,</span>&nbsp;<span class="ident" id="6577488">rand</span><span class="op" id="6577492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577495">m</span><span class="op" id="6577496">.</span><span class="ident" id="6577497">sessionId</span>&nbsp;<span class="op" id="6577507">=</span>&nbsp;<span class="ident" id="6577509">randomBytes</span><span class="op" id="6577520">(</span><span class="ident" id="6577521">rand</span><span class="op" id="6577525">.</span><span class="ident" id="6577526">Intn</span><span class="op" id="6577530">(</span><span class="num" id="6577531">32</span><span class="op" id="6577533">)</span><span class="op" id="6577534">,</span>&nbsp;<span class="ident" id="6577536">rand</span><span class="op" id="6577540">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577543">m</span><span class="op" id="6577544">.</span><span class="ident" id="6577545">cipherSuites</span>&nbsp;<span class="op" id="6577558">=</span>&nbsp;<span class="builtinfunc" id="6577560">make</span><span class="op" id="6577564">(</span><span class="op" id="6577565">[</span><span class="op" id="6577566">]</span><span class="builtintype" id="6577567">uint16</span><span class="op" id="6577573">,</span>&nbsp;<span class="ident" id="6577575">rand</span><span class="op" id="6577579">.</span><span class="ident" id="6577580">Intn</span><span class="op" id="6577584">(</span><span class="num" id="6577585">63</span><span class="op" id="6577587">)</span><span class="op" id="6577588">+</span><span class="num" id="6577589">1</span><span class="op" id="6577590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577593">for</span>&nbsp;<span class="ident" id="6577597">i</span>&nbsp;<span class="op" id="6577599">:=</span>&nbsp;<span class="num" id="6577602">0</span><span class="op" id="6577603">;</span>&nbsp;<span class="ident" id="6577605">i</span>&nbsp;<span class="op" id="6577607">&lt;</span>&nbsp;<span class="builtinfunc" id="6577609">len</span><span class="op" id="6577612">(</span><span class="ident" id="6577613">m</span><span class="op" id="6577614">.</span><span class="ident" id="6577615">cipherSuites</span><span class="op" id="6577627">)</span><span class="op" id="6577628">;</span>&nbsp;<span class="ident" id="6577630">i</span><span class="op" id="6577631">++</span>&nbsp;<span class="op" id="6577634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577638">m</span><span class="op" id="6577639">.</span><span class="ident" id="6577640">cipherSuites</span><span class="op" id="6577652">[</span><span class="ident" id="6577653">i</span><span class="op" id="6577654">]</span>&nbsp;<span class="op" id="6577656">=</span>&nbsp;<span class="builtintype" id="6577658">uint16</span><span class="op" id="6577664">(</span><span class="ident" id="6577665">rand</span><span class="op" id="6577669">.</span><span class="ident" id="6577670">Int31</span><span class="op" id="6577675">(</span><span class="op" id="6577676">)</span><span class="op" id="6577677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577683">m</span><span class="op" id="6577684">.</span><span class="ident" id="6577685">compressionMethods</span>&nbsp;<span class="op" id="6577704">=</span>&nbsp;<span class="ident" id="6577706">randomBytes</span><span class="op" id="6577717">(</span><span class="ident" id="6577718">rand</span><span class="op" id="6577722">.</span><span class="ident" id="6577723">Intn</span><span class="op" id="6577727">(</span><span class="num" id="6577728">63</span><span class="op" id="6577730">)</span><span class="op" id="6577731">+</span><span class="num" id="6577732">1</span><span class="op" id="6577733">,</span>&nbsp;<span class="ident" id="6577735">rand</span><span class="op" id="6577739">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577742">if</span>&nbsp;<span class="ident" id="6577745">rand</span><span class="op" id="6577749">.</span><span class="ident" id="6577750">Intn</span><span class="op" id="6577754">(</span><span class="num" id="6577755">10</span><span class="op" id="6577757">)</span>&nbsp;<span class="op" id="6577759">&gt;</span>&nbsp;<span class="num" id="6577761">5</span>&nbsp;<span class="op" id="6577763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577767">m</span><span class="op" id="6577768">.</span><span class="ident" id="6577769">nextProtoNeg</span>&nbsp;<span class="op" id="6577782">=</span>&nbsp;<span class="builtintype" id="6577784">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6577793">if</span>&nbsp;<span class="ident" id="6577796">rand</span><span class="op" id="6577800">.</span><span class="ident" id="6577801">Intn</span><span class="op" id="6577805">(</span><span class="num" id="6577806">10</span><span class="op" id="6577808">)</span>&nbsp;<span class="op" id="6577810">&gt;</span>&nbsp;<span class="num" id="6577812">5</span>&nbsp;<span class="op" id="6577814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577818">m</span><span class="op" id="6577819">.</span><span class="ident" id="6577820">serverName</span>&nbsp;<span class="op" id="6577831">=</span>&nbsp;<span class="ident" id="6577833">randomString</span><span class="op" id="6577845">(</span><span class="ident" id="6577846">rand</span><span class="op" id="6577850">.</span><span class="ident" id="6577851">Intn</span><span class="op" id="6577855">(</span><span class="num" id="6577856">255</span><span class="op" id="6577859">)</span><span class="op" id="6577860">,</span>&nbsp;<span class="ident" id="6577862">rand</span><span class="op" id="6577866">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6577869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577872">m</span><span class="op" id="6577873">.</span><span class="ident" id="6577874">ocspStapling</span>&nbsp;<span class="op" id="6577887">=</span>&nbsp;<span class="ident" id="6577889">rand</span><span class="op" id="6577893">.</span><span class="ident" id="6577894">Intn</span><span class="op" id="6577898">(</span><span class="num" id="6577899">10</span><span class="op" id="6577901">)</span>&nbsp;<span class="op" id="6577903">&gt;</span>&nbsp;<span class="num" id="6577905">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577908">m</span><span class="op" id="6577909">.</span><span class="ident" id="6577910">supportedPoints</span>&nbsp;<span class="op" id="6577926">=</span>&nbsp;<span class="ident" id="6577928">randomBytes</span><span class="op" id="6577939">(</span><span class="ident" id="6577940">rand</span><span class="op" id="6577944">.</span><span class="ident" id="6577945">Intn</span><span class="op" id="6577949">(</span><span class="num" id="6577950">5</span><span class="op" id="6577951">)</span><span class="op" id="6577952">+</span><span class="num" id="6577953">1</span><span class="op" id="6577954">,</span>&nbsp;<span class="ident" id="6577956">rand</span><span class="op" id="6577960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577963">m</span><span class="op" id="6577964">.</span><span class="ident" id="6577965">supportedCurves</span>&nbsp;<span class="op" id="6577981">=</span>&nbsp;<span class="builtinfunc" id="6577983">make</span><span class="op" id="6577987">(</span><span class="op" id="6577988">[</span><span class="op" id="6577989">]</span><span class="ident" id="6577990">CurveID</span><span class="op" id="6577997">,</span>&nbsp;<span class="ident" id="6577999">rand</span><span class="op" id="6578003">.</span><span class="ident" id="6578004">Intn</span><span class="op" id="6578008">(</span><span class="num" id="6578009">5</span><span class="op" id="6578010">)</span><span class="op" id="6578011">+</span><span class="num" id="6578012">1</span><span class="op" id="6578013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6578016">for</span>&nbsp;<span class="ident" id="6578020">i</span>&nbsp;<span class="op" id="6578022">:=</span>&nbsp;<span class="keyword" id="6578025">range</span>&nbsp;<span class="ident" id="6578031">m</span><span class="op" id="6578032">.</span><span class="ident" id="6578033">supportedCurves</span>&nbsp;<span class="op" id="6578049">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578053">m</span><span class="op" id="6578054">.</span><span class="ident" id="6578055">supportedCurves</span><span class="op" id="6578070">[</span><span class="ident" id="6578071">i</span><span class="op" id="6578072">]</span>&nbsp;<span class="op" id="6578074">=</span>&nbsp;<span class="ident" id="6578076">CurveID</span><span class="op" id="6578083">(</span><span class="ident" id="6578084">rand</span><span class="op" id="6578088">.</span><span class="ident" id="6578089">Intn</span><span class="op" id="6578093">(</span><span class="num" id="6578094">30000</span><span class="op" id="6578099">)</span><span class="op" id="6578100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6578103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6578106">if</span>&nbsp;<span class="ident" id="6578109">rand</span><span class="op" id="6578113">.</span><span class="ident" id="6578114">Intn</span><span class="op" id="6578118">(</span><span class="num" id="6578119">10</span><span class="op" id="6578121">)</span>&nbsp;<span class="op" id="6578123">&gt;</span>&nbsp;<span class="num" id="6578125">5</span>&nbsp;<span class="op" id="6578127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578131">m</span><span class="op" id="6578132">.</span><span class="ident" id="6578133">ticketSupported</span>&nbsp;<span class="op" id="6578149">=</span>&nbsp;<span class="builtintype" id="6578151">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6578158">if</span>&nbsp;<span class="ident" id="6578161">rand</span><span class="op" id="6578165">.</span><span class="ident" id="6578166">Intn</span><span class="op" id="6578170">(</span><span class="num" id="6578171">10</span><span class="op" id="6578173">)</span>&nbsp;<span class="op" id="6578175">&gt;</span>&nbsp;<span class="num" id="6578177">5</span>&nbsp;<span class="op" id="6578179">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578184">m</span><span class="op" id="6578185">.</span><span class="ident" id="6578186">sessionTicket</span>&nbsp;<span class="op" id="6578200">=</span>&nbsp;<span class="ident" id="6578202">randomBytes</span><span class="op" id="6578213">(</span><span class="ident" id="6578214">rand</span><span class="op" id="6578218">.</span><span class="ident" id="6578219">Intn</span><span class="op" id="6578223">(</span><span class="num" id="6578224">300</span><span class="op" id="6578227">)</span><span class="op" id="6578228">,</span>&nbsp;<span class="ident" id="6578230">rand</span><span class="op" id="6578234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6578238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6578241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6578244">if</span>&nbsp;<span class="ident" id="6578247">rand</span><span class="op" id="6578251">.</span><span class="ident" id="6578252">Intn</span><span class="op" id="6578256">(</span><span class="num" id="6578257">10</span><span class="op" id="6578259">)</span>&nbsp;<span class="op" id="6578261">&gt;</span>&nbsp;<span class="num" id="6578263">5</span>&nbsp;<span class="op" id="6578265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578269">m</span><span class="op" id="6578270">.</span><span class="ident" id="6578271">signatureAndHashes</span>&nbsp;<span class="op" id="6578290">=</span>&nbsp;<span class="ident" id="6578292">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6578325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578328">m</span><span class="op" id="6578329">.</span><span class="ident" id="6578330">alpnProtocols</span>&nbsp;<span class="op" id="6578344">=</span>&nbsp;<span class="builtinfunc" id="6578346">make</span><span class="op" id="6578350">(</span><span class="op" id="6578351">[</span><span class="op" id="6578352">]</span><span class="builtintype" id="6578353">string</span><span class="op" id="6578359">,</span>&nbsp;<span class="ident" id="6578361">rand</span><span class="op" id="6578365">.</span><span class="ident" id="6578366">Intn</span><span class="op" id="6578370">(</span><span class="num" id="6578371">5</span><span class="op" id="6578372">)</span><span class="op" id="6578373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6578376">for</span>&nbsp;<span class="ident" id="6578380">i</span>&nbsp;<span class="op" id="6578382">:=</span>&nbsp;<span class="keyword" id="6578385">range</span>&nbsp;<span class="ident" id="6578391">m</span><span class="op" id="6578392">.</span><span class="ident" id="6578393">alpnProtocols</span>&nbsp;<span class="op" id="6578407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578411">m</span><span class="op" id="6578412">.</span><span class="ident" id="6578413">alpnProtocols</span><span class="op" id="6578426">[</span><span class="ident" id="6578427">i</span><span class="op" id="6578428">]</span>&nbsp;<span class="op" id="6578430">=</span>&nbsp;<span class="ident" id="6578432">randomString</span><span class="op" id="6578444">(</span><span class="ident" id="6578445">rand</span><span class="op" id="6578449">.</span><span class="ident" id="6578450">Intn</span><span class="op" id="6578454">(</span><span class="num" id="6578455">20</span><span class="op" id="6578457">)</span><span class="op" id="6578458">+</span><span class="num" id="6578459">1</span><span class="op" id="6578460">,</span>&nbsp;<span class="ident" id="6578462">rand</span><span class="op" id="6578466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6578469">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6578473">return</span>&nbsp;<span class="ident" id="6578480">reflect</span><span class="op" id="6578487">.</span><span class="ident" id="6578488">ValueOf</span><span class="op" id="6578495">(</span><span class="ident" id="6578496">m</span><span class="op" id="6578497">)</span><br>
<span class="lineno"></span><span class="op" id="6578499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6578502">func</span>&nbsp;<span class="op" id="6578507">(</span><span class="op" id="6578508">*</span><span class="ident" id="6578509">serverHelloMsg</span><span class="op" id="6578523">)</span>&nbsp;<span class="ident" id="6578525">Generate</span><span class="op" id="6578533">(</span><span class="ident" id="6578534">rand</span>&nbsp;<span class="op" id="6578539">*</span><span class="ident" id="6578540">rand</span><span class="op" id="6578544">.</span><span class="ident" id="6578545">Rand</span><span class="op" id="6578549">,</span>&nbsp;<span class="ident" id="6578551">size</span>&nbsp;<span class="builtintype" id="6578556">int</span><span class="op" id="6578559">)</span>&nbsp;<span class="ident" id="6578561">reflect</span><span class="op" id="6578568">.</span><span class="ident" id="6578569">Value</span>&nbsp;<span class="op" id="6578575">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578578">m</span>&nbsp;<span class="op" id="6578580">:=</span>&nbsp;<span class="op" id="6578583">&amp;</span><span class="ident" id="6578584">serverHelloMsg</span><span class="op" id="6578598">{</span><span class="op" id="6578599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578602">m</span><span class="op" id="6578603">.</span><span class="ident" id="6578604">vers</span>&nbsp;<span class="op" id="6578609">=</span>&nbsp;<span class="builtintype" id="6578611">uint16</span><span class="op" id="6578617">(</span><span class="ident" id="6578618">rand</span><span class="op" id="6578622">.</span><span class="ident" id="6578623">Intn</span><span class="op" id="6578627">(</span><span class="num" id="6578628">65536</span><span class="op" id="6578633">)</span><span class="op" id="6578634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578637">m</span><span class="op" id="6578638">.</span><span class="ident" id="6578639">random</span>&nbsp;<span class="op" id="6578646">=</span>&nbsp;<span class="ident" id="6578648">randomBytes</span><span class="op" id="6578659">(</span><span class="num" id="6578660">32</span><span class="op" id="6578662">,</span>&nbsp;<span class="ident" id="6578664">rand</span><span class="op" id="6578668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578671">m</span><span class="op" id="6578672">.</span><span class="ident" id="6578673">sessionId</span>&nbsp;<span class="op" id="6578683">=</span>&nbsp;<span class="ident" id="6578685">randomBytes</span><span class="op" id="6578696">(</span><span class="ident" id="6578697">rand</span><span class="op" id="6578701">.</span><span class="ident" id="6578702">Intn</span><span class="op" id="6578706">(</span><span class="num" id="6578707">32</span><span class="op" id="6578709">)</span><span class="op" id="6578710">,</span>&nbsp;<span class="ident" id="6578712">rand</span><span class="op" id="6578716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578719">m</span><span class="op" id="6578720">.</span><span class="ident" id="6578721">cipherSuite</span>&nbsp;<span class="op" id="6578733">=</span>&nbsp;<span class="builtintype" id="6578735">uint16</span><span class="op" id="6578741">(</span><span class="ident" id="6578742">rand</span><span class="op" id="6578746">.</span><span class="ident" id="6578747">Int31</span><span class="op" id="6578752">(</span><span class="op" id="6578753">)</span><span class="op" id="6578754">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578757">m</span><span class="op" id="6578758">.</span><span class="ident" id="6578759">compressionMethod</span>&nbsp;<span class="op" id="6578777">=</span>&nbsp;<span class="builtintype" id="6578779">uint8</span><span class="op" id="6578784">(</span><span class="ident" id="6578785">rand</span><span class="op" id="6578789">.</span><span class="ident" id="6578790">Intn</span><span class="op" id="6578794">(</span><span class="num" id="6578795">256</span><span class="op" id="6578798">)</span><span class="op" id="6578799">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6578803">if</span>&nbsp;<span class="ident" id="6578806">rand</span><span class="op" id="6578810">.</span><span class="ident" id="6578811">Intn</span><span class="op" id="6578815">(</span><span class="num" id="6578816">10</span><span class="op" id="6578818">)</span>&nbsp;<span class="op" id="6578820">&gt;</span>&nbsp;<span class="num" id="6578822">5</span>&nbsp;<span class="op" id="6578824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578828">m</span><span class="op" id="6578829">.</span><span class="ident" id="6578830">nextProtoNeg</span>&nbsp;<span class="op" id="6578843">=</span>&nbsp;<span class="builtintype" id="6578845">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578853">n</span>&nbsp;<span class="op" id="6578855">:=</span>&nbsp;<span class="ident" id="6578858">rand</span><span class="op" id="6578862">.</span><span class="ident" id="6578863">Intn</span><span class="op" id="6578867">(</span><span class="num" id="6578868">10</span><span class="op" id="6578870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578874">m</span><span class="op" id="6578875">.</span><span class="ident" id="6578876">nextProtos</span>&nbsp;<span class="op" id="6578887">=</span>&nbsp;<span class="builtinfunc" id="6578889">make</span><span class="op" id="6578893">(</span><span class="op" id="6578894">[</span><span class="op" id="6578895">]</span><span class="builtintype" id="6578896">string</span><span class="op" id="6578902">,</span>&nbsp;<span class="ident" id="6578904">n</span><span class="op" id="6578905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6578909">for</span>&nbsp;<span class="ident" id="6578913">i</span>&nbsp;<span class="op" id="6578915">:=</span>&nbsp;<span class="num" id="6578918">0</span><span class="op" id="6578919">;</span>&nbsp;<span class="ident" id="6578921">i</span>&nbsp;<span class="op" id="6578923">&lt;</span>&nbsp;<span class="ident" id="6578925">n</span><span class="op" id="6578926">;</span>&nbsp;<span class="ident" id="6578928">i</span><span class="op" id="6578929">++</span>&nbsp;<span class="op" id="6578932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578937">m</span><span class="op" id="6578938">.</span><span class="ident" id="6578939">nextProtos</span><span class="op" id="6578949">[</span><span class="ident" id="6578950">i</span><span class="op" id="6578951">]</span>&nbsp;<span class="op" id="6578953">=</span>&nbsp;<span class="ident" id="6578955">randomString</span><span class="op" id="6578967">(</span><span class="num" id="6578968">20</span><span class="op" id="6578970">,</span>&nbsp;<span class="ident" id="6578972">rand</span><span class="op" id="6578976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6578980">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6578983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6578987">if</span>&nbsp;<span class="ident" id="6578990">rand</span><span class="op" id="6578994">.</span><span class="ident" id="6578995">Intn</span><span class="op" id="6578999">(</span><span class="num" id="6579000">10</span><span class="op" id="6579002">)</span>&nbsp;<span class="op" id="6579004">&gt;</span>&nbsp;<span class="num" id="6579006">5</span>&nbsp;<span class="op" id="6579008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579012">m</span><span class="op" id="6579013">.</span><span class="ident" id="6579014">ocspStapling</span>&nbsp;<span class="op" id="6579027">=</span>&nbsp;<span class="builtintype" id="6579029">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6579035">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6579038">if</span>&nbsp;<span class="ident" id="6579041">rand</span><span class="op" id="6579045">.</span><span class="ident" id="6579046">Intn</span><span class="op" id="6579050">(</span><span class="num" id="6579051">10</span><span class="op" id="6579053">)</span>&nbsp;<span class="op" id="6579055">&gt;</span>&nbsp;<span class="num" id="6579057">5</span>&nbsp;<span class="op" id="6579059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579063">m</span><span class="op" id="6579064">.</span><span class="ident" id="6579065">ticketSupported</span>&nbsp;<span class="op" id="6579081">=</span>&nbsp;<span class="builtintype" id="6579083">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6579089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579092">m</span><span class="op" id="6579093">.</span><span class="ident" id="6579094">alpnProtocol</span>&nbsp;<span class="op" id="6579107">=</span>&nbsp;<span class="ident" id="6579109">randomString</span><span class="op" id="6579121">(</span><span class="ident" id="6579122">rand</span><span class="op" id="6579126">.</span><span class="ident" id="6579127">Intn</span><span class="op" id="6579131">(</span><span class="num" id="6579132">32</span><span class="op" id="6579134">)</span><span class="op" id="6579135">+</span><span class="num" id="6579136">1</span><span class="op" id="6579137">,</span>&nbsp;<span class="ident" id="6579139">rand</span><span class="op" id="6579143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6579147">return</span>&nbsp;<span class="ident" id="6579154">reflect</span><span class="op" id="6579161">.</span><span class="ident" id="6579162">ValueOf</span><span class="op" id="6579169">(</span><span class="ident" id="6579170">m</span><span class="op" id="6579171">)</span><br>
<span class="lineno"></span><span class="op" id="6579173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6579176">func</span>&nbsp;<span class="op" id="6579181">(</span><span class="op" id="6579182">*</span><span class="ident" id="6579183">certificateMsg</span><span class="op" id="6579197">)</span>&nbsp;<span class="ident" id="6579199">Generate</span><span class="op" id="6579207">(</span><span class="ident" id="6579208">rand</span>&nbsp;<span class="op" id="6579213">*</span><span class="ident" id="6579214">rand</span><span class="op" id="6579218">.</span><span class="ident" id="6579219">Rand</span><span class="op" id="6579223">,</span>&nbsp;<span class="ident" id="6579225">size</span>&nbsp;<span class="builtintype" id="6579230">int</span><span class="op" id="6579233">)</span>&nbsp;<span class="ident" id="6579235">reflect</span><span class="op" id="6579242">.</span><span class="ident" id="6579243">Value</span>&nbsp;<span class="op" id="6579249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579252">m</span>&nbsp;<span class="op" id="6579254">:=</span>&nbsp;<span class="op" id="6579257">&amp;</span><span class="ident" id="6579258">certificateMsg</span><span class="op" id="6579272">{</span><span class="op" id="6579273">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579276">numCerts</span>&nbsp;<span class="op" id="6579285">:=</span>&nbsp;<span class="ident" id="6579288">rand</span><span class="op" id="6579292">.</span><span class="ident" id="6579293">Intn</span><span class="op" id="6579297">(</span><span class="num" id="6579298">20</span><span class="op" id="6579300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579303">m</span><span class="op" id="6579304">.</span><span class="ident" id="6579305">certificates</span>&nbsp;<span class="op" id="6579318">=</span>&nbsp;<span class="builtinfunc" id="6579320">make</span><span class="op" id="6579324">(</span><span class="op" id="6579325">[</span><span class="op" id="6579326">]</span><span class="op" id="6579327">[</span><span class="op" id="6579328">]</span><span class="builtintype" id="6579329">byte</span><span class="op" id="6579333">,</span>&nbsp;<span class="ident" id="6579335">numCerts</span><span class="op" id="6579343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6579346">for</span>&nbsp;<span class="ident" id="6579350">i</span>&nbsp;<span class="op" id="6579352">:=</span>&nbsp;<span class="num" id="6579355">0</span><span class="op" id="6579356">;</span>&nbsp;<span class="ident" id="6579358">i</span>&nbsp;<span class="op" id="6579360">&lt;</span>&nbsp;<span class="ident" id="6579362">numCerts</span><span class="op" id="6579370">;</span>&nbsp;<span class="ident" id="6579372">i</span><span class="op" id="6579373">++</span>&nbsp;<span class="op" id="6579376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579380">m</span><span class="op" id="6579381">.</span><span class="ident" id="6579382">certificates</span><span class="op" id="6579394">[</span><span class="ident" id="6579395">i</span><span class="op" id="6579396">]</span>&nbsp;<span class="op" id="6579398">=</span>&nbsp;<span class="ident" id="6579400">randomBytes</span><span class="op" id="6579411">(</span><span class="ident" id="6579412">rand</span><span class="op" id="6579416">.</span><span class="ident" id="6579417">Intn</span><span class="op" id="6579421">(</span><span class="num" id="6579422">10</span><span class="op" id="6579424">)</span><span class="op" id="6579425">+</span><span class="num" id="6579426">1</span><span class="op" id="6579427">,</span>&nbsp;<span class="ident" id="6579429">rand</span><span class="op" id="6579433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6579436">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6579439">return</span>&nbsp;<span class="ident" id="6579446">reflect</span><span class="op" id="6579453">.</span><span class="ident" id="6579454">ValueOf</span><span class="op" id="6579461">(</span><span class="ident" id="6579462">m</span><span class="op" id="6579463">)</span><br>
<span class="lineno"></span><span class="op" id="6579465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6579468">func</span>&nbsp;<span class="op" id="6579473">(</span><span class="op" id="6579474">*</span><span class="ident" id="6579475">certificateRequestMsg</span><span class="op" id="6579496">)</span>&nbsp;<span class="ident" id="6579498">Generate</span><span class="op" id="6579506">(</span><span class="ident" id="6579507">rand</span>&nbsp;<span class="op" id="6579512">*</span><span class="ident" id="6579513">rand</span><span class="op" id="6579517">.</span><span class="ident" id="6579518">Rand</span><span class="op" id="6579522">,</span>&nbsp;<span class="ident" id="6579524">size</span>&nbsp;<span class="builtintype" id="6579529">int</span><span class="op" id="6579532">)</span>&nbsp;<span class="ident" id="6579534">reflect</span><span class="op" id="6579541">.</span><span class="ident" id="6579542">Value</span>&nbsp;<span class="op" id="6579548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579551">m</span>&nbsp;<span class="op" id="6579553">:=</span>&nbsp;<span class="op" id="6579556">&amp;</span><span class="ident" id="6579557">certificateRequestMsg</span><span class="op" id="6579578">{</span><span class="op" id="6579579">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579582">m</span><span class="op" id="6579583">.</span><span class="ident" id="6579584">certificateTypes</span>&nbsp;<span class="op" id="6579601">=</span>&nbsp;<span class="ident" id="6579603">randomBytes</span><span class="op" id="6579614">(</span><span class="ident" id="6579615">rand</span><span class="op" id="6579619">.</span><span class="ident" id="6579620">Intn</span><span class="op" id="6579624">(</span><span class="num" id="6579625">5</span><span class="op" id="6579626">)</span><span class="op" id="6579627">+</span><span class="num" id="6579628">1</span><span class="op" id="6579629">,</span>&nbsp;<span class="ident" id="6579631">rand</span><span class="op" id="6579635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579638">numCAs</span>&nbsp;<span class="op" id="6579645">:=</span>&nbsp;<span class="ident" id="6579648">rand</span><span class="op" id="6579652">.</span><span class="ident" id="6579653">Intn</span><span class="op" id="6579657">(</span><span class="num" id="6579658">100</span><span class="op" id="6579661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579664">m</span><span class="op" id="6579665">.</span><span class="ident" id="6579666">certificateAuthorities</span>&nbsp;<span class="op" id="6579689">=</span>&nbsp;<span class="builtinfunc" id="6579691">make</span><span class="op" id="6579695">(</span><span class="op" id="6579696">[</span><span class="op" id="6579697">]</span><span class="op" id="6579698">[</span><span class="op" id="6579699">]</span><span class="builtintype" id="6579700">byte</span><span class="op" id="6579704">,</span>&nbsp;<span class="ident" id="6579706">numCAs</span><span class="op" id="6579712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6579715">for</span>&nbsp;<span class="ident" id="6579719">i</span>&nbsp;<span class="op" id="6579721">:=</span>&nbsp;<span class="num" id="6579724">0</span><span class="op" id="6579725">;</span>&nbsp;<span class="ident" id="6579727">i</span>&nbsp;<span class="op" id="6579729">&lt;</span>&nbsp;<span class="ident" id="6579731">numCAs</span><span class="op" id="6579737">;</span>&nbsp;<span class="ident" id="6579739">i</span><span class="op" id="6579740">++</span>&nbsp;<span class="op" id="6579743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579747">m</span><span class="op" id="6579748">.</span><span class="ident" id="6579749">certificateAuthorities</span><span class="op" id="6579771">[</span><span class="ident" id="6579772">i</span><span class="op" id="6579773">]</span>&nbsp;<span class="op" id="6579775">=</span>&nbsp;<span class="ident" id="6579777">randomBytes</span><span class="op" id="6579788">(</span><span class="ident" id="6579789">rand</span><span class="op" id="6579793">.</span><span class="ident" id="6579794">Intn</span><span class="op" id="6579798">(</span><span class="num" id="6579799">15</span><span class="op" id="6579801">)</span><span class="op" id="6579802">+</span><span class="num" id="6579803">1</span><span class="op" id="6579804">,</span>&nbsp;<span class="ident" id="6579806">rand</span><span class="op" id="6579810">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6579813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6579816">return</span>&nbsp;<span class="ident" id="6579823">reflect</span><span class="op" id="6579830">.</span><span class="ident" id="6579831">ValueOf</span><span class="op" id="6579838">(</span><span class="ident" id="6579839">m</span><span class="op" id="6579840">)</span><br>
<span class="lineno"></span><span class="op" id="6579842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6579845">func</span>&nbsp;<span class="op" id="6579850">(</span><span class="op" id="6579851">*</span><span class="ident" id="6579852">certificateVerifyMsg</span><span class="op" id="6579872">)</span>&nbsp;<span class="ident" id="6579874">Generate</span><span class="op" id="6579882">(</span><span class="ident" id="6579883">rand</span>&nbsp;<span class="op" id="6579888">*</span><span class="ident" id="6579889">rand</span><span class="op" id="6579893">.</span><span class="ident" id="6579894">Rand</span><span class="op" id="6579898">,</span>&nbsp;<span class="ident" id="6579900">size</span>&nbsp;<span class="builtintype" id="6579905">int</span><span class="op" id="6579908">)</span>&nbsp;<span class="ident" id="6579910">reflect</span><span class="op" id="6579917">.</span><span class="ident" id="6579918">Value</span>&nbsp;<span class="op" id="6579924">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579927">m</span>&nbsp;<span class="op" id="6579929">:=</span>&nbsp;<span class="op" id="6579932">&amp;</span><span class="ident" id="6579933">certificateVerifyMsg</span><span class="op" id="6579953">{</span><span class="op" id="6579954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579957">m</span><span class="op" id="6579958">.</span><span class="ident" id="6579959">signature</span>&nbsp;<span class="op" id="6579969">=</span>&nbsp;<span class="ident" id="6579971">randomBytes</span><span class="op" id="6579982">(</span><span class="ident" id="6579983">rand</span><span class="op" id="6579987">.</span><span class="ident" id="6579988">Intn</span><span class="op" id="6579992">(</span><span class="num" id="6579993">15</span><span class="op" id="6579995">)</span><span class="op" id="6579996">+</span><span class="num" id="6579997">1</span><span class="op" id="6579998">,</span>&nbsp;<span class="ident" id="6580000">rand</span><span class="op" id="6580004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6580007">return</span>&nbsp;<span class="ident" id="6580014">reflect</span><span class="op" id="6580021">.</span><span class="ident" id="6580022">ValueOf</span><span class="op" id="6580029">(</span><span class="ident" id="6580030">m</span><span class="op" id="6580031">)</span><br>
<span class="lineno"></span><span class="op" id="6580033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="6580036">func</span>&nbsp;<span class="op" id="6580041">(</span><span class="op" id="6580042">*</span><span class="ident" id="6580043">certificateStatusMsg</span><span class="op" id="6580063">)</span>&nbsp;<span class="ident" id="6580065">Generate</span><span class="op" id="6580073">(</span><span class="ident" id="6580074">rand</span>&nbsp;<span class="op" id="6580079">*</span><span class="ident" id="6580080">rand</span><span class="op" id="6580084">.</span><span class="ident" id="6580085">Rand</span><span class="op" id="6580089">,</span>&nbsp;<span class="ident" id="6580091">size</span>&nbsp;<span class="builtintype" id="6580096">int</span><span class="op" id="6580099">)</span>&nbsp;<span class="ident" id="6580101">reflect</span><span class="op" id="6580108">.</span><span class="ident" id="6580109">Value</span>&nbsp;<span class="op" id="6580115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580118">m</span>&nbsp;<span class="op" id="6580120">:=</span>&nbsp;<span class="op" id="6580123">&amp;</span><span class="ident" id="6580124">certificateStatusMsg</span><span class="op" id="6580144">{</span><span class="op" id="6580145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6580148">if</span>&nbsp;<span class="ident" id="6580151">rand</span><span class="op" id="6580155">.</span><span class="ident" id="6580156">Intn</span><span class="op" id="6580160">(</span><span class="num" id="6580161">10</span><span class="op" id="6580163">)</span>&nbsp;<span class="op" id="6580165">&gt;</span>&nbsp;<span class="num" id="6580167">5</span>&nbsp;<span class="op" id="6580169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580173">m</span><span class="op" id="6580174">.</span><span class="ident" id="6580175">statusType</span>&nbsp;<span class="op" id="6580186">=</span>&nbsp;<span class="ident" id="6580188">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580205">m</span><span class="op" id="6580206">.</span><span class="ident" id="6580207">response</span>&nbsp;<span class="op" id="6580216">=</span>&nbsp;<span class="ident" id="6580218">randomBytes</span><span class="op" id="6580229">(</span><span class="ident" id="6580230">rand</span><span class="op" id="6580234">.</span><span class="ident" id="6580235">Intn</span><span class="op" id="6580239">(</span><span class="num" id="6580240">10</span><span class="op" id="6580242">)</span><span class="op" id="6580243">+</span><span class="num" id="6580244">1</span><span class="op" id="6580245">,</span>&nbsp;<span class="ident" id="6580247">rand</span><span class="op" id="6580251">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6580254">}</span>&nbsp;<span class="keyword" id="6580256">else</span>&nbsp;<span class="op" id="6580261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580265">m</span><span class="op" id="6580266">.</span><span class="ident" id="6580267">statusType</span>&nbsp;<span class="op" id="6580278">=</span>&nbsp;<span class="num" id="6580280">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6580284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6580287">return</span>&nbsp;<span class="ident" id="6580294">reflect</span><span class="op" id="6580301">.</span><span class="ident" id="6580302">ValueOf</span><span class="op" id="6580309">(</span><span class="ident" id="6580310">m</span><span class="op" id="6580311">)</span><br>
<span class="lineno"></span><span class="op" id="6580313">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="6580316">func</span>&nbsp;<span class="op" id="6580321">(</span><span class="op" id="6580322">*</span><span class="ident" id="6580323">clientKeyExchangeMsg</span><span class="op" id="6580343">)</span>&nbsp;<span class="ident" id="6580345">Generate</span><span class="op" id="6580353">(</span><span class="ident" id="6580354">rand</span>&nbsp;<span class="op" id="6580359">*</span><span class="ident" id="6580360">rand</span><span class="op" id="6580364">.</span><span class="ident" id="6580365">Rand</span><span class="op" id="6580369">,</span>&nbsp;<span class="ident" id="6580371">size</span>&nbsp;<span class="builtintype" id="6580376">int</span><span class="op" id="6580379">)</span>&nbsp;<span class="ident" id="6580381">reflect</span><span class="op" id="6580388">.</span><span class="ident" id="6580389">Value</span>&nbsp;<span class="op" id="6580395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580398">m</span>&nbsp;<span class="op" id="6580400">:=</span>&nbsp;<span class="op" id="6580403">&amp;</span><span class="ident" id="6580404">clientKeyExchangeMsg</span><span class="op" id="6580424">{</span><span class="op" id="6580425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580428">m</span><span class="op" id="6580429">.</span><span class="ident" id="6580430">ciphertext</span>&nbsp;<span class="op" id="6580441">=</span>&nbsp;<span class="ident" id="6580443">randomBytes</span><span class="op" id="6580454">(</span><span class="ident" id="6580455">rand</span><span class="op" id="6580459">.</span><span class="ident" id="6580460">Intn</span><span class="op" id="6580464">(</span><span class="num" id="6580465">1000</span><span class="op" id="6580469">)</span><span class="op" id="6580470">+</span><span class="num" id="6580471">1</span><span class="op" id="6580472">,</span>&nbsp;<span class="ident" id="6580474">rand</span><span class="op" id="6580478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6580481">return</span>&nbsp;<span class="ident" id="6580488">reflect</span><span class="op" id="6580495">.</span><span class="ident" id="6580496">ValueOf</span><span class="op" id="6580503">(</span><span class="ident" id="6580504">m</span><span class="op" id="6580505">)</span><br>
<span class="lineno">220</span><span class="op" id="6580507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6580510">func</span>&nbsp;<span class="op" id="6580515">(</span><span class="op" id="6580516">*</span><span class="ident" id="6580517">finishedMsg</span><span class="op" id="6580528">)</span>&nbsp;<span class="ident" id="6580530">Generate</span><span class="op" id="6580538">(</span><span class="ident" id="6580539">rand</span>&nbsp;<span class="op" id="6580544">*</span><span class="ident" id="6580545">rand</span><span class="op" id="6580549">.</span><span class="ident" id="6580550">Rand</span><span class="op" id="6580554">,</span>&nbsp;<span class="ident" id="6580556">size</span>&nbsp;<span class="builtintype" id="6580561">int</span><span class="op" id="6580564">)</span>&nbsp;<span class="ident" id="6580566">reflect</span><span class="op" id="6580573">.</span><span class="ident" id="6580574">Value</span>&nbsp;<span class="op" id="6580580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580583">m</span>&nbsp;<span class="op" id="6580585">:=</span>&nbsp;<span class="op" id="6580588">&amp;</span><span class="ident" id="6580589">finishedMsg</span><span class="op" id="6580600">{</span><span class="op" id="6580601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580604">m</span><span class="op" id="6580605">.</span><span class="ident" id="6580606">verifyData</span>&nbsp;<span class="op" id="6580617">=</span>&nbsp;<span class="ident" id="6580619">randomBytes</span><span class="op" id="6580630">(</span><span class="num" id="6580631">12</span><span class="op" id="6580633">,</span>&nbsp;<span class="ident" id="6580635">rand</span><span class="op" id="6580639">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6580642">return</span>&nbsp;<span class="ident" id="6580649">reflect</span><span class="op" id="6580656">.</span><span class="ident" id="6580657">ValueOf</span><span class="op" id="6580664">(</span><span class="ident" id="6580665">m</span><span class="op" id="6580666">)</span><br>
<span class="lineno"></span><span class="op" id="6580668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6580671">func</span>&nbsp;<span class="op" id="6580676">(</span><span class="op" id="6580677">*</span><span class="ident" id="6580678">nextProtoMsg</span><span class="op" id="6580690">)</span>&nbsp;<span class="ident" id="6580692">Generate</span><span class="op" id="6580700">(</span><span class="ident" id="6580701">rand</span>&nbsp;<span class="op" id="6580706">*</span><span class="ident" id="6580707">rand</span><span class="op" id="6580711">.</span><span class="ident" id="6580712">Rand</span><span class="op" id="6580716">,</span>&nbsp;<span class="ident" id="6580718">size</span>&nbsp;<span class="builtintype" id="6580723">int</span><span class="op" id="6580726">)</span>&nbsp;<span class="ident" id="6580728">reflect</span><span class="op" id="6580735">.</span><span class="ident" id="6580736">Value</span>&nbsp;<span class="op" id="6580742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580745">m</span>&nbsp;<span class="op" id="6580747">:=</span>&nbsp;<span class="op" id="6580750">&amp;</span><span class="ident" id="6580751">nextProtoMsg</span><span class="op" id="6580763">{</span><span class="op" id="6580764">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580767">m</span><span class="op" id="6580768">.</span><span class="ident" id="6580769">proto</span>&nbsp;<span class="op" id="6580775">=</span>&nbsp;<span class="ident" id="6580777">randomString</span><span class="op" id="6580789">(</span><span class="ident" id="6580790">rand</span><span class="op" id="6580794">.</span><span class="ident" id="6580795">Intn</span><span class="op" id="6580799">(</span><span class="num" id="6580800">255</span><span class="op" id="6580803">)</span><span class="op" id="6580804">,</span>&nbsp;<span class="ident" id="6580806">rand</span><span class="op" id="6580810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6580813">return</span>&nbsp;<span class="ident" id="6580820">reflect</span><span class="op" id="6580827">.</span><span class="ident" id="6580828">ValueOf</span><span class="op" id="6580835">(</span><span class="ident" id="6580836">m</span><span class="op" id="6580837">)</span><br>
<span class="lineno"></span><span class="op" id="6580839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6580842">func</span>&nbsp;<span class="op" id="6580847">(</span><span class="op" id="6580848">*</span><span class="ident" id="6580849">newSessionTicketMsg</span><span class="op" id="6580868">)</span>&nbsp;<span class="ident" id="6580870">Generate</span><span class="op" id="6580878">(</span><span class="ident" id="6580879">rand</span>&nbsp;<span class="op" id="6580884">*</span><span class="ident" id="6580885">rand</span><span class="op" id="6580889">.</span><span class="ident" id="6580890">Rand</span><span class="op" id="6580894">,</span>&nbsp;<span class="ident" id="6580896">size</span>&nbsp;<span class="builtintype" id="6580901">int</span><span class="op" id="6580904">)</span>&nbsp;<span class="ident" id="6580906">reflect</span><span class="op" id="6580913">.</span><span class="ident" id="6580914">Value</span>&nbsp;<span class="op" id="6580920">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580923">m</span>&nbsp;<span class="op" id="6580925">:=</span>&nbsp;<span class="op" id="6580928">&amp;</span><span class="ident" id="6580929">newSessionTicketMsg</span><span class="op" id="6580948">{</span><span class="op" id="6580949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580952">m</span><span class="op" id="6580953">.</span><span class="ident" id="6580954">ticket</span>&nbsp;<span class="op" id="6580961">=</span>&nbsp;<span class="ident" id="6580963">randomBytes</span><span class="op" id="6580974">(</span><span class="ident" id="6580975">rand</span><span class="op" id="6580979">.</span><span class="ident" id="6580980">Intn</span><span class="op" id="6580984">(</span><span class="num" id="6580985">4</span><span class="op" id="6580986">)</span><span class="op" id="6580987">,</span>&nbsp;<span class="ident" id="6580989">rand</span><span class="op" id="6580993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6580996">return</span>&nbsp;<span class="ident" id="6581003">reflect</span><span class="op" id="6581010">.</span><span class="ident" id="6581011">ValueOf</span><span class="op" id="6581018">(</span><span class="ident" id="6581019">m</span><span class="op" id="6581020">)</span><br>
<span class="lineno"></span><span class="op" id="6581022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="6581025">func</span>&nbsp;<span class="op" id="6581030">(</span><span class="op" id="6581031">*</span><span class="ident" id="6581032">sessionState</span><span class="op" id="6581044">)</span>&nbsp;<span class="ident" id="6581046">Generate</span><span class="op" id="6581054">(</span><span class="ident" id="6581055">rand</span>&nbsp;<span class="op" id="6581060">*</span><span class="ident" id="6581061">rand</span><span class="op" id="6581065">.</span><span class="ident" id="6581066">Rand</span><span class="op" id="6581070">,</span>&nbsp;<span class="ident" id="6581072">size</span>&nbsp;<span class="builtintype" id="6581077">int</span><span class="op" id="6581080">)</span>&nbsp;<span class="ident" id="6581082">reflect</span><span class="op" id="6581089">.</span><span class="ident" id="6581090">Value</span>&nbsp;<span class="op" id="6581096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581099">s</span>&nbsp;<span class="op" id="6581101">:=</span>&nbsp;<span class="op" id="6581104">&amp;</span><span class="ident" id="6581105">sessionState</span><span class="op" id="6581117">{</span><span class="op" id="6581118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581121">s</span><span class="op" id="6581122">.</span><span class="ident" id="6581123">vers</span>&nbsp;<span class="op" id="6581128">=</span>&nbsp;<span class="builtintype" id="6581130">uint16</span><span class="op" id="6581136">(</span><span class="ident" id="6581137">rand</span><span class="op" id="6581141">.</span><span class="ident" id="6581142">Intn</span><span class="op" id="6581146">(</span><span class="num" id="6581147">10000</span><span class="op" id="6581152">)</span><span class="op" id="6581153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581156">s</span><span class="op" id="6581157">.</span><span class="ident" id="6581158">cipherSuite</span>&nbsp;<span class="op" id="6581170">=</span>&nbsp;<span class="builtintype" id="6581172">uint16</span><span class="op" id="6581178">(</span><span class="ident" id="6581179">rand</span><span class="op" id="6581183">.</span><span class="ident" id="6581184">Intn</span><span class="op" id="6581188">(</span><span class="num" id="6581189">10000</span><span class="op" id="6581194">)</span><span class="op" id="6581195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581198">s</span><span class="op" id="6581199">.</span><span class="ident" id="6581200">masterSecret</span>&nbsp;<span class="op" id="6581213">=</span>&nbsp;<span class="ident" id="6581215">randomBytes</span><span class="op" id="6581226">(</span><span class="ident" id="6581227">rand</span><span class="op" id="6581231">.</span><span class="ident" id="6581232">Intn</span><span class="op" id="6581236">(</span><span class="num" id="6581237">100</span><span class="op" id="6581240">)</span><span class="op" id="6581241">,</span>&nbsp;<span class="ident" id="6581243">rand</span><span class="op" id="6581247">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581250">numCerts</span>&nbsp;<span class="op" id="6581259">:=</span>&nbsp;<span class="ident" id="6581262">rand</span><span class="op" id="6581266">.</span><span class="ident" id="6581267">Intn</span><span class="op" id="6581271">(</span><span class="num" id="6581272">20</span><span class="op" id="6581274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581277">s</span><span class="op" id="6581278">.</span><span class="ident" id="6581279">certificates</span>&nbsp;<span class="op" id="6581292">=</span>&nbsp;<span class="builtinfunc" id="6581294">make</span><span class="op" id="6581298">(</span><span class="op" id="6581299">[</span><span class="op" id="6581300">]</span><span class="op" id="6581301">[</span><span class="op" id="6581302">]</span><span class="builtintype" id="6581303">byte</span><span class="op" id="6581307">,</span>&nbsp;<span class="ident" id="6581309">numCerts</span><span class="op" id="6581317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6581320">for</span>&nbsp;<span class="ident" id="6581324">i</span>&nbsp;<span class="op" id="6581326">:=</span>&nbsp;<span class="num" id="6581329">0</span><span class="op" id="6581330">;</span>&nbsp;<span class="ident" id="6581332">i</span>&nbsp;<span class="op" id="6581334">&lt;</span>&nbsp;<span class="ident" id="6581336">numCerts</span><span class="op" id="6581344">;</span>&nbsp;<span class="ident" id="6581346">i</span><span class="op" id="6581347">++</span>&nbsp;<span class="op" id="6581350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581354">s</span><span class="op" id="6581355">.</span><span class="ident" id="6581356">certificates</span><span class="op" id="6581368">[</span><span class="ident" id="6581369">i</span><span class="op" id="6581370">]</span>&nbsp;<span class="op" id="6581372">=</span>&nbsp;<span class="ident" id="6581374">randomBytes</span><span class="op" id="6581385">(</span><span class="ident" id="6581386">rand</span><span class="op" id="6581390">.</span><span class="ident" id="6581391">Intn</span><span class="op" id="6581395">(</span><span class="num" id="6581396">10</span><span class="op" id="6581398">)</span><span class="op" id="6581399">+</span><span class="num" id="6581400">1</span><span class="op" id="6581401">,</span>&nbsp;<span class="ident" id="6581403">rand</span><span class="op" id="6581407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6581410">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6581413">return</span>&nbsp;<span class="ident" id="6581420">reflect</span><span class="op" id="6581427">.</span><span class="ident" id="6581428">ValueOf</span><span class="op" id="6581435">(</span><span class="ident" id="6581436">s</span><span class="op" id="6581437">)</span><br>
<span class="lineno"></span><span class="op" id="6581439">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
