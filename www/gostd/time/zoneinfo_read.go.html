<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2793541">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2793596">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2793650">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2793701">//&nbsp;Parse&nbsp;&#34;zoneinfo&#34;&nbsp;time&nbsp;zone&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2793737">//&nbsp;This&nbsp;is&nbsp;a&nbsp;fairly&nbsp;standard&nbsp;file&nbsp;format&nbsp;used&nbsp;on&nbsp;OS&nbsp;X,&nbsp;Linux,&nbsp;BSD,&nbsp;Sun,&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span><span class="comment" id="2793821">//&nbsp;See&nbsp;tzfile(5),&nbsp;http://en.wikipedia.org/wiki/Zoneinfo,</span><br>
<span class="lineno"></span><span class="comment" id="2793878">//&nbsp;and&nbsp;ftp://munnari.oz.au/pub/oldtz/</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2793917">package</span>&nbsp;<span class="ident" id="2793925">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2793931">import</span>&nbsp;<span class="string" id="2793938">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2793948">//&nbsp;Simple&nbsp;I/O&nbsp;interface&nbsp;to&nbsp;binary&nbsp;blob&nbsp;of&nbsp;data.</span><br>
<span class="lineno">15</span><span class="keyword" id="2793996">type</span>&nbsp;<span class="ident" id="2794001">data</span>&nbsp;<span class="keyword" id="2794006">struct</span>&nbsp;<span class="op" id="2794013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794016">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794022">[</span><span class="op" id="2794023">]</span><span class="builtintype" id="2794024">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2794030">error</span>&nbsp;<span class="builtintype" id="2794036">bool</span><br>
<span class="lineno"></span><span class="op" id="2794041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2794044">func</span>&nbsp;<span class="op" id="2794049">(</span><span class="ident" id="2794050">d</span>&nbsp;<span class="op" id="2794052">*</span><span class="ident" id="2794053">data</span><span class="op" id="2794057">)</span>&nbsp;<span class="ident" id="2794059">read</span><span class="op" id="2794063">(</span><span class="ident" id="2794064">n</span>&nbsp;<span class="builtintype" id="2794066">int</span><span class="op" id="2794069">)</span>&nbsp;<span class="op" id="2794071">[</span><span class="op" id="2794072">]</span><span class="builtintype" id="2794073">byte</span>&nbsp;<span class="op" id="2794078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794081">if</span>&nbsp;<span class="builtinfunc" id="2794084">len</span><span class="op" id="2794087">(</span><span class="ident" id="2794088">d</span><span class="op" id="2794089">.</span><span class="ident" id="2794090">p</span><span class="op" id="2794091">)</span>&nbsp;<span class="op" id="2794093">&lt;</span>&nbsp;<span class="ident" id="2794095">n</span>&nbsp;<span class="op" id="2794097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794101">d</span><span class="op" id="2794102">.</span><span class="ident" id="2794103">p</span>&nbsp;<span class="op" id="2794105">=</span>&nbsp;<span class="ident" id="2794107">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794113">d</span><span class="op" id="2794114">.</span><span class="builtintype" id="2794115">error</span>&nbsp;<span class="op" id="2794121">=</span>&nbsp;<span class="builtintype" id="2794123">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794130">return</span>&nbsp;<span class="ident" id="2794137">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794145">p</span>&nbsp;<span class="op" id="2794147">:=</span>&nbsp;<span class="ident" id="2794150">d</span><span class="op" id="2794151">.</span><span class="ident" id="2794152">p</span><span class="op" id="2794153">[</span><span class="num" id="2794154">0</span><span class="op" id="2794155">:</span><span class="ident" id="2794156">n</span><span class="op" id="2794157">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794160">d</span><span class="op" id="2794161">.</span><span class="ident" id="2794162">p</span>&nbsp;<span class="op" id="2794164">=</span>&nbsp;<span class="ident" id="2794166">d</span><span class="op" id="2794167">.</span><span class="ident" id="2794168">p</span><span class="op" id="2794169">[</span><span class="ident" id="2794170">n</span><span class="op" id="2794171">:</span><span class="op" id="2794172">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794175">return</span>&nbsp;<span class="ident" id="2794182">p</span><br>
<span class="lineno"></span><span class="op" id="2794184">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2794187">func</span>&nbsp;<span class="op" id="2794192">(</span><span class="ident" id="2794193">d</span>&nbsp;<span class="op" id="2794195">*</span><span class="ident" id="2794196">data</span><span class="op" id="2794200">)</span>&nbsp;<span class="ident" id="2794202">big4</span><span class="op" id="2794206">(</span><span class="op" id="2794207">)</span>&nbsp;<span class="op" id="2794209">(</span><span class="ident" id="2794210">n</span>&nbsp;<span class="builtintype" id="2794212">uint32</span><span class="op" id="2794218">,</span>&nbsp;<span class="ident" id="2794220">ok</span>&nbsp;<span class="builtintype" id="2794223">bool</span><span class="op" id="2794227">)</span>&nbsp;<span class="op" id="2794229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794232">p</span>&nbsp;<span class="op" id="2794234">:=</span>&nbsp;<span class="ident" id="2794237">d</span><span class="op" id="2794238">.</span><span class="ident" id="2794239">read</span><span class="op" id="2794243">(</span><span class="num" id="2794244">4</span><span class="op" id="2794245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794248">if</span>&nbsp;<span class="builtinfunc" id="2794251">len</span><span class="op" id="2794254">(</span><span class="ident" id="2794255">p</span><span class="op" id="2794256">)</span>&nbsp;<span class="op" id="2794258">&lt;</span>&nbsp;<span class="num" id="2794260">4</span>&nbsp;<span class="op" id="2794262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794266">d</span><span class="op" id="2794267">.</span><span class="builtintype" id="2794268">error</span>&nbsp;<span class="op" id="2794274">=</span>&nbsp;<span class="builtintype" id="2794276">true</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794283">return</span>&nbsp;<span class="num" id="2794290">0</span><span class="op" id="2794291">,</span>&nbsp;<span class="builtintype" id="2794293">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794303">return</span>&nbsp;<span class="builtintype" id="2794310">uint32</span><span class="op" id="2794316">(</span><span class="ident" id="2794317">p</span><span class="op" id="2794318">[</span><span class="num" id="2794319">0</span><span class="op" id="2794320">]</span><span class="op" id="2794321">)</span><span class="op" id="2794322">&lt;&lt;</span><span class="num" id="2794324">24</span>&nbsp;<span class="op" id="2794327">|</span>&nbsp;<span class="builtintype" id="2794329">uint32</span><span class="op" id="2794335">(</span><span class="ident" id="2794336">p</span><span class="op" id="2794337">[</span><span class="num" id="2794338">1</span><span class="op" id="2794339">]</span><span class="op" id="2794340">)</span><span class="op" id="2794341">&lt;&lt;</span><span class="num" id="2794343">16</span>&nbsp;<span class="op" id="2794346">|</span>&nbsp;<span class="builtintype" id="2794348">uint32</span><span class="op" id="2794354">(</span><span class="ident" id="2794355">p</span><span class="op" id="2794356">[</span><span class="num" id="2794357">2</span><span class="op" id="2794358">]</span><span class="op" id="2794359">)</span><span class="op" id="2794360">&lt;&lt;</span><span class="num" id="2794362">8</span>&nbsp;<span class="op" id="2794364">|</span>&nbsp;<span class="builtintype" id="2794366">uint32</span><span class="op" id="2794372">(</span><span class="ident" id="2794373">p</span><span class="op" id="2794374">[</span><span class="num" id="2794375">3</span><span class="op" id="2794376">]</span><span class="op" id="2794377">)</span><span class="op" id="2794378">,</span>&nbsp;<span class="builtintype" id="2794380">true</span><br>
<span class="lineno"></span><span class="op" id="2794385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2794388">func</span>&nbsp;<span class="op" id="2794393">(</span><span class="ident" id="2794394">d</span>&nbsp;<span class="op" id="2794396">*</span><span class="ident" id="2794397">data</span><span class="op" id="2794401">)</span>&nbsp;<span class="builtintype" id="2794403">byte</span><span class="op" id="2794407">(</span><span class="op" id="2794408">)</span>&nbsp;<span class="op" id="2794410">(</span><span class="ident" id="2794411">n</span>&nbsp;<span class="builtintype" id="2794413">byte</span><span class="op" id="2794417">,</span>&nbsp;<span class="ident" id="2794419">ok</span>&nbsp;<span class="builtintype" id="2794422">bool</span><span class="op" id="2794426">)</span>&nbsp;<span class="op" id="2794428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794431">p</span>&nbsp;<span class="op" id="2794433">:=</span>&nbsp;<span class="ident" id="2794436">d</span><span class="op" id="2794437">.</span><span class="ident" id="2794438">read</span><span class="op" id="2794442">(</span><span class="num" id="2794443">1</span><span class="op" id="2794444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794447">if</span>&nbsp;<span class="builtinfunc" id="2794450">len</span><span class="op" id="2794453">(</span><span class="ident" id="2794454">p</span><span class="op" id="2794455">)</span>&nbsp;<span class="op" id="2794457">&lt;</span>&nbsp;<span class="num" id="2794459">1</span>&nbsp;<span class="op" id="2794461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794465">d</span><span class="op" id="2794466">.</span><span class="builtintype" id="2794467">error</span>&nbsp;<span class="op" id="2794473">=</span>&nbsp;<span class="builtintype" id="2794475">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794482">return</span>&nbsp;<span class="num" id="2794489">0</span><span class="op" id="2794490">,</span>&nbsp;<span class="builtintype" id="2794492">false</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794502">return</span>&nbsp;<span class="ident" id="2794509">p</span><span class="op" id="2794510">[</span><span class="num" id="2794511">0</span><span class="op" id="2794512">]</span><span class="op" id="2794513">,</span>&nbsp;<span class="builtintype" id="2794515">true</span><br>
<span class="lineno"></span><span class="op" id="2794520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794523">//&nbsp;Make&nbsp;a&nbsp;string&nbsp;by&nbsp;stopping&nbsp;at&nbsp;the&nbsp;first&nbsp;NUL</span><br>
<span class="lineno">50</span><span class="keyword" id="2794569">func</span>&nbsp;<span class="ident" id="2794574">byteString</span><span class="op" id="2794584">(</span><span class="ident" id="2794585">p</span>&nbsp;<span class="op" id="2794587">[</span><span class="op" id="2794588">]</span><span class="builtintype" id="2794589">byte</span><span class="op" id="2794593">)</span>&nbsp;<span class="builtintype" id="2794595">string</span>&nbsp;<span class="op" id="2794602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794605">for</span>&nbsp;<span class="ident" id="2794609">i</span>&nbsp;<span class="op" id="2794611">:=</span>&nbsp;<span class="num" id="2794614">0</span><span class="op" id="2794615">;</span>&nbsp;<span class="ident" id="2794617">i</span>&nbsp;<span class="op" id="2794619">&lt;</span>&nbsp;<span class="builtinfunc" id="2794621">len</span><span class="op" id="2794624">(</span><span class="ident" id="2794625">p</span><span class="op" id="2794626">)</span><span class="op" id="2794627">;</span>&nbsp;<span class="ident" id="2794629">i</span><span class="op" id="2794630">++</span>&nbsp;<span class="op" id="2794633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794637">if</span>&nbsp;<span class="ident" id="2794640">p</span><span class="op" id="2794641">[</span><span class="ident" id="2794642">i</span><span class="op" id="2794643">]</span>&nbsp;<span class="op" id="2794645">==</span>&nbsp;<span class="num" id="2794648">0</span>&nbsp;<span class="op" id="2794650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794655">return</span>&nbsp;<span class="builtintype" id="2794662">string</span><span class="op" id="2794668">(</span><span class="ident" id="2794669">p</span><span class="op" id="2794670">[</span><span class="num" id="2794671">0</span><span class="op" id="2794672">:</span><span class="ident" id="2794673">i</span><span class="op" id="2794674">]</span><span class="op" id="2794675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794679">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794685">return</span>&nbsp;<span class="builtintype" id="2794692">string</span><span class="op" id="2794698">(</span><span class="ident" id="2794699">p</span><span class="op" id="2794700">)</span><br>
<span class="lineno"></span><span class="op" id="2794702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2794705">var</span>&nbsp;<span class="ident" id="2794709">badData</span>&nbsp;<span class="op" id="2794717">=</span>&nbsp;<span class="ident" id="2794719">errors</span><span class="op" id="2794725">.</span><span class="ident" id="2794726">New</span><span class="op" id="2794729">(</span><span class="string" id="2794730">&#34;malformed&nbsp;time&nbsp;zone&nbsp;information&#34;</span><span class="op" id="2794763">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2794766">func</span>&nbsp;<span class="ident" id="2794771">loadZoneData</span><span class="op" id="2794783">(</span><span class="ident" id="2794784">bytes</span>&nbsp;<span class="op" id="2794790">[</span><span class="op" id="2794791">]</span><span class="builtintype" id="2794792">byte</span><span class="op" id="2794796">)</span>&nbsp;<span class="op" id="2794798">(</span><span class="ident" id="2794799">l</span>&nbsp;<span class="op" id="2794801">*</span><span class="ident" id="2794802">Location</span><span class="op" id="2794810">,</span>&nbsp;<span class="ident" id="2794812">err</span>&nbsp;<span class="builtintype" id="2794816">error</span><span class="op" id="2794821">)</span>&nbsp;<span class="op" id="2794823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794826">d</span>&nbsp;<span class="op" id="2794828">:=</span>&nbsp;<span class="ident" id="2794831">data</span><span class="op" id="2794835">{</span><span class="ident" id="2794836">bytes</span><span class="op" id="2794841">,</span>&nbsp;<span class="builtintype" id="2794843">false</span><span class="op" id="2794848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2794852">//&nbsp;4-byte&nbsp;magic&nbsp;&#34;TZif&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794876">if</span>&nbsp;<span class="ident" id="2794879">magic</span>&nbsp;<span class="op" id="2794885">:=</span>&nbsp;<span class="ident" id="2794888">d</span><span class="op" id="2794889">.</span><span class="ident" id="2794890">read</span><span class="op" id="2794894">(</span><span class="num" id="2794895">4</span><span class="op" id="2794896">)</span><span class="op" id="2794897">;</span>&nbsp;<span class="builtintype" id="2794899">string</span><span class="op" id="2794905">(</span><span class="ident" id="2794906">magic</span><span class="op" id="2794911">)</span>&nbsp;<span class="op" id="2794913">!=</span>&nbsp;<span class="string" id="2794916">&#34;TZif&#34;</span>&nbsp;<span class="op" id="2794923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794927">return</span>&nbsp;<span class="ident" id="2794934">nil</span><span class="op" id="2794937">,</span>&nbsp;<span class="ident" id="2794939">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2794952">//&nbsp;1-byte&nbsp;version,&nbsp;then&nbsp;15&nbsp;bytes&nbsp;of&nbsp;padding</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794997">var</span>&nbsp;<span class="ident" id="2795001">p</span>&nbsp;<span class="op" id="2795003">[</span><span class="op" id="2795004">]</span><span class="builtintype" id="2795005">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795011">if</span>&nbsp;<span class="ident" id="2795014">p</span>&nbsp;<span class="op" id="2795016">=</span>&nbsp;<span class="ident" id="2795018">d</span><span class="op" id="2795019">.</span><span class="ident" id="2795020">read</span><span class="op" id="2795024">(</span><span class="num" id="2795025">16</span><span class="op" id="2795027">)</span><span class="op" id="2795028">;</span>&nbsp;<span class="builtinfunc" id="2795030">len</span><span class="op" id="2795033">(</span><span class="ident" id="2795034">p</span><span class="op" id="2795035">)</span>&nbsp;<span class="op" id="2795037">!=</span>&nbsp;<span class="num" id="2795040">16</span>&nbsp;<span class="op" id="2795043">||</span>&nbsp;<span class="ident" id="2795046">p</span><span class="op" id="2795047">[</span><span class="num" id="2795048">0</span><span class="op" id="2795049">]</span>&nbsp;<span class="op" id="2795051">!=</span>&nbsp;<span class="num" id="2795054">0</span>&nbsp;<span class="op" id="2795056">&amp;&amp;</span>&nbsp;<span class="ident" id="2795059">p</span><span class="op" id="2795060">[</span><span class="num" id="2795061">0</span><span class="op" id="2795062">]</span>&nbsp;<span class="op" id="2795064">!=</span>&nbsp;<span class="string" id="2795067">&#39;2&#39;</span>&nbsp;<span class="op" id="2795071">&amp;&amp;</span>&nbsp;<span class="ident" id="2795074">p</span><span class="op" id="2795075">[</span><span class="num" id="2795076">0</span><span class="op" id="2795077">]</span>&nbsp;<span class="op" id="2795079">!=</span>&nbsp;<span class="string" id="2795082">&#39;3&#39;</span>&nbsp;<span class="op" id="2795086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795090">return</span>&nbsp;<span class="ident" id="2795097">nil</span><span class="op" id="2795100">,</span>&nbsp;<span class="ident" id="2795102">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795115">//&nbsp;six&nbsp;big-endian&nbsp;32-bit&nbsp;integers:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795151">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;UTC/local&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795186">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;standard/wall&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795225">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;leap&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795252">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;transition&nbsp;times</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795283">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;local&nbsp;time&nbsp;zones</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795314">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;characters&nbsp;of&nbsp;time&nbsp;zone&nbsp;abbrev&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795367">const</span>&nbsp;<span class="op" id="2795373">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795377">NUTCLocal</span>&nbsp;<span class="op" id="2795387">=</span>&nbsp;<span class="ident" id="2795389">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795396">NStdWall</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795407">NLeap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795415">NTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795423">NZone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795431">NChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795438">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795441">var</span>&nbsp;<span class="ident" id="2795445">n</span>&nbsp;<span class="op" id="2795447">[</span><span class="num" id="2795448">6</span><span class="op" id="2795449">]</span><span class="builtintype" id="2795450">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795455">for</span>&nbsp;<span class="ident" id="2795459">i</span>&nbsp;<span class="op" id="2795461">:=</span>&nbsp;<span class="num" id="2795464">0</span><span class="op" id="2795465">;</span>&nbsp;<span class="ident" id="2795467">i</span>&nbsp;<span class="op" id="2795469">&lt;</span>&nbsp;<span class="num" id="2795471">6</span><span class="op" id="2795472">;</span>&nbsp;<span class="ident" id="2795474">i</span><span class="op" id="2795475">++</span>&nbsp;<span class="op" id="2795478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795482">nn</span><span class="op" id="2795484">,</span>&nbsp;<span class="ident" id="2795486">ok</span>&nbsp;<span class="op" id="2795489">:=</span>&nbsp;<span class="ident" id="2795492">d</span><span class="op" id="2795493">.</span><span class="ident" id="2795494">big4</span><span class="op" id="2795498">(</span><span class="op" id="2795499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795503">if</span>&nbsp;<span class="op" id="2795506">!</span><span class="ident" id="2795507">ok</span>&nbsp;<span class="op" id="2795510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795515">return</span>&nbsp;<span class="ident" id="2795522">nil</span><span class="op" id="2795525">,</span>&nbsp;<span class="ident" id="2795527">badData</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795541">n</span><span class="op" id="2795542">[</span><span class="ident" id="2795543">i</span><span class="op" id="2795544">]</span>&nbsp;<span class="op" id="2795546">=</span>&nbsp;<span class="builtintype" id="2795548">int</span><span class="op" id="2795551">(</span><span class="ident" id="2795552">nn</span><span class="op" id="2795554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795561">//&nbsp;Transition&nbsp;times.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795583">txtimes</span>&nbsp;<span class="op" id="2795591">:=</span>&nbsp;<span class="ident" id="2795594">data</span><span class="op" id="2795598">{</span><span class="ident" id="2795599">d</span><span class="op" id="2795600">.</span><span class="ident" id="2795601">read</span><span class="op" id="2795605">(</span><span class="ident" id="2795606">n</span><span class="op" id="2795607">[</span><span class="ident" id="2795608">NTime</span><span class="op" id="2795613">]</span>&nbsp;<span class="op" id="2795615">*</span>&nbsp;<span class="num" id="2795617">4</span><span class="op" id="2795618">)</span><span class="op" id="2795619">,</span>&nbsp;<span class="builtintype" id="2795621">false</span><span class="op" id="2795626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795630">//&nbsp;Time&nbsp;zone&nbsp;indices&nbsp;for&nbsp;transition&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795674">txzones</span>&nbsp;<span class="op" id="2795682">:=</span>&nbsp;<span class="ident" id="2795685">d</span><span class="op" id="2795686">.</span><span class="ident" id="2795687">read</span><span class="op" id="2795691">(</span><span class="ident" id="2795692">n</span><span class="op" id="2795693">[</span><span class="ident" id="2795694">NTime</span><span class="op" id="2795699">]</span><span class="op" id="2795700">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795704">//&nbsp;Zone&nbsp;info&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795729">zonedata</span>&nbsp;<span class="op" id="2795738">:=</span>&nbsp;<span class="ident" id="2795741">data</span><span class="op" id="2795745">{</span><span class="ident" id="2795746">d</span><span class="op" id="2795747">.</span><span class="ident" id="2795748">read</span><span class="op" id="2795752">(</span><span class="ident" id="2795753">n</span><span class="op" id="2795754">[</span><span class="ident" id="2795755">NZone</span><span class="op" id="2795760">]</span>&nbsp;<span class="op" id="2795762">*</span>&nbsp;<span class="num" id="2795764">6</span><span class="op" id="2795765">)</span><span class="op" id="2795766">,</span>&nbsp;<span class="builtintype" id="2795768">false</span><span class="op" id="2795773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795777">//&nbsp;Time&nbsp;zone&nbsp;abbreviations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795806">abbrev</span>&nbsp;<span class="op" id="2795813">:=</span>&nbsp;<span class="ident" id="2795816">d</span><span class="op" id="2795817">.</span><span class="ident" id="2795818">read</span><span class="op" id="2795822">(</span><span class="ident" id="2795823">n</span><span class="op" id="2795824">[</span><span class="ident" id="2795825">NChar</span><span class="op" id="2795830">]</span><span class="op" id="2795831">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795835">//&nbsp;Leap-second&nbsp;time&nbsp;pairs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795862">d</span><span class="op" id="2795863">.</span><span class="ident" id="2795864">read</span><span class="op" id="2795868">(</span><span class="ident" id="2795869">n</span><span class="op" id="2795870">[</span><span class="ident" id="2795871">NLeap</span><span class="op" id="2795876">]</span>&nbsp;<span class="op" id="2795878">*</span>&nbsp;<span class="num" id="2795880">8</span><span class="op" id="2795881">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795885">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795939">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;standard&nbsp;time&nbsp;or&nbsp;wall&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795988">isstd</span>&nbsp;<span class="op" id="2795994">:=</span>&nbsp;<span class="ident" id="2795997">d</span><span class="op" id="2795998">.</span><span class="ident" id="2795999">read</span><span class="op" id="2796003">(</span><span class="ident" id="2796004">n</span><span class="op" id="2796005">[</span><span class="ident" id="2796006">NStdWall</span><span class="op" id="2796014">]</span><span class="op" id="2796015">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2796019">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2796073">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;UTC&nbsp;or&nbsp;local&nbsp;time.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2796113">isutc</span>&nbsp;<span class="op" id="2796119">:=</span>&nbsp;<span class="ident" id="2796122">d</span><span class="op" id="2796123">.</span><span class="ident" id="2796124">read</span><span class="op" id="2796128">(</span><span class="ident" id="2796129">n</span><span class="op" id="2796130">[</span><span class="ident" id="2796131">NUTCLocal</span><span class="op" id="2796140">]</span><span class="op" id="2796141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796145">if</span>&nbsp;<span class="ident" id="2796148">d</span><span class="op" id="2796149">.</span><span class="builtintype" id="2796150">error</span>&nbsp;<span class="op" id="2796156">{</span>&nbsp;<span class="comment" id="2796158">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796179">return</span>&nbsp;<span class="ident" id="2796186">nil</span><span class="op" id="2796189">,</span>&nbsp;<span class="ident" id="2796191">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2796200">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2796204">//&nbsp;If&nbsp;version&nbsp;==&nbsp;2&nbsp;or&nbsp;3,&nbsp;the&nbsp;entire&nbsp;file&nbsp;repeats,&nbsp;this&nbsp;time&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2796271">//&nbsp;8-byte&nbsp;ints&nbsp;for&nbsp;txtimes&nbsp;and&nbsp;leap&nbsp;seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2796317">//&nbsp;We&nbsp;won&#39;t&nbsp;need&nbsp;those&nbsp;until&nbsp;2106.</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2796354">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;build&nbsp;up&nbsp;a&nbsp;useful&nbsp;data&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2796403">//&nbsp;First&nbsp;the&nbsp;zone&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2796435">//&nbsp;&nbsp;&nbsp;&nbsputcoff[4]&nbsp;isdst[1]&nbsp;nameindex[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2796471">zone</span>&nbsp;<span class="op" id="2796476">:=</span>&nbsp;<span class="builtinfunc" id="2796479">make</span><span class="op" id="2796483">(</span><span class="op" id="2796484">[</span><span class="op" id="2796485">]</span><span class="ident" id="2796486">zone</span><span class="op" id="2796490">,</span>&nbsp;<span class="ident" id="2796492">n</span><span class="op" id="2796493">[</span><span class="ident" id="2796494">NZone</span><span class="op" id="2796499">]</span><span class="op" id="2796500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796503">for</span>&nbsp;<span class="ident" id="2796507">i</span>&nbsp;<span class="op" id="2796509">:=</span>&nbsp;<span class="keyword" id="2796512">range</span>&nbsp;<span class="ident" id="2796518">zone</span>&nbsp;<span class="op" id="2796523">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796527">var</span>&nbsp;<span class="ident" id="2796531">ok</span>&nbsp;<span class="builtintype" id="2796534">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796541">var</span>&nbsp;<span class="ident" id="2796545">n</span>&nbsp;<span class="builtintype" id="2796547">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796556">if</span>&nbsp;<span class="ident" id="2796559">n</span><span class="op" id="2796560">,</span>&nbsp;<span class="ident" id="2796562">ok</span>&nbsp;<span class="op" id="2796565">=</span>&nbsp;<span class="ident" id="2796567">zonedata</span><span class="op" id="2796575">.</span><span class="ident" id="2796576">big4</span><span class="op" id="2796580">(</span><span class="op" id="2796581">)</span><span class="op" id="2796582">;</span>&nbsp;<span class="op" id="2796584">!</span><span class="ident" id="2796585">ok</span>&nbsp;<span class="op" id="2796588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796593">return</span>&nbsp;<span class="ident" id="2796600">nil</span><span class="op" id="2796603">,</span>&nbsp;<span class="ident" id="2796605">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2796615">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2796619">zone</span><span class="op" id="2796623">[</span><span class="ident" id="2796624">i</span><span class="op" id="2796625">]</span><span class="op" id="2796626">.</span><span class="ident" id="2796627">offset</span>&nbsp;<span class="op" id="2796634">=</span>&nbsp;<span class="builtintype" id="2796636">int</span><span class="op" id="2796639">(</span><span class="builtintype" id="2796640">int32</span><span class="op" id="2796645">(</span><span class="ident" id="2796646">n</span><span class="op" id="2796647">)</span><span class="op" id="2796648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796652">var</span>&nbsp;<span class="ident" id="2796656">b</span>&nbsp;<span class="builtintype" id="2796658">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796665">if</span>&nbsp;<span class="ident" id="2796668">b</span><span class="op" id="2796669">,</span>&nbsp;<span class="ident" id="2796671">ok</span>&nbsp;<span class="op" id="2796674">=</span>&nbsp;<span class="ident" id="2796676">zonedata</span><span class="op" id="2796684">.</span><span class="builtintype" id="2796685">byte</span><span class="op" id="2796689">(</span><span class="op" id="2796690">)</span><span class="op" id="2796691">;</span>&nbsp;<span class="op" id="2796693">!</span><span class="ident" id="2796694">ok</span>&nbsp;<span class="op" id="2796697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796702">return</span>&nbsp;<span class="ident" id="2796709">nil</span><span class="op" id="2796712">,</span>&nbsp;<span class="ident" id="2796714">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2796724">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2796728">zone</span><span class="op" id="2796732">[</span><span class="ident" id="2796733">i</span><span class="op" id="2796734">]</span><span class="op" id="2796735">.</span><span class="ident" id="2796736">isDST</span>&nbsp;<span class="op" id="2796742">=</span>&nbsp;<span class="ident" id="2796744">b</span>&nbsp;<span class="op" id="2796746">!=</span>&nbsp;<span class="num" id="2796749">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796753">if</span>&nbsp;<span class="ident" id="2796756">b</span><span class="op" id="2796757">,</span>&nbsp;<span class="ident" id="2796759">ok</span>&nbsp;<span class="op" id="2796762">=</span>&nbsp;<span class="ident" id="2796764">zonedata</span><span class="op" id="2796772">.</span><span class="builtintype" id="2796773">byte</span><span class="op" id="2796777">(</span><span class="op" id="2796778">)</span><span class="op" id="2796779">;</span>&nbsp;<span class="op" id="2796781">!</span><span class="ident" id="2796782">ok</span>&nbsp;<span class="op" id="2796785">||</span>&nbsp;<span class="builtintype" id="2796788">int</span><span class="op" id="2796791">(</span><span class="ident" id="2796792">b</span><span class="op" id="2796793">)</span>&nbsp;<span class="op" id="2796795">&gt;=</span>&nbsp;<span class="builtinfunc" id="2796798">len</span><span class="op" id="2796801">(</span><span class="ident" id="2796802">abbrev</span><span class="op" id="2796808">)</span>&nbsp;<span class="op" id="2796810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796815">return</span>&nbsp;<span class="ident" id="2796822">nil</span><span class="op" id="2796825">,</span>&nbsp;<span class="ident" id="2796827">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2796837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2796841">zone</span><span class="op" id="2796845">[</span><span class="ident" id="2796846">i</span><span class="op" id="2796847">]</span><span class="op" id="2796848">.</span><span class="ident" id="2796849">name</span>&nbsp;<span class="op" id="2796854">=</span>&nbsp;<span class="ident" id="2796856">byteString</span><span class="op" id="2796866">(</span><span class="ident" id="2796867">abbrev</span><span class="op" id="2796873">[</span><span class="ident" id="2796874">b</span><span class="op" id="2796875">:</span><span class="op" id="2796876">]</span><span class="op" id="2796877">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2796880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2796884">//&nbsp;Now&nbsp;the&nbsp;transition&nbsp;time&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2796918">tx</span>&nbsp;<span class="op" id="2796921">:=</span>&nbsp;<span class="builtinfunc" id="2796924">make</span><span class="op" id="2796928">(</span><span class="op" id="2796929">[</span><span class="op" id="2796930">]</span><span class="ident" id="2796931">zoneTrans</span><span class="op" id="2796940">,</span>&nbsp;<span class="ident" id="2796942">n</span><span class="op" id="2796943">[</span><span class="ident" id="2796944">NTime</span><span class="op" id="2796949">]</span><span class="op" id="2796950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796953">for</span>&nbsp;<span class="ident" id="2796957">i</span>&nbsp;<span class="op" id="2796959">:=</span>&nbsp;<span class="keyword" id="2796962">range</span>&nbsp;<span class="ident" id="2796968">tx</span>&nbsp;<span class="op" id="2796971">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796975">var</span>&nbsp;<span class="ident" id="2796979">ok</span>&nbsp;<span class="builtintype" id="2796982">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796989">var</span>&nbsp;<span class="ident" id="2796993">n</span>&nbsp;<span class="builtintype" id="2796995">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797004">if</span>&nbsp;<span class="ident" id="2797007">n</span><span class="op" id="2797008">,</span>&nbsp;<span class="ident" id="2797010">ok</span>&nbsp;<span class="op" id="2797013">=</span>&nbsp;<span class="ident" id="2797015">txtimes</span><span class="op" id="2797022">.</span><span class="ident" id="2797023">big4</span><span class="op" id="2797027">(</span><span class="op" id="2797028">)</span><span class="op" id="2797029">;</span>&nbsp;<span class="op" id="2797031">!</span><span class="ident" id="2797032">ok</span>&nbsp;<span class="op" id="2797035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797040">return</span>&nbsp;<span class="ident" id="2797047">nil</span><span class="op" id="2797050">,</span>&nbsp;<span class="ident" id="2797052">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2797062">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797066">tx</span><span class="op" id="2797068">[</span><span class="ident" id="2797069">i</span><span class="op" id="2797070">]</span><span class="op" id="2797071">.</span><span class="ident" id="2797072">when</span>&nbsp;<span class="op" id="2797077">=</span>&nbsp;<span class="ident" id="2797079">int64</span><span class="op" id="2797084">(</span><span class="builtintype" id="2797085">int32</span><span class="op" id="2797090">(</span><span class="ident" id="2797091">n</span><span class="op" id="2797092">)</span><span class="op" id="2797093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797097">if</span>&nbsp;<span class="builtintype" id="2797100">int</span><span class="op" id="2797103">(</span><span class="ident" id="2797104">txzones</span><span class="op" id="2797111">[</span><span class="ident" id="2797112">i</span><span class="op" id="2797113">]</span><span class="op" id="2797114">)</span>&nbsp;<span class="op" id="2797116">&gt;=</span>&nbsp;<span class="builtinfunc" id="2797119">len</span><span class="op" id="2797122">(</span><span class="ident" id="2797123">zone</span><span class="op" id="2797127">)</span>&nbsp;<span class="op" id="2797129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797134">return</span>&nbsp;<span class="ident" id="2797141">nil</span><span class="op" id="2797144">,</span>&nbsp;<span class="ident" id="2797146">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2797156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797160">tx</span><span class="op" id="2797162">[</span><span class="ident" id="2797163">i</span><span class="op" id="2797164">]</span><span class="op" id="2797165">.</span><span class="ident" id="2797166">index</span>&nbsp;<span class="op" id="2797172">=</span>&nbsp;<span class="ident" id="2797174">txzones</span><span class="op" id="2797181">[</span><span class="ident" id="2797182">i</span><span class="op" id="2797183">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797187">if</span>&nbsp;<span class="ident" id="2797190">i</span>&nbsp;<span class="op" id="2797192">&lt;</span>&nbsp;<span class="builtinfunc" id="2797194">len</span><span class="op" id="2797197">(</span><span class="ident" id="2797198">isstd</span><span class="op" id="2797203">)</span>&nbsp;<span class="op" id="2797205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797210">tx</span><span class="op" id="2797212">[</span><span class="ident" id="2797213">i</span><span class="op" id="2797214">]</span><span class="op" id="2797215">.</span><span class="ident" id="2797216">isstd</span>&nbsp;<span class="op" id="2797222">=</span>&nbsp;<span class="ident" id="2797224">isstd</span><span class="op" id="2797229">[</span><span class="ident" id="2797230">i</span><span class="op" id="2797231">]</span>&nbsp;<span class="op" id="2797233">!=</span>&nbsp;<span class="num" id="2797236">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2797240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797244">if</span>&nbsp;<span class="ident" id="2797247">i</span>&nbsp;<span class="op" id="2797249">&lt;</span>&nbsp;<span class="builtinfunc" id="2797251">len</span><span class="op" id="2797254">(</span><span class="ident" id="2797255">isutc</span><span class="op" id="2797260">)</span>&nbsp;<span class="op" id="2797262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797267">tx</span><span class="op" id="2797269">[</span><span class="ident" id="2797270">i</span><span class="op" id="2797271">]</span><span class="op" id="2797272">.</span><span class="ident" id="2797273">isutc</span>&nbsp;<span class="op" id="2797279">=</span>&nbsp;<span class="ident" id="2797281">isutc</span><span class="op" id="2797286">[</span><span class="ident" id="2797287">i</span><span class="op" id="2797288">]</span>&nbsp;<span class="op" id="2797290">!=</span>&nbsp;<span class="num" id="2797293">0</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2797297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2797300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797304">if</span>&nbsp;<span class="builtinfunc" id="2797307">len</span><span class="op" id="2797310">(</span><span class="ident" id="2797311">tx</span><span class="op" id="2797313">)</span>&nbsp;<span class="op" id="2797315">==</span>&nbsp;<span class="num" id="2797318">0</span>&nbsp;<span class="op" id="2797320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2797324">//&nbsp;Build&nbsp;fake&nbsp;transition&nbsp;to&nbsp;cover&nbsp;all&nbsp;time.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2797370">//&nbsp;This&nbsp;happens&nbsp;in&nbsp;fixed&nbsp;locations&nbsp;like&nbsp;&#34;Etc/GMT0&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797424">tx</span>&nbsp;<span class="op" id="2797427">=</span>&nbsp;<span class="builtinfunc" id="2797429">append</span><span class="op" id="2797435">(</span><span class="ident" id="2797436">tx</span><span class="op" id="2797438">,</span>&nbsp;<span class="ident" id="2797440">zoneTrans</span><span class="op" id="2797449">{</span><span class="ident" id="2797450">when</span><span class="op" id="2797454">:</span>&nbsp;<span class="ident" id="2797456">alpha</span><span class="op" id="2797461">,</span>&nbsp;<span class="ident" id="2797463">index</span><span class="op" id="2797468">:</span>&nbsp;<span class="num" id="2797470">0</span><span class="op" id="2797471">}</span><span class="op" id="2797472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2797475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2797479">//&nbsp;Committed&nbsp;to&nbsp;succeed.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797505">l</span>&nbsp;<span class="op" id="2797507">=</span>&nbsp;<span class="op" id="2797509">&amp;</span><span class="ident" id="2797510">Location</span><span class="op" id="2797518">{</span><span class="ident" id="2797519">zone</span><span class="op" id="2797523">:</span>&nbsp;<span class="ident" id="2797525">zone</span><span class="op" id="2797529">,</span>&nbsp;<span class="ident" id="2797531">tx</span><span class="op" id="2797533">:</span>&nbsp;<span class="ident" id="2797535">tx</span><span class="op" id="2797537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2797541">//&nbsp;Fill&nbsp;in&nbsp;the&nbsp;cache&nbsp;with&nbsp;information&nbsp;about&nbsp;right&nbsp;now,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2797597">//&nbsp;since&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;most&nbsp;common&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797644">sec</span><span class="op" id="2797647">,</span>&nbsp;<span class="ident" id="2797649">_</span>&nbsp;<span class="op" id="2797651">:=</span>&nbsp;<span class="ident" id="2797654">now</span><span class="op" id="2797657">(</span><span class="op" id="2797658">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797661">for</span>&nbsp;<span class="ident" id="2797665">i</span>&nbsp;<span class="op" id="2797667">:=</span>&nbsp;<span class="keyword" id="2797670">range</span>&nbsp;<span class="ident" id="2797676">tx</span>&nbsp;<span class="op" id="2797679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797683">if</span>&nbsp;<span class="ident" id="2797686">tx</span><span class="op" id="2797688">[</span><span class="ident" id="2797689">i</span><span class="op" id="2797690">]</span><span class="op" id="2797691">.</span><span class="ident" id="2797692">when</span>&nbsp;<span class="op" id="2797697">&lt;=</span>&nbsp;<span class="ident" id="2797700">sec</span>&nbsp;<span class="op" id="2797704">&amp;&amp;</span>&nbsp;<span class="op" id="2797707">(</span><span class="ident" id="2797708">i</span><span class="op" id="2797709">+</span><span class="num" id="2797710">1</span>&nbsp;<span class="op" id="2797712">==</span>&nbsp;<span class="builtinfunc" id="2797715">len</span><span class="op" id="2797718">(</span><span class="ident" id="2797719">tx</span><span class="op" id="2797721">)</span>&nbsp;<span class="op" id="2797723">||</span>&nbsp;<span class="ident" id="2797726">sec</span>&nbsp;<span class="op" id="2797730">&lt;</span>&nbsp;<span class="ident" id="2797732">tx</span><span class="op" id="2797734">[</span><span class="ident" id="2797735">i</span><span class="op" id="2797736">+</span><span class="num" id="2797737">1</span><span class="op" id="2797738">]</span><span class="op" id="2797739">.</span><span class="ident" id="2797740">when</span><span class="op" id="2797744">)</span>&nbsp;<span class="op" id="2797746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797751">l</span><span class="op" id="2797752">.</span><span class="ident" id="2797753">cacheStart</span>&nbsp;<span class="op" id="2797764">=</span>&nbsp;<span class="ident" id="2797766">tx</span><span class="op" id="2797768">[</span><span class="ident" id="2797769">i</span><span class="op" id="2797770">]</span><span class="op" id="2797771">.</span><span class="ident" id="2797772">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797780">l</span><span class="op" id="2797781">.</span><span class="ident" id="2797782">cacheEnd</span>&nbsp;<span class="op" id="2797791">=</span>&nbsp;<span class="ident" id="2797793">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797802">if</span>&nbsp;<span class="ident" id="2797805">i</span><span class="op" id="2797806">+</span><span class="num" id="2797807">1</span>&nbsp;<span class="op" id="2797809">&lt;</span>&nbsp;<span class="builtinfunc" id="2797811">len</span><span class="op" id="2797814">(</span><span class="ident" id="2797815">tx</span><span class="op" id="2797817">)</span>&nbsp;<span class="op" id="2797819">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797825">l</span><span class="op" id="2797826">.</span><span class="ident" id="2797827">cacheEnd</span>&nbsp;<span class="op" id="2797836">=</span>&nbsp;<span class="ident" id="2797838">tx</span><span class="op" id="2797840">[</span><span class="ident" id="2797841">i</span><span class="op" id="2797842">+</span><span class="num" id="2797843">1</span><span class="op" id="2797844">]</span><span class="op" id="2797845">.</span><span class="ident" id="2797846">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2797854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2797859">l</span><span class="op" id="2797860">.</span><span class="ident" id="2797861">cacheZone</span>&nbsp;<span class="op" id="2797871">=</span>&nbsp;<span class="op" id="2797873">&amp;</span><span class="ident" id="2797874">l</span><span class="op" id="2797875">.</span><span class="ident" id="2797876">zone</span><span class="op" id="2797880">[</span><span class="ident" id="2797881">tx</span><span class="op" id="2797883">[</span><span class="ident" id="2797884">i</span><span class="op" id="2797885">]</span><span class="op" id="2797886">.</span><span class="ident" id="2797887">index</span><span class="op" id="2797892">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2797896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2797899">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797903">return</span>&nbsp;<span class="ident" id="2797910">l</span><span class="op" id="2797911">,</span>&nbsp;<span class="ident" id="2797913">nil</span><br>
<span class="lineno"></span><span class="op" id="2797917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2797920">func</span>&nbsp;<span class="ident" id="2797925">loadZoneFile</span><span class="op" id="2797937">(</span><span class="ident" id="2797938">dir</span><span class="op" id="2797941">,</span>&nbsp;<span class="ident" id="2797943">name</span>&nbsp;<span class="builtintype" id="2797948">string</span><span class="op" id="2797954">)</span>&nbsp;<span class="op" id="2797956">(</span><span class="ident" id="2797957">l</span>&nbsp;<span class="op" id="2797959">*</span><span class="ident" id="2797960">Location</span><span class="op" id="2797968">,</span>&nbsp;<span class="ident" id="2797970">err</span>&nbsp;<span class="builtintype" id="2797974">error</span><span class="op" id="2797979">)</span>&nbsp;<span class="op" id="2797981">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2797984">if</span>&nbsp;<span class="builtinfunc" id="2797987">len</span><span class="op" id="2797990">(</span><span class="ident" id="2797991">dir</span><span class="op" id="2797994">)</span>&nbsp;<span class="op" id="2797996">&gt;</span>&nbsp;<span class="num" id="2797998">4</span>&nbsp;<span class="op" id="2798000">&amp;&amp;</span>&nbsp;<span class="ident" id="2798003">dir</span><span class="op" id="2798006">[</span><span class="builtinfunc" id="2798007">len</span><span class="op" id="2798010">(</span><span class="ident" id="2798011">dir</span><span class="op" id="2798014">)</span><span class="op" id="2798015">-</span><span class="num" id="2798016">4</span><span class="op" id="2798017">:</span><span class="op" id="2798018">]</span>&nbsp;<span class="op" id="2798020">==</span>&nbsp;<span class="string" id="2798023">&#34;.zip&#34;</span>&nbsp;<span class="op" id="2798030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798034">return</span>&nbsp;<span class="ident" id="2798041">loadZoneZip</span><span class="op" id="2798052">(</span><span class="ident" id="2798053">dir</span><span class="op" id="2798056">,</span>&nbsp;<span class="ident" id="2798058">name</span><span class="op" id="2798062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2798065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798068">if</span>&nbsp;<span class="ident" id="2798071">dir</span>&nbsp;<span class="op" id="2798075">!=</span>&nbsp;<span class="string" id="2798078">&#34;&#34;</span>&nbsp;<span class="op" id="2798081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2798085">name</span>&nbsp;<span class="op" id="2798090">=</span>&nbsp;<span class="ident" id="2798092">dir</span>&nbsp;<span class="op" id="2798096">+</span>&nbsp;<span class="string" id="2798098">&#34;/&#34;</span>&nbsp;<span class="op" id="2798102">+</span>&nbsp;<span class="ident" id="2798104">name</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2798110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2798113">buf</span><span class="op" id="2798116">,</span>&nbsp;<span class="ident" id="2798118">err</span>&nbsp;<span class="op" id="2798122">:=</span>&nbsp;<span class="ident" id="2798125">readFile</span><span class="op" id="2798133">(</span><span class="ident" id="2798134">name</span><span class="op" id="2798138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798141">if</span>&nbsp;<span class="ident" id="2798144">err</span>&nbsp;<span class="op" id="2798148">!=</span>&nbsp;<span class="ident" id="2798151">nil</span>&nbsp;<span class="op" id="2798155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798159">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2798167">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798170">return</span>&nbsp;<span class="ident" id="2798177">loadZoneData</span><span class="op" id="2798189">(</span><span class="ident" id="2798190">buf</span><span class="op" id="2798193">)</span><br>
<span class="lineno"></span><span class="op" id="2798195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2798198">//&nbsp;There&nbsp;are&nbsp;500+&nbsp;zoneinfo&nbsp;files.&nbsp;&nbsp;Rather&nbsp;than&nbsp;distribute&nbsp;them&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2798265">//&nbsp;individually,&nbsp;we&nbsp;ship&nbsp;them&nbsp;in&nbsp;an&nbsp;uncompressed&nbsp;zip&nbsp;file.</span><br>
<span class="lineno">215</span><span class="comment" id="2798324">//&nbsp;Used&nbsp;this&nbsp;way,&nbsp;the&nbsp;zip&nbsp;file&nbsp;format&nbsp;serves&nbsp;as&nbsp;a&nbsp;commonly&nbsp;readable</span><br>
<span class="lineno"></span><span class="comment" id="2798392">//&nbsp;container&nbsp;for&nbsp;the&nbsp;individual&nbsp;small&nbsp;files.&nbsp;&nbsp;We&nbsp;choose&nbsp;zip&nbsp;over&nbsp;tar</span><br>
<span class="lineno"></span><span class="comment" id="2798461">//&nbsp;because&nbsp;zip&nbsp;files&nbsp;have&nbsp;a&nbsp;contiguous&nbsp;table&nbsp;of&nbsp;contents,&nbsp;making</span><br>
<span class="lineno"></span><span class="comment" id="2798526">//&nbsp;individual&nbsp;file&nbsp;lookups&nbsp;faster,&nbsp;and&nbsp;because&nbsp;the&nbsp;per-file&nbsp;overhead</span><br>
<span class="lineno"></span><span class="comment" id="2798595">//&nbsp;in&nbsp;a&nbsp;zip&nbsp;file&nbsp;is&nbsp;considerably&nbsp;less&nbsp;than&nbsp;tar&#39;s&nbsp;512&nbsp;bytes.</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2798656">//&nbsp;get4&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;32-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="2798709">func</span>&nbsp;<span class="ident" id="2798714">get4</span><span class="op" id="2798718">(</span><span class="ident" id="2798719">b</span>&nbsp;<span class="op" id="2798721">[</span><span class="op" id="2798722">]</span><span class="builtintype" id="2798723">byte</span><span class="op" id="2798727">)</span>&nbsp;<span class="builtintype" id="2798729">int</span>&nbsp;<span class="op" id="2798733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798736">if</span>&nbsp;<span class="builtinfunc" id="2798739">len</span><span class="op" id="2798742">(</span><span class="ident" id="2798743">b</span><span class="op" id="2798744">)</span>&nbsp;<span class="op" id="2798746">&lt;</span>&nbsp;<span class="num" id="2798748">4</span>&nbsp;<span class="op" id="2798750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798754">return</span>&nbsp;<span class="num" id="2798761">0</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2798764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798767">return</span>&nbsp;<span class="builtintype" id="2798774">int</span><span class="op" id="2798777">(</span><span class="ident" id="2798778">b</span><span class="op" id="2798779">[</span><span class="num" id="2798780">0</span><span class="op" id="2798781">]</span><span class="op" id="2798782">)</span>&nbsp;<span class="op" id="2798784">|</span>&nbsp;<span class="builtintype" id="2798786">int</span><span class="op" id="2798789">(</span><span class="ident" id="2798790">b</span><span class="op" id="2798791">[</span><span class="num" id="2798792">1</span><span class="op" id="2798793">]</span><span class="op" id="2798794">)</span><span class="op" id="2798795">&lt;&lt;</span><span class="num" id="2798797">8</span>&nbsp;<span class="op" id="2798799">|</span>&nbsp;<span class="builtintype" id="2798801">int</span><span class="op" id="2798804">(</span><span class="ident" id="2798805">b</span><span class="op" id="2798806">[</span><span class="num" id="2798807">2</span><span class="op" id="2798808">]</span><span class="op" id="2798809">)</span><span class="op" id="2798810">&lt;&lt;</span><span class="num" id="2798812">16</span>&nbsp;<span class="op" id="2798815">|</span>&nbsp;<span class="builtintype" id="2798817">int</span><span class="op" id="2798820">(</span><span class="ident" id="2798821">b</span><span class="op" id="2798822">[</span><span class="num" id="2798823">3</span><span class="op" id="2798824">]</span><span class="op" id="2798825">)</span><span class="op" id="2798826">&lt;&lt;</span><span class="num" id="2798828">24</span><br>
<span class="lineno"></span><span class="op" id="2798831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2798834">//&nbsp;get2&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;16-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno">230</span><span class="keyword" id="2798887">func</span>&nbsp;<span class="ident" id="2798892">get2</span><span class="op" id="2798896">(</span><span class="ident" id="2798897">b</span>&nbsp;<span class="op" id="2798899">[</span><span class="op" id="2798900">]</span><span class="builtintype" id="2798901">byte</span><span class="op" id="2798905">)</span>&nbsp;<span class="builtintype" id="2798907">int</span>&nbsp;<span class="op" id="2798911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798914">if</span>&nbsp;<span class="builtinfunc" id="2798917">len</span><span class="op" id="2798920">(</span><span class="ident" id="2798921">b</span><span class="op" id="2798922">)</span>&nbsp;<span class="op" id="2798924">&lt;</span>&nbsp;<span class="num" id="2798926">2</span>&nbsp;<span class="op" id="2798928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798932">return</span>&nbsp;<span class="num" id="2798939">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2798942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2798945">return</span>&nbsp;<span class="builtintype" id="2798952">int</span><span class="op" id="2798955">(</span><span class="ident" id="2798956">b</span><span class="op" id="2798957">[</span><span class="num" id="2798958">0</span><span class="op" id="2798959">]</span><span class="op" id="2798960">)</span>&nbsp;<span class="op" id="2798962">|</span>&nbsp;<span class="builtintype" id="2798964">int</span><span class="op" id="2798967">(</span><span class="ident" id="2798968">b</span><span class="op" id="2798969">[</span><span class="num" id="2798970">1</span><span class="op" id="2798971">]</span><span class="op" id="2798972">)</span><span class="op" id="2798973">&lt;&lt;</span><span class="num" id="2798975">8</span><br>
<span class="lineno">235</span><span class="op" id="2798977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2798980">func</span>&nbsp;<span class="ident" id="2798985">loadZoneZip</span><span class="op" id="2798996">(</span><span class="ident" id="2798997">zipfile</span><span class="op" id="2799004">,</span>&nbsp;<span class="ident" id="2799006">name</span>&nbsp;<span class="builtintype" id="2799011">string</span><span class="op" id="2799017">)</span>&nbsp;<span class="op" id="2799019">(</span><span class="ident" id="2799020">l</span>&nbsp;<span class="op" id="2799022">*</span><span class="ident" id="2799023">Location</span><span class="op" id="2799031">,</span>&nbsp;<span class="ident" id="2799033">err</span>&nbsp;<span class="builtintype" id="2799037">error</span><span class="op" id="2799042">)</span>&nbsp;<span class="op" id="2799044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799047">fd</span><span class="op" id="2799049">,</span>&nbsp;<span class="ident" id="2799051">err</span>&nbsp;<span class="op" id="2799055">:=</span>&nbsp;<span class="ident" id="2799058">open</span><span class="op" id="2799062">(</span><span class="ident" id="2799063">zipfile</span><span class="op" id="2799070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799073">if</span>&nbsp;<span class="ident" id="2799076">err</span>&nbsp;<span class="op" id="2799080">!=</span>&nbsp;<span class="ident" id="2799083">nil</span>&nbsp;<span class="op" id="2799087">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799091">return</span>&nbsp;<span class="ident" id="2799098">nil</span><span class="op" id="2799101">,</span>&nbsp;<span class="ident" id="2799103">errors</span><span class="op" id="2799109">.</span><span class="ident" id="2799110">New</span><span class="op" id="2799113">(</span><span class="string" id="2799114">&#34;open&nbsp;&#34;</span>&nbsp;<span class="op" id="2799122">+</span>&nbsp;<span class="ident" id="2799124">zipfile</span>&nbsp;<span class="op" id="2799132">+</span>&nbsp;<span class="string" id="2799134">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2799139">+</span>&nbsp;<span class="ident" id="2799141">err</span><span class="op" id="2799144">.</span><span class="ident" id="2799145">Error</span><span class="op" id="2799150">(</span><span class="op" id="2799151">)</span><span class="op" id="2799152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2799155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799158">defer</span>&nbsp;<span class="ident" id="2799164">closefd</span><span class="op" id="2799171">(</span><span class="ident" id="2799172">fd</span><span class="op" id="2799174">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799178">const</span>&nbsp;<span class="op" id="2799184">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799188">zecheader</span>&nbsp;<span class="op" id="2799198">=</span>&nbsp;<span class="num" id="2799200">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799213">zcheader</span>&nbsp;&nbsp;<span class="op" id="2799223">=</span>&nbsp;<span class="num" id="2799225">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799238">ztailsize</span>&nbsp;<span class="op" id="2799248">=</span>&nbsp;<span class="num" id="2799250">22</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799256">zheadersize</span>&nbsp;<span class="op" id="2799268">=</span>&nbsp;<span class="num" id="2799270">30</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799275">zheader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799287">=</span>&nbsp;<span class="num" id="2799289">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2799301">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799305">buf</span>&nbsp;<span class="op" id="2799309">:=</span>&nbsp;<span class="builtinfunc" id="2799312">make</span><span class="op" id="2799316">(</span><span class="op" id="2799317">[</span><span class="op" id="2799318">]</span><span class="builtintype" id="2799319">byte</span><span class="op" id="2799323">,</span>&nbsp;<span class="ident" id="2799325">ztailsize</span><span class="op" id="2799334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799337">if</span>&nbsp;<span class="ident" id="2799340">err</span>&nbsp;<span class="op" id="2799344">:=</span>&nbsp;<span class="ident" id="2799347">preadn</span><span class="op" id="2799353">(</span><span class="ident" id="2799354">fd</span><span class="op" id="2799356">,</span>&nbsp;<span class="ident" id="2799358">buf</span><span class="op" id="2799361">,</span>&nbsp;<span class="op" id="2799363">-</span><span class="ident" id="2799364">ztailsize</span><span class="op" id="2799373">)</span><span class="op" id="2799374">;</span>&nbsp;<span class="ident" id="2799376">err</span>&nbsp;<span class="op" id="2799380">!=</span>&nbsp;<span class="ident" id="2799383">nil</span>&nbsp;<span class="op" id="2799387">||</span>&nbsp;<span class="ident" id="2799390">get4</span><span class="op" id="2799394">(</span><span class="ident" id="2799395">buf</span><span class="op" id="2799398">)</span>&nbsp;<span class="op" id="2799400">!=</span>&nbsp;<span class="ident" id="2799403">zecheader</span>&nbsp;<span class="op" id="2799413">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799417">return</span>&nbsp;<span class="ident" id="2799424">nil</span><span class="op" id="2799427">,</span>&nbsp;<span class="ident" id="2799429">errors</span><span class="op" id="2799435">.</span><span class="ident" id="2799436">New</span><span class="op" id="2799439">(</span><span class="string" id="2799440">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2799460">+</span>&nbsp;<span class="ident" id="2799462">zipfile</span><span class="op" id="2799469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2799472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799475">n</span>&nbsp;<span class="op" id="2799477">:=</span>&nbsp;<span class="ident" id="2799480">get2</span><span class="op" id="2799484">(</span><span class="ident" id="2799485">buf</span><span class="op" id="2799488">[</span><span class="num" id="2799489">10</span><span class="op" id="2799491">:</span><span class="op" id="2799492">]</span><span class="op" id="2799493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799496">size</span>&nbsp;<span class="op" id="2799501">:=</span>&nbsp;<span class="ident" id="2799504">get4</span><span class="op" id="2799508">(</span><span class="ident" id="2799509">buf</span><span class="op" id="2799512">[</span><span class="num" id="2799513">12</span><span class="op" id="2799515">:</span><span class="op" id="2799516">]</span><span class="op" id="2799517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799520">off</span>&nbsp;<span class="op" id="2799524">:=</span>&nbsp;<span class="ident" id="2799527">get4</span><span class="op" id="2799531">(</span><span class="ident" id="2799532">buf</span><span class="op" id="2799535">[</span><span class="num" id="2799536">16</span><span class="op" id="2799538">:</span><span class="op" id="2799539">]</span><span class="op" id="2799540">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799544">buf</span>&nbsp;<span class="op" id="2799548">=</span>&nbsp;<span class="builtinfunc" id="2799550">make</span><span class="op" id="2799554">(</span><span class="op" id="2799555">[</span><span class="op" id="2799556">]</span><span class="builtintype" id="2799557">byte</span><span class="op" id="2799561">,</span>&nbsp;<span class="ident" id="2799563">size</span><span class="op" id="2799567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799570">if</span>&nbsp;<span class="ident" id="2799573">err</span>&nbsp;<span class="op" id="2799577">:=</span>&nbsp;<span class="ident" id="2799580">preadn</span><span class="op" id="2799586">(</span><span class="ident" id="2799587">fd</span><span class="op" id="2799589">,</span>&nbsp;<span class="ident" id="2799591">buf</span><span class="op" id="2799594">,</span>&nbsp;<span class="ident" id="2799596">off</span><span class="op" id="2799599">)</span><span class="op" id="2799600">;</span>&nbsp;<span class="ident" id="2799602">err</span>&nbsp;<span class="op" id="2799606">!=</span>&nbsp;<span class="ident" id="2799609">nil</span>&nbsp;<span class="op" id="2799613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799617">return</span>&nbsp;<span class="ident" id="2799624">nil</span><span class="op" id="2799627">,</span>&nbsp;<span class="ident" id="2799629">errors</span><span class="op" id="2799635">.</span><span class="ident" id="2799636">New</span><span class="op" id="2799639">(</span><span class="string" id="2799640">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2799660">+</span>&nbsp;<span class="ident" id="2799662">zipfile</span><span class="op" id="2799669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2799672">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799676">for</span>&nbsp;<span class="ident" id="2799680">i</span>&nbsp;<span class="op" id="2799682">:=</span>&nbsp;<span class="num" id="2799685">0</span><span class="op" id="2799686">;</span>&nbsp;<span class="ident" id="2799688">i</span>&nbsp;<span class="op" id="2799690">&lt;</span>&nbsp;<span class="ident" id="2799692">n</span><span class="op" id="2799693">;</span>&nbsp;<span class="ident" id="2799695">i</span><span class="op" id="2799696">++</span>&nbsp;<span class="op" id="2799699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799703">//&nbsp;zip&nbsp;entry&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799726">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799742">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspmadevers[1]</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799761">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspmadeos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799778">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799796">//&nbsp;&nbsp;&nbsp;&nbsp7&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799812">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799828">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799844">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799863">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799882">//&nbsp;&nbsp;&nbsp;&nbsp16&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799897">//&nbsp;&nbsp;&nbsp;&nbsp20&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799914">//&nbsp;&nbsp;&nbsp;&nbsp24&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799933">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799952">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799968">//&nbsp;&nbsp;&nbsp;&nbsp32&nbsp;&nbsp;&nbsp;&nbspfclen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2799985">//&nbsp;&nbsp;&nbsp;&nbsp34&nbsp;&nbsp;&nbsp;&nbspdisknum[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800004">//&nbsp;&nbsp;&nbsp;&nbsp36&nbsp;&nbsp;&nbsp;&nbspiattr[2]</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800021">//&nbsp;&nbsp;&nbsp;&nbsp38&nbsp;&nbsp;&nbsp;&nbspeattr[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800038">//&nbsp;&nbsp;&nbsp;&nbsp42&nbsp;&nbsp;&nbsp;&nbspoff[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800053">//&nbsp;&nbsp;&nbsp;&nbsp46&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800075">//&nbsp;&nbsp;&nbsp;&nbsp46+namelen+xlen+fclen&nbsp;-&nbsp;next&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800116">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800121">if</span>&nbsp;<span class="ident" id="2800124">get4</span><span class="op" id="2800128">(</span><span class="ident" id="2800129">buf</span><span class="op" id="2800132">)</span>&nbsp;<span class="op" id="2800134">!=</span>&nbsp;<span class="ident" id="2800137">zcheader</span>&nbsp;<span class="op" id="2800146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800151">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800163">meth</span>&nbsp;<span class="op" id="2800168">:=</span>&nbsp;<span class="ident" id="2800171">get2</span><span class="op" id="2800175">(</span><span class="ident" id="2800176">buf</span><span class="op" id="2800179">[</span><span class="num" id="2800180">10</span><span class="op" id="2800182">:</span><span class="op" id="2800183">]</span><span class="op" id="2800184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800188">size</span>&nbsp;<span class="op" id="2800193">:=</span>&nbsp;<span class="ident" id="2800196">get4</span><span class="op" id="2800200">(</span><span class="ident" id="2800201">buf</span><span class="op" id="2800204">[</span><span class="num" id="2800205">24</span><span class="op" id="2800207">:</span><span class="op" id="2800208">]</span><span class="op" id="2800209">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800213">namelen</span>&nbsp;<span class="op" id="2800221">:=</span>&nbsp;<span class="ident" id="2800224">get2</span><span class="op" id="2800228">(</span><span class="ident" id="2800229">buf</span><span class="op" id="2800232">[</span><span class="num" id="2800233">28</span><span class="op" id="2800235">:</span><span class="op" id="2800236">]</span><span class="op" id="2800237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800241">xlen</span>&nbsp;<span class="op" id="2800246">:=</span>&nbsp;<span class="ident" id="2800249">get2</span><span class="op" id="2800253">(</span><span class="ident" id="2800254">buf</span><span class="op" id="2800257">[</span><span class="num" id="2800258">30</span><span class="op" id="2800260">:</span><span class="op" id="2800261">]</span><span class="op" id="2800262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800266">fclen</span>&nbsp;<span class="op" id="2800272">:=</span>&nbsp;<span class="ident" id="2800275">get2</span><span class="op" id="2800279">(</span><span class="ident" id="2800280">buf</span><span class="op" id="2800283">[</span><span class="num" id="2800284">32</span><span class="op" id="2800286">:</span><span class="op" id="2800287">]</span><span class="op" id="2800288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800292">off</span>&nbsp;<span class="op" id="2800296">:=</span>&nbsp;<span class="ident" id="2800299">get4</span><span class="op" id="2800303">(</span><span class="ident" id="2800304">buf</span><span class="op" id="2800307">[</span><span class="num" id="2800308">42</span><span class="op" id="2800310">:</span><span class="op" id="2800311">]</span><span class="op" id="2800312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800316">zname</span>&nbsp;<span class="op" id="2800322">:=</span>&nbsp;<span class="ident" id="2800325">buf</span><span class="op" id="2800328">[</span><span class="num" id="2800329">46</span>&nbsp;<span class="op" id="2800332">:</span>&nbsp;<span class="num" id="2800334">46</span><span class="op" id="2800336">+</span><span class="ident" id="2800337">namelen</span><span class="op" id="2800344">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800348">buf</span>&nbsp;<span class="op" id="2800352">=</span>&nbsp;<span class="ident" id="2800354">buf</span><span class="op" id="2800357">[</span><span class="num" id="2800358">46</span><span class="op" id="2800360">+</span><span class="ident" id="2800361">namelen</span><span class="op" id="2800368">+</span><span class="ident" id="2800369">xlen</span><span class="op" id="2800373">+</span><span class="ident" id="2800374">fclen</span><span class="op" id="2800379">:</span><span class="op" id="2800380">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800384">if</span>&nbsp;<span class="builtintype" id="2800387">string</span><span class="op" id="2800393">(</span><span class="ident" id="2800394">zname</span><span class="op" id="2800399">)</span>&nbsp;<span class="op" id="2800401">!=</span>&nbsp;<span class="ident" id="2800404">name</span>&nbsp;<span class="op" id="2800409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800414">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800429">if</span>&nbsp;<span class="ident" id="2800432">meth</span>&nbsp;<span class="op" id="2800437">!=</span>&nbsp;<span class="num" id="2800440">0</span>&nbsp;<span class="op" id="2800442">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800447">return</span>&nbsp;<span class="ident" id="2800454">nil</span><span class="op" id="2800457">,</span>&nbsp;<span class="ident" id="2800459">errors</span><span class="op" id="2800465">.</span><span class="ident" id="2800466">New</span><span class="op" id="2800469">(</span><span class="string" id="2800470">&#34;unsupported&nbsp;compression&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2800501">+</span>&nbsp;<span class="ident" id="2800503">name</span>&nbsp;<span class="op" id="2800508">+</span>&nbsp;<span class="string" id="2800510">&#34;&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="2800517">+</span>&nbsp;<span class="ident" id="2800519">zipfile</span><span class="op" id="2800526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800535">//&nbsp;zip&nbsp;per-file&nbsp;header&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800568">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800584">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800602">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800618">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800634">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800649">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800668">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800687">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800702">//&nbsp;&nbsp;&nbsp;&nbsp18&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800719">//&nbsp;&nbsp;&nbsp;&nbsp22&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800738">//&nbsp;&nbsp;&nbsp;&nbsp26&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800757">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800773">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800795">//&nbsp;&nbsp;&nbsp;&nbsp30+namelen+xlen&nbsp;-&nbsp;file&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800828">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800833">buf</span>&nbsp;<span class="op" id="2800837">=</span>&nbsp;<span class="builtinfunc" id="2800839">make</span><span class="op" id="2800843">(</span><span class="op" id="2800844">[</span><span class="op" id="2800845">]</span><span class="builtintype" id="2800846">byte</span><span class="op" id="2800850">,</span>&nbsp;<span class="ident" id="2800852">zheadersize</span><span class="op" id="2800863">+</span><span class="ident" id="2800864">namelen</span><span class="op" id="2800871">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800875">if</span>&nbsp;<span class="ident" id="2800878">err</span>&nbsp;<span class="op" id="2800882">:=</span>&nbsp;<span class="ident" id="2800885">preadn</span><span class="op" id="2800891">(</span><span class="ident" id="2800892">fd</span><span class="op" id="2800894">,</span>&nbsp;<span class="ident" id="2800896">buf</span><span class="op" id="2800899">,</span>&nbsp;<span class="ident" id="2800901">off</span><span class="op" id="2800904">)</span><span class="op" id="2800905">;</span>&nbsp;<span class="ident" id="2800907">err</span>&nbsp;<span class="op" id="2800911">!=</span>&nbsp;<span class="ident" id="2800914">nil</span>&nbsp;<span class="op" id="2800918">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800924">get4</span><span class="op" id="2800928">(</span><span class="ident" id="2800929">buf</span><span class="op" id="2800932">)</span>&nbsp;<span class="op" id="2800934">!=</span>&nbsp;<span class="ident" id="2800937">zheader</span>&nbsp;<span class="op" id="2800945">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800951">get2</span><span class="op" id="2800955">(</span><span class="ident" id="2800956">buf</span><span class="op" id="2800959">[</span><span class="num" id="2800960">8</span><span class="op" id="2800961">:</span><span class="op" id="2800962">]</span><span class="op" id="2800963">)</span>&nbsp;<span class="op" id="2800965">!=</span>&nbsp;<span class="ident" id="2800968">meth</span>&nbsp;<span class="op" id="2800973">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800979">get2</span><span class="op" id="2800983">(</span><span class="ident" id="2800984">buf</span><span class="op" id="2800987">[</span><span class="num" id="2800988">26</span><span class="op" id="2800990">:</span><span class="op" id="2800991">]</span><span class="op" id="2800992">)</span>&nbsp;<span class="op" id="2800994">!=</span>&nbsp;<span class="ident" id="2800997">namelen</span>&nbsp;<span class="op" id="2801005">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2801011">string</span><span class="op" id="2801017">(</span><span class="ident" id="2801018">buf</span><span class="op" id="2801021">[</span><span class="num" id="2801022">30</span><span class="op" id="2801024">:</span><span class="num" id="2801025">30</span><span class="op" id="2801027">+</span><span class="ident" id="2801028">namelen</span><span class="op" id="2801035">]</span><span class="op" id="2801036">)</span>&nbsp;<span class="op" id="2801038">!=</span>&nbsp;<span class="ident" id="2801041">name</span>&nbsp;<span class="op" id="2801046">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801051">return</span>&nbsp;<span class="ident" id="2801058">nil</span><span class="op" id="2801061">,</span>&nbsp;<span class="ident" id="2801063">errors</span><span class="op" id="2801069">.</span><span class="ident" id="2801070">New</span><span class="op" id="2801073">(</span><span class="string" id="2801074">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2801094">+</span>&nbsp;<span class="ident" id="2801096">zipfile</span><span class="op" id="2801103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2801107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801111">xlen</span>&nbsp;<span class="op" id="2801116">=</span>&nbsp;<span class="ident" id="2801118">get2</span><span class="op" id="2801122">(</span><span class="ident" id="2801123">buf</span><span class="op" id="2801126">[</span><span class="num" id="2801127">28</span><span class="op" id="2801129">:</span><span class="op" id="2801130">]</span><span class="op" id="2801131">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801136">buf</span>&nbsp;<span class="op" id="2801140">=</span>&nbsp;<span class="builtinfunc" id="2801142">make</span><span class="op" id="2801146">(</span><span class="op" id="2801147">[</span><span class="op" id="2801148">]</span><span class="builtintype" id="2801149">byte</span><span class="op" id="2801153">,</span>&nbsp;<span class="ident" id="2801155">size</span><span class="op" id="2801159">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801163">if</span>&nbsp;<span class="ident" id="2801166">err</span>&nbsp;<span class="op" id="2801170">:=</span>&nbsp;<span class="ident" id="2801173">preadn</span><span class="op" id="2801179">(</span><span class="ident" id="2801180">fd</span><span class="op" id="2801182">,</span>&nbsp;<span class="ident" id="2801184">buf</span><span class="op" id="2801187">,</span>&nbsp;<span class="ident" id="2801189">off</span><span class="op" id="2801192">+</span><span class="num" id="2801193">30</span><span class="op" id="2801195">+</span><span class="ident" id="2801196">namelen</span><span class="op" id="2801203">+</span><span class="ident" id="2801204">xlen</span><span class="op" id="2801208">)</span><span class="op" id="2801209">;</span>&nbsp;<span class="ident" id="2801211">err</span>&nbsp;<span class="op" id="2801215">!=</span>&nbsp;<span class="ident" id="2801218">nil</span>&nbsp;<span class="op" id="2801222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801227">return</span>&nbsp;<span class="ident" id="2801234">nil</span><span class="op" id="2801237">,</span>&nbsp;<span class="ident" id="2801239">errors</span><span class="op" id="2801245">.</span><span class="ident" id="2801246">New</span><span class="op" id="2801249">(</span><span class="string" id="2801250">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2801270">+</span>&nbsp;<span class="ident" id="2801272">zipfile</span><span class="op" id="2801279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2801283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801288">return</span>&nbsp;<span class="ident" id="2801295">loadZoneData</span><span class="op" id="2801307">(</span><span class="ident" id="2801308">buf</span><span class="op" id="2801311">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2801314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2801318">return</span>&nbsp;<span class="ident" id="2801325">nil</span><span class="op" id="2801328">,</span>&nbsp;<span class="ident" id="2801330">errors</span><span class="op" id="2801336">.</span><span class="ident" id="2801337">New</span><span class="op" id="2801340">(</span><span class="string" id="2801341">&#34;cannot&nbsp;find&nbsp;&#34;</span>&nbsp;<span class="op" id="2801356">+</span>&nbsp;<span class="ident" id="2801358">name</span>&nbsp;<span class="op" id="2801363">+</span>&nbsp;<span class="string" id="2801365">&#34;&nbsp;in&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2801381">+</span>&nbsp;<span class="ident" id="2801383">zipfile</span><span class="op" id="2801390">)</span><br>
<span class="lineno"></span><span class="op" id="2801392">}</span>
</div>
</body>
</html>
