<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/dsa</h2>
<ul>
<li><a href="/gostd/crypto/dsa/dsa.go.html">dsa.go</a></li>
<li><a href="/gostd/crypto/dsa/dsa_test.go.html" class="current">dsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7177532">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7177587">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7177641">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7177692">package</span>&nbsp;<span class="ident" id="7177700">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7177705">import</span>&nbsp;<span class="op" id="7177712">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7177715">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7177730">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7177742">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7177752">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7177755">func</span>&nbsp;<span class="ident" id="7177760">testSignAndVerify</span><span class="op" id="7177777">(</span><span class="ident" id="7177778">t</span>&nbsp;<span class="op" id="7177780">*</span><span class="ident" id="7177781">testing</span><span class="op" id="7177788">.</span><span class="ident" id="7177789">T</span><span class="op" id="7177790">,</span>&nbsp;<span class="ident" id="7177792">i</span>&nbsp;<span class="builtintype" id="7177794">int</span><span class="op" id="7177797">,</span>&nbsp;<span class="ident" id="7177799">priv</span>&nbsp;<span class="op" id="7177804">*</span><span class="ident" id="7177805">PrivateKey</span><span class="op" id="7177815">)</span>&nbsp;<span class="op" id="7177817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7177820">hashed</span>&nbsp;<span class="op" id="7177827">:=</span>&nbsp;<span class="op" id="7177830">[</span><span class="op" id="7177831">]</span><span class="builtintype" id="7177832">byte</span><span class="op" id="7177836">(</span><span class="string" id="7177837">&#34;testing&#34;</span><span class="op" id="7177846">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7177849">r</span><span class="op" id="7177850">,</span>&nbsp;<span class="ident" id="7177852">s</span><span class="op" id="7177853">,</span>&nbsp;<span class="ident" id="7177855">err</span>&nbsp;<span class="op" id="7177859">:=</span>&nbsp;<span class="ident" id="7177862">Sign</span><span class="op" id="7177866">(</span><span class="ident" id="7177867">rand</span><span class="op" id="7177871">.</span><span class="ident" id="7177872">Reader</span><span class="op" id="7177878">,</span>&nbsp;<span class="ident" id="7177880">priv</span><span class="op" id="7177884">,</span>&nbsp;<span class="ident" id="7177886">hashed</span><span class="op" id="7177892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7177895">if</span>&nbsp;<span class="ident" id="7177898">err</span>&nbsp;<span class="op" id="7177902">!=</span>&nbsp;<span class="builtintype" id="7177905">nil</span>&nbsp;<span class="op" id="7177909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7177913">t</span><span class="op" id="7177914">.</span><span class="ident" id="7177915">Errorf</span><span class="op" id="7177921">(</span><span class="string" id="7177922">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7177945">,</span>&nbsp;<span class="ident" id="7177947">i</span><span class="op" id="7177948">,</span>&nbsp;<span class="ident" id="7177950">err</span><span class="op" id="7177953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7177957">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7177965">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7177969">if</span>&nbsp;<span class="op" id="7177972">!</span><span class="ident" id="7177973">Verify</span><span class="op" id="7177979">(</span><span class="op" id="7177980">&amp;</span><span class="ident" id="7177981">priv</span><span class="op" id="7177985">.</span><span class="ident" id="7177986">PublicKey</span><span class="op" id="7177995">,</span>&nbsp;<span class="ident" id="7177997">hashed</span><span class="op" id="7178003">,</span>&nbsp;<span class="ident" id="7178005">r</span><span class="op" id="7178006">,</span>&nbsp;<span class="ident" id="7178008">s</span><span class="op" id="7178009">)</span>&nbsp;<span class="op" id="7178011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178015">t</span><span class="op" id="7178016">.</span><span class="ident" id="7178017">Errorf</span><span class="op" id="7178023">(</span><span class="string" id="7178024">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7178043">,</span>&nbsp;<span class="ident" id="7178045">i</span><span class="op" id="7178046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7178049">}</span><br>
<span class="lineno"></span><span class="op" id="7178051">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="7178054">func</span>&nbsp;<span class="ident" id="7178059">testParameterGeneration</span><span class="op" id="7178082">(</span><span class="ident" id="7178083">t</span>&nbsp;<span class="op" id="7178085">*</span><span class="ident" id="7178086">testing</span><span class="op" id="7178093">.</span><span class="ident" id="7178094">T</span><span class="op" id="7178095">,</span>&nbsp;<span class="ident" id="7178097">sizes</span>&nbsp;<span class="ident" id="7178103">ParameterSizes</span><span class="op" id="7178117">,</span>&nbsp;<span class="ident" id="7178119">L</span><span class="op" id="7178120">,</span>&nbsp;<span class="ident" id="7178122">N</span>&nbsp;<span class="builtintype" id="7178124">int</span><span class="op" id="7178127">)</span>&nbsp;<span class="op" id="7178129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7178132">var</span>&nbsp;<span class="ident" id="7178136">priv</span>&nbsp;<span class="ident" id="7178141">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178153">params</span>&nbsp;<span class="op" id="7178160">:=</span>&nbsp;<span class="op" id="7178163">&amp;</span><span class="ident" id="7178164">priv</span><span class="op" id="7178168">.</span><span class="ident" id="7178169">Parameters</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178182">err</span>&nbsp;<span class="op" id="7178186">:=</span>&nbsp;<span class="ident" id="7178189">GenerateParameters</span><span class="op" id="7178207">(</span><span class="ident" id="7178208">params</span><span class="op" id="7178214">,</span>&nbsp;<span class="ident" id="7178216">rand</span><span class="op" id="7178220">.</span><span class="ident" id="7178221">Reader</span><span class="op" id="7178227">,</span>&nbsp;<span class="ident" id="7178229">sizes</span><span class="op" id="7178234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7178237">if</span>&nbsp;<span class="ident" id="7178240">err</span>&nbsp;<span class="op" id="7178244">!=</span>&nbsp;<span class="builtintype" id="7178247">nil</span>&nbsp;<span class="op" id="7178251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178255">t</span><span class="op" id="7178256">.</span><span class="ident" id="7178257">Errorf</span><span class="op" id="7178263">(</span><span class="string" id="7178264">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="7178272">,</span>&nbsp;<span class="builtintype" id="7178274">int</span><span class="op" id="7178277">(</span><span class="ident" id="7178278">sizes</span><span class="op" id="7178283">)</span><span class="op" id="7178284">,</span>&nbsp;<span class="ident" id="7178286">err</span><span class="op" id="7178289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7178293">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7178301">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7178305">if</span>&nbsp;<span class="ident" id="7178308">params</span><span class="op" id="7178314">.</span><span class="ident" id="7178315">P</span><span class="op" id="7178316">.</span><span class="ident" id="7178317">BitLen</span><span class="op" id="7178323">(</span><span class="op" id="7178324">)</span>&nbsp;<span class="op" id="7178326">!=</span>&nbsp;<span class="ident" id="7178329">L</span>&nbsp;<span class="op" id="7178331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178335">t</span><span class="op" id="7178336">.</span><span class="ident" id="7178337">Errorf</span><span class="op" id="7178343">(</span><span class="string" id="7178344">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="7178378">,</span>&nbsp;<span class="builtintype" id="7178380">int</span><span class="op" id="7178383">(</span><span class="ident" id="7178384">sizes</span><span class="op" id="7178389">)</span><span class="op" id="7178390">,</span>&nbsp;<span class="ident" id="7178392">params</span><span class="op" id="7178398">.</span><span class="ident" id="7178399">P</span><span class="op" id="7178400">.</span><span class="ident" id="7178401">BitLen</span><span class="op" id="7178407">(</span><span class="op" id="7178408">)</span><span class="op" id="7178409">,</span>&nbsp;<span class="ident" id="7178411">L</span><span class="op" id="7178412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7178415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7178419">if</span>&nbsp;<span class="ident" id="7178422">params</span><span class="op" id="7178428">.</span><span class="ident" id="7178429">Q</span><span class="op" id="7178430">.</span><span class="ident" id="7178431">BitLen</span><span class="op" id="7178437">(</span><span class="op" id="7178438">)</span>&nbsp;<span class="op" id="7178440">!=</span>&nbsp;<span class="ident" id="7178443">N</span>&nbsp;<span class="op" id="7178445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178449">t</span><span class="op" id="7178450">.</span><span class="ident" id="7178451">Errorf</span><span class="op" id="7178457">(</span><span class="string" id="7178458">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="7178487">,</span>&nbsp;<span class="builtintype" id="7178489">int</span><span class="op" id="7178492">(</span><span class="ident" id="7178493">sizes</span><span class="op" id="7178498">)</span><span class="op" id="7178499">,</span>&nbsp;<span class="ident" id="7178501">params</span><span class="op" id="7178507">.</span><span class="ident" id="7178508">Q</span><span class="op" id="7178509">.</span><span class="ident" id="7178510">BitLen</span><span class="op" id="7178516">(</span><span class="op" id="7178517">)</span><span class="op" id="7178518">,</span>&nbsp;<span class="ident" id="7178520">L</span><span class="op" id="7178521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7178524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178528">one</span>&nbsp;<span class="op" id="7178532">:=</span>&nbsp;<span class="builtinfunc" id="7178535">new</span><span class="op" id="7178538">(</span><span class="ident" id="7178539">big</span><span class="op" id="7178542">.</span><span class="ident" id="7178543">Int</span><span class="op" id="7178546">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178549">one</span><span class="op" id="7178552">.</span><span class="ident" id="7178553">SetInt64</span><span class="op" id="7178561">(</span><span class="num" id="7178562">1</span><span class="op" id="7178563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178566">pm1</span>&nbsp;<span class="op" id="7178570">:=</span>&nbsp;<span class="builtinfunc" id="7178573">new</span><span class="op" id="7178576">(</span><span class="ident" id="7178577">big</span><span class="op" id="7178580">.</span><span class="ident" id="7178581">Int</span><span class="op" id="7178584">)</span><span class="op" id="7178585">.</span><span class="ident" id="7178586">Sub</span><span class="op" id="7178589">(</span><span class="ident" id="7178590">params</span><span class="op" id="7178596">.</span><span class="ident" id="7178597">P</span><span class="op" id="7178598">,</span>&nbsp;<span class="ident" id="7178600">one</span><span class="op" id="7178603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178606">quo</span><span class="op" id="7178609">,</span>&nbsp;<span class="ident" id="7178611">rem</span>&nbsp;<span class="op" id="7178615">:=</span>&nbsp;<span class="builtinfunc" id="7178618">new</span><span class="op" id="7178621">(</span><span class="ident" id="7178622">big</span><span class="op" id="7178625">.</span><span class="ident" id="7178626">Int</span><span class="op" id="7178629">)</span><span class="op" id="7178630">.</span><span class="ident" id="7178631">DivMod</span><span class="op" id="7178637">(</span><span class="ident" id="7178638">pm1</span><span class="op" id="7178641">,</span>&nbsp;<span class="ident" id="7178643">params</span><span class="op" id="7178649">.</span><span class="ident" id="7178650">Q</span><span class="op" id="7178651">,</span>&nbsp;<span class="builtinfunc" id="7178653">new</span><span class="op" id="7178656">(</span><span class="ident" id="7178657">big</span><span class="op" id="7178660">.</span><span class="ident" id="7178661">Int</span><span class="op" id="7178664">)</span><span class="op" id="7178665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7178668">if</span>&nbsp;<span class="ident" id="7178671">rem</span><span class="op" id="7178674">.</span><span class="ident" id="7178675">Sign</span><span class="op" id="7178679">(</span><span class="op" id="7178680">)</span>&nbsp;<span class="op" id="7178682">!=</span>&nbsp;<span class="num" id="7178685">0</span>&nbsp;<span class="op" id="7178687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178691">t</span><span class="op" id="7178692">.</span><span class="ident" id="7178693">Errorf</span><span class="op" id="7178699">(</span><span class="string" id="7178700">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="7178720">,</span>&nbsp;<span class="builtintype" id="7178722">int</span><span class="op" id="7178725">(</span><span class="ident" id="7178726">sizes</span><span class="op" id="7178731">)</span><span class="op" id="7178732">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7178735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178738">x</span>&nbsp;<span class="op" id="7178740">:=</span>&nbsp;<span class="builtinfunc" id="7178743">new</span><span class="op" id="7178746">(</span><span class="ident" id="7178747">big</span><span class="op" id="7178750">.</span><span class="ident" id="7178751">Int</span><span class="op" id="7178754">)</span><span class="op" id="7178755">.</span><span class="ident" id="7178756">Exp</span><span class="op" id="7178759">(</span><span class="ident" id="7178760">params</span><span class="op" id="7178766">.</span><span class="ident" id="7178767">G</span><span class="op" id="7178768">,</span>&nbsp;<span class="ident" id="7178770">quo</span><span class="op" id="7178773">,</span>&nbsp;<span class="ident" id="7178775">params</span><span class="op" id="7178781">.</span><span class="ident" id="7178782">P</span><span class="op" id="7178783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7178786">if</span>&nbsp;<span class="ident" id="7178789">x</span><span class="op" id="7178790">.</span><span class="ident" id="7178791">Cmp</span><span class="op" id="7178794">(</span><span class="ident" id="7178795">one</span><span class="op" id="7178798">)</span>&nbsp;<span class="op" id="7178800">==</span>&nbsp;<span class="num" id="7178803">0</span>&nbsp;<span class="op" id="7178805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178809">t</span><span class="op" id="7178810">.</span><span class="ident" id="7178811">Errorf</span><span class="op" id="7178817">(</span><span class="string" id="7178818">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="7178841">,</span>&nbsp;<span class="builtintype" id="7178843">int</span><span class="op" id="7178846">(</span><span class="ident" id="7178847">sizes</span><span class="op" id="7178852">)</span><span class="op" id="7178853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7178856">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178860">err</span>&nbsp;<span class="op" id="7178864">=</span>&nbsp;<span class="ident" id="7178866">GenerateKey</span><span class="op" id="7178877">(</span><span class="op" id="7178878">&amp;</span><span class="ident" id="7178879">priv</span><span class="op" id="7178883">,</span>&nbsp;<span class="ident" id="7178885">rand</span><span class="op" id="7178889">.</span><span class="ident" id="7178890">Reader</span><span class="op" id="7178896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7178899">if</span>&nbsp;<span class="ident" id="7178902">err</span>&nbsp;<span class="op" id="7178906">!=</span>&nbsp;<span class="builtintype" id="7178909">nil</span>&nbsp;<span class="op" id="7178913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178917">t</span><span class="op" id="7178918">.</span><span class="ident" id="7178919">Errorf</span><span class="op" id="7178925">(</span><span class="string" id="7178926">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7178952">,</span>&nbsp;<span class="ident" id="7178954">err</span><span class="op" id="7178957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7178961">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7178969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7178973">testSignAndVerify</span><span class="op" id="7178990">(</span><span class="ident" id="7178991">t</span><span class="op" id="7178992">,</span>&nbsp;<span class="builtintype" id="7178994">int</span><span class="op" id="7178997">(</span><span class="ident" id="7178998">sizes</span><span class="op" id="7179003">)</span><span class="op" id="7179004">,</span>&nbsp;<span class="op" id="7179006">&amp;</span><span class="ident" id="7179007">priv</span><span class="op" id="7179011">)</span><br>
<span class="lineno"></span><span class="op" id="7179013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7179016">func</span>&nbsp;<span class="ident" id="7179021">TestParameterGeneration</span><span class="op" id="7179044">(</span><span class="ident" id="7179045">t</span>&nbsp;<span class="op" id="7179047">*</span><span class="ident" id="7179048">testing</span><span class="op" id="7179055">.</span><span class="ident" id="7179056">T</span><span class="op" id="7179057">)</span>&nbsp;<span class="op" id="7179059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7179062">if</span>&nbsp;<span class="ident" id="7179065">testing</span><span class="op" id="7179072">.</span><span class="ident" id="7179073">Short</span><span class="op" id="7179078">(</span><span class="op" id="7179079">)</span>&nbsp;<span class="op" id="7179081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7179085">t</span><span class="op" id="7179086">.</span><span class="ident" id="7179087">Skip</span><span class="op" id="7179091">(</span><span class="string" id="7179092">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7179142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7179145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7179149">testParameterGeneration</span><span class="op" id="7179172">(</span><span class="ident" id="7179173">t</span><span class="op" id="7179174">,</span>&nbsp;<span class="ident" id="7179176">L1024N160</span><span class="op" id="7179185">,</span>&nbsp;<span class="num" id="7179187">1024</span><span class="op" id="7179191">,</span>&nbsp;<span class="num" id="7179193">160</span><span class="op" id="7179196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7179199">testParameterGeneration</span><span class="op" id="7179222">(</span><span class="ident" id="7179223">t</span><span class="op" id="7179224">,</span>&nbsp;<span class="ident" id="7179226">L2048N224</span><span class="op" id="7179235">,</span>&nbsp;<span class="num" id="7179237">2048</span><span class="op" id="7179241">,</span>&nbsp;<span class="num" id="7179243">224</span><span class="op" id="7179246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7179249">testParameterGeneration</span><span class="op" id="7179272">(</span><span class="ident" id="7179273">t</span><span class="op" id="7179274">,</span>&nbsp;<span class="ident" id="7179276">L2048N256</span><span class="op" id="7179285">,</span>&nbsp;<span class="num" id="7179287">2048</span><span class="op" id="7179291">,</span>&nbsp;<span class="num" id="7179293">256</span><span class="op" id="7179296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7179299">testParameterGeneration</span><span class="op" id="7179322">(</span><span class="ident" id="7179323">t</span><span class="op" id="7179324">,</span>&nbsp;<span class="ident" id="7179326">L3072N256</span><span class="op" id="7179335">,</span>&nbsp;<span class="num" id="7179337">3072</span><span class="op" id="7179341">,</span>&nbsp;<span class="num" id="7179343">256</span><span class="op" id="7179346">)</span><br>
<span class="lineno"></span><span class="op" id="7179348">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7179351">func</span>&nbsp;<span class="ident" id="7179356">TestSignAndVerify</span><span class="op" id="7179373">(</span><span class="ident" id="7179374">t</span>&nbsp;<span class="op" id="7179376">*</span><span class="ident" id="7179377">testing</span><span class="op" id="7179384">.</span><span class="ident" id="7179385">T</span><span class="op" id="7179386">)</span>&nbsp;<span class="op" id="7179388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7179391">var</span>&nbsp;<span class="ident" id="7179395">priv</span>&nbsp;<span class="ident" id="7179400">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7179412">priv</span><span class="op" id="7179416">.</span><span class="ident" id="7179417">P</span><span class="op" id="7179418">,</span>&nbsp;<span class="ident" id="7179420">_</span>&nbsp;<span class="op" id="7179422">=</span>&nbsp;<span class="builtinfunc" id="7179424">new</span><span class="op" id="7179427">(</span><span class="ident" id="7179428">big</span><span class="op" id="7179431">.</span><span class="ident" id="7179432">Int</span><span class="op" id="7179435">)</span><span class="op" id="7179436">.</span><span class="ident" id="7179437">SetString</span><span class="op" id="7179446">(</span><span class="string" id="7179447">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="7179705">,</span>&nbsp;<span class="num" id="7179707">16</span><span class="op" id="7179709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7179712">priv</span><span class="op" id="7179716">.</span><span class="ident" id="7179717">Q</span><span class="op" id="7179718">,</span>&nbsp;<span class="ident" id="7179720">_</span>&nbsp;<span class="op" id="7179722">=</span>&nbsp;<span class="builtinfunc" id="7179724">new</span><span class="op" id="7179727">(</span><span class="ident" id="7179728">big</span><span class="op" id="7179731">.</span><span class="ident" id="7179732">Int</span><span class="op" id="7179735">)</span><span class="op" id="7179736">.</span><span class="ident" id="7179737">SetString</span><span class="op" id="7179746">(</span><span class="string" id="7179747">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="7179789">,</span>&nbsp;<span class="num" id="7179791">16</span><span class="op" id="7179793">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7179796">priv</span><span class="op" id="7179800">.</span><span class="ident" id="7179801">G</span><span class="op" id="7179802">,</span>&nbsp;<span class="ident" id="7179804">_</span>&nbsp;<span class="op" id="7179806">=</span>&nbsp;<span class="builtinfunc" id="7179808">new</span><span class="op" id="7179811">(</span><span class="ident" id="7179812">big</span><span class="op" id="7179815">.</span><span class="ident" id="7179816">Int</span><span class="op" id="7179819">)</span><span class="op" id="7179820">.</span><span class="ident" id="7179821">SetString</span><span class="op" id="7179830">(</span><span class="string" id="7179831">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="7180089">,</span>&nbsp;<span class="num" id="7180091">16</span><span class="op" id="7180093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7180096">priv</span><span class="op" id="7180100">.</span><span class="ident" id="7180101">Y</span><span class="op" id="7180102">,</span>&nbsp;<span class="ident" id="7180104">_</span>&nbsp;<span class="op" id="7180106">=</span>&nbsp;<span class="builtinfunc" id="7180108">new</span><span class="op" id="7180111">(</span><span class="ident" id="7180112">big</span><span class="op" id="7180115">.</span><span class="ident" id="7180116">Int</span><span class="op" id="7180119">)</span><span class="op" id="7180120">.</span><span class="ident" id="7180121">SetString</span><span class="op" id="7180130">(</span><span class="string" id="7180131">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="7180389">,</span>&nbsp;<span class="num" id="7180391">16</span><span class="op" id="7180393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7180396">priv</span><span class="op" id="7180400">.</span><span class="ident" id="7180401">X</span><span class="op" id="7180402">,</span>&nbsp;<span class="ident" id="7180404">_</span>&nbsp;<span class="op" id="7180406">=</span>&nbsp;<span class="builtinfunc" id="7180408">new</span><span class="op" id="7180411">(</span><span class="ident" id="7180412">big</span><span class="op" id="7180415">.</span><span class="ident" id="7180416">Int</span><span class="op" id="7180419">)</span><span class="op" id="7180420">.</span><span class="ident" id="7180421">SetString</span><span class="op" id="7180430">(</span><span class="string" id="7180431">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="7180473">,</span>&nbsp;<span class="num" id="7180475">16</span><span class="op" id="7180477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7180481">testSignAndVerify</span><span class="op" id="7180498">(</span><span class="ident" id="7180499">t</span><span class="op" id="7180500">,</span>&nbsp;<span class="num" id="7180502">0</span><span class="op" id="7180503">,</span>&nbsp;<span class="op" id="7180505">&amp;</span><span class="ident" id="7180506">priv</span><span class="op" id="7180510">)</span><br>
<span class="lineno">85</span><span class="op" id="7180512">}</span>
</div>
</body>
</html>
