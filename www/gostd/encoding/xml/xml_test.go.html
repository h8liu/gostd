<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7737442">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7737498">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7737552">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7737603">package</span>&nbsp;<span class="ident" id="7737611">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7737616">import</span>&nbsp;<span class="op" id="7737623">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7737626">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7737635">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7737642">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7737648">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7737659">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7737670">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7737681">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7737696">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7737699">const</span>&nbsp;<span class="ident" id="7737705">testInput</span>&nbsp;<span class="op" id="7737715">=</span>&nbsp;<span class="string" id="7737717">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="7737934">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7737937">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="7737946">+</span>&nbsp;<span class="string" id="7737948">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7738238">var</span>&nbsp;<span class="ident" id="7738242">testEntity</span>&nbsp;<span class="op" id="7738253">=</span>&nbsp;<span class="keyword" id="7738255">map</span><span class="op" id="7738258">[</span><span class="builtintype" id="7738259">string</span><span class="op" id="7738265">]</span><span class="builtintype" id="7738266">string</span><span class="op" id="7738272">{</span><span class="string" id="7738273">&#34;何&#34;</span><span class="op" id="7738278">:</span>&nbsp;<span class="string" id="7738280">&#34;What&#34;</span><span class="op" id="7738286">,</span>&nbsp;<span class="string" id="7738288">&#34;is-it&#34;</span><span class="op" id="7738295">:</span>&nbsp;<span class="string" id="7738297">&#34;is&nbsp;it?&#34;</span><span class="op" id="7738305">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7738308">var</span>&nbsp;<span class="ident" id="7738312">rawTokens</span>&nbsp;<span class="op" id="7738322">=</span>&nbsp;<span class="op" id="7738324">[</span><span class="op" id="7738325">]</span><span class="ident" id="7738326">Token</span><span class="op" id="7738331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738334">CharData</span><span class="op" id="7738342">(</span><span class="string" id="7738343">&#34;\n&#34;</span><span class="op" id="7738347">)</span><span class="op" id="7738348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738351">ProcInst</span><span class="op" id="7738359">{</span><span class="string" id="7738360">&#34;xml&#34;</span><span class="op" id="7738365">,</span>&nbsp;<span class="op" id="7738367">[</span><span class="op" id="7738368">]</span><span class="builtintype" id="7738369">byte</span><span class="op" id="7738373">(</span><span class="string" id="7738374">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7738406">)</span><span class="op" id="7738407">}</span><span class="op" id="7738408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738411">CharData</span><span class="op" id="7738419">(</span><span class="string" id="7738420">&#34;\n&#34;</span><span class="op" id="7738424">)</span><span class="op" id="7738425">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738428">Directive</span><span class="op" id="7738437">(</span><span class="string" id="7738438">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7738560">)</span><span class="op" id="7738561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738564">CharData</span><span class="op" id="7738572">(</span><span class="string" id="7738573">&#34;\n&#34;</span><span class="op" id="7738577">)</span><span class="op" id="7738578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738581">StartElement</span><span class="op" id="7738593">{</span><span class="ident" id="7738594">Name</span><span class="op" id="7738598">{</span><span class="string" id="7738599">&#34;&#34;</span><span class="op" id="7738601">,</span>&nbsp;<span class="string" id="7738603">&#34;body&#34;</span><span class="op" id="7738609">}</span><span class="op" id="7738610">,</span>&nbsp;<span class="op" id="7738612">[</span><span class="op" id="7738613">]</span><span class="ident" id="7738614">Attr</span><span class="op" id="7738618">{</span><span class="op" id="7738619">{</span><span class="ident" id="7738620">Name</span><span class="op" id="7738624">{</span><span class="string" id="7738625">&#34;xmlns&#34;</span><span class="op" id="7738632">,</span>&nbsp;<span class="string" id="7738634">&#34;foo&#34;</span><span class="op" id="7738639">}</span><span class="op" id="7738640">,</span>&nbsp;<span class="string" id="7738642">&#34;ns1&#34;</span><span class="op" id="7738647">}</span><span class="op" id="7738648">,</span>&nbsp;<span class="op" id="7738650">{</span><span class="ident" id="7738651">Name</span><span class="op" id="7738655">{</span><span class="string" id="7738656">&#34;&#34;</span><span class="op" id="7738658">,</span>&nbsp;<span class="string" id="7738660">&#34;xmlns&#34;</span><span class="op" id="7738667">}</span><span class="op" id="7738668">,</span>&nbsp;<span class="string" id="7738670">&#34;ns2&#34;</span><span class="op" id="7738675">}</span><span class="op" id="7738676">,</span>&nbsp;<span class="op" id="7738678">{</span><span class="ident" id="7738679">Name</span><span class="op" id="7738683">{</span><span class="string" id="7738684">&#34;xmlns&#34;</span><span class="op" id="7738691">,</span>&nbsp;<span class="string" id="7738693">&#34;tag&#34;</span><span class="op" id="7738698">}</span><span class="op" id="7738699">,</span>&nbsp;<span class="string" id="7738701">&#34;ns3&#34;</span><span class="op" id="7738706">}</span><span class="op" id="7738707">}</span><span class="op" id="7738708">}</span><span class="op" id="7738709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738712">CharData</span><span class="op" id="7738720">(</span><span class="string" id="7738721">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7738727">)</span><span class="op" id="7738728">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738731">StartElement</span><span class="op" id="7738743">{</span><span class="ident" id="7738744">Name</span><span class="op" id="7738748">{</span><span class="string" id="7738749">&#34;&#34;</span><span class="op" id="7738751">,</span>&nbsp;<span class="string" id="7738753">&#34;hello&#34;</span><span class="op" id="7738760">}</span><span class="op" id="7738761">,</span>&nbsp;<span class="op" id="7738763">[</span><span class="op" id="7738764">]</span><span class="ident" id="7738765">Attr</span><span class="op" id="7738769">{</span><span class="op" id="7738770">{</span><span class="ident" id="7738771">Name</span><span class="op" id="7738775">{</span><span class="string" id="7738776">&#34;&#34;</span><span class="op" id="7738778">,</span>&nbsp;<span class="string" id="7738780">&#34;lang&#34;</span><span class="op" id="7738786">}</span><span class="op" id="7738787">,</span>&nbsp;<span class="string" id="7738789">&#34;en&#34;</span><span class="op" id="7738793">}</span><span class="op" id="7738794">}</span><span class="op" id="7738795">}</span><span class="op" id="7738796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738799">CharData</span><span class="op" id="7738807">(</span><span class="string" id="7738808">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7738831">)</span><span class="op" id="7738832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738835">EndElement</span><span class="op" id="7738845">{</span><span class="ident" id="7738846">Name</span><span class="op" id="7738850">{</span><span class="string" id="7738851">&#34;&#34;</span><span class="op" id="7738853">,</span>&nbsp;<span class="string" id="7738855">&#34;hello&#34;</span><span class="op" id="7738862">}</span><span class="op" id="7738863">}</span><span class="op" id="7738864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738867">CharData</span><span class="op" id="7738875">(</span><span class="string" id="7738876">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7738882">)</span><span class="op" id="7738883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738886">StartElement</span><span class="op" id="7738898">{</span><span class="ident" id="7738899">Name</span><span class="op" id="7738903">{</span><span class="string" id="7738904">&#34;&#34;</span><span class="op" id="7738906">,</span>&nbsp;<span class="string" id="7738908">&#34;query&#34;</span><span class="op" id="7738915">}</span><span class="op" id="7738916">,</span>&nbsp;<span class="op" id="7738918">[</span><span class="op" id="7738919">]</span><span class="ident" id="7738920">Attr</span><span class="op" id="7738924">{</span><span class="op" id="7738925">}</span><span class="op" id="7738926">}</span><span class="op" id="7738927">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738930">CharData</span><span class="op" id="7738938">(</span><span class="string" id="7738939">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7738952">)</span><span class="op" id="7738953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738956">EndElement</span><span class="op" id="7738966">{</span><span class="ident" id="7738967">Name</span><span class="op" id="7738971">{</span><span class="string" id="7738972">&#34;&#34;</span><span class="op" id="7738974">,</span>&nbsp;<span class="string" id="7738976">&#34;query&#34;</span><span class="op" id="7738983">}</span><span class="op" id="7738984">}</span><span class="op" id="7738985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7738988">CharData</span><span class="op" id="7738996">(</span><span class="string" id="7738997">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7739003">)</span><span class="op" id="7739004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739007">StartElement</span><span class="op" id="7739019">{</span><span class="ident" id="7739020">Name</span><span class="op" id="7739024">{</span><span class="string" id="7739025">&#34;&#34;</span><span class="op" id="7739027">,</span>&nbsp;<span class="string" id="7739029">&#34;goodbye&#34;</span><span class="op" id="7739038">}</span><span class="op" id="7739039">,</span>&nbsp;<span class="op" id="7739041">[</span><span class="op" id="7739042">]</span><span class="ident" id="7739043">Attr</span><span class="op" id="7739047">{</span><span class="op" id="7739048">}</span><span class="op" id="7739049">}</span><span class="op" id="7739050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739053">EndElement</span><span class="op" id="7739063">{</span><span class="ident" id="7739064">Name</span><span class="op" id="7739068">{</span><span class="string" id="7739069">&#34;&#34;</span><span class="op" id="7739071">,</span>&nbsp;<span class="string" id="7739073">&#34;goodbye&#34;</span><span class="op" id="7739082">}</span><span class="op" id="7739083">}</span><span class="op" id="7739084">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739087">CharData</span><span class="op" id="7739095">(</span><span class="string" id="7739096">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7739102">)</span><span class="op" id="7739103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739106">StartElement</span><span class="op" id="7739118">{</span><span class="ident" id="7739119">Name</span><span class="op" id="7739123">{</span><span class="string" id="7739124">&#34;&#34;</span><span class="op" id="7739126">,</span>&nbsp;<span class="string" id="7739128">&#34;outer&#34;</span><span class="op" id="7739135">}</span><span class="op" id="7739136">,</span>&nbsp;<span class="op" id="7739138">[</span><span class="op" id="7739139">]</span><span class="ident" id="7739140">Attr</span><span class="op" id="7739144">{</span><span class="op" id="7739145">{</span><span class="ident" id="7739146">Name</span><span class="op" id="7739150">{</span><span class="string" id="7739151">&#34;foo&#34;</span><span class="op" id="7739156">,</span>&nbsp;<span class="string" id="7739158">&#34;attr&#34;</span><span class="op" id="7739164">}</span><span class="op" id="7739165">,</span>&nbsp;<span class="string" id="7739167">&#34;value&#34;</span><span class="op" id="7739174">}</span><span class="op" id="7739175">,</span>&nbsp;<span class="op" id="7739177">{</span><span class="ident" id="7739178">Name</span><span class="op" id="7739182">{</span><span class="string" id="7739183">&#34;xmlns&#34;</span><span class="op" id="7739190">,</span>&nbsp;<span class="string" id="7739192">&#34;tag&#34;</span><span class="op" id="7739197">}</span><span class="op" id="7739198">,</span>&nbsp;<span class="string" id="7739200">&#34;ns4&#34;</span><span class="op" id="7739205">}</span><span class="op" id="7739206">}</span><span class="op" id="7739207">}</span><span class="op" id="7739208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739211">CharData</span><span class="op" id="7739219">(</span><span class="string" id="7739220">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7739228">)</span><span class="op" id="7739229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739232">StartElement</span><span class="op" id="7739244">{</span><span class="ident" id="7739245">Name</span><span class="op" id="7739249">{</span><span class="string" id="7739250">&#34;&#34;</span><span class="op" id="7739252">,</span>&nbsp;<span class="string" id="7739254">&#34;inner&#34;</span><span class="op" id="7739261">}</span><span class="op" id="7739262">,</span>&nbsp;<span class="op" id="7739264">[</span><span class="op" id="7739265">]</span><span class="ident" id="7739266">Attr</span><span class="op" id="7739270">{</span><span class="op" id="7739271">}</span><span class="op" id="7739272">}</span><span class="op" id="7739273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739276">EndElement</span><span class="op" id="7739286">{</span><span class="ident" id="7739287">Name</span><span class="op" id="7739291">{</span><span class="string" id="7739292">&#34;&#34;</span><span class="op" id="7739294">,</span>&nbsp;<span class="string" id="7739296">&#34;inner&#34;</span><span class="op" id="7739303">}</span><span class="op" id="7739304">}</span><span class="op" id="7739305">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739308">CharData</span><span class="op" id="7739316">(</span><span class="string" id="7739317">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7739323">)</span><span class="op" id="7739324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739327">EndElement</span><span class="op" id="7739337">{</span><span class="ident" id="7739338">Name</span><span class="op" id="7739342">{</span><span class="string" id="7739343">&#34;&#34;</span><span class="op" id="7739345">,</span>&nbsp;<span class="string" id="7739347">&#34;outer&#34;</span><span class="op" id="7739354">}</span><span class="op" id="7739355">}</span><span class="op" id="7739356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739359">CharData</span><span class="op" id="7739367">(</span><span class="string" id="7739368">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7739374">)</span><span class="op" id="7739375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739378">StartElement</span><span class="op" id="7739390">{</span><span class="ident" id="7739391">Name</span><span class="op" id="7739395">{</span><span class="string" id="7739396">&#34;tag&#34;</span><span class="op" id="7739401">,</span>&nbsp;<span class="string" id="7739403">&#34;name&#34;</span><span class="op" id="7739409">}</span><span class="op" id="7739410">,</span>&nbsp;<span class="op" id="7739412">[</span><span class="op" id="7739413">]</span><span class="ident" id="7739414">Attr</span><span class="op" id="7739418">{</span><span class="op" id="7739419">}</span><span class="op" id="7739420">}</span><span class="op" id="7739421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739424">CharData</span><span class="op" id="7739432">(</span><span class="string" id="7739433">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7739441">)</span><span class="op" id="7739442">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739445">CharData</span><span class="op" id="7739453">(</span><span class="string" id="7739454">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7739471">)</span><span class="op" id="7739472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739475">CharData</span><span class="op" id="7739483">(</span><span class="string" id="7739484">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7739490">)</span><span class="op" id="7739491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739494">EndElement</span><span class="op" id="7739504">{</span><span class="ident" id="7739505">Name</span><span class="op" id="7739509">{</span><span class="string" id="7739510">&#34;tag&#34;</span><span class="op" id="7739515">,</span>&nbsp;<span class="string" id="7739517">&#34;name&#34;</span><span class="op" id="7739523">}</span><span class="op" id="7739524">}</span><span class="op" id="7739525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739528">CharData</span><span class="op" id="7739536">(</span><span class="string" id="7739537">&#34;\n&#34;</span><span class="op" id="7739541">)</span><span class="op" id="7739542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739545">EndElement</span><span class="op" id="7739555">{</span><span class="ident" id="7739556">Name</span><span class="op" id="7739560">{</span><span class="string" id="7739561">&#34;&#34;</span><span class="op" id="7739563">,</span>&nbsp;<span class="string" id="7739565">&#34;body&#34;</span><span class="op" id="7739571">}</span><span class="op" id="7739572">}</span><span class="op" id="7739573">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739576">Comment</span><span class="op" id="7739583">(</span><span class="string" id="7739584">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7739609">)</span><span class="op" id="7739610">,</span><br>
<span class="lineno"></span><span class="op" id="7739612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7739615">var</span>&nbsp;<span class="ident" id="7739619">cookedTokens</span>&nbsp;<span class="op" id="7739632">=</span>&nbsp;<span class="op" id="7739634">[</span><span class="op" id="7739635">]</span><span class="ident" id="7739636">Token</span><span class="op" id="7739641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739644">CharData</span><span class="op" id="7739652">(</span><span class="string" id="7739653">&#34;\n&#34;</span><span class="op" id="7739657">)</span><span class="op" id="7739658">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739661">ProcInst</span><span class="op" id="7739669">{</span><span class="string" id="7739670">&#34;xml&#34;</span><span class="op" id="7739675">,</span>&nbsp;<span class="op" id="7739677">[</span><span class="op" id="7739678">]</span><span class="builtintype" id="7739679">byte</span><span class="op" id="7739683">(</span><span class="string" id="7739684">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7739716">)</span><span class="op" id="7739717">}</span><span class="op" id="7739718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739721">CharData</span><span class="op" id="7739729">(</span><span class="string" id="7739730">&#34;\n&#34;</span><span class="op" id="7739734">)</span><span class="op" id="7739735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739738">Directive</span><span class="op" id="7739747">(</span><span class="string" id="7739748">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7739870">)</span><span class="op" id="7739871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739874">CharData</span><span class="op" id="7739882">(</span><span class="string" id="7739883">&#34;\n&#34;</span><span class="op" id="7739887">)</span><span class="op" id="7739888">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7739891">StartElement</span><span class="op" id="7739903">{</span><span class="ident" id="7739904">Name</span><span class="op" id="7739908">{</span><span class="string" id="7739909">&#34;ns2&#34;</span><span class="op" id="7739914">,</span>&nbsp;<span class="string" id="7739916">&#34;body&#34;</span><span class="op" id="7739922">}</span><span class="op" id="7739923">,</span>&nbsp;<span class="op" id="7739925">[</span><span class="op" id="7739926">]</span><span class="ident" id="7739927">Attr</span><span class="op" id="7739931">{</span><span class="op" id="7739932">{</span><span class="ident" id="7739933">Name</span><span class="op" id="7739937">{</span><span class="string" id="7739938">&#34;xmlns&#34;</span><span class="op" id="7739945">,</span>&nbsp;<span class="string" id="7739947">&#34;foo&#34;</span><span class="op" id="7739952">}</span><span class="op" id="7739953">,</span>&nbsp;<span class="string" id="7739955">&#34;ns1&#34;</span><span class="op" id="7739960">}</span><span class="op" id="7739961">,</span>&nbsp;<span class="op" id="7739963">{</span><span class="ident" id="7739964">Name</span><span class="op" id="7739968">{</span><span class="string" id="7739969">&#34;&#34;</span><span class="op" id="7739971">,</span>&nbsp;<span class="string" id="7739973">&#34;xmlns&#34;</span><span class="op" id="7739980">}</span><span class="op" id="7739981">,</span>&nbsp;<span class="string" id="7739983">&#34;ns2&#34;</span><span class="op" id="7739988">}</span><span class="op" id="7739989">,</span>&nbsp;<span class="op" id="7739991">{</span><span class="ident" id="7739992">Name</span><span class="op" id="7739996">{</span><span class="string" id="7739997">&#34;xmlns&#34;</span><span class="op" id="7740004">,</span>&nbsp;<span class="string" id="7740006">&#34;tag&#34;</span><span class="op" id="7740011">}</span><span class="op" id="7740012">,</span>&nbsp;<span class="string" id="7740014">&#34;ns3&#34;</span><span class="op" id="7740019">}</span><span class="op" id="7740020">}</span><span class="op" id="7740021">}</span><span class="op" id="7740022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740025">CharData</span><span class="op" id="7740033">(</span><span class="string" id="7740034">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7740040">)</span><span class="op" id="7740041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740044">StartElement</span><span class="op" id="7740056">{</span><span class="ident" id="7740057">Name</span><span class="op" id="7740061">{</span><span class="string" id="7740062">&#34;ns2&#34;</span><span class="op" id="7740067">,</span>&nbsp;<span class="string" id="7740069">&#34;hello&#34;</span><span class="op" id="7740076">}</span><span class="op" id="7740077">,</span>&nbsp;<span class="op" id="7740079">[</span><span class="op" id="7740080">]</span><span class="ident" id="7740081">Attr</span><span class="op" id="7740085">{</span><span class="op" id="7740086">{</span><span class="ident" id="7740087">Name</span><span class="op" id="7740091">{</span><span class="string" id="7740092">&#34;&#34;</span><span class="op" id="7740094">,</span>&nbsp;<span class="string" id="7740096">&#34;lang&#34;</span><span class="op" id="7740102">}</span><span class="op" id="7740103">,</span>&nbsp;<span class="string" id="7740105">&#34;en&#34;</span><span class="op" id="7740109">}</span><span class="op" id="7740110">}</span><span class="op" id="7740111">}</span><span class="op" id="7740112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740115">CharData</span><span class="op" id="7740123">(</span><span class="string" id="7740124">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7740147">)</span><span class="op" id="7740148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740151">EndElement</span><span class="op" id="7740161">{</span><span class="ident" id="7740162">Name</span><span class="op" id="7740166">{</span><span class="string" id="7740167">&#34;ns2&#34;</span><span class="op" id="7740172">,</span>&nbsp;<span class="string" id="7740174">&#34;hello&#34;</span><span class="op" id="7740181">}</span><span class="op" id="7740182">}</span><span class="op" id="7740183">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740186">CharData</span><span class="op" id="7740194">(</span><span class="string" id="7740195">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7740201">)</span><span class="op" id="7740202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740205">StartElement</span><span class="op" id="7740217">{</span><span class="ident" id="7740218">Name</span><span class="op" id="7740222">{</span><span class="string" id="7740223">&#34;ns2&#34;</span><span class="op" id="7740228">,</span>&nbsp;<span class="string" id="7740230">&#34;query&#34;</span><span class="op" id="7740237">}</span><span class="op" id="7740238">,</span>&nbsp;<span class="op" id="7740240">[</span><span class="op" id="7740241">]</span><span class="ident" id="7740242">Attr</span><span class="op" id="7740246">{</span><span class="op" id="7740247">}</span><span class="op" id="7740248">}</span><span class="op" id="7740249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740252">CharData</span><span class="op" id="7740260">(</span><span class="string" id="7740261">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7740274">)</span><span class="op" id="7740275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740278">EndElement</span><span class="op" id="7740288">{</span><span class="ident" id="7740289">Name</span><span class="op" id="7740293">{</span><span class="string" id="7740294">&#34;ns2&#34;</span><span class="op" id="7740299">,</span>&nbsp;<span class="string" id="7740301">&#34;query&#34;</span><span class="op" id="7740308">}</span><span class="op" id="7740309">}</span><span class="op" id="7740310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740313">CharData</span><span class="op" id="7740321">(</span><span class="string" id="7740322">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7740328">)</span><span class="op" id="7740329">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740332">StartElement</span><span class="op" id="7740344">{</span><span class="ident" id="7740345">Name</span><span class="op" id="7740349">{</span><span class="string" id="7740350">&#34;ns2&#34;</span><span class="op" id="7740355">,</span>&nbsp;<span class="string" id="7740357">&#34;goodbye&#34;</span><span class="op" id="7740366">}</span><span class="op" id="7740367">,</span>&nbsp;<span class="op" id="7740369">[</span><span class="op" id="7740370">]</span><span class="ident" id="7740371">Attr</span><span class="op" id="7740375">{</span><span class="op" id="7740376">}</span><span class="op" id="7740377">}</span><span class="op" id="7740378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740381">EndElement</span><span class="op" id="7740391">{</span><span class="ident" id="7740392">Name</span><span class="op" id="7740396">{</span><span class="string" id="7740397">&#34;ns2&#34;</span><span class="op" id="7740402">,</span>&nbsp;<span class="string" id="7740404">&#34;goodbye&#34;</span><span class="op" id="7740413">}</span><span class="op" id="7740414">}</span><span class="op" id="7740415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740418">CharData</span><span class="op" id="7740426">(</span><span class="string" id="7740427">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7740433">)</span><span class="op" id="7740434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740437">StartElement</span><span class="op" id="7740449">{</span><span class="ident" id="7740450">Name</span><span class="op" id="7740454">{</span><span class="string" id="7740455">&#34;ns2&#34;</span><span class="op" id="7740460">,</span>&nbsp;<span class="string" id="7740462">&#34;outer&#34;</span><span class="op" id="7740469">}</span><span class="op" id="7740470">,</span>&nbsp;<span class="op" id="7740472">[</span><span class="op" id="7740473">]</span><span class="ident" id="7740474">Attr</span><span class="op" id="7740478">{</span><span class="op" id="7740479">{</span><span class="ident" id="7740480">Name</span><span class="op" id="7740484">{</span><span class="string" id="7740485">&#34;ns1&#34;</span><span class="op" id="7740490">,</span>&nbsp;<span class="string" id="7740492">&#34;attr&#34;</span><span class="op" id="7740498">}</span><span class="op" id="7740499">,</span>&nbsp;<span class="string" id="7740501">&#34;value&#34;</span><span class="op" id="7740508">}</span><span class="op" id="7740509">,</span>&nbsp;<span class="op" id="7740511">{</span><span class="ident" id="7740512">Name</span><span class="op" id="7740516">{</span><span class="string" id="7740517">&#34;xmlns&#34;</span><span class="op" id="7740524">,</span>&nbsp;<span class="string" id="7740526">&#34;tag&#34;</span><span class="op" id="7740531">}</span><span class="op" id="7740532">,</span>&nbsp;<span class="string" id="7740534">&#34;ns4&#34;</span><span class="op" id="7740539">}</span><span class="op" id="7740540">}</span><span class="op" id="7740541">}</span><span class="op" id="7740542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740545">CharData</span><span class="op" id="7740553">(</span><span class="string" id="7740554">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7740562">)</span><span class="op" id="7740563">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740566">StartElement</span><span class="op" id="7740578">{</span><span class="ident" id="7740579">Name</span><span class="op" id="7740583">{</span><span class="string" id="7740584">&#34;ns2&#34;</span><span class="op" id="7740589">,</span>&nbsp;<span class="string" id="7740591">&#34;inner&#34;</span><span class="op" id="7740598">}</span><span class="op" id="7740599">,</span>&nbsp;<span class="op" id="7740601">[</span><span class="op" id="7740602">]</span><span class="ident" id="7740603">Attr</span><span class="op" id="7740607">{</span><span class="op" id="7740608">}</span><span class="op" id="7740609">}</span><span class="op" id="7740610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740613">EndElement</span><span class="op" id="7740623">{</span><span class="ident" id="7740624">Name</span><span class="op" id="7740628">{</span><span class="string" id="7740629">&#34;ns2&#34;</span><span class="op" id="7740634">,</span>&nbsp;<span class="string" id="7740636">&#34;inner&#34;</span><span class="op" id="7740643">}</span><span class="op" id="7740644">}</span><span class="op" id="7740645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740648">CharData</span><span class="op" id="7740656">(</span><span class="string" id="7740657">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7740663">)</span><span class="op" id="7740664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740667">EndElement</span><span class="op" id="7740677">{</span><span class="ident" id="7740678">Name</span><span class="op" id="7740682">{</span><span class="string" id="7740683">&#34;ns2&#34;</span><span class="op" id="7740688">,</span>&nbsp;<span class="string" id="7740690">&#34;outer&#34;</span><span class="op" id="7740697">}</span><span class="op" id="7740698">}</span><span class="op" id="7740699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740702">CharData</span><span class="op" id="7740710">(</span><span class="string" id="7740711">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7740717">)</span><span class="op" id="7740718">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740721">StartElement</span><span class="op" id="7740733">{</span><span class="ident" id="7740734">Name</span><span class="op" id="7740738">{</span><span class="string" id="7740739">&#34;ns3&#34;</span><span class="op" id="7740744">,</span>&nbsp;<span class="string" id="7740746">&#34;name&#34;</span><span class="op" id="7740752">}</span><span class="op" id="7740753">,</span>&nbsp;<span class="op" id="7740755">[</span><span class="op" id="7740756">]</span><span class="ident" id="7740757">Attr</span><span class="op" id="7740761">{</span><span class="op" id="7740762">}</span><span class="op" id="7740763">}</span><span class="op" id="7740764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740767">CharData</span><span class="op" id="7740775">(</span><span class="string" id="7740776">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7740784">)</span><span class="op" id="7740785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740788">CharData</span><span class="op" id="7740796">(</span><span class="string" id="7740797">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7740814">)</span><span class="op" id="7740815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740818">CharData</span><span class="op" id="7740826">(</span><span class="string" id="7740827">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7740833">)</span><span class="op" id="7740834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740837">EndElement</span><span class="op" id="7740847">{</span><span class="ident" id="7740848">Name</span><span class="op" id="7740852">{</span><span class="string" id="7740853">&#34;ns3&#34;</span><span class="op" id="7740858">,</span>&nbsp;<span class="string" id="7740860">&#34;name&#34;</span><span class="op" id="7740866">}</span><span class="op" id="7740867">}</span><span class="op" id="7740868">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740871">CharData</span><span class="op" id="7740879">(</span><span class="string" id="7740880">&#34;\n&#34;</span><span class="op" id="7740884">)</span><span class="op" id="7740885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740888">EndElement</span><span class="op" id="7740898">{</span><span class="ident" id="7740899">Name</span><span class="op" id="7740903">{</span><span class="string" id="7740904">&#34;ns2&#34;</span><span class="op" id="7740909">,</span>&nbsp;<span class="string" id="7740911">&#34;body&#34;</span><span class="op" id="7740917">}</span><span class="op" id="7740918">}</span><span class="op" id="7740919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7740922">Comment</span><span class="op" id="7740929">(</span><span class="string" id="7740930">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7740955">)</span><span class="op" id="7740956">,</span><br>
<span class="lineno"></span><span class="op" id="7740958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7740961">const</span>&nbsp;<span class="ident" id="7740967">testInputAltEncoding</span>&nbsp;<span class="op" id="7740988">=</span>&nbsp;<span class="string" id="7740990">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7741064">var</span>&nbsp;<span class="ident" id="7741068">rawTokensAltEncoding</span>&nbsp;<span class="op" id="7741089">=</span>&nbsp;<span class="op" id="7741091">[</span><span class="op" id="7741092">]</span><span class="ident" id="7741093">Token</span><span class="op" id="7741098">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7741101">CharData</span><span class="op" id="7741109">(</span><span class="string" id="7741110">&#34;\n&#34;</span><span class="op" id="7741114">)</span><span class="op" id="7741115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7741118">ProcInst</span><span class="op" id="7741126">{</span><span class="string" id="7741127">&#34;xml&#34;</span><span class="op" id="7741132">,</span>&nbsp;<span class="op" id="7741134">[</span><span class="op" id="7741135">]</span><span class="builtintype" id="7741136">byte</span><span class="op" id="7741140">(</span><span class="string" id="7741141">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="7741187">)</span><span class="op" id="7741188">}</span><span class="op" id="7741189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7741192">CharData</span><span class="op" id="7741200">(</span><span class="string" id="7741201">&#34;\n&#34;</span><span class="op" id="7741205">)</span><span class="op" id="7741206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7741209">StartElement</span><span class="op" id="7741221">{</span><span class="ident" id="7741222">Name</span><span class="op" id="7741226">{</span><span class="string" id="7741227">&#34;&#34;</span><span class="op" id="7741229">,</span>&nbsp;<span class="string" id="7741231">&#34;tag&#34;</span><span class="op" id="7741236">}</span><span class="op" id="7741237">,</span>&nbsp;<span class="op" id="7741239">[</span><span class="op" id="7741240">]</span><span class="ident" id="7741241">Attr</span><span class="op" id="7741245">{</span><span class="op" id="7741246">}</span><span class="op" id="7741247">}</span><span class="op" id="7741248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7741251">CharData</span><span class="op" id="7741259">(</span><span class="string" id="7741260">&#34;value&#34;</span><span class="op" id="7741267">)</span><span class="op" id="7741268">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7741271">EndElement</span><span class="op" id="7741281">{</span><span class="ident" id="7741282">Name</span><span class="op" id="7741286">{</span><span class="string" id="7741287">&#34;&#34;</span><span class="op" id="7741289">,</span>&nbsp;<span class="string" id="7741291">&#34;tag&#34;</span><span class="op" id="7741296">}</span><span class="op" id="7741297">}</span><span class="op" id="7741298">,</span><br>
<span class="lineno"></span><span class="op" id="7741300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7741303">var</span>&nbsp;<span class="ident" id="7741307">xmlInput</span>&nbsp;<span class="op" id="7741316">=</span>&nbsp;<span class="op" id="7741318">[</span><span class="op" id="7741319">]</span><span class="builtintype" id="7741320">string</span><span class="op" id="7741326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7741329">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741354">&#34;&lt;&#34;</span><span class="op" id="7741357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741360">&#34;&lt;t&#34;</span><span class="op" id="7741364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741367">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="7741372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741375">&#34;&lt;t/&#34;</span><span class="op" id="7741380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741383">&#34;&lt;!&#34;</span><span class="op" id="7741387">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741390">&#34;&lt;!-&#34;</span><span class="op" id="7741395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741398">&#34;&lt;!--&#34;</span><span class="op" id="7741404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741407">&#34;&lt;!--c-&#34;</span><span class="op" id="7741415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741418">&#34;&lt;!--c--&#34;</span><span class="op" id="7741427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741430">&#34;&lt;!d&#34;</span><span class="op" id="7741435">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741438">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="7741445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741448">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="7741456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741459">&#34;&lt;?&#34;</span><span class="op" id="7741463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741466">&#34;&lt;?p&#34;</span><span class="op" id="7741471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741474">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="7741480">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741483">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="7741490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741493">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="7741501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741504">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="7741513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741516">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="7741525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741528">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="7741538">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741541">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="7741557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741560">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="7741577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741580">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="7741598">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7741602">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741626">&#34;&lt;&gt;&#34;</span><span class="op" id="7741630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741633">&#34;&lt;t/a&#34;</span><span class="op" id="7741639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741642">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="7741649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741652">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="7741659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7741662">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741708">&#34;&lt;/0&gt;&#34;</span><span class="op" id="7741714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741717">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="7741727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741730">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="7741741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741744">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="7741755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741758">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="7741774">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741777">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="7741784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741787">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="7741795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741798">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="7741807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7741810">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741864">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="7741873">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741876">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="7741884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741887">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="7741896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7741899">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="7741916">,</span><br>
<span class="lineno"></span><span class="op" id="7741918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7741921">func</span>&nbsp;<span class="ident" id="7741926">TestRawToken</span><span class="op" id="7741938">(</span><span class="ident" id="7741939">t</span>&nbsp;<span class="op" id="7741941">*</span><span class="ident" id="7741942">testing</span><span class="op" id="7741949">.</span><span class="ident" id="7741950">T</span><span class="op" id="7741951">)</span>&nbsp;<span class="op" id="7741953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7741956">d</span>&nbsp;<span class="op" id="7741958">:=</span>&nbsp;<span class="ident" id="7741961">NewDecoder</span><span class="op" id="7741971">(</span><span class="ident" id="7741972">strings</span><span class="op" id="7741979">.</span><span class="ident" id="7741980">NewReader</span><span class="op" id="7741989">(</span><span class="ident" id="7741990">testInput</span><span class="op" id="7741999">)</span><span class="op" id="7742000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742003">d</span><span class="op" id="7742004">.</span><span class="ident" id="7742005">Entity</span>&nbsp;<span class="op" id="7742012">=</span>&nbsp;<span class="ident" id="7742014">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742026">testRawToken</span><span class="op" id="7742038">(</span><span class="ident" id="7742039">t</span><span class="op" id="7742040">,</span>&nbsp;<span class="ident" id="7742042">d</span><span class="op" id="7742043">,</span>&nbsp;<span class="ident" id="7742045">testInput</span><span class="op" id="7742054">,</span>&nbsp;<span class="ident" id="7742056">rawTokens</span><span class="op" id="7742065">)</span><br>
<span class="lineno"></span><span class="op" id="7742067">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7742070">const</span>&nbsp;<span class="ident" id="7742076">nonStrictInput</span>&nbsp;<span class="op" id="7742091">=</span>&nbsp;<span class="string" id="7742093">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7742255">var</span>&nbsp;<span class="ident" id="7742259">nonStringEntity</span>&nbsp;<span class="op" id="7742275">=</span>&nbsp;<span class="keyword" id="7742277">map</span><span class="op" id="7742280">[</span><span class="builtintype" id="7742281">string</span><span class="op" id="7742287">]</span><span class="builtintype" id="7742288">string</span><span class="op" id="7742294">{</span><span class="string" id="7742295">&#34;&#34;</span><span class="op" id="7742297">:</span>&nbsp;<span class="string" id="7742299">&#34;oops!&#34;</span><span class="op" id="7742306">,</span>&nbsp;<span class="string" id="7742308">&#34;0a&#34;</span><span class="op" id="7742312">:</span>&nbsp;<span class="string" id="7742314">&#34;oops!&#34;</span><span class="op" id="7742321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7742324">var</span>&nbsp;<span class="ident" id="7742328">nonStrictTokens</span>&nbsp;<span class="op" id="7742344">=</span>&nbsp;<span class="op" id="7742346">[</span><span class="op" id="7742347">]</span><span class="ident" id="7742348">Token</span><span class="op" id="7742353">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742356">CharData</span><span class="op" id="7742364">(</span><span class="string" id="7742365">&#34;\n&#34;</span><span class="op" id="7742369">)</span><span class="op" id="7742370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742373">StartElement</span><span class="op" id="7742385">{</span><span class="ident" id="7742386">Name</span><span class="op" id="7742390">{</span><span class="string" id="7742391">&#34;&#34;</span><span class="op" id="7742393">,</span>&nbsp;<span class="string" id="7742395">&#34;tag&#34;</span><span class="op" id="7742400">}</span><span class="op" id="7742401">,</span>&nbsp;<span class="op" id="7742403">[</span><span class="op" id="7742404">]</span><span class="ident" id="7742405">Attr</span><span class="op" id="7742409">{</span><span class="op" id="7742410">}</span><span class="op" id="7742411">}</span><span class="op" id="7742412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742415">CharData</span><span class="op" id="7742423">(</span><span class="string" id="7742424">&#34;non&amp;entity&#34;</span><span class="op" id="7742436">)</span><span class="op" id="7742437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742440">EndElement</span><span class="op" id="7742450">{</span><span class="ident" id="7742451">Name</span><span class="op" id="7742455">{</span><span class="string" id="7742456">&#34;&#34;</span><span class="op" id="7742458">,</span>&nbsp;<span class="string" id="7742460">&#34;tag&#34;</span><span class="op" id="7742465">}</span><span class="op" id="7742466">}</span><span class="op" id="7742467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742470">CharData</span><span class="op" id="7742478">(</span><span class="string" id="7742479">&#34;\n&#34;</span><span class="op" id="7742483">)</span><span class="op" id="7742484">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742487">StartElement</span><span class="op" id="7742499">{</span><span class="ident" id="7742500">Name</span><span class="op" id="7742504">{</span><span class="string" id="7742505">&#34;&#34;</span><span class="op" id="7742507">,</span>&nbsp;<span class="string" id="7742509">&#34;tag&#34;</span><span class="op" id="7742514">}</span><span class="op" id="7742515">,</span>&nbsp;<span class="op" id="7742517">[</span><span class="op" id="7742518">]</span><span class="ident" id="7742519">Attr</span><span class="op" id="7742523">{</span><span class="op" id="7742524">}</span><span class="op" id="7742525">}</span><span class="op" id="7742526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742529">CharData</span><span class="op" id="7742537">(</span><span class="string" id="7742538">&#34;&amp;unknown;entity&#34;</span><span class="op" id="7742555">)</span><span class="op" id="7742556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742559">EndElement</span><span class="op" id="7742569">{</span><span class="ident" id="7742570">Name</span><span class="op" id="7742574">{</span><span class="string" id="7742575">&#34;&#34;</span><span class="op" id="7742577">,</span>&nbsp;<span class="string" id="7742579">&#34;tag&#34;</span><span class="op" id="7742584">}</span><span class="op" id="7742585">}</span><span class="op" id="7742586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742589">CharData</span><span class="op" id="7742597">(</span><span class="string" id="7742598">&#34;\n&#34;</span><span class="op" id="7742602">)</span><span class="op" id="7742603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742606">StartElement</span><span class="op" id="7742618">{</span><span class="ident" id="7742619">Name</span><span class="op" id="7742623">{</span><span class="string" id="7742624">&#34;&#34;</span><span class="op" id="7742626">,</span>&nbsp;<span class="string" id="7742628">&#34;tag&#34;</span><span class="op" id="7742633">}</span><span class="op" id="7742634">,</span>&nbsp;<span class="op" id="7742636">[</span><span class="op" id="7742637">]</span><span class="ident" id="7742638">Attr</span><span class="op" id="7742642">{</span><span class="op" id="7742643">}</span><span class="op" id="7742644">}</span><span class="op" id="7742645">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742648">CharData</span><span class="op" id="7742656">(</span><span class="string" id="7742657">&#34;&amp;#123&#34;</span><span class="op" id="7742664">)</span><span class="op" id="7742665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742668">EndElement</span><span class="op" id="7742678">{</span><span class="ident" id="7742679">Name</span><span class="op" id="7742683">{</span><span class="string" id="7742684">&#34;&#34;</span><span class="op" id="7742686">,</span>&nbsp;<span class="string" id="7742688">&#34;tag&#34;</span><span class="op" id="7742693">}</span><span class="op" id="7742694">}</span><span class="op" id="7742695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742698">CharData</span><span class="op" id="7742706">(</span><span class="string" id="7742707">&#34;\n&#34;</span><span class="op" id="7742711">)</span><span class="op" id="7742712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742715">StartElement</span><span class="op" id="7742727">{</span><span class="ident" id="7742728">Name</span><span class="op" id="7742732">{</span><span class="string" id="7742733">&#34;&#34;</span><span class="op" id="7742735">,</span>&nbsp;<span class="string" id="7742737">&#34;tag&#34;</span><span class="op" id="7742742">}</span><span class="op" id="7742743">,</span>&nbsp;<span class="op" id="7742745">[</span><span class="op" id="7742746">]</span><span class="ident" id="7742747">Attr</span><span class="op" id="7742751">{</span><span class="op" id="7742752">}</span><span class="op" id="7742753">}</span><span class="op" id="7742754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742757">CharData</span><span class="op" id="7742765">(</span><span class="string" id="7742766">&#34;&amp;#zzz;&#34;</span><span class="op" id="7742774">)</span><span class="op" id="7742775">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742778">EndElement</span><span class="op" id="7742788">{</span><span class="ident" id="7742789">Name</span><span class="op" id="7742793">{</span><span class="string" id="7742794">&#34;&#34;</span><span class="op" id="7742796">,</span>&nbsp;<span class="string" id="7742798">&#34;tag&#34;</span><span class="op" id="7742803">}</span><span class="op" id="7742804">}</span><span class="op" id="7742805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742808">CharData</span><span class="op" id="7742816">(</span><span class="string" id="7742817">&#34;\n&#34;</span><span class="op" id="7742821">)</span><span class="op" id="7742822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742825">StartElement</span><span class="op" id="7742837">{</span><span class="ident" id="7742838">Name</span><span class="op" id="7742842">{</span><span class="string" id="7742843">&#34;&#34;</span><span class="op" id="7742845">,</span>&nbsp;<span class="string" id="7742847">&#34;tag&#34;</span><span class="op" id="7742852">}</span><span class="op" id="7742853">,</span>&nbsp;<span class="op" id="7742855">[</span><span class="op" id="7742856">]</span><span class="ident" id="7742857">Attr</span><span class="op" id="7742861">{</span><span class="op" id="7742862">}</span><span class="op" id="7742863">}</span><span class="op" id="7742864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742867">CharData</span><span class="op" id="7742875">(</span><span class="string" id="7742876">&#34;&amp;なまえ3;&#34;</span><span class="op" id="7742890">)</span><span class="op" id="7742891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742894">EndElement</span><span class="op" id="7742904">{</span><span class="ident" id="7742905">Name</span><span class="op" id="7742909">{</span><span class="string" id="7742910">&#34;&#34;</span><span class="op" id="7742912">,</span>&nbsp;<span class="string" id="7742914">&#34;tag&#34;</span><span class="op" id="7742919">}</span><span class="op" id="7742920">}</span><span class="op" id="7742921">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742924">CharData</span><span class="op" id="7742932">(</span><span class="string" id="7742933">&#34;\n&#34;</span><span class="op" id="7742937">)</span><span class="op" id="7742938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742941">StartElement</span><span class="op" id="7742953">{</span><span class="ident" id="7742954">Name</span><span class="op" id="7742958">{</span><span class="string" id="7742959">&#34;&#34;</span><span class="op" id="7742961">,</span>&nbsp;<span class="string" id="7742963">&#34;tag&#34;</span><span class="op" id="7742968">}</span><span class="op" id="7742969">,</span>&nbsp;<span class="op" id="7742971">[</span><span class="op" id="7742972">]</span><span class="ident" id="7742973">Attr</span><span class="op" id="7742977">{</span><span class="op" id="7742978">}</span><span class="op" id="7742979">}</span><span class="op" id="7742980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7742983">CharData</span><span class="op" id="7742991">(</span><span class="string" id="7742992">&#34;&amp;lt-gt;&#34;</span><span class="op" id="7743001">)</span><span class="op" id="7743002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743005">EndElement</span><span class="op" id="7743015">{</span><span class="ident" id="7743016">Name</span><span class="op" id="7743020">{</span><span class="string" id="7743021">&#34;&#34;</span><span class="op" id="7743023">,</span>&nbsp;<span class="string" id="7743025">&#34;tag&#34;</span><span class="op" id="7743030">}</span><span class="op" id="7743031">}</span><span class="op" id="7743032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743035">CharData</span><span class="op" id="7743043">(</span><span class="string" id="7743044">&#34;\n&#34;</span><span class="op" id="7743048">)</span><span class="op" id="7743049">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743052">StartElement</span><span class="op" id="7743064">{</span><span class="ident" id="7743065">Name</span><span class="op" id="7743069">{</span><span class="string" id="7743070">&#34;&#34;</span><span class="op" id="7743072">,</span>&nbsp;<span class="string" id="7743074">&#34;tag&#34;</span><span class="op" id="7743079">}</span><span class="op" id="7743080">,</span>&nbsp;<span class="op" id="7743082">[</span><span class="op" id="7743083">]</span><span class="ident" id="7743084">Attr</span><span class="op" id="7743088">{</span><span class="op" id="7743089">}</span><span class="op" id="7743090">}</span><span class="op" id="7743091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743094">CharData</span><span class="op" id="7743102">(</span><span class="string" id="7743103">&#34;&amp;;&#34;</span><span class="op" id="7743107">)</span><span class="op" id="7743108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743111">EndElement</span><span class="op" id="7743121">{</span><span class="ident" id="7743122">Name</span><span class="op" id="7743126">{</span><span class="string" id="7743127">&#34;&#34;</span><span class="op" id="7743129">,</span>&nbsp;<span class="string" id="7743131">&#34;tag&#34;</span><span class="op" id="7743136">}</span><span class="op" id="7743137">}</span><span class="op" id="7743138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743141">CharData</span><span class="op" id="7743149">(</span><span class="string" id="7743150">&#34;\n&#34;</span><span class="op" id="7743154">)</span><span class="op" id="7743155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743158">StartElement</span><span class="op" id="7743170">{</span><span class="ident" id="7743171">Name</span><span class="op" id="7743175">{</span><span class="string" id="7743176">&#34;&#34;</span><span class="op" id="7743178">,</span>&nbsp;<span class="string" id="7743180">&#34;tag&#34;</span><span class="op" id="7743185">}</span><span class="op" id="7743186">,</span>&nbsp;<span class="op" id="7743188">[</span><span class="op" id="7743189">]</span><span class="ident" id="7743190">Attr</span><span class="op" id="7743194">{</span><span class="op" id="7743195">}</span><span class="op" id="7743196">}</span><span class="op" id="7743197">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743200">CharData</span><span class="op" id="7743208">(</span><span class="string" id="7743209">&#34;&amp;0a;&#34;</span><span class="op" id="7743215">)</span><span class="op" id="7743216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743219">EndElement</span><span class="op" id="7743229">{</span><span class="ident" id="7743230">Name</span><span class="op" id="7743234">{</span><span class="string" id="7743235">&#34;&#34;</span><span class="op" id="7743237">,</span>&nbsp;<span class="string" id="7743239">&#34;tag&#34;</span><span class="op" id="7743244">}</span><span class="op" id="7743245">}</span><span class="op" id="7743246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743249">CharData</span><span class="op" id="7743257">(</span><span class="string" id="7743258">&#34;\n&#34;</span><span class="op" id="7743262">)</span><span class="op" id="7743263">,</span><br>
<span class="lineno"></span><span class="op" id="7743265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="7743268">func</span>&nbsp;<span class="ident" id="7743273">TestNonStrictRawToken</span><span class="op" id="7743294">(</span><span class="ident" id="7743295">t</span>&nbsp;<span class="op" id="7743297">*</span><span class="ident" id="7743298">testing</span><span class="op" id="7743305">.</span><span class="ident" id="7743306">T</span><span class="op" id="7743307">)</span>&nbsp;<span class="op" id="7743309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743312">d</span>&nbsp;<span class="op" id="7743314">:=</span>&nbsp;<span class="ident" id="7743317">NewDecoder</span><span class="op" id="7743327">(</span><span class="ident" id="7743328">strings</span><span class="op" id="7743335">.</span><span class="ident" id="7743336">NewReader</span><span class="op" id="7743345">(</span><span class="ident" id="7743346">nonStrictInput</span><span class="op" id="7743360">)</span><span class="op" id="7743361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743364">d</span><span class="op" id="7743365">.</span><span class="ident" id="7743366">Strict</span>&nbsp;<span class="op" id="7743373">=</span>&nbsp;<span class="builtintype" id="7743375">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743382">testRawToken</span><span class="op" id="7743394">(</span><span class="ident" id="7743395">t</span><span class="op" id="7743396">,</span>&nbsp;<span class="ident" id="7743398">d</span><span class="op" id="7743399">,</span>&nbsp;<span class="ident" id="7743401">nonStrictInput</span><span class="op" id="7743415">,</span>&nbsp;<span class="ident" id="7743417">nonStrictTokens</span><span class="op" id="7743432">)</span><br>
<span class="lineno"></span><span class="op" id="7743434">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="7743437">type</span>&nbsp;<span class="ident" id="7743442">downCaser</span>&nbsp;<span class="keyword" id="7743452">struct</span>&nbsp;<span class="op" id="7743459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743462">t</span>&nbsp;<span class="op" id="7743464">*</span><span class="ident" id="7743465">testing</span><span class="op" id="7743472">.</span><span class="ident" id="7743473">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743476">r</span>&nbsp;<span class="ident" id="7743478">io</span><span class="op" id="7743480">.</span><span class="ident" id="7743481">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="7743492">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="7743495">func</span>&nbsp;<span class="op" id="7743500">(</span><span class="ident" id="7743501">d</span>&nbsp;<span class="op" id="7743503">*</span><span class="ident" id="7743504">downCaser</span><span class="op" id="7743513">)</span>&nbsp;<span class="ident" id="7743515">ReadByte</span><span class="op" id="7743523">(</span><span class="op" id="7743524">)</span>&nbsp;<span class="op" id="7743526">(</span><span class="ident" id="7743527">c</span>&nbsp;<span class="builtintype" id="7743529">byte</span><span class="op" id="7743533">,</span>&nbsp;<span class="ident" id="7743535">err</span>&nbsp;<span class="builtintype" id="7743539">error</span><span class="op" id="7743544">)</span>&nbsp;<span class="op" id="7743546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743549">c</span><span class="op" id="7743550">,</span>&nbsp;<span class="ident" id="7743552">err</span>&nbsp;<span class="op" id="7743556">=</span>&nbsp;<span class="ident" id="7743558">d</span><span class="op" id="7743559">.</span><span class="ident" id="7743560">r</span><span class="op" id="7743561">.</span><span class="ident" id="7743562">ReadByte</span><span class="op" id="7743570">(</span><span class="op" id="7743571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7743574">if</span>&nbsp;<span class="ident" id="7743577">c</span>&nbsp;<span class="op" id="7743579">&gt;=</span>&nbsp;<span class="string" id="7743582">&#39;A&#39;</span>&nbsp;<span class="op" id="7743586">&amp;&amp;</span>&nbsp;<span class="ident" id="7743589">c</span>&nbsp;<span class="op" id="7743591">&lt;=</span>&nbsp;<span class="string" id="7743594">&#39;Z&#39;</span>&nbsp;<span class="op" id="7743598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743602">c</span>&nbsp;<span class="op" id="7743604">+=</span>&nbsp;<span class="string" id="7743607">&#39;a&#39;</span>&nbsp;<span class="op" id="7743611">-</span>&nbsp;<span class="string" id="7743613">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7743618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7743621">return</span><br>
<span class="lineno"></span><span class="op" id="7743628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7743631">func</span>&nbsp;<span class="op" id="7743636">(</span><span class="ident" id="7743637">d</span>&nbsp;<span class="op" id="7743639">*</span><span class="ident" id="7743640">downCaser</span><span class="op" id="7743649">)</span>&nbsp;<span class="ident" id="7743651">Read</span><span class="op" id="7743655">(</span><span class="ident" id="7743656">p</span>&nbsp;<span class="op" id="7743658">[</span><span class="op" id="7743659">]</span><span class="builtintype" id="7743660">byte</span><span class="op" id="7743664">)</span>&nbsp;<span class="op" id="7743666">(</span><span class="builtintype" id="7743667">int</span><span class="op" id="7743670">,</span>&nbsp;<span class="builtintype" id="7743672">error</span><span class="op" id="7743677">)</span>&nbsp;<span class="op" id="7743679">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743682">d</span><span class="op" id="7743683">.</span><span class="ident" id="7743684">t</span><span class="op" id="7743685">.</span><span class="ident" id="7743686">Fatalf</span><span class="op" id="7743692">(</span><span class="string" id="7743693">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="7743735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7743738">panic</span><span class="op" id="7743743">(</span><span class="string" id="7743744">&#34;unreachable&#34;</span><span class="op" id="7743757">)</span><br>
<span class="lineno"></span><span class="op" id="7743759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7743762">func</span>&nbsp;<span class="ident" id="7743767">TestRawTokenAltEncoding</span><span class="op" id="7743790">(</span><span class="ident" id="7743791">t</span>&nbsp;<span class="op" id="7743793">*</span><span class="ident" id="7743794">testing</span><span class="op" id="7743801">.</span><span class="ident" id="7743802">T</span><span class="op" id="7743803">)</span>&nbsp;<span class="op" id="7743805">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743808">d</span>&nbsp;<span class="op" id="7743810">:=</span>&nbsp;<span class="ident" id="7743813">NewDecoder</span><span class="op" id="7743823">(</span><span class="ident" id="7743824">strings</span><span class="op" id="7743831">.</span><span class="ident" id="7743832">NewReader</span><span class="op" id="7743841">(</span><span class="ident" id="7743842">testInputAltEncoding</span><span class="op" id="7743862">)</span><span class="op" id="7743863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743866">d</span><span class="op" id="7743867">.</span><span class="ident" id="7743868">CharsetReader</span>&nbsp;<span class="op" id="7743882">=</span>&nbsp;<span class="keyword" id="7743884">func</span><span class="op" id="7743888">(</span><span class="ident" id="7743889">charset</span>&nbsp;<span class="builtintype" id="7743897">string</span><span class="op" id="7743903">,</span>&nbsp;<span class="ident" id="7743905">input</span>&nbsp;<span class="ident" id="7743911">io</span><span class="op" id="7743913">.</span><span class="ident" id="7743914">Reader</span><span class="op" id="7743920">)</span>&nbsp;<span class="op" id="7743922">(</span><span class="ident" id="7743923">io</span><span class="op" id="7743925">.</span><span class="ident" id="7743926">Reader</span><span class="op" id="7743932">,</span>&nbsp;<span class="builtintype" id="7743934">error</span><span class="op" id="7743939">)</span>&nbsp;<span class="op" id="7743941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7743945">if</span>&nbsp;<span class="ident" id="7743948">charset</span>&nbsp;<span class="op" id="7743956">!=</span>&nbsp;<span class="string" id="7743959">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="7743981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7743986">t</span><span class="op" id="7743987">.</span><span class="ident" id="7743988">Fatalf</span><span class="op" id="7743994">(</span><span class="string" id="7743995">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="7744018">,</span>&nbsp;<span class="ident" id="7744020">charset</span><span class="op" id="7744027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7744031">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7744035">return</span>&nbsp;<span class="op" id="7744042">&amp;</span><span class="ident" id="7744043">downCaser</span><span class="op" id="7744052">{</span><span class="ident" id="7744053">t</span><span class="op" id="7744054">,</span>&nbsp;<span class="ident" id="7744056">input</span><span class="op" id="7744061">.</span><span class="op" id="7744062">(</span><span class="ident" id="7744063">io</span><span class="op" id="7744065">.</span><span class="ident" id="7744066">ByteReader</span><span class="op" id="7744076">)</span><span class="op" id="7744077">}</span><span class="op" id="7744078">,</span>&nbsp;<span class="ident" id="7744080">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7744085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744088">testRawToken</span><span class="op" id="7744100">(</span><span class="ident" id="7744101">t</span><span class="op" id="7744102">,</span>&nbsp;<span class="ident" id="7744104">d</span><span class="op" id="7744105">,</span>&nbsp;<span class="ident" id="7744107">testInputAltEncoding</span><span class="op" id="7744127">,</span>&nbsp;<span class="ident" id="7744129">rawTokensAltEncoding</span><span class="op" id="7744149">)</span><br>
<span class="lineno"></span><span class="op" id="7744151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="7744154">func</span>&nbsp;<span class="ident" id="7744159">TestRawTokenAltEncodingNoConverter</span><span class="op" id="7744193">(</span><span class="ident" id="7744194">t</span>&nbsp;<span class="op" id="7744196">*</span><span class="ident" id="7744197">testing</span><span class="op" id="7744204">.</span><span class="ident" id="7744205">T</span><span class="op" id="7744206">)</span>&nbsp;<span class="op" id="7744208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744211">d</span>&nbsp;<span class="op" id="7744213">:=</span>&nbsp;<span class="ident" id="7744216">NewDecoder</span><span class="op" id="7744226">(</span><span class="ident" id="7744227">strings</span><span class="op" id="7744234">.</span><span class="ident" id="7744235">NewReader</span><span class="op" id="7744244">(</span><span class="ident" id="7744245">testInputAltEncoding</span><span class="op" id="7744265">)</span><span class="op" id="7744266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744269">token</span><span class="op" id="7744274">,</span>&nbsp;<span class="ident" id="7744276">err</span>&nbsp;<span class="op" id="7744280">:=</span>&nbsp;<span class="ident" id="7744283">d</span><span class="op" id="7744284">.</span><span class="ident" id="7744285">RawToken</span><span class="op" id="7744293">(</span><span class="op" id="7744294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7744297">if</span>&nbsp;<span class="ident" id="7744300">token</span>&nbsp;<span class="op" id="7744306">==</span>&nbsp;<span class="ident" id="7744309">nil</span>&nbsp;<span class="op" id="7744313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744317">t</span><span class="op" id="7744318">.</span><span class="ident" id="7744319">Fatalf</span><span class="op" id="7744325">(</span><span class="string" id="7744326">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7744367">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7744370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7744373">if</span>&nbsp;<span class="ident" id="7744376">err</span>&nbsp;<span class="op" id="7744380">!=</span>&nbsp;<span class="ident" id="7744383">nil</span>&nbsp;<span class="op" id="7744387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744391">t</span><span class="op" id="7744392">.</span><span class="ident" id="7744393">Fatal</span><span class="op" id="7744398">(</span><span class="ident" id="7744399">err</span><span class="op" id="7744402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7744405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744408">token</span><span class="op" id="7744413">,</span>&nbsp;<span class="ident" id="7744415">err</span>&nbsp;<span class="op" id="7744419">=</span>&nbsp;<span class="ident" id="7744421">d</span><span class="op" id="7744422">.</span><span class="ident" id="7744423">RawToken</span><span class="op" id="7744431">(</span><span class="op" id="7744432">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7744435">if</span>&nbsp;<span class="ident" id="7744438">token</span>&nbsp;<span class="op" id="7744444">!=</span>&nbsp;<span class="ident" id="7744447">nil</span>&nbsp;<span class="op" id="7744451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744455">t</span><span class="op" id="7744456">.</span><span class="ident" id="7744457">Errorf</span><span class="op" id="7744463">(</span><span class="string" id="7744464">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="7744495">,</span>&nbsp;<span class="ident" id="7744497">token</span><span class="op" id="7744502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7744505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7744508">if</span>&nbsp;<span class="ident" id="7744511">err</span>&nbsp;<span class="op" id="7744515">==</span>&nbsp;<span class="ident" id="7744518">nil</span>&nbsp;<span class="op" id="7744522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744526">t</span><span class="op" id="7744527">.</span><span class="ident" id="7744528">Fatalf</span><span class="op" id="7744534">(</span><span class="string" id="7744535">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7744578">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7744581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7744584">const</span>&nbsp;<span class="ident" id="7744590">encoding</span>&nbsp;<span class="op" id="7744599">=</span>&nbsp;<span class="string" id="7744601">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7744624">if</span>&nbsp;<span class="op" id="7744627">!</span><span class="ident" id="7744628">strings</span><span class="op" id="7744635">.</span><span class="ident" id="7744636">Contains</span><span class="op" id="7744644">(</span><span class="ident" id="7744645">err</span><span class="op" id="7744648">.</span><span class="ident" id="7744649">Error</span><span class="op" id="7744654">(</span><span class="op" id="7744655">)</span><span class="op" id="7744656">,</span>&nbsp;<span class="ident" id="7744658">encoding</span><span class="op" id="7744666">)</span>&nbsp;<span class="op" id="7744668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744672">t</span><span class="op" id="7744673">.</span><span class="ident" id="7744674">Errorf</span><span class="op" id="7744680">(</span><span class="string" id="7744681">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7744726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744731">encoding</span><span class="op" id="7744739">,</span>&nbsp;<span class="ident" id="7744741">err</span><span class="op" id="7744744">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7744747">}</span><br>
<span class="lineno"></span><span class="op" id="7744749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7744752">func</span>&nbsp;<span class="ident" id="7744757">testRawToken</span><span class="op" id="7744769">(</span><span class="ident" id="7744770">t</span>&nbsp;<span class="op" id="7744772">*</span><span class="ident" id="7744773">testing</span><span class="op" id="7744780">.</span><span class="ident" id="7744781">T</span><span class="op" id="7744782">,</span>&nbsp;<span class="ident" id="7744784">d</span>&nbsp;<span class="op" id="7744786">*</span><span class="ident" id="7744787">Decoder</span><span class="op" id="7744794">,</span>&nbsp;<span class="ident" id="7744796">raw</span>&nbsp;<span class="builtintype" id="7744800">string</span><span class="op" id="7744806">,</span>&nbsp;<span class="ident" id="7744808">rawTokens</span>&nbsp;<span class="op" id="7744818">[</span><span class="op" id="7744819">]</span><span class="ident" id="7744820">Token</span><span class="op" id="7744825">)</span>&nbsp;<span class="op" id="7744827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744830">lastEnd</span>&nbsp;<span class="op" id="7744838">:=</span>&nbsp;<span class="ident" id="7744841">int64</span><span class="op" id="7744846">(</span><span class="num" id="7744847">0</span><span class="op" id="7744848">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7744851">for</span>&nbsp;<span class="ident" id="7744855">i</span><span class="op" id="7744856">,</span>&nbsp;<span class="ident" id="7744858">want</span>&nbsp;<span class="op" id="7744863">:=</span>&nbsp;<span class="keyword" id="7744866">range</span>&nbsp;<span class="ident" id="7744872">rawTokens</span>&nbsp;<span class="op" id="7744882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744886">start</span>&nbsp;<span class="op" id="7744892">:=</span>&nbsp;<span class="ident" id="7744895">d</span><span class="op" id="7744896">.</span><span class="ident" id="7744897">InputOffset</span><span class="op" id="7744908">(</span><span class="op" id="7744909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744913">have</span><span class="op" id="7744917">,</span>&nbsp;<span class="ident" id="7744919">err</span>&nbsp;<span class="op" id="7744923">:=</span>&nbsp;<span class="ident" id="7744926">d</span><span class="op" id="7744927">.</span><span class="ident" id="7744928">RawToken</span><span class="op" id="7744936">(</span><span class="op" id="7744937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744941">end</span>&nbsp;<span class="op" id="7744945">:=</span>&nbsp;<span class="ident" id="7744948">d</span><span class="op" id="7744949">.</span><span class="ident" id="7744950">InputOffset</span><span class="op" id="7744961">(</span><span class="op" id="7744962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7744966">if</span>&nbsp;<span class="ident" id="7744969">err</span>&nbsp;<span class="op" id="7744973">!=</span>&nbsp;<span class="ident" id="7744976">nil</span>&nbsp;<span class="op" id="7744980">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7744985">t</span><span class="op" id="7744986">.</span><span class="ident" id="7744987">Fatalf</span><span class="op" id="7744993">(</span><span class="string" id="7744994">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7745026">,</span>&nbsp;<span class="ident" id="7745028">i</span><span class="op" id="7745029">,</span>&nbsp;<span class="ident" id="7745031">err</span><span class="op" id="7745034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7745038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745042">if</span>&nbsp;<span class="op" id="7745045">!</span><span class="ident" id="7745046">reflect</span><span class="op" id="7745053">.</span><span class="ident" id="7745054">DeepEqual</span><span class="op" id="7745063">(</span><span class="ident" id="7745064">have</span><span class="op" id="7745068">,</span>&nbsp;<span class="ident" id="7745070">want</span><span class="op" id="7745074">)</span>&nbsp;<span class="op" id="7745076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745081">var</span>&nbsp;<span class="ident" id="7745085">shave</span><span class="op" id="7745090">,</span>&nbsp;<span class="ident" id="7745092">swant</span>&nbsp;<span class="builtintype" id="7745098">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745108">if</span>&nbsp;<span class="ident" id="7745111">_</span><span class="op" id="7745112">,</span>&nbsp;<span class="ident" id="7745114">ok</span>&nbsp;<span class="op" id="7745117">:=</span>&nbsp;<span class="ident" id="7745120">have</span><span class="op" id="7745124">.</span><span class="op" id="7745125">(</span><span class="ident" id="7745126">CharData</span><span class="op" id="7745134">)</span><span class="op" id="7745135">;</span>&nbsp;<span class="ident" id="7745137">ok</span>&nbsp;<span class="op" id="7745140">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7745146">shave</span>&nbsp;<span class="op" id="7745152">=</span>&nbsp;<span class="ident" id="7745154">fmt</span><span class="op" id="7745157">.</span><span class="ident" id="7745158">Sprintf</span><span class="op" id="7745165">(</span><span class="string" id="7745166">&#34;CharData(%q)&#34;</span><span class="op" id="7745180">,</span>&nbsp;<span class="ident" id="7745182">have</span><span class="op" id="7745186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7745191">}</span>&nbsp;<span class="keyword" id="7745193">else</span>&nbsp;<span class="op" id="7745198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7745204">shave</span>&nbsp;<span class="op" id="7745210">=</span>&nbsp;<span class="ident" id="7745212">fmt</span><span class="op" id="7745215">.</span><span class="ident" id="7745216">Sprintf</span><span class="op" id="7745223">(</span><span class="string" id="7745224">&#34;%#v&#34;</span><span class="op" id="7745229">,</span>&nbsp;<span class="ident" id="7745231">have</span><span class="op" id="7745235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7745240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745245">if</span>&nbsp;<span class="ident" id="7745248">_</span><span class="op" id="7745249">,</span>&nbsp;<span class="ident" id="7745251">ok</span>&nbsp;<span class="op" id="7745254">:=</span>&nbsp;<span class="ident" id="7745257">want</span><span class="op" id="7745261">.</span><span class="op" id="7745262">(</span><span class="ident" id="7745263">CharData</span><span class="op" id="7745271">)</span><span class="op" id="7745272">;</span>&nbsp;<span class="ident" id="7745274">ok</span>&nbsp;<span class="op" id="7745277">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7745283">swant</span>&nbsp;<span class="op" id="7745289">=</span>&nbsp;<span class="ident" id="7745291">fmt</span><span class="op" id="7745294">.</span><span class="ident" id="7745295">Sprintf</span><span class="op" id="7745302">(</span><span class="string" id="7745303">&#34;CharData(%q)&#34;</span><span class="op" id="7745317">,</span>&nbsp;<span class="ident" id="7745319">want</span><span class="op" id="7745323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7745328">}</span>&nbsp;<span class="keyword" id="7745330">else</span>&nbsp;<span class="op" id="7745335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7745341">swant</span>&nbsp;<span class="op" id="7745347">=</span>&nbsp;<span class="ident" id="7745349">fmt</span><span class="op" id="7745352">.</span><span class="ident" id="7745353">Sprintf</span><span class="op" id="7745360">(</span><span class="string" id="7745361">&#34;%#v&#34;</span><span class="op" id="7745366">,</span>&nbsp;<span class="ident" id="7745368">want</span><span class="op" id="7745372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7745377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7745382">t</span><span class="op" id="7745383">.</span><span class="ident" id="7745384">Errorf</span><span class="op" id="7745390">(</span><span class="string" id="7745391">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7745415">,</span>&nbsp;<span class="ident" id="7745417">i</span><span class="op" id="7745418">,</span>&nbsp;<span class="ident" id="7745420">shave</span><span class="op" id="7745425">,</span>&nbsp;<span class="ident" id="7745427">swant</span><span class="op" id="7745432">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7745436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7745441">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745492">switch</span>&nbsp;<span class="op" id="7745499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745503">case</span>&nbsp;<span class="ident" id="7745508">start</span>&nbsp;<span class="op" id="7745514">&lt;</span>&nbsp;<span class="ident" id="7745516">lastEnd</span><span class="op" id="7745523">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7745528">t</span><span class="op" id="7745529">.</span><span class="ident" id="7745530">Errorf</span><span class="op" id="7745536">(</span><span class="string" id="7745537">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="7745597">,</span>&nbsp;<span class="ident" id="7745599">i</span><span class="op" id="7745600">,</span>&nbsp;<span class="ident" id="7745602">start</span><span class="op" id="7745607">,</span>&nbsp;<span class="ident" id="7745609">end</span><span class="op" id="7745612">,</span>&nbsp;<span class="ident" id="7745614">have</span><span class="op" id="7745618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745622">case</span>&nbsp;<span class="ident" id="7745627">start</span>&nbsp;<span class="op" id="7745633">&gt;=</span>&nbsp;<span class="ident" id="7745636">end</span><span class="op" id="7745639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7745644">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745695">if</span>&nbsp;<span class="ident" id="7745698">start</span>&nbsp;<span class="op" id="7745704">==</span>&nbsp;<span class="ident" id="7745707">end</span>&nbsp;<span class="op" id="7745711">&amp;&amp;</span>&nbsp;<span class="ident" id="7745714">end</span>&nbsp;<span class="op" id="7745718">==</span>&nbsp;<span class="ident" id="7745721">lastEnd</span>&nbsp;<span class="op" id="7745729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745735">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7745744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7745749">t</span><span class="op" id="7745750">.</span><span class="ident" id="7745751">Errorf</span><span class="op" id="7745757">(</span><span class="string" id="7745758">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="7745802">,</span>&nbsp;<span class="ident" id="7745804">i</span><span class="op" id="7745805">,</span>&nbsp;<span class="ident" id="7745807">start</span><span class="op" id="7745812">,</span>&nbsp;<span class="ident" id="7745814">end</span><span class="op" id="7745817">,</span>&nbsp;<span class="ident" id="7745819">have</span><span class="op" id="7745823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745827">case</span>&nbsp;<span class="ident" id="7745832">end</span>&nbsp;<span class="op" id="7745836">&gt;</span>&nbsp;<span class="ident" id="7745838">int64</span><span class="op" id="7745843">(</span><span class="builtinfunc" id="7745844">len</span><span class="op" id="7745847">(</span><span class="ident" id="7745848">raw</span><span class="op" id="7745851">)</span><span class="op" id="7745852">)</span><span class="op" id="7745853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7745858">t</span><span class="op" id="7745859">.</span><span class="ident" id="7745860">Errorf</span><span class="op" id="7745866">(</span><span class="string" id="7745867">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="7745923">,</span>&nbsp;<span class="ident" id="7745925">i</span><span class="op" id="7745926">,</span>&nbsp;<span class="ident" id="7745928">start</span><span class="op" id="7745933">,</span>&nbsp;<span class="ident" id="7745935">end</span><span class="op" id="7745938">,</span>&nbsp;<span class="ident" id="7745940">have</span><span class="op" id="7745944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745948">default</span><span class="op" id="7745955">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7745960">text</span>&nbsp;<span class="op" id="7745965">:=</span>&nbsp;<span class="ident" id="7745968">raw</span><span class="op" id="7745971">[</span><span class="ident" id="7745972">start</span><span class="op" id="7745977">:</span><span class="ident" id="7745978">end</span><span class="op" id="7745981">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7745986">if</span>&nbsp;<span class="ident" id="7745989">strings</span><span class="op" id="7745996">.</span><span class="ident" id="7745997">ContainsAny</span><span class="op" id="7746008">(</span><span class="ident" id="7746009">text</span><span class="op" id="7746013">,</span>&nbsp;<span class="string" id="7746015">&#34;&lt;&gt;&#34;</span><span class="op" id="7746019">)</span>&nbsp;<span class="op" id="7746021">&amp;&amp;</span>&nbsp;<span class="op" id="7746024">(</span><span class="op" id="7746025">!</span><span class="ident" id="7746026">strings</span><span class="op" id="7746033">.</span><span class="ident" id="7746034">HasPrefix</span><span class="op" id="7746043">(</span><span class="ident" id="7746044">text</span><span class="op" id="7746048">,</span>&nbsp;<span class="string" id="7746050">&#34;&lt;&#34;</span><span class="op" id="7746053">)</span>&nbsp;<span class="op" id="7746055">||</span>&nbsp;<span class="op" id="7746058">!</span><span class="ident" id="7746059">strings</span><span class="op" id="7746066">.</span><span class="ident" id="7746067">HasSuffix</span><span class="op" id="7746076">(</span><span class="ident" id="7746077">text</span><span class="op" id="7746081">,</span>&nbsp;<span class="string" id="7746083">&#34;&gt;&#34;</span><span class="op" id="7746086">)</span><span class="op" id="7746087">)</span>&nbsp;<span class="op" id="7746089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746095">t</span><span class="op" id="7746096">.</span><span class="ident" id="7746097">Errorf</span><span class="op" id="7746103">(</span><span class="string" id="7746104">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="7746147">,</span>&nbsp;<span class="ident" id="7746149">i</span><span class="op" id="7746150">,</span>&nbsp;<span class="ident" id="7746152">text</span><span class="op" id="7746156">,</span>&nbsp;<span class="ident" id="7746158">have</span><span class="op" id="7746162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7746167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7746171">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746175">lastEnd</span>&nbsp;<span class="op" id="7746183">=</span>&nbsp;<span class="ident" id="7746185">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7746190">}</span><br>
<span class="lineno"></span><span class="op" id="7746192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7746195">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="7746266">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="7746334">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7746392">var</span>&nbsp;<span class="ident" id="7746396">nestedDirectivesInput</span>&nbsp;<span class="op" id="7746418">=</span>&nbsp;<span class="string" id="7746420">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7746686">var</span>&nbsp;<span class="ident" id="7746690">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7746713">=</span>&nbsp;<span class="op" id="7746715">[</span><span class="op" id="7746716">]</span><span class="ident" id="7746717">Token</span><span class="op" id="7746722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746725">CharData</span><span class="op" id="7746733">(</span><span class="string" id="7746734">&#34;\n&#34;</span><span class="op" id="7746738">)</span><span class="op" id="7746739">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746742">Directive</span><span class="op" id="7746751">(</span><span class="string" id="7746752">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7746823">)</span><span class="op" id="7746824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746827">CharData</span><span class="op" id="7746835">(</span><span class="string" id="7746836">&#34;\n&#34;</span><span class="op" id="7746840">)</span><span class="op" id="7746841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746844">Directive</span><span class="op" id="7746853">(</span><span class="string" id="7746854">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="7746883">)</span><span class="op" id="7746884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746887">CharData</span><span class="op" id="7746895">(</span><span class="string" id="7746896">&#34;\n&#34;</span><span class="op" id="7746900">)</span><span class="op" id="7746901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746904">Directive</span><span class="op" id="7746913">(</span><span class="string" id="7746914">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="7746943">)</span><span class="op" id="7746944">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746947">CharData</span><span class="op" id="7746955">(</span><span class="string" id="7746956">&#34;\n&#34;</span><span class="op" id="7746960">)</span><span class="op" id="7746961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7746964">Directive</span><span class="op" id="7746973">(</span><span class="string" id="7746974">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="7747003">)</span><span class="op" id="7747004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747007">CharData</span><span class="op" id="7747015">(</span><span class="string" id="7747016">&#34;\n&#34;</span><span class="op" id="7747020">)</span><span class="op" id="7747021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747024">Directive</span><span class="op" id="7747033">(</span><span class="string" id="7747034">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="7747063">)</span><span class="op" id="7747064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747067">CharData</span><span class="op" id="7747075">(</span><span class="string" id="7747076">&#34;\n&#34;</span><span class="op" id="7747080">)</span><span class="op" id="7747081">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747084">Directive</span><span class="op" id="7747093">(</span><span class="string" id="7747094">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="7747124">)</span><span class="op" id="7747125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747128">CharData</span><span class="op" id="7747136">(</span><span class="string" id="7747137">&#34;\n&#34;</span><span class="op" id="7747141">)</span><span class="op" id="7747142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747145">Directive</span><span class="op" id="7747154">(</span><span class="string" id="7747155">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="7747185">)</span><span class="op" id="7747186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747189">CharData</span><span class="op" id="7747197">(</span><span class="string" id="7747198">&#34;\n&#34;</span><span class="op" id="7747202">)</span><span class="op" id="7747203">,</span><br>
<span class="lineno"></span><span class="op" id="7747205">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="7747208">func</span>&nbsp;<span class="ident" id="7747213">TestNestedDirectives</span><span class="op" id="7747233">(</span><span class="ident" id="7747234">t</span>&nbsp;<span class="op" id="7747236">*</span><span class="ident" id="7747237">testing</span><span class="op" id="7747244">.</span><span class="ident" id="7747245">T</span><span class="op" id="7747246">)</span>&nbsp;<span class="op" id="7747248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747251">d</span>&nbsp;<span class="op" id="7747253">:=</span>&nbsp;<span class="ident" id="7747256">NewDecoder</span><span class="op" id="7747266">(</span><span class="ident" id="7747267">strings</span><span class="op" id="7747274">.</span><span class="ident" id="7747275">NewReader</span><span class="op" id="7747284">(</span><span class="ident" id="7747285">nestedDirectivesInput</span><span class="op" id="7747306">)</span><span class="op" id="7747307">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7747311">for</span>&nbsp;<span class="ident" id="7747315">i</span><span class="op" id="7747316">,</span>&nbsp;<span class="ident" id="7747318">want</span>&nbsp;<span class="op" id="7747323">:=</span>&nbsp;<span class="keyword" id="7747326">range</span>&nbsp;<span class="ident" id="7747332">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7747355">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747359">have</span><span class="op" id="7747363">,</span>&nbsp;<span class="ident" id="7747365">err</span>&nbsp;<span class="op" id="7747369">:=</span>&nbsp;<span class="ident" id="7747372">d</span><span class="op" id="7747373">.</span><span class="ident" id="7747374">Token</span><span class="op" id="7747379">(</span><span class="op" id="7747380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7747384">if</span>&nbsp;<span class="ident" id="7747387">err</span>&nbsp;<span class="op" id="7747391">!=</span>&nbsp;<span class="ident" id="7747394">nil</span>&nbsp;<span class="op" id="7747398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747403">t</span><span class="op" id="7747404">.</span><span class="ident" id="7747405">Fatalf</span><span class="op" id="7747411">(</span><span class="string" id="7747412">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7747444">,</span>&nbsp;<span class="ident" id="7747446">i</span><span class="op" id="7747447">,</span>&nbsp;<span class="ident" id="7747449">err</span><span class="op" id="7747452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7747456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7747460">if</span>&nbsp;<span class="op" id="7747463">!</span><span class="ident" id="7747464">reflect</span><span class="op" id="7747471">.</span><span class="ident" id="7747472">DeepEqual</span><span class="op" id="7747481">(</span><span class="ident" id="7747482">have</span><span class="op" id="7747486">,</span>&nbsp;<span class="ident" id="7747488">want</span><span class="op" id="7747492">)</span>&nbsp;<span class="op" id="7747494">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747499">t</span><span class="op" id="7747500">.</span><span class="ident" id="7747501">Errorf</span><span class="op" id="7747507">(</span><span class="string" id="7747508">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7747533">,</span>&nbsp;<span class="ident" id="7747535">i</span><span class="op" id="7747536">,</span>&nbsp;<span class="ident" id="7747538">have</span><span class="op" id="7747542">,</span>&nbsp;<span class="ident" id="7747544">want</span><span class="op" id="7747548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7747552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7747555">}</span><br>
<span class="lineno"></span><span class="op" id="7747557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="7747560">func</span>&nbsp;<span class="ident" id="7747565">TestToken</span><span class="op" id="7747574">(</span><span class="ident" id="7747575">t</span>&nbsp;<span class="op" id="7747577">*</span><span class="ident" id="7747578">testing</span><span class="op" id="7747585">.</span><span class="ident" id="7747586">T</span><span class="op" id="7747587">)</span>&nbsp;<span class="op" id="7747589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747592">d</span>&nbsp;<span class="op" id="7747594">:=</span>&nbsp;<span class="ident" id="7747597">NewDecoder</span><span class="op" id="7747607">(</span><span class="ident" id="7747608">strings</span><span class="op" id="7747615">.</span><span class="ident" id="7747616">NewReader</span><span class="op" id="7747625">(</span><span class="ident" id="7747626">testInput</span><span class="op" id="7747635">)</span><span class="op" id="7747636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747639">d</span><span class="op" id="7747640">.</span><span class="ident" id="7747641">Entity</span>&nbsp;<span class="op" id="7747648">=</span>&nbsp;<span class="ident" id="7747650">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7747663">for</span>&nbsp;<span class="ident" id="7747667">i</span><span class="op" id="7747668">,</span>&nbsp;<span class="ident" id="7747670">want</span>&nbsp;<span class="op" id="7747675">:=</span>&nbsp;<span class="keyword" id="7747678">range</span>&nbsp;<span class="ident" id="7747684">cookedTokens</span>&nbsp;<span class="op" id="7747697">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747701">have</span><span class="op" id="7747705">,</span>&nbsp;<span class="ident" id="7747707">err</span>&nbsp;<span class="op" id="7747711">:=</span>&nbsp;<span class="ident" id="7747714">d</span><span class="op" id="7747715">.</span><span class="ident" id="7747716">Token</span><span class="op" id="7747721">(</span><span class="op" id="7747722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7747726">if</span>&nbsp;<span class="ident" id="7747729">err</span>&nbsp;<span class="op" id="7747733">!=</span>&nbsp;<span class="ident" id="7747736">nil</span>&nbsp;<span class="op" id="7747740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747745">t</span><span class="op" id="7747746">.</span><span class="ident" id="7747747">Fatalf</span><span class="op" id="7747753">(</span><span class="string" id="7747754">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7747786">,</span>&nbsp;<span class="ident" id="7747788">i</span><span class="op" id="7747789">,</span>&nbsp;<span class="ident" id="7747791">err</span><span class="op" id="7747794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7747798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7747802">if</span>&nbsp;<span class="op" id="7747805">!</span><span class="ident" id="7747806">reflect</span><span class="op" id="7747813">.</span><span class="ident" id="7747814">DeepEqual</span><span class="op" id="7747823">(</span><span class="ident" id="7747824">have</span><span class="op" id="7747828">,</span>&nbsp;<span class="ident" id="7747830">want</span><span class="op" id="7747834">)</span>&nbsp;<span class="op" id="7747836">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747841">t</span><span class="op" id="7747842">.</span><span class="ident" id="7747843">Errorf</span><span class="op" id="7747849">(</span><span class="string" id="7747850">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7747875">,</span>&nbsp;<span class="ident" id="7747877">i</span><span class="op" id="7747878">,</span>&nbsp;<span class="ident" id="7747880">have</span><span class="op" id="7747884">,</span>&nbsp;<span class="ident" id="7747886">want</span><span class="op" id="7747890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7747894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7747897">}</span><br>
<span class="lineno"></span><span class="op" id="7747899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="7747902">func</span>&nbsp;<span class="ident" id="7747907">TestSyntax</span><span class="op" id="7747917">(</span><span class="ident" id="7747918">t</span>&nbsp;<span class="op" id="7747920">*</span><span class="ident" id="7747921">testing</span><span class="op" id="7747928">.</span><span class="ident" id="7747929">T</span><span class="op" id="7747930">)</span>&nbsp;<span class="op" id="7747932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7747935">for</span>&nbsp;<span class="ident" id="7747939">i</span>&nbsp;<span class="op" id="7747941">:=</span>&nbsp;<span class="keyword" id="7747944">range</span>&nbsp;<span class="ident" id="7747950">xmlInput</span>&nbsp;<span class="op" id="7747959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7747963">d</span>&nbsp;<span class="op" id="7747965">:=</span>&nbsp;<span class="ident" id="7747968">NewDecoder</span><span class="op" id="7747978">(</span><span class="ident" id="7747979">strings</span><span class="op" id="7747986">.</span><span class="ident" id="7747987">NewReader</span><span class="op" id="7747996">(</span><span class="ident" id="7747997">xmlInput</span><span class="op" id="7748005">[</span><span class="ident" id="7748006">i</span><span class="op" id="7748007">]</span><span class="op" id="7748008">)</span><span class="op" id="7748009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7748013">var</span>&nbsp;<span class="ident" id="7748017">err</span>&nbsp;<span class="builtintype" id="7748021">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7748029">for</span>&nbsp;<span class="ident" id="7748033">_</span><span class="op" id="7748034">,</span>&nbsp;<span class="ident" id="7748036">err</span>&nbsp;<span class="op" id="7748040">=</span>&nbsp;<span class="ident" id="7748042">d</span><span class="op" id="7748043">.</span><span class="ident" id="7748044">Token</span><span class="op" id="7748049">(</span><span class="op" id="7748050">)</span><span class="op" id="7748051">;</span>&nbsp;<span class="ident" id="7748053">err</span>&nbsp;<span class="op" id="7748057">==</span>&nbsp;<span class="ident" id="7748060">nil</span><span class="op" id="7748063">;</span>&nbsp;<span class="ident" id="7748065">_</span><span class="op" id="7748066">,</span>&nbsp;<span class="ident" id="7748068">err</span>&nbsp;<span class="op" id="7748072">=</span>&nbsp;<span class="ident" id="7748074">d</span><span class="op" id="7748075">.</span><span class="ident" id="7748076">Token</span><span class="op" id="7748081">(</span><span class="op" id="7748082">)</span>&nbsp;<span class="op" id="7748084">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7748088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7748092">if</span>&nbsp;<span class="ident" id="7748095">_</span><span class="op" id="7748096">,</span>&nbsp;<span class="ident" id="7748098">ok</span>&nbsp;<span class="op" id="7748101">:=</span>&nbsp;<span class="ident" id="7748104">err</span><span class="op" id="7748107">.</span><span class="op" id="7748108">(</span><span class="op" id="7748109">*</span><span class="ident" id="7748110">SyntaxError</span><span class="op" id="7748121">)</span><span class="op" id="7748122">;</span>&nbsp;<span class="op" id="7748124">!</span><span class="ident" id="7748125">ok</span>&nbsp;<span class="op" id="7748128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748133">t</span><span class="op" id="7748134">.</span><span class="ident" id="7748135">Fatalf</span><span class="op" id="7748141">(</span><span class="string" id="7748142">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="7748192">,</span>&nbsp;<span class="ident" id="7748194">xmlInput</span><span class="op" id="7748202">[</span><span class="ident" id="7748203">i</span><span class="op" id="7748204">]</span><span class="op" id="7748205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7748209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7748212">}</span><br>
<span class="lineno">400</span><span class="op" id="7748214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7748217">type</span>&nbsp;<span class="ident" id="7748222">allScalars</span>&nbsp;<span class="keyword" id="7748233">struct</span>&nbsp;<span class="op" id="7748240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748243">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748253">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748259">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748269">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748275">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748285">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748291">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748301">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748307">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748317">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748322">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748332">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748338">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748348">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748355">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748365">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748372">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7748382">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748389">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748399">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748404">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748414">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748421">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748431">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748439">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748449">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748457">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7748467">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748475">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748485">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748494">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748504">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748513">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748523">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748532">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748542">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748550">PtrString</span>&nbsp;<span class="op" id="7748560">*</span><span class="builtintype" id="7748561">string</span><br>
<span class="lineno"></span><span class="op" id="7748568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7748571">var</span>&nbsp;<span class="ident" id="7748575">all</span>&nbsp;<span class="op" id="7748579">=</span>&nbsp;<span class="ident" id="7748581">allScalars</span><span class="op" id="7748591">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748594">True1</span><span class="op" id="7748599">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748605">true</span><span class="op" id="7748609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748612">True2</span><span class="op" id="7748617">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748623">true</span><span class="op" id="7748627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748630">False1</span><span class="op" id="7748636">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748641">false</span><span class="op" id="7748646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748649">False2</span><span class="op" id="7748655">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7748660">false</span><span class="op" id="7748665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748668">Int</span><span class="op" id="7748671">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7748679">1</span><span class="op" id="7748680">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748683">Int8</span><span class="op" id="7748687">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7748694">-</span><span class="num" id="7748695">2</span><span class="op" id="7748696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748699">Int16</span><span class="op" id="7748704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7748710">3</span><span class="op" id="7748711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748714">Int32</span><span class="op" id="7748719">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7748725">-</span><span class="num" id="7748726">4</span><span class="op" id="7748727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748730">Int64</span><span class="op" id="7748735">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7748741">5</span><span class="op" id="7748742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748745">Uint</span><span class="op" id="7748749">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7748756">6</span><span class="op" id="7748757">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748760">Uint8</span><span class="op" id="7748765">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7748771">7</span><span class="op" id="7748772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748775">Uint16</span><span class="op" id="7748781">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7748786">8</span><span class="op" id="7748787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748790">Uint32</span><span class="op" id="7748796">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7748801">9</span><span class="op" id="7748802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748805">Uint64</span><span class="op" id="7748811">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7748816">10</span><span class="op" id="7748818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748821">Uintptr</span><span class="op" id="7748828">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7748832">11</span><span class="op" id="7748834">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748837">Float32</span><span class="op" id="7748844">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7748848">13.0</span><span class="op" id="7748852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748855">Float64</span><span class="op" id="7748862">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7748866">14.0</span><span class="op" id="7748870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748873">String</span><span class="op" id="7748879">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7748884">&#34;15&#34;</span><span class="op" id="7748888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7748891">PtrString</span><span class="op" id="7748900">:</span>&nbsp;<span class="op" id="7748902">&amp;</span><span class="ident" id="7748903">sixteen</span><span class="op" id="7748910">,</span><br>
<span class="lineno"></span><span class="op" id="7748912">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="7748915">var</span>&nbsp;<span class="ident" id="7748919">sixteen</span>&nbsp;<span class="op" id="7748927">=</span>&nbsp;<span class="string" id="7748929">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7748935">const</span>&nbsp;<span class="ident" id="7748941">testScalarsInput</span>&nbsp;<span class="op" id="7748958">=</span>&nbsp;<span class="string" id="7748960">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="7749396">func</span>&nbsp;<span class="ident" id="7749401">TestAllScalars</span><span class="op" id="7749415">(</span><span class="ident" id="7749416">t</span>&nbsp;<span class="op" id="7749418">*</span><span class="ident" id="7749419">testing</span><span class="op" id="7749426">.</span><span class="ident" id="7749427">T</span><span class="op" id="7749428">)</span>&nbsp;<span class="op" id="7749430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7749433">var</span>&nbsp;<span class="ident" id="7749437">a</span>&nbsp;<span class="ident" id="7749439">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749451">err</span>&nbsp;<span class="op" id="7749455">:=</span>&nbsp;<span class="ident" id="7749458">Unmarshal</span><span class="op" id="7749467">(</span><span class="op" id="7749468">[</span><span class="op" id="7749469">]</span><span class="builtintype" id="7749470">byte</span><span class="op" id="7749474">(</span><span class="ident" id="7749475">testScalarsInput</span><span class="op" id="7749491">)</span><span class="op" id="7749492">,</span>&nbsp;<span class="op" id="7749494">&amp;</span><span class="ident" id="7749495">a</span><span class="op" id="7749496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7749500">if</span>&nbsp;<span class="ident" id="7749503">err</span>&nbsp;<span class="op" id="7749507">!=</span>&nbsp;<span class="ident" id="7749510">nil</span>&nbsp;<span class="op" id="7749514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749518">t</span><span class="op" id="7749519">.</span><span class="ident" id="7749520">Fatal</span><span class="op" id="7749525">(</span><span class="ident" id="7749526">err</span><span class="op" id="7749529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7749532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7749535">if</span>&nbsp;<span class="op" id="7749538">!</span><span class="ident" id="7749539">reflect</span><span class="op" id="7749546">.</span><span class="ident" id="7749547">DeepEqual</span><span class="op" id="7749556">(</span><span class="ident" id="7749557">a</span><span class="op" id="7749558">,</span>&nbsp;<span class="ident" id="7749560">all</span><span class="op" id="7749563">)</span>&nbsp;<span class="op" id="7749565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749569">t</span><span class="op" id="7749570">.</span><span class="ident" id="7749571">Errorf</span><span class="op" id="7749577">(</span><span class="string" id="7749578">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="7749597">,</span>&nbsp;<span class="ident" id="7749599">a</span><span class="op" id="7749600">,</span>&nbsp;<span class="ident" id="7749602">all</span><span class="op" id="7749605">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7749608">}</span><br>
<span class="lineno"></span><span class="op" id="7749610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7749613">type</span>&nbsp;<span class="ident" id="7749618">item</span>&nbsp;<span class="keyword" id="7749623">struct</span>&nbsp;<span class="op" id="7749630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749633">Field_a</span>&nbsp;<span class="builtintype" id="7749641">string</span><br>
<span class="lineno">485</span><span class="op" id="7749648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7749651">func</span>&nbsp;<span class="ident" id="7749656">TestIssue569</span><span class="op" id="7749668">(</span><span class="ident" id="7749669">t</span>&nbsp;<span class="op" id="7749671">*</span><span class="ident" id="7749672">testing</span><span class="op" id="7749679">.</span><span class="ident" id="7749680">T</span><span class="op" id="7749681">)</span>&nbsp;<span class="op" id="7749683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749686">data</span>&nbsp;<span class="op" id="7749691">:=</span>&nbsp;<span class="string" id="7749694">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7749734">var</span>&nbsp;<span class="ident" id="7749738">i</span>&nbsp;<span class="ident" id="7749740">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749746">err</span>&nbsp;<span class="op" id="7749750">:=</span>&nbsp;<span class="ident" id="7749753">Unmarshal</span><span class="op" id="7749762">(</span><span class="op" id="7749763">[</span><span class="op" id="7749764">]</span><span class="builtintype" id="7749765">byte</span><span class="op" id="7749769">(</span><span class="ident" id="7749770">data</span><span class="op" id="7749774">)</span><span class="op" id="7749775">,</span>&nbsp;<span class="op" id="7749777">&amp;</span><span class="ident" id="7749778">i</span><span class="op" id="7749779">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7749783">if</span>&nbsp;<span class="ident" id="7749786">err</span>&nbsp;<span class="op" id="7749790">!=</span>&nbsp;<span class="ident" id="7749793">nil</span>&nbsp;<span class="op" id="7749797">||</span>&nbsp;<span class="ident" id="7749800">i</span><span class="op" id="7749801">.</span><span class="ident" id="7749802">Field_a</span>&nbsp;<span class="op" id="7749810">!=</span>&nbsp;<span class="string" id="7749813">&#34;abcd&#34;</span>&nbsp;<span class="op" id="7749820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749824">t</span><span class="op" id="7749825">.</span><span class="ident" id="7749826">Fatal</span><span class="op" id="7749831">(</span><span class="string" id="7749832">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="7749848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7749851">}</span><br>
<span class="lineno">495</span><span class="op" id="7749853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7749856">func</span>&nbsp;<span class="ident" id="7749861">TestUnquotedAttrs</span><span class="op" id="7749878">(</span><span class="ident" id="7749879">t</span>&nbsp;<span class="op" id="7749881">*</span><span class="ident" id="7749882">testing</span><span class="op" id="7749889">.</span><span class="ident" id="7749890">T</span><span class="op" id="7749891">)</span>&nbsp;<span class="op" id="7749893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749896">data</span>&nbsp;<span class="op" id="7749901">:=</span>&nbsp;<span class="string" id="7749904">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749930">d</span>&nbsp;<span class="op" id="7749932">:=</span>&nbsp;<span class="ident" id="7749935">NewDecoder</span><span class="op" id="7749945">(</span><span class="ident" id="7749946">strings</span><span class="op" id="7749953">.</span><span class="ident" id="7749954">NewReader</span><span class="op" id="7749963">(</span><span class="ident" id="7749964">data</span><span class="op" id="7749968">)</span><span class="op" id="7749969">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749972">d</span><span class="op" id="7749973">.</span><span class="ident" id="7749974">Strict</span>&nbsp;<span class="op" id="7749981">=</span>&nbsp;<span class="builtintype" id="7749983">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7749990">token</span><span class="op" id="7749995">,</span>&nbsp;<span class="ident" id="7749997">err</span>&nbsp;<span class="op" id="7750001">:=</span>&nbsp;<span class="ident" id="7750004">d</span><span class="op" id="7750005">.</span><span class="ident" id="7750006">Token</span><span class="op" id="7750011">(</span><span class="op" id="7750012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7750015">if</span>&nbsp;<span class="ident" id="7750018">_</span><span class="op" id="7750019">,</span>&nbsp;<span class="ident" id="7750021">ok</span>&nbsp;<span class="op" id="7750024">:=</span>&nbsp;<span class="ident" id="7750027">err</span><span class="op" id="7750030">.</span><span class="op" id="7750031">(</span><span class="op" id="7750032">*</span><span class="ident" id="7750033">SyntaxError</span><span class="op" id="7750044">)</span><span class="op" id="7750045">;</span>&nbsp;<span class="ident" id="7750047">ok</span>&nbsp;<span class="op" id="7750050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750054">t</span><span class="op" id="7750055">.</span><span class="ident" id="7750056">Errorf</span><span class="op" id="7750062">(</span><span class="string" id="7750063">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7750085">,</span>&nbsp;<span class="ident" id="7750087">err</span><span class="op" id="7750090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750093">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7750096">if</span>&nbsp;<span class="ident" id="7750099">token</span><span class="op" id="7750104">.</span><span class="op" id="7750105">(</span><span class="ident" id="7750106">StartElement</span><span class="op" id="7750118">)</span><span class="op" id="7750119">.</span><span class="ident" id="7750120">Name</span><span class="op" id="7750124">.</span><span class="ident" id="7750125">Local</span>&nbsp;<span class="op" id="7750131">!=</span>&nbsp;<span class="string" id="7750134">&#34;tag&#34;</span>&nbsp;<span class="op" id="7750140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750144">t</span><span class="op" id="7750145">.</span><span class="ident" id="7750146">Errorf</span><span class="op" id="7750152">(</span><span class="string" id="7750153">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7750178">,</span>&nbsp;<span class="ident" id="7750180">token</span><span class="op" id="7750185">.</span><span class="op" id="7750186">(</span><span class="ident" id="7750187">StartElement</span><span class="op" id="7750199">)</span><span class="op" id="7750200">.</span><span class="ident" id="7750201">Name</span><span class="op" id="7750205">.</span><span class="ident" id="7750206">Local</span><span class="op" id="7750211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750217">attr</span>&nbsp;<span class="op" id="7750222">:=</span>&nbsp;<span class="ident" id="7750225">token</span><span class="op" id="7750230">.</span><span class="op" id="7750231">(</span><span class="ident" id="7750232">StartElement</span><span class="op" id="7750244">)</span><span class="op" id="7750245">.</span><span class="ident" id="7750246">Attr</span><span class="op" id="7750250">[</span><span class="num" id="7750251">0</span><span class="op" id="7750252">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7750255">if</span>&nbsp;<span class="ident" id="7750258">attr</span><span class="op" id="7750262">.</span><span class="ident" id="7750263">Value</span>&nbsp;<span class="op" id="7750269">!=</span>&nbsp;<span class="string" id="7750272">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="7750284">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750288">t</span><span class="op" id="7750289">.</span><span class="ident" id="7750290">Errorf</span><span class="op" id="7750296">(</span><span class="string" id="7750297">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7750329">,</span>&nbsp;<span class="ident" id="7750331">attr</span><span class="op" id="7750335">.</span><span class="ident" id="7750336">Value</span><span class="op" id="7750341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7750347">if</span>&nbsp;<span class="ident" id="7750350">attr</span><span class="op" id="7750354">.</span><span class="ident" id="7750355">Name</span><span class="op" id="7750359">.</span><span class="ident" id="7750360">Local</span>&nbsp;<span class="op" id="7750366">!=</span>&nbsp;<span class="string" id="7750369">&#34;attr&#34;</span>&nbsp;<span class="op" id="7750376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750380">t</span><span class="op" id="7750381">.</span><span class="ident" id="7750382">Errorf</span><span class="op" id="7750388">(</span><span class="string" id="7750389">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7750420">,</span>&nbsp;<span class="ident" id="7750422">attr</span><span class="op" id="7750426">.</span><span class="ident" id="7750427">Name</span><span class="op" id="7750431">.</span><span class="ident" id="7750432">Local</span><span class="op" id="7750437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750440">}</span><br>
<span class="lineno">515</span><span class="op" id="7750442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7750445">func</span>&nbsp;<span class="ident" id="7750450">TestValuelessAttrs</span><span class="op" id="7750468">(</span><span class="ident" id="7750469">t</span>&nbsp;<span class="op" id="7750471">*</span><span class="ident" id="7750472">testing</span><span class="op" id="7750479">.</span><span class="ident" id="7750480">T</span><span class="op" id="7750481">)</span>&nbsp;<span class="op" id="7750483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750486">tests</span>&nbsp;<span class="op" id="7750492">:=</span>&nbsp;<span class="op" id="7750495">[</span><span class="op" id="7750496">]</span><span class="op" id="7750497">[</span><span class="num" id="7750498">3</span><span class="op" id="7750499">]</span><span class="builtintype" id="7750500">string</span><span class="op" id="7750506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750510">{</span><span class="string" id="7750511">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="7750523">,</span>&nbsp;<span class="string" id="7750525">&#34;p&#34;</span><span class="op" id="7750528">,</span>&nbsp;<span class="string" id="7750530">&#34;nowrap&#34;</span><span class="op" id="7750538">}</span><span class="op" id="7750539">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750543">{</span><span class="string" id="7750544">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="7750557">,</span>&nbsp;<span class="string" id="7750559">&#34;p&#34;</span><span class="op" id="7750562">,</span>&nbsp;<span class="string" id="7750564">&#34;nowrap&#34;</span><span class="op" id="7750572">}</span><span class="op" id="7750573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750577">{</span><span class="string" id="7750578">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="7750596">,</span>&nbsp;<span class="string" id="7750598">&#34;input&#34;</span><span class="op" id="7750605">,</span>&nbsp;<span class="string" id="7750607">&#34;checked&#34;</span><span class="op" id="7750616">}</span><span class="op" id="7750617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750621">{</span><span class="string" id="7750622">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="7750641">,</span>&nbsp;<span class="string" id="7750643">&#34;input&#34;</span><span class="op" id="7750650">,</span>&nbsp;<span class="string" id="7750652">&#34;checked&#34;</span><span class="op" id="7750661">}</span><span class="op" id="7750662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7750668">for</span>&nbsp;<span class="ident" id="7750672">_</span><span class="op" id="7750673">,</span>&nbsp;<span class="ident" id="7750675">test</span>&nbsp;<span class="op" id="7750680">:=</span>&nbsp;<span class="keyword" id="7750683">range</span>&nbsp;<span class="ident" id="7750689">tests</span>&nbsp;<span class="op" id="7750695">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750699">d</span>&nbsp;<span class="op" id="7750701">:=</span>&nbsp;<span class="ident" id="7750704">NewDecoder</span><span class="op" id="7750714">(</span><span class="ident" id="7750715">strings</span><span class="op" id="7750722">.</span><span class="ident" id="7750723">NewReader</span><span class="op" id="7750732">(</span><span class="ident" id="7750733">test</span><span class="op" id="7750737">[</span><span class="num" id="7750738">0</span><span class="op" id="7750739">]</span><span class="op" id="7750740">)</span><span class="op" id="7750741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750745">d</span><span class="op" id="7750746">.</span><span class="ident" id="7750747">Strict</span>&nbsp;<span class="op" id="7750754">=</span>&nbsp;<span class="builtintype" id="7750756">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750764">token</span><span class="op" id="7750769">,</span>&nbsp;<span class="ident" id="7750771">err</span>&nbsp;<span class="op" id="7750775">:=</span>&nbsp;<span class="ident" id="7750778">d</span><span class="op" id="7750779">.</span><span class="ident" id="7750780">Token</span><span class="op" id="7750785">(</span><span class="op" id="7750786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7750790">if</span>&nbsp;<span class="ident" id="7750793">_</span><span class="op" id="7750794">,</span>&nbsp;<span class="ident" id="7750796">ok</span>&nbsp;<span class="op" id="7750799">:=</span>&nbsp;<span class="ident" id="7750802">err</span><span class="op" id="7750805">.</span><span class="op" id="7750806">(</span><span class="op" id="7750807">*</span><span class="ident" id="7750808">SyntaxError</span><span class="op" id="7750819">)</span><span class="op" id="7750820">;</span>&nbsp;<span class="ident" id="7750822">ok</span>&nbsp;<span class="op" id="7750825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750830">t</span><span class="op" id="7750831">.</span><span class="ident" id="7750832">Errorf</span><span class="op" id="7750838">(</span><span class="string" id="7750839">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7750861">,</span>&nbsp;<span class="ident" id="7750863">err</span><span class="op" id="7750866">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7750874">if</span>&nbsp;<span class="ident" id="7750877">token</span><span class="op" id="7750882">.</span><span class="op" id="7750883">(</span><span class="ident" id="7750884">StartElement</span><span class="op" id="7750896">)</span><span class="op" id="7750897">.</span><span class="ident" id="7750898">Name</span><span class="op" id="7750902">.</span><span class="ident" id="7750903">Local</span>&nbsp;<span class="op" id="7750909">!=</span>&nbsp;<span class="ident" id="7750912">test</span><span class="op" id="7750916">[</span><span class="num" id="7750917">1</span><span class="op" id="7750918">]</span>&nbsp;<span class="op" id="7750920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7750925">t</span><span class="op" id="7750926">.</span><span class="ident" id="7750927">Errorf</span><span class="op" id="7750933">(</span><span class="string" id="7750934">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7750959">,</span>&nbsp;<span class="ident" id="7750961">token</span><span class="op" id="7750966">.</span><span class="op" id="7750967">(</span><span class="ident" id="7750968">StartElement</span><span class="op" id="7750980">)</span><span class="op" id="7750981">.</span><span class="ident" id="7750982">Name</span><span class="op" id="7750986">.</span><span class="ident" id="7750987">Local</span><span class="op" id="7750992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7750996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751000">attr</span>&nbsp;<span class="op" id="7751005">:=</span>&nbsp;<span class="ident" id="7751008">token</span><span class="op" id="7751013">.</span><span class="op" id="7751014">(</span><span class="ident" id="7751015">StartElement</span><span class="op" id="7751027">)</span><span class="op" id="7751028">.</span><span class="ident" id="7751029">Attr</span><span class="op" id="7751033">[</span><span class="num" id="7751034">0</span><span class="op" id="7751035">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751039">if</span>&nbsp;<span class="ident" id="7751042">attr</span><span class="op" id="7751046">.</span><span class="ident" id="7751047">Value</span>&nbsp;<span class="op" id="7751053">!=</span>&nbsp;<span class="ident" id="7751056">test</span><span class="op" id="7751060">[</span><span class="num" id="7751061">2</span><span class="op" id="7751062">]</span>&nbsp;<span class="op" id="7751064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751069">t</span><span class="op" id="7751070">.</span><span class="ident" id="7751071">Errorf</span><span class="op" id="7751077">(</span><span class="string" id="7751078">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7751110">,</span>&nbsp;<span class="ident" id="7751112">attr</span><span class="op" id="7751116">.</span><span class="ident" id="7751117">Value</span><span class="op" id="7751122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751130">if</span>&nbsp;<span class="ident" id="7751133">attr</span><span class="op" id="7751137">.</span><span class="ident" id="7751138">Name</span><span class="op" id="7751142">.</span><span class="ident" id="7751143">Local</span>&nbsp;<span class="op" id="7751149">!=</span>&nbsp;<span class="ident" id="7751152">test</span><span class="op" id="7751156">[</span><span class="num" id="7751157">2</span><span class="op" id="7751158">]</span>&nbsp;<span class="op" id="7751160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751165">t</span><span class="op" id="7751166">.</span><span class="ident" id="7751167">Errorf</span><span class="op" id="7751173">(</span><span class="string" id="7751174">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7751205">,</span>&nbsp;<span class="ident" id="7751207">attr</span><span class="op" id="7751211">.</span><span class="ident" id="7751212">Name</span><span class="op" id="7751216">.</span><span class="ident" id="7751217">Local</span><span class="op" id="7751222">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751229">}</span><br>
<span class="lineno"></span><span class="op" id="7751231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7751234">func</span>&nbsp;<span class="ident" id="7751239">TestCopyTokenCharData</span><span class="op" id="7751260">(</span><span class="ident" id="7751261">t</span>&nbsp;<span class="op" id="7751263">*</span><span class="ident" id="7751264">testing</span><span class="op" id="7751271">.</span><span class="ident" id="7751272">T</span><span class="op" id="7751273">)</span>&nbsp;<span class="op" id="7751275">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751278">data</span>&nbsp;<span class="op" id="7751283">:=</span>&nbsp;<span class="op" id="7751286">[</span><span class="op" id="7751287">]</span><span class="builtintype" id="7751288">byte</span><span class="op" id="7751292">(</span><span class="string" id="7751293">&#34;same&nbsp;data&#34;</span><span class="op" id="7751304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751307">var</span>&nbsp;<span class="ident" id="7751311">tok1</span>&nbsp;<span class="ident" id="7751316">Token</span>&nbsp;<span class="op" id="7751322">=</span>&nbsp;<span class="ident" id="7751324">CharData</span><span class="op" id="7751332">(</span><span class="ident" id="7751333">data</span><span class="op" id="7751337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751340">tok2</span>&nbsp;<span class="op" id="7751345">:=</span>&nbsp;<span class="ident" id="7751348">CopyToken</span><span class="op" id="7751357">(</span><span class="ident" id="7751358">tok1</span><span class="op" id="7751362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751365">if</span>&nbsp;<span class="op" id="7751368">!</span><span class="ident" id="7751369">reflect</span><span class="op" id="7751376">.</span><span class="ident" id="7751377">DeepEqual</span><span class="op" id="7751386">(</span><span class="ident" id="7751387">tok1</span><span class="op" id="7751391">,</span>&nbsp;<span class="ident" id="7751393">tok2</span><span class="op" id="7751397">)</span>&nbsp;<span class="op" id="7751399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751403">t</span><span class="op" id="7751404">.</span><span class="ident" id="7751405">Error</span><span class="op" id="7751410">(</span><span class="string" id="7751411">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="7751444">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751450">data</span><span class="op" id="7751454">[</span><span class="num" id="7751455">1</span><span class="op" id="7751456">]</span>&nbsp;<span class="op" id="7751458">=</span>&nbsp;<span class="string" id="7751460">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751465">if</span>&nbsp;<span class="ident" id="7751468">reflect</span><span class="op" id="7751475">.</span><span class="ident" id="7751476">DeepEqual</span><span class="op" id="7751485">(</span><span class="ident" id="7751486">tok1</span><span class="op" id="7751490">,</span>&nbsp;<span class="ident" id="7751492">tok2</span><span class="op" id="7751496">)</span>&nbsp;<span class="op" id="7751498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751502">t</span><span class="op" id="7751503">.</span><span class="ident" id="7751504">Error</span><span class="op" id="7751509">(</span><span class="string" id="7751510">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7751549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751552">}</span><br>
<span class="lineno">555</span><span class="op" id="7751554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7751557">func</span>&nbsp;<span class="ident" id="7751562">TestCopyTokenStartElement</span><span class="op" id="7751587">(</span><span class="ident" id="7751588">t</span>&nbsp;<span class="op" id="7751590">*</span><span class="ident" id="7751591">testing</span><span class="op" id="7751598">.</span><span class="ident" id="7751599">T</span><span class="op" id="7751600">)</span>&nbsp;<span class="op" id="7751602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751605">elt</span>&nbsp;<span class="op" id="7751609">:=</span>&nbsp;<span class="ident" id="7751612">StartElement</span><span class="op" id="7751624">{</span><span class="ident" id="7751625">Name</span><span class="op" id="7751629">{</span><span class="string" id="7751630">&#34;&#34;</span><span class="op" id="7751632">,</span>&nbsp;<span class="string" id="7751634">&#34;hello&#34;</span><span class="op" id="7751641">}</span><span class="op" id="7751642">,</span>&nbsp;<span class="op" id="7751644">[</span><span class="op" id="7751645">]</span><span class="ident" id="7751646">Attr</span><span class="op" id="7751650">{</span><span class="op" id="7751651">{</span><span class="ident" id="7751652">Name</span><span class="op" id="7751656">{</span><span class="string" id="7751657">&#34;&#34;</span><span class="op" id="7751659">,</span>&nbsp;<span class="string" id="7751661">&#34;lang&#34;</span><span class="op" id="7751667">}</span><span class="op" id="7751668">,</span>&nbsp;<span class="string" id="7751670">&#34;en&#34;</span><span class="op" id="7751674">}</span><span class="op" id="7751675">}</span><span class="op" id="7751676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751679">var</span>&nbsp;<span class="ident" id="7751683">tok1</span>&nbsp;<span class="ident" id="7751688">Token</span>&nbsp;<span class="op" id="7751694">=</span>&nbsp;<span class="ident" id="7751696">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751701">tok2</span>&nbsp;<span class="op" id="7751706">:=</span>&nbsp;<span class="ident" id="7751709">CopyToken</span><span class="op" id="7751718">(</span><span class="ident" id="7751719">tok1</span><span class="op" id="7751723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751726">if</span>&nbsp;<span class="ident" id="7751729">tok1</span><span class="op" id="7751733">.</span><span class="op" id="7751734">(</span><span class="ident" id="7751735">StartElement</span><span class="op" id="7751747">)</span><span class="op" id="7751748">.</span><span class="ident" id="7751749">Attr</span><span class="op" id="7751753">[</span><span class="num" id="7751754">0</span><span class="op" id="7751755">]</span><span class="op" id="7751756">.</span><span class="ident" id="7751757">Value</span>&nbsp;<span class="op" id="7751763">!=</span>&nbsp;<span class="string" id="7751766">&#34;en&#34;</span>&nbsp;<span class="op" id="7751771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751775">t</span><span class="op" id="7751776">.</span><span class="ident" id="7751777">Error</span><span class="op" id="7751782">(</span><span class="string" id="7751783">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="7751812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751818">if</span>&nbsp;<span class="op" id="7751821">!</span><span class="ident" id="7751822">reflect</span><span class="op" id="7751829">.</span><span class="ident" id="7751830">DeepEqual</span><span class="op" id="7751839">(</span><span class="ident" id="7751840">tok1</span><span class="op" id="7751844">,</span>&nbsp;<span class="ident" id="7751846">tok2</span><span class="op" id="7751850">)</span>&nbsp;<span class="op" id="7751852">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751856">t</span><span class="op" id="7751857">.</span><span class="ident" id="7751858">Error</span><span class="op" id="7751863">(</span><span class="string" id="7751864">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="7751905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751911">tok1</span><span class="op" id="7751915">.</span><span class="op" id="7751916">(</span><span class="ident" id="7751917">StartElement</span><span class="op" id="7751929">)</span><span class="op" id="7751930">.</span><span class="ident" id="7751931">Attr</span><span class="op" id="7751935">[</span><span class="num" id="7751936">0</span><span class="op" id="7751937">]</span>&nbsp;<span class="op" id="7751939">=</span>&nbsp;<span class="ident" id="7751941">Attr</span><span class="op" id="7751945">{</span><span class="ident" id="7751946">Name</span><span class="op" id="7751950">{</span><span class="string" id="7751951">&#34;&#34;</span><span class="op" id="7751953">,</span>&nbsp;<span class="string" id="7751955">&#34;lang&#34;</span><span class="op" id="7751961">}</span><span class="op" id="7751962">,</span>&nbsp;<span class="string" id="7751964">&#34;de&#34;</span><span class="op" id="7751968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751971">if</span>&nbsp;<span class="ident" id="7751974">reflect</span><span class="op" id="7751981">.</span><span class="ident" id="7751982">DeepEqual</span><span class="op" id="7751991">(</span><span class="ident" id="7751992">tok1</span><span class="op" id="7751996">,</span>&nbsp;<span class="ident" id="7751998">tok2</span><span class="op" id="7752002">)</span>&nbsp;<span class="op" id="7752004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752008">t</span><span class="op" id="7752009">.</span><span class="ident" id="7752010">Error</span><span class="op" id="7752015">(</span><span class="string" id="7752016">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7752055">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752058">}</span><br>
<span class="lineno"></span><span class="op" id="7752060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7752063">func</span>&nbsp;<span class="ident" id="7752068">TestSyntaxErrorLineNum</span><span class="op" id="7752090">(</span><span class="ident" id="7752091">t</span>&nbsp;<span class="op" id="7752093">*</span><span class="ident" id="7752094">testing</span><span class="op" id="7752101">.</span><span class="ident" id="7752102">T</span><span class="op" id="7752103">)</span>&nbsp;<span class="op" id="7752105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752108">testInput</span>&nbsp;<span class="op" id="7752118">:=</span>&nbsp;<span class="string" id="7752121">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752149">d</span>&nbsp;<span class="op" id="7752151">:=</span>&nbsp;<span class="ident" id="7752154">NewDecoder</span><span class="op" id="7752164">(</span><span class="ident" id="7752165">strings</span><span class="op" id="7752172">.</span><span class="ident" id="7752173">NewReader</span><span class="op" id="7752182">(</span><span class="ident" id="7752183">testInput</span><span class="op" id="7752192">)</span><span class="op" id="7752193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752196">var</span>&nbsp;<span class="ident" id="7752200">err</span>&nbsp;<span class="builtintype" id="7752204">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752211">for</span>&nbsp;<span class="ident" id="7752215">_</span><span class="op" id="7752216">,</span>&nbsp;<span class="ident" id="7752218">err</span>&nbsp;<span class="op" id="7752222">=</span>&nbsp;<span class="ident" id="7752224">d</span><span class="op" id="7752225">.</span><span class="ident" id="7752226">Token</span><span class="op" id="7752231">(</span><span class="op" id="7752232">)</span><span class="op" id="7752233">;</span>&nbsp;<span class="ident" id="7752235">err</span>&nbsp;<span class="op" id="7752239">==</span>&nbsp;<span class="ident" id="7752242">nil</span><span class="op" id="7752245">;</span>&nbsp;<span class="ident" id="7752247">_</span><span class="op" id="7752248">,</span>&nbsp;<span class="ident" id="7752250">err</span>&nbsp;<span class="op" id="7752254">=</span>&nbsp;<span class="ident" id="7752256">d</span><span class="op" id="7752257">.</span><span class="ident" id="7752258">Token</span><span class="op" id="7752263">(</span><span class="op" id="7752264">)</span>&nbsp;<span class="op" id="7752266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752272">synerr</span><span class="op" id="7752278">,</span>&nbsp;<span class="ident" id="7752280">ok</span>&nbsp;<span class="op" id="7752283">:=</span>&nbsp;<span class="ident" id="7752286">err</span><span class="op" id="7752289">.</span><span class="op" id="7752290">(</span><span class="op" id="7752291">*</span><span class="ident" id="7752292">SyntaxError</span><span class="op" id="7752303">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752306">if</span>&nbsp;<span class="op" id="7752309">!</span><span class="ident" id="7752310">ok</span>&nbsp;<span class="op" id="7752313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752317">t</span><span class="op" id="7752318">.</span><span class="ident" id="7752319">Error</span><span class="op" id="7752324">(</span><span class="string" id="7752325">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="7752348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752354">if</span>&nbsp;<span class="ident" id="7752357">synerr</span><span class="op" id="7752363">.</span><span class="ident" id="7752364">Line</span>&nbsp;<span class="op" id="7752369">!=</span>&nbsp;<span class="num" id="7752372">3</span>&nbsp;<span class="op" id="7752374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752378">t</span><span class="op" id="7752379">.</span><span class="ident" id="7752380">Error</span><span class="op" id="7752385">(</span><span class="string" id="7752386">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="7752432">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752435">}</span><br>
<span class="lineno"></span><span class="op" id="7752437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7752440">func</span>&nbsp;<span class="ident" id="7752445">TestTrailingRawToken</span><span class="op" id="7752465">(</span><span class="ident" id="7752466">t</span>&nbsp;<span class="op" id="7752468">*</span><span class="ident" id="7752469">testing</span><span class="op" id="7752476">.</span><span class="ident" id="7752477">T</span><span class="op" id="7752478">)</span>&nbsp;<span class="op" id="7752480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752483">input</span>&nbsp;<span class="op" id="7752489">:=</span>&nbsp;<span class="string" id="7752492">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752509">d</span>&nbsp;<span class="op" id="7752511">:=</span>&nbsp;<span class="ident" id="7752514">NewDecoder</span><span class="op" id="7752524">(</span><span class="ident" id="7752525">strings</span><span class="op" id="7752532">.</span><span class="ident" id="7752533">NewReader</span><span class="op" id="7752542">(</span><span class="ident" id="7752543">input</span><span class="op" id="7752548">)</span><span class="op" id="7752549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752552">var</span>&nbsp;<span class="ident" id="7752556">err</span>&nbsp;<span class="builtintype" id="7752560">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752567">for</span>&nbsp;<span class="ident" id="7752571">_</span><span class="op" id="7752572">,</span>&nbsp;<span class="ident" id="7752574">err</span>&nbsp;<span class="op" id="7752578">=</span>&nbsp;<span class="ident" id="7752580">d</span><span class="op" id="7752581">.</span><span class="ident" id="7752582">RawToken</span><span class="op" id="7752590">(</span><span class="op" id="7752591">)</span><span class="op" id="7752592">;</span>&nbsp;<span class="ident" id="7752594">err</span>&nbsp;<span class="op" id="7752598">==</span>&nbsp;<span class="ident" id="7752601">nil</span><span class="op" id="7752604">;</span>&nbsp;<span class="ident" id="7752606">_</span><span class="op" id="7752607">,</span>&nbsp;<span class="ident" id="7752609">err</span>&nbsp;<span class="op" id="7752613">=</span>&nbsp;<span class="ident" id="7752615">d</span><span class="op" id="7752616">.</span><span class="ident" id="7752617">RawToken</span><span class="op" id="7752625">(</span><span class="op" id="7752626">)</span>&nbsp;<span class="op" id="7752628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752634">if</span>&nbsp;<span class="ident" id="7752637">err</span>&nbsp;<span class="op" id="7752641">!=</span>&nbsp;<span class="ident" id="7752644">io</span><span class="op" id="7752646">.</span><span class="ident" id="7752647">EOF</span>&nbsp;<span class="op" id="7752651">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752655">t</span><span class="op" id="7752656">.</span><span class="ident" id="7752657">Fatalf</span><span class="op" id="7752663">(</span><span class="string" id="7752664">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7752702">,</span>&nbsp;<span class="ident" id="7752704">err</span><span class="op" id="7752707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752710">}</span><br>
<span class="lineno"></span><span class="op" id="7752712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7752715">func</span>&nbsp;<span class="ident" id="7752720">TestTrailingToken</span><span class="op" id="7752737">(</span><span class="ident" id="7752738">t</span>&nbsp;<span class="op" id="7752740">*</span><span class="ident" id="7752741">testing</span><span class="op" id="7752748">.</span><span class="ident" id="7752749">T</span><span class="op" id="7752750">)</span>&nbsp;<span class="op" id="7752752">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752755">input</span>&nbsp;<span class="op" id="7752761">:=</span>&nbsp;<span class="string" id="7752764">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752781">d</span>&nbsp;<span class="op" id="7752783">:=</span>&nbsp;<span class="ident" id="7752786">NewDecoder</span><span class="op" id="7752796">(</span><span class="ident" id="7752797">strings</span><span class="op" id="7752804">.</span><span class="ident" id="7752805">NewReader</span><span class="op" id="7752814">(</span><span class="ident" id="7752815">input</span><span class="op" id="7752820">)</span><span class="op" id="7752821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752824">var</span>&nbsp;<span class="ident" id="7752828">err</span>&nbsp;<span class="builtintype" id="7752832">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752839">for</span>&nbsp;<span class="ident" id="7752843">_</span><span class="op" id="7752844">,</span>&nbsp;<span class="ident" id="7752846">err</span>&nbsp;<span class="op" id="7752850">=</span>&nbsp;<span class="ident" id="7752852">d</span><span class="op" id="7752853">.</span><span class="ident" id="7752854">Token</span><span class="op" id="7752859">(</span><span class="op" id="7752860">)</span><span class="op" id="7752861">;</span>&nbsp;<span class="ident" id="7752863">err</span>&nbsp;<span class="op" id="7752867">==</span>&nbsp;<span class="ident" id="7752870">nil</span><span class="op" id="7752873">;</span>&nbsp;<span class="ident" id="7752875">_</span><span class="op" id="7752876">,</span>&nbsp;<span class="ident" id="7752878">err</span>&nbsp;<span class="op" id="7752882">=</span>&nbsp;<span class="ident" id="7752884">d</span><span class="op" id="7752885">.</span><span class="ident" id="7752886">Token</span><span class="op" id="7752891">(</span><span class="op" id="7752892">)</span>&nbsp;<span class="op" id="7752894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752897">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752900">if</span>&nbsp;<span class="ident" id="7752903">err</span>&nbsp;<span class="op" id="7752907">!=</span>&nbsp;<span class="ident" id="7752910">io</span><span class="op" id="7752912">.</span><span class="ident" id="7752913">EOF</span>&nbsp;<span class="op" id="7752917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752921">t</span><span class="op" id="7752922">.</span><span class="ident" id="7752923">Fatalf</span><span class="op" id="7752929">(</span><span class="string" id="7752930">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7752965">,</span>&nbsp;<span class="ident" id="7752967">err</span><span class="op" id="7752970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752973">}</span><br>
<span class="lineno"></span><span class="op" id="7752975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="7752978">func</span>&nbsp;<span class="ident" id="7752983">TestEntityInsideCDATA</span><span class="op" id="7753004">(</span><span class="ident" id="7753005">t</span>&nbsp;<span class="op" id="7753007">*</span><span class="ident" id="7753008">testing</span><span class="op" id="7753015">.</span><span class="ident" id="7753016">T</span><span class="op" id="7753017">)</span>&nbsp;<span class="op" id="7753019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753022">input</span>&nbsp;<span class="op" id="7753028">:=</span>&nbsp;<span class="string" id="7753031">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753070">d</span>&nbsp;<span class="op" id="7753072">:=</span>&nbsp;<span class="ident" id="7753075">NewDecoder</span><span class="op" id="7753085">(</span><span class="ident" id="7753086">strings</span><span class="op" id="7753093">.</span><span class="ident" id="7753094">NewReader</span><span class="op" id="7753103">(</span><span class="ident" id="7753104">input</span><span class="op" id="7753109">)</span><span class="op" id="7753110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753113">var</span>&nbsp;<span class="ident" id="7753117">err</span>&nbsp;<span class="builtintype" id="7753121">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753128">for</span>&nbsp;<span class="ident" id="7753132">_</span><span class="op" id="7753133">,</span>&nbsp;<span class="ident" id="7753135">err</span>&nbsp;<span class="op" id="7753139">=</span>&nbsp;<span class="ident" id="7753141">d</span><span class="op" id="7753142">.</span><span class="ident" id="7753143">Token</span><span class="op" id="7753148">(</span><span class="op" id="7753149">)</span><span class="op" id="7753150">;</span>&nbsp;<span class="ident" id="7753152">err</span>&nbsp;<span class="op" id="7753156">==</span>&nbsp;<span class="ident" id="7753159">nil</span><span class="op" id="7753162">;</span>&nbsp;<span class="ident" id="7753164">_</span><span class="op" id="7753165">,</span>&nbsp;<span class="ident" id="7753167">err</span>&nbsp;<span class="op" id="7753171">=</span>&nbsp;<span class="ident" id="7753173">d</span><span class="op" id="7753174">.</span><span class="ident" id="7753175">Token</span><span class="op" id="7753180">(</span><span class="op" id="7753181">)</span>&nbsp;<span class="op" id="7753183">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753189">if</span>&nbsp;<span class="ident" id="7753192">err</span>&nbsp;<span class="op" id="7753196">!=</span>&nbsp;<span class="ident" id="7753199">io</span><span class="op" id="7753201">.</span><span class="ident" id="7753202">EOF</span>&nbsp;<span class="op" id="7753206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753210">t</span><span class="op" id="7753211">.</span><span class="ident" id="7753212">Fatalf</span><span class="op" id="7753218">(</span><span class="string" id="7753219">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7753254">,</span>&nbsp;<span class="ident" id="7753256">err</span><span class="op" id="7753259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753262">}</span><br>
<span class="lineno"></span><span class="op" id="7753264">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="7753267">var</span>&nbsp;<span class="ident" id="7753271">characterTests</span>&nbsp;<span class="op" id="7753286">=</span>&nbsp;<span class="op" id="7753288">[</span><span class="op" id="7753289">]</span><span class="keyword" id="7753290">struct</span>&nbsp;<span class="op" id="7753297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753300">in</span>&nbsp;&nbsp;<span class="builtintype" id="7753304">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753312">err</span>&nbsp;<span class="builtintype" id="7753316">string</span><br>
<span class="lineno"></span><span class="op" id="7753323">}</span><span class="op" id="7753324">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753327">{</span><span class="string" id="7753328">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="7753340">,</span>&nbsp;<span class="string" id="7753342">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="7753373">}</span><span class="op" id="7753374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753377">{</span><span class="string" id="7753378">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="7753413">,</span>&nbsp;<span class="string" id="7753415">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="7753446">}</span><span class="op" id="7753447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753450">{</span><span class="string" id="7753451">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="7753471">,</span>&nbsp;<span class="string" id="7753473">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="7753504">}</span><span class="op" id="7753505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753508">{</span><span class="string" id="7753509">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="7753568">,</span>&nbsp;<span class="string" id="7753570">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="7753601">}</span><span class="op" id="7753602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753605">{</span><span class="string" id="7753606">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="7753664">,</span>&nbsp;<span class="string" id="7753666">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="7753702">}</span><span class="op" id="7753703">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753706">{</span><span class="string" id="7753707">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7753729">,</span>&nbsp;<span class="string" id="7753731">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7753777">}</span><span class="op" id="7753778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753781">{</span><span class="string" id="7753782">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7753801">,</span>&nbsp;<span class="string" id="7753803">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7753846">}</span><span class="op" id="7753847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753850">{</span><span class="string" id="7753851">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="7753878">,</span>&nbsp;<span class="string" id="7753880">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="7753915">}</span><span class="op" id="7753916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753919">{</span><span class="string" id="7753920">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="7753940">,</span>&nbsp;<span class="string" id="7753942">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="7753976">}</span><span class="op" id="7753977">,</span><br>
<span class="lineno"></span><span class="op" id="7753979">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="7753982">func</span>&nbsp;<span class="ident" id="7753987">TestDisallowedCharacters</span><span class="op" id="7754011">(</span><span class="ident" id="7754012">t</span>&nbsp;<span class="op" id="7754014">*</span><span class="ident" id="7754015">testing</span><span class="op" id="7754022">.</span><span class="ident" id="7754023">T</span><span class="op" id="7754024">)</span>&nbsp;<span class="op" id="7754026">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7754030">for</span>&nbsp;<span class="ident" id="7754034">i</span><span class="op" id="7754035">,</span>&nbsp;<span class="ident" id="7754037">tt</span>&nbsp;<span class="op" id="7754040">:=</span>&nbsp;<span class="keyword" id="7754043">range</span>&nbsp;<span class="ident" id="7754049">characterTests</span>&nbsp;<span class="op" id="7754064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7754068">d</span>&nbsp;<span class="op" id="7754070">:=</span>&nbsp;<span class="ident" id="7754073">NewDecoder</span><span class="op" id="7754083">(</span><span class="ident" id="7754084">strings</span><span class="op" id="7754091">.</span><span class="ident" id="7754092">NewReader</span><span class="op" id="7754101">(</span><span class="ident" id="7754102">tt</span><span class="op" id="7754104">.</span><span class="ident" id="7754105">in</span><span class="op" id="7754107">)</span><span class="op" id="7754108">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7754112">var</span>&nbsp;<span class="ident" id="7754116">err</span>&nbsp;<span class="builtintype" id="7754120">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7754129">for</span>&nbsp;<span class="ident" id="7754133">err</span>&nbsp;<span class="op" id="7754137">==</span>&nbsp;<span class="ident" id="7754140">nil</span>&nbsp;<span class="op" id="7754144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7754149">_</span><span class="op" id="7754150">,</span>&nbsp;<span class="ident" id="7754152">err</span>&nbsp;<span class="op" id="7754156">=</span>&nbsp;<span class="ident" id="7754158">d</span><span class="op" id="7754159">.</span><span class="ident" id="7754160">Token</span><span class="op" id="7754165">(</span><span class="op" id="7754166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754170">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7754174">synerr</span><span class="op" id="7754180">,</span>&nbsp;<span class="ident" id="7754182">ok</span>&nbsp;<span class="op" id="7754185">:=</span>&nbsp;<span class="ident" id="7754188">err</span><span class="op" id="7754191">.</span><span class="op" id="7754192">(</span><span class="op" id="7754193">*</span><span class="ident" id="7754194">SyntaxError</span><span class="op" id="7754205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7754209">if</span>&nbsp;<span class="op" id="7754212">!</span><span class="ident" id="7754213">ok</span>&nbsp;<span class="op" id="7754216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7754221">t</span><span class="op" id="7754222">.</span><span class="ident" id="7754223">Fatalf</span><span class="op" id="7754229">(</span><span class="string" id="7754230">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="7754280">,</span>&nbsp;<span class="ident" id="7754282">i</span><span class="op" id="7754283">,</span>&nbsp;<span class="ident" id="7754285">err</span><span class="op" id="7754288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7754296">if</span>&nbsp;<span class="ident" id="7754299">synerr</span><span class="op" id="7754305">.</span><span class="ident" id="7754306">Msg</span>&nbsp;<span class="op" id="7754310">!=</span>&nbsp;<span class="ident" id="7754313">tt</span><span class="op" id="7754315">.</span><span class="ident" id="7754316">err</span>&nbsp;<span class="op" id="7754320">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7754325">t</span><span class="op" id="7754326">.</span><span class="ident" id="7754327">Fatalf</span><span class="op" id="7754333">(</span><span class="string" id="7754334">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7754378">,</span>&nbsp;<span class="ident" id="7754380">i</span><span class="op" id="7754381">,</span>&nbsp;<span class="ident" id="7754383">tt</span><span class="op" id="7754385">.</span><span class="ident" id="7754386">err</span><span class="op" id="7754389">,</span>&nbsp;<span class="ident" id="7754391">synerr</span><span class="op" id="7754397">.</span><span class="ident" id="7754398">Msg</span><span class="op" id="7754401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754408">}</span><br>
<span class="lineno"></span><span class="op" id="7754410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="7754413">type</span>&nbsp;<span class="ident" id="7754418">procInstEncodingTest</span>&nbsp;<span class="keyword" id="7754439">struct</span>&nbsp;<span class="op" id="7754446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7754449">expect</span><span class="op" id="7754455">,</span>&nbsp;<span class="ident" id="7754457">got</span>&nbsp;<span class="builtintype" id="7754461">string</span><br>
<span class="lineno"></span><span class="op" id="7754468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7754471">var</span>&nbsp;<span class="ident" id="7754475">procInstTests</span>&nbsp;<span class="op" id="7754489">=</span>&nbsp;<span class="op" id="7754491">[</span><span class="op" id="7754492">]</span><span class="keyword" id="7754493">struct</span>&nbsp;<span class="op" id="7754500">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7754503">input</span><span class="op" id="7754508">,</span>&nbsp;<span class="ident" id="7754510">expect</span>&nbsp;<span class="builtintype" id="7754517">string</span><br>
<span class="lineno"></span><span class="op" id="7754524">}</span><span class="op" id="7754525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754528">{</span><span class="string" id="7754529">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="7754561">,</span>&nbsp;<span class="string" id="7754563">&#34;utf-8&#34;</span><span class="op" id="7754570">}</span><span class="op" id="7754571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754574">{</span><span class="string" id="7754575">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="7754607">,</span>&nbsp;<span class="string" id="7754609">&#34;utf-8&#34;</span><span class="op" id="7754616">}</span><span class="op" id="7754617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754620">{</span><span class="string" id="7754621">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="7754654">,</span>&nbsp;<span class="string" id="7754656">&#34;utf-8&#34;</span><span class="op" id="7754663">}</span><span class="op" id="7754664">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754667">{</span><span class="string" id="7754668">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="7754698">,</span>&nbsp;<span class="string" id="7754700">&#34;&#34;</span><span class="op" id="7754702">}</span><span class="op" id="7754703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754706">{</span><span class="string" id="7754707">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="7754724">,</span>&nbsp;<span class="string" id="7754726">&#34;FOO&#34;</span><span class="op" id="7754731">}</span><span class="op" id="7754732">,</span><br>
<span class="lineno"></span><span class="op" id="7754734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7754737">func</span>&nbsp;<span class="ident" id="7754742">TestProcInstEncoding</span><span class="op" id="7754762">(</span><span class="ident" id="7754763">t</span>&nbsp;<span class="op" id="7754765">*</span><span class="ident" id="7754766">testing</span><span class="op" id="7754773">.</span><span class="ident" id="7754774">T</span><span class="op" id="7754775">)</span>&nbsp;<span class="op" id="7754777">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7754780">for</span>&nbsp;<span class="ident" id="7754784">_</span><span class="op" id="7754785">,</span>&nbsp;<span class="ident" id="7754787">test</span>&nbsp;<span class="op" id="7754792">:=</span>&nbsp;<span class="keyword" id="7754795">range</span>&nbsp;<span class="ident" id="7754801">procInstTests</span>&nbsp;<span class="op" id="7754815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7754819">got</span>&nbsp;<span class="op" id="7754823">:=</span>&nbsp;<span class="ident" id="7754826">procInstEncoding</span><span class="op" id="7754842">(</span><span class="ident" id="7754843">test</span><span class="op" id="7754847">.</span><span class="ident" id="7754848">input</span><span class="op" id="7754853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7754857">if</span>&nbsp;<span class="ident" id="7754860">got</span>&nbsp;<span class="op" id="7754864">!=</span>&nbsp;<span class="ident" id="7754867">test</span><span class="op" id="7754871">.</span><span class="ident" id="7754872">expect</span>&nbsp;<span class="op" id="7754879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7754884">t</span><span class="op" id="7754885">.</span><span class="ident" id="7754886">Errorf</span><span class="op" id="7754892">(</span><span class="string" id="7754893">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7754929">,</span>&nbsp;<span class="ident" id="7754931">test</span><span class="op" id="7754935">.</span><span class="ident" id="7754936">input</span><span class="op" id="7754941">,</span>&nbsp;<span class="ident" id="7754943">got</span><span class="op" id="7754946">,</span>&nbsp;<span class="ident" id="7754948">test</span><span class="op" id="7754952">.</span><span class="ident" id="7754953">expect</span><span class="op" id="7754959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754963">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7754966">}</span><br>
<span class="lineno"></span><span class="op" id="7754968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7754971">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="7755032">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7755067">var</span>&nbsp;<span class="ident" id="7755071">directivesWithCommentsInput</span>&nbsp;<span class="op" id="7755099">=</span>&nbsp;<span class="string" id="7755101">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7755337">var</span>&nbsp;<span class="ident" id="7755341">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7755370">=</span>&nbsp;<span class="op" id="7755372">[</span><span class="op" id="7755373">]</span><span class="ident" id="7755374">Token</span><span class="op" id="7755379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755382">CharData</span><span class="op" id="7755390">(</span><span class="string" id="7755391">&#34;\n&#34;</span><span class="op" id="7755395">)</span><span class="op" id="7755396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755399">Directive</span><span class="op" id="7755408">(</span><span class="string" id="7755409">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7755480">)</span><span class="op" id="7755481">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755484">CharData</span><span class="op" id="7755492">(</span><span class="string" id="7755493">&#34;\n&#34;</span><span class="op" id="7755497">)</span><span class="op" id="7755498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755501">Directive</span><span class="op" id="7755510">(</span><span class="string" id="7755511">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7755544">)</span><span class="op" id="7755545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755548">CharData</span><span class="op" id="7755556">(</span><span class="string" id="7755557">&#34;\n&#34;</span><span class="op" id="7755561">)</span><span class="op" id="7755562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755565">Directive</span><span class="op" id="7755574">(</span><span class="string" id="7755575">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7755620">)</span><span class="op" id="7755621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755624">CharData</span><span class="op" id="7755632">(</span><span class="string" id="7755633">&#34;\n&#34;</span><span class="op" id="7755637">)</span><span class="op" id="7755638">,</span><br>
<span class="lineno">695</span><span class="op" id="7755640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7755643">func</span>&nbsp;<span class="ident" id="7755648">TestDirectivesWithComments</span><span class="op" id="7755674">(</span><span class="ident" id="7755675">t</span>&nbsp;<span class="op" id="7755677">*</span><span class="ident" id="7755678">testing</span><span class="op" id="7755685">.</span><span class="ident" id="7755686">T</span><span class="op" id="7755687">)</span>&nbsp;<span class="op" id="7755689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755692">d</span>&nbsp;<span class="op" id="7755694">:=</span>&nbsp;<span class="ident" id="7755697">NewDecoder</span><span class="op" id="7755707">(</span><span class="ident" id="7755708">strings</span><span class="op" id="7755715">.</span><span class="ident" id="7755716">NewReader</span><span class="op" id="7755725">(</span><span class="ident" id="7755726">directivesWithCommentsInput</span><span class="op" id="7755753">)</span><span class="op" id="7755754">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7755758">for</span>&nbsp;<span class="ident" id="7755762">i</span><span class="op" id="7755763">,</span>&nbsp;<span class="ident" id="7755765">want</span>&nbsp;<span class="op" id="7755770">:=</span>&nbsp;<span class="keyword" id="7755773">range</span>&nbsp;<span class="ident" id="7755779">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7755808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755812">have</span><span class="op" id="7755816">,</span>&nbsp;<span class="ident" id="7755818">err</span>&nbsp;<span class="op" id="7755822">:=</span>&nbsp;<span class="ident" id="7755825">d</span><span class="op" id="7755826">.</span><span class="ident" id="7755827">Token</span><span class="op" id="7755832">(</span><span class="op" id="7755833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7755837">if</span>&nbsp;<span class="ident" id="7755840">err</span>&nbsp;<span class="op" id="7755844">!=</span>&nbsp;<span class="ident" id="7755847">nil</span>&nbsp;<span class="op" id="7755851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755856">t</span><span class="op" id="7755857">.</span><span class="ident" id="7755858">Fatalf</span><span class="op" id="7755864">(</span><span class="string" id="7755865">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7755897">,</span>&nbsp;<span class="ident" id="7755899">i</span><span class="op" id="7755900">,</span>&nbsp;<span class="ident" id="7755902">err</span><span class="op" id="7755905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7755909">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7755913">if</span>&nbsp;<span class="op" id="7755916">!</span><span class="ident" id="7755917">reflect</span><span class="op" id="7755924">.</span><span class="ident" id="7755925">DeepEqual</span><span class="op" id="7755934">(</span><span class="ident" id="7755935">have</span><span class="op" id="7755939">,</span>&nbsp;<span class="ident" id="7755941">want</span><span class="op" id="7755945">)</span>&nbsp;<span class="op" id="7755947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7755952">t</span><span class="op" id="7755953">.</span><span class="ident" id="7755954">Errorf</span><span class="op" id="7755960">(</span><span class="string" id="7755961">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7755986">,</span>&nbsp;<span class="ident" id="7755988">i</span><span class="op" id="7755989">,</span>&nbsp;<span class="ident" id="7755991">have</span><span class="op" id="7755995">,</span>&nbsp;<span class="ident" id="7755997">want</span><span class="op" id="7756001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7756005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7756008">}</span><br>
<span class="lineno"></span><span class="op" id="7756010">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="7756013">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="7756067">type</span>&nbsp;<span class="ident" id="7756072">errWriter</span>&nbsp;<span class="keyword" id="7756082">struct</span><span class="op" id="7756088">{</span><span class="op" id="7756089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7756092">func</span>&nbsp;<span class="op" id="7756097">(</span><span class="ident" id="7756098">errWriter</span><span class="op" id="7756107">)</span>&nbsp;<span class="ident" id="7756109">Write</span><span class="op" id="7756114">(</span><span class="ident" id="7756115">p</span>&nbsp;<span class="op" id="7756117">[</span><span class="op" id="7756118">]</span><span class="builtintype" id="7756119">byte</span><span class="op" id="7756123">)</span>&nbsp;<span class="op" id="7756125">(</span><span class="ident" id="7756126">n</span>&nbsp;<span class="builtintype" id="7756128">int</span><span class="op" id="7756131">,</span>&nbsp;<span class="ident" id="7756133">err</span>&nbsp;<span class="builtintype" id="7756137">error</span><span class="op" id="7756142">)</span>&nbsp;<span class="op" id="7756144">{</span>&nbsp;<span class="keyword" id="7756146">return</span>&nbsp;<span class="num" id="7756153">0</span><span class="op" id="7756154">,</span>&nbsp;<span class="ident" id="7756156">fmt</span><span class="op" id="7756159">.</span><span class="ident" id="7756160">Errorf</span><span class="op" id="7756166">(</span><span class="string" id="7756167">&#34;unwritable&#34;</span><span class="op" id="7756179">)</span>&nbsp;<span class="op" id="7756181">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="7756184">func</span>&nbsp;<span class="ident" id="7756189">TestEscapeTextIOErrors</span><span class="op" id="7756211">(</span><span class="ident" id="7756212">t</span>&nbsp;<span class="op" id="7756214">*</span><span class="ident" id="7756215">testing</span><span class="op" id="7756222">.</span><span class="ident" id="7756223">T</span><span class="op" id="7756224">)</span>&nbsp;<span class="op" id="7756226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756229">expectErr</span>&nbsp;<span class="op" id="7756239">:=</span>&nbsp;<span class="string" id="7756242">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756256">err</span>&nbsp;<span class="op" id="7756260">:=</span>&nbsp;<span class="ident" id="7756263">EscapeText</span><span class="op" id="7756273">(</span><span class="ident" id="7756274">errWriter</span><span class="op" id="7756283">{</span><span class="op" id="7756284">}</span><span class="op" id="7756285">,</span>&nbsp;<span class="op" id="7756287">[</span><span class="op" id="7756288">]</span><span class="builtintype" id="7756289">byte</span><span class="op" id="7756293">{</span><span class="string" id="7756294">&#39;A&#39;</span><span class="op" id="7756297">}</span><span class="op" id="7756298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7756302">if</span>&nbsp;<span class="ident" id="7756305">err</span>&nbsp;<span class="op" id="7756309">==</span>&nbsp;<span class="ident" id="7756312">nil</span>&nbsp;<span class="op" id="7756316">||</span>&nbsp;<span class="ident" id="7756319">err</span><span class="op" id="7756322">.</span><span class="ident" id="7756323">Error</span><span class="op" id="7756328">(</span><span class="op" id="7756329">)</span>&nbsp;<span class="op" id="7756331">!=</span>&nbsp;<span class="ident" id="7756334">expectErr</span>&nbsp;<span class="op" id="7756344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756348">t</span><span class="op" id="7756349">.</span><span class="ident" id="7756350">Errorf</span><span class="op" id="7756356">(</span><span class="string" id="7756357">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7756375">,</span>&nbsp;<span class="ident" id="7756377">err</span><span class="op" id="7756380">,</span>&nbsp;<span class="ident" id="7756382">expectErr</span><span class="op" id="7756391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7756394">}</span><br>
<span class="lineno"></span><span class="op" id="7756396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="7756399">func</span>&nbsp;<span class="ident" id="7756404">TestEscapeTextInvalidChar</span><span class="op" id="7756429">(</span><span class="ident" id="7756430">t</span>&nbsp;<span class="op" id="7756432">*</span><span class="ident" id="7756433">testing</span><span class="op" id="7756440">.</span><span class="ident" id="7756441">T</span><span class="op" id="7756442">)</span>&nbsp;<span class="op" id="7756444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756447">input</span>&nbsp;<span class="op" id="7756453">:=</span>&nbsp;<span class="op" id="7756456">[</span><span class="op" id="7756457">]</span><span class="builtintype" id="7756458">byte</span><span class="op" id="7756462">(</span><span class="string" id="7756463">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="7756490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756493">expected</span>&nbsp;<span class="op" id="7756502">:=</span>&nbsp;<span class="string" id="7756505">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756537">buff</span>&nbsp;<span class="op" id="7756542">:=</span>&nbsp;<span class="builtinfunc" id="7756545">new</span><span class="op" id="7756548">(</span><span class="ident" id="7756549">bytes</span><span class="op" id="7756554">.</span><span class="ident" id="7756555">Buffer</span><span class="op" id="7756561">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7756564">if</span>&nbsp;<span class="ident" id="7756567">err</span>&nbsp;<span class="op" id="7756571">:=</span>&nbsp;<span class="ident" id="7756574">EscapeText</span><span class="op" id="7756584">(</span><span class="ident" id="7756585">buff</span><span class="op" id="7756589">,</span>&nbsp;<span class="ident" id="7756591">input</span><span class="op" id="7756596">)</span><span class="op" id="7756597">;</span>&nbsp;<span class="ident" id="7756599">err</span>&nbsp;<span class="op" id="7756603">!=</span>&nbsp;<span class="ident" id="7756606">nil</span>&nbsp;<span class="op" id="7756610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756614">t</span><span class="op" id="7756615">.</span><span class="ident" id="7756616">Fatalf</span><span class="op" id="7756622">(</span><span class="string" id="7756623">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7756642">,</span>&nbsp;<span class="ident" id="7756644">err</span><span class="op" id="7756647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7756650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756653">text</span>&nbsp;<span class="op" id="7756658">:=</span>&nbsp;<span class="ident" id="7756661">buff</span><span class="op" id="7756665">.</span><span class="ident" id="7756666">String</span><span class="op" id="7756672">(</span><span class="op" id="7756673">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7756677">if</span>&nbsp;<span class="ident" id="7756680">text</span>&nbsp;<span class="op" id="7756685">!=</span>&nbsp;<span class="ident" id="7756688">expected</span>&nbsp;<span class="op" id="7756697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756701">t</span><span class="op" id="7756702">.</span><span class="ident" id="7756703">Errorf</span><span class="op" id="7756709">(</span><span class="string" id="7756710">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7756728">,</span>&nbsp;<span class="ident" id="7756730">text</span><span class="op" id="7756734">,</span>&nbsp;<span class="ident" id="7756736">expected</span><span class="op" id="7756744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7756747">}</span><br>
<span class="lineno"></span><span class="op" id="7756749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="7756752">func</span>&nbsp;<span class="ident" id="7756757">TestIssue5880</span><span class="op" id="7756770">(</span><span class="ident" id="7756771">t</span>&nbsp;<span class="op" id="7756773">*</span><span class="ident" id="7756774">testing</span><span class="op" id="7756781">.</span><span class="ident" id="7756782">T</span><span class="op" id="7756783">)</span>&nbsp;<span class="op" id="7756785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7756788">type</span>&nbsp;<span class="ident" id="7756793">T</span>&nbsp;<span class="op" id="7756795">[</span><span class="op" id="7756796">]</span><span class="builtintype" id="7756797">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756803">data</span><span class="op" id="7756807">,</span>&nbsp;<span class="ident" id="7756809">err</span>&nbsp;<span class="op" id="7756813">:=</span>&nbsp;<span class="ident" id="7756816">Marshal</span><span class="op" id="7756823">(</span><span class="ident" id="7756824">T</span><span class="op" id="7756825">{</span><span class="num" id="7756826">192</span><span class="op" id="7756829">,</span>&nbsp;<span class="num" id="7756831">168</span><span class="op" id="7756834">,</span>&nbsp;<span class="num" id="7756836">0</span><span class="op" id="7756837">,</span>&nbsp;<span class="num" id="7756839">1</span><span class="op" id="7756840">}</span><span class="op" id="7756841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7756844">if</span>&nbsp;<span class="ident" id="7756847">err</span>&nbsp;<span class="op" id="7756851">!=</span>&nbsp;<span class="ident" id="7756854">nil</span>&nbsp;<span class="op" id="7756858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756862">t</span><span class="op" id="7756863">.</span><span class="ident" id="7756864">Errorf</span><span class="op" id="7756870">(</span><span class="string" id="7756871">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7756890">,</span>&nbsp;<span class="ident" id="7756892">err</span><span class="op" id="7756895">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7756898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7756901">if</span>&nbsp;<span class="op" id="7756904">!</span><span class="ident" id="7756905">utf8</span><span class="op" id="7756909">.</span><span class="ident" id="7756910">Valid</span><span class="op" id="7756915">(</span><span class="ident" id="7756916">data</span><span class="op" id="7756920">)</span>&nbsp;<span class="op" id="7756922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7756926">t</span><span class="op" id="7756927">.</span><span class="ident" id="7756928">Errorf</span><span class="op" id="7756934">(</span><span class="string" id="7756935">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="7756972">,</span>&nbsp;<span class="ident" id="7756974">data</span><span class="op" id="7756978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7756981">}</span><br>
<span class="lineno"></span><span class="op" id="7756983">}</span>
</div>
</body>
</html>
