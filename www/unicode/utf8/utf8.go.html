<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2526264">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2526319">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2526373">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2526424">//&nbsp;Package&nbsp;utf8&nbsp;implements&nbsp;functions&nbsp;and&nbsp;constants&nbsp;to&nbsp;support&nbsp;text&nbsp;encoded&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2526502">//&nbsp;UTF-8.&nbsp;It&nbsp;includes&nbsp;functions&nbsp;to&nbsp;translate&nbsp;between&nbsp;runes&nbsp;and&nbsp;UTF-8&nbsp;byte&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="2526587">package</span>&nbsp;<span class="ident" id="2526595">utf8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2526601">//&nbsp;The&nbsp;conditions&nbsp;RuneError==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2526658">//&nbsp;MaxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="2526713">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2526789">//&nbsp;Numbers&nbsp;fundamental&nbsp;to&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="2526829">const</span>&nbsp;<span class="op" id="2526835">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526838">RuneError</span>&nbsp;<span class="op" id="2526848">=</span>&nbsp;<span class="string" id="2526850">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2526863">//&nbsp;the&nbsp;&#34;error&#34;&nbsp;Rune&nbsp;or&nbsp;&#34;Unicode&nbsp;replacement&nbsp;character&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526919">RuneSelf</span>&nbsp;&nbsp;<span class="op" id="2526929">=</span>&nbsp;<span class="num" id="2526931">0x80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2526944">//&nbsp;characters&nbsp;below&nbsp;Runeself&nbsp;are&nbsp;represented&nbsp;as&nbsp;themselves&nbsp;in&nbsp;a&nbsp;single&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527022">MaxRune</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2527032">=</span>&nbsp;<span class="string" id="2527034">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="2527047">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527085">UTFMax</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2527095">=</span>&nbsp;<span class="num" id="2527097">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2527110">//&nbsp;maximum&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="op" id="2527175">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="2527178">//&nbsp;Code&nbsp;points&nbsp;in&nbsp;the&nbsp;surrogate&nbsp;range&nbsp;are&nbsp;not&nbsp;valid&nbsp;for&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="keyword" id="2527241">const</span>&nbsp;<span class="op" id="2527247">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527250">surrogateMin</span>&nbsp;<span class="op" id="2527263">=</span>&nbsp;<span class="num" id="2527265">0xD800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527273">surrogateMax</span>&nbsp;<span class="op" id="2527286">=</span>&nbsp;<span class="num" id="2527288">0xDFFF</span><br>
<span class="lineno">25</span><span class="op" id="2527295">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2527298">const</span>&nbsp;<span class="op" id="2527304">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527307">t1</span>&nbsp;<span class="op" id="2527310">=</span>&nbsp;<span class="num" id="2527312">0x00</span>&nbsp;<span class="comment" id="2527317">//&nbsp;0000&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527331">tx</span>&nbsp;<span class="op" id="2527334">=</span>&nbsp;<span class="num" id="2527336">0x80</span>&nbsp;<span class="comment" id="2527341">//&nbsp;1000&nbsp;0000</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527355">t2</span>&nbsp;<span class="op" id="2527358">=</span>&nbsp;<span class="num" id="2527360">0xC0</span>&nbsp;<span class="comment" id="2527365">//&nbsp;1100&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527379">t3</span>&nbsp;<span class="op" id="2527382">=</span>&nbsp;<span class="num" id="2527384">0xE0</span>&nbsp;<span class="comment" id="2527389">//&nbsp;1110&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527403">t4</span>&nbsp;<span class="op" id="2527406">=</span>&nbsp;<span class="num" id="2527408">0xF0</span>&nbsp;<span class="comment" id="2527413">//&nbsp;1111&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527427">t5</span>&nbsp;<span class="op" id="2527430">=</span>&nbsp;<span class="num" id="2527432">0xF8</span>&nbsp;<span class="comment" id="2527437">//&nbsp;1111&nbsp;1000</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527452">maskx</span>&nbsp;<span class="op" id="2527458">=</span>&nbsp;<span class="num" id="2527460">0x3F</span>&nbsp;<span class="comment" id="2527465">//&nbsp;0011&nbsp;1111</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527479">mask2</span>&nbsp;<span class="op" id="2527485">=</span>&nbsp;<span class="num" id="2527487">0x1F</span>&nbsp;<span class="comment" id="2527492">//&nbsp;0001&nbsp;1111</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527506">mask3</span>&nbsp;<span class="op" id="2527512">=</span>&nbsp;<span class="num" id="2527514">0x0F</span>&nbsp;<span class="comment" id="2527519">//&nbsp;0000&nbsp;1111</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527533">mask4</span>&nbsp;<span class="op" id="2527539">=</span>&nbsp;<span class="num" id="2527541">0x07</span>&nbsp;<span class="comment" id="2527546">//&nbsp;0000&nbsp;0111</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527561">rune1Max</span>&nbsp;<span class="op" id="2527570">=</span>&nbsp;<span class="num" id="2527572">1</span><span class="op" id="2527573">&lt;&lt;</span><span class="num" id="2527575">7</span>&nbsp;<span class="op" id="2527577">-</span>&nbsp;<span class="num" id="2527579">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527582">rune2Max</span>&nbsp;<span class="op" id="2527591">=</span>&nbsp;<span class="num" id="2527593">1</span><span class="op" id="2527594">&lt;&lt;</span><span class="num" id="2527596">11</span>&nbsp;<span class="op" id="2527599">-</span>&nbsp;<span class="num" id="2527601">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527604">rune3Max</span>&nbsp;<span class="op" id="2527613">=</span>&nbsp;<span class="num" id="2527615">1</span><span class="op" id="2527616">&lt;&lt;</span><span class="num" id="2527618">16</span>&nbsp;<span class="op" id="2527621">-</span>&nbsp;<span class="num" id="2527623">1</span><br>
<span class="lineno"></span><span class="op" id="2527625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="2527628">func</span>&nbsp;<span class="ident" id="2527633">decodeRuneInternal</span><span class="op" id="2527651">(</span><span class="ident" id="2527652">p</span>&nbsp;<span class="op" id="2527654">[</span><span class="op" id="2527655">]</span><span class="builtintype" id="2527656">byte</span><span class="op" id="2527660">)</span>&nbsp;<span class="op" id="2527662">(</span><span class="ident" id="2527663">r</span>&nbsp;<span class="builtintype" id="2527665">rune</span><span class="op" id="2527669">,</span>&nbsp;<span class="ident" id="2527671">size</span>&nbsp;<span class="builtintype" id="2527676">int</span><span class="op" id="2527679">,</span>&nbsp;<span class="ident" id="2527681">short</span>&nbsp;<span class="builtintype" id="2527687">bool</span><span class="op" id="2527691">)</span>&nbsp;<span class="op" id="2527693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527696">n</span>&nbsp;<span class="op" id="2527698">:=</span>&nbsp;<span class="builtinfunc" id="2527701">len</span><span class="op" id="2527704">(</span><span class="ident" id="2527705"><a href="/unicode/utf8/utf8.go.html#2527652">p</a></span><span class="op" id="2527706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527709">if</span>&nbsp;<span class="ident" id="2527712"><a href="/unicode/utf8/utf8.go.html#2527696">n</a></span>&nbsp;<span class="op" id="2527714">&lt;</span>&nbsp;<span class="num" id="2527716">1</span>&nbsp;<span class="op" id="2527718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527722">return</span>&nbsp;<span class="ident" id="2527729"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2527738">,</span>&nbsp;<span class="num" id="2527740">0</span><span class="op" id="2527741">,</span>&nbsp;<span class="builtintype" id="2527743">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527749">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527752">c0</span>&nbsp;<span class="op" id="2527755">:=</span>&nbsp;<span class="ident" id="2527758"><a href="/unicode/utf8/utf8.go.html#2527652">p</a></span><span class="op" id="2527759">[</span><span class="num" id="2527760">0</span><span class="op" id="2527761">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527765">//&nbsp;1-byte,&nbsp;7-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527793">if</span>&nbsp;<span class="ident" id="2527796"><a href="/unicode/utf8/utf8.go.html#2527752">c0</a></span>&nbsp;<span class="op" id="2527799">&lt;</span>&nbsp;<span class="ident" id="2527801"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2527804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527808">return</span>&nbsp;<span class="builtintype" id="2527815">rune</span><span class="op" id="2527819">(</span><span class="ident" id="2527820"><a href="/unicode/utf8/utf8.go.html#2527752">c0</a></span><span class="op" id="2527822">)</span><span class="op" id="2527823">,</span>&nbsp;<span class="num" id="2527825">1</span><span class="op" id="2527826">,</span>&nbsp;<span class="builtintype" id="2527828">false</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527839">//&nbsp;unexpected&nbsp;continuation&nbsp;byte?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527873">if</span>&nbsp;<span class="ident" id="2527876"><a href="/unicode/utf8/utf8.go.html#2527752">c0</a></span>&nbsp;<span class="op" id="2527879">&lt;</span>&nbsp;<span class="ident" id="2527881"><a href="/unicode/utf8/utf8.go.html#2527355">t2</a></span>&nbsp;<span class="op" id="2527884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527888">return</span>&nbsp;<span class="ident" id="2527895"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2527904">,</span>&nbsp;<span class="num" id="2527906">1</span><span class="op" id="2527907">,</span>&nbsp;<span class="builtintype" id="2527909">false</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527920">//&nbsp;need&nbsp;first&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527953">if</span>&nbsp;<span class="ident" id="2527956"><a href="/unicode/utf8/utf8.go.html#2527696">n</a></span>&nbsp;<span class="op" id="2527958">&lt;</span>&nbsp;<span class="num" id="2527960">2</span>&nbsp;<span class="op" id="2527962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527966">return</span>&nbsp;<span class="ident" id="2527973"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2527982">,</span>&nbsp;<span class="num" id="2527984">1</span><span class="op" id="2527985">,</span>&nbsp;<span class="builtintype" id="2527987">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527996">c1</span>&nbsp;<span class="op" id="2527999">:=</span>&nbsp;<span class="ident" id="2528002"><a href="/unicode/utf8/utf8.go.html#2527652">p</a></span><span class="op" id="2528003">[</span><span class="num" id="2528004">1</span><span class="op" id="2528005">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528008">if</span>&nbsp;<span class="ident" id="2528011"><a href="/unicode/utf8/utf8.go.html#2527996">c1</a></span>&nbsp;<span class="op" id="2528014">&lt;</span>&nbsp;<span class="ident" id="2528016"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2528019">||</span>&nbsp;<span class="ident" id="2528022"><a href="/unicode/utf8/utf8.go.html#2527355">t2</a></span>&nbsp;<span class="op" id="2528025">&lt;=</span>&nbsp;<span class="ident" id="2528028"><a href="/unicode/utf8/utf8.go.html#2527996">c1</a></span>&nbsp;<span class="op" id="2528031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528035">return</span>&nbsp;<span class="ident" id="2528042"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2528051">,</span>&nbsp;<span class="num" id="2528053">1</span><span class="op" id="2528054">,</span>&nbsp;<span class="builtintype" id="2528056">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528063">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528067">//&nbsp;2-byte,&nbsp;11-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528096">if</span>&nbsp;<span class="ident" id="2528099"><a href="/unicode/utf8/utf8.go.html#2527752">c0</a></span>&nbsp;<span class="op" id="2528102">&lt;</span>&nbsp;<span class="ident" id="2528104"><a href="/unicode/utf8/utf8.go.html#2527379">t3</a></span>&nbsp;<span class="op" id="2528107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528111"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span>&nbsp;<span class="op" id="2528113">=</span>&nbsp;<span class="builtintype" id="2528115">rune</span><span class="op" id="2528119">(</span><span class="ident" id="2528120"><a href="/unicode/utf8/utf8.go.html#2527752">c0</a></span><span class="op" id="2528122">&amp;</span><span class="ident" id="2528123"><a href="/unicode/utf8/utf8.go.html#2527479">mask2</a></span><span class="op" id="2528128">)</span><span class="op" id="2528129">&lt;&lt;</span><span class="num" id="2528131">6</span>&nbsp;<span class="op" id="2528133">|</span>&nbsp;<span class="builtintype" id="2528135">rune</span><span class="op" id="2528139">(</span><span class="ident" id="2528140"><a href="/unicode/utf8/utf8.go.html#2527996">c1</a></span><span class="op" id="2528142">&amp;</span><span class="ident" id="2528143"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2528148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528152">if</span>&nbsp;<span class="ident" id="2528155"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span>&nbsp;<span class="op" id="2528157">&lt;=</span>&nbsp;<span class="ident" id="2528160"><a href="/unicode/utf8/utf8.go.html#2527561">rune1Max</a></span>&nbsp;<span class="op" id="2528169">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528174">return</span>&nbsp;<span class="ident" id="2528181"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2528190">,</span>&nbsp;<span class="num" id="2528192">1</span><span class="op" id="2528193">,</span>&nbsp;<span class="builtintype" id="2528195">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528207">return</span>&nbsp;<span class="ident" id="2528214"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span><span class="op" id="2528215">,</span>&nbsp;<span class="num" id="2528217">2</span><span class="op" id="2528218">,</span>&nbsp;<span class="builtintype" id="2528220">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528231">//&nbsp;need&nbsp;second&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528265">if</span>&nbsp;<span class="ident" id="2528268"><a href="/unicode/utf8/utf8.go.html#2527696">n</a></span>&nbsp;<span class="op" id="2528270">&lt;</span>&nbsp;<span class="num" id="2528272">3</span>&nbsp;<span class="op" id="2528274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528278">return</span>&nbsp;<span class="ident" id="2528285"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2528294">,</span>&nbsp;<span class="num" id="2528296">1</span><span class="op" id="2528297">,</span>&nbsp;<span class="builtintype" id="2528299">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528308">c2</span>&nbsp;<span class="op" id="2528311">:=</span>&nbsp;<span class="ident" id="2528314"><a href="/unicode/utf8/utf8.go.html#2527652">p</a></span><span class="op" id="2528315">[</span><span class="num" id="2528316">2</span><span class="op" id="2528317">]</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528320">if</span>&nbsp;<span class="ident" id="2528323"><a href="/unicode/utf8/utf8.go.html#2528308">c2</a></span>&nbsp;<span class="op" id="2528326">&lt;</span>&nbsp;<span class="ident" id="2528328"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2528331">||</span>&nbsp;<span class="ident" id="2528334"><a href="/unicode/utf8/utf8.go.html#2527355">t2</a></span>&nbsp;<span class="op" id="2528337">&lt;=</span>&nbsp;<span class="ident" id="2528340"><a href="/unicode/utf8/utf8.go.html#2528308">c2</a></span>&nbsp;<span class="op" id="2528343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528347">return</span>&nbsp;<span class="ident" id="2528354"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2528363">,</span>&nbsp;<span class="num" id="2528365">1</span><span class="op" id="2528366">,</span>&nbsp;<span class="builtintype" id="2528368">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528379">//&nbsp;3-byte,&nbsp;16-bit&nbsp;sequence?</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528408">if</span>&nbsp;<span class="ident" id="2528411"><a href="/unicode/utf8/utf8.go.html#2527752">c0</a></span>&nbsp;<span class="op" id="2528414">&lt;</span>&nbsp;<span class="ident" id="2528416"><a href="/unicode/utf8/utf8.go.html#2527403">t4</a></span>&nbsp;<span class="op" id="2528419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528423"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span>&nbsp;<span class="op" id="2528425">=</span>&nbsp;<span class="builtintype" id="2528427">rune</span><span class="op" id="2528431">(</span><span class="ident" id="2528432"><a href="/unicode/utf8/utf8.go.html#2527752">c0</a></span><span class="op" id="2528434">&amp;</span><span class="ident" id="2528435"><a href="/unicode/utf8/utf8.go.html#2527506">mask3</a></span><span class="op" id="2528440">)</span><span class="op" id="2528441">&lt;&lt;</span><span class="num" id="2528443">12</span>&nbsp;<span class="op" id="2528446">|</span>&nbsp;<span class="builtintype" id="2528448">rune</span><span class="op" id="2528452">(</span><span class="ident" id="2528453"><a href="/unicode/utf8/utf8.go.html#2527996">c1</a></span><span class="op" id="2528455">&amp;</span><span class="ident" id="2528456"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2528461">)</span><span class="op" id="2528462">&lt;&lt;</span><span class="num" id="2528464">6</span>&nbsp;<span class="op" id="2528466">|</span>&nbsp;<span class="builtintype" id="2528468">rune</span><span class="op" id="2528472">(</span><span class="ident" id="2528473"><a href="/unicode/utf8/utf8.go.html#2528308">c2</a></span><span class="op" id="2528475">&amp;</span><span class="ident" id="2528476"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2528481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528485">if</span>&nbsp;<span class="ident" id="2528488"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span>&nbsp;<span class="op" id="2528490">&lt;=</span>&nbsp;<span class="ident" id="2528493"><a href="/unicode/utf8/utf8.go.html#2527582">rune2Max</a></span>&nbsp;<span class="op" id="2528502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528507">return</span>&nbsp;<span class="ident" id="2528514"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2528523">,</span>&nbsp;<span class="num" id="2528525">1</span><span class="op" id="2528526">,</span>&nbsp;<span class="builtintype" id="2528528">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528536">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528540">if</span>&nbsp;<span class="ident" id="2528543"><a href="/unicode/utf8/utf8.go.html#2527250">surrogateMin</a></span>&nbsp;<span class="op" id="2528556">&lt;=</span>&nbsp;<span class="ident" id="2528559"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span>&nbsp;<span class="op" id="2528561">&amp;&amp;</span>&nbsp;<span class="ident" id="2528564"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span>&nbsp;<span class="op" id="2528566">&lt;=</span>&nbsp;<span class="ident" id="2528569"><a href="/unicode/utf8/utf8.go.html#2527273">surrogateMax</a></span>&nbsp;<span class="op" id="2528582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528587">return</span>&nbsp;<span class="ident" id="2528594"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2528603">,</span>&nbsp;<span class="num" id="2528605">1</span><span class="op" id="2528606">,</span>&nbsp;<span class="builtintype" id="2528608">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528620">return</span>&nbsp;<span class="ident" id="2528627"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span><span class="op" id="2528628">,</span>&nbsp;<span class="num" id="2528630">3</span><span class="op" id="2528631">,</span>&nbsp;<span class="builtintype" id="2528633">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528640">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528644">//&nbsp;need&nbsp;third&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528677">if</span>&nbsp;<span class="ident" id="2528680"><a href="/unicode/utf8/utf8.go.html#2527696">n</a></span>&nbsp;<span class="op" id="2528682">&lt;</span>&nbsp;<span class="num" id="2528684">4</span>&nbsp;<span class="op" id="2528686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528690">return</span>&nbsp;<span class="ident" id="2528697"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2528706">,</span>&nbsp;<span class="num" id="2528708">1</span><span class="op" id="2528709">,</span>&nbsp;<span class="builtintype" id="2528711">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528717">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528720">c3</span>&nbsp;<span class="op" id="2528723">:=</span>&nbsp;<span class="ident" id="2528726"><a href="/unicode/utf8/utf8.go.html#2527652">p</a></span><span class="op" id="2528727">[</span><span class="num" id="2528728">3</span><span class="op" id="2528729">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528732">if</span>&nbsp;<span class="ident" id="2528735"><a href="/unicode/utf8/utf8.go.html#2528720">c3</a></span>&nbsp;<span class="op" id="2528738">&lt;</span>&nbsp;<span class="ident" id="2528740"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2528743">||</span>&nbsp;<span class="ident" id="2528746"><a href="/unicode/utf8/utf8.go.html#2527355">t2</a></span>&nbsp;<span class="op" id="2528749">&lt;=</span>&nbsp;<span class="ident" id="2528752"><a href="/unicode/utf8/utf8.go.html#2528720">c3</a></span>&nbsp;<span class="op" id="2528755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528759">return</span>&nbsp;<span class="ident" id="2528766"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2528775">,</span>&nbsp;<span class="num" id="2528777">1</span><span class="op" id="2528778">,</span>&nbsp;<span class="builtintype" id="2528780">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528791">//&nbsp;4-byte,&nbsp;21-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528820">if</span>&nbsp;<span class="ident" id="2528823"><a href="/unicode/utf8/utf8.go.html#2527752">c0</a></span>&nbsp;<span class="op" id="2528826">&lt;</span>&nbsp;<span class="ident" id="2528828"><a href="/unicode/utf8/utf8.go.html#2527427">t5</a></span>&nbsp;<span class="op" id="2528831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528835"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span>&nbsp;<span class="op" id="2528837">=</span>&nbsp;<span class="builtintype" id="2528839">rune</span><span class="op" id="2528843">(</span><span class="ident" id="2528844"><a href="/unicode/utf8/utf8.go.html#2527752">c0</a></span><span class="op" id="2528846">&amp;</span><span class="ident" id="2528847"><a href="/unicode/utf8/utf8.go.html#2527533">mask4</a></span><span class="op" id="2528852">)</span><span class="op" id="2528853">&lt;&lt;</span><span class="num" id="2528855">18</span>&nbsp;<span class="op" id="2528858">|</span>&nbsp;<span class="builtintype" id="2528860">rune</span><span class="op" id="2528864">(</span><span class="ident" id="2528865"><a href="/unicode/utf8/utf8.go.html#2527996">c1</a></span><span class="op" id="2528867">&amp;</span><span class="ident" id="2528868"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2528873">)</span><span class="op" id="2528874">&lt;&lt;</span><span class="num" id="2528876">12</span>&nbsp;<span class="op" id="2528879">|</span>&nbsp;<span class="builtintype" id="2528881">rune</span><span class="op" id="2528885">(</span><span class="ident" id="2528886"><a href="/unicode/utf8/utf8.go.html#2528308">c2</a></span><span class="op" id="2528888">&amp;</span><span class="ident" id="2528889"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2528894">)</span><span class="op" id="2528895">&lt;&lt;</span><span class="num" id="2528897">6</span>&nbsp;<span class="op" id="2528899">|</span>&nbsp;<span class="builtintype" id="2528901">rune</span><span class="op" id="2528905">(</span><span class="ident" id="2528906"><a href="/unicode/utf8/utf8.go.html#2528720">c3</a></span><span class="op" id="2528908">&amp;</span><span class="ident" id="2528909"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2528914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528918">if</span>&nbsp;<span class="ident" id="2528921"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span>&nbsp;<span class="op" id="2528923">&lt;=</span>&nbsp;<span class="ident" id="2528926"><a href="/unicode/utf8/utf8.go.html#2527604">rune3Max</a></span>&nbsp;<span class="op" id="2528935">||</span>&nbsp;<span class="ident" id="2528938"><a href="/unicode/utf8/utf8.go.html#2527022">MaxRune</a></span>&nbsp;<span class="op" id="2528946">&lt;</span>&nbsp;<span class="ident" id="2528948"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span>&nbsp;<span class="op" id="2528950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528955">return</span>&nbsp;<span class="ident" id="2528962"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2528971">,</span>&nbsp;<span class="num" id="2528973">1</span><span class="op" id="2528974">,</span>&nbsp;<span class="builtintype" id="2528976">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528988">return</span>&nbsp;<span class="ident" id="2528995"><a href="/unicode/utf8/utf8.go.html#2527663">r</a></span><span class="op" id="2528996">,</span>&nbsp;<span class="num" id="2528998">4</span><span class="op" id="2528999">,</span>&nbsp;<span class="builtintype" id="2529001">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529012">//&nbsp;error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529022">return</span>&nbsp;<span class="ident" id="2529029"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2529038">,</span>&nbsp;<span class="num" id="2529040">1</span><span class="op" id="2529041">,</span>&nbsp;<span class="builtintype" id="2529043">false</span><br>
<span class="lineno"></span><span class="op" id="2529049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2529052">func</span>&nbsp;<span class="ident" id="2529057">decodeRuneInStringInternal</span><span class="op" id="2529083">(</span><span class="ident" id="2529084">s</span>&nbsp;<span class="builtintype" id="2529086">string</span><span class="op" id="2529092">)</span>&nbsp;<span class="op" id="2529094">(</span><span class="ident" id="2529095">r</span>&nbsp;<span class="builtintype" id="2529097">rune</span><span class="op" id="2529101">,</span>&nbsp;<span class="ident" id="2529103">size</span>&nbsp;<span class="builtintype" id="2529108">int</span><span class="op" id="2529111">,</span>&nbsp;<span class="ident" id="2529113">short</span>&nbsp;<span class="builtintype" id="2529119">bool</span><span class="op" id="2529123">)</span>&nbsp;<span class="op" id="2529125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529128">n</span>&nbsp;<span class="op" id="2529130">:=</span>&nbsp;<span class="builtinfunc" id="2529133">len</span><span class="op" id="2529136">(</span><span class="ident" id="2529137"><a href="/unicode/utf8/utf8.go.html#2529084">s</a></span><span class="op" id="2529138">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529141">if</span>&nbsp;<span class="ident" id="2529144"><a href="/unicode/utf8/utf8.go.html#2529128">n</a></span>&nbsp;<span class="op" id="2529146">&lt;</span>&nbsp;<span class="num" id="2529148">1</span>&nbsp;<span class="op" id="2529150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529154">return</span>&nbsp;<span class="ident" id="2529161"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2529170">,</span>&nbsp;<span class="num" id="2529172">0</span><span class="op" id="2529173">,</span>&nbsp;<span class="builtintype" id="2529175">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529184">c0</span>&nbsp;<span class="op" id="2529187">:=</span>&nbsp;<span class="ident" id="2529190"><a href="/unicode/utf8/utf8.go.html#2529084">s</a></span><span class="op" id="2529191">[</span><span class="num" id="2529192">0</span><span class="op" id="2529193">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529197">//&nbsp;1-byte,&nbsp;7-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529225">if</span>&nbsp;<span class="ident" id="2529228"><a href="/unicode/utf8/utf8.go.html#2529184">c0</a></span>&nbsp;<span class="op" id="2529231">&lt;</span>&nbsp;<span class="ident" id="2529233"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2529236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529240">return</span>&nbsp;<span class="builtintype" id="2529247">rune</span><span class="op" id="2529251">(</span><span class="ident" id="2529252"><a href="/unicode/utf8/utf8.go.html#2529184">c0</a></span><span class="op" id="2529254">)</span><span class="op" id="2529255">,</span>&nbsp;<span class="num" id="2529257">1</span><span class="op" id="2529258">,</span>&nbsp;<span class="builtintype" id="2529260">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529271">//&nbsp;unexpected&nbsp;continuation&nbsp;byte?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529305">if</span>&nbsp;<span class="ident" id="2529308"><a href="/unicode/utf8/utf8.go.html#2529184">c0</a></span>&nbsp;<span class="op" id="2529311">&lt;</span>&nbsp;<span class="ident" id="2529313"><a href="/unicode/utf8/utf8.go.html#2527355">t2</a></span>&nbsp;<span class="op" id="2529316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529320">return</span>&nbsp;<span class="ident" id="2529327"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2529336">,</span>&nbsp;<span class="num" id="2529338">1</span><span class="op" id="2529339">,</span>&nbsp;<span class="builtintype" id="2529341">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529352">//&nbsp;need&nbsp;first&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529385">if</span>&nbsp;<span class="ident" id="2529388"><a href="/unicode/utf8/utf8.go.html#2529128">n</a></span>&nbsp;<span class="op" id="2529390">&lt;</span>&nbsp;<span class="num" id="2529392">2</span>&nbsp;<span class="op" id="2529394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529398">return</span>&nbsp;<span class="ident" id="2529405"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2529414">,</span>&nbsp;<span class="num" id="2529416">1</span><span class="op" id="2529417">,</span>&nbsp;<span class="builtintype" id="2529419">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529428">c1</span>&nbsp;<span class="op" id="2529431">:=</span>&nbsp;<span class="ident" id="2529434"><a href="/unicode/utf8/utf8.go.html#2529084">s</a></span><span class="op" id="2529435">[</span><span class="num" id="2529436">1</span><span class="op" id="2529437">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529440">if</span>&nbsp;<span class="ident" id="2529443"><a href="/unicode/utf8/utf8.go.html#2529428">c1</a></span>&nbsp;<span class="op" id="2529446">&lt;</span>&nbsp;<span class="ident" id="2529448"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2529451">||</span>&nbsp;<span class="ident" id="2529454"><a href="/unicode/utf8/utf8.go.html#2527355">t2</a></span>&nbsp;<span class="op" id="2529457">&lt;=</span>&nbsp;<span class="ident" id="2529460"><a href="/unicode/utf8/utf8.go.html#2529428">c1</a></span>&nbsp;<span class="op" id="2529463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529467">return</span>&nbsp;<span class="ident" id="2529474"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2529483">,</span>&nbsp;<span class="num" id="2529485">1</span><span class="op" id="2529486">,</span>&nbsp;<span class="builtintype" id="2529488">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529499">//&nbsp;2-byte,&nbsp;11-bit&nbsp;sequence?</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529528">if</span>&nbsp;<span class="ident" id="2529531"><a href="/unicode/utf8/utf8.go.html#2529184">c0</a></span>&nbsp;<span class="op" id="2529534">&lt;</span>&nbsp;<span class="ident" id="2529536"><a href="/unicode/utf8/utf8.go.html#2527379">t3</a></span>&nbsp;<span class="op" id="2529539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529543"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span>&nbsp;<span class="op" id="2529545">=</span>&nbsp;<span class="builtintype" id="2529547">rune</span><span class="op" id="2529551">(</span><span class="ident" id="2529552"><a href="/unicode/utf8/utf8.go.html#2529184">c0</a></span><span class="op" id="2529554">&amp;</span><span class="ident" id="2529555"><a href="/unicode/utf8/utf8.go.html#2527479">mask2</a></span><span class="op" id="2529560">)</span><span class="op" id="2529561">&lt;&lt;</span><span class="num" id="2529563">6</span>&nbsp;<span class="op" id="2529565">|</span>&nbsp;<span class="builtintype" id="2529567">rune</span><span class="op" id="2529571">(</span><span class="ident" id="2529572"><a href="/unicode/utf8/utf8.go.html#2529428">c1</a></span><span class="op" id="2529574">&amp;</span><span class="ident" id="2529575"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2529580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529584">if</span>&nbsp;<span class="ident" id="2529587"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span>&nbsp;<span class="op" id="2529589">&lt;=</span>&nbsp;<span class="ident" id="2529592"><a href="/unicode/utf8/utf8.go.html#2527561">rune1Max</a></span>&nbsp;<span class="op" id="2529601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529606">return</span>&nbsp;<span class="ident" id="2529613"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2529622">,</span>&nbsp;<span class="num" id="2529624">1</span><span class="op" id="2529625">,</span>&nbsp;<span class="builtintype" id="2529627">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529635">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529639">return</span>&nbsp;<span class="ident" id="2529646"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span><span class="op" id="2529647">,</span>&nbsp;<span class="num" id="2529649">2</span><span class="op" id="2529650">,</span>&nbsp;<span class="builtintype" id="2529652">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529663">//&nbsp;need&nbsp;second&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529697">if</span>&nbsp;<span class="ident" id="2529700"><a href="/unicode/utf8/utf8.go.html#2529128">n</a></span>&nbsp;<span class="op" id="2529702">&lt;</span>&nbsp;<span class="num" id="2529704">3</span>&nbsp;<span class="op" id="2529706">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529710">return</span>&nbsp;<span class="ident" id="2529717"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2529726">,</span>&nbsp;<span class="num" id="2529728">1</span><span class="op" id="2529729">,</span>&nbsp;<span class="builtintype" id="2529731">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529740">c2</span>&nbsp;<span class="op" id="2529743">:=</span>&nbsp;<span class="ident" id="2529746"><a href="/unicode/utf8/utf8.go.html#2529084">s</a></span><span class="op" id="2529747">[</span><span class="num" id="2529748">2</span><span class="op" id="2529749">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529752">if</span>&nbsp;<span class="ident" id="2529755"><a href="/unicode/utf8/utf8.go.html#2529740">c2</a></span>&nbsp;<span class="op" id="2529758">&lt;</span>&nbsp;<span class="ident" id="2529760"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2529763">||</span>&nbsp;<span class="ident" id="2529766"><a href="/unicode/utf8/utf8.go.html#2527355">t2</a></span>&nbsp;<span class="op" id="2529769">&lt;=</span>&nbsp;<span class="ident" id="2529772"><a href="/unicode/utf8/utf8.go.html#2529740">c2</a></span>&nbsp;<span class="op" id="2529775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529779">return</span>&nbsp;<span class="ident" id="2529786"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2529795">,</span>&nbsp;<span class="num" id="2529797">1</span><span class="op" id="2529798">,</span>&nbsp;<span class="builtintype" id="2529800">false</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529811">//&nbsp;3-byte,&nbsp;16-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529840">if</span>&nbsp;<span class="ident" id="2529843"><a href="/unicode/utf8/utf8.go.html#2529184">c0</a></span>&nbsp;<span class="op" id="2529846">&lt;</span>&nbsp;<span class="ident" id="2529848"><a href="/unicode/utf8/utf8.go.html#2527403">t4</a></span>&nbsp;<span class="op" id="2529851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529855"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span>&nbsp;<span class="op" id="2529857">=</span>&nbsp;<span class="builtintype" id="2529859">rune</span><span class="op" id="2529863">(</span><span class="ident" id="2529864"><a href="/unicode/utf8/utf8.go.html#2529184">c0</a></span><span class="op" id="2529866">&amp;</span><span class="ident" id="2529867"><a href="/unicode/utf8/utf8.go.html#2527506">mask3</a></span><span class="op" id="2529872">)</span><span class="op" id="2529873">&lt;&lt;</span><span class="num" id="2529875">12</span>&nbsp;<span class="op" id="2529878">|</span>&nbsp;<span class="builtintype" id="2529880">rune</span><span class="op" id="2529884">(</span><span class="ident" id="2529885"><a href="/unicode/utf8/utf8.go.html#2529428">c1</a></span><span class="op" id="2529887">&amp;</span><span class="ident" id="2529888"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2529893">)</span><span class="op" id="2529894">&lt;&lt;</span><span class="num" id="2529896">6</span>&nbsp;<span class="op" id="2529898">|</span>&nbsp;<span class="builtintype" id="2529900">rune</span><span class="op" id="2529904">(</span><span class="ident" id="2529905"><a href="/unicode/utf8/utf8.go.html#2529740">c2</a></span><span class="op" id="2529907">&amp;</span><span class="ident" id="2529908"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2529913">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529917">if</span>&nbsp;<span class="ident" id="2529920"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span>&nbsp;<span class="op" id="2529922">&lt;=</span>&nbsp;<span class="ident" id="2529925"><a href="/unicode/utf8/utf8.go.html#2527582">rune2Max</a></span>&nbsp;<span class="op" id="2529934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529939">return</span>&nbsp;<span class="ident" id="2529946"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2529955">,</span>&nbsp;<span class="num" id="2529957">1</span><span class="op" id="2529958">,</span>&nbsp;<span class="builtintype" id="2529960">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529972">if</span>&nbsp;<span class="ident" id="2529975"><a href="/unicode/utf8/utf8.go.html#2527250">surrogateMin</a></span>&nbsp;<span class="op" id="2529988">&lt;=</span>&nbsp;<span class="ident" id="2529991"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span>&nbsp;<span class="op" id="2529993">&amp;&amp;</span>&nbsp;<span class="ident" id="2529996"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span>&nbsp;<span class="op" id="2529998">&lt;=</span>&nbsp;<span class="ident" id="2530001"><a href="/unicode/utf8/utf8.go.html#2527273">surrogateMax</a></span>&nbsp;<span class="op" id="2530014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530019">return</span>&nbsp;<span class="ident" id="2530026"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2530035">,</span>&nbsp;<span class="num" id="2530037">1</span><span class="op" id="2530038">,</span>&nbsp;<span class="builtintype" id="2530040">false</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530052">return</span>&nbsp;<span class="ident" id="2530059"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span><span class="op" id="2530060">,</span>&nbsp;<span class="num" id="2530062">3</span><span class="op" id="2530063">,</span>&nbsp;<span class="builtintype" id="2530065">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530076">//&nbsp;need&nbsp;third&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530109">if</span>&nbsp;<span class="ident" id="2530112"><a href="/unicode/utf8/utf8.go.html#2529128">n</a></span>&nbsp;<span class="op" id="2530114">&lt;</span>&nbsp;<span class="num" id="2530116">4</span>&nbsp;<span class="op" id="2530118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530122">return</span>&nbsp;<span class="ident" id="2530129"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2530138">,</span>&nbsp;<span class="num" id="2530140">1</span><span class="op" id="2530141">,</span>&nbsp;<span class="builtintype" id="2530143">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530152">c3</span>&nbsp;<span class="op" id="2530155">:=</span>&nbsp;<span class="ident" id="2530158"><a href="/unicode/utf8/utf8.go.html#2529084">s</a></span><span class="op" id="2530159">[</span><span class="num" id="2530160">3</span><span class="op" id="2530161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530164">if</span>&nbsp;<span class="ident" id="2530167"><a href="/unicode/utf8/utf8.go.html#2530152">c3</a></span>&nbsp;<span class="op" id="2530170">&lt;</span>&nbsp;<span class="ident" id="2530172"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2530175">||</span>&nbsp;<span class="ident" id="2530178"><a href="/unicode/utf8/utf8.go.html#2527355">t2</a></span>&nbsp;<span class="op" id="2530181">&lt;=</span>&nbsp;<span class="ident" id="2530184"><a href="/unicode/utf8/utf8.go.html#2530152">c3</a></span>&nbsp;<span class="op" id="2530187">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530191">return</span>&nbsp;<span class="ident" id="2530198"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2530207">,</span>&nbsp;<span class="num" id="2530209">1</span><span class="op" id="2530210">,</span>&nbsp;<span class="builtintype" id="2530212">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530223">//&nbsp;4-byte,&nbsp;21-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530252">if</span>&nbsp;<span class="ident" id="2530255"><a href="/unicode/utf8/utf8.go.html#2529184">c0</a></span>&nbsp;<span class="op" id="2530258">&lt;</span>&nbsp;<span class="ident" id="2530260"><a href="/unicode/utf8/utf8.go.html#2527427">t5</a></span>&nbsp;<span class="op" id="2530263">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530267"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span>&nbsp;<span class="op" id="2530269">=</span>&nbsp;<span class="builtintype" id="2530271">rune</span><span class="op" id="2530275">(</span><span class="ident" id="2530276"><a href="/unicode/utf8/utf8.go.html#2529184">c0</a></span><span class="op" id="2530278">&amp;</span><span class="ident" id="2530279"><a href="/unicode/utf8/utf8.go.html#2527533">mask4</a></span><span class="op" id="2530284">)</span><span class="op" id="2530285">&lt;&lt;</span><span class="num" id="2530287">18</span>&nbsp;<span class="op" id="2530290">|</span>&nbsp;<span class="builtintype" id="2530292">rune</span><span class="op" id="2530296">(</span><span class="ident" id="2530297"><a href="/unicode/utf8/utf8.go.html#2529428">c1</a></span><span class="op" id="2530299">&amp;</span><span class="ident" id="2530300"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2530305">)</span><span class="op" id="2530306">&lt;&lt;</span><span class="num" id="2530308">12</span>&nbsp;<span class="op" id="2530311">|</span>&nbsp;<span class="builtintype" id="2530313">rune</span><span class="op" id="2530317">(</span><span class="ident" id="2530318"><a href="/unicode/utf8/utf8.go.html#2529740">c2</a></span><span class="op" id="2530320">&amp;</span><span class="ident" id="2530321"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2530326">)</span><span class="op" id="2530327">&lt;&lt;</span><span class="num" id="2530329">6</span>&nbsp;<span class="op" id="2530331">|</span>&nbsp;<span class="builtintype" id="2530333">rune</span><span class="op" id="2530337">(</span><span class="ident" id="2530338"><a href="/unicode/utf8/utf8.go.html#2530152">c3</a></span><span class="op" id="2530340">&amp;</span><span class="ident" id="2530341"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><span class="op" id="2530346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530350">if</span>&nbsp;<span class="ident" id="2530353"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span>&nbsp;<span class="op" id="2530355">&lt;=</span>&nbsp;<span class="ident" id="2530358"><a href="/unicode/utf8/utf8.go.html#2527604">rune3Max</a></span>&nbsp;<span class="op" id="2530367">||</span>&nbsp;<span class="ident" id="2530370"><a href="/unicode/utf8/utf8.go.html#2527022">MaxRune</a></span>&nbsp;<span class="op" id="2530378">&lt;</span>&nbsp;<span class="ident" id="2530380"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span>&nbsp;<span class="op" id="2530382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530387">return</span>&nbsp;<span class="ident" id="2530394"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2530403">,</span>&nbsp;<span class="num" id="2530405">1</span><span class="op" id="2530406">,</span>&nbsp;<span class="builtintype" id="2530408">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530420">return</span>&nbsp;<span class="ident" id="2530427"><a href="/unicode/utf8/utf8.go.html#2529095">r</a></span><span class="op" id="2530428">,</span>&nbsp;<span class="num" id="2530430">4</span><span class="op" id="2530431">,</span>&nbsp;<span class="builtintype" id="2530433">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530444">//&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530454">return</span>&nbsp;<span class="ident" id="2530461"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2530470">,</span>&nbsp;<span class="num" id="2530472">1</span><span class="op" id="2530473">,</span>&nbsp;<span class="builtintype" id="2530475">false</span><br>
<span class="lineno"></span><span class="op" id="2530481">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="comment" id="2530484">//&nbsp;FullRune&nbsp;reports&nbsp;whether&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;begin&nbsp;with&nbsp;a&nbsp;full&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;a&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="2530571">//&nbsp;An&nbsp;invalid&nbsp;encoding&nbsp;is&nbsp;considered&nbsp;a&nbsp;full&nbsp;Rune&nbsp;since&nbsp;it&nbsp;will&nbsp;convert&nbsp;as&nbsp;a&nbsp;width-1&nbsp;error&nbsp;rune.</span><br>
<span class="lineno"></span><span class="keyword" id="2530667">func</span>&nbsp;<span class="ident" id="2530672">FullRune</span><span class="op" id="2530680">(</span><span class="ident" id="2530681">p</span>&nbsp;<span class="op" id="2530683">[</span><span class="op" id="2530684">]</span><span class="builtintype" id="2530685">byte</span><span class="op" id="2530689">)</span>&nbsp;<span class="builtintype" id="2530691">bool</span>&nbsp;<span class="op" id="2530696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530699">_</span><span class="op" id="2530700">,</span>&nbsp;<span class="ident" id="2530702">_</span><span class="op" id="2530703">,</span>&nbsp;<span class="ident" id="2530705">short</span>&nbsp;<span class="op" id="2530711">:=</span>&nbsp;<span class="ident" id="2530714"><a href="/unicode/utf8/utf8.go.html#2527633">decodeRuneInternal</a></span><span class="op" id="2530732">(</span><span class="ident" id="2530733"><a href="/unicode/utf8/utf8.go.html#2530681">p</a></span><span class="op" id="2530734">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530737">return</span>&nbsp;<span class="op" id="2530744">!</span><span class="ident" id="2530745"><a href="/unicode/utf8/utf8.go.html#2530705">short</a></span><br>
<span class="lineno"></span><span class="op" id="2530751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2530754">//&nbsp;FullRuneInString&nbsp;is&nbsp;like&nbsp;FullRune&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2530818">func</span>&nbsp;<span class="ident" id="2530823">FullRuneInString</span><span class="op" id="2530839">(</span><span class="ident" id="2530840">s</span>&nbsp;<span class="builtintype" id="2530842">string</span><span class="op" id="2530848">)</span>&nbsp;<span class="builtintype" id="2530850">bool</span>&nbsp;<span class="op" id="2530855">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530858">_</span><span class="op" id="2530859">,</span>&nbsp;<span class="ident" id="2530861">_</span><span class="op" id="2530862">,</span>&nbsp;<span class="ident" id="2530864">short</span>&nbsp;<span class="op" id="2530870">:=</span>&nbsp;<span class="ident" id="2530873"><a href="/unicode/utf8/utf8.go.html#2529057">decodeRuneInStringInternal</a></span><span class="op" id="2530899">(</span><span class="ident" id="2530900"><a href="/unicode/utf8/utf8.go.html#2530840">s</a></span><span class="op" id="2530901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530904">return</span>&nbsp;<span class="op" id="2530911">!</span><span class="ident" id="2530912"><a href="/unicode/utf8/utf8.go.html#2530864">short</a></span><br>
<span class="lineno"></span><span class="op" id="2530918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2530921">//&nbsp;DecodeRune&nbsp;unpacks&nbsp;the&nbsp;first&nbsp;UTF-8&nbsp;encoding&nbsp;in&nbsp;p&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="2530998">//&nbsp;its&nbsp;width&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;p&nbsp;is&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2531076">//&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible</span><br>
<span class="lineno"></span><span class="comment" id="2531151">//&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="2531181">//</span><br>
<span class="lineno"></span><span class="comment" id="2531184">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno">220</span><span class="comment" id="2531259">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2531331">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="2531375">func</span>&nbsp;<span class="ident" id="2531380">DecodeRune</span><span class="op" id="2531390">(</span><span class="ident" id="2531391">p</span>&nbsp;<span class="op" id="2531393">[</span><span class="op" id="2531394">]</span><span class="builtintype" id="2531395">byte</span><span class="op" id="2531399">)</span>&nbsp;<span class="op" id="2531401">(</span><span class="ident" id="2531402">r</span>&nbsp;<span class="builtintype" id="2531404">rune</span><span class="op" id="2531408">,</span>&nbsp;<span class="ident" id="2531410">size</span>&nbsp;<span class="builtintype" id="2531415">int</span><span class="op" id="2531418">)</span>&nbsp;<span class="op" id="2531420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531423"><a href="/unicode/utf8/utf8.go.html#2531402">r</a></span><span class="op" id="2531424">,</span>&nbsp;<span class="ident" id="2531426"><a href="/unicode/utf8/utf8.go.html#2531410">size</a></span><span class="op" id="2531430">,</span>&nbsp;<span class="ident" id="2531432">_</span>&nbsp;<span class="op" id="2531434">=</span>&nbsp;<span class="ident" id="2531436"><a href="/unicode/utf8/utf8.go.html#2527633">decodeRuneInternal</a></span><span class="op" id="2531454">(</span><span class="ident" id="2531455"><a href="/unicode/utf8/utf8.go.html#2531391">p</a></span><span class="op" id="2531456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531459">return</span><br>
<span class="lineno">225</span><span class="op" id="2531466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2531469">//&nbsp;DecodeRuneInString&nbsp;is&nbsp;like&nbsp;DecodeRune&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.&nbsp;If&nbsp;s&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2531545">//&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2531623">//&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno">230</span><span class="comment" id="2531697">//</span><br>
<span class="lineno"></span><span class="comment" id="2531700">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2531775">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2531847">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="2531891">func</span>&nbsp;<span class="ident" id="2531896">DecodeRuneInString</span><span class="op" id="2531914">(</span><span class="ident" id="2531915">s</span>&nbsp;<span class="builtintype" id="2531917">string</span><span class="op" id="2531923">)</span>&nbsp;<span class="op" id="2531925">(</span><span class="ident" id="2531926">r</span>&nbsp;<span class="builtintype" id="2531928">rune</span><span class="op" id="2531932">,</span>&nbsp;<span class="ident" id="2531934">size</span>&nbsp;<span class="builtintype" id="2531939">int</span><span class="op" id="2531942">)</span>&nbsp;<span class="op" id="2531944">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531947"><a href="/unicode/utf8/utf8.go.html#2531926">r</a></span><span class="op" id="2531948">,</span>&nbsp;<span class="ident" id="2531950"><a href="/unicode/utf8/utf8.go.html#2531934">size</a></span><span class="op" id="2531954">,</span>&nbsp;<span class="ident" id="2531956">_</span>&nbsp;<span class="op" id="2531958">=</span>&nbsp;<span class="ident" id="2531960"><a href="/unicode/utf8/utf8.go.html#2529057">decodeRuneInStringInternal</a></span><span class="op" id="2531986">(</span><span class="ident" id="2531987"><a href="/unicode/utf8/utf8.go.html#2531915">s</a></span><span class="op" id="2531988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531991">return</span><br>
<span class="lineno"></span><span class="op" id="2531998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2532001">//&nbsp;DecodeLastRune&nbsp;unpacks&nbsp;the&nbsp;last&nbsp;UTF-8&nbsp;encoding&nbsp;in&nbsp;p&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and</span><br>
<span class="lineno">240</span><span class="comment" id="2532081">//&nbsp;its&nbsp;width&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;p&nbsp;is&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2532159">//&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible</span><br>
<span class="lineno"></span><span class="comment" id="2532234">//&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="2532264">//</span><br>
<span class="lineno"></span><span class="comment" id="2532267">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno">245</span><span class="comment" id="2532342">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2532414">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="2532458">func</span>&nbsp;<span class="ident" id="2532463">DecodeLastRune</span><span class="op" id="2532477">(</span><span class="ident" id="2532478">p</span>&nbsp;<span class="op" id="2532480">[</span><span class="op" id="2532481">]</span><span class="builtintype" id="2532482">byte</span><span class="op" id="2532486">)</span>&nbsp;<span class="op" id="2532488">(</span><span class="ident" id="2532489">r</span>&nbsp;<span class="builtintype" id="2532491">rune</span><span class="op" id="2532495">,</span>&nbsp;<span class="ident" id="2532497">size</span>&nbsp;<span class="builtintype" id="2532502">int</span><span class="op" id="2532505">)</span>&nbsp;<span class="op" id="2532507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532510">end</span>&nbsp;<span class="op" id="2532514">:=</span>&nbsp;<span class="builtinfunc" id="2532517">len</span><span class="op" id="2532520">(</span><span class="ident" id="2532521"><a href="/unicode/utf8/utf8.go.html#2532478">p</a></span><span class="op" id="2532522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532525">if</span>&nbsp;<span class="ident" id="2532528"><a href="/unicode/utf8/utf8.go.html#2532510">end</a></span>&nbsp;<span class="op" id="2532532">==</span>&nbsp;<span class="num" id="2532535">0</span>&nbsp;<span class="op" id="2532537">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532541">return</span>&nbsp;<span class="ident" id="2532548"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2532557">,</span>&nbsp;<span class="num" id="2532559">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532565">start</span>&nbsp;<span class="op" id="2532571">:=</span>&nbsp;<span class="ident" id="2532574"><a href="/unicode/utf8/utf8.go.html#2532510">end</a></span>&nbsp;<span class="op" id="2532578">-</span>&nbsp;<span class="num" id="2532580">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532583"><a href="/unicode/utf8/utf8.go.html#2532489">r</a></span>&nbsp;<span class="op" id="2532585">=</span>&nbsp;<span class="builtintype" id="2532587">rune</span><span class="op" id="2532591">(</span><span class="ident" id="2532592"><a href="/unicode/utf8/utf8.go.html#2532478">p</a></span><span class="op" id="2532593">[</span><span class="ident" id="2532594"><a href="/unicode/utf8/utf8.go.html#2532565">start</a></span><span class="op" id="2532599">]</span><span class="op" id="2532600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532603">if</span>&nbsp;<span class="ident" id="2532606"><a href="/unicode/utf8/utf8.go.html#2532489">r</a></span>&nbsp;<span class="op" id="2532608">&lt;</span>&nbsp;<span class="ident" id="2532610"><a href="/unicode/utf8/utf8.go.html#2526919">RuneSelf</a></span>&nbsp;<span class="op" id="2532619">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532623">return</span>&nbsp;<span class="ident" id="2532630"><a href="/unicode/utf8/utf8.go.html#2532489">r</a></span><span class="op" id="2532631">,</span>&nbsp;<span class="num" id="2532633">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532639">//&nbsp;guard&nbsp;against&nbsp;O(n^2)&nbsp;behavior&nbsp;when&nbsp;traversing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532689">//&nbsp;backwards&nbsp;through&nbsp;strings&nbsp;with&nbsp;long&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532742">//&nbsp;invalid&nbsp;UTF-8.</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532761">lim</span>&nbsp;<span class="op" id="2532765">:=</span>&nbsp;<span class="ident" id="2532768"><a href="/unicode/utf8/utf8.go.html#2532510">end</a></span>&nbsp;<span class="op" id="2532772">-</span>&nbsp;<span class="ident" id="2532774"><a href="/unicode/utf8/utf8.go.html#2527085">UTFMax</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532782">if</span>&nbsp;<span class="ident" id="2532785"><a href="/unicode/utf8/utf8.go.html#2532761">lim</a></span>&nbsp;<span class="op" id="2532789">&lt;</span>&nbsp;<span class="num" id="2532791">0</span>&nbsp;<span class="op" id="2532793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532797"><a href="/unicode/utf8/utf8.go.html#2532761">lim</a></span>&nbsp;<span class="op" id="2532801">=</span>&nbsp;<span class="num" id="2532803">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532809">for</span>&nbsp;<span class="ident" id="2532813"><a href="/unicode/utf8/utf8.go.html#2532565">start</a></span><span class="op" id="2532818">--</span><span class="op" id="2532820">;</span>&nbsp;<span class="ident" id="2532822"><a href="/unicode/utf8/utf8.go.html#2532565">start</a></span>&nbsp;<span class="op" id="2532828">&gt;=</span>&nbsp;<span class="ident" id="2532831"><a href="/unicode/utf8/utf8.go.html#2532761">lim</a></span><span class="op" id="2532834">;</span>&nbsp;<span class="ident" id="2532836"><a href="/unicode/utf8/utf8.go.html#2532565">start</a></span><span class="op" id="2532841">--</span>&nbsp;<span class="op" id="2532844">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532848">if</span>&nbsp;<span class="ident" id="2532851"><a href="/unicode/utf8/utf8.go.html#2535816">RuneStart</a></span><span class="op" id="2532860">(</span><span class="ident" id="2532861"><a href="/unicode/utf8/utf8.go.html#2532478">p</a></span><span class="op" id="2532862">[</span><span class="ident" id="2532863"><a href="/unicode/utf8/utf8.go.html#2532565">start</a></span><span class="op" id="2532868">]</span><span class="op" id="2532869">)</span>&nbsp;<span class="op" id="2532871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532876">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532890">if</span>&nbsp;<span class="ident" id="2532893"><a href="/unicode/utf8/utf8.go.html#2532565">start</a></span>&nbsp;<span class="op" id="2532899">&lt;</span>&nbsp;<span class="num" id="2532901">0</span>&nbsp;<span class="op" id="2532903">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532907"><a href="/unicode/utf8/utf8.go.html#2532565">start</a></span>&nbsp;<span class="op" id="2532913">=</span>&nbsp;<span class="num" id="2532915">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532921"><a href="/unicode/utf8/utf8.go.html#2532489">r</a></span><span class="op" id="2532922">,</span>&nbsp;<span class="ident" id="2532924"><a href="/unicode/utf8/utf8.go.html#2532497">size</a></span>&nbsp;<span class="op" id="2532929">=</span>&nbsp;<span class="ident" id="2532931"><a href="/unicode/utf8/utf8.go.html#2531380">DecodeRune</a></span><span class="op" id="2532941">(</span><span class="ident" id="2532942"><a href="/unicode/utf8/utf8.go.html#2532478">p</a></span><span class="op" id="2532943">[</span><span class="ident" id="2532944"><a href="/unicode/utf8/utf8.go.html#2532565">start</a></span><span class="op" id="2532949">:</span><span class="ident" id="2532950"><a href="/unicode/utf8/utf8.go.html#2532510">end</a></span><span class="op" id="2532953">]</span><span class="op" id="2532954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532957">if</span>&nbsp;<span class="ident" id="2532960"><a href="/unicode/utf8/utf8.go.html#2532565">start</a></span><span class="op" id="2532965">+</span><span class="ident" id="2532966"><a href="/unicode/utf8/utf8.go.html#2532497">size</a></span>&nbsp;<span class="op" id="2532971">!=</span>&nbsp;<span class="ident" id="2532974"><a href="/unicode/utf8/utf8.go.html#2532510">end</a></span>&nbsp;<span class="op" id="2532978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532982">return</span>&nbsp;<span class="ident" id="2532989"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2532998">,</span>&nbsp;<span class="num" id="2533000">1</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533006">return</span>&nbsp;<span class="ident" id="2533013"><a href="/unicode/utf8/utf8.go.html#2532489">r</a></span><span class="op" id="2533014">,</span>&nbsp;<span class="ident" id="2533016"><a href="/unicode/utf8/utf8.go.html#2532497">size</a></span><br>
<span class="lineno"></span><span class="op" id="2533021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2533024">//&nbsp;DecodeLastRuneInString&nbsp;is&nbsp;like&nbsp;DecodeLastRune&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.&nbsp;If</span><br>
<span class="lineno">280</span><span class="comment" id="2533103">//&nbsp;s&nbsp;is&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span><span class="comment" id="2533183">//&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="2533260">//</span><br>
<span class="lineno"></span><span class="comment" id="2533263">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2533338">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno">285</span><span class="comment" id="2533410">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="2533454">func</span>&nbsp;<span class="ident" id="2533459">DecodeLastRuneInString</span><span class="op" id="2533481">(</span><span class="ident" id="2533482">s</span>&nbsp;<span class="builtintype" id="2533484">string</span><span class="op" id="2533490">)</span>&nbsp;<span class="op" id="2533492">(</span><span class="ident" id="2533493">r</span>&nbsp;<span class="builtintype" id="2533495">rune</span><span class="op" id="2533499">,</span>&nbsp;<span class="ident" id="2533501">size</span>&nbsp;<span class="builtintype" id="2533506">int</span><span class="op" id="2533509">)</span>&nbsp;<span class="op" id="2533511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533514">end</span>&nbsp;<span class="op" id="2533518">:=</span>&nbsp;<span class="builtinfunc" id="2533521">len</span><span class="op" id="2533524">(</span><span class="ident" id="2533525"><a href="/unicode/utf8/utf8.go.html#2533482">s</a></span><span class="op" id="2533526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533529">if</span>&nbsp;<span class="ident" id="2533532"><a href="/unicode/utf8/utf8.go.html#2533514">end</a></span>&nbsp;<span class="op" id="2533536">==</span>&nbsp;<span class="num" id="2533539">0</span>&nbsp;<span class="op" id="2533541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533545">return</span>&nbsp;<span class="ident" id="2533552"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2533561">,</span>&nbsp;<span class="num" id="2533563">0</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533569">start</span>&nbsp;<span class="op" id="2533575">:=</span>&nbsp;<span class="ident" id="2533578"><a href="/unicode/utf8/utf8.go.html#2533514">end</a></span>&nbsp;<span class="op" id="2533582">-</span>&nbsp;<span class="num" id="2533584">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533587"><a href="/unicode/utf8/utf8.go.html#2533493">r</a></span>&nbsp;<span class="op" id="2533589">=</span>&nbsp;<span class="builtintype" id="2533591">rune</span><span class="op" id="2533595">(</span><span class="ident" id="2533596"><a href="/unicode/utf8/utf8.go.html#2533482">s</a></span><span class="op" id="2533597">[</span><span class="ident" id="2533598"><a href="/unicode/utf8/utf8.go.html#2533569">start</a></span><span class="op" id="2533603">]</span><span class="op" id="2533604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533607">if</span>&nbsp;<span class="ident" id="2533610"><a href="/unicode/utf8/utf8.go.html#2533493">r</a></span>&nbsp;<span class="op" id="2533612">&lt;</span>&nbsp;<span class="ident" id="2533614"><a href="/unicode/utf8/utf8.go.html#2526919">RuneSelf</a></span>&nbsp;<span class="op" id="2533623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533627">return</span>&nbsp;<span class="ident" id="2533634"><a href="/unicode/utf8/utf8.go.html#2533493">r</a></span><span class="op" id="2533635">,</span>&nbsp;<span class="num" id="2533637">1</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533643">//&nbsp;guard&nbsp;against&nbsp;O(n^2)&nbsp;behavior&nbsp;when&nbsp;traversing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533693">//&nbsp;backwards&nbsp;through&nbsp;strings&nbsp;with&nbsp;long&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533746">//&nbsp;invalid&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533765">lim</span>&nbsp;<span class="op" id="2533769">:=</span>&nbsp;<span class="ident" id="2533772"><a href="/unicode/utf8/utf8.go.html#2533514">end</a></span>&nbsp;<span class="op" id="2533776">-</span>&nbsp;<span class="ident" id="2533778"><a href="/unicode/utf8/utf8.go.html#2527085">UTFMax</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533786">if</span>&nbsp;<span class="ident" id="2533789"><a href="/unicode/utf8/utf8.go.html#2533765">lim</a></span>&nbsp;<span class="op" id="2533793">&lt;</span>&nbsp;<span class="num" id="2533795">0</span>&nbsp;<span class="op" id="2533797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533801"><a href="/unicode/utf8/utf8.go.html#2533765">lim</a></span>&nbsp;<span class="op" id="2533805">=</span>&nbsp;<span class="num" id="2533807">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533813">for</span>&nbsp;<span class="ident" id="2533817"><a href="/unicode/utf8/utf8.go.html#2533569">start</a></span><span class="op" id="2533822">--</span><span class="op" id="2533824">;</span>&nbsp;<span class="ident" id="2533826"><a href="/unicode/utf8/utf8.go.html#2533569">start</a></span>&nbsp;<span class="op" id="2533832">&gt;=</span>&nbsp;<span class="ident" id="2533835"><a href="/unicode/utf8/utf8.go.html#2533765">lim</a></span><span class="op" id="2533838">;</span>&nbsp;<span class="ident" id="2533840"><a href="/unicode/utf8/utf8.go.html#2533569">start</a></span><span class="op" id="2533845">--</span>&nbsp;<span class="op" id="2533848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533852">if</span>&nbsp;<span class="ident" id="2533855"><a href="/unicode/utf8/utf8.go.html#2535816">RuneStart</a></span><span class="op" id="2533864">(</span><span class="ident" id="2533865"><a href="/unicode/utf8/utf8.go.html#2533482">s</a></span><span class="op" id="2533866">[</span><span class="ident" id="2533867"><a href="/unicode/utf8/utf8.go.html#2533569">start</a></span><span class="op" id="2533872">]</span><span class="op" id="2533873">)</span>&nbsp;<span class="op" id="2533875">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533880">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533894">if</span>&nbsp;<span class="ident" id="2533897"><a href="/unicode/utf8/utf8.go.html#2533569">start</a></span>&nbsp;<span class="op" id="2533903">&lt;</span>&nbsp;<span class="num" id="2533905">0</span>&nbsp;<span class="op" id="2533907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533911"><a href="/unicode/utf8/utf8.go.html#2533569">start</a></span>&nbsp;<span class="op" id="2533917">=</span>&nbsp;<span class="num" id="2533919">0</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533925"><a href="/unicode/utf8/utf8.go.html#2533493">r</a></span><span class="op" id="2533926">,</span>&nbsp;<span class="ident" id="2533928"><a href="/unicode/utf8/utf8.go.html#2533501">size</a></span>&nbsp;<span class="op" id="2533933">=</span>&nbsp;<span class="ident" id="2533935"><a href="/unicode/utf8/utf8.go.html#2531896">DecodeRuneInString</a></span><span class="op" id="2533953">(</span><span class="ident" id="2533954"><a href="/unicode/utf8/utf8.go.html#2533482">s</a></span><span class="op" id="2533955">[</span><span class="ident" id="2533956"><a href="/unicode/utf8/utf8.go.html#2533569">start</a></span><span class="op" id="2533961">:</span><span class="ident" id="2533962"><a href="/unicode/utf8/utf8.go.html#2533514">end</a></span><span class="op" id="2533965">]</span><span class="op" id="2533966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533969">if</span>&nbsp;<span class="ident" id="2533972"><a href="/unicode/utf8/utf8.go.html#2533569">start</a></span><span class="op" id="2533977">+</span><span class="ident" id="2533978"><a href="/unicode/utf8/utf8.go.html#2533501">size</a></span>&nbsp;<span class="op" id="2533983">!=</span>&nbsp;<span class="ident" id="2533986"><a href="/unicode/utf8/utf8.go.html#2533514">end</a></span>&nbsp;<span class="op" id="2533990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533994">return</span>&nbsp;<span class="ident" id="2534001"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><span class="op" id="2534010">,</span>&nbsp;<span class="num" id="2534012">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534015">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534018">return</span>&nbsp;<span class="ident" id="2534025"><a href="/unicode/utf8/utf8.go.html#2533493">r</a></span><span class="op" id="2534026">,</span>&nbsp;<span class="ident" id="2534028"><a href="/unicode/utf8/utf8.go.html#2533501">size</a></span><br>
<span class="lineno"></span><span class="op" id="2534033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2534036">//&nbsp;RuneLen&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;required&nbsp;to&nbsp;encode&nbsp;the&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="2534104">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;value&nbsp;to&nbsp;encode&nbsp;in&nbsp;UTF-8.</span><br>
<span class="lineno">320</span><span class="keyword" id="2534174">func</span>&nbsp;<span class="ident" id="2534179">RuneLen</span><span class="op" id="2534186">(</span><span class="ident" id="2534187">r</span>&nbsp;<span class="builtintype" id="2534189">rune</span><span class="op" id="2534193">)</span>&nbsp;<span class="builtintype" id="2534195">int</span>&nbsp;<span class="op" id="2534199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534202">switch</span>&nbsp;<span class="op" id="2534209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534212">case</span>&nbsp;<span class="ident" id="2534217"><a href="/unicode/utf8/utf8.go.html#2534187">r</a></span>&nbsp;<span class="op" id="2534219">&lt;</span>&nbsp;<span class="num" id="2534221">0</span><span class="op" id="2534222">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534226">return</span>&nbsp;<span class="op" id="2534233">-</span><span class="num" id="2534234">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534237">case</span>&nbsp;<span class="ident" id="2534242"><a href="/unicode/utf8/utf8.go.html#2534187">r</a></span>&nbsp;<span class="op" id="2534244">&lt;=</span>&nbsp;<span class="ident" id="2534247"><a href="/unicode/utf8/utf8.go.html#2527561">rune1Max</a></span><span class="op" id="2534255">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534259">return</span>&nbsp;<span class="num" id="2534266">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534269">case</span>&nbsp;<span class="ident" id="2534274"><a href="/unicode/utf8/utf8.go.html#2534187">r</a></span>&nbsp;<span class="op" id="2534276">&lt;=</span>&nbsp;<span class="ident" id="2534279"><a href="/unicode/utf8/utf8.go.html#2527582">rune2Max</a></span><span class="op" id="2534287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534291">return</span>&nbsp;<span class="num" id="2534298">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534301">case</span>&nbsp;<span class="ident" id="2534306"><a href="/unicode/utf8/utf8.go.html#2527250">surrogateMin</a></span>&nbsp;<span class="op" id="2534319">&lt;=</span>&nbsp;<span class="ident" id="2534322"><a href="/unicode/utf8/utf8.go.html#2534187">r</a></span>&nbsp;<span class="op" id="2534324">&amp;&amp;</span>&nbsp;<span class="ident" id="2534327"><a href="/unicode/utf8/utf8.go.html#2534187">r</a></span>&nbsp;<span class="op" id="2534329">&lt;=</span>&nbsp;<span class="ident" id="2534332"><a href="/unicode/utf8/utf8.go.html#2527273">surrogateMax</a></span><span class="op" id="2534344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534348">return</span>&nbsp;<span class="op" id="2534355">-</span><span class="num" id="2534356">1</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534359">case</span>&nbsp;<span class="ident" id="2534364"><a href="/unicode/utf8/utf8.go.html#2534187">r</a></span>&nbsp;<span class="op" id="2534366">&lt;=</span>&nbsp;<span class="ident" id="2534369"><a href="/unicode/utf8/utf8.go.html#2527604">rune3Max</a></span><span class="op" id="2534377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534381">return</span>&nbsp;<span class="num" id="2534388">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534391">case</span>&nbsp;<span class="ident" id="2534396"><a href="/unicode/utf8/utf8.go.html#2534187">r</a></span>&nbsp;<span class="op" id="2534398">&lt;=</span>&nbsp;<span class="ident" id="2534401"><a href="/unicode/utf8/utf8.go.html#2527022">MaxRune</a></span><span class="op" id="2534408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534412">return</span>&nbsp;<span class="num" id="2534419">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534422">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534425">return</span>&nbsp;<span class="op" id="2534432">-</span><span class="num" id="2534433">1</span><br>
<span class="lineno"></span><span class="op" id="2534435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2534438">//&nbsp;EncodeRune&nbsp;writes&nbsp;into&nbsp;p&nbsp;(which&nbsp;must&nbsp;be&nbsp;large&nbsp;enough)&nbsp;the&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;the&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="2534527">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno">340</span><span class="keyword" id="2534570">func</span>&nbsp;<span class="ident" id="2534575">EncodeRune</span><span class="op" id="2534585">(</span><span class="ident" id="2534586">p</span>&nbsp;<span class="op" id="2534588">[</span><span class="op" id="2534589">]</span><span class="builtintype" id="2534590">byte</span><span class="op" id="2534594">,</span>&nbsp;<span class="ident" id="2534596">r</span>&nbsp;<span class="builtintype" id="2534598">rune</span><span class="op" id="2534602">)</span>&nbsp;<span class="builtintype" id="2534604">int</span>&nbsp;<span class="op" id="2534608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2534611">//&nbsp;Negative&nbsp;values&nbsp;are&nbsp;erroneous.&nbsp;&nbsp;Making&nbsp;it&nbsp;unsigned&nbsp;addresses&nbsp;the&nbsp;problem.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534689">switch</span>&nbsp;<span class="ident" id="2534696">i</span>&nbsp;<span class="op" id="2534698">:=</span>&nbsp;<span class="builtintype" id="2534701">uint32</span><span class="op" id="2534707">(</span><span class="ident" id="2534708"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2534709">)</span><span class="op" id="2534710">;</span>&nbsp;<span class="op" id="2534712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534715">case</span>&nbsp;<span class="ident" id="2534720"><a href="/unicode/utf8/utf8.go.html#2534696">i</a></span>&nbsp;<span class="op" id="2534722">&lt;=</span>&nbsp;<span class="ident" id="2534725"><a href="/unicode/utf8/utf8.go.html#2527561">rune1Max</a></span><span class="op" id="2534733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534737"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2534738">[</span><span class="num" id="2534739">0</span><span class="op" id="2534740">]</span>&nbsp;<span class="op" id="2534742">=</span>&nbsp;<span class="builtintype" id="2534744">byte</span><span class="op" id="2534748">(</span><span class="ident" id="2534749"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2534750">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534754">return</span>&nbsp;<span class="num" id="2534761">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534764">case</span>&nbsp;<span class="ident" id="2534769"><a href="/unicode/utf8/utf8.go.html#2534696">i</a></span>&nbsp;<span class="op" id="2534771">&lt;=</span>&nbsp;<span class="ident" id="2534774"><a href="/unicode/utf8/utf8.go.html#2527582">rune2Max</a></span><span class="op" id="2534782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534786"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2534787">[</span><span class="num" id="2534788">0</span><span class="op" id="2534789">]</span>&nbsp;<span class="op" id="2534791">=</span>&nbsp;<span class="ident" id="2534793"><a href="/unicode/utf8/utf8.go.html#2527355">t2</a></span>&nbsp;<span class="op" id="2534796">|</span>&nbsp;<span class="builtintype" id="2534798">byte</span><span class="op" id="2534802">(</span><span class="ident" id="2534803"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2534804">&gt;&gt;</span><span class="num" id="2534806">6</span><span class="op" id="2534807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534811"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2534812">[</span><span class="num" id="2534813">1</span><span class="op" id="2534814">]</span>&nbsp;<span class="op" id="2534816">=</span>&nbsp;<span class="ident" id="2534818"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2534821">|</span>&nbsp;<span class="builtintype" id="2534823">byte</span><span class="op" id="2534827">(</span><span class="ident" id="2534828"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2534829">)</span><span class="op" id="2534830">&amp;</span><span class="ident" id="2534831"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534839">return</span>&nbsp;<span class="num" id="2534846">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534849">case</span>&nbsp;<span class="ident" id="2534854"><a href="/unicode/utf8/utf8.go.html#2534696">i</a></span>&nbsp;<span class="op" id="2534856">&gt;</span>&nbsp;<span class="ident" id="2534858"><a href="/unicode/utf8/utf8.go.html#2527022">MaxRune</a></span><span class="op" id="2534865">,</span>&nbsp;<span class="ident" id="2534867"><a href="/unicode/utf8/utf8.go.html#2527250">surrogateMin</a></span>&nbsp;<span class="op" id="2534880">&lt;=</span>&nbsp;<span class="ident" id="2534883"><a href="/unicode/utf8/utf8.go.html#2534696">i</a></span>&nbsp;<span class="op" id="2534885">&amp;&amp;</span>&nbsp;<span class="ident" id="2534888"><a href="/unicode/utf8/utf8.go.html#2534696">i</a></span>&nbsp;<span class="op" id="2534890">&lt;=</span>&nbsp;<span class="ident" id="2534893"><a href="/unicode/utf8/utf8.go.html#2527273">surrogateMax</a></span><span class="op" id="2534905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534909"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span>&nbsp;<span class="op" id="2534911">=</span>&nbsp;<span class="ident" id="2534913"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534925">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534938">case</span>&nbsp;<span class="ident" id="2534943"><a href="/unicode/utf8/utf8.go.html#2534696">i</a></span>&nbsp;<span class="op" id="2534945">&lt;=</span>&nbsp;<span class="ident" id="2534948"><a href="/unicode/utf8/utf8.go.html#2527604">rune3Max</a></span><span class="op" id="2534956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534960"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2534961">[</span><span class="num" id="2534962">0</span><span class="op" id="2534963">]</span>&nbsp;<span class="op" id="2534965">=</span>&nbsp;<span class="ident" id="2534967"><a href="/unicode/utf8/utf8.go.html#2527379">t3</a></span>&nbsp;<span class="op" id="2534970">|</span>&nbsp;<span class="builtintype" id="2534972">byte</span><span class="op" id="2534976">(</span><span class="ident" id="2534977"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2534978">&gt;&gt;</span><span class="num" id="2534980">12</span><span class="op" id="2534982">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534986"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2534987">[</span><span class="num" id="2534988">1</span><span class="op" id="2534989">]</span>&nbsp;<span class="op" id="2534991">=</span>&nbsp;<span class="ident" id="2534993"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2534996">|</span>&nbsp;<span class="builtintype" id="2534998">byte</span><span class="op" id="2535002">(</span><span class="ident" id="2535003"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2535004">&gt;&gt;</span><span class="num" id="2535006">6</span><span class="op" id="2535007">)</span><span class="op" id="2535008">&amp;</span><span class="ident" id="2535009"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535017"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2535018">[</span><span class="num" id="2535019">2</span><span class="op" id="2535020">]</span>&nbsp;<span class="op" id="2535022">=</span>&nbsp;<span class="ident" id="2535024"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2535027">|</span>&nbsp;<span class="builtintype" id="2535029">byte</span><span class="op" id="2535033">(</span><span class="ident" id="2535034"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2535035">)</span><span class="op" id="2535036">&amp;</span><span class="ident" id="2535037"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535045">return</span>&nbsp;<span class="num" id="2535052">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535055">default</span><span class="op" id="2535062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535066"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2535067">[</span><span class="num" id="2535068">0</span><span class="op" id="2535069">]</span>&nbsp;<span class="op" id="2535071">=</span>&nbsp;<span class="ident" id="2535073"><a href="/unicode/utf8/utf8.go.html#2527403">t4</a></span>&nbsp;<span class="op" id="2535076">|</span>&nbsp;<span class="builtintype" id="2535078">byte</span><span class="op" id="2535082">(</span><span class="ident" id="2535083"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2535084">&gt;&gt;</span><span class="num" id="2535086">18</span><span class="op" id="2535088">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535092"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2535093">[</span><span class="num" id="2535094">1</span><span class="op" id="2535095">]</span>&nbsp;<span class="op" id="2535097">=</span>&nbsp;<span class="ident" id="2535099"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2535102">|</span>&nbsp;<span class="builtintype" id="2535104">byte</span><span class="op" id="2535108">(</span><span class="ident" id="2535109"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2535110">&gt;&gt;</span><span class="num" id="2535112">12</span><span class="op" id="2535114">)</span><span class="op" id="2535115">&amp;</span><span class="ident" id="2535116"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535124"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2535125">[</span><span class="num" id="2535126">2</span><span class="op" id="2535127">]</span>&nbsp;<span class="op" id="2535129">=</span>&nbsp;<span class="ident" id="2535131"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2535134">|</span>&nbsp;<span class="builtintype" id="2535136">byte</span><span class="op" id="2535140">(</span><span class="ident" id="2535141"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2535142">&gt;&gt;</span><span class="num" id="2535144">6</span><span class="op" id="2535145">)</span><span class="op" id="2535146">&amp;</span><span class="ident" id="2535147"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535155"><a href="/unicode/utf8/utf8.go.html#2534586">p</a></span><span class="op" id="2535156">[</span><span class="num" id="2535157">3</span><span class="op" id="2535158">]</span>&nbsp;<span class="op" id="2535160">=</span>&nbsp;<span class="ident" id="2535162"><a href="/unicode/utf8/utf8.go.html#2527331">tx</a></span>&nbsp;<span class="op" id="2535165">|</span>&nbsp;<span class="builtintype" id="2535167">byte</span><span class="op" id="2535171">(</span><span class="ident" id="2535172"><a href="/unicode/utf8/utf8.go.html#2534596">r</a></span><span class="op" id="2535173">)</span><span class="op" id="2535174">&amp;</span><span class="ident" id="2535175"><a href="/unicode/utf8/utf8.go.html#2527452">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535183">return</span>&nbsp;<span class="num" id="2535190">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535193">}</span><br>
<span class="lineno">365</span><span class="op" id="2535195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2535198">//&nbsp;RuneCount&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;runes&nbsp;in&nbsp;p.&nbsp;&nbsp;Erroneous&nbsp;and&nbsp;short</span><br>
<span class="lineno"></span><span class="comment" id="2535266">//&nbsp;encodings&nbsp;are&nbsp;treated&nbsp;as&nbsp;single&nbsp;runes&nbsp;of&nbsp;width&nbsp;1&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="2535324">func</span>&nbsp;<span class="ident" id="2535329">RuneCount</span><span class="op" id="2535338">(</span><span class="ident" id="2535339">p</span>&nbsp;<span class="op" id="2535341">[</span><span class="op" id="2535342">]</span><span class="builtintype" id="2535343">byte</span><span class="op" id="2535347">)</span>&nbsp;<span class="builtintype" id="2535349">int</span>&nbsp;<span class="op" id="2535353">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535356">i</span>&nbsp;<span class="op" id="2535358">:=</span>&nbsp;<span class="num" id="2535361">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535364">var</span>&nbsp;<span class="ident" id="2535368">n</span>&nbsp;<span class="builtintype" id="2535370">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535375">for</span>&nbsp;<span class="ident" id="2535379"><a href="/unicode/utf8/utf8.go.html#2535368">n</a></span>&nbsp;<span class="op" id="2535381">=</span>&nbsp;<span class="num" id="2535383">0</span><span class="op" id="2535384">;</span>&nbsp;<span class="ident" id="2535386"><a href="/unicode/utf8/utf8.go.html#2535356">i</a></span>&nbsp;<span class="op" id="2535388">&lt;</span>&nbsp;<span class="builtinfunc" id="2535390">len</span><span class="op" id="2535393">(</span><span class="ident" id="2535394"><a href="/unicode/utf8/utf8.go.html#2535339">p</a></span><span class="op" id="2535395">)</span><span class="op" id="2535396">;</span>&nbsp;<span class="ident" id="2535398"><a href="/unicode/utf8/utf8.go.html#2535368">n</a></span><span class="op" id="2535399">++</span>&nbsp;<span class="op" id="2535402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535406">if</span>&nbsp;<span class="ident" id="2535409"><a href="/unicode/utf8/utf8.go.html#2535339">p</a></span><span class="op" id="2535410">[</span><span class="ident" id="2535411"><a href="/unicode/utf8/utf8.go.html#2535356">i</a></span><span class="op" id="2535412">]</span>&nbsp;<span class="op" id="2535414">&lt;</span>&nbsp;<span class="ident" id="2535416"><a href="/unicode/utf8/utf8.go.html#2526919">RuneSelf</a></span>&nbsp;<span class="op" id="2535425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535430"><a href="/unicode/utf8/utf8.go.html#2535356">i</a></span><span class="op" id="2535431">++</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535436">}</span>&nbsp;<span class="keyword" id="2535438">else</span>&nbsp;<span class="op" id="2535443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535448">_</span><span class="op" id="2535449">,</span>&nbsp;<span class="ident" id="2535451">size</span>&nbsp;<span class="op" id="2535456">:=</span>&nbsp;<span class="ident" id="2535459"><a href="/unicode/utf8/utf8.go.html#2531380">DecodeRune</a></span><span class="op" id="2535469">(</span><span class="ident" id="2535470"><a href="/unicode/utf8/utf8.go.html#2535339">p</a></span><span class="op" id="2535471">[</span><span class="ident" id="2535472"><a href="/unicode/utf8/utf8.go.html#2535356">i</a></span><span class="op" id="2535473">:</span><span class="op" id="2535474">]</span><span class="op" id="2535475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535480"><a href="/unicode/utf8/utf8.go.html#2535356">i</a></span>&nbsp;<span class="op" id="2535482">+=</span>&nbsp;<span class="ident" id="2535485"><a href="/unicode/utf8/utf8.go.html#2535451">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535495">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535498">return</span>&nbsp;<span class="ident" id="2535505"><a href="/unicode/utf8/utf8.go.html#2535368">n</a></span><br>
<span class="lineno"></span><span class="op" id="2535507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2535510">//&nbsp;RuneCountInString&nbsp;is&nbsp;like&nbsp;RuneCount&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2535576">func</span>&nbsp;<span class="ident" id="2535581">RuneCountInString</span><span class="op" id="2535598">(</span><span class="ident" id="2535599">s</span>&nbsp;<span class="builtintype" id="2535601">string</span><span class="op" id="2535607">)</span>&nbsp;<span class="op" id="2535609">(</span><span class="ident" id="2535610">n</span>&nbsp;<span class="builtintype" id="2535612">int</span><span class="op" id="2535615">)</span>&nbsp;<span class="op" id="2535617">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535620">for</span>&nbsp;<span class="keyword" id="2535624">range</span>&nbsp;<span class="ident" id="2535630"><a href="/unicode/utf8/utf8.go.html#2535599">s</a></span>&nbsp;<span class="op" id="2535632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535636"><a href="/unicode/utf8/utf8.go.html#2535610">n</a></span><span class="op" id="2535637">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535644">return</span><br>
<span class="lineno"></span><span class="op" id="2535651">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="comment" id="2535654">//&nbsp;RuneStart&nbsp;reports&nbsp;whether&nbsp;the&nbsp;byte&nbsp;could&nbsp;be&nbsp;the&nbsp;first&nbsp;byte&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2535719">//&nbsp;an&nbsp;encoded&nbsp;rune.&nbsp;&nbsp;Second&nbsp;and&nbsp;subsequent&nbsp;bytes&nbsp;always&nbsp;have&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="2535788">//&nbsp;two&nbsp;bits&nbsp;set&nbsp;to&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="2535811">func</span>&nbsp;<span class="ident" id="2535816">RuneStart</span><span class="op" id="2535825">(</span><span class="ident" id="2535826">b</span>&nbsp;<span class="builtintype" id="2535828">byte</span><span class="op" id="2535832">)</span>&nbsp;<span class="builtintype" id="2535834">bool</span>&nbsp;<span class="op" id="2535839">{</span>&nbsp;<span class="keyword" id="2535841">return</span>&nbsp;<span class="ident" id="2535848"><a href="/unicode/utf8/utf8.go.html#2535826">b</a></span><span class="op" id="2535849">&amp;</span><span class="num" id="2535850">0xC0</span>&nbsp;<span class="op" id="2535855">!=</span>&nbsp;<span class="num" id="2535858">0x80</span>&nbsp;<span class="op" id="2535863">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="2535866">//&nbsp;Valid&nbsp;reports&nbsp;whether&nbsp;p&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;valid&nbsp;UTF-8-encoded&nbsp;runes.</span><br>
<span class="lineno"></span><span class="keyword" id="2535941">func</span>&nbsp;<span class="ident" id="2535946">Valid</span><span class="op" id="2535951">(</span><span class="ident" id="2535952">p</span>&nbsp;<span class="op" id="2535954">[</span><span class="op" id="2535955">]</span><span class="builtintype" id="2535956">byte</span><span class="op" id="2535960">)</span>&nbsp;<span class="builtintype" id="2535962">bool</span>&nbsp;<span class="op" id="2535967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535970">i</span>&nbsp;<span class="op" id="2535972">:=</span>&nbsp;<span class="num" id="2535975">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535978">for</span>&nbsp;<span class="ident" id="2535982"><a href="/unicode/utf8/utf8.go.html#2535970">i</a></span>&nbsp;<span class="op" id="2535984">&lt;</span>&nbsp;<span class="builtinfunc" id="2535986">len</span><span class="op" id="2535989">(</span><span class="ident" id="2535990"><a href="/unicode/utf8/utf8.go.html#2535952">p</a></span><span class="op" id="2535991">)</span>&nbsp;<span class="op" id="2535993">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535997">if</span>&nbsp;<span class="ident" id="2536000"><a href="/unicode/utf8/utf8.go.html#2535952">p</a></span><span class="op" id="2536001">[</span><span class="ident" id="2536002"><a href="/unicode/utf8/utf8.go.html#2535970">i</a></span><span class="op" id="2536003">]</span>&nbsp;<span class="op" id="2536005">&lt;</span>&nbsp;<span class="ident" id="2536007"><a href="/unicode/utf8/utf8.go.html#2526919">RuneSelf</a></span>&nbsp;<span class="op" id="2536016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536021"><a href="/unicode/utf8/utf8.go.html#2535970">i</a></span><span class="op" id="2536022">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536027">}</span>&nbsp;<span class="keyword" id="2536029">else</span>&nbsp;<span class="op" id="2536034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536039">_</span><span class="op" id="2536040">,</span>&nbsp;<span class="ident" id="2536042">size</span>&nbsp;<span class="op" id="2536047">:=</span>&nbsp;<span class="ident" id="2536050"><a href="/unicode/utf8/utf8.go.html#2531380">DecodeRune</a></span><span class="op" id="2536060">(</span><span class="ident" id="2536061"><a href="/unicode/utf8/utf8.go.html#2535952">p</a></span><span class="op" id="2536062">[</span><span class="ident" id="2536063"><a href="/unicode/utf8/utf8.go.html#2535970">i</a></span><span class="op" id="2536064">:</span><span class="op" id="2536065">]</span><span class="op" id="2536066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536071">if</span>&nbsp;<span class="ident" id="2536074"><a href="/unicode/utf8/utf8.go.html#2536042">size</a></span>&nbsp;<span class="op" id="2536079">==</span>&nbsp;<span class="num" id="2536082">1</span>&nbsp;<span class="op" id="2536084">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536090">//&nbsp;All&nbsp;valid&nbsp;runes&nbsp;of&nbsp;size&nbsp;1&nbsp;(those</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536130">//&nbsp;below&nbsp;RuneSelf)&nbsp;were&nbsp;handled&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536173">//&nbsp;This&nbsp;must&nbsp;be&nbsp;a&nbsp;RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536206">return</span>&nbsp;<span class="builtintype" id="2536213">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536222">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536227"><a href="/unicode/utf8/utf8.go.html#2535970">i</a></span>&nbsp;<span class="op" id="2536229">+=</span>&nbsp;<span class="ident" id="2536232"><a href="/unicode/utf8/utf8.go.html#2536042">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536245">return</span>&nbsp;<span class="builtintype" id="2536252">true</span><br>
<span class="lineno"></span><span class="op" id="2536257">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="2536260">//&nbsp;ValidString&nbsp;reports&nbsp;whether&nbsp;s&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;valid&nbsp;UTF-8-encoded&nbsp;runes.</span><br>
<span class="lineno"></span><span class="keyword" id="2536341">func</span>&nbsp;<span class="ident" id="2536346">ValidString</span><span class="op" id="2536357">(</span><span class="ident" id="2536358">s</span>&nbsp;<span class="builtintype" id="2536360">string</span><span class="op" id="2536366">)</span>&nbsp;<span class="builtintype" id="2536368">bool</span>&nbsp;<span class="op" id="2536373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536376">for</span>&nbsp;<span class="ident" id="2536380">i</span><span class="op" id="2536381">,</span>&nbsp;<span class="ident" id="2536383">r</span>&nbsp;<span class="op" id="2536385">:=</span>&nbsp;<span class="keyword" id="2536388">range</span>&nbsp;<span class="ident" id="2536394"><a href="/unicode/utf8/utf8.go.html#2536358">s</a></span>&nbsp;<span class="op" id="2536396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536400">if</span>&nbsp;<span class="ident" id="2536403"><a href="/unicode/utf8/utf8.go.html#2536383">r</a></span>&nbsp;<span class="op" id="2536405">==</span>&nbsp;<span class="ident" id="2536408"><a href="/unicode/utf8/utf8.go.html#2526838">RuneError</a></span>&nbsp;<span class="op" id="2536418">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536423">//&nbsp;The&nbsp;RuneError&nbsp;value&nbsp;can&nbsp;be&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536465">//&nbsp;sentinel&nbsp;value&nbsp;(if&nbsp;it&#39;s&nbsp;size&nbsp;1)&nbsp;or&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536515">//&nbsp;value&nbsp;encoded&nbsp;properly.&nbsp;Decode&nbsp;it&nbsp;to&nbsp;see&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536565">//&nbsp;it&#39;s&nbsp;the&nbsp;1&nbsp;byte&nbsp;sentinel&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536603">_</span><span class="op" id="2536604">,</span>&nbsp;<span class="ident" id="2536606">size</span>&nbsp;<span class="op" id="2536611">:=</span>&nbsp;<span class="ident" id="2536614"><a href="/unicode/utf8/utf8.go.html#2531896">DecodeRuneInString</a></span><span class="op" id="2536632">(</span><span class="ident" id="2536633"><a href="/unicode/utf8/utf8.go.html#2536358">s</a></span><span class="op" id="2536634">[</span><span class="ident" id="2536635"><a href="/unicode/utf8/utf8.go.html#2536380">i</a></span><span class="op" id="2536636">:</span><span class="op" id="2536637">]</span><span class="op" id="2536638">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536643">if</span>&nbsp;<span class="ident" id="2536646"><a href="/unicode/utf8/utf8.go.html#2536606">size</a></span>&nbsp;<span class="op" id="2536651">==</span>&nbsp;<span class="num" id="2536654">1</span>&nbsp;<span class="op" id="2536656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536662">return</span>&nbsp;<span class="builtintype" id="2536669">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536685">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536688">return</span>&nbsp;<span class="builtintype" id="2536695">true</span><br>
<span class="lineno"></span><span class="op" id="2536700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2536703">//&nbsp;ValidRune&nbsp;reports&nbsp;whether&nbsp;r&nbsp;can&nbsp;be&nbsp;legally&nbsp;encoded&nbsp;as&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="2536767">//&nbsp;Code&nbsp;points&nbsp;that&nbsp;are&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;a&nbsp;surrogate&nbsp;half&nbsp;are&nbsp;illegal.</span><br>
<span class="lineno">435</span><span class="keyword" id="2536837">func</span>&nbsp;<span class="ident" id="2536842">ValidRune</span><span class="op" id="2536851">(</span><span class="ident" id="2536852">r</span>&nbsp;<span class="builtintype" id="2536854">rune</span><span class="op" id="2536858">)</span>&nbsp;<span class="builtintype" id="2536860">bool</span>&nbsp;<span class="op" id="2536865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536868">switch</span>&nbsp;<span class="op" id="2536875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536878">case</span>&nbsp;<span class="ident" id="2536883"><a href="/unicode/utf8/utf8.go.html#2536852">r</a></span>&nbsp;<span class="op" id="2536885">&lt;</span>&nbsp;<span class="num" id="2536887">0</span><span class="op" id="2536888">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536892">return</span>&nbsp;<span class="builtintype" id="2536899">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536906">case</span>&nbsp;<span class="ident" id="2536911"><a href="/unicode/utf8/utf8.go.html#2527250">surrogateMin</a></span>&nbsp;<span class="op" id="2536924">&lt;=</span>&nbsp;<span class="ident" id="2536927"><a href="/unicode/utf8/utf8.go.html#2536852">r</a></span>&nbsp;<span class="op" id="2536929">&amp;&amp;</span>&nbsp;<span class="ident" id="2536932"><a href="/unicode/utf8/utf8.go.html#2536852">r</a></span>&nbsp;<span class="op" id="2536934">&lt;=</span>&nbsp;<span class="ident" id="2536937"><a href="/unicode/utf8/utf8.go.html#2527273">surrogateMax</a></span><span class="op" id="2536949">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536953">return</span>&nbsp;<span class="builtintype" id="2536960">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536967">case</span>&nbsp;<span class="ident" id="2536972"><a href="/unicode/utf8/utf8.go.html#2536852">r</a></span>&nbsp;<span class="op" id="2536974">&gt;</span>&nbsp;<span class="ident" id="2536976"><a href="/unicode/utf8/utf8.go.html#2527022">MaxRune</a></span><span class="op" id="2536983">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536987">return</span>&nbsp;<span class="builtintype" id="2536994">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537004">return</span>&nbsp;<span class="builtintype" id="2537011">true</span><br>
<span class="lineno">445</span><span class="op" id="2537016">}</span>
</div>
</body>
</html>
