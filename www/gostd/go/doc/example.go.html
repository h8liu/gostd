<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html" class="current">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3009828">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3009883">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3009937">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3009988">//&nbsp;Extract&nbsp;example&nbsp;functions&nbsp;from&nbsp;file&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3010034">package</span>&nbsp;<span class="ident" id="3010042">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3010047">import</span>&nbsp;<span class="op" id="3010054">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3010057">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3010067">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3010079">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3010087">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3010097">&#34;sort&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3010105">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3010116">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3010127">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3010138">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3010153">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3010156">//&nbsp;An&nbsp;Example&nbsp;represents&nbsp;an&nbsp;example&nbsp;function&nbsp;found&nbsp;in&nbsp;a&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="3010226">type</span>&nbsp;<span class="ident" id="3010231">Example</span>&nbsp;<span class="keyword" id="3010239">struct</span>&nbsp;<span class="op" id="3010246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010249">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3010261">string</span>&nbsp;<span class="comment" id="3010268">//&nbsp;name&nbsp;of&nbsp;the&nbsp;item&nbsp;being&nbsp;exemplified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010307">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3010319">string</span>&nbsp;<span class="comment" id="3010326">//&nbsp;example&nbsp;function&nbsp;doc&nbsp;string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010358">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010370">ast</span><span class="op" id="3010373">.</span><span class="ident" id="3010374">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010380">Play</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3010392">*</span><span class="ident" id="3010393">ast</span><span class="op" id="3010396">.</span><span class="ident" id="3010397">File</span>&nbsp;<span class="comment" id="3010402">//&nbsp;a&nbsp;whole&nbsp;program&nbsp;version&nbsp;of&nbsp;the&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010445">Comments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3010457">[</span><span class="op" id="3010458">]</span><span class="op" id="3010459">*</span><span class="ident" id="3010460">ast</span><span class="op" id="3010463">.</span><span class="ident" id="3010464">CommentGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010478">Output</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3010490">string</span>&nbsp;<span class="comment" id="3010497">//&nbsp;expected&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010517">EmptyOutput</span>&nbsp;<span class="builtintype" id="3010529">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3010536">//&nbsp;expect&nbsp;empty&nbsp;output</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3010560">Order</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3010572">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010579">//&nbsp;original&nbsp;source&nbsp;code&nbsp;order</span><br>
<span class="lineno"></span><span class="op" id="3010609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3010612">//&nbsp;Examples&nbsp;returns&nbsp;the&nbsp;examples&nbsp;found&nbsp;in&nbsp;the&nbsp;files,&nbsp;sorted&nbsp;by&nbsp;Name&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="3010687">//&nbsp;The&nbsp;Order&nbsp;fields&nbsp;record&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;the&nbsp;examples&nbsp;were&nbsp;encountered.</span><br>
<span class="lineno">35</span><span class="comment" id="3010764">//</span><br>
<span class="lineno"></span><span class="comment" id="3010767">//&nbsp;Playable&nbsp;Examples&nbsp;must&nbsp;be&nbsp;in&nbsp;a&nbsp;package&nbsp;whose&nbsp;name&nbsp;ends&nbsp;in&nbsp;&#34;_test&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3010837">//&nbsp;An&nbsp;Example&nbsp;is&nbsp;&#34;playable&#34;&nbsp;(the&nbsp;Play&nbsp;field&nbsp;is&nbsp;non-nil)&nbsp;in&nbsp;either&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="3010912">//&nbsp;circumstances:</span><br>
<span class="lineno"></span><span class="comment" id="3010930">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;example&nbsp;function&nbsp;is&nbsp;self-contained:&nbsp;the&nbsp;function&nbsp;references&nbsp;only</span><br>
<span class="lineno">40</span><span class="comment" id="3011006">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifiers&nbsp;from&nbsp;other&nbsp;packages&nbsp;(or&nbsp;predeclared&nbsp;identifiers,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3011082">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;int&#34;)&nbsp;and&nbsp;the&nbsp;test&nbsp;file&nbsp;does&nbsp;not&nbsp;include&nbsp;a&nbsp;dot&nbsp;import.</span><br>
<span class="lineno"></span><span class="comment" id="3011145">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;the&nbsp;example:&nbsp;the&nbsp;file&nbsp;contains&nbsp;exactly&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3011219">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;example&nbsp;function,&nbsp;zero&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions,&nbsp;and&nbsp;at&nbsp;least&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3011295">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top-level&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant&nbsp;declaration&nbsp;other</span><br>
<span class="lineno">45</span><span class="comment" id="3011368">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;the&nbsp;example&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="3011402">func</span>&nbsp;<span class="ident" id="3011407">Examples</span><span class="op" id="3011415">(</span><span class="ident" id="3011416">files</span>&nbsp;<span class="op" id="3011422">...</span><span class="op" id="3011425">*</span><span class="ident" id="3011426">ast</span><span class="op" id="3011429">.</span><span class="ident" id="3011430">File</span><span class="op" id="3011434">)</span>&nbsp;<span class="op" id="3011436">[</span><span class="op" id="3011437">]</span><span class="op" id="3011438">*</span><span class="ident" id="3011439">Example</span>&nbsp;<span class="op" id="3011447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011450">var</span>&nbsp;<span class="ident" id="3011454">list</span>&nbsp;<span class="op" id="3011459">[</span><span class="op" id="3011460">]</span><span class="op" id="3011461">*</span><span class="ident" id="3011462">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011471">for</span>&nbsp;<span class="ident" id="3011475">_</span><span class="op" id="3011476">,</span>&nbsp;<span class="ident" id="3011478">file</span>&nbsp;<span class="op" id="3011483">:=</span>&nbsp;<span class="keyword" id="3011486">range</span>&nbsp;<span class="ident" id="3011492">files</span>&nbsp;<span class="op" id="3011498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011502">hasTests</span>&nbsp;<span class="op" id="3011511">:=</span>&nbsp;<span class="builtintype" id="3011514">false</span>&nbsp;<span class="comment" id="3011520">//&nbsp;file&nbsp;contains&nbsp;tests&nbsp;or&nbsp;benchmarks</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011559">numDecl</span>&nbsp;<span class="op" id="3011567">:=</span>&nbsp;<span class="num" id="3011570">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3011577">//&nbsp;number&nbsp;of&nbsp;non-import&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011628">var</span>&nbsp;<span class="ident" id="3011632">flist</span>&nbsp;<span class="op" id="3011638">[</span><span class="op" id="3011639">]</span><span class="op" id="3011640">*</span><span class="ident" id="3011641">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011651">for</span>&nbsp;<span class="ident" id="3011655">_</span><span class="op" id="3011656">,</span>&nbsp;<span class="ident" id="3011658">decl</span>&nbsp;<span class="op" id="3011663">:=</span>&nbsp;<span class="keyword" id="3011666">range</span>&nbsp;<span class="ident" id="3011672">file</span><span class="op" id="3011676">.</span><span class="ident" id="3011677">Decls</span>&nbsp;<span class="op" id="3011683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011688">if</span>&nbsp;<span class="ident" id="3011691">g</span><span class="op" id="3011692">,</span>&nbsp;<span class="ident" id="3011694">ok</span>&nbsp;<span class="op" id="3011697">:=</span>&nbsp;<span class="ident" id="3011700">decl</span><span class="op" id="3011704">.</span><span class="op" id="3011705">(</span><span class="op" id="3011706">*</span><span class="ident" id="3011707">ast</span><span class="op" id="3011710">.</span><span class="ident" id="3011711">GenDecl</span><span class="op" id="3011718">)</span><span class="op" id="3011719">;</span>&nbsp;<span class="ident" id="3011721">ok</span>&nbsp;<span class="op" id="3011724">&amp;&amp;</span>&nbsp;<span class="ident" id="3011727">g</span><span class="op" id="3011728">.</span><span class="ident" id="3011729">Tok</span>&nbsp;<span class="op" id="3011733">!=</span>&nbsp;<span class="ident" id="3011736">token</span><span class="op" id="3011741">.</span><span class="ident" id="3011742">IMPORT</span>&nbsp;<span class="op" id="3011749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011755">numDecl</span><span class="op" id="3011762">++</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011769">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011786">f</span><span class="op" id="3011787">,</span>&nbsp;<span class="ident" id="3011789">ok</span>&nbsp;<span class="op" id="3011792">:=</span>&nbsp;<span class="ident" id="3011795">decl</span><span class="op" id="3011799">.</span><span class="op" id="3011800">(</span><span class="op" id="3011801">*</span><span class="ident" id="3011802">ast</span><span class="op" id="3011805">.</span><span class="ident" id="3011806">FuncDecl</span><span class="op" id="3011814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011819">if</span>&nbsp;<span class="op" id="3011822">!</span><span class="ident" id="3011823">ok</span>&nbsp;<span class="op" id="3011826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011832">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011849">numDecl</span><span class="op" id="3011856">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011862">name</span>&nbsp;<span class="op" id="3011867">:=</span>&nbsp;<span class="ident" id="3011870">f</span><span class="op" id="3011871">.</span><span class="ident" id="3011872">Name</span><span class="op" id="3011876">.</span><span class="ident" id="3011877">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011885">if</span>&nbsp;<span class="ident" id="3011888">isTest</span><span class="op" id="3011894">(</span><span class="ident" id="3011895">name</span><span class="op" id="3011899">,</span>&nbsp;<span class="string" id="3011901">&#34;Test&#34;</span><span class="op" id="3011907">)</span>&nbsp;<span class="op" id="3011909">||</span>&nbsp;<span class="ident" id="3011912">isTest</span><span class="op" id="3011918">(</span><span class="ident" id="3011919">name</span><span class="op" id="3011923">,</span>&nbsp;<span class="string" id="3011925">&#34;Benchmark&#34;</span><span class="op" id="3011936">)</span>&nbsp;<span class="op" id="3011938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3011944">hasTests</span>&nbsp;<span class="op" id="3011953">=</span>&nbsp;<span class="builtintype" id="3011955">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011964">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3011976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3011981">if</span>&nbsp;<span class="op" id="3011984">!</span><span class="ident" id="3011985">isTest</span><span class="op" id="3011991">(</span><span class="ident" id="3011992">name</span><span class="op" id="3011996">,</span>&nbsp;<span class="string" id="3011998">&#34;Example&#34;</span><span class="op" id="3012007">)</span>&nbsp;<span class="op" id="3012009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012015">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012027">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012032">var</span>&nbsp;<span class="ident" id="3012036">doc</span>&nbsp;<span class="builtintype" id="3012040">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012050">if</span>&nbsp;<span class="ident" id="3012053">f</span><span class="op" id="3012054">.</span><span class="ident" id="3012055">Doc</span>&nbsp;<span class="op" id="3012059">!=</span>&nbsp;<span class="ident" id="3012062">nil</span>&nbsp;<span class="op" id="3012066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012072">doc</span>&nbsp;<span class="op" id="3012076">=</span>&nbsp;<span class="ident" id="3012078">f</span><span class="op" id="3012079">.</span><span class="ident" id="3012080">Doc</span><span class="op" id="3012083">.</span><span class="ident" id="3012084">Text</span><span class="op" id="3012088">(</span><span class="op" id="3012089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012099">output</span><span class="op" id="3012105">,</span>&nbsp;<span class="ident" id="3012107">hasOutput</span>&nbsp;<span class="op" id="3012117">:=</span>&nbsp;<span class="ident" id="3012120">exampleOutput</span><span class="op" id="3012133">(</span><span class="ident" id="3012134">f</span><span class="op" id="3012135">.</span><span class="ident" id="3012136">Body</span><span class="op" id="3012140">,</span>&nbsp;<span class="ident" id="3012142">file</span><span class="op" id="3012146">.</span><span class="ident" id="3012147">Comments</span><span class="op" id="3012155">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012160">flist</span>&nbsp;<span class="op" id="3012166">=</span>&nbsp;<span class="builtinfunc" id="3012168">append</span><span class="op" id="3012174">(</span><span class="ident" id="3012175">flist</span><span class="op" id="3012180">,</span>&nbsp;<span class="op" id="3012182">&amp;</span><span class="ident" id="3012183">Example</span><span class="op" id="3012190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012196">Name</span><span class="op" id="3012200">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3012209">name</span><span class="op" id="3012213">[</span><span class="builtinfunc" id="3012214">len</span><span class="op" id="3012217">(</span><span class="string" id="3012218">&#34;Example&#34;</span><span class="op" id="3012227">)</span><span class="op" id="3012228">:</span><span class="op" id="3012229">]</span><span class="op" id="3012230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012236">Doc</span><span class="op" id="3012239">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3012249">doc</span><span class="op" id="3012252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012258">Code</span><span class="op" id="3012262">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3012271">f</span><span class="op" id="3012272">.</span><span class="ident" id="3012273">Body</span><span class="op" id="3012277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012283">Play</span><span class="op" id="3012287">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3012296">playExample</span><span class="op" id="3012307">(</span><span class="ident" id="3012308">file</span><span class="op" id="3012312">,</span>&nbsp;<span class="ident" id="3012314">f</span><span class="op" id="3012315">.</span><span class="ident" id="3012316">Body</span><span class="op" id="3012320">)</span><span class="op" id="3012321">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012327">Comments</span><span class="op" id="3012335">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3012340">file</span><span class="op" id="3012344">.</span><span class="ident" id="3012345">Comments</span><span class="op" id="3012353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012359">Output</span><span class="op" id="3012365">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3012372">output</span><span class="op" id="3012378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012384">EmptyOutput</span><span class="op" id="3012395">:</span>&nbsp;<span class="ident" id="3012397">output</span>&nbsp;<span class="op" id="3012404">==</span>&nbsp;<span class="string" id="3012407">&#34;&#34;</span>&nbsp;<span class="op" id="3012410">&amp;&amp;</span>&nbsp;<span class="ident" id="3012413">hasOutput</span><span class="op" id="3012422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012428">Order</span><span class="op" id="3012433">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3012441">len</span><span class="op" id="3012444">(</span><span class="ident" id="3012445">flist</span><span class="op" id="3012450">)</span><span class="op" id="3012451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012456">}</span><span class="op" id="3012457">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012465">if</span>&nbsp;<span class="op" id="3012468">!</span><span class="ident" id="3012469">hasTests</span>&nbsp;<span class="op" id="3012478">&amp;&amp;</span>&nbsp;<span class="ident" id="3012481">numDecl</span>&nbsp;<span class="op" id="3012489">&gt;</span>&nbsp;<span class="num" id="3012491">1</span>&nbsp;<span class="op" id="3012493">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3012496">len</span><span class="op" id="3012499">(</span><span class="ident" id="3012500">flist</span><span class="op" id="3012505">)</span>&nbsp;<span class="op" id="3012507">==</span>&nbsp;<span class="num" id="3012510">1</span>&nbsp;<span class="op" id="3012512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3012517">//&nbsp;If&nbsp;this&nbsp;file&nbsp;only&nbsp;has&nbsp;one&nbsp;example&nbsp;function,&nbsp;some</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3012572">//&nbsp;other&nbsp;top-level&nbsp;declarations,&nbsp;and&nbsp;no&nbsp;tests&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3012624">//&nbsp;benchmarks,&nbsp;use&nbsp;the&nbsp;whole&nbsp;file&nbsp;as&nbsp;the&nbsp;example.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012677">flist</span><span class="op" id="3012682">[</span><span class="num" id="3012683">0</span><span class="op" id="3012684">]</span><span class="op" id="3012685">.</span><span class="ident" id="3012686">Code</span>&nbsp;<span class="op" id="3012691">=</span>&nbsp;<span class="ident" id="3012693">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012701">flist</span><span class="op" id="3012706">[</span><span class="num" id="3012707">0</span><span class="op" id="3012708">]</span><span class="op" id="3012709">.</span><span class="ident" id="3012710">Play</span>&nbsp;<span class="op" id="3012715">=</span>&nbsp;<span class="ident" id="3012717">playExampleFile</span><span class="op" id="3012732">(</span><span class="ident" id="3012733">file</span><span class="op" id="3012737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012745">list</span>&nbsp;<span class="op" id="3012750">=</span>&nbsp;<span class="builtinfunc" id="3012752">append</span><span class="op" id="3012758">(</span><span class="ident" id="3012759">list</span><span class="op" id="3012763">,</span>&nbsp;<span class="ident" id="3012765">flist</span><span class="op" id="3012770">...</span><span class="op" id="3012773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3012776">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3012779">sort</span><span class="op" id="3012783">.</span><span class="ident" id="3012784">Sort</span><span class="op" id="3012788">(</span><span class="ident" id="3012789">exampleByName</span><span class="op" id="3012802">(</span><span class="ident" id="3012803">list</span><span class="op" id="3012807">)</span><span class="op" id="3012808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3012811">return</span>&nbsp;<span class="ident" id="3012818">list</span><br>
<span class="lineno"></span><span class="op" id="3012823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3012826">var</span>&nbsp;<span class="ident" id="3012830">outputPrefix</span>&nbsp;<span class="op" id="3012843">=</span>&nbsp;<span class="ident" id="3012845">regexp</span><span class="op" id="3012851">.</span><span class="ident" id="3012852">MustCompile</span><span class="op" id="3012863">(</span><span class="string" id="3012864">`(?i)^[[:space:]]*output:`</span><span class="op" id="3012890">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3012893">//&nbsp;Extracts&nbsp;the&nbsp;expected&nbsp;output&nbsp;and&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;valid&nbsp;output&nbsp;comment</span><br>
<span class="lineno"></span><span class="keyword" id="3012970">func</span>&nbsp;<span class="ident" id="3012975">exampleOutput</span><span class="op" id="3012988">(</span><span class="ident" id="3012989">b</span>&nbsp;<span class="op" id="3012991">*</span><span class="ident" id="3012992">ast</span><span class="op" id="3012995">.</span><span class="ident" id="3012996">BlockStmt</span><span class="op" id="3013005">,</span>&nbsp;<span class="ident" id="3013007">comments</span>&nbsp;<span class="op" id="3013016">[</span><span class="op" id="3013017">]</span><span class="op" id="3013018">*</span><span class="ident" id="3013019">ast</span><span class="op" id="3013022">.</span><span class="ident" id="3013023">CommentGroup</span><span class="op" id="3013035">)</span>&nbsp;<span class="op" id="3013037">(</span><span class="ident" id="3013038">output</span>&nbsp;<span class="builtintype" id="3013045">string</span><span class="op" id="3013051">,</span>&nbsp;<span class="ident" id="3013053">ok</span>&nbsp;<span class="builtintype" id="3013056">bool</span><span class="op" id="3013060">)</span>&nbsp;<span class="op" id="3013062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013065">if</span>&nbsp;<span class="ident" id="3013068">_</span><span class="op" id="3013069">,</span>&nbsp;<span class="ident" id="3013071">last</span>&nbsp;<span class="op" id="3013076">:=</span>&nbsp;<span class="ident" id="3013079">lastComment</span><span class="op" id="3013090">(</span><span class="ident" id="3013091">b</span><span class="op" id="3013092">,</span>&nbsp;<span class="ident" id="3013094">comments</span><span class="op" id="3013102">)</span><span class="op" id="3013103">;</span>&nbsp;<span class="ident" id="3013105">last</span>&nbsp;<span class="op" id="3013110">!=</span>&nbsp;<span class="ident" id="3013113">nil</span>&nbsp;<span class="op" id="3013117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3013121">//&nbsp;test&nbsp;that&nbsp;it&nbsp;begins&nbsp;with&nbsp;the&nbsp;correct&nbsp;prefix</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3013170">text</span>&nbsp;<span class="op" id="3013175">:=</span>&nbsp;<span class="ident" id="3013178">last</span><span class="op" id="3013182">.</span><span class="ident" id="3013183">Text</span><span class="op" id="3013187">(</span><span class="op" id="3013188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013192">if</span>&nbsp;<span class="ident" id="3013195">loc</span>&nbsp;<span class="op" id="3013199">:=</span>&nbsp;<span class="ident" id="3013202">outputPrefix</span><span class="op" id="3013214">.</span><span class="ident" id="3013215">FindStringIndex</span><span class="op" id="3013230">(</span><span class="ident" id="3013231">text</span><span class="op" id="3013235">)</span><span class="op" id="3013236">;</span>&nbsp;<span class="ident" id="3013238">loc</span>&nbsp;<span class="op" id="3013242">!=</span>&nbsp;<span class="ident" id="3013245">nil</span>&nbsp;<span class="op" id="3013249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3013254">text</span>&nbsp;<span class="op" id="3013259">=</span>&nbsp;<span class="ident" id="3013261">text</span><span class="op" id="3013265">[</span><span class="ident" id="3013266">loc</span><span class="op" id="3013269">[</span><span class="num" id="3013270">1</span><span class="op" id="3013271">]</span><span class="op" id="3013272">:</span><span class="op" id="3013273">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3013278">//&nbsp;Strip&nbsp;zero&nbsp;or&nbsp;more&nbsp;spaces&nbsp;followed&nbsp;by&nbsp;\n&nbsp;or&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3013344">text</span>&nbsp;<span class="op" id="3013349">=</span>&nbsp;<span class="ident" id="3013351">strings</span><span class="op" id="3013358">.</span><span class="ident" id="3013359">TrimLeft</span><span class="op" id="3013367">(</span><span class="ident" id="3013368">text</span><span class="op" id="3013372">,</span>&nbsp;<span class="string" id="3013374">&#34;&nbsp;&#34;</span><span class="op" id="3013377">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013382">if</span>&nbsp;<span class="builtinfunc" id="3013385">len</span><span class="op" id="3013388">(</span><span class="ident" id="3013389">text</span><span class="op" id="3013393">)</span>&nbsp;<span class="op" id="3013395">&gt;</span>&nbsp;<span class="num" id="3013397">0</span>&nbsp;<span class="op" id="3013399">&amp;&amp;</span>&nbsp;<span class="ident" id="3013402">text</span><span class="op" id="3013406">[</span><span class="num" id="3013407">0</span><span class="op" id="3013408">]</span>&nbsp;<span class="op" id="3013410">==</span>&nbsp;<span class="string" id="3013413">&#39;\n&#39;</span>&nbsp;<span class="op" id="3013418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3013424">text</span>&nbsp;<span class="op" id="3013429">=</span>&nbsp;<span class="ident" id="3013431">text</span><span class="op" id="3013435">[</span><span class="num" id="3013436">1</span><span class="op" id="3013437">:</span><span class="op" id="3013438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3013443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013448">return</span>&nbsp;<span class="ident" id="3013455">text</span><span class="op" id="3013459">,</span>&nbsp;<span class="builtintype" id="3013461">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3013468">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3013471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013474">return</span>&nbsp;<span class="string" id="3013481">&#34;&#34;</span><span class="op" id="3013483">,</span>&nbsp;<span class="builtintype" id="3013485">false</span>&nbsp;<span class="comment" id="3013491">//&nbsp;no&nbsp;suitable&nbsp;comment&nbsp;found</span><br>
<span class="lineno"></span><span class="op" id="3013520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3013523">//&nbsp;isTest&nbsp;tells&nbsp;whether&nbsp;name&nbsp;looks&nbsp;like&nbsp;a&nbsp;test,&nbsp;example,&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno">120</span><span class="comment" id="3013594">//&nbsp;It&nbsp;is&nbsp;a&nbsp;Test&nbsp;(say)&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;character&nbsp;after&nbsp;Test&nbsp;that&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3013665">//&nbsp;lower-case&nbsp;letter.&nbsp;(We&nbsp;don&#39;t&nbsp;want&nbsp;Testiness.)</span><br>
<span class="lineno"></span><span class="keyword" id="3013714">func</span>&nbsp;<span class="ident" id="3013719">isTest</span><span class="op" id="3013725">(</span><span class="ident" id="3013726">name</span><span class="op" id="3013730">,</span>&nbsp;<span class="ident" id="3013732">prefix</span>&nbsp;<span class="builtintype" id="3013739">string</span><span class="op" id="3013745">)</span>&nbsp;<span class="builtintype" id="3013747">bool</span>&nbsp;<span class="op" id="3013752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013755">if</span>&nbsp;<span class="op" id="3013758">!</span><span class="ident" id="3013759">strings</span><span class="op" id="3013766">.</span><span class="ident" id="3013767">HasPrefix</span><span class="op" id="3013776">(</span><span class="ident" id="3013777">name</span><span class="op" id="3013781">,</span>&nbsp;<span class="ident" id="3013783">prefix</span><span class="op" id="3013789">)</span>&nbsp;<span class="op" id="3013791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013795">return</span>&nbsp;<span class="builtintype" id="3013802">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3013809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013812">if</span>&nbsp;<span class="builtinfunc" id="3013815">len</span><span class="op" id="3013818">(</span><span class="ident" id="3013819">name</span><span class="op" id="3013823">)</span>&nbsp;<span class="op" id="3013825">==</span>&nbsp;<span class="builtinfunc" id="3013828">len</span><span class="op" id="3013831">(</span><span class="ident" id="3013832">prefix</span><span class="op" id="3013838">)</span>&nbsp;<span class="op" id="3013840">{</span>&nbsp;<span class="comment" id="3013842">//&nbsp;&#34;Test&#34;&nbsp;is&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013860">return</span>&nbsp;<span class="builtintype" id="3013867">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3013873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3013876">rune</span><span class="op" id="3013880">,</span>&nbsp;<span class="ident" id="3013882">_</span>&nbsp;<span class="op" id="3013884">:=</span>&nbsp;<span class="ident" id="3013887">utf8</span><span class="op" id="3013891">.</span><span class="ident" id="3013892">DecodeRuneInString</span><span class="op" id="3013910">(</span><span class="ident" id="3013911">name</span><span class="op" id="3013915">[</span><span class="builtinfunc" id="3013916">len</span><span class="op" id="3013919">(</span><span class="ident" id="3013920">prefix</span><span class="op" id="3013926">)</span><span class="op" id="3013927">:</span><span class="op" id="3013928">]</span><span class="op" id="3013929">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3013932">return</span>&nbsp;<span class="op" id="3013939">!</span><span class="ident" id="3013940">unicode</span><span class="op" id="3013947">.</span><span class="ident" id="3013948">IsLower</span><span class="op" id="3013955">(</span><span class="builtintype" id="3013956">rune</span><span class="op" id="3013960">)</span><br>
<span class="lineno"></span><span class="op" id="3013962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3013965">type</span>&nbsp;<span class="ident" id="3013970">exampleByName</span>&nbsp;<span class="op" id="3013984">[</span><span class="op" id="3013985">]</span><span class="op" id="3013986">*</span><span class="ident" id="3013987">Example</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3013996">func</span>&nbsp;<span class="op" id="3014001">(</span><span class="ident" id="3014002">s</span>&nbsp;<span class="ident" id="3014004">exampleByName</span><span class="op" id="3014017">)</span>&nbsp;<span class="ident" id="3014019">Len</span><span class="op" id="3014022">(</span><span class="op" id="3014023">)</span>&nbsp;<span class="builtintype" id="3014025">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3014039">{</span>&nbsp;<span class="keyword" id="3014041">return</span>&nbsp;<span class="builtinfunc" id="3014048">len</span><span class="op" id="3014051">(</span><span class="ident" id="3014052">s</span><span class="op" id="3014053">)</span>&nbsp;<span class="op" id="3014055">}</span><br>
<span class="lineno"></span><span class="keyword" id="3014057">func</span>&nbsp;<span class="op" id="3014062">(</span><span class="ident" id="3014063">s</span>&nbsp;<span class="ident" id="3014065">exampleByName</span><span class="op" id="3014078">)</span>&nbsp;<span class="ident" id="3014080">Swap</span><span class="op" id="3014084">(</span><span class="ident" id="3014085">i</span><span class="op" id="3014086">,</span>&nbsp;<span class="ident" id="3014088">j</span>&nbsp;<span class="builtintype" id="3014090">int</span><span class="op" id="3014093">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3014100">{</span>&nbsp;<span class="ident" id="3014102">s</span><span class="op" id="3014103">[</span><span class="ident" id="3014104">i</span><span class="op" id="3014105">]</span><span class="op" id="3014106">,</span>&nbsp;<span class="ident" id="3014108">s</span><span class="op" id="3014109">[</span><span class="ident" id="3014110">j</span><span class="op" id="3014111">]</span>&nbsp;<span class="op" id="3014113">=</span>&nbsp;<span class="ident" id="3014115">s</span><span class="op" id="3014116">[</span><span class="ident" id="3014117">j</span><span class="op" id="3014118">]</span><span class="op" id="3014119">,</span>&nbsp;<span class="ident" id="3014121">s</span><span class="op" id="3014122">[</span><span class="ident" id="3014123">i</span><span class="op" id="3014124">]</span>&nbsp;<span class="op" id="3014126">}</span><br>
<span class="lineno"></span><span class="keyword" id="3014128">func</span>&nbsp;<span class="op" id="3014133">(</span><span class="ident" id="3014134">s</span>&nbsp;<span class="ident" id="3014136">exampleByName</span><span class="op" id="3014149">)</span>&nbsp;<span class="ident" id="3014151">Less</span><span class="op" id="3014155">(</span><span class="ident" id="3014156">i</span><span class="op" id="3014157">,</span>&nbsp;<span class="ident" id="3014159">j</span>&nbsp;<span class="builtintype" id="3014161">int</span><span class="op" id="3014164">)</span>&nbsp;<span class="builtintype" id="3014166">bool</span>&nbsp;<span class="op" id="3014171">{</span>&nbsp;<span class="keyword" id="3014173">return</span>&nbsp;<span class="ident" id="3014180">s</span><span class="op" id="3014181">[</span><span class="ident" id="3014182">i</span><span class="op" id="3014183">]</span><span class="op" id="3014184">.</span><span class="ident" id="3014185">Name</span>&nbsp;<span class="op" id="3014190">&lt;</span>&nbsp;<span class="ident" id="3014192">s</span><span class="op" id="3014193">[</span><span class="ident" id="3014194">j</span><span class="op" id="3014195">]</span><span class="op" id="3014196">.</span><span class="ident" id="3014197">Name</span>&nbsp;<span class="op" id="3014202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3014205">//&nbsp;playExample&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File&nbsp;based&nbsp;on&nbsp;the&nbsp;provided</span><br>
<span class="lineno">140</span><span class="comment" id="3014270">//&nbsp;file&nbsp;with&nbsp;the&nbsp;provided&nbsp;function&nbsp;body&nbsp;as&nbsp;the&nbsp;body&nbsp;of&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="3014331">func</span>&nbsp;<span class="ident" id="3014336">playExample</span><span class="op" id="3014347">(</span><span class="ident" id="3014348">file</span>&nbsp;<span class="op" id="3014353">*</span><span class="ident" id="3014354">ast</span><span class="op" id="3014357">.</span><span class="ident" id="3014358">File</span><span class="op" id="3014362">,</span>&nbsp;<span class="ident" id="3014364">body</span>&nbsp;<span class="op" id="3014369">*</span><span class="ident" id="3014370">ast</span><span class="op" id="3014373">.</span><span class="ident" id="3014374">BlockStmt</span><span class="op" id="3014383">)</span>&nbsp;<span class="op" id="3014385">*</span><span class="ident" id="3014386">ast</span><span class="op" id="3014389">.</span><span class="ident" id="3014390">File</span>&nbsp;<span class="op" id="3014395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014398">if</span>&nbsp;<span class="op" id="3014401">!</span><span class="ident" id="3014402">strings</span><span class="op" id="3014409">.</span><span class="ident" id="3014410">HasSuffix</span><span class="op" id="3014419">(</span><span class="ident" id="3014420">file</span><span class="op" id="3014424">.</span><span class="ident" id="3014425">Name</span><span class="op" id="3014429">.</span><span class="ident" id="3014430">Name</span><span class="op" id="3014434">,</span>&nbsp;<span class="string" id="3014436">&#34;_test&#34;</span><span class="op" id="3014443">)</span>&nbsp;<span class="op" id="3014445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3014449">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3014501">//&nbsp;greater&nbsp;package&nbsp;(yet).</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014529">return</span>&nbsp;<span class="ident" id="3014536">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3014545">//&nbsp;Find&nbsp;top-level&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014590">topDecls</span>&nbsp;<span class="op" id="3014599">:=</span>&nbsp;<span class="builtinfunc" id="3014602">make</span><span class="op" id="3014606">(</span><span class="keyword" id="3014607">map</span><span class="op" id="3014610">[</span><span class="op" id="3014611">*</span><span class="ident" id="3014612">ast</span><span class="op" id="3014615">.</span><span class="ident" id="3014616">Object</span><span class="op" id="3014622">]</span><span class="builtintype" id="3014623">bool</span><span class="op" id="3014627">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014630">for</span>&nbsp;<span class="ident" id="3014634">_</span><span class="op" id="3014635">,</span>&nbsp;<span class="ident" id="3014637">decl</span>&nbsp;<span class="op" id="3014642">:=</span>&nbsp;<span class="keyword" id="3014645">range</span>&nbsp;<span class="ident" id="3014651">file</span><span class="op" id="3014655">.</span><span class="ident" id="3014656">Decls</span>&nbsp;<span class="op" id="3014662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014666">switch</span>&nbsp;<span class="ident" id="3014673">d</span>&nbsp;<span class="op" id="3014675">:=</span>&nbsp;<span class="ident" id="3014678">decl</span><span class="op" id="3014682">.</span><span class="op" id="3014683">(</span><span class="keyword" id="3014684">type</span><span class="op" id="3014688">)</span>&nbsp;<span class="op" id="3014690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014694">case</span>&nbsp;<span class="op" id="3014699">*</span><span class="ident" id="3014700">ast</span><span class="op" id="3014703">.</span><span class="ident" id="3014704">FuncDecl</span><span class="op" id="3014712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014717">topDecls</span><span class="op" id="3014725">[</span><span class="ident" id="3014726">d</span><span class="op" id="3014727">.</span><span class="ident" id="3014728">Name</span><span class="op" id="3014732">.</span><span class="ident" id="3014733">Obj</span><span class="op" id="3014736">]</span>&nbsp;<span class="op" id="3014738">=</span>&nbsp;<span class="builtintype" id="3014740">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014747">case</span>&nbsp;<span class="op" id="3014752">*</span><span class="ident" id="3014753">ast</span><span class="op" id="3014756">.</span><span class="ident" id="3014757">GenDecl</span><span class="op" id="3014764">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014769">for</span>&nbsp;<span class="ident" id="3014773">_</span><span class="op" id="3014774">,</span>&nbsp;<span class="ident" id="3014776">spec</span>&nbsp;<span class="op" id="3014781">:=</span>&nbsp;<span class="keyword" id="3014784">range</span>&nbsp;<span class="ident" id="3014790">d</span><span class="op" id="3014791">.</span><span class="ident" id="3014792">Specs</span>&nbsp;<span class="op" id="3014798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014804">switch</span>&nbsp;<span class="ident" id="3014811">s</span>&nbsp;<span class="op" id="3014813">:=</span>&nbsp;<span class="ident" id="3014816">spec</span><span class="op" id="3014820">.</span><span class="op" id="3014821">(</span><span class="keyword" id="3014822">type</span><span class="op" id="3014826">)</span>&nbsp;<span class="op" id="3014828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014834">case</span>&nbsp;<span class="op" id="3014839">*</span><span class="ident" id="3014840">ast</span><span class="op" id="3014843">.</span><span class="ident" id="3014844">TypeSpec</span><span class="op" id="3014852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014859">topDecls</span><span class="op" id="3014867">[</span><span class="ident" id="3014868">s</span><span class="op" id="3014869">.</span><span class="ident" id="3014870">Name</span><span class="op" id="3014874">.</span><span class="ident" id="3014875">Obj</span><span class="op" id="3014878">]</span>&nbsp;<span class="op" id="3014880">=</span>&nbsp;<span class="builtintype" id="3014882">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014891">case</span>&nbsp;<span class="op" id="3014896">*</span><span class="ident" id="3014897">ast</span><span class="op" id="3014900">.</span><span class="ident" id="3014901">ValueSpec</span><span class="op" id="3014910">:</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014917">for</span>&nbsp;<span class="ident" id="3014921">_</span><span class="op" id="3014922">,</span>&nbsp;<span class="ident" id="3014924">id</span>&nbsp;<span class="op" id="3014927">:=</span>&nbsp;<span class="keyword" id="3014930">range</span>&nbsp;<span class="ident" id="3014936">s</span><span class="op" id="3014937">.</span><span class="ident" id="3014938">Names</span>&nbsp;<span class="op" id="3014944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014952">topDecls</span><span class="op" id="3014960">[</span><span class="ident" id="3014961">id</span><span class="op" id="3014963">.</span><span class="ident" id="3014964">Obj</span><span class="op" id="3014967">]</span>&nbsp;<span class="op" id="3014969">=</span>&nbsp;<span class="builtintype" id="3014971">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014992">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015003">//&nbsp;Find&nbsp;unresolved&nbsp;identifiers&nbsp;and&nbsp;uses&nbsp;of&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015071">unresolved</span>&nbsp;<span class="op" id="3015082">:=</span>&nbsp;<span class="builtinfunc" id="3015085">make</span><span class="op" id="3015089">(</span><span class="keyword" id="3015090">map</span><span class="op" id="3015093">[</span><span class="builtintype" id="3015094">string</span><span class="op" id="3015100">]</span><span class="builtintype" id="3015101">bool</span><span class="op" id="3015105">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015108">usesTopDecl</span>&nbsp;<span class="op" id="3015120">:=</span>&nbsp;<span class="builtintype" id="3015123">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015130">var</span>&nbsp;<span class="ident" id="3015134">inspectFunc</span>&nbsp;<span class="keyword" id="3015146">func</span><span class="op" id="3015150">(</span><span class="ident" id="3015151">ast</span><span class="op" id="3015154">.</span><span class="ident" id="3015155">Node</span><span class="op" id="3015159">)</span>&nbsp;<span class="builtintype" id="3015161">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015167">inspectFunc</span>&nbsp;<span class="op" id="3015179">=</span>&nbsp;<span class="keyword" id="3015181">func</span><span class="op" id="3015185">(</span><span class="ident" id="3015186">n</span>&nbsp;<span class="ident" id="3015188">ast</span><span class="op" id="3015191">.</span><span class="ident" id="3015192">Node</span><span class="op" id="3015196">)</span>&nbsp;<span class="builtintype" id="3015198">bool</span>&nbsp;<span class="op" id="3015203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015207">//&nbsp;For&nbsp;selector&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;left&nbsp;hand&nbsp;side.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015271">//&nbsp;(For&nbsp;an&nbsp;expression&nbsp;like&nbsp;fmt.Println,&nbsp;only&nbsp;add&nbsp;&#34;fmt&#34;&nbsp;to&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015335">//&nbsp;set&nbsp;of&nbsp;unresolved&nbsp;names,&nbsp;not&nbsp;&#34;Println&#34;.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015381">if</span>&nbsp;<span class="ident" id="3015384">e</span><span class="op" id="3015385">,</span>&nbsp;<span class="ident" id="3015387">ok</span>&nbsp;<span class="op" id="3015390">:=</span>&nbsp;<span class="ident" id="3015393">n</span><span class="op" id="3015394">.</span><span class="op" id="3015395">(</span><span class="op" id="3015396">*</span><span class="ident" id="3015397">ast</span><span class="op" id="3015400">.</span><span class="ident" id="3015401">SelectorExpr</span><span class="op" id="3015413">)</span><span class="op" id="3015414">;</span>&nbsp;<span class="ident" id="3015416">ok</span>&nbsp;<span class="op" id="3015419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015424">ast</span><span class="op" id="3015427">.</span><span class="ident" id="3015428">Inspect</span><span class="op" id="3015435">(</span><span class="ident" id="3015436">e</span><span class="op" id="3015437">.</span><span class="ident" id="3015438">X</span><span class="op" id="3015439">,</span>&nbsp;<span class="ident" id="3015441">inspectFunc</span><span class="op" id="3015452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015457">return</span>&nbsp;<span class="builtintype" id="3015464">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015472">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015476">//&nbsp;For&nbsp;key&nbsp;value&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015531">//&nbsp;as&nbsp;the&nbsp;key&nbsp;should&nbsp;be&nbsp;resolved&nbsp;by&nbsp;the&nbsp;type&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015585">//&nbsp;composite&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015609">if</span>&nbsp;<span class="ident" id="3015612">e</span><span class="op" id="3015613">,</span>&nbsp;<span class="ident" id="3015615">ok</span>&nbsp;<span class="op" id="3015618">:=</span>&nbsp;<span class="ident" id="3015621">n</span><span class="op" id="3015622">.</span><span class="op" id="3015623">(</span><span class="op" id="3015624">*</span><span class="ident" id="3015625">ast</span><span class="op" id="3015628">.</span><span class="ident" id="3015629">KeyValueExpr</span><span class="op" id="3015641">)</span><span class="op" id="3015642">;</span>&nbsp;<span class="ident" id="3015644">ok</span>&nbsp;<span class="op" id="3015647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015652">ast</span><span class="op" id="3015655">.</span><span class="ident" id="3015656">Inspect</span><span class="op" id="3015663">(</span><span class="ident" id="3015664">e</span><span class="op" id="3015665">.</span><span class="ident" id="3015666">Value</span><span class="op" id="3015671">,</span>&nbsp;<span class="ident" id="3015673">inspectFunc</span><span class="op" id="3015684">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015689">return</span>&nbsp;<span class="builtintype" id="3015696">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015708">if</span>&nbsp;<span class="ident" id="3015711">id</span><span class="op" id="3015713">,</span>&nbsp;<span class="ident" id="3015715">ok</span>&nbsp;<span class="op" id="3015718">:=</span>&nbsp;<span class="ident" id="3015721">n</span><span class="op" id="3015722">.</span><span class="op" id="3015723">(</span><span class="op" id="3015724">*</span><span class="ident" id="3015725">ast</span><span class="op" id="3015728">.</span><span class="ident" id="3015729">Ident</span><span class="op" id="3015734">)</span><span class="op" id="3015735">;</span>&nbsp;<span class="ident" id="3015737">ok</span>&nbsp;<span class="op" id="3015740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015745">if</span>&nbsp;<span class="ident" id="3015748">id</span><span class="op" id="3015750">.</span><span class="ident" id="3015751">Obj</span>&nbsp;<span class="op" id="3015755">==</span>&nbsp;<span class="ident" id="3015758">nil</span>&nbsp;<span class="op" id="3015762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015768">unresolved</span><span class="op" id="3015778">[</span><span class="ident" id="3015779">id</span><span class="op" id="3015781">.</span><span class="ident" id="3015782">Name</span><span class="op" id="3015786">]</span>&nbsp;<span class="op" id="3015788">=</span>&nbsp;<span class="builtintype" id="3015790">true</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015798">}</span>&nbsp;<span class="keyword" id="3015800">else</span>&nbsp;<span class="keyword" id="3015805">if</span>&nbsp;<span class="ident" id="3015808">topDecls</span><span class="op" id="3015816">[</span><span class="ident" id="3015817">id</span><span class="op" id="3015819">.</span><span class="ident" id="3015820">Obj</span><span class="op" id="3015823">]</span>&nbsp;<span class="op" id="3015825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015831">usesTopDecl</span>&nbsp;<span class="op" id="3015843">=</span>&nbsp;<span class="builtintype" id="3015845">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015861">return</span>&nbsp;<span class="builtintype" id="3015868">true</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015877">ast</span><span class="op" id="3015880">.</span><span class="ident" id="3015881">Inspect</span><span class="op" id="3015888">(</span><span class="ident" id="3015889">body</span><span class="op" id="3015893">,</span>&nbsp;<span class="ident" id="3015895">inspectFunc</span><span class="op" id="3015906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015909">if</span>&nbsp;<span class="ident" id="3015912">usesTopDecl</span>&nbsp;<span class="op" id="3015924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3015928">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;not&nbsp;self-contained&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015994">return</span>&nbsp;<span class="ident" id="3016001">nil</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016010">//&nbsp;Remove&nbsp;predeclared&nbsp;identifiers&nbsp;from&nbsp;unresolved&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016067">for</span>&nbsp;<span class="ident" id="3016071">n</span>&nbsp;<span class="op" id="3016073">:=</span>&nbsp;<span class="keyword" id="3016076">range</span>&nbsp;<span class="ident" id="3016082">unresolved</span>&nbsp;<span class="op" id="3016093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016097">if</span>&nbsp;<span class="ident" id="3016100">predeclaredTypes</span><span class="op" id="3016116">[</span><span class="ident" id="3016117">n</span><span class="op" id="3016118">]</span>&nbsp;<span class="op" id="3016120">||</span>&nbsp;<span class="ident" id="3016123">predeclaredConstants</span><span class="op" id="3016143">[</span><span class="ident" id="3016144">n</span><span class="op" id="3016145">]</span>&nbsp;<span class="op" id="3016147">||</span>&nbsp;<span class="ident" id="3016150">predeclaredFuncs</span><span class="op" id="3016166">[</span><span class="ident" id="3016167">n</span><span class="op" id="3016168">]</span>&nbsp;<span class="op" id="3016170">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3016175">delete</span><span class="op" id="3016181">(</span><span class="ident" id="3016182">unresolved</span><span class="op" id="3016192">,</span>&nbsp;<span class="ident" id="3016194">n</span><span class="op" id="3016195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016206">//&nbsp;Use&nbsp;unresolved&nbsp;identifiers&nbsp;to&nbsp;determine&nbsp;the&nbsp;imports&nbsp;used&nbsp;by&nbsp;this</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016275">//&nbsp;example.&nbsp;The&nbsp;heuristic&nbsp;assumes&nbsp;package&nbsp;names&nbsp;match&nbsp;base&nbsp;import</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016342">//&nbsp;paths&nbsp;for&nbsp;imports&nbsp;w/o&nbsp;renames&nbsp;(should&nbsp;be&nbsp;good&nbsp;enough&nbsp;most&nbsp;of&nbsp;the&nbsp;time).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016418">namedImports</span>&nbsp;<span class="op" id="3016431">:=</span>&nbsp;<span class="builtinfunc" id="3016434">make</span><span class="op" id="3016438">(</span><span class="keyword" id="3016439">map</span><span class="op" id="3016442">[</span><span class="builtintype" id="3016443">string</span><span class="op" id="3016449">]</span><span class="builtintype" id="3016450">string</span><span class="op" id="3016456">)</span>&nbsp;<span class="comment" id="3016458">//&nbsp;[name]path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016473">var</span>&nbsp;<span class="ident" id="3016477">blankImports</span>&nbsp;<span class="op" id="3016490">[</span><span class="op" id="3016491">]</span><span class="ident" id="3016492">ast</span><span class="op" id="3016495">.</span><span class="ident" id="3016496">Spec</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3016513">//&nbsp;_&nbsp;imports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016527">for</span>&nbsp;<span class="ident" id="3016531">_</span><span class="op" id="3016532">,</span>&nbsp;<span class="ident" id="3016534">s</span>&nbsp;<span class="op" id="3016536">:=</span>&nbsp;<span class="keyword" id="3016539">range</span>&nbsp;<span class="ident" id="3016545">file</span><span class="op" id="3016549">.</span><span class="ident" id="3016550">Imports</span>&nbsp;<span class="op" id="3016558">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016562">p</span><span class="op" id="3016563">,</span>&nbsp;<span class="ident" id="3016565">err</span>&nbsp;<span class="op" id="3016569">:=</span>&nbsp;<span class="ident" id="3016572">strconv</span><span class="op" id="3016579">.</span><span class="ident" id="3016580">Unquote</span><span class="op" id="3016587">(</span><span class="ident" id="3016588">s</span><span class="op" id="3016589">.</span><span class="ident" id="3016590">Path</span><span class="op" id="3016594">.</span><span class="ident" id="3016595">Value</span><span class="op" id="3016600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016604">if</span>&nbsp;<span class="ident" id="3016607">err</span>&nbsp;<span class="op" id="3016611">!=</span>&nbsp;<span class="ident" id="3016614">nil</span>&nbsp;<span class="op" id="3016618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016623">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016638">n</span>&nbsp;<span class="op" id="3016640">:=</span>&nbsp;<span class="ident" id="3016643">path</span><span class="op" id="3016647">.</span><span class="ident" id="3016648">Base</span><span class="op" id="3016652">(</span><span class="ident" id="3016653">p</span><span class="op" id="3016654">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016658">if</span>&nbsp;<span class="ident" id="3016661">s</span><span class="op" id="3016662">.</span><span class="ident" id="3016663">Name</span>&nbsp;<span class="op" id="3016668">!=</span>&nbsp;<span class="ident" id="3016671">nil</span>&nbsp;<span class="op" id="3016675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016680">n</span>&nbsp;<span class="op" id="3016682">=</span>&nbsp;<span class="ident" id="3016684">s</span><span class="op" id="3016685">.</span><span class="ident" id="3016686">Name</span><span class="op" id="3016690">.</span><span class="ident" id="3016691">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016699">switch</span>&nbsp;<span class="ident" id="3016706">n</span>&nbsp;<span class="op" id="3016708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016713">case</span>&nbsp;<span class="string" id="3016718">&#34;_&#34;</span><span class="op" id="3016721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016727">blankImports</span>&nbsp;<span class="op" id="3016740">=</span>&nbsp;<span class="builtinfunc" id="3016742">append</span><span class="op" id="3016748">(</span><span class="ident" id="3016749">blankImports</span><span class="op" id="3016761">,</span>&nbsp;<span class="ident" id="3016763">s</span><span class="op" id="3016764">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016770">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016782">case</span>&nbsp;<span class="string" id="3016787">&#34;.&#34;</span><span class="op" id="3016790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016796">//&nbsp;We&nbsp;can&#39;t&nbsp;resolve&nbsp;dot&nbsp;imports&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016839">return</span>&nbsp;<span class="ident" id="3016846">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016853">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016861">if</span>&nbsp;<span class="ident" id="3016864">unresolved</span><span class="op" id="3016874">[</span><span class="ident" id="3016875">n</span><span class="op" id="3016876">]</span>&nbsp;<span class="op" id="3016878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016883">namedImports</span><span class="op" id="3016895">[</span><span class="ident" id="3016896">n</span><span class="op" id="3016897">]</span>&nbsp;<span class="op" id="3016899">=</span>&nbsp;<span class="ident" id="3016901">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3016906">delete</span><span class="op" id="3016912">(</span><span class="ident" id="3016913">unresolved</span><span class="op" id="3016923">,</span>&nbsp;<span class="ident" id="3016925">n</span><span class="op" id="3016926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016930">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3016937">//&nbsp;If&nbsp;there&nbsp;are&nbsp;other&nbsp;unresolved&nbsp;identifiers,&nbsp;give&nbsp;up&nbsp;because&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017005">//&nbsp;synthesized&nbsp;file&nbsp;is&nbsp;not&nbsp;going&nbsp;to&nbsp;build.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017049">if</span>&nbsp;<span class="builtinfunc" id="3017052">len</span><span class="op" id="3017055">(</span><span class="ident" id="3017056">unresolved</span><span class="op" id="3017066">)</span>&nbsp;<span class="op" id="3017068">&gt;</span>&nbsp;<span class="num" id="3017070">0</span>&nbsp;<span class="op" id="3017072">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017076">return</span>&nbsp;<span class="ident" id="3017083">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017092">//&nbsp;Include&nbsp;documentation&nbsp;belonging&nbsp;to&nbsp;blank&nbsp;imports.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017146">var</span>&nbsp;<span class="ident" id="3017150">comments</span>&nbsp;<span class="op" id="3017159">[</span><span class="op" id="3017160">]</span><span class="op" id="3017161">*</span><span class="ident" id="3017162">ast</span><span class="op" id="3017165">.</span><span class="ident" id="3017166">CommentGroup</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017180">for</span>&nbsp;<span class="ident" id="3017184">_</span><span class="op" id="3017185">,</span>&nbsp;<span class="ident" id="3017187">s</span>&nbsp;<span class="op" id="3017189">:=</span>&nbsp;<span class="keyword" id="3017192">range</span>&nbsp;<span class="ident" id="3017198">blankImports</span>&nbsp;<span class="op" id="3017211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017215">if</span>&nbsp;<span class="ident" id="3017218">c</span>&nbsp;<span class="op" id="3017220">:=</span>&nbsp;<span class="ident" id="3017223">s</span><span class="op" id="3017224">.</span><span class="op" id="3017225">(</span><span class="op" id="3017226">*</span><span class="ident" id="3017227">ast</span><span class="op" id="3017230">.</span><span class="ident" id="3017231">ImportSpec</span><span class="op" id="3017241">)</span><span class="op" id="3017242">.</span><span class="ident" id="3017243">Doc</span><span class="op" id="3017246">;</span>&nbsp;<span class="ident" id="3017248">c</span>&nbsp;<span class="op" id="3017250">!=</span>&nbsp;<span class="ident" id="3017253">nil</span>&nbsp;<span class="op" id="3017257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017262">comments</span>&nbsp;<span class="op" id="3017271">=</span>&nbsp;<span class="builtinfunc" id="3017273">append</span><span class="op" id="3017279">(</span><span class="ident" id="3017280">comments</span><span class="op" id="3017288">,</span>&nbsp;<span class="ident" id="3017290">c</span><span class="op" id="3017291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017298">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017302">//&nbsp;Include&nbsp;comments&nbsp;that&nbsp;are&nbsp;inside&nbsp;the&nbsp;function&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017358">for</span>&nbsp;<span class="ident" id="3017362">_</span><span class="op" id="3017363">,</span>&nbsp;<span class="ident" id="3017365">c</span>&nbsp;<span class="op" id="3017367">:=</span>&nbsp;<span class="keyword" id="3017370">range</span>&nbsp;<span class="ident" id="3017376">file</span><span class="op" id="3017380">.</span><span class="ident" id="3017381">Comments</span>&nbsp;<span class="op" id="3017390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017394">if</span>&nbsp;<span class="ident" id="3017397">body</span><span class="op" id="3017401">.</span><span class="ident" id="3017402">Pos</span><span class="op" id="3017405">(</span><span class="op" id="3017406">)</span>&nbsp;<span class="op" id="3017408">&lt;=</span>&nbsp;<span class="ident" id="3017411">c</span><span class="op" id="3017412">.</span><span class="ident" id="3017413">Pos</span><span class="op" id="3017416">(</span><span class="op" id="3017417">)</span>&nbsp;<span class="op" id="3017419">&amp;&amp;</span>&nbsp;<span class="ident" id="3017422">c</span><span class="op" id="3017423">.</span><span class="ident" id="3017424">End</span><span class="op" id="3017427">(</span><span class="op" id="3017428">)</span>&nbsp;<span class="op" id="3017430">&lt;=</span>&nbsp;<span class="ident" id="3017433">body</span><span class="op" id="3017437">.</span><span class="ident" id="3017438">End</span><span class="op" id="3017441">(</span><span class="op" id="3017442">)</span>&nbsp;<span class="op" id="3017444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017449">comments</span>&nbsp;<span class="op" id="3017458">=</span>&nbsp;<span class="builtinfunc" id="3017460">append</span><span class="op" id="3017466">(</span><span class="ident" id="3017467">comments</span><span class="op" id="3017475">,</span>&nbsp;<span class="ident" id="3017477">c</span><span class="op" id="3017478">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017489">//&nbsp;Strip&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;and&nbsp;adjust&nbsp;body&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017547">body</span><span class="op" id="3017551">,</span>&nbsp;<span class="ident" id="3017553">comments</span>&nbsp;<span class="op" id="3017562">=</span>&nbsp;<span class="ident" id="3017564">stripOutputComment</span><span class="op" id="3017582">(</span><span class="ident" id="3017583">body</span><span class="op" id="3017587">,</span>&nbsp;<span class="ident" id="3017589">comments</span><span class="op" id="3017597">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3017601">//&nbsp;Synthesize&nbsp;import&nbsp;declaration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017636">importDecl</span>&nbsp;<span class="op" id="3017647">:=</span>&nbsp;<span class="op" id="3017650">&amp;</span><span class="ident" id="3017651">ast</span><span class="op" id="3017654">.</span><span class="ident" id="3017655">GenDecl</span><span class="op" id="3017662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017666">Tok</span><span class="op" id="3017669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3017674">token</span><span class="op" id="3017679">.</span><span class="ident" id="3017680">IMPORT</span><span class="op" id="3017686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017690">Lparen</span><span class="op" id="3017696">:</span>&nbsp;<span class="num" id="3017698">1</span><span class="op" id="3017699">,</span>&nbsp;<span class="comment" id="3017701">//&nbsp;Need&nbsp;non-zero&nbsp;Lparen&nbsp;and&nbsp;Rparen&nbsp;so&nbsp;that&nbsp;printer</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017754">Rparen</span><span class="op" id="3017760">:</span>&nbsp;<span class="num" id="3017762">1</span><span class="op" id="3017763">,</span>&nbsp;<span class="comment" id="3017765">//&nbsp;treats&nbsp;this&nbsp;as&nbsp;a&nbsp;factored&nbsp;import.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017806">for</span>&nbsp;<span class="ident" id="3017810">n</span><span class="op" id="3017811">,</span>&nbsp;<span class="ident" id="3017813">p</span>&nbsp;<span class="op" id="3017815">:=</span>&nbsp;<span class="keyword" id="3017818">range</span>&nbsp;<span class="ident" id="3017824">namedImports</span>&nbsp;<span class="op" id="3017837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017841">s</span>&nbsp;<span class="op" id="3017843">:=</span>&nbsp;<span class="op" id="3017846">&amp;</span><span class="ident" id="3017847">ast</span><span class="op" id="3017850">.</span><span class="ident" id="3017851">ImportSpec</span><span class="op" id="3017861">{</span><span class="ident" id="3017862">Path</span><span class="op" id="3017866">:</span>&nbsp;<span class="op" id="3017868">&amp;</span><span class="ident" id="3017869">ast</span><span class="op" id="3017872">.</span><span class="ident" id="3017873">BasicLit</span><span class="op" id="3017881">{</span><span class="ident" id="3017882">Value</span><span class="op" id="3017887">:</span>&nbsp;<span class="ident" id="3017889">strconv</span><span class="op" id="3017896">.</span><span class="ident" id="3017897">Quote</span><span class="op" id="3017902">(</span><span class="ident" id="3017903">p</span><span class="op" id="3017904">)</span><span class="op" id="3017905">}</span><span class="op" id="3017906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017910">if</span>&nbsp;<span class="ident" id="3017913">path</span><span class="op" id="3017917">.</span><span class="ident" id="3017918">Base</span><span class="op" id="3017922">(</span><span class="ident" id="3017923">p</span><span class="op" id="3017924">)</span>&nbsp;<span class="op" id="3017926">!=</span>&nbsp;<span class="ident" id="3017929">n</span>&nbsp;<span class="op" id="3017931">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017936">s</span><span class="op" id="3017937">.</span><span class="ident" id="3017938">Name</span>&nbsp;<span class="op" id="3017943">=</span>&nbsp;<span class="ident" id="3017945">ast</span><span class="op" id="3017948">.</span><span class="ident" id="3017949">NewIdent</span><span class="op" id="3017957">(</span><span class="ident" id="3017958">n</span><span class="op" id="3017959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017967">importDecl</span><span class="op" id="3017977">.</span><span class="ident" id="3017978">Specs</span>&nbsp;<span class="op" id="3017984">=</span>&nbsp;<span class="builtinfunc" id="3017986">append</span><span class="op" id="3017992">(</span><span class="ident" id="3017993">importDecl</span><span class="op" id="3018003">.</span><span class="ident" id="3018004">Specs</span><span class="op" id="3018009">,</span>&nbsp;<span class="ident" id="3018011">s</span><span class="op" id="3018012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018018">importDecl</span><span class="op" id="3018028">.</span><span class="ident" id="3018029">Specs</span>&nbsp;<span class="op" id="3018035">=</span>&nbsp;<span class="builtinfunc" id="3018037">append</span><span class="op" id="3018043">(</span><span class="ident" id="3018044">importDecl</span><span class="op" id="3018054">.</span><span class="ident" id="3018055">Specs</span><span class="op" id="3018060">,</span>&nbsp;<span class="ident" id="3018062">blankImports</span><span class="op" id="3018074">...</span><span class="op" id="3018077">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3018081">//&nbsp;Synthesize&nbsp;main&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018111">funcDecl</span>&nbsp;<span class="op" id="3018120">:=</span>&nbsp;<span class="op" id="3018123">&amp;</span><span class="ident" id="3018124">ast</span><span class="op" id="3018127">.</span><span class="ident" id="3018128">FuncDecl</span><span class="op" id="3018136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018140">Name</span><span class="op" id="3018144">:</span>&nbsp;<span class="ident" id="3018146">ast</span><span class="op" id="3018149">.</span><span class="ident" id="3018150">NewIdent</span><span class="op" id="3018158">(</span><span class="string" id="3018159">&#34;main&#34;</span><span class="op" id="3018165">)</span><span class="op" id="3018166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018170">Type</span><span class="op" id="3018174">:</span>&nbsp;<span class="op" id="3018176">&amp;</span><span class="ident" id="3018177">ast</span><span class="op" id="3018180">.</span><span class="ident" id="3018181">FuncType</span><span class="op" id="3018189">{</span><span class="ident" id="3018190">Params</span><span class="op" id="3018196">:</span>&nbsp;<span class="op" id="3018198">&amp;</span><span class="ident" id="3018199">ast</span><span class="op" id="3018202">.</span><span class="ident" id="3018203">FieldList</span><span class="op" id="3018212">{</span><span class="op" id="3018213">}</span><span class="op" id="3018214">}</span><span class="op" id="3018215">,</span>&nbsp;<span class="comment" id="3018217">//&nbsp;FuncType.Params&nbsp;must&nbsp;be&nbsp;non-nil</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018254">Body</span><span class="op" id="3018258">:</span>&nbsp;<span class="ident" id="3018260">body</span><span class="op" id="3018264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3018271">//&nbsp;Synthesize&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018292">return</span>&nbsp;<span class="op" id="3018299">&amp;</span><span class="ident" id="3018300">ast</span><span class="op" id="3018303">.</span><span class="ident" id="3018304">File</span><span class="op" id="3018308">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018312">Name</span><span class="op" id="3018316">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3018322">ast</span><span class="op" id="3018325">.</span><span class="ident" id="3018326">NewIdent</span><span class="op" id="3018334">(</span><span class="string" id="3018335">&#34;main&#34;</span><span class="op" id="3018341">)</span><span class="op" id="3018342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018346">Decls</span><span class="op" id="3018351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3018356">[</span><span class="op" id="3018357">]</span><span class="ident" id="3018358">ast</span><span class="op" id="3018361">.</span><span class="ident" id="3018362">Decl</span><span class="op" id="3018366">{</span><span class="ident" id="3018367">importDecl</span><span class="op" id="3018377">,</span>&nbsp;<span class="ident" id="3018379">funcDecl</span><span class="op" id="3018387">}</span><span class="op" id="3018388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018392">Comments</span><span class="op" id="3018400">:</span>&nbsp;<span class="ident" id="3018402">comments</span><span class="op" id="3018410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018413">}</span><br>
<span class="lineno"></span><span class="op" id="3018415">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="3018418">//&nbsp;playExampleFile&nbsp;takes&nbsp;a&nbsp;whole&nbsp;file&nbsp;example&nbsp;and&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File</span><br>
<span class="lineno"></span><span class="comment" id="3018496">//&nbsp;such&nbsp;that&nbsp;the&nbsp;example&nbsp;is&nbsp;function&nbsp;main&nbsp;in&nbsp;package&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="3018555">func</span>&nbsp;<span class="ident" id="3018560">playExampleFile</span><span class="op" id="3018575">(</span><span class="ident" id="3018576">file</span>&nbsp;<span class="op" id="3018581">*</span><span class="ident" id="3018582">ast</span><span class="op" id="3018585">.</span><span class="ident" id="3018586">File</span><span class="op" id="3018590">)</span>&nbsp;<span class="op" id="3018592">*</span><span class="ident" id="3018593">ast</span><span class="op" id="3018596">.</span><span class="ident" id="3018597">File</span>&nbsp;<span class="op" id="3018602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3018605">//&nbsp;Strip&nbsp;copyright&nbsp;comment&nbsp;if&nbsp;present.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018645">comments</span>&nbsp;<span class="op" id="3018654">:=</span>&nbsp;<span class="ident" id="3018657">file</span><span class="op" id="3018661">.</span><span class="ident" id="3018662">Comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018672">if</span>&nbsp;<span class="builtinfunc" id="3018675">len</span><span class="op" id="3018678">(</span><span class="ident" id="3018679">comments</span><span class="op" id="3018687">)</span>&nbsp;<span class="op" id="3018689">&gt;</span>&nbsp;<span class="num" id="3018691">0</span>&nbsp;<span class="op" id="3018693">&amp;&amp;</span>&nbsp;<span class="ident" id="3018696">strings</span><span class="op" id="3018703">.</span><span class="ident" id="3018704">HasPrefix</span><span class="op" id="3018713">(</span><span class="ident" id="3018714">comments</span><span class="op" id="3018722">[</span><span class="num" id="3018723">0</span><span class="op" id="3018724">]</span><span class="op" id="3018725">.</span><span class="ident" id="3018726">Text</span><span class="op" id="3018730">(</span><span class="op" id="3018731">)</span><span class="op" id="3018732">,</span>&nbsp;<span class="string" id="3018734">&#34;Copyright&#34;</span><span class="op" id="3018745">)</span>&nbsp;<span class="op" id="3018747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3018751">comments</span>&nbsp;<span class="op" id="3018760">=</span>&nbsp;<span class="ident" id="3018762">comments</span><span class="op" id="3018770">[</span><span class="num" id="3018771">1</span><span class="op" id="3018772">:</span><span class="op" id="3018773">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3018776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3018780">//&nbsp;Copy&nbsp;declaration&nbsp;slice,&nbsp;rewriting&nbsp;the&nbsp;ExampleX&nbsp;function&nbsp;to&nbsp;main.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018849">var</span>&nbsp;<span class="ident" id="3018853">decls</span>&nbsp;<span class="op" id="3018859">[</span><span class="op" id="3018860">]</span><span class="ident" id="3018861">ast</span><span class="op" id="3018864">.</span><span class="ident" id="3018865">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018871">for</span>&nbsp;<span class="ident" id="3018875">_</span><span class="op" id="3018876">,</span>&nbsp;<span class="ident" id="3018878">d</span>&nbsp;<span class="op" id="3018880">:=</span>&nbsp;<span class="keyword" id="3018883">range</span>&nbsp;<span class="ident" id="3018889">file</span><span class="op" id="3018893">.</span><span class="ident" id="3018894">Decls</span>&nbsp;<span class="op" id="3018900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3018904">if</span>&nbsp;<span class="ident" id="3018907">f</span><span class="op" id="3018908">,</span>&nbsp;<span class="ident" id="3018910">ok</span>&nbsp;<span class="op" id="3018913">:=</span>&nbsp;<span class="ident" id="3018916">d</span><span class="op" id="3018917">.</span><span class="op" id="3018918">(</span><span class="op" id="3018919">*</span><span class="ident" id="3018920">ast</span><span class="op" id="3018923">.</span><span class="ident" id="3018924">FuncDecl</span><span class="op" id="3018932">)</span><span class="op" id="3018933">;</span>&nbsp;<span class="ident" id="3018935">ok</span>&nbsp;<span class="op" id="3018938">&amp;&amp;</span>&nbsp;<span class="ident" id="3018941">isTest</span><span class="op" id="3018947">(</span><span class="ident" id="3018948">f</span><span class="op" id="3018949">.</span><span class="ident" id="3018950">Name</span><span class="op" id="3018954">.</span><span class="ident" id="3018955">Name</span><span class="op" id="3018959">,</span>&nbsp;<span class="string" id="3018961">&#34;Example&#34;</span><span class="op" id="3018970">)</span>&nbsp;<span class="op" id="3018972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3018977">//&nbsp;Copy&nbsp;the&nbsp;FuncDecl,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019031">newF</span>&nbsp;<span class="op" id="3019036">:=</span>&nbsp;<span class="op" id="3019039">*</span><span class="ident" id="3019040">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019045">newF</span><span class="op" id="3019049">.</span><span class="ident" id="3019050">Name</span>&nbsp;<span class="op" id="3019055">=</span>&nbsp;<span class="ident" id="3019057">ast</span><span class="op" id="3019060">.</span><span class="ident" id="3019061">NewIdent</span><span class="op" id="3019069">(</span><span class="string" id="3019070">&#34;main&#34;</span><span class="op" id="3019076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019081">newF</span><span class="op" id="3019085">.</span><span class="ident" id="3019086">Body</span><span class="op" id="3019090">,</span>&nbsp;<span class="ident" id="3019092">comments</span>&nbsp;<span class="op" id="3019101">=</span>&nbsp;<span class="ident" id="3019103">stripOutputComment</span><span class="op" id="3019121">(</span><span class="ident" id="3019122">f</span><span class="op" id="3019123">.</span><span class="ident" id="3019124">Body</span><span class="op" id="3019128">,</span>&nbsp;<span class="ident" id="3019130">comments</span><span class="op" id="3019138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019143">d</span>&nbsp;<span class="op" id="3019145">=</span>&nbsp;<span class="op" id="3019147">&amp;</span><span class="ident" id="3019148">newF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019155">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019159">decls</span>&nbsp;<span class="op" id="3019165">=</span>&nbsp;<span class="builtinfunc" id="3019167">append</span><span class="op" id="3019173">(</span><span class="ident" id="3019174">decls</span><span class="op" id="3019179">,</span>&nbsp;<span class="ident" id="3019181">d</span><span class="op" id="3019182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3019189">//&nbsp;Copy&nbsp;the&nbsp;File,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019237">f</span>&nbsp;<span class="op" id="3019239">:=</span>&nbsp;<span class="op" id="3019242">*</span><span class="ident" id="3019243">file</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019249">f</span><span class="op" id="3019250">.</span><span class="ident" id="3019251">Name</span>&nbsp;<span class="op" id="3019256">=</span>&nbsp;<span class="ident" id="3019258">ast</span><span class="op" id="3019261">.</span><span class="ident" id="3019262">NewIdent</span><span class="op" id="3019270">(</span><span class="string" id="3019271">&#34;main&#34;</span><span class="op" id="3019277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019280">f</span><span class="op" id="3019281">.</span><span class="ident" id="3019282">Decls</span>&nbsp;<span class="op" id="3019288">=</span>&nbsp;<span class="ident" id="3019290">decls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019297">f</span><span class="op" id="3019298">.</span><span class="ident" id="3019299">Comments</span>&nbsp;<span class="op" id="3019308">=</span>&nbsp;<span class="ident" id="3019310">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019320">return</span>&nbsp;<span class="op" id="3019327">&amp;</span><span class="ident" id="3019328">f</span><br>
<span class="lineno"></span><span class="op" id="3019330">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="3019333">//&nbsp;stripOutputComment&nbsp;finds&nbsp;and&nbsp;removes&nbsp;an&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;from&nbsp;body</span><br>
<span class="lineno"></span><span class="comment" id="3019404">//&nbsp;and&nbsp;comments,&nbsp;and&nbsp;adjusts&nbsp;the&nbsp;body&nbsp;block&#39;s&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="3019464">func</span>&nbsp;<span class="ident" id="3019469">stripOutputComment</span><span class="op" id="3019487">(</span><span class="ident" id="3019488">body</span>&nbsp;<span class="op" id="3019493">*</span><span class="ident" id="3019494">ast</span><span class="op" id="3019497">.</span><span class="ident" id="3019498">BlockStmt</span><span class="op" id="3019507">,</span>&nbsp;<span class="ident" id="3019509">comments</span>&nbsp;<span class="op" id="3019518">[</span><span class="op" id="3019519">]</span><span class="op" id="3019520">*</span><span class="ident" id="3019521">ast</span><span class="op" id="3019524">.</span><span class="ident" id="3019525">CommentGroup</span><span class="op" id="3019537">)</span>&nbsp;<span class="op" id="3019539">(</span><span class="op" id="3019540">*</span><span class="ident" id="3019541">ast</span><span class="op" id="3019544">.</span><span class="ident" id="3019545">BlockStmt</span><span class="op" id="3019554">,</span>&nbsp;<span class="op" id="3019556">[</span><span class="op" id="3019557">]</span><span class="op" id="3019558">*</span><span class="ident" id="3019559">ast</span><span class="op" id="3019562">.</span><span class="ident" id="3019563">CommentGroup</span><span class="op" id="3019575">)</span>&nbsp;<span class="op" id="3019577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3019580">//&nbsp;Do&nbsp;nothing&nbsp;if&nbsp;no&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;found.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019626">i</span><span class="op" id="3019627">,</span>&nbsp;<span class="ident" id="3019629">last</span>&nbsp;<span class="op" id="3019634">:=</span>&nbsp;<span class="ident" id="3019637">lastComment</span><span class="op" id="3019648">(</span><span class="ident" id="3019649">body</span><span class="op" id="3019653">,</span>&nbsp;<span class="ident" id="3019655">comments</span><span class="op" id="3019663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019666">if</span>&nbsp;<span class="ident" id="3019669">last</span>&nbsp;<span class="op" id="3019674">==</span>&nbsp;<span class="ident" id="3019677">nil</span>&nbsp;<span class="op" id="3019681">||</span>&nbsp;<span class="op" id="3019684">!</span><span class="ident" id="3019685">outputPrefix</span><span class="op" id="3019697">.</span><span class="ident" id="3019698">MatchString</span><span class="op" id="3019709">(</span><span class="ident" id="3019710">last</span><span class="op" id="3019714">.</span><span class="ident" id="3019715">Text</span><span class="op" id="3019719">(</span><span class="op" id="3019720">)</span><span class="op" id="3019721">)</span>&nbsp;<span class="op" id="3019723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3019727">return</span>&nbsp;<span class="ident" id="3019734">body</span><span class="op" id="3019738">,</span>&nbsp;<span class="ident" id="3019740">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3019754">//&nbsp;Copy&nbsp;body&nbsp;and&nbsp;comments,&nbsp;as&nbsp;the&nbsp;originals&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019822">newBody</span>&nbsp;<span class="op" id="3019830">:=</span>&nbsp;<span class="op" id="3019833">&amp;</span><span class="ident" id="3019834">ast</span><span class="op" id="3019837">.</span><span class="ident" id="3019838">BlockStmt</span><span class="op" id="3019847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019851">Lbrace</span><span class="op" id="3019857">:</span>&nbsp;<span class="ident" id="3019859">body</span><span class="op" id="3019863">.</span><span class="ident" id="3019864">Lbrace</span><span class="op" id="3019870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019874">List</span><span class="op" id="3019878">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3019882">body</span><span class="op" id="3019886">.</span><span class="ident" id="3019887">List</span><span class="op" id="3019891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019895">Rbrace</span><span class="op" id="3019901">:</span>&nbsp;<span class="ident" id="3019903">last</span><span class="op" id="3019907">.</span><span class="ident" id="3019908">Pos</span><span class="op" id="3019911">(</span><span class="op" id="3019912">)</span><span class="op" id="3019913">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3019916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3019919">newComments</span>&nbsp;<span class="op" id="3019931">:=</span>&nbsp;<span class="builtinfunc" id="3019934">make</span><span class="op" id="3019938">(</span><span class="op" id="3019939">[</span><span class="op" id="3019940">]</span><span class="op" id="3019941">*</span><span class="ident" id="3019942">ast</span><span class="op" id="3019945">.</span><span class="ident" id="3019946">CommentGroup</span><span class="op" id="3019958">,</span>&nbsp;<span class="builtinfunc" id="3019960">len</span><span class="op" id="3019963">(</span><span class="ident" id="3019964">comments</span><span class="op" id="3019972">)</span><span class="op" id="3019973">-</span><span class="num" id="3019974">1</span><span class="op" id="3019975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3019978">copy</span><span class="op" id="3019982">(</span><span class="ident" id="3019983">newComments</span><span class="op" id="3019994">,</span>&nbsp;<span class="ident" id="3019996">comments</span><span class="op" id="3020004">[</span><span class="op" id="3020005">:</span><span class="ident" id="3020006">i</span><span class="op" id="3020007">]</span><span class="op" id="3020008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3020011">copy</span><span class="op" id="3020015">(</span><span class="ident" id="3020016">newComments</span><span class="op" id="3020027">[</span><span class="ident" id="3020028">i</span><span class="op" id="3020029">:</span><span class="op" id="3020030">]</span><span class="op" id="3020031">,</span>&nbsp;<span class="ident" id="3020033">comments</span><span class="op" id="3020041">[</span><span class="ident" id="3020042">i</span><span class="op" id="3020043">+</span><span class="num" id="3020044">1</span><span class="op" id="3020045">:</span><span class="op" id="3020046">]</span><span class="op" id="3020047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020050">return</span>&nbsp;<span class="ident" id="3020057">newBody</span><span class="op" id="3020064">,</span>&nbsp;<span class="ident" id="3020066">newComments</span><br>
<span class="lineno">340</span><span class="op" id="3020078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3020081">//&nbsp;lastComment&nbsp;returns&nbsp;the&nbsp;last&nbsp;comment&nbsp;inside&nbsp;the&nbsp;provided&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="3020148">func</span>&nbsp;<span class="ident" id="3020153">lastComment</span><span class="op" id="3020164">(</span><span class="ident" id="3020165">b</span>&nbsp;<span class="op" id="3020167">*</span><span class="ident" id="3020168">ast</span><span class="op" id="3020171">.</span><span class="ident" id="3020172">BlockStmt</span><span class="op" id="3020181">,</span>&nbsp;<span class="ident" id="3020183">c</span>&nbsp;<span class="op" id="3020185">[</span><span class="op" id="3020186">]</span><span class="op" id="3020187">*</span><span class="ident" id="3020188">ast</span><span class="op" id="3020191">.</span><span class="ident" id="3020192">CommentGroup</span><span class="op" id="3020204">)</span>&nbsp;<span class="op" id="3020206">(</span><span class="ident" id="3020207">i</span>&nbsp;<span class="builtintype" id="3020209">int</span><span class="op" id="3020212">,</span>&nbsp;<span class="ident" id="3020214">last</span>&nbsp;<span class="op" id="3020219">*</span><span class="ident" id="3020220">ast</span><span class="op" id="3020223">.</span><span class="ident" id="3020224">CommentGroup</span><span class="op" id="3020236">)</span>&nbsp;<span class="op" id="3020238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3020241">pos</span><span class="op" id="3020244">,</span>&nbsp;<span class="ident" id="3020246">end</span>&nbsp;<span class="op" id="3020250">:=</span>&nbsp;<span class="ident" id="3020253">b</span><span class="op" id="3020254">.</span><span class="ident" id="3020255">Pos</span><span class="op" id="3020258">(</span><span class="op" id="3020259">)</span><span class="op" id="3020260">,</span>&nbsp;<span class="ident" id="3020262">b</span><span class="op" id="3020263">.</span><span class="ident" id="3020264">End</span><span class="op" id="3020267">(</span><span class="op" id="3020268">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020271">for</span>&nbsp;<span class="ident" id="3020275">j</span><span class="op" id="3020276">,</span>&nbsp;<span class="ident" id="3020278">cg</span>&nbsp;<span class="op" id="3020281">:=</span>&nbsp;<span class="keyword" id="3020284">range</span>&nbsp;<span class="ident" id="3020290">c</span>&nbsp;<span class="op" id="3020292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020296">if</span>&nbsp;<span class="ident" id="3020299">cg</span><span class="op" id="3020301">.</span><span class="ident" id="3020302">Pos</span><span class="op" id="3020305">(</span><span class="op" id="3020306">)</span>&nbsp;<span class="op" id="3020308">&lt;</span>&nbsp;<span class="ident" id="3020310">pos</span>&nbsp;<span class="op" id="3020314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020319">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020334">if</span>&nbsp;<span class="ident" id="3020337">cg</span><span class="op" id="3020339">.</span><span class="ident" id="3020340">End</span><span class="op" id="3020343">(</span><span class="op" id="3020344">)</span>&nbsp;<span class="op" id="3020346">&gt;</span>&nbsp;<span class="ident" id="3020348">end</span>&nbsp;<span class="op" id="3020352">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020357">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3020369">i</span><span class="op" id="3020370">,</span>&nbsp;<span class="ident" id="3020372">last</span>&nbsp;<span class="op" id="3020377">=</span>&nbsp;<span class="ident" id="3020379">j</span><span class="op" id="3020380">,</span>&nbsp;<span class="ident" id="3020382">cg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3020386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3020389">return</span><br>
<span class="lineno">355</span><span class="op" id="3020396">}</span>
</div>
</body>
</html>
