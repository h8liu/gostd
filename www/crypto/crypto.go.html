<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4055046">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4055101">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4055155">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4055206">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4055265">package</span>&nbsp;<span class="ident" id="4055273">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4055281">import</span>&nbsp;<span class="op" id="4055288">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4055291">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4055299">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4055305">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="4055315">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4055318">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="4055398">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="4055410">type</span>&nbsp;<span class="ident" id="4055415">Hash</span>&nbsp;<span class="builtintype" id="4055420">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4055426">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="4055504">func</span>&nbsp;<span class="op" id="4055509">(</span><span class="ident" id="4055510">h</span>&nbsp;<span class="ident" id="4055512">Hash</span><span class="op" id="4055516">)</span>&nbsp;<span class="ident" id="4055518">HashFunc</span><span class="op" id="4055526">(</span><span class="op" id="4055527">)</span>&nbsp;<span class="ident" id="4055529">Hash</span>&nbsp;<span class="op" id="4055534">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055537">return</span>&nbsp;<span class="ident" id="4055544">h</span><br>
<span class="lineno"></span><span class="op" id="4055546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4055549">const</span>&nbsp;<span class="op" id="4055555">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055558">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055568">Hash</span>&nbsp;<span class="op" id="4055573">=</span>&nbsp;<span class="num" id="4055575">1</span>&nbsp;<span class="op" id="4055577">+</span>&nbsp;<span class="ident" id="4055579">iota</span>&nbsp;<span class="comment" id="4055584">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055619">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055645">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055667">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055693">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055716">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055742">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055767">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055793">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055818">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055844">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055869">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055895">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055920">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055946">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055995">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4056021">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056062">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4056088">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056124">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4056150">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056186">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4056212">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056248">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4056274">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056310">maxHash</span><br>
<span class="lineno"></span><span class="op" id="4056318">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4056321">var</span>&nbsp;<span class="ident" id="4056325">digestSizes</span>&nbsp;<span class="op" id="4056337">=</span>&nbsp;<span class="op" id="4056339">[</span><span class="op" id="4056340">]</span><span class="builtintype" id="4056341">uint8</span><span class="op" id="4056346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056349">MD4</span><span class="op" id="4056352">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4056360">16</span><span class="op" id="4056362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056365">MD5</span><span class="op" id="4056368">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4056376">16</span><span class="op" id="4056378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056381">SHA1</span><span class="op" id="4056385">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4056392">20</span><span class="op" id="4056394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056397">SHA224</span><span class="op" id="4056403">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4056408">28</span><span class="op" id="4056410">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056413">SHA256</span><span class="op" id="4056419">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4056424">32</span><span class="op" id="4056426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056429">SHA384</span><span class="op" id="4056435">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4056440">48</span><span class="op" id="4056442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056445">SHA512</span><span class="op" id="4056451">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4056456">64</span><span class="op" id="4056458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056461">SHA3_224</span><span class="op" id="4056469">:</span>&nbsp;&nbsp;<span class="num" id="4056472">28</span><span class="op" id="4056474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056477">SHA3_256</span><span class="op" id="4056485">:</span>&nbsp;&nbsp;<span class="num" id="4056488">32</span><span class="op" id="4056490">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056493">SHA3_384</span><span class="op" id="4056501">:</span>&nbsp;&nbsp;<span class="num" id="4056504">48</span><span class="op" id="4056506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056509">SHA3_512</span><span class="op" id="4056517">:</span>&nbsp;&nbsp;<span class="num" id="4056520">64</span><span class="op" id="4056522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056525">MD5SHA1</span><span class="op" id="4056532">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="4056536">36</span><span class="op" id="4056538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056541">RIPEMD160</span><span class="op" id="4056550">:</span>&nbsp;<span class="num" id="4056552">20</span><span class="op" id="4056554">,</span><br>
<span class="lineno"></span><span class="op" id="4056556">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4056559">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4056639">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="4056716">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="4056737">func</span>&nbsp;<span class="op" id="4056742">(</span><span class="ident" id="4056743">h</span>&nbsp;<span class="ident" id="4056745">Hash</span><span class="op" id="4056749">)</span>&nbsp;<span class="ident" id="4056751">Size</span><span class="op" id="4056755">(</span><span class="op" id="4056756">)</span>&nbsp;<span class="builtintype" id="4056758">int</span>&nbsp;<span class="op" id="4056762">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056765">if</span>&nbsp;<span class="ident" id="4056768">h</span>&nbsp;<span class="op" id="4056770">&gt;</span>&nbsp;<span class="num" id="4056772">0</span>&nbsp;<span class="op" id="4056774">&amp;&amp;</span>&nbsp;<span class="ident" id="4056777">h</span>&nbsp;<span class="op" id="4056779">&lt;</span>&nbsp;<span class="ident" id="4056781">maxHash</span>&nbsp;<span class="op" id="4056789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056793">return</span>&nbsp;<span class="builtintype" id="4056800">int</span><span class="op" id="4056803">(</span><span class="ident" id="4056804">digestSizes</span><span class="op" id="4056815">[</span><span class="ident" id="4056816">h</span><span class="op" id="4056817">]</span><span class="op" id="4056818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4056824">panic</span><span class="op" id="4056829">(</span><span class="string" id="4056830">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4056869">)</span><br>
<span class="lineno"></span><span class="op" id="4056871">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4056874">var</span>&nbsp;<span class="ident" id="4056878">hashes</span>&nbsp;<span class="op" id="4056885">=</span>&nbsp;<span class="builtinfunc" id="4056887">make</span><span class="op" id="4056891">(</span><span class="op" id="4056892">[</span><span class="op" id="4056893">]</span><span class="keyword" id="4056894">func</span><span class="op" id="4056898">(</span><span class="op" id="4056899">)</span>&nbsp;<span class="ident" id="4056901">hash</span><span class="op" id="4056905">.</span><span class="ident" id="4056906">Hash</span><span class="op" id="4056910">,</span>&nbsp;<span class="ident" id="4056912">maxHash</span><span class="op" id="4056919">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4056922">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="4057001">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="4057056">func</span>&nbsp;<span class="op" id="4057061">(</span><span class="ident" id="4057062">h</span>&nbsp;<span class="ident" id="4057064">Hash</span><span class="op" id="4057068">)</span>&nbsp;<span class="ident" id="4057070">New</span><span class="op" id="4057073">(</span><span class="op" id="4057074">)</span>&nbsp;<span class="ident" id="4057076">hash</span><span class="op" id="4057080">.</span><span class="ident" id="4057081">Hash</span>&nbsp;<span class="op" id="4057086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057089">if</span>&nbsp;<span class="ident" id="4057092">h</span>&nbsp;<span class="op" id="4057094">&gt;</span>&nbsp;<span class="num" id="4057096">0</span>&nbsp;<span class="op" id="4057098">&amp;&amp;</span>&nbsp;<span class="ident" id="4057101">h</span>&nbsp;<span class="op" id="4057103">&lt;</span>&nbsp;<span class="ident" id="4057105">maxHash</span>&nbsp;<span class="op" id="4057113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057117">f</span>&nbsp;<span class="op" id="4057119">:=</span>&nbsp;<span class="ident" id="4057122">hashes</span><span class="op" id="4057128">[</span><span class="ident" id="4057129">h</span><span class="op" id="4057130">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057134">if</span>&nbsp;<span class="ident" id="4057137">f</span>&nbsp;<span class="op" id="4057139">!=</span>&nbsp;<span class="ident" id="4057142">nil</span>&nbsp;<span class="op" id="4057146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057151">return</span>&nbsp;<span class="ident" id="4057158">f</span><span class="op" id="4057159">(</span><span class="op" id="4057160">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4057164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4057167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4057170">panic</span><span class="op" id="4057175">(</span><span class="string" id="4057176">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="4057212">+</span>&nbsp;<span class="ident" id="4057214">strconv</span><span class="op" id="4057221">.</span><span class="ident" id="4057222">Itoa</span><span class="op" id="4057226">(</span><span class="builtintype" id="4057227">int</span><span class="op" id="4057230">(</span><span class="ident" id="4057231">h</span><span class="op" id="4057232">)</span><span class="op" id="4057233">)</span>&nbsp;<span class="op" id="4057235">+</span>&nbsp;<span class="string" id="4057237">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="4057254">)</span><br>
<span class="lineno"></span><span class="op" id="4057256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="4057259">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4057339">func</span>&nbsp;<span class="op" id="4057344">(</span><span class="ident" id="4057345">h</span>&nbsp;<span class="ident" id="4057347">Hash</span><span class="op" id="4057351">)</span>&nbsp;<span class="ident" id="4057353">Available</span><span class="op" id="4057362">(</span><span class="op" id="4057363">)</span>&nbsp;<span class="builtintype" id="4057365">bool</span>&nbsp;<span class="op" id="4057370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057373">return</span>&nbsp;<span class="ident" id="4057380">h</span>&nbsp;<span class="op" id="4057382">&lt;</span>&nbsp;<span class="ident" id="4057384">maxHash</span>&nbsp;<span class="op" id="4057392">&amp;&amp;</span>&nbsp;<span class="ident" id="4057395">hashes</span><span class="op" id="4057401">[</span><span class="ident" id="4057402">h</span><span class="op" id="4057403">]</span>&nbsp;<span class="op" id="4057405">!=</span>&nbsp;<span class="ident" id="4057408">nil</span><br>
<span class="lineno"></span><span class="op" id="4057412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4057415">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4057493">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4057567">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="4057610">func</span>&nbsp;<span class="ident" id="4057615">RegisterHash</span><span class="op" id="4057627">(</span><span class="ident" id="4057628">h</span>&nbsp;<span class="ident" id="4057630">Hash</span><span class="op" id="4057634">,</span>&nbsp;<span class="ident" id="4057636">f</span>&nbsp;<span class="keyword" id="4057638">func</span><span class="op" id="4057642">(</span><span class="op" id="4057643">)</span>&nbsp;<span class="ident" id="4057645">hash</span><span class="op" id="4057649">.</span><span class="ident" id="4057650">Hash</span><span class="op" id="4057654">)</span>&nbsp;<span class="op" id="4057656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057659">if</span>&nbsp;<span class="ident" id="4057662">h</span>&nbsp;<span class="op" id="4057664">&gt;=</span>&nbsp;<span class="ident" id="4057667">maxHash</span>&nbsp;<span class="op" id="4057675">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4057679">panic</span><span class="op" id="4057684">(</span><span class="string" id="4057685">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4057732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4057735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057738">hashes</span><span class="op" id="4057744">[</span><span class="ident" id="4057745">h</span><span class="op" id="4057746">]</span>&nbsp;<span class="op" id="4057748">=</span>&nbsp;<span class="ident" id="4057750">f</span><br>
<span class="lineno"></span><span class="op" id="4057752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4057755">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4057824">type</span>&nbsp;<span class="ident" id="4057829">PublicKey</span>&nbsp;<span class="keyword" id="4057839">interface</span><span class="op" id="4057848">{</span><span class="op" id="4057849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4057852">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4057923">type</span>&nbsp;<span class="ident" id="4057928">PrivateKey</span>&nbsp;<span class="keyword" id="4057939">interface</span><span class="op" id="4057948">{</span><span class="op" id="4057949">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4057952">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4058025">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="4058099">type</span>&nbsp;<span class="ident" id="4058104">Signer</span>&nbsp;<span class="keyword" id="4058111">interface</span>&nbsp;<span class="op" id="4058121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058124">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058187">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058204">Public</span><span class="op" id="4058210">(</span><span class="op" id="4058211">)</span>&nbsp;<span class="ident" id="4058213">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058225">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058294">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058363">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058435">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058502">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058506">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058579">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058652">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058720">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058792">Sign</span><span class="op" id="4058796">(</span><span class="ident" id="4058797">rand</span>&nbsp;<span class="ident" id="4058802">io</span><span class="op" id="4058804">.</span><span class="ident" id="4058805">Reader</span><span class="op" id="4058811">,</span>&nbsp;<span class="ident" id="4058813">msg</span>&nbsp;<span class="op" id="4058817">[</span><span class="op" id="4058818">]</span><span class="builtintype" id="4058819">byte</span><span class="op" id="4058823">,</span>&nbsp;<span class="ident" id="4058825">opts</span>&nbsp;<span class="ident" id="4058830">SignerOpts</span><span class="op" id="4058840">)</span>&nbsp;<span class="op" id="4058842">(</span><span class="ident" id="4058843">signature</span>&nbsp;<span class="op" id="4058853">[</span><span class="op" id="4058854">]</span><span class="builtintype" id="4058855">byte</span><span class="op" id="4058859">,</span>&nbsp;<span class="ident" id="4058861">err</span>&nbsp;<span class="builtintype" id="4058865">error</span><span class="op" id="4058870">)</span><br>
<span class="lineno"></span><span class="op" id="4058872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4058875">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="4058933">type</span>&nbsp;<span class="ident" id="4058938">SignerOpts</span>&nbsp;<span class="keyword" id="4058949">interface</span>&nbsp;<span class="op" id="4058959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058962">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059035">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059107">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059129">HashFunc</span><span class="op" id="4059137">(</span><span class="op" id="4059138">)</span>&nbsp;<span class="ident" id="4059140">Hash</span><br>
<span class="lineno"></span><span class="op" id="4059145">}</span>
</div>
</body>
</html>
