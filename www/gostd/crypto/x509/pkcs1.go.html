<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html" class="current">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4047731">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4047786">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4047840">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4047891">package</span>&nbsp;<span class="ident" id="4047899">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4047905">import</span>&nbsp;<span class="op" id="4047912">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4047915">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4047929">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4047946">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4047956">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4047967">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4047970">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="4048059">type</span>&nbsp;<span class="ident" id="4048064">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="4048080">struct</span>&nbsp;<span class="op" id="4048087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048090">Version</span>&nbsp;<span class="builtintype" id="4048098">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048103">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048111">*</span><span class="ident" id="4048112">big</span><span class="op" id="4048115">.</span><span class="ident" id="4048116">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048121">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4048129">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048134">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048142">*</span><span class="ident" id="4048143">big</span><span class="op" id="4048146">.</span><span class="ident" id="4048147">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048152">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048160">*</span><span class="ident" id="4048161">big</span><span class="op" id="4048164">.</span><span class="ident" id="4048165">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048170">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048178">*</span><span class="ident" id="4048179">big</span><span class="op" id="4048182">.</span><span class="ident" id="4048183">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4048188">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048261">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4048266">*</span><span class="ident" id="4048267">big</span><span class="op" id="4048270">.</span><span class="ident" id="4048271">Int</span>&nbsp;<span class="string" id="4048275">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048294">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4048299">*</span><span class="ident" id="4048300">big</span><span class="op" id="4048303">.</span><span class="ident" id="4048304">Int</span>&nbsp;<span class="string" id="4048308">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048327">Qinv</span>&nbsp;<span class="op" id="4048332">*</span><span class="ident" id="4048333">big</span><span class="op" id="4048336">.</span><span class="ident" id="4048337">Int</span>&nbsp;<span class="string" id="4048341">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048361">AdditionalPrimes</span>&nbsp;<span class="op" id="4048378">[</span><span class="op" id="4048379">]</span><span class="ident" id="4048380">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="string" id="4048404">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4048432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4048435">type</span>&nbsp;<span class="ident" id="4048440">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="4048464">struct</span>&nbsp;<span class="op" id="4048471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048474">Prime</span>&nbsp;<span class="op" id="4048480">*</span><span class="ident" id="4048481">big</span><span class="op" id="4048484">.</span><span class="ident" id="4048485">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4048491">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048551">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4048557">*</span><span class="ident" id="4048558">big</span><span class="op" id="4048561">.</span><span class="ident" id="4048562">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048567">Coeff</span>&nbsp;<span class="op" id="4048573">*</span><span class="ident" id="4048574">big</span><span class="op" id="4048577">.</span><span class="ident" id="4048578">Int</span><br>
<span class="lineno"></span><span class="op" id="4048582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4048585">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4048676">func</span>&nbsp;<span class="ident" id="4048681">ParsePKCS1PrivateKey</span><span class="op" id="4048701">(</span><span class="ident" id="4048702">der</span>&nbsp;<span class="op" id="4048706">[</span><span class="op" id="4048707">]</span><span class="builtintype" id="4048708">byte</span><span class="op" id="4048712">)</span>&nbsp;<span class="op" id="4048714">(</span><span class="ident" id="4048715">key</span>&nbsp;<span class="op" id="4048719">*</span><span class="ident" id="4048720">rsa</span><span class="op" id="4048723">.</span><span class="ident" id="4048724">PrivateKey</span><span class="op" id="4048734">,</span>&nbsp;<span class="ident" id="4048736">err</span>&nbsp;<span class="builtintype" id="4048740">error</span><span class="op" id="4048745">)</span>&nbsp;<span class="op" id="4048747">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048750">var</span>&nbsp;<span class="ident" id="4048754">priv</span>&nbsp;<span class="ident" id="4048759">pkcs1PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048776">rest</span><span class="op" id="4048780">,</span>&nbsp;<span class="ident" id="4048782">err</span>&nbsp;<span class="op" id="4048786">:=</span>&nbsp;<span class="ident" id="4048789">asn1</span><span class="op" id="4048793">.</span><span class="ident" id="4048794">Unmarshal</span><span class="op" id="4048803">(</span><span class="ident" id="4048804">der</span><span class="op" id="4048807">,</span>&nbsp;<span class="op" id="4048809">&amp;</span><span class="ident" id="4048810">priv</span><span class="op" id="4048814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048817">if</span>&nbsp;<span class="builtinfunc" id="4048820">len</span><span class="op" id="4048823">(</span><span class="ident" id="4048824">rest</span><span class="op" id="4048828">)</span>&nbsp;<span class="op" id="4048830">&gt;</span>&nbsp;<span class="num" id="4048832">0</span>&nbsp;<span class="op" id="4048834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048838">err</span>&nbsp;<span class="op" id="4048842">=</span>&nbsp;<span class="ident" id="4048844">asn1</span><span class="op" id="4048848">.</span><span class="ident" id="4048849">SyntaxError</span><span class="op" id="4048860">{</span><span class="ident" id="4048861">Msg</span><span class="op" id="4048864">:</span>&nbsp;<span class="string" id="4048866">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4048881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048885">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048896">if</span>&nbsp;<span class="ident" id="4048899">err</span>&nbsp;<span class="op" id="4048903">!=</span>&nbsp;<span class="ident" id="4048906">nil</span>&nbsp;<span class="op" id="4048910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048914">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048926">if</span>&nbsp;<span class="ident" id="4048929">priv</span><span class="op" id="4048933">.</span><span class="ident" id="4048934">Version</span>&nbsp;<span class="op" id="4048942">&gt;</span>&nbsp;<span class="num" id="4048944">1</span>&nbsp;<span class="op" id="4048946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048950">return</span>&nbsp;<span class="ident" id="4048957">nil</span><span class="op" id="4048960">,</span>&nbsp;<span class="ident" id="4048962">errors</span><span class="op" id="4048968">.</span><span class="ident" id="4048969">New</span><span class="op" id="4048972">(</span><span class="string" id="4048973">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="4049012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049019">if</span>&nbsp;<span class="ident" id="4049022">priv</span><span class="op" id="4049026">.</span><span class="ident" id="4049027">N</span><span class="op" id="4049028">.</span><span class="ident" id="4049029">Sign</span><span class="op" id="4049033">(</span><span class="op" id="4049034">)</span>&nbsp;<span class="op" id="4049036">&lt;=</span>&nbsp;<span class="num" id="4049039">0</span>&nbsp;<span class="op" id="4049041">||</span>&nbsp;<span class="ident" id="4049044">priv</span><span class="op" id="4049048">.</span><span class="ident" id="4049049">D</span><span class="op" id="4049050">.</span><span class="ident" id="4049051">Sign</span><span class="op" id="4049055">(</span><span class="op" id="4049056">)</span>&nbsp;<span class="op" id="4049058">&lt;=</span>&nbsp;<span class="num" id="4049061">0</span>&nbsp;<span class="op" id="4049063">||</span>&nbsp;<span class="ident" id="4049066">priv</span><span class="op" id="4049070">.</span><span class="ident" id="4049071">P</span><span class="op" id="4049072">.</span><span class="ident" id="4049073">Sign</span><span class="op" id="4049077">(</span><span class="op" id="4049078">)</span>&nbsp;<span class="op" id="4049080">&lt;=</span>&nbsp;<span class="num" id="4049083">0</span>&nbsp;<span class="op" id="4049085">||</span>&nbsp;<span class="ident" id="4049088">priv</span><span class="op" id="4049092">.</span><span class="ident" id="4049093">Q</span><span class="op" id="4049094">.</span><span class="ident" id="4049095">Sign</span><span class="op" id="4049099">(</span><span class="op" id="4049100">)</span>&nbsp;<span class="op" id="4049102">&lt;=</span>&nbsp;<span class="num" id="4049105">0</span>&nbsp;<span class="op" id="4049107">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049111">return</span>&nbsp;<span class="ident" id="4049118">nil</span><span class="op" id="4049121">,</span>&nbsp;<span class="ident" id="4049123">errors</span><span class="op" id="4049129">.</span><span class="ident" id="4049130">New</span><span class="op" id="4049133">(</span><span class="string" id="4049134">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="4049185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049192">key</span>&nbsp;<span class="op" id="4049196">=</span>&nbsp;<span class="builtinfunc" id="4049198">new</span><span class="op" id="4049201">(</span><span class="ident" id="4049202">rsa</span><span class="op" id="4049205">.</span><span class="ident" id="4049206">PrivateKey</span><span class="op" id="4049216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049219">key</span><span class="op" id="4049222">.</span><span class="ident" id="4049223">PublicKey</span>&nbsp;<span class="op" id="4049233">=</span>&nbsp;<span class="ident" id="4049235">rsa</span><span class="op" id="4049238">.</span><span class="ident" id="4049239">PublicKey</span><span class="op" id="4049248">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049252">E</span><span class="op" id="4049253">:</span>&nbsp;<span class="ident" id="4049255">priv</span><span class="op" id="4049259">.</span><span class="ident" id="4049260">E</span><span class="op" id="4049261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049265">N</span><span class="op" id="4049266">:</span>&nbsp;<span class="ident" id="4049268">priv</span><span class="op" id="4049272">.</span><span class="ident" id="4049273">N</span><span class="op" id="4049274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049281">key</span><span class="op" id="4049284">.</span><span class="ident" id="4049285">D</span>&nbsp;<span class="op" id="4049287">=</span>&nbsp;<span class="ident" id="4049289">priv</span><span class="op" id="4049293">.</span><span class="ident" id="4049294">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049297">key</span><span class="op" id="4049300">.</span><span class="ident" id="4049301">Primes</span>&nbsp;<span class="op" id="4049308">=</span>&nbsp;<span class="builtinfunc" id="4049310">make</span><span class="op" id="4049314">(</span><span class="op" id="4049315">[</span><span class="op" id="4049316">]</span><span class="op" id="4049317">*</span><span class="ident" id="4049318">big</span><span class="op" id="4049321">.</span><span class="ident" id="4049322">Int</span><span class="op" id="4049325">,</span>&nbsp;<span class="num" id="4049327">2</span><span class="op" id="4049328">+</span><span class="builtinfunc" id="4049329">len</span><span class="op" id="4049332">(</span><span class="ident" id="4049333">priv</span><span class="op" id="4049337">.</span><span class="ident" id="4049338">AdditionalPrimes</span><span class="op" id="4049354">)</span><span class="op" id="4049355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049358">key</span><span class="op" id="4049361">.</span><span class="ident" id="4049362">Primes</span><span class="op" id="4049368">[</span><span class="num" id="4049369">0</span><span class="op" id="4049370">]</span>&nbsp;<span class="op" id="4049372">=</span>&nbsp;<span class="ident" id="4049374">priv</span><span class="op" id="4049378">.</span><span class="ident" id="4049379">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049382">key</span><span class="op" id="4049385">.</span><span class="ident" id="4049386">Primes</span><span class="op" id="4049392">[</span><span class="num" id="4049393">1</span><span class="op" id="4049394">]</span>&nbsp;<span class="op" id="4049396">=</span>&nbsp;<span class="ident" id="4049398">priv</span><span class="op" id="4049402">.</span><span class="ident" id="4049403">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049406">for</span>&nbsp;<span class="ident" id="4049410">i</span><span class="op" id="4049411">,</span>&nbsp;<span class="ident" id="4049413">a</span>&nbsp;<span class="op" id="4049415">:=</span>&nbsp;<span class="keyword" id="4049418">range</span>&nbsp;<span class="ident" id="4049424">priv</span><span class="op" id="4049428">.</span><span class="ident" id="4049429">AdditionalPrimes</span>&nbsp;<span class="op" id="4049446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049450">if</span>&nbsp;<span class="ident" id="4049453">a</span><span class="op" id="4049454">.</span><span class="ident" id="4049455">Prime</span><span class="op" id="4049460">.</span><span class="ident" id="4049461">Sign</span><span class="op" id="4049465">(</span><span class="op" id="4049466">)</span>&nbsp;<span class="op" id="4049468">&lt;=</span>&nbsp;<span class="num" id="4049471">0</span>&nbsp;<span class="op" id="4049473">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049478">return</span>&nbsp;<span class="ident" id="4049485">nil</span><span class="op" id="4049488">,</span>&nbsp;<span class="ident" id="4049490">errors</span><span class="op" id="4049496">.</span><span class="ident" id="4049497">New</span><span class="op" id="4049500">(</span><span class="string" id="4049501">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="4049552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049560">key</span><span class="op" id="4049563">.</span><span class="ident" id="4049564">Primes</span><span class="op" id="4049570">[</span><span class="ident" id="4049571">i</span><span class="op" id="4049572">+</span><span class="num" id="4049573">2</span><span class="op" id="4049574">]</span>&nbsp;<span class="op" id="4049576">=</span>&nbsp;<span class="ident" id="4049578">a</span><span class="op" id="4049579">.</span><span class="ident" id="4049580">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4049588">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4049651">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049675">err</span>&nbsp;<span class="op" id="4049679">=</span>&nbsp;<span class="ident" id="4049681">key</span><span class="op" id="4049684">.</span><span class="ident" id="4049685">Validate</span><span class="op" id="4049693">(</span><span class="op" id="4049694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049697">if</span>&nbsp;<span class="ident" id="4049700">err</span>&nbsp;<span class="op" id="4049704">!=</span>&nbsp;<span class="ident" id="4049707">nil</span>&nbsp;<span class="op" id="4049711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049715">return</span>&nbsp;<span class="ident" id="4049722">nil</span><span class="op" id="4049725">,</span>&nbsp;<span class="ident" id="4049727">err</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049735">key</span><span class="op" id="4049738">.</span><span class="ident" id="4049739">Precompute</span><span class="op" id="4049749">(</span><span class="op" id="4049750">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049754">return</span><br>
<span class="lineno"></span><span class="op" id="4049761">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="4049764">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4049840">func</span>&nbsp;<span class="ident" id="4049845">MarshalPKCS1PrivateKey</span><span class="op" id="4049867">(</span><span class="ident" id="4049868">key</span>&nbsp;<span class="op" id="4049872">*</span><span class="ident" id="4049873">rsa</span><span class="op" id="4049876">.</span><span class="ident" id="4049877">PrivateKey</span><span class="op" id="4049887">)</span>&nbsp;<span class="op" id="4049889">[</span><span class="op" id="4049890">]</span><span class="builtintype" id="4049891">byte</span>&nbsp;<span class="op" id="4049896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049899">key</span><span class="op" id="4049902">.</span><span class="ident" id="4049903">Precompute</span><span class="op" id="4049913">(</span><span class="op" id="4049914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049918">version</span>&nbsp;<span class="op" id="4049926">:=</span>&nbsp;<span class="num" id="4049929">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049932">if</span>&nbsp;<span class="builtinfunc" id="4049935">len</span><span class="op" id="4049938">(</span><span class="ident" id="4049939">key</span><span class="op" id="4049942">.</span><span class="ident" id="4049943">Primes</span><span class="op" id="4049949">)</span>&nbsp;<span class="op" id="4049951">&gt;</span>&nbsp;<span class="num" id="4049953">2</span>&nbsp;<span class="op" id="4049955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049959">version</span>&nbsp;<span class="op" id="4049967">=</span>&nbsp;<span class="num" id="4049969">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049976">priv</span>&nbsp;<span class="op" id="4049981">:=</span>&nbsp;<span class="ident" id="4049984">pkcs1PrivateKey</span><span class="op" id="4049999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050003">Version</span><span class="op" id="4050010">:</span>&nbsp;<span class="ident" id="4050012">version</span><span class="op" id="4050019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050023">N</span><span class="op" id="4050024">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050032">key</span><span class="op" id="4050035">.</span><span class="ident" id="4050036">N</span><span class="op" id="4050037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050041">E</span><span class="op" id="4050042">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050050">key</span><span class="op" id="4050053">.</span><span class="ident" id="4050054">PublicKey</span><span class="op" id="4050063">.</span><span class="ident" id="4050064">E</span><span class="op" id="4050065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050069">D</span><span class="op" id="4050070">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050078">key</span><span class="op" id="4050081">.</span><span class="ident" id="4050082">D</span><span class="op" id="4050083">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050087">P</span><span class="op" id="4050088">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050096">key</span><span class="op" id="4050099">.</span><span class="ident" id="4050100">Primes</span><span class="op" id="4050106">[</span><span class="num" id="4050107">0</span><span class="op" id="4050108">]</span><span class="op" id="4050109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050113">Q</span><span class="op" id="4050114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050122">key</span><span class="op" id="4050125">.</span><span class="ident" id="4050126">Primes</span><span class="op" id="4050132">[</span><span class="num" id="4050133">1</span><span class="op" id="4050134">]</span><span class="op" id="4050135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050139">Dp</span><span class="op" id="4050141">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050148">key</span><span class="op" id="4050151">.</span><span class="ident" id="4050152">Precomputed</span><span class="op" id="4050163">.</span><span class="ident" id="4050164">Dp</span><span class="op" id="4050166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050170">Dq</span><span class="op" id="4050172">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050179">key</span><span class="op" id="4050182">.</span><span class="ident" id="4050183">Precomputed</span><span class="op" id="4050194">.</span><span class="ident" id="4050195">Dq</span><span class="op" id="4050197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050201">Qinv</span><span class="op" id="4050205">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050210">key</span><span class="op" id="4050213">.</span><span class="ident" id="4050214">Precomputed</span><span class="op" id="4050225">.</span><span class="ident" id="4050226">Qinv</span><span class="op" id="4050230">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4050233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050237">priv</span><span class="op" id="4050241">.</span><span class="ident" id="4050242">AdditionalPrimes</span>&nbsp;<span class="op" id="4050259">=</span>&nbsp;<span class="builtinfunc" id="4050261">make</span><span class="op" id="4050265">(</span><span class="op" id="4050266">[</span><span class="op" id="4050267">]</span><span class="ident" id="4050268">pkcs1AdditionalRSAPrime</span><span class="op" id="4050291">,</span>&nbsp;<span class="builtinfunc" id="4050293">len</span><span class="op" id="4050296">(</span><span class="ident" id="4050297">key</span><span class="op" id="4050300">.</span><span class="ident" id="4050301">Precomputed</span><span class="op" id="4050312">.</span><span class="ident" id="4050313">CRTValues</span><span class="op" id="4050322">)</span><span class="op" id="4050323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4050326">for</span>&nbsp;<span class="ident" id="4050330">i</span><span class="op" id="4050331">,</span>&nbsp;<span class="ident" id="4050333">values</span>&nbsp;<span class="op" id="4050340">:=</span>&nbsp;<span class="keyword" id="4050343">range</span>&nbsp;<span class="ident" id="4050349">key</span><span class="op" id="4050352">.</span><span class="ident" id="4050353">Precomputed</span><span class="op" id="4050364">.</span><span class="ident" id="4050365">CRTValues</span>&nbsp;<span class="op" id="4050375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050379">priv</span><span class="op" id="4050383">.</span><span class="ident" id="4050384">AdditionalPrimes</span><span class="op" id="4050400">[</span><span class="ident" id="4050401">i</span><span class="op" id="4050402">]</span><span class="op" id="4050403">.</span><span class="ident" id="4050404">Prime</span>&nbsp;<span class="op" id="4050410">=</span>&nbsp;<span class="ident" id="4050412">key</span><span class="op" id="4050415">.</span><span class="ident" id="4050416">Primes</span><span class="op" id="4050422">[</span><span class="num" id="4050423">2</span><span class="op" id="4050424">+</span><span class="ident" id="4050425">i</span><span class="op" id="4050426">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050430">priv</span><span class="op" id="4050434">.</span><span class="ident" id="4050435">AdditionalPrimes</span><span class="op" id="4050451">[</span><span class="ident" id="4050452">i</span><span class="op" id="4050453">]</span><span class="op" id="4050454">.</span><span class="ident" id="4050455">Exp</span>&nbsp;<span class="op" id="4050459">=</span>&nbsp;<span class="ident" id="4050461">values</span><span class="op" id="4050467">.</span><span class="ident" id="4050468">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050474">priv</span><span class="op" id="4050478">.</span><span class="ident" id="4050479">AdditionalPrimes</span><span class="op" id="4050495">[</span><span class="ident" id="4050496">i</span><span class="op" id="4050497">]</span><span class="op" id="4050498">.</span><span class="ident" id="4050499">Coeff</span>&nbsp;<span class="op" id="4050505">=</span>&nbsp;<span class="ident" id="4050507">values</span><span class="op" id="4050513">.</span><span class="ident" id="4050514">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4050521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050525">b</span><span class="op" id="4050526">,</span>&nbsp;<span class="ident" id="4050528">_</span>&nbsp;<span class="op" id="4050530">:=</span>&nbsp;<span class="ident" id="4050533">asn1</span><span class="op" id="4050537">.</span><span class="ident" id="4050538">Marshal</span><span class="op" id="4050545">(</span><span class="ident" id="4050546">priv</span><span class="op" id="4050550">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4050553">return</span>&nbsp;<span class="ident" id="4050560">b</span><br>
<span class="lineno"></span><span class="op" id="4050562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4050565">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4050634">type</span>&nbsp;<span class="ident" id="4050639">rsaPublicKey</span>&nbsp;<span class="keyword" id="4050652">struct</span>&nbsp;<span class="op" id="4050659">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050662">N</span>&nbsp;<span class="op" id="4050664">*</span><span class="ident" id="4050665">big</span><span class="op" id="4050668">.</span><span class="ident" id="4050669">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050674">E</span>&nbsp;<span class="builtintype" id="4050676">int</span><br>
<span class="lineno"></span><span class="op" id="4050680">}</span>
</div>
</body>
</html>
