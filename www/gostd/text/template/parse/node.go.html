<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html" class="current">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4412473">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4412528">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4412582">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4412633">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412650">package</span>&nbsp;<span class="ident" id="4412658">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412665">import</span>&nbsp;<span class="op" id="4412672">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4412675">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4412684">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4412691">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4412702">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4412712">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4412715">var</span>&nbsp;<span class="ident" id="4412719">textFormat</span>&nbsp;<span class="op" id="4412730">=</span>&nbsp;<span class="string" id="4412732">&#34;%s&#34;</span>&nbsp;<span class="comment" id="4412737">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4412793">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="4412862">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="4412922">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4412969">type</span>&nbsp;<span class="ident" id="4412974">Node</span>&nbsp;<span class="keyword" id="4412979">interface</span>&nbsp;<span class="op" id="4412989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412992">Type</span><span class="op" id="4412996">(</span><span class="op" id="4412997">)</span>&nbsp;<span class="ident" id="4412999">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413009">String</span><span class="op" id="4413015">(</span><span class="op" id="4413016">)</span>&nbsp;<span class="builtintype" id="4413018">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4413026">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4413088">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4413154">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413196">Copy</span><span class="op" id="4413200">(</span><span class="op" id="4413201">)</span>&nbsp;<span class="ident" id="4413203">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413209">Position</span><span class="op" id="4413217">(</span><span class="op" id="4413218">)</span>&nbsp;<span class="ident" id="4413220">Pos</span>&nbsp;<span class="comment" id="4413224">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4413289">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4413328">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413401">tree</span><span class="op" id="4413405">(</span><span class="op" id="4413406">)</span>&nbsp;<span class="op" id="4413408">*</span><span class="ident" id="4413409">Tree</span><br>
<span class="lineno"></span><span class="op" id="4413414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4413417">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="4413471">type</span>&nbsp;<span class="ident" id="4413476">NodeType</span>&nbsp;<span class="builtintype" id="4413485">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4413490">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="4413562">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="4413591">type</span>&nbsp;<span class="ident" id="4413596">Pos</span>&nbsp;<span class="builtintype" id="4413600">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4413605">func</span>&nbsp;<span class="op" id="4413610">(</span><span class="ident" id="4413611">p</span>&nbsp;<span class="ident" id="4413613">Pos</span><span class="op" id="4413616">)</span>&nbsp;<span class="ident" id="4413618">Position</span><span class="op" id="4413626">(</span><span class="op" id="4413627">)</span>&nbsp;<span class="ident" id="4413629">Pos</span>&nbsp;<span class="op" id="4413633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413636">return</span>&nbsp;<span class="ident" id="4413643">p</span><br>
<span class="lineno"></span><span class="op" id="4413645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4413648">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="4413715">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4413778">func</span>&nbsp;<span class="op" id="4413783">(</span><span class="ident" id="4413784">t</span>&nbsp;<span class="ident" id="4413786">NodeType</span><span class="op" id="4413794">)</span>&nbsp;<span class="ident" id="4413796">Type</span><span class="op" id="4413800">(</span><span class="op" id="4413801">)</span>&nbsp;<span class="ident" id="4413803">NodeType</span>&nbsp;<span class="op" id="4413812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413815">return</span>&nbsp;<span class="ident" id="4413822">t</span><br>
<span class="lineno"></span><span class="op" id="4413824">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4413827">const</span>&nbsp;<span class="op" id="4413833">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413836">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413851">NodeType</span>&nbsp;<span class="op" id="4413860">=</span>&nbsp;<span class="ident" id="4413862">iota</span>&nbsp;<span class="comment" id="4413867">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413883">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4413914">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413967">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4413998">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414022">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414053">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414087">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414118">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414148">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414179">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414200">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414231">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414270">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414301">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414339">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414370">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414398">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414429">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414472">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414503">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414521">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414552">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414573">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414604">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414633">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414664">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414690">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414721">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414749">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414780">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414800">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414831">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414854">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414885">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414919">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414950">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414968">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414999">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="4415017">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4415020">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="4415031">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4415070">type</span>&nbsp;<span class="ident" id="4415075">ListNode</span>&nbsp;<span class="keyword" id="4415084">struct</span>&nbsp;<span class="op" id="4415091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415094">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415104">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415109">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415115">*</span><span class="ident" id="4415116">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415122">Nodes</span>&nbsp;<span class="op" id="4415128">[</span><span class="op" id="4415129">]</span><span class="ident" id="4415130">Node</span>&nbsp;<span class="comment" id="4415135">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4415174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4415177">func</span>&nbsp;<span class="op" id="4415182">(</span><span class="ident" id="4415183">t</span>&nbsp;<span class="op" id="4415185">*</span><span class="ident" id="4415186">Tree</span><span class="op" id="4415190">)</span>&nbsp;<span class="ident" id="4415192">newList</span><span class="op" id="4415199">(</span><span class="ident" id="4415200">pos</span>&nbsp;<span class="ident" id="4415204">Pos</span><span class="op" id="4415207">)</span>&nbsp;<span class="op" id="4415209">*</span><span class="ident" id="4415210">ListNode</span>&nbsp;<span class="op" id="4415219">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415222">return</span>&nbsp;<span class="op" id="4415229">&amp;</span><span class="ident" id="4415230">ListNode</span><span class="op" id="4415238">{</span><span class="ident" id="4415239">tr</span><span class="op" id="4415241">:</span>&nbsp;<span class="ident" id="4415243">t</span><span class="op" id="4415244">,</span>&nbsp;<span class="ident" id="4415246">NodeType</span><span class="op" id="4415254">:</span>&nbsp;<span class="ident" id="4415256">NodeList</span><span class="op" id="4415264">,</span>&nbsp;<span class="ident" id="4415266">Pos</span><span class="op" id="4415269">:</span>&nbsp;<span class="ident" id="4415271">pos</span><span class="op" id="4415274">}</span><br>
<span class="lineno"></span><span class="op" id="4415276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4415279">func</span>&nbsp;<span class="op" id="4415284">(</span><span class="ident" id="4415285">l</span>&nbsp;<span class="op" id="4415287">*</span><span class="ident" id="4415288">ListNode</span><span class="op" id="4415296">)</span>&nbsp;<span class="builtinfunc" id="4415298">append</span><span class="op" id="4415304">(</span><span class="ident" id="4415305">n</span>&nbsp;<span class="ident" id="4415307">Node</span><span class="op" id="4415311">)</span>&nbsp;<span class="op" id="4415313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415316">l</span><span class="op" id="4415317">.</span><span class="ident" id="4415318">Nodes</span>&nbsp;<span class="op" id="4415324">=</span>&nbsp;<span class="builtinfunc" id="4415326">append</span><span class="op" id="4415332">(</span><span class="ident" id="4415333">l</span><span class="op" id="4415334">.</span><span class="ident" id="4415335">Nodes</span><span class="op" id="4415340">,</span>&nbsp;<span class="ident" id="4415342">n</span><span class="op" id="4415343">)</span><br>
<span class="lineno">90</span><span class="op" id="4415345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4415348">func</span>&nbsp;<span class="op" id="4415353">(</span><span class="ident" id="4415354">l</span>&nbsp;<span class="op" id="4415356">*</span><span class="ident" id="4415357">ListNode</span><span class="op" id="4415365">)</span>&nbsp;<span class="ident" id="4415367">tree</span><span class="op" id="4415371">(</span><span class="op" id="4415372">)</span>&nbsp;<span class="op" id="4415374">*</span><span class="ident" id="4415375">Tree</span>&nbsp;<span class="op" id="4415380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415383">return</span>&nbsp;<span class="ident" id="4415390">l</span><span class="op" id="4415391">.</span><span class="ident" id="4415392">tr</span><br>
<span class="lineno"></span><span class="op" id="4415395">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4415398">func</span>&nbsp;<span class="op" id="4415403">(</span><span class="ident" id="4415404">l</span>&nbsp;<span class="op" id="4415406">*</span><span class="ident" id="4415407">ListNode</span><span class="op" id="4415415">)</span>&nbsp;<span class="ident" id="4415417">String</span><span class="op" id="4415423">(</span><span class="op" id="4415424">)</span>&nbsp;<span class="builtintype" id="4415426">string</span>&nbsp;<span class="op" id="4415433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415436">b</span>&nbsp;<span class="op" id="4415438">:=</span>&nbsp;<span class="builtinfunc" id="4415441">new</span><span class="op" id="4415444">(</span><span class="ident" id="4415445">bytes</span><span class="op" id="4415450">.</span><span class="ident" id="4415451">Buffer</span><span class="op" id="4415457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415460">for</span>&nbsp;<span class="ident" id="4415464">_</span><span class="op" id="4415465">,</span>&nbsp;<span class="ident" id="4415467">n</span>&nbsp;<span class="op" id="4415469">:=</span>&nbsp;<span class="keyword" id="4415472">range</span>&nbsp;<span class="ident" id="4415478">l</span><span class="op" id="4415479">.</span><span class="ident" id="4415480">Nodes</span>&nbsp;<span class="op" id="4415486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415490">fmt</span><span class="op" id="4415493">.</span><span class="ident" id="4415494">Fprint</span><span class="op" id="4415500">(</span><span class="ident" id="4415501">b</span><span class="op" id="4415502">,</span>&nbsp;<span class="ident" id="4415504">n</span><span class="op" id="4415505">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415511">return</span>&nbsp;<span class="ident" id="4415518">b</span><span class="op" id="4415519">.</span><span class="ident" id="4415520">String</span><span class="op" id="4415526">(</span><span class="op" id="4415527">)</span><br>
<span class="lineno"></span><span class="op" id="4415529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4415532">func</span>&nbsp;<span class="op" id="4415537">(</span><span class="ident" id="4415538">l</span>&nbsp;<span class="op" id="4415540">*</span><span class="ident" id="4415541">ListNode</span><span class="op" id="4415549">)</span>&nbsp;<span class="ident" id="4415551">CopyList</span><span class="op" id="4415559">(</span><span class="op" id="4415560">)</span>&nbsp;<span class="op" id="4415562">*</span><span class="ident" id="4415563">ListNode</span>&nbsp;<span class="op" id="4415572">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415575">if</span>&nbsp;<span class="ident" id="4415578">l</span>&nbsp;<span class="op" id="4415580">==</span>&nbsp;<span class="builtintype" id="4415583">nil</span>&nbsp;<span class="op" id="4415587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415591">return</span>&nbsp;<span class="ident" id="4415598">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415604">n</span>&nbsp;<span class="op" id="4415606">:=</span>&nbsp;<span class="ident" id="4415609">l</span><span class="op" id="4415610">.</span><span class="ident" id="4415611">tr</span><span class="op" id="4415613">.</span><span class="ident" id="4415614">newList</span><span class="op" id="4415621">(</span><span class="ident" id="4415622">l</span><span class="op" id="4415623">.</span><span class="ident" id="4415624">Pos</span><span class="op" id="4415627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415630">for</span>&nbsp;<span class="ident" id="4415634">_</span><span class="op" id="4415635">,</span>&nbsp;<span class="ident" id="4415637">elem</span>&nbsp;<span class="op" id="4415642">:=</span>&nbsp;<span class="keyword" id="4415645">range</span>&nbsp;<span class="ident" id="4415651">l</span><span class="op" id="4415652">.</span><span class="ident" id="4415653">Nodes</span>&nbsp;<span class="op" id="4415659">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415663">n</span><span class="op" id="4415664">.</span><span class="builtinfunc" id="4415665">append</span><span class="op" id="4415671">(</span><span class="ident" id="4415672">elem</span><span class="op" id="4415676">.</span><span class="ident" id="4415677">Copy</span><span class="op" id="4415681">(</span><span class="op" id="4415682">)</span><span class="op" id="4415683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415689">return</span>&nbsp;<span class="ident" id="4415696">n</span><br>
<span class="lineno"></span><span class="op" id="4415698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4415701">func</span>&nbsp;<span class="op" id="4415706">(</span><span class="ident" id="4415707">l</span>&nbsp;<span class="op" id="4415709">*</span><span class="ident" id="4415710">ListNode</span><span class="op" id="4415718">)</span>&nbsp;<span class="ident" id="4415720">Copy</span><span class="op" id="4415724">(</span><span class="op" id="4415725">)</span>&nbsp;<span class="ident" id="4415727">Node</span>&nbsp;<span class="op" id="4415732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415735">return</span>&nbsp;<span class="ident" id="4415742">l</span><span class="op" id="4415743">.</span><span class="ident" id="4415744">CopyList</span><span class="op" id="4415752">(</span><span class="op" id="4415753">)</span><br>
<span class="lineno"></span><span class="op" id="4415755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4415758">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="4415788">type</span>&nbsp;<span class="ident" id="4415793">TextNode</span>&nbsp;<span class="keyword" id="4415802">struct</span>&nbsp;<span class="op" id="4415809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415812">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415822">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415827">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4415832">*</span><span class="ident" id="4415833">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415839">Text</span>&nbsp;<span class="op" id="4415844">[</span><span class="op" id="4415845">]</span><span class="builtintype" id="4415846">byte</span>&nbsp;<span class="comment" id="4415851">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="4415883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4415886">func</span>&nbsp;<span class="op" id="4415891">(</span><span class="ident" id="4415892">t</span>&nbsp;<span class="op" id="4415894">*</span><span class="ident" id="4415895">Tree</span><span class="op" id="4415899">)</span>&nbsp;<span class="ident" id="4415901">newText</span><span class="op" id="4415908">(</span><span class="ident" id="4415909">pos</span>&nbsp;<span class="ident" id="4415913">Pos</span><span class="op" id="4415916">,</span>&nbsp;<span class="ident" id="4415918">text</span>&nbsp;<span class="builtintype" id="4415923">string</span><span class="op" id="4415929">)</span>&nbsp;<span class="op" id="4415931">*</span><span class="ident" id="4415932">TextNode</span>&nbsp;<span class="op" id="4415941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415944">return</span>&nbsp;<span class="op" id="4415951">&amp;</span><span class="ident" id="4415952">TextNode</span><span class="op" id="4415960">{</span><span class="ident" id="4415961">tr</span><span class="op" id="4415963">:</span>&nbsp;<span class="ident" id="4415965">t</span><span class="op" id="4415966">,</span>&nbsp;<span class="ident" id="4415968">NodeType</span><span class="op" id="4415976">:</span>&nbsp;<span class="ident" id="4415978">NodeText</span><span class="op" id="4415986">,</span>&nbsp;<span class="ident" id="4415988">Pos</span><span class="op" id="4415991">:</span>&nbsp;<span class="ident" id="4415993">pos</span><span class="op" id="4415996">,</span>&nbsp;<span class="ident" id="4415998">Text</span><span class="op" id="4416002">:</span>&nbsp;<span class="op" id="4416004">[</span><span class="op" id="4416005">]</span><span class="builtintype" id="4416006">byte</span><span class="op" id="4416010">(</span><span class="ident" id="4416011">text</span><span class="op" id="4416015">)</span><span class="op" id="4416016">}</span><br>
<span class="lineno"></span><span class="op" id="4416018">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="4416021">func</span>&nbsp;<span class="op" id="4416026">(</span><span class="ident" id="4416027">t</span>&nbsp;<span class="op" id="4416029">*</span><span class="ident" id="4416030">TextNode</span><span class="op" id="4416038">)</span>&nbsp;<span class="ident" id="4416040">String</span><span class="op" id="4416046">(</span><span class="op" id="4416047">)</span>&nbsp;<span class="builtintype" id="4416049">string</span>&nbsp;<span class="op" id="4416056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416059">return</span>&nbsp;<span class="ident" id="4416066">fmt</span><span class="op" id="4416069">.</span><span class="ident" id="4416070">Sprintf</span><span class="op" id="4416077">(</span><span class="ident" id="4416078">textFormat</span><span class="op" id="4416088">,</span>&nbsp;<span class="ident" id="4416090">t</span><span class="op" id="4416091">.</span><span class="ident" id="4416092">Text</span><span class="op" id="4416096">)</span><br>
<span class="lineno"></span><span class="op" id="4416098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="4416101">func</span>&nbsp;<span class="op" id="4416106">(</span><span class="ident" id="4416107">t</span>&nbsp;<span class="op" id="4416109">*</span><span class="ident" id="4416110">TextNode</span><span class="op" id="4416118">)</span>&nbsp;<span class="ident" id="4416120">tree</span><span class="op" id="4416124">(</span><span class="op" id="4416125">)</span>&nbsp;<span class="op" id="4416127">*</span><span class="ident" id="4416128">Tree</span>&nbsp;<span class="op" id="4416133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416136">return</span>&nbsp;<span class="ident" id="4416143">t</span><span class="op" id="4416144">.</span><span class="ident" id="4416145">tr</span><br>
<span class="lineno"></span><span class="op" id="4416148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4416151">func</span>&nbsp;<span class="op" id="4416156">(</span><span class="ident" id="4416157">t</span>&nbsp;<span class="op" id="4416159">*</span><span class="ident" id="4416160">TextNode</span><span class="op" id="4416168">)</span>&nbsp;<span class="ident" id="4416170">Copy</span><span class="op" id="4416174">(</span><span class="op" id="4416175">)</span>&nbsp;<span class="ident" id="4416177">Node</span>&nbsp;<span class="op" id="4416182">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416185">return</span>&nbsp;<span class="op" id="4416192">&amp;</span><span class="ident" id="4416193">TextNode</span><span class="op" id="4416201">{</span><span class="ident" id="4416202">tr</span><span class="op" id="4416204">:</span>&nbsp;<span class="ident" id="4416206">t</span><span class="op" id="4416207">.</span><span class="ident" id="4416208">tr</span><span class="op" id="4416210">,</span>&nbsp;<span class="ident" id="4416212">NodeType</span><span class="op" id="4416220">:</span>&nbsp;<span class="ident" id="4416222">NodeText</span><span class="op" id="4416230">,</span>&nbsp;<span class="ident" id="4416232">Pos</span><span class="op" id="4416235">:</span>&nbsp;<span class="ident" id="4416237">t</span><span class="op" id="4416238">.</span><span class="ident" id="4416239">Pos</span><span class="op" id="4416242">,</span>&nbsp;<span class="ident" id="4416244">Text</span><span class="op" id="4416248">:</span>&nbsp;<span class="builtinfunc" id="4416250">append</span><span class="op" id="4416256">(</span><span class="op" id="4416257">[</span><span class="op" id="4416258">]</span><span class="builtintype" id="4416259">byte</span><span class="op" id="4416263">{</span><span class="op" id="4416264">}</span><span class="op" id="4416265">,</span>&nbsp;<span class="ident" id="4416267">t</span><span class="op" id="4416268">.</span><span class="ident" id="4416269">Text</span><span class="op" id="4416273">...</span><span class="op" id="4416276">)</span><span class="op" id="4416277">}</span><br>
<span class="lineno"></span><span class="op" id="4416279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4416282">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="4416337">type</span>&nbsp;<span class="ident" id="4416342">PipeNode</span>&nbsp;<span class="keyword" id="4416351">struct</span>&nbsp;<span class="op" id="4416358">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416361">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416371">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416376">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4416381">*</span><span class="ident" id="4416382">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416388">Line</span>&nbsp;<span class="builtintype" id="4416393">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416409">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416479">Decl</span>&nbsp;<span class="op" id="4416484">[</span><span class="op" id="4416485">]</span><span class="op" id="4416486">*</span><span class="ident" id="4416487">VariableNode</span>&nbsp;<span class="comment" id="4416500">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416544">Cmds</span>&nbsp;<span class="op" id="4416549">[</span><span class="op" id="4416550">]</span><span class="op" id="4416551">*</span><span class="ident" id="4416552">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="4416565">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4416599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4416602">func</span>&nbsp;<span class="op" id="4416607">(</span><span class="ident" id="4416608">t</span>&nbsp;<span class="op" id="4416610">*</span><span class="ident" id="4416611">Tree</span><span class="op" id="4416615">)</span>&nbsp;<span class="ident" id="4416617">newPipeline</span><span class="op" id="4416628">(</span><span class="ident" id="4416629">pos</span>&nbsp;<span class="ident" id="4416633">Pos</span><span class="op" id="4416636">,</span>&nbsp;<span class="ident" id="4416638">line</span>&nbsp;<span class="builtintype" id="4416643">int</span><span class="op" id="4416646">,</span>&nbsp;<span class="ident" id="4416648">decl</span>&nbsp;<span class="op" id="4416653">[</span><span class="op" id="4416654">]</span><span class="op" id="4416655">*</span><span class="ident" id="4416656">VariableNode</span><span class="op" id="4416668">)</span>&nbsp;<span class="op" id="4416670">*</span><span class="ident" id="4416671">PipeNode</span>&nbsp;<span class="op" id="4416680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416683">return</span>&nbsp;<span class="op" id="4416690">&amp;</span><span class="ident" id="4416691">PipeNode</span><span class="op" id="4416699">{</span><span class="ident" id="4416700">tr</span><span class="op" id="4416702">:</span>&nbsp;<span class="ident" id="4416704">t</span><span class="op" id="4416705">,</span>&nbsp;<span class="ident" id="4416707">NodeType</span><span class="op" id="4416715">:</span>&nbsp;<span class="ident" id="4416717">NodePipe</span><span class="op" id="4416725">,</span>&nbsp;<span class="ident" id="4416727">Pos</span><span class="op" id="4416730">:</span>&nbsp;<span class="ident" id="4416732">pos</span><span class="op" id="4416735">,</span>&nbsp;<span class="ident" id="4416737">Line</span><span class="op" id="4416741">:</span>&nbsp;<span class="ident" id="4416743">line</span><span class="op" id="4416747">,</span>&nbsp;<span class="ident" id="4416749">Decl</span><span class="op" id="4416753">:</span>&nbsp;<span class="ident" id="4416755">decl</span><span class="op" id="4416759">}</span><br>
<span class="lineno">155</span><span class="op" id="4416761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4416764">func</span>&nbsp;<span class="op" id="4416769">(</span><span class="ident" id="4416770">p</span>&nbsp;<span class="op" id="4416772">*</span><span class="ident" id="4416773">PipeNode</span><span class="op" id="4416781">)</span>&nbsp;<span class="builtinfunc" id="4416783">append</span><span class="op" id="4416789">(</span><span class="ident" id="4416790">command</span>&nbsp;<span class="op" id="4416798">*</span><span class="ident" id="4416799">CommandNode</span><span class="op" id="4416810">)</span>&nbsp;<span class="op" id="4416812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416815">p</span><span class="op" id="4416816">.</span><span class="ident" id="4416817">Cmds</span>&nbsp;<span class="op" id="4416822">=</span>&nbsp;<span class="builtinfunc" id="4416824">append</span><span class="op" id="4416830">(</span><span class="ident" id="4416831">p</span><span class="op" id="4416832">.</span><span class="ident" id="4416833">Cmds</span><span class="op" id="4416837">,</span>&nbsp;<span class="ident" id="4416839">command</span><span class="op" id="4416846">)</span><br>
<span class="lineno"></span><span class="op" id="4416848">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="4416851">func</span>&nbsp;<span class="op" id="4416856">(</span><span class="ident" id="4416857">p</span>&nbsp;<span class="op" id="4416859">*</span><span class="ident" id="4416860">PipeNode</span><span class="op" id="4416868">)</span>&nbsp;<span class="ident" id="4416870">String</span><span class="op" id="4416876">(</span><span class="op" id="4416877">)</span>&nbsp;<span class="builtintype" id="4416879">string</span>&nbsp;<span class="op" id="4416886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416889">s</span>&nbsp;<span class="op" id="4416891">:=</span>&nbsp;<span class="string" id="4416894">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416898">if</span>&nbsp;<span class="builtinfunc" id="4416901">len</span><span class="op" id="4416904">(</span><span class="ident" id="4416905">p</span><span class="op" id="4416906">.</span><span class="ident" id="4416907">Decl</span><span class="op" id="4416911">)</span>&nbsp;<span class="op" id="4416913">&gt;</span>&nbsp;<span class="num" id="4416915">0</span>&nbsp;<span class="op" id="4416917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416921">for</span>&nbsp;<span class="ident" id="4416925">i</span><span class="op" id="4416926">,</span>&nbsp;<span class="ident" id="4416928">v</span>&nbsp;<span class="op" id="4416930">:=</span>&nbsp;<span class="keyword" id="4416933">range</span>&nbsp;<span class="ident" id="4416939">p</span><span class="op" id="4416940">.</span><span class="ident" id="4416941">Decl</span>&nbsp;<span class="op" id="4416946">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416951">if</span>&nbsp;<span class="ident" id="4416954">i</span>&nbsp;<span class="op" id="4416956">&gt;</span>&nbsp;<span class="num" id="4416958">0</span>&nbsp;<span class="op" id="4416960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416966">s</span>&nbsp;<span class="op" id="4416968">+=</span>&nbsp;<span class="string" id="4416971">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416984">s</span>&nbsp;<span class="op" id="4416986">+=</span>&nbsp;<span class="ident" id="4416989">v</span><span class="op" id="4416990">.</span><span class="ident" id="4416991">String</span><span class="op" id="4416997">(</span><span class="op" id="4416998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417002">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417006">s</span>&nbsp;<span class="op" id="4417008">+=</span>&nbsp;<span class="string" id="4417011">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417022">for</span>&nbsp;<span class="ident" id="4417026">i</span><span class="op" id="4417027">,</span>&nbsp;<span class="ident" id="4417029">c</span>&nbsp;<span class="op" id="4417031">:=</span>&nbsp;<span class="keyword" id="4417034">range</span>&nbsp;<span class="ident" id="4417040">p</span><span class="op" id="4417041">.</span><span class="ident" id="4417042">Cmds</span>&nbsp;<span class="op" id="4417047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417051">if</span>&nbsp;<span class="ident" id="4417054">i</span>&nbsp;<span class="op" id="4417056">&gt;</span>&nbsp;<span class="num" id="4417058">0</span>&nbsp;<span class="op" id="4417060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417065">s</span>&nbsp;<span class="op" id="4417067">+=</span>&nbsp;<span class="string" id="4417070">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417082">s</span>&nbsp;<span class="op" id="4417084">+=</span>&nbsp;<span class="ident" id="4417087">c</span><span class="op" id="4417088">.</span><span class="ident" id="4417089">String</span><span class="op" id="4417095">(</span><span class="op" id="4417096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417102">return</span>&nbsp;<span class="ident" id="4417109">s</span><br>
<span class="lineno"></span><span class="op" id="4417111">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4417114">func</span>&nbsp;<span class="op" id="4417119">(</span><span class="ident" id="4417120">p</span>&nbsp;<span class="op" id="4417122">*</span><span class="ident" id="4417123">PipeNode</span><span class="op" id="4417131">)</span>&nbsp;<span class="ident" id="4417133">tree</span><span class="op" id="4417137">(</span><span class="op" id="4417138">)</span>&nbsp;<span class="op" id="4417140">*</span><span class="ident" id="4417141">Tree</span>&nbsp;<span class="op" id="4417146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417149">return</span>&nbsp;<span class="ident" id="4417156">p</span><span class="op" id="4417157">.</span><span class="ident" id="4417158">tr</span><br>
<span class="lineno"></span><span class="op" id="4417161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4417164">func</span>&nbsp;<span class="op" id="4417169">(</span><span class="ident" id="4417170">p</span>&nbsp;<span class="op" id="4417172">*</span><span class="ident" id="4417173">PipeNode</span><span class="op" id="4417181">)</span>&nbsp;<span class="ident" id="4417183">CopyPipe</span><span class="op" id="4417191">(</span><span class="op" id="4417192">)</span>&nbsp;<span class="op" id="4417194">*</span><span class="ident" id="4417195">PipeNode</span>&nbsp;<span class="op" id="4417204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417207">if</span>&nbsp;<span class="ident" id="4417210">p</span>&nbsp;<span class="op" id="4417212">==</span>&nbsp;<span class="builtintype" id="4417215">nil</span>&nbsp;<span class="op" id="4417219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417223">return</span>&nbsp;<span class="ident" id="4417230">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417236">var</span>&nbsp;<span class="ident" id="4417240">decl</span>&nbsp;<span class="op" id="4417245">[</span><span class="op" id="4417246">]</span><span class="op" id="4417247">*</span><span class="ident" id="4417248">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417262">for</span>&nbsp;<span class="ident" id="4417266">_</span><span class="op" id="4417267">,</span>&nbsp;<span class="ident" id="4417269">d</span>&nbsp;<span class="op" id="4417271">:=</span>&nbsp;<span class="keyword" id="4417274">range</span>&nbsp;<span class="ident" id="4417280">p</span><span class="op" id="4417281">.</span><span class="ident" id="4417282">Decl</span>&nbsp;<span class="op" id="4417287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417291">decl</span>&nbsp;<span class="op" id="4417296">=</span>&nbsp;<span class="builtinfunc" id="4417298">append</span><span class="op" id="4417304">(</span><span class="ident" id="4417305">decl</span><span class="op" id="4417309">,</span>&nbsp;<span class="ident" id="4417311">d</span><span class="op" id="4417312">.</span><span class="ident" id="4417313">Copy</span><span class="op" id="4417317">(</span><span class="op" id="4417318">)</span><span class="op" id="4417319">.</span><span class="op" id="4417320">(</span><span class="op" id="4417321">*</span><span class="ident" id="4417322">VariableNode</span><span class="op" id="4417334">)</span><span class="op" id="4417335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417341">n</span>&nbsp;<span class="op" id="4417343">:=</span>&nbsp;<span class="ident" id="4417346">p</span><span class="op" id="4417347">.</span><span class="ident" id="4417348">tr</span><span class="op" id="4417350">.</span><span class="ident" id="4417351">newPipeline</span><span class="op" id="4417362">(</span><span class="ident" id="4417363">p</span><span class="op" id="4417364">.</span><span class="ident" id="4417365">Pos</span><span class="op" id="4417368">,</span>&nbsp;<span class="ident" id="4417370">p</span><span class="op" id="4417371">.</span><span class="ident" id="4417372">Line</span><span class="op" id="4417376">,</span>&nbsp;<span class="ident" id="4417378">decl</span><span class="op" id="4417382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417385">for</span>&nbsp;<span class="ident" id="4417389">_</span><span class="op" id="4417390">,</span>&nbsp;<span class="ident" id="4417392">c</span>&nbsp;<span class="op" id="4417394">:=</span>&nbsp;<span class="keyword" id="4417397">range</span>&nbsp;<span class="ident" id="4417403">p</span><span class="op" id="4417404">.</span><span class="ident" id="4417405">Cmds</span>&nbsp;<span class="op" id="4417410">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417414">n</span><span class="op" id="4417415">.</span><span class="builtinfunc" id="4417416">append</span><span class="op" id="4417422">(</span><span class="ident" id="4417423">c</span><span class="op" id="4417424">.</span><span class="ident" id="4417425">Copy</span><span class="op" id="4417429">(</span><span class="op" id="4417430">)</span><span class="op" id="4417431">.</span><span class="op" id="4417432">(</span><span class="op" id="4417433">*</span><span class="ident" id="4417434">CommandNode</span><span class="op" id="4417445">)</span><span class="op" id="4417446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417452">return</span>&nbsp;<span class="ident" id="4417459">n</span><br>
<span class="lineno"></span><span class="op" id="4417461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="4417464">func</span>&nbsp;<span class="op" id="4417469">(</span><span class="ident" id="4417470">p</span>&nbsp;<span class="op" id="4417472">*</span><span class="ident" id="4417473">PipeNode</span><span class="op" id="4417481">)</span>&nbsp;<span class="ident" id="4417483">Copy</span><span class="op" id="4417487">(</span><span class="op" id="4417488">)</span>&nbsp;<span class="ident" id="4417490">Node</span>&nbsp;<span class="op" id="4417495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417498">return</span>&nbsp;<span class="ident" id="4417505">p</span><span class="op" id="4417506">.</span><span class="ident" id="4417507">CopyPipe</span><span class="op" id="4417515">(</span><span class="op" id="4417516">)</span><br>
<span class="lineno"></span><span class="op" id="4417518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4417521">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="4417586">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="4417656">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="4417719">type</span>&nbsp;<span class="ident" id="4417724">ActionNode</span>&nbsp;<span class="keyword" id="4417735">struct</span>&nbsp;<span class="op" id="4417742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417745">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417755">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417760">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4417765">*</span><span class="ident" id="4417766">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417772">Line</span>&nbsp;<span class="builtintype" id="4417777">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4417787">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417857">Pipe</span>&nbsp;<span class="op" id="4417862">*</span><span class="ident" id="4417863">PipeNode</span>&nbsp;<span class="comment" id="4417872">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="4417903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="4417906">func</span>&nbsp;<span class="op" id="4417911">(</span><span class="ident" id="4417912">t</span>&nbsp;<span class="op" id="4417914">*</span><span class="ident" id="4417915">Tree</span><span class="op" id="4417919">)</span>&nbsp;<span class="ident" id="4417921">newAction</span><span class="op" id="4417930">(</span><span class="ident" id="4417931">pos</span>&nbsp;<span class="ident" id="4417935">Pos</span><span class="op" id="4417938">,</span>&nbsp;<span class="ident" id="4417940">line</span>&nbsp;<span class="builtintype" id="4417945">int</span><span class="op" id="4417948">,</span>&nbsp;<span class="ident" id="4417950">pipe</span>&nbsp;<span class="op" id="4417955">*</span><span class="ident" id="4417956">PipeNode</span><span class="op" id="4417964">)</span>&nbsp;<span class="op" id="4417966">*</span><span class="ident" id="4417967">ActionNode</span>&nbsp;<span class="op" id="4417978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417981">return</span>&nbsp;<span class="op" id="4417988">&amp;</span><span class="ident" id="4417989">ActionNode</span><span class="op" id="4417999">{</span><span class="ident" id="4418000">tr</span><span class="op" id="4418002">:</span>&nbsp;<span class="ident" id="4418004">t</span><span class="op" id="4418005">,</span>&nbsp;<span class="ident" id="4418007">NodeType</span><span class="op" id="4418015">:</span>&nbsp;<span class="ident" id="4418017">NodeAction</span><span class="op" id="4418027">,</span>&nbsp;<span class="ident" id="4418029">Pos</span><span class="op" id="4418032">:</span>&nbsp;<span class="ident" id="4418034">pos</span><span class="op" id="4418037">,</span>&nbsp;<span class="ident" id="4418039">Line</span><span class="op" id="4418043">:</span>&nbsp;<span class="ident" id="4418045">line</span><span class="op" id="4418049">,</span>&nbsp;<span class="ident" id="4418051">Pipe</span><span class="op" id="4418055">:</span>&nbsp;<span class="ident" id="4418057">pipe</span><span class="op" id="4418061">}</span><br>
<span class="lineno"></span><span class="op" id="4418063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418066">func</span>&nbsp;<span class="op" id="4418071">(</span><span class="ident" id="4418072">a</span>&nbsp;<span class="op" id="4418074">*</span><span class="ident" id="4418075">ActionNode</span><span class="op" id="4418085">)</span>&nbsp;<span class="ident" id="4418087">String</span><span class="op" id="4418093">(</span><span class="op" id="4418094">)</span>&nbsp;<span class="builtintype" id="4418096">string</span>&nbsp;<span class="op" id="4418103">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418106">return</span>&nbsp;<span class="ident" id="4418113">fmt</span><span class="op" id="4418116">.</span><span class="ident" id="4418117">Sprintf</span><span class="op" id="4418124">(</span><span class="string" id="4418125">&#34;{{%s}}&#34;</span><span class="op" id="4418133">,</span>&nbsp;<span class="ident" id="4418135">a</span><span class="op" id="4418136">.</span><span class="ident" id="4418137">Pipe</span><span class="op" id="4418141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="4418144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418147">func</span>&nbsp;<span class="op" id="4418152">(</span><span class="ident" id="4418153">a</span>&nbsp;<span class="op" id="4418155">*</span><span class="ident" id="4418156">ActionNode</span><span class="op" id="4418166">)</span>&nbsp;<span class="ident" id="4418168">tree</span><span class="op" id="4418172">(</span><span class="op" id="4418173">)</span>&nbsp;<span class="op" id="4418175">*</span><span class="ident" id="4418176">Tree</span>&nbsp;<span class="op" id="4418181">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418184">return</span>&nbsp;<span class="ident" id="4418191">a</span><span class="op" id="4418192">.</span><span class="ident" id="4418193">tr</span><br>
<span class="lineno"></span><span class="op" id="4418196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418199">func</span>&nbsp;<span class="op" id="4418204">(</span><span class="ident" id="4418205">a</span>&nbsp;<span class="op" id="4418207">*</span><span class="ident" id="4418208">ActionNode</span><span class="op" id="4418218">)</span>&nbsp;<span class="ident" id="4418220">Copy</span><span class="op" id="4418224">(</span><span class="op" id="4418225">)</span>&nbsp;<span class="ident" id="4418227">Node</span>&nbsp;<span class="op" id="4418232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418235">return</span>&nbsp;<span class="ident" id="4418242">a</span><span class="op" id="4418243">.</span><span class="ident" id="4418244">tr</span><span class="op" id="4418246">.</span><span class="ident" id="4418247">newAction</span><span class="op" id="4418256">(</span><span class="ident" id="4418257">a</span><span class="op" id="4418258">.</span><span class="ident" id="4418259">Pos</span><span class="op" id="4418262">,</span>&nbsp;<span class="ident" id="4418264">a</span><span class="op" id="4418265">.</span><span class="ident" id="4418266">Line</span><span class="op" id="4418270">,</span>&nbsp;<span class="ident" id="4418272">a</span><span class="op" id="4418273">.</span><span class="ident" id="4418274">Pipe</span><span class="op" id="4418278">.</span><span class="ident" id="4418279">CopyPipe</span><span class="op" id="4418287">(</span><span class="op" id="4418288">)</span><span class="op" id="4418289">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="4418292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4418295">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="4418368">type</span>&nbsp;<span class="ident" id="4418373">CommandNode</span>&nbsp;<span class="keyword" id="4418385">struct</span>&nbsp;<span class="op" id="4418392">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418395">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418405">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418410">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4418415">*</span><span class="ident" id="4418416">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418422">Args</span>&nbsp;<span class="op" id="4418427">[</span><span class="op" id="4418428">]</span><span class="ident" id="4418429">Node</span>&nbsp;<span class="comment" id="4418434">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="4418497">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="4418500">func</span>&nbsp;<span class="op" id="4418505">(</span><span class="ident" id="4418506">t</span>&nbsp;<span class="op" id="4418508">*</span><span class="ident" id="4418509">Tree</span><span class="op" id="4418513">)</span>&nbsp;<span class="ident" id="4418515">newCommand</span><span class="op" id="4418525">(</span><span class="ident" id="4418526">pos</span>&nbsp;<span class="ident" id="4418530">Pos</span><span class="op" id="4418533">)</span>&nbsp;<span class="op" id="4418535">*</span><span class="ident" id="4418536">CommandNode</span>&nbsp;<span class="op" id="4418548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418551">return</span>&nbsp;<span class="op" id="4418558">&amp;</span><span class="ident" id="4418559">CommandNode</span><span class="op" id="4418570">{</span><span class="ident" id="4418571">tr</span><span class="op" id="4418573">:</span>&nbsp;<span class="ident" id="4418575">t</span><span class="op" id="4418576">,</span>&nbsp;<span class="ident" id="4418578">NodeType</span><span class="op" id="4418586">:</span>&nbsp;<span class="ident" id="4418588">NodeCommand</span><span class="op" id="4418599">,</span>&nbsp;<span class="ident" id="4418601">Pos</span><span class="op" id="4418604">:</span>&nbsp;<span class="ident" id="4418606">pos</span><span class="op" id="4418609">}</span><br>
<span class="lineno"></span><span class="op" id="4418611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="4418614">func</span>&nbsp;<span class="op" id="4418619">(</span><span class="ident" id="4418620">c</span>&nbsp;<span class="op" id="4418622">*</span><span class="ident" id="4418623">CommandNode</span><span class="op" id="4418634">)</span>&nbsp;<span class="builtinfunc" id="4418636">append</span><span class="op" id="4418642">(</span><span class="ident" id="4418643">arg</span>&nbsp;<span class="ident" id="4418647">Node</span><span class="op" id="4418651">)</span>&nbsp;<span class="op" id="4418653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418656">c</span><span class="op" id="4418657">.</span><span class="ident" id="4418658">Args</span>&nbsp;<span class="op" id="4418663">=</span>&nbsp;<span class="builtinfunc" id="4418665">append</span><span class="op" id="4418671">(</span><span class="ident" id="4418672">c</span><span class="op" id="4418673">.</span><span class="ident" id="4418674">Args</span><span class="op" id="4418678">,</span>&nbsp;<span class="ident" id="4418680">arg</span><span class="op" id="4418683">)</span><br>
<span class="lineno"></span><span class="op" id="4418685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418688">func</span>&nbsp;<span class="op" id="4418693">(</span><span class="ident" id="4418694">c</span>&nbsp;<span class="op" id="4418696">*</span><span class="ident" id="4418697">CommandNode</span><span class="op" id="4418708">)</span>&nbsp;<span class="ident" id="4418710">String</span><span class="op" id="4418716">(</span><span class="op" id="4418717">)</span>&nbsp;<span class="builtintype" id="4418719">string</span>&nbsp;<span class="op" id="4418726">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418729">s</span>&nbsp;<span class="op" id="4418731">:=</span>&nbsp;<span class="string" id="4418734">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418738">for</span>&nbsp;<span class="ident" id="4418742">i</span><span class="op" id="4418743">,</span>&nbsp;<span class="ident" id="4418745">arg</span>&nbsp;<span class="op" id="4418749">:=</span>&nbsp;<span class="keyword" id="4418752">range</span>&nbsp;<span class="ident" id="4418758">c</span><span class="op" id="4418759">.</span><span class="ident" id="4418760">Args</span>&nbsp;<span class="op" id="4418765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418769">if</span>&nbsp;<span class="ident" id="4418772">i</span>&nbsp;<span class="op" id="4418774">&gt;</span>&nbsp;<span class="num" id="4418776">0</span>&nbsp;<span class="op" id="4418778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418783">s</span>&nbsp;<span class="op" id="4418785">+=</span>&nbsp;<span class="string" id="4418788">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418794">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418798">if</span>&nbsp;<span class="ident" id="4418801">arg</span><span class="op" id="4418804">,</span>&nbsp;<span class="ident" id="4418806">ok</span>&nbsp;<span class="op" id="4418809">:=</span>&nbsp;<span class="ident" id="4418812">arg</span><span class="op" id="4418815">.</span><span class="op" id="4418816">(</span><span class="op" id="4418817">*</span><span class="ident" id="4418818">PipeNode</span><span class="op" id="4418826">)</span><span class="op" id="4418827">;</span>&nbsp;<span class="ident" id="4418829">ok</span>&nbsp;<span class="op" id="4418832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418837">s</span>&nbsp;<span class="op" id="4418839">+=</span>&nbsp;<span class="string" id="4418842">&#34;(&#34;</span>&nbsp;<span class="op" id="4418846">+</span>&nbsp;<span class="ident" id="4418848">arg</span><span class="op" id="4418851">.</span><span class="ident" id="4418852">String</span><span class="op" id="4418858">(</span><span class="op" id="4418859">)</span>&nbsp;<span class="op" id="4418861">+</span>&nbsp;<span class="string" id="4418863">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418870">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418885">s</span>&nbsp;<span class="op" id="4418887">+=</span>&nbsp;<span class="ident" id="4418890">arg</span><span class="op" id="4418893">.</span><span class="ident" id="4418894">String</span><span class="op" id="4418900">(</span><span class="op" id="4418901">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418907">return</span>&nbsp;<span class="ident" id="4418914">s</span><br>
<span class="lineno"></span><span class="op" id="4418916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418919">func</span>&nbsp;<span class="op" id="4418924">(</span><span class="ident" id="4418925">c</span>&nbsp;<span class="op" id="4418927">*</span><span class="ident" id="4418928">CommandNode</span><span class="op" id="4418939">)</span>&nbsp;<span class="ident" id="4418941">tree</span><span class="op" id="4418945">(</span><span class="op" id="4418946">)</span>&nbsp;<span class="op" id="4418948">*</span><span class="ident" id="4418949">Tree</span>&nbsp;<span class="op" id="4418954">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418957">return</span>&nbsp;<span class="ident" id="4418964">c</span><span class="op" id="4418965">.</span><span class="ident" id="4418966">tr</span><br>
<span class="lineno"></span><span class="op" id="4418969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418972">func</span>&nbsp;<span class="op" id="4418977">(</span><span class="ident" id="4418978">c</span>&nbsp;<span class="op" id="4418980">*</span><span class="ident" id="4418981">CommandNode</span><span class="op" id="4418992">)</span>&nbsp;<span class="ident" id="4418994">Copy</span><span class="op" id="4418998">(</span><span class="op" id="4418999">)</span>&nbsp;<span class="ident" id="4419001">Node</span>&nbsp;<span class="op" id="4419006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419009">if</span>&nbsp;<span class="ident" id="4419012">c</span>&nbsp;<span class="op" id="4419014">==</span>&nbsp;<span class="builtintype" id="4419017">nil</span>&nbsp;<span class="op" id="4419021">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419025">return</span>&nbsp;<span class="ident" id="4419032">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419038">n</span>&nbsp;<span class="op" id="4419040">:=</span>&nbsp;<span class="ident" id="4419043">c</span><span class="op" id="4419044">.</span><span class="ident" id="4419045">tr</span><span class="op" id="4419047">.</span><span class="ident" id="4419048">newCommand</span><span class="op" id="4419058">(</span><span class="ident" id="4419059">c</span><span class="op" id="4419060">.</span><span class="ident" id="4419061">Pos</span><span class="op" id="4419064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419067">for</span>&nbsp;<span class="ident" id="4419071">_</span><span class="op" id="4419072">,</span>&nbsp;<span class="ident" id="4419074">c</span>&nbsp;<span class="op" id="4419076">:=</span>&nbsp;<span class="keyword" id="4419079">range</span>&nbsp;<span class="ident" id="4419085">c</span><span class="op" id="4419086">.</span><span class="ident" id="4419087">Args</span>&nbsp;<span class="op" id="4419092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419096">n</span><span class="op" id="4419097">.</span><span class="builtinfunc" id="4419098">append</span><span class="op" id="4419104">(</span><span class="ident" id="4419105">c</span><span class="op" id="4419106">.</span><span class="ident" id="4419107">Copy</span><span class="op" id="4419111">(</span><span class="op" id="4419112">)</span><span class="op" id="4419113">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419119">return</span>&nbsp;<span class="ident" id="4419126">n</span><br>
<span class="lineno"></span><span class="op" id="4419128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4419131">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="4419170">type</span>&nbsp;<span class="ident" id="4419175">IdentifierNode</span>&nbsp;<span class="keyword" id="4419190">struct</span>&nbsp;<span class="op" id="4419197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419200">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419210">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419215">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419221">*</span><span class="ident" id="4419222">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419228">Ident</span>&nbsp;<span class="builtintype" id="4419234">string</span>&nbsp;<span class="comment" id="4419241">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="4419267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4419270">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4419348">func</span>&nbsp;<span class="ident" id="4419353">NewIdentifier</span><span class="op" id="4419366">(</span><span class="ident" id="4419367">ident</span>&nbsp;<span class="builtintype" id="4419373">string</span><span class="op" id="4419379">)</span>&nbsp;<span class="op" id="4419381">*</span><span class="ident" id="4419382">IdentifierNode</span>&nbsp;<span class="op" id="4419397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419400">return</span>&nbsp;<span class="op" id="4419407">&amp;</span><span class="ident" id="4419408">IdentifierNode</span><span class="op" id="4419422">{</span><span class="ident" id="4419423">NodeType</span><span class="op" id="4419431">:</span>&nbsp;<span class="ident" id="4419433">NodeIdentifier</span><span class="op" id="4419447">,</span>&nbsp;<span class="ident" id="4419449">Ident</span><span class="op" id="4419454">:</span>&nbsp;<span class="ident" id="4419456">ident</span><span class="op" id="4419461">}</span><br>
<span class="lineno">290</span><span class="op" id="4419463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4419466">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4419562">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="4419590">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="4419612">func</span>&nbsp;<span class="op" id="4419617">(</span><span class="ident" id="4419618">i</span>&nbsp;<span class="op" id="4419620">*</span><span class="ident" id="4419621">IdentifierNode</span><span class="op" id="4419635">)</span>&nbsp;<span class="ident" id="4419637">SetPos</span><span class="op" id="4419643">(</span><span class="ident" id="4419644">pos</span>&nbsp;<span class="ident" id="4419648">Pos</span><span class="op" id="4419651">)</span>&nbsp;<span class="op" id="4419653">*</span><span class="ident" id="4419654">IdentifierNode</span>&nbsp;<span class="op" id="4419669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419672">i</span><span class="op" id="4419673">.</span><span class="ident" id="4419674">Pos</span>&nbsp;<span class="op" id="4419678">=</span>&nbsp;<span class="ident" id="4419680">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419685">return</span>&nbsp;<span class="ident" id="4419692">i</span><br>
<span class="lineno"></span><span class="op" id="4419694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="4419697">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4419810">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="4419838">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="4419860">func</span>&nbsp;<span class="op" id="4419865">(</span><span class="ident" id="4419866">i</span>&nbsp;<span class="op" id="4419868">*</span><span class="ident" id="4419869">IdentifierNode</span><span class="op" id="4419883">)</span>&nbsp;<span class="ident" id="4419885">SetTree</span><span class="op" id="4419892">(</span><span class="ident" id="4419893">t</span>&nbsp;<span class="op" id="4419895">*</span><span class="ident" id="4419896">Tree</span><span class="op" id="4419900">)</span>&nbsp;<span class="op" id="4419902">*</span><span class="ident" id="4419903">IdentifierNode</span>&nbsp;<span class="op" id="4419918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419921">i</span><span class="op" id="4419922">.</span><span class="ident" id="4419923">tr</span>&nbsp;<span class="op" id="4419926">=</span>&nbsp;<span class="ident" id="4419928">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419931">return</span>&nbsp;<span class="ident" id="4419938">i</span><br>
<span class="lineno"></span><span class="op" id="4419940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4419943">func</span>&nbsp;<span class="op" id="4419948">(</span><span class="ident" id="4419949">i</span>&nbsp;<span class="op" id="4419951">*</span><span class="ident" id="4419952">IdentifierNode</span><span class="op" id="4419966">)</span>&nbsp;<span class="ident" id="4419968">String</span><span class="op" id="4419974">(</span><span class="op" id="4419975">)</span>&nbsp;<span class="builtintype" id="4419977">string</span>&nbsp;<span class="op" id="4419984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419987">return</span>&nbsp;<span class="ident" id="4419994">i</span><span class="op" id="4419995">.</span><span class="ident" id="4419996">Ident</span><br>
<span class="lineno">310</span><span class="op" id="4420002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4420005">func</span>&nbsp;<span class="op" id="4420010">(</span><span class="ident" id="4420011">i</span>&nbsp;<span class="op" id="4420013">*</span><span class="ident" id="4420014">IdentifierNode</span><span class="op" id="4420028">)</span>&nbsp;<span class="ident" id="4420030">tree</span><span class="op" id="4420034">(</span><span class="op" id="4420035">)</span>&nbsp;<span class="op" id="4420037">*</span><span class="ident" id="4420038">Tree</span>&nbsp;<span class="op" id="4420043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420046">return</span>&nbsp;<span class="ident" id="4420053">i</span><span class="op" id="4420054">.</span><span class="ident" id="4420055">tr</span><br>
<span class="lineno"></span><span class="op" id="4420058">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="4420061">func</span>&nbsp;<span class="op" id="4420066">(</span><span class="ident" id="4420067">i</span>&nbsp;<span class="op" id="4420069">*</span><span class="ident" id="4420070">IdentifierNode</span><span class="op" id="4420084">)</span>&nbsp;<span class="ident" id="4420086">Copy</span><span class="op" id="4420090">(</span><span class="op" id="4420091">)</span>&nbsp;<span class="ident" id="4420093">Node</span>&nbsp;<span class="op" id="4420098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420101">return</span>&nbsp;<span class="ident" id="4420108">NewIdentifier</span><span class="op" id="4420121">(</span><span class="ident" id="4420122">i</span><span class="op" id="4420123">.</span><span class="ident" id="4420124">Ident</span><span class="op" id="4420129">)</span><span class="op" id="4420130">.</span><span class="ident" id="4420131">SetTree</span><span class="op" id="4420138">(</span><span class="ident" id="4420139">i</span><span class="op" id="4420140">.</span><span class="ident" id="4420141">tr</span><span class="op" id="4420143">)</span><span class="op" id="4420144">.</span><span class="ident" id="4420145">SetPos</span><span class="op" id="4420151">(</span><span class="ident" id="4420152">i</span><span class="op" id="4420153">.</span><span class="ident" id="4420154">Pos</span><span class="op" id="4420157">)</span><br>
<span class="lineno"></span><span class="op" id="4420159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="4420162">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="4420238">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4420296">type</span>&nbsp;<span class="ident" id="4420301">VariableNode</span>&nbsp;<span class="keyword" id="4420314">struct</span>&nbsp;<span class="op" id="4420321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420324">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420334">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420339">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420345">*</span><span class="ident" id="4420346">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420352">Ident</span>&nbsp;<span class="op" id="4420358">[</span><span class="op" id="4420359">]</span><span class="builtintype" id="4420360">string</span>&nbsp;<span class="comment" id="4420367">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4420413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4420416">func</span>&nbsp;<span class="op" id="4420421">(</span><span class="ident" id="4420422">t</span>&nbsp;<span class="op" id="4420424">*</span><span class="ident" id="4420425">Tree</span><span class="op" id="4420429">)</span>&nbsp;<span class="ident" id="4420431">newVariable</span><span class="op" id="4420442">(</span><span class="ident" id="4420443">pos</span>&nbsp;<span class="ident" id="4420447">Pos</span><span class="op" id="4420450">,</span>&nbsp;<span class="ident" id="4420452">ident</span>&nbsp;<span class="builtintype" id="4420458">string</span><span class="op" id="4420464">)</span>&nbsp;<span class="op" id="4420466">*</span><span class="ident" id="4420467">VariableNode</span>&nbsp;<span class="op" id="4420480">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420483">return</span>&nbsp;<span class="op" id="4420490">&amp;</span><span class="ident" id="4420491">VariableNode</span><span class="op" id="4420503">{</span><span class="ident" id="4420504">tr</span><span class="op" id="4420506">:</span>&nbsp;<span class="ident" id="4420508">t</span><span class="op" id="4420509">,</span>&nbsp;<span class="ident" id="4420511">NodeType</span><span class="op" id="4420519">:</span>&nbsp;<span class="ident" id="4420521">NodeVariable</span><span class="op" id="4420533">,</span>&nbsp;<span class="ident" id="4420535">Pos</span><span class="op" id="4420538">:</span>&nbsp;<span class="ident" id="4420540">pos</span><span class="op" id="4420543">,</span>&nbsp;<span class="ident" id="4420545">Ident</span><span class="op" id="4420550">:</span>&nbsp;<span class="ident" id="4420552">strings</span><span class="op" id="4420559">.</span><span class="ident" id="4420560">Split</span><span class="op" id="4420565">(</span><span class="ident" id="4420566">ident</span><span class="op" id="4420571">,</span>&nbsp;<span class="string" id="4420573">&#34;.&#34;</span><span class="op" id="4420576">)</span><span class="op" id="4420577">}</span><br>
<span class="lineno"></span><span class="op" id="4420579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4420582">func</span>&nbsp;<span class="op" id="4420587">(</span><span class="ident" id="4420588">v</span>&nbsp;<span class="op" id="4420590">*</span><span class="ident" id="4420591">VariableNode</span><span class="op" id="4420603">)</span>&nbsp;<span class="ident" id="4420605">String</span><span class="op" id="4420611">(</span><span class="op" id="4420612">)</span>&nbsp;<span class="builtintype" id="4420614">string</span>&nbsp;<span class="op" id="4420621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420624">s</span>&nbsp;<span class="op" id="4420626">:=</span>&nbsp;<span class="string" id="4420629">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420633">for</span>&nbsp;<span class="ident" id="4420637">i</span><span class="op" id="4420638">,</span>&nbsp;<span class="ident" id="4420640">id</span>&nbsp;<span class="op" id="4420643">:=</span>&nbsp;<span class="keyword" id="4420646">range</span>&nbsp;<span class="ident" id="4420652">v</span><span class="op" id="4420653">.</span><span class="ident" id="4420654">Ident</span>&nbsp;<span class="op" id="4420660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420664">if</span>&nbsp;<span class="ident" id="4420667">i</span>&nbsp;<span class="op" id="4420669">&gt;</span>&nbsp;<span class="num" id="4420671">0</span>&nbsp;<span class="op" id="4420673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420678">s</span>&nbsp;<span class="op" id="4420680">+=</span>&nbsp;<span class="string" id="4420683">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420693">s</span>&nbsp;<span class="op" id="4420695">+=</span>&nbsp;<span class="ident" id="4420698">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420705">return</span>&nbsp;<span class="ident" id="4420712">s</span><br>
<span class="lineno"></span><span class="op" id="4420714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4420717">func</span>&nbsp;<span class="op" id="4420722">(</span><span class="ident" id="4420723">v</span>&nbsp;<span class="op" id="4420725">*</span><span class="ident" id="4420726">VariableNode</span><span class="op" id="4420738">)</span>&nbsp;<span class="ident" id="4420740">tree</span><span class="op" id="4420744">(</span><span class="op" id="4420745">)</span>&nbsp;<span class="op" id="4420747">*</span><span class="ident" id="4420748">Tree</span>&nbsp;<span class="op" id="4420753">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420756">return</span>&nbsp;<span class="ident" id="4420763">v</span><span class="op" id="4420764">.</span><span class="ident" id="4420765">tr</span><br>
<span class="lineno"></span><span class="op" id="4420768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4420771">func</span>&nbsp;<span class="op" id="4420776">(</span><span class="ident" id="4420777">v</span>&nbsp;<span class="op" id="4420779">*</span><span class="ident" id="4420780">VariableNode</span><span class="op" id="4420792">)</span>&nbsp;<span class="ident" id="4420794">Copy</span><span class="op" id="4420798">(</span><span class="op" id="4420799">)</span>&nbsp;<span class="ident" id="4420801">Node</span>&nbsp;<span class="op" id="4420806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420809">return</span>&nbsp;<span class="op" id="4420816">&amp;</span><span class="ident" id="4420817">VariableNode</span><span class="op" id="4420829">{</span><span class="ident" id="4420830">tr</span><span class="op" id="4420832">:</span>&nbsp;<span class="ident" id="4420834">v</span><span class="op" id="4420835">.</span><span class="ident" id="4420836">tr</span><span class="op" id="4420838">,</span>&nbsp;<span class="ident" id="4420840">NodeType</span><span class="op" id="4420848">:</span>&nbsp;<span class="ident" id="4420850">NodeVariable</span><span class="op" id="4420862">,</span>&nbsp;<span class="ident" id="4420864">Pos</span><span class="op" id="4420867">:</span>&nbsp;<span class="ident" id="4420869">v</span><span class="op" id="4420870">.</span><span class="ident" id="4420871">Pos</span><span class="op" id="4420874">,</span>&nbsp;<span class="ident" id="4420876">Ident</span><span class="op" id="4420881">:</span>&nbsp;<span class="builtinfunc" id="4420883">append</span><span class="op" id="4420889">(</span><span class="op" id="4420890">[</span><span class="op" id="4420891">]</span><span class="builtintype" id="4420892">string</span><span class="op" id="4420898">{</span><span class="op" id="4420899">}</span><span class="op" id="4420900">,</span>&nbsp;<span class="ident" id="4420902">v</span><span class="op" id="4420903">.</span><span class="ident" id="4420904">Ident</span><span class="op" id="4420909">...</span><span class="op" id="4420912">)</span><span class="op" id="4420913">}</span><br>
<span class="lineno">350</span><span class="op" id="4420915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4420918">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="4420963">type</span>&nbsp;<span class="ident" id="4420968">DotNode</span>&nbsp;<span class="keyword" id="4420976">struct</span>&nbsp;<span class="op" id="4420983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420986">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420996">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421001">tr</span>&nbsp;<span class="op" id="4421004">*</span><span class="ident" id="4421005">Tree</span><br>
<span class="lineno"></span><span class="op" id="4421010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4421013">func</span>&nbsp;<span class="op" id="4421018">(</span><span class="ident" id="4421019">t</span>&nbsp;<span class="op" id="4421021">*</span><span class="ident" id="4421022">Tree</span><span class="op" id="4421026">)</span>&nbsp;<span class="ident" id="4421028">newDot</span><span class="op" id="4421034">(</span><span class="ident" id="4421035">pos</span>&nbsp;<span class="ident" id="4421039">Pos</span><span class="op" id="4421042">)</span>&nbsp;<span class="op" id="4421044">*</span><span class="ident" id="4421045">DotNode</span>&nbsp;<span class="op" id="4421053">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421056">return</span>&nbsp;<span class="op" id="4421063">&amp;</span><span class="ident" id="4421064">DotNode</span><span class="op" id="4421071">{</span><span class="ident" id="4421072">tr</span><span class="op" id="4421074">:</span>&nbsp;<span class="ident" id="4421076">t</span><span class="op" id="4421077">,</span>&nbsp;<span class="ident" id="4421079">NodeType</span><span class="op" id="4421087">:</span>&nbsp;<span class="ident" id="4421089">NodeDot</span><span class="op" id="4421096">,</span>&nbsp;<span class="ident" id="4421098">Pos</span><span class="op" id="4421101">:</span>&nbsp;<span class="ident" id="4421103">pos</span><span class="op" id="4421106">}</span><br>
<span class="lineno"></span><span class="op" id="4421108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4421111">func</span>&nbsp;<span class="op" id="4421116">(</span><span class="ident" id="4421117">d</span>&nbsp;<span class="op" id="4421119">*</span><span class="ident" id="4421120">DotNode</span><span class="op" id="4421127">)</span>&nbsp;<span class="ident" id="4421129">Type</span><span class="op" id="4421133">(</span><span class="op" id="4421134">)</span>&nbsp;<span class="ident" id="4421136">NodeType</span>&nbsp;<span class="op" id="4421145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4421148">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4421212">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4421280">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421304">return</span>&nbsp;<span class="ident" id="4421311">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="4421319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="4421322">func</span>&nbsp;<span class="op" id="4421327">(</span><span class="ident" id="4421328">d</span>&nbsp;<span class="op" id="4421330">*</span><span class="ident" id="4421331">DotNode</span><span class="op" id="4421338">)</span>&nbsp;<span class="ident" id="4421340">String</span><span class="op" id="4421346">(</span><span class="op" id="4421347">)</span>&nbsp;<span class="builtintype" id="4421349">string</span>&nbsp;<span class="op" id="4421356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421359">return</span>&nbsp;<span class="string" id="4421366">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="4421370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4421373">func</span>&nbsp;<span class="op" id="4421378">(</span><span class="ident" id="4421379">d</span>&nbsp;<span class="op" id="4421381">*</span><span class="ident" id="4421382">DotNode</span><span class="op" id="4421389">)</span>&nbsp;<span class="ident" id="4421391">tree</span><span class="op" id="4421395">(</span><span class="op" id="4421396">)</span>&nbsp;<span class="op" id="4421398">*</span><span class="ident" id="4421399">Tree</span>&nbsp;<span class="op" id="4421404">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421407">return</span>&nbsp;<span class="ident" id="4421414">d</span><span class="op" id="4421415">.</span><span class="ident" id="4421416">tr</span><br>
<span class="lineno"></span><span class="op" id="4421419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4421422">func</span>&nbsp;<span class="op" id="4421427">(</span><span class="ident" id="4421428">d</span>&nbsp;<span class="op" id="4421430">*</span><span class="ident" id="4421431">DotNode</span><span class="op" id="4421438">)</span>&nbsp;<span class="ident" id="4421440">Copy</span><span class="op" id="4421444">(</span><span class="op" id="4421445">)</span>&nbsp;<span class="ident" id="4421447">Node</span>&nbsp;<span class="op" id="4421452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421455">return</span>&nbsp;<span class="ident" id="4421462">d</span><span class="op" id="4421463">.</span><span class="ident" id="4421464">tr</span><span class="op" id="4421466">.</span><span class="ident" id="4421467">newDot</span><span class="op" id="4421473">(</span><span class="ident" id="4421474">d</span><span class="op" id="4421475">.</span><span class="ident" id="4421476">Pos</span><span class="op" id="4421479">)</span><br>
<span class="lineno">380</span><span class="op" id="4421481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4421484">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="4421568">type</span>&nbsp;<span class="ident" id="4421573">NilNode</span>&nbsp;<span class="keyword" id="4421581">struct</span>&nbsp;<span class="op" id="4421588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421591">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421601">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421606">tr</span>&nbsp;<span class="op" id="4421609">*</span><span class="ident" id="4421610">Tree</span><br>
<span class="lineno"></span><span class="op" id="4421615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4421618">func</span>&nbsp;<span class="op" id="4421623">(</span><span class="ident" id="4421624">t</span>&nbsp;<span class="op" id="4421626">*</span><span class="ident" id="4421627">Tree</span><span class="op" id="4421631">)</span>&nbsp;<span class="ident" id="4421633">newNil</span><span class="op" id="4421639">(</span><span class="ident" id="4421640">pos</span>&nbsp;<span class="ident" id="4421644">Pos</span><span class="op" id="4421647">)</span>&nbsp;<span class="op" id="4421649">*</span><span class="ident" id="4421650">NilNode</span>&nbsp;<span class="op" id="4421658">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421661">return</span>&nbsp;<span class="op" id="4421668">&amp;</span><span class="ident" id="4421669">NilNode</span><span class="op" id="4421676">{</span><span class="ident" id="4421677">tr</span><span class="op" id="4421679">:</span>&nbsp;<span class="ident" id="4421681">t</span><span class="op" id="4421682">,</span>&nbsp;<span class="ident" id="4421684">NodeType</span><span class="op" id="4421692">:</span>&nbsp;<span class="ident" id="4421694">NodeNil</span><span class="op" id="4421701">,</span>&nbsp;<span class="ident" id="4421703">Pos</span><span class="op" id="4421706">:</span>&nbsp;<span class="ident" id="4421708">pos</span><span class="op" id="4421711">}</span><br>
<span class="lineno"></span><span class="op" id="4421713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4421716">func</span>&nbsp;<span class="op" id="4421721">(</span><span class="ident" id="4421722">n</span>&nbsp;<span class="op" id="4421724">*</span><span class="ident" id="4421725">NilNode</span><span class="op" id="4421732">)</span>&nbsp;<span class="ident" id="4421734">Type</span><span class="op" id="4421738">(</span><span class="op" id="4421739">)</span>&nbsp;<span class="ident" id="4421741">NodeType</span>&nbsp;<span class="op" id="4421750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4421753">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4421817">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4421885">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421909">return</span>&nbsp;<span class="ident" id="4421916">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="4421924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="4421927">func</span>&nbsp;<span class="op" id="4421932">(</span><span class="ident" id="4421933">n</span>&nbsp;<span class="op" id="4421935">*</span><span class="ident" id="4421936">NilNode</span><span class="op" id="4421943">)</span>&nbsp;<span class="ident" id="4421945">String</span><span class="op" id="4421951">(</span><span class="op" id="4421952">)</span>&nbsp;<span class="builtintype" id="4421954">string</span>&nbsp;<span class="op" id="4421961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421964">return</span>&nbsp;<span class="string" id="4421971">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="4421977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4421980">func</span>&nbsp;<span class="op" id="4421985">(</span><span class="ident" id="4421986">n</span>&nbsp;<span class="op" id="4421988">*</span><span class="ident" id="4421989">NilNode</span><span class="op" id="4421996">)</span>&nbsp;<span class="ident" id="4421998">tree</span><span class="op" id="4422002">(</span><span class="op" id="4422003">)</span>&nbsp;<span class="op" id="4422005">*</span><span class="ident" id="4422006">Tree</span>&nbsp;<span class="op" id="4422011">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422014">return</span>&nbsp;<span class="ident" id="4422021">n</span><span class="op" id="4422022">.</span><span class="ident" id="4422023">tr</span><br>
<span class="lineno"></span><span class="op" id="4422026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4422029">func</span>&nbsp;<span class="op" id="4422034">(</span><span class="ident" id="4422035">n</span>&nbsp;<span class="op" id="4422037">*</span><span class="ident" id="4422038">NilNode</span><span class="op" id="4422045">)</span>&nbsp;<span class="ident" id="4422047">Copy</span><span class="op" id="4422051">(</span><span class="op" id="4422052">)</span>&nbsp;<span class="ident" id="4422054">Node</span>&nbsp;<span class="op" id="4422059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422062">return</span>&nbsp;<span class="ident" id="4422069">n</span><span class="op" id="4422070">.</span><span class="ident" id="4422071">tr</span><span class="op" id="4422073">.</span><span class="ident" id="4422074">newNil</span><span class="op" id="4422080">(</span><span class="ident" id="4422081">n</span><span class="op" id="4422082">.</span><span class="ident" id="4422083">Pos</span><span class="op" id="4422086">)</span><br>
<span class="lineno">410</span><span class="op" id="4422088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4422091">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4422150">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4422188">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="4422230">type</span>&nbsp;<span class="ident" id="4422235">FieldNode</span>&nbsp;<span class="keyword" id="4422245">struct</span>&nbsp;<span class="op" id="4422252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422255">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422265">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422270">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4422276">*</span><span class="ident" id="4422277">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422283">Ident</span>&nbsp;<span class="op" id="4422289">[</span><span class="op" id="4422290">]</span><span class="builtintype" id="4422291">string</span>&nbsp;<span class="comment" id="4422298">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="4422335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4422338">func</span>&nbsp;<span class="op" id="4422343">(</span><span class="ident" id="4422344">t</span>&nbsp;<span class="op" id="4422346">*</span><span class="ident" id="4422347">Tree</span><span class="op" id="4422351">)</span>&nbsp;<span class="ident" id="4422353">newField</span><span class="op" id="4422361">(</span><span class="ident" id="4422362">pos</span>&nbsp;<span class="ident" id="4422366">Pos</span><span class="op" id="4422369">,</span>&nbsp;<span class="ident" id="4422371">ident</span>&nbsp;<span class="builtintype" id="4422377">string</span><span class="op" id="4422383">)</span>&nbsp;<span class="op" id="4422385">*</span><span class="ident" id="4422386">FieldNode</span>&nbsp;<span class="op" id="4422396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422399">return</span>&nbsp;<span class="op" id="4422406">&amp;</span><span class="ident" id="4422407">FieldNode</span><span class="op" id="4422416">{</span><span class="ident" id="4422417">tr</span><span class="op" id="4422419">:</span>&nbsp;<span class="ident" id="4422421">t</span><span class="op" id="4422422">,</span>&nbsp;<span class="ident" id="4422424">NodeType</span><span class="op" id="4422432">:</span>&nbsp;<span class="ident" id="4422434">NodeField</span><span class="op" id="4422443">,</span>&nbsp;<span class="ident" id="4422445">Pos</span><span class="op" id="4422448">:</span>&nbsp;<span class="ident" id="4422450">pos</span><span class="op" id="4422453">,</span>&nbsp;<span class="ident" id="4422455">Ident</span><span class="op" id="4422460">:</span>&nbsp;<span class="ident" id="4422462">strings</span><span class="op" id="4422469">.</span><span class="ident" id="4422470">Split</span><span class="op" id="4422475">(</span><span class="ident" id="4422476">ident</span><span class="op" id="4422481">[</span><span class="num" id="4422482">1</span><span class="op" id="4422483">:</span><span class="op" id="4422484">]</span><span class="op" id="4422485">,</span>&nbsp;<span class="string" id="4422487">&#34;.&#34;</span><span class="op" id="4422490">)</span><span class="op" id="4422491">}</span>&nbsp;<span class="comment" id="4422493">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="4422524">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="4422527">func</span>&nbsp;<span class="op" id="4422532">(</span><span class="ident" id="4422533">f</span>&nbsp;<span class="op" id="4422535">*</span><span class="ident" id="4422536">FieldNode</span><span class="op" id="4422545">)</span>&nbsp;<span class="ident" id="4422547">String</span><span class="op" id="4422553">(</span><span class="op" id="4422554">)</span>&nbsp;<span class="builtintype" id="4422556">string</span>&nbsp;<span class="op" id="4422563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422566">s</span>&nbsp;<span class="op" id="4422568">:=</span>&nbsp;<span class="string" id="4422571">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422575">for</span>&nbsp;<span class="ident" id="4422579">_</span><span class="op" id="4422580">,</span>&nbsp;<span class="ident" id="4422582">id</span>&nbsp;<span class="op" id="4422585">:=</span>&nbsp;<span class="keyword" id="4422588">range</span>&nbsp;<span class="ident" id="4422594">f</span><span class="op" id="4422595">.</span><span class="ident" id="4422596">Ident</span>&nbsp;<span class="op" id="4422602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422606">s</span>&nbsp;<span class="op" id="4422608">+=</span>&nbsp;<span class="string" id="4422611">&#34;.&#34;</span>&nbsp;<span class="op" id="4422615">+</span>&nbsp;<span class="ident" id="4422617">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4422621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422624">return</span>&nbsp;<span class="ident" id="4422631">s</span><br>
<span class="lineno"></span><span class="op" id="4422633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4422636">func</span>&nbsp;<span class="op" id="4422641">(</span><span class="ident" id="4422642">f</span>&nbsp;<span class="op" id="4422644">*</span><span class="ident" id="4422645">FieldNode</span><span class="op" id="4422654">)</span>&nbsp;<span class="ident" id="4422656">tree</span><span class="op" id="4422660">(</span><span class="op" id="4422661">)</span>&nbsp;<span class="op" id="4422663">*</span><span class="ident" id="4422664">Tree</span>&nbsp;<span class="op" id="4422669">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422672">return</span>&nbsp;<span class="ident" id="4422679">f</span><span class="op" id="4422680">.</span><span class="ident" id="4422681">tr</span><br>
<span class="lineno"></span><span class="op" id="4422684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4422687">func</span>&nbsp;<span class="op" id="4422692">(</span><span class="ident" id="4422693">f</span>&nbsp;<span class="op" id="4422695">*</span><span class="ident" id="4422696">FieldNode</span><span class="op" id="4422705">)</span>&nbsp;<span class="ident" id="4422707">Copy</span><span class="op" id="4422711">(</span><span class="op" id="4422712">)</span>&nbsp;<span class="ident" id="4422714">Node</span>&nbsp;<span class="op" id="4422719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422722">return</span>&nbsp;<span class="op" id="4422729">&amp;</span><span class="ident" id="4422730">FieldNode</span><span class="op" id="4422739">{</span><span class="ident" id="4422740">tr</span><span class="op" id="4422742">:</span>&nbsp;<span class="ident" id="4422744">f</span><span class="op" id="4422745">.</span><span class="ident" id="4422746">tr</span><span class="op" id="4422748">,</span>&nbsp;<span class="ident" id="4422750">NodeType</span><span class="op" id="4422758">:</span>&nbsp;<span class="ident" id="4422760">NodeField</span><span class="op" id="4422769">,</span>&nbsp;<span class="ident" id="4422771">Pos</span><span class="op" id="4422774">:</span>&nbsp;<span class="ident" id="4422776">f</span><span class="op" id="4422777">.</span><span class="ident" id="4422778">Pos</span><span class="op" id="4422781">,</span>&nbsp;<span class="ident" id="4422783">Ident</span><span class="op" id="4422788">:</span>&nbsp;<span class="builtinfunc" id="4422790">append</span><span class="op" id="4422796">(</span><span class="op" id="4422797">[</span><span class="op" id="4422798">]</span><span class="builtintype" id="4422799">string</span><span class="op" id="4422805">{</span><span class="op" id="4422806">}</span><span class="op" id="4422807">,</span>&nbsp;<span class="ident" id="4422809">f</span><span class="op" id="4422810">.</span><span class="ident" id="4422811">Ident</span><span class="op" id="4422816">...</span><span class="op" id="4422819">)</span><span class="op" id="4422820">}</span><br>
<span class="lineno">440</span><span class="op" id="4422822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4422825">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4422921">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4422959">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="4423003">type</span>&nbsp;<span class="ident" id="4423008">ChainNode</span>&nbsp;<span class="keyword" id="4423018">struct</span>&nbsp;<span class="op" id="4423025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423028">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423038">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423043">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423049">*</span><span class="ident" id="4423050">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423056">Node</span>&nbsp;&nbsp;<span class="ident" id="4423062">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423068">Field</span>&nbsp;<span class="op" id="4423074">[</span><span class="op" id="4423075">]</span><span class="builtintype" id="4423076">string</span>&nbsp;<span class="comment" id="4423083">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4423120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4423123">func</span>&nbsp;<span class="op" id="4423128">(</span><span class="ident" id="4423129">t</span>&nbsp;<span class="op" id="4423131">*</span><span class="ident" id="4423132">Tree</span><span class="op" id="4423136">)</span>&nbsp;<span class="ident" id="4423138">newChain</span><span class="op" id="4423146">(</span><span class="ident" id="4423147">pos</span>&nbsp;<span class="ident" id="4423151">Pos</span><span class="op" id="4423154">,</span>&nbsp;<span class="ident" id="4423156">node</span>&nbsp;<span class="ident" id="4423161">Node</span><span class="op" id="4423165">)</span>&nbsp;<span class="op" id="4423167">*</span><span class="ident" id="4423168">ChainNode</span>&nbsp;<span class="op" id="4423178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423181">return</span>&nbsp;<span class="op" id="4423188">&amp;</span><span class="ident" id="4423189">ChainNode</span><span class="op" id="4423198">{</span><span class="ident" id="4423199">tr</span><span class="op" id="4423201">:</span>&nbsp;<span class="ident" id="4423203">t</span><span class="op" id="4423204">,</span>&nbsp;<span class="ident" id="4423206">NodeType</span><span class="op" id="4423214">:</span>&nbsp;<span class="ident" id="4423216">NodeChain</span><span class="op" id="4423225">,</span>&nbsp;<span class="ident" id="4423227">Pos</span><span class="op" id="4423230">:</span>&nbsp;<span class="ident" id="4423232">pos</span><span class="op" id="4423235">,</span>&nbsp;<span class="ident" id="4423237">Node</span><span class="op" id="4423241">:</span>&nbsp;<span class="ident" id="4423243">node</span><span class="op" id="4423247">}</span><br>
<span class="lineno">455</span><span class="op" id="4423249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4423252">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="4423340">func</span>&nbsp;<span class="op" id="4423345">(</span><span class="ident" id="4423346">c</span>&nbsp;<span class="op" id="4423348">*</span><span class="ident" id="4423349">ChainNode</span><span class="op" id="4423358">)</span>&nbsp;<span class="ident" id="4423360">Add</span><span class="op" id="4423363">(</span><span class="ident" id="4423364">field</span>&nbsp;<span class="builtintype" id="4423370">string</span><span class="op" id="4423376">)</span>&nbsp;<span class="op" id="4423378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423381">if</span>&nbsp;<span class="builtinfunc" id="4423384">len</span><span class="op" id="4423387">(</span><span class="ident" id="4423388">field</span><span class="op" id="4423393">)</span>&nbsp;<span class="op" id="4423395">==</span>&nbsp;<span class="num" id="4423398">0</span>&nbsp;<span class="op" id="4423400">||</span>&nbsp;<span class="ident" id="4423403">field</span><span class="op" id="4423408">[</span><span class="num" id="4423409">0</span><span class="op" id="4423410">]</span>&nbsp;<span class="op" id="4423412">!=</span>&nbsp;<span class="string" id="4423415">&#39;.&#39;</span>&nbsp;<span class="op" id="4423419">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4423423">panic</span><span class="op" id="4423428">(</span><span class="string" id="4423429">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="4423446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423452">field</span>&nbsp;<span class="op" id="4423458">=</span>&nbsp;<span class="ident" id="4423460">field</span><span class="op" id="4423465">[</span><span class="num" id="4423466">1</span><span class="op" id="4423467">:</span><span class="op" id="4423468">]</span>&nbsp;<span class="comment" id="4423470">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423494">if</span>&nbsp;<span class="ident" id="4423497">field</span>&nbsp;<span class="op" id="4423503">==</span>&nbsp;<span class="string" id="4423506">&#34;&#34;</span>&nbsp;<span class="op" id="4423509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4423513">panic</span><span class="op" id="4423518">(</span><span class="string" id="4423519">&#34;empty&nbsp;field&#34;</span><span class="op" id="4423532">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423538">c</span><span class="op" id="4423539">.</span><span class="ident" id="4423540">Field</span>&nbsp;<span class="op" id="4423546">=</span>&nbsp;<span class="builtinfunc" id="4423548">append</span><span class="op" id="4423554">(</span><span class="ident" id="4423555">c</span><span class="op" id="4423556">.</span><span class="ident" id="4423557">Field</span><span class="op" id="4423562">,</span>&nbsp;<span class="ident" id="4423564">field</span><span class="op" id="4423569">)</span><br>
<span class="lineno"></span><span class="op" id="4423571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4423574">func</span>&nbsp;<span class="op" id="4423579">(</span><span class="ident" id="4423580">c</span>&nbsp;<span class="op" id="4423582">*</span><span class="ident" id="4423583">ChainNode</span><span class="op" id="4423592">)</span>&nbsp;<span class="ident" id="4423594">String</span><span class="op" id="4423600">(</span><span class="op" id="4423601">)</span>&nbsp;<span class="builtintype" id="4423603">string</span>&nbsp;<span class="op" id="4423610">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423613">s</span>&nbsp;<span class="op" id="4423615">:=</span>&nbsp;<span class="ident" id="4423618">c</span><span class="op" id="4423619">.</span><span class="ident" id="4423620">Node</span><span class="op" id="4423624">.</span><span class="ident" id="4423625">String</span><span class="op" id="4423631">(</span><span class="op" id="4423632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423635">if</span>&nbsp;<span class="ident" id="4423638">_</span><span class="op" id="4423639">,</span>&nbsp;<span class="ident" id="4423641">ok</span>&nbsp;<span class="op" id="4423644">:=</span>&nbsp;<span class="ident" id="4423647">c</span><span class="op" id="4423648">.</span><span class="ident" id="4423649">Node</span><span class="op" id="4423653">.</span><span class="op" id="4423654">(</span><span class="op" id="4423655">*</span><span class="ident" id="4423656">PipeNode</span><span class="op" id="4423664">)</span><span class="op" id="4423665">;</span>&nbsp;<span class="ident" id="4423667">ok</span>&nbsp;<span class="op" id="4423670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423674">s</span>&nbsp;<span class="op" id="4423676">=</span>&nbsp;<span class="string" id="4423678">&#34;(&#34;</span>&nbsp;<span class="op" id="4423682">+</span>&nbsp;<span class="ident" id="4423684">s</span>&nbsp;<span class="op" id="4423686">+</span>&nbsp;<span class="string" id="4423688">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423696">for</span>&nbsp;<span class="ident" id="4423700">_</span><span class="op" id="4423701">,</span>&nbsp;<span class="ident" id="4423703">field</span>&nbsp;<span class="op" id="4423709">:=</span>&nbsp;<span class="keyword" id="4423712">range</span>&nbsp;<span class="ident" id="4423718">c</span><span class="op" id="4423719">.</span><span class="ident" id="4423720">Field</span>&nbsp;<span class="op" id="4423726">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423730">s</span>&nbsp;<span class="op" id="4423732">+=</span>&nbsp;<span class="string" id="4423735">&#34;.&#34;</span>&nbsp;<span class="op" id="4423739">+</span>&nbsp;<span class="ident" id="4423741">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423751">return</span>&nbsp;<span class="ident" id="4423758">s</span><br>
<span class="lineno"></span><span class="op" id="4423760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="4423763">func</span>&nbsp;<span class="op" id="4423768">(</span><span class="ident" id="4423769">c</span>&nbsp;<span class="op" id="4423771">*</span><span class="ident" id="4423772">ChainNode</span><span class="op" id="4423781">)</span>&nbsp;<span class="ident" id="4423783">tree</span><span class="op" id="4423787">(</span><span class="op" id="4423788">)</span>&nbsp;<span class="op" id="4423790">*</span><span class="ident" id="4423791">Tree</span>&nbsp;<span class="op" id="4423796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423799">return</span>&nbsp;<span class="ident" id="4423806">c</span><span class="op" id="4423807">.</span><span class="ident" id="4423808">tr</span><br>
<span class="lineno"></span><span class="op" id="4423811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4423814">func</span>&nbsp;<span class="op" id="4423819">(</span><span class="ident" id="4423820">c</span>&nbsp;<span class="op" id="4423822">*</span><span class="ident" id="4423823">ChainNode</span><span class="op" id="4423832">)</span>&nbsp;<span class="ident" id="4423834">Copy</span><span class="op" id="4423838">(</span><span class="op" id="4423839">)</span>&nbsp;<span class="ident" id="4423841">Node</span>&nbsp;<span class="op" id="4423846">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423849">return</span>&nbsp;<span class="op" id="4423856">&amp;</span><span class="ident" id="4423857">ChainNode</span><span class="op" id="4423866">{</span><span class="ident" id="4423867">tr</span><span class="op" id="4423869">:</span>&nbsp;<span class="ident" id="4423871">c</span><span class="op" id="4423872">.</span><span class="ident" id="4423873">tr</span><span class="op" id="4423875">,</span>&nbsp;<span class="ident" id="4423877">NodeType</span><span class="op" id="4423885">:</span>&nbsp;<span class="ident" id="4423887">NodeChain</span><span class="op" id="4423896">,</span>&nbsp;<span class="ident" id="4423898">Pos</span><span class="op" id="4423901">:</span>&nbsp;<span class="ident" id="4423903">c</span><span class="op" id="4423904">.</span><span class="ident" id="4423905">Pos</span><span class="op" id="4423908">,</span>&nbsp;<span class="ident" id="4423910">Node</span><span class="op" id="4423914">:</span>&nbsp;<span class="ident" id="4423916">c</span><span class="op" id="4423917">.</span><span class="ident" id="4423918">Node</span><span class="op" id="4423922">,</span>&nbsp;<span class="ident" id="4423924">Field</span><span class="op" id="4423929">:</span>&nbsp;<span class="builtinfunc" id="4423931">append</span><span class="op" id="4423937">(</span><span class="op" id="4423938">[</span><span class="op" id="4423939">]</span><span class="builtintype" id="4423940">string</span><span class="op" id="4423946">{</span><span class="op" id="4423947">}</span><span class="op" id="4423948">,</span>&nbsp;<span class="ident" id="4423950">c</span><span class="op" id="4423951">.</span><span class="ident" id="4423952">Field</span><span class="op" id="4423957">...</span><span class="op" id="4423960">)</span><span class="op" id="4423961">}</span><br>
<span class="lineno"></span><span class="op" id="4423963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4423966">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="4424004">type</span>&nbsp;<span class="ident" id="4424009">BoolNode</span>&nbsp;<span class="keyword" id="4424018">struct</span>&nbsp;<span class="op" id="4424025">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424028">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424038">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424043">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4424048">*</span><span class="ident" id="4424049">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424055">True</span>&nbsp;<span class="builtintype" id="4424060">bool</span>&nbsp;<span class="comment" id="4424065">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="4424103">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="4424106">func</span>&nbsp;<span class="op" id="4424111">(</span><span class="ident" id="4424112">t</span>&nbsp;<span class="op" id="4424114">*</span><span class="ident" id="4424115">Tree</span><span class="op" id="4424119">)</span>&nbsp;<span class="ident" id="4424121">newBool</span><span class="op" id="4424128">(</span><span class="ident" id="4424129">pos</span>&nbsp;<span class="ident" id="4424133">Pos</span><span class="op" id="4424136">,</span>&nbsp;<span class="builtintype" id="4424138">true</span>&nbsp;<span class="builtintype" id="4424143">bool</span><span class="op" id="4424147">)</span>&nbsp;<span class="op" id="4424149">*</span><span class="ident" id="4424150">BoolNode</span>&nbsp;<span class="op" id="4424159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424162">return</span>&nbsp;<span class="op" id="4424169">&amp;</span><span class="ident" id="4424170">BoolNode</span><span class="op" id="4424178">{</span><span class="ident" id="4424179">tr</span><span class="op" id="4424181">:</span>&nbsp;<span class="ident" id="4424183">t</span><span class="op" id="4424184">,</span>&nbsp;<span class="ident" id="4424186">NodeType</span><span class="op" id="4424194">:</span>&nbsp;<span class="ident" id="4424196">NodeBool</span><span class="op" id="4424204">,</span>&nbsp;<span class="ident" id="4424206">Pos</span><span class="op" id="4424209">:</span>&nbsp;<span class="ident" id="4424211">pos</span><span class="op" id="4424214">,</span>&nbsp;<span class="ident" id="4424216">True</span><span class="op" id="4424220">:</span>&nbsp;<span class="builtintype" id="4424222">true</span><span class="op" id="4424226">}</span><br>
<span class="lineno"></span><span class="op" id="4424228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="4424231">func</span>&nbsp;<span class="op" id="4424236">(</span><span class="ident" id="4424237">b</span>&nbsp;<span class="op" id="4424239">*</span><span class="ident" id="4424240">BoolNode</span><span class="op" id="4424248">)</span>&nbsp;<span class="ident" id="4424250">String</span><span class="op" id="4424256">(</span><span class="op" id="4424257">)</span>&nbsp;<span class="builtintype" id="4424259">string</span>&nbsp;<span class="op" id="4424266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424269">if</span>&nbsp;<span class="ident" id="4424272">b</span><span class="op" id="4424273">.</span><span class="ident" id="4424274">True</span>&nbsp;<span class="op" id="4424279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424283">return</span>&nbsp;<span class="string" id="4424290">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4424298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424301">return</span>&nbsp;<span class="string" id="4424308">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="4424316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4424319">func</span>&nbsp;<span class="op" id="4424324">(</span><span class="ident" id="4424325">b</span>&nbsp;<span class="op" id="4424327">*</span><span class="ident" id="4424328">BoolNode</span><span class="op" id="4424336">)</span>&nbsp;<span class="ident" id="4424338">tree</span><span class="op" id="4424342">(</span><span class="op" id="4424343">)</span>&nbsp;<span class="op" id="4424345">*</span><span class="ident" id="4424346">Tree</span>&nbsp;<span class="op" id="4424351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424354">return</span>&nbsp;<span class="ident" id="4424361">b</span><span class="op" id="4424362">.</span><span class="ident" id="4424363">tr</span><br>
<span class="lineno"></span><span class="op" id="4424366">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="4424369">func</span>&nbsp;<span class="op" id="4424374">(</span><span class="ident" id="4424375">b</span>&nbsp;<span class="op" id="4424377">*</span><span class="ident" id="4424378">BoolNode</span><span class="op" id="4424386">)</span>&nbsp;<span class="ident" id="4424388">Copy</span><span class="op" id="4424392">(</span><span class="op" id="4424393">)</span>&nbsp;<span class="ident" id="4424395">Node</span>&nbsp;<span class="op" id="4424400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424403">return</span>&nbsp;<span class="ident" id="4424410">b</span><span class="op" id="4424411">.</span><span class="ident" id="4424412">tr</span><span class="op" id="4424414">.</span><span class="ident" id="4424415">newBool</span><span class="op" id="4424422">(</span><span class="ident" id="4424423">b</span><span class="op" id="4424424">.</span><span class="ident" id="4424425">Pos</span><span class="op" id="4424428">,</span>&nbsp;<span class="ident" id="4424430">b</span><span class="op" id="4424431">.</span><span class="ident" id="4424432">True</span><span class="op" id="4424436">)</span><br>
<span class="lineno"></span><span class="op" id="4424438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="4424441">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="4424518">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4424602">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4424684">type</span>&nbsp;<span class="ident" id="4424689">NumberNode</span>&nbsp;<span class="keyword" id="4424700">struct</span>&nbsp;<span class="op" id="4424707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424710">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424720">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424725">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4424736">*</span><span class="ident" id="4424737">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424743">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4424754">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4424765">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424799">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4424810">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4424821">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424864">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4424875">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4424886">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424925">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="4424936">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4424947">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424970">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424981">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4424992">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425022">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425033">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4425044">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425076">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4425087">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4425098">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425128">Complex128</span>&nbsp;<span class="builtintype" id="4425139">complex128</span>&nbsp;<span class="comment" id="4425150">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425173">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4425184">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4425195">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="4425250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4425253">func</span>&nbsp;<span class="op" id="4425258">(</span><span class="ident" id="4425259">t</span>&nbsp;<span class="op" id="4425261">*</span><span class="ident" id="4425262">Tree</span><span class="op" id="4425266">)</span>&nbsp;<span class="ident" id="4425268">newNumber</span><span class="op" id="4425277">(</span><span class="ident" id="4425278">pos</span>&nbsp;<span class="ident" id="4425282">Pos</span><span class="op" id="4425285">,</span>&nbsp;<span class="ident" id="4425287">text</span>&nbsp;<span class="builtintype" id="4425292">string</span><span class="op" id="4425298">,</span>&nbsp;<span class="ident" id="4425300">typ</span>&nbsp;<span class="ident" id="4425304">itemType</span><span class="op" id="4425312">)</span>&nbsp;<span class="op" id="4425314">(</span><span class="op" id="4425315">*</span><span class="ident" id="4425316">NumberNode</span><span class="op" id="4425326">,</span>&nbsp;<span class="builtintype" id="4425328">error</span><span class="op" id="4425333">)</span>&nbsp;<span class="op" id="4425335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425338">n</span>&nbsp;<span class="op" id="4425340">:=</span>&nbsp;<span class="op" id="4425343">&amp;</span><span class="ident" id="4425344">NumberNode</span><span class="op" id="4425354">{</span><span class="ident" id="4425355">tr</span><span class="op" id="4425357">:</span>&nbsp;<span class="ident" id="4425359">t</span><span class="op" id="4425360">,</span>&nbsp;<span class="ident" id="4425362">NodeType</span><span class="op" id="4425370">:</span>&nbsp;<span class="ident" id="4425372">NodeNumber</span><span class="op" id="4425382">,</span>&nbsp;<span class="ident" id="4425384">Pos</span><span class="op" id="4425387">:</span>&nbsp;<span class="ident" id="4425389">pos</span><span class="op" id="4425392">,</span>&nbsp;<span class="ident" id="4425394">Text</span><span class="op" id="4425398">:</span>&nbsp;<span class="ident" id="4425400">text</span><span class="op" id="4425404">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425407">switch</span>&nbsp;<span class="ident" id="4425414">typ</span>&nbsp;<span class="op" id="4425418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425421">case</span>&nbsp;<span class="ident" id="4425426">itemCharConstant</span><span class="op" id="4425442">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4425446">rune</span><span class="op" id="4425450">,</span>&nbsp;<span class="ident" id="4425452">_</span><span class="op" id="4425453">,</span>&nbsp;<span class="ident" id="4425455">tail</span><span class="op" id="4425459">,</span>&nbsp;<span class="ident" id="4425461">err</span>&nbsp;<span class="op" id="4425465">:=</span>&nbsp;<span class="ident" id="4425468">strconv</span><span class="op" id="4425475">.</span><span class="ident" id="4425476">UnquoteChar</span><span class="op" id="4425487">(</span><span class="ident" id="4425488">text</span><span class="op" id="4425492">[</span><span class="num" id="4425493">1</span><span class="op" id="4425494">:</span><span class="op" id="4425495">]</span><span class="op" id="4425496">,</span>&nbsp;<span class="ident" id="4425498">text</span><span class="op" id="4425502">[</span><span class="num" id="4425503">0</span><span class="op" id="4425504">]</span><span class="op" id="4425505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425509">if</span>&nbsp;<span class="ident" id="4425512">err</span>&nbsp;<span class="op" id="4425516">!=</span>&nbsp;<span class="builtintype" id="4425519">nil</span>&nbsp;<span class="op" id="4425523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425528">return</span>&nbsp;<span class="builtintype" id="4425535">nil</span><span class="op" id="4425538">,</span>&nbsp;<span class="ident" id="4425540">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4425546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425550">if</span>&nbsp;<span class="ident" id="4425553">tail</span>&nbsp;<span class="op" id="4425558">!=</span>&nbsp;<span class="string" id="4425561">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="4425565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425570">return</span>&nbsp;<span class="builtintype" id="4425577">nil</span><span class="op" id="4425580">,</span>&nbsp;<span class="ident" id="4425582">fmt</span><span class="op" id="4425585">.</span><span class="ident" id="4425586">Errorf</span><span class="op" id="4425592">(</span><span class="string" id="4425593">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="4425627">,</span>&nbsp;<span class="ident" id="4425629">text</span><span class="op" id="4425633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4425637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425641">n</span><span class="op" id="4425642">.</span><span class="ident" id="4425643">Int64</span>&nbsp;<span class="op" id="4425649">=</span>&nbsp;<span class="ident" id="4425651">int64</span><span class="op" id="4425656">(</span><span class="builtintype" id="4425657">rune</span><span class="op" id="4425661">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425665">n</span><span class="op" id="4425666">.</span><span class="ident" id="4425667">IsInt</span>&nbsp;<span class="op" id="4425673">=</span>&nbsp;<span class="builtintype" id="4425675">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425682">n</span><span class="op" id="4425683">.</span><span class="ident" id="4425684">Uint64</span>&nbsp;<span class="op" id="4425691">=</span>&nbsp;<span class="ident" id="4425693">uint64</span><span class="op" id="4425699">(</span><span class="builtintype" id="4425700">rune</span><span class="op" id="4425704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425708">n</span><span class="op" id="4425709">.</span><span class="ident" id="4425710">IsUint</span>&nbsp;<span class="op" id="4425717">=</span>&nbsp;<span class="builtintype" id="4425719">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425726">n</span><span class="op" id="4425727">.</span><span class="ident" id="4425728">Float64</span>&nbsp;<span class="op" id="4425736">=</span>&nbsp;<span class="builtintype" id="4425738">float64</span><span class="op" id="4425745">(</span><span class="builtintype" id="4425746">rune</span><span class="op" id="4425750">)</span>&nbsp;<span class="comment" id="4425752">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425786">n</span><span class="op" id="4425787">.</span><span class="ident" id="4425788">IsFloat</span>&nbsp;<span class="op" id="4425796">=</span>&nbsp;<span class="builtintype" id="4425798">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425805">return</span>&nbsp;<span class="ident" id="4425812">n</span><span class="op" id="4425813">,</span>&nbsp;<span class="builtintype" id="4425815">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425820">case</span>&nbsp;<span class="ident" id="4425825">itemComplex</span><span class="op" id="4425836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4425840">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425898">if</span>&nbsp;<span class="ident" id="4425901">_</span><span class="op" id="4425902">,</span>&nbsp;<span class="ident" id="4425904">err</span>&nbsp;<span class="op" id="4425908">:=</span>&nbsp;<span class="ident" id="4425911">fmt</span><span class="op" id="4425914">.</span><span class="ident" id="4425915">Sscan</span><span class="op" id="4425920">(</span><span class="ident" id="4425921">text</span><span class="op" id="4425925">,</span>&nbsp;<span class="op" id="4425927">&amp;</span><span class="ident" id="4425928">n</span><span class="op" id="4425929">.</span><span class="ident" id="4425930">Complex128</span><span class="op" id="4425940">)</span><span class="op" id="4425941">;</span>&nbsp;<span class="ident" id="4425943">err</span>&nbsp;<span class="op" id="4425947">!=</span>&nbsp;<span class="builtintype" id="4425950">nil</span>&nbsp;<span class="op" id="4425954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425959">return</span>&nbsp;<span class="builtintype" id="4425966">nil</span><span class="op" id="4425969">,</span>&nbsp;<span class="ident" id="4425971">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4425977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425981">n</span><span class="op" id="4425982">.</span><span class="ident" id="4425983">IsComplex</span>&nbsp;<span class="op" id="4425993">=</span>&nbsp;<span class="builtintype" id="4425995">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426002">n</span><span class="op" id="4426003">.</span><span class="ident" id="4426004">simplifyComplex</span><span class="op" id="4426019">(</span><span class="op" id="4426020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426024">return</span>&nbsp;<span class="ident" id="4426031">n</span><span class="op" id="4426032">,</span>&nbsp;<span class="builtintype" id="4426034">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426039">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4426042">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426108">if</span>&nbsp;<span class="builtinfunc" id="4426111">len</span><span class="op" id="4426114">(</span><span class="ident" id="4426115">text</span><span class="op" id="4426119">)</span>&nbsp;<span class="op" id="4426121">&gt;</span>&nbsp;<span class="num" id="4426123">0</span>&nbsp;<span class="op" id="4426125">&amp;&amp;</span>&nbsp;<span class="ident" id="4426128">text</span><span class="op" id="4426132">[</span><span class="builtinfunc" id="4426133">len</span><span class="op" id="4426136">(</span><span class="ident" id="4426137">text</span><span class="op" id="4426141">)</span><span class="op" id="4426142">-</span><span class="num" id="4426143">1</span><span class="op" id="4426144">]</span>&nbsp;<span class="op" id="4426146">==</span>&nbsp;<span class="string" id="4426149">&#39;i&#39;</span>&nbsp;<span class="op" id="4426153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426157">f</span><span class="op" id="4426158">,</span>&nbsp;<span class="ident" id="4426160">err</span>&nbsp;<span class="op" id="4426164">:=</span>&nbsp;<span class="ident" id="4426167">strconv</span><span class="op" id="4426174">.</span><span class="ident" id="4426175">ParseFloat</span><span class="op" id="4426185">(</span><span class="ident" id="4426186">text</span><span class="op" id="4426190">[</span><span class="op" id="4426191">:</span><span class="builtinfunc" id="4426192">len</span><span class="op" id="4426195">(</span><span class="ident" id="4426196">text</span><span class="op" id="4426200">)</span><span class="op" id="4426201">-</span><span class="num" id="4426202">1</span><span class="op" id="4426203">]</span><span class="op" id="4426204">,</span>&nbsp;<span class="num" id="4426206">64</span><span class="op" id="4426208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426212">if</span>&nbsp;<span class="ident" id="4426215">err</span>&nbsp;<span class="op" id="4426219">==</span>&nbsp;<span class="builtintype" id="4426222">nil</span>&nbsp;<span class="op" id="4426226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426231">n</span><span class="op" id="4426232">.</span><span class="ident" id="4426233">IsComplex</span>&nbsp;<span class="op" id="4426243">=</span>&nbsp;<span class="builtintype" id="4426245">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426253">n</span><span class="op" id="4426254">.</span><span class="ident" id="4426255">Complex128</span>&nbsp;<span class="op" id="4426266">=</span>&nbsp;<span class="builtinfunc" id="4426268">complex</span><span class="op" id="4426275">(</span><span class="num" id="4426276">0</span><span class="op" id="4426277">,</span>&nbsp;<span class="ident" id="4426279">f</span><span class="op" id="4426280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426285">n</span><span class="op" id="4426286">.</span><span class="ident" id="4426287">simplifyComplex</span><span class="op" id="4426302">(</span><span class="op" id="4426303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426308">return</span>&nbsp;<span class="ident" id="4426315">n</span><span class="op" id="4426316">,</span>&nbsp;<span class="builtintype" id="4426318">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426327">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4426330">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426377">u</span><span class="op" id="4426378">,</span>&nbsp;<span class="ident" id="4426380">err</span>&nbsp;<span class="op" id="4426384">:=</span>&nbsp;<span class="ident" id="4426387">strconv</span><span class="op" id="4426394">.</span><span class="ident" id="4426395">ParseUint</span><span class="op" id="4426404">(</span><span class="ident" id="4426405">text</span><span class="op" id="4426409">,</span>&nbsp;<span class="num" id="4426411">0</span><span class="op" id="4426412">,</span>&nbsp;<span class="num" id="4426414">64</span><span class="op" id="4426416">)</span>&nbsp;<span class="comment" id="4426418">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426453">if</span>&nbsp;<span class="ident" id="4426456">err</span>&nbsp;<span class="op" id="4426460">==</span>&nbsp;<span class="builtintype" id="4426463">nil</span>&nbsp;<span class="op" id="4426467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426471">n</span><span class="op" id="4426472">.</span><span class="ident" id="4426473">IsUint</span>&nbsp;<span class="op" id="4426480">=</span>&nbsp;<span class="builtintype" id="4426482">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426489">n</span><span class="op" id="4426490">.</span><span class="ident" id="4426491">Uint64</span>&nbsp;<span class="op" id="4426498">=</span>&nbsp;<span class="ident" id="4426500">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426506">i</span><span class="op" id="4426507">,</span>&nbsp;<span class="ident" id="4426509">err</span>&nbsp;<span class="op" id="4426513">:=</span>&nbsp;<span class="ident" id="4426516">strconv</span><span class="op" id="4426523">.</span><span class="ident" id="4426524">ParseInt</span><span class="op" id="4426532">(</span><span class="ident" id="4426533">text</span><span class="op" id="4426537">,</span>&nbsp;<span class="num" id="4426539">0</span><span class="op" id="4426540">,</span>&nbsp;<span class="num" id="4426542">64</span><span class="op" id="4426544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426547">if</span>&nbsp;<span class="ident" id="4426550">err</span>&nbsp;<span class="op" id="4426554">==</span>&nbsp;<span class="builtintype" id="4426557">nil</span>&nbsp;<span class="op" id="4426561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426565">n</span><span class="op" id="4426566">.</span><span class="ident" id="4426567">IsInt</span>&nbsp;<span class="op" id="4426573">=</span>&nbsp;<span class="builtintype" id="4426575">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426582">n</span><span class="op" id="4426583">.</span><span class="ident" id="4426584">Int64</span>&nbsp;<span class="op" id="4426590">=</span>&nbsp;<span class="ident" id="4426592">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426596">if</span>&nbsp;<span class="ident" id="4426599">i</span>&nbsp;<span class="op" id="4426601">==</span>&nbsp;<span class="num" id="4426604">0</span>&nbsp;<span class="op" id="4426606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426611">n</span><span class="op" id="4426612">.</span><span class="ident" id="4426613">IsUint</span>&nbsp;<span class="op" id="4426620">=</span>&nbsp;<span class="builtintype" id="4426622">true</span>&nbsp;<span class="comment" id="4426627">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426648">n</span><span class="op" id="4426649">.</span><span class="ident" id="4426650">Uint64</span>&nbsp;<span class="op" id="4426657">=</span>&nbsp;<span class="ident" id="4426659">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426666">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4426669">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426728">if</span>&nbsp;<span class="ident" id="4426731">n</span><span class="op" id="4426732">.</span><span class="ident" id="4426733">IsInt</span>&nbsp;<span class="op" id="4426739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426743">n</span><span class="op" id="4426744">.</span><span class="ident" id="4426745">IsFloat</span>&nbsp;<span class="op" id="4426753">=</span>&nbsp;<span class="builtintype" id="4426755">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426762">n</span><span class="op" id="4426763">.</span><span class="ident" id="4426764">Float64</span>&nbsp;<span class="op" id="4426772">=</span>&nbsp;<span class="builtintype" id="4426774">float64</span><span class="op" id="4426781">(</span><span class="ident" id="4426782">n</span><span class="op" id="4426783">.</span><span class="ident" id="4426784">Int64</span><span class="op" id="4426789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426792">}</span>&nbsp;<span class="keyword" id="4426794">else</span>&nbsp;<span class="keyword" id="4426799">if</span>&nbsp;<span class="ident" id="4426802">n</span><span class="op" id="4426803">.</span><span class="ident" id="4426804">IsUint</span>&nbsp;<span class="op" id="4426811">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426815">n</span><span class="op" id="4426816">.</span><span class="ident" id="4426817">IsFloat</span>&nbsp;<span class="op" id="4426825">=</span>&nbsp;<span class="builtintype" id="4426827">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426834">n</span><span class="op" id="4426835">.</span><span class="ident" id="4426836">Float64</span>&nbsp;<span class="op" id="4426844">=</span>&nbsp;<span class="builtintype" id="4426846">float64</span><span class="op" id="4426853">(</span><span class="ident" id="4426854">n</span><span class="op" id="4426855">.</span><span class="ident" id="4426856">Uint64</span><span class="op" id="4426862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426865">}</span>&nbsp;<span class="keyword" id="4426867">else</span>&nbsp;<span class="op" id="4426872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426876">f</span><span class="op" id="4426877">,</span>&nbsp;<span class="ident" id="4426879">err</span>&nbsp;<span class="op" id="4426883">:=</span>&nbsp;<span class="ident" id="4426886">strconv</span><span class="op" id="4426893">.</span><span class="ident" id="4426894">ParseFloat</span><span class="op" id="4426904">(</span><span class="ident" id="4426905">text</span><span class="op" id="4426909">,</span>&nbsp;<span class="num" id="4426911">64</span><span class="op" id="4426913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426917">if</span>&nbsp;<span class="ident" id="4426920">err</span>&nbsp;<span class="op" id="4426924">==</span>&nbsp;<span class="builtintype" id="4426927">nil</span>&nbsp;<span class="op" id="4426931">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426936">n</span><span class="op" id="4426937">.</span><span class="ident" id="4426938">IsFloat</span>&nbsp;<span class="op" id="4426946">=</span>&nbsp;<span class="builtintype" id="4426948">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426956">n</span><span class="op" id="4426957">.</span><span class="ident" id="4426958">Float64</span>&nbsp;<span class="op" id="4426966">=</span>&nbsp;<span class="ident" id="4426968">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4426973">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427048">if</span>&nbsp;<span class="op" id="4427051">!</span><span class="ident" id="4427052">n</span><span class="op" id="4427053">.</span><span class="ident" id="4427054">IsInt</span>&nbsp;<span class="op" id="4427060">&amp;&amp;</span>&nbsp;<span class="builtintype" id="4427063">float64</span><span class="op" id="4427070">(</span><span class="ident" id="4427071">int64</span><span class="op" id="4427076">(</span><span class="ident" id="4427077">f</span><span class="op" id="4427078">)</span><span class="op" id="4427079">)</span>&nbsp;<span class="op" id="4427081">==</span>&nbsp;<span class="ident" id="4427084">f</span>&nbsp;<span class="op" id="4427086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427092">n</span><span class="op" id="4427093">.</span><span class="ident" id="4427094">IsInt</span>&nbsp;<span class="op" id="4427100">=</span>&nbsp;<span class="builtintype" id="4427102">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427111">n</span><span class="op" id="4427112">.</span><span class="ident" id="4427113">Int64</span>&nbsp;<span class="op" id="4427119">=</span>&nbsp;<span class="ident" id="4427121">int64</span><span class="op" id="4427126">(</span><span class="ident" id="4427127">f</span><span class="op" id="4427128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427138">if</span>&nbsp;<span class="op" id="4427141">!</span><span class="ident" id="4427142">n</span><span class="op" id="4427143">.</span><span class="ident" id="4427144">IsUint</span>&nbsp;<span class="op" id="4427151">&amp;&amp;</span>&nbsp;<span class="builtintype" id="4427154">float64</span><span class="op" id="4427161">(</span><span class="ident" id="4427162">uint64</span><span class="op" id="4427168">(</span><span class="ident" id="4427169">f</span><span class="op" id="4427170">)</span><span class="op" id="4427171">)</span>&nbsp;<span class="op" id="4427173">==</span>&nbsp;<span class="ident" id="4427176">f</span>&nbsp;<span class="op" id="4427178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427184">n</span><span class="op" id="4427185">.</span><span class="ident" id="4427186">IsUint</span>&nbsp;<span class="op" id="4427193">=</span>&nbsp;<span class="builtintype" id="4427195">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427204">n</span><span class="op" id="4427205">.</span><span class="ident" id="4427206">Uint64</span>&nbsp;<span class="op" id="4427213">=</span>&nbsp;<span class="ident" id="4427215">uint64</span><span class="op" id="4427221">(</span><span class="ident" id="4427222">f</span><span class="op" id="4427223">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427238">if</span>&nbsp;<span class="op" id="4427241">!</span><span class="ident" id="4427242">n</span><span class="op" id="4427243">.</span><span class="ident" id="4427244">IsInt</span>&nbsp;<span class="op" id="4427250">&amp;&amp;</span>&nbsp;<span class="op" id="4427253">!</span><span class="ident" id="4427254">n</span><span class="op" id="4427255">.</span><span class="ident" id="4427256">IsUint</span>&nbsp;<span class="op" id="4427263">&amp;&amp;</span>&nbsp;<span class="op" id="4427266">!</span><span class="ident" id="4427267">n</span><span class="op" id="4427268">.</span><span class="ident" id="4427269">IsFloat</span>&nbsp;<span class="op" id="4427277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427281">return</span>&nbsp;<span class="builtintype" id="4427288">nil</span><span class="op" id="4427291">,</span>&nbsp;<span class="ident" id="4427293">fmt</span><span class="op" id="4427296">.</span><span class="ident" id="4427297">Errorf</span><span class="op" id="4427303">(</span><span class="string" id="4427304">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="4427331">,</span>&nbsp;<span class="ident" id="4427333">text</span><span class="op" id="4427337">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427343">return</span>&nbsp;<span class="ident" id="4427350">n</span><span class="op" id="4427351">,</span>&nbsp;<span class="builtintype" id="4427353">nil</span><br>
<span class="lineno"></span><span class="op" id="4427357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4427360">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="4427449">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="4427503">func</span>&nbsp;<span class="op" id="4427508">(</span><span class="ident" id="4427509">n</span>&nbsp;<span class="op" id="4427511">*</span><span class="ident" id="4427512">NumberNode</span><span class="op" id="4427522">)</span>&nbsp;<span class="ident" id="4427524">simplifyComplex</span><span class="op" id="4427539">(</span><span class="op" id="4427540">)</span>&nbsp;<span class="op" id="4427542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427545">n</span><span class="op" id="4427546">.</span><span class="ident" id="4427547">IsFloat</span>&nbsp;<span class="op" id="4427555">=</span>&nbsp;<span class="builtinfunc" id="4427557">imag</span><span class="op" id="4427561">(</span><span class="ident" id="4427562">n</span><span class="op" id="4427563">.</span><span class="ident" id="4427564">Complex128</span><span class="op" id="4427574">)</span>&nbsp;<span class="op" id="4427576">==</span>&nbsp;<span class="num" id="4427579">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427582">if</span>&nbsp;<span class="ident" id="4427585">n</span><span class="op" id="4427586">.</span><span class="ident" id="4427587">IsFloat</span>&nbsp;<span class="op" id="4427595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427599">n</span><span class="op" id="4427600">.</span><span class="ident" id="4427601">Float64</span>&nbsp;<span class="op" id="4427609">=</span>&nbsp;<span class="builtinfunc" id="4427611">real</span><span class="op" id="4427615">(</span><span class="ident" id="4427616">n</span><span class="op" id="4427617">.</span><span class="ident" id="4427618">Complex128</span><span class="op" id="4427628">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427632">n</span><span class="op" id="4427633">.</span><span class="ident" id="4427634">IsInt</span>&nbsp;<span class="op" id="4427640">=</span>&nbsp;<span class="builtintype" id="4427642">float64</span><span class="op" id="4427649">(</span><span class="ident" id="4427650">int64</span><span class="op" id="4427655">(</span><span class="ident" id="4427656">n</span><span class="op" id="4427657">.</span><span class="ident" id="4427658">Float64</span><span class="op" id="4427665">)</span><span class="op" id="4427666">)</span>&nbsp;<span class="op" id="4427668">==</span>&nbsp;<span class="ident" id="4427671">n</span><span class="op" id="4427672">.</span><span class="ident" id="4427673">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427683">if</span>&nbsp;<span class="ident" id="4427686">n</span><span class="op" id="4427687">.</span><span class="ident" id="4427688">IsInt</span>&nbsp;<span class="op" id="4427694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427699">n</span><span class="op" id="4427700">.</span><span class="ident" id="4427701">Int64</span>&nbsp;<span class="op" id="4427707">=</span>&nbsp;<span class="ident" id="4427709">int64</span><span class="op" id="4427714">(</span><span class="ident" id="4427715">n</span><span class="op" id="4427716">.</span><span class="ident" id="4427717">Float64</span><span class="op" id="4427724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427732">n</span><span class="op" id="4427733">.</span><span class="ident" id="4427734">IsUint</span>&nbsp;<span class="op" id="4427741">=</span>&nbsp;<span class="builtintype" id="4427743">float64</span><span class="op" id="4427750">(</span><span class="ident" id="4427751">uint64</span><span class="op" id="4427757">(</span><span class="ident" id="4427758">n</span><span class="op" id="4427759">.</span><span class="ident" id="4427760">Float64</span><span class="op" id="4427767">)</span><span class="op" id="4427768">)</span>&nbsp;<span class="op" id="4427770">==</span>&nbsp;<span class="ident" id="4427773">n</span><span class="op" id="4427774">.</span><span class="ident" id="4427775">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427785">if</span>&nbsp;<span class="ident" id="4427788">n</span><span class="op" id="4427789">.</span><span class="ident" id="4427790">IsUint</span>&nbsp;<span class="op" id="4427797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427802">n</span><span class="op" id="4427803">.</span><span class="ident" id="4427804">Uint64</span>&nbsp;<span class="op" id="4427811">=</span>&nbsp;<span class="ident" id="4427813">uint64</span><span class="op" id="4427819">(</span><span class="ident" id="4427820">n</span><span class="op" id="4427821">.</span><span class="ident" id="4427822">Float64</span><span class="op" id="4427829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427836">}</span><br>
<span class="lineno"></span><span class="op" id="4427838">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="4427841">func</span>&nbsp;<span class="op" id="4427846">(</span><span class="ident" id="4427847">n</span>&nbsp;<span class="op" id="4427849">*</span><span class="ident" id="4427850">NumberNode</span><span class="op" id="4427860">)</span>&nbsp;<span class="ident" id="4427862">String</span><span class="op" id="4427868">(</span><span class="op" id="4427869">)</span>&nbsp;<span class="builtintype" id="4427871">string</span>&nbsp;<span class="op" id="4427878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427881">return</span>&nbsp;<span class="ident" id="4427888">n</span><span class="op" id="4427889">.</span><span class="ident" id="4427890">Text</span><br>
<span class="lineno"></span><span class="op" id="4427895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="4427898">func</span>&nbsp;<span class="op" id="4427903">(</span><span class="ident" id="4427904">n</span>&nbsp;<span class="op" id="4427906">*</span><span class="ident" id="4427907">NumberNode</span><span class="op" id="4427917">)</span>&nbsp;<span class="ident" id="4427919">tree</span><span class="op" id="4427923">(</span><span class="op" id="4427924">)</span>&nbsp;<span class="op" id="4427926">*</span><span class="ident" id="4427927">Tree</span>&nbsp;<span class="op" id="4427932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427935">return</span>&nbsp;<span class="ident" id="4427942">n</span><span class="op" id="4427943">.</span><span class="ident" id="4427944">tr</span><br>
<span class="lineno"></span><span class="op" id="4427947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4427950">func</span>&nbsp;<span class="op" id="4427955">(</span><span class="ident" id="4427956">n</span>&nbsp;<span class="op" id="4427958">*</span><span class="ident" id="4427959">NumberNode</span><span class="op" id="4427969">)</span>&nbsp;<span class="ident" id="4427971">Copy</span><span class="op" id="4427975">(</span><span class="op" id="4427976">)</span>&nbsp;<span class="ident" id="4427978">Node</span>&nbsp;<span class="op" id="4427983">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427986">nn</span>&nbsp;<span class="op" id="4427989">:=</span>&nbsp;<span class="builtinfunc" id="4427992">new</span><span class="op" id="4427995">(</span><span class="ident" id="4427996">NumberNode</span><span class="op" id="4428006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428009">*</span><span class="ident" id="4428010">nn</span>&nbsp;<span class="op" id="4428013">=</span>&nbsp;<span class="op" id="4428015">*</span><span class="ident" id="4428016">n</span>&nbsp;<span class="comment" id="4428018">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428043">return</span>&nbsp;<span class="ident" id="4428050">nn</span><br>
<span class="lineno"></span><span class="op" id="4428053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="4428056">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4428126">type</span>&nbsp;<span class="ident" id="4428131">StringNode</span>&nbsp;<span class="keyword" id="4428142">struct</span>&nbsp;<span class="op" id="4428149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428152">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428162">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428167">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428174">*</span><span class="ident" id="4428175">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428181">Quoted</span>&nbsp;<span class="builtintype" id="4428188">string</span>&nbsp;<span class="comment" id="4428195">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428245">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4428252">string</span>&nbsp;<span class="comment" id="4428259">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="4428298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4428301">func</span>&nbsp;<span class="op" id="4428306">(</span><span class="ident" id="4428307">t</span>&nbsp;<span class="op" id="4428309">*</span><span class="ident" id="4428310">Tree</span><span class="op" id="4428314">)</span>&nbsp;<span class="ident" id="4428316">newString</span><span class="op" id="4428325">(</span><span class="ident" id="4428326">pos</span>&nbsp;<span class="ident" id="4428330">Pos</span><span class="op" id="4428333">,</span>&nbsp;<span class="ident" id="4428335">orig</span><span class="op" id="4428339">,</span>&nbsp;<span class="ident" id="4428341">text</span>&nbsp;<span class="builtintype" id="4428346">string</span><span class="op" id="4428352">)</span>&nbsp;<span class="op" id="4428354">*</span><span class="ident" id="4428355">StringNode</span>&nbsp;<span class="op" id="4428366">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428369">return</span>&nbsp;<span class="op" id="4428376">&amp;</span><span class="ident" id="4428377">StringNode</span><span class="op" id="4428387">{</span><span class="ident" id="4428388">tr</span><span class="op" id="4428390">:</span>&nbsp;<span class="ident" id="4428392">t</span><span class="op" id="4428393">,</span>&nbsp;<span class="ident" id="4428395">NodeType</span><span class="op" id="4428403">:</span>&nbsp;<span class="ident" id="4428405">NodeString</span><span class="op" id="4428415">,</span>&nbsp;<span class="ident" id="4428417">Pos</span><span class="op" id="4428420">:</span>&nbsp;<span class="ident" id="4428422">pos</span><span class="op" id="4428425">,</span>&nbsp;<span class="ident" id="4428427">Quoted</span><span class="op" id="4428433">:</span>&nbsp;<span class="ident" id="4428435">orig</span><span class="op" id="4428439">,</span>&nbsp;<span class="ident" id="4428441">Text</span><span class="op" id="4428445">:</span>&nbsp;<span class="ident" id="4428447">text</span><span class="op" id="4428451">}</span><br>
<span class="lineno"></span><span class="op" id="4428453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4428456">func</span>&nbsp;<span class="op" id="4428461">(</span><span class="ident" id="4428462">s</span>&nbsp;<span class="op" id="4428464">*</span><span class="ident" id="4428465">StringNode</span><span class="op" id="4428475">)</span>&nbsp;<span class="ident" id="4428477">String</span><span class="op" id="4428483">(</span><span class="op" id="4428484">)</span>&nbsp;<span class="builtintype" id="4428486">string</span>&nbsp;<span class="op" id="4428493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428496">return</span>&nbsp;<span class="ident" id="4428503">s</span><span class="op" id="4428504">.</span><span class="ident" id="4428505">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="4428512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4428515">func</span>&nbsp;<span class="op" id="4428520">(</span><span class="ident" id="4428521">s</span>&nbsp;<span class="op" id="4428523">*</span><span class="ident" id="4428524">StringNode</span><span class="op" id="4428534">)</span>&nbsp;<span class="ident" id="4428536">tree</span><span class="op" id="4428540">(</span><span class="op" id="4428541">)</span>&nbsp;<span class="op" id="4428543">*</span><span class="ident" id="4428544">Tree</span>&nbsp;<span class="op" id="4428549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428552">return</span>&nbsp;<span class="ident" id="4428559">s</span><span class="op" id="4428560">.</span><span class="ident" id="4428561">tr</span><br>
<span class="lineno"></span><span class="op" id="4428564">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="4428567">func</span>&nbsp;<span class="op" id="4428572">(</span><span class="ident" id="4428573">s</span>&nbsp;<span class="op" id="4428575">*</span><span class="ident" id="4428576">StringNode</span><span class="op" id="4428586">)</span>&nbsp;<span class="ident" id="4428588">Copy</span><span class="op" id="4428592">(</span><span class="op" id="4428593">)</span>&nbsp;<span class="ident" id="4428595">Node</span>&nbsp;<span class="op" id="4428600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428603">return</span>&nbsp;<span class="ident" id="4428610">s</span><span class="op" id="4428611">.</span><span class="ident" id="4428612">tr</span><span class="op" id="4428614">.</span><span class="ident" id="4428615">newString</span><span class="op" id="4428624">(</span><span class="ident" id="4428625">s</span><span class="op" id="4428626">.</span><span class="ident" id="4428627">Pos</span><span class="op" id="4428630">,</span>&nbsp;<span class="ident" id="4428632">s</span><span class="op" id="4428633">.</span><span class="ident" id="4428634">Quoted</span><span class="op" id="4428640">,</span>&nbsp;<span class="ident" id="4428642">s</span><span class="op" id="4428643">.</span><span class="ident" id="4428644">Text</span><span class="op" id="4428648">)</span><br>
<span class="lineno"></span><span class="op" id="4428650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="4428653">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="4428694">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="4428741">type</span>&nbsp;<span class="ident" id="4428746">endNode</span>&nbsp;<span class="keyword" id="4428754">struct</span>&nbsp;<span class="op" id="4428761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428764">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428774">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428779">tr</span>&nbsp;<span class="op" id="4428782">*</span><span class="ident" id="4428783">Tree</span><br>
<span class="lineno"></span><span class="op" id="4428788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4428791">func</span>&nbsp;<span class="op" id="4428796">(</span><span class="ident" id="4428797">t</span>&nbsp;<span class="op" id="4428799">*</span><span class="ident" id="4428800">Tree</span><span class="op" id="4428804">)</span>&nbsp;<span class="ident" id="4428806">newEnd</span><span class="op" id="4428812">(</span><span class="ident" id="4428813">pos</span>&nbsp;<span class="ident" id="4428817">Pos</span><span class="op" id="4428820">)</span>&nbsp;<span class="op" id="4428822">*</span><span class="ident" id="4428823">endNode</span>&nbsp;<span class="op" id="4428831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428834">return</span>&nbsp;<span class="op" id="4428841">&amp;</span><span class="ident" id="4428842">endNode</span><span class="op" id="4428849">{</span><span class="ident" id="4428850">tr</span><span class="op" id="4428852">:</span>&nbsp;<span class="ident" id="4428854">t</span><span class="op" id="4428855">,</span>&nbsp;<span class="ident" id="4428857">NodeType</span><span class="op" id="4428865">:</span>&nbsp;<span class="ident" id="4428867">nodeEnd</span><span class="op" id="4428874">,</span>&nbsp;<span class="ident" id="4428876">Pos</span><span class="op" id="4428879">:</span>&nbsp;<span class="ident" id="4428881">pos</span><span class="op" id="4428884">}</span><br>
<span class="lineno">680</span><span class="op" id="4428886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4428889">func</span>&nbsp;<span class="op" id="4428894">(</span><span class="ident" id="4428895">e</span>&nbsp;<span class="op" id="4428897">*</span><span class="ident" id="4428898">endNode</span><span class="op" id="4428905">)</span>&nbsp;<span class="ident" id="4428907">String</span><span class="op" id="4428913">(</span><span class="op" id="4428914">)</span>&nbsp;<span class="builtintype" id="4428916">string</span>&nbsp;<span class="op" id="4428923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428926">return</span>&nbsp;<span class="string" id="4428933">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="4428943">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="4428946">func</span>&nbsp;<span class="op" id="4428951">(</span><span class="ident" id="4428952">e</span>&nbsp;<span class="op" id="4428954">*</span><span class="ident" id="4428955">endNode</span><span class="op" id="4428962">)</span>&nbsp;<span class="ident" id="4428964">tree</span><span class="op" id="4428968">(</span><span class="op" id="4428969">)</span>&nbsp;<span class="op" id="4428971">*</span><span class="ident" id="4428972">Tree</span>&nbsp;<span class="op" id="4428977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428980">return</span>&nbsp;<span class="ident" id="4428987">e</span><span class="op" id="4428988">.</span><span class="ident" id="4428989">tr</span><br>
<span class="lineno"></span><span class="op" id="4428992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="4428995">func</span>&nbsp;<span class="op" id="4429000">(</span><span class="ident" id="4429001">e</span>&nbsp;<span class="op" id="4429003">*</span><span class="ident" id="4429004">endNode</span><span class="op" id="4429011">)</span>&nbsp;<span class="ident" id="4429013">Copy</span><span class="op" id="4429017">(</span><span class="op" id="4429018">)</span>&nbsp;<span class="ident" id="4429020">Node</span>&nbsp;<span class="op" id="4429025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429028">return</span>&nbsp;<span class="ident" id="4429035">e</span><span class="op" id="4429036">.</span><span class="ident" id="4429037">tr</span><span class="op" id="4429039">.</span><span class="ident" id="4429040">newEnd</span><span class="op" id="4429046">(</span><span class="ident" id="4429047">e</span><span class="op" id="4429048">.</span><span class="ident" id="4429049">Pos</span><span class="op" id="4429052">)</span><br>
<span class="lineno"></span><span class="op" id="4429054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4429057">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="4429135">type</span>&nbsp;<span class="ident" id="4429140">elseNode</span>&nbsp;<span class="keyword" id="4429149">struct</span>&nbsp;<span class="op" id="4429156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429159">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429169">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429174">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4429179">*</span><span class="ident" id="4429180">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429186">Line</span>&nbsp;<span class="builtintype" id="4429191">int</span>&nbsp;<span class="comment" id="4429195">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="4429264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4429267">func</span>&nbsp;<span class="op" id="4429272">(</span><span class="ident" id="4429273">t</span>&nbsp;<span class="op" id="4429275">*</span><span class="ident" id="4429276">Tree</span><span class="op" id="4429280">)</span>&nbsp;<span class="ident" id="4429282">newElse</span><span class="op" id="4429289">(</span><span class="ident" id="4429290">pos</span>&nbsp;<span class="ident" id="4429294">Pos</span><span class="op" id="4429297">,</span>&nbsp;<span class="ident" id="4429299">line</span>&nbsp;<span class="builtintype" id="4429304">int</span><span class="op" id="4429307">)</span>&nbsp;<span class="op" id="4429309">*</span><span class="ident" id="4429310">elseNode</span>&nbsp;<span class="op" id="4429319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429322">return</span>&nbsp;<span class="op" id="4429329">&amp;</span><span class="ident" id="4429330">elseNode</span><span class="op" id="4429338">{</span><span class="ident" id="4429339">tr</span><span class="op" id="4429341">:</span>&nbsp;<span class="ident" id="4429343">t</span><span class="op" id="4429344">,</span>&nbsp;<span class="ident" id="4429346">NodeType</span><span class="op" id="4429354">:</span>&nbsp;<span class="ident" id="4429356">nodeElse</span><span class="op" id="4429364">,</span>&nbsp;<span class="ident" id="4429366">Pos</span><span class="op" id="4429369">:</span>&nbsp;<span class="ident" id="4429371">pos</span><span class="op" id="4429374">,</span>&nbsp;<span class="ident" id="4429376">Line</span><span class="op" id="4429380">:</span>&nbsp;<span class="ident" id="4429382">line</span><span class="op" id="4429386">}</span><br>
<span class="lineno"></span><span class="op" id="4429388">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="4429391">func</span>&nbsp;<span class="op" id="4429396">(</span><span class="ident" id="4429397">e</span>&nbsp;<span class="op" id="4429399">*</span><span class="ident" id="4429400">elseNode</span><span class="op" id="4429408">)</span>&nbsp;<span class="ident" id="4429410">Type</span><span class="op" id="4429414">(</span><span class="op" id="4429415">)</span>&nbsp;<span class="ident" id="4429417">NodeType</span>&nbsp;<span class="op" id="4429426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429429">return</span>&nbsp;<span class="ident" id="4429436">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="4429445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="4429448">func</span>&nbsp;<span class="op" id="4429453">(</span><span class="ident" id="4429454">e</span>&nbsp;<span class="op" id="4429456">*</span><span class="ident" id="4429457">elseNode</span><span class="op" id="4429465">)</span>&nbsp;<span class="ident" id="4429467">String</span><span class="op" id="4429473">(</span><span class="op" id="4429474">)</span>&nbsp;<span class="builtintype" id="4429476">string</span>&nbsp;<span class="op" id="4429483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429486">return</span>&nbsp;<span class="string" id="4429493">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="4429504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4429507">func</span>&nbsp;<span class="op" id="4429512">(</span><span class="ident" id="4429513">e</span>&nbsp;<span class="op" id="4429515">*</span><span class="ident" id="4429516">elseNode</span><span class="op" id="4429524">)</span>&nbsp;<span class="ident" id="4429526">tree</span><span class="op" id="4429530">(</span><span class="op" id="4429531">)</span>&nbsp;<span class="op" id="4429533">*</span><span class="ident" id="4429534">Tree</span>&nbsp;<span class="op" id="4429539">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429542">return</span>&nbsp;<span class="ident" id="4429549">e</span><span class="op" id="4429550">.</span><span class="ident" id="4429551">tr</span><br>
<span class="lineno"></span><span class="op" id="4429554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4429557">func</span>&nbsp;<span class="op" id="4429562">(</span><span class="ident" id="4429563">e</span>&nbsp;<span class="op" id="4429565">*</span><span class="ident" id="4429566">elseNode</span><span class="op" id="4429574">)</span>&nbsp;<span class="ident" id="4429576">Copy</span><span class="op" id="4429580">(</span><span class="op" id="4429581">)</span>&nbsp;<span class="ident" id="4429583">Node</span>&nbsp;<span class="op" id="4429588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429591">return</span>&nbsp;<span class="ident" id="4429598">e</span><span class="op" id="4429599">.</span><span class="ident" id="4429600">tr</span><span class="op" id="4429602">.</span><span class="ident" id="4429603">newElse</span><span class="op" id="4429610">(</span><span class="ident" id="4429611">e</span><span class="op" id="4429612">.</span><span class="ident" id="4429613">Pos</span><span class="op" id="4429616">,</span>&nbsp;<span class="ident" id="4429618">e</span><span class="op" id="4429619">.</span><span class="ident" id="4429620">Line</span><span class="op" id="4429624">)</span><br>
<span class="lineno">720</span><span class="op" id="4429626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4429629">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="4429696">type</span>&nbsp;<span class="ident" id="4429701">BranchNode</span>&nbsp;<span class="keyword" id="4429712">struct</span>&nbsp;<span class="op" id="4429719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429722">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429732">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429737">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4429746">*</span><span class="ident" id="4429747">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429753">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4429762">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429772">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429842">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4429851">*</span><span class="ident" id="4429852">PipeNode</span>&nbsp;<span class="comment" id="4429861">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429895">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4429904">*</span><span class="ident" id="4429905">ListNode</span>&nbsp;<span class="comment" id="4429914">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429961">ElseList</span>&nbsp;<span class="op" id="4429970">*</span><span class="ident" id="4429971">ListNode</span>&nbsp;<span class="comment" id="4429980">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="4430038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4430041">func</span>&nbsp;<span class="op" id="4430046">(</span><span class="ident" id="4430047">b</span>&nbsp;<span class="op" id="4430049">*</span><span class="ident" id="4430050">BranchNode</span><span class="op" id="4430060">)</span>&nbsp;<span class="ident" id="4430062">String</span><span class="op" id="4430068">(</span><span class="op" id="4430069">)</span>&nbsp;<span class="builtintype" id="4430071">string</span>&nbsp;<span class="op" id="4430078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430081">name</span>&nbsp;<span class="op" id="4430086">:=</span>&nbsp;<span class="string" id="4430089">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430093">switch</span>&nbsp;<span class="ident" id="4430100">b</span><span class="op" id="4430101">.</span><span class="ident" id="4430102">NodeType</span>&nbsp;<span class="op" id="4430111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430114">case</span>&nbsp;<span class="ident" id="4430119">NodeIf</span><span class="op" id="4430125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430129">name</span>&nbsp;<span class="op" id="4430134">=</span>&nbsp;<span class="string" id="4430136">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430142">case</span>&nbsp;<span class="ident" id="4430147">NodeRange</span><span class="op" id="4430156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430160">name</span>&nbsp;<span class="op" id="4430165">=</span>&nbsp;<span class="string" id="4430167">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430176">case</span>&nbsp;<span class="ident" id="4430181">NodeWith</span><span class="op" id="4430189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430193">name</span>&nbsp;<span class="op" id="4430198">=</span>&nbsp;<span class="string" id="4430200">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430208">default</span><span class="op" id="4430215">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4430219">panic</span><span class="op" id="4430224">(</span><span class="string" id="4430225">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="4430246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4430249">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430252">if</span>&nbsp;<span class="ident" id="4430255">b</span><span class="op" id="4430256">.</span><span class="ident" id="4430257">ElseList</span>&nbsp;<span class="op" id="4430266">!=</span>&nbsp;<span class="builtintype" id="4430269">nil</span>&nbsp;<span class="op" id="4430273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430277">return</span>&nbsp;<span class="ident" id="4430284">fmt</span><span class="op" id="4430287">.</span><span class="ident" id="4430288">Sprintf</span><span class="op" id="4430295">(</span><span class="string" id="4430296">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="4430326">,</span>&nbsp;<span class="ident" id="4430328">name</span><span class="op" id="4430332">,</span>&nbsp;<span class="ident" id="4430334">b</span><span class="op" id="4430335">.</span><span class="ident" id="4430336">Pipe</span><span class="op" id="4430340">,</span>&nbsp;<span class="ident" id="4430342">b</span><span class="op" id="4430343">.</span><span class="ident" id="4430344">List</span><span class="op" id="4430348">,</span>&nbsp;<span class="ident" id="4430350">b</span><span class="op" id="4430351">.</span><span class="ident" id="4430352">ElseList</span><span class="op" id="4430360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4430363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430366">return</span>&nbsp;<span class="ident" id="4430373">fmt</span><span class="op" id="4430376">.</span><span class="ident" id="4430377">Sprintf</span><span class="op" id="4430384">(</span><span class="string" id="4430385">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="4430405">,</span>&nbsp;<span class="ident" id="4430407">name</span><span class="op" id="4430411">,</span>&nbsp;<span class="ident" id="4430413">b</span><span class="op" id="4430414">.</span><span class="ident" id="4430415">Pipe</span><span class="op" id="4430419">,</span>&nbsp;<span class="ident" id="4430421">b</span><span class="op" id="4430422">.</span><span class="ident" id="4430423">List</span><span class="op" id="4430427">)</span><br>
<span class="lineno"></span><span class="op" id="4430429">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="4430432">func</span>&nbsp;<span class="op" id="4430437">(</span><span class="ident" id="4430438">b</span>&nbsp;<span class="op" id="4430440">*</span><span class="ident" id="4430441">BranchNode</span><span class="op" id="4430451">)</span>&nbsp;<span class="ident" id="4430453">tree</span><span class="op" id="4430457">(</span><span class="op" id="4430458">)</span>&nbsp;<span class="op" id="4430460">*</span><span class="ident" id="4430461">Tree</span>&nbsp;<span class="op" id="4430466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430469">return</span>&nbsp;<span class="ident" id="4430476">b</span><span class="op" id="4430477">.</span><span class="ident" id="4430478">tr</span><br>
<span class="lineno"></span><span class="op" id="4430481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="4430484">func</span>&nbsp;<span class="op" id="4430489">(</span><span class="ident" id="4430490">b</span>&nbsp;<span class="op" id="4430492">*</span><span class="ident" id="4430493">BranchNode</span><span class="op" id="4430503">)</span>&nbsp;<span class="ident" id="4430505">Copy</span><span class="op" id="4430509">(</span><span class="op" id="4430510">)</span>&nbsp;<span class="ident" id="4430512">Node</span>&nbsp;<span class="op" id="4430517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430520">switch</span>&nbsp;<span class="ident" id="4430527">b</span><span class="op" id="4430528">.</span><span class="ident" id="4430529">NodeType</span>&nbsp;<span class="op" id="4430538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430541">case</span>&nbsp;<span class="ident" id="4430546">NodeIf</span><span class="op" id="4430552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430556">return</span>&nbsp;<span class="ident" id="4430563">b</span><span class="op" id="4430564">.</span><span class="ident" id="4430565">tr</span><span class="op" id="4430567">.</span><span class="ident" id="4430568">newIf</span><span class="op" id="4430573">(</span><span class="ident" id="4430574">b</span><span class="op" id="4430575">.</span><span class="ident" id="4430576">Pos</span><span class="op" id="4430579">,</span>&nbsp;<span class="ident" id="4430581">b</span><span class="op" id="4430582">.</span><span class="ident" id="4430583">Line</span><span class="op" id="4430587">,</span>&nbsp;<span class="ident" id="4430589">b</span><span class="op" id="4430590">.</span><span class="ident" id="4430591">Pipe</span><span class="op" id="4430595">,</span>&nbsp;<span class="ident" id="4430597">b</span><span class="op" id="4430598">.</span><span class="ident" id="4430599">List</span><span class="op" id="4430603">,</span>&nbsp;<span class="ident" id="4430605">b</span><span class="op" id="4430606">.</span><span class="ident" id="4430607">ElseList</span><span class="op" id="4430615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430618">case</span>&nbsp;<span class="ident" id="4430623">NodeRange</span><span class="op" id="4430632">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430636">return</span>&nbsp;<span class="ident" id="4430643">b</span><span class="op" id="4430644">.</span><span class="ident" id="4430645">tr</span><span class="op" id="4430647">.</span><span class="ident" id="4430648">newRange</span><span class="op" id="4430656">(</span><span class="ident" id="4430657">b</span><span class="op" id="4430658">.</span><span class="ident" id="4430659">Pos</span><span class="op" id="4430662">,</span>&nbsp;<span class="ident" id="4430664">b</span><span class="op" id="4430665">.</span><span class="ident" id="4430666">Line</span><span class="op" id="4430670">,</span>&nbsp;<span class="ident" id="4430672">b</span><span class="op" id="4430673">.</span><span class="ident" id="4430674">Pipe</span><span class="op" id="4430678">,</span>&nbsp;<span class="ident" id="4430680">b</span><span class="op" id="4430681">.</span><span class="ident" id="4430682">List</span><span class="op" id="4430686">,</span>&nbsp;<span class="ident" id="4430688">b</span><span class="op" id="4430689">.</span><span class="ident" id="4430690">ElseList</span><span class="op" id="4430698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430701">case</span>&nbsp;<span class="ident" id="4430706">NodeWith</span><span class="op" id="4430714">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430718">return</span>&nbsp;<span class="ident" id="4430725">b</span><span class="op" id="4430726">.</span><span class="ident" id="4430727">tr</span><span class="op" id="4430729">.</span><span class="ident" id="4430730">newWith</span><span class="op" id="4430737">(</span><span class="ident" id="4430738">b</span><span class="op" id="4430739">.</span><span class="ident" id="4430740">Pos</span><span class="op" id="4430743">,</span>&nbsp;<span class="ident" id="4430745">b</span><span class="op" id="4430746">.</span><span class="ident" id="4430747">Line</span><span class="op" id="4430751">,</span>&nbsp;<span class="ident" id="4430753">b</span><span class="op" id="4430754">.</span><span class="ident" id="4430755">Pipe</span><span class="op" id="4430759">,</span>&nbsp;<span class="ident" id="4430761">b</span><span class="op" id="4430762">.</span><span class="ident" id="4430763">List</span><span class="op" id="4430767">,</span>&nbsp;<span class="ident" id="4430769">b</span><span class="op" id="4430770">.</span><span class="ident" id="4430771">ElseList</span><span class="op" id="4430779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4430782">default</span><span class="op" id="4430789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4430793">panic</span><span class="op" id="4430798">(</span><span class="string" id="4430799">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="4430820">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4430823">}</span><br>
<span class="lineno"></span><span class="op" id="4430825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4430828">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="4430884">type</span>&nbsp;<span class="ident" id="4430889">IfNode</span>&nbsp;<span class="keyword" id="4430896">struct</span>&nbsp;<span class="op" id="4430903">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430906">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4430917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4430920">func</span>&nbsp;<span class="op" id="4430925">(</span><span class="ident" id="4430926">t</span>&nbsp;<span class="op" id="4430928">*</span><span class="ident" id="4430929">Tree</span><span class="op" id="4430933">)</span>&nbsp;<span class="ident" id="4430935">newIf</span><span class="op" id="4430940">(</span><span class="ident" id="4430941">pos</span>&nbsp;<span class="ident" id="4430945">Pos</span><span class="op" id="4430948">,</span>&nbsp;<span class="ident" id="4430950">line</span>&nbsp;<span class="builtintype" id="4430955">int</span><span class="op" id="4430958">,</span>&nbsp;<span class="ident" id="4430960">pipe</span>&nbsp;<span class="op" id="4430965">*</span><span class="ident" id="4430966">PipeNode</span><span class="op" id="4430974">,</span>&nbsp;<span class="ident" id="4430976">list</span><span class="op" id="4430980">,</span>&nbsp;<span class="ident" id="4430982">elseList</span>&nbsp;<span class="op" id="4430991">*</span><span class="ident" id="4430992">ListNode</span><span class="op" id="4431000">)</span>&nbsp;<span class="op" id="4431002">*</span><span class="ident" id="4431003">IfNode</span>&nbsp;<span class="op" id="4431010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431013">return</span>&nbsp;<span class="op" id="4431020">&amp;</span><span class="ident" id="4431021">IfNode</span><span class="op" id="4431027">{</span><span class="ident" id="4431028">BranchNode</span><span class="op" id="4431038">{</span><span class="ident" id="4431039">tr</span><span class="op" id="4431041">:</span>&nbsp;<span class="ident" id="4431043">t</span><span class="op" id="4431044">,</span>&nbsp;<span class="ident" id="4431046">NodeType</span><span class="op" id="4431054">:</span>&nbsp;<span class="ident" id="4431056">NodeIf</span><span class="op" id="4431062">,</span>&nbsp;<span class="ident" id="4431064">Pos</span><span class="op" id="4431067">:</span>&nbsp;<span class="ident" id="4431069">pos</span><span class="op" id="4431072">,</span>&nbsp;<span class="ident" id="4431074">Line</span><span class="op" id="4431078">:</span>&nbsp;<span class="ident" id="4431080">line</span><span class="op" id="4431084">,</span>&nbsp;<span class="ident" id="4431086">Pipe</span><span class="op" id="4431090">:</span>&nbsp;<span class="ident" id="4431092">pipe</span><span class="op" id="4431096">,</span>&nbsp;<span class="ident" id="4431098">List</span><span class="op" id="4431102">:</span>&nbsp;<span class="ident" id="4431104">list</span><span class="op" id="4431108">,</span>&nbsp;<span class="ident" id="4431110">ElseList</span><span class="op" id="4431118">:</span>&nbsp;<span class="ident" id="4431120">elseList</span><span class="op" id="4431128">}</span><span class="op" id="4431129">}</span><br>
<span class="lineno">775</span><span class="op" id="4431131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4431134">func</span>&nbsp;<span class="op" id="4431139">(</span><span class="ident" id="4431140">i</span>&nbsp;<span class="op" id="4431142">*</span><span class="ident" id="4431143">IfNode</span><span class="op" id="4431149">)</span>&nbsp;<span class="ident" id="4431151">Copy</span><span class="op" id="4431155">(</span><span class="op" id="4431156">)</span>&nbsp;<span class="ident" id="4431158">Node</span>&nbsp;<span class="op" id="4431163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431166">return</span>&nbsp;<span class="ident" id="4431173">i</span><span class="op" id="4431174">.</span><span class="ident" id="4431175">tr</span><span class="op" id="4431177">.</span><span class="ident" id="4431178">newIf</span><span class="op" id="4431183">(</span><span class="ident" id="4431184">i</span><span class="op" id="4431185">.</span><span class="ident" id="4431186">Pos</span><span class="op" id="4431189">,</span>&nbsp;<span class="ident" id="4431191">i</span><span class="op" id="4431192">.</span><span class="ident" id="4431193">Line</span><span class="op" id="4431197">,</span>&nbsp;<span class="ident" id="4431199">i</span><span class="op" id="4431200">.</span><span class="ident" id="4431201">Pipe</span><span class="op" id="4431205">.</span><span class="ident" id="4431206">CopyPipe</span><span class="op" id="4431214">(</span><span class="op" id="4431215">)</span><span class="op" id="4431216">,</span>&nbsp;<span class="ident" id="4431218">i</span><span class="op" id="4431219">.</span><span class="ident" id="4431220">List</span><span class="op" id="4431224">.</span><span class="ident" id="4431225">CopyList</span><span class="op" id="4431233">(</span><span class="op" id="4431234">)</span><span class="op" id="4431235">,</span>&nbsp;<span class="ident" id="4431237">i</span><span class="op" id="4431238">.</span><span class="ident" id="4431239">ElseList</span><span class="op" id="4431247">.</span><span class="ident" id="4431248">CopyList</span><span class="op" id="4431256">(</span><span class="op" id="4431257">)</span><span class="op" id="4431258">)</span><br>
<span class="lineno"></span><span class="op" id="4431260">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="4431263">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="4431324">type</span>&nbsp;<span class="ident" id="4431329">RangeNode</span>&nbsp;<span class="keyword" id="4431339">struct</span>&nbsp;<span class="op" id="4431346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4431349">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4431360">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="4431363">func</span>&nbsp;<span class="op" id="4431368">(</span><span class="ident" id="4431369">t</span>&nbsp;<span class="op" id="4431371">*</span><span class="ident" id="4431372">Tree</span><span class="op" id="4431376">)</span>&nbsp;<span class="ident" id="4431378">newRange</span><span class="op" id="4431386">(</span><span class="ident" id="4431387">pos</span>&nbsp;<span class="ident" id="4431391">Pos</span><span class="op" id="4431394">,</span>&nbsp;<span class="ident" id="4431396">line</span>&nbsp;<span class="builtintype" id="4431401">int</span><span class="op" id="4431404">,</span>&nbsp;<span class="ident" id="4431406">pipe</span>&nbsp;<span class="op" id="4431411">*</span><span class="ident" id="4431412">PipeNode</span><span class="op" id="4431420">,</span>&nbsp;<span class="ident" id="4431422">list</span><span class="op" id="4431426">,</span>&nbsp;<span class="ident" id="4431428">elseList</span>&nbsp;<span class="op" id="4431437">*</span><span class="ident" id="4431438">ListNode</span><span class="op" id="4431446">)</span>&nbsp;<span class="op" id="4431448">*</span><span class="ident" id="4431449">RangeNode</span>&nbsp;<span class="op" id="4431459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431462">return</span>&nbsp;<span class="op" id="4431469">&amp;</span><span class="ident" id="4431470">RangeNode</span><span class="op" id="4431479">{</span><span class="ident" id="4431480">BranchNode</span><span class="op" id="4431490">{</span><span class="ident" id="4431491">tr</span><span class="op" id="4431493">:</span>&nbsp;<span class="ident" id="4431495">t</span><span class="op" id="4431496">,</span>&nbsp;<span class="ident" id="4431498">NodeType</span><span class="op" id="4431506">:</span>&nbsp;<span class="ident" id="4431508">NodeRange</span><span class="op" id="4431517">,</span>&nbsp;<span class="ident" id="4431519">Pos</span><span class="op" id="4431522">:</span>&nbsp;<span class="ident" id="4431524">pos</span><span class="op" id="4431527">,</span>&nbsp;<span class="ident" id="4431529">Line</span><span class="op" id="4431533">:</span>&nbsp;<span class="ident" id="4431535">line</span><span class="op" id="4431539">,</span>&nbsp;<span class="ident" id="4431541">Pipe</span><span class="op" id="4431545">:</span>&nbsp;<span class="ident" id="4431547">pipe</span><span class="op" id="4431551">,</span>&nbsp;<span class="ident" id="4431553">List</span><span class="op" id="4431557">:</span>&nbsp;<span class="ident" id="4431559">list</span><span class="op" id="4431563">,</span>&nbsp;<span class="ident" id="4431565">ElseList</span><span class="op" id="4431573">:</span>&nbsp;<span class="ident" id="4431575">elseList</span><span class="op" id="4431583">}</span><span class="op" id="4431584">}</span><br>
<span class="lineno"></span><span class="op" id="4431586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="4431589">func</span>&nbsp;<span class="op" id="4431594">(</span><span class="ident" id="4431595">r</span>&nbsp;<span class="op" id="4431597">*</span><span class="ident" id="4431598">RangeNode</span><span class="op" id="4431607">)</span>&nbsp;<span class="ident" id="4431609">Copy</span><span class="op" id="4431613">(</span><span class="op" id="4431614">)</span>&nbsp;<span class="ident" id="4431616">Node</span>&nbsp;<span class="op" id="4431621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431624">return</span>&nbsp;<span class="ident" id="4431631">r</span><span class="op" id="4431632">.</span><span class="ident" id="4431633">tr</span><span class="op" id="4431635">.</span><span class="ident" id="4431636">newRange</span><span class="op" id="4431644">(</span><span class="ident" id="4431645">r</span><span class="op" id="4431646">.</span><span class="ident" id="4431647">Pos</span><span class="op" id="4431650">,</span>&nbsp;<span class="ident" id="4431652">r</span><span class="op" id="4431653">.</span><span class="ident" id="4431654">Line</span><span class="op" id="4431658">,</span>&nbsp;<span class="ident" id="4431660">r</span><span class="op" id="4431661">.</span><span class="ident" id="4431662">Pipe</span><span class="op" id="4431666">.</span><span class="ident" id="4431667">CopyPipe</span><span class="op" id="4431675">(</span><span class="op" id="4431676">)</span><span class="op" id="4431677">,</span>&nbsp;<span class="ident" id="4431679">r</span><span class="op" id="4431680">.</span><span class="ident" id="4431681">List</span><span class="op" id="4431685">.</span><span class="ident" id="4431686">CopyList</span><span class="op" id="4431694">(</span><span class="op" id="4431695">)</span><span class="op" id="4431696">,</span>&nbsp;<span class="ident" id="4431698">r</span><span class="op" id="4431699">.</span><span class="ident" id="4431700">ElseList</span><span class="op" id="4431708">.</span><span class="ident" id="4431709">CopyList</span><span class="op" id="4431717">(</span><span class="op" id="4431718">)</span><span class="op" id="4431719">)</span><br>
<span class="lineno"></span><span class="op" id="4431721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4431724">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="4431783">type</span>&nbsp;<span class="ident" id="4431788">WithNode</span>&nbsp;<span class="keyword" id="4431797">struct</span>&nbsp;<span class="op" id="4431804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4431807">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4431818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4431821">func</span>&nbsp;<span class="op" id="4431826">(</span><span class="ident" id="4431827">t</span>&nbsp;<span class="op" id="4431829">*</span><span class="ident" id="4431830">Tree</span><span class="op" id="4431834">)</span>&nbsp;<span class="ident" id="4431836">newWith</span><span class="op" id="4431843">(</span><span class="ident" id="4431844">pos</span>&nbsp;<span class="ident" id="4431848">Pos</span><span class="op" id="4431851">,</span>&nbsp;<span class="ident" id="4431853">line</span>&nbsp;<span class="builtintype" id="4431858">int</span><span class="op" id="4431861">,</span>&nbsp;<span class="ident" id="4431863">pipe</span>&nbsp;<span class="op" id="4431868">*</span><span class="ident" id="4431869">PipeNode</span><span class="op" id="4431877">,</span>&nbsp;<span class="ident" id="4431879">list</span><span class="op" id="4431883">,</span>&nbsp;<span class="ident" id="4431885">elseList</span>&nbsp;<span class="op" id="4431894">*</span><span class="ident" id="4431895">ListNode</span><span class="op" id="4431903">)</span>&nbsp;<span class="op" id="4431905">*</span><span class="ident" id="4431906">WithNode</span>&nbsp;<span class="op" id="4431915">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431918">return</span>&nbsp;<span class="op" id="4431925">&amp;</span><span class="ident" id="4431926">WithNode</span><span class="op" id="4431934">{</span><span class="ident" id="4431935">BranchNode</span><span class="op" id="4431945">{</span><span class="ident" id="4431946">tr</span><span class="op" id="4431948">:</span>&nbsp;<span class="ident" id="4431950">t</span><span class="op" id="4431951">,</span>&nbsp;<span class="ident" id="4431953">NodeType</span><span class="op" id="4431961">:</span>&nbsp;<span class="ident" id="4431963">NodeWith</span><span class="op" id="4431971">,</span>&nbsp;<span class="ident" id="4431973">Pos</span><span class="op" id="4431976">:</span>&nbsp;<span class="ident" id="4431978">pos</span><span class="op" id="4431981">,</span>&nbsp;<span class="ident" id="4431983">Line</span><span class="op" id="4431987">:</span>&nbsp;<span class="ident" id="4431989">line</span><span class="op" id="4431993">,</span>&nbsp;<span class="ident" id="4431995">Pipe</span><span class="op" id="4431999">:</span>&nbsp;<span class="ident" id="4432001">pipe</span><span class="op" id="4432005">,</span>&nbsp;<span class="ident" id="4432007">List</span><span class="op" id="4432011">:</span>&nbsp;<span class="ident" id="4432013">list</span><span class="op" id="4432017">,</span>&nbsp;<span class="ident" id="4432019">ElseList</span><span class="op" id="4432027">:</span>&nbsp;<span class="ident" id="4432029">elseList</span><span class="op" id="4432037">}</span><span class="op" id="4432038">}</span><br>
<span class="lineno"></span><span class="op" id="4432040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4432043">func</span>&nbsp;<span class="op" id="4432048">(</span><span class="ident" id="4432049">w</span>&nbsp;<span class="op" id="4432051">*</span><span class="ident" id="4432052">WithNode</span><span class="op" id="4432060">)</span>&nbsp;<span class="ident" id="4432062">Copy</span><span class="op" id="4432066">(</span><span class="op" id="4432067">)</span>&nbsp;<span class="ident" id="4432069">Node</span>&nbsp;<span class="op" id="4432074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432077">return</span>&nbsp;<span class="ident" id="4432084">w</span><span class="op" id="4432085">.</span><span class="ident" id="4432086">tr</span><span class="op" id="4432088">.</span><span class="ident" id="4432089">newWith</span><span class="op" id="4432096">(</span><span class="ident" id="4432097">w</span><span class="op" id="4432098">.</span><span class="ident" id="4432099">Pos</span><span class="op" id="4432102">,</span>&nbsp;<span class="ident" id="4432104">w</span><span class="op" id="4432105">.</span><span class="ident" id="4432106">Line</span><span class="op" id="4432110">,</span>&nbsp;<span class="ident" id="4432112">w</span><span class="op" id="4432113">.</span><span class="ident" id="4432114">Pipe</span><span class="op" id="4432118">.</span><span class="ident" id="4432119">CopyPipe</span><span class="op" id="4432127">(</span><span class="op" id="4432128">)</span><span class="op" id="4432129">,</span>&nbsp;<span class="ident" id="4432131">w</span><span class="op" id="4432132">.</span><span class="ident" id="4432133">List</span><span class="op" id="4432137">.</span><span class="ident" id="4432138">CopyList</span><span class="op" id="4432146">(</span><span class="op" id="4432147">)</span><span class="op" id="4432148">,</span>&nbsp;<span class="ident" id="4432150">w</span><span class="op" id="4432151">.</span><span class="ident" id="4432152">ElseList</span><span class="op" id="4432160">.</span><span class="ident" id="4432161">CopyList</span><span class="op" id="4432169">(</span><span class="op" id="4432170">)</span><span class="op" id="4432171">)</span><br>
<span class="lineno">805</span><span class="op" id="4432173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4432176">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4432226">type</span>&nbsp;<span class="ident" id="4432231">TemplateNode</span>&nbsp;<span class="keyword" id="4432244">struct</span>&nbsp;<span class="op" id="4432251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432254">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432264">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432269">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4432274">*</span><span class="ident" id="4432275">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432281">Line</span>&nbsp;<span class="builtintype" id="4432286">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4432296">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432366">Name</span>&nbsp;<span class="builtintype" id="4432371">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4432381">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432422">Pipe</span>&nbsp;<span class="op" id="4432427">*</span><span class="ident" id="4432428">PipeNode</span>&nbsp;<span class="comment" id="4432437">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="4432489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4432492">func</span>&nbsp;<span class="op" id="4432497">(</span><span class="ident" id="4432498">t</span>&nbsp;<span class="op" id="4432500">*</span><span class="ident" id="4432501">Tree</span><span class="op" id="4432505">)</span>&nbsp;<span class="ident" id="4432507">newTemplate</span><span class="op" id="4432518">(</span><span class="ident" id="4432519">pos</span>&nbsp;<span class="ident" id="4432523">Pos</span><span class="op" id="4432526">,</span>&nbsp;<span class="ident" id="4432528">line</span>&nbsp;<span class="builtintype" id="4432533">int</span><span class="op" id="4432536">,</span>&nbsp;<span class="ident" id="4432538">name</span>&nbsp;<span class="builtintype" id="4432543">string</span><span class="op" id="4432549">,</span>&nbsp;<span class="ident" id="4432551">pipe</span>&nbsp;<span class="op" id="4432556">*</span><span class="ident" id="4432557">PipeNode</span><span class="op" id="4432565">)</span>&nbsp;<span class="op" id="4432567">*</span><span class="ident" id="4432568">TemplateNode</span>&nbsp;<span class="op" id="4432581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432584">return</span>&nbsp;<span class="op" id="4432591">&amp;</span><span class="ident" id="4432592">TemplateNode</span><span class="op" id="4432604">{</span><span class="ident" id="4432605">tr</span><span class="op" id="4432607">:</span>&nbsp;<span class="ident" id="4432609">t</span><span class="op" id="4432610">,</span>&nbsp;<span class="ident" id="4432612">NodeType</span><span class="op" id="4432620">:</span>&nbsp;<span class="ident" id="4432622">NodeTemplate</span><span class="op" id="4432634">,</span>&nbsp;<span class="ident" id="4432636">Pos</span><span class="op" id="4432639">:</span>&nbsp;<span class="ident" id="4432641">pos</span><span class="op" id="4432644">,</span>&nbsp;<span class="ident" id="4432646">Line</span><span class="op" id="4432650">:</span>&nbsp;<span class="ident" id="4432652">line</span><span class="op" id="4432656">,</span>&nbsp;<span class="ident" id="4432658">Name</span><span class="op" id="4432662">:</span>&nbsp;<span class="ident" id="4432664">name</span><span class="op" id="4432668">,</span>&nbsp;<span class="ident" id="4432670">Pipe</span><span class="op" id="4432674">:</span>&nbsp;<span class="ident" id="4432676">pipe</span><span class="op" id="4432680">}</span><br>
<span class="lineno"></span><span class="op" id="4432682">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="4432685">func</span>&nbsp;<span class="op" id="4432690">(</span><span class="ident" id="4432691">t</span>&nbsp;<span class="op" id="4432693">*</span><span class="ident" id="4432694">TemplateNode</span><span class="op" id="4432706">)</span>&nbsp;<span class="ident" id="4432708">String</span><span class="op" id="4432714">(</span><span class="op" id="4432715">)</span>&nbsp;<span class="builtintype" id="4432717">string</span>&nbsp;<span class="op" id="4432724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432727">if</span>&nbsp;<span class="ident" id="4432730">t</span><span class="op" id="4432731">.</span><span class="ident" id="4432732">Pipe</span>&nbsp;<span class="op" id="4432737">==</span>&nbsp;<span class="builtintype" id="4432740">nil</span>&nbsp;<span class="op" id="4432744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432748">return</span>&nbsp;<span class="ident" id="4432755">fmt</span><span class="op" id="4432758">.</span><span class="ident" id="4432759">Sprintf</span><span class="op" id="4432766">(</span><span class="string" id="4432767">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="4432784">,</span>&nbsp;<span class="ident" id="4432786">t</span><span class="op" id="4432787">.</span><span class="ident" id="4432788">Name</span><span class="op" id="4432792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4432795">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432798">return</span>&nbsp;<span class="ident" id="4432805">fmt</span><span class="op" id="4432808">.</span><span class="ident" id="4432809">Sprintf</span><span class="op" id="4432816">(</span><span class="string" id="4432817">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="4432837">,</span>&nbsp;<span class="ident" id="4432839">t</span><span class="op" id="4432840">.</span><span class="ident" id="4432841">Name</span><span class="op" id="4432845">,</span>&nbsp;<span class="ident" id="4432847">t</span><span class="op" id="4432848">.</span><span class="ident" id="4432849">Pipe</span><span class="op" id="4432853">)</span><br>
<span class="lineno"></span><span class="op" id="4432855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4432858">func</span>&nbsp;<span class="op" id="4432863">(</span><span class="ident" id="4432864">t</span>&nbsp;<span class="op" id="4432866">*</span><span class="ident" id="4432867">TemplateNode</span><span class="op" id="4432879">)</span>&nbsp;<span class="ident" id="4432881">tree</span><span class="op" id="4432885">(</span><span class="op" id="4432886">)</span>&nbsp;<span class="op" id="4432888">*</span><span class="ident" id="4432889">Tree</span>&nbsp;<span class="op" id="4432894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432897">return</span>&nbsp;<span class="ident" id="4432904">t</span><span class="op" id="4432905">.</span><span class="ident" id="4432906">tr</span><br>
<span class="lineno">830</span><span class="op" id="4432909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4432912">func</span>&nbsp;<span class="op" id="4432917">(</span><span class="ident" id="4432918">t</span>&nbsp;<span class="op" id="4432920">*</span><span class="ident" id="4432921">TemplateNode</span><span class="op" id="4432933">)</span>&nbsp;<span class="ident" id="4432935">Copy</span><span class="op" id="4432939">(</span><span class="op" id="4432940">)</span>&nbsp;<span class="ident" id="4432942">Node</span>&nbsp;<span class="op" id="4432947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432950">return</span>&nbsp;<span class="ident" id="4432957">t</span><span class="op" id="4432958">.</span><span class="ident" id="4432959">tr</span><span class="op" id="4432961">.</span><span class="ident" id="4432962">newTemplate</span><span class="op" id="4432973">(</span><span class="ident" id="4432974">t</span><span class="op" id="4432975">.</span><span class="ident" id="4432976">Pos</span><span class="op" id="4432979">,</span>&nbsp;<span class="ident" id="4432981">t</span><span class="op" id="4432982">.</span><span class="ident" id="4432983">Line</span><span class="op" id="4432987">,</span>&nbsp;<span class="ident" id="4432989">t</span><span class="op" id="4432990">.</span><span class="ident" id="4432991">Name</span><span class="op" id="4432995">,</span>&nbsp;<span class="ident" id="4432997">t</span><span class="op" id="4432998">.</span><span class="ident" id="4432999">Pipe</span><span class="op" id="4433003">.</span><span class="ident" id="4433004">CopyPipe</span><span class="op" id="4433012">(</span><span class="op" id="4433013">)</span><span class="op" id="4433014">)</span><br>
<span class="lineno"></span><span class="op" id="4433016">}</span>
</div>
</body>
</html>
