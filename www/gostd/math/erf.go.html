<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html" class="current">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2185485">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2185540">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2185594">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2185645">package</span>&nbsp;<span class="ident" id="2185653">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2185659">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2185731">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2185785">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2185837">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2185892">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2185922">//</span><br>
<span class="lineno"></span><span class="comment" id="2185925">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2185981">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2186050">//</span><br>
<span class="lineno"></span><span class="comment" id="2186053">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2186112">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2186168">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2186225">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2186242">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2186298">//</span><br>
<span class="lineno">25</span><span class="comment" id="2186301">//</span><br>
<span class="lineno"></span><span class="comment" id="2186304">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2186328">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2186353">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2186384">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="2186416">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="2186459">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="2186490">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2186521">//</span><br>
<span class="lineno"></span><span class="comment" id="2186524">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="2186551">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2186565">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="2186599">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2186638">//</span><br>
<span class="lineno"></span><span class="comment" id="2186641">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="2186652">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2186687">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2186723">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="2186789">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2186855">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="2186919">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="2186961">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="2187017">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2187067">//</span><br>
<span class="lineno"></span><span class="comment" id="2187070">//</span><br>
<span class="lineno">50</span><span class="comment" id="2187073">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="2187125">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="2187199">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2187219">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="2187286">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="2187353">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2187421">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2187491">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="2187552">//</span><br>
<span class="lineno"></span><span class="comment" id="2187555">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="2187614">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="2187671">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="2187726">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2187782">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2187838">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="2187890">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="2187957">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="2188003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="2188052">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2188117">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="2188180">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="2188240">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2188257">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2188300">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2188343">//</span><br>
<span class="lineno">75</span><span class="comment" id="2188346">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="2188392">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="2188447">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2188485">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2188502">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="2188557">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2188600">//</span><br>
<span class="lineno"></span><span class="comment" id="2188603">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="2188635">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2188699">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="2188770">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="2188831">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2188896">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="2188943">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2188960">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="2189015">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2189058">//</span><br>
<span class="lineno"></span><span class="comment" id="2189061">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="2189076">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="2189138">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="2189183">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="2189225">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="2189264">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="2189327">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="2189342">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="2189400">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="2189436">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2189496">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="2189533">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2189589">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="2189652">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="2189707">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="2189753">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="2189799">//</span><br>
<span class="lineno"></span><span class="comment" id="2189802">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="2189831">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="2189894">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2189957">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2189999">//</span><br>
<span class="lineno"></span><span class="comment" id="2190002">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="2190027">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="2190087">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="2190147">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2190185">const</span>&nbsp;<span class="op" id="2190191">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190194">erx</span>&nbsp;<span class="op" id="2190198">=</span>&nbsp;<span class="num" id="2190200">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="2190227">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190250">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190309">efx</span>&nbsp;&nbsp;<span class="op" id="2190314">=</span>&nbsp;<span class="num" id="2190316">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="2190344">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190367">efx8</span>&nbsp;<span class="op" id="2190372">=</span>&nbsp;<span class="num" id="2190374">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="2190402">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190425">pp0</span>&nbsp;&nbsp;<span class="op" id="2190430">=</span>&nbsp;<span class="num" id="2190432">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="2190460">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190483">pp1</span>&nbsp;&nbsp;<span class="op" id="2190488">=</span>&nbsp;<span class="op" id="2190490">-</span><span class="num" id="2190491">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="2190518">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190541">pp2</span>&nbsp;&nbsp;<span class="op" id="2190546">=</span>&nbsp;<span class="op" id="2190548">-</span><span class="num" id="2190549">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="2190576">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190599">pp3</span>&nbsp;&nbsp;<span class="op" id="2190604">=</span>&nbsp;<span class="op" id="2190606">-</span><span class="num" id="2190607">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="2190634">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190657">pp4</span>&nbsp;&nbsp;<span class="op" id="2190662">=</span>&nbsp;<span class="op" id="2190664">-</span><span class="num" id="2190665">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="2190692">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190715">qq1</span>&nbsp;&nbsp;<span class="op" id="2190720">=</span>&nbsp;<span class="num" id="2190722">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="2190750">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190773">qq2</span>&nbsp;&nbsp;<span class="op" id="2190778">=</span>&nbsp;<span class="num" id="2190780">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="2190808">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190831">qq3</span>&nbsp;&nbsp;<span class="op" id="2190836">=</span>&nbsp;<span class="num" id="2190838">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="2190866">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190889">qq4</span>&nbsp;&nbsp;<span class="op" id="2190894">=</span>&nbsp;<span class="num" id="2190896">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="2190924">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190947">qq5</span>&nbsp;&nbsp;<span class="op" id="2190952">=</span>&nbsp;<span class="op" id="2190954">-</span><span class="num" id="2190955">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="2190982">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191005">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191068">pa0</span>&nbsp;<span class="op" id="2191072">=</span>&nbsp;<span class="op" id="2191074">-</span><span class="num" id="2191075">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="2191102">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191125">pa1</span>&nbsp;<span class="op" id="2191129">=</span>&nbsp;<span class="num" id="2191131">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="2191159">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191182">pa2</span>&nbsp;<span class="op" id="2191186">=</span>&nbsp;<span class="op" id="2191188">-</span><span class="num" id="2191189">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="2191216">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191239">pa3</span>&nbsp;<span class="op" id="2191243">=</span>&nbsp;<span class="num" id="2191245">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="2191273">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191296">pa4</span>&nbsp;<span class="op" id="2191300">=</span>&nbsp;<span class="op" id="2191302">-</span><span class="num" id="2191303">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="2191330">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191353">pa5</span>&nbsp;<span class="op" id="2191357">=</span>&nbsp;<span class="num" id="2191359">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="2191387">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191410">pa6</span>&nbsp;<span class="op" id="2191414">=</span>&nbsp;<span class="op" id="2191416">-</span><span class="num" id="2191417">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="2191444">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191467">qa1</span>&nbsp;<span class="op" id="2191471">=</span>&nbsp;<span class="num" id="2191473">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="2191501">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191524">qa2</span>&nbsp;<span class="op" id="2191528">=</span>&nbsp;<span class="num" id="2191530">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="2191558">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191581">qa3</span>&nbsp;<span class="op" id="2191585">=</span>&nbsp;<span class="num" id="2191587">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="2191615">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191638">qa4</span>&nbsp;<span class="op" id="2191642">=</span>&nbsp;<span class="num" id="2191644">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="2191672">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191695">qa5</span>&nbsp;<span class="op" id="2191699">=</span>&nbsp;<span class="num" id="2191701">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="2191729">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191752">qa6</span>&nbsp;<span class="op" id="2191756">=</span>&nbsp;<span class="num" id="2191758">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="2191786">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191809">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191871">ra0</span>&nbsp;<span class="op" id="2191875">=</span>&nbsp;<span class="op" id="2191877">-</span><span class="num" id="2191878">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="2191905">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191928">ra1</span>&nbsp;<span class="op" id="2191932">=</span>&nbsp;<span class="op" id="2191934">-</span><span class="num" id="2191935">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="2191962">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191985">ra2</span>&nbsp;<span class="op" id="2191989">=</span>&nbsp;<span class="op" id="2191991">-</span><span class="num" id="2191992">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="2192019">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192042">ra3</span>&nbsp;<span class="op" id="2192046">=</span>&nbsp;<span class="op" id="2192048">-</span><span class="num" id="2192049">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="2192076">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192099">ra4</span>&nbsp;<span class="op" id="2192103">=</span>&nbsp;<span class="op" id="2192105">-</span><span class="num" id="2192106">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="2192133">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192156">ra5</span>&nbsp;<span class="op" id="2192160">=</span>&nbsp;<span class="op" id="2192162">-</span><span class="num" id="2192163">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="2192190">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192213">ra6</span>&nbsp;<span class="op" id="2192217">=</span>&nbsp;<span class="op" id="2192219">-</span><span class="num" id="2192220">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="2192247">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192270">ra7</span>&nbsp;<span class="op" id="2192274">=</span>&nbsp;<span class="op" id="2192276">-</span><span class="num" id="2192277">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="2192304">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192327">sa1</span>&nbsp;<span class="op" id="2192331">=</span>&nbsp;<span class="num" id="2192333">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="2192361">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192384">sa2</span>&nbsp;<span class="op" id="2192388">=</span>&nbsp;<span class="num" id="2192390">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="2192418">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192441">sa3</span>&nbsp;<span class="op" id="2192445">=</span>&nbsp;<span class="num" id="2192447">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="2192475">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192498">sa4</span>&nbsp;<span class="op" id="2192502">=</span>&nbsp;<span class="num" id="2192504">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="2192532">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192555">sa5</span>&nbsp;<span class="op" id="2192559">=</span>&nbsp;<span class="num" id="2192561">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="2192589">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192612">sa6</span>&nbsp;<span class="op" id="2192616">=</span>&nbsp;<span class="num" id="2192618">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="2192646">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192669">sa7</span>&nbsp;<span class="op" id="2192673">=</span>&nbsp;<span class="num" id="2192675">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="2192703">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192726">sa8</span>&nbsp;<span class="op" id="2192730">=</span>&nbsp;<span class="op" id="2192732">-</span><span class="num" id="2192733">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="2192760">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192783">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192842">rb0</span>&nbsp;<span class="op" id="2192846">=</span>&nbsp;<span class="op" id="2192848">-</span><span class="num" id="2192849">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="2192876">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192899">rb1</span>&nbsp;<span class="op" id="2192903">=</span>&nbsp;<span class="op" id="2192905">-</span><span class="num" id="2192906">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="2192933">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192956">rb2</span>&nbsp;<span class="op" id="2192960">=</span>&nbsp;<span class="op" id="2192962">-</span><span class="num" id="2192963">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="2192990">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193013">rb3</span>&nbsp;<span class="op" id="2193017">=</span>&nbsp;<span class="op" id="2193019">-</span><span class="num" id="2193020">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="2193047">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193070">rb4</span>&nbsp;<span class="op" id="2193074">=</span>&nbsp;<span class="op" id="2193076">-</span><span class="num" id="2193077">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="2193104">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193127">rb5</span>&nbsp;<span class="op" id="2193131">=</span>&nbsp;<span class="op" id="2193133">-</span><span class="num" id="2193134">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="2193161">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193184">rb6</span>&nbsp;<span class="op" id="2193188">=</span>&nbsp;<span class="op" id="2193190">-</span><span class="num" id="2193191">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="2193218">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193241">sb1</span>&nbsp;<span class="op" id="2193245">=</span>&nbsp;<span class="num" id="2193247">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="2193275">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193298">sb2</span>&nbsp;<span class="op" id="2193302">=</span>&nbsp;<span class="num" id="2193304">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="2193332">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193355">sb3</span>&nbsp;<span class="op" id="2193359">=</span>&nbsp;<span class="num" id="2193361">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="2193389">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193412">sb4</span>&nbsp;<span class="op" id="2193416">=</span>&nbsp;<span class="num" id="2193418">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="2193446">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193469">sb5</span>&nbsp;<span class="op" id="2193473">=</span>&nbsp;<span class="num" id="2193475">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="2193503">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193526">sb6</span>&nbsp;<span class="op" id="2193530">=</span>&nbsp;<span class="num" id="2193532">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="2193560">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193583">sb7</span>&nbsp;<span class="op" id="2193587">=</span>&nbsp;<span class="op" id="2193589">-</span><span class="num" id="2193590">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="2193617">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="2193639">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2193642">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2193682">//</span><br>
<span class="lineno"></span><span class="comment" id="2193685">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="2193707">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2193724">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="2193742">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2193760">func</span>&nbsp;<span class="ident" id="2193765">Erf</span><span class="op" id="2193768">(</span><span class="ident" id="2193769">x</span>&nbsp;<span class="builtintype" id="2193771">float64</span><span class="op" id="2193778">)</span>&nbsp;<span class="builtintype" id="2193780">float64</span>&nbsp;<span class="op" id="2193788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2193791">const</span>&nbsp;<span class="op" id="2193797">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193801">VeryTiny</span>&nbsp;<span class="op" id="2193810">=</span>&nbsp;<span class="num" id="2193812">2.848094538889218e-306</span>&nbsp;<span class="comment" id="2193835">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193859">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2193868">=</span>&nbsp;<span class="num" id="2193870">1.0</span>&nbsp;<span class="op" id="2193874">/</span>&nbsp;<span class="op" id="2193876">(</span><span class="num" id="2193877">1</span>&nbsp;<span class="op" id="2193879">&lt;&lt;</span>&nbsp;<span class="num" id="2193882">28</span><span class="op" id="2193884">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193893">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2193904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193907">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2193925">switch</span>&nbsp;<span class="op" id="2193932">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2193935">case</span>&nbsp;<span class="ident" id="2193940">IsNaN</span><span class="op" id="2193945">(</span><span class="ident" id="2193946">x</span><span class="op" id="2193947">)</span><span class="op" id="2193948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2193952">return</span>&nbsp;<span class="ident" id="2193959">NaN</span><span class="op" id="2193962">(</span><span class="op" id="2193963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2193966">case</span>&nbsp;<span class="ident" id="2193971">IsInf</span><span class="op" id="2193976">(</span><span class="ident" id="2193977">x</span><span class="op" id="2193978">,</span>&nbsp;<span class="num" id="2193980">1</span><span class="op" id="2193981">)</span><span class="op" id="2193982">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2193986">return</span>&nbsp;<span class="num" id="2193993">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2193996">case</span>&nbsp;<span class="ident" id="2194001">IsInf</span><span class="op" id="2194006">(</span><span class="ident" id="2194007">x</span><span class="op" id="2194008">,</span>&nbsp;<span class="op" id="2194010">-</span><span class="num" id="2194011">1</span><span class="op" id="2194012">)</span><span class="op" id="2194013">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194017">return</span>&nbsp;<span class="op" id="2194024">-</span><span class="num" id="2194025">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194031">sign</span>&nbsp;<span class="op" id="2194036">:=</span>&nbsp;<span class="builtintype" id="2194039">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194046">if</span>&nbsp;<span class="ident" id="2194049">x</span>&nbsp;<span class="op" id="2194051">&lt;</span>&nbsp;<span class="num" id="2194053">0</span>&nbsp;<span class="op" id="2194055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194059">x</span>&nbsp;<span class="op" id="2194061">=</span>&nbsp;<span class="op" id="2194063">-</span><span class="ident" id="2194064">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194068">sign</span>&nbsp;<span class="op" id="2194073">=</span>&nbsp;<span class="builtintype" id="2194075">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194084">if</span>&nbsp;<span class="ident" id="2194087">x</span>&nbsp;<span class="op" id="2194089">&lt;</span>&nbsp;<span class="num" id="2194091">0.84375</span>&nbsp;<span class="op" id="2194099">{</span>&nbsp;<span class="comment" id="2194101">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194120">var</span>&nbsp;<span class="ident" id="2194124">temp</span>&nbsp;<span class="builtintype" id="2194129">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194139">if</span>&nbsp;<span class="ident" id="2194142">x</span>&nbsp;<span class="op" id="2194144">&lt;</span>&nbsp;<span class="ident" id="2194146">Small</span>&nbsp;<span class="op" id="2194152">{</span>&nbsp;<span class="comment" id="2194154">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194173">if</span>&nbsp;<span class="ident" id="2194176">x</span>&nbsp;<span class="op" id="2194178">&lt;</span>&nbsp;<span class="ident" id="2194180">VeryTiny</span>&nbsp;<span class="op" id="2194189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194195">temp</span>&nbsp;<span class="op" id="2194200">=</span>&nbsp;<span class="num" id="2194202">0.125</span>&nbsp;<span class="op" id="2194208">*</span>&nbsp;<span class="op" id="2194210">(</span><span class="num" id="2194211">8.0</span><span class="op" id="2194214">*</span><span class="ident" id="2194215">x</span>&nbsp;<span class="op" id="2194217">+</span>&nbsp;<span class="ident" id="2194219">efx8</span><span class="op" id="2194223">*</span><span class="ident" id="2194224">x</span><span class="op" id="2194225">)</span>&nbsp;<span class="comment" id="2194227">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194249">}</span>&nbsp;<span class="keyword" id="2194251">else</span>&nbsp;<span class="op" id="2194256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194262">temp</span>&nbsp;<span class="op" id="2194267">=</span>&nbsp;<span class="ident" id="2194269">x</span>&nbsp;<span class="op" id="2194271">+</span>&nbsp;<span class="ident" id="2194273">efx</span><span class="op" id="2194276">*</span><span class="ident" id="2194277">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194282">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194286">}</span>&nbsp;<span class="keyword" id="2194288">else</span>&nbsp;<span class="op" id="2194293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194298">z</span>&nbsp;<span class="op" id="2194300">:=</span>&nbsp;<span class="ident" id="2194303">x</span>&nbsp;<span class="op" id="2194305">*</span>&nbsp;<span class="ident" id="2194307">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194312">r</span>&nbsp;<span class="op" id="2194314">:=</span>&nbsp;<span class="ident" id="2194317">pp0</span>&nbsp;<span class="op" id="2194321">+</span>&nbsp;<span class="ident" id="2194323">z</span><span class="op" id="2194324">*</span><span class="op" id="2194325">(</span><span class="ident" id="2194326">pp1</span><span class="op" id="2194329">+</span><span class="ident" id="2194330">z</span><span class="op" id="2194331">*</span><span class="op" id="2194332">(</span><span class="ident" id="2194333">pp2</span><span class="op" id="2194336">+</span><span class="ident" id="2194337">z</span><span class="op" id="2194338">*</span><span class="op" id="2194339">(</span><span class="ident" id="2194340">pp3</span><span class="op" id="2194343">+</span><span class="ident" id="2194344">z</span><span class="op" id="2194345">*</span><span class="ident" id="2194346">pp4</span><span class="op" id="2194349">)</span><span class="op" id="2194350">)</span><span class="op" id="2194351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194356">s</span>&nbsp;<span class="op" id="2194358">:=</span>&nbsp;<span class="num" id="2194361">1</span>&nbsp;<span class="op" id="2194363">+</span>&nbsp;<span class="ident" id="2194365">z</span><span class="op" id="2194366">*</span><span class="op" id="2194367">(</span><span class="ident" id="2194368">qq1</span><span class="op" id="2194371">+</span><span class="ident" id="2194372">z</span><span class="op" id="2194373">*</span><span class="op" id="2194374">(</span><span class="ident" id="2194375">qq2</span><span class="op" id="2194378">+</span><span class="ident" id="2194379">z</span><span class="op" id="2194380">*</span><span class="op" id="2194381">(</span><span class="ident" id="2194382">qq3</span><span class="op" id="2194385">+</span><span class="ident" id="2194386">z</span><span class="op" id="2194387">*</span><span class="op" id="2194388">(</span><span class="ident" id="2194389">qq4</span><span class="op" id="2194392">+</span><span class="ident" id="2194393">z</span><span class="op" id="2194394">*</span><span class="ident" id="2194395">qq5</span><span class="op" id="2194398">)</span><span class="op" id="2194399">)</span><span class="op" id="2194400">)</span><span class="op" id="2194401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194406">y</span>&nbsp;<span class="op" id="2194408">:=</span>&nbsp;<span class="ident" id="2194411">r</span>&nbsp;<span class="op" id="2194413">/</span>&nbsp;<span class="ident" id="2194415">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194420">temp</span>&nbsp;<span class="op" id="2194425">=</span>&nbsp;<span class="ident" id="2194427">x</span>&nbsp;<span class="op" id="2194429">+</span>&nbsp;<span class="ident" id="2194431">x</span><span class="op" id="2194432">*</span><span class="ident" id="2194433">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194441">if</span>&nbsp;<span class="ident" id="2194444">sign</span>&nbsp;<span class="op" id="2194449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194454">return</span>&nbsp;<span class="op" id="2194461">-</span><span class="ident" id="2194462">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194469">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194473">return</span>&nbsp;<span class="ident" id="2194480">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194489">if</span>&nbsp;<span class="ident" id="2194492">x</span>&nbsp;<span class="op" id="2194494">&lt;</span>&nbsp;<span class="num" id="2194496">1.25</span>&nbsp;<span class="op" id="2194501">{</span>&nbsp;<span class="comment" id="2194503">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194530">s</span>&nbsp;<span class="op" id="2194532">:=</span>&nbsp;<span class="ident" id="2194535">x</span>&nbsp;<span class="op" id="2194537">-</span>&nbsp;<span class="num" id="2194539">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194543">P</span>&nbsp;<span class="op" id="2194545">:=</span>&nbsp;<span class="ident" id="2194548">pa0</span>&nbsp;<span class="op" id="2194552">+</span>&nbsp;<span class="ident" id="2194554">s</span><span class="op" id="2194555">*</span><span class="op" id="2194556">(</span><span class="ident" id="2194557">pa1</span><span class="op" id="2194560">+</span><span class="ident" id="2194561">s</span><span class="op" id="2194562">*</span><span class="op" id="2194563">(</span><span class="ident" id="2194564">pa2</span><span class="op" id="2194567">+</span><span class="ident" id="2194568">s</span><span class="op" id="2194569">*</span><span class="op" id="2194570">(</span><span class="ident" id="2194571">pa3</span><span class="op" id="2194574">+</span><span class="ident" id="2194575">s</span><span class="op" id="2194576">*</span><span class="op" id="2194577">(</span><span class="ident" id="2194578">pa4</span><span class="op" id="2194581">+</span><span class="ident" id="2194582">s</span><span class="op" id="2194583">*</span><span class="op" id="2194584">(</span><span class="ident" id="2194585">pa5</span><span class="op" id="2194588">+</span><span class="ident" id="2194589">s</span><span class="op" id="2194590">*</span><span class="ident" id="2194591">pa6</span><span class="op" id="2194594">)</span><span class="op" id="2194595">)</span><span class="op" id="2194596">)</span><span class="op" id="2194597">)</span><span class="op" id="2194598">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194602">Q</span>&nbsp;<span class="op" id="2194604">:=</span>&nbsp;<span class="num" id="2194607">1</span>&nbsp;<span class="op" id="2194609">+</span>&nbsp;<span class="ident" id="2194611">s</span><span class="op" id="2194612">*</span><span class="op" id="2194613">(</span><span class="ident" id="2194614">qa1</span><span class="op" id="2194617">+</span><span class="ident" id="2194618">s</span><span class="op" id="2194619">*</span><span class="op" id="2194620">(</span><span class="ident" id="2194621">qa2</span><span class="op" id="2194624">+</span><span class="ident" id="2194625">s</span><span class="op" id="2194626">*</span><span class="op" id="2194627">(</span><span class="ident" id="2194628">qa3</span><span class="op" id="2194631">+</span><span class="ident" id="2194632">s</span><span class="op" id="2194633">*</span><span class="op" id="2194634">(</span><span class="ident" id="2194635">qa4</span><span class="op" id="2194638">+</span><span class="ident" id="2194639">s</span><span class="op" id="2194640">*</span><span class="op" id="2194641">(</span><span class="ident" id="2194642">qa5</span><span class="op" id="2194645">+</span><span class="ident" id="2194646">s</span><span class="op" id="2194647">*</span><span class="ident" id="2194648">qa6</span><span class="op" id="2194651">)</span><span class="op" id="2194652">)</span><span class="op" id="2194653">)</span><span class="op" id="2194654">)</span><span class="op" id="2194655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194659">if</span>&nbsp;<span class="ident" id="2194662">sign</span>&nbsp;<span class="op" id="2194667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194672">return</span>&nbsp;<span class="op" id="2194679">-</span><span class="ident" id="2194680">erx</span>&nbsp;<span class="op" id="2194684">-</span>&nbsp;<span class="ident" id="2194686">P</span><span class="op" id="2194687">/</span><span class="ident" id="2194688">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194696">return</span>&nbsp;<span class="ident" id="2194703">erx</span>&nbsp;<span class="op" id="2194707">+</span>&nbsp;<span class="ident" id="2194709">P</span><span class="op" id="2194710">/</span><span class="ident" id="2194711">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194717">if</span>&nbsp;<span class="ident" id="2194720">x</span>&nbsp;<span class="op" id="2194722">&gt;=</span>&nbsp;<span class="num" id="2194725">6</span>&nbsp;<span class="op" id="2194727">{</span>&nbsp;<span class="comment" id="2194729">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194749">if</span>&nbsp;<span class="ident" id="2194752">sign</span>&nbsp;<span class="op" id="2194757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194762">return</span>&nbsp;<span class="op" id="2194769">-</span><span class="num" id="2194770">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194774">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194778">return</span>&nbsp;<span class="num" id="2194785">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2194788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194791">s</span>&nbsp;<span class="op" id="2194793">:=</span>&nbsp;<span class="num" id="2194796">1</span>&nbsp;<span class="op" id="2194798">/</span>&nbsp;<span class="op" id="2194800">(</span><span class="ident" id="2194801">x</span>&nbsp;<span class="op" id="2194803">*</span>&nbsp;<span class="ident" id="2194805">x</span><span class="op" id="2194806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194809">var</span>&nbsp;<span class="ident" id="2194813">R</span><span class="op" id="2194814">,</span>&nbsp;<span class="ident" id="2194816">S</span>&nbsp;<span class="builtintype" id="2194818">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2194827">if</span>&nbsp;<span class="ident" id="2194830">x</span>&nbsp;<span class="op" id="2194832">&lt;</span>&nbsp;<span class="num" id="2194834">1</span><span class="op" id="2194835">/</span><span class="num" id="2194836">0.35</span>&nbsp;<span class="op" id="2194841">{</span>&nbsp;<span class="comment" id="2194843">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194875">R</span>&nbsp;<span class="op" id="2194877">=</span>&nbsp;<span class="ident" id="2194879">ra0</span>&nbsp;<span class="op" id="2194883">+</span>&nbsp;<span class="ident" id="2194885">s</span><span class="op" id="2194886">*</span><span class="op" id="2194887">(</span><span class="ident" id="2194888">ra1</span><span class="op" id="2194891">+</span><span class="ident" id="2194892">s</span><span class="op" id="2194893">*</span><span class="op" id="2194894">(</span><span class="ident" id="2194895">ra2</span><span class="op" id="2194898">+</span><span class="ident" id="2194899">s</span><span class="op" id="2194900">*</span><span class="op" id="2194901">(</span><span class="ident" id="2194902">ra3</span><span class="op" id="2194905">+</span><span class="ident" id="2194906">s</span><span class="op" id="2194907">*</span><span class="op" id="2194908">(</span><span class="ident" id="2194909">ra4</span><span class="op" id="2194912">+</span><span class="ident" id="2194913">s</span><span class="op" id="2194914">*</span><span class="op" id="2194915">(</span><span class="ident" id="2194916">ra5</span><span class="op" id="2194919">+</span><span class="ident" id="2194920">s</span><span class="op" id="2194921">*</span><span class="op" id="2194922">(</span><span class="ident" id="2194923">ra6</span><span class="op" id="2194926">+</span><span class="ident" id="2194927">s</span><span class="op" id="2194928">*</span><span class="ident" id="2194929">ra7</span><span class="op" id="2194932">)</span><span class="op" id="2194933">)</span><span class="op" id="2194934">)</span><span class="op" id="2194935">)</span><span class="op" id="2194936">)</span><span class="op" id="2194937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194941">S</span>&nbsp;<span class="op" id="2194943">=</span>&nbsp;<span class="num" id="2194945">1</span>&nbsp;<span class="op" id="2194947">+</span>&nbsp;<span class="ident" id="2194949">s</span><span class="op" id="2194950">*</span><span class="op" id="2194951">(</span><span class="ident" id="2194952">sa1</span><span class="op" id="2194955">+</span><span class="ident" id="2194956">s</span><span class="op" id="2194957">*</span><span class="op" id="2194958">(</span><span class="ident" id="2194959">sa2</span><span class="op" id="2194962">+</span><span class="ident" id="2194963">s</span><span class="op" id="2194964">*</span><span class="op" id="2194965">(</span><span class="ident" id="2194966">sa3</span><span class="op" id="2194969">+</span><span class="ident" id="2194970">s</span><span class="op" id="2194971">*</span><span class="op" id="2194972">(</span><span class="ident" id="2194973">sa4</span><span class="op" id="2194976">+</span><span class="ident" id="2194977">s</span><span class="op" id="2194978">*</span><span class="op" id="2194979">(</span><span class="ident" id="2194980">sa5</span><span class="op" id="2194983">+</span><span class="ident" id="2194984">s</span><span class="op" id="2194985">*</span><span class="op" id="2194986">(</span><span class="ident" id="2194987">sa6</span><span class="op" id="2194990">+</span><span class="ident" id="2194991">s</span><span class="op" id="2194992">*</span><span class="op" id="2194993">(</span><span class="ident" id="2194994">sa7</span><span class="op" id="2194997">+</span><span class="ident" id="2194998">s</span><span class="op" id="2194999">*</span><span class="ident" id="2195000">sa8</span><span class="op" id="2195003">)</span><span class="op" id="2195004">)</span><span class="op" id="2195005">)</span><span class="op" id="2195006">)</span><span class="op" id="2195007">)</span><span class="op" id="2195008">)</span><span class="op" id="2195009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195012">}</span>&nbsp;<span class="keyword" id="2195014">else</span>&nbsp;<span class="op" id="2195019">{</span>&nbsp;<span class="comment" id="2195021">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195054">R</span>&nbsp;<span class="op" id="2195056">=</span>&nbsp;<span class="ident" id="2195058">rb0</span>&nbsp;<span class="op" id="2195062">+</span>&nbsp;<span class="ident" id="2195064">s</span><span class="op" id="2195065">*</span><span class="op" id="2195066">(</span><span class="ident" id="2195067">rb1</span><span class="op" id="2195070">+</span><span class="ident" id="2195071">s</span><span class="op" id="2195072">*</span><span class="op" id="2195073">(</span><span class="ident" id="2195074">rb2</span><span class="op" id="2195077">+</span><span class="ident" id="2195078">s</span><span class="op" id="2195079">*</span><span class="op" id="2195080">(</span><span class="ident" id="2195081">rb3</span><span class="op" id="2195084">+</span><span class="ident" id="2195085">s</span><span class="op" id="2195086">*</span><span class="op" id="2195087">(</span><span class="ident" id="2195088">rb4</span><span class="op" id="2195091">+</span><span class="ident" id="2195092">s</span><span class="op" id="2195093">*</span><span class="op" id="2195094">(</span><span class="ident" id="2195095">rb5</span><span class="op" id="2195098">+</span><span class="ident" id="2195099">s</span><span class="op" id="2195100">*</span><span class="ident" id="2195101">rb6</span><span class="op" id="2195104">)</span><span class="op" id="2195105">)</span><span class="op" id="2195106">)</span><span class="op" id="2195107">)</span><span class="op" id="2195108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195112">S</span>&nbsp;<span class="op" id="2195114">=</span>&nbsp;<span class="num" id="2195116">1</span>&nbsp;<span class="op" id="2195118">+</span>&nbsp;<span class="ident" id="2195120">s</span><span class="op" id="2195121">*</span><span class="op" id="2195122">(</span><span class="ident" id="2195123">sb1</span><span class="op" id="2195126">+</span><span class="ident" id="2195127">s</span><span class="op" id="2195128">*</span><span class="op" id="2195129">(</span><span class="ident" id="2195130">sb2</span><span class="op" id="2195133">+</span><span class="ident" id="2195134">s</span><span class="op" id="2195135">*</span><span class="op" id="2195136">(</span><span class="ident" id="2195137">sb3</span><span class="op" id="2195140">+</span><span class="ident" id="2195141">s</span><span class="op" id="2195142">*</span><span class="op" id="2195143">(</span><span class="ident" id="2195144">sb4</span><span class="op" id="2195147">+</span><span class="ident" id="2195148">s</span><span class="op" id="2195149">*</span><span class="op" id="2195150">(</span><span class="ident" id="2195151">sb5</span><span class="op" id="2195154">+</span><span class="ident" id="2195155">s</span><span class="op" id="2195156">*</span><span class="op" id="2195157">(</span><span class="ident" id="2195158">sb6</span><span class="op" id="2195161">+</span><span class="ident" id="2195162">s</span><span class="op" id="2195163">*</span><span class="ident" id="2195164">sb7</span><span class="op" id="2195167">)</span><span class="op" id="2195168">)</span><span class="op" id="2195169">)</span><span class="op" id="2195170">)</span><span class="op" id="2195171">)</span><span class="op" id="2195172">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195178">z</span>&nbsp;<span class="op" id="2195180">:=</span>&nbsp;<span class="ident" id="2195183">Float64frombits</span><span class="op" id="2195198">(</span><span class="ident" id="2195199">Float64bits</span><span class="op" id="2195210">(</span><span class="ident" id="2195211">x</span><span class="op" id="2195212">)</span>&nbsp;<span class="op" id="2195214">&amp;</span>&nbsp;<span class="num" id="2195216">0xffffffff00000000</span><span class="op" id="2195234">)</span>&nbsp;<span class="comment" id="2195236">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195275">r</span>&nbsp;<span class="op" id="2195277">:=</span>&nbsp;<span class="ident" id="2195280">Exp</span><span class="op" id="2195283">(</span><span class="op" id="2195284">-</span><span class="ident" id="2195285">z</span><span class="op" id="2195286">*</span><span class="ident" id="2195287">z</span><span class="op" id="2195288">-</span><span class="num" id="2195289">0.5625</span><span class="op" id="2195295">)</span>&nbsp;<span class="op" id="2195297">*</span>&nbsp;<span class="ident" id="2195299">Exp</span><span class="op" id="2195302">(</span><span class="op" id="2195303">(</span><span class="ident" id="2195304">z</span><span class="op" id="2195305">-</span><span class="ident" id="2195306">x</span><span class="op" id="2195307">)</span><span class="op" id="2195308">*</span><span class="op" id="2195309">(</span><span class="ident" id="2195310">z</span><span class="op" id="2195311">+</span><span class="ident" id="2195312">x</span><span class="op" id="2195313">)</span><span class="op" id="2195314">+</span><span class="ident" id="2195315">R</span><span class="op" id="2195316">/</span><span class="ident" id="2195317">S</span><span class="op" id="2195318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195321">if</span>&nbsp;<span class="ident" id="2195324">sign</span>&nbsp;<span class="op" id="2195329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195333">return</span>&nbsp;<span class="ident" id="2195340">r</span><span class="op" id="2195341">/</span><span class="ident" id="2195342">x</span>&nbsp;<span class="op" id="2195344">-</span>&nbsp;<span class="num" id="2195346">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195352">return</span>&nbsp;<span class="num" id="2195359">1</span>&nbsp;<span class="op" id="2195361">-</span>&nbsp;<span class="ident" id="2195363">r</span><span class="op" id="2195364">/</span><span class="ident" id="2195365">x</span><br>
<span class="lineno"></span><span class="op" id="2195367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2195370">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="2195425">//</span><br>
<span class="lineno"></span><span class="comment" id="2195428">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2195450">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2195468">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2195486">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="2195505">func</span>&nbsp;<span class="ident" id="2195510">Erfc</span><span class="op" id="2195514">(</span><span class="ident" id="2195515">x</span>&nbsp;<span class="builtintype" id="2195517">float64</span><span class="op" id="2195524">)</span>&nbsp;<span class="builtintype" id="2195526">float64</span>&nbsp;<span class="op" id="2195534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195537">const</span>&nbsp;<span class="ident" id="2195543">Tiny</span>&nbsp;<span class="op" id="2195548">=</span>&nbsp;<span class="num" id="2195550">1.0</span>&nbsp;<span class="op" id="2195554">/</span>&nbsp;<span class="op" id="2195556">(</span><span class="num" id="2195557">1</span>&nbsp;<span class="op" id="2195559">&lt;&lt;</span>&nbsp;<span class="num" id="2195562">56</span><span class="op" id="2195564">)</span>&nbsp;<span class="comment" id="2195566">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2195577">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195595">switch</span>&nbsp;<span class="op" id="2195602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195605">case</span>&nbsp;<span class="ident" id="2195610">IsNaN</span><span class="op" id="2195615">(</span><span class="ident" id="2195616">x</span><span class="op" id="2195617">)</span><span class="op" id="2195618">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195622">return</span>&nbsp;<span class="ident" id="2195629">NaN</span><span class="op" id="2195632">(</span><span class="op" id="2195633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195636">case</span>&nbsp;<span class="ident" id="2195641">IsInf</span><span class="op" id="2195646">(</span><span class="ident" id="2195647">x</span><span class="op" id="2195648">,</span>&nbsp;<span class="num" id="2195650">1</span><span class="op" id="2195651">)</span><span class="op" id="2195652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195656">return</span>&nbsp;<span class="num" id="2195663">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195666">case</span>&nbsp;<span class="ident" id="2195671">IsInf</span><span class="op" id="2195676">(</span><span class="ident" id="2195677">x</span><span class="op" id="2195678">,</span>&nbsp;<span class="op" id="2195680">-</span><span class="num" id="2195681">1</span><span class="op" id="2195682">)</span><span class="op" id="2195683">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195687">return</span>&nbsp;<span class="num" id="2195694">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195700">sign</span>&nbsp;<span class="op" id="2195705">:=</span>&nbsp;<span class="builtintype" id="2195708">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195715">if</span>&nbsp;<span class="ident" id="2195718">x</span>&nbsp;<span class="op" id="2195720">&lt;</span>&nbsp;<span class="num" id="2195722">0</span>&nbsp;<span class="op" id="2195724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195728">x</span>&nbsp;<span class="op" id="2195730">=</span>&nbsp;<span class="op" id="2195732">-</span><span class="ident" id="2195733">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195737">sign</span>&nbsp;<span class="op" id="2195742">=</span>&nbsp;<span class="builtintype" id="2195744">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195753">if</span>&nbsp;<span class="ident" id="2195756">x</span>&nbsp;<span class="op" id="2195758">&lt;</span>&nbsp;<span class="num" id="2195760">0.84375</span>&nbsp;<span class="op" id="2195768">{</span>&nbsp;<span class="comment" id="2195770">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195789">var</span>&nbsp;<span class="ident" id="2195793">temp</span>&nbsp;<span class="builtintype" id="2195798">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195808">if</span>&nbsp;<span class="ident" id="2195811">x</span>&nbsp;<span class="op" id="2195813">&lt;</span>&nbsp;<span class="ident" id="2195815">Tiny</span>&nbsp;<span class="op" id="2195820">{</span>&nbsp;<span class="comment" id="2195822">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195841">temp</span>&nbsp;<span class="op" id="2195846">=</span>&nbsp;<span class="ident" id="2195848">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2195852">}</span>&nbsp;<span class="keyword" id="2195854">else</span>&nbsp;<span class="op" id="2195859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195864">z</span>&nbsp;<span class="op" id="2195866">:=</span>&nbsp;<span class="ident" id="2195869">x</span>&nbsp;<span class="op" id="2195871">*</span>&nbsp;<span class="ident" id="2195873">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195878">r</span>&nbsp;<span class="op" id="2195880">:=</span>&nbsp;<span class="ident" id="2195883">pp0</span>&nbsp;<span class="op" id="2195887">+</span>&nbsp;<span class="ident" id="2195889">z</span><span class="op" id="2195890">*</span><span class="op" id="2195891">(</span><span class="ident" id="2195892">pp1</span><span class="op" id="2195895">+</span><span class="ident" id="2195896">z</span><span class="op" id="2195897">*</span><span class="op" id="2195898">(</span><span class="ident" id="2195899">pp2</span><span class="op" id="2195902">+</span><span class="ident" id="2195903">z</span><span class="op" id="2195904">*</span><span class="op" id="2195905">(</span><span class="ident" id="2195906">pp3</span><span class="op" id="2195909">+</span><span class="ident" id="2195910">z</span><span class="op" id="2195911">*</span><span class="ident" id="2195912">pp4</span><span class="op" id="2195915">)</span><span class="op" id="2195916">)</span><span class="op" id="2195917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195922">s</span>&nbsp;<span class="op" id="2195924">:=</span>&nbsp;<span class="num" id="2195927">1</span>&nbsp;<span class="op" id="2195929">+</span>&nbsp;<span class="ident" id="2195931">z</span><span class="op" id="2195932">*</span><span class="op" id="2195933">(</span><span class="ident" id="2195934">qq1</span><span class="op" id="2195937">+</span><span class="ident" id="2195938">z</span><span class="op" id="2195939">*</span><span class="op" id="2195940">(</span><span class="ident" id="2195941">qq2</span><span class="op" id="2195944">+</span><span class="ident" id="2195945">z</span><span class="op" id="2195946">*</span><span class="op" id="2195947">(</span><span class="ident" id="2195948">qq3</span><span class="op" id="2195951">+</span><span class="ident" id="2195952">z</span><span class="op" id="2195953">*</span><span class="op" id="2195954">(</span><span class="ident" id="2195955">qq4</span><span class="op" id="2195958">+</span><span class="ident" id="2195959">z</span><span class="op" id="2195960">*</span><span class="ident" id="2195961">qq5</span><span class="op" id="2195964">)</span><span class="op" id="2195965">)</span><span class="op" id="2195966">)</span><span class="op" id="2195967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195972">y</span>&nbsp;<span class="op" id="2195974">:=</span>&nbsp;<span class="ident" id="2195977">r</span>&nbsp;<span class="op" id="2195979">/</span>&nbsp;<span class="ident" id="2195981">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2195986">if</span>&nbsp;<span class="ident" id="2195989">x</span>&nbsp;<span class="op" id="2195991">&lt;</span>&nbsp;<span class="num" id="2195993">0.25</span>&nbsp;<span class="op" id="2195998">{</span>&nbsp;<span class="comment" id="2196000">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196017">temp</span>&nbsp;<span class="op" id="2196022">=</span>&nbsp;<span class="ident" id="2196024">x</span>&nbsp;<span class="op" id="2196026">+</span>&nbsp;<span class="ident" id="2196028">x</span><span class="op" id="2196029">*</span><span class="ident" id="2196030">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196035">}</span>&nbsp;<span class="keyword" id="2196037">else</span>&nbsp;<span class="op" id="2196042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196048">temp</span>&nbsp;<span class="op" id="2196053">=</span>&nbsp;<span class="num" id="2196055">0.5</span>&nbsp;<span class="op" id="2196059">+</span>&nbsp;<span class="op" id="2196061">(</span><span class="ident" id="2196062">x</span><span class="op" id="2196063">*</span><span class="ident" id="2196064">y</span>&nbsp;<span class="op" id="2196066">+</span>&nbsp;<span class="op" id="2196068">(</span><span class="ident" id="2196069">x</span>&nbsp;<span class="op" id="2196071">-</span>&nbsp;<span class="num" id="2196073">0.5</span><span class="op" id="2196076">)</span><span class="op" id="2196077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196082">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196090">if</span>&nbsp;<span class="ident" id="2196093">sign</span>&nbsp;<span class="op" id="2196098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196103">return</span>&nbsp;<span class="num" id="2196110">1</span>&nbsp;<span class="op" id="2196112">+</span>&nbsp;<span class="ident" id="2196114">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196125">return</span>&nbsp;<span class="num" id="2196132">1</span>&nbsp;<span class="op" id="2196134">-</span>&nbsp;<span class="ident" id="2196136">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196145">if</span>&nbsp;<span class="ident" id="2196148">x</span>&nbsp;<span class="op" id="2196150">&lt;</span>&nbsp;<span class="num" id="2196152">1.25</span>&nbsp;<span class="op" id="2196157">{</span>&nbsp;<span class="comment" id="2196159">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196186">s</span>&nbsp;<span class="op" id="2196188">:=</span>&nbsp;<span class="ident" id="2196191">x</span>&nbsp;<span class="op" id="2196193">-</span>&nbsp;<span class="num" id="2196195">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196199">P</span>&nbsp;<span class="op" id="2196201">:=</span>&nbsp;<span class="ident" id="2196204">pa0</span>&nbsp;<span class="op" id="2196208">+</span>&nbsp;<span class="ident" id="2196210">s</span><span class="op" id="2196211">*</span><span class="op" id="2196212">(</span><span class="ident" id="2196213">pa1</span><span class="op" id="2196216">+</span><span class="ident" id="2196217">s</span><span class="op" id="2196218">*</span><span class="op" id="2196219">(</span><span class="ident" id="2196220">pa2</span><span class="op" id="2196223">+</span><span class="ident" id="2196224">s</span><span class="op" id="2196225">*</span><span class="op" id="2196226">(</span><span class="ident" id="2196227">pa3</span><span class="op" id="2196230">+</span><span class="ident" id="2196231">s</span><span class="op" id="2196232">*</span><span class="op" id="2196233">(</span><span class="ident" id="2196234">pa4</span><span class="op" id="2196237">+</span><span class="ident" id="2196238">s</span><span class="op" id="2196239">*</span><span class="op" id="2196240">(</span><span class="ident" id="2196241">pa5</span><span class="op" id="2196244">+</span><span class="ident" id="2196245">s</span><span class="op" id="2196246">*</span><span class="ident" id="2196247">pa6</span><span class="op" id="2196250">)</span><span class="op" id="2196251">)</span><span class="op" id="2196252">)</span><span class="op" id="2196253">)</span><span class="op" id="2196254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196258">Q</span>&nbsp;<span class="op" id="2196260">:=</span>&nbsp;<span class="num" id="2196263">1</span>&nbsp;<span class="op" id="2196265">+</span>&nbsp;<span class="ident" id="2196267">s</span><span class="op" id="2196268">*</span><span class="op" id="2196269">(</span><span class="ident" id="2196270">qa1</span><span class="op" id="2196273">+</span><span class="ident" id="2196274">s</span><span class="op" id="2196275">*</span><span class="op" id="2196276">(</span><span class="ident" id="2196277">qa2</span><span class="op" id="2196280">+</span><span class="ident" id="2196281">s</span><span class="op" id="2196282">*</span><span class="op" id="2196283">(</span><span class="ident" id="2196284">qa3</span><span class="op" id="2196287">+</span><span class="ident" id="2196288">s</span><span class="op" id="2196289">*</span><span class="op" id="2196290">(</span><span class="ident" id="2196291">qa4</span><span class="op" id="2196294">+</span><span class="ident" id="2196295">s</span><span class="op" id="2196296">*</span><span class="op" id="2196297">(</span><span class="ident" id="2196298">qa5</span><span class="op" id="2196301">+</span><span class="ident" id="2196302">s</span><span class="op" id="2196303">*</span><span class="ident" id="2196304">qa6</span><span class="op" id="2196307">)</span><span class="op" id="2196308">)</span><span class="op" id="2196309">)</span><span class="op" id="2196310">)</span><span class="op" id="2196311">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196315">if</span>&nbsp;<span class="ident" id="2196318">sign</span>&nbsp;<span class="op" id="2196323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196328">return</span>&nbsp;<span class="num" id="2196335">1</span>&nbsp;<span class="op" id="2196337">+</span>&nbsp;<span class="ident" id="2196339">erx</span>&nbsp;<span class="op" id="2196343">+</span>&nbsp;<span class="ident" id="2196345">P</span><span class="op" id="2196346">/</span><span class="ident" id="2196347">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196355">return</span>&nbsp;<span class="num" id="2196362">1</span>&nbsp;<span class="op" id="2196364">-</span>&nbsp;<span class="ident" id="2196366">erx</span>&nbsp;<span class="op" id="2196370">-</span>&nbsp;<span class="ident" id="2196372">P</span><span class="op" id="2196373">/</span><span class="ident" id="2196374">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196381">if</span>&nbsp;<span class="ident" id="2196384">x</span>&nbsp;<span class="op" id="2196386">&lt;</span>&nbsp;<span class="num" id="2196388">28</span>&nbsp;<span class="op" id="2196391">{</span>&nbsp;<span class="comment" id="2196393">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196407">s</span>&nbsp;<span class="op" id="2196409">:=</span>&nbsp;<span class="num" id="2196412">1</span>&nbsp;<span class="op" id="2196414">/</span>&nbsp;<span class="op" id="2196416">(</span><span class="ident" id="2196417">x</span>&nbsp;<span class="op" id="2196419">*</span>&nbsp;<span class="ident" id="2196421">x</span><span class="op" id="2196422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196426">var</span>&nbsp;<span class="ident" id="2196430">R</span><span class="op" id="2196431">,</span>&nbsp;<span class="ident" id="2196433">S</span>&nbsp;<span class="builtintype" id="2196435">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196445">if</span>&nbsp;<span class="ident" id="2196448">x</span>&nbsp;<span class="op" id="2196450">&lt;</span>&nbsp;<span class="num" id="2196452">1</span><span class="op" id="2196453">/</span><span class="num" id="2196454">0.35</span>&nbsp;<span class="op" id="2196459">{</span>&nbsp;<span class="comment" id="2196461">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196493">R</span>&nbsp;<span class="op" id="2196495">=</span>&nbsp;<span class="ident" id="2196497">ra0</span>&nbsp;<span class="op" id="2196501">+</span>&nbsp;<span class="ident" id="2196503">s</span><span class="op" id="2196504">*</span><span class="op" id="2196505">(</span><span class="ident" id="2196506">ra1</span><span class="op" id="2196509">+</span><span class="ident" id="2196510">s</span><span class="op" id="2196511">*</span><span class="op" id="2196512">(</span><span class="ident" id="2196513">ra2</span><span class="op" id="2196516">+</span><span class="ident" id="2196517">s</span><span class="op" id="2196518">*</span><span class="op" id="2196519">(</span><span class="ident" id="2196520">ra3</span><span class="op" id="2196523">+</span><span class="ident" id="2196524">s</span><span class="op" id="2196525">*</span><span class="op" id="2196526">(</span><span class="ident" id="2196527">ra4</span><span class="op" id="2196530">+</span><span class="ident" id="2196531">s</span><span class="op" id="2196532">*</span><span class="op" id="2196533">(</span><span class="ident" id="2196534">ra5</span><span class="op" id="2196537">+</span><span class="ident" id="2196538">s</span><span class="op" id="2196539">*</span><span class="op" id="2196540">(</span><span class="ident" id="2196541">ra6</span><span class="op" id="2196544">+</span><span class="ident" id="2196545">s</span><span class="op" id="2196546">*</span><span class="ident" id="2196547">ra7</span><span class="op" id="2196550">)</span><span class="op" id="2196551">)</span><span class="op" id="2196552">)</span><span class="op" id="2196553">)</span><span class="op" id="2196554">)</span><span class="op" id="2196555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196560">S</span>&nbsp;<span class="op" id="2196562">=</span>&nbsp;<span class="num" id="2196564">1</span>&nbsp;<span class="op" id="2196566">+</span>&nbsp;<span class="ident" id="2196568">s</span><span class="op" id="2196569">*</span><span class="op" id="2196570">(</span><span class="ident" id="2196571">sa1</span><span class="op" id="2196574">+</span><span class="ident" id="2196575">s</span><span class="op" id="2196576">*</span><span class="op" id="2196577">(</span><span class="ident" id="2196578">sa2</span><span class="op" id="2196581">+</span><span class="ident" id="2196582">s</span><span class="op" id="2196583">*</span><span class="op" id="2196584">(</span><span class="ident" id="2196585">sa3</span><span class="op" id="2196588">+</span><span class="ident" id="2196589">s</span><span class="op" id="2196590">*</span><span class="op" id="2196591">(</span><span class="ident" id="2196592">sa4</span><span class="op" id="2196595">+</span><span class="ident" id="2196596">s</span><span class="op" id="2196597">*</span><span class="op" id="2196598">(</span><span class="ident" id="2196599">sa5</span><span class="op" id="2196602">+</span><span class="ident" id="2196603">s</span><span class="op" id="2196604">*</span><span class="op" id="2196605">(</span><span class="ident" id="2196606">sa6</span><span class="op" id="2196609">+</span><span class="ident" id="2196610">s</span><span class="op" id="2196611">*</span><span class="op" id="2196612">(</span><span class="ident" id="2196613">sa7</span><span class="op" id="2196616">+</span><span class="ident" id="2196617">s</span><span class="op" id="2196618">*</span><span class="ident" id="2196619">sa8</span><span class="op" id="2196622">)</span><span class="op" id="2196623">)</span><span class="op" id="2196624">)</span><span class="op" id="2196625">)</span><span class="op" id="2196626">)</span><span class="op" id="2196627">)</span><span class="op" id="2196628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196632">}</span>&nbsp;<span class="keyword" id="2196634">else</span>&nbsp;<span class="op" id="2196639">{</span>&nbsp;<span class="comment" id="2196641">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196674">if</span>&nbsp;<span class="ident" id="2196677">sign</span>&nbsp;<span class="op" id="2196682">&amp;&amp;</span>&nbsp;<span class="ident" id="2196685">x</span>&nbsp;<span class="op" id="2196687">&gt;</span>&nbsp;<span class="num" id="2196689">6</span>&nbsp;<span class="op" id="2196691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196697">return</span>&nbsp;<span class="num" id="2196704">2</span>&nbsp;<span class="comment" id="2196706">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196724">R</span>&nbsp;<span class="op" id="2196726">=</span>&nbsp;<span class="ident" id="2196728">rb0</span>&nbsp;<span class="op" id="2196732">+</span>&nbsp;<span class="ident" id="2196734">s</span><span class="op" id="2196735">*</span><span class="op" id="2196736">(</span><span class="ident" id="2196737">rb1</span><span class="op" id="2196740">+</span><span class="ident" id="2196741">s</span><span class="op" id="2196742">*</span><span class="op" id="2196743">(</span><span class="ident" id="2196744">rb2</span><span class="op" id="2196747">+</span><span class="ident" id="2196748">s</span><span class="op" id="2196749">*</span><span class="op" id="2196750">(</span><span class="ident" id="2196751">rb3</span><span class="op" id="2196754">+</span><span class="ident" id="2196755">s</span><span class="op" id="2196756">*</span><span class="op" id="2196757">(</span><span class="ident" id="2196758">rb4</span><span class="op" id="2196761">+</span><span class="ident" id="2196762">s</span><span class="op" id="2196763">*</span><span class="op" id="2196764">(</span><span class="ident" id="2196765">rb5</span><span class="op" id="2196768">+</span><span class="ident" id="2196769">s</span><span class="op" id="2196770">*</span><span class="ident" id="2196771">rb6</span><span class="op" id="2196774">)</span><span class="op" id="2196775">)</span><span class="op" id="2196776">)</span><span class="op" id="2196777">)</span><span class="op" id="2196778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196783">S</span>&nbsp;<span class="op" id="2196785">=</span>&nbsp;<span class="num" id="2196787">1</span>&nbsp;<span class="op" id="2196789">+</span>&nbsp;<span class="ident" id="2196791">s</span><span class="op" id="2196792">*</span><span class="op" id="2196793">(</span><span class="ident" id="2196794">sb1</span><span class="op" id="2196797">+</span><span class="ident" id="2196798">s</span><span class="op" id="2196799">*</span><span class="op" id="2196800">(</span><span class="ident" id="2196801">sb2</span><span class="op" id="2196804">+</span><span class="ident" id="2196805">s</span><span class="op" id="2196806">*</span><span class="op" id="2196807">(</span><span class="ident" id="2196808">sb3</span><span class="op" id="2196811">+</span><span class="ident" id="2196812">s</span><span class="op" id="2196813">*</span><span class="op" id="2196814">(</span><span class="ident" id="2196815">sb4</span><span class="op" id="2196818">+</span><span class="ident" id="2196819">s</span><span class="op" id="2196820">*</span><span class="op" id="2196821">(</span><span class="ident" id="2196822">sb5</span><span class="op" id="2196825">+</span><span class="ident" id="2196826">s</span><span class="op" id="2196827">*</span><span class="op" id="2196828">(</span><span class="ident" id="2196829">sb6</span><span class="op" id="2196832">+</span><span class="ident" id="2196833">s</span><span class="op" id="2196834">*</span><span class="ident" id="2196835">sb7</span><span class="op" id="2196838">)</span><span class="op" id="2196839">)</span><span class="op" id="2196840">)</span><span class="op" id="2196841">)</span><span class="op" id="2196842">)</span><span class="op" id="2196843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196851">z</span>&nbsp;<span class="op" id="2196853">:=</span>&nbsp;<span class="ident" id="2196856">Float64frombits</span><span class="op" id="2196871">(</span><span class="ident" id="2196872">Float64bits</span><span class="op" id="2196883">(</span><span class="ident" id="2196884">x</span><span class="op" id="2196885">)</span>&nbsp;<span class="op" id="2196887">&amp;</span>&nbsp;<span class="num" id="2196889">0xffffffff00000000</span><span class="op" id="2196907">)</span>&nbsp;<span class="comment" id="2196909">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196949">r</span>&nbsp;<span class="op" id="2196951">:=</span>&nbsp;<span class="ident" id="2196954">Exp</span><span class="op" id="2196957">(</span><span class="op" id="2196958">-</span><span class="ident" id="2196959">z</span><span class="op" id="2196960">*</span><span class="ident" id="2196961">z</span><span class="op" id="2196962">-</span><span class="num" id="2196963">0.5625</span><span class="op" id="2196969">)</span>&nbsp;<span class="op" id="2196971">*</span>&nbsp;<span class="ident" id="2196973">Exp</span><span class="op" id="2196976">(</span><span class="op" id="2196977">(</span><span class="ident" id="2196978">z</span><span class="op" id="2196979">-</span><span class="ident" id="2196980">x</span><span class="op" id="2196981">)</span><span class="op" id="2196982">*</span><span class="op" id="2196983">(</span><span class="ident" id="2196984">z</span><span class="op" id="2196985">+</span><span class="ident" id="2196986">x</span><span class="op" id="2196987">)</span><span class="op" id="2196988">+</span><span class="ident" id="2196989">R</span><span class="op" id="2196990">/</span><span class="ident" id="2196991">S</span><span class="op" id="2196992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2196996">if</span>&nbsp;<span class="ident" id="2196999">sign</span>&nbsp;<span class="op" id="2197004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2197009">return</span>&nbsp;<span class="num" id="2197016">2</span>&nbsp;<span class="op" id="2197018">-</span>&nbsp;<span class="ident" id="2197020">r</span><span class="op" id="2197021">/</span><span class="ident" id="2197022">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2197026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2197030">return</span>&nbsp;<span class="ident" id="2197037">r</span>&nbsp;<span class="op" id="2197039">/</span>&nbsp;<span class="ident" id="2197041">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2197044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2197047">if</span>&nbsp;<span class="ident" id="2197050">sign</span>&nbsp;<span class="op" id="2197055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2197059">return</span>&nbsp;<span class="num" id="2197066">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2197069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2197072">return</span>&nbsp;<span class="num" id="2197079">0</span><br>
<span class="lineno">335</span><span class="op" id="2197081">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
