<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5417904">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5417959">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5418013">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5418064">package</span>&nbsp;<span class="ident" id="5418072">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5418078">import</span>&nbsp;<span class="op" id="5418085">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5418088">&#34;image&#34;</span><br>
<span class="lineno"></span><span class="op" id="5418096">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="5418099">//&nbsp;makeImg&nbsp;allocates&nbsp;and&nbsp;initializes&nbsp;the&nbsp;destination&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="5418159">func</span>&nbsp;<span class="op" id="5418164">(</span><span class="ident" id="5418165">d</span>&nbsp;<span class="op" id="5418167">*</span><span class="ident" id="5418168"><a href="/image/jpeg/reader.go.html#5405509">decoder</a></span><span class="op" id="5418175">)</span>&nbsp;<span class="ident" id="5418177">makeImg</span><span class="op" id="5418184">(</span><span class="ident" id="5418185">h0</span><span class="op" id="5418187">,</span>&nbsp;<span class="ident" id="5418189">v0</span><span class="op" id="5418191">,</span>&nbsp;<span class="ident" id="5418193">mxx</span><span class="op" id="5418196">,</span>&nbsp;<span class="ident" id="5418198">myy</span>&nbsp;<span class="builtintype" id="5418202">int</span><span class="op" id="5418205">)</span>&nbsp;<span class="op" id="5418207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418210">if</span>&nbsp;<span class="ident" id="5418213"><a href="/image/jpeg/scan.go.html#5418165">d</a></span><span class="op" id="5418214">.</span><span class="ident" id="5418215">nComp</span>&nbsp;<span class="op" id="5418221">==</span>&nbsp;<span class="ident" id="5418224"><a href="/image/jpeg/reader.go.html#5403693">nGrayComponent</a></span>&nbsp;<span class="op" id="5418239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418243">m</span>&nbsp;<span class="op" id="5418245">:=</span>&nbsp;<span class="ident" id="5418248"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418253">.</span><span class="ident" id="5418254">NewGray</span><span class="op" id="5418261">(</span><span class="ident" id="5418262"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418267">.</span><span class="ident" id="5418268">Rect</span><span class="op" id="5418272">(</span><span class="num" id="5418273">0</span><span class="op" id="5418274">,</span>&nbsp;<span class="num" id="5418276">0</span><span class="op" id="5418277">,</span>&nbsp;<span class="num" id="5418279">8</span><span class="op" id="5418280">*</span><span class="ident" id="5418281"><a href="/image/jpeg/scan.go.html#5418193">mxx</a></span><span class="op" id="5418284">,</span>&nbsp;<span class="num" id="5418286">8</span><span class="op" id="5418287">*</span><span class="ident" id="5418288"><a href="/image/jpeg/scan.go.html#5418198">myy</a></span><span class="op" id="5418291">)</span><span class="op" id="5418292">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418296"><a href="/image/jpeg/scan.go.html#5418165">d</a></span><span class="op" id="5418297">.</span><span class="ident" id="5418298">img1</span>&nbsp;<span class="op" id="5418303">=</span>&nbsp;<span class="ident" id="5418305"><a href="/image/jpeg/scan.go.html#5418243">m</a></span><span class="op" id="5418306">.</span><span class="ident" id="5418307">SubImage</span><span class="op" id="5418315">(</span><span class="ident" id="5418316"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418321">.</span><span class="ident" id="5418322">Rect</span><span class="op" id="5418326">(</span><span class="num" id="5418327">0</span><span class="op" id="5418328">,</span>&nbsp;<span class="num" id="5418330">0</span><span class="op" id="5418331">,</span>&nbsp;<span class="ident" id="5418333"><a href="/image/jpeg/scan.go.html#5418165">d</a></span><span class="op" id="5418334">.</span><span class="ident" id="5418335">width</span><span class="op" id="5418340">,</span>&nbsp;<span class="ident" id="5418342"><a href="/image/jpeg/scan.go.html#5418165">d</a></span><span class="op" id="5418343">.</span><span class="ident" id="5418344">height</span><span class="op" id="5418350">)</span><span class="op" id="5418351">)</span><span class="op" id="5418352">.</span><span class="op" id="5418353">(</span><span class="op" id="5418354">*</span><span class="ident" id="5418355"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418360">.</span><span class="ident" id="5418361">Gray</span><span class="op" id="5418365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418369">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418380">var</span>&nbsp;<span class="ident" id="5418384">subsampleRatio</span>&nbsp;<span class="ident" id="5418399"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418404">.</span><span class="ident" id="5418405">YCbCrSubsampleRatio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418426">switch</span>&nbsp;<span class="op" id="5418433">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418436">case</span>&nbsp;<span class="ident" id="5418441"><a href="/image/jpeg/scan.go.html#5418185">h0</a></span>&nbsp;<span class="op" id="5418444">==</span>&nbsp;<span class="num" id="5418447">1</span>&nbsp;<span class="op" id="5418449">&amp;&amp;</span>&nbsp;<span class="ident" id="5418452"><a href="/image/jpeg/scan.go.html#5418189">v0</a></span>&nbsp;<span class="op" id="5418455">==</span>&nbsp;<span class="num" id="5418458">1</span><span class="op" id="5418459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418463"><a href="/image/jpeg/scan.go.html#5418384">subsampleRatio</a></span>&nbsp;<span class="op" id="5418478">=</span>&nbsp;<span class="ident" id="5418480"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418485">.</span><span class="ident" id="5418486">YCbCrSubsampleRatio444</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418510">case</span>&nbsp;<span class="ident" id="5418515"><a href="/image/jpeg/scan.go.html#5418185">h0</a></span>&nbsp;<span class="op" id="5418518">==</span>&nbsp;<span class="num" id="5418521">1</span>&nbsp;<span class="op" id="5418523">&amp;&amp;</span>&nbsp;<span class="ident" id="5418526"><a href="/image/jpeg/scan.go.html#5418189">v0</a></span>&nbsp;<span class="op" id="5418529">==</span>&nbsp;<span class="num" id="5418532">2</span><span class="op" id="5418533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418537"><a href="/image/jpeg/scan.go.html#5418384">subsampleRatio</a></span>&nbsp;<span class="op" id="5418552">=</span>&nbsp;<span class="ident" id="5418554"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418559">.</span><span class="ident" id="5418560">YCbCrSubsampleRatio440</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418584">case</span>&nbsp;<span class="ident" id="5418589"><a href="/image/jpeg/scan.go.html#5418185">h0</a></span>&nbsp;<span class="op" id="5418592">==</span>&nbsp;<span class="num" id="5418595">2</span>&nbsp;<span class="op" id="5418597">&amp;&amp;</span>&nbsp;<span class="ident" id="5418600"><a href="/image/jpeg/scan.go.html#5418189">v0</a></span>&nbsp;<span class="op" id="5418603">==</span>&nbsp;<span class="num" id="5418606">1</span><span class="op" id="5418607">:</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418611"><a href="/image/jpeg/scan.go.html#5418384">subsampleRatio</a></span>&nbsp;<span class="op" id="5418626">=</span>&nbsp;<span class="ident" id="5418628"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418633">.</span><span class="ident" id="5418634">YCbCrSubsampleRatio422</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418658">case</span>&nbsp;<span class="ident" id="5418663"><a href="/image/jpeg/scan.go.html#5418185">h0</a></span>&nbsp;<span class="op" id="5418666">==</span>&nbsp;<span class="num" id="5418669">2</span>&nbsp;<span class="op" id="5418671">&amp;&amp;</span>&nbsp;<span class="ident" id="5418674"><a href="/image/jpeg/scan.go.html#5418189">v0</a></span>&nbsp;<span class="op" id="5418677">==</span>&nbsp;<span class="num" id="5418680">2</span><span class="op" id="5418681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418685"><a href="/image/jpeg/scan.go.html#5418384">subsampleRatio</a></span>&nbsp;<span class="op" id="5418700">=</span>&nbsp;<span class="ident" id="5418702"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418707">.</span><span class="ident" id="5418708">YCbCrSubsampleRatio420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418732">default</span><span class="op" id="5418739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5418743">panic</span><span class="op" id="5418748">(</span><span class="string" id="5418749">&#34;unreachable&#34;</span><span class="op" id="5418762">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418768">m</span>&nbsp;<span class="op" id="5418770">:=</span>&nbsp;<span class="ident" id="5418773"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418778">.</span><span class="ident" id="5418779">NewYCbCr</span><span class="op" id="5418787">(</span><span class="ident" id="5418788"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418793">.</span><span class="ident" id="5418794">Rect</span><span class="op" id="5418798">(</span><span class="num" id="5418799">0</span><span class="op" id="5418800">,</span>&nbsp;<span class="num" id="5418802">0</span><span class="op" id="5418803">,</span>&nbsp;<span class="num" id="5418805">8</span><span class="op" id="5418806">*</span><span class="ident" id="5418807"><a href="/image/jpeg/scan.go.html#5418185">h0</a></span><span class="op" id="5418809">*</span><span class="ident" id="5418810"><a href="/image/jpeg/scan.go.html#5418193">mxx</a></span><span class="op" id="5418813">,</span>&nbsp;<span class="num" id="5418815">8</span><span class="op" id="5418816">*</span><span class="ident" id="5418817"><a href="/image/jpeg/scan.go.html#5418189">v0</a></span><span class="op" id="5418819">*</span><span class="ident" id="5418820"><a href="/image/jpeg/scan.go.html#5418198">myy</a></span><span class="op" id="5418823">)</span><span class="op" id="5418824">,</span>&nbsp;<span class="ident" id="5418826"><a href="/image/jpeg/scan.go.html#5418384">subsampleRatio</a></span><span class="op" id="5418840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418843"><a href="/image/jpeg/scan.go.html#5418165">d</a></span><span class="op" id="5418844">.</span><span class="ident" id="5418845">img3</span>&nbsp;<span class="op" id="5418850">=</span>&nbsp;<span class="ident" id="5418852"><a href="/image/jpeg/scan.go.html#5418768">m</a></span><span class="op" id="5418853">.</span><span class="ident" id="5418854">SubImage</span><span class="op" id="5418862">(</span><span class="ident" id="5418863"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418868">.</span><span class="ident" id="5418869">Rect</span><span class="op" id="5418873">(</span><span class="num" id="5418874">0</span><span class="op" id="5418875">,</span>&nbsp;<span class="num" id="5418877">0</span><span class="op" id="5418878">,</span>&nbsp;<span class="ident" id="5418880"><a href="/image/jpeg/scan.go.html#5418165">d</a></span><span class="op" id="5418881">.</span><span class="ident" id="5418882">width</span><span class="op" id="5418887">,</span>&nbsp;<span class="ident" id="5418889"><a href="/image/jpeg/scan.go.html#5418165">d</a></span><span class="op" id="5418890">.</span><span class="ident" id="5418891">height</span><span class="op" id="5418897">)</span><span class="op" id="5418898">)</span><span class="op" id="5418899">.</span><span class="op" id="5418900">(</span><span class="op" id="5418901">*</span><span class="ident" id="5418902"><a href="/image/jpeg/scan.go.html#5418088">image</a></span><span class="op" id="5418907">.</span><span class="ident" id="5418908">YCbCr</span><span class="op" id="5418913">)</span><br>
<span class="lineno"></span><span class="op" id="5418915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="5418918">//&nbsp;Specified&nbsp;in&nbsp;section&nbsp;B.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="5418949">func</span>&nbsp;<span class="op" id="5418954">(</span><span class="ident" id="5418955">d</span>&nbsp;<span class="op" id="5418957">*</span><span class="ident" id="5418958"><a href="/image/jpeg/reader.go.html#5405509">decoder</a></span><span class="op" id="5418965">)</span>&nbsp;<span class="ident" id="5418967">processSOS</span><span class="op" id="5418977">(</span><span class="ident" id="5418978">n</span>&nbsp;<span class="builtintype" id="5418980">int</span><span class="op" id="5418983">)</span>&nbsp;<span class="builtintype" id="5418985">error</span>&nbsp;<span class="op" id="5418991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418994">if</span>&nbsp;<span class="ident" id="5418997"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5418998">.</span><span class="ident" id="5418999">nComp</span>&nbsp;<span class="op" id="5419005">==</span>&nbsp;<span class="num" id="5419008">0</span>&nbsp;<span class="op" id="5419010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419014">return</span>&nbsp;<span class="ident" id="5419021"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5419032">(</span><span class="string" id="5419033">&#34;missing&nbsp;SOF&nbsp;marker&#34;</span><span class="op" id="5419053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419056">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419059">if</span>&nbsp;<span class="ident" id="5419062"><a href="/image/jpeg/scan.go.html#5418978">n</a></span>&nbsp;<span class="op" id="5419064">&lt;</span>&nbsp;<span class="num" id="5419066">6</span>&nbsp;<span class="op" id="5419068">||</span>&nbsp;<span class="num" id="5419071">4</span><span class="op" id="5419072">+</span><span class="num" id="5419073">2</span><span class="op" id="5419074">*</span><span class="ident" id="5419075"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5419076">.</span><span class="ident" id="5419077">nComp</span>&nbsp;<span class="op" id="5419083">&lt;</span>&nbsp;<span class="ident" id="5419085"><a href="/image/jpeg/scan.go.html#5418978">n</a></span>&nbsp;<span class="op" id="5419087">||</span>&nbsp;<span class="ident" id="5419090"><a href="/image/jpeg/scan.go.html#5418978">n</a></span><span class="op" id="5419091">%</span><span class="num" id="5419092">2</span>&nbsp;<span class="op" id="5419094">!=</span>&nbsp;<span class="num" id="5419097">0</span>&nbsp;<span class="op" id="5419099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419103">return</span>&nbsp;<span class="ident" id="5419110"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5419121">(</span><span class="string" id="5419122">&#34;SOS&nbsp;has&nbsp;wrong&nbsp;length&#34;</span><span class="op" id="5419144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419150">if</span>&nbsp;<span class="ident" id="5419153">err</span>&nbsp;<span class="op" id="5419157">:=</span>&nbsp;<span class="ident" id="5419160"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5419161">.</span><span class="ident" id="5419162">readFull</span><span class="op" id="5419170">(</span><span class="ident" id="5419171"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5419172">.</span><span class="ident" id="5419173">tmp</span><span class="op" id="5419176">[</span><span class="op" id="5419177">:</span><span class="ident" id="5419178"><a href="/image/jpeg/scan.go.html#5418978">n</a></span><span class="op" id="5419179">]</span><span class="op" id="5419180">)</span><span class="op" id="5419181">;</span>&nbsp;<span class="ident" id="5419183"><a href="/image/jpeg/scan.go.html#5419153">err</a></span>&nbsp;<span class="op" id="5419187">!=</span>&nbsp;<span class="ident" id="5419190">nil</span>&nbsp;<span class="op" id="5419194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419198">return</span>&nbsp;<span class="ident" id="5419205"><a href="/image/jpeg/scan.go.html#5419153">err</a></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419213">nComp</span>&nbsp;<span class="op" id="5419219">:=</span>&nbsp;<span class="builtintype" id="5419222">int</span><span class="op" id="5419225">(</span><span class="ident" id="5419226"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5419227">.</span><span class="ident" id="5419228">tmp</span><span class="op" id="5419231">[</span><span class="num" id="5419232">0</span><span class="op" id="5419233">]</span><span class="op" id="5419234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419237">if</span>&nbsp;<span class="ident" id="5419240"><a href="/image/jpeg/scan.go.html#5418978">n</a></span>&nbsp;<span class="op" id="5419242">!=</span>&nbsp;<span class="num" id="5419245">4</span><span class="op" id="5419246">+</span><span class="num" id="5419247">2</span><span class="op" id="5419248">*</span><span class="ident" id="5419249"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span>&nbsp;<span class="op" id="5419255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419259">return</span>&nbsp;<span class="ident" id="5419266"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5419277">(</span><span class="string" id="5419278">&#34;SOS&nbsp;length&nbsp;inconsistent&nbsp;with&nbsp;number&nbsp;of&nbsp;components&#34;</span><span class="op" id="5419329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419332">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419335">var</span>&nbsp;<span class="ident" id="5419339">scan</span>&nbsp;<span class="op" id="5419344">[</span><span class="ident" id="5419345"><a href="/image/jpeg/reader.go.html#5403765">nColorComponent</a></span><span class="op" id="5419360">]</span><span class="keyword" id="5419361">struct</span>&nbsp;<span class="op" id="5419368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419372">compIndex</span>&nbsp;<span class="builtintype" id="5419382">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419390">td</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5419400">uint8</span>&nbsp;<span class="comment" id="5419406">//&nbsp;DC&nbsp;table&nbsp;selector.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419430">ta</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5419440">uint8</span>&nbsp;<span class="comment" id="5419446">//&nbsp;AC&nbsp;table&nbsp;selector.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419469">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419472">for</span>&nbsp;<span class="ident" id="5419476">i</span>&nbsp;<span class="op" id="5419478">:=</span>&nbsp;<span class="num" id="5419481">0</span><span class="op" id="5419482">;</span>&nbsp;<span class="ident" id="5419484"><a href="/image/jpeg/scan.go.html#5419476">i</a></span>&nbsp;<span class="op" id="5419486">&lt;</span>&nbsp;<span class="ident" id="5419488"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span><span class="op" id="5419493">;</span>&nbsp;<span class="ident" id="5419495"><a href="/image/jpeg/scan.go.html#5419476">i</a></span><span class="op" id="5419496">++</span>&nbsp;<span class="op" id="5419499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419503">cs</span>&nbsp;<span class="op" id="5419506">:=</span>&nbsp;<span class="ident" id="5419509"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5419510">.</span><span class="ident" id="5419511">tmp</span><span class="op" id="5419514">[</span><span class="num" id="5419515">1</span><span class="op" id="5419516">+</span><span class="num" id="5419517">2</span><span class="op" id="5419518">*</span><span class="ident" id="5419519"><a href="/image/jpeg/scan.go.html#5419476">i</a></span><span class="op" id="5419520">]</span>&nbsp;<span class="comment" id="5419522">//&nbsp;Component&nbsp;selector.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419547">compIndex</span>&nbsp;<span class="op" id="5419557">:=</span>&nbsp;<span class="op" id="5419560">-</span><span class="num" id="5419561">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419565">for</span>&nbsp;<span class="ident" id="5419569">j</span><span class="op" id="5419570">,</span>&nbsp;<span class="ident" id="5419572">comp</span>&nbsp;<span class="op" id="5419577">:=</span>&nbsp;<span class="keyword" id="5419580">range</span>&nbsp;<span class="ident" id="5419586"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5419587">.</span><span class="ident" id="5419588">comp</span>&nbsp;<span class="op" id="5419593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419598">if</span>&nbsp;<span class="ident" id="5419601"><a href="/image/jpeg/scan.go.html#5419503">cs</a></span>&nbsp;<span class="op" id="5419604">==</span>&nbsp;<span class="ident" id="5419607"><a href="/image/jpeg/scan.go.html#5419572">comp</a></span><span class="op" id="5419611">.</span><span class="ident" id="5419612">c</span>&nbsp;<span class="op" id="5419614">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419620"><a href="/image/jpeg/scan.go.html#5419547">compIndex</a></span>&nbsp;<span class="op" id="5419630">=</span>&nbsp;<span class="ident" id="5419632"><a href="/image/jpeg/scan.go.html#5419569">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419645">if</span>&nbsp;<span class="ident" id="5419648"><a href="/image/jpeg/scan.go.html#5419547">compIndex</a></span>&nbsp;<span class="op" id="5419658">&lt;</span>&nbsp;<span class="num" id="5419660">0</span>&nbsp;<span class="op" id="5419662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419667">return</span>&nbsp;<span class="ident" id="5419674"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5419685">(</span><span class="string" id="5419686">&#34;unknown&nbsp;component&nbsp;selector&#34;</span><span class="op" id="5419714">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419722"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5419726">[</span><span class="ident" id="5419727"><a href="/image/jpeg/scan.go.html#5419476">i</a></span><span class="op" id="5419728">]</span><span class="op" id="5419729">.</span><span class="ident" id="5419730">compIndex</span>&nbsp;<span class="op" id="5419740">=</span>&nbsp;<span class="builtintype" id="5419742">uint8</span><span class="op" id="5419747">(</span><span class="ident" id="5419748"><a href="/image/jpeg/scan.go.html#5419547">compIndex</a></span><span class="op" id="5419757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419761"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5419765">[</span><span class="ident" id="5419766"><a href="/image/jpeg/scan.go.html#5419476">i</a></span><span class="op" id="5419767">]</span><span class="op" id="5419768">.</span><span class="ident" id="5419769">td</span>&nbsp;<span class="op" id="5419772">=</span>&nbsp;<span class="ident" id="5419774"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5419775">.</span><span class="ident" id="5419776">tmp</span><span class="op" id="5419779">[</span><span class="num" id="5419780">2</span><span class="op" id="5419781">+</span><span class="num" id="5419782">2</span><span class="op" id="5419783">*</span><span class="ident" id="5419784"><a href="/image/jpeg/scan.go.html#5419476">i</a></span><span class="op" id="5419785">]</span>&nbsp;<span class="op" id="5419787">&gt;&gt;</span>&nbsp;<span class="num" id="5419790">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419794">if</span>&nbsp;<span class="ident" id="5419797"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5419801">[</span><span class="ident" id="5419802"><a href="/image/jpeg/scan.go.html#5419476">i</a></span><span class="op" id="5419803">]</span><span class="op" id="5419804">.</span><span class="ident" id="5419805">td</span>&nbsp;<span class="op" id="5419808">&gt;</span>&nbsp;<span class="ident" id="5419810"><a href="/image/jpeg/reader.go.html#5403615">maxTh</a></span>&nbsp;<span class="op" id="5419816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419821">return</span>&nbsp;<span class="ident" id="5419828"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5419839">(</span><span class="string" id="5419840">&#34;bad&nbsp;Td&nbsp;value&#34;</span><span class="op" id="5419854">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419862"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5419866">[</span><span class="ident" id="5419867"><a href="/image/jpeg/scan.go.html#5419476">i</a></span><span class="op" id="5419868">]</span><span class="op" id="5419869">.</span><span class="ident" id="5419870">ta</span>&nbsp;<span class="op" id="5419873">=</span>&nbsp;<span class="ident" id="5419875"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5419876">.</span><span class="ident" id="5419877">tmp</span><span class="op" id="5419880">[</span><span class="num" id="5419881">2</span><span class="op" id="5419882">+</span><span class="num" id="5419883">2</span><span class="op" id="5419884">*</span><span class="ident" id="5419885"><a href="/image/jpeg/scan.go.html#5419476">i</a></span><span class="op" id="5419886">]</span>&nbsp;<span class="op" id="5419888">&amp;</span>&nbsp;<span class="num" id="5419890">0x0f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419897">if</span>&nbsp;<span class="ident" id="5419900"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5419904">[</span><span class="ident" id="5419905"><a href="/image/jpeg/scan.go.html#5419476">i</a></span><span class="op" id="5419906">]</span><span class="op" id="5419907">.</span><span class="ident" id="5419908">ta</span>&nbsp;<span class="op" id="5419911">&gt;</span>&nbsp;<span class="ident" id="5419913"><a href="/image/jpeg/reader.go.html#5403615">maxTh</a></span>&nbsp;<span class="op" id="5419919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419924">return</span>&nbsp;<span class="ident" id="5419931"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5419942">(</span><span class="string" id="5419943">&#34;bad&nbsp;Ta&nbsp;value&#34;</span><span class="op" id="5419957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419961">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5419968">//&nbsp;zigStart&nbsp;and&nbsp;zigEnd&nbsp;are&nbsp;the&nbsp;spectral&nbsp;selection&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420027">//&nbsp;ah&nbsp;and&nbsp;al&nbsp;are&nbsp;the&nbsp;successive&nbsp;approximation&nbsp;high&nbsp;and&nbsp;low&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420095">//&nbsp;The&nbsp;spec&nbsp;calls&nbsp;these&nbsp;values&nbsp;Ss,&nbsp;Se,&nbsp;Ah&nbsp;and&nbsp;Al.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420146">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420150">//&nbsp;For&nbsp;progressive&nbsp;JPEGs,&nbsp;these&nbsp;are&nbsp;the&nbsp;two&nbsp;more-or-less&nbsp;independent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420220">//&nbsp;aspects&nbsp;of&nbsp;progression.&nbsp;Spectral&nbsp;selection&nbsp;progression&nbsp;is&nbsp;when&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420291">//&nbsp;all&nbsp;of&nbsp;a&nbsp;block&#39;s&nbsp;64&nbsp;DCT&nbsp;coefficients&nbsp;are&nbsp;transmitted&nbsp;in&nbsp;one&nbsp;pass.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420361">//&nbsp;For&nbsp;example,&nbsp;three&nbsp;passes&nbsp;could&nbsp;transmit&nbsp;coefficient&nbsp;0&nbsp;(the&nbsp;DC</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420428">//&nbsp;component),&nbsp;coefficients&nbsp;1-5,&nbsp;and&nbsp;coefficients&nbsp;6-63,&nbsp;in&nbsp;zig-zag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420496">//&nbsp;order.&nbsp;Successive&nbsp;approximation&nbsp;is&nbsp;when&nbsp;not&nbsp;all&nbsp;of&nbsp;the&nbsp;bits&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420565">//&nbsp;band&nbsp;of&nbsp;coefficients&nbsp;are&nbsp;transmitted&nbsp;in&nbsp;one&nbsp;pass.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420632">//&nbsp;three&nbsp;passes&nbsp;could&nbsp;transmit&nbsp;the&nbsp;6&nbsp;most&nbsp;significant&nbsp;bits,&nbsp;followed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420702">//&nbsp;by&nbsp;the&nbsp;second-least&nbsp;significant&nbsp;bit,&nbsp;followed&nbsp;by&nbsp;the&nbsp;least</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420765">//&nbsp;significant&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420786">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420790">//&nbsp;For&nbsp;baseline&nbsp;JPEGs,&nbsp;these&nbsp;parameters&nbsp;are&nbsp;hard-coded&nbsp;to&nbsp;0/63/0/0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420859">zigStart</span><span class="op" id="5420867">,</span>&nbsp;<span class="ident" id="5420869">zigEnd</span><span class="op" id="5420875">,</span>&nbsp;<span class="ident" id="5420877">ah</span><span class="op" id="5420879">,</span>&nbsp;<span class="ident" id="5420881">al</span>&nbsp;<span class="op" id="5420884">:=</span>&nbsp;<span class="builtintype" id="5420887">int32</span><span class="op" id="5420892">(</span><span class="num" id="5420893">0</span><span class="op" id="5420894">)</span><span class="op" id="5420895">,</span>&nbsp;<span class="builtintype" id="5420897">int32</span><span class="op" id="5420902">(</span><span class="ident" id="5420903"><a href="/image/jpeg/idct.go.html#5398910">blockSize</a></span><span class="op" id="5420912">-</span><span class="num" id="5420913">1</span><span class="op" id="5420914">)</span><span class="op" id="5420915">,</span>&nbsp;<span class="builtintype" id="5420917">uint32</span><span class="op" id="5420923">(</span><span class="num" id="5420924">0</span><span class="op" id="5420925">)</span><span class="op" id="5420926">,</span>&nbsp;<span class="builtintype" id="5420928">uint32</span><span class="op" id="5420934">(</span><span class="num" id="5420935">0</span><span class="op" id="5420936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420939">if</span>&nbsp;<span class="ident" id="5420942"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5420943">.</span><span class="ident" id="5420944">progressive</span>&nbsp;<span class="op" id="5420956">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420960"><a href="/image/jpeg/scan.go.html#5420859">zigStart</a></span>&nbsp;<span class="op" id="5420969">=</span>&nbsp;<span class="builtintype" id="5420971">int32</span><span class="op" id="5420976">(</span><span class="ident" id="5420977"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5420978">.</span><span class="ident" id="5420979">tmp</span><span class="op" id="5420982">[</span><span class="num" id="5420983">1</span><span class="op" id="5420984">+</span><span class="num" id="5420985">2</span><span class="op" id="5420986">*</span><span class="ident" id="5420987"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span><span class="op" id="5420992">]</span><span class="op" id="5420993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420997"><a href="/image/jpeg/scan.go.html#5420869">zigEnd</a></span>&nbsp;<span class="op" id="5421004">=</span>&nbsp;<span class="builtintype" id="5421006">int32</span><span class="op" id="5421011">(</span><span class="ident" id="5421012"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421013">.</span><span class="ident" id="5421014">tmp</span><span class="op" id="5421017">[</span><span class="num" id="5421018">2</span><span class="op" id="5421019">+</span><span class="num" id="5421020">2</span><span class="op" id="5421021">*</span><span class="ident" id="5421022"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span><span class="op" id="5421027">]</span><span class="op" id="5421028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421032"><a href="/image/jpeg/scan.go.html#5420877">ah</a></span>&nbsp;<span class="op" id="5421035">=</span>&nbsp;<span class="builtintype" id="5421037">uint32</span><span class="op" id="5421043">(</span><span class="ident" id="5421044"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421045">.</span><span class="ident" id="5421046">tmp</span><span class="op" id="5421049">[</span><span class="num" id="5421050">3</span><span class="op" id="5421051">+</span><span class="num" id="5421052">2</span><span class="op" id="5421053">*</span><span class="ident" id="5421054"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span><span class="op" id="5421059">]</span>&nbsp;<span class="op" id="5421061">&gt;&gt;</span>&nbsp;<span class="num" id="5421064">4</span><span class="op" id="5421065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421069"><a href="/image/jpeg/scan.go.html#5420881">al</a></span>&nbsp;<span class="op" id="5421072">=</span>&nbsp;<span class="builtintype" id="5421074">uint32</span><span class="op" id="5421080">(</span><span class="ident" id="5421081"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421082">.</span><span class="ident" id="5421083">tmp</span><span class="op" id="5421086">[</span><span class="num" id="5421087">3</span><span class="op" id="5421088">+</span><span class="num" id="5421089">2</span><span class="op" id="5421090">*</span><span class="ident" id="5421091"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span><span class="op" id="5421096">]</span>&nbsp;<span class="op" id="5421098">&amp;</span>&nbsp;<span class="num" id="5421100">0x0f</span><span class="op" id="5421104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421108">if</span>&nbsp;<span class="op" id="5421111">(</span><span class="ident" id="5421112"><a href="/image/jpeg/scan.go.html#5420859">zigStart</a></span>&nbsp;<span class="op" id="5421121">==</span>&nbsp;<span class="num" id="5421124">0</span>&nbsp;<span class="op" id="5421126">&amp;&amp;</span>&nbsp;<span class="ident" id="5421129"><a href="/image/jpeg/scan.go.html#5420869">zigEnd</a></span>&nbsp;<span class="op" id="5421136">!=</span>&nbsp;<span class="num" id="5421139">0</span><span class="op" id="5421140">)</span>&nbsp;<span class="op" id="5421142">||</span>&nbsp;<span class="ident" id="5421145"><a href="/image/jpeg/scan.go.html#5420859">zigStart</a></span>&nbsp;<span class="op" id="5421154">&gt;</span>&nbsp;<span class="ident" id="5421156"><a href="/image/jpeg/scan.go.html#5420869">zigEnd</a></span>&nbsp;<span class="op" id="5421163">||</span>&nbsp;<span class="ident" id="5421166"><a href="/image/jpeg/idct.go.html#5398910">blockSize</a></span>&nbsp;<span class="op" id="5421176">&lt;=</span>&nbsp;<span class="ident" id="5421179"><a href="/image/jpeg/scan.go.html#5420869">zigEnd</a></span>&nbsp;<span class="op" id="5421186">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421191">return</span>&nbsp;<span class="ident" id="5421198"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5421209">(</span><span class="string" id="5421210">&#34;bad&nbsp;spectral&nbsp;selection&nbsp;bounds&#34;</span><span class="op" id="5421241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421249">if</span>&nbsp;<span class="ident" id="5421252"><a href="/image/jpeg/scan.go.html#5420859">zigStart</a></span>&nbsp;<span class="op" id="5421261">!=</span>&nbsp;<span class="num" id="5421264">0</span>&nbsp;<span class="op" id="5421266">&amp;&amp;</span>&nbsp;<span class="ident" id="5421269"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span>&nbsp;<span class="op" id="5421275">!=</span>&nbsp;<span class="num" id="5421278">1</span>&nbsp;<span class="op" id="5421280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421285">return</span>&nbsp;<span class="ident" id="5421292"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5421303">(</span><span class="string" id="5421304">&#34;progressive&nbsp;AC&nbsp;coefficients&nbsp;for&nbsp;more&nbsp;than&nbsp;one&nbsp;component&#34;</span><span class="op" id="5421361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421365">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421369">if</span>&nbsp;<span class="ident" id="5421372"><a href="/image/jpeg/scan.go.html#5420877">ah</a></span>&nbsp;<span class="op" id="5421375">!=</span>&nbsp;<span class="num" id="5421378">0</span>&nbsp;<span class="op" id="5421380">&amp;&amp;</span>&nbsp;<span class="ident" id="5421383"><a href="/image/jpeg/scan.go.html#5420877">ah</a></span>&nbsp;<span class="op" id="5421386">!=</span>&nbsp;<span class="ident" id="5421389"><a href="/image/jpeg/scan.go.html#5420881">al</a></span><span class="op" id="5421391">+</span><span class="num" id="5421392">1</span>&nbsp;<span class="op" id="5421394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421399">return</span>&nbsp;<span class="ident" id="5421406"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5421417">(</span><span class="string" id="5421418">&#34;bad&nbsp;successive&nbsp;approximation&nbsp;values&#34;</span><span class="op" id="5421455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5421466">//&nbsp;mxx&nbsp;and&nbsp;myy&nbsp;are&nbsp;the&nbsp;number&nbsp;of&nbsp;MCUs&nbsp;(Minimum&nbsp;Coded&nbsp;Units)&nbsp;in&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421541">h0</span><span class="op" id="5421543">,</span>&nbsp;<span class="ident" id="5421545">v0</span>&nbsp;<span class="op" id="5421548">:=</span>&nbsp;<span class="ident" id="5421551"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421552">.</span><span class="ident" id="5421553">comp</span><span class="op" id="5421557">[</span><span class="num" id="5421558">0</span><span class="op" id="5421559">]</span><span class="op" id="5421560">.</span><span class="ident" id="5421561">h</span><span class="op" id="5421562">,</span>&nbsp;<span class="ident" id="5421564"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421565">.</span><span class="ident" id="5421566">comp</span><span class="op" id="5421570">[</span><span class="num" id="5421571">0</span><span class="op" id="5421572">]</span><span class="op" id="5421573">.</span><span class="ident" id="5421574">v</span>&nbsp;<span class="comment" id="5421576">//&nbsp;The&nbsp;h&nbsp;and&nbsp;v&nbsp;values&nbsp;from&nbsp;the&nbsp;Y&nbsp;components.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421622">mxx</span>&nbsp;<span class="op" id="5421626">:=</span>&nbsp;<span class="op" id="5421629">(</span><span class="ident" id="5421630"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421631">.</span><span class="ident" id="5421632">width</span>&nbsp;<span class="op" id="5421638">+</span>&nbsp;<span class="num" id="5421640">8</span><span class="op" id="5421641">*</span><span class="ident" id="5421642"><a href="/image/jpeg/scan.go.html#5421541">h0</a></span>&nbsp;<span class="op" id="5421645">-</span>&nbsp;<span class="num" id="5421647">1</span><span class="op" id="5421648">)</span>&nbsp;<span class="op" id="5421650">/</span>&nbsp;<span class="op" id="5421652">(</span><span class="num" id="5421653">8</span>&nbsp;<span class="op" id="5421655">*</span>&nbsp;<span class="ident" id="5421657"><a href="/image/jpeg/scan.go.html#5421541">h0</a></span><span class="op" id="5421659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421662">myy</span>&nbsp;<span class="op" id="5421666">:=</span>&nbsp;<span class="op" id="5421669">(</span><span class="ident" id="5421670"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421671">.</span><span class="ident" id="5421672">height</span>&nbsp;<span class="op" id="5421679">+</span>&nbsp;<span class="num" id="5421681">8</span><span class="op" id="5421682">*</span><span class="ident" id="5421683"><a href="/image/jpeg/scan.go.html#5421545">v0</a></span>&nbsp;<span class="op" id="5421686">-</span>&nbsp;<span class="num" id="5421688">1</span><span class="op" id="5421689">)</span>&nbsp;<span class="op" id="5421691">/</span>&nbsp;<span class="op" id="5421693">(</span><span class="num" id="5421694">8</span>&nbsp;<span class="op" id="5421696">*</span>&nbsp;<span class="ident" id="5421698"><a href="/image/jpeg/scan.go.html#5421545">v0</a></span><span class="op" id="5421700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421703">if</span>&nbsp;<span class="ident" id="5421706"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421707">.</span><span class="ident" id="5421708">img1</span>&nbsp;<span class="op" id="5421713">==</span>&nbsp;<span class="ident" id="5421716">nil</span>&nbsp;<span class="op" id="5421720">&amp;&amp;</span>&nbsp;<span class="ident" id="5421723"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421724">.</span><span class="ident" id="5421725">img3</span>&nbsp;<span class="op" id="5421730">==</span>&nbsp;<span class="ident" id="5421733">nil</span>&nbsp;<span class="op" id="5421737">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421741"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421742">.</span><span class="ident" id="5421743">makeImg</span><span class="op" id="5421750">(</span><span class="ident" id="5421751"><a href="/image/jpeg/scan.go.html#5421541">h0</a></span><span class="op" id="5421753">,</span>&nbsp;<span class="ident" id="5421755"><a href="/image/jpeg/scan.go.html#5421545">v0</a></span><span class="op" id="5421757">,</span>&nbsp;<span class="ident" id="5421759"><a href="/image/jpeg/scan.go.html#5421622">mxx</a></span><span class="op" id="5421762">,</span>&nbsp;<span class="ident" id="5421764"><a href="/image/jpeg/scan.go.html#5421662">myy</a></span><span class="op" id="5421767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421773">if</span>&nbsp;<span class="ident" id="5421776"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421777">.</span><span class="ident" id="5421778">progressive</span>&nbsp;<span class="op" id="5421790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421794">for</span>&nbsp;<span class="ident" id="5421798">i</span>&nbsp;<span class="op" id="5421800">:=</span>&nbsp;<span class="num" id="5421803">0</span><span class="op" id="5421804">;</span>&nbsp;<span class="ident" id="5421806"><a href="/image/jpeg/scan.go.html#5421798">i</a></span>&nbsp;<span class="op" id="5421808">&lt;</span>&nbsp;<span class="ident" id="5421810"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span><span class="op" id="5421815">;</span>&nbsp;<span class="ident" id="5421817"><a href="/image/jpeg/scan.go.html#5421798">i</a></span><span class="op" id="5421818">++</span>&nbsp;<span class="op" id="5421821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421826">compIndex</span>&nbsp;<span class="op" id="5421836">:=</span>&nbsp;<span class="ident" id="5421839"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5421843">[</span><span class="ident" id="5421844"><a href="/image/jpeg/scan.go.html#5421798">i</a></span><span class="op" id="5421845">]</span><span class="op" id="5421846">.</span><span class="ident" id="5421847">compIndex</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421860">if</span>&nbsp;<span class="ident" id="5421863"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421864">.</span><span class="ident" id="5421865">progCoeffs</span><span class="op" id="5421875">[</span><span class="ident" id="5421876"><a href="/image/jpeg/scan.go.html#5421826">compIndex</a></span><span class="op" id="5421885">]</span>&nbsp;<span class="op" id="5421887">==</span>&nbsp;<span class="ident" id="5421890">nil</span>&nbsp;<span class="op" id="5421894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421900"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421901">.</span><span class="ident" id="5421902">progCoeffs</span><span class="op" id="5421912">[</span><span class="ident" id="5421913"><a href="/image/jpeg/scan.go.html#5421826">compIndex</a></span><span class="op" id="5421922">]</span>&nbsp;<span class="op" id="5421924">=</span>&nbsp;<span class="builtinfunc" id="5421926">make</span><span class="op" id="5421930">(</span><span class="op" id="5421931">[</span><span class="op" id="5421932">]</span><span class="ident" id="5421933"><a href="/image/jpeg/idct.go.html#5398954">block</a></span><span class="op" id="5421938">,</span>&nbsp;<span class="ident" id="5421940"><a href="/image/jpeg/scan.go.html#5421622">mxx</a></span><span class="op" id="5421943">*</span><span class="ident" id="5421944"><a href="/image/jpeg/scan.go.html#5421662">myy</a></span><span class="op" id="5421947">*</span><span class="ident" id="5421948"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421949">.</span><span class="ident" id="5421950">comp</span><span class="op" id="5421954">[</span><span class="ident" id="5421955"><a href="/image/jpeg/scan.go.html#5421826">compIndex</a></span><span class="op" id="5421964">]</span><span class="op" id="5421965">.</span><span class="ident" id="5421966">h</span><span class="op" id="5421967">*</span><span class="ident" id="5421968"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5421969">.</span><span class="ident" id="5421970">comp</span><span class="op" id="5421974">[</span><span class="ident" id="5421975"><a href="/image/jpeg/scan.go.html#5421826">compIndex</a></span><span class="op" id="5421984">]</span><span class="op" id="5421985">.</span><span class="ident" id="5421986">v</span><span class="op" id="5421987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421999">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422003"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5422004">.</span><span class="ident" id="5422005">bits</span>&nbsp;<span class="op" id="5422010">=</span>&nbsp;<span class="ident" id="5422012"><a href="/image/jpeg/reader.go.html#5405354">bits</a></span><span class="op" id="5422016">{</span><span class="op" id="5422017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422020">mcu</span><span class="op" id="5422023">,</span>&nbsp;<span class="ident" id="5422025">expectedRST</span>&nbsp;<span class="op" id="5422037">:=</span>&nbsp;<span class="num" id="5422040">0</span><span class="op" id="5422041">,</span>&nbsp;<span class="builtintype" id="5422043">uint8</span><span class="op" id="5422048">(</span><span class="ident" id="5422049"><a href="/image/jpeg/reader.go.html#5404373">rst0Marker</a></span><span class="op" id="5422059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422062">var</span>&nbsp;<span class="op" id="5422066">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422070">//&nbsp;b&nbsp;is&nbsp;the&nbsp;decoded&nbsp;coefficients,&nbsp;in&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422138">b</span>&nbsp;&nbsp;<span class="ident" id="5422141"><a href="/image/jpeg/idct.go.html#5398954">block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422149">dc</span>&nbsp;<span class="op" id="5422152">[</span><span class="ident" id="5422153"><a href="/image/jpeg/reader.go.html#5403765">nColorComponent</a></span><span class="op" id="5422168">]</span><span class="builtintype" id="5422169">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422177">//&nbsp;bx&nbsp;and&nbsp;by&nbsp;are&nbsp;the&nbsp;location&nbsp;of&nbsp;the&nbsp;current&nbsp;(in&nbsp;terms&nbsp;of&nbsp;8x8&nbsp;blocks).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422250">//&nbsp;For&nbsp;example,&nbsp;with&nbsp;4:2:0&nbsp;chroma&nbsp;subsampling,&nbsp;the&nbsp;block&nbsp;whose&nbsp;top&nbsp;left</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422324">//&nbsp;pixel&nbsp;co-ordinates&nbsp;are&nbsp;(16,&nbsp;8)&nbsp;is&nbsp;the&nbsp;third&nbsp;block&nbsp;in&nbsp;the&nbsp;first&nbsp;row:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422397">//&nbsp;bx&nbsp;is&nbsp;2&nbsp;and&nbsp;by&nbsp;is&nbsp;0,&nbsp;even&nbsp;though&nbsp;the&nbsp;pixel&nbsp;is&nbsp;in&nbsp;the&nbsp;second&nbsp;MCU.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422467">bx</span><span class="op" id="5422469">,</span>&nbsp;<span class="ident" id="5422471">by</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5422478">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422484">blockCount</span>&nbsp;<span class="builtintype" id="5422495">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422503">for</span>&nbsp;<span class="ident" id="5422507">my</span>&nbsp;<span class="op" id="5422510">:=</span>&nbsp;<span class="num" id="5422513">0</span><span class="op" id="5422514">;</span>&nbsp;<span class="ident" id="5422516"><a href="/image/jpeg/scan.go.html#5422507">my</a></span>&nbsp;<span class="op" id="5422519">&lt;</span>&nbsp;<span class="ident" id="5422521"><a href="/image/jpeg/scan.go.html#5421662">myy</a></span><span class="op" id="5422524">;</span>&nbsp;<span class="ident" id="5422526"><a href="/image/jpeg/scan.go.html#5422507">my</a></span><span class="op" id="5422528">++</span>&nbsp;<span class="op" id="5422531">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422535">for</span>&nbsp;<span class="ident" id="5422539">mx</span>&nbsp;<span class="op" id="5422542">:=</span>&nbsp;<span class="num" id="5422545">0</span><span class="op" id="5422546">;</span>&nbsp;<span class="ident" id="5422548"><a href="/image/jpeg/scan.go.html#5422539">mx</a></span>&nbsp;<span class="op" id="5422551">&lt;</span>&nbsp;<span class="ident" id="5422553"><a href="/image/jpeg/scan.go.html#5421622">mxx</a></span><span class="op" id="5422556">;</span>&nbsp;<span class="ident" id="5422558"><a href="/image/jpeg/scan.go.html#5422539">mx</a></span><span class="op" id="5422560">++</span>&nbsp;<span class="op" id="5422563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422568">for</span>&nbsp;<span class="ident" id="5422572">i</span>&nbsp;<span class="op" id="5422574">:=</span>&nbsp;<span class="num" id="5422577">0</span><span class="op" id="5422578">;</span>&nbsp;<span class="ident" id="5422580"><a href="/image/jpeg/scan.go.html#5422572">i</a></span>&nbsp;<span class="op" id="5422582">&lt;</span>&nbsp;<span class="ident" id="5422584"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span><span class="op" id="5422589">;</span>&nbsp;<span class="ident" id="5422591"><a href="/image/jpeg/scan.go.html#5422572">i</a></span><span class="op" id="5422592">++</span>&nbsp;<span class="op" id="5422595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422601">compIndex</span>&nbsp;<span class="op" id="5422611">:=</span>&nbsp;<span class="ident" id="5422614"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5422618">[</span><span class="ident" id="5422619"><a href="/image/jpeg/scan.go.html#5422572">i</a></span><span class="op" id="5422620">]</span><span class="op" id="5422621">.</span><span class="ident" id="5422622">compIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422636">qt</span>&nbsp;<span class="op" id="5422639">:=</span>&nbsp;<span class="op" id="5422642">&amp;</span><span class="ident" id="5422643"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5422644">.</span><span class="ident" id="5422645">quant</span><span class="op" id="5422650">[</span><span class="ident" id="5422651"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5422652">.</span><span class="ident" id="5422653">comp</span><span class="op" id="5422657">[</span><span class="ident" id="5422658"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5422667">]</span><span class="op" id="5422668">.</span><span class="ident" id="5422669">tq</span><span class="op" id="5422671">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422677">for</span>&nbsp;<span class="ident" id="5422681">j</span>&nbsp;<span class="op" id="5422683">:=</span>&nbsp;<span class="num" id="5422686">0</span><span class="op" id="5422687">;</span>&nbsp;<span class="ident" id="5422689"><a href="/image/jpeg/scan.go.html#5422681">j</a></span>&nbsp;<span class="op" id="5422691">&lt;</span>&nbsp;<span class="ident" id="5422693"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5422694">.</span><span class="ident" id="5422695">comp</span><span class="op" id="5422699">[</span><span class="ident" id="5422700"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5422709">]</span><span class="op" id="5422710">.</span><span class="ident" id="5422711">h</span><span class="op" id="5422712">*</span><span class="ident" id="5422713"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5422714">.</span><span class="ident" id="5422715">comp</span><span class="op" id="5422719">[</span><span class="ident" id="5422720"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5422729">]</span><span class="op" id="5422730">.</span><span class="ident" id="5422731">v</span><span class="op" id="5422732">;</span>&nbsp;<span class="ident" id="5422734"><a href="/image/jpeg/scan.go.html#5422681">j</a></span><span class="op" id="5422735">++</span>&nbsp;<span class="op" id="5422738">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422745">//&nbsp;The&nbsp;blocks&nbsp;are&nbsp;traversed&nbsp;one&nbsp;MCU&nbsp;at&nbsp;a&nbsp;time.&nbsp;For&nbsp;4:2:0&nbsp;chroma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422814">//&nbsp;subsampling,&nbsp;there&nbsp;are&nbsp;four&nbsp;Y&nbsp;8x8&nbsp;blocks&nbsp;in&nbsp;every&nbsp;16x16&nbsp;MCU.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422883">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422891">//&nbsp;For&nbsp;a&nbsp;baseline&nbsp;32x16&nbsp;pixel&nbsp;image,&nbsp;the&nbsp;Y&nbsp;blocks&nbsp;visiting&nbsp;order&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422965">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;1&nbsp;4&nbsp;5</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422981">//&nbsp;&nbsp;&nbsp;&nbsp2&nbsp;3&nbsp;6&nbsp;7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422997">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423005">//&nbsp;For&nbsp;progressive&nbsp;images,&nbsp;the&nbsp;interleaved&nbsp;scans&nbsp;(those&nbsp;with&nbsp;nComp&nbsp;&gt;&nbsp;1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423082">//&nbsp;are&nbsp;traversed&nbsp;as&nbsp;above,&nbsp;but&nbsp;non-interleaved&nbsp;scans&nbsp;are&nbsp;traversed&nbsp;left</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423159">//&nbsp;to&nbsp;right,&nbsp;top&nbsp;to&nbsp;bottom:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423192">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;1&nbsp;2&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423208">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;5&nbsp;6&nbsp;7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423224">//&nbsp;Only&nbsp;DC&nbsp;scans&nbsp;(zigStart&nbsp;==&nbsp;0)&nbsp;can&nbsp;be&nbsp;interleaved.&nbsp;AC&nbsp;scans&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423301">//&nbsp;only&nbsp;one&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423329">//</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423337">//&nbsp;To&nbsp;further&nbsp;complicate&nbsp;matters,&nbsp;for&nbsp;non-interleaved&nbsp;scans,&nbsp;there&nbsp;is&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423415">//&nbsp;data&nbsp;for&nbsp;any&nbsp;blocks&nbsp;that&nbsp;are&nbsp;inside&nbsp;the&nbsp;image&nbsp;at&nbsp;the&nbsp;MCU&nbsp;level&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423490">//&nbsp;outside&nbsp;the&nbsp;image&nbsp;at&nbsp;the&nbsp;pixel&nbsp;level.&nbsp;For&nbsp;example,&nbsp;a&nbsp;24x16&nbsp;pixel&nbsp;4:2:0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423569">//&nbsp;progressive&nbsp;image&nbsp;consists&nbsp;of&nbsp;two&nbsp;16x16&nbsp;MCUs.&nbsp;The&nbsp;interleaved&nbsp;scans</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423645">//&nbsp;will&nbsp;process&nbsp;8&nbsp;Y&nbsp;blocks:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423678">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;1&nbsp;4&nbsp;5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423694">//&nbsp;&nbsp;&nbsp;&nbsp2&nbsp;3&nbsp;6&nbsp;7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423710">//&nbsp;The&nbsp;non-interleaved&nbsp;scans&nbsp;will&nbsp;process&nbsp;only&nbsp;6&nbsp;Y&nbsp;blocks:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423774">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;1&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423788">//&nbsp;&nbsp;&nbsp;&nbsp3&nbsp;4&nbsp;5</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423802">if</span>&nbsp;<span class="ident" id="5423805"><a href="/image/jpeg/scan.go.html#5419213">nComp</a></span>&nbsp;<span class="op" id="5423811">!=</span>&nbsp;<span class="num" id="5423814">1</span>&nbsp;<span class="op" id="5423816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423824"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span><span class="op" id="5423826">,</span>&nbsp;<span class="ident" id="5423828"><a href="/image/jpeg/scan.go.html#5422471">by</a></span>&nbsp;<span class="op" id="5423831">=</span>&nbsp;<span class="ident" id="5423833"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5423834">.</span><span class="ident" id="5423835">comp</span><span class="op" id="5423839">[</span><span class="ident" id="5423840"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5423849">]</span><span class="op" id="5423850">.</span><span class="ident" id="5423851">h</span><span class="op" id="5423852">*</span><span class="ident" id="5423853"><a href="/image/jpeg/scan.go.html#5422539">mx</a></span><span class="op" id="5423855">,</span>&nbsp;<span class="ident" id="5423857"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5423858">.</span><span class="ident" id="5423859">comp</span><span class="op" id="5423863">[</span><span class="ident" id="5423864"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5423873">]</span><span class="op" id="5423874">.</span><span class="ident" id="5423875">v</span><span class="op" id="5423876">*</span><span class="ident" id="5423877"><a href="/image/jpeg/scan.go.html#5422507">my</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423886">if</span>&nbsp;<span class="ident" id="5423889"><a href="/image/jpeg/scan.go.html#5421541">h0</a></span>&nbsp;<span class="op" id="5423892">==</span>&nbsp;<span class="num" id="5423895">1</span>&nbsp;<span class="op" id="5423897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423906"><a href="/image/jpeg/scan.go.html#5422471">by</a></span>&nbsp;<span class="op" id="5423909">+=</span>&nbsp;<span class="ident" id="5423912"><a href="/image/jpeg/scan.go.html#5422681">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423920">}</span>&nbsp;<span class="keyword" id="5423922">else</span>&nbsp;<span class="op" id="5423927">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423936"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span>&nbsp;<span class="op" id="5423939">+=</span>&nbsp;<span class="ident" id="5423942"><a href="/image/jpeg/scan.go.html#5422681">j</a></span>&nbsp;<span class="op" id="5423944">%</span>&nbsp;<span class="num" id="5423946">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423955"><a href="/image/jpeg/scan.go.html#5422471">by</a></span>&nbsp;<span class="op" id="5423958">+=</span>&nbsp;<span class="ident" id="5423961"><a href="/image/jpeg/scan.go.html#5422681">j</a></span>&nbsp;<span class="op" id="5423963">/</span>&nbsp;<span class="num" id="5423965">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423980">}</span>&nbsp;<span class="keyword" id="5423982">else</span>&nbsp;<span class="op" id="5423987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423995">q</span>&nbsp;<span class="op" id="5423997">:=</span>&nbsp;<span class="ident" id="5424000"><a href="/image/jpeg/scan.go.html#5421622">mxx</a></span>&nbsp;<span class="op" id="5424004">*</span>&nbsp;<span class="ident" id="5424006"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424007">.</span><span class="ident" id="5424008">comp</span><span class="op" id="5424012">[</span><span class="ident" id="5424013"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5424022">]</span><span class="op" id="5424023">.</span><span class="ident" id="5424024">h</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424032"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span>&nbsp;<span class="op" id="5424035">=</span>&nbsp;<span class="ident" id="5424037"><a href="/image/jpeg/scan.go.html#5422484">blockCount</a></span>&nbsp;<span class="op" id="5424048">%</span>&nbsp;<span class="ident" id="5424050"><a href="/image/jpeg/scan.go.html#5423995">q</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424058"><a href="/image/jpeg/scan.go.html#5422471">by</a></span>&nbsp;<span class="op" id="5424061">=</span>&nbsp;<span class="ident" id="5424063"><a href="/image/jpeg/scan.go.html#5422484">blockCount</a></span>&nbsp;<span class="op" id="5424074">/</span>&nbsp;<span class="ident" id="5424076"><a href="/image/jpeg/scan.go.html#5423995">q</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424084"><a href="/image/jpeg/scan.go.html#5422484">blockCount</a></span><span class="op" id="5424094">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424103">if</span>&nbsp;<span class="ident" id="5424106"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span><span class="op" id="5424108">*</span><span class="num" id="5424109">8</span>&nbsp;<span class="op" id="5424111">&gt;=</span>&nbsp;<span class="ident" id="5424114"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424115">.</span><span class="ident" id="5424116">width</span>&nbsp;<span class="op" id="5424122">||</span>&nbsp;<span class="ident" id="5424125"><a href="/image/jpeg/scan.go.html#5422471">by</a></span><span class="op" id="5424127">*</span><span class="num" id="5424128">8</span>&nbsp;<span class="op" id="5424130">&gt;=</span>&nbsp;<span class="ident" id="5424133"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424134">.</span><span class="ident" id="5424135">height</span>&nbsp;<span class="op" id="5424142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424151">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5424181">//&nbsp;Load&nbsp;the&nbsp;previous&nbsp;partially&nbsp;decoded&nbsp;coefficients,&nbsp;if&nbsp;applicable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424254">if</span>&nbsp;<span class="ident" id="5424257"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424258">.</span><span class="ident" id="5424259">progressive</span>&nbsp;<span class="op" id="5424271">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424279"><a href="/image/jpeg/scan.go.html#5422138">b</a></span>&nbsp;<span class="op" id="5424281">=</span>&nbsp;<span class="ident" id="5424283"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424284">.</span><span class="ident" id="5424285">progCoeffs</span><span class="op" id="5424295">[</span><span class="ident" id="5424296"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5424305">]</span><span class="op" id="5424306">[</span><span class="ident" id="5424307"><a href="/image/jpeg/scan.go.html#5422471">by</a></span><span class="op" id="5424309">*</span><span class="ident" id="5424310"><a href="/image/jpeg/scan.go.html#5421622">mxx</a></span><span class="op" id="5424313">*</span><span class="ident" id="5424314"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424315">.</span><span class="ident" id="5424316">comp</span><span class="op" id="5424320">[</span><span class="ident" id="5424321"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5424330">]</span><span class="op" id="5424331">.</span><span class="ident" id="5424332">h</span><span class="op" id="5424333">+</span><span class="ident" id="5424334"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span><span class="op" id="5424336">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424343">}</span>&nbsp;<span class="keyword" id="5424345">else</span>&nbsp;<span class="op" id="5424350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424358"><a href="/image/jpeg/scan.go.html#5422138">b</a></span>&nbsp;<span class="op" id="5424360">=</span>&nbsp;<span class="ident" id="5424362"><a href="/image/jpeg/idct.go.html#5398954">block</a></span><span class="op" id="5424367">{</span><span class="op" id="5424368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424383">if</span>&nbsp;<span class="ident" id="5424386"><a href="/image/jpeg/scan.go.html#5420877">ah</a></span>&nbsp;<span class="op" id="5424389">!=</span>&nbsp;<span class="num" id="5424392">0</span>&nbsp;<span class="op" id="5424394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424402">if</span>&nbsp;<span class="ident" id="5424405">err</span>&nbsp;<span class="op" id="5424409">:=</span>&nbsp;<span class="ident" id="5424412"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424413">.</span><span class="ident" id="5424414">refine</span><span class="op" id="5424420">(</span><span class="op" id="5424421">&amp;</span><span class="ident" id="5424422"><a href="/image/jpeg/scan.go.html#5422138">b</a></span><span class="op" id="5424423">,</span>&nbsp;<span class="op" id="5424425">&amp;</span><span class="ident" id="5424426"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424427">.</span><span class="ident" id="5424428">huff</span><span class="op" id="5424432">[</span><span class="ident" id="5424433"><a href="/image/jpeg/reader.go.html#5403589">acTable</a></span><span class="op" id="5424440">]</span><span class="op" id="5424441">[</span><span class="ident" id="5424442"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5424446">[</span><span class="ident" id="5424447"><a href="/image/jpeg/scan.go.html#5422572">i</a></span><span class="op" id="5424448">]</span><span class="op" id="5424449">.</span><span class="ident" id="5424450">ta</span><span class="op" id="5424452">]</span><span class="op" id="5424453">,</span>&nbsp;<span class="ident" id="5424455"><a href="/image/jpeg/scan.go.html#5420859">zigStart</a></span><span class="op" id="5424463">,</span>&nbsp;<span class="ident" id="5424465"><a href="/image/jpeg/scan.go.html#5420869">zigEnd</a></span><span class="op" id="5424471">,</span>&nbsp;<span class="num" id="5424473">1</span><span class="op" id="5424474">&lt;&lt;</span><span class="ident" id="5424476"><a href="/image/jpeg/scan.go.html#5420881">al</a></span><span class="op" id="5424478">)</span><span class="op" id="5424479">;</span>&nbsp;<span class="ident" id="5424481"><a href="/image/jpeg/scan.go.html#5424405">err</a></span>&nbsp;<span class="op" id="5424485">!=</span>&nbsp;<span class="ident" id="5424488">nil</span>&nbsp;<span class="op" id="5424492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424501">return</span>&nbsp;<span class="ident" id="5424508"><a href="/image/jpeg/scan.go.html#5424405">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424525">}</span>&nbsp;<span class="keyword" id="5424527">else</span>&nbsp;<span class="op" id="5424532">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424540">zig</span>&nbsp;<span class="op" id="5424544">:=</span>&nbsp;<span class="ident" id="5424547"><a href="/image/jpeg/scan.go.html#5420859">zigStart</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424562">if</span>&nbsp;<span class="ident" id="5424565"><a href="/image/jpeg/scan.go.html#5424540">zig</a></span>&nbsp;<span class="op" id="5424569">==</span>&nbsp;<span class="num" id="5424572">0</span>&nbsp;<span class="op" id="5424574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424583"><a href="/image/jpeg/scan.go.html#5424540">zig</a></span><span class="op" id="5424586">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5424596">//&nbsp;Decode&nbsp;the&nbsp;DC&nbsp;coefficient,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;F.2.2.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424666">value</span><span class="op" id="5424671">,</span>&nbsp;<span class="ident" id="5424673">err</span>&nbsp;<span class="op" id="5424677">:=</span>&nbsp;<span class="ident" id="5424680"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424681">.</span><span class="ident" id="5424682">decodeHuffman</span><span class="op" id="5424695">(</span><span class="op" id="5424696">&amp;</span><span class="ident" id="5424697"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424698">.</span><span class="ident" id="5424699">huff</span><span class="op" id="5424703">[</span><span class="ident" id="5424704"><a href="/image/jpeg/reader.go.html#5403576">dcTable</a></span><span class="op" id="5424711">]</span><span class="op" id="5424712">[</span><span class="ident" id="5424713"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5424717">[</span><span class="ident" id="5424718"><a href="/image/jpeg/scan.go.html#5422572">i</a></span><span class="op" id="5424719">]</span><span class="op" id="5424720">.</span><span class="ident" id="5424721">td</span><span class="op" id="5424723">]</span><span class="op" id="5424724">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424733">if</span>&nbsp;<span class="ident" id="5424736"><a href="/image/jpeg/scan.go.html#5424673">err</a></span>&nbsp;<span class="op" id="5424740">!=</span>&nbsp;<span class="ident" id="5424743">nil</span>&nbsp;<span class="op" id="5424747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424757">return</span>&nbsp;<span class="ident" id="5424764"><a href="/image/jpeg/scan.go.html#5424673">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424784">if</span>&nbsp;<span class="ident" id="5424787"><a href="/image/jpeg/scan.go.html#5424666">value</a></span>&nbsp;<span class="op" id="5424793">&gt;</span>&nbsp;<span class="num" id="5424795">16</span>&nbsp;<span class="op" id="5424798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424808">return</span>&nbsp;<span class="ident" id="5424815"><a href="/image/jpeg/reader.go.html#5403196">UnsupportedError</a></span><span class="op" id="5424831">(</span><span class="string" id="5424832">&#34;excessive&nbsp;DC&nbsp;component&#34;</span><span class="op" id="5424856">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424874">dcDelta</span><span class="op" id="5424881">,</span>&nbsp;<span class="ident" id="5424883"><a href="/image/jpeg/scan.go.html#5424673">err</a></span>&nbsp;<span class="op" id="5424887">:=</span>&nbsp;<span class="ident" id="5424890"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5424891">.</span><span class="ident" id="5424892">receiveExtend</span><span class="op" id="5424905">(</span><span class="ident" id="5424906"><a href="/image/jpeg/scan.go.html#5424666">value</a></span><span class="op" id="5424911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424920">if</span>&nbsp;<span class="ident" id="5424923"><a href="/image/jpeg/scan.go.html#5424673">err</a></span>&nbsp;<span class="op" id="5424927">!=</span>&nbsp;<span class="ident" id="5424930">nil</span>&nbsp;<span class="op" id="5424934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424944">return</span>&nbsp;<span class="ident" id="5424951"><a href="/image/jpeg/scan.go.html#5424673">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424962">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424971"><a href="/image/jpeg/scan.go.html#5422149">dc</a></span><span class="op" id="5424973">[</span><span class="ident" id="5424974"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5424983">]</span>&nbsp;<span class="op" id="5424985">+=</span>&nbsp;<span class="ident" id="5424988"><a href="/image/jpeg/scan.go.html#5424874">dcDelta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425003"><a href="/image/jpeg/scan.go.html#5422138">b</a></span><span class="op" id="5425004">[</span><span class="num" id="5425005">0</span><span class="op" id="5425006">]</span>&nbsp;<span class="op" id="5425008">=</span>&nbsp;<span class="ident" id="5425010"><a href="/image/jpeg/scan.go.html#5422149">dc</a></span><span class="op" id="5425012">[</span><span class="ident" id="5425013"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5425022">]</span>&nbsp;<span class="op" id="5425024">&lt;&lt;</span>&nbsp;<span class="ident" id="5425027"><a href="/image/jpeg/scan.go.html#5420881">al</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425045">if</span>&nbsp;<span class="ident" id="5425048"><a href="/image/jpeg/scan.go.html#5424540">zig</a></span>&nbsp;<span class="op" id="5425052">&lt;=</span>&nbsp;<span class="ident" id="5425055"><a href="/image/jpeg/scan.go.html#5420869">zigEnd</a></span>&nbsp;<span class="op" id="5425062">&amp;&amp;</span>&nbsp;<span class="ident" id="5425065"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5425066">.</span><span class="ident" id="5425067">eobRun</span>&nbsp;<span class="op" id="5425074">&gt;</span>&nbsp;<span class="num" id="5425076">0</span>&nbsp;<span class="op" id="5425078">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425087"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5425088">.</span><span class="ident" id="5425089">eobRun</span><span class="op" id="5425095">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425104">}</span>&nbsp;<span class="keyword" id="5425106">else</span>&nbsp;<span class="op" id="5425111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425120">//&nbsp;Decode&nbsp;the&nbsp;AC&nbsp;coefficients,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;F.2.2.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425191">huff</span>&nbsp;<span class="op" id="5425196">:=</span>&nbsp;<span class="op" id="5425199">&amp;</span><span class="ident" id="5425200"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5425201">.</span><span class="ident" id="5425202">huff</span><span class="op" id="5425206">[</span><span class="ident" id="5425207"><a href="/image/jpeg/reader.go.html#5403589">acTable</a></span><span class="op" id="5425214">]</span><span class="op" id="5425215">[</span><span class="ident" id="5425216"><a href="/image/jpeg/scan.go.html#5419339">scan</a></span><span class="op" id="5425220">[</span><span class="ident" id="5425221"><a href="/image/jpeg/scan.go.html#5422572">i</a></span><span class="op" id="5425222">]</span><span class="op" id="5425223">.</span><span class="ident" id="5425224">ta</span><span class="op" id="5425226">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425235">for</span>&nbsp;<span class="op" id="5425239">;</span>&nbsp;<span class="ident" id="5425241"><a href="/image/jpeg/scan.go.html#5424540">zig</a></span>&nbsp;<span class="op" id="5425245">&lt;=</span>&nbsp;<span class="ident" id="5425248"><a href="/image/jpeg/scan.go.html#5420869">zigEnd</a></span><span class="op" id="5425254">;</span>&nbsp;<span class="ident" id="5425256"><a href="/image/jpeg/scan.go.html#5424540">zig</a></span><span class="op" id="5425259">++</span>&nbsp;<span class="op" id="5425262">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425272">value</span><span class="op" id="5425277">,</span>&nbsp;<span class="ident" id="5425279">err</span>&nbsp;<span class="op" id="5425283">:=</span>&nbsp;<span class="ident" id="5425286"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5425287">.</span><span class="ident" id="5425288">decodeHuffman</span><span class="op" id="5425301">(</span><span class="ident" id="5425302"><a href="/image/jpeg/scan.go.html#5425191">huff</a></span><span class="op" id="5425306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425316">if</span>&nbsp;<span class="ident" id="5425319"><a href="/image/jpeg/scan.go.html#5425279">err</a></span>&nbsp;<span class="op" id="5425323">!=</span>&nbsp;<span class="ident" id="5425326">nil</span>&nbsp;<span class="op" id="5425330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425341">return</span>&nbsp;<span class="ident" id="5425348"><a href="/image/jpeg/scan.go.html#5425279">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425370">val0</span>&nbsp;<span class="op" id="5425375">:=</span>&nbsp;<span class="ident" id="5425378"><a href="/image/jpeg/scan.go.html#5425272">value</a></span>&nbsp;<span class="op" id="5425384">&gt;&gt;</span>&nbsp;<span class="num" id="5425387">4</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425397">val1</span>&nbsp;<span class="op" id="5425402">:=</span>&nbsp;<span class="ident" id="5425405"><a href="/image/jpeg/scan.go.html#5425272">value</a></span>&nbsp;<span class="op" id="5425411">&amp;</span>&nbsp;<span class="num" id="5425413">0x0f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425426">if</span>&nbsp;<span class="ident" id="5425429"><a href="/image/jpeg/scan.go.html#5425397">val1</a></span>&nbsp;<span class="op" id="5425434">!=</span>&nbsp;<span class="num" id="5425437">0</span>&nbsp;<span class="op" id="5425439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425450"><a href="/image/jpeg/scan.go.html#5424540">zig</a></span>&nbsp;<span class="op" id="5425454">+=</span>&nbsp;<span class="builtintype" id="5425457">int32</span><span class="op" id="5425462">(</span><span class="ident" id="5425463"><a href="/image/jpeg/scan.go.html#5425370">val0</a></span><span class="op" id="5425467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425478">if</span>&nbsp;<span class="ident" id="5425481"><a href="/image/jpeg/scan.go.html#5424540">zig</a></span>&nbsp;<span class="op" id="5425485">&gt;</span>&nbsp;<span class="ident" id="5425487"><a href="/image/jpeg/scan.go.html#5420869">zigEnd</a></span>&nbsp;<span class="op" id="5425494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425506">break</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425532">ac</span><span class="op" id="5425534">,</span>&nbsp;<span class="ident" id="5425536">err</span>&nbsp;<span class="op" id="5425540">:=</span>&nbsp;<span class="ident" id="5425543"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5425544">.</span><span class="ident" id="5425545">receiveExtend</span><span class="op" id="5425558">(</span><span class="ident" id="5425559"><a href="/image/jpeg/scan.go.html#5425397">val1</a></span><span class="op" id="5425563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425574">if</span>&nbsp;<span class="ident" id="5425577"><a href="/image/jpeg/scan.go.html#5425536">err</a></span>&nbsp;<span class="op" id="5425581">!=</span>&nbsp;<span class="ident" id="5425584">nil</span>&nbsp;<span class="op" id="5425588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425600">return</span>&nbsp;<span class="ident" id="5425607"><a href="/image/jpeg/scan.go.html#5425536">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425620">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425631"><a href="/image/jpeg/scan.go.html#5422138">b</a></span><span class="op" id="5425632">[</span><span class="ident" id="5425633"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="5425638">[</span><span class="ident" id="5425639"><a href="/image/jpeg/scan.go.html#5424540">zig</a></span><span class="op" id="5425642">]</span><span class="op" id="5425643">]</span>&nbsp;<span class="op" id="5425645">=</span>&nbsp;<span class="ident" id="5425647"><a href="/image/jpeg/scan.go.html#5425532">ac</a></span>&nbsp;<span class="op" id="5425650">&lt;&lt;</span>&nbsp;<span class="ident" id="5425653"><a href="/image/jpeg/scan.go.html#5420881">al</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425664">}</span>&nbsp;<span class="keyword" id="5425666">else</span>&nbsp;<span class="op" id="5425671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425682">if</span>&nbsp;<span class="ident" id="5425685"><a href="/image/jpeg/scan.go.html#5425370">val0</a></span>&nbsp;<span class="op" id="5425690">!=</span>&nbsp;<span class="num" id="5425693">0x0f</span>&nbsp;<span class="op" id="5425698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425710"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5425711">.</span><span class="ident" id="5425712">eobRun</span>&nbsp;<span class="op" id="5425719">=</span>&nbsp;<span class="builtintype" id="5425721">uint16</span><span class="op" id="5425727">(</span><span class="num" id="5425728">1</span>&nbsp;<span class="op" id="5425730">&lt;&lt;</span>&nbsp;<span class="ident" id="5425733"><a href="/image/jpeg/scan.go.html#5425370">val0</a></span><span class="op" id="5425737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425749">if</span>&nbsp;<span class="ident" id="5425752"><a href="/image/jpeg/scan.go.html#5425370">val0</a></span>&nbsp;<span class="op" id="5425757">!=</span>&nbsp;<span class="num" id="5425760">0</span>&nbsp;<span class="op" id="5425762">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425775">bits</span><span class="op" id="5425779">,</span>&nbsp;<span class="ident" id="5425781">err</span>&nbsp;<span class="op" id="5425785">:=</span>&nbsp;<span class="ident" id="5425788"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5425789">.</span><span class="ident" id="5425790">decodeBits</span><span class="op" id="5425800">(</span><span class="builtintype" id="5425801">int32</span><span class="op" id="5425806">(</span><span class="ident" id="5425807"><a href="/image/jpeg/scan.go.html#5425370">val0</a></span><span class="op" id="5425811">)</span><span class="op" id="5425812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425825">if</span>&nbsp;<span class="ident" id="5425828"><a href="/image/jpeg/scan.go.html#5425781">err</a></span>&nbsp;<span class="op" id="5425832">!=</span>&nbsp;<span class="ident" id="5425835">nil</span>&nbsp;<span class="op" id="5425839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425853">return</span>&nbsp;<span class="ident" id="5425860"><a href="/image/jpeg/scan.go.html#5425781">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425888"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5425889">.</span><span class="ident" id="5425890">eobRun</span>&nbsp;<span class="op" id="5425897">|=</span>&nbsp;<span class="builtintype" id="5425900">uint16</span><span class="op" id="5425906">(</span><span class="ident" id="5425907"><a href="/image/jpeg/scan.go.html#5425775">bits</a></span><span class="op" id="5425911">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425935"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5425936">.</span><span class="ident" id="5425937">eobRun</span><span class="op" id="5425943">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425956">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425982"><a href="/image/jpeg/scan.go.html#5424540">zig</a></span>&nbsp;<span class="op" id="5425986">+=</span>&nbsp;<span class="num" id="5425989">0x0f</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426034">if</span>&nbsp;<span class="ident" id="5426037"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5426038">.</span><span class="ident" id="5426039">progressive</span>&nbsp;<span class="op" id="5426051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426059">if</span>&nbsp;<span class="ident" id="5426062"><a href="/image/jpeg/scan.go.html#5420869">zigEnd</a></span>&nbsp;<span class="op" id="5426069">!=</span>&nbsp;<span class="ident" id="5426072"><a href="/image/jpeg/idct.go.html#5398910">blockSize</a></span><span class="op" id="5426081">-</span><span class="num" id="5426082">1</span>&nbsp;<span class="op" id="5426084">||</span>&nbsp;<span class="ident" id="5426087"><a href="/image/jpeg/scan.go.html#5420881">al</a></span>&nbsp;<span class="op" id="5426090">!=</span>&nbsp;<span class="num" id="5426093">0</span>&nbsp;<span class="op" id="5426095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426104">//&nbsp;We&nbsp;haven&#39;t&nbsp;completely&nbsp;decoded&nbsp;this&nbsp;8x8&nbsp;block.&nbsp;Save&nbsp;the&nbsp;coefficients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426183"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5426184">.</span><span class="ident" id="5426185">progCoeffs</span><span class="op" id="5426195">[</span><span class="ident" id="5426196"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5426205">]</span><span class="op" id="5426206">[</span><span class="ident" id="5426207"><a href="/image/jpeg/scan.go.html#5422471">by</a></span><span class="op" id="5426209">*</span><span class="ident" id="5426210"><a href="/image/jpeg/scan.go.html#5421622">mxx</a></span><span class="op" id="5426213">*</span><span class="ident" id="5426214"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5426215">.</span><span class="ident" id="5426216">comp</span><span class="op" id="5426220">[</span><span class="ident" id="5426221"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span><span class="op" id="5426230">]</span><span class="op" id="5426231">.</span><span class="ident" id="5426232">h</span><span class="op" id="5426233">+</span><span class="ident" id="5426234"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span><span class="op" id="5426236">]</span>&nbsp;<span class="op" id="5426238">=</span>&nbsp;<span class="ident" id="5426240"><a href="/image/jpeg/scan.go.html#5422138">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426249">//&nbsp;At&nbsp;this&nbsp;point,&nbsp;we&nbsp;could&nbsp;execute&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;loop&nbsp;body&nbsp;to&nbsp;dequantize&nbsp;and</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426335">//&nbsp;perform&nbsp;the&nbsp;inverse&nbsp;DCT,&nbsp;to&nbsp;save&nbsp;early&nbsp;stages&nbsp;of&nbsp;a&nbsp;progressive&nbsp;image&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426421">//&nbsp;*image.YCbCr&nbsp;buffers&nbsp;(the&nbsp;whole&nbsp;point&nbsp;of&nbsp;progressive&nbsp;encoding),&nbsp;but&nbsp;in&nbsp;Go,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426506">//&nbsp;the&nbsp;jpeg.Decode&nbsp;function&nbsp;does&nbsp;not&nbsp;return&nbsp;until&nbsp;the&nbsp;entire&nbsp;image&nbsp;is&nbsp;decoded,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426592">//&nbsp;so&nbsp;we&nbsp;&#34;continue&#34;&nbsp;here&nbsp;to&nbsp;avoid&nbsp;wasted&nbsp;computation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426653">continue</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426683">//&nbsp;Dequantize,&nbsp;perform&nbsp;the&nbsp;inverse&nbsp;DCT&nbsp;and&nbsp;store&nbsp;the&nbsp;block&nbsp;to&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426761">for</span>&nbsp;<span class="ident" id="5426765">zig</span>&nbsp;<span class="op" id="5426769">:=</span>&nbsp;<span class="num" id="5426772">0</span><span class="op" id="5426773">;</span>&nbsp;<span class="ident" id="5426775"><a href="/image/jpeg/scan.go.html#5426765">zig</a></span>&nbsp;<span class="op" id="5426779">&lt;</span>&nbsp;<span class="ident" id="5426781"><a href="/image/jpeg/idct.go.html#5398910">blockSize</a></span><span class="op" id="5426790">;</span>&nbsp;<span class="ident" id="5426792"><a href="/image/jpeg/scan.go.html#5426765">zig</a></span><span class="op" id="5426795">++</span>&nbsp;<span class="op" id="5426798">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426806"><a href="/image/jpeg/scan.go.html#5422138">b</a></span><span class="op" id="5426807">[</span><span class="ident" id="5426808"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="5426813">[</span><span class="ident" id="5426814"><a href="/image/jpeg/scan.go.html#5426765">zig</a></span><span class="op" id="5426817">]</span><span class="op" id="5426818">]</span>&nbsp;<span class="op" id="5426820">*=</span>&nbsp;<span class="ident" id="5426823"><a href="/image/jpeg/scan.go.html#5422636">qt</a></span><span class="op" id="5426825">[</span><span class="ident" id="5426826"><a href="/image/jpeg/scan.go.html#5426765">zig</a></span><span class="op" id="5426829">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426843"><a href="/image/jpeg/idct.go.html#5399868">idct</a></span><span class="op" id="5426847">(</span><span class="op" id="5426848">&amp;</span><span class="ident" id="5426849"><a href="/image/jpeg/scan.go.html#5422138">b</a></span><span class="op" id="5426850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426857">dst</span><span class="op" id="5426860">,</span>&nbsp;<span class="ident" id="5426862">stride</span>&nbsp;<span class="op" id="5426869">:=</span>&nbsp;<span class="op" id="5426872">[</span><span class="op" id="5426873">]</span><span class="builtintype" id="5426874">byte</span><span class="op" id="5426878">(</span><span class="ident" id="5426879">nil</span><span class="op" id="5426882">)</span><span class="op" id="5426883">,</span>&nbsp;<span class="num" id="5426885">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426892">if</span>&nbsp;<span class="ident" id="5426895"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5426896">.</span><span class="ident" id="5426897">nComp</span>&nbsp;<span class="op" id="5426903">==</span>&nbsp;<span class="ident" id="5426906"><a href="/image/jpeg/reader.go.html#5403693">nGrayComponent</a></span>&nbsp;<span class="op" id="5426921">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426929"><a href="/image/jpeg/scan.go.html#5426857">dst</a></span><span class="op" id="5426932">,</span>&nbsp;<span class="ident" id="5426934"><a href="/image/jpeg/scan.go.html#5426862">stride</a></span>&nbsp;<span class="op" id="5426941">=</span>&nbsp;<span class="ident" id="5426943"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5426944">.</span><span class="ident" id="5426945">img1</span><span class="op" id="5426949">.</span><span class="ident" id="5426950">Pix</span><span class="op" id="5426953">[</span><span class="num" id="5426954">8</span><span class="op" id="5426955">*</span><span class="op" id="5426956">(</span><span class="ident" id="5426957"><a href="/image/jpeg/scan.go.html#5422471">by</a></span><span class="op" id="5426959">*</span><span class="ident" id="5426960"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5426961">.</span><span class="ident" id="5426962">img1</span><span class="op" id="5426966">.</span><span class="ident" id="5426967">Stride</span><span class="op" id="5426973">+</span><span class="ident" id="5426974"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span><span class="op" id="5426976">)</span><span class="op" id="5426977">:</span><span class="op" id="5426978">]</span><span class="op" id="5426979">,</span>&nbsp;<span class="ident" id="5426981"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5426982">.</span><span class="ident" id="5426983">img1</span><span class="op" id="5426987">.</span><span class="ident" id="5426988">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427000">}</span>&nbsp;<span class="keyword" id="5427002">else</span>&nbsp;<span class="op" id="5427007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427015">switch</span>&nbsp;<span class="ident" id="5427022"><a href="/image/jpeg/scan.go.html#5422601">compIndex</a></span>&nbsp;<span class="op" id="5427032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427040">case</span>&nbsp;<span class="num" id="5427045">0</span><span class="op" id="5427046">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427055"><a href="/image/jpeg/scan.go.html#5426857">dst</a></span><span class="op" id="5427058">,</span>&nbsp;<span class="ident" id="5427060"><a href="/image/jpeg/scan.go.html#5426862">stride</a></span>&nbsp;<span class="op" id="5427067">=</span>&nbsp;<span class="ident" id="5427069"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427070">.</span><span class="ident" id="5427071">img3</span><span class="op" id="5427075">.</span><span class="ident" id="5427076">Y</span><span class="op" id="5427077">[</span><span class="num" id="5427078">8</span><span class="op" id="5427079">*</span><span class="op" id="5427080">(</span><span class="ident" id="5427081"><a href="/image/jpeg/scan.go.html#5422471">by</a></span><span class="op" id="5427083">*</span><span class="ident" id="5427084"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427085">.</span><span class="ident" id="5427086">img3</span><span class="op" id="5427090">.</span><span class="ident" id="5427091">YStride</span><span class="op" id="5427098">+</span><span class="ident" id="5427099"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span><span class="op" id="5427101">)</span><span class="op" id="5427102">:</span><span class="op" id="5427103">]</span><span class="op" id="5427104">,</span>&nbsp;<span class="ident" id="5427106"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427107">.</span><span class="ident" id="5427108">img3</span><span class="op" id="5427112">.</span><span class="ident" id="5427113">YStride</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427127">case</span>&nbsp;<span class="num" id="5427132">1</span><span class="op" id="5427133">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427142"><a href="/image/jpeg/scan.go.html#5426857">dst</a></span><span class="op" id="5427145">,</span>&nbsp;<span class="ident" id="5427147"><a href="/image/jpeg/scan.go.html#5426862">stride</a></span>&nbsp;<span class="op" id="5427154">=</span>&nbsp;<span class="ident" id="5427156"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427157">.</span><span class="ident" id="5427158">img3</span><span class="op" id="5427162">.</span><span class="ident" id="5427163">Cb</span><span class="op" id="5427165">[</span><span class="num" id="5427166">8</span><span class="op" id="5427167">*</span><span class="op" id="5427168">(</span><span class="ident" id="5427169"><a href="/image/jpeg/scan.go.html#5422471">by</a></span><span class="op" id="5427171">*</span><span class="ident" id="5427172"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427173">.</span><span class="ident" id="5427174">img3</span><span class="op" id="5427178">.</span><span class="ident" id="5427179">CStride</span><span class="op" id="5427186">+</span><span class="ident" id="5427187"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span><span class="op" id="5427189">)</span><span class="op" id="5427190">:</span><span class="op" id="5427191">]</span><span class="op" id="5427192">,</span>&nbsp;<span class="ident" id="5427194"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427195">.</span><span class="ident" id="5427196">img3</span><span class="op" id="5427200">.</span><span class="ident" id="5427201">CStride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427215">case</span>&nbsp;<span class="num" id="5427220">2</span><span class="op" id="5427221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427230"><a href="/image/jpeg/scan.go.html#5426857">dst</a></span><span class="op" id="5427233">,</span>&nbsp;<span class="ident" id="5427235"><a href="/image/jpeg/scan.go.html#5426862">stride</a></span>&nbsp;<span class="op" id="5427242">=</span>&nbsp;<span class="ident" id="5427244"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427245">.</span><span class="ident" id="5427246">img3</span><span class="op" id="5427250">.</span><span class="ident" id="5427251">Cr</span><span class="op" id="5427253">[</span><span class="num" id="5427254">8</span><span class="op" id="5427255">*</span><span class="op" id="5427256">(</span><span class="ident" id="5427257"><a href="/image/jpeg/scan.go.html#5422471">by</a></span><span class="op" id="5427259">*</span><span class="ident" id="5427260"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427261">.</span><span class="ident" id="5427262">img3</span><span class="op" id="5427266">.</span><span class="ident" id="5427267">CStride</span><span class="op" id="5427274">+</span><span class="ident" id="5427275"><a href="/image/jpeg/scan.go.html#5422467">bx</a></span><span class="op" id="5427277">)</span><span class="op" id="5427278">:</span><span class="op" id="5427279">]</span><span class="op" id="5427280">,</span>&nbsp;<span class="ident" id="5427282"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427283">.</span><span class="ident" id="5427284">img3</span><span class="op" id="5427288">.</span><span class="ident" id="5427289">CStride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427303">default</span><span class="op" id="5427310">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427319">return</span>&nbsp;<span class="ident" id="5427326"><a href="/image/jpeg/reader.go.html#5403196">UnsupportedError</a></span><span class="op" id="5427342">(</span><span class="string" id="5427343">&#34;too&nbsp;many&nbsp;components&#34;</span><span class="op" id="5427364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5427386">//&nbsp;Level&nbsp;shift&nbsp;by&nbsp;+128,&nbsp;clip&nbsp;to&nbsp;[0,&nbsp;255],&nbsp;and&nbsp;write&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427451">for</span>&nbsp;<span class="ident" id="5427455">y</span>&nbsp;<span class="op" id="5427457">:=</span>&nbsp;<span class="num" id="5427460">0</span><span class="op" id="5427461">;</span>&nbsp;<span class="ident" id="5427463"><a href="/image/jpeg/scan.go.html#5427455">y</a></span>&nbsp;<span class="op" id="5427465">&lt;</span>&nbsp;<span class="num" id="5427467">8</span><span class="op" id="5427468">;</span>&nbsp;<span class="ident" id="5427470"><a href="/image/jpeg/scan.go.html#5427455">y</a></span><span class="op" id="5427471">++</span>&nbsp;<span class="op" id="5427474">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427482">y8</span>&nbsp;<span class="op" id="5427485">:=</span>&nbsp;<span class="ident" id="5427488"><a href="/image/jpeg/scan.go.html#5427455">y</a></span>&nbsp;<span class="op" id="5427490">*</span>&nbsp;<span class="num" id="5427492">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427500">yStride</span>&nbsp;<span class="op" id="5427508">:=</span>&nbsp;<span class="ident" id="5427511"><a href="/image/jpeg/scan.go.html#5427455">y</a></span>&nbsp;<span class="op" id="5427513">*</span>&nbsp;<span class="ident" id="5427515"><a href="/image/jpeg/scan.go.html#5426862">stride</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427528">for</span>&nbsp;<span class="ident" id="5427532">x</span>&nbsp;<span class="op" id="5427534">:=</span>&nbsp;<span class="num" id="5427537">0</span><span class="op" id="5427538">;</span>&nbsp;<span class="ident" id="5427540"><a href="/image/jpeg/scan.go.html#5427532">x</a></span>&nbsp;<span class="op" id="5427542">&lt;</span>&nbsp;<span class="num" id="5427544">8</span><span class="op" id="5427545">;</span>&nbsp;<span class="ident" id="5427547"><a href="/image/jpeg/scan.go.html#5427532">x</a></span><span class="op" id="5427548">++</span>&nbsp;<span class="op" id="5427551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427560">c</span>&nbsp;<span class="op" id="5427562">:=</span>&nbsp;<span class="ident" id="5427565"><a href="/image/jpeg/scan.go.html#5422138">b</a></span><span class="op" id="5427566">[</span><span class="ident" id="5427567"><a href="/image/jpeg/scan.go.html#5427482">y8</a></span><span class="op" id="5427569">+</span><span class="ident" id="5427570"><a href="/image/jpeg/scan.go.html#5427532">x</a></span><span class="op" id="5427571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427580">if</span>&nbsp;<span class="ident" id="5427583"><a href="/image/jpeg/scan.go.html#5427560">c</a></span>&nbsp;<span class="op" id="5427585">&lt;</span>&nbsp;<span class="op" id="5427587">-</span><span class="num" id="5427588">128</span>&nbsp;<span class="op" id="5427592">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427602"><a href="/image/jpeg/scan.go.html#5427560">c</a></span>&nbsp;<span class="op" id="5427604">=</span>&nbsp;<span class="num" id="5427606">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427615">}</span>&nbsp;<span class="keyword" id="5427617">else</span>&nbsp;<span class="keyword" id="5427622">if</span>&nbsp;<span class="ident" id="5427625"><a href="/image/jpeg/scan.go.html#5427560">c</a></span>&nbsp;<span class="op" id="5427627">&gt;</span>&nbsp;<span class="num" id="5427629">127</span>&nbsp;<span class="op" id="5427633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427643"><a href="/image/jpeg/scan.go.html#5427560">c</a></span>&nbsp;<span class="op" id="5427645">=</span>&nbsp;<span class="num" id="5427647">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427658">}</span>&nbsp;<span class="keyword" id="5427660">else</span>&nbsp;<span class="op" id="5427665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427675"><a href="/image/jpeg/scan.go.html#5427560">c</a></span>&nbsp;<span class="op" id="5427677">+=</span>&nbsp;<span class="num" id="5427680">128</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427700"><a href="/image/jpeg/scan.go.html#5426857">dst</a></span><span class="op" id="5427703">[</span><span class="ident" id="5427704"><a href="/image/jpeg/scan.go.html#5427500">yStride</a></span><span class="op" id="5427711">+</span><span class="ident" id="5427712"><a href="/image/jpeg/scan.go.html#5427532">x</a></span><span class="op" id="5427713">]</span>&nbsp;<span class="op" id="5427715">=</span>&nbsp;<span class="builtintype" id="5427717">uint8</span><span class="op" id="5427722">(</span><span class="ident" id="5427723"><a href="/image/jpeg/scan.go.html#5427560">c</a></span><span class="op" id="5427724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427745">}</span>&nbsp;<span class="comment" id="5427747">//&nbsp;for&nbsp;j</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5427759">}</span>&nbsp;<span class="comment" id="5427761">//&nbsp;for&nbsp;i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5427773"><a href="/image/jpeg/scan.go.html#5422020">mcu</a></span><span class="op" id="5427776">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5427782">if</span>&nbsp;<span class="ident" id="5427785"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427786">.</span><span class="ident" id="5427787">ri</span>&nbsp;<span class="op" id="5427790">&gt;</span>&nbsp;<span class="num" id="5427792">0</span>&nbsp;<span class="op" id="5427794">&amp;&amp;</span>&nbsp;<span class="ident" id="5427797"><a href="/image/jpeg/scan.go.html#5422020">mcu</a></span><span class="op" id="5427800">%</span><span class="ident" id="5427801"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5427802">.</span><span class="ident" id="5427803">ri</span>&nbsp;<span class="op" id="5427806">==</span>&nbsp;<span class="num" id="5427809">0</span>&nbsp;<span class="op" id="5427811">&amp;&amp;</span>&nbsp;<span class="ident" id="5427814"><a href="/image/jpeg/scan.go.html#5422020">mcu</a></span>&nbsp;<span class="op" id="5427818">&lt;</span>&nbsp;<span class="ident" id="5427820"><a href="/image/jpeg/scan.go.html#5421622">mxx</a></span><span class="op" id="5427823">*</span><span class="ident" id="5427824"><a href="/image/jpeg/scan.go.html#5421662">myy</a></span>&nbsp;<span class="op" id="5427828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5427834">//&nbsp;A&nbsp;more&nbsp;sophisticated&nbsp;decoder&nbsp;could&nbsp;use&nbsp;RST[0-7]&nbsp;markers&nbsp;to&nbsp;resynchronize&nbsp;from&nbsp;corrupt&nbsp;input,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5427934">//&nbsp;but&nbsp;this&nbsp;one&nbsp;assumes&nbsp;well-formed&nbsp;input,&nbsp;and&nbsp;hence&nbsp;the&nbsp;restart&nbsp;marker&nbsp;follows&nbsp;immediately.</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428031">if</span>&nbsp;<span class="ident" id="5428034">err</span>&nbsp;<span class="op" id="5428038">:=</span>&nbsp;<span class="ident" id="5428041"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5428042">.</span><span class="ident" id="5428043">readFull</span><span class="op" id="5428051">(</span><span class="ident" id="5428052"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5428053">.</span><span class="ident" id="5428054">tmp</span><span class="op" id="5428057">[</span><span class="op" id="5428058">:</span><span class="num" id="5428059">2</span><span class="op" id="5428060">]</span><span class="op" id="5428061">)</span><span class="op" id="5428062">;</span>&nbsp;<span class="ident" id="5428064"><a href="/image/jpeg/scan.go.html#5428034">err</a></span>&nbsp;<span class="op" id="5428068">!=</span>&nbsp;<span class="ident" id="5428071">nil</span>&nbsp;<span class="op" id="5428075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428082">return</span>&nbsp;<span class="ident" id="5428089"><a href="/image/jpeg/scan.go.html#5428034">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428103">if</span>&nbsp;<span class="ident" id="5428106"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5428107">.</span><span class="ident" id="5428108">tmp</span><span class="op" id="5428111">[</span><span class="num" id="5428112">0</span><span class="op" id="5428113">]</span>&nbsp;<span class="op" id="5428115">!=</span>&nbsp;<span class="num" id="5428118">0xff</span>&nbsp;<span class="op" id="5428123">||</span>&nbsp;<span class="ident" id="5428126"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5428127">.</span><span class="ident" id="5428128">tmp</span><span class="op" id="5428131">[</span><span class="num" id="5428132">1</span><span class="op" id="5428133">]</span>&nbsp;<span class="op" id="5428135">!=</span>&nbsp;<span class="ident" id="5428138"><a href="/image/jpeg/scan.go.html#5422025">expectedRST</a></span>&nbsp;<span class="op" id="5428150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428157">return</span>&nbsp;<span class="ident" id="5428164"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5428175">(</span><span class="string" id="5428176">&#34;bad&nbsp;RST&nbsp;marker&#34;</span><span class="op" id="5428192">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5428204"><a href="/image/jpeg/scan.go.html#5422025">expectedRST</a></span><span class="op" id="5428215">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428222">if</span>&nbsp;<span class="ident" id="5428225"><a href="/image/jpeg/scan.go.html#5422025">expectedRST</a></span>&nbsp;<span class="op" id="5428237">==</span>&nbsp;<span class="ident" id="5428240"><a href="/image/jpeg/reader.go.html#5404409">rst7Marker</a></span><span class="op" id="5428250">+</span><span class="num" id="5428251">1</span>&nbsp;<span class="op" id="5428253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5428260"><a href="/image/jpeg/scan.go.html#5422025">expectedRST</a></span>&nbsp;<span class="op" id="5428272">=</span>&nbsp;<span class="ident" id="5428274"><a href="/image/jpeg/reader.go.html#5404373">rst0Marker</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428289">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5428295">//&nbsp;Reset&nbsp;the&nbsp;Huffman&nbsp;decoder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5428329"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5428330">.</span><span class="ident" id="5428331">bits</span>&nbsp;<span class="op" id="5428336">=</span>&nbsp;<span class="ident" id="5428338"><a href="/image/jpeg/reader.go.html#5405354">bits</a></span><span class="op" id="5428342">{</span><span class="op" id="5428343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5428349">//&nbsp;Reset&nbsp;the&nbsp;DC&nbsp;components,&nbsp;as&nbsp;per&nbsp;section&nbsp;F.2.1.3.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5428407"><a href="/image/jpeg/scan.go.html#5422149">dc</a></span>&nbsp;<span class="op" id="5428410">=</span>&nbsp;<span class="op" id="5428412">[</span><span class="ident" id="5428413"><a href="/image/jpeg/reader.go.html#5403765">nColorComponent</a></span><span class="op" id="5428428">]</span><span class="builtintype" id="5428429">int32</span><span class="op" id="5428434">{</span><span class="op" id="5428435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5428441">//&nbsp;Reset&nbsp;the&nbsp;progressive&nbsp;decoder&nbsp;state,&nbsp;as&nbsp;per&nbsp;section&nbsp;G.1.2.2.</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5428509"><a href="/image/jpeg/scan.go.html#5418955">d</a></span><span class="op" id="5428510">.</span><span class="ident" id="5428511">eobRun</span>&nbsp;<span class="op" id="5428518">=</span>&nbsp;<span class="num" id="5428520">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428529">}</span>&nbsp;<span class="comment" id="5428531">//&nbsp;for&nbsp;mx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428542">}</span>&nbsp;<span class="comment" id="5428544">//&nbsp;for&nbsp;my</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428556">return</span>&nbsp;<span class="ident" id="5428563">nil</span><br>
<span class="lineno"></span><span class="op" id="5428567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5428570">//&nbsp;refine&nbsp;decodes&nbsp;a&nbsp;successive&nbsp;approximation&nbsp;refinement&nbsp;block,&nbsp;as&nbsp;specified&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5428649">//&nbsp;section&nbsp;G.1.2.</span><br>
<span class="lineno">340</span><span class="keyword" id="5428667">func</span>&nbsp;<span class="op" id="5428672">(</span><span class="ident" id="5428673">d</span>&nbsp;<span class="op" id="5428675">*</span><span class="ident" id="5428676"><a href="/image/jpeg/reader.go.html#5405509">decoder</a></span><span class="op" id="5428683">)</span>&nbsp;<span class="ident" id="5428685">refine</span><span class="op" id="5428691">(</span><span class="ident" id="5428692">b</span>&nbsp;<span class="op" id="5428694">*</span><span class="ident" id="5428695"><a href="/image/jpeg/idct.go.html#5398954">block</a></span><span class="op" id="5428700">,</span>&nbsp;<span class="ident" id="5428702">h</span>&nbsp;<span class="op" id="5428704">*</span><span class="ident" id="5428705"><a href="/image/jpeg/huffman.go.html#5391520">huffman</a></span><span class="op" id="5428712">,</span>&nbsp;<span class="ident" id="5428714">zigStart</span><span class="op" id="5428722">,</span>&nbsp;<span class="ident" id="5428724">zigEnd</span><span class="op" id="5428730">,</span>&nbsp;<span class="ident" id="5428732">delta</span>&nbsp;<span class="builtintype" id="5428738">int32</span><span class="op" id="5428743">)</span>&nbsp;<span class="builtintype" id="5428745">error</span>&nbsp;<span class="op" id="5428751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5428754">//&nbsp;Refining&nbsp;a&nbsp;DC&nbsp;component&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428794">if</span>&nbsp;<span class="ident" id="5428797"><a href="/image/jpeg/scan.go.html#5428714">zigStart</a></span>&nbsp;<span class="op" id="5428806">==</span>&nbsp;<span class="num" id="5428809">0</span>&nbsp;<span class="op" id="5428811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428815">if</span>&nbsp;<span class="ident" id="5428818"><a href="/image/jpeg/scan.go.html#5428724">zigEnd</a></span>&nbsp;<span class="op" id="5428825">!=</span>&nbsp;<span class="num" id="5428828">0</span>&nbsp;<span class="op" id="5428830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5428835">panic</span><span class="op" id="5428840">(</span><span class="string" id="5428841">&#34;unreachable&#34;</span><span class="op" id="5428854">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5428862">bit</span><span class="op" id="5428865">,</span>&nbsp;<span class="ident" id="5428867">err</span>&nbsp;<span class="op" id="5428871">:=</span>&nbsp;<span class="ident" id="5428874"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5428875">.</span><span class="ident" id="5428876">decodeBit</span><span class="op" id="5428885">(</span><span class="op" id="5428886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428890">if</span>&nbsp;<span class="ident" id="5428893"><a href="/image/jpeg/scan.go.html#5428867">err</a></span>&nbsp;<span class="op" id="5428897">!=</span>&nbsp;<span class="ident" id="5428900">nil</span>&nbsp;<span class="op" id="5428904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428909">return</span>&nbsp;<span class="ident" id="5428916"><a href="/image/jpeg/scan.go.html#5428867">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428922">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428926">if</span>&nbsp;<span class="ident" id="5428929"><a href="/image/jpeg/scan.go.html#5428862">bit</a></span>&nbsp;<span class="op" id="5428933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5428938"><a href="/image/jpeg/scan.go.html#5428692">b</a></span><span class="op" id="5428939">[</span><span class="num" id="5428940">0</span><span class="op" id="5428941">]</span>&nbsp;<span class="op" id="5428943">|=</span>&nbsp;<span class="ident" id="5428946"><a href="/image/jpeg/scan.go.html#5428732">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5428958">return</span>&nbsp;<span class="ident" id="5428965">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5428970">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5428974">//&nbsp;Refining&nbsp;AC&nbsp;components&nbsp;is&nbsp;more&nbsp;complicated;&nbsp;see&nbsp;sections&nbsp;G.1.2.2&nbsp;and&nbsp;G.1.2.3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429056">zig</span>&nbsp;<span class="op" id="5429060">:=</span>&nbsp;<span class="ident" id="5429063"><a href="/image/jpeg/scan.go.html#5428714">zigStart</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429073">if</span>&nbsp;<span class="ident" id="5429076"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5429077">.</span><span class="ident" id="5429078">eobRun</span>&nbsp;<span class="op" id="5429085">==</span>&nbsp;<span class="num" id="5429088">0</span>&nbsp;<span class="op" id="5429090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429093">loop</span><span class="op" id="5429097">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429101">for</span>&nbsp;<span class="op" id="5429105">;</span>&nbsp;<span class="ident" id="5429107"><a href="/image/jpeg/scan.go.html#5429056">zig</a></span>&nbsp;<span class="op" id="5429111">&lt;=</span>&nbsp;<span class="ident" id="5429114"><a href="/image/jpeg/scan.go.html#5428724">zigEnd</a></span><span class="op" id="5429120">;</span>&nbsp;<span class="ident" id="5429122"><a href="/image/jpeg/scan.go.html#5429056">zig</a></span><span class="op" id="5429125">++</span>&nbsp;<span class="op" id="5429128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429133">z</span>&nbsp;<span class="op" id="5429135">:=</span>&nbsp;<span class="builtintype" id="5429138">int32</span><span class="op" id="5429143">(</span><span class="num" id="5429144">0</span><span class="op" id="5429145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429150">value</span><span class="op" id="5429155">,</span>&nbsp;<span class="ident" id="5429157">err</span>&nbsp;<span class="op" id="5429161">:=</span>&nbsp;<span class="ident" id="5429164"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5429165">.</span><span class="ident" id="5429166">decodeHuffman</span><span class="op" id="5429179">(</span><span class="ident" id="5429180"><a href="/image/jpeg/scan.go.html#5428702">h</a></span><span class="op" id="5429181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429186">if</span>&nbsp;<span class="ident" id="5429189"><a href="/image/jpeg/scan.go.html#5429157">err</a></span>&nbsp;<span class="op" id="5429193">!=</span>&nbsp;<span class="ident" id="5429196">nil</span>&nbsp;<span class="op" id="5429200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429206">return</span>&nbsp;<span class="ident" id="5429213"><a href="/image/jpeg/scan.go.html#5429157">err</a></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429225">val0</span>&nbsp;<span class="op" id="5429230">:=</span>&nbsp;<span class="ident" id="5429233"><a href="/image/jpeg/scan.go.html#5429150">value</a></span>&nbsp;<span class="op" id="5429239">&gt;&gt;</span>&nbsp;<span class="num" id="5429242">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429247">val1</span>&nbsp;<span class="op" id="5429252">:=</span>&nbsp;<span class="ident" id="5429255"><a href="/image/jpeg/scan.go.html#5429150">value</a></span>&nbsp;<span class="op" id="5429261">&amp;</span>&nbsp;<span class="num" id="5429263">0x0f</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429272">switch</span>&nbsp;<span class="ident" id="5429279"><a href="/image/jpeg/scan.go.html#5429247">val1</a></span>&nbsp;<span class="op" id="5429284">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429289">case</span>&nbsp;<span class="num" id="5429294">0</span><span class="op" id="5429295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429301">if</span>&nbsp;<span class="ident" id="5429304"><a href="/image/jpeg/scan.go.html#5429225">val0</a></span>&nbsp;<span class="op" id="5429309">!=</span>&nbsp;<span class="num" id="5429312">0x0f</span>&nbsp;<span class="op" id="5429317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429324"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5429325">.</span><span class="ident" id="5429326">eobRun</span>&nbsp;<span class="op" id="5429333">=</span>&nbsp;<span class="builtintype" id="5429335">uint16</span><span class="op" id="5429341">(</span><span class="num" id="5429342">1</span>&nbsp;<span class="op" id="5429344">&lt;&lt;</span>&nbsp;<span class="ident" id="5429347"><a href="/image/jpeg/scan.go.html#5429225">val0</a></span><span class="op" id="5429351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429358">if</span>&nbsp;<span class="ident" id="5429361"><a href="/image/jpeg/scan.go.html#5429225">val0</a></span>&nbsp;<span class="op" id="5429366">!=</span>&nbsp;<span class="num" id="5429369">0</span>&nbsp;<span class="op" id="5429371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429379">bits</span><span class="op" id="5429383">,</span>&nbsp;<span class="ident" id="5429385">err</span>&nbsp;<span class="op" id="5429389">:=</span>&nbsp;<span class="ident" id="5429392"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5429393">.</span><span class="ident" id="5429394">decodeBits</span><span class="op" id="5429404">(</span><span class="builtintype" id="5429405">int32</span><span class="op" id="5429410">(</span><span class="ident" id="5429411"><a href="/image/jpeg/scan.go.html#5429225">val0</a></span><span class="op" id="5429415">)</span><span class="op" id="5429416">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429424">if</span>&nbsp;<span class="ident" id="5429427"><a href="/image/jpeg/scan.go.html#5429385">err</a></span>&nbsp;<span class="op" id="5429431">!=</span>&nbsp;<span class="ident" id="5429434">nil</span>&nbsp;<span class="op" id="5429438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429447">return</span>&nbsp;<span class="ident" id="5429454"><a href="/image/jpeg/scan.go.html#5429385">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429472"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5429473">.</span><span class="ident" id="5429474">eobRun</span>&nbsp;<span class="op" id="5429481">|=</span>&nbsp;<span class="builtintype" id="5429484">uint16</span><span class="op" id="5429490">(</span><span class="ident" id="5429491"><a href="/image/jpeg/scan.go.html#5429379">bits</a></span><span class="op" id="5429495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429502">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429509">break</span>&nbsp;<span class="ident" id="5429515">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429529">case</span>&nbsp;<span class="num" id="5429534">1</span><span class="op" id="5429535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429541"><a href="/image/jpeg/scan.go.html#5429133">z</a></span>&nbsp;<span class="op" id="5429543">=</span>&nbsp;<span class="ident" id="5429545"><a href="/image/jpeg/scan.go.html#5428732">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429555">bit</span><span class="op" id="5429558">,</span>&nbsp;<span class="ident" id="5429560">err</span>&nbsp;<span class="op" id="5429564">:=</span>&nbsp;<span class="ident" id="5429567"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5429568">.</span><span class="ident" id="5429569">decodeBit</span><span class="op" id="5429578">(</span><span class="op" id="5429579">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429585">if</span>&nbsp;<span class="ident" id="5429588"><a href="/image/jpeg/scan.go.html#5429560">err</a></span>&nbsp;<span class="op" id="5429592">!=</span>&nbsp;<span class="ident" id="5429595">nil</span>&nbsp;<span class="op" id="5429599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429606">return</span>&nbsp;<span class="ident" id="5429613"><a href="/image/jpeg/scan.go.html#5429560">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429627">if</span>&nbsp;<span class="op" id="5429630">!</span><span class="ident" id="5429631"><a href="/image/jpeg/scan.go.html#5429555">bit</a></span>&nbsp;<span class="op" id="5429635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429642"><a href="/image/jpeg/scan.go.html#5429133">z</a></span>&nbsp;<span class="op" id="5429644">=</span>&nbsp;<span class="op" id="5429646">-</span><span class="ident" id="5429647"><a href="/image/jpeg/scan.go.html#5429133">z</a></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429658">default</span><span class="op" id="5429665">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429671">return</span>&nbsp;<span class="ident" id="5429678"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5429689">(</span><span class="string" id="5429690">&#34;unexpected&nbsp;Huffman&nbsp;code&#34;</span><span class="op" id="5429715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429726"><a href="/image/jpeg/scan.go.html#5429056">zig</a></span><span class="op" id="5429729">,</span>&nbsp;<span class="ident" id="5429731"><a href="/image/jpeg/scan.go.html#5429157">err</a></span>&nbsp;<span class="op" id="5429735">=</span>&nbsp;<span class="ident" id="5429737"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5429738">.</span><span class="ident" id="5429739">refineNonZeroes</span><span class="op" id="5429754">(</span><span class="ident" id="5429755"><a href="/image/jpeg/scan.go.html#5428692">b</a></span><span class="op" id="5429756">,</span>&nbsp;<span class="ident" id="5429758"><a href="/image/jpeg/scan.go.html#5429056">zig</a></span><span class="op" id="5429761">,</span>&nbsp;<span class="ident" id="5429763"><a href="/image/jpeg/scan.go.html#5428724">zigEnd</a></span><span class="op" id="5429769">,</span>&nbsp;<span class="builtintype" id="5429771">int32</span><span class="op" id="5429776">(</span><span class="ident" id="5429777"><a href="/image/jpeg/scan.go.html#5429225">val0</a></span><span class="op" id="5429781">)</span><span class="op" id="5429782">,</span>&nbsp;<span class="ident" id="5429784"><a href="/image/jpeg/scan.go.html#5428732">delta</a></span><span class="op" id="5429789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429794">if</span>&nbsp;<span class="ident" id="5429797"><a href="/image/jpeg/scan.go.html#5429157">err</a></span>&nbsp;<span class="op" id="5429801">!=</span>&nbsp;<span class="ident" id="5429804">nil</span>&nbsp;<span class="op" id="5429808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429814">return</span>&nbsp;<span class="ident" id="5429821"><a href="/image/jpeg/scan.go.html#5429157">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429833">if</span>&nbsp;<span class="ident" id="5429836"><a href="/image/jpeg/scan.go.html#5429056">zig</a></span>&nbsp;<span class="op" id="5429840">&gt;</span>&nbsp;<span class="ident" id="5429842"><a href="/image/jpeg/scan.go.html#5428724">zigEnd</a></span>&nbsp;<span class="op" id="5429849">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429855">return</span>&nbsp;<span class="ident" id="5429862"><a href="/image/jpeg/reader.go.html#5402996">FormatError</a></span><span class="op" id="5429873">(</span><span class="string" id="5429874">&#34;too&nbsp;many&nbsp;coefficients&#34;</span><span class="op" id="5429897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429907">if</span>&nbsp;<span class="ident" id="5429910"><a href="/image/jpeg/scan.go.html#5429133">z</a></span>&nbsp;<span class="op" id="5429912">!=</span>&nbsp;<span class="num" id="5429915">0</span>&nbsp;<span class="op" id="5429917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429923"><a href="/image/jpeg/scan.go.html#5428692">b</a></span><span class="op" id="5429924">[</span><span class="ident" id="5429925"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="5429930">[</span><span class="ident" id="5429931"><a href="/image/jpeg/scan.go.html#5429056">zig</a></span><span class="op" id="5429934">]</span><span class="op" id="5429935">]</span>&nbsp;<span class="op" id="5429937">=</span>&nbsp;<span class="ident" id="5429939"><a href="/image/jpeg/scan.go.html#5429133">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429944">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5429951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429954">if</span>&nbsp;<span class="ident" id="5429957"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5429958">.</span><span class="ident" id="5429959">eobRun</span>&nbsp;<span class="op" id="5429966">&gt;</span>&nbsp;<span class="num" id="5429968">0</span>&nbsp;<span class="op" id="5429970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5429974"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5429975">.</span><span class="ident" id="5429976">eobRun</span><span class="op" id="5429982">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5429987">if</span>&nbsp;<span class="ident" id="5429990">_</span><span class="op" id="5429991">,</span>&nbsp;<span class="ident" id="5429993">err</span>&nbsp;<span class="op" id="5429997">:=</span>&nbsp;<span class="ident" id="5430000"><a href="/image/jpeg/scan.go.html#5428673">d</a></span><span class="op" id="5430001">.</span><span class="ident" id="5430002">refineNonZeroes</span><span class="op" id="5430017">(</span><span class="ident" id="5430018"><a href="/image/jpeg/scan.go.html#5428692">b</a></span><span class="op" id="5430019">,</span>&nbsp;<span class="ident" id="5430021"><a href="/image/jpeg/scan.go.html#5429056">zig</a></span><span class="op" id="5430024">,</span>&nbsp;<span class="ident" id="5430026"><a href="/image/jpeg/scan.go.html#5428724">zigEnd</a></span><span class="op" id="5430032">,</span>&nbsp;<span class="op" id="5430034">-</span><span class="num" id="5430035">1</span><span class="op" id="5430036">,</span>&nbsp;<span class="ident" id="5430038"><a href="/image/jpeg/scan.go.html#5428732">delta</a></span><span class="op" id="5430043">)</span><span class="op" id="5430044">;</span>&nbsp;<span class="ident" id="5430046"><a href="/image/jpeg/scan.go.html#5429993">err</a></span>&nbsp;<span class="op" id="5430050">!=</span>&nbsp;<span class="ident" id="5430053">nil</span>&nbsp;<span class="op" id="5430057">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430062">return</span>&nbsp;<span class="ident" id="5430069"><a href="/image/jpeg/scan.go.html#5429993">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5430075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5430078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430081">return</span>&nbsp;<span class="ident" id="5430088">nil</span><br>
<span class="lineno"></span><span class="op" id="5430092">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="5430095">//&nbsp;refineNonZeroes&nbsp;refines&nbsp;non-zero&nbsp;entries&nbsp;of&nbsp;b&nbsp;in&nbsp;zig-zag&nbsp;order.&nbsp;If&nbsp;nz&nbsp;&gt;=&nbsp;0,</span><br>
<span class="lineno"></span><span class="comment" id="5430174">//&nbsp;the&nbsp;first&nbsp;nz&nbsp;zero&nbsp;entries&nbsp;are&nbsp;skipped&nbsp;over.</span><br>
<span class="lineno"></span><span class="keyword" id="5430221">func</span>&nbsp;<span class="op" id="5430226">(</span><span class="ident" id="5430227">d</span>&nbsp;<span class="op" id="5430229">*</span><span class="ident" id="5430230"><a href="/image/jpeg/reader.go.html#5405509">decoder</a></span><span class="op" id="5430237">)</span>&nbsp;<span class="ident" id="5430239">refineNonZeroes</span><span class="op" id="5430254">(</span><span class="ident" id="5430255">b</span>&nbsp;<span class="op" id="5430257">*</span><span class="ident" id="5430258"><a href="/image/jpeg/idct.go.html#5398954">block</a></span><span class="op" id="5430263">,</span>&nbsp;<span class="ident" id="5430265">zig</span><span class="op" id="5430268">,</span>&nbsp;<span class="ident" id="5430270">zigEnd</span><span class="op" id="5430276">,</span>&nbsp;<span class="ident" id="5430278">nz</span><span class="op" id="5430280">,</span>&nbsp;<span class="ident" id="5430282">delta</span>&nbsp;<span class="builtintype" id="5430288">int32</span><span class="op" id="5430293">)</span>&nbsp;<span class="op" id="5430295">(</span><span class="builtintype" id="5430296">int32</span><span class="op" id="5430301">,</span>&nbsp;<span class="builtintype" id="5430303">error</span><span class="op" id="5430308">)</span>&nbsp;<span class="op" id="5430310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430313">for</span>&nbsp;<span class="op" id="5430317">;</span>&nbsp;<span class="ident" id="5430319"><a href="/image/jpeg/scan.go.html#5430265">zig</a></span>&nbsp;<span class="op" id="5430323">&lt;=</span>&nbsp;<span class="ident" id="5430326"><a href="/image/jpeg/scan.go.html#5430270">zigEnd</a></span><span class="op" id="5430332">;</span>&nbsp;<span class="ident" id="5430334"><a href="/image/jpeg/scan.go.html#5430265">zig</a></span><span class="op" id="5430337">++</span>&nbsp;<span class="op" id="5430340">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5430344">u</span>&nbsp;<span class="op" id="5430346">:=</span>&nbsp;<span class="ident" id="5430349"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="5430354">[</span><span class="ident" id="5430355"><a href="/image/jpeg/scan.go.html#5430265">zig</a></span><span class="op" id="5430358">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430362">if</span>&nbsp;<span class="ident" id="5430365"><a href="/image/jpeg/scan.go.html#5430255">b</a></span><span class="op" id="5430366">[</span><span class="ident" id="5430367"><a href="/image/jpeg/scan.go.html#5430344">u</a></span><span class="op" id="5430368">]</span>&nbsp;<span class="op" id="5430370">==</span>&nbsp;<span class="num" id="5430373">0</span>&nbsp;<span class="op" id="5430375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430380">if</span>&nbsp;<span class="ident" id="5430383"><a href="/image/jpeg/scan.go.html#5430278">nz</a></span>&nbsp;<span class="op" id="5430386">==</span>&nbsp;<span class="num" id="5430389">0</span>&nbsp;<span class="op" id="5430391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430397">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5430406">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5430411"><a href="/image/jpeg/scan.go.html#5430278">nz</a></span><span class="op" id="5430413">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430419">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5430430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5430434">bit</span><span class="op" id="5430437">,</span>&nbsp;<span class="ident" id="5430439">err</span>&nbsp;<span class="op" id="5430443">:=</span>&nbsp;<span class="ident" id="5430446"><a href="/image/jpeg/scan.go.html#5430227">d</a></span><span class="op" id="5430447">.</span><span class="ident" id="5430448">decodeBit</span><span class="op" id="5430457">(</span><span class="op" id="5430458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430462">if</span>&nbsp;<span class="ident" id="5430465"><a href="/image/jpeg/scan.go.html#5430439">err</a></span>&nbsp;<span class="op" id="5430469">!=</span>&nbsp;<span class="ident" id="5430472">nil</span>&nbsp;<span class="op" id="5430476">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430481">return</span>&nbsp;<span class="num" id="5430488">0</span><span class="op" id="5430489">,</span>&nbsp;<span class="ident" id="5430491"><a href="/image/jpeg/scan.go.html#5430439">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5430497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430501">if</span>&nbsp;<span class="op" id="5430504">!</span><span class="ident" id="5430505"><a href="/image/jpeg/scan.go.html#5430434">bit</a></span>&nbsp;<span class="op" id="5430509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430514">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5430525">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430529">if</span>&nbsp;<span class="ident" id="5430532"><a href="/image/jpeg/scan.go.html#5430255">b</a></span><span class="op" id="5430533">[</span><span class="ident" id="5430534"><a href="/image/jpeg/scan.go.html#5430344">u</a></span><span class="op" id="5430535">]</span>&nbsp;<span class="op" id="5430537">&gt;=</span>&nbsp;<span class="num" id="5430540">0</span>&nbsp;<span class="op" id="5430542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5430547"><a href="/image/jpeg/scan.go.html#5430255">b</a></span><span class="op" id="5430548">[</span><span class="ident" id="5430549"><a href="/image/jpeg/scan.go.html#5430344">u</a></span><span class="op" id="5430550">]</span>&nbsp;<span class="op" id="5430552">+=</span>&nbsp;<span class="ident" id="5430555"><a href="/image/jpeg/scan.go.html#5430282">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5430563">}</span>&nbsp;<span class="keyword" id="5430565">else</span>&nbsp;<span class="op" id="5430570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5430575"><a href="/image/jpeg/scan.go.html#5430255">b</a></span><span class="op" id="5430576">[</span><span class="ident" id="5430577"><a href="/image/jpeg/scan.go.html#5430344">u</a></span><span class="op" id="5430578">]</span>&nbsp;<span class="op" id="5430580">-=</span>&nbsp;<span class="ident" id="5430583"><a href="/image/jpeg/scan.go.html#5430282">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5430591">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5430594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5430597">return</span>&nbsp;<span class="ident" id="5430604"><a href="/image/jpeg/scan.go.html#5430265">zig</a></span><span class="op" id="5430607">,</span>&nbsp;<span class="ident" id="5430609">nil</span><br>
<span class="lineno"></span><span class="op" id="5430613">}</span>
</div>
</body>
</html>
