<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html" class="current">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4072430">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4072485">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4072539">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4072590">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4072655">package</span>&nbsp;<span class="ident" id="4072663">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4072668">import</span>&nbsp;<span class="op" id="4072675">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4072678">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4072684">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="4072694">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4072697">func</span>&nbsp;<span class="ident" id="4072702">newFileFD</span><span class="op" id="4072711">(</span><span class="ident" id="4072712">f</span>&nbsp;<span class="op" id="4072714">*</span><span class="ident" id="4072715">os</span><span class="op" id="4072717">.</span><span class="ident" id="4072718">File</span><span class="op" id="4072722">)</span>&nbsp;<span class="op" id="4072724">(</span><span class="op" id="4072725">*</span><span class="ident" id="4072726">netFD</span><span class="op" id="4072731">,</span>&nbsp;<span class="builtintype" id="4072733">error</span><span class="op" id="4072738">)</span>&nbsp;<span class="op" id="4072740">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072743">fd</span><span class="op" id="4072745">,</span>&nbsp;<span class="ident" id="4072747">err</span>&nbsp;<span class="op" id="4072751">:=</span>&nbsp;<span class="ident" id="4072754">dupCloseOnExec</span><span class="op" id="4072768">(</span><span class="builtintype" id="4072769">int</span><span class="op" id="4072772">(</span><span class="ident" id="4072773">f</span><span class="op" id="4072774">.</span><span class="ident" id="4072775">Fd</span><span class="op" id="4072777">(</span><span class="op" id="4072778">)</span><span class="op" id="4072779">)</span><span class="op" id="4072780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072783">if</span>&nbsp;<span class="ident" id="4072786">err</span>&nbsp;<span class="op" id="4072790">!=</span>&nbsp;<span class="ident" id="4072793">nil</span>&nbsp;<span class="op" id="4072797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072801">return</span>&nbsp;<span class="ident" id="4072808">nil</span><span class="op" id="4072811">,</span>&nbsp;<span class="ident" id="4072813">os</span><span class="op" id="4072815">.</span><span class="ident" id="4072816">NewSyscallError</span><span class="op" id="4072831">(</span><span class="string" id="4072832">&#34;dup&#34;</span><span class="op" id="4072837">,</span>&nbsp;<span class="ident" id="4072839">err</span><span class="op" id="4072842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072849">if</span>&nbsp;<span class="ident" id="4072852">err</span>&nbsp;<span class="op" id="4072856">=</span>&nbsp;<span class="ident" id="4072858">syscall</span><span class="op" id="4072865">.</span><span class="ident" id="4072866">SetNonblock</span><span class="op" id="4072877">(</span><span class="ident" id="4072878">fd</span><span class="op" id="4072880">,</span>&nbsp;<span class="builtintype" id="4072882">true</span><span class="op" id="4072886">)</span><span class="op" id="4072887">;</span>&nbsp;<span class="ident" id="4072889">err</span>&nbsp;<span class="op" id="4072893">!=</span>&nbsp;<span class="ident" id="4072896">nil</span>&nbsp;<span class="op" id="4072900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072904">closesocket</span><span class="op" id="4072915">(</span><span class="ident" id="4072916">fd</span><span class="op" id="4072918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072922">return</span>&nbsp;<span class="ident" id="4072929">nil</span><span class="op" id="4072932">,</span>&nbsp;<span class="ident" id="4072934">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072943">sotype</span><span class="op" id="4072949">,</span>&nbsp;<span class="ident" id="4072951">err</span>&nbsp;<span class="op" id="4072955">:=</span>&nbsp;<span class="ident" id="4072958">syscall</span><span class="op" id="4072965">.</span><span class="ident" id="4072966">GetsockoptInt</span><span class="op" id="4072979">(</span><span class="ident" id="4072980">fd</span><span class="op" id="4072982">,</span>&nbsp;<span class="ident" id="4072984">syscall</span><span class="op" id="4072991">.</span><span class="ident" id="4072992">SOL_SOCKET</span><span class="op" id="4073002">,</span>&nbsp;<span class="ident" id="4073004">syscall</span><span class="op" id="4073011">.</span><span class="ident" id="4073012">SO_TYPE</span><span class="op" id="4073019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073022">if</span>&nbsp;<span class="ident" id="4073025">err</span>&nbsp;<span class="op" id="4073029">!=</span>&nbsp;<span class="ident" id="4073032">nil</span>&nbsp;<span class="op" id="4073036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073040">closesocket</span><span class="op" id="4073051">(</span><span class="ident" id="4073052">fd</span><span class="op" id="4073054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073058">return</span>&nbsp;<span class="ident" id="4073065">nil</span><span class="op" id="4073068">,</span>&nbsp;<span class="ident" id="4073070">os</span><span class="op" id="4073072">.</span><span class="ident" id="4073073">NewSyscallError</span><span class="op" id="4073088">(</span><span class="string" id="4073089">&#34;getsockopt&#34;</span><span class="op" id="4073101">,</span>&nbsp;<span class="ident" id="4073103">err</span><span class="op" id="4073106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073109">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073113">family</span>&nbsp;<span class="op" id="4073120">:=</span>&nbsp;<span class="ident" id="4073123">syscall</span><span class="op" id="4073130">.</span><span class="ident" id="4073131">AF_UNSPEC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073142">toAddr</span>&nbsp;<span class="op" id="4073149">:=</span>&nbsp;<span class="ident" id="4073152">sockaddrToTCP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073167">lsa</span><span class="op" id="4073170">,</span>&nbsp;<span class="ident" id="4073172">_</span>&nbsp;<span class="op" id="4073174">:=</span>&nbsp;<span class="ident" id="4073177">syscall</span><span class="op" id="4073184">.</span><span class="ident" id="4073185">Getsockname</span><span class="op" id="4073196">(</span><span class="ident" id="4073197">fd</span><span class="op" id="4073199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073202">switch</span>&nbsp;<span class="ident" id="4073209">lsa</span><span class="op" id="4073212">.</span><span class="op" id="4073213">(</span><span class="keyword" id="4073214">type</span><span class="op" id="4073218">)</span>&nbsp;<span class="op" id="4073220">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073223">default</span><span class="op" id="4073230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073234">closesocket</span><span class="op" id="4073245">(</span><span class="ident" id="4073246">fd</span><span class="op" id="4073248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073252">return</span>&nbsp;<span class="ident" id="4073259">nil</span><span class="op" id="4073262">,</span>&nbsp;<span class="ident" id="4073264">syscall</span><span class="op" id="4073271">.</span><span class="ident" id="4073272">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073280">case</span>&nbsp;<span class="op" id="4073285">*</span><span class="ident" id="4073286">syscall</span><span class="op" id="4073293">.</span><span class="ident" id="4073294">SockaddrInet4</span><span class="op" id="4073307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073311">family</span>&nbsp;<span class="op" id="4073318">=</span>&nbsp;<span class="ident" id="4073320">syscall</span><span class="op" id="4073327">.</span><span class="ident" id="4073328">AF_INET</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073338">if</span>&nbsp;<span class="ident" id="4073341">sotype</span>&nbsp;<span class="op" id="4073348">==</span>&nbsp;<span class="ident" id="4073351">syscall</span><span class="op" id="4073358">.</span><span class="ident" id="4073359">SOCK_DGRAM</span>&nbsp;<span class="op" id="4073370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073375">toAddr</span>&nbsp;<span class="op" id="4073382">=</span>&nbsp;<span class="ident" id="4073384">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073400">}</span>&nbsp;<span class="keyword" id="4073402">else</span>&nbsp;<span class="keyword" id="4073407">if</span>&nbsp;<span class="ident" id="4073410">sotype</span>&nbsp;<span class="op" id="4073417">==</span>&nbsp;<span class="ident" id="4073420">syscall</span><span class="op" id="4073427">.</span><span class="ident" id="4073428">SOCK_RAW</span>&nbsp;<span class="op" id="4073437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073442">toAddr</span>&nbsp;<span class="op" id="4073449">=</span>&nbsp;<span class="ident" id="4073451">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073466">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073469">case</span>&nbsp;<span class="op" id="4073474">*</span><span class="ident" id="4073475">syscall</span><span class="op" id="4073482">.</span><span class="ident" id="4073483">SockaddrInet6</span><span class="op" id="4073496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073500">family</span>&nbsp;<span class="op" id="4073507">=</span>&nbsp;<span class="ident" id="4073509">syscall</span><span class="op" id="4073516">.</span><span class="ident" id="4073517">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073528">if</span>&nbsp;<span class="ident" id="4073531">sotype</span>&nbsp;<span class="op" id="4073538">==</span>&nbsp;<span class="ident" id="4073541">syscall</span><span class="op" id="4073548">.</span><span class="ident" id="4073549">SOCK_DGRAM</span>&nbsp;<span class="op" id="4073560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073565">toAddr</span>&nbsp;<span class="op" id="4073572">=</span>&nbsp;<span class="ident" id="4073574">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073590">}</span>&nbsp;<span class="keyword" id="4073592">else</span>&nbsp;<span class="keyword" id="4073597">if</span>&nbsp;<span class="ident" id="4073600">sotype</span>&nbsp;<span class="op" id="4073607">==</span>&nbsp;<span class="ident" id="4073610">syscall</span><span class="op" id="4073617">.</span><span class="ident" id="4073618">SOCK_RAW</span>&nbsp;<span class="op" id="4073627">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073632">toAddr</span>&nbsp;<span class="op" id="4073639">=</span>&nbsp;<span class="ident" id="4073641">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073659">case</span>&nbsp;<span class="op" id="4073664">*</span><span class="ident" id="4073665">syscall</span><span class="op" id="4073672">.</span><span class="ident" id="4073673">SockaddrUnix</span><span class="op" id="4073685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073689">family</span>&nbsp;<span class="op" id="4073696">=</span>&nbsp;<span class="ident" id="4073698">syscall</span><span class="op" id="4073705">.</span><span class="ident" id="4073706">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073716">toAddr</span>&nbsp;<span class="op" id="4073723">=</span>&nbsp;<span class="ident" id="4073725">sockaddrToUnix</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073742">if</span>&nbsp;<span class="ident" id="4073745">sotype</span>&nbsp;<span class="op" id="4073752">==</span>&nbsp;<span class="ident" id="4073755">syscall</span><span class="op" id="4073762">.</span><span class="ident" id="4073763">SOCK_DGRAM</span>&nbsp;<span class="op" id="4073774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073779">toAddr</span>&nbsp;<span class="op" id="4073786">=</span>&nbsp;<span class="ident" id="4073788">sockaddrToUnixgram</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073809">}</span>&nbsp;<span class="keyword" id="4073811">else</span>&nbsp;<span class="keyword" id="4073816">if</span>&nbsp;<span class="ident" id="4073819">sotype</span>&nbsp;<span class="op" id="4073826">==</span>&nbsp;<span class="ident" id="4073829">syscall</span><span class="op" id="4073836">.</span><span class="ident" id="4073837">SOCK_SEQPACKET</span>&nbsp;<span class="op" id="4073852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073857">toAddr</span>&nbsp;<span class="op" id="4073864">=</span>&nbsp;<span class="ident" id="4073866">sockaddrToUnixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073889">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073895">laddr</span>&nbsp;<span class="op" id="4073901">:=</span>&nbsp;<span class="ident" id="4073904">toAddr</span><span class="op" id="4073910">(</span><span class="ident" id="4073911">lsa</span><span class="op" id="4073914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073917">rsa</span><span class="op" id="4073920">,</span>&nbsp;<span class="ident" id="4073922">_</span>&nbsp;<span class="op" id="4073924">:=</span>&nbsp;<span class="ident" id="4073927">syscall</span><span class="op" id="4073934">.</span><span class="ident" id="4073935">Getpeername</span><span class="op" id="4073946">(</span><span class="ident" id="4073947">fd</span><span class="op" id="4073949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073952">raddr</span>&nbsp;<span class="op" id="4073958">:=</span>&nbsp;<span class="ident" id="4073961">toAddr</span><span class="op" id="4073967">(</span><span class="ident" id="4073968">rsa</span><span class="op" id="4073971">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073975">netfd</span><span class="op" id="4073980">,</span>&nbsp;<span class="ident" id="4073982">err</span>&nbsp;<span class="op" id="4073986">:=</span>&nbsp;<span class="ident" id="4073989">newFD</span><span class="op" id="4073994">(</span><span class="ident" id="4073995">fd</span><span class="op" id="4073997">,</span>&nbsp;<span class="ident" id="4073999">family</span><span class="op" id="4074005">,</span>&nbsp;<span class="ident" id="4074007">sotype</span><span class="op" id="4074013">,</span>&nbsp;<span class="ident" id="4074015">laddr</span><span class="op" id="4074020">.</span><span class="ident" id="4074021">Network</span><span class="op" id="4074028">(</span><span class="op" id="4074029">)</span><span class="op" id="4074030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074033">if</span>&nbsp;<span class="ident" id="4074036">err</span>&nbsp;<span class="op" id="4074040">!=</span>&nbsp;<span class="ident" id="4074043">nil</span>&nbsp;<span class="op" id="4074047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074051">closesocket</span><span class="op" id="4074062">(</span><span class="ident" id="4074063">fd</span><span class="op" id="4074065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074069">return</span>&nbsp;<span class="ident" id="4074076">nil</span><span class="op" id="4074079">,</span>&nbsp;<span class="ident" id="4074081">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074086">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074089">if</span>&nbsp;<span class="ident" id="4074092">err</span>&nbsp;<span class="op" id="4074096">:=</span>&nbsp;<span class="ident" id="4074099">netfd</span><span class="op" id="4074104">.</span><span class="ident" id="4074105">init</span><span class="op" id="4074109">(</span><span class="op" id="4074110">)</span><span class="op" id="4074111">;</span>&nbsp;<span class="ident" id="4074113">err</span>&nbsp;<span class="op" id="4074117">!=</span>&nbsp;<span class="ident" id="4074120">nil</span>&nbsp;<span class="op" id="4074124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074128">netfd</span><span class="op" id="4074133">.</span><span class="ident" id="4074134">Close</span><span class="op" id="4074139">(</span><span class="op" id="4074140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074144">return</span>&nbsp;<span class="ident" id="4074151">nil</span><span class="op" id="4074154">,</span>&nbsp;<span class="ident" id="4074156">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074164">netfd</span><span class="op" id="4074169">.</span><span class="ident" id="4074170">setAddr</span><span class="op" id="4074177">(</span><span class="ident" id="4074178">laddr</span><span class="op" id="4074183">,</span>&nbsp;<span class="ident" id="4074185">raddr</span><span class="op" id="4074190">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074193">return</span>&nbsp;<span class="ident" id="4074200">netfd</span><span class="op" id="4074205">,</span>&nbsp;<span class="ident" id="4074207">nil</span><br>
<span class="lineno"></span><span class="op" id="4074211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4074214">//&nbsp;FileConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;connection&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4074284">//&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when</span><br>
<span class="lineno">80</span><span class="comment" id="4074355">//&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4074421">//&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4074434">func</span>&nbsp;<span class="ident" id="4074439">FileConn</span><span class="op" id="4074447">(</span><span class="ident" id="4074448">f</span>&nbsp;<span class="op" id="4074450">*</span><span class="ident" id="4074451">os</span><span class="op" id="4074453">.</span><span class="ident" id="4074454">File</span><span class="op" id="4074458">)</span>&nbsp;<span class="op" id="4074460">(</span><span class="ident" id="4074461">c</span>&nbsp;<span class="ident" id="4074463">Conn</span><span class="op" id="4074467">,</span>&nbsp;<span class="ident" id="4074469">err</span>&nbsp;<span class="builtintype" id="4074473">error</span><span class="op" id="4074478">)</span>&nbsp;<span class="op" id="4074480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074483">fd</span><span class="op" id="4074485">,</span>&nbsp;<span class="ident" id="4074487">err</span>&nbsp;<span class="op" id="4074491">:=</span>&nbsp;<span class="ident" id="4074494">newFileFD</span><span class="op" id="4074503">(</span><span class="ident" id="4074504">f</span><span class="op" id="4074505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074508">if</span>&nbsp;<span class="ident" id="4074511">err</span>&nbsp;<span class="op" id="4074515">!=</span>&nbsp;<span class="ident" id="4074518">nil</span>&nbsp;<span class="op" id="4074522">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074526">return</span>&nbsp;<span class="ident" id="4074533">nil</span><span class="op" id="4074536">,</span>&nbsp;<span class="ident" id="4074538">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074546">switch</span>&nbsp;<span class="ident" id="4074553">fd</span><span class="op" id="4074555">.</span><span class="ident" id="4074556">laddr</span><span class="op" id="4074561">.</span><span class="op" id="4074562">(</span><span class="keyword" id="4074563">type</span><span class="op" id="4074567">)</span>&nbsp;<span class="op" id="4074569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074572">case</span>&nbsp;<span class="op" id="4074577">*</span><span class="ident" id="4074578">TCPAddr</span><span class="op" id="4074585">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074589">return</span>&nbsp;<span class="ident" id="4074596">newTCPConn</span><span class="op" id="4074606">(</span><span class="ident" id="4074607">fd</span><span class="op" id="4074609">)</span><span class="op" id="4074610">,</span>&nbsp;<span class="ident" id="4074612">nil</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074617">case</span>&nbsp;<span class="op" id="4074622">*</span><span class="ident" id="4074623">UDPAddr</span><span class="op" id="4074630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074634">return</span>&nbsp;<span class="ident" id="4074641">newUDPConn</span><span class="op" id="4074651">(</span><span class="ident" id="4074652">fd</span><span class="op" id="4074654">)</span><span class="op" id="4074655">,</span>&nbsp;<span class="ident" id="4074657">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074662">case</span>&nbsp;<span class="op" id="4074667">*</span><span class="ident" id="4074668">IPAddr</span><span class="op" id="4074674">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074678">return</span>&nbsp;<span class="ident" id="4074685">newIPConn</span><span class="op" id="4074694">(</span><span class="ident" id="4074695">fd</span><span class="op" id="4074697">)</span><span class="op" id="4074698">,</span>&nbsp;<span class="ident" id="4074700">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074705">case</span>&nbsp;<span class="op" id="4074710">*</span><span class="ident" id="4074711">UnixAddr</span><span class="op" id="4074719">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074723">return</span>&nbsp;<span class="ident" id="4074730">newUnixConn</span><span class="op" id="4074741">(</span><span class="ident" id="4074742">fd</span><span class="op" id="4074744">)</span><span class="op" id="4074745">,</span>&nbsp;<span class="ident" id="4074747">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074755">fd</span><span class="op" id="4074757">.</span><span class="ident" id="4074758">Close</span><span class="op" id="4074763">(</span><span class="op" id="4074764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074767">return</span>&nbsp;<span class="ident" id="4074774">nil</span><span class="op" id="4074777">,</span>&nbsp;<span class="ident" id="4074779">syscall</span><span class="op" id="4074786">.</span><span class="ident" id="4074787">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="4074794">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4074797">//&nbsp;FileListener&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;listener&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="4074866">//&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;l</span><br>
<span class="lineno"></span><span class="comment" id="4074935">//&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4075006">//&nbsp;affect&nbsp;l.</span><br>
<span class="lineno">105</span><span class="keyword" id="4075019">func</span>&nbsp;<span class="ident" id="4075024">FileListener</span><span class="op" id="4075036">(</span><span class="ident" id="4075037">f</span>&nbsp;<span class="op" id="4075039">*</span><span class="ident" id="4075040">os</span><span class="op" id="4075042">.</span><span class="ident" id="4075043">File</span><span class="op" id="4075047">)</span>&nbsp;<span class="op" id="4075049">(</span><span class="ident" id="4075050">l</span>&nbsp;<span class="ident" id="4075052">Listener</span><span class="op" id="4075060">,</span>&nbsp;<span class="ident" id="4075062">err</span>&nbsp;<span class="builtintype" id="4075066">error</span><span class="op" id="4075071">)</span>&nbsp;<span class="op" id="4075073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075076">fd</span><span class="op" id="4075078">,</span>&nbsp;<span class="ident" id="4075080">err</span>&nbsp;<span class="op" id="4075084">:=</span>&nbsp;<span class="ident" id="4075087">newFileFD</span><span class="op" id="4075096">(</span><span class="ident" id="4075097">f</span><span class="op" id="4075098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075101">if</span>&nbsp;<span class="ident" id="4075104">err</span>&nbsp;<span class="op" id="4075108">!=</span>&nbsp;<span class="ident" id="4075111">nil</span>&nbsp;<span class="op" id="4075115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075119">return</span>&nbsp;<span class="ident" id="4075126">nil</span><span class="op" id="4075129">,</span>&nbsp;<span class="ident" id="4075131">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075136">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075139">switch</span>&nbsp;<span class="ident" id="4075146">laddr</span>&nbsp;<span class="op" id="4075152">:=</span>&nbsp;<span class="ident" id="4075155">fd</span><span class="op" id="4075157">.</span><span class="ident" id="4075158">laddr</span><span class="op" id="4075163">.</span><span class="op" id="4075164">(</span><span class="keyword" id="4075165">type</span><span class="op" id="4075169">)</span>&nbsp;<span class="op" id="4075171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075174">case</span>&nbsp;<span class="op" id="4075179">*</span><span class="ident" id="4075180">TCPAddr</span><span class="op" id="4075187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075191">return</span>&nbsp;<span class="op" id="4075198">&amp;</span><span class="ident" id="4075199">TCPListener</span><span class="op" id="4075210">{</span><span class="ident" id="4075211">fd</span><span class="op" id="4075213">}</span><span class="op" id="4075214">,</span>&nbsp;<span class="ident" id="4075216">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075221">case</span>&nbsp;<span class="op" id="4075226">*</span><span class="ident" id="4075227">UnixAddr</span><span class="op" id="4075235">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075239">return</span>&nbsp;<span class="op" id="4075246">&amp;</span><span class="ident" id="4075247">UnixListener</span><span class="op" id="4075259">{</span><span class="ident" id="4075260">fd</span><span class="op" id="4075262">,</span>&nbsp;<span class="ident" id="4075264">laddr</span><span class="op" id="4075269">.</span><span class="ident" id="4075270">Name</span><span class="op" id="4075274">}</span><span class="op" id="4075275">,</span>&nbsp;<span class="ident" id="4075277">nil</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075285">fd</span><span class="op" id="4075287">.</span><span class="ident" id="4075288">Close</span><span class="op" id="4075293">(</span><span class="op" id="4075294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075297">return</span>&nbsp;<span class="ident" id="4075304">nil</span><span class="op" id="4075307">,</span>&nbsp;<span class="ident" id="4075309">syscall</span><span class="op" id="4075316">.</span><span class="ident" id="4075317">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="4075324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4075327">//&nbsp;FilePacketConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;packet&nbsp;network&nbsp;connection</span><br>
<span class="lineno"></span><span class="comment" id="4075393">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4075450">//&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect</span><br>
<span class="lineno"></span><span class="comment" id="4075521">//&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4075560">func</span>&nbsp;<span class="ident" id="4075565">FilePacketConn</span><span class="op" id="4075579">(</span><span class="ident" id="4075580">f</span>&nbsp;<span class="op" id="4075582">*</span><span class="ident" id="4075583">os</span><span class="op" id="4075585">.</span><span class="ident" id="4075586">File</span><span class="op" id="4075590">)</span>&nbsp;<span class="op" id="4075592">(</span><span class="ident" id="4075593">c</span>&nbsp;<span class="ident" id="4075595">PacketConn</span><span class="op" id="4075605">,</span>&nbsp;<span class="ident" id="4075607">err</span>&nbsp;<span class="builtintype" id="4075611">error</span><span class="op" id="4075616">)</span>&nbsp;<span class="op" id="4075618">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075621">fd</span><span class="op" id="4075623">,</span>&nbsp;<span class="ident" id="4075625">err</span>&nbsp;<span class="op" id="4075629">:=</span>&nbsp;<span class="ident" id="4075632">newFileFD</span><span class="op" id="4075641">(</span><span class="ident" id="4075642">f</span><span class="op" id="4075643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075646">if</span>&nbsp;<span class="ident" id="4075649">err</span>&nbsp;<span class="op" id="4075653">!=</span>&nbsp;<span class="ident" id="4075656">nil</span>&nbsp;<span class="op" id="4075660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075664">return</span>&nbsp;<span class="ident" id="4075671">nil</span><span class="op" id="4075674">,</span>&nbsp;<span class="ident" id="4075676">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075684">switch</span>&nbsp;<span class="ident" id="4075691">fd</span><span class="op" id="4075693">.</span><span class="ident" id="4075694">laddr</span><span class="op" id="4075699">.</span><span class="op" id="4075700">(</span><span class="keyword" id="4075701">type</span><span class="op" id="4075705">)</span>&nbsp;<span class="op" id="4075707">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075710">case</span>&nbsp;<span class="op" id="4075715">*</span><span class="ident" id="4075716">UDPAddr</span><span class="op" id="4075723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075727">return</span>&nbsp;<span class="ident" id="4075734">newUDPConn</span><span class="op" id="4075744">(</span><span class="ident" id="4075745">fd</span><span class="op" id="4075747">)</span><span class="op" id="4075748">,</span>&nbsp;<span class="ident" id="4075750">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075755">case</span>&nbsp;<span class="op" id="4075760">*</span><span class="ident" id="4075761">IPAddr</span><span class="op" id="4075767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075771">return</span>&nbsp;<span class="ident" id="4075778">newIPConn</span><span class="op" id="4075787">(</span><span class="ident" id="4075788">fd</span><span class="op" id="4075790">)</span><span class="op" id="4075791">,</span>&nbsp;<span class="ident" id="4075793">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075798">case</span>&nbsp;<span class="op" id="4075803">*</span><span class="ident" id="4075804">UnixAddr</span><span class="op" id="4075812">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075816">return</span>&nbsp;<span class="ident" id="4075823">newUnixConn</span><span class="op" id="4075834">(</span><span class="ident" id="4075835">fd</span><span class="op" id="4075837">)</span><span class="op" id="4075838">,</span>&nbsp;<span class="ident" id="4075840">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075848">fd</span><span class="op" id="4075850">.</span><span class="ident" id="4075851">Close</span><span class="op" id="4075856">(</span><span class="op" id="4075857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075860">return</span>&nbsp;<span class="ident" id="4075867">nil</span><span class="op" id="4075870">,</span>&nbsp;<span class="ident" id="4075872">syscall</span><span class="op" id="4075879">.</span><span class="ident" id="4075880">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="4075887">}</span>
</div>
</body>
</html>
