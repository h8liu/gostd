<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6671924">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6671979">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6672033">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6672084">package</span>&nbsp;<span class="ident" id="6672092">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6672097">import</span>&nbsp;<span class="op" id="6672104">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6672107">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6672116">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6672122">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6672135">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6672148">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6672154">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6672164">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6672167">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6672214">type</span>&nbsp;<span class="ident" id="6672219">WriteTest</span>&nbsp;<span class="keyword" id="6672229">struct</span>&nbsp;<span class="op" id="6672236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672239">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6672246">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672254">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6672261">[</span><span class="op" id="6672262">]</span><span class="builtintype" id="6672263">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672269">Method</span>&nbsp;<span class="builtintype" id="6672276">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672284">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6672291"><a href="/archive/zip/writer_test.go.html#6672148">os</a></span><span class="op" id="6672293">.</span><span class="ident" id="6672294">FileMode</span><br>
<span class="lineno"></span><span class="op" id="6672303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6672306">var</span>&nbsp;<span class="ident" id="6672310">writeTests</span>&nbsp;<span class="op" id="6672321">=</span>&nbsp;<span class="op" id="6672323">[</span><span class="op" id="6672324">]</span><span class="ident" id="6672325"><a href="/archive/zip/writer_test.go.html#6672219">WriteTest</a></span><span class="op" id="6672334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672341">Name</span><span class="op" id="6672345">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6672349">&#34;foo&#34;</span><span class="op" id="6672354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672358">Data</span><span class="op" id="6672362">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6672366">[</span><span class="op" id="6672367">]</span><span class="builtintype" id="6672368">byte</span><span class="op" id="6672372">(</span><span class="string" id="6672373">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="6672433">)</span><span class="op" id="6672434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672438">Method</span><span class="op" id="6672444">:</span>&nbsp;<span class="ident" id="6672446"><a href="/archive/zip/struct.go.html#6403390">Store</a></span><span class="op" id="6672451">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672455">Mode</span><span class="op" id="6672459">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6672463">0666</span><span class="op" id="6672467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672470">}</span><span class="op" id="6672471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672478">Name</span><span class="op" id="6672482">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6672486">&#34;bar&#34;</span><span class="op" id="6672491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672495">Data</span><span class="op" id="6672499">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6672503">nil</span><span class="op" id="6672506">,</span>&nbsp;<span class="comment" id="6672508">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672540">Method</span><span class="op" id="6672546">:</span>&nbsp;<span class="ident" id="6672548"><a href="/archive/zip/struct.go.html#6403410">Deflate</a></span><span class="op" id="6672555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672559">Mode</span><span class="op" id="6672563">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6672567">0644</span><span class="op" id="6672571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672574">}</span><span class="op" id="6672575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672582">Name</span><span class="op" id="6672586">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6672590">&#34;setuid&#34;</span><span class="op" id="6672598">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672602">Data</span><span class="op" id="6672606">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6672610">[</span><span class="op" id="6672611">]</span><span class="builtintype" id="6672612">byte</span><span class="op" id="6672616">(</span><span class="string" id="6672617">&#34;setuid&nbsp;file&#34;</span><span class="op" id="6672630">)</span><span class="op" id="6672631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672635">Method</span><span class="op" id="6672641">:</span>&nbsp;<span class="ident" id="6672643"><a href="/archive/zip/struct.go.html#6403410">Deflate</a></span><span class="op" id="6672650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672654">Mode</span><span class="op" id="6672658">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6672662">0755</span>&nbsp;<span class="op" id="6672667">|</span>&nbsp;<span class="ident" id="6672669"><a href="/archive/zip/writer_test.go.html#6672148">os</a></span><span class="op" id="6672671">.</span><span class="ident" id="6672672">ModeSetuid</span><span class="op" id="6672682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672685">}</span><span class="op" id="6672686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672689">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672693">Name</span><span class="op" id="6672697">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6672701">&#34;setgid&#34;</span><span class="op" id="6672709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672713">Data</span><span class="op" id="6672717">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6672721">[</span><span class="op" id="6672722">]</span><span class="builtintype" id="6672723">byte</span><span class="op" id="6672727">(</span><span class="string" id="6672728">&#34;setgid&nbsp;file&#34;</span><span class="op" id="6672741">)</span><span class="op" id="6672742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672746">Method</span><span class="op" id="6672752">:</span>&nbsp;<span class="ident" id="6672754"><a href="/archive/zip/struct.go.html#6403410">Deflate</a></span><span class="op" id="6672761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672765">Mode</span><span class="op" id="6672769">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6672773">0755</span>&nbsp;<span class="op" id="6672778">|</span>&nbsp;<span class="ident" id="6672780"><a href="/archive/zip/writer_test.go.html#6672148">os</a></span><span class="op" id="6672782">.</span><span class="ident" id="6672783">ModeSetgid</span><span class="op" id="6672793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672796">}</span><span class="op" id="6672797">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672804">Name</span><span class="op" id="6672808">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6672812">&#34;symlink&#34;</span><span class="op" id="6672821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672825">Data</span><span class="op" id="6672829">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6672833">[</span><span class="op" id="6672834">]</span><span class="builtintype" id="6672835">byte</span><span class="op" id="6672839">(</span><span class="string" id="6672840">&#34;../link/target&#34;</span><span class="op" id="6672856">)</span><span class="op" id="6672857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672861">Method</span><span class="op" id="6672867">:</span>&nbsp;<span class="ident" id="6672869"><a href="/archive/zip/struct.go.html#6403410">Deflate</a></span><span class="op" id="6672876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672880">Mode</span><span class="op" id="6672884">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6672888">0755</span>&nbsp;<span class="op" id="6672893">|</span>&nbsp;<span class="ident" id="6672895"><a href="/archive/zip/writer_test.go.html#6672148">os</a></span><span class="op" id="6672897">.</span><span class="ident" id="6672898">ModeSymlink</span><span class="op" id="6672909">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6672912">}</span><span class="op" id="6672913">,</span><br>
<span class="lineno"></span><span class="op" id="6672915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6672918">func</span>&nbsp;<span class="ident" id="6672923">TestWriter</span><span class="op" id="6672933">(</span><span class="ident" id="6672934">t</span>&nbsp;<span class="op" id="6672936">*</span><span class="ident" id="6672937"><a href="/archive/zip/writer_test.go.html#6672154">testing</a></span><span class="op" id="6672944">.</span><span class="ident" id="6672945">T</span><span class="op" id="6672946">)</span>&nbsp;<span class="op" id="6672948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6672951">largeData</span>&nbsp;<span class="op" id="6672961">:=</span>&nbsp;<span class="builtinfunc" id="6672964">make</span><span class="op" id="6672968">(</span><span class="op" id="6672969">[</span><span class="op" id="6672970">]</span><span class="builtintype" id="6672971">byte</span><span class="op" id="6672975">,</span>&nbsp;<span class="num" id="6672977">1</span><span class="op" id="6672978">&lt;&lt;</span><span class="num" id="6672980">17</span><span class="op" id="6672982">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6672985">for</span>&nbsp;<span class="ident" id="6672989">i</span>&nbsp;<span class="op" id="6672991">:=</span>&nbsp;<span class="keyword" id="6672994">range</span>&nbsp;<span class="ident" id="6673000"><a href="/archive/zip/writer_test.go.html#6672951">largeData</a></span>&nbsp;<span class="op" id="6673010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673014"><a href="/archive/zip/writer_test.go.html#6672951">largeData</a></span><span class="op" id="6673023">[</span><span class="ident" id="6673024"><a href="/archive/zip/writer_test.go.html#6672989">i</a></span><span class="op" id="6673025">]</span>&nbsp;<span class="op" id="6673027">=</span>&nbsp;<span class="builtintype" id="6673029">byte</span><span class="op" id="6673033">(</span><span class="ident" id="6673034"><a href="/archive/zip/writer_test.go.html#6672135">rand</a></span><span class="op" id="6673038">.</span><span class="ident" id="6673039">Int</span><span class="op" id="6673042">(</span><span class="op" id="6673043">)</span><span class="op" id="6673044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673050"><a href="/archive/zip/writer_test.go.html#6672310">writeTests</a></span><span class="op" id="6673060">[</span><span class="num" id="6673061">1</span><span class="op" id="6673062">]</span><span class="op" id="6673063">.</span><span class="ident" id="6673064">Data</span>&nbsp;<span class="op" id="6673069">=</span>&nbsp;<span class="ident" id="6673071"><a href="/archive/zip/writer_test.go.html#6672951">largeData</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673082">defer</span>&nbsp;<span class="keyword" id="6673088">func</span><span class="op" id="6673092">(</span><span class="op" id="6673093">)</span>&nbsp;<span class="op" id="6673095">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673099"><a href="/archive/zip/writer_test.go.html#6672310">writeTests</a></span><span class="op" id="6673109">[</span><span class="num" id="6673110">1</span><span class="op" id="6673111">]</span><span class="op" id="6673112">.</span><span class="ident" id="6673113">Data</span>&nbsp;<span class="op" id="6673118">=</span>&nbsp;<span class="ident" id="6673120">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673125">}</span><span class="op" id="6673126">(</span><span class="op" id="6673127">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6673131">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673152">buf</span>&nbsp;<span class="op" id="6673156">:=</span>&nbsp;<span class="builtinfunc" id="6673159">new</span><span class="op" id="6673162">(</span><span class="ident" id="6673163"><a href="/archive/zip/writer_test.go.html#6672107">bytes</a></span><span class="op" id="6673168">.</span><span class="ident" id="6673169">Buffer</span><span class="op" id="6673175">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673178">w</span>&nbsp;<span class="op" id="6673180">:=</span>&nbsp;<span class="ident" id="6673183"><a href="/archive/zip/writer.go.html#6411718">NewWriter</a></span><span class="op" id="6673192">(</span><span class="ident" id="6673193"><a href="/archive/zip/writer_test.go.html#6673152">buf</a></span><span class="op" id="6673196">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673200">for</span>&nbsp;<span class="ident" id="6673204">_</span><span class="op" id="6673205">,</span>&nbsp;<span class="ident" id="6673207">wt</span>&nbsp;<span class="op" id="6673210">:=</span>&nbsp;<span class="keyword" id="6673213">range</span>&nbsp;<span class="ident" id="6673219"><a href="/archive/zip/writer_test.go.html#6672310">writeTests</a></span>&nbsp;<span class="op" id="6673230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673234"><a href="/archive/zip/writer_test.go.html#6673885">testCreate</a></span><span class="op" id="6673244">(</span><span class="ident" id="6673245"><a href="/archive/zip/writer_test.go.html#6672934">t</a></span><span class="op" id="6673246">,</span>&nbsp;<span class="ident" id="6673248"><a href="/archive/zip/writer_test.go.html#6673178">w</a></span><span class="op" id="6673249">,</span>&nbsp;<span class="op" id="6673251">&amp;</span><span class="ident" id="6673252"><a href="/archive/zip/writer_test.go.html#6673207">wt</a></span><span class="op" id="6673254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673257">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673261">if</span>&nbsp;<span class="ident" id="6673264">err</span>&nbsp;<span class="op" id="6673268">:=</span>&nbsp;<span class="ident" id="6673271"><a href="/archive/zip/writer_test.go.html#6673178">w</a></span><span class="op" id="6673272">.</span><span class="ident" id="6673273">Close</span><span class="op" id="6673278">(</span><span class="op" id="6673279">)</span><span class="op" id="6673280">;</span>&nbsp;<span class="ident" id="6673282"><a href="/archive/zip/writer_test.go.html#6673264">err</a></span>&nbsp;<span class="op" id="6673286">!=</span>&nbsp;<span class="ident" id="6673289">nil</span>&nbsp;<span class="op" id="6673293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673297"><a href="/archive/zip/writer_test.go.html#6672934">t</a></span><span class="op" id="6673298">.</span><span class="ident" id="6673299">Fatal</span><span class="op" id="6673304">(</span><span class="ident" id="6673305"><a href="/archive/zip/writer_test.go.html#6673264">err</a></span><span class="op" id="6673308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6673315">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673332">r</span><span class="op" id="6673333">,</span>&nbsp;<span class="ident" id="6673335">err</span>&nbsp;<span class="op" id="6673339">:=</span>&nbsp;<span class="ident" id="6673342"><a href="/archive/zip/reader.go.html#6388809">NewReader</a></span><span class="op" id="6673351">(</span><span class="ident" id="6673352"><a href="/archive/zip/writer_test.go.html#6672107">bytes</a></span><span class="op" id="6673357">.</span><span class="ident" id="6673358">NewReader</span><span class="op" id="6673367">(</span><span class="ident" id="6673368"><a href="/archive/zip/writer_test.go.html#6673152">buf</a></span><span class="op" id="6673371">.</span><span class="ident" id="6673372">Bytes</span><span class="op" id="6673377">(</span><span class="op" id="6673378">)</span><span class="op" id="6673379">)</span><span class="op" id="6673380">,</span>&nbsp;<span class="ident" id="6673382">int64</span><span class="op" id="6673387">(</span><span class="ident" id="6673388"><a href="/archive/zip/writer_test.go.html#6673152">buf</a></span><span class="op" id="6673391">.</span><span class="ident" id="6673392">Len</span><span class="op" id="6673395">(</span><span class="op" id="6673396">)</span><span class="op" id="6673397">)</span><span class="op" id="6673398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673401">if</span>&nbsp;<span class="ident" id="6673404"><a href="/archive/zip/writer_test.go.html#6673335">err</a></span>&nbsp;<span class="op" id="6673408">!=</span>&nbsp;<span class="ident" id="6673411">nil</span>&nbsp;<span class="op" id="6673415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673419"><a href="/archive/zip/writer_test.go.html#6672934">t</a></span><span class="op" id="6673420">.</span><span class="ident" id="6673421">Fatal</span><span class="op" id="6673426">(</span><span class="ident" id="6673427"><a href="/archive/zip/writer_test.go.html#6673335">err</a></span><span class="op" id="6673430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673433">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673436">for</span>&nbsp;<span class="ident" id="6673440">i</span><span class="op" id="6673441">,</span>&nbsp;<span class="ident" id="6673443">wt</span>&nbsp;<span class="op" id="6673446">:=</span>&nbsp;<span class="keyword" id="6673449">range</span>&nbsp;<span class="ident" id="6673455"><a href="/archive/zip/writer_test.go.html#6672310">writeTests</a></span>&nbsp;<span class="op" id="6673466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673470"><a href="/archive/zip/writer_test.go.html#6674192">testReadFile</a></span><span class="op" id="6673482">(</span><span class="ident" id="6673483"><a href="/archive/zip/writer_test.go.html#6672934">t</a></span><span class="op" id="6673484">,</span>&nbsp;<span class="ident" id="6673486"><a href="/archive/zip/writer_test.go.html#6673332">r</a></span><span class="op" id="6673487">.</span><span class="ident" id="6673488">File</span><span class="op" id="6673492">[</span><span class="ident" id="6673493"><a href="/archive/zip/writer_test.go.html#6673440">i</a></span><span class="op" id="6673494">]</span><span class="op" id="6673495">,</span>&nbsp;<span class="op" id="6673497">&amp;</span><span class="ident" id="6673498"><a href="/archive/zip/writer_test.go.html#6673443">wt</a></span><span class="op" id="6673500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673503">}</span><br>
<span class="lineno"></span><span class="op" id="6673505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6673508">func</span>&nbsp;<span class="ident" id="6673513">TestWriterFlush</span><span class="op" id="6673528">(</span><span class="ident" id="6673529">t</span>&nbsp;<span class="op" id="6673531">*</span><span class="ident" id="6673532"><a href="/archive/zip/writer_test.go.html#6672154">testing</a></span><span class="op" id="6673539">.</span><span class="ident" id="6673540">T</span><span class="op" id="6673541">)</span>&nbsp;<span class="op" id="6673543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673546">var</span>&nbsp;<span class="ident" id="6673550">buf</span>&nbsp;<span class="ident" id="6673554"><a href="/archive/zip/writer_test.go.html#6672107">bytes</a></span><span class="op" id="6673559">.</span><span class="ident" id="6673560">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673568">w</span>&nbsp;<span class="op" id="6673570">:=</span>&nbsp;<span class="ident" id="6673573"><a href="/archive/zip/writer.go.html#6411718">NewWriter</a></span><span class="op" id="6673582">(</span><span class="keyword" id="6673583">struct</span><span class="op" id="6673589">{</span>&nbsp;<span class="ident" id="6673591"><a href="/archive/zip/writer_test.go.html#6672116">io</a></span><span class="op" id="6673593">.</span><span class="ident" id="6673594">Writer</span>&nbsp;<span class="op" id="6673601">}</span><span class="op" id="6673602">{</span><span class="op" id="6673603">&amp;</span><span class="ident" id="6673604"><a href="/archive/zip/writer_test.go.html#6673550">buf</a></span><span class="op" id="6673607">}</span><span class="op" id="6673608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673611">_</span><span class="op" id="6673612">,</span>&nbsp;<span class="ident" id="6673614">err</span>&nbsp;<span class="op" id="6673618">:=</span>&nbsp;<span class="ident" id="6673621"><a href="/archive/zip/writer_test.go.html#6673568">w</a></span><span class="op" id="6673622">.</span><span class="ident" id="6673623">Create</span><span class="op" id="6673629">(</span><span class="string" id="6673630">&#34;foo&#34;</span><span class="op" id="6673635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673638">if</span>&nbsp;<span class="ident" id="6673641"><a href="/archive/zip/writer_test.go.html#6673614">err</a></span>&nbsp;<span class="op" id="6673645">!=</span>&nbsp;<span class="ident" id="6673648">nil</span>&nbsp;<span class="op" id="6673652">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673656"><a href="/archive/zip/writer_test.go.html#6673529">t</a></span><span class="op" id="6673657">.</span><span class="ident" id="6673658">Fatal</span><span class="op" id="6673663">(</span><span class="ident" id="6673664"><a href="/archive/zip/writer_test.go.html#6673614">err</a></span><span class="op" id="6673667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673673">if</span>&nbsp;<span class="ident" id="6673676"><a href="/archive/zip/writer_test.go.html#6673550">buf</a></span><span class="op" id="6673679">.</span><span class="ident" id="6673680">Len</span><span class="op" id="6673683">(</span><span class="op" id="6673684">)</span>&nbsp;<span class="op" id="6673686">&gt;</span>&nbsp;<span class="num" id="6673688">0</span>&nbsp;<span class="op" id="6673690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673694"><a href="/archive/zip/writer_test.go.html#6673529">t</a></span><span class="op" id="6673695">.</span><span class="ident" id="6673696">Fatalf</span><span class="op" id="6673702">(</span><span class="string" id="6673703">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="6673742">,</span>&nbsp;<span class="ident" id="6673744"><a href="/archive/zip/writer_test.go.html#6673550">buf</a></span><span class="op" id="6673747">.</span><span class="ident" id="6673748">Len</span><span class="op" id="6673751">(</span><span class="op" id="6673752">)</span><span class="op" id="6673753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673756">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673759">if</span>&nbsp;<span class="ident" id="6673762">err</span>&nbsp;<span class="op" id="6673766">:=</span>&nbsp;<span class="ident" id="6673769"><a href="/archive/zip/writer_test.go.html#6673568">w</a></span><span class="op" id="6673770">.</span><span class="ident" id="6673771">Flush</span><span class="op" id="6673776">(</span><span class="op" id="6673777">)</span><span class="op" id="6673778">;</span>&nbsp;<span class="ident" id="6673780"><a href="/archive/zip/writer_test.go.html#6673762">err</a></span>&nbsp;<span class="op" id="6673784">!=</span>&nbsp;<span class="ident" id="6673787">nil</span>&nbsp;<span class="op" id="6673791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673795"><a href="/archive/zip/writer_test.go.html#6673529">t</a></span><span class="op" id="6673796">.</span><span class="ident" id="6673797">Fatal</span><span class="op" id="6673802">(</span><span class="ident" id="6673803"><a href="/archive/zip/writer_test.go.html#6673762">err</a></span><span class="op" id="6673806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673812">if</span>&nbsp;<span class="ident" id="6673815"><a href="/archive/zip/writer_test.go.html#6673550">buf</a></span><span class="op" id="6673818">.</span><span class="ident" id="6673819">Len</span><span class="op" id="6673822">(</span><span class="op" id="6673823">)</span>&nbsp;<span class="op" id="6673825">==</span>&nbsp;<span class="num" id="6673828">0</span>&nbsp;<span class="op" id="6673830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673834"><a href="/archive/zip/writer_test.go.html#6673529">t</a></span><span class="op" id="6673835">.</span><span class="ident" id="6673836">Fatal</span><span class="op" id="6673841">(</span><span class="string" id="6673842">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="6673872">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673875">}</span><br>
<span class="lineno"></span><span class="op" id="6673877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6673880">func</span>&nbsp;<span class="ident" id="6673885">testCreate</span><span class="op" id="6673895">(</span><span class="ident" id="6673896">t</span>&nbsp;<span class="op" id="6673898">*</span><span class="ident" id="6673899"><a href="/archive/zip/writer_test.go.html#6672154">testing</a></span><span class="op" id="6673906">.</span><span class="ident" id="6673907">T</span><span class="op" id="6673908">,</span>&nbsp;<span class="ident" id="6673910">w</span>&nbsp;<span class="op" id="6673912">*</span><span class="ident" id="6673913"><a href="/archive/zip/writer.go.html#6411511">Writer</a></span><span class="op" id="6673919">,</span>&nbsp;<span class="ident" id="6673921">wt</span>&nbsp;<span class="op" id="6673924">*</span><span class="ident" id="6673925"><a href="/archive/zip/writer_test.go.html#6672219">WriteTest</a></span><span class="op" id="6673934">)</span>&nbsp;<span class="op" id="6673936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673939">header</span>&nbsp;<span class="op" id="6673946">:=</span>&nbsp;<span class="op" id="6673949">&amp;</span><span class="ident" id="6673950"><a href="/archive/zip/struct.go.html#6404695">FileHeader</a></span><span class="op" id="6673960">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673964">Name</span><span class="op" id="6673968">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6673972"><a href="/archive/zip/writer_test.go.html#6673921">wt</a></span><span class="op" id="6673974">.</span><span class="ident" id="6673975">Name</span><span class="op" id="6673979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673983">Method</span><span class="op" id="6673989">:</span>&nbsp;<span class="ident" id="6673991"><a href="/archive/zip/writer_test.go.html#6673921">wt</a></span><span class="op" id="6673993">.</span><span class="ident" id="6673994">Method</span><span class="op" id="6674000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674006">if</span>&nbsp;<span class="ident" id="6674009"><a href="/archive/zip/writer_test.go.html#6673921">wt</a></span><span class="op" id="6674011">.</span><span class="ident" id="6674012">Mode</span>&nbsp;<span class="op" id="6674017">!=</span>&nbsp;<span class="num" id="6674020">0</span>&nbsp;<span class="op" id="6674022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674026"><a href="/archive/zip/writer_test.go.html#6673939">header</a></span><span class="op" id="6674032">.</span><span class="ident" id="6674033">SetMode</span><span class="op" id="6674040">(</span><span class="ident" id="6674041"><a href="/archive/zip/writer_test.go.html#6673921">wt</a></span><span class="op" id="6674043">.</span><span class="ident" id="6674044">Mode</span><span class="op" id="6674048">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674054">f</span><span class="op" id="6674055">,</span>&nbsp;<span class="ident" id="6674057">err</span>&nbsp;<span class="op" id="6674061">:=</span>&nbsp;<span class="ident" id="6674064"><a href="/archive/zip/writer_test.go.html#6673910">w</a></span><span class="op" id="6674065">.</span><span class="ident" id="6674066">CreateHeader</span><span class="op" id="6674078">(</span><span class="ident" id="6674079"><a href="/archive/zip/writer_test.go.html#6673939">header</a></span><span class="op" id="6674085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674088">if</span>&nbsp;<span class="ident" id="6674091"><a href="/archive/zip/writer_test.go.html#6674057">err</a></span>&nbsp;<span class="op" id="6674095">!=</span>&nbsp;<span class="ident" id="6674098">nil</span>&nbsp;<span class="op" id="6674102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674106"><a href="/archive/zip/writer_test.go.html#6673896">t</a></span><span class="op" id="6674107">.</span><span class="ident" id="6674108">Fatal</span><span class="op" id="6674113">(</span><span class="ident" id="6674114"><a href="/archive/zip/writer_test.go.html#6674057">err</a></span><span class="op" id="6674117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674120">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674123">_</span><span class="op" id="6674124">,</span>&nbsp;<span class="ident" id="6674126"><a href="/archive/zip/writer_test.go.html#6674057">err</a></span>&nbsp;<span class="op" id="6674130">=</span>&nbsp;<span class="ident" id="6674132"><a href="/archive/zip/writer_test.go.html#6674054">f</a></span><span class="op" id="6674133">.</span><span class="ident" id="6674134">Write</span><span class="op" id="6674139">(</span><span class="ident" id="6674140"><a href="/archive/zip/writer_test.go.html#6673921">wt</a></span><span class="op" id="6674142">.</span><span class="ident" id="6674143">Data</span><span class="op" id="6674147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674150">if</span>&nbsp;<span class="ident" id="6674153"><a href="/archive/zip/writer_test.go.html#6674057">err</a></span>&nbsp;<span class="op" id="6674157">!=</span>&nbsp;<span class="ident" id="6674160">nil</span>&nbsp;<span class="op" id="6674164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674168"><a href="/archive/zip/writer_test.go.html#6673896">t</a></span><span class="op" id="6674169">.</span><span class="ident" id="6674170">Fatal</span><span class="op" id="6674175">(</span><span class="ident" id="6674176"><a href="/archive/zip/writer_test.go.html#6674057">err</a></span><span class="op" id="6674179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674182">}</span><br>
<span class="lineno"></span><span class="op" id="6674184">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="6674187">func</span>&nbsp;<span class="ident" id="6674192">testReadFile</span><span class="op" id="6674204">(</span><span class="ident" id="6674205">t</span>&nbsp;<span class="op" id="6674207">*</span><span class="ident" id="6674208"><a href="/archive/zip/writer_test.go.html#6672154">testing</a></span><span class="op" id="6674215">.</span><span class="ident" id="6674216">T</span><span class="op" id="6674217">,</span>&nbsp;<span class="ident" id="6674219">f</span>&nbsp;<span class="op" id="6674221">*</span><span class="ident" id="6674222"><a href="/archive/zip/reader.go.html#6388142">File</a></span><span class="op" id="6674226">,</span>&nbsp;<span class="ident" id="6674228">wt</span>&nbsp;<span class="op" id="6674231">*</span><span class="ident" id="6674232"><a href="/archive/zip/writer_test.go.html#6672219">WriteTest</a></span><span class="op" id="6674241">)</span>&nbsp;<span class="op" id="6674243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674246">if</span>&nbsp;<span class="ident" id="6674249"><a href="/archive/zip/writer_test.go.html#6674219">f</a></span><span class="op" id="6674250">.</span><span class="ident" id="6674251">Name</span>&nbsp;<span class="op" id="6674256">!=</span>&nbsp;<span class="ident" id="6674259"><a href="/archive/zip/writer_test.go.html#6674228">wt</a></span><span class="op" id="6674261">.</span><span class="ident" id="6674262">Name</span>&nbsp;<span class="op" id="6674267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674271"><a href="/archive/zip/writer_test.go.html#6674205">t</a></span><span class="op" id="6674272">.</span><span class="ident" id="6674273">Fatalf</span><span class="op" id="6674279">(</span><span class="string" id="6674280">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6674308">,</span>&nbsp;<span class="ident" id="6674310"><a href="/archive/zip/writer_test.go.html#6674219">f</a></span><span class="op" id="6674311">.</span><span class="ident" id="6674312">Name</span><span class="op" id="6674316">,</span>&nbsp;<span class="ident" id="6674318"><a href="/archive/zip/writer_test.go.html#6674228">wt</a></span><span class="op" id="6674320">.</span><span class="ident" id="6674321">Name</span><span class="op" id="6674325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674328">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674331"><a href="/archive/zip/reader_test.go.html#6666089">testFileMode</a></span><span class="op" id="6674343">(</span><span class="ident" id="6674344"><a href="/archive/zip/writer_test.go.html#6674205">t</a></span><span class="op" id="6674345">,</span>&nbsp;<span class="ident" id="6674347"><a href="/archive/zip/writer_test.go.html#6674228">wt</a></span><span class="op" id="6674349">.</span><span class="ident" id="6674350">Name</span><span class="op" id="6674354">,</span>&nbsp;<span class="ident" id="6674356"><a href="/archive/zip/writer_test.go.html#6674219">f</a></span><span class="op" id="6674357">,</span>&nbsp;<span class="ident" id="6674359"><a href="/archive/zip/writer_test.go.html#6674228">wt</a></span><span class="op" id="6674361">.</span><span class="ident" id="6674362">Mode</span><span class="op" id="6674366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674369">rc</span><span class="op" id="6674371">,</span>&nbsp;<span class="ident" id="6674373">err</span>&nbsp;<span class="op" id="6674377">:=</span>&nbsp;<span class="ident" id="6674380"><a href="/archive/zip/writer_test.go.html#6674219">f</a></span><span class="op" id="6674381">.</span><span class="ident" id="6674382">Open</span><span class="op" id="6674386">(</span><span class="op" id="6674387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674390">if</span>&nbsp;<span class="ident" id="6674393"><a href="/archive/zip/writer_test.go.html#6674373">err</a></span>&nbsp;<span class="op" id="6674397">!=</span>&nbsp;<span class="ident" id="6674400">nil</span>&nbsp;<span class="op" id="6674404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674408"><a href="/archive/zip/writer_test.go.html#6674205">t</a></span><span class="op" id="6674409">.</span><span class="ident" id="6674410">Fatal</span><span class="op" id="6674415">(</span><span class="string" id="6674416">&#34;opening:&#34;</span><span class="op" id="6674426">,</span>&nbsp;<span class="ident" id="6674428"><a href="/archive/zip/writer_test.go.html#6674373">err</a></span><span class="op" id="6674431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674434">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674437">b</span><span class="op" id="6674438">,</span>&nbsp;<span class="ident" id="6674440"><a href="/archive/zip/writer_test.go.html#6674373">err</a></span>&nbsp;<span class="op" id="6674444">:=</span>&nbsp;<span class="ident" id="6674447"><a href="/archive/zip/writer_test.go.html#6672122">ioutil</a></span><span class="op" id="6674453">.</span><span class="ident" id="6674454">ReadAll</span><span class="op" id="6674461">(</span><span class="ident" id="6674462"><a href="/archive/zip/writer_test.go.html#6674369">rc</a></span><span class="op" id="6674464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674467">if</span>&nbsp;<span class="ident" id="6674470"><a href="/archive/zip/writer_test.go.html#6674373">err</a></span>&nbsp;<span class="op" id="6674474">!=</span>&nbsp;<span class="ident" id="6674477">nil</span>&nbsp;<span class="op" id="6674481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674485"><a href="/archive/zip/writer_test.go.html#6674205">t</a></span><span class="op" id="6674486">.</span><span class="ident" id="6674487">Fatal</span><span class="op" id="6674492">(</span><span class="string" id="6674493">&#34;reading:&#34;</span><span class="op" id="6674503">,</span>&nbsp;<span class="ident" id="6674505"><a href="/archive/zip/writer_test.go.html#6674373">err</a></span><span class="op" id="6674508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674514"><a href="/archive/zip/writer_test.go.html#6674373">err</a></span>&nbsp;<span class="op" id="6674518">=</span>&nbsp;<span class="ident" id="6674520"><a href="/archive/zip/writer_test.go.html#6674369">rc</a></span><span class="op" id="6674522">.</span><span class="ident" id="6674523">Close</span><span class="op" id="6674528">(</span><span class="op" id="6674529">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674532">if</span>&nbsp;<span class="ident" id="6674535"><a href="/archive/zip/writer_test.go.html#6674373">err</a></span>&nbsp;<span class="op" id="6674539">!=</span>&nbsp;<span class="ident" id="6674542">nil</span>&nbsp;<span class="op" id="6674546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674550"><a href="/archive/zip/writer_test.go.html#6674205">t</a></span><span class="op" id="6674551">.</span><span class="ident" id="6674552">Fatal</span><span class="op" id="6674557">(</span><span class="string" id="6674558">&#34;closing:&#34;</span><span class="op" id="6674568">,</span>&nbsp;<span class="ident" id="6674570"><a href="/archive/zip/writer_test.go.html#6674373">err</a></span><span class="op" id="6674573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674579">if</span>&nbsp;<span class="op" id="6674582">!</span><span class="ident" id="6674583"><a href="/archive/zip/writer_test.go.html#6672107">bytes</a></span><span class="op" id="6674588">.</span><span class="ident" id="6674589">Equal</span><span class="op" id="6674594">(</span><span class="ident" id="6674595"><a href="/archive/zip/writer_test.go.html#6674437">b</a></span><span class="op" id="6674596">,</span>&nbsp;<span class="ident" id="6674598"><a href="/archive/zip/writer_test.go.html#6674228">wt</a></span><span class="op" id="6674600">.</span><span class="ident" id="6674601">Data</span><span class="op" id="6674605">)</span>&nbsp;<span class="op" id="6674607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674611"><a href="/archive/zip/writer_test.go.html#6674205">t</a></span><span class="op" id="6674612">.</span><span class="ident" id="6674613">Errorf</span><span class="op" id="6674619">(</span><span class="string" id="6674620">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6674647">,</span>&nbsp;<span class="ident" id="6674649"><a href="/archive/zip/writer_test.go.html#6674437">b</a></span><span class="op" id="6674650">,</span>&nbsp;<span class="ident" id="6674652"><a href="/archive/zip/writer_test.go.html#6674228">wt</a></span><span class="op" id="6674654">.</span><span class="ident" id="6674655">Data</span><span class="op" id="6674659">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674662">}</span><br>
<span class="lineno"></span><span class="op" id="6674664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6674667">func</span>&nbsp;<span class="ident" id="6674672">BenchmarkCompressedZipGarbage</span><span class="op" id="6674701">(</span><span class="ident" id="6674702">b</span>&nbsp;<span class="op" id="6674704">*</span><span class="ident" id="6674705"><a href="/archive/zip/writer_test.go.html#6672154">testing</a></span><span class="op" id="6674712">.</span><span class="ident" id="6674713">B</span><span class="op" id="6674714">)</span>&nbsp;<span class="op" id="6674716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674719"><a href="/archive/zip/writer_test.go.html#6674702">b</a></span><span class="op" id="6674720">.</span><span class="ident" id="6674721">ReportAllocs</span><span class="op" id="6674733">(</span><span class="op" id="6674734">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674737">var</span>&nbsp;<span class="ident" id="6674741">buf</span>&nbsp;<span class="ident" id="6674745"><a href="/archive/zip/writer_test.go.html#6672107">bytes</a></span><span class="op" id="6674750">.</span><span class="ident" id="6674751">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674759">bigBuf</span>&nbsp;<span class="op" id="6674766">:=</span>&nbsp;<span class="ident" id="6674769"><a href="/archive/zip/writer_test.go.html#6672107">bytes</a></span><span class="op" id="6674774">.</span><span class="ident" id="6674775">Repeat</span><span class="op" id="6674781">(</span><span class="op" id="6674782">[</span><span class="op" id="6674783">]</span><span class="builtintype" id="6674784">byte</span><span class="op" id="6674788">(</span><span class="string" id="6674789">&#34;a&#34;</span><span class="op" id="6674792">)</span><span class="op" id="6674793">,</span>&nbsp;<span class="num" id="6674795">1</span><span class="op" id="6674796">&lt;&lt;</span><span class="num" id="6674798">20</span><span class="op" id="6674800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674803">for</span>&nbsp;<span class="ident" id="6674807">i</span>&nbsp;<span class="op" id="6674809">:=</span>&nbsp;<span class="num" id="6674812">0</span><span class="op" id="6674813">;</span>&nbsp;<span class="ident" id="6674815"><a href="/archive/zip/writer_test.go.html#6674807">i</a></span>&nbsp;<span class="op" id="6674817">&lt;</span>&nbsp;<span class="ident" id="6674819"><a href="/archive/zip/writer_test.go.html#6674702">b</a></span><span class="op" id="6674820">.</span><span class="ident" id="6674821">N</span><span class="op" id="6674822">;</span>&nbsp;<span class="ident" id="6674824"><a href="/archive/zip/writer_test.go.html#6674807">i</a></span><span class="op" id="6674825">++</span>&nbsp;<span class="op" id="6674828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674832"><a href="/archive/zip/writer_test.go.html#6674741">buf</a></span><span class="op" id="6674835">.</span><span class="ident" id="6674836">Reset</span><span class="op" id="6674841">(</span><span class="op" id="6674842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674846">zw</span>&nbsp;<span class="op" id="6674849">:=</span>&nbsp;<span class="ident" id="6674852"><a href="/archive/zip/writer.go.html#6411718">NewWriter</a></span><span class="op" id="6674861">(</span><span class="op" id="6674862">&amp;</span><span class="ident" id="6674863"><a href="/archive/zip/writer_test.go.html#6674741">buf</a></span><span class="op" id="6674866">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674870">for</span>&nbsp;<span class="ident" id="6674874">j</span>&nbsp;<span class="op" id="6674876">:=</span>&nbsp;<span class="num" id="6674879">0</span><span class="op" id="6674880">;</span>&nbsp;<span class="ident" id="6674882"><a href="/archive/zip/writer_test.go.html#6674874">j</a></span>&nbsp;<span class="op" id="6674884">&lt;</span>&nbsp;<span class="num" id="6674886">3</span><span class="op" id="6674887">;</span>&nbsp;<span class="ident" id="6674889"><a href="/archive/zip/writer_test.go.html#6674874">j</a></span><span class="op" id="6674890">++</span>&nbsp;<span class="op" id="6674893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674898">w</span><span class="op" id="6674899">,</span>&nbsp;<span class="ident" id="6674901">_</span>&nbsp;<span class="op" id="6674903">:=</span>&nbsp;<span class="ident" id="6674906"><a href="/archive/zip/writer_test.go.html#6674846">zw</a></span><span class="op" id="6674908">.</span><span class="ident" id="6674909">CreateHeader</span><span class="op" id="6674921">(</span><span class="op" id="6674922">&amp;</span><span class="ident" id="6674923"><a href="/archive/zip/struct.go.html#6404695">FileHeader</a></span><span class="op" id="6674933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674939">Name</span><span class="op" id="6674943">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6674947">&#34;foo&#34;</span><span class="op" id="6674952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674958">Method</span><span class="op" id="6674964">:</span>&nbsp;<span class="ident" id="6674966"><a href="/archive/zip/struct.go.html#6403410">Deflate</a></span><span class="op" id="6674973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674978">}</span><span class="op" id="6674979">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674984"><a href="/archive/zip/writer_test.go.html#6674898">w</a></span><span class="op" id="6674985">.</span><span class="ident" id="6674986">Write</span><span class="op" id="6674991">(</span><span class="ident" id="6674992"><a href="/archive/zip/writer_test.go.html#6674759">bigBuf</a></span><span class="op" id="6674998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675006"><a href="/archive/zip/writer_test.go.html#6674846">zw</a></span><span class="op" id="6675008">.</span><span class="ident" id="6675009">Close</span><span class="op" id="6675014">(</span><span class="op" id="6675015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675018">}</span><br>
<span class="lineno"></span><span class="op" id="6675020">}</span>
</div>
</body>
</html>
