<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>path</h2>
<ul>
<li><a href="/gostd/path/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/path/match.go.html" class="current">match.go</a></li>
<li><a href="/gostd/path/match_test.go.html">match_test.go</a></li>
<li><a href="/gostd/path/path.go.html">path.go</a></li>
<li><a href="/gostd/path/path_test.go.html">path_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3839859">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3839914">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3839968">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3840019">package</span>&nbsp;<span class="ident" id="3840027">path</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3840033">import</span>&nbsp;<span class="op" id="3840040">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3840043">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3840053">&#34;strings&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3840064">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3840079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3840082">//&nbsp;ErrBadPattern&nbsp;indicates&nbsp;a&nbsp;globbing&nbsp;pattern&nbsp;was&nbsp;malformed.</span><br>
<span class="lineno"></span><span class="keyword" id="3840143">var</span>&nbsp;<span class="ident" id="3840147">ErrBadPattern</span>&nbsp;<span class="op" id="3840161">=</span>&nbsp;<span class="ident" id="3840163">errors</span><span class="op" id="3840169">.</span><span class="ident" id="3840170">New</span><span class="op" id="3840173">(</span><span class="string" id="3840174">&#34;syntax&nbsp;error&nbsp;in&nbsp;pattern&#34;</span><span class="op" id="3840199">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3840202">//&nbsp;Match&nbsp;returns&nbsp;true&nbsp;if&nbsp;name&nbsp;matches&nbsp;the&nbsp;shell&nbsp;file&nbsp;name&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="comment" id="3840269">//&nbsp;The&nbsp;pattern&nbsp;syntax&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="3840295">//</span><br>
<span class="lineno"></span><span class="comment" id="3840298">//&nbsp;&nbsp;&nbsp;&nbsp;pattern:</span><br>
<span class="lineno">20</span><span class="comment" id="3840310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;term&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3840323">//&nbsp;&nbsp;&nbsp;&nbsp;term:</span><br>
<span class="lineno"></span><span class="comment" id="3840332">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;*&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;any&nbsp;sequence&nbsp;of&nbsp;non-/&nbsp;characters</span><br>
<span class="lineno"></span><span class="comment" id="3840389">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;?&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;any&nbsp;single&nbsp;non-/&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="3840440">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;[&#39;&nbsp;[&nbsp;&#39;^&#39;&nbsp;]&nbsp;{&nbsp;character-range&nbsp;}&nbsp;&#39;]&#39;</span><br>
<span class="lineno">25</span><span class="comment" id="3840480">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character&nbsp;class&nbsp;(must&nbsp;be&nbsp;non-empty)</span><br>
<span class="lineno"></span><span class="comment" id="3840532">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c&nbsp;(c&nbsp;!=&nbsp;&#39;*&#39;,&nbsp;&#39;?&#39;,&nbsp;&#39;\\&#39;,&nbsp;&#39;[&#39;)</span><br>
<span class="lineno"></span><span class="comment" id="3840595">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;\\&#39;&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c</span><br>
<span class="lineno"></span><span class="comment" id="3840631">//</span><br>
<span class="lineno"></span><span class="comment" id="3840634">//&nbsp;&nbsp;&nbsp;&nbsp;character-range:</span><br>
<span class="lineno">30</span><span class="comment" id="3840654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c&nbsp;(c&nbsp;!=&nbsp;&#39;\\&#39;,&nbsp;&#39;-&#39;,&nbsp;&#39;]&#39;)</span><br>
<span class="lineno"></span><span class="comment" id="3840712">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;\\&#39;&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c</span><br>
<span class="lineno"></span><span class="comment" id="3840748">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo&nbsp;&#39;-&#39;&nbsp;hi&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c&nbsp;for&nbsp;lo&nbsp;&lt;=&nbsp;c&nbsp;&lt;=&nbsp;hi</span><br>
<span class="lineno"></span><span class="comment" id="3840802">//</span><br>
<span class="lineno"></span><span class="comment" id="3840805">//&nbsp;Match&nbsp;requires&nbsp;pattern&nbsp;to&nbsp;match&nbsp;all&nbsp;of&nbsp;name,&nbsp;not&nbsp;just&nbsp;a&nbsp;substring.</span><br>
<span class="lineno">35</span><span class="comment" id="3840875">//&nbsp;The&nbsp;only&nbsp;possible&nbsp;returned&nbsp;error&nbsp;is&nbsp;ErrBadPattern,&nbsp;when&nbsp;pattern</span><br>
<span class="lineno"></span><span class="comment" id="3840942">//&nbsp;is&nbsp;malformed.</span><br>
<span class="lineno"></span><span class="comment" id="3840959">//</span><br>
<span class="lineno"></span><span class="keyword" id="3840962">func</span>&nbsp;<span class="ident" id="3840967">Match</span><span class="op" id="3840972">(</span><span class="ident" id="3840973">pattern</span><span class="op" id="3840980">,</span>&nbsp;<span class="ident" id="3840982">name</span>&nbsp;<span class="builtintype" id="3840987">string</span><span class="op" id="3840993">)</span>&nbsp;<span class="op" id="3840995">(</span><span class="ident" id="3840996">matched</span>&nbsp;<span class="builtintype" id="3841004">bool</span><span class="op" id="3841008">,</span>&nbsp;<span class="ident" id="3841010">err</span>&nbsp;<span class="builtintype" id="3841014">error</span><span class="op" id="3841019">)</span>&nbsp;<span class="op" id="3841021">{</span><br>
<span class="lineno"></span><span class="ident" id="3841023">Pattern</span><span class="op" id="3841030">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841033">for</span>&nbsp;<span class="builtinfunc" id="3841037">len</span><span class="op" id="3841040">(</span><span class="ident" id="3841041">pattern</span><span class="op" id="3841048">)</span>&nbsp;<span class="op" id="3841050">&gt;</span>&nbsp;<span class="num" id="3841052">0</span>&nbsp;<span class="op" id="3841054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841058">var</span>&nbsp;<span class="ident" id="3841062">star</span>&nbsp;<span class="builtintype" id="3841067">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841074">var</span>&nbsp;<span class="ident" id="3841078">chunk</span>&nbsp;<span class="builtintype" id="3841084">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3841093">star</span><span class="op" id="3841097">,</span>&nbsp;<span class="ident" id="3841099">chunk</span><span class="op" id="3841104">,</span>&nbsp;<span class="ident" id="3841106">pattern</span>&nbsp;<span class="op" id="3841114">=</span>&nbsp;<span class="ident" id="3841116">scanChunk</span><span class="op" id="3841125">(</span><span class="ident" id="3841126">pattern</span><span class="op" id="3841133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841137">if</span>&nbsp;<span class="ident" id="3841140">star</span>&nbsp;<span class="op" id="3841145">&amp;&amp;</span>&nbsp;<span class="ident" id="3841148">chunk</span>&nbsp;<span class="op" id="3841154">==</span>&nbsp;<span class="string" id="3841157">&#34;&#34;</span>&nbsp;<span class="op" id="3841160">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3841165">//&nbsp;Trailing&nbsp;*&nbsp;matches&nbsp;rest&nbsp;of&nbsp;string&nbsp;unless&nbsp;it&nbsp;has&nbsp;a&nbsp;/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841224">return</span>&nbsp;<span class="ident" id="3841231">strings</span><span class="op" id="3841238">.</span><span class="ident" id="3841239">Index</span><span class="op" id="3841244">(</span><span class="ident" id="3841245">name</span><span class="op" id="3841249">,</span>&nbsp;<span class="string" id="3841251">&#34;/&#34;</span><span class="op" id="3841254">)</span>&nbsp;<span class="op" id="3841256">&lt;</span>&nbsp;<span class="num" id="3841258">0</span><span class="op" id="3841259">,</span>&nbsp;<span class="ident" id="3841261">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3841271">//&nbsp;Look&nbsp;for&nbsp;match&nbsp;at&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3841312">t</span><span class="op" id="3841313">,</span>&nbsp;<span class="ident" id="3841315">ok</span><span class="op" id="3841317">,</span>&nbsp;<span class="ident" id="3841319">err</span>&nbsp;<span class="op" id="3841323">:=</span>&nbsp;<span class="ident" id="3841326">matchChunk</span><span class="op" id="3841336">(</span><span class="ident" id="3841337">chunk</span><span class="op" id="3841342">,</span>&nbsp;<span class="ident" id="3841344">name</span><span class="op" id="3841348">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3841352">//&nbsp;if&nbsp;we&#39;re&nbsp;the&nbsp;last&nbsp;chunk,&nbsp;make&nbsp;sure&nbsp;we&#39;ve&nbsp;exhausted&nbsp;the&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3841417">//&nbsp;otherwise&nbsp;we&#39;ll&nbsp;give&nbsp;a&nbsp;false&nbsp;result&nbsp;even&nbsp;if&nbsp;we&nbsp;could&nbsp;still&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3841487">//&nbsp;using&nbsp;the&nbsp;star</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841507">if</span>&nbsp;<span class="ident" id="3841510">ok</span>&nbsp;<span class="op" id="3841513">&amp;&amp;</span>&nbsp;<span class="op" id="3841516">(</span><span class="builtinfunc" id="3841517">len</span><span class="op" id="3841520">(</span><span class="ident" id="3841521">t</span><span class="op" id="3841522">)</span>&nbsp;<span class="op" id="3841524">==</span>&nbsp;<span class="num" id="3841527">0</span>&nbsp;<span class="op" id="3841529">||</span>&nbsp;<span class="builtinfunc" id="3841532">len</span><span class="op" id="3841535">(</span><span class="ident" id="3841536">pattern</span><span class="op" id="3841543">)</span>&nbsp;<span class="op" id="3841545">&gt;</span>&nbsp;<span class="num" id="3841547">0</span><span class="op" id="3841548">)</span>&nbsp;<span class="op" id="3841550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3841555">name</span>&nbsp;<span class="op" id="3841560">=</span>&nbsp;<span class="ident" id="3841562">t</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841567">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841582">if</span>&nbsp;<span class="ident" id="3841585">err</span>&nbsp;<span class="op" id="3841589">!=</span>&nbsp;<span class="ident" id="3841592">nil</span>&nbsp;<span class="op" id="3841596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841601">return</span>&nbsp;<span class="builtintype" id="3841608">false</span><span class="op" id="3841613">,</span>&nbsp;<span class="ident" id="3841615">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841621">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841625">if</span>&nbsp;<span class="ident" id="3841628">star</span>&nbsp;<span class="op" id="3841633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3841638">//&nbsp;Look&nbsp;for&nbsp;match&nbsp;skipping&nbsp;i+1&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3841679">//&nbsp;Cannot&nbsp;skip&nbsp;/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841700">for</span>&nbsp;<span class="ident" id="3841704">i</span>&nbsp;<span class="op" id="3841706">:=</span>&nbsp;<span class="num" id="3841709">0</span><span class="op" id="3841710">;</span>&nbsp;<span class="ident" id="3841712">i</span>&nbsp;<span class="op" id="3841714">&lt;</span>&nbsp;<span class="builtinfunc" id="3841716">len</span><span class="op" id="3841719">(</span><span class="ident" id="3841720">name</span><span class="op" id="3841724">)</span>&nbsp;<span class="op" id="3841726">&amp;&amp;</span>&nbsp;<span class="ident" id="3841729">name</span><span class="op" id="3841733">[</span><span class="ident" id="3841734">i</span><span class="op" id="3841735">]</span>&nbsp;<span class="op" id="3841737">!=</span>&nbsp;<span class="string" id="3841740">&#39;/&#39;</span><span class="op" id="3841743">;</span>&nbsp;<span class="ident" id="3841745">i</span><span class="op" id="3841746">++</span>&nbsp;<span class="op" id="3841749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3841755">t</span><span class="op" id="3841756">,</span>&nbsp;<span class="ident" id="3841758">ok</span><span class="op" id="3841760">,</span>&nbsp;<span class="ident" id="3841762">err</span>&nbsp;<span class="op" id="3841766">:=</span>&nbsp;<span class="ident" id="3841769">matchChunk</span><span class="op" id="3841779">(</span><span class="ident" id="3841780">chunk</span><span class="op" id="3841785">,</span>&nbsp;<span class="ident" id="3841787">name</span><span class="op" id="3841791">[</span><span class="ident" id="3841792">i</span><span class="op" id="3841793">+</span><span class="num" id="3841794">1</span><span class="op" id="3841795">:</span><span class="op" id="3841796">]</span><span class="op" id="3841797">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841803">if</span>&nbsp;<span class="ident" id="3841806">ok</span>&nbsp;<span class="op" id="3841809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3841816">//&nbsp;if&nbsp;we&#39;re&nbsp;the&nbsp;last&nbsp;chunk,&nbsp;make&nbsp;sure&nbsp;we&nbsp;exhausted&nbsp;the&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841881">if</span>&nbsp;<span class="builtinfunc" id="3841884">len</span><span class="op" id="3841887">(</span><span class="ident" id="3841888">pattern</span><span class="op" id="3841895">)</span>&nbsp;<span class="op" id="3841897">==</span>&nbsp;<span class="num" id="3841900">0</span>&nbsp;<span class="op" id="3841902">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3841905">len</span><span class="op" id="3841908">(</span><span class="ident" id="3841909">t</span><span class="op" id="3841910">)</span>&nbsp;<span class="op" id="3841912">&gt;</span>&nbsp;<span class="num" id="3841914">0</span>&nbsp;<span class="op" id="3841916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841924">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841938">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3841945">name</span>&nbsp;<span class="op" id="3841950">=</span>&nbsp;<span class="ident" id="3841952">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841959">continue</span>&nbsp;<span class="ident" id="3841968">Pattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3841986">if</span>&nbsp;<span class="ident" id="3841989">err</span>&nbsp;<span class="op" id="3841993">!=</span>&nbsp;<span class="ident" id="3841996">nil</span>&nbsp;<span class="op" id="3842000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842007">return</span>&nbsp;<span class="builtintype" id="3842014">false</span><span class="op" id="3842019">,</span>&nbsp;<span class="ident" id="3842021">err</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842042">return</span>&nbsp;<span class="builtintype" id="3842049">false</span><span class="op" id="3842054">,</span>&nbsp;<span class="ident" id="3842056">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842061">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842064">return</span>&nbsp;<span class="builtinfunc" id="3842071">len</span><span class="op" id="3842074">(</span><span class="ident" id="3842075">name</span><span class="op" id="3842079">)</span>&nbsp;<span class="op" id="3842081">==</span>&nbsp;<span class="num" id="3842084">0</span><span class="op" id="3842085">,</span>&nbsp;<span class="ident" id="3842087">nil</span><br>
<span class="lineno"></span><span class="op" id="3842091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3842094">//&nbsp;scanChunk&nbsp;gets&nbsp;the&nbsp;next&nbsp;segment&nbsp;of&nbsp;pattern,&nbsp;which&nbsp;is&nbsp;a&nbsp;non-star&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="3842168">//&nbsp;possibly&nbsp;preceded&nbsp;by&nbsp;a&nbsp;star.</span><br>
<span class="lineno">85</span><span class="keyword" id="3842200">func</span>&nbsp;<span class="ident" id="3842205">scanChunk</span><span class="op" id="3842214">(</span><span class="ident" id="3842215">pattern</span>&nbsp;<span class="builtintype" id="3842223">string</span><span class="op" id="3842229">)</span>&nbsp;<span class="op" id="3842231">(</span><span class="ident" id="3842232">star</span>&nbsp;<span class="builtintype" id="3842237">bool</span><span class="op" id="3842241">,</span>&nbsp;<span class="ident" id="3842243">chunk</span><span class="op" id="3842248">,</span>&nbsp;<span class="ident" id="3842250">rest</span>&nbsp;<span class="builtintype" id="3842255">string</span><span class="op" id="3842261">)</span>&nbsp;<span class="op" id="3842263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842266">for</span>&nbsp;<span class="builtinfunc" id="3842270">len</span><span class="op" id="3842273">(</span><span class="ident" id="3842274">pattern</span><span class="op" id="3842281">)</span>&nbsp;<span class="op" id="3842283">&gt;</span>&nbsp;<span class="num" id="3842285">0</span>&nbsp;<span class="op" id="3842287">&amp;&amp;</span>&nbsp;<span class="ident" id="3842290">pattern</span><span class="op" id="3842297">[</span><span class="num" id="3842298">0</span><span class="op" id="3842299">]</span>&nbsp;<span class="op" id="3842301">==</span>&nbsp;<span class="string" id="3842304">&#39;*&#39;</span>&nbsp;<span class="op" id="3842308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3842312">pattern</span>&nbsp;<span class="op" id="3842320">=</span>&nbsp;<span class="ident" id="3842322">pattern</span><span class="op" id="3842329">[</span><span class="num" id="3842330">1</span><span class="op" id="3842331">:</span><span class="op" id="3842332">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3842336">star</span>&nbsp;<span class="op" id="3842341">=</span>&nbsp;<span class="builtintype" id="3842343">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842349">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3842352">inrange</span>&nbsp;<span class="op" id="3842360">:=</span>&nbsp;<span class="builtintype" id="3842363">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842370">var</span>&nbsp;<span class="ident" id="3842374">i</span>&nbsp;<span class="builtintype" id="3842376">int</span><br>
<span class="lineno"></span><span class="ident" id="3842380">Scan</span><span class="op" id="3842384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842387">for</span>&nbsp;<span class="ident" id="3842391">i</span>&nbsp;<span class="op" id="3842393">=</span>&nbsp;<span class="num" id="3842395">0</span><span class="op" id="3842396">;</span>&nbsp;<span class="ident" id="3842398">i</span>&nbsp;<span class="op" id="3842400">&lt;</span>&nbsp;<span class="builtinfunc" id="3842402">len</span><span class="op" id="3842405">(</span><span class="ident" id="3842406">pattern</span><span class="op" id="3842413">)</span><span class="op" id="3842414">;</span>&nbsp;<span class="ident" id="3842416">i</span><span class="op" id="3842417">++</span>&nbsp;<span class="op" id="3842420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842424">switch</span>&nbsp;<span class="ident" id="3842431">pattern</span><span class="op" id="3842438">[</span><span class="ident" id="3842439">i</span><span class="op" id="3842440">]</span>&nbsp;<span class="op" id="3842442">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842446">case</span>&nbsp;<span class="string" id="3842451">&#39;\\&#39;</span><span class="op" id="3842455">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3842460">//&nbsp;error&nbsp;check&nbsp;handled&nbsp;in&nbsp;matchChunk:&nbsp;bad&nbsp;pattern.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842514">if</span>&nbsp;<span class="ident" id="3842517">i</span><span class="op" id="3842518">+</span><span class="num" id="3842519">1</span>&nbsp;<span class="op" id="3842521">&lt;</span>&nbsp;<span class="builtinfunc" id="3842523">len</span><span class="op" id="3842526">(</span><span class="ident" id="3842527">pattern</span><span class="op" id="3842534">)</span>&nbsp;<span class="op" id="3842536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3842542">i</span><span class="op" id="3842543">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842549">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842553">case</span>&nbsp;<span class="string" id="3842558">&#39;[&#39;</span><span class="op" id="3842561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3842566">inrange</span>&nbsp;<span class="op" id="3842574">=</span>&nbsp;<span class="builtintype" id="3842576">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842583">case</span>&nbsp;<span class="string" id="3842588">&#39;]&#39;</span><span class="op" id="3842591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3842596">inrange</span>&nbsp;<span class="op" id="3842604">=</span>&nbsp;<span class="builtintype" id="3842606">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842614">case</span>&nbsp;<span class="string" id="3842619">&#39;*&#39;</span><span class="op" id="3842622">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842627">if</span>&nbsp;<span class="op" id="3842630">!</span><span class="ident" id="3842631">inrange</span>&nbsp;<span class="op" id="3842639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842645">break</span>&nbsp;<span class="ident" id="3842651">Scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842666">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842669">return</span>&nbsp;<span class="ident" id="3842676">star</span><span class="op" id="3842680">,</span>&nbsp;<span class="ident" id="3842682">pattern</span><span class="op" id="3842689">[</span><span class="num" id="3842690">0</span><span class="op" id="3842691">:</span><span class="ident" id="3842692">i</span><span class="op" id="3842693">]</span><span class="op" id="3842694">,</span>&nbsp;<span class="ident" id="3842696">pattern</span><span class="op" id="3842703">[</span><span class="ident" id="3842704">i</span><span class="op" id="3842705">:</span><span class="op" id="3842706">]</span><br>
<span class="lineno"></span><span class="op" id="3842708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3842711">//&nbsp;matchChunk&nbsp;checks&nbsp;whether&nbsp;chunk&nbsp;matches&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="3842774">//&nbsp;If&nbsp;so,&nbsp;it&nbsp;returns&nbsp;the&nbsp;remainder&nbsp;of&nbsp;s&nbsp;(after&nbsp;the&nbsp;match).</span><br>
<span class="lineno">115</span><span class="comment" id="3842833">//&nbsp;Chunk&nbsp;is&nbsp;all&nbsp;single-character&nbsp;operators:&nbsp;literals,&nbsp;char&nbsp;classes,&nbsp;and&nbsp;?.</span><br>
<span class="lineno"></span><span class="keyword" id="3842908">func</span>&nbsp;<span class="ident" id="3842913">matchChunk</span><span class="op" id="3842923">(</span><span class="ident" id="3842924">chunk</span><span class="op" id="3842929">,</span>&nbsp;<span class="ident" id="3842931">s</span>&nbsp;<span class="builtintype" id="3842933">string</span><span class="op" id="3842939">)</span>&nbsp;<span class="op" id="3842941">(</span><span class="ident" id="3842942">rest</span>&nbsp;<span class="builtintype" id="3842947">string</span><span class="op" id="3842953">,</span>&nbsp;<span class="ident" id="3842955">ok</span>&nbsp;<span class="builtintype" id="3842958">bool</span><span class="op" id="3842962">,</span>&nbsp;<span class="ident" id="3842964">err</span>&nbsp;<span class="builtintype" id="3842968">error</span><span class="op" id="3842973">)</span>&nbsp;<span class="op" id="3842975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3842978">for</span>&nbsp;<span class="builtinfunc" id="3842982">len</span><span class="op" id="3842985">(</span><span class="ident" id="3842986">chunk</span><span class="op" id="3842991">)</span>&nbsp;<span class="op" id="3842993">&gt;</span>&nbsp;<span class="num" id="3842995">0</span>&nbsp;<span class="op" id="3842997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843001">if</span>&nbsp;<span class="builtinfunc" id="3843004">len</span><span class="op" id="3843007">(</span><span class="ident" id="3843008">s</span><span class="op" id="3843009">)</span>&nbsp;<span class="op" id="3843011">==</span>&nbsp;<span class="num" id="3843014">0</span>&nbsp;<span class="op" id="3843016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843021">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843034">switch</span>&nbsp;<span class="ident" id="3843041">chunk</span><span class="op" id="3843046">[</span><span class="num" id="3843047">0</span><span class="op" id="3843048">]</span>&nbsp;<span class="op" id="3843050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843054">case</span>&nbsp;<span class="string" id="3843059">&#39;[&#39;</span><span class="op" id="3843062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3843067">//&nbsp;character&nbsp;class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843089">r</span><span class="op" id="3843090">,</span>&nbsp;<span class="ident" id="3843092">n</span>&nbsp;<span class="op" id="3843094">:=</span>&nbsp;<span class="ident" id="3843097">utf8</span><span class="op" id="3843101">.</span><span class="ident" id="3843102">DecodeRuneInString</span><span class="op" id="3843120">(</span><span class="ident" id="3843121">s</span><span class="op" id="3843122">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843127">s</span>&nbsp;<span class="op" id="3843129">=</span>&nbsp;<span class="ident" id="3843131">s</span><span class="op" id="3843132">[</span><span class="ident" id="3843133">n</span><span class="op" id="3843134">:</span><span class="op" id="3843135">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843140">chunk</span>&nbsp;<span class="op" id="3843146">=</span>&nbsp;<span class="ident" id="3843148">chunk</span><span class="op" id="3843153">[</span><span class="num" id="3843154">1</span><span class="op" id="3843155">:</span><span class="op" id="3843156">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3843161">//&nbsp;possibly&nbsp;negated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843184">notNegated</span>&nbsp;<span class="op" id="3843195">:=</span>&nbsp;<span class="builtintype" id="3843198">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843206">if</span>&nbsp;<span class="builtinfunc" id="3843209">len</span><span class="op" id="3843212">(</span><span class="ident" id="3843213">chunk</span><span class="op" id="3843218">)</span>&nbsp;<span class="op" id="3843220">&gt;</span>&nbsp;<span class="num" id="3843222">0</span>&nbsp;<span class="op" id="3843224">&amp;&amp;</span>&nbsp;<span class="ident" id="3843227">chunk</span><span class="op" id="3843232">[</span><span class="num" id="3843233">0</span><span class="op" id="3843234">]</span>&nbsp;<span class="op" id="3843236">==</span>&nbsp;<span class="string" id="3843239">&#39;^&#39;</span>&nbsp;<span class="op" id="3843243">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843249">notNegated</span>&nbsp;<span class="op" id="3843260">=</span>&nbsp;<span class="builtintype" id="3843262">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843272">chunk</span>&nbsp;<span class="op" id="3843278">=</span>&nbsp;<span class="ident" id="3843280">chunk</span><span class="op" id="3843285">[</span><span class="num" id="3843286">1</span><span class="op" id="3843287">:</span><span class="op" id="3843288">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3843298">//&nbsp;parse&nbsp;all&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843321">match</span>&nbsp;<span class="op" id="3843327">:=</span>&nbsp;<span class="builtintype" id="3843330">false</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843339">nrange</span>&nbsp;<span class="op" id="3843346">:=</span>&nbsp;<span class="num" id="3843349">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843354">for</span>&nbsp;<span class="op" id="3843358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843364">if</span>&nbsp;<span class="builtinfunc" id="3843367">len</span><span class="op" id="3843370">(</span><span class="ident" id="3843371">chunk</span><span class="op" id="3843376">)</span>&nbsp;<span class="op" id="3843378">&gt;</span>&nbsp;<span class="num" id="3843380">0</span>&nbsp;<span class="op" id="3843382">&amp;&amp;</span>&nbsp;<span class="ident" id="3843385">chunk</span><span class="op" id="3843390">[</span><span class="num" id="3843391">0</span><span class="op" id="3843392">]</span>&nbsp;<span class="op" id="3843394">==</span>&nbsp;<span class="string" id="3843397">&#39;]&#39;</span>&nbsp;<span class="op" id="3843401">&amp;&amp;</span>&nbsp;<span class="ident" id="3843404">nrange</span>&nbsp;<span class="op" id="3843411">&gt;</span>&nbsp;<span class="num" id="3843413">0</span>&nbsp;<span class="op" id="3843415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843422">chunk</span>&nbsp;<span class="op" id="3843428">=</span>&nbsp;<span class="ident" id="3843430">chunk</span><span class="op" id="3843435">[</span><span class="num" id="3843436">1</span><span class="op" id="3843437">:</span><span class="op" id="3843438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843445">break</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843461">var</span>&nbsp;<span class="ident" id="3843465">lo</span><span class="op" id="3843467">,</span>&nbsp;<span class="ident" id="3843469">hi</span>&nbsp;<span class="builtintype" id="3843472">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843481">if</span>&nbsp;<span class="ident" id="3843484">lo</span><span class="op" id="3843486">,</span>&nbsp;<span class="ident" id="3843488">chunk</span><span class="op" id="3843493">,</span>&nbsp;<span class="ident" id="3843495">err</span>&nbsp;<span class="op" id="3843499">=</span>&nbsp;<span class="ident" id="3843501">getEsc</span><span class="op" id="3843507">(</span><span class="ident" id="3843508">chunk</span><span class="op" id="3843513">)</span><span class="op" id="3843514">;</span>&nbsp;<span class="ident" id="3843516">err</span>&nbsp;<span class="op" id="3843520">!=</span>&nbsp;<span class="ident" id="3843523">nil</span>&nbsp;<span class="op" id="3843527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843534">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843545">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843551">hi</span>&nbsp;<span class="op" id="3843554">=</span>&nbsp;<span class="ident" id="3843556">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843563">if</span>&nbsp;<span class="ident" id="3843566">chunk</span><span class="op" id="3843571">[</span><span class="num" id="3843572">0</span><span class="op" id="3843573">]</span>&nbsp;<span class="op" id="3843575">==</span>&nbsp;<span class="string" id="3843578">&#39;-&#39;</span>&nbsp;<span class="op" id="3843582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843589">if</span>&nbsp;<span class="ident" id="3843592">hi</span><span class="op" id="3843594">,</span>&nbsp;<span class="ident" id="3843596">chunk</span><span class="op" id="3843601">,</span>&nbsp;<span class="ident" id="3843603">err</span>&nbsp;<span class="op" id="3843607">=</span>&nbsp;<span class="ident" id="3843609">getEsc</span><span class="op" id="3843615">(</span><span class="ident" id="3843616">chunk</span><span class="op" id="3843621">[</span><span class="num" id="3843622">1</span><span class="op" id="3843623">:</span><span class="op" id="3843624">]</span><span class="op" id="3843625">)</span><span class="op" id="3843626">;</span>&nbsp;<span class="ident" id="3843628">err</span>&nbsp;<span class="op" id="3843632">!=</span>&nbsp;<span class="ident" id="3843635">nil</span>&nbsp;<span class="op" id="3843639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843647">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843659">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843671">if</span>&nbsp;<span class="ident" id="3843674">lo</span>&nbsp;<span class="op" id="3843677">&lt;=</span>&nbsp;<span class="ident" id="3843680">r</span>&nbsp;<span class="op" id="3843682">&amp;&amp;</span>&nbsp;<span class="ident" id="3843685">r</span>&nbsp;<span class="op" id="3843687">&lt;=</span>&nbsp;<span class="ident" id="3843690">hi</span>&nbsp;<span class="op" id="3843693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843700">match</span>&nbsp;<span class="op" id="3843706">=</span>&nbsp;<span class="builtintype" id="3843708">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843723">nrange</span><span class="op" id="3843729">++</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843740">if</span>&nbsp;<span class="ident" id="3843743">match</span>&nbsp;<span class="op" id="3843749">!=</span>&nbsp;<span class="ident" id="3843752">notNegated</span>&nbsp;<span class="op" id="3843763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843769">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843784">case</span>&nbsp;<span class="string" id="3843789">&#39;?&#39;</span><span class="op" id="3843792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843797">if</span>&nbsp;<span class="ident" id="3843800">s</span><span class="op" id="3843801">[</span><span class="num" id="3843802">0</span><span class="op" id="3843803">]</span>&nbsp;<span class="op" id="3843805">==</span>&nbsp;<span class="string" id="3843808">&#39;/&#39;</span>&nbsp;<span class="op" id="3843812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843818">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843833">_</span><span class="op" id="3843834">,</span>&nbsp;<span class="ident" id="3843836">n</span>&nbsp;<span class="op" id="3843838">:=</span>&nbsp;<span class="ident" id="3843841">utf8</span><span class="op" id="3843845">.</span><span class="ident" id="3843846">DecodeRuneInString</span><span class="op" id="3843864">(</span><span class="ident" id="3843865">s</span><span class="op" id="3843866">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843871">s</span>&nbsp;<span class="op" id="3843873">=</span>&nbsp;<span class="ident" id="3843875">s</span><span class="op" id="3843876">[</span><span class="ident" id="3843877">n</span><span class="op" id="3843878">:</span><span class="op" id="3843879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843884">chunk</span>&nbsp;<span class="op" id="3843890">=</span>&nbsp;<span class="ident" id="3843892">chunk</span><span class="op" id="3843897">[</span><span class="num" id="3843898">1</span><span class="op" id="3843899">:</span><span class="op" id="3843900">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843905">case</span>&nbsp;<span class="string" id="3843910">&#39;\\&#39;</span><span class="op" id="3843914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843919">chunk</span>&nbsp;<span class="op" id="3843925">=</span>&nbsp;<span class="ident" id="3843927">chunk</span><span class="op" id="3843932">[</span><span class="num" id="3843933">1</span><span class="op" id="3843934">:</span><span class="op" id="3843935">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843940">if</span>&nbsp;<span class="builtinfunc" id="3843943">len</span><span class="op" id="3843946">(</span><span class="ident" id="3843947">chunk</span><span class="op" id="3843952">)</span>&nbsp;<span class="op" id="3843954">==</span>&nbsp;<span class="num" id="3843957">0</span>&nbsp;<span class="op" id="3843959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843965">err</span>&nbsp;<span class="op" id="3843969">=</span>&nbsp;<span class="ident" id="3843971">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3843989">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3843999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844004">fallthrough</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844019">default</span><span class="op" id="3844026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844031">if</span>&nbsp;<span class="ident" id="3844034">chunk</span><span class="op" id="3844039">[</span><span class="num" id="3844040">0</span><span class="op" id="3844041">]</span>&nbsp;<span class="op" id="3844043">!=</span>&nbsp;<span class="ident" id="3844046">s</span><span class="op" id="3844047">[</span><span class="num" id="3844048">0</span><span class="op" id="3844049">]</span>&nbsp;<span class="op" id="3844051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844057">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844067">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844072">s</span>&nbsp;<span class="op" id="3844074">=</span>&nbsp;<span class="ident" id="3844076">s</span><span class="op" id="3844077">[</span><span class="num" id="3844078">1</span><span class="op" id="3844079">:</span><span class="op" id="3844080">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844085">chunk</span>&nbsp;<span class="op" id="3844091">=</span>&nbsp;<span class="ident" id="3844093">chunk</span><span class="op" id="3844098">[</span><span class="num" id="3844099">1</span><span class="op" id="3844100">:</span><span class="op" id="3844101">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844111">return</span>&nbsp;<span class="ident" id="3844118">s</span><span class="op" id="3844119">,</span>&nbsp;<span class="builtintype" id="3844121">true</span><span class="op" id="3844125">,</span>&nbsp;<span class="ident" id="3844127">nil</span><br>
<span class="lineno">185</span><span class="op" id="3844131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3844134">//&nbsp;getEsc&nbsp;gets&nbsp;a&nbsp;possibly-escaped&nbsp;character&nbsp;from&nbsp;chunk,&nbsp;for&nbsp;a&nbsp;character&nbsp;class.</span><br>
<span class="lineno"></span><span class="keyword" id="3844213">func</span>&nbsp;<span class="ident" id="3844218">getEsc</span><span class="op" id="3844224">(</span><span class="ident" id="3844225">chunk</span>&nbsp;<span class="builtintype" id="3844231">string</span><span class="op" id="3844237">)</span>&nbsp;<span class="op" id="3844239">(</span><span class="ident" id="3844240">r</span>&nbsp;<span class="builtintype" id="3844242">rune</span><span class="op" id="3844246">,</span>&nbsp;<span class="ident" id="3844248">nchunk</span>&nbsp;<span class="builtintype" id="3844255">string</span><span class="op" id="3844261">,</span>&nbsp;<span class="ident" id="3844263">err</span>&nbsp;<span class="builtintype" id="3844267">error</span><span class="op" id="3844272">)</span>&nbsp;<span class="op" id="3844274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844277">if</span>&nbsp;<span class="builtinfunc" id="3844280">len</span><span class="op" id="3844283">(</span><span class="ident" id="3844284">chunk</span><span class="op" id="3844289">)</span>&nbsp;<span class="op" id="3844291">==</span>&nbsp;<span class="num" id="3844294">0</span>&nbsp;<span class="op" id="3844296">||</span>&nbsp;<span class="ident" id="3844299">chunk</span><span class="op" id="3844304">[</span><span class="num" id="3844305">0</span><span class="op" id="3844306">]</span>&nbsp;<span class="op" id="3844308">==</span>&nbsp;<span class="string" id="3844311">&#39;-&#39;</span>&nbsp;<span class="op" id="3844315">||</span>&nbsp;<span class="ident" id="3844318">chunk</span><span class="op" id="3844323">[</span><span class="num" id="3844324">0</span><span class="op" id="3844325">]</span>&nbsp;<span class="op" id="3844327">==</span>&nbsp;<span class="string" id="3844330">&#39;]&#39;</span>&nbsp;<span class="op" id="3844334">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844338">err</span>&nbsp;<span class="op" id="3844342">=</span>&nbsp;<span class="ident" id="3844344">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844360">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844371">if</span>&nbsp;<span class="ident" id="3844374">chunk</span><span class="op" id="3844379">[</span><span class="num" id="3844380">0</span><span class="op" id="3844381">]</span>&nbsp;<span class="op" id="3844383">==</span>&nbsp;<span class="string" id="3844386">&#39;\\&#39;</span>&nbsp;<span class="op" id="3844391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844395">chunk</span>&nbsp;<span class="op" id="3844401">=</span>&nbsp;<span class="ident" id="3844403">chunk</span><span class="op" id="3844408">[</span><span class="num" id="3844409">1</span><span class="op" id="3844410">:</span><span class="op" id="3844411">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844415">if</span>&nbsp;<span class="builtinfunc" id="3844418">len</span><span class="op" id="3844421">(</span><span class="ident" id="3844422">chunk</span><span class="op" id="3844427">)</span>&nbsp;<span class="op" id="3844429">==</span>&nbsp;<span class="num" id="3844432">0</span>&nbsp;<span class="op" id="3844434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844439">err</span>&nbsp;<span class="op" id="3844443">=</span>&nbsp;<span class="ident" id="3844445">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844462">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844474">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844477">r</span><span class="op" id="3844478">,</span>&nbsp;<span class="ident" id="3844480">n</span>&nbsp;<span class="op" id="3844482">:=</span>&nbsp;<span class="ident" id="3844485">utf8</span><span class="op" id="3844489">.</span><span class="ident" id="3844490">DecodeRuneInString</span><span class="op" id="3844508">(</span><span class="ident" id="3844509">chunk</span><span class="op" id="3844514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844517">if</span>&nbsp;<span class="ident" id="3844520">r</span>&nbsp;<span class="op" id="3844522">==</span>&nbsp;<span class="ident" id="3844525">utf8</span><span class="op" id="3844529">.</span><span class="ident" id="3844530">RuneError</span>&nbsp;<span class="op" id="3844540">&amp;&amp;</span>&nbsp;<span class="ident" id="3844543">n</span>&nbsp;<span class="op" id="3844545">==</span>&nbsp;<span class="num" id="3844548">1</span>&nbsp;<span class="op" id="3844550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844554">err</span>&nbsp;<span class="op" id="3844558">=</span>&nbsp;<span class="ident" id="3844560">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844578">nchunk</span>&nbsp;<span class="op" id="3844585">=</span>&nbsp;<span class="ident" id="3844587">chunk</span><span class="op" id="3844592">[</span><span class="ident" id="3844593">n</span><span class="op" id="3844594">:</span><span class="op" id="3844595">]</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844598">if</span>&nbsp;<span class="builtinfunc" id="3844601">len</span><span class="op" id="3844604">(</span><span class="ident" id="3844605">nchunk</span><span class="op" id="3844611">)</span>&nbsp;<span class="op" id="3844613">==</span>&nbsp;<span class="num" id="3844616">0</span>&nbsp;<span class="op" id="3844618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844622">err</span>&nbsp;<span class="op" id="3844626">=</span>&nbsp;<span class="ident" id="3844628">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844646">return</span><br>
<span class="lineno"></span><span class="op" id="3844653">}</span>
</div>
</body>
</html>
