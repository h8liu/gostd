<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1963714">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1963769">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1963823">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1963874">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="1963951">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="1963975">package</span>&nbsp;<span class="ident" id="1963983">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1963992">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="1964040">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="1964054">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="1964101">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="1964174">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1964234">import</span>&nbsp;<span class="string" id="1964241">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1964249">var</span>&nbsp;<span class="ident" id="1964253">optimize</span>&nbsp;<span class="op" id="1964262">=</span>&nbsp;<span class="builtintype" id="1964264">true</span>&nbsp;<span class="comment" id="1964269">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1964296">func</span>&nbsp;<span class="ident" id="1964301">equalIgnoreCase</span><span class="op" id="1964316">(</span><span class="ident" id="1964317">s1</span><span class="op" id="1964319">,</span>&nbsp;<span class="ident" id="1964321">s2</span>&nbsp;<span class="builtintype" id="1964324">string</span><span class="op" id="1964330">)</span>&nbsp;<span class="builtintype" id="1964332">bool</span>&nbsp;<span class="op" id="1964337">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964340">if</span>&nbsp;<span class="builtinfunc" id="1964343">len</span><span class="op" id="1964346">(</span><span class="ident" id="1964347">s1</span><span class="op" id="1964349">)</span>&nbsp;<span class="op" id="1964351">!=</span>&nbsp;<span class="builtinfunc" id="1964354">len</span><span class="op" id="1964357">(</span><span class="ident" id="1964358">s2</span><span class="op" id="1964360">)</span>&nbsp;<span class="op" id="1964362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964366">return</span>&nbsp;<span class="builtintype" id="1964373">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964383">for</span>&nbsp;<span class="ident" id="1964387">i</span>&nbsp;<span class="op" id="1964389">:=</span>&nbsp;<span class="num" id="1964392">0</span><span class="op" id="1964393">;</span>&nbsp;<span class="ident" id="1964395">i</span>&nbsp;<span class="op" id="1964397">&lt;</span>&nbsp;<span class="builtinfunc" id="1964399">len</span><span class="op" id="1964402">(</span><span class="ident" id="1964403">s1</span><span class="op" id="1964405">)</span><span class="op" id="1964406">;</span>&nbsp;<span class="ident" id="1964408">i</span><span class="op" id="1964409">++</span>&nbsp;<span class="op" id="1964412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964416">c1</span>&nbsp;<span class="op" id="1964419">:=</span>&nbsp;<span class="ident" id="1964422">s1</span><span class="op" id="1964424">[</span><span class="ident" id="1964425">i</span><span class="op" id="1964426">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964430">if</span>&nbsp;<span class="string" id="1964433">&#39;A&#39;</span>&nbsp;<span class="op" id="1964437">&lt;=</span>&nbsp;<span class="ident" id="1964440">c1</span>&nbsp;<span class="op" id="1964443">&amp;&amp;</span>&nbsp;<span class="ident" id="1964446">c1</span>&nbsp;<span class="op" id="1964449">&lt;=</span>&nbsp;<span class="string" id="1964452">&#39;Z&#39;</span>&nbsp;<span class="op" id="1964456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964461">c1</span>&nbsp;<span class="op" id="1964464">+=</span>&nbsp;<span class="string" id="1964467">&#39;a&#39;</span>&nbsp;<span class="op" id="1964471">-</span>&nbsp;<span class="string" id="1964473">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964483">c2</span>&nbsp;<span class="op" id="1964486">:=</span>&nbsp;<span class="ident" id="1964489">s2</span><span class="op" id="1964491">[</span><span class="ident" id="1964492">i</span><span class="op" id="1964493">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964497">if</span>&nbsp;<span class="string" id="1964500">&#39;A&#39;</span>&nbsp;<span class="op" id="1964504">&lt;=</span>&nbsp;<span class="ident" id="1964507">c2</span>&nbsp;<span class="op" id="1964510">&amp;&amp;</span>&nbsp;<span class="ident" id="1964513">c2</span>&nbsp;<span class="op" id="1964516">&lt;=</span>&nbsp;<span class="string" id="1964519">&#39;Z&#39;</span>&nbsp;<span class="op" id="1964523">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964528">c2</span>&nbsp;<span class="op" id="1964531">+=</span>&nbsp;<span class="string" id="1964534">&#39;a&#39;</span>&nbsp;<span class="op" id="1964538">-</span>&nbsp;<span class="string" id="1964540">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964550">if</span>&nbsp;<span class="ident" id="1964553">c1</span>&nbsp;<span class="op" id="1964556">!=</span>&nbsp;<span class="ident" id="1964559">c2</span>&nbsp;<span class="op" id="1964562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964567">return</span>&nbsp;<span class="builtintype" id="1964574">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964582">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964588">return</span>&nbsp;<span class="builtintype" id="1964595">true</span><br>
<span class="lineno"></span><span class="op" id="1964600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1964603">func</span>&nbsp;<span class="ident" id="1964608">special</span><span class="op" id="1964615">(</span><span class="ident" id="1964616">s</span>&nbsp;<span class="builtintype" id="1964618">string</span><span class="op" id="1964624">)</span>&nbsp;<span class="op" id="1964626">(</span><span class="ident" id="1964627">f</span>&nbsp;<span class="builtintype" id="1964629">float64</span><span class="op" id="1964636">,</span>&nbsp;<span class="ident" id="1964638">ok</span>&nbsp;<span class="builtintype" id="1964641">bool</span><span class="op" id="1964645">)</span>&nbsp;<span class="op" id="1964647">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964650">if</span>&nbsp;<span class="builtinfunc" id="1964653">len</span><span class="op" id="1964656">(</span><span class="ident" id="1964657">s</span><span class="op" id="1964658">)</span>&nbsp;<span class="op" id="1964660">==</span>&nbsp;<span class="num" id="1964663">0</span>&nbsp;<span class="op" id="1964665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964680">switch</span>&nbsp;<span class="ident" id="1964687">s</span><span class="op" id="1964688">[</span><span class="num" id="1964689">0</span><span class="op" id="1964690">]</span>&nbsp;<span class="op" id="1964692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964695">default</span><span class="op" id="1964702">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964706">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964714">case</span>&nbsp;<span class="string" id="1964719">&#39;+&#39;</span><span class="op" id="1964722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964726">if</span>&nbsp;<span class="ident" id="1964729">equalIgnoreCase</span><span class="op" id="1964744">(</span><span class="ident" id="1964745">s</span><span class="op" id="1964746">,</span>&nbsp;<span class="string" id="1964748">&#34;+inf&#34;</span><span class="op" id="1964754">)</span>&nbsp;<span class="op" id="1964756">||</span>&nbsp;<span class="ident" id="1964759">equalIgnoreCase</span><span class="op" id="1964774">(</span><span class="ident" id="1964775">s</span><span class="op" id="1964776">,</span>&nbsp;<span class="string" id="1964778">&#34;+infinity&#34;</span><span class="op" id="1964789">)</span>&nbsp;<span class="op" id="1964791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964796">return</span>&nbsp;<span class="ident" id="1964803">math</span><span class="op" id="1964807">.</span><span class="ident" id="1964808">Inf</span><span class="op" id="1964811">(</span><span class="num" id="1964812">1</span><span class="op" id="1964813">)</span><span class="op" id="1964814">,</span>&nbsp;<span class="builtintype" id="1964816">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964823">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964826">case</span>&nbsp;<span class="string" id="1964831">&#39;-&#39;</span><span class="op" id="1964834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964838">if</span>&nbsp;<span class="ident" id="1964841">equalIgnoreCase</span><span class="op" id="1964856">(</span><span class="ident" id="1964857">s</span><span class="op" id="1964858">,</span>&nbsp;<span class="string" id="1964860">&#34;-inf&#34;</span><span class="op" id="1964866">)</span>&nbsp;<span class="op" id="1964868">||</span>&nbsp;<span class="ident" id="1964871">equalIgnoreCase</span><span class="op" id="1964886">(</span><span class="ident" id="1964887">s</span><span class="op" id="1964888">,</span>&nbsp;<span class="string" id="1964890">&#34;-infinity&#34;</span><span class="op" id="1964901">)</span>&nbsp;<span class="op" id="1964903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964908">return</span>&nbsp;<span class="ident" id="1964915">math</span><span class="op" id="1964919">.</span><span class="ident" id="1964920">Inf</span><span class="op" id="1964923">(</span><span class="op" id="1964924">-</span><span class="num" id="1964925">1</span><span class="op" id="1964926">)</span><span class="op" id="1964927">,</span>&nbsp;<span class="builtintype" id="1964929">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964939">case</span>&nbsp;<span class="string" id="1964944">&#39;n&#39;</span><span class="op" id="1964947">,</span>&nbsp;<span class="string" id="1964949">&#39;N&#39;</span><span class="op" id="1964952">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964956">if</span>&nbsp;<span class="ident" id="1964959">equalIgnoreCase</span><span class="op" id="1964974">(</span><span class="ident" id="1964975">s</span><span class="op" id="1964976">,</span>&nbsp;<span class="string" id="1964978">&#34;nan&#34;</span><span class="op" id="1964983">)</span>&nbsp;<span class="op" id="1964985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964990">return</span>&nbsp;<span class="ident" id="1964997">math</span><span class="op" id="1965001">.</span><span class="ident" id="1965002">NaN</span><span class="op" id="1965005">(</span><span class="op" id="1965006">)</span><span class="op" id="1965007">,</span>&nbsp;<span class="builtintype" id="1965009">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965019">case</span>&nbsp;<span class="string" id="1965024">&#39;i&#39;</span><span class="op" id="1965027">,</span>&nbsp;<span class="string" id="1965029">&#39;I&#39;</span><span class="op" id="1965032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965036">if</span>&nbsp;<span class="ident" id="1965039">equalIgnoreCase</span><span class="op" id="1965054">(</span><span class="ident" id="1965055">s</span><span class="op" id="1965056">,</span>&nbsp;<span class="string" id="1965058">&#34;inf&#34;</span><span class="op" id="1965063">)</span>&nbsp;<span class="op" id="1965065">||</span>&nbsp;<span class="ident" id="1965068">equalIgnoreCase</span><span class="op" id="1965083">(</span><span class="ident" id="1965084">s</span><span class="op" id="1965085">,</span>&nbsp;<span class="string" id="1965087">&#34;infinity&#34;</span><span class="op" id="1965097">)</span>&nbsp;<span class="op" id="1965099">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965104">return</span>&nbsp;<span class="ident" id="1965111">math</span><span class="op" id="1965115">.</span><span class="ident" id="1965116">Inf</span><span class="op" id="1965119">(</span><span class="num" id="1965120">1</span><span class="op" id="1965121">)</span><span class="op" id="1965122">,</span>&nbsp;<span class="builtintype" id="1965124">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965137">return</span><br>
<span class="lineno"></span><span class="op" id="1965144">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1965147">func</span>&nbsp;<span class="op" id="1965152">(</span><span class="ident" id="1965153">b</span>&nbsp;<span class="op" id="1965155">*</span><span class="ident" id="1965156">decimal</span><span class="op" id="1965163">)</span>&nbsp;<span class="ident" id="1965165">set</span><span class="op" id="1965168">(</span><span class="ident" id="1965169">s</span>&nbsp;<span class="builtintype" id="1965171">string</span><span class="op" id="1965177">)</span>&nbsp;<span class="op" id="1965179">(</span><span class="ident" id="1965180">ok</span>&nbsp;<span class="builtintype" id="1965183">bool</span><span class="op" id="1965187">)</span>&nbsp;<span class="op" id="1965189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965192">i</span>&nbsp;<span class="op" id="1965194">:=</span>&nbsp;<span class="num" id="1965197">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965200">b</span><span class="op" id="1965201">.</span><span class="ident" id="1965202">neg</span>&nbsp;<span class="op" id="1965206">=</span>&nbsp;<span class="builtintype" id="1965208">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965215">b</span><span class="op" id="1965216">.</span><span class="ident" id="1965217">trunc</span>&nbsp;<span class="op" id="1965223">=</span>&nbsp;<span class="builtintype" id="1965225">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965233">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965251">if</span>&nbsp;<span class="ident" id="1965254">i</span>&nbsp;<span class="op" id="1965256">&gt;=</span>&nbsp;<span class="builtinfunc" id="1965259">len</span><span class="op" id="1965262">(</span><span class="ident" id="1965263">s</span><span class="op" id="1965264">)</span>&nbsp;<span class="op" id="1965266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965270">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965278">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965281">switch</span>&nbsp;<span class="op" id="1965288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965291">case</span>&nbsp;<span class="ident" id="1965296">s</span><span class="op" id="1965297">[</span><span class="ident" id="1965298">i</span><span class="op" id="1965299">]</span>&nbsp;<span class="op" id="1965301">==</span>&nbsp;<span class="string" id="1965304">&#39;+&#39;</span><span class="op" id="1965307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965311">i</span><span class="op" id="1965312">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965316">case</span>&nbsp;<span class="ident" id="1965321">s</span><span class="op" id="1965322">[</span><span class="ident" id="1965323">i</span><span class="op" id="1965324">]</span>&nbsp;<span class="op" id="1965326">==</span>&nbsp;<span class="string" id="1965329">&#39;-&#39;</span><span class="op" id="1965332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965336">b</span><span class="op" id="1965337">.</span><span class="ident" id="1965338">neg</span>&nbsp;<span class="op" id="1965342">=</span>&nbsp;<span class="builtintype" id="1965344">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965351">i</span><span class="op" id="1965352">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965360">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965371">sawdot</span>&nbsp;<span class="op" id="1965378">:=</span>&nbsp;<span class="builtintype" id="1965381">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965388">sawdigits</span>&nbsp;<span class="op" id="1965398">:=</span>&nbsp;<span class="builtintype" id="1965401">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965408">for</span>&nbsp;<span class="op" id="1965412">;</span>&nbsp;<span class="ident" id="1965414">i</span>&nbsp;<span class="op" id="1965416">&lt;</span>&nbsp;<span class="builtinfunc" id="1965418">len</span><span class="op" id="1965421">(</span><span class="ident" id="1965422">s</span><span class="op" id="1965423">)</span><span class="op" id="1965424">;</span>&nbsp;<span class="ident" id="1965426">i</span><span class="op" id="1965427">++</span>&nbsp;<span class="op" id="1965430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965434">switch</span>&nbsp;<span class="op" id="1965441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965445">case</span>&nbsp;<span class="ident" id="1965450">s</span><span class="op" id="1965451">[</span><span class="ident" id="1965452">i</span><span class="op" id="1965453">]</span>&nbsp;<span class="op" id="1965455">==</span>&nbsp;<span class="string" id="1965458">&#39;.&#39;</span><span class="op" id="1965461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965466">if</span>&nbsp;<span class="ident" id="1965469">sawdot</span>&nbsp;<span class="op" id="1965476">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965482">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965497">sawdot</span>&nbsp;<span class="op" id="1965504">=</span>&nbsp;<span class="builtintype" id="1965506">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965514">b</span><span class="op" id="1965515">.</span><span class="ident" id="1965516">dp</span>&nbsp;<span class="op" id="1965519">=</span>&nbsp;<span class="ident" id="1965521">b</span><span class="op" id="1965522">.</span><span class="ident" id="1965523">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965529">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965541">case</span>&nbsp;<span class="string" id="1965546">&#39;0&#39;</span>&nbsp;<span class="op" id="1965550">&lt;=</span>&nbsp;<span class="ident" id="1965553">s</span><span class="op" id="1965554">[</span><span class="ident" id="1965555">i</span><span class="op" id="1965556">]</span>&nbsp;<span class="op" id="1965558">&amp;&amp;</span>&nbsp;<span class="ident" id="1965561">s</span><span class="op" id="1965562">[</span><span class="ident" id="1965563">i</span><span class="op" id="1965564">]</span>&nbsp;<span class="op" id="1965566">&lt;=</span>&nbsp;<span class="string" id="1965569">&#39;9&#39;</span><span class="op" id="1965572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965577">sawdigits</span>&nbsp;<span class="op" id="1965587">=</span>&nbsp;<span class="builtintype" id="1965589">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965597">if</span>&nbsp;<span class="ident" id="1965600">s</span><span class="op" id="1965601">[</span><span class="ident" id="1965602">i</span><span class="op" id="1965603">]</span>&nbsp;<span class="op" id="1965605">==</span>&nbsp;<span class="string" id="1965608">&#39;0&#39;</span>&nbsp;<span class="op" id="1965612">&amp;&amp;</span>&nbsp;<span class="ident" id="1965615">b</span><span class="op" id="1965616">.</span><span class="ident" id="1965617">nd</span>&nbsp;<span class="op" id="1965620">==</span>&nbsp;<span class="num" id="1965623">0</span>&nbsp;<span class="op" id="1965625">{</span>&nbsp;<span class="comment" id="1965627">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965655">b</span><span class="op" id="1965656">.</span><span class="ident" id="1965657">dp</span><span class="op" id="1965659">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965666">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965683">if</span>&nbsp;<span class="ident" id="1965686">b</span><span class="op" id="1965687">.</span><span class="ident" id="1965688">nd</span>&nbsp;<span class="op" id="1965691">&lt;</span>&nbsp;<span class="builtinfunc" id="1965693">len</span><span class="op" id="1965696">(</span><span class="ident" id="1965697">b</span><span class="op" id="1965698">.</span><span class="ident" id="1965699">d</span><span class="op" id="1965700">)</span>&nbsp;<span class="op" id="1965702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965708">b</span><span class="op" id="1965709">.</span><span class="ident" id="1965710">d</span><span class="op" id="1965711">[</span><span class="ident" id="1965712">b</span><span class="op" id="1965713">.</span><span class="ident" id="1965714">nd</span><span class="op" id="1965716">]</span>&nbsp;<span class="op" id="1965718">=</span>&nbsp;<span class="ident" id="1965720">s</span><span class="op" id="1965721">[</span><span class="ident" id="1965722">i</span><span class="op" id="1965723">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965729">b</span><span class="op" id="1965730">.</span><span class="ident" id="1965731">nd</span><span class="op" id="1965733">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965739">}</span>&nbsp;<span class="keyword" id="1965741">else</span>&nbsp;<span class="keyword" id="1965746">if</span>&nbsp;<span class="ident" id="1965749">s</span><span class="op" id="1965750">[</span><span class="ident" id="1965751">i</span><span class="op" id="1965752">]</span>&nbsp;<span class="op" id="1965754">!=</span>&nbsp;<span class="string" id="1965757">&#39;0&#39;</span>&nbsp;<span class="op" id="1965761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965767">b</span><span class="op" id="1965768">.</span><span class="ident" id="1965769">trunc</span>&nbsp;<span class="op" id="1965775">=</span>&nbsp;<span class="builtintype" id="1965777">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965790">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965801">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965805">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965815">if</span>&nbsp;<span class="op" id="1965818">!</span><span class="ident" id="1965819">sawdigits</span>&nbsp;<span class="op" id="1965829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965833">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965841">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965844">if</span>&nbsp;<span class="op" id="1965847">!</span><span class="ident" id="1965848">sawdot</span>&nbsp;<span class="op" id="1965855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965859">b</span><span class="op" id="1965860">.</span><span class="ident" id="1965861">dp</span>&nbsp;<span class="op" id="1965864">=</span>&nbsp;<span class="ident" id="1965866">b</span><span class="op" id="1965867">.</span><span class="ident" id="1965868">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965876">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965919">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965966">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966012">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966064">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966090">if</span>&nbsp;<span class="ident" id="1966093">i</span>&nbsp;<span class="op" id="1966095">&lt;</span>&nbsp;<span class="builtinfunc" id="1966097">len</span><span class="op" id="1966100">(</span><span class="ident" id="1966101">s</span><span class="op" id="1966102">)</span>&nbsp;<span class="op" id="1966104">&amp;&amp;</span>&nbsp;<span class="op" id="1966107">(</span><span class="ident" id="1966108">s</span><span class="op" id="1966109">[</span><span class="ident" id="1966110">i</span><span class="op" id="1966111">]</span>&nbsp;<span class="op" id="1966113">==</span>&nbsp;<span class="string" id="1966116">&#39;e&#39;</span>&nbsp;<span class="op" id="1966120">||</span>&nbsp;<span class="ident" id="1966123">s</span><span class="op" id="1966124">[</span><span class="ident" id="1966125">i</span><span class="op" id="1966126">]</span>&nbsp;<span class="op" id="1966128">==</span>&nbsp;<span class="string" id="1966131">&#39;E&#39;</span><span class="op" id="1966134">)</span>&nbsp;<span class="op" id="1966136">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966140">i</span><span class="op" id="1966141">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966146">if</span>&nbsp;<span class="ident" id="1966149">i</span>&nbsp;<span class="op" id="1966151">&gt;=</span>&nbsp;<span class="builtinfunc" id="1966154">len</span><span class="op" id="1966157">(</span><span class="ident" id="1966158">s</span><span class="op" id="1966159">)</span>&nbsp;<span class="op" id="1966161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966166">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966179">esign</span>&nbsp;<span class="op" id="1966185">:=</span>&nbsp;<span class="num" id="1966188">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966192">if</span>&nbsp;<span class="ident" id="1966195">s</span><span class="op" id="1966196">[</span><span class="ident" id="1966197">i</span><span class="op" id="1966198">]</span>&nbsp;<span class="op" id="1966200">==</span>&nbsp;<span class="string" id="1966203">&#39;+&#39;</span>&nbsp;<span class="op" id="1966207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966212">i</span><span class="op" id="1966213">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966218">}</span>&nbsp;<span class="keyword" id="1966220">else</span>&nbsp;<span class="keyword" id="1966225">if</span>&nbsp;<span class="ident" id="1966228">s</span><span class="op" id="1966229">[</span><span class="ident" id="1966230">i</span><span class="op" id="1966231">]</span>&nbsp;<span class="op" id="1966233">==</span>&nbsp;<span class="string" id="1966236">&#39;-&#39;</span>&nbsp;<span class="op" id="1966240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966245">i</span><span class="op" id="1966246">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966252">esign</span>&nbsp;<span class="op" id="1966258">=</span>&nbsp;<span class="op" id="1966260">-</span><span class="num" id="1966261">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966269">if</span>&nbsp;<span class="ident" id="1966272">i</span>&nbsp;<span class="op" id="1966274">&gt;=</span>&nbsp;<span class="builtinfunc" id="1966277">len</span><span class="op" id="1966280">(</span><span class="ident" id="1966281">s</span><span class="op" id="1966282">)</span>&nbsp;<span class="op" id="1966284">||</span>&nbsp;<span class="ident" id="1966287">s</span><span class="op" id="1966288">[</span><span class="ident" id="1966289">i</span><span class="op" id="1966290">]</span>&nbsp;<span class="op" id="1966292">&lt;</span>&nbsp;<span class="string" id="1966294">&#39;0&#39;</span>&nbsp;<span class="op" id="1966298">||</span>&nbsp;<span class="ident" id="1966301">s</span><span class="op" id="1966302">[</span><span class="ident" id="1966303">i</span><span class="op" id="1966304">]</span>&nbsp;<span class="op" id="1966306">&gt;</span>&nbsp;<span class="string" id="1966308">&#39;9&#39;</span>&nbsp;<span class="op" id="1966312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966317">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966330">e</span>&nbsp;<span class="op" id="1966332">:=</span>&nbsp;<span class="num" id="1966335">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966339">for</span>&nbsp;<span class="op" id="1966343">;</span>&nbsp;<span class="ident" id="1966345">i</span>&nbsp;<span class="op" id="1966347">&lt;</span>&nbsp;<span class="builtinfunc" id="1966349">len</span><span class="op" id="1966352">(</span><span class="ident" id="1966353">s</span><span class="op" id="1966354">)</span>&nbsp;<span class="op" id="1966356">&amp;&amp;</span>&nbsp;<span class="string" id="1966359">&#39;0&#39;</span>&nbsp;<span class="op" id="1966363">&lt;=</span>&nbsp;<span class="ident" id="1966366">s</span><span class="op" id="1966367">[</span><span class="ident" id="1966368">i</span><span class="op" id="1966369">]</span>&nbsp;<span class="op" id="1966371">&amp;&amp;</span>&nbsp;<span class="ident" id="1966374">s</span><span class="op" id="1966375">[</span><span class="ident" id="1966376">i</span><span class="op" id="1966377">]</span>&nbsp;<span class="op" id="1966379">&lt;=</span>&nbsp;<span class="string" id="1966382">&#39;9&#39;</span><span class="op" id="1966385">;</span>&nbsp;<span class="ident" id="1966387">i</span><span class="op" id="1966388">++</span>&nbsp;<span class="op" id="1966391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966396">if</span>&nbsp;<span class="ident" id="1966399">e</span>&nbsp;<span class="op" id="1966401">&lt;</span>&nbsp;<span class="num" id="1966403">10000</span>&nbsp;<span class="op" id="1966409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966415">e</span>&nbsp;<span class="op" id="1966417">=</span>&nbsp;<span class="ident" id="1966419">e</span><span class="op" id="1966420">*</span><span class="num" id="1966421">10</span>&nbsp;<span class="op" id="1966424">+</span>&nbsp;<span class="builtintype" id="1966426">int</span><span class="op" id="1966429">(</span><span class="ident" id="1966430">s</span><span class="op" id="1966431">[</span><span class="ident" id="1966432">i</span><span class="op" id="1966433">]</span><span class="op" id="1966434">)</span>&nbsp;<span class="op" id="1966436">-</span>&nbsp;<span class="string" id="1966438">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966449">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966453">b</span><span class="op" id="1966454">.</span><span class="ident" id="1966455">dp</span>&nbsp;<span class="op" id="1966458">+=</span>&nbsp;<span class="ident" id="1966461">e</span>&nbsp;<span class="op" id="1966463">*</span>&nbsp;<span class="ident" id="1966465">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966476">if</span>&nbsp;<span class="ident" id="1966479">i</span>&nbsp;<span class="op" id="1966481">!=</span>&nbsp;<span class="builtinfunc" id="1966484">len</span><span class="op" id="1966487">(</span><span class="ident" id="1966488">s</span><span class="op" id="1966489">)</span>&nbsp;<span class="op" id="1966491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966495">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966507">ok</span>&nbsp;<span class="op" id="1966510">=</span>&nbsp;<span class="builtintype" id="1966512">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966518">return</span><br>
<span class="lineno"></span><span class="op" id="1966525">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="1966528">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="1966592">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="1966658">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="1966697">func</span>&nbsp;<span class="ident" id="1966702">readFloat</span><span class="op" id="1966711">(</span><span class="ident" id="1966712">s</span>&nbsp;<span class="builtintype" id="1966714">string</span><span class="op" id="1966720">)</span>&nbsp;<span class="op" id="1966722">(</span><span class="ident" id="1966723">mantissa</span>&nbsp;<span class="ident" id="1966732">uint64</span><span class="op" id="1966738">,</span>&nbsp;<span class="ident" id="1966740">exp</span>&nbsp;<span class="builtintype" id="1966744">int</span><span class="op" id="1966747">,</span>&nbsp;<span class="ident" id="1966749">neg</span><span class="op" id="1966752">,</span>&nbsp;<span class="ident" id="1966754">trunc</span><span class="op" id="1966759">,</span>&nbsp;<span class="ident" id="1966761">ok</span>&nbsp;<span class="builtintype" id="1966764">bool</span><span class="op" id="1966768">)</span>&nbsp;<span class="op" id="1966770">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966773">const</span>&nbsp;<span class="ident" id="1966779">uint64digits</span>&nbsp;<span class="op" id="1966792">=</span>&nbsp;<span class="num" id="1966794">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966798">i</span>&nbsp;<span class="op" id="1966800">:=</span>&nbsp;<span class="num" id="1966803">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966807">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966825">if</span>&nbsp;<span class="ident" id="1966828">i</span>&nbsp;<span class="op" id="1966830">&gt;=</span>&nbsp;<span class="builtinfunc" id="1966833">len</span><span class="op" id="1966836">(</span><span class="ident" id="1966837">s</span><span class="op" id="1966838">)</span>&nbsp;<span class="op" id="1966840">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966844">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966855">switch</span>&nbsp;<span class="op" id="1966862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966865">case</span>&nbsp;<span class="ident" id="1966870">s</span><span class="op" id="1966871">[</span><span class="ident" id="1966872">i</span><span class="op" id="1966873">]</span>&nbsp;<span class="op" id="1966875">==</span>&nbsp;<span class="string" id="1966878">&#39;+&#39;</span><span class="op" id="1966881">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966885">i</span><span class="op" id="1966886">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966890">case</span>&nbsp;<span class="ident" id="1966895">s</span><span class="op" id="1966896">[</span><span class="ident" id="1966897">i</span><span class="op" id="1966898">]</span>&nbsp;<span class="op" id="1966900">==</span>&nbsp;<span class="string" id="1966903">&#39;-&#39;</span><span class="op" id="1966906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966910">neg</span>&nbsp;<span class="op" id="1966914">=</span>&nbsp;<span class="builtintype" id="1966916">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966923">i</span><span class="op" id="1966924">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966932">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966943">sawdot</span>&nbsp;<span class="op" id="1966950">:=</span>&nbsp;<span class="builtintype" id="1966953">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966960">sawdigits</span>&nbsp;<span class="op" id="1966970">:=</span>&nbsp;<span class="builtintype" id="1966973">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966980">nd</span>&nbsp;<span class="op" id="1966983">:=</span>&nbsp;<span class="num" id="1966986">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966989">ndMant</span>&nbsp;<span class="op" id="1966996">:=</span>&nbsp;<span class="num" id="1966999">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967002">dp</span>&nbsp;<span class="op" id="1967005">:=</span>&nbsp;<span class="num" id="1967008">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967011">for</span>&nbsp;<span class="op" id="1967015">;</span>&nbsp;<span class="ident" id="1967017">i</span>&nbsp;<span class="op" id="1967019">&lt;</span>&nbsp;<span class="builtinfunc" id="1967021">len</span><span class="op" id="1967024">(</span><span class="ident" id="1967025">s</span><span class="op" id="1967026">)</span><span class="op" id="1967027">;</span>&nbsp;<span class="ident" id="1967029">i</span><span class="op" id="1967030">++</span>&nbsp;<span class="op" id="1967033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967037">switch</span>&nbsp;<span class="ident" id="1967044">c</span>&nbsp;<span class="op" id="1967046">:=</span>&nbsp;<span class="ident" id="1967049">s</span><span class="op" id="1967050">[</span><span class="ident" id="1967051">i</span><span class="op" id="1967052">]</span><span class="op" id="1967053">;</span>&nbsp;<span class="builtintype" id="1967055">true</span>&nbsp;<span class="op" id="1967060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967064">case</span>&nbsp;<span class="ident" id="1967069">c</span>&nbsp;<span class="op" id="1967071">==</span>&nbsp;<span class="string" id="1967074">&#39;.&#39;</span><span class="op" id="1967077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967082">if</span>&nbsp;<span class="ident" id="1967085">sawdot</span>&nbsp;<span class="op" id="1967092">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967098">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967113">sawdot</span>&nbsp;<span class="op" id="1967120">=</span>&nbsp;<span class="builtintype" id="1967122">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967130">dp</span>&nbsp;<span class="op" id="1967133">=</span>&nbsp;<span class="ident" id="1967135">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967141">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967153">case</span>&nbsp;<span class="string" id="1967158">&#39;0&#39;</span>&nbsp;<span class="op" id="1967162">&lt;=</span>&nbsp;<span class="ident" id="1967165">c</span>&nbsp;<span class="op" id="1967167">&amp;&amp;</span>&nbsp;<span class="ident" id="1967170">c</span>&nbsp;<span class="op" id="1967172">&lt;=</span>&nbsp;<span class="string" id="1967175">&#39;9&#39;</span><span class="op" id="1967178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967183">sawdigits</span>&nbsp;<span class="op" id="1967193">=</span>&nbsp;<span class="builtintype" id="1967195">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967203">if</span>&nbsp;<span class="ident" id="1967206">c</span>&nbsp;<span class="op" id="1967208">==</span>&nbsp;<span class="string" id="1967211">&#39;0&#39;</span>&nbsp;<span class="op" id="1967215">&amp;&amp;</span>&nbsp;<span class="ident" id="1967218">nd</span>&nbsp;<span class="op" id="1967221">==</span>&nbsp;<span class="num" id="1967224">0</span>&nbsp;<span class="op" id="1967226">{</span>&nbsp;<span class="comment" id="1967228">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967256">dp</span><span class="op" id="1967258">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967265">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967282">nd</span><span class="op" id="1967284">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967290">if</span>&nbsp;<span class="ident" id="1967293">ndMant</span>&nbsp;<span class="op" id="1967300">&lt;</span>&nbsp;<span class="ident" id="1967302">uint64digits</span>&nbsp;<span class="op" id="1967315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967321">mantissa</span>&nbsp;<span class="op" id="1967330">*=</span>&nbsp;<span class="num" id="1967333">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967340">mantissa</span>&nbsp;<span class="op" id="1967349">+=</span>&nbsp;<span class="ident" id="1967352">uint64</span><span class="op" id="1967358">(</span><span class="ident" id="1967359">c</span>&nbsp;<span class="op" id="1967361">-</span>&nbsp;<span class="string" id="1967363">&#39;0&#39;</span><span class="op" id="1967366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967372">ndMant</span><span class="op" id="1967378">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967384">}</span>&nbsp;<span class="keyword" id="1967386">else</span>&nbsp;<span class="keyword" id="1967391">if</span>&nbsp;<span class="ident" id="1967394">s</span><span class="op" id="1967395">[</span><span class="ident" id="1967396">i</span><span class="op" id="1967397">]</span>&nbsp;<span class="op" id="1967399">!=</span>&nbsp;<span class="string" id="1967402">&#39;0&#39;</span>&nbsp;<span class="op" id="1967406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967412">trunc</span>&nbsp;<span class="op" id="1967418">=</span>&nbsp;<span class="builtintype" id="1967420">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967428">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967433">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967448">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967458">if</span>&nbsp;<span class="op" id="1967461">!</span><span class="ident" id="1967462">sawdigits</span>&nbsp;<span class="op" id="1967472">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967476">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967487">if</span>&nbsp;<span class="op" id="1967490">!</span><span class="ident" id="1967491">sawdot</span>&nbsp;<span class="op" id="1967498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967502">dp</span>&nbsp;<span class="op" id="1967505">=</span>&nbsp;<span class="ident" id="1967507">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967511">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967515">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967558">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967605">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967651">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967703">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967729">if</span>&nbsp;<span class="ident" id="1967732">i</span>&nbsp;<span class="op" id="1967734">&lt;</span>&nbsp;<span class="builtinfunc" id="1967736">len</span><span class="op" id="1967739">(</span><span class="ident" id="1967740">s</span><span class="op" id="1967741">)</span>&nbsp;<span class="op" id="1967743">&amp;&amp;</span>&nbsp;<span class="op" id="1967746">(</span><span class="ident" id="1967747">s</span><span class="op" id="1967748">[</span><span class="ident" id="1967749">i</span><span class="op" id="1967750">]</span>&nbsp;<span class="op" id="1967752">==</span>&nbsp;<span class="string" id="1967755">&#39;e&#39;</span>&nbsp;<span class="op" id="1967759">||</span>&nbsp;<span class="ident" id="1967762">s</span><span class="op" id="1967763">[</span><span class="ident" id="1967764">i</span><span class="op" id="1967765">]</span>&nbsp;<span class="op" id="1967767">==</span>&nbsp;<span class="string" id="1967770">&#39;E&#39;</span><span class="op" id="1967773">)</span>&nbsp;<span class="op" id="1967775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967779">i</span><span class="op" id="1967780">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967785">if</span>&nbsp;<span class="ident" id="1967788">i</span>&nbsp;<span class="op" id="1967790">&gt;=</span>&nbsp;<span class="builtinfunc" id="1967793">len</span><span class="op" id="1967796">(</span><span class="ident" id="1967797">s</span><span class="op" id="1967798">)</span>&nbsp;<span class="op" id="1967800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967805">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967818">esign</span>&nbsp;<span class="op" id="1967824">:=</span>&nbsp;<span class="num" id="1967827">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967831">if</span>&nbsp;<span class="ident" id="1967834">s</span><span class="op" id="1967835">[</span><span class="ident" id="1967836">i</span><span class="op" id="1967837">]</span>&nbsp;<span class="op" id="1967839">==</span>&nbsp;<span class="string" id="1967842">&#39;+&#39;</span>&nbsp;<span class="op" id="1967846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967851">i</span><span class="op" id="1967852">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967857">}</span>&nbsp;<span class="keyword" id="1967859">else</span>&nbsp;<span class="keyword" id="1967864">if</span>&nbsp;<span class="ident" id="1967867">s</span><span class="op" id="1967868">[</span><span class="ident" id="1967869">i</span><span class="op" id="1967870">]</span>&nbsp;<span class="op" id="1967872">==</span>&nbsp;<span class="string" id="1967875">&#39;-&#39;</span>&nbsp;<span class="op" id="1967879">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967884">i</span><span class="op" id="1967885">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967891">esign</span>&nbsp;<span class="op" id="1967897">=</span>&nbsp;<span class="op" id="1967899">-</span><span class="num" id="1967900">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967908">if</span>&nbsp;<span class="ident" id="1967911">i</span>&nbsp;<span class="op" id="1967913">&gt;=</span>&nbsp;<span class="builtinfunc" id="1967916">len</span><span class="op" id="1967919">(</span><span class="ident" id="1967920">s</span><span class="op" id="1967921">)</span>&nbsp;<span class="op" id="1967923">||</span>&nbsp;<span class="ident" id="1967926">s</span><span class="op" id="1967927">[</span><span class="ident" id="1967928">i</span><span class="op" id="1967929">]</span>&nbsp;<span class="op" id="1967931">&lt;</span>&nbsp;<span class="string" id="1967933">&#39;0&#39;</span>&nbsp;<span class="op" id="1967937">||</span>&nbsp;<span class="ident" id="1967940">s</span><span class="op" id="1967941">[</span><span class="ident" id="1967942">i</span><span class="op" id="1967943">]</span>&nbsp;<span class="op" id="1967945">&gt;</span>&nbsp;<span class="string" id="1967947">&#39;9&#39;</span>&nbsp;<span class="op" id="1967951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967956">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967969">e</span>&nbsp;<span class="op" id="1967971">:=</span>&nbsp;<span class="num" id="1967974">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967978">for</span>&nbsp;<span class="op" id="1967982">;</span>&nbsp;<span class="ident" id="1967984">i</span>&nbsp;<span class="op" id="1967986">&lt;</span>&nbsp;<span class="builtinfunc" id="1967988">len</span><span class="op" id="1967991">(</span><span class="ident" id="1967992">s</span><span class="op" id="1967993">)</span>&nbsp;<span class="op" id="1967995">&amp;&amp;</span>&nbsp;<span class="string" id="1967998">&#39;0&#39;</span>&nbsp;<span class="op" id="1968002">&lt;=</span>&nbsp;<span class="ident" id="1968005">s</span><span class="op" id="1968006">[</span><span class="ident" id="1968007">i</span><span class="op" id="1968008">]</span>&nbsp;<span class="op" id="1968010">&amp;&amp;</span>&nbsp;<span class="ident" id="1968013">s</span><span class="op" id="1968014">[</span><span class="ident" id="1968015">i</span><span class="op" id="1968016">]</span>&nbsp;<span class="op" id="1968018">&lt;=</span>&nbsp;<span class="string" id="1968021">&#39;9&#39;</span><span class="op" id="1968024">;</span>&nbsp;<span class="ident" id="1968026">i</span><span class="op" id="1968027">++</span>&nbsp;<span class="op" id="1968030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968035">if</span>&nbsp;<span class="ident" id="1968038">e</span>&nbsp;<span class="op" id="1968040">&lt;</span>&nbsp;<span class="num" id="1968042">10000</span>&nbsp;<span class="op" id="1968048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968054">e</span>&nbsp;<span class="op" id="1968056">=</span>&nbsp;<span class="ident" id="1968058">e</span><span class="op" id="1968059">*</span><span class="num" id="1968060">10</span>&nbsp;<span class="op" id="1968063">+</span>&nbsp;<span class="builtintype" id="1968065">int</span><span class="op" id="1968068">(</span><span class="ident" id="1968069">s</span><span class="op" id="1968070">[</span><span class="ident" id="1968071">i</span><span class="op" id="1968072">]</span><span class="op" id="1968073">)</span>&nbsp;<span class="op" id="1968075">-</span>&nbsp;<span class="string" id="1968077">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968092">dp</span>&nbsp;<span class="op" id="1968095">+=</span>&nbsp;<span class="ident" id="1968098">e</span>&nbsp;<span class="op" id="1968100">*</span>&nbsp;<span class="ident" id="1968102">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968113">if</span>&nbsp;<span class="ident" id="1968116">i</span>&nbsp;<span class="op" id="1968118">!=</span>&nbsp;<span class="builtinfunc" id="1968121">len</span><span class="op" id="1968124">(</span><span class="ident" id="1968125">s</span><span class="op" id="1968126">)</span>&nbsp;<span class="op" id="1968128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968132">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968144">exp</span>&nbsp;<span class="op" id="1968148">=</span>&nbsp;<span class="ident" id="1968150">dp</span>&nbsp;<span class="op" id="1968153">-</span>&nbsp;<span class="ident" id="1968155">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968163">ok</span>&nbsp;<span class="op" id="1968166">=</span>&nbsp;<span class="builtintype" id="1968168">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968174">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="1968182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="1968185">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="1968233">var</span>&nbsp;<span class="ident" id="1968237">powtab</span>&nbsp;<span class="op" id="1968244">=</span>&nbsp;<span class="op" id="1968246">[</span><span class="op" id="1968247">]</span><span class="builtintype" id="1968248">int</span><span class="op" id="1968251">{</span><span class="num" id="1968252">1</span><span class="op" id="1968253">,</span>&nbsp;<span class="num" id="1968255">3</span><span class="op" id="1968256">,</span>&nbsp;<span class="num" id="1968258">6</span><span class="op" id="1968259">,</span>&nbsp;<span class="num" id="1968261">9</span><span class="op" id="1968262">,</span>&nbsp;<span class="num" id="1968264">13</span><span class="op" id="1968266">,</span>&nbsp;<span class="num" id="1968268">16</span><span class="op" id="1968270">,</span>&nbsp;<span class="num" id="1968272">19</span><span class="op" id="1968274">,</span>&nbsp;<span class="num" id="1968276">23</span><span class="op" id="1968278">,</span>&nbsp;<span class="num" id="1968280">26</span><span class="op" id="1968282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1968285">func</span>&nbsp;<span class="op" id="1968290">(</span><span class="ident" id="1968291">d</span>&nbsp;<span class="op" id="1968293">*</span><span class="ident" id="1968294">decimal</span><span class="op" id="1968301">)</span>&nbsp;<span class="ident" id="1968303">floatBits</span><span class="op" id="1968312">(</span><span class="ident" id="1968313">flt</span>&nbsp;<span class="op" id="1968317">*</span><span class="ident" id="1968318">floatInfo</span><span class="op" id="1968327">)</span>&nbsp;<span class="op" id="1968329">(</span><span class="ident" id="1968330">b</span>&nbsp;<span class="ident" id="1968332">uint64</span><span class="op" id="1968338">,</span>&nbsp;<span class="ident" id="1968340">overflow</span>&nbsp;<span class="builtintype" id="1968349">bool</span><span class="op" id="1968353">)</span>&nbsp;<span class="op" id="1968355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968358">var</span>&nbsp;<span class="ident" id="1968362">exp</span>&nbsp;<span class="builtintype" id="1968366">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968371">var</span>&nbsp;<span class="ident" id="1968375">mant</span>&nbsp;<span class="ident" id="1968380">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968389">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968424">if</span>&nbsp;<span class="ident" id="1968427">d</span><span class="op" id="1968428">.</span><span class="ident" id="1968429">nd</span>&nbsp;<span class="op" id="1968432">==</span>&nbsp;<span class="num" id="1968435">0</span>&nbsp;<span class="op" id="1968437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968441">mant</span>&nbsp;<span class="op" id="1968446">=</span>&nbsp;<span class="num" id="1968448">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968452">exp</span>&nbsp;<span class="op" id="1968456">=</span>&nbsp;<span class="ident" id="1968458">flt</span><span class="op" id="1968461">.</span><span class="ident" id="1968462">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968469">goto</span>&nbsp;<span class="ident" id="1968474">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968483">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968515">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968555">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968630">if</span>&nbsp;<span class="ident" id="1968633">d</span><span class="op" id="1968634">.</span><span class="ident" id="1968635">dp</span>&nbsp;<span class="op" id="1968638">&gt;</span>&nbsp;<span class="num" id="1968640">310</span>&nbsp;<span class="op" id="1968644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968648">goto</span>&nbsp;<span class="ident" id="1968653">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968663">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968666">if</span>&nbsp;<span class="ident" id="1968669">d</span><span class="op" id="1968670">.</span><span class="ident" id="1968671">dp</span>&nbsp;<span class="op" id="1968674">&lt;</span>&nbsp;<span class="op" id="1968676">-</span><span class="num" id="1968677">330</span>&nbsp;<span class="op" id="1968681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968685">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968695">mant</span>&nbsp;<span class="op" id="1968700">=</span>&nbsp;<span class="num" id="1968702">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968706">exp</span>&nbsp;<span class="op" id="1968710">=</span>&nbsp;<span class="ident" id="1968712">flt</span><span class="op" id="1968715">.</span><span class="ident" id="1968716">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968723">goto</span>&nbsp;<span class="ident" id="1968728">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968737">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968790">exp</span>&nbsp;<span class="op" id="1968794">=</span>&nbsp;<span class="num" id="1968796">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968799">for</span>&nbsp;<span class="ident" id="1968803">d</span><span class="op" id="1968804">.</span><span class="ident" id="1968805">dp</span>&nbsp;<span class="op" id="1968808">&gt;</span>&nbsp;<span class="num" id="1968810">0</span>&nbsp;<span class="op" id="1968812">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968816">var</span>&nbsp;<span class="ident" id="1968820">n</span>&nbsp;<span class="builtintype" id="1968822">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968828">if</span>&nbsp;<span class="ident" id="1968831">d</span><span class="op" id="1968832">.</span><span class="ident" id="1968833">dp</span>&nbsp;<span class="op" id="1968836">&gt;=</span>&nbsp;<span class="builtinfunc" id="1968839">len</span><span class="op" id="1968842">(</span><span class="ident" id="1968843">powtab</span><span class="op" id="1968849">)</span>&nbsp;<span class="op" id="1968851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968856">n</span>&nbsp;<span class="op" id="1968858">=</span>&nbsp;<span class="num" id="1968860">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968865">}</span>&nbsp;<span class="keyword" id="1968867">else</span>&nbsp;<span class="op" id="1968872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968877">n</span>&nbsp;<span class="op" id="1968879">=</span>&nbsp;<span class="ident" id="1968881">powtab</span><span class="op" id="1968887">[</span><span class="ident" id="1968888">d</span><span class="op" id="1968889">.</span><span class="ident" id="1968890">dp</span><span class="op" id="1968892">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968900">d</span><span class="op" id="1968901">.</span><span class="ident" id="1968902">Shift</span><span class="op" id="1968907">(</span><span class="op" id="1968908">-</span><span class="ident" id="1968909">n</span><span class="op" id="1968910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968914">exp</span>&nbsp;<span class="op" id="1968918">+=</span>&nbsp;<span class="ident" id="1968921">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968927">for</span>&nbsp;<span class="ident" id="1968931">d</span><span class="op" id="1968932">.</span><span class="ident" id="1968933">dp</span>&nbsp;<span class="op" id="1968936">&lt;</span>&nbsp;<span class="num" id="1968938">0</span>&nbsp;<span class="op" id="1968940">||</span>&nbsp;<span class="ident" id="1968943">d</span><span class="op" id="1968944">.</span><span class="ident" id="1968945">dp</span>&nbsp;<span class="op" id="1968948">==</span>&nbsp;<span class="num" id="1968951">0</span>&nbsp;<span class="op" id="1968953">&amp;&amp;</span>&nbsp;<span class="ident" id="1968956">d</span><span class="op" id="1968957">.</span><span class="ident" id="1968958">d</span><span class="op" id="1968959">[</span><span class="num" id="1968960">0</span><span class="op" id="1968961">]</span>&nbsp;<span class="op" id="1968963">&lt;</span>&nbsp;<span class="string" id="1968965">&#39;5&#39;</span>&nbsp;<span class="op" id="1968969">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968973">var</span>&nbsp;<span class="ident" id="1968977">n</span>&nbsp;<span class="builtintype" id="1968979">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968985">if</span>&nbsp;<span class="op" id="1968988">-</span><span class="ident" id="1968989">d</span><span class="op" id="1968990">.</span><span class="ident" id="1968991">dp</span>&nbsp;<span class="op" id="1968994">&gt;=</span>&nbsp;<span class="builtinfunc" id="1968997">len</span><span class="op" id="1969000">(</span><span class="ident" id="1969001">powtab</span><span class="op" id="1969007">)</span>&nbsp;<span class="op" id="1969009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969014">n</span>&nbsp;<span class="op" id="1969016">=</span>&nbsp;<span class="num" id="1969018">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969023">}</span>&nbsp;<span class="keyword" id="1969025">else</span>&nbsp;<span class="op" id="1969030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969035">n</span>&nbsp;<span class="op" id="1969037">=</span>&nbsp;<span class="ident" id="1969039">powtab</span><span class="op" id="1969045">[</span><span class="op" id="1969046">-</span><span class="ident" id="1969047">d</span><span class="op" id="1969048">.</span><span class="ident" id="1969049">dp</span><span class="op" id="1969051">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969059">d</span><span class="op" id="1969060">.</span><span class="ident" id="1969061">Shift</span><span class="op" id="1969066">(</span><span class="ident" id="1969067">n</span><span class="op" id="1969068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969072">exp</span>&nbsp;<span class="op" id="1969076">-=</span>&nbsp;<span class="ident" id="1969079">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969086">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969146">exp</span><span class="op" id="1969149">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969154">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969204">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969251">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969277">if</span>&nbsp;<span class="ident" id="1969280">exp</span>&nbsp;<span class="op" id="1969284">&lt;</span>&nbsp;<span class="ident" id="1969286">flt</span><span class="op" id="1969289">.</span><span class="ident" id="1969290">bias</span><span class="op" id="1969294">+</span><span class="num" id="1969295">1</span>&nbsp;<span class="op" id="1969297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969301">n</span>&nbsp;<span class="op" id="1969303">:=</span>&nbsp;<span class="ident" id="1969306">flt</span><span class="op" id="1969309">.</span><span class="ident" id="1969310">bias</span>&nbsp;<span class="op" id="1969315">+</span>&nbsp;<span class="num" id="1969317">1</span>&nbsp;<span class="op" id="1969319">-</span>&nbsp;<span class="ident" id="1969321">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969327">d</span><span class="op" id="1969328">.</span><span class="ident" id="1969329">Shift</span><span class="op" id="1969334">(</span><span class="op" id="1969335">-</span><span class="ident" id="1969336">n</span><span class="op" id="1969337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969341">exp</span>&nbsp;<span class="op" id="1969345">+=</span>&nbsp;<span class="ident" id="1969348">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969355">if</span>&nbsp;<span class="ident" id="1969358">exp</span><span class="op" id="1969361">-</span><span class="ident" id="1969362">flt</span><span class="op" id="1969365">.</span><span class="ident" id="1969366">bias</span>&nbsp;<span class="op" id="1969371">&gt;=</span>&nbsp;<span class="num" id="1969374">1</span><span class="op" id="1969375">&lt;&lt;</span><span class="ident" id="1969377">flt</span><span class="op" id="1969380">.</span><span class="ident" id="1969381">expbits</span><span class="op" id="1969388">-</span><span class="num" id="1969389">1</span>&nbsp;<span class="op" id="1969391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969395">goto</span>&nbsp;<span class="ident" id="1969400">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969410">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969414">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969447">d</span><span class="op" id="1969448">.</span><span class="ident" id="1969449">Shift</span><span class="op" id="1969454">(</span><span class="builtintype" id="1969455">int</span><span class="op" id="1969458">(</span><span class="num" id="1969459">1</span>&nbsp;<span class="op" id="1969461">+</span>&nbsp;<span class="ident" id="1969463">flt</span><span class="op" id="1969466">.</span><span class="ident" id="1969467">mantbits</span><span class="op" id="1969475">)</span><span class="op" id="1969476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969479">mant</span>&nbsp;<span class="op" id="1969484">=</span>&nbsp;<span class="ident" id="1969486">d</span><span class="op" id="1969487">.</span><span class="ident" id="1969488">RoundedInteger</span><span class="op" id="1969502">(</span><span class="op" id="1969503">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969507">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969556">if</span>&nbsp;<span class="ident" id="1969559">mant</span>&nbsp;<span class="op" id="1969564">==</span>&nbsp;<span class="num" id="1969567">2</span><span class="op" id="1969568">&lt;&lt;</span><span class="ident" id="1969570">flt</span><span class="op" id="1969573">.</span><span class="ident" id="1969574">mantbits</span>&nbsp;<span class="op" id="1969583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969587">mant</span>&nbsp;<span class="op" id="1969592">&gt;&gt;=</span>&nbsp;<span class="num" id="1969596">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969600">exp</span><span class="op" id="1969603">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969608">if</span>&nbsp;<span class="ident" id="1969611">exp</span><span class="op" id="1969614">-</span><span class="ident" id="1969615">flt</span><span class="op" id="1969618">.</span><span class="ident" id="1969619">bias</span>&nbsp;<span class="op" id="1969624">&gt;=</span>&nbsp;<span class="num" id="1969627">1</span><span class="op" id="1969628">&lt;&lt;</span><span class="ident" id="1969630">flt</span><span class="op" id="1969633">.</span><span class="ident" id="1969634">expbits</span><span class="op" id="1969641">-</span><span class="num" id="1969642">1</span>&nbsp;<span class="op" id="1969644">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969649">goto</span>&nbsp;<span class="ident" id="1969654">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969672">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969690">if</span>&nbsp;<span class="ident" id="1969693">mant</span><span class="op" id="1969697">&amp;</span><span class="op" id="1969698">(</span><span class="num" id="1969699">1</span><span class="op" id="1969700">&lt;&lt;</span><span class="ident" id="1969702">flt</span><span class="op" id="1969705">.</span><span class="ident" id="1969706">mantbits</span><span class="op" id="1969714">)</span>&nbsp;<span class="op" id="1969716">==</span>&nbsp;<span class="num" id="1969719">0</span>&nbsp;<span class="op" id="1969721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969725">exp</span>&nbsp;<span class="op" id="1969729">=</span>&nbsp;<span class="ident" id="1969731">flt</span><span class="op" id="1969734">.</span><span class="ident" id="1969735">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969744">goto</span>&nbsp;<span class="ident" id="1969749">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="1969754">overflow</span><span class="op" id="1969762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969765">//&nbsp;Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969775">mant</span>&nbsp;<span class="op" id="1969780">=</span>&nbsp;<span class="num" id="1969782">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969785">exp</span>&nbsp;<span class="op" id="1969789">=</span>&nbsp;<span class="num" id="1969791">1</span><span class="op" id="1969792">&lt;&lt;</span><span class="ident" id="1969794">flt</span><span class="op" id="1969797">.</span><span class="ident" id="1969798">expbits</span>&nbsp;<span class="op" id="1969806">-</span>&nbsp;<span class="num" id="1969808">1</span>&nbsp;<span class="op" id="1969810">+</span>&nbsp;<span class="ident" id="1969812">flt</span><span class="op" id="1969815">.</span><span class="ident" id="1969816">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969822">overflow</span>&nbsp;<span class="op" id="1969831">=</span>&nbsp;<span class="builtintype" id="1969833">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="1969839">out</span><span class="op" id="1969842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969845">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969864">bits</span>&nbsp;<span class="op" id="1969869">:=</span>&nbsp;<span class="ident" id="1969872">mant</span>&nbsp;<span class="op" id="1969877">&amp;</span>&nbsp;<span class="op" id="1969879">(</span><span class="ident" id="1969880">uint64</span><span class="op" id="1969886">(</span><span class="num" id="1969887">1</span><span class="op" id="1969888">)</span><span class="op" id="1969889">&lt;&lt;</span><span class="ident" id="1969891">flt</span><span class="op" id="1969894">.</span><span class="ident" id="1969895">mantbits</span>&nbsp;<span class="op" id="1969904">-</span>&nbsp;<span class="num" id="1969906">1</span><span class="op" id="1969907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969910">bits</span>&nbsp;<span class="op" id="1969915">|=</span>&nbsp;<span class="ident" id="1969918">uint64</span><span class="op" id="1969924">(</span><span class="op" id="1969925">(</span><span class="ident" id="1969926">exp</span><span class="op" id="1969929">-</span><span class="ident" id="1969930">flt</span><span class="op" id="1969933">.</span><span class="ident" id="1969934">bias</span><span class="op" id="1969938">)</span><span class="op" id="1969939">&amp;</span><span class="op" id="1969940">(</span><span class="num" id="1969941">1</span><span class="op" id="1969942">&lt;&lt;</span><span class="ident" id="1969944">flt</span><span class="op" id="1969947">.</span><span class="ident" id="1969948">expbits</span><span class="op" id="1969955">-</span><span class="num" id="1969956">1</span><span class="op" id="1969957">)</span><span class="op" id="1969958">)</span>&nbsp;<span class="op" id="1969960">&lt;&lt;</span>&nbsp;<span class="ident" id="1969963">flt</span><span class="op" id="1969966">.</span><span class="ident" id="1969967">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969977">if</span>&nbsp;<span class="ident" id="1969980">d</span><span class="op" id="1969981">.</span><span class="ident" id="1969982">neg</span>&nbsp;<span class="op" id="1969986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969990">bits</span>&nbsp;<span class="op" id="1969995">|=</span>&nbsp;<span class="num" id="1969998">1</span>&nbsp;<span class="op" id="1970000">&lt;&lt;</span>&nbsp;<span class="ident" id="1970003">flt</span><span class="op" id="1970006">.</span><span class="ident" id="1970007">mantbits</span>&nbsp;<span class="op" id="1970016">&lt;&lt;</span>&nbsp;<span class="ident" id="1970019">flt</span><span class="op" id="1970022">.</span><span class="ident" id="1970023">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970035">return</span>&nbsp;<span class="ident" id="1970042">bits</span><span class="op" id="1970046">,</span>&nbsp;<span class="ident" id="1970048">overflow</span><br>
<span class="lineno"></span><span class="op" id="1970057">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="1970060">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="1970083">var</span>&nbsp;<span class="ident" id="1970087">float64pow10</span>&nbsp;<span class="op" id="1970100">=</span>&nbsp;<span class="op" id="1970102">[</span><span class="op" id="1970103">]</span><span class="builtintype" id="1970104">float64</span><span class="op" id="1970111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1970114">1e0</span><span class="op" id="1970117">,</span>&nbsp;<span class="num" id="1970119">1e1</span><span class="op" id="1970122">,</span>&nbsp;<span class="num" id="1970124">1e2</span><span class="op" id="1970127">,</span>&nbsp;<span class="num" id="1970129">1e3</span><span class="op" id="1970132">,</span>&nbsp;<span class="num" id="1970134">1e4</span><span class="op" id="1970137">,</span>&nbsp;<span class="num" id="1970139">1e5</span><span class="op" id="1970142">,</span>&nbsp;<span class="num" id="1970144">1e6</span><span class="op" id="1970147">,</span>&nbsp;<span class="num" id="1970149">1e7</span><span class="op" id="1970152">,</span>&nbsp;<span class="num" id="1970154">1e8</span><span class="op" id="1970157">,</span>&nbsp;<span class="num" id="1970159">1e9</span><span class="op" id="1970162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1970165">1e10</span><span class="op" id="1970169">,</span>&nbsp;<span class="num" id="1970171">1e11</span><span class="op" id="1970175">,</span>&nbsp;<span class="num" id="1970177">1e12</span><span class="op" id="1970181">,</span>&nbsp;<span class="num" id="1970183">1e13</span><span class="op" id="1970187">,</span>&nbsp;<span class="num" id="1970189">1e14</span><span class="op" id="1970193">,</span>&nbsp;<span class="num" id="1970195">1e15</span><span class="op" id="1970199">,</span>&nbsp;<span class="num" id="1970201">1e16</span><span class="op" id="1970205">,</span>&nbsp;<span class="num" id="1970207">1e17</span><span class="op" id="1970211">,</span>&nbsp;<span class="num" id="1970213">1e18</span><span class="op" id="1970217">,</span>&nbsp;<span class="num" id="1970219">1e19</span><span class="op" id="1970223">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1970226">1e20</span><span class="op" id="1970230">,</span>&nbsp;<span class="num" id="1970232">1e21</span><span class="op" id="1970236">,</span>&nbsp;<span class="num" id="1970238">1e22</span><span class="op" id="1970242">,</span><br>
<span class="lineno"></span><span class="op" id="1970244">}</span><br>
<span class="lineno"></span><span class="keyword" id="1970246">var</span>&nbsp;<span class="ident" id="1970250">float32pow10</span>&nbsp;<span class="op" id="1970263">=</span>&nbsp;<span class="op" id="1970265">[</span><span class="op" id="1970266">]</span><span class="builtintype" id="1970267">float32</span><span class="op" id="1970274">{</span><span class="num" id="1970275">1e0</span><span class="op" id="1970278">,</span>&nbsp;<span class="num" id="1970280">1e1</span><span class="op" id="1970283">,</span>&nbsp;<span class="num" id="1970285">1e2</span><span class="op" id="1970288">,</span>&nbsp;<span class="num" id="1970290">1e3</span><span class="op" id="1970293">,</span>&nbsp;<span class="num" id="1970295">1e4</span><span class="op" id="1970298">,</span>&nbsp;<span class="num" id="1970300">1e5</span><span class="op" id="1970303">,</span>&nbsp;<span class="num" id="1970305">1e6</span><span class="op" id="1970308">,</span>&nbsp;<span class="num" id="1970310">1e7</span><span class="op" id="1970313">,</span>&nbsp;<span class="num" id="1970315">1e8</span><span class="op" id="1970318">,</span>&nbsp;<span class="num" id="1970320">1e9</span><span class="op" id="1970323">,</span>&nbsp;<span class="num" id="1970325">1e10</span><span class="op" id="1970329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1970332">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="1970408">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="1970495">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1970518">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="1970544">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="1970591">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="1970638">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="1970710">func</span>&nbsp;<span class="ident" id="1970715">atof64exact</span><span class="op" id="1970726">(</span><span class="ident" id="1970727">mantissa</span>&nbsp;<span class="ident" id="1970736">uint64</span><span class="op" id="1970742">,</span>&nbsp;<span class="ident" id="1970744">exp</span>&nbsp;<span class="builtintype" id="1970748">int</span><span class="op" id="1970751">,</span>&nbsp;<span class="ident" id="1970753">neg</span>&nbsp;<span class="builtintype" id="1970757">bool</span><span class="op" id="1970761">)</span>&nbsp;<span class="op" id="1970763">(</span><span class="ident" id="1970764">f</span>&nbsp;<span class="builtintype" id="1970766">float64</span><span class="op" id="1970773">,</span>&nbsp;<span class="ident" id="1970775">ok</span>&nbsp;<span class="builtintype" id="1970778">bool</span><span class="op" id="1970782">)</span>&nbsp;<span class="op" id="1970784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970787">if</span>&nbsp;<span class="ident" id="1970790">mantissa</span><span class="op" id="1970798">&gt;&gt;</span><span class="ident" id="1970800">float64info</span><span class="op" id="1970811">.</span><span class="ident" id="1970812">mantbits</span>&nbsp;<span class="op" id="1970821">!=</span>&nbsp;<span class="num" id="1970824">0</span>&nbsp;<span class="op" id="1970826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970830">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970838">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970841">f</span>&nbsp;<span class="op" id="1970843">=</span>&nbsp;<span class="builtintype" id="1970845">float64</span><span class="op" id="1970852">(</span><span class="ident" id="1970853">mantissa</span><span class="op" id="1970861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970864">if</span>&nbsp;<span class="ident" id="1970867">neg</span>&nbsp;<span class="op" id="1970871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970875">f</span>&nbsp;<span class="op" id="1970877">=</span>&nbsp;<span class="op" id="1970879">-</span><span class="ident" id="1970880">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970886">switch</span>&nbsp;<span class="op" id="1970893">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970896">case</span>&nbsp;<span class="ident" id="1970901">exp</span>&nbsp;<span class="op" id="1970905">==</span>&nbsp;<span class="num" id="1970908">0</span><span class="op" id="1970909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1970913">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970930">return</span>&nbsp;<span class="ident" id="1970937">f</span><span class="op" id="1970938">,</span>&nbsp;<span class="builtintype" id="1970940">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1970946">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1970979">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971017">case</span>&nbsp;<span class="ident" id="1971022">exp</span>&nbsp;<span class="op" id="1971026">&gt;</span>&nbsp;<span class="num" id="1971028">0</span>&nbsp;<span class="op" id="1971030">&amp;&amp;</span>&nbsp;<span class="ident" id="1971033">exp</span>&nbsp;<span class="op" id="1971037">&lt;=</span>&nbsp;<span class="num" id="1971040">15</span><span class="op" id="1971042">+</span><span class="num" id="1971043">22</span><span class="op" id="1971045">:</span>&nbsp;<span class="comment" id="1971047">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971063">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971116">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971165">if</span>&nbsp;<span class="ident" id="1971168">exp</span>&nbsp;<span class="op" id="1971172">&gt;</span>&nbsp;<span class="num" id="1971174">22</span>&nbsp;<span class="op" id="1971177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971182">f</span>&nbsp;<span class="op" id="1971184">*=</span>&nbsp;<span class="ident" id="1971187">float64pow10</span><span class="op" id="1971199">[</span><span class="ident" id="1971200">exp</span><span class="op" id="1971203">-</span><span class="num" id="1971204">22</span><span class="op" id="1971206">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971211">exp</span>&nbsp;<span class="op" id="1971215">=</span>&nbsp;<span class="num" id="1971217">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1971222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971226">if</span>&nbsp;<span class="ident" id="1971229">f</span>&nbsp;<span class="op" id="1971231">&gt;</span>&nbsp;<span class="num" id="1971233">1e15</span>&nbsp;<span class="op" id="1971238">||</span>&nbsp;<span class="ident" id="1971241">f</span>&nbsp;<span class="op" id="1971243">&lt;</span>&nbsp;<span class="op" id="1971245">-</span><span class="num" id="1971246">1e15</span>&nbsp;<span class="op" id="1971251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971256">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971297">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1971306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971310">return</span>&nbsp;<span class="ident" id="1971317">f</span>&nbsp;<span class="op" id="1971319">*</span>&nbsp;<span class="ident" id="1971321">float64pow10</span><span class="op" id="1971333">[</span><span class="ident" id="1971334">exp</span><span class="op" id="1971337">]</span><span class="op" id="1971338">,</span>&nbsp;<span class="builtintype" id="1971340">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971346">case</span>&nbsp;<span class="ident" id="1971351">exp</span>&nbsp;<span class="op" id="1971355">&lt;</span>&nbsp;<span class="num" id="1971357">0</span>&nbsp;<span class="op" id="1971359">&amp;&amp;</span>&nbsp;<span class="ident" id="1971362">exp</span>&nbsp;<span class="op" id="1971366">&gt;=</span>&nbsp;<span class="op" id="1971369">-</span><span class="num" id="1971370">22</span><span class="op" id="1971372">:</span>&nbsp;<span class="comment" id="1971374">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971390">return</span>&nbsp;<span class="ident" id="1971397">f</span>&nbsp;<span class="op" id="1971399">/</span>&nbsp;<span class="ident" id="1971401">float64pow10</span><span class="op" id="1971413">[</span><span class="op" id="1971414">-</span><span class="ident" id="1971415">exp</span><span class="op" id="1971418">]</span><span class="op" id="1971419">,</span>&nbsp;<span class="builtintype" id="1971421">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1971427">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971430">return</span><br>
<span class="lineno"></span><span class="op" id="1971437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1971440">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="1971509">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="1971582">func</span>&nbsp;<span class="ident" id="1971587">atof32exact</span><span class="op" id="1971598">(</span><span class="ident" id="1971599">mantissa</span>&nbsp;<span class="ident" id="1971608">uint64</span><span class="op" id="1971614">,</span>&nbsp;<span class="ident" id="1971616">exp</span>&nbsp;<span class="builtintype" id="1971620">int</span><span class="op" id="1971623">,</span>&nbsp;<span class="ident" id="1971625">neg</span>&nbsp;<span class="builtintype" id="1971629">bool</span><span class="op" id="1971633">)</span>&nbsp;<span class="op" id="1971635">(</span><span class="ident" id="1971636">f</span>&nbsp;<span class="builtintype" id="1971638">float32</span><span class="op" id="1971645">,</span>&nbsp;<span class="ident" id="1971647">ok</span>&nbsp;<span class="builtintype" id="1971650">bool</span><span class="op" id="1971654">)</span>&nbsp;<span class="op" id="1971656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971659">if</span>&nbsp;<span class="ident" id="1971662">mantissa</span><span class="op" id="1971670">&gt;&gt;</span><span class="ident" id="1971672">float32info</span><span class="op" id="1971683">.</span><span class="ident" id="1971684">mantbits</span>&nbsp;<span class="op" id="1971693">!=</span>&nbsp;<span class="num" id="1971696">0</span>&nbsp;<span class="op" id="1971698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971702">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1971710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971713">f</span>&nbsp;<span class="op" id="1971715">=</span>&nbsp;<span class="builtintype" id="1971717">float32</span><span class="op" id="1971724">(</span><span class="ident" id="1971725">mantissa</span><span class="op" id="1971733">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971736">if</span>&nbsp;<span class="ident" id="1971739">neg</span>&nbsp;<span class="op" id="1971743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971747">f</span>&nbsp;<span class="op" id="1971749">=</span>&nbsp;<span class="op" id="1971751">-</span><span class="ident" id="1971752">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1971755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971758">switch</span>&nbsp;<span class="op" id="1971765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971768">case</span>&nbsp;<span class="ident" id="1971773">exp</span>&nbsp;<span class="op" id="1971777">==</span>&nbsp;<span class="num" id="1971780">0</span><span class="op" id="1971781">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971785">return</span>&nbsp;<span class="ident" id="1971792">f</span><span class="op" id="1971793">,</span>&nbsp;<span class="builtintype" id="1971795">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971801">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971833">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971871">case</span>&nbsp;<span class="ident" id="1971876">exp</span>&nbsp;<span class="op" id="1971880">&gt;</span>&nbsp;<span class="num" id="1971882">0</span>&nbsp;<span class="op" id="1971884">&amp;&amp;</span>&nbsp;<span class="ident" id="1971887">exp</span>&nbsp;<span class="op" id="1971891">&lt;=</span>&nbsp;<span class="num" id="1971894">7</span><span class="op" id="1971895">+</span><span class="num" id="1971896">10</span><span class="op" id="1971898">:</span>&nbsp;<span class="comment" id="1971900">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971916">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971969">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972018">if</span>&nbsp;<span class="ident" id="1972021">exp</span>&nbsp;<span class="op" id="1972025">&gt;</span>&nbsp;<span class="num" id="1972027">10</span>&nbsp;<span class="op" id="1972030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972035">f</span>&nbsp;<span class="op" id="1972037">*=</span>&nbsp;<span class="ident" id="1972040">float32pow10</span><span class="op" id="1972052">[</span><span class="ident" id="1972053">exp</span><span class="op" id="1972056">-</span><span class="num" id="1972057">10</span><span class="op" id="1972059">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972064">exp</span>&nbsp;<span class="op" id="1972068">=</span>&nbsp;<span class="num" id="1972070">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972075">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972079">if</span>&nbsp;<span class="ident" id="1972082">f</span>&nbsp;<span class="op" id="1972084">&gt;</span>&nbsp;<span class="num" id="1972086">1e7</span>&nbsp;<span class="op" id="1972090">||</span>&nbsp;<span class="ident" id="1972093">f</span>&nbsp;<span class="op" id="1972095">&lt;</span>&nbsp;<span class="op" id="1972097">-</span><span class="num" id="1972098">1e7</span>&nbsp;<span class="op" id="1972102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972107">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972148">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972161">return</span>&nbsp;<span class="ident" id="1972168">f</span>&nbsp;<span class="op" id="1972170">*</span>&nbsp;<span class="ident" id="1972172">float32pow10</span><span class="op" id="1972184">[</span><span class="ident" id="1972185">exp</span><span class="op" id="1972188">]</span><span class="op" id="1972189">,</span>&nbsp;<span class="builtintype" id="1972191">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972197">case</span>&nbsp;<span class="ident" id="1972202">exp</span>&nbsp;<span class="op" id="1972206">&lt;</span>&nbsp;<span class="num" id="1972208">0</span>&nbsp;<span class="op" id="1972210">&amp;&amp;</span>&nbsp;<span class="ident" id="1972213">exp</span>&nbsp;<span class="op" id="1972217">&gt;=</span>&nbsp;<span class="op" id="1972220">-</span><span class="num" id="1972221">10</span><span class="op" id="1972223">:</span>&nbsp;<span class="comment" id="1972225">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972241">return</span>&nbsp;<span class="ident" id="1972248">f</span>&nbsp;<span class="op" id="1972250">/</span>&nbsp;<span class="ident" id="1972252">float32pow10</span><span class="op" id="1972264">[</span><span class="op" id="1972265">-</span><span class="ident" id="1972266">exp</span><span class="op" id="1972269">]</span><span class="op" id="1972270">,</span>&nbsp;<span class="builtintype" id="1972272">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972281">return</span><br>
<span class="lineno"></span><span class="op" id="1972288">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="1972291">const</span>&nbsp;<span class="ident" id="1972297">fnParseFloat</span>&nbsp;<span class="op" id="1972310">=</span>&nbsp;<span class="string" id="1972312">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1972326">func</span>&nbsp;<span class="ident" id="1972331">atof32</span><span class="op" id="1972337">(</span><span class="ident" id="1972338">s</span>&nbsp;<span class="builtintype" id="1972340">string</span><span class="op" id="1972346">)</span>&nbsp;<span class="op" id="1972348">(</span><span class="ident" id="1972349">f</span>&nbsp;<span class="builtintype" id="1972351">float32</span><span class="op" id="1972358">,</span>&nbsp;<span class="ident" id="1972360">err</span>&nbsp;<span class="builtintype" id="1972364">error</span><span class="op" id="1972369">)</span>&nbsp;<span class="op" id="1972371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972374">if</span>&nbsp;<span class="ident" id="1972377">val</span><span class="op" id="1972380">,</span>&nbsp;<span class="ident" id="1972382">ok</span>&nbsp;<span class="op" id="1972385">:=</span>&nbsp;<span class="ident" id="1972388">special</span><span class="op" id="1972395">(</span><span class="ident" id="1972396">s</span><span class="op" id="1972397">)</span><span class="op" id="1972398">;</span>&nbsp;<span class="ident" id="1972400">ok</span>&nbsp;<span class="op" id="1972403">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972407">return</span>&nbsp;<span class="builtintype" id="1972414">float32</span><span class="op" id="1972421">(</span><span class="ident" id="1972422">val</span><span class="op" id="1972425">)</span><span class="op" id="1972426">,</span>&nbsp;<span class="ident" id="1972428">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972437">if</span>&nbsp;<span class="ident" id="1972440">optimize</span>&nbsp;<span class="op" id="1972449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972453">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972487">mantissa</span><span class="op" id="1972495">,</span>&nbsp;<span class="ident" id="1972497">exp</span><span class="op" id="1972500">,</span>&nbsp;<span class="ident" id="1972502">neg</span><span class="op" id="1972505">,</span>&nbsp;<span class="ident" id="1972507">trunc</span><span class="op" id="1972512">,</span>&nbsp;<span class="ident" id="1972514">ok</span>&nbsp;<span class="op" id="1972517">:=</span>&nbsp;<span class="ident" id="1972520">readFloat</span><span class="op" id="1972529">(</span><span class="ident" id="1972530">s</span><span class="op" id="1972531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972535">if</span>&nbsp;<span class="ident" id="1972538">ok</span>&nbsp;<span class="op" id="1972541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972546">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972599">if</span>&nbsp;<span class="op" id="1972602">!</span><span class="ident" id="1972603">trunc</span>&nbsp;<span class="op" id="1972609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972615">if</span>&nbsp;<span class="ident" id="1972618">f</span><span class="op" id="1972619">,</span>&nbsp;<span class="ident" id="1972621">ok</span>&nbsp;<span class="op" id="1972624">:=</span>&nbsp;<span class="ident" id="1972627">atof32exact</span><span class="op" id="1972638">(</span><span class="ident" id="1972639">mantissa</span><span class="op" id="1972647">,</span>&nbsp;<span class="ident" id="1972649">exp</span><span class="op" id="1972652">,</span>&nbsp;<span class="ident" id="1972654">neg</span><span class="op" id="1972657">)</span><span class="op" id="1972658">;</span>&nbsp;<span class="ident" id="1972660">ok</span>&nbsp;<span class="op" id="1972663">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972670">return</span>&nbsp;<span class="ident" id="1972677">f</span><span class="op" id="1972678">,</span>&nbsp;<span class="ident" id="1972680">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972698">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972727">ext</span>&nbsp;<span class="op" id="1972731">:=</span>&nbsp;<span class="builtinfunc" id="1972734">new</span><span class="op" id="1972737">(</span><span class="ident" id="1972738">extFloat</span><span class="op" id="1972746">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972751">if</span>&nbsp;<span class="ident" id="1972754">ok</span>&nbsp;<span class="op" id="1972757">:=</span>&nbsp;<span class="ident" id="1972760">ext</span><span class="op" id="1972763">.</span><span class="ident" id="1972764">AssignDecimal</span><span class="op" id="1972777">(</span><span class="ident" id="1972778">mantissa</span><span class="op" id="1972786">,</span>&nbsp;<span class="ident" id="1972788">exp</span><span class="op" id="1972791">,</span>&nbsp;<span class="ident" id="1972793">neg</span><span class="op" id="1972796">,</span>&nbsp;<span class="ident" id="1972798">trunc</span><span class="op" id="1972803">,</span>&nbsp;<span class="op" id="1972805">&amp;</span><span class="ident" id="1972806">float32info</span><span class="op" id="1972817">)</span><span class="op" id="1972818">;</span>&nbsp;<span class="ident" id="1972820">ok</span>&nbsp;<span class="op" id="1972823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972829">b</span><span class="op" id="1972830">,</span>&nbsp;<span class="ident" id="1972832">ovf</span>&nbsp;<span class="op" id="1972836">:=</span>&nbsp;<span class="ident" id="1972839">ext</span><span class="op" id="1972842">.</span><span class="ident" id="1972843">floatBits</span><span class="op" id="1972852">(</span><span class="op" id="1972853">&amp;</span><span class="ident" id="1972854">float32info</span><span class="op" id="1972865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972871">f</span>&nbsp;<span class="op" id="1972873">=</span>&nbsp;<span class="ident" id="1972875">math</span><span class="op" id="1972879">.</span><span class="ident" id="1972880">Float32frombits</span><span class="op" id="1972895">(</span><span class="builtintype" id="1972896">uint32</span><span class="op" id="1972902">(</span><span class="ident" id="1972903">b</span><span class="op" id="1972904">)</span><span class="op" id="1972905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972911">if</span>&nbsp;<span class="ident" id="1972914">ovf</span>&nbsp;<span class="op" id="1972918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972925">err</span>&nbsp;<span class="op" id="1972929">=</span>&nbsp;<span class="ident" id="1972931">rangeError</span><span class="op" id="1972941">(</span><span class="ident" id="1972942">fnParseFloat</span><span class="op" id="1972954">,</span>&nbsp;<span class="ident" id="1972956">s</span><span class="op" id="1972957">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972969">return</span>&nbsp;<span class="ident" id="1972976">f</span><span class="op" id="1972977">,</span>&nbsp;<span class="ident" id="1972979">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972993">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972996">var</span>&nbsp;<span class="ident" id="1973000">d</span>&nbsp;<span class="ident" id="1973002">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973011">if</span>&nbsp;<span class="op" id="1973014">!</span><span class="ident" id="1973015">d</span><span class="op" id="1973016">.</span><span class="ident" id="1973017">set</span><span class="op" id="1973020">(</span><span class="ident" id="1973021">s</span><span class="op" id="1973022">)</span>&nbsp;<span class="op" id="1973024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973028">return</span>&nbsp;<span class="num" id="1973035">0</span><span class="op" id="1973036">,</span>&nbsp;<span class="ident" id="1973038">syntaxError</span><span class="op" id="1973049">(</span><span class="ident" id="1973050">fnParseFloat</span><span class="op" id="1973062">,</span>&nbsp;<span class="ident" id="1973064">s</span><span class="op" id="1973065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973071">b</span><span class="op" id="1973072">,</span>&nbsp;<span class="ident" id="1973074">ovf</span>&nbsp;<span class="op" id="1973078">:=</span>&nbsp;<span class="ident" id="1973081">d</span><span class="op" id="1973082">.</span><span class="ident" id="1973083">floatBits</span><span class="op" id="1973092">(</span><span class="op" id="1973093">&amp;</span><span class="ident" id="1973094">float32info</span><span class="op" id="1973105">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973108">f</span>&nbsp;<span class="op" id="1973110">=</span>&nbsp;<span class="ident" id="1973112">math</span><span class="op" id="1973116">.</span><span class="ident" id="1973117">Float32frombits</span><span class="op" id="1973132">(</span><span class="builtintype" id="1973133">uint32</span><span class="op" id="1973139">(</span><span class="ident" id="1973140">b</span><span class="op" id="1973141">)</span><span class="op" id="1973142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973145">if</span>&nbsp;<span class="ident" id="1973148">ovf</span>&nbsp;<span class="op" id="1973152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973156">err</span>&nbsp;<span class="op" id="1973160">=</span>&nbsp;<span class="ident" id="1973162">rangeError</span><span class="op" id="1973172">(</span><span class="ident" id="1973173">fnParseFloat</span><span class="op" id="1973185">,</span>&nbsp;<span class="ident" id="1973187">s</span><span class="op" id="1973188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973194">return</span>&nbsp;<span class="ident" id="1973201">f</span><span class="op" id="1973202">,</span>&nbsp;<span class="ident" id="1973204">err</span><br>
<span class="lineno">475</span><span class="op" id="1973208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1973211">func</span>&nbsp;<span class="ident" id="1973216">atof64</span><span class="op" id="1973222">(</span><span class="ident" id="1973223">s</span>&nbsp;<span class="builtintype" id="1973225">string</span><span class="op" id="1973231">)</span>&nbsp;<span class="op" id="1973233">(</span><span class="ident" id="1973234">f</span>&nbsp;<span class="builtintype" id="1973236">float64</span><span class="op" id="1973243">,</span>&nbsp;<span class="ident" id="1973245">err</span>&nbsp;<span class="builtintype" id="1973249">error</span><span class="op" id="1973254">)</span>&nbsp;<span class="op" id="1973256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973259">if</span>&nbsp;<span class="ident" id="1973262">val</span><span class="op" id="1973265">,</span>&nbsp;<span class="ident" id="1973267">ok</span>&nbsp;<span class="op" id="1973270">:=</span>&nbsp;<span class="ident" id="1973273">special</span><span class="op" id="1973280">(</span><span class="ident" id="1973281">s</span><span class="op" id="1973282">)</span><span class="op" id="1973283">;</span>&nbsp;<span class="ident" id="1973285">ok</span>&nbsp;<span class="op" id="1973288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973292">return</span>&nbsp;<span class="ident" id="1973299">val</span><span class="op" id="1973302">,</span>&nbsp;<span class="ident" id="1973304">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973313">if</span>&nbsp;<span class="ident" id="1973316">optimize</span>&nbsp;<span class="op" id="1973325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973329">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973363">mantissa</span><span class="op" id="1973371">,</span>&nbsp;<span class="ident" id="1973373">exp</span><span class="op" id="1973376">,</span>&nbsp;<span class="ident" id="1973378">neg</span><span class="op" id="1973381">,</span>&nbsp;<span class="ident" id="1973383">trunc</span><span class="op" id="1973388">,</span>&nbsp;<span class="ident" id="1973390">ok</span>&nbsp;<span class="op" id="1973393">:=</span>&nbsp;<span class="ident" id="1973396">readFloat</span><span class="op" id="1973405">(</span><span class="ident" id="1973406">s</span><span class="op" id="1973407">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973411">if</span>&nbsp;<span class="ident" id="1973414">ok</span>&nbsp;<span class="op" id="1973417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973422">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973475">if</span>&nbsp;<span class="op" id="1973478">!</span><span class="ident" id="1973479">trunc</span>&nbsp;<span class="op" id="1973485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973491">if</span>&nbsp;<span class="ident" id="1973494">f</span><span class="op" id="1973495">,</span>&nbsp;<span class="ident" id="1973497">ok</span>&nbsp;<span class="op" id="1973500">:=</span>&nbsp;<span class="ident" id="1973503">atof64exact</span><span class="op" id="1973514">(</span><span class="ident" id="1973515">mantissa</span><span class="op" id="1973523">,</span>&nbsp;<span class="ident" id="1973525">exp</span><span class="op" id="1973528">,</span>&nbsp;<span class="ident" id="1973530">neg</span><span class="op" id="1973533">)</span><span class="op" id="1973534">;</span>&nbsp;<span class="ident" id="1973536">ok</span>&nbsp;<span class="op" id="1973539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973546">return</span>&nbsp;<span class="ident" id="1973553">f</span><span class="op" id="1973554">,</span>&nbsp;<span class="ident" id="1973556">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973574">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973603">ext</span>&nbsp;<span class="op" id="1973607">:=</span>&nbsp;<span class="builtinfunc" id="1973610">new</span><span class="op" id="1973613">(</span><span class="ident" id="1973614">extFloat</span><span class="op" id="1973622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973627">if</span>&nbsp;<span class="ident" id="1973630">ok</span>&nbsp;<span class="op" id="1973633">:=</span>&nbsp;<span class="ident" id="1973636">ext</span><span class="op" id="1973639">.</span><span class="ident" id="1973640">AssignDecimal</span><span class="op" id="1973653">(</span><span class="ident" id="1973654">mantissa</span><span class="op" id="1973662">,</span>&nbsp;<span class="ident" id="1973664">exp</span><span class="op" id="1973667">,</span>&nbsp;<span class="ident" id="1973669">neg</span><span class="op" id="1973672">,</span>&nbsp;<span class="ident" id="1973674">trunc</span><span class="op" id="1973679">,</span>&nbsp;<span class="op" id="1973681">&amp;</span><span class="ident" id="1973682">float64info</span><span class="op" id="1973693">)</span><span class="op" id="1973694">;</span>&nbsp;<span class="ident" id="1973696">ok</span>&nbsp;<span class="op" id="1973699">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973705">b</span><span class="op" id="1973706">,</span>&nbsp;<span class="ident" id="1973708">ovf</span>&nbsp;<span class="op" id="1973712">:=</span>&nbsp;<span class="ident" id="1973715">ext</span><span class="op" id="1973718">.</span><span class="ident" id="1973719">floatBits</span><span class="op" id="1973728">(</span><span class="op" id="1973729">&amp;</span><span class="ident" id="1973730">float64info</span><span class="op" id="1973741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973747">f</span>&nbsp;<span class="op" id="1973749">=</span>&nbsp;<span class="ident" id="1973751">math</span><span class="op" id="1973755">.</span><span class="ident" id="1973756">Float64frombits</span><span class="op" id="1973771">(</span><span class="ident" id="1973772">b</span><span class="op" id="1973773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973779">if</span>&nbsp;<span class="ident" id="1973782">ovf</span>&nbsp;<span class="op" id="1973786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973793">err</span>&nbsp;<span class="op" id="1973797">=</span>&nbsp;<span class="ident" id="1973799">rangeError</span><span class="op" id="1973809">(</span><span class="ident" id="1973810">fnParseFloat</span><span class="op" id="1973822">,</span>&nbsp;<span class="ident" id="1973824">s</span><span class="op" id="1973825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973831">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973837">return</span>&nbsp;<span class="ident" id="1973844">f</span><span class="op" id="1973845">,</span>&nbsp;<span class="ident" id="1973847">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973864">var</span>&nbsp;<span class="ident" id="1973868">d</span>&nbsp;<span class="ident" id="1973870">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973879">if</span>&nbsp;<span class="op" id="1973882">!</span><span class="ident" id="1973883">d</span><span class="op" id="1973884">.</span><span class="ident" id="1973885">set</span><span class="op" id="1973888">(</span><span class="ident" id="1973889">s</span><span class="op" id="1973890">)</span>&nbsp;<span class="op" id="1973892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973896">return</span>&nbsp;<span class="num" id="1973903">0</span><span class="op" id="1973904">,</span>&nbsp;<span class="ident" id="1973906">syntaxError</span><span class="op" id="1973917">(</span><span class="ident" id="1973918">fnParseFloat</span><span class="op" id="1973930">,</span>&nbsp;<span class="ident" id="1973932">s</span><span class="op" id="1973933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973939">b</span><span class="op" id="1973940">,</span>&nbsp;<span class="ident" id="1973942">ovf</span>&nbsp;<span class="op" id="1973946">:=</span>&nbsp;<span class="ident" id="1973949">d</span><span class="op" id="1973950">.</span><span class="ident" id="1973951">floatBits</span><span class="op" id="1973960">(</span><span class="op" id="1973961">&amp;</span><span class="ident" id="1973962">float64info</span><span class="op" id="1973973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973976">f</span>&nbsp;<span class="op" id="1973978">=</span>&nbsp;<span class="ident" id="1973980">math</span><span class="op" id="1973984">.</span><span class="ident" id="1973985">Float64frombits</span><span class="op" id="1974000">(</span><span class="ident" id="1974001">b</span><span class="op" id="1974002">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974005">if</span>&nbsp;<span class="ident" id="1974008">ovf</span>&nbsp;<span class="op" id="1974012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974016">err</span>&nbsp;<span class="op" id="1974020">=</span>&nbsp;<span class="ident" id="1974022">rangeError</span><span class="op" id="1974032">(</span><span class="ident" id="1974033">fnParseFloat</span><span class="op" id="1974045">,</span>&nbsp;<span class="ident" id="1974047">s</span><span class="op" id="1974048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974054">return</span>&nbsp;<span class="ident" id="1974061">f</span><span class="op" id="1974062">,</span>&nbsp;<span class="ident" id="1974064">err</span><br>
<span class="lineno"></span><span class="op" id="1974068">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="1974071">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="1974134">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="1974213">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="1974283">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="1974337">//</span><br>
<span class="lineno"></span><span class="comment" id="1974340">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="1974403">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="1974467">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="1974503">//</span><br>
<span class="lineno">525</span><span class="comment" id="1974506">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="1974573">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="1974601">//</span><br>
<span class="lineno"></span><span class="comment" id="1974604">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="1974686">//</span><br>
<span class="lineno">530</span><span class="comment" id="1974689">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="1974751">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="1974817">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="1974870">func</span>&nbsp;<span class="ident" id="1974875">ParseFloat</span><span class="op" id="1974885">(</span><span class="ident" id="1974886">s</span>&nbsp;<span class="builtintype" id="1974888">string</span><span class="op" id="1974894">,</span>&nbsp;<span class="ident" id="1974896">bitSize</span>&nbsp;<span class="builtintype" id="1974904">int</span><span class="op" id="1974907">)</span>&nbsp;<span class="op" id="1974909">(</span><span class="ident" id="1974910">f</span>&nbsp;<span class="builtintype" id="1974912">float64</span><span class="op" id="1974919">,</span>&nbsp;<span class="ident" id="1974921">err</span>&nbsp;<span class="builtintype" id="1974925">error</span><span class="op" id="1974930">)</span>&nbsp;<span class="op" id="1974932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974935">if</span>&nbsp;<span class="ident" id="1974938">bitSize</span>&nbsp;<span class="op" id="1974946">==</span>&nbsp;<span class="num" id="1974949">32</span>&nbsp;<span class="op" id="1974952">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974956">f1</span><span class="op" id="1974958">,</span>&nbsp;<span class="ident" id="1974960">err1</span>&nbsp;<span class="op" id="1974965">:=</span>&nbsp;<span class="ident" id="1974968">atof32</span><span class="op" id="1974974">(</span><span class="ident" id="1974975">s</span><span class="op" id="1974976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974980">return</span>&nbsp;<span class="builtintype" id="1974987">float64</span><span class="op" id="1974994">(</span><span class="ident" id="1974995">f1</span><span class="op" id="1974997">)</span><span class="op" id="1974998">,</span>&nbsp;<span class="ident" id="1975000">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975009">f1</span><span class="op" id="1975011">,</span>&nbsp;<span class="ident" id="1975013">err1</span>&nbsp;<span class="op" id="1975018">:=</span>&nbsp;<span class="ident" id="1975021">atof64</span><span class="op" id="1975027">(</span><span class="ident" id="1975028">s</span><span class="op" id="1975029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975032">return</span>&nbsp;<span class="ident" id="1975039">f1</span><span class="op" id="1975041">,</span>&nbsp;<span class="ident" id="1975043">err1</span><br>
<span class="lineno">540</span><span class="op" id="1975048">}</span>
</div>
</body>
</html>
