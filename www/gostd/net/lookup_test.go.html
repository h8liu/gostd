<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8427143">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8427198">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8427252">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8427303">//&nbsp;TODO&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;use&nbsp;a&nbsp;mock&nbsp;DNS&nbsp;server,&nbsp;to&nbsp;eliminate</span><br>
<span class="lineno"></span><span class="comment" id="8427367">//&nbsp;external&nbsp;dependencies.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8427394">package</span>&nbsp;<span class="ident" id="8427402">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="8427407">import</span>&nbsp;<span class="op" id="8427414">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8427417">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8427425">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8427436">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8427446">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8427449">var</span>&nbsp;<span class="ident" id="8427453">testExternal</span>&nbsp;<span class="op" id="8427466">=</span>&nbsp;<span class="ident" id="8427468">flag</span><span class="op" id="8427472">.</span><span class="ident" id="8427473">Bool</span><span class="op" id="8427477">(</span><span class="string" id="8427478">&#34;external&#34;</span><span class="op" id="8427488">,</span>&nbsp;<span class="builtintype" id="8427490">true</span><span class="op" id="8427494">,</span>&nbsp;<span class="string" id="8427496">&#34;allow&nbsp;use&nbsp;of&nbsp;external&nbsp;networks&nbsp;during&nbsp;long&nbsp;test&#34;</span><span class="op" id="8427545">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8427548">var</span>&nbsp;<span class="ident" id="8427552">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="8427573">=</span>&nbsp;<span class="op" id="8427575">[</span><span class="op" id="8427576">]</span><span class="keyword" id="8427577">struct</span>&nbsp;<span class="op" id="8427584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8427587">service</span><span class="op" id="8427594">,</span>&nbsp;<span class="ident" id="8427596">proto</span><span class="op" id="8427601">,</span>&nbsp;<span class="ident" id="8427603">name</span>&nbsp;<span class="builtintype" id="8427608">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8427616">cname</span><span class="op" id="8427621">,</span>&nbsp;<span class="ident" id="8427623">target</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8427637">string</span><br>
<span class="lineno"></span><span class="op" id="8427644">}</span><span class="op" id="8427645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8427648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8427652">&#34;xmpp-server&#34;</span><span class="op" id="8427665">,</span>&nbsp;<span class="string" id="8427667">&#34;tcp&#34;</span><span class="op" id="8427672">,</span>&nbsp;<span class="string" id="8427674">&#34;google.com&#34;</span><span class="op" id="8427686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8427690">&#34;.google.com&#34;</span><span class="op" id="8427703">,</span>&nbsp;<span class="string" id="8427705">&#34;.google.com&#34;</span><span class="op" id="8427718">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8427721">}</span><span class="op" id="8427722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8427725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8427729">&#34;&#34;</span><span class="op" id="8427731">,</span>&nbsp;<span class="string" id="8427733">&#34;&#34;</span><span class="op" id="8427735">,</span>&nbsp;<span class="string" id="8427737">&#34;_xmpp-server._tcp.google.com&#34;</span><span class="op" id="8427767">,</span>&nbsp;<span class="comment" id="8427769">//&nbsp;non-standard&nbsp;back&nbsp;door</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8427797">&#34;.google.com&#34;</span><span class="op" id="8427810">,</span>&nbsp;<span class="string" id="8427812">&#34;.google.com&#34;</span><span class="op" id="8427825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8427828">}</span><span class="op" id="8427829">,</span><br>
<span class="lineno">30</span><span class="op" id="8427831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8427834">func</span>&nbsp;<span class="ident" id="8427839">TestLookupGoogleSRV</span><span class="op" id="8427858">(</span><span class="ident" id="8427859">t</span>&nbsp;<span class="op" id="8427861">*</span><span class="ident" id="8427862">testing</span><span class="op" id="8427869">.</span><span class="ident" id="8427870">T</span><span class="op" id="8427871">)</span>&nbsp;<span class="op" id="8427873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8427876">if</span>&nbsp;<span class="ident" id="8427879">testing</span><span class="op" id="8427886">.</span><span class="ident" id="8427887">Short</span><span class="op" id="8427892">(</span><span class="op" id="8427893">)</span>&nbsp;<span class="op" id="8427895">||</span>&nbsp;<span class="op" id="8427898">!</span><span class="op" id="8427899">*</span><span class="ident" id="8427900">testExternal</span>&nbsp;<span class="op" id="8427913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8427917">t</span><span class="op" id="8427918">.</span><span class="ident" id="8427919">Skip</span><span class="op" id="8427923">(</span><span class="string" id="8427924">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8427965">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8427968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8427972">for</span>&nbsp;<span class="ident" id="8427976">_</span><span class="op" id="8427977">,</span>&nbsp;<span class="ident" id="8427979">tt</span>&nbsp;<span class="op" id="8427982">:=</span>&nbsp;<span class="keyword" id="8427985">range</span>&nbsp;<span class="ident" id="8427991">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="8428012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428016">cname</span><span class="op" id="8428021">,</span>&nbsp;<span class="ident" id="8428023">srvs</span><span class="op" id="8428027">,</span>&nbsp;<span class="ident" id="8428029">err</span>&nbsp;<span class="op" id="8428033">:=</span>&nbsp;<span class="ident" id="8428036">LookupSRV</span><span class="op" id="8428045">(</span><span class="ident" id="8428046">tt</span><span class="op" id="8428048">.</span><span class="ident" id="8428049">service</span><span class="op" id="8428056">,</span>&nbsp;<span class="ident" id="8428058">tt</span><span class="op" id="8428060">.</span><span class="ident" id="8428061">proto</span><span class="op" id="8428066">,</span>&nbsp;<span class="ident" id="8428068">tt</span><span class="op" id="8428070">.</span><span class="ident" id="8428071">name</span><span class="op" id="8428075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428079">if</span>&nbsp;<span class="ident" id="8428082">err</span>&nbsp;<span class="op" id="8428086">!=</span>&nbsp;<span class="ident" id="8428089">nil</span>&nbsp;<span class="op" id="8428093">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428098">t</span><span class="op" id="8428099">.</span><span class="ident" id="8428100">Fatal</span><span class="op" id="8428105">(</span><span class="ident" id="8428106">err</span><span class="op" id="8428109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428117">if</span>&nbsp;<span class="builtinfunc" id="8428120">len</span><span class="op" id="8428123">(</span><span class="ident" id="8428124">srvs</span><span class="op" id="8428128">)</span>&nbsp;<span class="op" id="8428130">==</span>&nbsp;<span class="num" id="8428133">0</span>&nbsp;<span class="op" id="8428135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428140">t</span><span class="op" id="8428141">.</span><span class="ident" id="8428142">Error</span><span class="op" id="8428147">(</span><span class="string" id="8428148">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8428163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428167">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428171">if</span>&nbsp;<span class="op" id="8428174">!</span><span class="ident" id="8428175">strings</span><span class="op" id="8428182">.</span><span class="ident" id="8428183">Contains</span><span class="op" id="8428191">(</span><span class="ident" id="8428192">cname</span><span class="op" id="8428197">,</span>&nbsp;<span class="ident" id="8428199">tt</span><span class="op" id="8428201">.</span><span class="ident" id="8428202">cname</span><span class="op" id="8428207">)</span>&nbsp;<span class="op" id="8428209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428214">t</span><span class="op" id="8428215">.</span><span class="ident" id="8428216">Errorf</span><span class="op" id="8428222">(</span><span class="string" id="8428223">&#34;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8428240">,</span>&nbsp;<span class="ident" id="8428242">cname</span><span class="op" id="8428247">,</span>&nbsp;<span class="ident" id="8428249">tt</span><span class="op" id="8428251">.</span><span class="ident" id="8428252">cname</span><span class="op" id="8428257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428265">for</span>&nbsp;<span class="ident" id="8428269">_</span><span class="op" id="8428270">,</span>&nbsp;<span class="ident" id="8428272">srv</span>&nbsp;<span class="op" id="8428276">:=</span>&nbsp;<span class="keyword" id="8428279">range</span>&nbsp;<span class="ident" id="8428285">srvs</span>&nbsp;<span class="op" id="8428290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428295">if</span>&nbsp;<span class="op" id="8428298">!</span><span class="ident" id="8428299">strings</span><span class="op" id="8428306">.</span><span class="ident" id="8428307">Contains</span><span class="op" id="8428315">(</span><span class="ident" id="8428316">srv</span><span class="op" id="8428319">.</span><span class="ident" id="8428320">Target</span><span class="op" id="8428326">,</span>&nbsp;<span class="ident" id="8428328">tt</span><span class="op" id="8428330">.</span><span class="ident" id="8428331">target</span><span class="op" id="8428337">)</span>&nbsp;<span class="op" id="8428339">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428345">t</span><span class="op" id="8428346">.</span><span class="ident" id="8428347">Errorf</span><span class="op" id="8428353">(</span><span class="string" id="8428354">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="8428391">,</span>&nbsp;<span class="ident" id="8428393">srv</span><span class="op" id="8428396">,</span>&nbsp;<span class="ident" id="8428398">tt</span><span class="op" id="8428400">.</span><span class="ident" id="8428401">target</span><span class="op" id="8428407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428419">}</span><br>
<span class="lineno"></span><span class="op" id="8428421">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="8428424">func</span>&nbsp;<span class="ident" id="8428429">TestLookupGmailMX</span><span class="op" id="8428446">(</span><span class="ident" id="8428447">t</span>&nbsp;<span class="op" id="8428449">*</span><span class="ident" id="8428450">testing</span><span class="op" id="8428457">.</span><span class="ident" id="8428458">T</span><span class="op" id="8428459">)</span>&nbsp;<span class="op" id="8428461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428464">if</span>&nbsp;<span class="ident" id="8428467">testing</span><span class="op" id="8428474">.</span><span class="ident" id="8428475">Short</span><span class="op" id="8428480">(</span><span class="op" id="8428481">)</span>&nbsp;<span class="op" id="8428483">||</span>&nbsp;<span class="op" id="8428486">!</span><span class="op" id="8428487">*</span><span class="ident" id="8428488">testExternal</span>&nbsp;<span class="op" id="8428501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428505">t</span><span class="op" id="8428506">.</span><span class="ident" id="8428507">Skip</span><span class="op" id="8428511">(</span><span class="string" id="8428512">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8428553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428556">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428560">mxs</span><span class="op" id="8428563">,</span>&nbsp;<span class="ident" id="8428565">err</span>&nbsp;<span class="op" id="8428569">:=</span>&nbsp;<span class="ident" id="8428572">LookupMX</span><span class="op" id="8428580">(</span><span class="string" id="8428581">&#34;gmail.com&#34;</span><span class="op" id="8428592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428595">if</span>&nbsp;<span class="ident" id="8428598">err</span>&nbsp;<span class="op" id="8428602">!=</span>&nbsp;<span class="ident" id="8428605">nil</span>&nbsp;<span class="op" id="8428609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428613">t</span><span class="op" id="8428614">.</span><span class="ident" id="8428615">Fatal</span><span class="op" id="8428620">(</span><span class="ident" id="8428621">err</span><span class="op" id="8428624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428627">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428630">if</span>&nbsp;<span class="builtinfunc" id="8428633">len</span><span class="op" id="8428636">(</span><span class="ident" id="8428637">mxs</span><span class="op" id="8428640">)</span>&nbsp;<span class="op" id="8428642">==</span>&nbsp;<span class="num" id="8428645">0</span>&nbsp;<span class="op" id="8428647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428651">t</span><span class="op" id="8428652">.</span><span class="ident" id="8428653">Error</span><span class="op" id="8428658">(</span><span class="string" id="8428659">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8428674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428680">for</span>&nbsp;<span class="ident" id="8428684">_</span><span class="op" id="8428685">,</span>&nbsp;<span class="ident" id="8428687">mx</span>&nbsp;<span class="op" id="8428690">:=</span>&nbsp;<span class="keyword" id="8428693">range</span>&nbsp;<span class="ident" id="8428699">mxs</span>&nbsp;<span class="op" id="8428703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428707">if</span>&nbsp;<span class="op" id="8428710">!</span><span class="ident" id="8428711">strings</span><span class="op" id="8428718">.</span><span class="ident" id="8428719">Contains</span><span class="op" id="8428727">(</span><span class="ident" id="8428728">mx</span><span class="op" id="8428730">.</span><span class="ident" id="8428731">Host</span><span class="op" id="8428735">,</span>&nbsp;<span class="string" id="8428737">&#34;.google.com&#34;</span><span class="op" id="8428750">)</span>&nbsp;<span class="op" id="8428752">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428757">t</span><span class="op" id="8428758">.</span><span class="ident" id="8428759">Errorf</span><span class="op" id="8428765">(</span><span class="string" id="8428766">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="8428813">,</span>&nbsp;<span class="ident" id="8428815">mx</span><span class="op" id="8428817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428824">}</span><br>
<span class="lineno"></span><span class="op" id="8428826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="8428829">func</span>&nbsp;<span class="ident" id="8428834">TestLookupGmailNS</span><span class="op" id="8428851">(</span><span class="ident" id="8428852">t</span>&nbsp;<span class="op" id="8428854">*</span><span class="ident" id="8428855">testing</span><span class="op" id="8428862">.</span><span class="ident" id="8428863">T</span><span class="op" id="8428864">)</span>&nbsp;<span class="op" id="8428866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8428869">if</span>&nbsp;<span class="ident" id="8428872">testing</span><span class="op" id="8428879">.</span><span class="ident" id="8428880">Short</span><span class="op" id="8428885">(</span><span class="op" id="8428886">)</span>&nbsp;<span class="op" id="8428888">||</span>&nbsp;<span class="op" id="8428891">!</span><span class="op" id="8428892">*</span><span class="ident" id="8428893">testExternal</span>&nbsp;<span class="op" id="8428906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428910">t</span><span class="op" id="8428911">.</span><span class="ident" id="8428912">Skip</span><span class="op" id="8428916">(</span><span class="string" id="8428917">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8428958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8428961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8428965">nss</span><span class="op" id="8428968">,</span>&nbsp;<span class="ident" id="8428970">err</span>&nbsp;<span class="op" id="8428974">:=</span>&nbsp;<span class="ident" id="8428977">LookupNS</span><span class="op" id="8428985">(</span><span class="string" id="8428986">&#34;gmail.com&#34;</span><span class="op" id="8428997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429000">if</span>&nbsp;<span class="ident" id="8429003">err</span>&nbsp;<span class="op" id="8429007">!=</span>&nbsp;<span class="ident" id="8429010">nil</span>&nbsp;<span class="op" id="8429014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429018">t</span><span class="op" id="8429019">.</span><span class="ident" id="8429020">Fatal</span><span class="op" id="8429025">(</span><span class="ident" id="8429026">err</span><span class="op" id="8429029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429035">if</span>&nbsp;<span class="builtinfunc" id="8429038">len</span><span class="op" id="8429041">(</span><span class="ident" id="8429042">nss</span><span class="op" id="8429045">)</span>&nbsp;<span class="op" id="8429047">==</span>&nbsp;<span class="num" id="8429050">0</span>&nbsp;<span class="op" id="8429052">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429056">t</span><span class="op" id="8429057">.</span><span class="ident" id="8429058">Error</span><span class="op" id="8429063">(</span><span class="string" id="8429064">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8429079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429085">for</span>&nbsp;<span class="ident" id="8429089">_</span><span class="op" id="8429090">,</span>&nbsp;<span class="ident" id="8429092">ns</span>&nbsp;<span class="op" id="8429095">:=</span>&nbsp;<span class="keyword" id="8429098">range</span>&nbsp;<span class="ident" id="8429104">nss</span>&nbsp;<span class="op" id="8429108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429112">if</span>&nbsp;<span class="op" id="8429115">!</span><span class="ident" id="8429116">strings</span><span class="op" id="8429123">.</span><span class="ident" id="8429124">Contains</span><span class="op" id="8429132">(</span><span class="ident" id="8429133">ns</span><span class="op" id="8429135">.</span><span class="ident" id="8429136">Host</span><span class="op" id="8429140">,</span>&nbsp;<span class="string" id="8429142">&#34;.google.com&#34;</span><span class="op" id="8429155">)</span>&nbsp;<span class="op" id="8429157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429162">t</span><span class="op" id="8429163">.</span><span class="ident" id="8429164">Errorf</span><span class="op" id="8429170">(</span><span class="string" id="8429171">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="8429218">,</span>&nbsp;<span class="ident" id="8429220">ns</span><span class="op" id="8429222">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429229">}</span><br>
<span class="lineno"></span><span class="op" id="8429231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8429234">func</span>&nbsp;<span class="ident" id="8429239">TestLookupGmailTXT</span><span class="op" id="8429257">(</span><span class="ident" id="8429258">t</span>&nbsp;<span class="op" id="8429260">*</span><span class="ident" id="8429261">testing</span><span class="op" id="8429268">.</span><span class="ident" id="8429269">T</span><span class="op" id="8429270">)</span>&nbsp;<span class="op" id="8429272">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429275">if</span>&nbsp;<span class="ident" id="8429278">testing</span><span class="op" id="8429285">.</span><span class="ident" id="8429286">Short</span><span class="op" id="8429291">(</span><span class="op" id="8429292">)</span>&nbsp;<span class="op" id="8429294">||</span>&nbsp;<span class="op" id="8429297">!</span><span class="op" id="8429298">*</span><span class="ident" id="8429299">testExternal</span>&nbsp;<span class="op" id="8429312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429316">t</span><span class="op" id="8429317">.</span><span class="ident" id="8429318">Skip</span><span class="op" id="8429322">(</span><span class="string" id="8429323">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8429364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429371">txts</span><span class="op" id="8429375">,</span>&nbsp;<span class="ident" id="8429377">err</span>&nbsp;<span class="op" id="8429381">:=</span>&nbsp;<span class="ident" id="8429384">LookupTXT</span><span class="op" id="8429393">(</span><span class="string" id="8429394">&#34;gmail.com&#34;</span><span class="op" id="8429405">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429408">if</span>&nbsp;<span class="ident" id="8429411">err</span>&nbsp;<span class="op" id="8429415">!=</span>&nbsp;<span class="ident" id="8429418">nil</span>&nbsp;<span class="op" id="8429422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429426">t</span><span class="op" id="8429427">.</span><span class="ident" id="8429428">Fatal</span><span class="op" id="8429433">(</span><span class="ident" id="8429434">err</span><span class="op" id="8429437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429443">if</span>&nbsp;<span class="builtinfunc" id="8429446">len</span><span class="op" id="8429449">(</span><span class="ident" id="8429450">txts</span><span class="op" id="8429454">)</span>&nbsp;<span class="op" id="8429456">==</span>&nbsp;<span class="num" id="8429459">0</span>&nbsp;<span class="op" id="8429461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429465">t</span><span class="op" id="8429466">.</span><span class="ident" id="8429467">Error</span><span class="op" id="8429472">(</span><span class="string" id="8429473">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8429488">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429494">for</span>&nbsp;<span class="ident" id="8429498">_</span><span class="op" id="8429499">,</span>&nbsp;<span class="ident" id="8429501">txt</span>&nbsp;<span class="op" id="8429505">:=</span>&nbsp;<span class="keyword" id="8429508">range</span>&nbsp;<span class="ident" id="8429514">txts</span>&nbsp;<span class="op" id="8429519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429523">if</span>&nbsp;<span class="op" id="8429526">!</span><span class="ident" id="8429527">strings</span><span class="op" id="8429534">.</span><span class="ident" id="8429535">Contains</span><span class="op" id="8429543">(</span><span class="ident" id="8429544">txt</span><span class="op" id="8429547">,</span>&nbsp;<span class="string" id="8429549">&#34;spf&#34;</span><span class="op" id="8429554">)</span>&nbsp;<span class="op" id="8429556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429561">t</span><span class="op" id="8429562">.</span><span class="ident" id="8429563">Errorf</span><span class="op" id="8429569">(</span><span class="string" id="8429570">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;spf&nbsp;record&#34;</span><span class="op" id="8429597">,</span>&nbsp;<span class="ident" id="8429599">txt</span><span class="op" id="8429602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429606">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429609">}</span><br>
<span class="lineno"></span><span class="op" id="8429611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8429614">var</span>&nbsp;<span class="ident" id="8429618">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="8429645">=</span>&nbsp;<span class="op" id="8429647">[</span><span class="op" id="8429648">]</span><span class="keyword" id="8429649">struct</span>&nbsp;<span class="op" id="8429656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429659">addr</span>&nbsp;<span class="builtintype" id="8429664">string</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429672">name</span>&nbsp;<span class="builtintype" id="8429677">string</span><br>
<span class="lineno"></span><span class="op" id="8429684">}</span><span class="op" id="8429685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429688">{</span><span class="string" id="8429689">&#34;8.8.8.8&#34;</span><span class="op" id="8429698">,</span>&nbsp;<span class="string" id="8429700">&#34;.google.com.&#34;</span><span class="op" id="8429714">}</span><span class="op" id="8429715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429718">{</span><span class="string" id="8429719">&#34;8.8.4.4&#34;</span><span class="op" id="8429728">,</span>&nbsp;<span class="string" id="8429730">&#34;.google.com.&#34;</span><span class="op" id="8429744">}</span><span class="op" id="8429745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429748">{</span><span class="string" id="8429749">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="8429771">,</span>&nbsp;<span class="string" id="8429773">&#34;.google.com.&#34;</span><span class="op" id="8429787">}</span><span class="op" id="8429788">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429791">{</span><span class="string" id="8429792">&#34;2001:4860:4860::8844&#34;</span><span class="op" id="8429814">,</span>&nbsp;<span class="string" id="8429816">&#34;.google.com.&#34;</span><span class="op" id="8429830">}</span><span class="op" id="8429831">,</span><br>
<span class="lineno"></span><span class="op" id="8429833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8429836">func</span>&nbsp;<span class="ident" id="8429841">TestLookupGooglePublicDNSAddr</span><span class="op" id="8429870">(</span><span class="ident" id="8429871">t</span>&nbsp;<span class="op" id="8429873">*</span><span class="ident" id="8429874">testing</span><span class="op" id="8429881">.</span><span class="ident" id="8429882">T</span><span class="op" id="8429883">)</span>&nbsp;<span class="op" id="8429885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429888">if</span>&nbsp;<span class="ident" id="8429891">testing</span><span class="op" id="8429898">.</span><span class="ident" id="8429899">Short</span><span class="op" id="8429904">(</span><span class="op" id="8429905">)</span>&nbsp;<span class="op" id="8429907">||</span>&nbsp;<span class="op" id="8429910">!</span><span class="op" id="8429911">*</span><span class="ident" id="8429912">testExternal</span>&nbsp;<span class="op" id="8429925">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8429929">t</span><span class="op" id="8429930">.</span><span class="ident" id="8429931">Skip</span><span class="op" id="8429935">(</span><span class="string" id="8429936">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8429977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8429980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8429984">for</span>&nbsp;<span class="ident" id="8429988">_</span><span class="op" id="8429989">,</span>&nbsp;<span class="ident" id="8429991">tt</span>&nbsp;<span class="op" id="8429994">:=</span>&nbsp;<span class="keyword" id="8429997">range</span>&nbsp;<span class="ident" id="8430003">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="8430030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430034">names</span><span class="op" id="8430039">,</span>&nbsp;<span class="ident" id="8430041">err</span>&nbsp;<span class="op" id="8430045">:=</span>&nbsp;<span class="ident" id="8430048">LookupAddr</span><span class="op" id="8430058">(</span><span class="ident" id="8430059">tt</span><span class="op" id="8430061">.</span><span class="ident" id="8430062">addr</span><span class="op" id="8430066">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430070">if</span>&nbsp;<span class="ident" id="8430073">err</span>&nbsp;<span class="op" id="8430077">!=</span>&nbsp;<span class="ident" id="8430080">nil</span>&nbsp;<span class="op" id="8430084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430089">t</span><span class="op" id="8430090">.</span><span class="ident" id="8430091">Fatal</span><span class="op" id="8430096">(</span><span class="ident" id="8430097">err</span><span class="op" id="8430100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430108">if</span>&nbsp;<span class="builtinfunc" id="8430111">len</span><span class="op" id="8430114">(</span><span class="ident" id="8430115">names</span><span class="op" id="8430120">)</span>&nbsp;<span class="op" id="8430122">==</span>&nbsp;<span class="num" id="8430125">0</span>&nbsp;<span class="op" id="8430127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430132">t</span><span class="op" id="8430133">.</span><span class="ident" id="8430134">Error</span><span class="op" id="8430139">(</span><span class="string" id="8430140">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8430155">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430163">for</span>&nbsp;<span class="ident" id="8430167">_</span><span class="op" id="8430168">,</span>&nbsp;<span class="ident" id="8430170">name</span>&nbsp;<span class="op" id="8430175">:=</span>&nbsp;<span class="keyword" id="8430178">range</span>&nbsp;<span class="ident" id="8430184">names</span>&nbsp;<span class="op" id="8430190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430195">if</span>&nbsp;<span class="op" id="8430198">!</span><span class="ident" id="8430199">strings</span><span class="op" id="8430206">.</span><span class="ident" id="8430207">HasSuffix</span><span class="op" id="8430216">(</span><span class="ident" id="8430217">name</span><span class="op" id="8430221">,</span>&nbsp;<span class="ident" id="8430223">tt</span><span class="op" id="8430225">.</span><span class="ident" id="8430226">name</span><span class="op" id="8430230">)</span>&nbsp;<span class="op" id="8430232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430238">t</span><span class="op" id="8430239">.</span><span class="ident" id="8430240">Errorf</span><span class="op" id="8430246">(</span><span class="string" id="8430247">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="8430284">,</span>&nbsp;<span class="ident" id="8430286">name</span><span class="op" id="8430290">,</span>&nbsp;<span class="ident" id="8430292">tt</span><span class="op" id="8430294">.</span><span class="ident" id="8430295">name</span><span class="op" id="8430299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430304">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430311">}</span><br>
<span class="lineno"></span><span class="op" id="8430313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8430316">func</span>&nbsp;<span class="ident" id="8430321">TestLookupIANACNAME</span><span class="op" id="8430340">(</span><span class="ident" id="8430341">t</span>&nbsp;<span class="op" id="8430343">*</span><span class="ident" id="8430344">testing</span><span class="op" id="8430351">.</span><span class="ident" id="8430352">T</span><span class="op" id="8430353">)</span>&nbsp;<span class="op" id="8430355">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430358">if</span>&nbsp;<span class="ident" id="8430361">testing</span><span class="op" id="8430368">.</span><span class="ident" id="8430369">Short</span><span class="op" id="8430374">(</span><span class="op" id="8430375">)</span>&nbsp;<span class="op" id="8430377">||</span>&nbsp;<span class="op" id="8430380">!</span><span class="op" id="8430381">*</span><span class="ident" id="8430382">testExternal</span>&nbsp;<span class="op" id="8430395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430399">t</span><span class="op" id="8430400">.</span><span class="ident" id="8430401">Skip</span><span class="op" id="8430405">(</span><span class="string" id="8430406">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8430447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430454">cname</span><span class="op" id="8430459">,</span>&nbsp;<span class="ident" id="8430461">err</span>&nbsp;<span class="op" id="8430465">:=</span>&nbsp;<span class="ident" id="8430468">LookupCNAME</span><span class="op" id="8430479">(</span><span class="string" id="8430480">&#34;www.iana.org&#34;</span><span class="op" id="8430494">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430497">if</span>&nbsp;<span class="ident" id="8430500">err</span>&nbsp;<span class="op" id="8430504">!=</span>&nbsp;<span class="ident" id="8430507">nil</span>&nbsp;<span class="op" id="8430511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430515">t</span><span class="op" id="8430516">.</span><span class="ident" id="8430517">Fatal</span><span class="op" id="8430522">(</span><span class="ident" id="8430523">err</span><span class="op" id="8430526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430532">if</span>&nbsp;<span class="op" id="8430535">!</span><span class="ident" id="8430536">strings</span><span class="op" id="8430543">.</span><span class="ident" id="8430544">HasSuffix</span><span class="op" id="8430553">(</span><span class="ident" id="8430554">cname</span><span class="op" id="8430559">,</span>&nbsp;<span class="string" id="8430561">&#34;.icann.org.&#34;</span><span class="op" id="8430574">)</span>&nbsp;<span class="op" id="8430576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430580">t</span><span class="op" id="8430581">.</span><span class="ident" id="8430582">Errorf</span><span class="op" id="8430588">(</span><span class="string" id="8430589">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.icann.org.&#34;</span><span class="op" id="8430635">,</span>&nbsp;<span class="ident" id="8430637">cname</span><span class="op" id="8430642">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430645">}</span><br>
<span class="lineno"></span><span class="op" id="8430647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8430650">func</span>&nbsp;<span class="ident" id="8430655">TestLookupGoogleHost</span><span class="op" id="8430675">(</span><span class="ident" id="8430676">t</span>&nbsp;<span class="op" id="8430678">*</span><span class="ident" id="8430679">testing</span><span class="op" id="8430686">.</span><span class="ident" id="8430687">T</span><span class="op" id="8430688">)</span>&nbsp;<span class="op" id="8430690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430693">if</span>&nbsp;<span class="ident" id="8430696">testing</span><span class="op" id="8430703">.</span><span class="ident" id="8430704">Short</span><span class="op" id="8430709">(</span><span class="op" id="8430710">)</span>&nbsp;<span class="op" id="8430712">||</span>&nbsp;<span class="op" id="8430715">!</span><span class="op" id="8430716">*</span><span class="ident" id="8430717">testExternal</span>&nbsp;<span class="op" id="8430730">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430734">t</span><span class="op" id="8430735">.</span><span class="ident" id="8430736">Skip</span><span class="op" id="8430740">(</span><span class="string" id="8430741">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8430782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430789">addrs</span><span class="op" id="8430794">,</span>&nbsp;<span class="ident" id="8430796">err</span>&nbsp;<span class="op" id="8430800">:=</span>&nbsp;<span class="ident" id="8430803">LookupHost</span><span class="op" id="8430813">(</span><span class="string" id="8430814">&#34;google.com&#34;</span><span class="op" id="8430826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430829">if</span>&nbsp;<span class="ident" id="8430832">err</span>&nbsp;<span class="op" id="8430836">!=</span>&nbsp;<span class="ident" id="8430839">nil</span>&nbsp;<span class="op" id="8430843">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430847">t</span><span class="op" id="8430848">.</span><span class="ident" id="8430849">Fatal</span><span class="op" id="8430854">(</span><span class="ident" id="8430855">err</span><span class="op" id="8430858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430864">if</span>&nbsp;<span class="builtinfunc" id="8430867">len</span><span class="op" id="8430870">(</span><span class="ident" id="8430871">addrs</span><span class="op" id="8430876">)</span>&nbsp;<span class="op" id="8430878">==</span>&nbsp;<span class="num" id="8430881">0</span>&nbsp;<span class="op" id="8430883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430887">t</span><span class="op" id="8430888">.</span><span class="ident" id="8430889">Error</span><span class="op" id="8430894">(</span><span class="string" id="8430895">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8430910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8430913">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430916">for</span>&nbsp;<span class="ident" id="8430920">_</span><span class="op" id="8430921">,</span>&nbsp;<span class="ident" id="8430923">addr</span>&nbsp;<span class="op" id="8430928">:=</span>&nbsp;<span class="keyword" id="8430931">range</span>&nbsp;<span class="ident" id="8430937">addrs</span>&nbsp;<span class="op" id="8430943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8430947">if</span>&nbsp;<span class="ident" id="8430950">ParseIP</span><span class="op" id="8430957">(</span><span class="ident" id="8430958">addr</span><span class="op" id="8430962">)</span>&nbsp;<span class="op" id="8430964">==</span>&nbsp;<span class="ident" id="8430967">nil</span>&nbsp;<span class="op" id="8430971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8430976">t</span><span class="op" id="8430977">.</span><span class="ident" id="8430978">Errorf</span><span class="op" id="8430984">(</span><span class="string" id="8430985">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;literal&nbsp;ip&nbsp;address&#34;</span><span class="op" id="8431020">,</span>&nbsp;<span class="ident" id="8431022">addr</span><span class="op" id="8431026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431033">}</span><br>
<span class="lineno">175</span><span class="op" id="8431035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8431038">func</span>&nbsp;<span class="ident" id="8431043">TestLookupGoogleIP</span><span class="op" id="8431061">(</span><span class="ident" id="8431062">t</span>&nbsp;<span class="op" id="8431064">*</span><span class="ident" id="8431065">testing</span><span class="op" id="8431072">.</span><span class="ident" id="8431073">T</span><span class="op" id="8431074">)</span>&nbsp;<span class="op" id="8431076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8431079">if</span>&nbsp;<span class="ident" id="8431082">testing</span><span class="op" id="8431089">.</span><span class="ident" id="8431090">Short</span><span class="op" id="8431095">(</span><span class="op" id="8431096">)</span>&nbsp;<span class="op" id="8431098">||</span>&nbsp;<span class="op" id="8431101">!</span><span class="op" id="8431102">*</span><span class="ident" id="8431103">testExternal</span>&nbsp;<span class="op" id="8431116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8431120">t</span><span class="op" id="8431121">.</span><span class="ident" id="8431122">Skip</span><span class="op" id="8431126">(</span><span class="string" id="8431127">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8431168">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8431175">ips</span><span class="op" id="8431178">,</span>&nbsp;<span class="ident" id="8431180">err</span>&nbsp;<span class="op" id="8431184">:=</span>&nbsp;<span class="ident" id="8431187">LookupIP</span><span class="op" id="8431195">(</span><span class="string" id="8431196">&#34;google.com&#34;</span><span class="op" id="8431208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8431211">if</span>&nbsp;<span class="ident" id="8431214">err</span>&nbsp;<span class="op" id="8431218">!=</span>&nbsp;<span class="ident" id="8431221">nil</span>&nbsp;<span class="op" id="8431225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8431229">t</span><span class="op" id="8431230">.</span><span class="ident" id="8431231">Fatal</span><span class="op" id="8431236">(</span><span class="ident" id="8431237">err</span><span class="op" id="8431240">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8431246">if</span>&nbsp;<span class="builtinfunc" id="8431249">len</span><span class="op" id="8431252">(</span><span class="ident" id="8431253">ips</span><span class="op" id="8431256">)</span>&nbsp;<span class="op" id="8431258">==</span>&nbsp;<span class="num" id="8431261">0</span>&nbsp;<span class="op" id="8431263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8431267">t</span><span class="op" id="8431268">.</span><span class="ident" id="8431269">Error</span><span class="op" id="8431274">(</span><span class="string" id="8431275">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8431290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8431296">for</span>&nbsp;<span class="ident" id="8431300">_</span><span class="op" id="8431301">,</span>&nbsp;<span class="ident" id="8431303">ip</span>&nbsp;<span class="op" id="8431306">:=</span>&nbsp;<span class="keyword" id="8431309">range</span>&nbsp;<span class="ident" id="8431315">ips</span>&nbsp;<span class="op" id="8431319">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8431323">if</span>&nbsp;<span class="ident" id="8431326">ip</span><span class="op" id="8431328">.</span><span class="ident" id="8431329">To4</span><span class="op" id="8431332">(</span><span class="op" id="8431333">)</span>&nbsp;<span class="op" id="8431335">==</span>&nbsp;<span class="ident" id="8431338">nil</span>&nbsp;<span class="op" id="8431342">&amp;&amp;</span>&nbsp;<span class="ident" id="8431345">ip</span><span class="op" id="8431347">.</span><span class="ident" id="8431348">To16</span><span class="op" id="8431352">(</span><span class="op" id="8431353">)</span>&nbsp;<span class="op" id="8431355">==</span>&nbsp;<span class="ident" id="8431358">nil</span>&nbsp;<span class="op" id="8431362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8431367">t</span><span class="op" id="8431368">.</span><span class="ident" id="8431369">Errorf</span><span class="op" id="8431375">(</span><span class="string" id="8431376">&#34;got&nbsp;%v;&nbsp;want&nbsp;an&nbsp;ip&nbsp;address&#34;</span><span class="op" id="8431404">,</span>&nbsp;<span class="ident" id="8431406">ip</span><span class="op" id="8431408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431415">}</span><br>
<span class="lineno"></span><span class="op" id="8431417">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="8431420">var</span>&nbsp;<span class="ident" id="8431424">revAddrTests</span>&nbsp;<span class="op" id="8431437">=</span>&nbsp;<span class="op" id="8431439">[</span><span class="op" id="8431440">]</span><span class="keyword" id="8431441">struct</span>&nbsp;<span class="op" id="8431448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8431451">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8431461">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8431469">Reverse</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8431479">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8431487">ErrPrefix</span>&nbsp;<span class="builtintype" id="8431497">string</span><br>
<span class="lineno">200</span><span class="op" id="8431504">}</span><span class="op" id="8431505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431508">{</span><span class="string" id="8431509">&#34;1.2.3.4&#34;</span><span class="op" id="8431518">,</span>&nbsp;<span class="string" id="8431520">&#34;4.3.2.1.in-addr.arpa.&#34;</span><span class="op" id="8431543">,</span>&nbsp;<span class="string" id="8431545">&#34;&#34;</span><span class="op" id="8431547">}</span><span class="op" id="8431548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431551">{</span><span class="string" id="8431552">&#34;245.110.36.114&#34;</span><span class="op" id="8431568">,</span>&nbsp;<span class="string" id="8431570">&#34;114.36.110.245.in-addr.arpa.&#34;</span><span class="op" id="8431600">,</span>&nbsp;<span class="string" id="8431602">&#34;&#34;</span><span class="op" id="8431604">}</span><span class="op" id="8431605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431608">{</span><span class="string" id="8431609">&#34;::ffff:12.34.56.78&#34;</span><span class="op" id="8431629">,</span>&nbsp;<span class="string" id="8431631">&#34;78.56.34.12.in-addr.arpa.&#34;</span><span class="op" id="8431658">,</span>&nbsp;<span class="string" id="8431660">&#34;&#34;</span><span class="op" id="8431662">}</span><span class="op" id="8431663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431666">{</span><span class="string" id="8431667">&#34;::1&#34;</span><span class="op" id="8431672">,</span>&nbsp;<span class="string" id="8431674">&#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa.&#34;</span><span class="op" id="8431749">,</span>&nbsp;<span class="string" id="8431751">&#34;&#34;</span><span class="op" id="8431753">}</span><span class="op" id="8431754">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431757">{</span><span class="string" id="8431758">&#34;1::&#34;</span><span class="op" id="8431763">,</span>&nbsp;<span class="string" id="8431765">&#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1.0.0.0.ip6.arpa.&#34;</span><span class="op" id="8431840">,</span>&nbsp;<span class="string" id="8431842">&#34;&#34;</span><span class="op" id="8431844">}</span><span class="op" id="8431845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431848">{</span><span class="string" id="8431849">&#34;1234:567::89a:bcde&#34;</span><span class="op" id="8431869">,</span>&nbsp;<span class="string" id="8431871">&#34;e.d.c.b.a.9.8.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="8431946">,</span>&nbsp;<span class="string" id="8431948">&#34;&#34;</span><span class="op" id="8431950">}</span><span class="op" id="8431951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8431954">{</span><span class="string" id="8431955">&#34;1234:567:fefe:bcbc:adad:9e4a:89a:bcde&#34;</span><span class="op" id="8431994">,</span>&nbsp;<span class="string" id="8431996">&#34;e.d.c.b.a.9.8.0.a.4.e.9.d.a.d.a.c.b.c.b.e.f.e.f.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="8432071">,</span>&nbsp;<span class="string" id="8432073">&#34;&#34;</span><span class="op" id="8432075">}</span><span class="op" id="8432076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8432079">{</span><span class="string" id="8432080">&#34;1.2.3&#34;</span><span class="op" id="8432087">,</span>&nbsp;<span class="string" id="8432089">&#34;&#34;</span><span class="op" id="8432091">,</span>&nbsp;<span class="string" id="8432093">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="8432115">}</span><span class="op" id="8432116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8432119">{</span><span class="string" id="8432120">&#34;1.2.3.4.5&#34;</span><span class="op" id="8432131">,</span>&nbsp;<span class="string" id="8432133">&#34;&#34;</span><span class="op" id="8432135">,</span>&nbsp;<span class="string" id="8432137">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="8432159">}</span><span class="op" id="8432160">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8432163">{</span><span class="string" id="8432164">&#34;1234:567:bcbca::89a:bcde&#34;</span><span class="op" id="8432190">,</span>&nbsp;<span class="string" id="8432192">&#34;&#34;</span><span class="op" id="8432194">,</span>&nbsp;<span class="string" id="8432196">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="8432218">}</span><span class="op" id="8432219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8432222">{</span><span class="string" id="8432223">&#34;1234:567::bcbc:adad::89a:bcde&#34;</span><span class="op" id="8432254">,</span>&nbsp;<span class="string" id="8432256">&#34;&#34;</span><span class="op" id="8432258">,</span>&nbsp;<span class="string" id="8432260">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="8432282">}</span><span class="op" id="8432283">,</span><br>
<span class="lineno"></span><span class="op" id="8432285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8432288">func</span>&nbsp;<span class="ident" id="8432293">TestReverseAddress</span><span class="op" id="8432311">(</span><span class="ident" id="8432312">t</span>&nbsp;<span class="op" id="8432314">*</span><span class="ident" id="8432315">testing</span><span class="op" id="8432322">.</span><span class="ident" id="8432323">T</span><span class="op" id="8432324">)</span>&nbsp;<span class="op" id="8432326">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8432329">for</span>&nbsp;<span class="ident" id="8432333">i</span><span class="op" id="8432334">,</span>&nbsp;<span class="ident" id="8432336">tt</span>&nbsp;<span class="op" id="8432339">:=</span>&nbsp;<span class="keyword" id="8432342">range</span>&nbsp;<span class="ident" id="8432348">revAddrTests</span>&nbsp;<span class="op" id="8432361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8432365">a</span><span class="op" id="8432366">,</span>&nbsp;<span class="ident" id="8432368">err</span>&nbsp;<span class="op" id="8432372">:=</span>&nbsp;<span class="ident" id="8432375">reverseaddr</span><span class="op" id="8432386">(</span><span class="ident" id="8432387">tt</span><span class="op" id="8432389">.</span><span class="ident" id="8432390">Addr</span><span class="op" id="8432394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8432398">if</span>&nbsp;<span class="builtinfunc" id="8432401">len</span><span class="op" id="8432404">(</span><span class="ident" id="8432405">tt</span><span class="op" id="8432407">.</span><span class="ident" id="8432408">ErrPrefix</span><span class="op" id="8432417">)</span>&nbsp;<span class="op" id="8432419">&gt;</span>&nbsp;<span class="num" id="8432421">0</span>&nbsp;<span class="op" id="8432423">&amp;&amp;</span>&nbsp;<span class="ident" id="8432426">err</span>&nbsp;<span class="op" id="8432430">==</span>&nbsp;<span class="ident" id="8432433">nil</span>&nbsp;<span class="op" id="8432437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8432442">t</span><span class="op" id="8432443">.</span><span class="ident" id="8432444">Errorf</span><span class="op" id="8432450">(</span><span class="string" id="8432451">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;&lt;nil&gt;&nbsp;(error)&#34;</span><span class="op" id="8432488">,</span>&nbsp;<span class="ident" id="8432490">i</span><span class="op" id="8432491">,</span>&nbsp;<span class="ident" id="8432493">tt</span><span class="op" id="8432495">.</span><span class="ident" id="8432496">ErrPrefix</span><span class="op" id="8432505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8432510">continue</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8432521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8432525">if</span>&nbsp;<span class="builtinfunc" id="8432528">len</span><span class="op" id="8432531">(</span><span class="ident" id="8432532">tt</span><span class="op" id="8432534">.</span><span class="ident" id="8432535">ErrPrefix</span><span class="op" id="8432544">)</span>&nbsp;<span class="op" id="8432546">==</span>&nbsp;<span class="num" id="8432549">0</span>&nbsp;<span class="op" id="8432551">&amp;&amp;</span>&nbsp;<span class="ident" id="8432554">err</span>&nbsp;<span class="op" id="8432558">!=</span>&nbsp;<span class="ident" id="8432561">nil</span>&nbsp;<span class="op" id="8432565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8432570">t</span><span class="op" id="8432571">.</span><span class="ident" id="8432572">Errorf</span><span class="op" id="8432578">(</span><span class="string" id="8432579">&#34;#%d:&nbsp;expected&nbsp;&lt;nil&gt;,&nbsp;got&nbsp;%q&nbsp;(error)&#34;</span><span class="op" id="8432616">,</span>&nbsp;<span class="ident" id="8432618">i</span><span class="op" id="8432619">,</span>&nbsp;<span class="ident" id="8432621">err</span><span class="op" id="8432624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8432628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8432632">if</span>&nbsp;<span class="ident" id="8432635">err</span>&nbsp;<span class="op" id="8432639">!=</span>&nbsp;<span class="ident" id="8432642">nil</span>&nbsp;<span class="op" id="8432646">&amp;&amp;</span>&nbsp;<span class="ident" id="8432649">err</span><span class="op" id="8432652">.</span><span class="op" id="8432653">(</span><span class="op" id="8432654">*</span><span class="ident" id="8432655">DNSError</span><span class="op" id="8432663">)</span><span class="op" id="8432664">.</span><span class="ident" id="8432665">Err</span>&nbsp;<span class="op" id="8432669">!=</span>&nbsp;<span class="ident" id="8432672">tt</span><span class="op" id="8432674">.</span><span class="ident" id="8432675">ErrPrefix</span>&nbsp;<span class="op" id="8432685">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8432690">t</span><span class="op" id="8432691">.</span><span class="ident" id="8432692">Errorf</span><span class="op" id="8432698">(</span><span class="string" id="8432699">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(mismatched&nbsp;error)&#34;</span><span class="op" id="8432744">,</span>&nbsp;<span class="ident" id="8432746">i</span><span class="op" id="8432747">,</span>&nbsp;<span class="ident" id="8432749">tt</span><span class="op" id="8432751">.</span><span class="ident" id="8432752">ErrPrefix</span><span class="op" id="8432761">,</span>&nbsp;<span class="ident" id="8432763">err</span><span class="op" id="8432766">.</span><span class="op" id="8432767">(</span><span class="op" id="8432768">*</span><span class="ident" id="8432769">DNSError</span><span class="op" id="8432777">)</span><span class="op" id="8432778">.</span><span class="ident" id="8432779">Err</span><span class="op" id="8432782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8432786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8432790">if</span>&nbsp;<span class="ident" id="8432793">a</span>&nbsp;<span class="op" id="8432795">!=</span>&nbsp;<span class="ident" id="8432798">tt</span><span class="op" id="8432800">.</span><span class="ident" id="8432801">Reverse</span>&nbsp;<span class="op" id="8432809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8432814">t</span><span class="op" id="8432815">.</span><span class="ident" id="8432816">Errorf</span><span class="op" id="8432822">(</span><span class="string" id="8432823">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(reverse&nbsp;address)&#34;</span><span class="op" id="8432867">,</span>&nbsp;<span class="ident" id="8432869">i</span><span class="op" id="8432870">,</span>&nbsp;<span class="ident" id="8432872">tt</span><span class="op" id="8432874">.</span><span class="ident" id="8432875">Reverse</span><span class="op" id="8432882">,</span>&nbsp;<span class="ident" id="8432884">a</span><span class="op" id="8432885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8432889">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8432892">}</span><br>
<span class="lineno"></span><span class="op" id="8432894">}</span>
</div>
</body>
</html>
