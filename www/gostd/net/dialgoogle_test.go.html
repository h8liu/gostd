<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7759173">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7759228">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7759282">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7759333">package</span>&nbsp;<span class="ident" id="7759341">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7759346">import</span>&nbsp;<span class="op" id="7759353">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7759356">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7759364">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7759371">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7759377">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7759388">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7759399">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7759409">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7759412">//&nbsp;If&nbsp;an&nbsp;IPv6&nbsp;tunnel&nbsp;is&nbsp;running,&nbsp;we&nbsp;can&nbsp;try&nbsp;dialing&nbsp;a&nbsp;real&nbsp;IPv6&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="7759485">var</span>&nbsp;<span class="ident" id="7759489">testIPv6</span>&nbsp;<span class="op" id="7759498">=</span>&nbsp;<span class="ident" id="7759500">flag</span><span class="op" id="7759504">.</span><span class="ident" id="7759505">Bool</span><span class="op" id="7759509">(</span><span class="string" id="7759510">&#34;ipv6&#34;</span><span class="op" id="7759516">,</span>&nbsp;<span class="builtintype" id="7759518">false</span><span class="op" id="7759523">,</span>&nbsp;<span class="string" id="7759525">&#34;assume&nbsp;ipv6&nbsp;tunnel&nbsp;is&nbsp;present&#34;</span><span class="op" id="7759556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7759559">func</span>&nbsp;<span class="ident" id="7759564">TestResolveGoogle</span><span class="op" id="7759581">(</span><span class="ident" id="7759582">t</span>&nbsp;<span class="op" id="7759584">*</span><span class="ident" id="7759585">testing</span><span class="op" id="7759592">.</span><span class="ident" id="7759593">T</span><span class="op" id="7759594">)</span>&nbsp;<span class="op" id="7759596">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7759599">if</span>&nbsp;<span class="ident" id="7759602">testing</span><span class="op" id="7759609">.</span><span class="ident" id="7759610">Short</span><span class="op" id="7759615">(</span><span class="op" id="7759616">)</span>&nbsp;<span class="op" id="7759618">||</span>&nbsp;<span class="op" id="7759621">!</span><span class="op" id="7759622">*</span><span class="ident" id="7759623">testExternal</span>&nbsp;<span class="op" id="7759636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7759640">t</span><span class="op" id="7759641">.</span><span class="ident" id="7759642">Skip</span><span class="op" id="7759646">(</span><span class="string" id="7759647">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7759688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7759691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7759695">for</span>&nbsp;<span class="ident" id="7759699">_</span><span class="op" id="7759700">,</span>&nbsp;<span class="ident" id="7759702">network</span>&nbsp;<span class="op" id="7759710">:=</span>&nbsp;<span class="keyword" id="7759713">range</span>&nbsp;<span class="op" id="7759719">[</span><span class="op" id="7759720">]</span><span class="builtintype" id="7759721">string</span><span class="op" id="7759727">{</span><span class="string" id="7759728">&#34;tcp&#34;</span><span class="op" id="7759733">,</span>&nbsp;<span class="string" id="7759735">&#34;tcp4&#34;</span><span class="op" id="7759741">,</span>&nbsp;<span class="string" id="7759743">&#34;tcp6&#34;</span><span class="op" id="7759749">}</span>&nbsp;<span class="op" id="7759751">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7759755">addr</span><span class="op" id="7759759">,</span>&nbsp;<span class="ident" id="7759761">err</span>&nbsp;<span class="op" id="7759765">:=</span>&nbsp;<span class="ident" id="7759768">ResolveTCPAddr</span><span class="op" id="7759782">(</span><span class="ident" id="7759783">network</span><span class="op" id="7759790">,</span>&nbsp;<span class="string" id="7759792">&#34;www.google.com:http&#34;</span><span class="op" id="7759813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7759817">if</span>&nbsp;<span class="ident" id="7759820">err</span>&nbsp;<span class="op" id="7759824">!=</span>&nbsp;<span class="ident" id="7759827">nil</span>&nbsp;<span class="op" id="7759831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7759836">if</span>&nbsp;<span class="op" id="7759839">(</span><span class="ident" id="7759840">network</span>&nbsp;<span class="op" id="7759848">==</span>&nbsp;<span class="string" id="7759851">&#34;tcp&#34;</span>&nbsp;<span class="op" id="7759857">||</span>&nbsp;<span class="ident" id="7759860">network</span>&nbsp;<span class="op" id="7759868">==</span>&nbsp;<span class="string" id="7759871">&#34;tcp4&#34;</span><span class="op" id="7759877">)</span>&nbsp;<span class="op" id="7759879">&amp;&amp;</span>&nbsp;<span class="op" id="7759882">!</span><span class="ident" id="7759883">supportsIPv4</span>&nbsp;<span class="op" id="7759896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7759902">t</span><span class="op" id="7759903">.</span><span class="ident" id="7759904">Logf</span><span class="op" id="7759908">(</span><span class="string" id="7759909">&#34;ipv4&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="7759936">,</span>&nbsp;<span class="ident" id="7759938">err</span><span class="op" id="7759941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7759946">}</span>&nbsp;<span class="keyword" id="7759948">else</span>&nbsp;<span class="keyword" id="7759953">if</span>&nbsp;<span class="ident" id="7759956">network</span>&nbsp;<span class="op" id="7759964">==</span>&nbsp;<span class="string" id="7759967">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7759974">&amp;&amp;</span>&nbsp;<span class="op" id="7759977">!</span><span class="ident" id="7759978">supportsIPv6</span>&nbsp;<span class="op" id="7759991">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7759997">t</span><span class="op" id="7759998">.</span><span class="ident" id="7759999">Logf</span><span class="op" id="7760003">(</span><span class="string" id="7760004">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="7760031">,</span>&nbsp;<span class="ident" id="7760033">err</span><span class="op" id="7760036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7760041">}</span>&nbsp;<span class="keyword" id="7760043">else</span>&nbsp;<span class="op" id="7760048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7760054">t</span><span class="op" id="7760055">.</span><span class="ident" id="7760056">Errorf</span><span class="op" id="7760062">(</span><span class="string" id="7760063">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7760090">,</span>&nbsp;<span class="ident" id="7760092">err</span><span class="op" id="7760095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7760100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7760105">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7760116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7760120">if</span>&nbsp;<span class="op" id="7760123">(</span><span class="ident" id="7760124">network</span>&nbsp;<span class="op" id="7760132">==</span>&nbsp;<span class="string" id="7760135">&#34;tcp&#34;</span>&nbsp;<span class="op" id="7760141">||</span>&nbsp;<span class="ident" id="7760144">network</span>&nbsp;<span class="op" id="7760152">==</span>&nbsp;<span class="string" id="7760155">&#34;tcp4&#34;</span><span class="op" id="7760161">)</span>&nbsp;<span class="op" id="7760163">&amp;&amp;</span>&nbsp;<span class="ident" id="7760166">addr</span><span class="op" id="7760170">.</span><span class="ident" id="7760171">IP</span><span class="op" id="7760173">.</span><span class="ident" id="7760174">To4</span><span class="op" id="7760177">(</span><span class="op" id="7760178">)</span>&nbsp;<span class="op" id="7760180">==</span>&nbsp;<span class="ident" id="7760183">nil</span>&nbsp;<span class="op" id="7760187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7760192">t</span><span class="op" id="7760193">.</span><span class="ident" id="7760194">Errorf</span><span class="op" id="7760200">(</span><span class="string" id="7760201">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="7760241">,</span>&nbsp;<span class="ident" id="7760243">addr</span><span class="op" id="7760247">,</span>&nbsp;<span class="ident" id="7760249">network</span><span class="op" id="7760256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7760260">}</span>&nbsp;<span class="keyword" id="7760262">else</span>&nbsp;<span class="keyword" id="7760267">if</span>&nbsp;<span class="ident" id="7760270">network</span>&nbsp;<span class="op" id="7760278">==</span>&nbsp;<span class="string" id="7760281">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7760288">&amp;&amp;</span>&nbsp;<span class="op" id="7760291">(</span><span class="ident" id="7760292">addr</span><span class="op" id="7760296">.</span><span class="ident" id="7760297">IP</span><span class="op" id="7760299">.</span><span class="ident" id="7760300">To16</span><span class="op" id="7760304">(</span><span class="op" id="7760305">)</span>&nbsp;<span class="op" id="7760307">==</span>&nbsp;<span class="ident" id="7760310">nil</span>&nbsp;<span class="op" id="7760314">||</span>&nbsp;<span class="ident" id="7760317">addr</span><span class="op" id="7760321">.</span><span class="ident" id="7760322">IP</span><span class="op" id="7760324">.</span><span class="ident" id="7760325">To4</span><span class="op" id="7760328">(</span><span class="op" id="7760329">)</span>&nbsp;<span class="op" id="7760331">!=</span>&nbsp;<span class="ident" id="7760334">nil</span><span class="op" id="7760337">)</span>&nbsp;<span class="op" id="7760339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7760344">t</span><span class="op" id="7760345">.</span><span class="ident" id="7760346">Errorf</span><span class="op" id="7760352">(</span><span class="string" id="7760353">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="7760393">,</span>&nbsp;<span class="ident" id="7760395">addr</span><span class="op" id="7760399">,</span>&nbsp;<span class="ident" id="7760401">network</span><span class="op" id="7760408">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7760412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7760415">}</span><br>
<span class="lineno"></span><span class="op" id="7760417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7760420">func</span>&nbsp;<span class="ident" id="7760425">TestDialGoogle</span><span class="op" id="7760439">(</span><span class="ident" id="7760440">t</span>&nbsp;<span class="op" id="7760442">*</span><span class="ident" id="7760443">testing</span><span class="op" id="7760450">.</span><span class="ident" id="7760451">T</span><span class="op" id="7760452">)</span>&nbsp;<span class="op" id="7760454">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7760457">if</span>&nbsp;<span class="ident" id="7760460">testing</span><span class="op" id="7760467">.</span><span class="ident" id="7760468">Short</span><span class="op" id="7760473">(</span><span class="op" id="7760474">)</span>&nbsp;<span class="op" id="7760476">||</span>&nbsp;<span class="op" id="7760479">!</span><span class="op" id="7760480">*</span><span class="ident" id="7760481">testExternal</span>&nbsp;<span class="op" id="7760494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7760498">t</span><span class="op" id="7760499">.</span><span class="ident" id="7760500">Skip</span><span class="op" id="7760504">(</span><span class="string" id="7760505">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7760546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7760549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7760553">d</span>&nbsp;<span class="op" id="7760555">:=</span>&nbsp;<span class="op" id="7760558">&amp;</span><span class="ident" id="7760559">Dialer</span><span class="op" id="7760565">{</span><span class="ident" id="7760566">DualStack</span><span class="op" id="7760575">:</span>&nbsp;<span class="builtintype" id="7760577">true</span><span class="op" id="7760581">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7760584">for</span>&nbsp;<span class="ident" id="7760588">_</span><span class="op" id="7760589">,</span>&nbsp;<span class="ident" id="7760591">network</span>&nbsp;<span class="op" id="7760599">:=</span>&nbsp;<span class="keyword" id="7760602">range</span>&nbsp;<span class="op" id="7760608">[</span><span class="op" id="7760609">]</span><span class="builtintype" id="7760610">string</span><span class="op" id="7760616">{</span><span class="string" id="7760617">&#34;tcp&#34;</span><span class="op" id="7760622">,</span>&nbsp;<span class="string" id="7760624">&#34;tcp4&#34;</span><span class="op" id="7760630">,</span>&nbsp;<span class="string" id="7760632">&#34;tcp6&#34;</span><span class="op" id="7760638">}</span>&nbsp;<span class="op" id="7760640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7760644">if</span>&nbsp;<span class="ident" id="7760647">network</span>&nbsp;<span class="op" id="7760655">==</span>&nbsp;<span class="string" id="7760658">&#34;tcp&#34;</span>&nbsp;<span class="op" id="7760664">&amp;&amp;</span>&nbsp;<span class="op" id="7760667">!</span><span class="ident" id="7760668">supportsIPv4</span>&nbsp;<span class="op" id="7760681">&amp;&amp;</span>&nbsp;<span class="op" id="7760684">!</span><span class="ident" id="7760685">supportsIPv6</span>&nbsp;<span class="op" id="7760698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7760703">t</span><span class="op" id="7760704">.</span><span class="ident" id="7760705">Logf</span><span class="op" id="7760709">(</span><span class="string" id="7760710">&#34;skipping&nbsp;test;&nbsp;both&nbsp;ipv4&nbsp;and&nbsp;ipv6&nbsp;are&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7760763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7760768">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7760779">}</span>&nbsp;<span class="keyword" id="7760781">else</span>&nbsp;<span class="keyword" id="7760786">if</span>&nbsp;<span class="ident" id="7760789">network</span>&nbsp;<span class="op" id="7760797">==</span>&nbsp;<span class="string" id="7760800">&#34;tcp4&#34;</span>&nbsp;<span class="op" id="7760807">&amp;&amp;</span>&nbsp;<span class="op" id="7760810">!</span><span class="ident" id="7760811">supportsIPv4</span>&nbsp;<span class="op" id="7760824">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7760829">t</span><span class="op" id="7760830">.</span><span class="ident" id="7760831">Logf</span><span class="op" id="7760835">(</span><span class="string" id="7760836">&#34;skipping&nbsp;test;&nbsp;ipv4&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7760874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7760879">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7760890">}</span>&nbsp;<span class="keyword" id="7760892">else</span>&nbsp;<span class="keyword" id="7760897">if</span>&nbsp;<span class="ident" id="7760900">network</span>&nbsp;<span class="op" id="7760908">==</span>&nbsp;<span class="string" id="7760911">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7760918">&amp;&amp;</span>&nbsp;<span class="op" id="7760921">!</span><span class="ident" id="7760922">supportsIPv6</span>&nbsp;<span class="op" id="7760935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7760940">t</span><span class="op" id="7760941">.</span><span class="ident" id="7760942">Logf</span><span class="op" id="7760946">(</span><span class="string" id="7760947">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7760985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7760990">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7761001">}</span>&nbsp;<span class="keyword" id="7761003">else</span>&nbsp;<span class="keyword" id="7761008">if</span>&nbsp;<span class="ident" id="7761011">network</span>&nbsp;<span class="op" id="7761019">==</span>&nbsp;<span class="string" id="7761022">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7761029">&amp;&amp;</span>&nbsp;<span class="op" id="7761032">!</span><span class="op" id="7761033">*</span><span class="ident" id="7761034">testIPv6</span>&nbsp;<span class="op" id="7761043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761048">t</span><span class="op" id="7761049">.</span><span class="ident" id="7761050">Logf</span><span class="op" id="7761054">(</span><span class="string" id="7761055">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="7761091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7761096">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7761107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7761111">if</span>&nbsp;<span class="ident" id="7761114">c</span><span class="op" id="7761115">,</span>&nbsp;<span class="ident" id="7761117">err</span>&nbsp;<span class="op" id="7761121">:=</span>&nbsp;<span class="ident" id="7761124">d</span><span class="op" id="7761125">.</span><span class="ident" id="7761126">Dial</span><span class="op" id="7761130">(</span><span class="ident" id="7761131">network</span><span class="op" id="7761138">,</span>&nbsp;<span class="string" id="7761140">&#34;www.google.com:http&#34;</span><span class="op" id="7761161">)</span><span class="op" id="7761162">;</span>&nbsp;<span class="ident" id="7761164">err</span>&nbsp;<span class="op" id="7761168">!=</span>&nbsp;<span class="ident" id="7761171">nil</span>&nbsp;<span class="op" id="7761175">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761180">t</span><span class="op" id="7761181">.</span><span class="ident" id="7761182">Errorf</span><span class="op" id="7761188">(</span><span class="string" id="7761189">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7761206">,</span>&nbsp;<span class="ident" id="7761208">err</span><span class="op" id="7761211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7761215">}</span>&nbsp;<span class="keyword" id="7761217">else</span>&nbsp;<span class="op" id="7761222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761227">c</span><span class="op" id="7761228">.</span><span class="ident" id="7761229">Close</span><span class="op" id="7761234">(</span><span class="op" id="7761235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7761239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7761242">}</span><br>
<span class="lineno">70</span><span class="op" id="7761244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7761247">//&nbsp;fd&nbsp;is&nbsp;already&nbsp;connected&nbsp;to&nbsp;the&nbsp;destination,&nbsp;port&nbsp;80.</span><br>
<span class="lineno"></span><span class="comment" id="7761303">//&nbsp;Run&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;fetch&nbsp;the&nbsp;appropriate&nbsp;page.</span><br>
<span class="lineno"></span><span class="keyword" id="7761357">func</span>&nbsp;<span class="ident" id="7761362">fetchGoogle</span><span class="op" id="7761373">(</span><span class="ident" id="7761374">t</span>&nbsp;<span class="op" id="7761376">*</span><span class="ident" id="7761377">testing</span><span class="op" id="7761384">.</span><span class="ident" id="7761385">T</span><span class="op" id="7761386">,</span>&nbsp;<span class="ident" id="7761388">fd</span>&nbsp;<span class="ident" id="7761391">Conn</span><span class="op" id="7761395">,</span>&nbsp;<span class="ident" id="7761397">network</span><span class="op" id="7761404">,</span>&nbsp;<span class="ident" id="7761406">addr</span>&nbsp;<span class="builtintype" id="7761411">string</span><span class="op" id="7761417">)</span>&nbsp;<span class="op" id="7761419">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761422">req</span>&nbsp;<span class="op" id="7761426">:=</span>&nbsp;<span class="op" id="7761429">[</span><span class="op" id="7761430">]</span><span class="builtintype" id="7761431">byte</span><span class="op" id="7761435">(</span><span class="string" id="7761436">&#34;GET&nbsp;/robots.txt&nbsp;HTTP/1.0\r\nHost:&nbsp;www.google.com\r\n\r\n&#34;</span><span class="op" id="7761494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761497">n</span><span class="op" id="7761498">,</span>&nbsp;<span class="ident" id="7761500">err</span>&nbsp;<span class="op" id="7761504">:=</span>&nbsp;<span class="ident" id="7761507">fd</span><span class="op" id="7761509">.</span><span class="ident" id="7761510">Write</span><span class="op" id="7761515">(</span><span class="ident" id="7761516">req</span><span class="op" id="7761519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761523">buf</span>&nbsp;<span class="op" id="7761527">:=</span>&nbsp;<span class="builtinfunc" id="7761530">make</span><span class="op" id="7761534">(</span><span class="op" id="7761535">[</span><span class="op" id="7761536">]</span><span class="builtintype" id="7761537">byte</span><span class="op" id="7761541">,</span>&nbsp;<span class="num" id="7761543">1000</span><span class="op" id="7761547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761550">n</span><span class="op" id="7761551">,</span>&nbsp;<span class="ident" id="7761553">err</span>&nbsp;<span class="op" id="7761557">=</span>&nbsp;<span class="ident" id="7761559">io</span><span class="op" id="7761561">.</span><span class="ident" id="7761562">ReadFull</span><span class="op" id="7761570">(</span><span class="ident" id="7761571">fd</span><span class="op" id="7761573">,</span>&nbsp;<span class="ident" id="7761575">buf</span><span class="op" id="7761578">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7761582">if</span>&nbsp;<span class="ident" id="7761585">n</span>&nbsp;<span class="op" id="7761587">&lt;</span>&nbsp;<span class="num" id="7761589">1000</span>&nbsp;<span class="op" id="7761594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761598">t</span><span class="op" id="7761599">.</span><span class="ident" id="7761600">Errorf</span><span class="op" id="7761606">(</span><span class="string" id="7761607">&#34;fetchGoogle:&nbsp;short&nbsp;HTTP&nbsp;read&nbsp;from&nbsp;%s&nbsp;%s&nbsp;-&nbsp;%v&#34;</span><span class="op" id="7761653">,</span>&nbsp;<span class="ident" id="7761655">network</span><span class="op" id="7761662">,</span>&nbsp;<span class="ident" id="7761664">addr</span><span class="op" id="7761668">,</span>&nbsp;<span class="ident" id="7761670">err</span><span class="op" id="7761673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7761677">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7761685">}</span><br>
<span class="lineno">85</span><span class="op" id="7761687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7761690">func</span>&nbsp;<span class="ident" id="7761695">doDial</span><span class="op" id="7761701">(</span><span class="ident" id="7761702">t</span>&nbsp;<span class="op" id="7761704">*</span><span class="ident" id="7761705">testing</span><span class="op" id="7761712">.</span><span class="ident" id="7761713">T</span><span class="op" id="7761714">,</span>&nbsp;<span class="ident" id="7761716">network</span><span class="op" id="7761723">,</span>&nbsp;<span class="ident" id="7761725">addr</span>&nbsp;<span class="builtintype" id="7761730">string</span><span class="op" id="7761736">)</span>&nbsp;<span class="op" id="7761738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761741">fd</span><span class="op" id="7761743">,</span>&nbsp;<span class="ident" id="7761745">err</span>&nbsp;<span class="op" id="7761749">:=</span>&nbsp;<span class="ident" id="7761752">Dial</span><span class="op" id="7761756">(</span><span class="ident" id="7761757">network</span><span class="op" id="7761764">,</span>&nbsp;<span class="ident" id="7761766">addr</span><span class="op" id="7761770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7761773">if</span>&nbsp;<span class="ident" id="7761776">err</span>&nbsp;<span class="op" id="7761780">!=</span>&nbsp;<span class="ident" id="7761783">nil</span>&nbsp;<span class="op" id="7761787">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761791">t</span><span class="op" id="7761792">.</span><span class="ident" id="7761793">Errorf</span><span class="op" id="7761799">(</span><span class="string" id="7761800">&#34;Dial(%q,&nbsp;%q,&nbsp;%q)&nbsp;=&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="7761826">,</span>&nbsp;<span class="ident" id="7761828">network</span><span class="op" id="7761835">,</span>&nbsp;<span class="string" id="7761837">&#34;&#34;</span><span class="op" id="7761839">,</span>&nbsp;<span class="ident" id="7761841">addr</span><span class="op" id="7761845">,</span>&nbsp;<span class="ident" id="7761847">err</span><span class="op" id="7761850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7761854">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7761862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761865">fetchGoogle</span><span class="op" id="7761876">(</span><span class="ident" id="7761877">t</span><span class="op" id="7761878">,</span>&nbsp;<span class="ident" id="7761880">fd</span><span class="op" id="7761882">,</span>&nbsp;<span class="ident" id="7761884">network</span><span class="op" id="7761891">,</span>&nbsp;<span class="ident" id="7761893">addr</span><span class="op" id="7761897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7761900">fd</span><span class="op" id="7761902">.</span><span class="ident" id="7761903">Close</span><span class="op" id="7761908">(</span><span class="op" id="7761909">)</span><br>
<span class="lineno">95</span><span class="op" id="7761911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7761914">var</span>&nbsp;<span class="ident" id="7761918">googleaddrsipv4</span>&nbsp;<span class="op" id="7761934">=</span>&nbsp;<span class="op" id="7761936">[</span><span class="op" id="7761937">]</span><span class="builtintype" id="7761938">string</span><span class="op" id="7761944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7761947">&#34;%d.%d.%d.%d:80&#34;</span><span class="op" id="7761963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7761966">&#34;www.google.com:80&#34;</span><span class="op" id="7761985">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7761988">&#34;%d.%d.%d.%d:http&#34;</span><span class="op" id="7762006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7762009">&#34;www.google.com:http&#34;</span><span class="op" id="7762030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7762033">&#34;%03d.%03d.%03d.%03d:0080&#34;</span><span class="op" id="7762059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7762062">&#34;[::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7762087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7762090">&#34;[::ffff:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="7762121">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7762124">&#34;[0:0:0:0:0000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7762160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7762163">&#34;[0:0:0:0:000000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7762201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7762204">&#34;[0:0:0:0::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7762236">,</span><br>
<span class="lineno"></span><span class="op" id="7762238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7762241">func</span>&nbsp;<span class="ident" id="7762246">TestDialGoogleIPv4</span><span class="op" id="7762264">(</span><span class="ident" id="7762265">t</span>&nbsp;<span class="op" id="7762267">*</span><span class="ident" id="7762268">testing</span><span class="op" id="7762275">.</span><span class="ident" id="7762276">T</span><span class="op" id="7762277">)</span>&nbsp;<span class="op" id="7762279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762282">if</span>&nbsp;<span class="ident" id="7762285">testing</span><span class="op" id="7762292">.</span><span class="ident" id="7762293">Short</span><span class="op" id="7762298">(</span><span class="op" id="7762299">)</span>&nbsp;<span class="op" id="7762301">||</span>&nbsp;<span class="op" id="7762304">!</span><span class="op" id="7762305">*</span><span class="ident" id="7762306">testExternal</span>&nbsp;<span class="op" id="7762319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7762323">t</span><span class="op" id="7762324">.</span><span class="ident" id="7762325">Skip</span><span class="op" id="7762329">(</span><span class="string" id="7762330">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7762371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7762374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7762378">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv4&nbsp;address&nbsp;for&nbsp;google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7762427">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7762447">addrs</span><span class="op" id="7762452">,</span>&nbsp;<span class="ident" id="7762454">err</span>&nbsp;<span class="op" id="7762458">:=</span>&nbsp;<span class="ident" id="7762461">LookupIP</span><span class="op" id="7762469">(</span><span class="string" id="7762470">&#34;www.google.com&#34;</span><span class="op" id="7762486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762489">if</span>&nbsp;<span class="ident" id="7762492">err</span>&nbsp;<span class="op" id="7762496">!=</span>&nbsp;<span class="ident" id="7762499">nil</span>&nbsp;<span class="op" id="7762503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7762507">t</span><span class="op" id="7762508">.</span><span class="ident" id="7762509">Fatalf</span><span class="op" id="7762515">(</span><span class="string" id="7762516">&#34;lookup&nbsp;www.google.com:&nbsp;%v&#34;</span><span class="op" id="7762543">,</span>&nbsp;<span class="ident" id="7762545">err</span><span class="op" id="7762548">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7762551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762554">var</span>&nbsp;<span class="ident" id="7762558">ip</span>&nbsp;<span class="ident" id="7762561">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762565">for</span>&nbsp;<span class="ident" id="7762569">_</span><span class="op" id="7762570">,</span>&nbsp;<span class="ident" id="7762572">addr</span>&nbsp;<span class="op" id="7762577">:=</span>&nbsp;<span class="keyword" id="7762580">range</span>&nbsp;<span class="ident" id="7762586">addrs</span>&nbsp;<span class="op" id="7762592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762596">if</span>&nbsp;<span class="ident" id="7762599">x</span>&nbsp;<span class="op" id="7762601">:=</span>&nbsp;<span class="ident" id="7762604">addr</span><span class="op" id="7762608">.</span><span class="ident" id="7762609">To4</span><span class="op" id="7762612">(</span><span class="op" id="7762613">)</span><span class="op" id="7762614">;</span>&nbsp;<span class="ident" id="7762616">x</span>&nbsp;<span class="op" id="7762618">!=</span>&nbsp;<span class="ident" id="7762621">nil</span>&nbsp;<span class="op" id="7762625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7762630">ip</span>&nbsp;<span class="op" id="7762633">=</span>&nbsp;<span class="ident" id="7762635">x</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762640">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7762648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7762651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762654">if</span>&nbsp;<span class="ident" id="7762657">ip</span>&nbsp;<span class="op" id="7762660">==</span>&nbsp;<span class="ident" id="7762663">nil</span>&nbsp;<span class="op" id="7762667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7762671">t</span><span class="op" id="7762672">.</span><span class="ident" id="7762673">Fatalf</span><span class="op" id="7762679">(</span><span class="string" id="7762680">&#34;no&nbsp;IPv4&nbsp;addresses&nbsp;for&nbsp;www.google.com&#34;</span><span class="op" id="7762718">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7762721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762725">for</span>&nbsp;<span class="ident" id="7762729">i</span><span class="op" id="7762730">,</span>&nbsp;<span class="ident" id="7762732">s</span>&nbsp;<span class="op" id="7762734">:=</span>&nbsp;<span class="keyword" id="7762737">range</span>&nbsp;<span class="ident" id="7762743">googleaddrsipv4</span>&nbsp;<span class="op" id="7762759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762763">if</span>&nbsp;<span class="ident" id="7762766">strings</span><span class="op" id="7762773">.</span><span class="ident" id="7762774">Contains</span><span class="op" id="7762782">(</span><span class="ident" id="7762783">s</span><span class="op" id="7762784">,</span>&nbsp;<span class="string" id="7762786">&#34;%&#34;</span><span class="op" id="7762789">)</span>&nbsp;<span class="op" id="7762791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7762796">googleaddrsipv4</span><span class="op" id="7762811">[</span><span class="ident" id="7762812">i</span><span class="op" id="7762813">]</span>&nbsp;<span class="op" id="7762815">=</span>&nbsp;<span class="ident" id="7762817">fmt</span><span class="op" id="7762820">.</span><span class="ident" id="7762821">Sprintf</span><span class="op" id="7762828">(</span><span class="ident" id="7762829">s</span><span class="op" id="7762830">,</span>&nbsp;<span class="ident" id="7762832">ip</span><span class="op" id="7762834">[</span><span class="num" id="7762835">0</span><span class="op" id="7762836">]</span><span class="op" id="7762837">,</span>&nbsp;<span class="ident" id="7762839">ip</span><span class="op" id="7762841">[</span><span class="num" id="7762842">1</span><span class="op" id="7762843">]</span><span class="op" id="7762844">,</span>&nbsp;<span class="ident" id="7762846">ip</span><span class="op" id="7762848">[</span><span class="num" id="7762849">2</span><span class="op" id="7762850">]</span><span class="op" id="7762851">,</span>&nbsp;<span class="ident" id="7762853">ip</span><span class="op" id="7762855">[</span><span class="num" id="7762856">3</span><span class="op" id="7762857">]</span><span class="op" id="7762858">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7762862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7762865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762869">for</span>&nbsp;<span class="ident" id="7762873">i</span>&nbsp;<span class="op" id="7762875">:=</span>&nbsp;<span class="num" id="7762878">0</span><span class="op" id="7762879">;</span>&nbsp;<span class="ident" id="7762881">i</span>&nbsp;<span class="op" id="7762883">&lt;</span>&nbsp;<span class="builtinfunc" id="7762885">len</span><span class="op" id="7762888">(</span><span class="ident" id="7762889">googleaddrsipv4</span><span class="op" id="7762904">)</span><span class="op" id="7762905">;</span>&nbsp;<span class="ident" id="7762907">i</span><span class="op" id="7762908">++</span>&nbsp;<span class="op" id="7762911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7762915">addr</span>&nbsp;<span class="op" id="7762920">:=</span>&nbsp;<span class="ident" id="7762923">googleaddrsipv4</span><span class="op" id="7762938">[</span><span class="ident" id="7762939">i</span><span class="op" id="7762940">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762944">if</span>&nbsp;<span class="ident" id="7762947">addr</span>&nbsp;<span class="op" id="7762952">==</span>&nbsp;<span class="string" id="7762955">&#34;&#34;</span>&nbsp;<span class="op" id="7762958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7762963">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7762974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7762978">t</span><span class="op" id="7762979">.</span><span class="ident" id="7762980">Logf</span><span class="op" id="7762984">(</span><span class="string" id="7762985">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="7762995">,</span>&nbsp;<span class="ident" id="7762997">addr</span><span class="op" id="7763001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763005">doDial</span><span class="op" id="7763011">(</span><span class="ident" id="7763012">t</span><span class="op" id="7763013">,</span>&nbsp;<span class="string" id="7763015">&#34;tcp&#34;</span><span class="op" id="7763020">,</span>&nbsp;<span class="ident" id="7763022">addr</span><span class="op" id="7763026">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7763030">if</span>&nbsp;<span class="ident" id="7763033">addr</span><span class="op" id="7763037">[</span><span class="num" id="7763038">0</span><span class="op" id="7763039">]</span>&nbsp;<span class="op" id="7763041">!=</span>&nbsp;<span class="string" id="7763044">&#39;[&#39;</span>&nbsp;<span class="op" id="7763048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763053">doDial</span><span class="op" id="7763059">(</span><span class="ident" id="7763060">t</span><span class="op" id="7763061">,</span>&nbsp;<span class="string" id="7763063">&#34;tcp4&#34;</span><span class="op" id="7763069">,</span>&nbsp;<span class="ident" id="7763071">addr</span><span class="op" id="7763075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7763080">if</span>&nbsp;<span class="ident" id="7763083">supportsIPv6</span>&nbsp;<span class="op" id="7763096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7763102">//&nbsp;make&nbsp;sure&nbsp;syscall.SocketDisableIPv6&nbsp;flag&nbsp;works.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763157">syscall</span><span class="op" id="7763164">.</span><span class="ident" id="7763165">SocketDisableIPv6</span>&nbsp;<span class="op" id="7763183">=</span>&nbsp;<span class="builtintype" id="7763185">true</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763194">doDial</span><span class="op" id="7763200">(</span><span class="ident" id="7763201">t</span><span class="op" id="7763202">,</span>&nbsp;<span class="string" id="7763204">&#34;tcp&#34;</span><span class="op" id="7763209">,</span>&nbsp;<span class="ident" id="7763211">addr</span><span class="op" id="7763215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763221">doDial</span><span class="op" id="7763227">(</span><span class="ident" id="7763228">t</span><span class="op" id="7763229">,</span>&nbsp;<span class="string" id="7763231">&#34;tcp4&#34;</span><span class="op" id="7763237">,</span>&nbsp;<span class="ident" id="7763239">addr</span><span class="op" id="7763243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763249">syscall</span><span class="op" id="7763256">.</span><span class="ident" id="7763257">SocketDisableIPv6</span>&nbsp;<span class="op" id="7763275">=</span>&nbsp;<span class="builtintype" id="7763277">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763290">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763293">}</span><br>
<span class="lineno"></span><span class="op" id="7763295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7763298">var</span>&nbsp;<span class="ident" id="7763302">googleaddrsipv6</span>&nbsp;<span class="op" id="7763318">=</span>&nbsp;<span class="op" id="7763320">[</span><span class="op" id="7763321">]</span><span class="builtintype" id="7763322">string</span><span class="op" id="7763328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763331">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="7763409">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763412">&#34;ipv6.google.com:80&#34;</span><span class="op" id="7763432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763435">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:http&#34;</span><span class="op" id="7763515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763518">&#34;ipv6.google.com:http&#34;</span><span class="op" id="7763540">,</span><br>
<span class="lineno"></span><span class="op" id="7763542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="7763545">func</span>&nbsp;<span class="ident" id="7763550">TestDialGoogleIPv6</span><span class="op" id="7763568">(</span><span class="ident" id="7763569">t</span>&nbsp;<span class="op" id="7763571">*</span><span class="ident" id="7763572">testing</span><span class="op" id="7763579">.</span><span class="ident" id="7763580">T</span><span class="op" id="7763581">)</span>&nbsp;<span class="op" id="7763583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7763586">if</span>&nbsp;<span class="ident" id="7763589">testing</span><span class="op" id="7763596">.</span><span class="ident" id="7763597">Short</span><span class="op" id="7763602">(</span><span class="op" id="7763603">)</span>&nbsp;<span class="op" id="7763605">||</span>&nbsp;<span class="op" id="7763608">!</span><span class="op" id="7763609">*</span><span class="ident" id="7763610">testExternal</span>&nbsp;<span class="op" id="7763623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763627">t</span><span class="op" id="7763628">.</span><span class="ident" id="7763629">Skip</span><span class="op" id="7763633">(</span><span class="string" id="7763634">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7763675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7763681">//&nbsp;Only&nbsp;run&nbsp;tcp6&nbsp;if&nbsp;the&nbsp;kernel&nbsp;will&nbsp;take&nbsp;it.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7763727">if</span>&nbsp;<span class="op" id="7763730">!</span><span class="ident" id="7763731">supportsIPv6</span>&nbsp;<span class="op" id="7763744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763748">t</span><span class="op" id="7763749">.</span><span class="ident" id="7763750">Skip</span><span class="op" id="7763754">(</span><span class="string" id="7763755">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7763793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7763799">if</span>&nbsp;<span class="op" id="7763802">!</span><span class="op" id="7763803">*</span><span class="ident" id="7763804">testIPv6</span>&nbsp;<span class="op" id="7763813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763817">t</span><span class="op" id="7763818">.</span><span class="ident" id="7763819">Skip</span><span class="op" id="7763823">(</span><span class="string" id="7763824">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="7763860">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7763867">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv6&nbsp;address&nbsp;for&nbsp;ipv6.google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7763921">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763941">addrs</span><span class="op" id="7763946">,</span>&nbsp;<span class="ident" id="7763948">err</span>&nbsp;<span class="op" id="7763952">:=</span>&nbsp;<span class="ident" id="7763955">LookupIP</span><span class="op" id="7763963">(</span><span class="string" id="7763964">&#34;ipv6.google.com&#34;</span><span class="op" id="7763981">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7763984">if</span>&nbsp;<span class="ident" id="7763987">err</span>&nbsp;<span class="op" id="7763991">!=</span>&nbsp;<span class="ident" id="7763994">nil</span>&nbsp;<span class="op" id="7763998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764002">t</span><span class="op" id="7764003">.</span><span class="ident" id="7764004">Fatalf</span><span class="op" id="7764010">(</span><span class="string" id="7764011">&#34;lookup&nbsp;ipv6.google.com:&nbsp;%v&#34;</span><span class="op" id="7764039">,</span>&nbsp;<span class="ident" id="7764041">err</span><span class="op" id="7764044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764050">var</span>&nbsp;<span class="ident" id="7764054">ip</span>&nbsp;<span class="ident" id="7764057">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764061">for</span>&nbsp;<span class="ident" id="7764065">_</span><span class="op" id="7764066">,</span>&nbsp;<span class="ident" id="7764068">addr</span>&nbsp;<span class="op" id="7764073">:=</span>&nbsp;<span class="keyword" id="7764076">range</span>&nbsp;<span class="ident" id="7764082">addrs</span>&nbsp;<span class="op" id="7764088">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764092">if</span>&nbsp;<span class="ident" id="7764095">x</span>&nbsp;<span class="op" id="7764097">:=</span>&nbsp;<span class="ident" id="7764100">addr</span><span class="op" id="7764104">.</span><span class="ident" id="7764105">To16</span><span class="op" id="7764109">(</span><span class="op" id="7764110">)</span><span class="op" id="7764111">;</span>&nbsp;<span class="ident" id="7764113">x</span>&nbsp;<span class="op" id="7764115">!=</span>&nbsp;<span class="ident" id="7764118">nil</span>&nbsp;<span class="op" id="7764122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764127">ip</span>&nbsp;<span class="op" id="7764130">=</span>&nbsp;<span class="ident" id="7764132">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764137">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764148">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764151">if</span>&nbsp;<span class="ident" id="7764154">ip</span>&nbsp;<span class="op" id="7764157">==</span>&nbsp;<span class="ident" id="7764160">nil</span>&nbsp;<span class="op" id="7764164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764168">t</span><span class="op" id="7764169">.</span><span class="ident" id="7764170">Fatalf</span><span class="op" id="7764176">(</span><span class="string" id="7764177">&#34;no&nbsp;IPv6&nbsp;addresses&nbsp;for&nbsp;ipv6.google.com&#34;</span><span class="op" id="7764216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764223">for</span>&nbsp;<span class="ident" id="7764227">i</span><span class="op" id="7764228">,</span>&nbsp;<span class="ident" id="7764230">s</span>&nbsp;<span class="op" id="7764232">:=</span>&nbsp;<span class="keyword" id="7764235">range</span>&nbsp;<span class="ident" id="7764241">googleaddrsipv6</span>&nbsp;<span class="op" id="7764257">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764261">if</span>&nbsp;<span class="ident" id="7764264">strings</span><span class="op" id="7764271">.</span><span class="ident" id="7764272">Contains</span><span class="op" id="7764280">(</span><span class="ident" id="7764281">s</span><span class="op" id="7764282">,</span>&nbsp;<span class="string" id="7764284">&#34;%&#34;</span><span class="op" id="7764287">)</span>&nbsp;<span class="op" id="7764289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764294">googleaddrsipv6</span><span class="op" id="7764309">[</span><span class="ident" id="7764310">i</span><span class="op" id="7764311">]</span>&nbsp;<span class="op" id="7764313">=</span>&nbsp;<span class="ident" id="7764315">fmt</span><span class="op" id="7764318">.</span><span class="ident" id="7764319">Sprintf</span><span class="op" id="7764326">(</span><span class="ident" id="7764327">s</span><span class="op" id="7764328">,</span>&nbsp;<span class="ident" id="7764330">ip</span><span class="op" id="7764332">[</span><span class="num" id="7764333">0</span><span class="op" id="7764334">]</span><span class="op" id="7764335">,</span>&nbsp;<span class="ident" id="7764337">ip</span><span class="op" id="7764339">[</span><span class="num" id="7764340">1</span><span class="op" id="7764341">]</span><span class="op" id="7764342">,</span>&nbsp;<span class="ident" id="7764344">ip</span><span class="op" id="7764346">[</span><span class="num" id="7764347">2</span><span class="op" id="7764348">]</span><span class="op" id="7764349">,</span>&nbsp;<span class="ident" id="7764351">ip</span><span class="op" id="7764353">[</span><span class="num" id="7764354">3</span><span class="op" id="7764355">]</span><span class="op" id="7764356">,</span>&nbsp;<span class="ident" id="7764358">ip</span><span class="op" id="7764360">[</span><span class="num" id="7764361">4</span><span class="op" id="7764362">]</span><span class="op" id="7764363">,</span>&nbsp;<span class="ident" id="7764365">ip</span><span class="op" id="7764367">[</span><span class="num" id="7764368">5</span><span class="op" id="7764369">]</span><span class="op" id="7764370">,</span>&nbsp;<span class="ident" id="7764372">ip</span><span class="op" id="7764374">[</span><span class="num" id="7764375">6</span><span class="op" id="7764376">]</span><span class="op" id="7764377">,</span>&nbsp;<span class="ident" id="7764379">ip</span><span class="op" id="7764381">[</span><span class="num" id="7764382">7</span><span class="op" id="7764383">]</span><span class="op" id="7764384">,</span>&nbsp;<span class="ident" id="7764386">ip</span><span class="op" id="7764388">[</span><span class="num" id="7764389">8</span><span class="op" id="7764390">]</span><span class="op" id="7764391">,</span>&nbsp;<span class="ident" id="7764393">ip</span><span class="op" id="7764395">[</span><span class="num" id="7764396">9</span><span class="op" id="7764397">]</span><span class="op" id="7764398">,</span>&nbsp;<span class="ident" id="7764400">ip</span><span class="op" id="7764402">[</span><span class="num" id="7764403">10</span><span class="op" id="7764405">]</span><span class="op" id="7764406">,</span>&nbsp;<span class="ident" id="7764408">ip</span><span class="op" id="7764410">[</span><span class="num" id="7764411">11</span><span class="op" id="7764413">]</span><span class="op" id="7764414">,</span>&nbsp;<span class="ident" id="7764416">ip</span><span class="op" id="7764418">[</span><span class="num" id="7764419">12</span><span class="op" id="7764421">]</span><span class="op" id="7764422">,</span>&nbsp;<span class="ident" id="7764424">ip</span><span class="op" id="7764426">[</span><span class="num" id="7764427">13</span><span class="op" id="7764429">]</span><span class="op" id="7764430">,</span>&nbsp;<span class="ident" id="7764432">ip</span><span class="op" id="7764434">[</span><span class="num" id="7764435">14</span><span class="op" id="7764437">]</span><span class="op" id="7764438">,</span>&nbsp;<span class="ident" id="7764440">ip</span><span class="op" id="7764442">[</span><span class="num" id="7764443">15</span><span class="op" id="7764445">]</span><span class="op" id="7764446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764457">for</span>&nbsp;<span class="ident" id="7764461">i</span>&nbsp;<span class="op" id="7764463">:=</span>&nbsp;<span class="num" id="7764466">0</span><span class="op" id="7764467">;</span>&nbsp;<span class="ident" id="7764469">i</span>&nbsp;<span class="op" id="7764471">&lt;</span>&nbsp;<span class="builtinfunc" id="7764473">len</span><span class="op" id="7764476">(</span><span class="ident" id="7764477">googleaddrsipv6</span><span class="op" id="7764492">)</span><span class="op" id="7764493">;</span>&nbsp;<span class="ident" id="7764495">i</span><span class="op" id="7764496">++</span>&nbsp;<span class="op" id="7764499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764503">addr</span>&nbsp;<span class="op" id="7764508">:=</span>&nbsp;<span class="ident" id="7764511">googleaddrsipv6</span><span class="op" id="7764526">[</span><span class="ident" id="7764527">i</span><span class="op" id="7764528">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764532">if</span>&nbsp;<span class="ident" id="7764535">addr</span>&nbsp;<span class="op" id="7764540">==</span>&nbsp;<span class="string" id="7764543">&#34;&#34;</span>&nbsp;<span class="op" id="7764546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764551">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764562">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764566">t</span><span class="op" id="7764567">.</span><span class="ident" id="7764568">Logf</span><span class="op" id="7764572">(</span><span class="string" id="7764573">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="7764583">,</span>&nbsp;<span class="ident" id="7764585">addr</span><span class="op" id="7764589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764593">doDial</span><span class="op" id="7764599">(</span><span class="ident" id="7764600">t</span><span class="op" id="7764601">,</span>&nbsp;<span class="string" id="7764603">&#34;tcp&#34;</span><span class="op" id="7764608">,</span>&nbsp;<span class="ident" id="7764610">addr</span><span class="op" id="7764614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764618">doDial</span><span class="op" id="7764624">(</span><span class="ident" id="7764625">t</span><span class="op" id="7764626">,</span>&nbsp;<span class="string" id="7764628">&#34;tcp6&#34;</span><span class="op" id="7764634">,</span>&nbsp;<span class="ident" id="7764636">addr</span><span class="op" id="7764640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764643">}</span><br>
<span class="lineno"></span><span class="op" id="7764645">}</span>
</div>
</body>
</html>
