<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1445534">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1445589">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1445643">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1445694">package</span>&nbsp;<span class="ident" id="1445702">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1445708">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1445758">//</span><br>
<span class="lineno"></span><span class="comment" id="1445761">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="1445783">//&nbsp;&nbsp;&nbsp;&nbspExp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1445803">//&nbsp;&nbsp;&nbsp;&nbspExp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1445821">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="1445865">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="1445902">func</span>&nbsp;<span class="ident" id="1445907">Exp</span><span class="op" id="1445910">(</span><span class="ident" id="1445911">x</span>&nbsp;<span class="builtintype" id="1445913">float64</span><span class="op" id="1445920">)</span>&nbsp;<span class="builtintype" id="1445922">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="1445931">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1445991">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="1446049">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1446108">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="1446138">//</span><br>
<span class="lineno"></span><span class="comment" id="1446141">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1446197">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1446266">//</span><br>
<span class="lineno"></span><span class="comment" id="1446269">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="1446325">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1446382">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1446399">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1446455">//</span><br>
<span class="lineno"></span><span class="comment" id="1446458">//</span><br>
<span class="lineno">30</span><span class="comment" id="1446461">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="1446471">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1446504">//</span><br>
<span class="lineno"></span><span class="comment" id="1446507">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="1446517">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="1446545">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="1446604">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1446652">//</span><br>
<span class="lineno"></span><span class="comment" id="1446655">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="1446704">//</span><br>
<span class="lineno">40</span><span class="comment" id="1446707">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="1446766">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="1446784">//</span><br>
<span class="lineno"></span><span class="comment" id="1446787">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="1446853">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="1446887">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="1446901">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="1446976">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="1447044">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1447113">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="1447179">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="1447200">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="1447270">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="1447337">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1447349">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="1447401">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1447450">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="1447494">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="1447541">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="1447576">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="1447613">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1447649">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="1447692">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="1447759">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="1447803">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="1447817">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="1447875">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="1447936">//</span><br>
<span class="lineno"></span><span class="comment" id="1447939">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="1447976">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="1448005">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="1448039">//</span><br>
<span class="lineno"></span><span class="comment" id="1448042">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1448060">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="1448102">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="1448130">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="1448183">//</span><br>
<span class="lineno"></span><span class="comment" id="1448186">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="1448199">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="1448269">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="1448309">//</span><br>
<span class="lineno"></span><span class="comment" id="1448312">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="1448327">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="1448351">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="1448419">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="1448488">//</span><br>
<span class="lineno"></span><span class="comment" id="1448491">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="1448505">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="1448571">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1448635">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="1448701">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1448746">func</span>&nbsp;<span class="ident" id="1448751">exp</span><span class="op" id="1448754">(</span><span class="ident" id="1448755">x</span>&nbsp;<span class="builtintype" id="1448757">float64</span><span class="op" id="1448764">)</span>&nbsp;<span class="builtintype" id="1448766">float64</span>&nbsp;<span class="op" id="1448774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448777">const</span>&nbsp;<span class="op" id="1448783">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448787">Ln2Hi</span>&nbsp;<span class="op" id="1448793">=</span>&nbsp;<span class="num" id="1448795">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448824">Ln2Lo</span>&nbsp;<span class="op" id="1448830">=</span>&nbsp;<span class="num" id="1448832">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448861">Log2e</span>&nbsp;<span class="op" id="1448867">=</span>&nbsp;<span class="num" id="1448869">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448899">Overflow</span>&nbsp;&nbsp;<span class="op" id="1448909">=</span>&nbsp;<span class="num" id="1448911">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448940">Underflow</span>&nbsp;<span class="op" id="1448950">=</span>&nbsp;<span class="op" id="1448952">-</span><span class="num" id="1448953">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448982">NearZero</span>&nbsp;&nbsp;<span class="op" id="1448992">=</span>&nbsp;<span class="num" id="1448994">1.0</span>&nbsp;<span class="op" id="1448998">/</span>&nbsp;<span class="op" id="1449000">(</span><span class="num" id="1449001">1</span>&nbsp;<span class="op" id="1449003">&lt;&lt;</span>&nbsp;<span class="num" id="1449006">28</span><span class="op" id="1449008">)</span>&nbsp;<span class="comment" id="1449010">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1449025">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449043">switch</span>&nbsp;<span class="op" id="1449050">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449053">case</span>&nbsp;<span class="ident" id="1449058"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1449063">(</span><span class="ident" id="1449064"><a href="/math/exp.go.html#1448755">x</a></span><span class="op" id="1449065">)</span>&nbsp;<span class="op" id="1449067">||</span>&nbsp;<span class="ident" id="1449070"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1449075">(</span><span class="ident" id="1449076"><a href="/math/exp.go.html#1448755">x</a></span><span class="op" id="1449077">,</span>&nbsp;<span class="num" id="1449079">1</span><span class="op" id="1449080">)</span><span class="op" id="1449081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449085">return</span>&nbsp;<span class="ident" id="1449092"><a href="/math/exp.go.html#1448755">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449095">case</span>&nbsp;<span class="ident" id="1449100"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1449105">(</span><span class="ident" id="1449106"><a href="/math/exp.go.html#1448755">x</a></span><span class="op" id="1449107">,</span>&nbsp;<span class="op" id="1449109">-</span><span class="num" id="1449110">1</span><span class="op" id="1449111">)</span><span class="op" id="1449112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449116">return</span>&nbsp;<span class="num" id="1449123">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449126">case</span>&nbsp;<span class="ident" id="1449131"><a href="/math/exp.go.html#1448755">x</a></span>&nbsp;<span class="op" id="1449133">&gt;</span>&nbsp;<span class="ident" id="1449135"><a href="/math/exp.go.html#1448899">Overflow</a></span><span class="op" id="1449143">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449147">return</span>&nbsp;<span class="ident" id="1449154"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1449157">(</span><span class="num" id="1449158">1</span><span class="op" id="1449159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449162">case</span>&nbsp;<span class="ident" id="1449167"><a href="/math/exp.go.html#1448755">x</a></span>&nbsp;<span class="op" id="1449169">&lt;</span>&nbsp;<span class="ident" id="1449171"><a href="/math/exp.go.html#1448940">Underflow</a></span><span class="op" id="1449180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449184">return</span>&nbsp;<span class="num" id="1449191">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449194">case</span>&nbsp;<span class="op" id="1449199">-</span><span class="ident" id="1449200"><a href="/math/exp.go.html#1448982">NearZero</a></span>&nbsp;<span class="op" id="1449209">&lt;</span>&nbsp;<span class="ident" id="1449211"><a href="/math/exp.go.html#1448755">x</a></span>&nbsp;<span class="op" id="1449213">&amp;&amp;</span>&nbsp;<span class="ident" id="1449216"><a href="/math/exp.go.html#1448755">x</a></span>&nbsp;<span class="op" id="1449218">&lt;</span>&nbsp;<span class="ident" id="1449220"><a href="/math/exp.go.html#1448982">NearZero</a></span><span class="op" id="1449228">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449232">return</span>&nbsp;<span class="num" id="1449239">1</span>&nbsp;<span class="op" id="1449241">+</span>&nbsp;<span class="ident" id="1449243"><a href="/math/exp.go.html#1448755">x</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1449250">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449307">var</span>&nbsp;<span class="ident" id="1449311">k</span>&nbsp;<span class="builtintype" id="1449313">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449318">switch</span>&nbsp;<span class="op" id="1449325">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449328">case</span>&nbsp;<span class="ident" id="1449333"><a href="/math/exp.go.html#1448755">x</a></span>&nbsp;<span class="op" id="1449335">&lt;</span>&nbsp;<span class="num" id="1449337">0</span><span class="op" id="1449338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449342"><a href="/math/exp.go.html#1449311">k</a></span>&nbsp;<span class="op" id="1449344">=</span>&nbsp;<span class="builtintype" id="1449346">int</span><span class="op" id="1449349">(</span><span class="ident" id="1449350"><a href="/math/exp.go.html#1448861">Log2e</a></span><span class="op" id="1449355">*</span><span class="ident" id="1449356"><a href="/math/exp.go.html#1448755">x</a></span>&nbsp;<span class="op" id="1449358">-</span>&nbsp;<span class="num" id="1449360">0.5</span><span class="op" id="1449363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449366">case</span>&nbsp;<span class="ident" id="1449371"><a href="/math/exp.go.html#1448755">x</a></span>&nbsp;<span class="op" id="1449373">&gt;</span>&nbsp;<span class="num" id="1449375">0</span><span class="op" id="1449376">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449380"><a href="/math/exp.go.html#1449311">k</a></span>&nbsp;<span class="op" id="1449382">=</span>&nbsp;<span class="builtintype" id="1449384">int</span><span class="op" id="1449387">(</span><span class="ident" id="1449388"><a href="/math/exp.go.html#1448861">Log2e</a></span><span class="op" id="1449393">*</span><span class="ident" id="1449394"><a href="/math/exp.go.html#1448755">x</a></span>&nbsp;<span class="op" id="1449396">+</span>&nbsp;<span class="num" id="1449398">0.5</span><span class="op" id="1449401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449404">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449407">hi</span>&nbsp;<span class="op" id="1449410">:=</span>&nbsp;<span class="ident" id="1449413"><a href="/math/exp.go.html#1448755">x</a></span>&nbsp;<span class="op" id="1449415">-</span>&nbsp;<span class="builtintype" id="1449417">float64</span><span class="op" id="1449424">(</span><span class="ident" id="1449425"><a href="/math/exp.go.html#1449311">k</a></span><span class="op" id="1449426">)</span><span class="op" id="1449427">*</span><span class="ident" id="1449428"><a href="/math/exp.go.html#1448787">Ln2Hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449435">lo</span>&nbsp;<span class="op" id="1449438">:=</span>&nbsp;<span class="builtintype" id="1449441">float64</span><span class="op" id="1449448">(</span><span class="ident" id="1449449"><a href="/math/exp.go.html#1449311">k</a></span><span class="op" id="1449450">)</span>&nbsp;<span class="op" id="1449452">*</span>&nbsp;<span class="ident" id="1449454"><a href="/math/exp.go.html#1448824">Ln2Lo</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1449462">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449474">return</span>&nbsp;<span class="ident" id="1449481"><a href="/math/exp.go.html#1450354">expmulti</a></span><span class="op" id="1449489">(</span><span class="ident" id="1449490"><a href="/math/exp.go.html#1449407">hi</a></span><span class="op" id="1449492">,</span>&nbsp;<span class="ident" id="1449494"><a href="/math/exp.go.html#1449435">lo</a></span><span class="op" id="1449496">,</span>&nbsp;<span class="ident" id="1449498"><a href="/math/exp.go.html#1449311">k</a></span><span class="op" id="1449499">)</span><br>
<span class="lineno">130</span><span class="op" id="1449501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1449504">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1449555">//</span><br>
<span class="lineno"></span><span class="comment" id="1449558">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="1449596">func</span>&nbsp;<span class="ident" id="1449601">Exp2</span><span class="op" id="1449605">(</span><span class="ident" id="1449606">x</span>&nbsp;<span class="builtintype" id="1449608">float64</span><span class="op" id="1449615">)</span>&nbsp;<span class="builtintype" id="1449617">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1449626">func</span>&nbsp;<span class="ident" id="1449631">exp2</span><span class="op" id="1449635">(</span><span class="ident" id="1449636">x</span>&nbsp;<span class="builtintype" id="1449638">float64</span><span class="op" id="1449645">)</span>&nbsp;<span class="builtintype" id="1449647">float64</span>&nbsp;<span class="op" id="1449655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449658">const</span>&nbsp;<span class="op" id="1449664">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449668">Ln2Hi</span>&nbsp;<span class="op" id="1449674">=</span>&nbsp;<span class="num" id="1449676">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449705">Ln2Lo</span>&nbsp;<span class="op" id="1449711">=</span>&nbsp;<span class="num" id="1449713">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449743">Overflow</span>&nbsp;&nbsp;<span class="op" id="1449753">=</span>&nbsp;<span class="num" id="1449755">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449780">Underflow</span>&nbsp;<span class="op" id="1449790">=</span>&nbsp;<span class="op" id="1449792">-</span><span class="num" id="1449793">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449805">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1449809">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449827">switch</span>&nbsp;<span class="op" id="1449834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449837">case</span>&nbsp;<span class="ident" id="1449842"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1449847">(</span><span class="ident" id="1449848"><a href="/math/exp.go.html#1449636">x</a></span><span class="op" id="1449849">)</span>&nbsp;<span class="op" id="1449851">||</span>&nbsp;<span class="ident" id="1449854"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1449859">(</span><span class="ident" id="1449860"><a href="/math/exp.go.html#1449636">x</a></span><span class="op" id="1449861">,</span>&nbsp;<span class="num" id="1449863">1</span><span class="op" id="1449864">)</span><span class="op" id="1449865">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449869">return</span>&nbsp;<span class="ident" id="1449876"><a href="/math/exp.go.html#1449636">x</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449879">case</span>&nbsp;<span class="ident" id="1449884"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1449889">(</span><span class="ident" id="1449890"><a href="/math/exp.go.html#1449636">x</a></span><span class="op" id="1449891">,</span>&nbsp;<span class="op" id="1449893">-</span><span class="num" id="1449894">1</span><span class="op" id="1449895">)</span><span class="op" id="1449896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449900">return</span>&nbsp;<span class="num" id="1449907">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449910">case</span>&nbsp;<span class="ident" id="1449915"><a href="/math/exp.go.html#1449636">x</a></span>&nbsp;<span class="op" id="1449917">&gt;</span>&nbsp;<span class="ident" id="1449919"><a href="/math/exp.go.html#1449743">Overflow</a></span><span class="op" id="1449927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449931">return</span>&nbsp;<span class="ident" id="1449938"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1449941">(</span><span class="num" id="1449942">1</span><span class="op" id="1449943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449946">case</span>&nbsp;<span class="ident" id="1449951"><a href="/math/exp.go.html#1449636">x</a></span>&nbsp;<span class="op" id="1449953">&lt;</span>&nbsp;<span class="ident" id="1449955"><a href="/math/exp.go.html#1449780">Underflow</a></span><span class="op" id="1449964">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449968">return</span>&nbsp;<span class="num" id="1449975">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1449982">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1450045">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450094">var</span>&nbsp;<span class="ident" id="1450098">k</span>&nbsp;<span class="builtintype" id="1450100">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450105">switch</span>&nbsp;<span class="op" id="1450112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450115">case</span>&nbsp;<span class="ident" id="1450120"><a href="/math/exp.go.html#1449636">x</a></span>&nbsp;<span class="op" id="1450122">&gt;</span>&nbsp;<span class="num" id="1450124">0</span><span class="op" id="1450125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450129"><a href="/math/exp.go.html#1450098">k</a></span>&nbsp;<span class="op" id="1450131">=</span>&nbsp;<span class="builtintype" id="1450133">int</span><span class="op" id="1450136">(</span><span class="ident" id="1450137"><a href="/math/exp.go.html#1449636">x</a></span>&nbsp;<span class="op" id="1450139">+</span>&nbsp;<span class="num" id="1450141">0.5</span><span class="op" id="1450144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450147">case</span>&nbsp;<span class="ident" id="1450152"><a href="/math/exp.go.html#1449636">x</a></span>&nbsp;<span class="op" id="1450154">&lt;</span>&nbsp;<span class="num" id="1450156">0</span><span class="op" id="1450157">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450161"><a href="/math/exp.go.html#1450098">k</a></span>&nbsp;<span class="op" id="1450163">=</span>&nbsp;<span class="builtintype" id="1450165">int</span><span class="op" id="1450168">(</span><span class="ident" id="1450169"><a href="/math/exp.go.html#1449636">x</a></span>&nbsp;<span class="op" id="1450171">-</span>&nbsp;<span class="num" id="1450173">0.5</span><span class="op" id="1450176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1450179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450182">t</span>&nbsp;<span class="op" id="1450184">:=</span>&nbsp;<span class="ident" id="1450187"><a href="/math/exp.go.html#1449636">x</a></span>&nbsp;<span class="op" id="1450189">-</span>&nbsp;<span class="builtintype" id="1450191">float64</span><span class="op" id="1450198">(</span><span class="ident" id="1450199"><a href="/math/exp.go.html#1450098">k</a></span><span class="op" id="1450200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450203">hi</span>&nbsp;<span class="op" id="1450206">:=</span>&nbsp;<span class="ident" id="1450209"><a href="/math/exp.go.html#1450182">t</a></span>&nbsp;<span class="op" id="1450211">*</span>&nbsp;<span class="ident" id="1450213"><a href="/math/exp.go.html#1449668">Ln2Hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450220">lo</span>&nbsp;<span class="op" id="1450223">:=</span>&nbsp;<span class="op" id="1450226">-</span><span class="ident" id="1450227"><a href="/math/exp.go.html#1450182">t</a></span>&nbsp;<span class="op" id="1450229">*</span>&nbsp;<span class="ident" id="1450231"><a href="/math/exp.go.html#1449705">Ln2Lo</a></span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1450239">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450251">return</span>&nbsp;<span class="ident" id="1450258"><a href="/math/exp.go.html#1450354">expmulti</a></span><span class="op" id="1450266">(</span><span class="ident" id="1450267"><a href="/math/exp.go.html#1450203">hi</a></span><span class="op" id="1450269">,</span>&nbsp;<span class="ident" id="1450271"><a href="/math/exp.go.html#1450220">lo</a></span><span class="op" id="1450273">,</span>&nbsp;<span class="ident" id="1450275"><a href="/math/exp.go.html#1450098">k</a></span><span class="op" id="1450276">)</span><br>
<span class="lineno"></span><span class="op" id="1450278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="1450281">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="1450349">func</span>&nbsp;<span class="ident" id="1450354">expmulti</span><span class="op" id="1450362">(</span><span class="ident" id="1450363">hi</span><span class="op" id="1450365">,</span>&nbsp;<span class="ident" id="1450367">lo</span>&nbsp;<span class="builtintype" id="1450370">float64</span><span class="op" id="1450377">,</span>&nbsp;<span class="ident" id="1450379">k</span>&nbsp;<span class="builtintype" id="1450381">int</span><span class="op" id="1450384">)</span>&nbsp;<span class="builtintype" id="1450386">float64</span>&nbsp;<span class="op" id="1450394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450397">const</span>&nbsp;<span class="op" id="1450403">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450407">P1</span>&nbsp;<span class="op" id="1450410">=</span>&nbsp;<span class="num" id="1450412">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="1450440">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450471">P2</span>&nbsp;<span class="op" id="1450474">=</span>&nbsp;<span class="op" id="1450476">-</span><span class="num" id="1450477">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="1450504">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450535">P3</span>&nbsp;<span class="op" id="1450538">=</span>&nbsp;<span class="num" id="1450540">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="1450568">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450599">P4</span>&nbsp;<span class="op" id="1450602">=</span>&nbsp;<span class="op" id="1450604">-</span><span class="num" id="1450605">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="1450632">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450663">P5</span>&nbsp;<span class="op" id="1450666">=</span>&nbsp;<span class="num" id="1450668">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="1450696">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1450726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450730">r</span>&nbsp;<span class="op" id="1450732">:=</span>&nbsp;<span class="ident" id="1450735"><a href="/math/exp.go.html#1450363">hi</a></span>&nbsp;<span class="op" id="1450738">-</span>&nbsp;<span class="ident" id="1450740"><a href="/math/exp.go.html#1450367">lo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450744">t</span>&nbsp;<span class="op" id="1450746">:=</span>&nbsp;<span class="ident" id="1450749"><a href="/math/exp.go.html#1450730">r</a></span>&nbsp;<span class="op" id="1450751">*</span>&nbsp;<span class="ident" id="1450753"><a href="/math/exp.go.html#1450730">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450756">c</span>&nbsp;<span class="op" id="1450758">:=</span>&nbsp;<span class="ident" id="1450761"><a href="/math/exp.go.html#1450730">r</a></span>&nbsp;<span class="op" id="1450763">-</span>&nbsp;<span class="ident" id="1450765"><a href="/math/exp.go.html#1450744">t</a></span><span class="op" id="1450766">*</span><span class="op" id="1450767">(</span><span class="ident" id="1450768"><a href="/math/exp.go.html#1450407">P1</a></span><span class="op" id="1450770">+</span><span class="ident" id="1450771"><a href="/math/exp.go.html#1450744">t</a></span><span class="op" id="1450772">*</span><span class="op" id="1450773">(</span><span class="ident" id="1450774"><a href="/math/exp.go.html#1450471">P2</a></span><span class="op" id="1450776">+</span><span class="ident" id="1450777"><a href="/math/exp.go.html#1450744">t</a></span><span class="op" id="1450778">*</span><span class="op" id="1450779">(</span><span class="ident" id="1450780"><a href="/math/exp.go.html#1450535">P3</a></span><span class="op" id="1450782">+</span><span class="ident" id="1450783"><a href="/math/exp.go.html#1450744">t</a></span><span class="op" id="1450784">*</span><span class="op" id="1450785">(</span><span class="ident" id="1450786"><a href="/math/exp.go.html#1450599">P4</a></span><span class="op" id="1450788">+</span><span class="ident" id="1450789"><a href="/math/exp.go.html#1450744">t</a></span><span class="op" id="1450790">*</span><span class="ident" id="1450791"><a href="/math/exp.go.html#1450663">P5</a></span><span class="op" id="1450793">)</span><span class="op" id="1450794">)</span><span class="op" id="1450795">)</span><span class="op" id="1450796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450799">y</span>&nbsp;<span class="op" id="1450801">:=</span>&nbsp;<span class="num" id="1450804">1</span>&nbsp;<span class="op" id="1450806">-</span>&nbsp;<span class="op" id="1450808">(</span><span class="op" id="1450809">(</span><span class="ident" id="1450810"><a href="/math/exp.go.html#1450367">lo</a></span>&nbsp;<span class="op" id="1450813">-</span>&nbsp;<span class="op" id="1450815">(</span><span class="ident" id="1450816"><a href="/math/exp.go.html#1450730">r</a></span><span class="op" id="1450817">*</span><span class="ident" id="1450818"><a href="/math/exp.go.html#1450756">c</a></span><span class="op" id="1450819">)</span><span class="op" id="1450820">/</span><span class="op" id="1450821">(</span><span class="num" id="1450822">2</span><span class="op" id="1450823">-</span><span class="ident" id="1450824"><a href="/math/exp.go.html#1450756">c</a></span><span class="op" id="1450825">)</span><span class="op" id="1450826">)</span>&nbsp;<span class="op" id="1450828">-</span>&nbsp;<span class="ident" id="1450830"><a href="/math/exp.go.html#1450363">hi</a></span><span class="op" id="1450832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1450835">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450888">return</span>&nbsp;<span class="ident" id="1450895"><a href="/math/ldexp.go.html#1501970">Ldexp</a></span><span class="op" id="1450900">(</span><span class="ident" id="1450901"><a href="/math/exp.go.html#1450799">y</a></span><span class="op" id="1450902">,</span>&nbsp;<span class="ident" id="1450904"><a href="/math/exp.go.html#1450379">k</a></span><span class="op" id="1450905">)</span><br>
<span class="lineno"></span><span class="op" id="1450907">}</span>
</div>
</body>
</html>
