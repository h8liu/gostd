<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html" class="current">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3374671">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3374727">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3374781">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3374832">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3374910">package</span>&nbsp;<span class="ident" id="3374918">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3374923">import</span>&nbsp;<span class="op" id="3374930">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3374933">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3374939">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3374945">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3374956">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3374963">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3374966">//&nbsp;BUG(rsc):&nbsp;On&nbsp;OpenBSD,&nbsp;listening&nbsp;on&nbsp;the&nbsp;&#34;tcp&#34;&nbsp;network&nbsp;does&nbsp;not&nbsp;listen&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3375042">//&nbsp;both&nbsp;IPv4&nbsp;and&nbsp;IPv6&nbsp;connections.&nbsp;This&nbsp;is&nbsp;due&nbsp;to&nbsp;the&nbsp;fact&nbsp;that&nbsp;IPv4&nbsp;traffic</span><br>
<span class="lineno"></span><span class="comment" id="3375119">//&nbsp;will&nbsp;not&nbsp;be&nbsp;routed&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;socket&nbsp;-&nbsp;two&nbsp;separate&nbsp;sockets&nbsp;are&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="3375195">//&nbsp;if&nbsp;both&nbsp;AFs&nbsp;are&nbsp;to&nbsp;be&nbsp;supported.&nbsp;See&nbsp;inet6(4)&nbsp;on&nbsp;OpenBSD&nbsp;for&nbsp;details.</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3375269">func</span>&nbsp;<span class="ident" id="3375274">sockaddrToTCP</span><span class="op" id="3375287">(</span><span class="ident" id="3375288">sa</span>&nbsp;<span class="ident" id="3375291"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3375298">.</span><span class="ident" id="3375299"><a href="/gostd/syscall/syscall_unix.go.html#2547075">Sockaddr</a></span><span class="op" id="3375307">)</span>&nbsp;<span class="ident" id="3375309"><a href="/gostd/net/net.go.html#3334179">Addr</a></span>&nbsp;<span class="op" id="3375314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375317">switch</span>&nbsp;<span class="ident" id="3375324">sa</span>&nbsp;<span class="op" id="3375327">:=</span>&nbsp;<span class="ident" id="3375330"><a href="/gostd/net/tcpsock_posix.go.html#3375288">sa</a></span><span class="op" id="3375332">.</span><span class="op" id="3375333">(</span><span class="keyword" id="3375334">type</span><span class="op" id="3375338">)</span>&nbsp;<span class="op" id="3375340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375343">case</span>&nbsp;<span class="op" id="3375348">*</span><span class="ident" id="3375349"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3375356">.</span><span class="ident" id="3375357"><a href="/gostd/syscall/syscall_unix.go.html#2547205">SockaddrInet4</a></span><span class="op" id="3375370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375374">return</span>&nbsp;<span class="op" id="3375381">&amp;</span><span class="ident" id="3375382"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3375389">{</span><span class="ident" id="3375390"><a href="/gostd/net/tcpsock.go.html#3373487">IP</a></span><span class="op" id="3375392">:</span>&nbsp;<span class="ident" id="3375394"><a href="/gostd/net/tcpsock_posix.go.html#3375324">sa</a></span><span class="op" id="3375396">.</span><span class="ident" id="3375397"><a href="/gostd/syscall/syscall_unix.go.html#2547239">Addr</a></span><span class="op" id="3375401">[</span><span class="num" id="3375402">0</span><span class="op" id="3375403">:</span><span class="op" id="3375404">]</span><span class="op" id="3375405">,</span>&nbsp;<span class="ident" id="3375407"><a href="/gostd/net/tcpsock.go.html#3373496">Port</a></span><span class="op" id="3375411">:</span>&nbsp;<span class="ident" id="3375413"><a href="/gostd/net/tcpsock_posix.go.html#3375324">sa</a></span><span class="op" id="3375415">.</span><span class="ident" id="3375416"><a href="/gostd/syscall/syscall_unix.go.html#2547229">Port</a></span><span class="op" id="3375420">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375423">case</span>&nbsp;<span class="op" id="3375428">*</span><span class="ident" id="3375429"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3375436">.</span><span class="ident" id="3375437"><a href="/gostd/syscall/syscall_unix.go.html#2547283">SockaddrInet6</a></span><span class="op" id="3375450">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375454">return</span>&nbsp;<span class="op" id="3375461">&amp;</span><span class="ident" id="3375462"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3375469">{</span><span class="ident" id="3375470"><a href="/gostd/net/tcpsock.go.html#3373487">IP</a></span><span class="op" id="3375472">:</span>&nbsp;<span class="ident" id="3375474"><a href="/gostd/net/tcpsock_posix.go.html#3375324">sa</a></span><span class="op" id="3375476">.</span><span class="ident" id="3375477"><a href="/gostd/syscall/syscall_unix.go.html#2547334">Addr</a></span><span class="op" id="3375481">[</span><span class="num" id="3375482">0</span><span class="op" id="3375483">:</span><span class="op" id="3375484">]</span><span class="op" id="3375485">,</span>&nbsp;<span class="ident" id="3375487"><a href="/gostd/net/tcpsock.go.html#3373496">Port</a></span><span class="op" id="3375491">:</span>&nbsp;<span class="ident" id="3375493"><a href="/gostd/net/tcpsock_posix.go.html#3375324">sa</a></span><span class="op" id="3375495">.</span><span class="ident" id="3375496"><a href="/gostd/syscall/syscall_unix.go.html#2547307">Port</a></span><span class="op" id="3375500">,</span>&nbsp;<span class="ident" id="3375502"><a href="/gostd/net/tcpsock.go.html#3373506">Zone</a></span><span class="op" id="3375506">:</span>&nbsp;<span class="ident" id="3375508"><a href="/gostd/net/ipsock.go.html#3317149">zoneToString</a></span><span class="op" id="3375520">(</span><span class="builtintype" id="3375521">int</span><span class="op" id="3375524">(</span><span class="ident" id="3375525"><a href="/gostd/net/tcpsock_posix.go.html#3375324">sa</a></span><span class="op" id="3375527">.</span><span class="ident" id="3375528"><a href="/gostd/syscall/syscall_unix.go.html#2547319">ZoneId</a></span><span class="op" id="3375534">)</span><span class="op" id="3375535">)</span><span class="op" id="3375536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375542">return</span>&nbsp;<span class="builtintype" id="3375549">nil</span><br>
<span class="lineno"></span><span class="op" id="3375553">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3375556">func</span>&nbsp;<span class="op" id="3375561">(</span><span class="ident" id="3375562">a</span>&nbsp;<span class="op" id="3375564">*</span><span class="ident" id="3375565"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3375572">)</span>&nbsp;<span class="ident" id="3375574">family</span><span class="op" id="3375580">(</span><span class="op" id="3375581">)</span>&nbsp;<span class="builtintype" id="3375583">int</span>&nbsp;<span class="op" id="3375587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375590">if</span>&nbsp;<span class="ident" id="3375593"><a href="/gostd/net/tcpsock_posix.go.html#3375562">a</a></span>&nbsp;<span class="op" id="3375595">==</span>&nbsp;<span class="builtintype" id="3375598">nil</span>&nbsp;<span class="op" id="3375602">||</span>&nbsp;<span class="builtinfunc" id="3375605">len</span><span class="op" id="3375608">(</span><span class="ident" id="3375609"><a href="/gostd/net/tcpsock_posix.go.html#3375562">a</a></span><span class="op" id="3375610">.</span><span class="ident" id="3375611"><a href="/gostd/net/tcpsock.go.html#3373487">IP</a></span><span class="op" id="3375613">)</span>&nbsp;<span class="op" id="3375615">&lt;=</span>&nbsp;<span class="ident" id="3375618"><a href="/gostd/net/ip.go.html#3285851">IPv4len</a></span>&nbsp;<span class="op" id="3375626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375630">return</span>&nbsp;<span class="ident" id="3375637"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3375644">.</span><span class="ident" id="3375645"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551244">AF_INET</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375654">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375657">if</span>&nbsp;<span class="ident" id="3375660"><a href="/gostd/net/tcpsock_posix.go.html#3375562">a</a></span><span class="op" id="3375661">.</span><span class="ident" id="3375662"><a href="/gostd/net/tcpsock.go.html#3373487">IP</a></span><span class="op" id="3375664">.</span><span class="ident" id="3375665"><a href="/gostd/net/ip.go.html#3290039">To4</a></span><span class="op" id="3375668">(</span><span class="op" id="3375669">)</span>&nbsp;<span class="op" id="3375671">!=</span>&nbsp;<span class="builtintype" id="3375674">nil</span>&nbsp;<span class="op" id="3375678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375682">return</span>&nbsp;<span class="ident" id="3375689"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3375696">.</span><span class="ident" id="3375697"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551244">AF_INET</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375709">return</span>&nbsp;<span class="ident" id="3375716"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3375723">.</span><span class="ident" id="3375724"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551284">AF_INET6</a></span><br>
<span class="lineno"></span><span class="op" id="3375733">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3375736">func</span>&nbsp;<span class="op" id="3375741">(</span><span class="ident" id="3375742">a</span>&nbsp;<span class="op" id="3375744">*</span><span class="ident" id="3375745"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3375752">)</span>&nbsp;<span class="ident" id="3375754">isWildcard</span><span class="op" id="3375764">(</span><span class="op" id="3375765">)</span>&nbsp;<span class="builtintype" id="3375767">bool</span>&nbsp;<span class="op" id="3375772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375775">if</span>&nbsp;<span class="ident" id="3375778"><a href="/gostd/net/tcpsock_posix.go.html#3375742">a</a></span>&nbsp;<span class="op" id="3375780">==</span>&nbsp;<span class="builtintype" id="3375783">nil</span>&nbsp;<span class="op" id="3375787">||</span>&nbsp;<span class="ident" id="3375790"><a href="/gostd/net/tcpsock_posix.go.html#3375742">a</a></span><span class="op" id="3375791">.</span><span class="ident" id="3375792"><a href="/gostd/net/tcpsock.go.html#3373487">IP</a></span>&nbsp;<span class="op" id="3375795">==</span>&nbsp;<span class="builtintype" id="3375798">nil</span>&nbsp;<span class="op" id="3375802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375806">return</span>&nbsp;<span class="builtintype" id="3375813">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375819">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375822">return</span>&nbsp;<span class="ident" id="3375829"><a href="/gostd/net/tcpsock_posix.go.html#3375742">a</a></span><span class="op" id="3375830">.</span><span class="ident" id="3375831"><a href="/gostd/net/tcpsock.go.html#3373487">IP</a></span><span class="op" id="3375833">.</span><span class="ident" id="3375834"><a href="/gostd/net/ip.go.html#3288341">IsUnspecified</a></span><span class="op" id="3375847">(</span><span class="op" id="3375848">)</span><br>
<span class="lineno"></span><span class="op" id="3375850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3375853">func</span>&nbsp;<span class="op" id="3375858">(</span><span class="ident" id="3375859">a</span>&nbsp;<span class="op" id="3375861">*</span><span class="ident" id="3375862"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3375869">)</span>&nbsp;<span class="ident" id="3375871">sockaddr</span><span class="op" id="3375879">(</span><span class="ident" id="3375880">family</span>&nbsp;<span class="builtintype" id="3375887">int</span><span class="op" id="3375890">)</span>&nbsp;<span class="op" id="3375892">(</span><span class="ident" id="3375893"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3375900">.</span><span class="ident" id="3375901"><a href="/gostd/syscall/syscall_unix.go.html#2547075">Sockaddr</a></span><span class="op" id="3375909">,</span>&nbsp;<span class="builtintype" id="3375911">error</span><span class="op" id="3375916">)</span>&nbsp;<span class="op" id="3375918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375921">if</span>&nbsp;<span class="ident" id="3375924"><a href="/gostd/net/tcpsock_posix.go.html#3375859">a</a></span>&nbsp;<span class="op" id="3375926">==</span>&nbsp;<span class="builtintype" id="3375929">nil</span>&nbsp;<span class="op" id="3375933">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375937">return</span>&nbsp;<span class="builtintype" id="3375944">nil</span><span class="op" id="3375947">,</span>&nbsp;<span class="builtintype" id="3375949">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375957">return</span>&nbsp;<span class="ident" id="3375964"><a href="/gostd/net/ipsock_posix.go.html#3322112">ipToSockaddr</a></span><span class="op" id="3375976">(</span><span class="ident" id="3375977"><a href="/gostd/net/tcpsock_posix.go.html#3375880">family</a></span><span class="op" id="3375983">,</span>&nbsp;<span class="ident" id="3375985"><a href="/gostd/net/tcpsock_posix.go.html#3375859">a</a></span><span class="op" id="3375986">.</span><span class="ident" id="3375987"><a href="/gostd/net/tcpsock.go.html#3373487">IP</a></span><span class="op" id="3375989">,</span>&nbsp;<span class="ident" id="3375991"><a href="/gostd/net/tcpsock_posix.go.html#3375859">a</a></span><span class="op" id="3375992">.</span><span class="ident" id="3375993"><a href="/gostd/net/tcpsock.go.html#3373496">Port</a></span><span class="op" id="3375997">,</span>&nbsp;<span class="ident" id="3375999"><a href="/gostd/net/tcpsock_posix.go.html#3375859">a</a></span><span class="op" id="3376000">.</span><span class="ident" id="3376001"><a href="/gostd/net/tcpsock.go.html#3373506">Zone</a></span><span class="op" id="3376005">)</span><br>
<span class="lineno"></span><span class="op" id="3376007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="3376010">//&nbsp;TCPConn&nbsp;is&nbsp;an&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;interface&nbsp;for&nbsp;TCP&nbsp;network</span><br>
<span class="lineno"></span><span class="comment" id="3376080">//&nbsp;connections.</span><br>
<span class="lineno"></span><span class="keyword" id="3376096">type</span>&nbsp;<span class="ident" id="3376101">TCPConn</span>&nbsp;<span class="keyword" id="3376109">struct</span>&nbsp;<span class="op" id="3376116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376119"><a href="/gostd/net/net.go.html#3336184">conn</a></span><br>
<span class="lineno"></span><span class="op" id="3376124">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3376127">func</span>&nbsp;<span class="ident" id="3376132">newTCPConn</span><span class="op" id="3376142">(</span><span class="ident" id="3376143">fd</span>&nbsp;<span class="op" id="3376146">*</span><span class="ident" id="3376147"><a href="/gostd/net/fd_unix.go.html#3257361">netFD</a></span><span class="op" id="3376152">)</span>&nbsp;<span class="op" id="3376154">*</span><span class="ident" id="3376155"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span>&nbsp;<span class="op" id="3376163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376166">c</span>&nbsp;<span class="op" id="3376168">:=</span>&nbsp;<span class="op" id="3376171">&amp;</span><span class="ident" id="3376172"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3376179">{</span><span class="ident" id="3376180"><a href="/gostd/net/net.go.html#3336184">conn</a></span><span class="op" id="3376184">{</span><span class="ident" id="3376185"><a href="/gostd/net/tcpsock_posix.go.html#3376143">fd</a></span><span class="op" id="3376187">}</span><span class="op" id="3376188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376191"><a href="/gostd/net/tcpsock_posix.go.html#3376166">c</a></span><span class="op" id="3376192">.</span><span class="ident" id="3376193"><a href="/gostd/net/tcpsock_posix.go.html#3378168">SetNoDelay</a></span><span class="op" id="3376203">(</span><span class="builtintype" id="3376204">true</span><span class="op" id="3376208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376211">return</span>&nbsp;<span class="ident" id="3376218"><a href="/gostd/net/tcpsock_posix.go.html#3376166">c</a></span><br>
<span class="lineno">65</span><span class="op" id="3376220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3376223">//&nbsp;ReadFrom&nbsp;implements&nbsp;the&nbsp;io.ReaderFrom&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3376281">func</span>&nbsp;<span class="op" id="3376286">(</span><span class="ident" id="3376287">c</span>&nbsp;<span class="op" id="3376289">*</span><span class="ident" id="3376290"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3376297">)</span>&nbsp;<span class="ident" id="3376299">ReadFrom</span><span class="op" id="3376307">(</span><span class="ident" id="3376308">r</span>&nbsp;<span class="ident" id="3376310"><a href="/gostd/net/tcpsock_posix.go.html#3374933">io</a></span><span class="op" id="3376312">.</span><span class="ident" id="3376313"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="3376319">)</span>&nbsp;<span class="op" id="3376321">(</span><span class="builtintype" id="3376322">int64</span><span class="op" id="3376327">,</span>&nbsp;<span class="builtintype" id="3376329">error</span><span class="op" id="3376334">)</span>&nbsp;<span class="op" id="3376336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376339">if</span>&nbsp;<span class="ident" id="3376342">n</span><span class="op" id="3376343">,</span>&nbsp;<span class="ident" id="3376345">err</span><span class="op" id="3376348">,</span>&nbsp;<span class="ident" id="3376350">handled</span>&nbsp;<span class="op" id="3376358">:=</span>&nbsp;<span class="ident" id="3376361"><a href="/gostd/net/sendfile_linux.go.html#3353524">sendFile</a></span><span class="op" id="3376369">(</span><span class="ident" id="3376370"><a href="/gostd/net/tcpsock_posix.go.html#3376287">c</a></span><span class="op" id="3376371">.</span><span class="ident" id="3376372"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3376374">,</span>&nbsp;<span class="ident" id="3376376"><a href="/gostd/net/tcpsock_posix.go.html#3376308">r</a></span><span class="op" id="3376377">)</span><span class="op" id="3376378">;</span>&nbsp;<span class="ident" id="3376380"><a href="/gostd/net/tcpsock_posix.go.html#3376350">handled</a></span>&nbsp;<span class="op" id="3376388">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376392">return</span>&nbsp;<span class="ident" id="3376399"><a href="/gostd/net/tcpsock_posix.go.html#3376342">n</a></span><span class="op" id="3376400">,</span>&nbsp;<span class="ident" id="3376402"><a href="/gostd/net/tcpsock_posix.go.html#3376345">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376410">return</span>&nbsp;<span class="ident" id="3376417"><a href="/gostd/net/net.go.html#3343881">genericReadFrom</a></span><span class="op" id="3376432">(</span><span class="ident" id="3376433"><a href="/gostd/net/tcpsock_posix.go.html#3376287">c</a></span><span class="op" id="3376434">,</span>&nbsp;<span class="ident" id="3376436"><a href="/gostd/net/tcpsock_posix.go.html#3376308">r</a></span><span class="op" id="3376437">)</span><br>
<span class="lineno"></span><span class="op" id="3376439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="3376442">//&nbsp;CloseRead&nbsp;shuts&nbsp;down&nbsp;the&nbsp;reading&nbsp;side&nbsp;of&nbsp;the&nbsp;TCP&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3376506">//&nbsp;Most&nbsp;callers&nbsp;should&nbsp;just&nbsp;use&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="3376545">func</span>&nbsp;<span class="op" id="3376550">(</span><span class="ident" id="3376551">c</span>&nbsp;<span class="op" id="3376553">*</span><span class="ident" id="3376554"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3376561">)</span>&nbsp;<span class="ident" id="3376563">CloseRead</span><span class="op" id="3376572">(</span><span class="op" id="3376573">)</span>&nbsp;<span class="builtintype" id="3376575">error</span>&nbsp;<span class="op" id="3376581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376584">if</span>&nbsp;<span class="op" id="3376587">!</span><span class="ident" id="3376588"><a href="/gostd/net/tcpsock_posix.go.html#3376551">c</a></span><span class="op" id="3376589">.</span><span class="ident" id="3376590"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3376592">(</span><span class="op" id="3376593">)</span>&nbsp;<span class="op" id="3376595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376599">return</span>&nbsp;<span class="ident" id="3376606"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3376613">.</span><span class="ident" id="3376614"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376625">return</span>&nbsp;<span class="ident" id="3376632"><a href="/gostd/net/tcpsock_posix.go.html#3376551">c</a></span><span class="op" id="3376633">.</span><span class="ident" id="3376634"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3376636">.</span><span class="ident" id="3376637"><a href="/gostd/net/fd_unix.go.html#3262289">closeRead</a></span><span class="op" id="3376646">(</span><span class="op" id="3376647">)</span><br>
<span class="lineno"></span><span class="op" id="3376649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3376652">//&nbsp;CloseWrite&nbsp;shuts&nbsp;down&nbsp;the&nbsp;writing&nbsp;side&nbsp;of&nbsp;the&nbsp;TCP&nbsp;connection.</span><br>
<span class="lineno">85</span><span class="comment" id="3376717">//&nbsp;Most&nbsp;callers&nbsp;should&nbsp;just&nbsp;use&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="3376756">func</span>&nbsp;<span class="op" id="3376761">(</span><span class="ident" id="3376762">c</span>&nbsp;<span class="op" id="3376764">*</span><span class="ident" id="3376765"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3376772">)</span>&nbsp;<span class="ident" id="3376774">CloseWrite</span><span class="op" id="3376784">(</span><span class="op" id="3376785">)</span>&nbsp;<span class="builtintype" id="3376787">error</span>&nbsp;<span class="op" id="3376793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376796">if</span>&nbsp;<span class="op" id="3376799">!</span><span class="ident" id="3376800"><a href="/gostd/net/tcpsock_posix.go.html#3376762">c</a></span><span class="op" id="3376801">.</span><span class="ident" id="3376802"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3376804">(</span><span class="op" id="3376805">)</span>&nbsp;<span class="op" id="3376807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376811">return</span>&nbsp;<span class="ident" id="3376818"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3376825">.</span><span class="ident" id="3376826"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376834">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376837">return</span>&nbsp;<span class="ident" id="3376844"><a href="/gostd/net/tcpsock_posix.go.html#3376762">c</a></span><span class="op" id="3376845">.</span><span class="ident" id="3376846"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3376848">.</span><span class="ident" id="3376849"><a href="/gostd/net/fd_unix.go.html#3262366">closeWrite</a></span><span class="op" id="3376859">(</span><span class="op" id="3376860">)</span><br>
<span class="lineno"></span><span class="op" id="3376862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3376865">//&nbsp;SetLinger&nbsp;sets&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Close&nbsp;on&nbsp;a&nbsp;connection&nbsp;which&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="3376933">//&nbsp;has&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;sent&nbsp;or&nbsp;to&nbsp;be&nbsp;acknowledged.</span><br>
<span class="lineno">95</span><span class="comment" id="3376987">//</span><br>
<span class="lineno"></span><span class="comment" id="3376990">//&nbsp;If&nbsp;sec&nbsp;&lt;&nbsp;0&nbsp;(the&nbsp;default),&nbsp;the&nbsp;operating&nbsp;system&nbsp;finishes&nbsp;sending&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3377061">//&nbsp;data&nbsp;in&nbsp;the&nbsp;background.</span><br>
<span class="lineno"></span><span class="comment" id="3377088">//</span><br>
<span class="lineno"></span><span class="comment" id="3377091">//&nbsp;If&nbsp;sec&nbsp;==&nbsp;0,&nbsp;the&nbsp;operating&nbsp;system&nbsp;discards&nbsp;any&nbsp;unsent&nbsp;or</span><br>
<span class="lineno">100</span><span class="comment" id="3377151">//&nbsp;unacknowledged&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="3377175">//</span><br>
<span class="lineno"></span><span class="comment" id="3377178">//&nbsp;If&nbsp;sec&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;data&nbsp;is&nbsp;sent&nbsp;in&nbsp;the&nbsp;background&nbsp;as&nbsp;with&nbsp;sec&nbsp;&lt;&nbsp;0.&nbsp;On</span><br>
<span class="lineno"></span><span class="comment" id="3377248">//&nbsp;some&nbsp;operating&nbsp;systems&nbsp;after&nbsp;sec&nbsp;seconds&nbsp;have&nbsp;elapsed&nbsp;any&nbsp;remaining</span><br>
<span class="lineno"></span><span class="comment" id="3377319">//&nbsp;unsent&nbsp;data&nbsp;may&nbsp;be&nbsp;discarded.</span><br>
<span class="lineno">105</span><span class="keyword" id="3377352">func</span>&nbsp;<span class="op" id="3377357">(</span><span class="ident" id="3377358">c</span>&nbsp;<span class="op" id="3377360">*</span><span class="ident" id="3377361"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3377368">)</span>&nbsp;<span class="ident" id="3377370">SetLinger</span><span class="op" id="3377379">(</span><span class="ident" id="3377380">sec</span>&nbsp;<span class="builtintype" id="3377384">int</span><span class="op" id="3377387">)</span>&nbsp;<span class="builtintype" id="3377389">error</span>&nbsp;<span class="op" id="3377395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377398">if</span>&nbsp;<span class="op" id="3377401">!</span><span class="ident" id="3377402"><a href="/gostd/net/tcpsock_posix.go.html#3377358">c</a></span><span class="op" id="3377403">.</span><span class="ident" id="3377404"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3377406">(</span><span class="op" id="3377407">)</span>&nbsp;<span class="op" id="3377409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377413">return</span>&nbsp;<span class="ident" id="3377420"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3377427">.</span><span class="ident" id="3377428"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377439">return</span>&nbsp;<span class="ident" id="3377446"><a href="/gostd/net/sockopt_posix.go.html#3370406">setLinger</a></span><span class="op" id="3377455">(</span><span class="ident" id="3377456"><a href="/gostd/net/tcpsock_posix.go.html#3377358">c</a></span><span class="op" id="3377457">.</span><span class="ident" id="3377458"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3377460">,</span>&nbsp;<span class="ident" id="3377462"><a href="/gostd/net/tcpsock_posix.go.html#3377380">sec</a></span><span class="op" id="3377465">)</span><br>
<span class="lineno">110</span><span class="op" id="3377467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3377470">//&nbsp;SetKeepAlive&nbsp;sets&nbsp;whether&nbsp;the&nbsp;operating&nbsp;system&nbsp;should&nbsp;send</span><br>
<span class="lineno"></span><span class="comment" id="3377532">//&nbsp;keepalive&nbsp;messages&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3377573">func</span>&nbsp;<span class="op" id="3377578">(</span><span class="ident" id="3377579">c</span>&nbsp;<span class="op" id="3377581">*</span><span class="ident" id="3377582"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3377589">)</span>&nbsp;<span class="ident" id="3377591">SetKeepAlive</span><span class="op" id="3377603">(</span><span class="ident" id="3377604">keepalive</span>&nbsp;<span class="builtintype" id="3377614">bool</span><span class="op" id="3377618">)</span>&nbsp;<span class="builtintype" id="3377620">error</span>&nbsp;<span class="op" id="3377626">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377629">if</span>&nbsp;<span class="op" id="3377632">!</span><span class="ident" id="3377633"><a href="/gostd/net/tcpsock_posix.go.html#3377579">c</a></span><span class="op" id="3377634">.</span><span class="ident" id="3377635"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3377637">(</span><span class="op" id="3377638">)</span>&nbsp;<span class="op" id="3377640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377644">return</span>&nbsp;<span class="ident" id="3377651"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3377658">.</span><span class="ident" id="3377659"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377670">return</span>&nbsp;<span class="ident" id="3377677"><a href="/gostd/net/sockopt_posix.go.html#3370142">setKeepAlive</a></span><span class="op" id="3377689">(</span><span class="ident" id="3377690"><a href="/gostd/net/tcpsock_posix.go.html#3377579">c</a></span><span class="op" id="3377691">.</span><span class="ident" id="3377692"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3377694">,</span>&nbsp;<span class="ident" id="3377696"><a href="/gostd/net/tcpsock_posix.go.html#3377604">keepalive</a></span><span class="op" id="3377705">)</span><br>
<span class="lineno"></span><span class="op" id="3377707">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="3377710">//&nbsp;SetKeepAlivePeriod&nbsp;sets&nbsp;period&nbsp;between&nbsp;keep&nbsp;alives.</span><br>
<span class="lineno"></span><span class="keyword" id="3377765">func</span>&nbsp;<span class="op" id="3377770">(</span><span class="ident" id="3377771">c</span>&nbsp;<span class="op" id="3377773">*</span><span class="ident" id="3377774"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3377781">)</span>&nbsp;<span class="ident" id="3377783">SetKeepAlivePeriod</span><span class="op" id="3377801">(</span><span class="ident" id="3377802">d</span>&nbsp;<span class="ident" id="3377804"><a href="/gostd/net/tcpsock_posix.go.html#3374956">time</a></span><span class="op" id="3377808">.</span><span class="ident" id="3377809"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><span class="op" id="3377817">)</span>&nbsp;<span class="builtintype" id="3377819">error</span>&nbsp;<span class="op" id="3377825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377828">if</span>&nbsp;<span class="op" id="3377831">!</span><span class="ident" id="3377832"><a href="/gostd/net/tcpsock_posix.go.html#3377771">c</a></span><span class="op" id="3377833">.</span><span class="ident" id="3377834"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3377836">(</span><span class="op" id="3377837">)</span>&nbsp;<span class="op" id="3377839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377843">return</span>&nbsp;<span class="ident" id="3377850"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3377857">.</span><span class="ident" id="3377858"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377869">return</span>&nbsp;<span class="ident" id="3377876"><a href="/gostd/net/tcpsockopt_unix.go.html#3385071">setKeepAlivePeriod</a></span><span class="op" id="3377894">(</span><span class="ident" id="3377895"><a href="/gostd/net/tcpsock_posix.go.html#3377771">c</a></span><span class="op" id="3377896">.</span><span class="ident" id="3377897"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3377899">,</span>&nbsp;<span class="ident" id="3377901"><a href="/gostd/net/tcpsock_posix.go.html#3377802">d</a></span><span class="op" id="3377902">)</span><br>
<span class="lineno"></span><span class="op" id="3377904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3377907">//&nbsp;SetNoDelay&nbsp;controls&nbsp;whether&nbsp;the&nbsp;operating&nbsp;system&nbsp;should&nbsp;delay</span><br>
<span class="lineno">130</span><span class="comment" id="3377972">//&nbsp;packet&nbsp;transmission&nbsp;in&nbsp;hopes&nbsp;of&nbsp;sending&nbsp;fewer&nbsp;packets&nbsp;(Nagle&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3378038">//&nbsp;algorithm).&nbsp;&nbsp;The&nbsp;default&nbsp;is&nbsp;true&nbsp;(no&nbsp;delay),&nbsp;meaning&nbsp;that&nbsp;data&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3378107">//&nbsp;sent&nbsp;as&nbsp;soon&nbsp;as&nbsp;possible&nbsp;after&nbsp;a&nbsp;Write.</span><br>
<span class="lineno"></span><span class="keyword" id="3378150">func</span>&nbsp;<span class="op" id="3378155">(</span><span class="ident" id="3378156">c</span>&nbsp;<span class="op" id="3378158">*</span><span class="ident" id="3378159"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3378166">)</span>&nbsp;<span class="ident" id="3378168">SetNoDelay</span><span class="op" id="3378178">(</span><span class="ident" id="3378179">noDelay</span>&nbsp;<span class="builtintype" id="3378187">bool</span><span class="op" id="3378191">)</span>&nbsp;<span class="builtintype" id="3378193">error</span>&nbsp;<span class="op" id="3378199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378202">if</span>&nbsp;<span class="op" id="3378205">!</span><span class="ident" id="3378206"><a href="/gostd/net/tcpsock_posix.go.html#3378156">c</a></span><span class="op" id="3378207">.</span><span class="ident" id="3378208"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3378210">(</span><span class="op" id="3378211">)</span>&nbsp;<span class="op" id="3378213">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378217">return</span>&nbsp;<span class="ident" id="3378224"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3378231">.</span><span class="ident" id="3378232"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3378240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378243">return</span>&nbsp;<span class="ident" id="3378250"><a href="/gostd/net/tcpsockopt_posix.go.html#3384562">setNoDelay</a></span><span class="op" id="3378260">(</span><span class="ident" id="3378261"><a href="/gostd/net/tcpsock_posix.go.html#3378156">c</a></span><span class="op" id="3378262">.</span><span class="ident" id="3378263"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3378265">,</span>&nbsp;<span class="ident" id="3378267"><a href="/gostd/net/tcpsock_posix.go.html#3378179">noDelay</a></span><span class="op" id="3378274">)</span><br>
<span class="lineno"></span><span class="op" id="3378276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3378279">//&nbsp;DialTCP&nbsp;connects&nbsp;to&nbsp;the&nbsp;remote&nbsp;address&nbsp;raddr&nbsp;on&nbsp;the&nbsp;network&nbsp;net,</span><br>
<span class="lineno"></span><span class="comment" id="3378347">//&nbsp;which&nbsp;must&nbsp;be&nbsp;&#34;tcp&#34;,&nbsp;&#34;tcp4&#34;,&nbsp;or&nbsp;&#34;tcp6&#34;.&nbsp;&nbsp;If&nbsp;laddr&nbsp;is&nbsp;not&nbsp;nil,&nbsp;it&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3378418">//&nbsp;used&nbsp;as&nbsp;the&nbsp;local&nbsp;address&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3378467">func</span>&nbsp;<span class="ident" id="3378472">DialTCP</span><span class="op" id="3378479">(</span><span class="ident" id="3378480">net</span>&nbsp;<span class="builtintype" id="3378484">string</span><span class="op" id="3378490">,</span>&nbsp;<span class="ident" id="3378492">laddr</span><span class="op" id="3378497">,</span>&nbsp;<span class="ident" id="3378499">raddr</span>&nbsp;<span class="op" id="3378505">*</span><span class="ident" id="3378506"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3378513">)</span>&nbsp;<span class="op" id="3378515">(</span><span class="op" id="3378516">*</span><span class="ident" id="3378517"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3378524">,</span>&nbsp;<span class="builtintype" id="3378526">error</span><span class="op" id="3378531">)</span>&nbsp;<span class="op" id="3378533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378536">switch</span>&nbsp;<span class="ident" id="3378543"><a href="/gostd/net/tcpsock_posix.go.html#3378480">net</a></span>&nbsp;<span class="op" id="3378547">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378550">case</span>&nbsp;<span class="string" id="3378555">&#34;tcp&#34;</span><span class="op" id="3378560">,</span>&nbsp;<span class="string" id="3378562">&#34;tcp4&#34;</span><span class="op" id="3378568">,</span>&nbsp;<span class="string" id="3378570">&#34;tcp6&#34;</span><span class="op" id="3378576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378579">default</span><span class="op" id="3378586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378590">return</span>&nbsp;<span class="builtintype" id="3378597">nil</span><span class="op" id="3378600">,</span>&nbsp;<span class="op" id="3378602">&amp;</span><span class="ident" id="3378603"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3378610">{</span><span class="ident" id="3378611"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3378613">:</span>&nbsp;<span class="string" id="3378615">&#34;dial&#34;</span><span class="op" id="3378621">,</span>&nbsp;<span class="ident" id="3378623"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3378626">:</span>&nbsp;<span class="ident" id="3378628"><a href="/gostd/net/tcpsock_posix.go.html#3378480">net</a></span><span class="op" id="3378631">,</span>&nbsp;<span class="ident" id="3378633"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3378637">:</span>&nbsp;<span class="ident" id="3378639"><a href="/gostd/net/tcpsock_posix.go.html#3378499">raddr</a></span><span class="op" id="3378644">,</span>&nbsp;<span class="ident" id="3378646"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3378649">:</span>&nbsp;<span class="ident" id="3378651"><a href="/gostd/net/net.go.html#3342949">UnknownNetworkError</a></span><span class="op" id="3378670">(</span><span class="ident" id="3378671"><a href="/gostd/net/tcpsock_posix.go.html#3378480">net</a></span><span class="op" id="3378674">)</span><span class="op" id="3378675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3378678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378681">if</span>&nbsp;<span class="ident" id="3378684"><a href="/gostd/net/tcpsock_posix.go.html#3378499">raddr</a></span>&nbsp;<span class="op" id="3378690">==</span>&nbsp;<span class="builtintype" id="3378693">nil</span>&nbsp;<span class="op" id="3378697">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378701">return</span>&nbsp;<span class="builtintype" id="3378708">nil</span><span class="op" id="3378711">,</span>&nbsp;<span class="op" id="3378713">&amp;</span><span class="ident" id="3378714"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3378721">{</span><span class="ident" id="3378722"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3378724">:</span>&nbsp;<span class="string" id="3378726">&#34;dial&#34;</span><span class="op" id="3378732">,</span>&nbsp;<span class="ident" id="3378734"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3378737">:</span>&nbsp;<span class="ident" id="3378739"><a href="/gostd/net/tcpsock_posix.go.html#3378480">net</a></span><span class="op" id="3378742">,</span>&nbsp;<span class="ident" id="3378744"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3378748">:</span>&nbsp;<span class="builtintype" id="3378750">nil</span><span class="op" id="3378753">,</span>&nbsp;<span class="ident" id="3378755"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3378758">:</span>&nbsp;<span class="ident" id="3378760"><a href="/gostd/net/net.go.html#3341102">errMissingAddress</a></span><span class="op" id="3378777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3378780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378783">return</span>&nbsp;<span class="ident" id="3378790"><a href="/gostd/net/tcpsock_posix.go.html#3378837">dialTCP</a></span><span class="op" id="3378797">(</span><span class="ident" id="3378798"><a href="/gostd/net/tcpsock_posix.go.html#3378480">net</a></span><span class="op" id="3378801">,</span>&nbsp;<span class="ident" id="3378803"><a href="/gostd/net/tcpsock_posix.go.html#3378492">laddr</a></span><span class="op" id="3378808">,</span>&nbsp;<span class="ident" id="3378810"><a href="/gostd/net/tcpsock_posix.go.html#3378499">raddr</a></span><span class="op" id="3378815">,</span>&nbsp;<span class="ident" id="3378817"><a href="/gostd/net/net.go.html#3342276">noDeadline</a></span><span class="op" id="3378827">)</span><br>
<span class="lineno"></span><span class="op" id="3378829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="3378832">func</span>&nbsp;<span class="ident" id="3378837">dialTCP</span><span class="op" id="3378844">(</span><span class="ident" id="3378845">net</span>&nbsp;<span class="builtintype" id="3378849">string</span><span class="op" id="3378855">,</span>&nbsp;<span class="ident" id="3378857">laddr</span><span class="op" id="3378862">,</span>&nbsp;<span class="ident" id="3378864">raddr</span>&nbsp;<span class="op" id="3378870">*</span><span class="ident" id="3378871"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3378878">,</span>&nbsp;<span class="ident" id="3378880">deadline</span>&nbsp;<span class="ident" id="3378889"><a href="/gostd/net/tcpsock_posix.go.html#3374956">time</a></span><span class="op" id="3378893">.</span><span class="ident" id="3378894"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="3378898">)</span>&nbsp;<span class="op" id="3378900">(</span><span class="op" id="3378901">*</span><span class="ident" id="3378902"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3378909">,</span>&nbsp;<span class="builtintype" id="3378911">error</span><span class="op" id="3378916">)</span>&nbsp;<span class="op" id="3378918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3378921">fd</span><span class="op" id="3378923">,</span>&nbsp;<span class="ident" id="3378925">err</span>&nbsp;<span class="op" id="3378929">:=</span>&nbsp;<span class="ident" id="3378932"><a href="/gostd/net/ipsock_posix.go.html#3321835">internetSocket</a></span><span class="op" id="3378946">(</span><span class="ident" id="3378947"><a href="/gostd/net/tcpsock_posix.go.html#3378845">net</a></span><span class="op" id="3378950">,</span>&nbsp;<span class="ident" id="3378952"><a href="/gostd/net/tcpsock_posix.go.html#3378857">laddr</a></span><span class="op" id="3378957">,</span>&nbsp;<span class="ident" id="3378959"><a href="/gostd/net/tcpsock_posix.go.html#3378864">raddr</a></span><span class="op" id="3378964">,</span>&nbsp;<span class="ident" id="3378966"><a href="/gostd/net/tcpsock_posix.go.html#3378880">deadline</a></span><span class="op" id="3378974">,</span>&nbsp;<span class="ident" id="3378976"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3378983">.</span><span class="ident" id="3378984"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592030">SOCK_STREAM</a></span><span class="op" id="3378995">,</span>&nbsp;<span class="num" id="3378997">0</span><span class="op" id="3378998">,</span>&nbsp;<span class="string" id="3379000">&#34;dial&#34;</span><span class="op" id="3379006">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379010">//&nbsp;TCP&nbsp;has&nbsp;a&nbsp;rarely&nbsp;used&nbsp;mechanism&nbsp;called&nbsp;a&nbsp;&#39;simultaneous&nbsp;connection&#39;&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379084">//&nbsp;which&nbsp;Dial(&#34;tcp&#34;,&nbsp;addr1,&nbsp;addr2)&nbsp;run&nbsp;on&nbsp;the&nbsp;machine&nbsp;at&nbsp;addr1&nbsp;can</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379152">//&nbsp;connect&nbsp;to&nbsp;a&nbsp;simultaneous&nbsp;Dial(&#34;tcp&#34;,&nbsp;addr2,&nbsp;addr1)&nbsp;run&nbsp;on&nbsp;the&nbsp;machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379227">//&nbsp;at&nbsp;addr2,&nbsp;without&nbsp;either&nbsp;machine&nbsp;executing&nbsp;Listen.&nbsp;&nbsp;If&nbsp;laddr&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379300">//&nbsp;it&nbsp;means&nbsp;we&nbsp;want&nbsp;the&nbsp;kernel&nbsp;to&nbsp;pick&nbsp;an&nbsp;appropriate&nbsp;originating&nbsp;local</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379373">//&nbsp;address.&nbsp;&nbsp;Some&nbsp;Linux&nbsp;kernels&nbsp;cycle&nbsp;blindly&nbsp;through&nbsp;a&nbsp;fixed&nbsp;range&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379445">//&nbsp;local&nbsp;ports,&nbsp;regardless&nbsp;of&nbsp;destination&nbsp;port.&nbsp;&nbsp;If&nbsp;a&nbsp;kernel&nbsp;happens&nbsp;to</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379518">//&nbsp;pick&nbsp;local&nbsp;port&nbsp;50001&nbsp;as&nbsp;the&nbsp;source&nbsp;for&nbsp;a&nbsp;Dial(&#34;tcp&#34;,&nbsp;&#34;&#34;,&nbsp;&#34;localhost:50001&#34;),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379600">//&nbsp;then&nbsp;the&nbsp;Dial&nbsp;will&nbsp;succeed,&nbsp;having&nbsp;simultaneously&nbsp;connected&nbsp;to&nbsp;itself.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379675">//&nbsp;This&nbsp;can&nbsp;only&nbsp;happen&nbsp;when&nbsp;we&nbsp;are&nbsp;letting&nbsp;the&nbsp;kernel&nbsp;pick&nbsp;a&nbsp;port&nbsp;(laddr&nbsp;==&nbsp;nil)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379758">//&nbsp;and&nbsp;when&nbsp;there&nbsp;is&nbsp;no&nbsp;listener&nbsp;for&nbsp;the&nbsp;destination&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379821">//&nbsp;It&#39;s&nbsp;hard&nbsp;to&nbsp;argue&nbsp;this&nbsp;is&nbsp;anything&nbsp;other&nbsp;than&nbsp;a&nbsp;kernel&nbsp;bug.&nbsp;&nbsp;If&nbsp;we</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379893">//&nbsp;see&nbsp;this&nbsp;happen,&nbsp;rather&nbsp;than&nbsp;expose&nbsp;the&nbsp;buggy&nbsp;effect&nbsp;to&nbsp;users,&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3379963">//&nbsp;close&nbsp;the&nbsp;fd&nbsp;and&nbsp;try&nbsp;again.&nbsp;&nbsp;If&nbsp;it&nbsp;happens&nbsp;twice&nbsp;more,&nbsp;we&nbsp;relent&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380036">//&nbsp;use&nbsp;the&nbsp;result.&nbsp;&nbsp;See&nbsp;also:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380067">//&nbsp;&nbsp;&nbsp;&nbsp;http://golang.org/issue/2690</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380100">//&nbsp;&nbsp;&nbsp;&nbsp;http://stackoverflow.com/questions/4949858/</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380148">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380152">//&nbsp;The&nbsp;opposite&nbsp;can&nbsp;also&nbsp;happen:&nbsp;if&nbsp;we&nbsp;ask&nbsp;the&nbsp;kernel&nbsp;to&nbsp;pick&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380230">//&nbsp;originating&nbsp;local&nbsp;address,&nbsp;sometimes&nbsp;it&nbsp;picks&nbsp;one&nbsp;that&nbsp;is&nbsp;already&nbsp;in&nbsp;use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380308">//&nbsp;So&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;EADDRNOTAVAIL,&nbsp;we&nbsp;have&nbsp;to&nbsp;try&nbsp;again&nbsp;too,&nbsp;just&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380381">//&nbsp;a&nbsp;different&nbsp;reason.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380405">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380409">//&nbsp;The&nbsp;kernel&nbsp;socket&nbsp;code&nbsp;is&nbsp;no&nbsp;doubt&nbsp;enjoying&nbsp;watching&nbsp;us&nbsp;squirm.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3380477">for</span>&nbsp;<span class="ident" id="3380481">i</span>&nbsp;<span class="op" id="3380483">:=</span>&nbsp;<span class="num" id="3380486">0</span><span class="op" id="3380487">;</span>&nbsp;<span class="ident" id="3380489"><a href="/gostd/net/tcpsock_posix.go.html#3380481">i</a></span>&nbsp;<span class="op" id="3380491">&lt;</span>&nbsp;<span class="num" id="3380493">2</span>&nbsp;<span class="op" id="3380495">&amp;&amp;</span>&nbsp;<span class="op" id="3380498">(</span><span class="ident" id="3380499"><a href="/gostd/net/tcpsock_posix.go.html#3378857">laddr</a></span>&nbsp;<span class="op" id="3380505">==</span>&nbsp;<span class="builtintype" id="3380508">nil</span>&nbsp;<span class="op" id="3380512">||</span>&nbsp;<span class="ident" id="3380515"><a href="/gostd/net/tcpsock_posix.go.html#3378857">laddr</a></span><span class="op" id="3380520">.</span><span class="ident" id="3380521"><a href="/gostd/net/tcpsock.go.html#3373496">Port</a></span>&nbsp;<span class="op" id="3380526">==</span>&nbsp;<span class="num" id="3380529">0</span><span class="op" id="3380530">)</span>&nbsp;<span class="op" id="3380532">&amp;&amp;</span>&nbsp;<span class="op" id="3380535">(</span><span class="ident" id="3380536"><a href="/gostd/net/tcpsock_posix.go.html#3380843">selfConnect</a></span><span class="op" id="3380547">(</span><span class="ident" id="3380548"><a href="/gostd/net/tcpsock_posix.go.html#3378921">fd</a></span><span class="op" id="3380550">,</span>&nbsp;<span class="ident" id="3380552"><a href="/gostd/net/tcpsock_posix.go.html#3378925">err</a></span><span class="op" id="3380555">)</span>&nbsp;<span class="op" id="3380557">||</span>&nbsp;<span class="ident" id="3380560"><a href="/gostd/net/tcpsock_posix.go.html#3381665">spuriousENOTAVAIL</a></span><span class="op" id="3380577">(</span><span class="ident" id="3380578"><a href="/gostd/net/tcpsock_posix.go.html#3378925">err</a></span><span class="op" id="3380581">)</span><span class="op" id="3380582">)</span><span class="op" id="3380583">;</span>&nbsp;<span class="ident" id="3380585"><a href="/gostd/net/tcpsock_posix.go.html#3380481">i</a></span><span class="op" id="3380586">++</span>&nbsp;<span class="op" id="3380589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3380593">if</span>&nbsp;<span class="ident" id="3380596"><a href="/gostd/net/tcpsock_posix.go.html#3378925">err</a></span>&nbsp;<span class="op" id="3380600">==</span>&nbsp;<span class="builtintype" id="3380603">nil</span>&nbsp;<span class="op" id="3380607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3380612"><a href="/gostd/net/tcpsock_posix.go.html#3378921">fd</a></span><span class="op" id="3380614">.</span><span class="ident" id="3380615"><a href="/gostd/net/fd_unix.go.html#3261468">Close</a></span><span class="op" id="3380620">(</span><span class="op" id="3380621">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3380625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3380629"><a href="/gostd/net/tcpsock_posix.go.html#3378921">fd</a></span><span class="op" id="3380631">,</span>&nbsp;<span class="ident" id="3380633"><a href="/gostd/net/tcpsock_posix.go.html#3378925">err</a></span>&nbsp;<span class="op" id="3380637">=</span>&nbsp;<span class="ident" id="3380639"><a href="/gostd/net/ipsock_posix.go.html#3321835">internetSocket</a></span><span class="op" id="3380653">(</span><span class="ident" id="3380654"><a href="/gostd/net/tcpsock_posix.go.html#3378845">net</a></span><span class="op" id="3380657">,</span>&nbsp;<span class="ident" id="3380659"><a href="/gostd/net/tcpsock_posix.go.html#3378857">laddr</a></span><span class="op" id="3380664">,</span>&nbsp;<span class="ident" id="3380666"><a href="/gostd/net/tcpsock_posix.go.html#3378864">raddr</a></span><span class="op" id="3380671">,</span>&nbsp;<span class="ident" id="3380673"><a href="/gostd/net/tcpsock_posix.go.html#3378880">deadline</a></span><span class="op" id="3380681">,</span>&nbsp;<span class="ident" id="3380683"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3380690">.</span><span class="ident" id="3380691"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592030">SOCK_STREAM</a></span><span class="op" id="3380702">,</span>&nbsp;<span class="num" id="3380704">0</span><span class="op" id="3380705">,</span>&nbsp;<span class="string" id="3380707">&#34;dial&#34;</span><span class="op" id="3380713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3380716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3380720">if</span>&nbsp;<span class="ident" id="3380723"><a href="/gostd/net/tcpsock_posix.go.html#3378925">err</a></span>&nbsp;<span class="op" id="3380727">!=</span>&nbsp;<span class="builtintype" id="3380730">nil</span>&nbsp;<span class="op" id="3380734">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3380738">return</span>&nbsp;<span class="builtintype" id="3380745">nil</span><span class="op" id="3380748">,</span>&nbsp;<span class="op" id="3380750">&amp;</span><span class="ident" id="3380751"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3380758">{</span><span class="ident" id="3380759"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3380761">:</span>&nbsp;<span class="string" id="3380763">&#34;dial&#34;</span><span class="op" id="3380769">,</span>&nbsp;<span class="ident" id="3380771"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3380774">:</span>&nbsp;<span class="ident" id="3380776"><a href="/gostd/net/tcpsock_posix.go.html#3378845">net</a></span><span class="op" id="3380779">,</span>&nbsp;<span class="ident" id="3380781"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3380785">:</span>&nbsp;<span class="ident" id="3380787"><a href="/gostd/net/tcpsock_posix.go.html#3378864">raddr</a></span><span class="op" id="3380792">,</span>&nbsp;<span class="ident" id="3380794"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3380797">:</span>&nbsp;<span class="ident" id="3380799"><a href="/gostd/net/tcpsock_posix.go.html#3378925">err</a></span><span class="op" id="3380802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3380805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3380808">return</span>&nbsp;<span class="ident" id="3380815"><a href="/gostd/net/tcpsock_posix.go.html#3376132">newTCPConn</a></span><span class="op" id="3380825">(</span><span class="ident" id="3380826"><a href="/gostd/net/tcpsock_posix.go.html#3378921">fd</a></span><span class="op" id="3380828">)</span><span class="op" id="3380829">,</span>&nbsp;<span class="builtintype" id="3380831">nil</span><br>
<span class="lineno"></span><span class="op" id="3380835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="keyword" id="3380838">func</span>&nbsp;<span class="ident" id="3380843">selfConnect</span><span class="op" id="3380854">(</span><span class="ident" id="3380855">fd</span>&nbsp;<span class="op" id="3380858">*</span><span class="ident" id="3380859"><a href="/gostd/net/fd_unix.go.html#3257361">netFD</a></span><span class="op" id="3380864">,</span>&nbsp;<span class="ident" id="3380866">err</span>&nbsp;<span class="builtintype" id="3380870">error</span><span class="op" id="3380875">)</span>&nbsp;<span class="builtintype" id="3380877">bool</span>&nbsp;<span class="op" id="3380882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380885">//&nbsp;If&nbsp;the&nbsp;connect&nbsp;failed,&nbsp;we&nbsp;clearly&nbsp;didn&#39;t&nbsp;connect&nbsp;to&nbsp;ourselves.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3380952">if</span>&nbsp;<span class="ident" id="3380955"><a href="/gostd/net/tcpsock_posix.go.html#3380866">err</a></span>&nbsp;<span class="op" id="3380959">!=</span>&nbsp;<span class="builtintype" id="3380962">nil</span>&nbsp;<span class="op" id="3380966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3380970">return</span>&nbsp;<span class="builtintype" id="3380977">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3380984">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3380988">//&nbsp;The&nbsp;socket&nbsp;constructor&nbsp;can&nbsp;return&nbsp;an&nbsp;fd&nbsp;with&nbsp;raddr&nbsp;nil&nbsp;under&nbsp;certain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3381061">//&nbsp;unknown&nbsp;conditions.&nbsp;The&nbsp;errors&nbsp;in&nbsp;the&nbsp;calls&nbsp;there&nbsp;to&nbsp;Getpeername</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3381130">//&nbsp;are&nbsp;discarded,&nbsp;but&nbsp;we&nbsp;can&#39;t&nbsp;catch&nbsp;the&nbsp;problem&nbsp;there&nbsp;because&nbsp;those</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3381200">//&nbsp;calls&nbsp;are&nbsp;sometimes&nbsp;legally&nbsp;erroneous&nbsp;with&nbsp;a&nbsp;&#34;socket&nbsp;not&nbsp;connected&#34;.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3381273">//&nbsp;Since&nbsp;this&nbsp;code&nbsp;(selfConnect)&nbsp;is&nbsp;already&nbsp;trying&nbsp;to&nbsp;work&nbsp;around</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3381340">//&nbsp;a&nbsp;problem,&nbsp;we&nbsp;make&nbsp;sure&nbsp;if&nbsp;this&nbsp;happens&nbsp;we&nbsp;recognize&nbsp;trouble&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3381409">//&nbsp;ask&nbsp;the&nbsp;DialTCP&nbsp;routine&nbsp;to&nbsp;try&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3381451">//&nbsp;TODO:&nbsp;try&nbsp;to&nbsp;understand&nbsp;what&#39;s&nbsp;really&nbsp;going&nbsp;on.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3381503">if</span>&nbsp;<span class="ident" id="3381506"><a href="/gostd/net/tcpsock_posix.go.html#3380855">fd</a></span><span class="op" id="3381508">.</span><span class="ident" id="3381509"><a href="/gostd/net/fd_unix.go.html#3257582">laddr</a></span>&nbsp;<span class="op" id="3381515">==</span>&nbsp;<span class="builtintype" id="3381518">nil</span>&nbsp;<span class="op" id="3381522">||</span>&nbsp;<span class="ident" id="3381525"><a href="/gostd/net/tcpsock_posix.go.html#3380855">fd</a></span><span class="op" id="3381527">.</span><span class="ident" id="3381528"><a href="/gostd/net/fd_unix.go.html#3257600">raddr</a></span>&nbsp;<span class="op" id="3381534">==</span>&nbsp;<span class="builtintype" id="3381537">nil</span>&nbsp;<span class="op" id="3381541">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3381545">return</span>&nbsp;<span class="builtintype" id="3381552">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3381558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3381561">l</span>&nbsp;<span class="op" id="3381563">:=</span>&nbsp;<span class="ident" id="3381566"><a href="/gostd/net/tcpsock_posix.go.html#3380855">fd</a></span><span class="op" id="3381568">.</span><span class="ident" id="3381569"><a href="/gostd/net/fd_unix.go.html#3257582">laddr</a></span><span class="op" id="3381574">.</span><span class="op" id="3381575">(</span><span class="op" id="3381576">*</span><span class="ident" id="3381577"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3381584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3381587">r</span>&nbsp;<span class="op" id="3381589">:=</span>&nbsp;<span class="ident" id="3381592"><a href="/gostd/net/tcpsock_posix.go.html#3380855">fd</a></span><span class="op" id="3381594">.</span><span class="ident" id="3381595"><a href="/gostd/net/fd_unix.go.html#3257600">raddr</a></span><span class="op" id="3381600">.</span><span class="op" id="3381601">(</span><span class="op" id="3381602">*</span><span class="ident" id="3381603"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3381610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3381613">return</span>&nbsp;<span class="ident" id="3381620"><a href="/gostd/net/tcpsock_posix.go.html#3381561">l</a></span><span class="op" id="3381621">.</span><span class="ident" id="3381622"><a href="/gostd/net/tcpsock.go.html#3373496">Port</a></span>&nbsp;<span class="op" id="3381627">==</span>&nbsp;<span class="ident" id="3381630"><a href="/gostd/net/tcpsock_posix.go.html#3381587">r</a></span><span class="op" id="3381631">.</span><span class="ident" id="3381632"><a href="/gostd/net/tcpsock.go.html#3373496">Port</a></span>&nbsp;<span class="op" id="3381637">&amp;&amp;</span>&nbsp;<span class="ident" id="3381640"><a href="/gostd/net/tcpsock_posix.go.html#3381561">l</a></span><span class="op" id="3381641">.</span><span class="ident" id="3381642"><a href="/gostd/net/tcpsock.go.html#3373487">IP</a></span><span class="op" id="3381644">.</span><span class="ident" id="3381645"><a href="/gostd/net/ip.go.html#3293893">Equal</a></span><span class="op" id="3381650">(</span><span class="ident" id="3381651"><a href="/gostd/net/tcpsock_posix.go.html#3381587">r</a></span><span class="op" id="3381652">.</span><span class="ident" id="3381653"><a href="/gostd/net/tcpsock.go.html#3373487">IP</a></span><span class="op" id="3381655">)</span><br>
<span class="lineno">215</span><span class="op" id="3381657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3381660">func</span>&nbsp;<span class="ident" id="3381665">spuriousENOTAVAIL</span><span class="op" id="3381682">(</span><span class="ident" id="3381683">err</span>&nbsp;<span class="builtintype" id="3381687">error</span><span class="op" id="3381692">)</span>&nbsp;<span class="builtintype" id="3381694">bool</span>&nbsp;<span class="op" id="3381699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3381702">e</span><span class="op" id="3381703">,</span>&nbsp;<span class="ident" id="3381705">ok</span>&nbsp;<span class="op" id="3381708">:=</span>&nbsp;<span class="ident" id="3381711"><a href="/gostd/net/tcpsock_posix.go.html#3381683">err</a></span><span class="op" id="3381714">.</span><span class="op" id="3381715">(</span><span class="op" id="3381716">*</span><span class="ident" id="3381717"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3381724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3381727">return</span>&nbsp;<span class="ident" id="3381734"><a href="/gostd/net/tcpsock_posix.go.html#3381705">ok</a></span>&nbsp;<span class="op" id="3381737">&amp;&amp;</span>&nbsp;<span class="ident" id="3381740"><a href="/gostd/net/tcpsock_posix.go.html#3381702">e</a></span><span class="op" id="3381741">.</span><span class="ident" id="3381742"><a href="/gostd/net/net.go.html#3341902">Err</a></span>&nbsp;<span class="op" id="3381746">==</span>&nbsp;<span class="ident" id="3381749"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3381756">.</span><span class="ident" id="3381757"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2600220">EADDRNOTAVAIL</a></span><br>
<span class="lineno">220</span><span class="op" id="3381771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3381774">//&nbsp;TCPListener&nbsp;is&nbsp;a&nbsp;TCP&nbsp;network&nbsp;listener.&nbsp;&nbsp;Clients&nbsp;should&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="3381842">//&nbsp;use&nbsp;variables&nbsp;of&nbsp;type&nbsp;Listener&nbsp;instead&nbsp;of&nbsp;assuming&nbsp;TCP.</span><br>
<span class="lineno"></span><span class="keyword" id="3381901">type</span>&nbsp;<span class="ident" id="3381906">TCPListener</span>&nbsp;<span class="keyword" id="3381918">struct</span>&nbsp;<span class="op" id="3381925">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3381928">fd</span>&nbsp;<span class="op" id="3381931">*</span><span class="ident" id="3381932"><a href="/gostd/net/fd_unix.go.html#3257361">netFD</a></span><br>
<span class="lineno"></span><span class="op" id="3381938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3381941">//&nbsp;AcceptTCP&nbsp;accepts&nbsp;the&nbsp;next&nbsp;incoming&nbsp;call&nbsp;and&nbsp;returns&nbsp;the&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="3382005">//&nbsp;connection.</span><br>
<span class="lineno">230</span><span class="keyword" id="3382020">func</span>&nbsp;<span class="op" id="3382025">(</span><span class="ident" id="3382026">l</span>&nbsp;<span class="op" id="3382028">*</span><span class="ident" id="3382029"><a href="/gostd/net/tcpsock_posix.go.html#3381906">TCPListener</a></span><span class="op" id="3382040">)</span>&nbsp;<span class="ident" id="3382042">AcceptTCP</span><span class="op" id="3382051">(</span><span class="op" id="3382052">)</span>&nbsp;<span class="op" id="3382054">(</span><span class="op" id="3382055">*</span><span class="ident" id="3382056"><a href="/gostd/net/tcpsock_posix.go.html#3376101">TCPConn</a></span><span class="op" id="3382063">,</span>&nbsp;<span class="builtintype" id="3382065">error</span><span class="op" id="3382070">)</span>&nbsp;<span class="op" id="3382072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382075">if</span>&nbsp;<span class="ident" id="3382078"><a href="/gostd/net/tcpsock_posix.go.html#3382026">l</a></span>&nbsp;<span class="op" id="3382080">==</span>&nbsp;<span class="builtintype" id="3382083">nil</span>&nbsp;<span class="op" id="3382087">||</span>&nbsp;<span class="ident" id="3382090"><a href="/gostd/net/tcpsock_posix.go.html#3382026">l</a></span><span class="op" id="3382091">.</span><span class="ident" id="3382092"><a href="/gostd/net/tcpsock_posix.go.html#3381928">fd</a></span>&nbsp;<span class="op" id="3382095">==</span>&nbsp;<span class="builtintype" id="3382098">nil</span>&nbsp;<span class="op" id="3382102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382106">return</span>&nbsp;<span class="builtintype" id="3382113">nil</span><span class="op" id="3382116">,</span>&nbsp;<span class="ident" id="3382118"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3382125">.</span><span class="ident" id="3382126"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3382134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3382137">fd</span><span class="op" id="3382139">,</span>&nbsp;<span class="ident" id="3382141">err</span>&nbsp;<span class="op" id="3382145">:=</span>&nbsp;<span class="ident" id="3382148"><a href="/gostd/net/tcpsock_posix.go.html#3382026">l</a></span><span class="op" id="3382149">.</span><span class="ident" id="3382150"><a href="/gostd/net/tcpsock_posix.go.html#3381928">fd</a></span><span class="op" id="3382152">.</span><span class="ident" id="3382153"><a href="/gostd/net/fd_unix.go.html#3266187">accept</a></span><span class="op" id="3382159">(</span><span class="op" id="3382160">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382163">if</span>&nbsp;<span class="ident" id="3382166"><a href="/gostd/net/tcpsock_posix.go.html#3382141">err</a></span>&nbsp;<span class="op" id="3382170">!=</span>&nbsp;<span class="builtintype" id="3382173">nil</span>&nbsp;<span class="op" id="3382177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382181">return</span>&nbsp;<span class="builtintype" id="3382188">nil</span><span class="op" id="3382191">,</span>&nbsp;<span class="ident" id="3382193"><a href="/gostd/net/tcpsock_posix.go.html#3382141">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3382198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382201">return</span>&nbsp;<span class="ident" id="3382208"><a href="/gostd/net/tcpsock_posix.go.html#3376132">newTCPConn</a></span><span class="op" id="3382218">(</span><span class="ident" id="3382219"><a href="/gostd/net/tcpsock_posix.go.html#3382137">fd</a></span><span class="op" id="3382221">)</span><span class="op" id="3382222">,</span>&nbsp;<span class="builtintype" id="3382224">nil</span><br>
<span class="lineno"></span><span class="op" id="3382228">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="comment" id="3382231">//&nbsp;Accept&nbsp;implements&nbsp;the&nbsp;Accept&nbsp;method&nbsp;in&nbsp;the&nbsp;Listener&nbsp;interface;&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3382300">//&nbsp;waits&nbsp;for&nbsp;the&nbsp;next&nbsp;call&nbsp;and&nbsp;returns&nbsp;a&nbsp;generic&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="keyword" id="3382355">func</span>&nbsp;<span class="op" id="3382360">(</span><span class="ident" id="3382361">l</span>&nbsp;<span class="op" id="3382363">*</span><span class="ident" id="3382364"><a href="/gostd/net/tcpsock_posix.go.html#3381906">TCPListener</a></span><span class="op" id="3382375">)</span>&nbsp;<span class="ident" id="3382377">Accept</span><span class="op" id="3382383">(</span><span class="op" id="3382384">)</span>&nbsp;<span class="op" id="3382386">(</span><span class="ident" id="3382387"><a href="/gostd/net/net.go.html#3334417">Conn</a></span><span class="op" id="3382391">,</span>&nbsp;<span class="builtintype" id="3382393">error</span><span class="op" id="3382398">)</span>&nbsp;<span class="op" id="3382400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3382403">c</span><span class="op" id="3382404">,</span>&nbsp;<span class="ident" id="3382406">err</span>&nbsp;<span class="op" id="3382410">:=</span>&nbsp;<span class="ident" id="3382413"><a href="/gostd/net/tcpsock_posix.go.html#3382361">l</a></span><span class="op" id="3382414">.</span><span class="ident" id="3382415"><a href="/gostd/net/tcpsock_posix.go.html#3382042">AcceptTCP</a></span><span class="op" id="3382424">(</span><span class="op" id="3382425">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382428">if</span>&nbsp;<span class="ident" id="3382431"><a href="/gostd/net/tcpsock_posix.go.html#3382406">err</a></span>&nbsp;<span class="op" id="3382435">!=</span>&nbsp;<span class="builtintype" id="3382438">nil</span>&nbsp;<span class="op" id="3382442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382446">return</span>&nbsp;<span class="builtintype" id="3382453">nil</span><span class="op" id="3382456">,</span>&nbsp;<span class="ident" id="3382458"><a href="/gostd/net/tcpsock_posix.go.html#3382406">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3382463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382466">return</span>&nbsp;<span class="ident" id="3382473"><a href="/gostd/net/tcpsock_posix.go.html#3382403">c</a></span><span class="op" id="3382474">,</span>&nbsp;<span class="builtintype" id="3382476">nil</span><br>
<span class="lineno"></span><span class="op" id="3382480">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span><span class="comment" id="3382483">//&nbsp;Close&nbsp;stops&nbsp;listening&nbsp;on&nbsp;the&nbsp;TCP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="3382528">//&nbsp;Already&nbsp;Accepted&nbsp;connections&nbsp;are&nbsp;not&nbsp;closed.</span><br>
<span class="lineno"></span><span class="keyword" id="3382576">func</span>&nbsp;<span class="op" id="3382581">(</span><span class="ident" id="3382582">l</span>&nbsp;<span class="op" id="3382584">*</span><span class="ident" id="3382585"><a href="/gostd/net/tcpsock_posix.go.html#3381906">TCPListener</a></span><span class="op" id="3382596">)</span>&nbsp;<span class="ident" id="3382598">Close</span><span class="op" id="3382603">(</span><span class="op" id="3382604">)</span>&nbsp;<span class="builtintype" id="3382606">error</span>&nbsp;<span class="op" id="3382612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382615">if</span>&nbsp;<span class="ident" id="3382618"><a href="/gostd/net/tcpsock_posix.go.html#3382582">l</a></span>&nbsp;<span class="op" id="3382620">==</span>&nbsp;<span class="builtintype" id="3382623">nil</span>&nbsp;<span class="op" id="3382627">||</span>&nbsp;<span class="ident" id="3382630"><a href="/gostd/net/tcpsock_posix.go.html#3382582">l</a></span><span class="op" id="3382631">.</span><span class="ident" id="3382632"><a href="/gostd/net/tcpsock_posix.go.html#3381928">fd</a></span>&nbsp;<span class="op" id="3382635">==</span>&nbsp;<span class="builtintype" id="3382638">nil</span>&nbsp;<span class="op" id="3382642">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382646">return</span>&nbsp;<span class="ident" id="3382653"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3382660">.</span><span class="ident" id="3382661"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3382669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382672">return</span>&nbsp;<span class="ident" id="3382679"><a href="/gostd/net/tcpsock_posix.go.html#3382582">l</a></span><span class="op" id="3382680">.</span><span class="ident" id="3382681"><a href="/gostd/net/tcpsock_posix.go.html#3381928">fd</a></span><span class="op" id="3382683">.</span><span class="ident" id="3382684"><a href="/gostd/net/fd_unix.go.html#3261468">Close</a></span><span class="op" id="3382689">(</span><span class="op" id="3382690">)</span><br>
<span class="lineno"></span><span class="op" id="3382692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3382695">//&nbsp;Addr&nbsp;returns&nbsp;the&nbsp;listener&#39;s&nbsp;network&nbsp;address,&nbsp;a&nbsp;*TCPAddr.</span><br>
<span class="lineno"></span><span class="keyword" id="3382755">func</span>&nbsp;<span class="op" id="3382760">(</span><span class="ident" id="3382761">l</span>&nbsp;<span class="op" id="3382763">*</span><span class="ident" id="3382764"><a href="/gostd/net/tcpsock_posix.go.html#3381906">TCPListener</a></span><span class="op" id="3382775">)</span>&nbsp;<span class="ident" id="3382777">Addr</span><span class="op" id="3382781">(</span><span class="op" id="3382782">)</span>&nbsp;<span class="ident" id="3382784"><a href="/gostd/net/net.go.html#3334179">Addr</a></span>&nbsp;<span class="op" id="3382789">{</span>&nbsp;<span class="keyword" id="3382791">return</span>&nbsp;<span class="ident" id="3382798"><a href="/gostd/net/tcpsock_posix.go.html#3382761">l</a></span><span class="op" id="3382799">.</span><span class="ident" id="3382800"><a href="/gostd/net/tcpsock_posix.go.html#3381928">fd</a></span><span class="op" id="3382802">.</span><span class="ident" id="3382803"><a href="/gostd/net/fd_unix.go.html#3257582">laddr</a></span>&nbsp;<span class="op" id="3382809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3382812">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;associated&nbsp;with&nbsp;the&nbsp;listener.</span><br>
<span class="lineno"></span><span class="comment" id="3382875">//&nbsp;A&nbsp;zero&nbsp;time&nbsp;value&nbsp;disables&nbsp;the&nbsp;deadline.</span><br>
<span class="lineno">265</span><span class="keyword" id="3382919">func</span>&nbsp;<span class="op" id="3382924">(</span><span class="ident" id="3382925">l</span>&nbsp;<span class="op" id="3382927">*</span><span class="ident" id="3382928"><a href="/gostd/net/tcpsock_posix.go.html#3381906">TCPListener</a></span><span class="op" id="3382939">)</span>&nbsp;<span class="ident" id="3382941">SetDeadline</span><span class="op" id="3382952">(</span><span class="ident" id="3382953">t</span>&nbsp;<span class="ident" id="3382955"><a href="/gostd/net/tcpsock_posix.go.html#3374956">time</a></span><span class="op" id="3382959">.</span><span class="ident" id="3382960"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="3382964">)</span>&nbsp;<span class="builtintype" id="3382966">error</span>&nbsp;<span class="op" id="3382972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3382975">if</span>&nbsp;<span class="ident" id="3382978"><a href="/gostd/net/tcpsock_posix.go.html#3382925">l</a></span>&nbsp;<span class="op" id="3382980">==</span>&nbsp;<span class="builtintype" id="3382983">nil</span>&nbsp;<span class="op" id="3382987">||</span>&nbsp;<span class="ident" id="3382990"><a href="/gostd/net/tcpsock_posix.go.html#3382925">l</a></span><span class="op" id="3382991">.</span><span class="ident" id="3382992"><a href="/gostd/net/tcpsock_posix.go.html#3381928">fd</a></span>&nbsp;<span class="op" id="3382995">==</span>&nbsp;<span class="builtintype" id="3382998">nil</span>&nbsp;<span class="op" id="3383002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3383006">return</span>&nbsp;<span class="ident" id="3383013"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3383020">.</span><span class="ident" id="3383021"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3383029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3383032">return</span>&nbsp;<span class="ident" id="3383039"><a href="/gostd/net/tcpsock_posix.go.html#3382925">l</a></span><span class="op" id="3383040">.</span><span class="ident" id="3383041"><a href="/gostd/net/tcpsock_posix.go.html#3381928">fd</a></span><span class="op" id="3383043">.</span><span class="ident" id="3383044"><a href="/gostd/net/fd_poll_runtime.go.html#3256482">setDeadline</a></span><span class="op" id="3383055">(</span><span class="ident" id="3383056"><a href="/gostd/net/tcpsock_posix.go.html#3382953">t</a></span><span class="op" id="3383057">)</span><br>
<span class="lineno">270</span><span class="op" id="3383059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3383062">//&nbsp;File&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;underlying&nbsp;os.File,&nbsp;set&nbsp;to&nbsp;blocking</span><br>
<span class="lineno"></span><span class="comment" id="3383128">//&nbsp;mode.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.</span><br>
<span class="lineno"></span><span class="comment" id="3383198">//&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;l.</span><br>
<span class="lineno">275</span><span class="comment" id="3383263">//</span><br>
<span class="lineno"></span><span class="comment" id="3383266">//&nbsp;The&nbsp;returned&nbsp;os.File&#39;s&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;different&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3383330">//&nbsp;connection&#39;s.&nbsp;&nbsp;Attempting&nbsp;to&nbsp;change&nbsp;properties&nbsp;of&nbsp;the&nbsp;original</span><br>
<span class="lineno"></span><span class="comment" id="3383396">//&nbsp;using&nbsp;this&nbsp;duplicate&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;desired&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="3383460">func</span>&nbsp;<span class="op" id="3383465">(</span><span class="ident" id="3383466">l</span>&nbsp;<span class="op" id="3383468">*</span><span class="ident" id="3383469"><a href="/gostd/net/tcpsock_posix.go.html#3381906">TCPListener</a></span><span class="op" id="3383480">)</span>&nbsp;<span class="ident" id="3383482">File</span><span class="op" id="3383486">(</span><span class="op" id="3383487">)</span>&nbsp;<span class="op" id="3383489">(</span><span class="ident" id="3383490">f</span>&nbsp;<span class="op" id="3383492">*</span><span class="ident" id="3383493"><a href="/gostd/net/tcpsock_posix.go.html#3374939">os</a></span><span class="op" id="3383495">.</span><span class="ident" id="3383496"><a href="/gostd/os/file_unix.go.html#2452288">File</a></span><span class="op" id="3383500">,</span>&nbsp;<span class="ident" id="3383502">err</span>&nbsp;<span class="builtintype" id="3383506">error</span><span class="op" id="3383511">)</span>&nbsp;<span class="op" id="3383513">{</span>&nbsp;<span class="keyword" id="3383515">return</span>&nbsp;<span class="ident" id="3383522"><a href="/gostd/net/tcpsock_posix.go.html#3383466">l</a></span><span class="op" id="3383523">.</span><span class="ident" id="3383524"><a href="/gostd/net/tcpsock_posix.go.html#3381928">fd</a></span><span class="op" id="3383526">.</span><span class="ident" id="3383527"><a href="/gostd/net/fd_unix.go.html#3268610">dup</a></span><span class="op" id="3383530">(</span><span class="op" id="3383531">)</span>&nbsp;<span class="op" id="3383533">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="3383536">//&nbsp;ListenTCP&nbsp;announces&nbsp;on&nbsp;the&nbsp;TCP&nbsp;address&nbsp;laddr&nbsp;and&nbsp;returns&nbsp;a&nbsp;TCP</span><br>
<span class="lineno"></span><span class="comment" id="3383602">//&nbsp;listener.&nbsp;&nbsp;Net&nbsp;must&nbsp;be&nbsp;&#34;tcp&#34;,&nbsp;&#34;tcp4&#34;,&nbsp;or&nbsp;&#34;tcp6&#34;.&nbsp;&nbsp;If&nbsp;laddr&nbsp;has&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3383670">//&nbsp;port&nbsp;of&nbsp;0,&nbsp;ListenTCP&nbsp;will&nbsp;choose&nbsp;an&nbsp;available&nbsp;port.&nbsp;&nbsp;The&nbsp;caller&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="3383741">//&nbsp;use&nbsp;the&nbsp;Addr&nbsp;method&nbsp;of&nbsp;TCPListener&nbsp;to&nbsp;retrieve&nbsp;the&nbsp;chosen&nbsp;address.</span><br>
<span class="lineno">285</span><span class="keyword" id="3383811">func</span>&nbsp;<span class="ident" id="3383816">ListenTCP</span><span class="op" id="3383825">(</span><span class="ident" id="3383826">net</span>&nbsp;<span class="builtintype" id="3383830">string</span><span class="op" id="3383836">,</span>&nbsp;<span class="ident" id="3383838">laddr</span>&nbsp;<span class="op" id="3383844">*</span><span class="ident" id="3383845"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3383852">)</span>&nbsp;<span class="op" id="3383854">(</span><span class="op" id="3383855">*</span><span class="ident" id="3383856"><a href="/gostd/net/tcpsock_posix.go.html#3381906">TCPListener</a></span><span class="op" id="3383867">,</span>&nbsp;<span class="builtintype" id="3383869">error</span><span class="op" id="3383874">)</span>&nbsp;<span class="op" id="3383876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3383879">switch</span>&nbsp;<span class="ident" id="3383886"><a href="/gostd/net/tcpsock_posix.go.html#3383826">net</a></span>&nbsp;<span class="op" id="3383890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3383893">case</span>&nbsp;<span class="string" id="3383898">&#34;tcp&#34;</span><span class="op" id="3383903">,</span>&nbsp;<span class="string" id="3383905">&#34;tcp4&#34;</span><span class="op" id="3383911">,</span>&nbsp;<span class="string" id="3383913">&#34;tcp6&#34;</span><span class="op" id="3383919">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3383922">default</span><span class="op" id="3383929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3383933">return</span>&nbsp;<span class="builtintype" id="3383940">nil</span><span class="op" id="3383943">,</span>&nbsp;<span class="op" id="3383945">&amp;</span><span class="ident" id="3383946"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3383953">{</span><span class="ident" id="3383954"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3383956">:</span>&nbsp;<span class="string" id="3383958">&#34;listen&#34;</span><span class="op" id="3383966">,</span>&nbsp;<span class="ident" id="3383968"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3383971">:</span>&nbsp;<span class="ident" id="3383973"><a href="/gostd/net/tcpsock_posix.go.html#3383826">net</a></span><span class="op" id="3383976">,</span>&nbsp;<span class="ident" id="3383978"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3383982">:</span>&nbsp;<span class="ident" id="3383984"><a href="/gostd/net/tcpsock_posix.go.html#3383838">laddr</a></span><span class="op" id="3383989">,</span>&nbsp;<span class="ident" id="3383991"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3383994">:</span>&nbsp;<span class="ident" id="3383996"><a href="/gostd/net/net.go.html#3342949">UnknownNetworkError</a></span><span class="op" id="3384015">(</span><span class="ident" id="3384016"><a href="/gostd/net/tcpsock_posix.go.html#3383826">net</a></span><span class="op" id="3384019">)</span><span class="op" id="3384020">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3384023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3384026">if</span>&nbsp;<span class="ident" id="3384029"><a href="/gostd/net/tcpsock_posix.go.html#3383838">laddr</a></span>&nbsp;<span class="op" id="3384035">==</span>&nbsp;<span class="builtintype" id="3384038">nil</span>&nbsp;<span class="op" id="3384042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3384046"><a href="/gostd/net/tcpsock_posix.go.html#3383838">laddr</a></span>&nbsp;<span class="op" id="3384052">=</span>&nbsp;<span class="op" id="3384054">&amp;</span><span class="ident" id="3384055"><a href="/gostd/net/tcpsock.go.html#3373469">TCPAddr</a></span><span class="op" id="3384062">{</span><span class="op" id="3384063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3384066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3384069">fd</span><span class="op" id="3384071">,</span>&nbsp;<span class="ident" id="3384073">err</span>&nbsp;<span class="op" id="3384077">:=</span>&nbsp;<span class="ident" id="3384080"><a href="/gostd/net/ipsock_posix.go.html#3321835">internetSocket</a></span><span class="op" id="3384094">(</span><span class="ident" id="3384095"><a href="/gostd/net/tcpsock_posix.go.html#3383826">net</a></span><span class="op" id="3384098">,</span>&nbsp;<span class="ident" id="3384100"><a href="/gostd/net/tcpsock_posix.go.html#3383838">laddr</a></span><span class="op" id="3384105">,</span>&nbsp;<span class="builtintype" id="3384107">nil</span><span class="op" id="3384110">,</span>&nbsp;<span class="ident" id="3384112"><a href="/gostd/net/net.go.html#3342276">noDeadline</a></span><span class="op" id="3384122">,</span>&nbsp;<span class="ident" id="3384124"><a href="/gostd/net/tcpsock_posix.go.html#3374945">syscall</a></span><span class="op" id="3384131">.</span><span class="ident" id="3384132"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592030">SOCK_STREAM</a></span><span class="op" id="3384143">,</span>&nbsp;<span class="num" id="3384145">0</span><span class="op" id="3384146">,</span>&nbsp;<span class="string" id="3384148">&#34;listen&#34;</span><span class="op" id="3384156">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3384159">if</span>&nbsp;<span class="ident" id="3384162"><a href="/gostd/net/tcpsock_posix.go.html#3384073">err</a></span>&nbsp;<span class="op" id="3384166">!=</span>&nbsp;<span class="builtintype" id="3384169">nil</span>&nbsp;<span class="op" id="3384173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3384177">return</span>&nbsp;<span class="builtintype" id="3384184">nil</span><span class="op" id="3384187">,</span>&nbsp;<span class="op" id="3384189">&amp;</span><span class="ident" id="3384190"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3384197">{</span><span class="ident" id="3384198"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3384200">:</span>&nbsp;<span class="string" id="3384202">&#34;listen&#34;</span><span class="op" id="3384210">,</span>&nbsp;<span class="ident" id="3384212"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3384215">:</span>&nbsp;<span class="ident" id="3384217"><a href="/gostd/net/tcpsock_posix.go.html#3383826">net</a></span><span class="op" id="3384220">,</span>&nbsp;<span class="ident" id="3384222"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3384226">:</span>&nbsp;<span class="ident" id="3384228"><a href="/gostd/net/tcpsock_posix.go.html#3383838">laddr</a></span><span class="op" id="3384233">,</span>&nbsp;<span class="ident" id="3384235"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3384238">:</span>&nbsp;<span class="ident" id="3384240"><a href="/gostd/net/tcpsock_posix.go.html#3384073">err</a></span><span class="op" id="3384243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3384246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3384249">return</span>&nbsp;<span class="op" id="3384256">&amp;</span><span class="ident" id="3384257"><a href="/gostd/net/tcpsock_posix.go.html#3381906">TCPListener</a></span><span class="op" id="3384268">{</span><span class="ident" id="3384269"><a href="/gostd/net/tcpsock_posix.go.html#3384069">fd</a></span><span class="op" id="3384271">}</span><span class="op" id="3384272">,</span>&nbsp;<span class="builtintype" id="3384274">nil</span><br>
<span class="lineno"></span><span class="op" id="3384278">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
