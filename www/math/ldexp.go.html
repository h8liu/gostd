<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1501623">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1501678">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1501732">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1501783">package</span>&nbsp;<span class="ident" id="1501791">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1501797">//&nbsp;Ldexp&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;Frexp.</span><br>
<span class="lineno"></span><span class="comment" id="1501831">//&nbsp;It&nbsp;returns&nbsp;frac&nbsp;×&nbsp;2**exp.</span><br>
<span class="lineno"></span><span class="comment" id="1501861">//</span><br>
<span class="lineno">10</span><span class="comment" id="1501864">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1501886">//&nbsp;&nbsp;&nbsp;&nbspLdexp(±0,&nbsp;exp)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1501911">//&nbsp;&nbsp;&nbsp;&nbspLdexp(±Inf,&nbsp;exp)&nbsp;=&nbsp;±Inf</span><br>
<span class="lineno"></span><span class="comment" id="1501940">//&nbsp;&nbsp;&nbsp;&nbspLdexp(NaN,&nbsp;exp)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1501965">func</span>&nbsp;<span class="ident" id="1501970">Ldexp</span><span class="op" id="1501975">(</span><span class="ident" id="1501976">frac</span>&nbsp;<span class="builtintype" id="1501981">float64</span><span class="op" id="1501988">,</span>&nbsp;<span class="ident" id="1501990">exp</span>&nbsp;<span class="builtintype" id="1501994">int</span><span class="op" id="1501997">)</span>&nbsp;<span class="builtintype" id="1501999">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="1502008">func</span>&nbsp;<span class="ident" id="1502013">ldexp</span><span class="op" id="1502018">(</span><span class="ident" id="1502019">frac</span>&nbsp;<span class="builtintype" id="1502024">float64</span><span class="op" id="1502031">,</span>&nbsp;<span class="ident" id="1502033">exp</span>&nbsp;<span class="builtintype" id="1502037">int</span><span class="op" id="1502040">)</span>&nbsp;<span class="builtintype" id="1502042">float64</span>&nbsp;<span class="op" id="1502050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1502053">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502071">switch</span>&nbsp;<span class="op" id="1502078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502081">case</span>&nbsp;<span class="ident" id="1502086"><a href="/math/ldexp.go.html#1502019">frac</a></span>&nbsp;<span class="op" id="1502091">==</span>&nbsp;<span class="num" id="1502094">0</span><span class="op" id="1502095">:</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502099">return</span>&nbsp;<span class="ident" id="1502106"><a href="/math/ldexp.go.html#1502019">frac</a></span>&nbsp;<span class="comment" id="1502111">//&nbsp;correctly&nbsp;return&nbsp;-0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502135">case</span>&nbsp;<span class="ident" id="1502140"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1502145">(</span><span class="ident" id="1502146"><a href="/math/ldexp.go.html#1502019">frac</a></span><span class="op" id="1502150">,</span>&nbsp;<span class="num" id="1502152">0</span><span class="op" id="1502153">)</span>&nbsp;<span class="op" id="1502155">||</span>&nbsp;<span class="ident" id="1502158"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1502163">(</span><span class="ident" id="1502164"><a href="/math/ldexp.go.html#1502019">frac</a></span><span class="op" id="1502168">)</span><span class="op" id="1502169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502173">return</span>&nbsp;<span class="ident" id="1502180"><a href="/math/ldexp.go.html#1502019">frac</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1502186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502189"><a href="/math/ldexp.go.html#1502019">frac</a></span><span class="op" id="1502193">,</span>&nbsp;<span class="ident" id="1502195">e</span>&nbsp;<span class="op" id="1502197">:=</span>&nbsp;<span class="ident" id="1502200"><a href="/math/bits.go.html#1428329">normalize</a></span><span class="op" id="1502209">(</span><span class="ident" id="1502210"><a href="/math/ldexp.go.html#1502019">frac</a></span><span class="op" id="1502214">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502217"><a href="/math/ldexp.go.html#1502033">exp</a></span>&nbsp;<span class="op" id="1502221">+=</span>&nbsp;<span class="ident" id="1502224"><a href="/math/ldexp.go.html#1502195">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502227">x</span>&nbsp;<span class="op" id="1502229">:=</span>&nbsp;<span class="ident" id="1502232"><a href="/math/unsafe.go.html#1556032">Float64bits</a></span><span class="op" id="1502243">(</span><span class="ident" id="1502244"><a href="/math/ldexp.go.html#1502019">frac</a></span><span class="op" id="1502248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502251"><a href="/math/ldexp.go.html#1502033">exp</a></span>&nbsp;<span class="op" id="1502255">+=</span>&nbsp;<span class="builtintype" id="1502258">int</span><span class="op" id="1502261">(</span><span class="ident" id="1502262"><a href="/math/ldexp.go.html#1502227">x</a></span><span class="op" id="1502263">&gt;&gt;</span><span class="ident" id="1502265"><a href="/math/bits.go.html#1426968">shift</a></span><span class="op" id="1502270">)</span><span class="op" id="1502271">&amp;</span><span class="ident" id="1502272"><a href="/math/bits.go.html#1426950">mask</a></span>&nbsp;<span class="op" id="1502277">-</span>&nbsp;<span class="ident" id="1502279"><a href="/math/bits.go.html#1426992">bias</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502285">if</span>&nbsp;<span class="ident" id="1502288"><a href="/math/ldexp.go.html#1502033">exp</a></span>&nbsp;<span class="op" id="1502292">&lt;</span>&nbsp;<span class="op" id="1502294">-</span><span class="num" id="1502295">1074</span>&nbsp;<span class="op" id="1502300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502304">return</span>&nbsp;<span class="ident" id="1502311"><a href="/math/copysign.go.html#1432437">Copysign</a></span><span class="op" id="1502319">(</span><span class="num" id="1502320">0</span><span class="op" id="1502321">,</span>&nbsp;<span class="ident" id="1502323"><a href="/math/ldexp.go.html#1502019">frac</a></span><span class="op" id="1502327">)</span>&nbsp;<span class="comment" id="1502329">//&nbsp;underflow</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1502343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502346">if</span>&nbsp;<span class="ident" id="1502349"><a href="/math/ldexp.go.html#1502033">exp</a></span>&nbsp;<span class="op" id="1502353">&gt;</span>&nbsp;<span class="num" id="1502355">1023</span>&nbsp;<span class="op" id="1502360">{</span>&nbsp;<span class="comment" id="1502362">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502376">if</span>&nbsp;<span class="ident" id="1502379"><a href="/math/ldexp.go.html#1502019">frac</a></span>&nbsp;<span class="op" id="1502384">&lt;</span>&nbsp;<span class="num" id="1502386">0</span>&nbsp;<span class="op" id="1502388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502393">return</span>&nbsp;<span class="ident" id="1502400"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1502403">(</span><span class="op" id="1502404">-</span><span class="num" id="1502405">1</span><span class="op" id="1502406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1502410">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502414">return</span>&nbsp;<span class="ident" id="1502421"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1502424">(</span><span class="num" id="1502425">1</span><span class="op" id="1502426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1502429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502432">var</span>&nbsp;<span class="ident" id="1502436">m</span>&nbsp;<span class="builtintype" id="1502438">float64</span>&nbsp;<span class="op" id="1502446">=</span>&nbsp;<span class="num" id="1502448">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502451">if</span>&nbsp;<span class="ident" id="1502454"><a href="/math/ldexp.go.html#1502033">exp</a></span>&nbsp;<span class="op" id="1502458">&lt;</span>&nbsp;<span class="op" id="1502460">-</span><span class="num" id="1502461">1022</span>&nbsp;<span class="op" id="1502466">{</span>&nbsp;<span class="comment" id="1502468">//&nbsp;denormal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502482"><a href="/math/ldexp.go.html#1502033">exp</a></span>&nbsp;<span class="op" id="1502486">+=</span>&nbsp;<span class="num" id="1502489">52</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502494"><a href="/math/ldexp.go.html#1502436">m</a></span>&nbsp;<span class="op" id="1502496">=</span>&nbsp;<span class="num" id="1502498">1.0</span>&nbsp;<span class="op" id="1502502">/</span>&nbsp;<span class="op" id="1502504">(</span><span class="num" id="1502505">1</span>&nbsp;<span class="op" id="1502507">&lt;&lt;</span>&nbsp;<span class="num" id="1502510">52</span><span class="op" id="1502512">)</span>&nbsp;<span class="comment" id="1502514">//&nbsp;2**-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1502525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502528"><a href="/math/ldexp.go.html#1502227">x</a></span>&nbsp;<span class="op" id="1502530">&amp;^=</span>&nbsp;<span class="ident" id="1502534"><a href="/math/bits.go.html#1426950">mask</a></span>&nbsp;<span class="op" id="1502539">&lt;&lt;</span>&nbsp;<span class="ident" id="1502542"><a href="/math/bits.go.html#1426968">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502549"><a href="/math/ldexp.go.html#1502227">x</a></span>&nbsp;<span class="op" id="1502551">|=</span>&nbsp;<span class="ident" id="1502554">uint64</span><span class="op" id="1502560">(</span><span class="ident" id="1502561"><a href="/math/ldexp.go.html#1502033">exp</a></span><span class="op" id="1502564">+</span><span class="ident" id="1502565"><a href="/math/bits.go.html#1426992">bias</a></span><span class="op" id="1502569">)</span>&nbsp;<span class="op" id="1502571">&lt;&lt;</span>&nbsp;<span class="ident" id="1502574"><a href="/math/bits.go.html#1426968">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502581">return</span>&nbsp;<span class="ident" id="1502588"><a href="/math/ldexp.go.html#1502436">m</a></span>&nbsp;<span class="op" id="1502590">*</span>&nbsp;<span class="ident" id="1502592"><a href="/math/unsafe.go.html#1556218">Float64frombits</a></span><span class="op" id="1502607">(</span><span class="ident" id="1502608"><a href="/math/ldexp.go.html#1502227">x</a></span><span class="op" id="1502609">)</span><br>
<span class="lineno">45</span><span class="op" id="1502611">}</span>
</div>
</body>
</html>
