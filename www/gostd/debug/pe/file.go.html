<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4693148">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4693204">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4693258">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4693309">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="4693394">package</span>&nbsp;<span class="ident" id="4693402">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4693406">import</span>&nbsp;<span class="op" id="4693413">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693416">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693431">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693450">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693460">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693467">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693473">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693479">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="4693489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4693492">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4693530">type</span>&nbsp;<span class="ident" id="4693535">File</span>&nbsp;<span class="keyword" id="4693540">struct</span>&nbsp;<span class="op" id="4693547">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693550">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693562">OptionalHeader</span>&nbsp;<span class="keyword" id="4693577">interface</span><span class="op" id="4693586">{</span><span class="op" id="4693587">}</span>&nbsp;<span class="comment" id="4693589">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693640">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4693655">[</span><span class="op" id="4693656">]</span><span class="op" id="4693657">*</span><span class="ident" id="4693658">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693667">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4693682">[</span><span class="op" id="4693683">]</span><span class="op" id="4693684">*</span><span class="ident" id="4693685">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693694">closer</span>&nbsp;<span class="ident" id="4693701">io</span><span class="op" id="4693703">.</span><span class="ident" id="4693704">Closer</span><br>
<span class="lineno"></span><span class="op" id="4693711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4693714">type</span>&nbsp;<span class="ident" id="4693719">SectionHeader</span>&nbsp;<span class="keyword" id="4693733">struct</span>&nbsp;<span class="op" id="4693740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693743">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4693764">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693772">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4693793">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693801">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4693822">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693830">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4693851">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693859">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4693880">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693888">PointerToRelocations</span>&nbsp;<span class="builtintype" id="4693909">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693917">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="4693938">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693946">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="4693967">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693975">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="4693996">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694004">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694025">uint32</span><br>
<span class="lineno"></span><span class="op" id="4694032">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4694035">type</span>&nbsp;<span class="ident" id="4694040">Section</span>&nbsp;<span class="keyword" id="4694048">struct</span>&nbsp;<span class="op" id="4694055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694058">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694074">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694112">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694152">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694187">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694235">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694285">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694309">io</span><span class="op" id="4694311">.</span><span class="ident" id="4694312">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694322">sr</span>&nbsp;<span class="op" id="4694325">*</span><span class="ident" id="4694326">io</span><span class="op" id="4694328">.</span><span class="ident" id="4694329">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="4694343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4694346">type</span>&nbsp;<span class="ident" id="4694351">Symbol</span>&nbsp;<span class="keyword" id="4694358">struct</span>&nbsp;<span class="op" id="4694365">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694368">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694382">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694390">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694404">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694412">SectionNumber</span>&nbsp;<span class="builtintype" id="4694426">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694433">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694447">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694455">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="4694469">uint8</span><br>
<span class="lineno">60</span><span class="op" id="4694475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4694478">type</span>&nbsp;<span class="ident" id="4694483">ImportDirectory</span>&nbsp;<span class="keyword" id="4694499">struct</span>&nbsp;<span class="op" id="4694506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694509">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="4694528">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694536">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694555">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694563">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694582">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694590">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694609">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694617">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694636">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694645">dll</span>&nbsp;<span class="builtintype" id="4694649">string</span><br>
<span class="lineno">70</span><span class="op" id="4694656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4694659">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4694717">func</span>&nbsp;<span class="op" id="4694722">(</span><span class="ident" id="4694723">s</span>&nbsp;<span class="op" id="4694725">*</span><span class="ident" id="4694726">Section</span><span class="op" id="4694733">)</span>&nbsp;<span class="ident" id="4694735">Data</span><span class="op" id="4694739">(</span><span class="op" id="4694740">)</span>&nbsp;<span class="op" id="4694742">(</span><span class="op" id="4694743">[</span><span class="op" id="4694744">]</span><span class="builtintype" id="4694745">byte</span><span class="op" id="4694749">,</span>&nbsp;<span class="builtintype" id="4694751">error</span><span class="op" id="4694756">)</span>&nbsp;<span class="op" id="4694758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694761">dat</span>&nbsp;<span class="op" id="4694765">:=</span>&nbsp;<span class="builtinfunc" id="4694768">make</span><span class="op" id="4694772">(</span><span class="op" id="4694773">[</span><span class="op" id="4694774">]</span><span class="builtintype" id="4694775">byte</span><span class="op" id="4694779">,</span>&nbsp;<span class="ident" id="4694781">s</span><span class="op" id="4694782">.</span><span class="ident" id="4694783">sr</span><span class="op" id="4694785">.</span><span class="ident" id="4694786">Size</span><span class="op" id="4694790">(</span><span class="op" id="4694791">)</span><span class="op" id="4694792">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694795">n</span><span class="op" id="4694796">,</span>&nbsp;<span class="ident" id="4694798">err</span>&nbsp;<span class="op" id="4694802">:=</span>&nbsp;<span class="ident" id="4694805">s</span><span class="op" id="4694806">.</span><span class="ident" id="4694807">sr</span><span class="op" id="4694809">.</span><span class="ident" id="4694810">ReadAt</span><span class="op" id="4694816">(</span><span class="ident" id="4694817">dat</span><span class="op" id="4694820">,</span>&nbsp;<span class="num" id="4694822">0</span><span class="op" id="4694823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4694826">if</span>&nbsp;<span class="ident" id="4694829">n</span>&nbsp;<span class="op" id="4694831">==</span>&nbsp;<span class="builtinfunc" id="4694834">len</span><span class="op" id="4694837">(</span><span class="ident" id="4694838">dat</span><span class="op" id="4694841">)</span>&nbsp;<span class="op" id="4694843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694847">err</span>&nbsp;<span class="op" id="4694851">=</span>&nbsp;<span class="builtintype" id="4694853">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4694858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4694861">return</span>&nbsp;<span class="ident" id="4694868">dat</span><span class="op" id="4694871">[</span><span class="num" id="4694872">0</span><span class="op" id="4694873">:</span><span class="ident" id="4694874">n</span><span class="op" id="4694875">]</span><span class="op" id="4694876">,</span>&nbsp;<span class="ident" id="4694878">err</span><br>
<span class="lineno">80</span><span class="op" id="4694882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4694885">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4694942">func</span>&nbsp;<span class="op" id="4694947">(</span><span class="ident" id="4694948">s</span>&nbsp;<span class="op" id="4694950">*</span><span class="ident" id="4694951">Section</span><span class="op" id="4694958">)</span>&nbsp;<span class="ident" id="4694960">Open</span><span class="op" id="4694964">(</span><span class="op" id="4694965">)</span>&nbsp;<span class="ident" id="4694967">io</span><span class="op" id="4694969">.</span><span class="ident" id="4694970">ReadSeeker</span>&nbsp;<span class="op" id="4694981">{</span>&nbsp;<span class="keyword" id="4694983">return</span>&nbsp;<span class="ident" id="4694990">io</span><span class="op" id="4694992">.</span><span class="ident" id="4694993">NewSectionReader</span><span class="op" id="4695009">(</span><span class="ident" id="4695010">s</span><span class="op" id="4695011">.</span><span class="ident" id="4695012">sr</span><span class="op" id="4695014">,</span>&nbsp;<span class="num" id="4695016">0</span><span class="op" id="4695017">,</span>&nbsp;<span class="num" id="4695019">1</span><span class="op" id="4695020">&lt;&lt;</span><span class="num" id="4695022">63</span><span class="op" id="4695024">-</span><span class="num" id="4695025">1</span><span class="op" id="4695026">)</span>&nbsp;<span class="op" id="4695028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="4695031">type</span>&nbsp;<span class="ident" id="4695036">FormatError</span>&nbsp;<span class="keyword" id="4695048">struct</span>&nbsp;<span class="op" id="4695055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695058">off</span>&nbsp;<span class="ident" id="4695062">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695069">msg</span>&nbsp;<span class="builtintype" id="4695073">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695081">val</span>&nbsp;<span class="keyword" id="4695085">interface</span><span class="op" id="4695094">{</span><span class="op" id="4695095">}</span><br>
<span class="lineno"></span><span class="op" id="4695097">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="4695100">func</span>&nbsp;<span class="op" id="4695105">(</span><span class="ident" id="4695106">e</span>&nbsp;<span class="op" id="4695108">*</span><span class="ident" id="4695109">FormatError</span><span class="op" id="4695120">)</span>&nbsp;<span class="ident" id="4695122">Error</span><span class="op" id="4695127">(</span><span class="op" id="4695128">)</span>&nbsp;<span class="builtintype" id="4695130">string</span>&nbsp;<span class="op" id="4695137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695140">msg</span>&nbsp;<span class="op" id="4695144">:=</span>&nbsp;<span class="ident" id="4695147">e</span><span class="op" id="4695148">.</span><span class="ident" id="4695149">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695154">if</span>&nbsp;<span class="ident" id="4695157">e</span><span class="op" id="4695158">.</span><span class="ident" id="4695159">val</span>&nbsp;<span class="op" id="4695163">!=</span>&nbsp;<span class="builtintype" id="4695166">nil</span>&nbsp;<span class="op" id="4695170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695174">msg</span>&nbsp;<span class="op" id="4695178">+=</span>&nbsp;<span class="ident" id="4695181">fmt</span><span class="op" id="4695184">.</span><span class="ident" id="4695185">Sprintf</span><span class="op" id="4695192">(</span><span class="string" id="4695193">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="4695200">,</span>&nbsp;<span class="ident" id="4695202">e</span><span class="op" id="4695203">.</span><span class="ident" id="4695204">val</span><span class="op" id="4695207">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4695210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695213">msg</span>&nbsp;<span class="op" id="4695217">+=</span>&nbsp;<span class="ident" id="4695220">fmt</span><span class="op" id="4695223">.</span><span class="ident" id="4695224">Sprintf</span><span class="op" id="4695231">(</span><span class="string" id="4695232">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="4695256">,</span>&nbsp;<span class="ident" id="4695258">e</span><span class="op" id="4695259">.</span><span class="ident" id="4695260">off</span><span class="op" id="4695263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695266">return</span>&nbsp;<span class="ident" id="4695273">msg</span><br>
<span class="lineno"></span><span class="op" id="4695277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="4695280">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4695363">func</span>&nbsp;<span class="ident" id="4695368">Open</span><span class="op" id="4695372">(</span><span class="ident" id="4695373">name</span>&nbsp;<span class="builtintype" id="4695378">string</span><span class="op" id="4695384">)</span>&nbsp;<span class="op" id="4695386">(</span><span class="op" id="4695387">*</span><span class="ident" id="4695388">File</span><span class="op" id="4695392">,</span>&nbsp;<span class="builtintype" id="4695394">error</span><span class="op" id="4695399">)</span>&nbsp;<span class="op" id="4695401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695404">f</span><span class="op" id="4695405">,</span>&nbsp;<span class="ident" id="4695407">err</span>&nbsp;<span class="op" id="4695411">:=</span>&nbsp;<span class="ident" id="4695414">os</span><span class="op" id="4695416">.</span><span class="ident" id="4695417">Open</span><span class="op" id="4695421">(</span><span class="ident" id="4695422">name</span><span class="op" id="4695426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695429">if</span>&nbsp;<span class="ident" id="4695432">err</span>&nbsp;<span class="op" id="4695436">!=</span>&nbsp;<span class="builtintype" id="4695439">nil</span>&nbsp;<span class="op" id="4695443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695447">return</span>&nbsp;<span class="builtintype" id="4695454">nil</span><span class="op" id="4695457">,</span>&nbsp;<span class="ident" id="4695459">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4695464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695467">ff</span><span class="op" id="4695469">,</span>&nbsp;<span class="ident" id="4695471">err</span>&nbsp;<span class="op" id="4695475">:=</span>&nbsp;<span class="ident" id="4695478">NewFile</span><span class="op" id="4695485">(</span><span class="ident" id="4695486">f</span><span class="op" id="4695487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695490">if</span>&nbsp;<span class="ident" id="4695493">err</span>&nbsp;<span class="op" id="4695497">!=</span>&nbsp;<span class="builtintype" id="4695500">nil</span>&nbsp;<span class="op" id="4695504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695508">f</span><span class="op" id="4695509">.</span><span class="ident" id="4695510">Close</span><span class="op" id="4695515">(</span><span class="op" id="4695516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695520">return</span>&nbsp;<span class="builtintype" id="4695527">nil</span><span class="op" id="4695530">,</span>&nbsp;<span class="ident" id="4695532">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4695537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695540">ff</span><span class="op" id="4695542">.</span><span class="ident" id="4695543">closer</span>&nbsp;<span class="op" id="4695550">=</span>&nbsp;<span class="ident" id="4695552">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695555">return</span>&nbsp;<span class="ident" id="4695562">ff</span><span class="op" id="4695564">,</span>&nbsp;<span class="builtintype" id="4695566">nil</span><br>
<span class="lineno"></span><span class="op" id="4695570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="4695573">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="4695599">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="4695666">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="4695690">func</span>&nbsp;<span class="op" id="4695695">(</span><span class="ident" id="4695696">f</span>&nbsp;<span class="op" id="4695698">*</span><span class="ident" id="4695699">File</span><span class="op" id="4695703">)</span>&nbsp;<span class="ident" id="4695705">Close</span><span class="op" id="4695710">(</span><span class="op" id="4695711">)</span>&nbsp;<span class="builtintype" id="4695713">error</span>&nbsp;<span class="op" id="4695719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695722">var</span>&nbsp;<span class="ident" id="4695726">err</span>&nbsp;<span class="builtintype" id="4695730">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695737">if</span>&nbsp;<span class="ident" id="4695740">f</span><span class="op" id="4695741">.</span><span class="ident" id="4695742">closer</span>&nbsp;<span class="op" id="4695749">!=</span>&nbsp;<span class="builtintype" id="4695752">nil</span>&nbsp;<span class="op" id="4695756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695760">err</span>&nbsp;<span class="op" id="4695764">=</span>&nbsp;<span class="ident" id="4695766">f</span><span class="op" id="4695767">.</span><span class="ident" id="4695768">closer</span><span class="op" id="4695774">.</span><span class="ident" id="4695775">Close</span><span class="op" id="4695780">(</span><span class="op" id="4695781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695785">f</span><span class="op" id="4695786">.</span><span class="ident" id="4695787">closer</span>&nbsp;<span class="op" id="4695794">=</span>&nbsp;<span class="builtintype" id="4695796">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4695801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695804">return</span>&nbsp;<span class="ident" id="4695811">err</span><br>
<span class="lineno">125</span><span class="op" id="4695815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4695818">var</span>&nbsp;<span class="op" id="4695822">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695825">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="4695848">=</span>&nbsp;<span class="builtintype" id="4695850">uint16</span><span class="op" id="4695856">(</span><span class="ident" id="4695857">binary</span><span class="op" id="4695863">.</span><span class="ident" id="4695864">Size</span><span class="op" id="4695868">(</span><span class="ident" id="4695869">OptionalHeader32</span><span class="op" id="4695885">{</span><span class="op" id="4695886">}</span><span class="op" id="4695887">)</span><span class="op" id="4695888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695891">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="4695914">=</span>&nbsp;<span class="builtintype" id="4695916">uint16</span><span class="op" id="4695922">(</span><span class="ident" id="4695923">binary</span><span class="op" id="4695929">.</span><span class="ident" id="4695930">Size</span><span class="op" id="4695934">(</span><span class="ident" id="4695935">OptionalHeader64</span><span class="op" id="4695951">{</span><span class="op" id="4695952">}</span><span class="op" id="4695953">)</span><span class="op" id="4695954">)</span><br>
<span class="lineno">130</span><span class="op" id="4695956">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4695959">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="4696040">func</span>&nbsp;<span class="ident" id="4696045">NewFile</span><span class="op" id="4696052">(</span><span class="ident" id="4696053">r</span>&nbsp;<span class="ident" id="4696055">io</span><span class="op" id="4696057">.</span><span class="ident" id="4696058">ReaderAt</span><span class="op" id="4696066">)</span>&nbsp;<span class="op" id="4696068">(</span><span class="op" id="4696069">*</span><span class="ident" id="4696070">File</span><span class="op" id="4696074">,</span>&nbsp;<span class="builtintype" id="4696076">error</span><span class="op" id="4696081">)</span>&nbsp;<span class="op" id="4696083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696086">f</span>&nbsp;<span class="op" id="4696088">:=</span>&nbsp;<span class="builtinfunc" id="4696091">new</span><span class="op" id="4696094">(</span><span class="ident" id="4696095">File</span><span class="op" id="4696099">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696102">sr</span>&nbsp;<span class="op" id="4696105">:=</span>&nbsp;<span class="ident" id="4696108">io</span><span class="op" id="4696110">.</span><span class="ident" id="4696111">NewSectionReader</span><span class="op" id="4696127">(</span><span class="ident" id="4696128">r</span><span class="op" id="4696129">,</span>&nbsp;<span class="num" id="4696131">0</span><span class="op" id="4696132">,</span>&nbsp;<span class="num" id="4696134">1</span><span class="op" id="4696135">&lt;&lt;</span><span class="num" id="4696137">63</span><span class="op" id="4696139">-</span><span class="num" id="4696140">1</span><span class="op" id="4696141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696145">var</span>&nbsp;<span class="ident" id="4696149">dosheader</span>&nbsp;<span class="op" id="4696159">[</span><span class="num" id="4696160">96</span><span class="op" id="4696162">]</span><span class="builtintype" id="4696163">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696169">if</span>&nbsp;<span class="ident" id="4696172">_</span><span class="op" id="4696173">,</span>&nbsp;<span class="ident" id="4696175">err</span>&nbsp;<span class="op" id="4696179">:=</span>&nbsp;<span class="ident" id="4696182">r</span><span class="op" id="4696183">.</span><span class="ident" id="4696184">ReadAt</span><span class="op" id="4696190">(</span><span class="ident" id="4696191">dosheader</span><span class="op" id="4696200">[</span><span class="num" id="4696201">0</span><span class="op" id="4696202">:</span><span class="op" id="4696203">]</span><span class="op" id="4696204">,</span>&nbsp;<span class="num" id="4696206">0</span><span class="op" id="4696207">)</span><span class="op" id="4696208">;</span>&nbsp;<span class="ident" id="4696210">err</span>&nbsp;<span class="op" id="4696214">!=</span>&nbsp;<span class="builtintype" id="4696217">nil</span>&nbsp;<span class="op" id="4696221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696225">return</span>&nbsp;<span class="builtintype" id="4696232">nil</span><span class="op" id="4696235">,</span>&nbsp;<span class="ident" id="4696237">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4696242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696245">var</span>&nbsp;<span class="ident" id="4696249">base</span>&nbsp;<span class="ident" id="4696254">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696261">if</span>&nbsp;<span class="ident" id="4696264">dosheader</span><span class="op" id="4696273">[</span><span class="num" id="4696274">0</span><span class="op" id="4696275">]</span>&nbsp;<span class="op" id="4696277">==</span>&nbsp;<span class="string" id="4696280">&#39;M&#39;</span>&nbsp;<span class="op" id="4696284">&amp;&amp;</span>&nbsp;<span class="ident" id="4696287">dosheader</span><span class="op" id="4696296">[</span><span class="num" id="4696297">1</span><span class="op" id="4696298">]</span>&nbsp;<span class="op" id="4696300">==</span>&nbsp;<span class="string" id="4696303">&#39;Z&#39;</span>&nbsp;<span class="op" id="4696307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696311">signoff</span>&nbsp;<span class="op" id="4696319">:=</span>&nbsp;<span class="ident" id="4696322">int64</span><span class="op" id="4696327">(</span><span class="ident" id="4696328">binary</span><span class="op" id="4696334">.</span><span class="ident" id="4696335">LittleEndian</span><span class="op" id="4696347">.</span><span class="ident" id="4696348">Uint32</span><span class="op" id="4696354">(</span><span class="ident" id="4696355">dosheader</span><span class="op" id="4696364">[</span><span class="num" id="4696365">0x3c</span><span class="op" id="4696369">:</span><span class="op" id="4696370">]</span><span class="op" id="4696371">)</span><span class="op" id="4696372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696376">var</span>&nbsp;<span class="ident" id="4696380">sign</span>&nbsp;<span class="op" id="4696385">[</span><span class="num" id="4696386">4</span><span class="op" id="4696387">]</span><span class="builtintype" id="4696388">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696395">r</span><span class="op" id="4696396">.</span><span class="ident" id="4696397">ReadAt</span><span class="op" id="4696403">(</span><span class="ident" id="4696404">sign</span><span class="op" id="4696408">[</span><span class="op" id="4696409">:</span><span class="op" id="4696410">]</span><span class="op" id="4696411">,</span>&nbsp;<span class="ident" id="4696413">signoff</span><span class="op" id="4696420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696424">if</span>&nbsp;<span class="op" id="4696427">!</span><span class="op" id="4696428">(</span><span class="ident" id="4696429">sign</span><span class="op" id="4696433">[</span><span class="num" id="4696434">0</span><span class="op" id="4696435">]</span>&nbsp;<span class="op" id="4696437">==</span>&nbsp;<span class="string" id="4696440">&#39;P&#39;</span>&nbsp;<span class="op" id="4696444">&amp;&amp;</span>&nbsp;<span class="ident" id="4696447">sign</span><span class="op" id="4696451">[</span><span class="num" id="4696452">1</span><span class="op" id="4696453">]</span>&nbsp;<span class="op" id="4696455">==</span>&nbsp;<span class="string" id="4696458">&#39;E&#39;</span>&nbsp;<span class="op" id="4696462">&amp;&amp;</span>&nbsp;<span class="ident" id="4696465">sign</span><span class="op" id="4696469">[</span><span class="num" id="4696470">2</span><span class="op" id="4696471">]</span>&nbsp;<span class="op" id="4696473">==</span>&nbsp;<span class="num" id="4696476">0</span>&nbsp;<span class="op" id="4696478">&amp;&amp;</span>&nbsp;<span class="ident" id="4696481">sign</span><span class="op" id="4696485">[</span><span class="num" id="4696486">3</span><span class="op" id="4696487">]</span>&nbsp;<span class="op" id="4696489">==</span>&nbsp;<span class="num" id="4696492">0</span><span class="op" id="4696493">)</span>&nbsp;<span class="op" id="4696495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696500">return</span>&nbsp;<span class="builtintype" id="4696507">nil</span><span class="op" id="4696510">,</span>&nbsp;<span class="ident" id="4696512">errors</span><span class="op" id="4696518">.</span><span class="ident" id="4696519">New</span><span class="op" id="4696522">(</span><span class="string" id="4696523">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="4696548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4696552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696556">base</span>&nbsp;<span class="op" id="4696561">=</span>&nbsp;<span class="ident" id="4696563">signoff</span>&nbsp;<span class="op" id="4696571">+</span>&nbsp;<span class="num" id="4696573">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4696576">}</span>&nbsp;<span class="keyword" id="4696578">else</span>&nbsp;<span class="op" id="4696583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696587">base</span>&nbsp;<span class="op" id="4696592">=</span>&nbsp;<span class="ident" id="4696594">int64</span><span class="op" id="4696599">(</span><span class="num" id="4696600">0</span><span class="op" id="4696601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4696604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696607">sr</span><span class="op" id="4696609">.</span><span class="ident" id="4696610">Seek</span><span class="op" id="4696614">(</span><span class="ident" id="4696615">base</span><span class="op" id="4696619">,</span>&nbsp;<span class="ident" id="4696621">os</span><span class="op" id="4696623">.</span><span class="ident" id="4696624">SEEK_SET</span><span class="op" id="4696632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696635">if</span>&nbsp;<span class="ident" id="4696638">err</span>&nbsp;<span class="op" id="4696642">:=</span>&nbsp;<span class="ident" id="4696645">binary</span><span class="op" id="4696651">.</span><span class="ident" id="4696652">Read</span><span class="op" id="4696656">(</span><span class="ident" id="4696657">sr</span><span class="op" id="4696659">,</span>&nbsp;<span class="ident" id="4696661">binary</span><span class="op" id="4696667">.</span><span class="ident" id="4696668">LittleEndian</span><span class="op" id="4696680">,</span>&nbsp;<span class="op" id="4696682">&amp;</span><span class="ident" id="4696683">f</span><span class="op" id="4696684">.</span><span class="ident" id="4696685">FileHeader</span><span class="op" id="4696695">)</span><span class="op" id="4696696">;</span>&nbsp;<span class="ident" id="4696698">err</span>&nbsp;<span class="op" id="4696702">!=</span>&nbsp;<span class="builtintype" id="4696705">nil</span>&nbsp;<span class="op" id="4696709">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696713">return</span>&nbsp;<span class="builtintype" id="4696720">nil</span><span class="op" id="4696723">,</span>&nbsp;<span class="ident" id="4696725">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4696730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696733">if</span>&nbsp;<span class="ident" id="4696736">f</span><span class="op" id="4696737">.</span><span class="ident" id="4696738">FileHeader</span><span class="op" id="4696748">.</span><span class="ident" id="4696749">Machine</span>&nbsp;<span class="op" id="4696757">!=</span>&nbsp;<span class="ident" id="4696760">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="4696787">&amp;&amp;</span>&nbsp;<span class="ident" id="4696790">f</span><span class="op" id="4696791">.</span><span class="ident" id="4696792">FileHeader</span><span class="op" id="4696802">.</span><span class="ident" id="4696803">Machine</span>&nbsp;<span class="op" id="4696811">!=</span>&nbsp;<span class="ident" id="4696814">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="4696839">&amp;&amp;</span>&nbsp;<span class="ident" id="4696842">f</span><span class="op" id="4696843">.</span><span class="ident" id="4696844">FileHeader</span><span class="op" id="4696854">.</span><span class="ident" id="4696855">Machine</span>&nbsp;<span class="op" id="4696863">!=</span>&nbsp;<span class="ident" id="4696866">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="4696890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696894">return</span>&nbsp;<span class="builtintype" id="4696901">nil</span><span class="op" id="4696904">,</span>&nbsp;<span class="ident" id="4696906">errors</span><span class="op" id="4696912">.</span><span class="ident" id="4696913">New</span><span class="op" id="4696916">(</span><span class="string" id="4696917">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="4696942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4696945">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696949">var</span>&nbsp;<span class="ident" id="4696953">ss</span>&nbsp;<span class="op" id="4696956">[</span><span class="op" id="4696957">]</span><span class="builtintype" id="4696958">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696964">if</span>&nbsp;<span class="ident" id="4696967">f</span><span class="op" id="4696968">.</span><span class="ident" id="4696969">FileHeader</span><span class="op" id="4696979">.</span><span class="ident" id="4696980">NumberOfSymbols</span>&nbsp;<span class="op" id="4696996">&gt;</span>&nbsp;<span class="num" id="4696998">0</span>&nbsp;<span class="op" id="4697000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4697004">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697086">sr</span><span class="op" id="4697088">.</span><span class="ident" id="4697089">Seek</span><span class="op" id="4697093">(</span><span class="ident" id="4697094">int64</span><span class="op" id="4697099">(</span><span class="ident" id="4697100">f</span><span class="op" id="4697101">.</span><span class="ident" id="4697102">FileHeader</span><span class="op" id="4697112">.</span><span class="ident" id="4697113">PointerToSymbolTable</span><span class="op" id="4697133">+</span><span class="ident" id="4697134">COFFSymbolSize</span><span class="op" id="4697148">*</span><span class="ident" id="4697149">f</span><span class="op" id="4697150">.</span><span class="ident" id="4697151">FileHeader</span><span class="op" id="4697161">.</span><span class="ident" id="4697162">NumberOfSymbols</span><span class="op" id="4697177">)</span><span class="op" id="4697178">,</span>&nbsp;<span class="ident" id="4697180">os</span><span class="op" id="4697182">.</span><span class="ident" id="4697183">SEEK_SET</span><span class="op" id="4697191">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697195">var</span>&nbsp;<span class="ident" id="4697199">l</span>&nbsp;<span class="builtintype" id="4697201">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697210">if</span>&nbsp;<span class="ident" id="4697213">err</span>&nbsp;<span class="op" id="4697217">:=</span>&nbsp;<span class="ident" id="4697220">binary</span><span class="op" id="4697226">.</span><span class="ident" id="4697227">Read</span><span class="op" id="4697231">(</span><span class="ident" id="4697232">sr</span><span class="op" id="4697234">,</span>&nbsp;<span class="ident" id="4697236">binary</span><span class="op" id="4697242">.</span><span class="ident" id="4697243">LittleEndian</span><span class="op" id="4697255">,</span>&nbsp;<span class="op" id="4697257">&amp;</span><span class="ident" id="4697258">l</span><span class="op" id="4697259">)</span><span class="op" id="4697260">;</span>&nbsp;<span class="ident" id="4697262">err</span>&nbsp;<span class="op" id="4697266">!=</span>&nbsp;<span class="builtintype" id="4697269">nil</span>&nbsp;<span class="op" id="4697273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697278">return</span>&nbsp;<span class="builtintype" id="4697285">nil</span><span class="op" id="4697288">,</span>&nbsp;<span class="ident" id="4697290">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697300">ss</span>&nbsp;<span class="op" id="4697303">=</span>&nbsp;<span class="builtinfunc" id="4697305">make</span><span class="op" id="4697309">(</span><span class="op" id="4697310">[</span><span class="op" id="4697311">]</span><span class="builtintype" id="4697312">byte</span><span class="op" id="4697316">,</span>&nbsp;<span class="ident" id="4697318">l</span><span class="op" id="4697319">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697323">if</span>&nbsp;<span class="ident" id="4697326">_</span><span class="op" id="4697327">,</span>&nbsp;<span class="ident" id="4697329">err</span>&nbsp;<span class="op" id="4697333">:=</span>&nbsp;<span class="ident" id="4697336">r</span><span class="op" id="4697337">.</span><span class="ident" id="4697338">ReadAt</span><span class="op" id="4697344">(</span><span class="ident" id="4697345">ss</span><span class="op" id="4697347">,</span>&nbsp;<span class="ident" id="4697349">int64</span><span class="op" id="4697354">(</span><span class="ident" id="4697355">f</span><span class="op" id="4697356">.</span><span class="ident" id="4697357">FileHeader</span><span class="op" id="4697367">.</span><span class="ident" id="4697368">PointerToSymbolTable</span><span class="op" id="4697388">+</span><span class="ident" id="4697389">COFFSymbolSize</span><span class="op" id="4697403">*</span><span class="ident" id="4697404">f</span><span class="op" id="4697405">.</span><span class="ident" id="4697406">FileHeader</span><span class="op" id="4697416">.</span><span class="ident" id="4697417">NumberOfSymbols</span><span class="op" id="4697432">)</span><span class="op" id="4697433">)</span><span class="op" id="4697434">;</span>&nbsp;<span class="ident" id="4697436">err</span>&nbsp;<span class="op" id="4697440">!=</span>&nbsp;<span class="builtintype" id="4697443">nil</span>&nbsp;<span class="op" id="4697447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697452">return</span>&nbsp;<span class="builtintype" id="4697459">nil</span><span class="op" id="4697462">,</span>&nbsp;<span class="ident" id="4697464">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4697475">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697507">sr</span><span class="op" id="4697509">.</span><span class="ident" id="4697510">Seek</span><span class="op" id="4697514">(</span><span class="ident" id="4697515">int64</span><span class="op" id="4697520">(</span><span class="ident" id="4697521">f</span><span class="op" id="4697522">.</span><span class="ident" id="4697523">FileHeader</span><span class="op" id="4697533">.</span><span class="ident" id="4697534">PointerToSymbolTable</span><span class="op" id="4697554">)</span><span class="op" id="4697555">,</span>&nbsp;<span class="ident" id="4697557">os</span><span class="op" id="4697559">.</span><span class="ident" id="4697560">SEEK_SET</span><span class="op" id="4697568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697572">aux</span>&nbsp;<span class="op" id="4697576">:=</span>&nbsp;<span class="builtintype" id="4697579">uint8</span><span class="op" id="4697584">(</span><span class="num" id="4697585">0</span><span class="op" id="4697586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697590">for</span>&nbsp;<span class="ident" id="4697594">i</span>&nbsp;<span class="op" id="4697596">:=</span>&nbsp;<span class="num" id="4697599">0</span><span class="op" id="4697600">;</span>&nbsp;<span class="ident" id="4697602">i</span>&nbsp;<span class="op" id="4697604">&lt;</span>&nbsp;<span class="builtintype" id="4697606">int</span><span class="op" id="4697609">(</span><span class="ident" id="4697610">f</span><span class="op" id="4697611">.</span><span class="ident" id="4697612">FileHeader</span><span class="op" id="4697622">.</span><span class="ident" id="4697623">NumberOfSymbols</span><span class="op" id="4697638">)</span><span class="op" id="4697639">;</span>&nbsp;<span class="ident" id="4697641">i</span><span class="op" id="4697642">++</span>&nbsp;<span class="op" id="4697645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697650">cs</span>&nbsp;<span class="op" id="4697653">:=</span>&nbsp;<span class="builtinfunc" id="4697656">new</span><span class="op" id="4697659">(</span><span class="ident" id="4697660">COFFSymbol</span><span class="op" id="4697670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697675">if</span>&nbsp;<span class="ident" id="4697678">err</span>&nbsp;<span class="op" id="4697682">:=</span>&nbsp;<span class="ident" id="4697685">binary</span><span class="op" id="4697691">.</span><span class="ident" id="4697692">Read</span><span class="op" id="4697696">(</span><span class="ident" id="4697697">sr</span><span class="op" id="4697699">,</span>&nbsp;<span class="ident" id="4697701">binary</span><span class="op" id="4697707">.</span><span class="ident" id="4697708">LittleEndian</span><span class="op" id="4697720">,</span>&nbsp;<span class="ident" id="4697722">cs</span><span class="op" id="4697724">)</span><span class="op" id="4697725">;</span>&nbsp;<span class="ident" id="4697727">err</span>&nbsp;<span class="op" id="4697731">!=</span>&nbsp;<span class="builtintype" id="4697734">nil</span>&nbsp;<span class="op" id="4697738">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697744">return</span>&nbsp;<span class="builtintype" id="4697751">nil</span><span class="op" id="4697754">,</span>&nbsp;<span class="ident" id="4697756">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697768">if</span>&nbsp;<span class="ident" id="4697771">aux</span>&nbsp;<span class="op" id="4697775">&gt;</span>&nbsp;<span class="num" id="4697777">0</span>&nbsp;<span class="op" id="4697779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697785">aux</span><span class="op" id="4697788">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697795">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697812">var</span>&nbsp;<span class="ident" id="4697816">name</span>&nbsp;<span class="builtintype" id="4697821">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697831">if</span>&nbsp;<span class="ident" id="4697834">cs</span><span class="op" id="4697836">.</span><span class="ident" id="4697837">Name</span><span class="op" id="4697841">[</span><span class="num" id="4697842">0</span><span class="op" id="4697843">]</span>&nbsp;<span class="op" id="4697845">==</span>&nbsp;<span class="num" id="4697848">0</span>&nbsp;<span class="op" id="4697850">&amp;&amp;</span>&nbsp;<span class="ident" id="4697853">cs</span><span class="op" id="4697855">.</span><span class="ident" id="4697856">Name</span><span class="op" id="4697860">[</span><span class="num" id="4697861">1</span><span class="op" id="4697862">]</span>&nbsp;<span class="op" id="4697864">==</span>&nbsp;<span class="num" id="4697867">0</span>&nbsp;<span class="op" id="4697869">&amp;&amp;</span>&nbsp;<span class="ident" id="4697872">cs</span><span class="op" id="4697874">.</span><span class="ident" id="4697875">Name</span><span class="op" id="4697879">[</span><span class="num" id="4697880">2</span><span class="op" id="4697881">]</span>&nbsp;<span class="op" id="4697883">==</span>&nbsp;<span class="num" id="4697886">0</span>&nbsp;<span class="op" id="4697888">&amp;&amp;</span>&nbsp;<span class="ident" id="4697891">cs</span><span class="op" id="4697893">.</span><span class="ident" id="4697894">Name</span><span class="op" id="4697898">[</span><span class="num" id="4697899">3</span><span class="op" id="4697900">]</span>&nbsp;<span class="op" id="4697902">==</span>&nbsp;<span class="num" id="4697905">0</span>&nbsp;<span class="op" id="4697907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697913">si</span>&nbsp;<span class="op" id="4697916">:=</span>&nbsp;<span class="builtintype" id="4697919">int</span><span class="op" id="4697922">(</span><span class="ident" id="4697923">binary</span><span class="op" id="4697929">.</span><span class="ident" id="4697930">LittleEndian</span><span class="op" id="4697942">.</span><span class="ident" id="4697943">Uint32</span><span class="op" id="4697949">(</span><span class="ident" id="4697950">cs</span><span class="op" id="4697952">.</span><span class="ident" id="4697953">Name</span><span class="op" id="4697957">[</span><span class="num" id="4697958">4</span><span class="op" id="4697959">:</span><span class="op" id="4697960">]</span><span class="op" id="4697961">)</span><span class="op" id="4697962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697968">name</span><span class="op" id="4697972">,</span>&nbsp;<span class="ident" id="4697974">_</span>&nbsp;<span class="op" id="4697976">=</span>&nbsp;<span class="ident" id="4697978">getString</span><span class="op" id="4697987">(</span><span class="ident" id="4697988">ss</span><span class="op" id="4697990">,</span>&nbsp;<span class="ident" id="4697992">si</span><span class="op" id="4697994">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697999">}</span>&nbsp;<span class="keyword" id="4698001">else</span>&nbsp;<span class="op" id="4698006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698012">name</span>&nbsp;<span class="op" id="4698017">=</span>&nbsp;<span class="ident" id="4698019">cstring</span><span class="op" id="4698026">(</span><span class="ident" id="4698027">cs</span><span class="op" id="4698029">.</span><span class="ident" id="4698030">Name</span><span class="op" id="4698034">[</span><span class="op" id="4698035">:</span><span class="op" id="4698036">]</span><span class="op" id="4698037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698047">aux</span>&nbsp;<span class="op" id="4698051">=</span>&nbsp;<span class="ident" id="4698053">cs</span><span class="op" id="4698055">.</span><span class="ident" id="4698056">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698078">s</span>&nbsp;<span class="op" id="4698080">:=</span>&nbsp;<span class="op" id="4698083">&amp;</span><span class="ident" id="4698084">Symbol</span><span class="op" id="4698090">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698096">Name</span><span class="op" id="4698100">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698111">name</span><span class="op" id="4698115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698121">Value</span><span class="op" id="4698126">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698136">cs</span><span class="op" id="4698138">.</span><span class="ident" id="4698139">Value</span><span class="op" id="4698144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698150">SectionNumber</span><span class="op" id="4698163">:</span>&nbsp;<span class="ident" id="4698165">cs</span><span class="op" id="4698167">.</span><span class="ident" id="4698168">SectionNumber</span><span class="op" id="4698181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698187">Type</span><span class="op" id="4698191">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698202">cs</span><span class="op" id="4698204">.</span><span class="ident" id="4698205">Type</span><span class="op" id="4698209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698215">StorageClass</span><span class="op" id="4698227">:</span>&nbsp;&nbsp;<span class="ident" id="4698230">cs</span><span class="op" id="4698232">.</span><span class="ident" id="4698233">StorageClass</span><span class="op" id="4698245">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698255">f</span><span class="op" id="4698256">.</span><span class="ident" id="4698257">Symbols</span>&nbsp;<span class="op" id="4698265">=</span>&nbsp;<span class="builtinfunc" id="4698267">append</span><span class="op" id="4698273">(</span><span class="ident" id="4698274">f</span><span class="op" id="4698275">.</span><span class="ident" id="4698276">Symbols</span><span class="op" id="4698283">,</span>&nbsp;<span class="ident" id="4698285">s</span><span class="op" id="4698286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4698297">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698323">sr</span><span class="op" id="4698325">.</span><span class="ident" id="4698326">Seek</span><span class="op" id="4698330">(</span><span class="ident" id="4698331">base</span><span class="op" id="4698335">,</span>&nbsp;<span class="ident" id="4698337">os</span><span class="op" id="4698339">.</span><span class="ident" id="4698340">SEEK_SET</span><span class="op" id="4698348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698351">if</span>&nbsp;<span class="ident" id="4698354">err</span>&nbsp;<span class="op" id="4698358">:=</span>&nbsp;<span class="ident" id="4698361">binary</span><span class="op" id="4698367">.</span><span class="ident" id="4698368">Read</span><span class="op" id="4698372">(</span><span class="ident" id="4698373">sr</span><span class="op" id="4698375">,</span>&nbsp;<span class="ident" id="4698377">binary</span><span class="op" id="4698383">.</span><span class="ident" id="4698384">LittleEndian</span><span class="op" id="4698396">,</span>&nbsp;<span class="op" id="4698398">&amp;</span><span class="ident" id="4698399">f</span><span class="op" id="4698400">.</span><span class="ident" id="4698401">FileHeader</span><span class="op" id="4698411">)</span><span class="op" id="4698412">;</span>&nbsp;<span class="ident" id="4698414">err</span>&nbsp;<span class="op" id="4698418">!=</span>&nbsp;<span class="builtintype" id="4698421">nil</span>&nbsp;<span class="op" id="4698425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698429">return</span>&nbsp;<span class="builtintype" id="4698436">nil</span><span class="op" id="4698439">,</span>&nbsp;<span class="ident" id="4698441">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698446">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698449">var</span>&nbsp;<span class="ident" id="4698453">oh32</span>&nbsp;<span class="ident" id="4698458">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698476">var</span>&nbsp;<span class="ident" id="4698480">oh64</span>&nbsp;<span class="ident" id="4698485">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698503">switch</span>&nbsp;<span class="ident" id="4698510">f</span><span class="op" id="4698511">.</span><span class="ident" id="4698512">FileHeader</span><span class="op" id="4698522">.</span><span class="ident" id="4698523">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="4698544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698547">case</span>&nbsp;<span class="ident" id="4698552">sizeofOptionalHeader32</span><span class="op" id="4698574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698578">if</span>&nbsp;<span class="ident" id="4698581">err</span>&nbsp;<span class="op" id="4698585">:=</span>&nbsp;<span class="ident" id="4698588">binary</span><span class="op" id="4698594">.</span><span class="ident" id="4698595">Read</span><span class="op" id="4698599">(</span><span class="ident" id="4698600">sr</span><span class="op" id="4698602">,</span>&nbsp;<span class="ident" id="4698604">binary</span><span class="op" id="4698610">.</span><span class="ident" id="4698611">LittleEndian</span><span class="op" id="4698623">,</span>&nbsp;<span class="op" id="4698625">&amp;</span><span class="ident" id="4698626">oh32</span><span class="op" id="4698630">)</span><span class="op" id="4698631">;</span>&nbsp;<span class="ident" id="4698633">err</span>&nbsp;<span class="op" id="4698637">!=</span>&nbsp;<span class="builtintype" id="4698640">nil</span>&nbsp;<span class="op" id="4698644">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698649">return</span>&nbsp;<span class="builtintype" id="4698656">nil</span><span class="op" id="4698659">,</span>&nbsp;<span class="ident" id="4698661">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698671">if</span>&nbsp;<span class="ident" id="4698674">oh32</span><span class="op" id="4698678">.</span><span class="ident" id="4698679">Magic</span>&nbsp;<span class="op" id="4698685">!=</span>&nbsp;<span class="num" id="4698688">0x10b</span>&nbsp;<span class="op" id="4698694">{</span>&nbsp;<span class="comment" id="4698696">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698707">return</span>&nbsp;<span class="builtintype" id="4698714">nil</span><span class="op" id="4698717">,</span>&nbsp;<span class="ident" id="4698719">fmt</span><span class="op" id="4698722">.</span><span class="ident" id="4698723">Errorf</span><span class="op" id="4698729">(</span><span class="string" id="4698730">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="4698781">,</span>&nbsp;<span class="ident" id="4698783">oh32</span><span class="op" id="4698787">.</span><span class="ident" id="4698788">Magic</span><span class="op" id="4698793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698797">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698801">f</span><span class="op" id="4698802">.</span><span class="ident" id="4698803">OptionalHeader</span>&nbsp;<span class="op" id="4698818">=</span>&nbsp;<span class="op" id="4698820">&amp;</span><span class="ident" id="4698821">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698827">case</span>&nbsp;<span class="ident" id="4698832">sizeofOptionalHeader64</span><span class="op" id="4698854">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698858">if</span>&nbsp;<span class="ident" id="4698861">err</span>&nbsp;<span class="op" id="4698865">:=</span>&nbsp;<span class="ident" id="4698868">binary</span><span class="op" id="4698874">.</span><span class="ident" id="4698875">Read</span><span class="op" id="4698879">(</span><span class="ident" id="4698880">sr</span><span class="op" id="4698882">,</span>&nbsp;<span class="ident" id="4698884">binary</span><span class="op" id="4698890">.</span><span class="ident" id="4698891">LittleEndian</span><span class="op" id="4698903">,</span>&nbsp;<span class="op" id="4698905">&amp;</span><span class="ident" id="4698906">oh64</span><span class="op" id="4698910">)</span><span class="op" id="4698911">;</span>&nbsp;<span class="ident" id="4698913">err</span>&nbsp;<span class="op" id="4698917">!=</span>&nbsp;<span class="builtintype" id="4698920">nil</span>&nbsp;<span class="op" id="4698924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698929">return</span>&nbsp;<span class="builtintype" id="4698936">nil</span><span class="op" id="4698939">,</span>&nbsp;<span class="ident" id="4698941">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698947">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698951">if</span>&nbsp;<span class="ident" id="4698954">oh64</span><span class="op" id="4698958">.</span><span class="ident" id="4698959">Magic</span>&nbsp;<span class="op" id="4698965">!=</span>&nbsp;<span class="num" id="4698968">0x20b</span>&nbsp;<span class="op" id="4698974">{</span>&nbsp;<span class="comment" id="4698976">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698988">return</span>&nbsp;<span class="builtintype" id="4698995">nil</span><span class="op" id="4698998">,</span>&nbsp;<span class="ident" id="4699000">fmt</span><span class="op" id="4699003">.</span><span class="ident" id="4699004">Errorf</span><span class="op" id="4699010">(</span><span class="string" id="4699011">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="4699063">,</span>&nbsp;<span class="ident" id="4699065">oh64</span><span class="op" id="4699069">.</span><span class="ident" id="4699070">Magic</span><span class="op" id="4699075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699083">f</span><span class="op" id="4699084">.</span><span class="ident" id="4699085">OptionalHeader</span>&nbsp;<span class="op" id="4699100">=</span>&nbsp;<span class="op" id="4699102">&amp;</span><span class="ident" id="4699103">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699109">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4699113">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699135">f</span><span class="op" id="4699136">.</span><span class="ident" id="4699137">Sections</span>&nbsp;<span class="op" id="4699146">=</span>&nbsp;<span class="builtinfunc" id="4699148">make</span><span class="op" id="4699152">(</span><span class="op" id="4699153">[</span><span class="op" id="4699154">]</span><span class="op" id="4699155">*</span><span class="ident" id="4699156">Section</span><span class="op" id="4699163">,</span>&nbsp;<span class="ident" id="4699165">f</span><span class="op" id="4699166">.</span><span class="ident" id="4699167">FileHeader</span><span class="op" id="4699177">.</span><span class="ident" id="4699178">NumberOfSections</span><span class="op" id="4699194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699197">for</span>&nbsp;<span class="ident" id="4699201">i</span>&nbsp;<span class="op" id="4699203">:=</span>&nbsp;<span class="num" id="4699206">0</span><span class="op" id="4699207">;</span>&nbsp;<span class="ident" id="4699209">i</span>&nbsp;<span class="op" id="4699211">&lt;</span>&nbsp;<span class="builtintype" id="4699213">int</span><span class="op" id="4699216">(</span><span class="ident" id="4699217">f</span><span class="op" id="4699218">.</span><span class="ident" id="4699219">FileHeader</span><span class="op" id="4699229">.</span><span class="ident" id="4699230">NumberOfSections</span><span class="op" id="4699246">)</span><span class="op" id="4699247">;</span>&nbsp;<span class="ident" id="4699249">i</span><span class="op" id="4699250">++</span>&nbsp;<span class="op" id="4699253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699257">sh</span>&nbsp;<span class="op" id="4699260">:=</span>&nbsp;<span class="builtinfunc" id="4699263">new</span><span class="op" id="4699266">(</span><span class="ident" id="4699267">SectionHeader32</span><span class="op" id="4699282">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699286">if</span>&nbsp;<span class="ident" id="4699289">err</span>&nbsp;<span class="op" id="4699293">:=</span>&nbsp;<span class="ident" id="4699296">binary</span><span class="op" id="4699302">.</span><span class="ident" id="4699303">Read</span><span class="op" id="4699307">(</span><span class="ident" id="4699308">sr</span><span class="op" id="4699310">,</span>&nbsp;<span class="ident" id="4699312">binary</span><span class="op" id="4699318">.</span><span class="ident" id="4699319">LittleEndian</span><span class="op" id="4699331">,</span>&nbsp;<span class="ident" id="4699333">sh</span><span class="op" id="4699335">)</span><span class="op" id="4699336">;</span>&nbsp;<span class="ident" id="4699338">err</span>&nbsp;<span class="op" id="4699342">!=</span>&nbsp;<span class="builtintype" id="4699345">nil</span>&nbsp;<span class="op" id="4699349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699354">return</span>&nbsp;<span class="builtintype" id="4699361">nil</span><span class="op" id="4699364">,</span>&nbsp;<span class="ident" id="4699366">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699376">var</span>&nbsp;<span class="ident" id="4699380">name</span>&nbsp;<span class="builtintype" id="4699385">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699394">if</span>&nbsp;<span class="ident" id="4699397">sh</span><span class="op" id="4699399">.</span><span class="ident" id="4699400">Name</span><span class="op" id="4699404">[</span><span class="num" id="4699405">0</span><span class="op" id="4699406">]</span>&nbsp;<span class="op" id="4699408">==</span>&nbsp;<span class="string" id="4699411">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="4699418">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699423">si</span><span class="op" id="4699425">,</span>&nbsp;<span class="ident" id="4699427">_</span>&nbsp;<span class="op" id="4699429">:=</span>&nbsp;<span class="ident" id="4699432">strconv</span><span class="op" id="4699439">.</span><span class="ident" id="4699440">Atoi</span><span class="op" id="4699444">(</span><span class="ident" id="4699445">cstring</span><span class="op" id="4699452">(</span><span class="ident" id="4699453">sh</span><span class="op" id="4699455">.</span><span class="ident" id="4699456">Name</span><span class="op" id="4699460">[</span><span class="num" id="4699461">1</span><span class="op" id="4699462">:</span><span class="op" id="4699463">]</span><span class="op" id="4699464">)</span><span class="op" id="4699465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699470">name</span><span class="op" id="4699474">,</span>&nbsp;<span class="ident" id="4699476">_</span>&nbsp;<span class="op" id="4699478">=</span>&nbsp;<span class="ident" id="4699480">getString</span><span class="op" id="4699489">(</span><span class="ident" id="4699490">ss</span><span class="op" id="4699492">,</span>&nbsp;<span class="ident" id="4699494">si</span><span class="op" id="4699496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699500">}</span>&nbsp;<span class="keyword" id="4699502">else</span>&nbsp;<span class="op" id="4699507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699512">name</span>&nbsp;<span class="op" id="4699517">=</span>&nbsp;<span class="ident" id="4699519">cstring</span><span class="op" id="4699526">(</span><span class="ident" id="4699527">sh</span><span class="op" id="4699529">.</span><span class="ident" id="4699530">Name</span><span class="op" id="4699534">[</span><span class="num" id="4699535">0</span><span class="op" id="4699536">:</span><span class="op" id="4699537">]</span><span class="op" id="4699538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699542">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699546">s</span>&nbsp;<span class="op" id="4699548">:=</span>&nbsp;<span class="builtinfunc" id="4699551">new</span><span class="op" id="4699554">(</span><span class="ident" id="4699555">Section</span><span class="op" id="4699562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699566">s</span><span class="op" id="4699567">.</span><span class="ident" id="4699568">SectionHeader</span>&nbsp;<span class="op" id="4699582">=</span>&nbsp;<span class="ident" id="4699584">SectionHeader</span><span class="op" id="4699597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699602">Name</span><span class="op" id="4699606">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699624">name</span><span class="op" id="4699628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699633">VirtualSize</span><span class="op" id="4699644">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699655">sh</span><span class="op" id="4699657">.</span><span class="ident" id="4699658">VirtualSize</span><span class="op" id="4699669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699674">VirtualAddress</span><span class="op" id="4699688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699696">sh</span><span class="op" id="4699698">.</span><span class="ident" id="4699699">VirtualAddress</span><span class="op" id="4699713">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699718">Size</span><span class="op" id="4699722">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699740">sh</span><span class="op" id="4699742">.</span><span class="ident" id="4699743">SizeOfRawData</span><span class="op" id="4699756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699761">Offset</span><span class="op" id="4699767">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699783">sh</span><span class="op" id="4699785">.</span><span class="ident" id="4699786">PointerToRawData</span><span class="op" id="4699802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699807">PointerToRelocations</span><span class="op" id="4699827">:</span>&nbsp;<span class="ident" id="4699829">sh</span><span class="op" id="4699831">.</span><span class="ident" id="4699832">PointerToRelocations</span><span class="op" id="4699852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699857">PointerToLineNumbers</span><span class="op" id="4699877">:</span>&nbsp;<span class="ident" id="4699879">sh</span><span class="op" id="4699881">.</span><span class="ident" id="4699882">PointerToLineNumbers</span><span class="op" id="4699902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699907">NumberOfRelocations</span><span class="op" id="4699926">:</span>&nbsp;&nbsp;<span class="ident" id="4699929">sh</span><span class="op" id="4699931">.</span><span class="ident" id="4699932">NumberOfRelocations</span><span class="op" id="4699951">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699956">NumberOfLineNumbers</span><span class="op" id="4699975">:</span>&nbsp;&nbsp;<span class="ident" id="4699978">sh</span><span class="op" id="4699980">.</span><span class="ident" id="4699981">NumberOfLineNumbers</span><span class="op" id="4700000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700005">Characteristics</span><span class="op" id="4700020">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700027">sh</span><span class="op" id="4700029">.</span><span class="ident" id="4700030">Characteristics</span><span class="op" id="4700045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700053">s</span><span class="op" id="4700054">.</span><span class="ident" id="4700055">sr</span>&nbsp;<span class="op" id="4700058">=</span>&nbsp;<span class="ident" id="4700060">io</span><span class="op" id="4700062">.</span><span class="ident" id="4700063">NewSectionReader</span><span class="op" id="4700079">(</span><span class="ident" id="4700080">r</span><span class="op" id="4700081">,</span>&nbsp;<span class="ident" id="4700083">int64</span><span class="op" id="4700088">(</span><span class="ident" id="4700089">s</span><span class="op" id="4700090">.</span><span class="ident" id="4700091">SectionHeader</span><span class="op" id="4700104">.</span><span class="ident" id="4700105">Offset</span><span class="op" id="4700111">)</span><span class="op" id="4700112">,</span>&nbsp;<span class="ident" id="4700114">int64</span><span class="op" id="4700119">(</span><span class="ident" id="4700120">s</span><span class="op" id="4700121">.</span><span class="ident" id="4700122">SectionHeader</span><span class="op" id="4700135">.</span><span class="ident" id="4700136">Size</span><span class="op" id="4700140">)</span><span class="op" id="4700141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700145">s</span><span class="op" id="4700146">.</span><span class="ident" id="4700147">ReaderAt</span>&nbsp;<span class="op" id="4700156">=</span>&nbsp;<span class="ident" id="4700158">s</span><span class="op" id="4700159">.</span><span class="ident" id="4700160">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700165">f</span><span class="op" id="4700166">.</span><span class="ident" id="4700167">Sections</span><span class="op" id="4700175">[</span><span class="ident" id="4700176">i</span><span class="op" id="4700177">]</span>&nbsp;<span class="op" id="4700179">=</span>&nbsp;<span class="ident" id="4700181">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700187">return</span>&nbsp;<span class="ident" id="4700194">f</span><span class="op" id="4700195">,</span>&nbsp;<span class="builtintype" id="4700197">nil</span><br>
<span class="lineno"></span><span class="op" id="4700201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="4700204">func</span>&nbsp;<span class="ident" id="4700209">cstring</span><span class="op" id="4700216">(</span><span class="ident" id="4700217">b</span>&nbsp;<span class="op" id="4700219">[</span><span class="op" id="4700220">]</span><span class="builtintype" id="4700221">byte</span><span class="op" id="4700225">)</span>&nbsp;<span class="builtintype" id="4700227">string</span>&nbsp;<span class="op" id="4700234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700237">var</span>&nbsp;<span class="ident" id="4700241">i</span>&nbsp;<span class="builtintype" id="4700243">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700248">for</span>&nbsp;<span class="ident" id="4700252">i</span>&nbsp;<span class="op" id="4700254">=</span>&nbsp;<span class="num" id="4700256">0</span><span class="op" id="4700257">;</span>&nbsp;<span class="ident" id="4700259">i</span>&nbsp;<span class="op" id="4700261">&lt;</span>&nbsp;<span class="builtinfunc" id="4700263">len</span><span class="op" id="4700266">(</span><span class="ident" id="4700267">b</span><span class="op" id="4700268">)</span>&nbsp;<span class="op" id="4700270">&amp;&amp;</span>&nbsp;<span class="ident" id="4700273">b</span><span class="op" id="4700274">[</span><span class="ident" id="4700275">i</span><span class="op" id="4700276">]</span>&nbsp;<span class="op" id="4700278">!=</span>&nbsp;<span class="num" id="4700281">0</span><span class="op" id="4700282">;</span>&nbsp;<span class="ident" id="4700284">i</span><span class="op" id="4700285">++</span>&nbsp;<span class="op" id="4700288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700294">return</span>&nbsp;<span class="builtintype" id="4700301">string</span><span class="op" id="4700307">(</span><span class="ident" id="4700308">b</span><span class="op" id="4700309">[</span><span class="num" id="4700310">0</span><span class="op" id="4700311">:</span><span class="ident" id="4700312">i</span><span class="op" id="4700313">]</span><span class="op" id="4700314">)</span><br>
<span class="lineno">270</span><span class="op" id="4700316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4700319">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="4700376">func</span>&nbsp;<span class="ident" id="4700381">getString</span><span class="op" id="4700390">(</span><span class="ident" id="4700391">section</span>&nbsp;<span class="op" id="4700399">[</span><span class="op" id="4700400">]</span><span class="builtintype" id="4700401">byte</span><span class="op" id="4700405">,</span>&nbsp;<span class="ident" id="4700407">start</span>&nbsp;<span class="builtintype" id="4700413">int</span><span class="op" id="4700416">)</span>&nbsp;<span class="op" id="4700418">(</span><span class="builtintype" id="4700419">string</span><span class="op" id="4700425">,</span>&nbsp;<span class="builtintype" id="4700427">bool</span><span class="op" id="4700431">)</span>&nbsp;<span class="op" id="4700433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700436">if</span>&nbsp;<span class="ident" id="4700439">start</span>&nbsp;<span class="op" id="4700445">&lt;</span>&nbsp;<span class="num" id="4700447">0</span>&nbsp;<span class="op" id="4700449">||</span>&nbsp;<span class="ident" id="4700452">start</span>&nbsp;<span class="op" id="4700458">&gt;=</span>&nbsp;<span class="builtinfunc" id="4700461">len</span><span class="op" id="4700464">(</span><span class="ident" id="4700465">section</span><span class="op" id="4700472">)</span>&nbsp;<span class="op" id="4700474">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700478">return</span>&nbsp;<span class="string" id="4700485">&#34;&#34;</span><span class="op" id="4700487">,</span>&nbsp;<span class="builtintype" id="4700489">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700500">for</span>&nbsp;<span class="ident" id="4700504">end</span>&nbsp;<span class="op" id="4700508">:=</span>&nbsp;<span class="ident" id="4700511">start</span><span class="op" id="4700516">;</span>&nbsp;<span class="ident" id="4700518">end</span>&nbsp;<span class="op" id="4700522">&lt;</span>&nbsp;<span class="builtinfunc" id="4700524">len</span><span class="op" id="4700527">(</span><span class="ident" id="4700528">section</span><span class="op" id="4700535">)</span><span class="op" id="4700536">;</span>&nbsp;<span class="ident" id="4700538">end</span><span class="op" id="4700541">++</span>&nbsp;<span class="op" id="4700544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700548">if</span>&nbsp;<span class="ident" id="4700551">section</span><span class="op" id="4700558">[</span><span class="ident" id="4700559">end</span><span class="op" id="4700562">]</span>&nbsp;<span class="op" id="4700564">==</span>&nbsp;<span class="num" id="4700567">0</span>&nbsp;<span class="op" id="4700569">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700574">return</span>&nbsp;<span class="builtintype" id="4700581">string</span><span class="op" id="4700587">(</span><span class="ident" id="4700588">section</span><span class="op" id="4700595">[</span><span class="ident" id="4700596">start</span><span class="op" id="4700601">:</span><span class="ident" id="4700602">end</span><span class="op" id="4700605">]</span><span class="op" id="4700606">)</span><span class="op" id="4700607">,</span>&nbsp;<span class="builtintype" id="4700609">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700622">return</span>&nbsp;<span class="string" id="4700629">&#34;&#34;</span><span class="op" id="4700631">,</span>&nbsp;<span class="builtintype" id="4700633">false</span><br>
<span class="lineno"></span><span class="op" id="4700639">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4700642">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4700718">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="4700737">func</span>&nbsp;<span class="op" id="4700742">(</span><span class="ident" id="4700743">f</span>&nbsp;<span class="op" id="4700745">*</span><span class="ident" id="4700746">File</span><span class="op" id="4700750">)</span>&nbsp;<span class="ident" id="4700752">Section</span><span class="op" id="4700759">(</span><span class="ident" id="4700760">name</span>&nbsp;<span class="builtintype" id="4700765">string</span><span class="op" id="4700771">)</span>&nbsp;<span class="op" id="4700773">*</span><span class="ident" id="4700774">Section</span>&nbsp;<span class="op" id="4700782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700785">for</span>&nbsp;<span class="ident" id="4700789">_</span><span class="op" id="4700790">,</span>&nbsp;<span class="ident" id="4700792">s</span>&nbsp;<span class="op" id="4700794">:=</span>&nbsp;<span class="keyword" id="4700797">range</span>&nbsp;<span class="ident" id="4700803">f</span><span class="op" id="4700804">.</span><span class="ident" id="4700805">Sections</span>&nbsp;<span class="op" id="4700814">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700818">if</span>&nbsp;<span class="ident" id="4700821">s</span><span class="op" id="4700822">.</span><span class="ident" id="4700823">Name</span>&nbsp;<span class="op" id="4700828">==</span>&nbsp;<span class="ident" id="4700831">name</span>&nbsp;<span class="op" id="4700836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700841">return</span>&nbsp;<span class="ident" id="4700848">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700858">return</span>&nbsp;<span class="builtintype" id="4700865">nil</span><br>
<span class="lineno">295</span><span class="op" id="4700869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4700872">func</span>&nbsp;<span class="op" id="4700877">(</span><span class="ident" id="4700878">f</span>&nbsp;<span class="op" id="4700880">*</span><span class="ident" id="4700881">File</span><span class="op" id="4700885">)</span>&nbsp;<span class="ident" id="4700887">DWARF</span><span class="op" id="4700892">(</span><span class="op" id="4700893">)</span>&nbsp;<span class="op" id="4700895">(</span><span class="op" id="4700896">*</span><span class="ident" id="4700897">dwarf</span><span class="op" id="4700902">.</span><span class="ident" id="4700903">Data</span><span class="op" id="4700907">,</span>&nbsp;<span class="builtintype" id="4700909">error</span><span class="op" id="4700914">)</span>&nbsp;<span class="op" id="4700916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4700919">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4700970">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4701025">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701084">var</span>&nbsp;<span class="ident" id="4701088">names</span>&nbsp;<span class="op" id="4701094">=</span>&nbsp;<span class="op" id="4701096">[</span><span class="op" id="4701097">...</span><span class="op" id="4701100">]</span><span class="builtintype" id="4701101">string</span><span class="op" id="4701107">{</span><span class="string" id="4701108">&#34;abbrev&#34;</span><span class="op" id="4701116">,</span>&nbsp;<span class="string" id="4701118">&#34;info&#34;</span><span class="op" id="4701124">,</span>&nbsp;<span class="string" id="4701126">&#34;str&#34;</span><span class="op" id="4701131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701134">var</span>&nbsp;<span class="ident" id="4701138">dat</span>&nbsp;<span class="op" id="4701142">[</span><span class="builtinfunc" id="4701143">len</span><span class="op" id="4701146">(</span><span class="ident" id="4701147">names</span><span class="op" id="4701152">)</span><span class="op" id="4701153">]</span><span class="op" id="4701154">[</span><span class="op" id="4701155">]</span><span class="builtintype" id="4701156">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701162">for</span>&nbsp;<span class="ident" id="4701166">i</span><span class="op" id="4701167">,</span>&nbsp;<span class="ident" id="4701169">name</span>&nbsp;<span class="op" id="4701174">:=</span>&nbsp;<span class="keyword" id="4701177">range</span>&nbsp;<span class="ident" id="4701183">names</span>&nbsp;<span class="op" id="4701189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701193">name</span>&nbsp;<span class="op" id="4701198">=</span>&nbsp;<span class="string" id="4701200">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="4701210">+</span>&nbsp;<span class="ident" id="4701212">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701219">s</span>&nbsp;<span class="op" id="4701221">:=</span>&nbsp;<span class="ident" id="4701224">f</span><span class="op" id="4701225">.</span><span class="ident" id="4701226">Section</span><span class="op" id="4701233">(</span><span class="ident" id="4701234">name</span><span class="op" id="4701238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701242">if</span>&nbsp;<span class="ident" id="4701245">s</span>&nbsp;<span class="op" id="4701247">==</span>&nbsp;<span class="builtintype" id="4701250">nil</span>&nbsp;<span class="op" id="4701254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701259">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701274">b</span><span class="op" id="4701275">,</span>&nbsp;<span class="ident" id="4701277">err</span>&nbsp;<span class="op" id="4701281">:=</span>&nbsp;<span class="ident" id="4701284">s</span><span class="op" id="4701285">.</span><span class="ident" id="4701286">Data</span><span class="op" id="4701290">(</span><span class="op" id="4701291">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701295">if</span>&nbsp;<span class="ident" id="4701298">err</span>&nbsp;<span class="op" id="4701302">!=</span>&nbsp;<span class="builtintype" id="4701305">nil</span>&nbsp;<span class="op" id="4701309">&amp;&amp;</span>&nbsp;<span class="builtintype" id="4701312">uint32</span><span class="op" id="4701318">(</span><span class="builtinfunc" id="4701319">len</span><span class="op" id="4701322">(</span><span class="ident" id="4701323">b</span><span class="op" id="4701324">)</span><span class="op" id="4701325">)</span>&nbsp;<span class="op" id="4701327">&lt;</span>&nbsp;<span class="ident" id="4701329">s</span><span class="op" id="4701330">.</span><span class="ident" id="4701331">Size</span>&nbsp;<span class="op" id="4701336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701341">return</span>&nbsp;<span class="builtintype" id="4701348">nil</span><span class="op" id="4701351">,</span>&nbsp;<span class="ident" id="4701353">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701363">dat</span><span class="op" id="4701366">[</span><span class="ident" id="4701367">i</span><span class="op" id="4701368">]</span>&nbsp;<span class="op" id="4701370">=</span>&nbsp;<span class="ident" id="4701372">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701375">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701379">abbrev</span><span class="op" id="4701385">,</span>&nbsp;<span class="ident" id="4701387">info</span><span class="op" id="4701391">,</span>&nbsp;<span class="ident" id="4701393">str</span>&nbsp;<span class="op" id="4701397">:=</span>&nbsp;<span class="ident" id="4701400">dat</span><span class="op" id="4701403">[</span><span class="num" id="4701404">0</span><span class="op" id="4701405">]</span><span class="op" id="4701406">,</span>&nbsp;<span class="ident" id="4701408">dat</span><span class="op" id="4701411">[</span><span class="num" id="4701412">1</span><span class="op" id="4701413">]</span><span class="op" id="4701414">,</span>&nbsp;<span class="ident" id="4701416">dat</span><span class="op" id="4701419">[</span><span class="num" id="4701420">2</span><span class="op" id="4701421">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701424">return</span>&nbsp;<span class="ident" id="4701431">dwarf</span><span class="op" id="4701436">.</span><span class="ident" id="4701437">New</span><span class="op" id="4701440">(</span><span class="ident" id="4701441">abbrev</span><span class="op" id="4701447">,</span>&nbsp;<span class="builtintype" id="4701449">nil</span><span class="op" id="4701452">,</span>&nbsp;<span class="builtintype" id="4701454">nil</span><span class="op" id="4701457">,</span>&nbsp;<span class="ident" id="4701459">info</span><span class="op" id="4701463">,</span>&nbsp;<span class="builtintype" id="4701465">nil</span><span class="op" id="4701468">,</span>&nbsp;<span class="builtintype" id="4701470">nil</span><span class="op" id="4701473">,</span>&nbsp;<span class="builtintype" id="4701475">nil</span><span class="op" id="4701478">,</span>&nbsp;<span class="ident" id="4701480">str</span><span class="op" id="4701483">)</span><br>
<span class="lineno"></span><span class="op" id="4701485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="4701488">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="4701540">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4701595">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="4701649">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="4701685">func</span>&nbsp;<span class="op" id="4701690">(</span><span class="ident" id="4701691">f</span>&nbsp;<span class="op" id="4701693">*</span><span class="ident" id="4701694">File</span><span class="op" id="4701698">)</span>&nbsp;<span class="ident" id="4701700">ImportedSymbols</span><span class="op" id="4701715">(</span><span class="op" id="4701716">)</span>&nbsp;<span class="op" id="4701718">(</span><span class="op" id="4701719">[</span><span class="op" id="4701720">]</span><span class="builtintype" id="4701721">string</span><span class="op" id="4701727">,</span>&nbsp;<span class="builtintype" id="4701729">error</span><span class="op" id="4701734">)</span>&nbsp;<span class="op" id="4701736">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701739">pe64</span>&nbsp;<span class="op" id="4701744">:=</span>&nbsp;<span class="ident" id="4701747">f</span><span class="op" id="4701748">.</span><span class="ident" id="4701749">Machine</span>&nbsp;<span class="op" id="4701757">==</span>&nbsp;<span class="ident" id="4701760">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701786">ds</span>&nbsp;<span class="op" id="4701789">:=</span>&nbsp;<span class="ident" id="4701792">f</span><span class="op" id="4701793">.</span><span class="ident" id="4701794">Section</span><span class="op" id="4701801">(</span><span class="string" id="4701802">&#34;.idata&#34;</span><span class="op" id="4701810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701813">if</span>&nbsp;<span class="ident" id="4701816">ds</span>&nbsp;<span class="op" id="4701819">==</span>&nbsp;<span class="builtintype" id="4701822">nil</span>&nbsp;<span class="op" id="4701826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4701830">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701864">return</span>&nbsp;<span class="builtintype" id="4701871">nil</span><span class="op" id="4701874">,</span>&nbsp;<span class="builtintype" id="4701876">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701884">d</span><span class="op" id="4701885">,</span>&nbsp;<span class="ident" id="4701887">err</span>&nbsp;<span class="op" id="4701891">:=</span>&nbsp;<span class="ident" id="4701894">ds</span><span class="op" id="4701896">.</span><span class="ident" id="4701897">Data</span><span class="op" id="4701901">(</span><span class="op" id="4701902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701905">if</span>&nbsp;<span class="ident" id="4701908">err</span>&nbsp;<span class="op" id="4701912">!=</span>&nbsp;<span class="builtintype" id="4701915">nil</span>&nbsp;<span class="op" id="4701919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701923">return</span>&nbsp;<span class="builtintype" id="4701930">nil</span><span class="op" id="4701933">,</span>&nbsp;<span class="ident" id="4701935">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701940">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701943">var</span>&nbsp;<span class="ident" id="4701947">ida</span>&nbsp;<span class="op" id="4701951">[</span><span class="op" id="4701952">]</span><span class="ident" id="4701953">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701970">for</span>&nbsp;<span class="builtinfunc" id="4701974">len</span><span class="op" id="4701977">(</span><span class="ident" id="4701978">d</span><span class="op" id="4701979">)</span>&nbsp;<span class="op" id="4701981">&gt;</span>&nbsp;<span class="num" id="4701983">0</span>&nbsp;<span class="op" id="4701985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701989">var</span>&nbsp;<span class="ident" id="4701993">dt</span>&nbsp;<span class="ident" id="4701996">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702014">dt</span><span class="op" id="4702016">.</span><span class="ident" id="4702017">OriginalFirstThunk</span>&nbsp;<span class="op" id="4702036">=</span>&nbsp;<span class="ident" id="4702038">binary</span><span class="op" id="4702044">.</span><span class="ident" id="4702045">LittleEndian</span><span class="op" id="4702057">.</span><span class="ident" id="4702058">Uint32</span><span class="op" id="4702064">(</span><span class="ident" id="4702065">d</span><span class="op" id="4702066">[</span><span class="num" id="4702067">0</span><span class="op" id="4702068">:</span><span class="num" id="4702069">4</span><span class="op" id="4702070">]</span><span class="op" id="4702071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702075">dt</span><span class="op" id="4702077">.</span><span class="ident" id="4702078">Name</span>&nbsp;<span class="op" id="4702083">=</span>&nbsp;<span class="ident" id="4702085">binary</span><span class="op" id="4702091">.</span><span class="ident" id="4702092">LittleEndian</span><span class="op" id="4702104">.</span><span class="ident" id="4702105">Uint32</span><span class="op" id="4702111">(</span><span class="ident" id="4702112">d</span><span class="op" id="4702113">[</span><span class="num" id="4702114">12</span><span class="op" id="4702116">:</span><span class="num" id="4702117">16</span><span class="op" id="4702119">]</span><span class="op" id="4702120">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702124">dt</span><span class="op" id="4702126">.</span><span class="ident" id="4702127">FirstThunk</span>&nbsp;<span class="op" id="4702138">=</span>&nbsp;<span class="ident" id="4702140">binary</span><span class="op" id="4702146">.</span><span class="ident" id="4702147">LittleEndian</span><span class="op" id="4702159">.</span><span class="ident" id="4702160">Uint32</span><span class="op" id="4702166">(</span><span class="ident" id="4702167">d</span><span class="op" id="4702168">[</span><span class="num" id="4702169">16</span><span class="op" id="4702171">:</span><span class="num" id="4702172">20</span><span class="op" id="4702174">]</span><span class="op" id="4702175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702179">d</span>&nbsp;<span class="op" id="4702181">=</span>&nbsp;<span class="ident" id="4702183">d</span><span class="op" id="4702184">[</span><span class="num" id="4702185">20</span><span class="op" id="4702187">:</span><span class="op" id="4702188">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702192">if</span>&nbsp;<span class="ident" id="4702195">dt</span><span class="op" id="4702197">.</span><span class="ident" id="4702198">OriginalFirstThunk</span>&nbsp;<span class="op" id="4702217">==</span>&nbsp;<span class="num" id="4702220">0</span>&nbsp;<span class="op" id="4702222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702227">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702235">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702239">ida</span>&nbsp;<span class="op" id="4702243">=</span>&nbsp;<span class="builtinfunc" id="4702245">append</span><span class="op" id="4702251">(</span><span class="ident" id="4702252">ida</span><span class="op" id="4702255">,</span>&nbsp;<span class="ident" id="4702257">dt</span><span class="op" id="4702259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702265">names</span><span class="op" id="4702270">,</span>&nbsp;<span class="ident" id="4702272">_</span>&nbsp;<span class="op" id="4702274">:=</span>&nbsp;<span class="ident" id="4702277">ds</span><span class="op" id="4702279">.</span><span class="ident" id="4702280">Data</span><span class="op" id="4702284">(</span><span class="op" id="4702285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702288">var</span>&nbsp;<span class="ident" id="4702292">all</span>&nbsp;<span class="op" id="4702296">[</span><span class="op" id="4702297">]</span><span class="builtintype" id="4702298">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702306">for</span>&nbsp;<span class="ident" id="4702310">_</span><span class="op" id="4702311">,</span>&nbsp;<span class="ident" id="4702313">dt</span>&nbsp;<span class="op" id="4702316">:=</span>&nbsp;<span class="keyword" id="4702319">range</span>&nbsp;<span class="ident" id="4702325">ida</span>&nbsp;<span class="op" id="4702329">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702333">dt</span><span class="op" id="4702335">.</span><span class="ident" id="4702336">dll</span><span class="op" id="4702339">,</span>&nbsp;<span class="ident" id="4702341">_</span>&nbsp;<span class="op" id="4702343">=</span>&nbsp;<span class="ident" id="4702345">getString</span><span class="op" id="4702354">(</span><span class="ident" id="4702355">names</span><span class="op" id="4702360">,</span>&nbsp;<span class="builtintype" id="4702362">int</span><span class="op" id="4702365">(</span><span class="ident" id="4702366">dt</span><span class="op" id="4702368">.</span><span class="ident" id="4702369">Name</span><span class="op" id="4702373">-</span><span class="ident" id="4702374">ds</span><span class="op" id="4702376">.</span><span class="ident" id="4702377">VirtualAddress</span><span class="op" id="4702391">)</span><span class="op" id="4702392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702396">d</span><span class="op" id="4702397">,</span>&nbsp;<span class="ident" id="4702399">_</span>&nbsp;<span class="op" id="4702401">=</span>&nbsp;<span class="ident" id="4702403">ds</span><span class="op" id="4702405">.</span><span class="ident" id="4702406">Data</span><span class="op" id="4702410">(</span><span class="op" id="4702411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4702415">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702447">d</span>&nbsp;<span class="op" id="4702449">=</span>&nbsp;<span class="ident" id="4702451">d</span><span class="op" id="4702452">[</span><span class="ident" id="4702453">dt</span><span class="op" id="4702455">.</span><span class="ident" id="4702456">OriginalFirstThunk</span><span class="op" id="4702474">-</span><span class="ident" id="4702475">ds</span><span class="op" id="4702477">.</span><span class="ident" id="4702478">VirtualAddress</span><span class="op" id="4702492">:</span><span class="op" id="4702493">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702497">for</span>&nbsp;<span class="builtinfunc" id="4702501">len</span><span class="op" id="4702504">(</span><span class="ident" id="4702505">d</span><span class="op" id="4702506">)</span>&nbsp;<span class="op" id="4702508">&gt;</span>&nbsp;<span class="num" id="4702510">0</span>&nbsp;<span class="op" id="4702512">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702517">if</span>&nbsp;<span class="ident" id="4702520">pe64</span>&nbsp;<span class="op" id="4702525">{</span>&nbsp;<span class="comment" id="4702527">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702540">va</span>&nbsp;<span class="op" id="4702543">:=</span>&nbsp;<span class="ident" id="4702546">binary</span><span class="op" id="4702552">.</span><span class="ident" id="4702553">LittleEndian</span><span class="op" id="4702565">.</span><span class="ident" id="4702566">Uint64</span><span class="op" id="4702572">(</span><span class="ident" id="4702573">d</span><span class="op" id="4702574">[</span><span class="num" id="4702575">0</span><span class="op" id="4702576">:</span><span class="num" id="4702577">8</span><span class="op" id="4702578">]</span><span class="op" id="4702579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702585">d</span>&nbsp;<span class="op" id="4702587">=</span>&nbsp;<span class="ident" id="4702589">d</span><span class="op" id="4702590">[</span><span class="num" id="4702591">8</span><span class="op" id="4702592">:</span><span class="op" id="4702593">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702599">if</span>&nbsp;<span class="ident" id="4702602">va</span>&nbsp;<span class="op" id="4702605">==</span>&nbsp;<span class="num" id="4702608">0</span>&nbsp;<span class="op" id="4702610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702617">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702633">if</span>&nbsp;<span class="ident" id="4702636">va</span><span class="op" id="4702638">&amp;</span><span class="num" id="4702639">0x8000000000000000</span>&nbsp;<span class="op" id="4702658">&gt;</span>&nbsp;<span class="num" id="4702660">0</span>&nbsp;<span class="op" id="4702662">{</span>&nbsp;<span class="comment" id="4702664">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4702683">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702726">}</span>&nbsp;<span class="keyword" id="4702728">else</span>&nbsp;<span class="op" id="4702733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702740">fn</span><span class="op" id="4702742">,</span>&nbsp;<span class="ident" id="4702744">_</span>&nbsp;<span class="op" id="4702746">:=</span>&nbsp;<span class="ident" id="4702749">getString</span><span class="op" id="4702758">(</span><span class="ident" id="4702759">names</span><span class="op" id="4702764">,</span>&nbsp;<span class="builtintype" id="4702766">int</span><span class="op" id="4702769">(</span><span class="builtintype" id="4702770">uint32</span><span class="op" id="4702776">(</span><span class="ident" id="4702777">va</span><span class="op" id="4702779">)</span><span class="op" id="4702780">-</span><span class="ident" id="4702781">ds</span><span class="op" id="4702783">.</span><span class="ident" id="4702784">VirtualAddress</span><span class="op" id="4702798">+</span><span class="num" id="4702799">2</span><span class="op" id="4702800">)</span><span class="op" id="4702801">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702808">all</span>&nbsp;<span class="op" id="4702812">=</span>&nbsp;<span class="builtinfunc" id="4702814">append</span><span class="op" id="4702820">(</span><span class="ident" id="4702821">all</span><span class="op" id="4702824">,</span>&nbsp;<span class="ident" id="4702826">fn</span><span class="op" id="4702828">+</span><span class="string" id="4702829">&#34;:&#34;</span><span class="op" id="4702832">+</span><span class="ident" id="4702833">dt</span><span class="op" id="4702835">.</span><span class="ident" id="4702836">dll</span><span class="op" id="4702839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702850">}</span>&nbsp;<span class="keyword" id="4702852">else</span>&nbsp;<span class="op" id="4702857">{</span>&nbsp;<span class="comment" id="4702859">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702872">va</span>&nbsp;<span class="op" id="4702875">:=</span>&nbsp;<span class="ident" id="4702878">binary</span><span class="op" id="4702884">.</span><span class="ident" id="4702885">LittleEndian</span><span class="op" id="4702897">.</span><span class="ident" id="4702898">Uint32</span><span class="op" id="4702904">(</span><span class="ident" id="4702905">d</span><span class="op" id="4702906">[</span><span class="num" id="4702907">0</span><span class="op" id="4702908">:</span><span class="num" id="4702909">4</span><span class="op" id="4702910">]</span><span class="op" id="4702911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702917">d</span>&nbsp;<span class="op" id="4702919">=</span>&nbsp;<span class="ident" id="4702921">d</span><span class="op" id="4702922">[</span><span class="num" id="4702923">4</span><span class="op" id="4702924">:</span><span class="op" id="4702925">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702931">if</span>&nbsp;<span class="ident" id="4702934">va</span>&nbsp;<span class="op" id="4702937">==</span>&nbsp;<span class="num" id="4702940">0</span>&nbsp;<span class="op" id="4702942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702949">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702965">if</span>&nbsp;<span class="ident" id="4702968">va</span><span class="op" id="4702970">&amp;</span><span class="num" id="4702971">0x80000000</span>&nbsp;<span class="op" id="4702982">&gt;</span>&nbsp;<span class="num" id="4702984">0</span>&nbsp;<span class="op" id="4702986">{</span>&nbsp;<span class="comment" id="4702988">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4703007">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4703051">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703078">}</span>&nbsp;<span class="keyword" id="4703080">else</span>&nbsp;<span class="op" id="4703085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703092">fn</span><span class="op" id="4703094">,</span>&nbsp;<span class="ident" id="4703096">_</span>&nbsp;<span class="op" id="4703098">:=</span>&nbsp;<span class="ident" id="4703101">getString</span><span class="op" id="4703110">(</span><span class="ident" id="4703111">names</span><span class="op" id="4703116">,</span>&nbsp;<span class="builtintype" id="4703118">int</span><span class="op" id="4703121">(</span><span class="ident" id="4703122">va</span><span class="op" id="4703124">-</span><span class="ident" id="4703125">ds</span><span class="op" id="4703127">.</span><span class="ident" id="4703128">VirtualAddress</span><span class="op" id="4703142">+</span><span class="num" id="4703143">2</span><span class="op" id="4703144">)</span><span class="op" id="4703145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703152">all</span>&nbsp;<span class="op" id="4703156">=</span>&nbsp;<span class="builtinfunc" id="4703158">append</span><span class="op" id="4703164">(</span><span class="ident" id="4703165">all</span><span class="op" id="4703168">,</span>&nbsp;<span class="ident" id="4703170">fn</span><span class="op" id="4703172">+</span><span class="string" id="4703173">&#34;:&#34;</span><span class="op" id="4703176">+</span><span class="ident" id="4703177">dt</span><span class="op" id="4703179">.</span><span class="ident" id="4703180">dll</span><span class="op" id="4703183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703189">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703205">return</span>&nbsp;<span class="ident" id="4703212">all</span><span class="op" id="4703215">,</span>&nbsp;<span class="builtintype" id="4703217">nil</span><br>
<span class="lineno">385</span><span class="op" id="4703221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4703224">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="4703280">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4703335">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="4703383">func</span>&nbsp;<span class="op" id="4703388">(</span><span class="ident" id="4703389">f</span>&nbsp;<span class="op" id="4703391">*</span><span class="ident" id="4703392">File</span><span class="op" id="4703396">)</span>&nbsp;<span class="ident" id="4703398">ImportedLibraries</span><span class="op" id="4703415">(</span><span class="op" id="4703416">)</span>&nbsp;<span class="op" id="4703418">(</span><span class="op" id="4703419">[</span><span class="op" id="4703420">]</span><span class="builtintype" id="4703421">string</span><span class="op" id="4703427">,</span>&nbsp;<span class="builtintype" id="4703429">error</span><span class="op" id="4703434">)</span>&nbsp;<span class="op" id="4703436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4703439">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4703448">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703514">return</span>&nbsp;<span class="builtintype" id="4703521">nil</span><span class="op" id="4703524">,</span>&nbsp;<span class="builtintype" id="4703526">nil</span><br>
<span class="lineno"></span><span class="op" id="4703530">}</span>
</div>
</body>
</html>
